<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3087348</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-428</article-id>
    <article-id pub-id-type="pmid">20015393</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-428</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TargetSearch - a Bioconductor package for the efficient preprocessing of GC-MS metabolite profiling data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Cuadros-Inostroza</surname>
          <given-names>Álvaro</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>inostroza@mpimp-golm.mpg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Caldana</surname>
          <given-names>Camila</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>caldana@mpimp-golm.mpg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Redestig</surname>
          <given-names>Henning</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>henning.red@psc.riken.jp</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Kusano</surname>
          <given-names>Miyako</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>mkusano005@psc.riken.jp</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Lisec</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>lisec@mpimp-golm.mpg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Peña-Cortés</surname>
          <given-names>Hugo</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>hugo.pena@usm.cl</email>
      </contrib>
      <contrib contrib-type="author" id="A7">
        <name>
          <surname>Willmitzer</surname>
          <given-names>Lothar</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>willmitzer@mpimp-golm.mpg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A8">
        <name>
          <surname>Hannah</surname>
          <given-names>Matthew A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>matthew.hannah@bayercropscience.com</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Max Planck Institute of Molecular Plant Physiology, Am Mühlenberg 1, D-14476 Potsdam-Golm, Germany</aff>
    <aff id="I2"><label>2</label>Centro de Biotecnología, Universidad Técnica Federico Santa María, General Bari 699 Valparaíso, Chile</aff>
    <aff id="I3"><label>3</label>RIKEN Plant Science Center, Tsurumi-ku, Suehiro-cho, 1-7-22 Yokohama, Kanagawa, 230-0045, Japan</aff>
    <aff id="I4"><label>4</label>Bayer BioScience N.V., Technologiepark 38, B-9052, Gent, Belgium</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>12</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>428</fpage>
    <lpage>428</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>8</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>12</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2009 Cuadros-Inostroza et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Cuadros-Inostroza et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/10/428"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Metabolite profiling, the simultaneous quantification of multiple metabolites in an experiment, is becoming increasingly popular, particularly with the rise of systems-level biology. The workhorse in this field is gas-chromatography hyphenated with mass spectrometry (GC-MS). The high-throughput of this technology coupled with a demand for large experiments has led to data pre-processing, i.e. the quantification of metabolites across samples, becoming a major bottleneck. Existing software has several limitations, including restricted maximum sample size, systematic errors and low flexibility. However, the biggest limitation is that the resulting data usually require extensive hand-curation, which is subjective and can typically take several days to weeks.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We introduce the <italic>TargetSearch </italic>package, an open source tool which is a flexible and accurate method for pre-processing even very large numbers of GC-MS samples within hours. We developed a novel strategy to iteratively correct and update retention time indices for searching and identifying metabolites. The package is written in the R programming language with computationally intensive functions written in C for speed and performance. The package includes a graphical user interface to allow easy use by those unfamiliar with R.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p><italic>TargetSearch </italic>allows fast and accurate data pre-processing for GC-MS experiments and overcomes the sample number limitations and manual curation requirements of existing software. We validate our method by carrying out an analysis against both a set of known chemical standard mixtures and of a biological experiment. In addition we demonstrate its capabilities and speed by comparing it with other GC-MS pre-processing tools. We believe this package will greatly ease current bottlenecks and facilitate the analysis of metabolic profiling data.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Metabolite profiling has become a powerful tool to address biological problems. It has been used in a wide range of applications, such as discovering the effects of herbicides in plants [<xref ref-type="bibr" rid="B1">1</xref>], drugs in medical fields [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>], or molecular physiology and functional genomics [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>GC-MS is by far the most widely applied analytical method as it provides an efficient way to quantify hundreds of metabolites in a single sample run [<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B9">9</xref>]. In addition, robust extraction protocols exist and there is continued development of data evaluation methods. See [<xref ref-type="bibr" rid="B10">10</xref>] for a introduction to metabolomics using GC-MS.</p>
    <p>The relatively low cost and high-throughput of GC-MS instruments has led to data pre-processing becoming a major bottleneck in metabolite profiling, particularly with recent increases in experiment size. The typical GC-MS pre-processing approach consists of peak detection and mass spectra deconvolution, retention time alignment across different samples and a normalisation step to remove systematic variation in the data. Finally, the peak information is collected and transformed into a data matrix for statistical analysis. Many software tools are available that can perform said steps, either using a non-targeted approach, i.e., all the extracted peaks are used as relevant information, or a metabolite-targeted approach, where detected peaks are searched in existing compound databases, matching their retention time and spectra. Examples of GC-MS pre-processing software solutions include AMDIS [<xref ref-type="bibr" rid="B11">11</xref>], Leco ChromaTOF [<xref ref-type="bibr" rid="B12">12</xref>], MetAlign [<xref ref-type="bibr" rid="B13">13</xref>], XCMS [<xref ref-type="bibr" rid="B14">14</xref>] and Tagfinder [<xref ref-type="bibr" rid="B15">15</xref>].</p>
    <p>Although deconvolution is a well accepted method, biological complexity of samples, e.g., co-eluting compounds, causes errors in the deconvolution algorithm that result in partially deconvoluted or mixed mass spectra tags (MSTs). A widely accepted alternative to avoid this inconvenience is the extraction of peak apex intensities for selected masses [<xref ref-type="bibr" rid="B15">15</xref>]. This method has the advantage of being both less computationally intensive and less error susceptible. In spite of that, existing tools have other limitations such as restrictions to maximum sample number, long run-time and complicated peak identification. The latter typically requires manual inspection and curation that may take weeks to complete for an average experiment.</p>
    <p>Our aim was to develop a flexible and automated tool that can pre-process data, identify and quantify metabolite levels for even very large numbers of samples in a targeted manner, whilst keeping processing time to a minimum. Our approach uses peak apex intensities to avoid deconvolution errors, a metabolite reference library based on selective masses and retention time indices [<xref ref-type="bibr" rid="B16">16</xref>], conversion and correction from retention time (RT) to retention time index (RI), RI updating and metabolite identification using multiple correlated masses [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B17">17</xref>].</p>
    <p>Our software is implemented in the R language with computationally intensive functions programmed in C for speed and performance. The software is available as an R-package within the framework of the Bioconductor project [<xref ref-type="bibr" rid="B18">18</xref>].</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>This section describes our GC-MS pre-processing approach (Figure <xref ref-type="fig" rid="F1">1</xref>). In short, a sample definition file and a reference library are required to identify the files to process and to provide the metabolite information to be searched for. Mass trace apices are extracted from every chromatogram and stored in text files. At the same time, RT is converted to RI. Selective masses from the reference library are searched in a three-step RI updating procedure. Every file, either chromatogram or peak list, is processed one at a time, allowing the analysis of a large number of samples. Also, since the most time consuming algorithms are written in C, the overall processing time, from raw chromatograms to a metabolite data matrix, is very short.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>TargetSearch flow chart</bold>. <italic>TargetSearch </italic>pre-processing flow chart for the analysis of GC-MS data.</p>
      </caption>
      <graphic xlink:href="1471-2105-10-428-1"/>
    </fig>
    <sec>
      <title>User input</title>
      <p>There are three types of input that the user must supply: chromatogram files, sample description and a reference library.</p>
      <p>GC-MS chromatograms must be first exported to the widely accepted and platform-independent NetCDF file format. This is usually performed by using the platform-specific GC-MS software (e.g. Leco ChromaTOF). Baseline correction and smoothing could be performed before exporting the chromatograms, but as this is not always done, we implemented these steps so they can be performed by <italic>TargetSearch</italic>.</p>
      <p>The "sample description" file contains a list of sample names, sample files and sample groups, which is used for the downstream analyses.</p>
      <p>Finally, the "reference library" file contains the information on the MSTs that will be searched for in the chromatograms. Required information is the metabolite name, expected RI, selective masses, most abundant masses, spectra and RI deviation. The file format can be tab-delimited text containing said columns or the commonly used NIST MS Search Software text format [<xref ref-type="bibr" rid="B19">19</xref>]. We developed a novel iterative approach to RI assignment to take advantage of the fact that RI variation decreases in the following order: between experiment <italic>&gt;&gt; </italic>between samples <italic>&gt;&gt; </italic>between masses from the same metabolite. Thus, we use selective masses to identify the experiment RI from the library RI, following that use this to find the sample RI and finally use this to identify co-eluting masses for quantification. <italic>TargetSearch </italic>can be used with freely available public metabolite libraries, for example, in [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B20">20</xref>], with commercial libraries, for example, [<xref ref-type="bibr" rid="B21">21</xref>] or in-house developed or curated libraries.</p>
    </sec>
    <sec>
      <title>Peak identification and RI correction</title>
      <p>Initially, <italic>TargetSearch </italic>performs baseline correction and identifies the local apex intensities from the mass traces in all chromatograms. The baseline correction algorithm is based on [<xref ref-type="bibr" rid="B22">22</xref>] and should be performed if the exported chromatograms were not baseline corrected by the vendor software. This is controlled by the user. After that, <italic>TargetSearch </italic>finds the retention time of the RI markers, internal standard compounds like alkanes or fatty acid methyl esters, and converts the retention time to RI using a linear interpolation [<xref ref-type="bibr" rid="B23">23</xref>]. The RI marker definition, time window and <italic>m/z </italic>values, have to be provided by the user in the same way as for other software [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B24">24</xref>].</p>
      <p>In addition, a report is created to allow the rapid assessment of RI marker outliers. This is an essential step which can be cumbersome and time-consuming using other methods. The generated report contains a separate plot for each retention index marker in which sample number is plotted against the found retention time. Outliers are highlighted on a per-day basis using a 3<italic>σ </italic>cut-off (or other defined cut-off). Here, measurement days are defined in the "sample description" file or can be detected automatically using hierarchical clustering. This report allows a fast assessment of outliers allowing the user to quickly decide whether the sample should be removed from the data set or not. It is also possible to manually edit the found retention time, but this is in our experience rarely necessary.</p>
      <p>Finally, <italic>TargetSearch </italic>creates a tab delimited file per chromatogram file which contains a peak list, retention times and converted RIs. For efficiency, it is possible to start subsequent steps from these saved files by selecting "Apex Data" instead of "NetCDF Data".</p>
    </sec>
    <sec>
      <title>Library search</title>
      <p>Metabolites are identified in three steps. First, for every metabolite, selective masses are searched for in a given time window around the expected RI, returning the median RI of all selective masses. The expected RI of the respective metabolite is updated to that value. In the second step, <italic>TargetSearch </italic>searches the selected masses using the updated RI and a given time deviation, usually smaller than the one used in the first step. The intensities of the selected masses are normalised to the median of the day, and then used to extract other masses with correlated apex profiles. The masses for which the Pearson correlation coefficient is above a given threshold are taken as metabolite markers and their RIs are averaged on a per sample basis. This average RI is taken to represent the exact position where the metabolite elutes in the respective sample. Finally, using this exact RI and a much smaller RI window, <italic>TargetSearch </italic>searches again for the top masses and the apex intensities are returned.</p>
    </sec>
    <sec>
      <title>Metabolite profile</title>
      <p>The aim of <italic>TargetSearch </italic>is to return a metabolite profile that is directly interpretable with little additional manual curation. This is achieved by using many correlated masses for accurate metabolite identification and quantification. <italic>TargetSearch </italic>details the set of masses that were used for each metabolite. However, as metabolites with similar selective masses and RIs can be present in metabolite libraries it is necessary to reduce redundancy. <italic>TargetSearch </italic>does this by selecting peaks for which the RI gap is smaller than a defined cut-off and computing the Pearson correlation between them. When two or more metabolites within such a time-group are tightly correlated only the one with more correlated masses is retained. The potential ambiguity is given in the metabolite identity information. This mostly occurs with large, comprehensive libraries which contain many metabolites that elute at the same time and are thus not distinguishable with any approach, or metabolites that are not in the samples, but whose RI and selective masses match one metabolite that indeed is there. Such ambiguity is largely avoided in the case that a curated or more selective library is used.</p>
      <p>To aid objective metabolite identification a spectrum similarity score per metabolite is given in the information section. The score includes either all library masses or only the masses that correlate. The score is calculated according to [<xref ref-type="bibr" rid="B25">25</xref>]. Let <italic>I</italic><sub><italic>m </italic></sub>and <italic>J</italic><sub><italic>m </italic></sub>the intensities of mass trace <italic>m </italic>of sample spectrum and reference spectrum, respectively. Then the score <italic>S </italic>is:<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1471-2105-10-428-i1.gif"/></disp-formula></p>
      <p>where <italic>N </italic>is the total number of masses. If one mass is missing, then the intensity of that mass is zero.</p>
    </sec>
    <sec>
      <title>Output</title>
      <p>At the end, three matrices are given. One contains the so called metabolite information. This consists of metabolite names; number of correlating masses and the actual correlating mass values, the library RI, found RI and the deviation, spectra similarity score, and the number of samples in which a given metabolite was found. The other two matrices contain the normalised intensities and the RIs, where columns are samples and rows metabolites.</p>
    </sec>
    <sec>
      <title>Graphical user interface</title>
      <p>In order to facilitate the use of <italic>TargetSearch </italic>for users unfamiliar with R, we provide a simple to use graphical user interface (GUI). A screenshot can be seen in Figure <xref ref-type="fig" rid="F2">2</xref>. Many parameters that would be set by calling <italic>TargetSearch </italic>functions can be set here before running the complete analysis. After the analysis is finished, the results are stored in a set of text files that contain the matrices described in the section above. To invoke the GUI, use the R-command <italic>TargetSearchGUI()</italic>.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>TargetSearch grahical user interface</bold>. A simple GUI for <italic>TargetSearch</italic>. Here, the user can set all the parameters, import or manually edit the sample files, retention markers definition and library for and run the analysis in one go.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-428-2"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <p>In order to validate and demonstrate our method, we performed pre-processing analyses of both a standard mixture experiment and a biological example dataset. The standard mixture dataset allows the performance of <italic>TargetSearch </italic>to be objectively assessed by comparing the results against the known concentration ranges, whilst the analysis of a biological dataset and the resulting comparison to manual data curation provides an example of the performance on an actual experiment. The standard mixture experiment is described in the example in order to demonstrate the analysis workflow, whilst only the interpretation and comparison of results is presented for the biological dataset.</p>
    <sec>
      <title>Standard mixture experiment pre-processing</title>
      <p>The following section describes the analysis of the standard mixture experiment containing 27 samples using <italic>TargetSearch</italic>. It is worth noting that these samples were measured in another laboratory (RIKEN Plant Science Center, Japan), which shows that <italic>TargetSearch </italic>can work for other data and not only for data generated by our GC-MS platform. Each sample consisted of a mixture of 44 chemical standards at different proportions that were measured as described by Kusano et al. [<xref ref-type="bibr" rid="B26">26</xref>]. All chemicals used for GC-TOF/MS analysis were purchased from Wako (Tokyo, Japan) or Sigma-Aldrich (Tokyo, Japan). See Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for a detailed list of the standard proportions. The chromatograms are available for download via DROP Met at <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp">http://prime.psc.riken.jp</ext-link>. We provide a detailed R-script (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) to perform the analysis of the 27 samples. See the <italic>TargetSearch </italic>vignette or the user manual for further options not covered here.</p>
    </sec>
    <sec>
      <title>Data pre-processing example</title>
      <p>The first step in GC-MS data pre-processing is to import the chromatogram NetCDF files to <italic>TargetSearch</italic>. In order to do that, the user must provide the sample ("samples.txt") and retention index ("rimLimits.txt") markers definitions, as described in the <italic>user input </italic>subsection (see Additional files <xref ref-type="supplementary-material" rid="S3">3</xref> and <xref ref-type="supplementary-material" rid="S4">4</xref>). The following R-code shows how both definition files are imported.</p>
      <p>&gt; samples &lt;- ImportSamples("samples.txt", RIpath=".", CDFpath=".")</p>
      <p>&gt; rimLimits &lt;- ImportFameSettings("rimLimits.txt", row.names = 1)</p>
      <p>The parameters set the directories where the chromatograms are located and where the extracted peak list files will be saved. After that, the user needs to perform baseline correction and peak identification. Obviously, baseline correction is needed here because these chromatograms have not already been corrected. Otherwise this step is optional.</p>
      <p>The <italic>RIcorrect </italic>function performs both algorithms and is the most time consuming step of the whole pre-processing analysis. In this stage it is possible to specify several parameters: <italic>massRange </italic>parameter limits the mass values (<italic>m/z</italic>) that will be included in the analysis, smoothing <italic>Window </italic>parameter is the number of raw data points that will be averaged in order to remove noise, <italic>IntThreshold </italic>defines the minimum apex intensity to be listed, <italic>baseline </italic>indicates that baseline correction will be performed, and <italic>baseline.opts </italic>is a list object that contains the parameters passed to the baseline algorithm.</p>
      <p>&gt; RImatrix &lt;- RIcorrect(samples, rimLimits, massRange = c(75,550), + Window = 15, IntThreshold = 50, baseline = TRUE, baseline.opts = + list(threshold = 0.5))</p>
      <p>The function returns a matrix (<italic>RImatrix</italic>) which contains the retention times of the RI markers (rows) found in every sample (columns) and creates a peak list tab delimited file per chromatogram as described in the peak identification section.</p>
      <p>This took around 13 minutes to run on an Intel<sup>® </sup>Core™2 CPU, 2.13 GHz, 2Gb of RAM computer. It should be mentioned that performing baseline correction doubles the running time in comparison to the running time of already corrected chromatograms, so is very useful to select baseline correction when exporting the chromatograms with the vendor software.</p>
      <p>As mentioned before, an essential step is to look for RI markers outliers. This can be easily done by the function <italic>FameOutliers </italic>which creates a separate plot for each marker and reports whether or not outliers have been found (Figure <xref ref-type="fig" rid="F3">3</xref>). In this example, we did not find any outliers, but we did observe a strong so-called "day effect" when comparing the measurement day number 2 against days 3 and 4.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Retention index markers report</bold>. Retention time of the first four retention index markers in the standard mixture experiment. Samples and retention times are represented in the <italic>x </italic>and <italic>y</italic>-axis, respectively. Different days of measurement are indicated by numbers 2, 3 and 4. A so-called day effect is observed between days 2, and 3 and 4, manifested as a retention time shift.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-428-3"/>
      </fig>
      <p>outliers &lt;- FAMEoutliers(samples, RImatrix) Outliers Report:</p>
      <p>===============</p>
      <p>No outliers were found.</p>
      <p>The next step is to import the library file (Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>), which is done by the function <italic>ImportLibrary</italic>. Useful options are <italic>TopMasses</italic>, which takes the top <italic>N </italic>most intense masses from the reference spectrum to be searched for, and <italic>RI_dev </italic>sets the RI deviations. The RI deviations can be equal for all metabolites (a vector of length three), or individual ones (a matrix of three columns and as many rows as metabolites) for fine tuning, i.e., it is possible to set specific RI deviations per metabolite.</p>
      <p>&gt; lib &lt;- ImportLibrary("metabLibrary.txt", RI_dev = c(15,8,3), TopMasses = 20)</p>
      <p>The metabolite search is performed in three steps as explained in the <italic>library search </italic>subsection, where a smaller window is used in every following step. Function <italic>medianRILib </italic>searches the average RI of the selective masses and returns an updated library object. Function <italic>sampleRI </italic>searches for the selective masses in the samples using the updated average RIs and returns a matrix where each element (<italic>i, j</italic>) represents the average RI of metabolite <italic>i </italic>in sample <italic>j</italic>. Finally, function <italic>peakFind </italic>searches again for the top masses and returns the apex intensities and RIs. The three step search is performed by the following R-code.</p>
      <p>&gt; lib &lt;- medianRILib(samples, lib)</p>
      <p>&gt; corRI &lt;- sampleRI(samples, lib)</p>
      <p>&gt; peakData &lt;- peakFind(samples, lib, corRI)</p>
      <p>The object <italic>peakData </italic>object has two slots containing all apex raw intensities and RIs of all the masses that were searched for in matrix form. The apex matrix can in principle be used to perform further statistical analysis, by either using R or other statistical tools. In addition, we provide two functions, <italic>Profile </italic>and <italic>ProfileCleanUp</italic>, that create a metabolite profile out of the raw apex data.</p>
      <p>&gt; metabProfile &lt;- Profile(samples, lib, peakData)</p>
      <p>&gt; finalProfile &lt;- ProfileCleanUp(metabProfile, timeSplit = 2, r_thresh = 0.95)</p>
      <p>The first function makes the metabolite profile and the second one looks for possible ambiguities, which are controlled by the parameters <italic>timeSplit </italic>and <italic>r_thresh</italic>. They define the RI gap cut-off that is used to look for metabolites whose RI distance is less than this gap and the correlation threshold, respectively. A conceptually similar approach so-called "time groups" is implemented in the TagFider software [<xref ref-type="bibr" rid="B15">15</xref>]. A summary of the obtained metabolite profile is shown in Table <xref ref-type="table" rid="T1">1</xref> (see Additional file <xref ref-type="supplementary-material" rid="S6">6</xref> for the full profile). We could identify 43 of the 44 standards. All metabolites have at least seven correlating masses, except maltose that has only four. The similarity score (1) was over 790 for every metabolite except histidine (443), fructose-6-phosphate (661) and maltose (716). Only one ambiguous assignment was found: ribose and arabinose. This may have happened because both metabolites have very similar RIs, the same selective masses and similar spectra. One way to resolve such ambiguity can be setting smaller RI deviations and/or using different selective masses.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Summary of the standard mixture metabolite profiling.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Name</th>
              <th align="center">Mass count</th>
              <th align="center">RI</th>
              <th align="center">Score</th>
              <th align="center">RI dev</th>
              <th align="center">Sample Count</th>
              <th align="center">Corr Coef</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Glycolic acid</td>
              <td align="center">20</td>
              <td align="center">1056.8</td>
              <td align="center">977</td>
              <td align="center">6.2</td>
              <td align="center">27</td>
              <td align="center">0.874</td>
            </tr>
            <tr>
              <td align="left">Alanine</td>
              <td align="center">19</td>
              <td align="center">1090.0</td>
              <td align="center">950</td>
              <td align="center">0.7</td>
              <td align="center">27</td>
              <td align="center">0.968</td>
            </tr>
            <tr>
              <td align="left">Valine</td>
              <td align="center">20</td>
              <td align="center">1213.5</td>
              <td align="center">960</td>
              <td align="center">-4.7</td>
              <td align="center">27</td>
              <td align="center">0.982</td>
            </tr>
            <tr>
              <td align="left">Leucine</td>
              <td align="center">7</td>
              <td align="center">1267.9</td>
              <td align="center">995</td>
              <td align="center">-1.8</td>
              <td align="center">27</td>
              <td align="center">0.988</td>
            </tr>
            <tr>
              <td align="left">Isoleucine</td>
              <td align="center">7</td>
              <td align="center">1289.7</td>
              <td align="center">993</td>
              <td align="center">-1.1</td>
              <td align="center">27</td>
              <td align="center">0.990</td>
            </tr>
            <tr>
              <td align="left">Proline</td>
              <td align="center">20</td>
              <td align="center">1299.2</td>
              <td align="center">869</td>
              <td align="center">-1.2</td>
              <td align="center">27</td>
              <td align="center">0.987</td>
            </tr>
            <tr>
              <td align="left">Nicotinic acid</td>
              <td align="center">13</td>
              <td align="center">1301.5</td>
              <td align="center">959</td>
              <td align="center">-1.7</td>
              <td align="center">27</td>
              <td align="center">0.986</td>
            </tr>
            <tr>
              <td align="left">Glycine</td>
              <td align="center">15</td>
              <td align="center">1305.0</td>
              <td align="center">790</td>
              <td align="center">-0.5</td>
              <td align="center">27</td>
              <td align="center">0.976</td>
            </tr>
            <tr>
              <td align="left">Fumaric acid</td>
              <td align="center">20</td>
              <td align="center">1346.1</td>
              <td align="center">880</td>
              <td align="center">0.1</td>
              <td align="center">27</td>
              <td align="center">0.982</td>
            </tr>
            <tr>
              <td align="left">Serine</td>
              <td align="center">21</td>
              <td align="center">1353.2</td>
              <td align="center">929</td>
              <td align="center">0.1</td>
              <td align="center">27</td>
              <td align="center">0.991</td>
            </tr>
            <tr>
              <td align="left">Threonine</td>
              <td align="center">21</td>
              <td align="center">1380.1</td>
              <td align="center">917</td>
              <td align="center">-0.6</td>
              <td align="center">27</td>
              <td align="center">0.997</td>
            </tr>
            <tr>
              <td align="left">Glutaric acid</td>
              <td align="center">20</td>
              <td align="center">1402.7</td>
              <td align="center">961</td>
              <td align="center">-1.7</td>
              <td align="center">27</td>
              <td align="center">0.947</td>
            </tr>
            <tr>
              <td align="left">Alanine, beta-</td>
              <td align="center">21</td>
              <td align="center">1429.8</td>
              <td align="center">929</td>
              <td align="center">-5.0</td>
              <td align="center">27</td>
              <td align="center">0.994</td>
            </tr>
            <tr>
              <td align="left">Homoserine</td>
              <td align="center">20</td>
              <td align="center">1443.7</td>
              <td align="center">949</td>
              <td align="center">-1.5</td>
              <td align="center">27</td>
              <td align="center">0.820</td>
            </tr>
            <tr>
              <td align="left">Aspartic acid</td>
              <td align="center">20</td>
              <td align="center">1510.0</td>
              <td align="center">915</td>
              <td align="center">-0.2</td>
              <td align="center">27</td>
              <td align="center">0.983</td>
            </tr>
            <tr>
              <td align="left">Methionine</td>
              <td align="center">20</td>
              <td align="center">1519.2</td>
              <td align="center">922</td>
              <td align="center">-4.7</td>
              <td align="center">27</td>
              <td align="center">0.985</td>
            </tr>
            <tr>
              <td align="left">Butyric acid, 4-amino-</td>
              <td align="center">19</td>
              <td align="center">1530.0</td>
              <td align="center">967</td>
              <td align="center">-3.5</td>
              <td align="center">27</td>
              <td align="center">0.950</td>
            </tr>
            <tr>
              <td align="left">Glutaric acid, 2-oxo-</td>
              <td align="center">19</td>
              <td align="center">1567.0</td>
              <td align="center">955</td>
              <td align="center">1.2</td>
              <td align="center">27</td>
              <td align="center">0.951</td>
            </tr>
            <tr>
              <td align="left">Phenylalanine</td>
              <td align="center">21</td>
              <td align="center">1635.3</td>
              <td align="center">936</td>
              <td align="center">-6.0</td>
              <td align="center">27</td>
              <td align="center">0.982</td>
            </tr>
            <tr>
              <td align="left">Ribose | Arabinose</td>
              <td align="center">20 | 20</td>
              <td align="center">1662.7 | 1662.7</td>
              <td align="center">915 | 942</td>
              <td align="center">4.2 | -4.7</td>
              <td align="center">27</td>
              <td align="center">0.829</td>
            </tr>
            <tr>
              <td align="left">Suberic acid</td>
              <td align="center">20</td>
              <td align="center">1695.0</td>
              <td align="center">867</td>
              <td align="center">-0.3</td>
              <td align="center">27</td>
              <td align="center">0.985</td>
            </tr>
            <tr>
              <td align="left">Aconitic acid</td>
              <td align="center">19</td>
              <td align="center">1736.9</td>
              <td align="center">977</td>
              <td align="center">3.6</td>
              <td align="center">27</td>
              <td align="center">0.919</td>
            </tr>
            <tr>
              <td align="left">Shikimic acid</td>
              <td align="center">15</td>
              <td align="center">1791.4</td>
              <td align="center">975</td>
              <td align="center">1.1</td>
              <td align="center">27</td>
              <td align="center">0.986</td>
            </tr>
            <tr>
              <td align="left">Citric acid</td>
              <td align="center">17</td>
              <td align="center">1806.1</td>
              <td align="center">920</td>
              <td align="center">-1.6</td>
              <td align="center">27</td>
              <td align="center">0.948</td>
            </tr>
            <tr>
              <td align="left">Isocitric acid</td>
              <td align="center">9</td>
              <td align="center">1804.6</td>
              <td align="center">909</td>
              <td align="center">0.0</td>
              <td align="center">27</td>
              <td align="center">0.828</td>
            </tr>
            <tr>
              <td align="left">Arginine</td>
              <td align="center">16</td>
              <td align="center">1817.8</td>
              <td align="center">826</td>
              <td align="center">-3.4</td>
              <td align="center">27</td>
              <td align="center">0.993</td>
            </tr>
            <tr>
              <td align="left">Quinic acid</td>
              <td align="center">14</td>
              <td align="center">1845.0</td>
              <td align="center">882</td>
              <td align="center">-1.8</td>
              <td align="center">27</td>
              <td align="center">0.896</td>
            </tr>
            <tr>
              <td align="left">Fructose</td>
              <td align="center">22</td>
              <td align="center">1854.3</td>
              <td align="center">922</td>
              <td align="center">1.9</td>
              <td align="center">27</td>
              <td align="center">0.867</td>
            </tr>
            <tr>
              <td align="left">Mannose</td>
              <td align="center">21</td>
              <td align="center">1869.1</td>
              <td align="center">908</td>
              <td align="center">-0.1</td>
              <td align="center">27</td>
              <td align="center">0.689</td>
            </tr>
            <tr>
              <td align="left">Lysine</td>
              <td align="center">20</td>
              <td align="center">1912.0</td>
              <td align="center">856</td>
              <td align="center">0.3</td>
              <td align="center">27</td>
              <td align="center">0.993</td>
            </tr>
            <tr>
              <td align="left">Histidine</td>
              <td align="center">17</td>
              <td align="center">1914.1</td>
              <td align="center">443</td>
              <td align="center">-2.5</td>
              <td align="center">27</td>
              <td align="center">0.983</td>
            </tr>
            <tr>
              <td align="left">Galacturonic acid</td>
              <td align="center">22</td>
              <td align="center">1926.8</td>
              <td align="center">948</td>
              <td align="center">0.7</td>
              <td align="center">27</td>
              <td align="center">0.783</td>
            </tr>
            <tr>
              <td align="left">Tyrosine</td>
              <td align="center">21</td>
              <td align="center">1934.0</td>
              <td align="center">955</td>
              <td align="center">-1.4</td>
              <td align="center">27</td>
              <td align="center">0.988</td>
            </tr>
            <tr>
              <td align="left">Sinapic acid</td>
              <td align="center">20</td>
              <td align="center">2056.1</td>
              <td align="center">962</td>
              <td align="center">-2.4</td>
              <td align="center">27</td>
              <td align="center">0.868</td>
            </tr>
            <tr>
              <td align="left">Inositol, myo-</td>
              <td align="center">21</td>
              <td align="center">2085.0</td>
              <td align="center">911</td>
              <td align="center">-1.2</td>
              <td align="center">27</td>
              <td align="center">0.959</td>
            </tr>
            <tr>
              <td align="left">Caffeic acid</td>
              <td align="center">21</td>
              <td align="center">2133.0</td>
              <td align="center">957</td>
              <td align="center">0.2</td>
              <td align="center">27</td>
              <td align="center">0.913</td>
            </tr>
            <tr>
              <td align="left">Phytol</td>
              <td align="center">21</td>
              <td align="center">2169.7</td>
              <td align="center">954</td>
              <td align="center">-0.6</td>
              <td align="center">27</td>
              <td align="center">0.745</td>
            </tr>
            <tr>
              <td align="left">Tryptamine</td>
              <td align="center">19</td>
              <td align="center">2244.2</td>
              <td align="center">864</td>
              <td align="center">-14.8</td>
              <td align="center">27</td>
              <td align="center">0.838</td>
            </tr>
            <tr>
              <td align="left">Fructose-6-phosphate</td>
              <td align="center">12</td>
              <td align="center">2286.3</td>
              <td align="center">661</td>
              <td align="center">6.5</td>
              <td align="center">27</td>
              <td align="center">0.738</td>
            </tr>
            <tr>
              <td align="left">Cystine</td>
              <td align="center">13</td>
              <td align="center">2290.0</td>
              <td align="center">860</td>
              <td align="center">0.6</td>
              <td align="center">27</td>
              <td align="center">0.971</td>
            </tr>
            <tr>
              <td align="left">Glucose-6-phosphate</td>
              <td align="center">21</td>
              <td align="center">2301.9</td>
              <td align="center">958</td>
              <td align="center">5.2</td>
              <td align="center">27</td>
              <td align="center">0.866</td>
            </tr>
            <tr>
              <td align="left">Maltose</td>
              <td align="center">4</td>
              <td align="center">2723.7</td>
              <td align="center">716</td>
              <td align="center">3.4</td>
              <td align="center">27</td>
              <td align="center">0.741</td>
            </tr>
            <tr>
              <td align="left">Trehalose</td>
              <td align="center">16</td>
              <td align="center">2729.8</td>
              <td align="center">853</td>
              <td align="center">0.3</td>
              <td align="center">27</td>
              <td align="center">0.949</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The summarised metabolite profile of the chemical standards (see Additional file <xref ref-type="supplementary-material" rid="S6">6</xref> for full information). Name: metabolite name; Mass count: the number of correlating masses; RI: averaged RI; Score: spectrum similarity according to (1); RI dev; RI deviation from the expected RI; Sample Count: the number of samples in which the metabolite was found; Corr Coef: the correlation coefficient between metabolite input concentration and abundance estimation.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Since the chemical standards were measured using different proportions (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), we examined the correlation between the abundance estimation with the input concentration in order to further confirm the <italic>TargetSearch </italic>results. There is a clear correlation for all the metabolites (Table <xref ref-type="table" rid="T1">1</xref>, Additional file <xref ref-type="supplementary-material" rid="S7">7</xref>). Most of the metabolites (29) had a correlation coefficient greater than 0.9 and the lowest coefficient was 0.69. Here we showed that with little effort we can perform a metabolite analysis that can be used with little manual curation needed (only 4 of 44 has to be manually checked).</p>
    </sec>
  </sec>
  <sec>
    <title>Visualisation</title>
    <p>After GC-MS pre-processing, the user can visually compare the averaged metabolite spectra with the reference spectra. Our software include two functions to do so. <italic>plotSpectra </italic>and <italic>plotAllSpectra</italic>. They plot a spectra contrast between averaged metabolite spectra, obtained by computing the median intensity of every mass across the samples, and reference spectra for a given metabolite (Figure <xref ref-type="fig" rid="F4">4</xref>). This allows the user to quickly validate the results by visually inspecting the contrasted spectra. In addition, the metabolite spectra can also be exported as a MSP format file (function <italic>writeMSP</italic>), which can be imported into NIST for further comparisons against other metabolite libraries.</p>
    <fig id="F4" position="float">
      <label>Figure 4</label>
      <caption>
        <p><bold>Comparison between identified metabolite spectra and reference spectra</bold>. Comparison example between the averaged (blue) and reference spectra (red) of glycolic acid (right) and histidine (left). This type of comparisons can be used to assess the quality of individual identified peaks. In this example, histidine may need a closer inspection to elucidate what causes the difference.</p>
      </caption>
      <graphic xlink:href="1471-2105-10-428-4"/>
    </fig>
    <p>We additionally provide a function to visualise chromatographic peaks in a given sample, which may also help to identify metabolites. See the <italic>TargetSearch </italic>vignette for examples.</p>
    <sec>
      <title>Biological dataset pre-processing</title>
      <p>The biological dataset consisted of wild-type Col-0 <italic>Arabidopsis thaliana </italic>seedling samples. Three week old seedlings, grown on solid MS medium with 1% sucrose, were kept for 4h under either continuous light or darkness. Metabolites were extracted from pools of seedlings in a total of four biological replicates. Extraction and derivatisation of metabolites from leaves using GC-MS were performed as outlined by Lisec et al. [<xref ref-type="bibr" rid="B24">24</xref>]. GC-MS data were obtained using an Agilent 7683 series autosampler (Agilent Technologies GmbH, Waldbronn, Germany), coupled to an Agilent 6890 gas chromatograph - Leco Pegasus 2 time-of-flight mass spectrometer (LECO, St. Joseph, MI, USA). Identical chromatogram acquisition parameters were used as those previously described by Weckwerth et al. [<xref ref-type="bibr" rid="B27">27</xref>].</p>
      <p>A similar pre-processing analysis as the one described for the standard mixture dataset was performed. We used a fatty acid methyl esters (FAMEs) as RI marker standards (Additional file <xref ref-type="supplementary-material" rid="S8">8</xref>) and an in-house reference library composed of 153 metabolites (Additional file <xref ref-type="supplementary-material" rid="S9">9</xref>). This library was manually curated and in addition to known metabolites includes several unknown metabolites that have been observed in previous experiments.</p>
      <p>After running <italic>TargetSearch</italic>, we manually compared the final profile with the deconvoluted peak profiles obtained with LECO (see Additional file <xref ref-type="supplementary-material" rid="S10">10</xref> for full profile with manual annotations). The profile list contained 138 entries in total, of which 131 metabolites were unambiguously assigned. The 7 ambiguous assignments corresponded to 14 metabolites (2 metabolites per entry). The remaining 8 metabolites (of the 153) were neither present in the final profile nor in the chromatograms as confirmed by manual inspection. Based on our previous experience, we routinely only consider metabolites to be present if at least 3 correlating masses at the correct RI are identified (this excludes the duplicate isotope pairs that are often observed to correlate). Taking this into account, we would consider 101 metabolites to be identified in this experiment. We thus checked these manually and found that 96 were correctly assigned (these were all assigned a similarity score above 600), 1 ambiguity was wrongly resolved, i.e., the correct metabolite was not the one suggested; 1 ambiguity could not be resolved manually, due to similar RIs and reference spectra; 1 metabolite was not found in the chromatograms; and 2 metabolites were not found but 2 peaks (unknowns) were found at their expected retention time. The later could be anticipated in the profile since the similarity score reported by <italic>TargetSearch </italic>was below 400.</p>
      <p>Although we would not routinely work with the remaining 37 entries (38 metabolites in total) that did not meet our correlating masses minimum, we additionally manually inspected these. Their classification was as follows: 31 metabolites, including 1 ambiguity, were not found in the chromatograms; 5 metabolites were only found in a few of the chromatograms at low abundance and 2 metabolites were present but overloaded. In summary, 96 of 101 metabolites found by <italic>TargetSearch </italic>were correctly assigned. Similarly, 31 of 38 metabolites that we considered to have too few correlating masses to be present were manually confirmed not to be present in the chromatograms. Just 5 metabolites were found by our software but could not be confirmed to sufficient confidence by manual curation, whilst 7 metabolites were not reported by <italic>TargetSearch </italic>but were present in the chromatograms. This gives over 91% of assignment accuracy, counting the true positives and true negatives ratio. The results are illustrated in Figure <xref ref-type="fig" rid="F5">5</xref>.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Comparison between identified metabolites by TargetSearch and manual curation</bold>. The venn diagrams show the number of metabolites considered to be either present or not present by <italic>TargetSearch </italic>in comparison to the manual curation. Left hand side: 96 metabolites identified by <italic>TargetSearch </italic>that were confirmed by manual curation. Right hand side: 31 metabolites not identified by <italic>TargetSearch </italic>and confirmed by manual curation. Both diagrams: 5 metabolites found by our software but not confirmed by manual curation, whilst 7 metabolites were not reported by <italic>TargetSearch </italic>but were present in the chromatograms.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-428-5"/>
      </fig>
      <p>Based on this example analysis and our experience with several other biological datasets, errors can be made by <italic>TargetSearch </italic>in the following cases: metabolites with similar selective masses and spectra that elute at similar retention times; low abundant metabolites may cause spurious correlations, whilst overloaded peaks often elude the peak detection algorithm or disrupt correlation; finally, metabolites not present in the library that elute in the place where another metabolite is expected, as occurred in two cases in this analysis.</p>
      <p>Many of these issues can be solved by changing the parameter definitions and in general the resulting dataset is more objectively linked to these parameters than the decisions involved in a typical manual curation. Metabolite identification issues for example can be solved by increasing the intensity threshold during the peak detection stage, or by changing the correlation cut-off. We also note that most of these errors are inherent to metabolite profiling <italic>per se </italic>rather than being specific to our software and are thus also addressed by other technical aspects of the experiment (e.g. saturation/sample overloading or low-abundance).</p>
    </sec>
    <sec>
      <title>Performance</title>
      <p>We developed this package with the intention to process as many chromatograms as possible in a single run and to be fast. To asses performance, we compared the processing speed of <italic>TargetSearch </italic>with other GC-MS pre-processing software: XCMS and Tagfinder. First, we wanted to see what was the maximum number of chromatograms that can be processed by said tools. <italic>TargetSearch </italic>could process our largest experiment - 1025 baseline corrected chromatograms (Caldana et al., unpublished), taking around 6 hours to get a final data matrix (Intel<sup>® </sup>Core™2 CPU, 2.13 GHz, 2Gb of RAM). However, neither XCMS nor Tagfinder were able to process anywhere near that number of chromatograms with the same computer. We then reduced the number of chromatograms to 200 so we could compare the processing times. <italic>TargetSearch </italic>proved to be much faster than XCMS and Tagfinder. Results are summarised in Table <xref ref-type="table" rid="T2">2</xref>.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Performance comparison of pre-processing analysis using Tagfinder, XCMS and TargetSearch.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="right">Tagfinder</th>
              <th align="right">XCMS</th>
              <th align="right">TargetSearch</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">
                <bold>Maximum number of samples</bold>
              </td>
              <td align="right">
                <bold>70</bold>
              </td>
              <td align="right">
                <bold>645</bold>
              </td>
              <td align="right">
                <bold><italic>&gt; </italic>1025</bold>
              </td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left"><italic>Pre-processing step</italic>:</td>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">Peak extraction</td>
              <td align="right">3442</td>
              <td align="right">3634</td>
              <td align="right">2779</td>
            </tr>
            <tr>
              <td align="left">Peak import</td>
              <td align="right">271</td>
              <td align="right">-</td>
              <td align="right">-</td>
            </tr>
            <tr>
              <td align="left">RI correction</td>
              <td align="right">255</td>
              <td align="right">29</td>
              <td align="right">-</td>
            </tr>
            <tr>
              <td align="left">Profile building</td>
              <td align="right">3050</td>
              <td align="right">1740</td>
              <td align="right">195</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Total time</bold>
              </td>
              <td align="right">
                <bold>7018</bold>
              </td>
              <td align="right">
                <bold>5403</bold>
              </td>
              <td align="right">
                <bold>2974</bold>
              </td>
            </tr>
            <tr>
              <td align="left">
                <bold>Total time per sample</bold>
              </td>
              <td align="right">
                <bold>35.1</bold>
              </td>
              <td align="right">
                <bold>27.0</bold>
              </td>
              <td align="right">
                <bold>14.9</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>All parameters were set to default in order to obtain the maximum number of samples, but only 1025 samples were available. Times were compared using 200 samples. Before running this analysis, Tagfinder intensity threshold was set to 200 to allow the 200 samples to be imported. Time is expressed in seconds. Peak import is not necessary in XCMS and <italic>TargetSearch</italic>. RI correction is performed together with Peak extraction in <italic>TargetSearch</italic>.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Here we presented the <italic>TargetSearch </italic>software for the data pre-processing of GC-MS based metabolite profiling experiments. Our method includes a novel strategy to iteratively correct and update retention times and uses efficient criteria for searching and identifying metabolites. This massively reduces the time from data acquisition to biological interpretation, particularly as good quality data can be directly obtained with limited need for manual curation. Another advantage over other software, is the ability to analyse virtually any number of samples, at least over 1000, which otherwise is a major limitation of existing software, whilst maintaining a fast processing speed. We also provide a GUI intended to assist users not familiar with R. Using a dilution mixture dataset we found that <italic>TargetSearch </italic>accurately identified the chemical components and reported abundance estimates which very well reproduced the input concentrations. Using a real biological experiment, the accuracy in terms of automated profiling was over 90%. These results show that <italic>TargetSearch </italic>greatly facilitates the analysis of metabolic profiling data and creates substantial time savings allowing scientists to focus more on the biology under investigation.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Project name: TargetSearch</p>
    <p>Project homepage: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.5/bioc/html/TargetSearch.html">http://bioconductor.org/packages/2.5/bioc/html/TargetSearch.html</ext-link></p>
    <p>Operating System: Platform independent</p>
    <p>Programming language: R, C</p>
    <p>Other requirements: R <italic>&gt; </italic>= 2.7</p>
    <p>License: GPL version 2 or newer</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>GC-MS: Gas Chromatography-Mass Spectrometry; MST: Mass Spectra Tag; RT: Retention Time; RI: Retention time Index; GUI: Graphical User Interface.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MAH initiated and supervised the project and developed an initial method with HR. ACI improved and developed the majority of the method and the R package. CC tested and contributed to the method. JL contributed R scripts and developed the graphic user interface. MK performed GC-MS analysis. LW discussed and supervised the project. ACI drafted the manuscript, with additions from all authors. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>standard compounds</bold>. The list of standard compounds. Additional columns indicate the concentration in <italic>μ</italic>g/<italic>μ</italic>L that was used in every mixture.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S1.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>TargetSearch example R-script</bold>. R-script used in this manuscript to process the standard mixture samples.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S2.R" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Sample file</bold>. The sample description file needed as input for <italic>TargetSearch</italic>. It contains the list of NetCDF files, the measurement day and the mixture used.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S3.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Retention index marker limits</bold>. The Retention index marker file needed as input for <italic>TargetSearch</italic>. Columns represent the standard name, lower and upper limits, RI, and mass.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S4.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Reference metabolite library</bold>. The reference library which contains the information on the standards that were searched for in the chromatograms.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S5.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>Metabolite profile</bold>. The metabolite profile information as given by <italic>TargetSearch</italic>. It contains the metabolite names, number of correlating masses, the mass values, the library RI, the found RI, RI deviation and spectra score.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S6.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>Metabolite concentration correlation</bold>. Correlation between the input standard concentration and the obtained metabolite abundance. Every boxplot corresponds to one metabolite as indicated in the plot title. Boxes represent mixtures, mixture concentrations are shown above the box, the <italic>y</italic>-axis is the relative abundance, the expected abundances are indicated by horizontal dashed lines, and the correlation coefficient is displayed at the bottom of the graph.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S7.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S8">
      <caption>
        <title>Additional file 8</title>
        <p><bold>Retention index marker limits (biological dataset)</bold>. The Retention index marker file needed as input for <italic>TargetSearch </italic>(Biological Dataset). Columns represent the standard name, lower and upper limits and RI.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S8.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S9">
      <caption>
        <title>Additional file 9</title>
        <p><bold>Reference metabolite library (biological dataset)</bold>. The reference library which contains the information on the standards that were searched for in the biological dataset chromatograms.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S9.TXT" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S10">
      <caption>
        <title>Additional file 10</title>
        <p><bold>Biological dataset profile</bold>. The metabolite profile information as given by <italic>TargetSearch</italic>. It contains the metabolite names, number of correlating masses, the mass values, the library RI, the found RI, RI deviation and spectra score. The first column contains the annotations after manual curation.</p>
      </caption>
      <media xlink:href="1471-2105-10-428-S10.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors acknowledge Aenne Eckhardt, Gudrun Wolter and Anjte Boltze for running samples. Alexander Erban, Alexander Luedemann and Joachim Kopka for useful discussion. Thomas Degenkolbe, Szymon Jozefczuck and Gareth Catchpole for commenting on the method. ACI acknowledges MECESUP. Makoto Kobayashi is thanked for GC-MS measurements. Funding was provided by Max Planck Society, Max Planck Institute for Molecular Plant Physiology. MAH was supported by FP6 "AGRON-OMICS" (contract LSHG-CT-2006-037704).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sauter</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lauer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Fritsch</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Metabolic profiling of plants - a new diagnostic-technique</article-title>
        <source>Acs Symposium Series</source>
        <year>1991</year>
        <volume>443</volume>
        <fpage>288</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1021/bk-1991-0443.ch024</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lindon</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Bollard</surname>
          <given-names>ME</given-names>
        </name>
        <name>
          <surname>Stanley</surname>
          <given-names>EG</given-names>
        </name>
        <name>
          <surname>Nicholson</surname>
          <given-names>JK</given-names>
        </name>
        <article-title>Metabonomics technologies and their applications in physiological monitoring, drug safety assessment and disease diagnosis</article-title>
        <source>Biomarkers</source>
        <year>2004</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1080/13547500410001668379</pub-id>
        <pub-id pub-id-type="pmid">15204308</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Claudino</surname>
          <given-names>WM</given-names>
        </name>
        <name>
          <surname>Quattrone</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Biganzoli</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Pestrin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bertini</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Leo</surname>
          <given-names>AD</given-names>
        </name>
        <article-title>Metabolomics: Available results, current research projects in breast cancer, and future applications</article-title>
        <source>J Clinical Oncology</source>
        <year>2007</year>
        <volume>25</volume>
        <issue>19</issue>
        <fpage>2840</fpage>
        <lpage>2846</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2006.09.7550</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bino</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Hall</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Fiehn</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Kopka</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Saito</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Draper</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Nikolau</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Mendes</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Roessner-Tunali</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Beale</surname>
          <given-names>MH</given-names>
        </name>
        <name>
          <surname>Trethewey</surname>
          <given-names>RN</given-names>
        </name>
        <name>
          <surname>Lange</surname>
          <given-names>BM</given-names>
        </name>
        <name>
          <surname>Wurtele</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Sumner</surname>
          <given-names>LW</given-names>
        </name>
        <article-title>Potential of metabolomics as a functional genomics tool</article-title>
        <source>Trends In Plant Science</source>
        <year>2004</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>418</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tplants.2004.07.004</pub-id>
        <pub-id pub-id-type="pmid">15337491</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nicholson</surname>
          <given-names>JK</given-names>
        </name>
        <name>
          <surname>Lindon</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>E</given-names>
        </name>
        <article-title>'Metabonomics': understanding the metabolic responses of living systems to pathophysiological stimuli via multivariate statistical analysis of biological NMR spectroscopic data</article-title>
        <source>Xenobiotica</source>
        <year>1999</year>
        <volume>29</volume>
        <issue>11</issue>
        <fpage>1181</fpage>
        <lpage>1189</lpage>
        <pub-id pub-id-type="doi">10.1080/004982599238047</pub-id>
        <pub-id pub-id-type="pmid">10598751</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stephanopoulos</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Alper</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Moxley</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Exploiting biological complexity for strain improvement through systems biology</article-title>
        <source>Nature Biotechnology</source>
        <year>2004</year>
        <volume>22</volume>
        <issue>10</issue>
        <fpage>1261</fpage>
        <lpage>1267</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1016</pub-id>
        <pub-id pub-id-type="pmid">15470466</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fernie</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Trethewey</surname>
          <given-names>RN</given-names>
        </name>
        <name>
          <surname>Krotzky</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Willmitzer</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Innovation - Metabolite profiling: from diagnostics to systems biology</article-title>
        <source>Nature Rev Mol Cell Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>9</issue>
        <fpage>763</fpage>
        <lpage>769</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm1451</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fiehn</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Kopka</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Trethewey</surname>
          <given-names>RN</given-names>
        </name>
        <name>
          <surname>Willmitzer</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Identification of uncommon plant metabolites based on calculation of elemental compositions using gas chromatography and quadrupole mass spectrometry</article-title>
        <source>Analytical Chem</source>
        <year>2000</year>
        <volume>72</volume>
        <issue>15</issue>
        <fpage>3573</fpage>
        <lpage>3580</lpage>
        <pub-id pub-id-type="doi">10.1021/ac991142i</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gullberg</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Jonsson</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Nordstrom</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Sjostrom</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Moritz</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Design of experiments: an efficient strategy to identify factors influencing extraction and derivatization of Arabidopsis thaliana samples in metabolomic studies with gas chromatography/mass spectrometry</article-title>
        <source>Analytical Biochem</source>
        <year>2004</year>
        <volume>331</volume>
        <issue>2</issue>
        <fpage>283</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ab.2004.04.037</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="book">
        <name>
          <surname>Fancy</surname>
          <given-names>SA</given-names>
        </name>
        <name>
          <surname>Rumpel</surname>
          <given-names>K</given-names>
        </name>
        <person-group person-group-type="editor">Wang F</person-group>
        <article-title>GC-MS-Based Metabolomics</article-title>
        <source>Biomarker Methods in Drug Discovery and Development, Methods in Pharmacology and Toxicology</source>
        <year>2008</year>
        <publisher-name>Humana Press</publisher-name>
        <fpage>317</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-59745-463-6</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="other">
        <article-title>AMDIS Overview</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://chemdata.nist.gov/mass-spc/amdis/">http://chemdata.nist.gov/mass-spc/amdis/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="other">
        <article-title>Leco ChromaTOF, St. Joseph, MI, USA</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.leco.com.">http://www.leco.com.</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lommen</surname>
          <given-names>A</given-names>
        </name>
        <article-title>MetAlign: interface-driven, versatile metabolomics tool for hyphenated full-scan mass spectrometry data preprocessing</article-title>
        <source>Anal Chem</source>
        <year>2009</year>
        <volume>81</volume>
        <issue>8</issue>
        <fpage>3079</fpage>
        <lpage>3086</lpage>
        <pub-id pub-id-type="doi">10.1021/ac900036d</pub-id>
        <pub-id pub-id-type="pmid">19301908</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smith</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Want</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>O'Maille</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abagyan</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Siuzdak</surname>
          <given-names>G</given-names>
        </name>
        <article-title>XCMS: Processing mass spectrometry data for metabolite profiling using Nonlinear peak alignment, matching, and identification</article-title>
        <source>Analytical Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <issue>3</issue>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Luedemann</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Strassburg</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Erban</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kopka</surname>
          <given-names>J</given-names>
        </name>
        <article-title>TagFinder for the quantitative analysis of gas chromatography - mass spectrometry (GC-MS)-based metabolite profiling experiments</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>732</fpage>
        <lpage>737</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn023</pub-id>
        <pub-id pub-id-type="pmid">18204057</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kopka</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Schauer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Krueger</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Birkemeyer</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Usadel</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Bergmuller</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Dormann</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Weckwerth</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Gibon</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Stitt</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Willmitzer</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fernie</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Steinhauser</surname>
          <given-names>D</given-names>
        </name>
        <article-title>GMD@CSB.DB: the Golm Metabolome Database</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>8</issue>
        <fpage>1635</fpage>
        <lpage>1638</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti236</pub-id>
        <pub-id pub-id-type="pmid">15613389</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tikunov</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Lommen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>de Vos</surname>
          <given-names>CHR</given-names>
        </name>
        <name>
          <surname>Verhoeven</surname>
          <given-names>HA</given-names>
        </name>
        <name>
          <surname>Bino</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Hall</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Bovy</surname>
          <given-names>AG</given-names>
        </name>
        <article-title>A novel approach for nontargeted data analysis for metabolomics. Large-scale profiling of tomato fruit volatiles</article-title>
        <source>Plant Physiol</source>
        <year>2005</year>
        <volume>139</volume>
        <issue>3</issue>
        <fpage>1125</fpage>
        <lpage>1137</lpage>
        <pub-id pub-id-type="doi">10.1104/pp.105.068130</pub-id>
        <pub-id pub-id-type="pmid">16286451</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gentleman</surname>
          <given-names>RC</given-names>
        </name>
        <name>
          <surname>Carey</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Bates</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Bolstad</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Dettling</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dudoit</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ellis</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Gautier</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ge</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Gentry</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hornik</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Hothorn</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Iacus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Leisch</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Maechler</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rossini</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Sawitzki</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Tierney</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>JYH</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Bioconductor: Open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biology</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="other">
        <article-title>National Institute of Standards and Technology, Gaithersburg, MD, USA</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.nist.gov/srd/nist1a.htm">http://www.nist.gov/srd/nist1a.htm</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schauer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Steinhauser</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Strelkov</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Schomburg</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Allison</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Moritz</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lundgren</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Roessner-Tunali</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Forbes</surname>
          <given-names>MG</given-names>
        </name>
        <name>
          <surname>Willmitzer</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fernie</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Kopka</surname>
          <given-names>J</given-names>
        </name>
        <article-title>GC-MS libraries for the rapid identification of metabolites in complex biological samples</article-title>
        <source>Febs Lett</source>
        <year>2005</year>
        <volume>579</volume>
        <issue>6</issue>
        <fpage>1332</fpage>
        <lpage>1337</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2005.01.029</pub-id>
        <pub-id pub-id-type="pmid">15733837</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="other">
        <article-title>NIST/EPA/NIH Mass Spectral Library 2008</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470425172.html">http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470425172.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chang</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Banack</surname>
          <given-names>CD</given-names>
        </name>
        <name>
          <surname>Shah</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Robust baseline correction algorithm for signal dense NMR spectra</article-title>
        <source>J Magn Reson</source>
        <year>2007</year>
        <volume>187</volume>
        <issue>2</issue>
        <fpage>288</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmr.2007.05.008</pub-id>
        <pub-id pub-id-type="pmid">17562374</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dool</surname>
          <given-names>H Van den</given-names>
        </name>
        <name>
          <surname>Kratz</surname>
          <given-names>PD</given-names>
        </name>
        <article-title>A generalization of retention index system including linear temperature programmed gas-liquid partition chromatography</article-title>
        <source>J Chromatography</source>
        <year>1963</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>463</fpage>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(01)80947-X</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lisec</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Schauer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Kopka</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Willmitzer</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fernie</surname>
          <given-names>AR</given-names>
        </name>
        <article-title>Gas chromatography mass spectrometry-based metabolite profiling in plants</article-title>
        <source>Nature Protocols</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>387</fpage>
        <lpage>396</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2006.59</pub-id>
        <pub-id pub-id-type="pmid">17406261</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gan</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>JH</given-names>
        </name>
        <name>
          <surname>Liang</surname>
          <given-names>YZ</given-names>
        </name>
        <article-title>Library search of mass spectra with a new matching algorithm based on substructure similarity</article-title>
        <source>Analytical Sciences</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>5</issue>
        <fpage>635</fpage>
        <lpage>638</lpage>
        <pub-id pub-id-type="doi">10.2116/analsci.17.635</pub-id>
        <pub-id pub-id-type="pmid">11708145</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kusano</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Fukushima</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Arita</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jonsson</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Moritz</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Kobayashi</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hayashi</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Tohge</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Saito</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Unbiased characterization of genotype-dependent metabolic regulations by metabolomic approach in Arabidopsis thaliana</article-title>
        <source>BMC Syst Biol</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>53</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-1-53</pub-id>
        <pub-id pub-id-type="pmid">18028551</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Weckwerth</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wenzel</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fiehn</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Process for the integrated extraction, identification and quantification of metabolites, proteins and RNA to reveal their co-regulation in biochemical networks</article-title>
        <source>Proteomics</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>78</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.200200500</pub-id>
        <pub-id pub-id-type="pmid">14730673</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
