<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9563678</article-id>
    <article-id pub-id-type="pmid">36005887</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac582</article-id>
    <article-id pub-id-type="publisher-id">btac582</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">propeller:</italic> testing for differences in cell type proportions in single cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1711-7454</contrib-id>
        <name>
          <surname>Phipson</surname>
          <given-names>Belinda</given-names>
        </name>
        <!--phipson.b@wehi.edu.au-->
        <aff><institution>Bioinformatics Division, Walter and Eliza Hall Institute of Medical Research</institution>, Melbourne, VIC 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Pediatrics, University of Melbourne</institution>, Melbourne, VIC 3010, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, University of Melbourne</institution>, Melbourne, VIC 3010, <country country="AU">Australia</country></aff>
        <xref rid="btac582-cor1" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sim</surname>
          <given-names>Choon Boon</given-names>
        </name>
        <aff><institution>Heart Regeneration Group, Murdoch Children’s Research Institute, Royal Children’s Hospital</institution>, Melbourne, VIC 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Melbourne Centre for Cardiovascular Genomics and Regenerative Medicine, The Royal Children's Hospital</institution>, Melbourne, VIC 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Porrello</surname>
          <given-names>Enzo R</given-names>
        </name>
        <aff><institution>Heart Regeneration Group, Murdoch Children’s Research Institute, Royal Children’s Hospital</institution>, Melbourne, VIC 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Melbourne Centre for Cardiovascular Genomics and Regenerative Medicine, The Royal Children's Hospital</institution>, Melbourne, VIC 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Anatomy and Physiology, School of Biomedical Sciences, The University of Melbourne</institution>, Melbourne, VIC 3010, <country country="AU">Australia</country></aff>
        <aff><institution>Novo Nordisk Foundation Center for Stem Cell Medicine, Murdoch Children’s Research Institute, Royal Children’s Hospital</institution>, Melbourne, VIC 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hewitt</surname>
          <given-names>Alex W</given-names>
        </name>
        <aff><institution>Menzies Institute for Medical Research, School of Medicine, University of Tasmania</institution>, Hobart, TAS, <country country="AU">Australia</country></aff>
        <aff><institution>Centre for Eye Research Australia, The University of Melbourne</institution>, Melbourne, VIC, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5070-4124</contrib-id>
        <name>
          <surname>Powell</surname>
          <given-names>Joseph</given-names>
        </name>
        <aff><institution>Garvan-Weizmann Centre for Cellular Genomics, Garvan Institute of Medical Research</institution>, Darlinghurst, NSW 2010, <country country="AU">Australia</country></aff>
        <aff><institution>UNSW Cellular Genomics Futures Institute, University of New Souith Wales</institution>, Kingston, NSW 2052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Oshlack</surname>
          <given-names>Alicia</given-names>
        </name>
        <!--alicia.oshlack@petermac.org-->
        <aff><institution>Bioinformatics and Computational Biology, Peter MacCallum Cancer Centre</institution>, Melbourne, VIC 3000, <country country="AU">Australia</country></aff>
        <aff><institution>Sir Peter MacCallum Department of Oncology, University of Melbourne</institution>, Melbourne, VIC 3010, <country country="AU">Australia</country></aff>
        <aff><institution>School of Biosciences, University of Melbourne</institution>, Melbourne, VIC 3010, <country country="AU">Australia</country></aff>
        <xref rid="btac582-cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac582-cor1">To whom correspondence should be addressed. <email>alicia.oshlack@petermac.org</email> or <email>phipson.b@wehi.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-25">
      <day>25</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>20</issue>
    <fpage>4720</fpage>
    <lpage>4726</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>22</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac582.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single cell RNA-Sequencing (scRNA-seq) has rapidly gained popularity over the last few years for profiling the transcriptomes of thousands to millions of single cells. This technology is now being used to analyse experiments with complex designs including biological replication. One question that can be asked from single cell experiments, which has been difficult to directly address with bulk RNA-seq data, is whether the cell type proportions are different between two or more experimental conditions. As well as gene expression changes, the relative depletion or enrichment of a particular cell type can be the functional consequence of disease or treatment. However, cell type proportion estimates from scRNA-seq data are variable and statistical methods that can correctly account for different sources of variability are needed to confidently identify statistically significant shifts in cell type composition between experimental conditions.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed <italic toggle="yes">propeller</italic>, a robust and flexible method that leverages biological replication to find statistically significant differences in cell type proportions between groups. Using simulated cell type proportions data, we show that <italic toggle="yes">propeller</italic> performs well under a variety of scenarios. We applied <italic toggle="yes">propeller</italic> to test for significant changes in cell type proportions related to human heart development, ageing and COVID-19 disease severity.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The <italic toggle="yes">propeller</italic> method is publicly available in the open source <monospace>speckle</monospace> R package (<ext-link xlink:href="https://github.com/phipsonlab/speckle" ext-link-type="uri">https://github.com/phipsonlab/speckle</ext-link>). All the analysis code for the article is available at the associated analysis website: <ext-link xlink:href="https://phipsonlab.github.io/propeller-paper-analysis/" ext-link-type="uri">https://phipsonlab.github.io/propeller-paper-analysis/</ext-link>. The <monospace>speckl</monospace>e package, analysis scripts and datasets have been deposited at <ext-link xlink:href="https://doi.org/10.5281/zenodo.7009042" ext-link-type="uri">https://doi.org/10.5281/zenodo.7009042</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council Investigator</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GNT1175653</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council Investigator</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GNT1196256</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council Investigator</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GNT1175781</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council Investigator</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GNT2008376</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000925</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GNT1187748</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Royal Children’s Hospital Foundation and National Health and Medical Research Council Project</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GNT1160257</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>The Novo Nordisk Foundation Center for Stem Cell Medicine is supported by Novo Nordisk Foundation grants</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NNF21CC0073729</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Victorian Government’s Operational Infrastructure Support Program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single cell RNA-sequencing (scRNA-seq) technology has led to breakthroughs in the discovery of novel cell types and enhanced our understanding of the development of complex tissues. As the technology has matured it has become relatively straightforward to profile the transcriptomes of hundreds of thousands of cells, resulting in valuable insight into the composition of tissues.</p>
    <p>While many of the first published single cell papers focussed on defining the resident cell types in complex tissues (<xref rid="btac582-B4" ref-type="bibr">Bornstein <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac582-B7" ref-type="bibr">Combes <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac582-B13" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac582-B21" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic>, 2015</xref>), the field is now using this technology for complex experimental comparisons with biological replication (<xref rid="btac582-B5" ref-type="bibr">Bunis <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac582-B11" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac582-B15" ref-type="bibr">Ren <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac582-B16" ref-type="bibr">Sim <italic toggle="yes">et al.</italic>, 2021</xref>). Experiments with different conditions and multiple biological samples can be costly; however, substantial savings can be made by pooling cells from multiple samples. If samples are genetically diverse, they can be demultiplexed using genetic information (<xref rid="btac582-B10" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac582-B20" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2019</xref>). An alternative approach is to use molecular cell multiplexing protocols, such as the commercially available CellPlex from 10x Genomics. Collectively, cell multiplexing makes designing larger scRNA-seq experiments more feasible.</p>
    <p>The first step in analysis for an scRNA-seq experiment with multiple experimental conditions and biological replicates is to identify the cell types present in each sample. However, downstream analysis requires sophisticated tools to address specific hypotheses about how a perturbation affects the biological system. Two analysis tasks are commonly performed following cell type identification in order to understand the effect of the condition. One task is to find genes that are differentially expressed between groups of samples, for every cell type observed in the experiment, similar to the analysis of bulk RNA-seq experiments (<xref rid="btac582-B8" ref-type="bibr">Crowell <italic toggle="yes">et al.</italic>, 2020</xref>). However, a benefit of scRNA-seq data is that we have additional information on the composition of the samples. The relative change in abundance of a cell type can be a consequence of normal development, disease, or treatment. Due to technical as well as biological sources, the cell type proportion estimates from single cell data can be highly variable. The focus of this work is to find statistically significant differences in cell type proportions between groups of samples that appropriately takes into account sample-to-sample variability.</p>
    <p>Here, we present <italic toggle="yes">propeller</italic>, a robust and flexible linear modelling-based solution to test for differences in cell type proportions between experimental conditions. The <italic toggle="yes">propeller</italic> method leverages biological replication to obtain measures of variability of cell type proportion estimates and uses empirical Bayes to stabilize variance estimates by borrowing information across cell types. It is a flexible approach that can be applied to complex experimental designs with multiple factors. Using simulated data, we compared the performance of commonly used statistical models for testing for differences in cell type proportions in single cell data and show that <italic toggle="yes">propeller</italic> performs well across a variety of experimental scenarios. We applied <italic toggle="yes">propeller</italic> to three different single cell datasets on ageing, human heart development and COVID-19 disease severity. Our <italic toggle="yes">propeller</italic> method is publicly available in the <monospace>speckle</monospace> R package (<ext-link xlink:href="https://github.com/phipsonlab/speckle" ext-link-type="uri">https://github.com/phipsonlab/speckle</ext-link>).</p>
  </sec>
  <sec>
    <title>2 The <italic toggle="yes">propeller</italic> method</title>
    <p><italic toggle="yes">Propeller</italic> is a function in the <monospace>speckle</monospace> R package that uses cell level annotation information to calculate sample level cell type proportions, followed by data transformation and statistical testing for each cell type. <italic toggle="yes">Propeller</italic> leverages biological replication to estimate the high sample-to-sample variability in cell type counts often observed in real single cell data (<xref rid="btac582-F1" ref-type="fig">Fig. 1a</xref>, PBMC scRNA-seq data from 12 healthy human donors). The variability in cell type proportion estimates between samples can be large both due to technical sources, such as variation in dissociation protocols, and due to valid biological factors that contribute to variability. For example, blood cell type composition is known to change with age (<xref rid="btac582-B19" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2017</xref>). Taking into account, sample-to-sample variability when analysing differences in cell type proportions is critical as observed cell type variances are far greater than variances estimated under a binomial or Poisson distribution, which can only account for sampling variation (<xref rid="btac582-F1" ref-type="fig">Fig. 1b</xref>, PBMC scRNA-seq dataset from 12 healthy human donors).</p>
    <fig position="float" id="btac582-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Exploring heterogeneity in cell type proportions estimated from PBMC scRNA-seq data. (<bold>a</bold>) Barplot showing high levels of variability of cell type proportion estimates between 12 healthy PBMC scRNA-seq samples. (<bold>b</bold>) Mean–variance relationship for 27 cell types in 12 healthy PBMC scRNA-seq samples showing that cell type proportions are over-dispersed compared to the variance estimated under a Binomial distribution. The plot is produced using the <italic toggle="yes">plotCellTypePropsMeanVar</italic> function in the <monospace>speckle</monospace> package</p>
      </caption>
      <graphic xlink:href="btac582f1" position="float"/>
    </fig>
    <p>The first step of <italic toggle="yes">propeller</italic> is to calculate the cell type proportions for each sample. <italic toggle="yes">Propeller</italic> can directly derive the counts and calculate the proportions from a Seurat or SingleCellExperiment object. This results in a matrix of proportions where the rows are the cell types, and the columns are the samples. The binomial distribution has the statistical property that proportions close to zero and one have small variance, and values close to 0.5 have large variance i.e. the variances are heteroskedastic. To overcome this, we have implemented two transformations in propeller: (i) arcsin square root transformation, and (ii) logit transformation. The arcsin square root transformation has the benefit that it will always produce a real value. If the logit transformation is selected an offset of 0.5 is added to the raw cell type counts matrix prior to transformation to avoid taking the log of zeroes.</p>
    <p>Next, we test whether the transformed proportions for every cell type are significantly different between two or more experimental conditions using a linear modelling framework. If there are exactly two groups, we perform moderated <italic toggle="yes">t</italic>-tests; if there are more than two groups, we perform moderated ANOVA tests (<xref rid="btac582-B18" ref-type="bibr">Smyth, 2004</xref>).</p>
    <p>These tests are moderated using an empirical Bayes framework, allowing information to be borrowed across cell types to stabilize the cell type-specific variance estimates. This is particularly effective when the number of biological replicates is small and the number of cell types is at least three (<xref rid="btac582-B9" ref-type="bibr">Efron and Morris, 1977</xref>), a common situation in scRNA-seq experiments. The final step in <italic toggle="yes">propeller</italic> is to calculate false discovery rates (<xref rid="btac582-B1" ref-type="bibr">Benjamini and Hochberg, 1995</xref>; <xref rid="btac582-B2" ref-type="bibr">Benjamini and Yekutieli, 2001</xref>) to account for testing across multiple cell types. The output of <italic toggle="yes">propeller</italic> consists of condition-specific proportions estimates, <italic toggle="yes">P</italic>-values and false discovery rates for every cell type observed in the experiment. The statistical details for <italic toggle="yes">propeller</italic> are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <p>The minimal annotation information that <italic toggle="yes">propeller</italic> requires for each cell is cluster/cell type, sample and group/condition. More complex experimental designs can be accommodated using the <italic toggle="yes">propeller.ttest</italic> and <italic toggle="yes">propeller.anova</italic> functions, which have the flexibility to model additional covariates of interest, such as sex or age.</p>
  </sec>
  <sec>
    <title>3 Performance using simulated datasets</title>
    <sec>
      <title>3.1 Type I error control under null simulation scenario</title>
      <p>Although it is clear from the PBMC scRNA-seq data that cell type proportions estimates are over-dispersed (<xref rid="btac582-F1" ref-type="fig">Fig. 1b</xref>), we wanted to more thoroughly evaluate the performance of <italic toggle="yes">propeller</italic> as well as other statistical methods that have commonly been used for testing differences in proportions in other fields. Using simulated cell type proportions, we compared the performance of nine different statistical models.
</p>
      <list list-type="order">
        <list-item>
          <p>χ<sup>2</sup> test for differences in proportions.</p>
        </list-item>
        <list-item>
          <p>Logistic binomial regression (special case of beta-binomial with dispersion =0).</p>
        </list-item>
        <list-item>
          <p>Poisson regression (special case of negative binomial with dispersion =0).</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">propeller</italic> with arcsin square root transformation of proportions, denoted propeller(asin).</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">propeller</italic> with logit transformation of proportions, denoted propeller(logit).</p>
        </list-item>
        <list-item>
          <p>Beta-binomial regression on cell type counts.</p>
        </list-item>
        <list-item>
          <p>Negative binomial regression on cell type counts.</p>
        </list-item>
        <list-item>
          <p>Quasi-likelihood negative binomial regression on cell type counts.</p>
        </list-item>
        <list-item>
          <p>Centred log-ratio (CLR) transformation followed by linear regression, denoted compositional data analysis (CODA).</p>
        </list-item>
      </list>
      <p>The first three methods do not take into account sample-to-sample variability, while the remaining six methods (4–9) do. The quasi-likelihood approach (Method 8) is described in the Bioconductor book ‘Orchestrating single cell analysis with Bioconductor’ (<ext-link xlink:href="https://bioconductor.org/books/release/OSCA/" ext-link-type="uri">https://bioconductor.org/books/release/OSCA/</ext-link>). The two variations of <italic toggle="yes">propeller</italic> model transformed proportions, while the remaining statistical tests, with the exception of the CODA method, model the cell type counts directly. Method 9 is an example from the CODA field where the cell types are modelled relative to a reference ‘cell type’. Here, the geometric mean of the cell types forms the baseline as is commonly done in microbiome data analysis (<xref rid="btac582-B14" ref-type="bibr">Quinn <italic toggle="yes">et al.</italic>, 2019</xref>). The log-ratio of the counts to the geometric mean is calculated and a linear model fitted with group as the explanatory variable to obtain <italic toggle="yes">P</italic>-values. The implementation of the nine methods is described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      <p>We simulated cell type counts in a hierarchical manner under a simple null scenario where the cell type proportions do not differ between two groups in order to determine whether the nine methods control the Type I error rate. We simulated five cell types with proportions that varied from rare to abundant (true proportions <italic toggle="yes">π<sub>i</sub></italic>=0.01, 0.02, 0.15, 0.34, 0.45). The sample proportions, <italic toggle="yes">p<sub>ij</sub></italic>, for cell type <italic toggle="yes">i</italic> and sample <italic toggle="yes">j</italic>, were generated from a Beta distribution with parameters α<sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">β<sub>i</sub></italic>, which control how variable the proportions are. Larger values of α<sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">β<sub>i</sub></italic> result in a more precise distribution centred around the true proportions, while smaller values result in a more diffuse prior (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We set α<sub><italic toggle="yes">i</italic></sub>=10, and calculated the corresponding <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for each cell type <italic toggle="yes">i</italic> from the following relationship derived from properties of the Beta distribution:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>α</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Cell type counts <italic toggle="yes">x<sub>ij</sub></italic> were then sampled from a binomial distribution with parameters <italic toggle="yes">n<sub>j</sub></italic> and <italic toggle="yes">p<sub>ij</sub></italic>. The total number of cells, <italic toggle="yes">n<sub>j</sub></italic>, per sample <italic toggle="yes">j</italic>, were sampled from a negative binomial distribution with mean 5000 and dispersion 20 to simulate variation in total cell numbers per sample observed in real data. The hierarchical model is further described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. We simulated 10 000 datasets and counted the number of times each of the five cell types were statistically significant with <italic toggle="yes">P</italic>-value &lt;0.05 for the nine different statistical models. We also varied the number of samples per group to determine the effect of sample size on the Type I error rate (<italic toggle="yes">n</italic> = 3, 5, 10, 20). <xref rid="btac582-F2" ref-type="fig">Figure 2a</xref> shows the cell type proportions per sample observed for an example simulated dataset under these conditions.</p>
      <fig position="float" id="btac582-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Simulation results. (<bold>a</bold>) Cell type proportions for one simulated dataset with no abundance differences between Group 1 (samples S1–S5) and Group 2 (samples S6–S10). <bold>(b</bold>) Type I error rate at α = 0.05 for sample sizes <italic toggle="yes">n</italic> = 3, 5, 10, 20 for the six methods. A total of 1000 datasets with five cell types that do not change in abundance between two groups were simulated, varying the sample size. For each of the cell types, the proportion of simulated datasets with <italic toggle="yes">P</italic>-value &lt;0.05 was calculated when testing for cell type proportion differences for each of the six models. (<bold>c</bold>) True cell type proportions for Groups 1 and 2. Three cell types that range in abundance are simulated to vary by 2–3-fold (denoted by asterisks). The remaining four cell types do not differ. <bold>(d</bold>) Heatmap showing the proportions of 1000 simulated datasets with <italic toggle="yes">P</italic>-value &lt;0.05 when testing for cell type proportion differences between two groups. True positives are denoted by an asterisk. For the true positives, a large value indicates greater power to detect significant cell type differences (proportion significant is high). For true negatives, entries without the # symbol indicates good false discovery rate control with proportion significant &lt;0.05, # indicates proportion significant between 0.05 and 0.1 and ## indicates poorest control with the proportion significant &gt;0.1. (<bold>e</bold>) Heatmap showing the mean AUC for each of the six methods for all sample sizes across 1000 simulated datasets. Higher AUC indicates a method has both good power to detect true positives as well as good false discovery rate control</p>
        </caption>
        <graphic xlink:href="btac582f2" position="float"/>
      </fig>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> shows the type I error rates for the nine different methods for each of the five different cell types at a nominal <italic toggle="yes">P</italic>-value cut-off of 0.05 when the number of samples per group is five. The most striking observation is that the statistical tests (Methods 1–3) that do not account for additional biological variability frequently find significant differences between the two groups when there are none. As expected, it is clear that methods that account for this additional variability are required and Methods 1–3 are not further explored in this analysis.</p>
      <p>For the methods that model sample-to-sample variability none have perfect type I error rate control, although the observed rates are generally close to 0.05 (Methods 4–9). Propeller(asin) tends to be conservative for the most rare cell type, and permissive for more abundant cell types whereas the opposite tends to be true for the other tests, particularly for the negative binomial methods. These results show that the type I error rate differs between different cell types depending on how abundant the cell type is, and no method perfectly controls the type I error rate for both rare and abundant cell types.</p>
      <p><xref rid="btac582-F2" ref-type="fig">Figure 2b</xref> summarizes the Type I error rates for different sample sizes. As the number of samples in each group increases, the type I error rate for all methods is closer to 0.05. For sample sizes of 10 and 20 per group, the arcsin square root transformation shows the best type I error rate control for almost all cell type abundances, however with smaller sample sizes (<italic toggle="yes">n</italic>=3, 5), the logit transform appears to better control the type I error rate. Across all sample sizes there was a trend of increased Type I error rate for the more rare cell types for propeller(logit), beta-binomial, negative binomial, quasi-likelihood negative binomial and the CODA method, while propeller(asin) tends to be conservative for the most rare cell type (<italic toggle="yes">π</italic>= 0.01). It is not surprising that the beta-binomial model performs favourably as this method most closely resembles the distributional assumptions underlying the simulation.</p>
    </sec>
    <sec>
      <title>3.2 Power to detect true differences in cell type proportions in simulated data</title>
      <p>Next, we expanded the simulation to include seven cell types, three of which change proportions between the two groups by between 2 and 3-fold, while the remaining four did not (<xref rid="btac582-F2" ref-type="fig">Fig. 2c</xref>). The parameters <italic toggle="yes">α<sub>i</sub></italic> and <italic toggle="yes">β<sub>i</sub></italic> of the beta distribution were estimated from real human heart single nuclei RNA-seq data (<xref rid="btac582-F3" ref-type="fig">Fig. 3a</xref>) using the <italic toggle="yes">estimateBetaParamsFromCounts</italic> function available in the <monospace>speckle</monospace> package. We simulated 1000 datasets and evaluated the performance of the models by examining the proportion of simulated datasets with <italic toggle="yes">P</italic>-value &lt;0.05 for each of the seven cell types for each of the six methods. The proportions of the three cell types that are simulated to differ between the two groups range from very rare to quite abundant (baseline proportions in Group 1 = 0.008, 0.183, 0.551). We repeated these simulations for sample sizes <italic toggle="yes">n=</italic>3, 5, 10, 20.</p>
      <fig position="float" id="btac582-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Applying propeller to three scRNA-seq datasets. (<bold>a</bold>) Barplot showing cell type proportions for nine samples in a human heart development snRNA-seq dataset. f, foetal; y, young; a, adult. <bold>(b</bold>) Barplot showing cell type proportions for 20 PBMC samples that differ in terms of their age (Y/O) and sex (M/F). (<bold>c</bold>) Barplot showing cell type proportions for 13 samples in a COVID-19 study. HC, healthy control; M, moderate COVID-19 infection; S, severe COVID-19 infection. (<bold>d</bold>) Treating developmental stage as a continuous variable, the cardiomyocyte populations show a relative decline across development in human heart samples. (<bold>e</bold>) There is a statistically significant difference in the proportions of CD8 naive cells between young and old PBMC samples, taking sex into account. (<bold>f</bold>) Neutrophils are statistically significantly different between healthy control, moderate and severe COVID-19 bronchoalveolar lavage samples</p>
        </caption>
        <graphic xlink:href="btac582f3" position="float"/>
      </fig>
      <p>At <italic toggle="yes">n=5</italic> samples per group, propeller(asin) detected the rare cell type difference in only 52% of the simulated datasets, while the other methods detected the rare cell type difference in 71–81% of simulated datasets (<xref rid="btac582-F2" ref-type="fig">Fig. 2d</xref>). However, propeller(asin) detected the differences in the more abundant cell types in a larger percentage of the simulated datasets compared to the other methods (82% and 74% of simulated datasets). The negative binomial methods detected the difference in the most abundant cell type in &lt;50% of the simulated datasets. The CODA method had relatively poor performance for the more abundant cell types compared to the <italic toggle="yes">propeller</italic> methods and the beta-binomial model. The most consistent performing models across cell type abundances were propeller(logit) and the beta-binomial model. In terms of the cell types that did not change between the two groups, we noted that propeller(asin) generally had the best false discovery rate control and CODA had the worst. Heatmaps for sample sizes <italic toggle="yes">n</italic>=3, 10 and 20 are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>.</p>
      <p><xref rid="btac582-F2" ref-type="fig">Figure 2e</xref> shows the mean area under the receiver operating curve (AUC) for the six methods at the four different sample sizes (<italic toggle="yes">n</italic>=3, 5, 10, 20). As sample size increases, all methods show an improvement in performance. With at least 10 samples in each group, all methods except CODA have an AUC above 98%. In general, propeller(asin), propeller(logit) and the Beta-binomial method have the highest AUC at each of the four sample sizes.</p>
    </sec>
    <sec>
      <title>3.3 Extreme case: varying numbers of cell types</title>
      <p>While the simulations above examine Type I error control and power to detect true positives with 5 and 7 cell types, respectively, we wanted to examine the performance of the methods in the extreme case when there are only 2 cell types present in the dataset, compared to when there are 20. Here, we focussed on <italic toggle="yes">n</italic>=5 and simulating cell types with true differences between two groups.</p>
      <p>The scenario when only two cell types are present in the data is interesting from the perspective that if one cell type changes in proportion, the other cell type will also naturally change. In this scenario, we set the Group 1 true proportions as <italic toggle="yes">π</italic><sub>1</sub><sub><italic toggle="yes">i</italic></sub>=0.4, 0.6; and Group 2 true proportions as <italic toggle="yes">π</italic><sub>2</sub><sub><italic toggle="yes">i</italic></sub>=0.2, 0.8 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3a</xref>). Hence, cell type 1 is halved in Group 2 compared to Group 1, and cell type 2 increases by 33.3%. In this scenario, all the methods detected the changes in the two cell types in the majority of the simulated datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3b</xref>). There was a slight decrease in power for the negative binomial methods for the more abundant cell type.</p>
      <p>For the scenario with 20 cell types, we used cell type proportion estimates from the 12 healthy human PBMC scRNA-seq dataset as our true baseline proportions. We modified 8 of the 20 cell types to be different between the two groups (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4a</xref>). The cell types that differed in abundance between the two groups ranged from rare to abundant. The heatmap in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4b</xref> shows the proportion of significant tests across the 1000 simulated datasets for each cell type and each method. In this scenario with a larger number of cell types, the negative binomial methods have similar performance compared to the other methods. Cell types with larger log-fold changes are detected as statistically significant in the majority of simulated datasets by all methods.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> shows the recall, precision and <italic toggle="yes">F</italic>1 score for each method averaged across the 1000 simulated datasets. In this scenario, the CODA method is able to detect more true differences in cell type proportions compared to any of the other methods, at the expense of detecting the most false positives. In general, the <italic toggle="yes">propeller</italic> methods have high precision indicating that not many false discoveries are reported. The negative binomial methods perform better in this scenario, and the beta-binomial model has the second highest <italic toggle="yes">F</italic>1 score with a good balance between precision and recall. Propeller(logit) has the highest precision and CODA has the highest recall.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Application to real single cell datasets</title>
    <p>One important feature of <italic toggle="yes">propeller</italic> is that complex experimental designs can be modelled by using a design matrix that takes account of multiple factors. In order to demonstrate the types of experimental designs that can be accommodated, we applied propeller(logit) to three different scRNA-seq datasets that varied in terms of the experimental design and the number of samples and cell types in each dataset:
</p>
    <list list-type="order">
      <list-item>
        <p>Nine human heart biopsy samples across development (foetal, young and adult), with eight broad cell types annotated (<xref rid="btac582-B16" ref-type="bibr">Sim <italic toggle="yes">et al.</italic>, 2021</xref>). We modelled development as a continuous variable and sex as a categorical variable.</p>
      </list-item>
      <list-item>
        <p>A total of 20 PBMC samples across young and old male and female samples with 24 cell types annotated (<xref rid="btac582-B11" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2021</xref>). We modelled age and sex as categorical variables.</p>
      </list-item>
      <list-item>
        <p>A total of 13 bronchoalveolar lavage fluid immune cell samples across three groups (healthy controls, moderate and severe COVID-19 infection) with 10 cell types annotated (<xref rid="btac582-B12" ref-type="bibr">Liao <italic toggle="yes">et al.</italic>, 2020</xref>). We modelled disease status as a categorical variable and performed an ANOVA to find cell type differences between the three groups.</p>
      </list-item>
    </list>
    <p><xref rid="btac582-F3" ref-type="fig">Figure 3(a–c)</xref> shows the cell type proportion estimates for each sample for the three different datasets. The cell type proportions are highly variable between individuals across all datasets. Across healthy human heart development, we detected significant changes in the abundances of immune, erythroid, cardiomyocyte and fibroblast cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). In the original analysis, propeller(logit) was applied as an ANOVA test, ignoring sex. While the conclusions are not markedly different, the order of significant cell types has changed with immune cells the most significant cell type when modelling development as a continuous variable. The immune and erythroid cell type changes across development form a type of positive control and it is encouraging that they are the most significant cell types. As noted in the initial paper (<xref rid="btac582-B16" ref-type="bibr">Sim <italic toggle="yes">et al.</italic>, 2021</xref>), immune cells increase throughout development, as would be expected as the foetus has not been exposed to many pathogens, while an adult would have a larger and more diverse repertoire of immune cells. With the erythroid cells, only foetal red blood cells are nucleated, and hence they are captured with the nuclei protocol in foetal samples and absent in young and adult samples. An interesting finding in this study was that the relative abundance of cardiomyocytes declines with age (<xref rid="btac582-F3" ref-type="fig">Fig. 3d</xref>), while fibroblasts increase across development (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
    <p>For the ageing PBMC dataset, we detected statistically significant differences in CD8 naive and CD16 cells between young and old samples, while controlling for sex, at a false discovery rate threshold of 0.05. CD8 naive cells were significantly enriched in the young samples (<xref rid="btac582-F3" ref-type="fig">Fig. 3e</xref>), and CD16 cells were significantly depleted in the young samples compared to old (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). While the CD8 naive result was reported in the initial paper, we detected a significant change in abundance of CD16 cells between young and old samples that was not reported in the original analysis (<xref rid="btac582-B11" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>For the COVID-19 dataset, we found four cell types to have significant changes in abundance between the three groups when we applied propeller(logit) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). We found that neutrophils were the most significantly different between healthy controls and moderate and severe bronchoalveolar lavage samples from COVID-19 patients (<xref rid="btac582-F3" ref-type="fig">Fig. 3f</xref>), and this was not reported as statistically significant in the original analysis (<xref rid="btac582-B12" ref-type="bibr">Liao <italic toggle="yes">et al.</italic>, 2020</xref>). Plasma, pDC and NK cells also showed significant changes in abundance. Upon closer inspection, it appeared that the significant result for Plasma was driven by one sample in the severe COVID-19 group (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). When we re-analysed the data with propeller(asin), this cell type was no longer significant, while neutrophils, pDC and NK cells were still statistically significant. This indicates that propeller(logit) may be sensitive to outlier samples and suggests that propeller(asin) is a more robust method to use when outliers are present in the data. Compared to the results from the original analysis, we detected two additional cell types, neutrophils and NK cells, that significantly changed in abundance between healthy controls, moderate and severe COVID-19 patients.</p>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>In this article, we present <italic toggle="yes">propeller</italic>, a new method for testing for differences in cell type proportions from single cell data. It takes account of sample-to-sample variability, which is large due to both technical and biological sources. The <italic toggle="yes">propeller</italic> function itself inter-operates with Seurat and SingleCellExperiment class objects, and the <italic toggle="yes">propeller.ttest</italic> and <italic toggle="yes">propeller.anova</italic> functions have the ability to model complex experimental designs. In order to work specifically with the features of single cell data, which often have extreme cell type proportions, we have implemented <italic toggle="yes">propeller</italic> with two different transformations: the arcsin square root transformation and the logit transformation. Through simulation studies, we found propeller(logit) has superior performance in terms of power to detect changes in cell type proportions, as well as good false discovery rate control. Through analysis of real datasets, we found that propeller(logit) may be sensitive to outlier samples, while propeller(asin) is not, which suggests that propeller(asin) is a good alternative in this scenario. A recent comparison of statistical methods for performing cell type composition analysis of single cell data found that propeller(asin) and Dirichlet regression had the best performance across a variety of scenarios (<xref rid="btac582-B17" ref-type="bibr">Simmons, 2022</xref>). The <italic toggle="yes">propeller</italic> methods have the ability to handle zeros and ones in the data, which are not uncommon in cell type proportion estimates from single cell data. Zero values need to be carefully dealt with when using CODA methods. For the simulation studies, we replaced zeroes with 0.5 prior to CLR transformation. Another factor to consider when using a CODA framework is the choice of reference cell type, and all results need to be interpreted relative to the reference cell type, which can make interpretation of the output more challenging.</p>
    <p>In our simulation studies, we explored the effect of the number of cell types on the performance of the methods. For datasets with fewer cell types, the negative binomial methods and the CODA method show decreased performance compared to beta-binomial and propeller methods. As the number of cell types increases to 20, the performance of negative binomial and CODA methods improve to be comparable to the other methods. We also explored the effect of sample size and baseline abundance of the cell type on the performance of the methods. For small sample sizes the differences between the methods are more pronounced, with propeller(logit) and beta-binomial showing the best overall performance. As the sample size increases beyond 10 samples per group, all methods show good power and false discovery rate control, with the exception of the CODA method, which has increased false discovery rates for all cell types with increasing sample size. We also found that at smaller sample sizes, propeller(asin) had less power to detect the difference in the most rare cell type, while the negative binomial methods had less power to detect differences in the most abundant cell types.</p>
    <p>We applied propeller to the analysis of three different single cell datasets that differed in terms of tissue, number of cell types, sample size and experimental conditions. We found significant biological differences in abundance, including some cell types that had not been previously reported in three different studies: across healthy human heart development, comparing blood from young and old patients, and in lung fluid from individuals with severe covid versus moderate and healthy controls. All our analysis is available via a <italic toggle="yes">workflowr</italic> (<xref rid="btac582-B3" ref-type="bibr">Blischak <italic toggle="yes">et al.</italic>, 2019</xref>) website (<ext-link xlink:href="https://phipsonlab.github.io/propeller-paper-analysis/" ext-link-type="uri">https://phipsonlab.github.io/propeller-paper-analysis/</ext-link>), with the original source code available on github (<ext-link xlink:href="https://github.com/phipsonlab/propeller-paper-analysis/tree/master" ext-link-type="uri">https://github.com/phipsonlab/propeller-paper-analysis/tree/master</ext-link>). The propeller methods are available in the speckle R package (<ext-link xlink:href="https://github.com/phipsonlab/speckle" ext-link-type="uri">https://github.com/phipsonlab/speckle</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac582_Supplementary_Data</label>
      <media xlink:href="btac582_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Xinyi Jin for preparing the speckle package for submission to Bioconductor. We thank Dr Jovana Maksimovic for suggesting the COVID-19 dataset as an application dataset, and Prof. Gordon Smyth for discussion regarding multiple testing adjustment under dependence of test statistics.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by a National Health and Medical Research Council Investigator grant [GNT1175653 to B.P.]; a National Health and Medical Research Council Investigator grant [GNT1196256 to A.O.]; a National Health and Medical Research Council Investigator grant [GNT1175781 to J.P.]; and a National Health and Medical Research Council Investigator grant [GNT2008376 to E.R.P.]. The work was supported by National Health and Medical Research Council Grant [GNT1187748]. The snRNA-seq dataset for heart was funded by Royal Children’s Hospital Foundation and National Health and Medical Research Council Project grant [GNT1160257]. The Novo Nordisk Foundation Center for Stem Cell Medicine is supported by Novo Nordisk Foundation grants [NNF21CC0073729 to E.R.P.]. MCRI is supported by the Victorian Government’s Operational Infrastructure Support Program.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The data underlying this article are available in Zenodo at <ext-link xlink:href="https://doi.org/10.5281/zenodo.7009042" ext-link-type="uri">https://doi.org/10.5281/zenodo.7009042</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac582-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Series B Stat. Methodol</source>., <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btac582-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Yekutieli</surname><given-names>D.</given-names></string-name></person-group> (<year>2001</year>) <article-title>The control of the false discovery rate in multiple testing under dependency</article-title>. <source>Ann. Stat</source>., <volume>29</volume>, <fpage>1165</fpage>–<lpage>1188</lpage>.</mixed-citation>
    </ref>
    <ref id="btac582-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blischak</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Creating and sharing reproducible research code the workflowr way</article-title>. <source>F1000Res</source>., <volume>8</volume>, <fpage>1749</fpage>.<pub-id pub-id-type="pmid">31723427</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bornstein</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Single-cell mapping of the thymic stroma identifies IL-25-producing tuft epithelial cells</article-title>. <source>Nature</source>, <volume>559</volume>, <fpage>622</fpage>–<lpage>626</lpage>.<pub-id pub-id-type="pmid">30022162</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bunis</surname><given-names>D.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell mapping of progressive fetal-to-adult transition in human naive T cells</article-title>. <source>Cell Rep</source>., <volume>34</volume>, <fpage>108573</fpage>.<pub-id pub-id-type="pmid">33406429</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Combes</surname><given-names>A.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single cell analysis of the developing mouse kidney provides deeper insight into marker gene expression and ligand-receptor crosstalk</article-title>. <source>Development</source>, <volume>146</volume>, <fpage>dev178673</fpage>.<pub-id pub-id-type="pmid">31118232</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crowell</surname><given-names>H.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Muscat detects subpopulation-specific state transitions from multi-sample multi-condition single-cell transcriptomics data</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>6077</fpage>.<pub-id pub-id-type="pmid">33257685</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B.</given-names></string-name>, <string-name><surname>Morris</surname><given-names>C.</given-names></string-name></person-group> (<year>1977</year>) <article-title>Stein’s paradox in statistics</article-title>. <source>Sci. Am</source>., <volume>236</volume>, <fpage>119</fpage>–<lpage>127</lpage>.</mixed-citation>
    </ref>
    <ref id="btac582-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Vireo: Bayesian demultiplexing of pooled single-cell RNA-seq data without genotype reference</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>273</fpage>.<pub-id pub-id-type="pmid">31836005</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Effects of sex and aging on the immune cell landscape as assessed by single-cell transcriptomic analysis</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>118</volume>, <fpage>e2023216118</fpage>.<pub-id pub-id-type="pmid">34385315</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell landscape of bronchoalveolar immune cells in patients with COVID-19</article-title>. <source>Nat. Med</source>., <volume>26</volume>, <fpage>842</fpage>–<lpage>844</lpage>.<pub-id pub-id-type="pmid">32398875</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Single-cell RNA-seq reveals the diversity of trophoblast subtypes and patterns of differentiation in the human placenta</article-title>. <source>Cell Res</source>., <volume>28</volume>, <fpage>819</fpage>–<lpage>832</lpage>.<pub-id pub-id-type="pmid">30042384</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quinn</surname><given-names>T.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A field guide for the compositional analysis of any-omics data</article-title>. <source>GigaScience</source>, <volume>8</volume>, <fpage>giz107</fpage>.<pub-id pub-id-type="pmid">31544212</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>COVID-19 immune features revealed by a large-scale single-cell transcriptome atlas</article-title>. <source>Cell</source>, <volume>184</volume>, <fpage>1895</fpage>–<lpage>1913.e19</lpage>.<pub-id pub-id-type="pmid">33657410</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sim</surname><given-names>C.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Sex-specific control of human heart maturation by the progesterone receptor</article-title>. <source>Circulation</source>, <volume>143</volume>, <fpage>1614</fpage>–<lpage>1628</lpage>.<pub-id pub-id-type="pmid">33682422</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Simmons</surname><given-names>S.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Cell type composition analysis: comparison of statistical methods</article-title>. bioRxiv (p. 2022.02.04.479123). <pub-id pub-id-type="doi">10.1101/2022.02.04.479123</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac582-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group> (<year>2004</year>) <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>., <volume>3</volume>, <fpage>Article3</fpage>.<pub-id pub-id-type="pmid">16646809</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Handling blood cell composition in epigenetic studies on ageing [review of handling blood cell composition in epigenetic studies on ageing]</article-title>. <source>Int. J. Epidemiol</source>., <volume>46</volume>, <fpage>1717</fpage>–<lpage>1718</lpage>.<pub-id pub-id-type="pmid">28582533</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Genotype-free demultiplexing of pooled single-cell RNA-seq</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>290</fpage>.<pub-id pub-id-type="pmid">31856883</pub-id></mixed-citation>
    </ref>
    <ref id="btac582-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
