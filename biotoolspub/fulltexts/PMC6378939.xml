<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6378939</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty655</article-id>
    <article-id pub-id-type="publisher-id">bty655</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The epiGenomic Efficient Correlator (epiGeEC) tool allows fast comparison of user datasets with thousands of public epigenomic datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Laperle</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff1">1</xref>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hébert-Deschamps</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raby</surname>
          <given-names>Joanny</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Lima Morais</surname>
          <given-names>David A</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barrette</surname>
          <given-names>Michel</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bujold</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bastin</surname>
          <given-names>Charlotte</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robert</surname>
          <given-names>Marc-Antoine</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nadeau</surname>
          <given-names>Jean-François</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harel</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nordell-Markovits</surname>
          <given-names>Alexei</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Veilleux</surname>
          <given-names>Alain</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bourque</surname>
          <given-names>Guillaume</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jacques</surname>
          <given-names>Pierre-Étienne</given-names>
        </name>
        <xref ref-type="aff" rid="bty655-aff1">1</xref>
        <xref ref-type="aff" rid="bty655-aff2">2</xref>
        <xref ref-type="aff" rid="bty655-aff3">3</xref>
        <xref ref-type="aff" rid="bty655-aff6">6</xref>
        <xref ref-type="corresp" rid="bty655-cor1"/>
        <!--<email>pierre-etienne.jacques@usherbrooke.ca</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty655-aff1"><label>1</label>Département d’Informatique, Université de Sherbrooke, Sherbrooke, QC, Canada</aff>
    <aff id="bty655-aff2"><label>2</label>Département de Biologie, Université de Sherbrooke, Sherbrooke, QC, Canada</aff>
    <aff id="bty655-aff3"><label>3</label>Centre de Calcul Scientifique, Faculté des Sciences, Université de Sherbrooke, Sherbrooke, QC, Canada</aff>
    <aff id="bty655-aff4"><label>4</label>McGill University and Génome Québec Innovation Center, Montréal, Canada</aff>
    <aff id="bty655-aff5"><label>5</label>Department of Human Genetics, McGill University, Montréal, Canada</aff>
    <aff id="bty655-aff6"><label>6</label>Centre de Recherche du CHUS, Université de Sherbrooke, Sherbrooke, QC, Canada</aff>
    <author-notes>
      <corresp id="bty655-cor1">To whom correspondence should be addressed. <email>pierre-etienne.jacques@usherbrooke.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-07-24">
      <day>24</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>4</issue>
    <fpage>674</fpage>
    <lpage>676</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>7</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty655.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>In recent years, major initiatives such as the International Human Epigenome Consortium have generated thousands of high-quality genome-wide datasets for a large variety of assays and cell types. This data can be used as a reference to assess whether the signal from a user-provided dataset corresponds to its expected experiment, as well as to help reveal unexpected biological associations. We have developed the epiGenomic Efficient Correlator (epiGeEC) tool to enable genome-wide comparisons of very large numbers of datasets. A public Galaxy implementation of epiGeEC allows comparison of user datasets with thousands of public datasets in a few minutes.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The source code is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/labjacquespe/epigeec">https://bitbucket.org/labjacquespe/epigeec</ext-link> and the Galaxy implementation at <ext-link ext-link-type="uri" xlink:href="http://epigeec.genap.ca">http://epigeec.genap.ca</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Natural Sciences and Engineering Research Council of Canada</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000038</named-content>
        </funding-source>
        <award-id>NSERC 435710–2013</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Fonds de recherche du Québec – Santé</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">CANARIE</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Processing files generated by high-throughput sequencing of epigenomic experiments should involve evaluating the quality of both the raw reads and their alignment. Confirming that the signal in a resulting file globally corresponds to the expected experiment is also highly desirable before entering the time-consuming analysis and interpretation steps. However, determining for instance the biological assay and the cell type is virtually impossible by looking at the signal without comparative datasets. This is usually available only to groups producing enough data themselves. Using high-quality reference data generated in a large variety of assays and cell types by consortia such as the International Human Epigenome Consortium (IHEC) (<xref rid="bty655-B6" ref-type="bibr">Stunnenberg <italic>et al.</italic>, 2016</xref>), it becomes possible to develop tools for the validation of user datasets. The IHEC Data Portal (<ext-link ext-link-type="uri" xlink:href="http://epigenomesportal.ca/ihec/grid.html">epigenomesportal.ca/ihec/grid.html</ext-link>) (<xref rid="bty655-B3" ref-type="bibr">Bujold <italic>et al.</italic>, 2016</xref>) provides such processed datasets, while public databases such as Gene Expression Omnibus (GEO) (<xref rid="bty655-B1" ref-type="bibr">Barrett <italic>et al.</italic>, 2013</xref>) are giving access to raw epigenomic data.</p>
    <p>Comparing large numbers of datasets simultaneously in a reasonable amount of time requires an efficient approach. The epiGenomic Efficient Correlator (epiGeEC) tool was developed specifically to fulfill this need. A few other tools such as bigWigCorrelate (<xref rid="bty655-B4" ref-type="bibr">Kent <italic>et al.</italic>, 2010</xref>) and DeepTools (<xref rid="bty655-B5" ref-type="bibr">Ramírez <italic>et al.</italic>, 2016</xref>) have the capability to generate correlation matrices on many datasets, but they need to read each signal file every time a new dataset is to be compared, which greatly affects performance. Instead, epiGeEC uses intermediate files in the high-performance HDF5 format. A user-friendly public Galaxy interface integrating epiGeEC and featuring a large collection of reference datasets enables the efficient comparison of user-provided datasets with thousands of public epigenomic datasets in only a few minutes (<ext-link ext-link-type="uri" xlink:href="http://epigeec.genap.ca/">http://epigeec.genap.ca/</ext-link>). This public Galaxy framework is provided by the Genetics and genomics Analysis Platform (GenAP) project, thereby leveraging Compute Canada advanced research computing infrastructure.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>EpiGeEC is designed to efficiently perform pairwise correlations of thousands of epigenomic datasets. It supports many genomic signal file formats (bigWig, WIG and bedGraph), and offers the possibility of computing correlations at various resolutions (from 1 kb to 1 Mb) on pre-defined filtered regions (e.g. whole genome with or without blacklisted regions, only genes, TSS) and using the selected correlation metric (Pearson and Spearman), as well as the annotation and analysis of the generated correlation matrices. Most of the wrapping is coded in Python, while the core functionalities requiring high performance are coded in C++ using the openMP API for parallelization.</p>
    <p>Public datasets gathered in the epiGeEC server currently include more than 10 000 processed datasets from IHEC (human hg19 and hg38 and mouse mm10 assemblies), as well as a subset of ∼1000 high-quality ChIP-Seq and chromatin accessibility data from the yeast model organism <italic>Saccaromyces cerevisiae</italic> downloaded from GEO and uniformly processed on the sacCer3 assembly.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>A typical use case is to compare some signal files to a set of public datasets within minutes. For instance, we uploaded in the epiGeEC-Galaxy history 10 bigWig files from ChIP-Seq experiments conducted on four histone modifications and the CTCF transcription regulator. We then used the <monospace>Public Dataset Selection</monospace> tool to select 3101 datasets from the IHEC_hg19_2017-10 freeze, corresponding largely to the same assays (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). Upon selection, a JSON file containing the metadata from the selected public datasets was uploaded to the history. The <monospace>Correlation Matrix</monospace> tool was then used to select the JSON file and the 10 user-provided datasets from the history to compute, in &lt;10 min, a Pearson correlation matrix of 3111 elements at a resolution of 1 kb over the whole genome. The <monospace>Annotate Matrix</monospace> tool was then used to generate a report containing a dendrogram, heatmap and pie chart annotations, as well as a multidimensional scaling representation (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). As shown in <xref ref-type="fig" rid="bty655-F1">Figure 1A</xref>, the heatmap representation shows that the five pairs of user datasets (cyan dots) are, as expected, highly similar to histone modifications or CTCF experiments.
</p>
    <fig id="bty655-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>A)</bold> Heatmap representation adapted from the PDF report (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>), showing the annotated correlation matrix between 10 user-provided datasets (cyan dots) mapped onto hg19 (accession GSE50893) and 3101 public pre-computed datasets from the IHEC_hg19_2017-10 freeze. This matrix was generated in &lt;10 min. <bold>(B)</bold> Time spent by three tools generating correlation matrices of various sizes, starting directly from the bigWig (no pre-computation)</p>
      </caption>
      <graphic xlink:href="bty655f1"/>
    </fig>
    <p>As explained in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, one of the reasons for the high performance of epiGeEC is the pre-computation of the signal in intermediate HDF5 files, thereby reducing the time limiting step of reading the signal files. We compared the performances of three tools used to generate correlation matrices of various sizes, starting from the bigWig signal files to the final matrix at a resolution of 1 kb. While the matrices generated with the three tools were highly similar (average Pearson coefficient &gt;0.93, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>), epiGeEC was ∼10 times faster than DeepTools (version 2.4.3) and 5–40 times faster than bigWigCorrelate, while using more than 10 times less peak memory than the other tools (<xref ref-type="fig" rid="bty655-F1">Fig. 1B</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). Because of these constraints, on a server containing 48 cores and 256 GB of RAM, the largest correlation matrices we were able to generate contained 250 datasets using bigWigCorrelate, and 1000 datasets using DeepTools. By comparison, it took to epiGeEC ∼16 h and ∼96 GB of RAM to create a complete correlation matrix from ∼8000 raw bigWig files from IHEC_hg19_2017-10 freeze.</p>
    <p>In recent years, epiGeEC has been used to pre-calculate static correlation matrices that are incorporated to the IHEC Data Portal, and that have been used to identify problematic datasets as part of a quality control pipeline. EpiGeEC has also proven useful to demonstrate that despite the non-uniform procedures applied by the different consortia, the IHEC datasets are overall highly comparable (<xref rid="bty655-B2" ref-type="bibr">Breeze <italic>et al.</italic>, 2016</xref>). We plan to regularly update the IHEC data and expand the referenced processed datasets from human and model organisms, as well as to develop a programmatic access to the epiGeEC functionalities.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Information</label>
      <media xlink:href="bty655_supplementary_information.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank the members of the GenAP projects and lab members, as well as Sébastien Rodrigue for useful comments. Computing and networking infrastructure was provided by Calcul Québec and Compute Canada.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Natural Sciences and Engineering Research Council of Canada (NSERC 435710–2013) [P.É.J.], Fonds de recherche du Québec – Santé (FRQS) [P.É.J.] and CANARIE [to G.B. and P.É.J.].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bty655-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barrett</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>NCBI GEO: archive for functional genomics data sets - Update</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>D991</fpage>–<lpage>D995</lpage>.<pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="bty655-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Breeze</surname><given-names>C.E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>eFORGE: a Tool for Identifying Cell Type-Specific Signal in Epigenomic Data</article-title>. <source>Cell Rep</source>., <volume>17</volume>, <fpage>2137</fpage>–<lpage>2150</lpage>.<pub-id pub-id-type="pmid">27851974</pub-id></mixed-citation>
    </ref>
    <ref id="bty655-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bujold</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The International Human Epigenome Consortium Data Portal</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>496</fpage>–<lpage>499</lpage>.<pub-id pub-id-type="pmid">27863956</pub-id></mixed-citation>
    </ref>
    <ref id="bty655-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>W.J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>BigWig and BigBed: enabling browsing of large distributed datasets</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2204</fpage>–<lpage>2207</lpage>.<pub-id pub-id-type="pmid">20639541</pub-id></mixed-citation>
    </ref>
    <ref id="bty655-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ramírez</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W160</fpage>–<lpage>W165</lpage>.<pub-id pub-id-type="pmid">27079975</pub-id></mixed-citation>
    </ref>
    <ref id="bty655-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stunnenberg</surname><given-names>H.G.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The International Human Epigenome Consortium: a Blueprint for Scientific Collaboration and Discovery</article-title>. <source>Cell</source>, <volume>167</volume>, <fpage>1145</fpage>–<lpage>1149</lpage>.<pub-id pub-id-type="pmid">27863232</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
