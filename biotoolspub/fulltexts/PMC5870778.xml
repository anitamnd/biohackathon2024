<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870778</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx373</article-id>
    <article-id pub-id-type="publisher-id">btx373</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FQC Dashboard: integrates FastQC results into a web-based, interactive, and extensible FASTQ quality control tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Joseph</given-names>
        </name>
        <xref ref-type="aff" rid="btx373-aff1">1</xref>
        <xref ref-type="corresp" rid="btx373-cor1"/>
        <!--<email>joseph.brown@pnnl.gov</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pirrung</surname>
          <given-names>Meg</given-names>
        </name>
        <xref ref-type="aff" rid="btx373-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCue</surname>
          <given-names>Lee Ann</given-names>
        </name>
        <xref ref-type="aff" rid="btx373-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx373-aff1"><label>1</label>Earth and Biological Sciences Division, Pacific Northwest National Laboratory, Richland, WA, USA and</aff>
    <aff id="btx373-aff2"><label>2</label>Computation and Analytics Division, Pacific Northwest National Laboratory, Richland, WA, USA</aff>
    <author-notes>
      <corresp id="btx373-cor1">To whom correspondence should be addressed. Email: <email>joseph.brown@pnnl.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-06-09">
      <day>09</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>19</issue>
    <fpage>3137</fpage>
    <lpage>3139</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>6</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits 
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx373.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>FQC is software that facilitates quality control of FASTQ files by carrying out a QC protocol using FastQC, parsing results, and aggregating quality metrics into an interactive dashboard designed to richly summarize individual sequencing runs. The dashboard groups samples in dropdowns for navigation among the data sets, utilizes human-readable configuration files to manipulate the pages and tabs, and is extensible with CSV data.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and implementation</title>
        <p>FQC is implemented in Python 3 and Javascript, and is maintained under an MIT license. Documentation and source code is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/pnnl/fqc">https://github.com/pnnl/fqc</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">DOE</named-content>
          <named-content content-type="funder-identifier">10.13039/100000015</named-content>
        </funding-source>
        <award-id>DE-AC06-76RL01830</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Quality control (QC) tools geared towards next-generation sequencing need to adapt to an ever-changing list of requirements and the expectations of different users. Many tools have been developed that address specific QC requirements, though few provide comprehensive results. We address some of these shortfalls through data aggregation and visualization within an extensible and interactive dashboard that simplifies the identification of points of failure for the individuals generating data as well as providing data quality metrics to the researchers using the data for downstream analyses.</p>
    <p>FASTQ files containing nucleotide sequence data with associated quality scores can be summarized in several ways. FastQC (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>) is a widely-adopted application in FASTQ QC as it summarizes read quality by position, informs the user of adapter content in sequences, reports on tetramer frequencies, and many other aspects one would expect to glean from the raw sequence data.</p>
    <p>FQC Dashboard addresses QC capturing by utilizing FastQC on the backend, taking advantage of its speed and versatility in analyzing single files, and placing those results within a web server with extensible capabilities. FQC’s web framework is built around the same standard metrics obtained from FastQC, but with the ability to aggregate results of multiple sequence runs and easily navigate between them. FQC is intended to be used as an interactive website with dynamically generated plots, which can be readily extended to include additional sequence runs and to add custom plots. This extensibility, and the ability to aggregate multiple sequence runs as individual pages, distinguishes FQC from similar tools (e.g. MultiQC; <xref rid="btx373-B1" ref-type="bibr">Ewels <italic>et al.</italic>, 2016</xref>) designed to summarize FASTQ data sets as individual or groups of samples, but that lack the ability to display multiple, single-sample reports in a unified dashboard; the goal of this design is to enable sequencing facility personnel to identify and track issues with runs. </p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>FQC Dashboard is a combination of a command line interface (CLI) written in Python 3, which depends on FastQC for processing FASTQ files, a frontend website written in JavaScript, HTML, and CSS, that utilizes Highcharts (<ext-link ext-link-type="uri" xlink:href="http://www.highcharts.com">http://www.highcharts.com</ext-link>) and D3 (<ext-link ext-link-type="uri" xlink:href="https://d3js.org">https://d3js.org</ext-link>) Javascript libraries for plotting, and Bootstrap.js (<ext-link ext-link-type="uri" xlink:href="https://getbootstrap.com">https://getbootstrap.com</ext-link>) for styling and interactivity. These packages are included in the source code repository. The CLI is a single executable with submodules for (i) FASTQ processing of either single- or paired-end data, (ii) batch FASTQ processing based on directory searching and (iii) adding custom plots onto existing dashboard pages. The only dependencies outside of cloning the source code repository are Python 3, which can be installed using Anaconda (<ext-link ext-link-type="uri" xlink:href="https://www.continuum.io/downloads">https://www.continuum.io/downloads</ext-link>), and FastQC, which can be installed using the Bioconda channel (<ext-link ext-link-type="uri" xlink:href="https://github.com/bioconda/bioconda-recipes">https://github.com/bioconda/bioconda-recipes</ext-link>).</p>
    <p>Plots and tables are dynamically generated from CSV files and configured by the user to be displayed within FQC's supported visualizations: table, line plot, bar plot, area range plot, heatmap or plate heatmap. Configuration is set using JSON files which define the biological samples and sample groups as well as which plots to display and their respective user settings. The default settings for FQC will generate a standard QC analysis from FastQC without the need for the user to edit files, though by modifying the configuration files, the user can personalize and add plots relevant to their analysis protocol.</p>
  </sec>
  <sec>
    <title>3 Application</title>
    <p>An FQC analysis starts with the CLI, which simplifies executing QC on FASTQ files by aggregating QC data like quality by position, sequence content, GC content, and adapter content, and generating the FQC dashboard's configuration files. The default configuration files and settings are determined by the results of FastQC per sample and written to the user’s server data directory. The CLI handles combining paired-end QC data by compiling data from the forward and reverse strand into single plots where applicable, or adding R1 and R2 tabs for more complex plots that should not be combined, like sequence content.</p>
    <p>The dashboard (<xref ref-type="fig" rid="btx373-F1">Fig. 1</xref>) provides a single place for laboratory personnel and researchers to explore the data generated from the command line. Dashboard viewing selections are made from groups (<xref ref-type="fig" rid="btx373-F1">Fig. 1B</xref>), which are sets of samples, and then from a list of the samples, which can be comprised of single-end or paired-end sequence QC. Samples are selected and explored individually (<xref ref-type="fig" rid="btx373-F1">Fig. 1B</xref>) and can contain many plot pages, each of which can have many subplots which are displayed as tabs in the plot window (<xref ref-type="fig" rid="btx373-F1">Fig. 1C</xref>). The user has full control over the parameters for every plot, including axes labels, legend colors and labels, plot color zones, titles, subtitles and tab names.
</p>
    <fig id="btx373-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>The FQC dashboard. <bold>(A)</bold> Tab navigation with the metric name displayed on the tab and status of the metric as determined by FastQC. <bold>(B)</bold> Dropdown menus of the groups (in this example, a group represents a flow cell) and biological samples within a group available for viewing. <bold>(C)</bold> Plot tabs enable switching between multiple plots (R1 and R2 reads in this example) within a given quality metric. <bold>(D)</bold> 96-well reagent plate heatmap with positive controls encircled in red; this example shows positive control sample bleed-over into neighboring plate wells. <bold>(E)</bold> Read abundance values across a reagent plate showing potential dispensing robot failure after column 8. <bold>(F)</bold> A Lorenz curve showing the distribution of on-target reads across sequence barcodes. A live FQC example site is available at: <ext-link ext-link-type="uri" xlink:href="https://pnnl.github.io/fqc/">https://pnnl.github.io/fqc/</ext-link></p>
      </caption>
      <graphic xlink:href="btx373f1"/>
    </fig>
    <p>The extensibility of the dashboard provides various ways to employ the visualizations in practice. In a sequencing facility, FQC can be used to plot abundances across reagent plates to show the spatial relationships of read abundance and illustrate effects of a positive control (<xref ref-type="fig" rid="btx373-F1">Fig. 1D</xref>) or view amplification bias per plate (<xref ref-type="fig" rid="btx373-F1">Fig. 1E</xref>), crucial information for internal QC. The distribution of reads across barcodes can be viewed as a Lorenz curve to quickly evaluate loading concentrations (<xref ref-type="fig" rid="btx373-F1">Fig. 1F</xref>). Additional associated data or summary data that is not suitable for plotting can be displayed as a table with pagination and sortable columns.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>FQC can track standard FASTQ quality metrics while serving a website and being trivially extensible with additional CSV data. The CLI wraps FastQC and builds the website with default QC metrics upon which one can expand without additional programming. The CLI and dashboard lower the threshold of performing and following up on quality issues that may be apparent upon visual inspection and it promotes evidence-based protocol changes in sequencing facilities to generate better quality data.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This research was supported by the Microbiomes in Transition Initiative LDRD Program at the Pacific Northwest National Laboratory, a multi-program national laboratory operated by Battelle for the DOE under Contract DE-AC06-76RL01830.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>Reference</title>
    <ref id="btx373-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ewels</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>MultiQC: Summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3047</fpage>–<lpage>3048</lpage>.<pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
