<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7068949</article-id>
    <article-id pub-id-type="publisher-id">6636</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-6636-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MHiC, an integrated user-friendly tool for the identification and visualization of significant interactions in Hi-C data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Khakmardan</surname>
          <given-names>Saman</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1172-1941</contrib-id>
        <name>
          <surname>Rezvani</surname>
          <given-names>Mohsen</given-names>
        </name>
        <address>
          <email>mrezvani@shahroodut.ac.ir</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pouyan</surname>
          <given-names>Ali Akbar</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fateh</surname>
          <given-names>Mansoor</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Alinejad-Rokny</surname>
          <given-names>Hamid</given-names>
        </name>
        <address>
          <email>h.alinejad@ieee.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0618 762X</institution-id><institution-id institution-id-type="GRID">grid.440804.c</institution-id><institution>Faculty of Computer Engineering, </institution><institution>Shahrood University of Technology, </institution></institution-wrap>Shahrood, Iran </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4902 0432</institution-id><institution-id institution-id-type="GRID">grid.1005.4</institution-id><institution>Systems Biology and Health Data Analytics Lab, The Graduate School of Biomedical Engineering, UNSW Sydney, </institution></institution-wrap>Sydney, 2052 Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4902 0432</institution-id><institution-id institution-id-type="GRID">grid.1005.4</institution-id><institution>School of Computer Science and Engineering, </institution><institution>The University of New South Wales (UNSW Sydney), </institution></institution-wrap>Sydney, 2052 Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>225</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Hi-C is a molecular biology technique to understand the genome spatial structure. However, data obtained from Hi-C experiments is biased. Therefore, several methods have been developed to model Hi-C data and identify significant interactions. Each method receives its own Hi-C data structure and only work on specific operating systems.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We introduce MHiC (Multi-function Hi-C data analysis tool), a tool to identify and visualize statistically signifiant interactions from Hi-C data. The MHiC tool (i) works on different operating systems, (ii) accepts various Hi-C data structures from different Hi-C analysis tools such as HiCUP or HiC-Pro, (iii) identify significant Hi-C interactions with GOTHiC, HiCNorm and Fit-Hi-C methods and (iv) visualizes interactions in Arc or Heatmap diagram. MHiC is an open-source tool which is freely available for download on <ext-link ext-link-type="uri" xlink:href="https://github.com/MHi-C">https://github.com/MHi-C</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">MHiC is an integrated tool for the analysis of high-throughput chromosome conformation capture (Hi-C) data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Chromosome conformation capture</kwd>
      <kwd>Hi-C</kwd>
      <kwd>Statistically significant interactions</kwd>
      <kwd>Hi-C data visualization</kwd>
      <kwd>Contact map</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Chromosome conformation capture (3C) assays are now the method of choice to study the role of DNA looping in transcriptional regulation. These assays directly identify genomic loci that are in close enough proximity to each other in living cells to be cross-linked. This new technology allows for the mapping of chromatin interactions on a whole genome level. The first study of 3C technology was developed by Dekker et al. [<xref ref-type="bibr" rid="CR1">1</xref>]. This protocol captures interactions between a single pair of candidate regions. The other protocols include 4C (chromosome conformation capture-on-chip) which captures interactions between one locus and all other genomic loci [<xref ref-type="bibr" rid="CR2">2</xref>], 5C (chromosome conformation capture carbon copy) which captures interactions between all locus within a given region [<xref ref-type="bibr" rid="CR3">3</xref>], and Hi-C which captures all vs all interactions across the genome [<xref ref-type="bibr" rid="CR4">4</xref>]. Hi-C is a high-throughput technique to understand the spatial organization of chromosomes by finding all of the nuclear interactions. Capture based methods are also developed to use biotinylated RNA oligomers complementary to enrich 3C and Hi-C libraries for specific loci of interest. These methods include Capture-C, Capture-3C, and Capture Hi-C.</p>
    <p id="Par10">The central goal in the analysis of Hi-C data is to understand which pair of genomic loci tends to interact together. Unfortunately, due to the Hi-C protocol and process, data obtained from Hi-C is biased. Therefore, normalization of Hi-C data and the identification of true interactions compared to artefact interactions is important before any downstream analysis. In Hi-C data, there are different sources of bias. The source of some types of these biases are known. For instance, spurious self-ligated interactions and PCR duplicates are easily handled at the start of Hi-C data processing from Hi-C raw data. In contrast, there are some unknown sources of bias which cannot be identified directly, and only their effect on some features can be identified. An example is ligations between two noncrosslinked DNA fragments. These interactions are indistinguishable from real interactions.</p>
    <p id="Par11">Several methods have been developed to deal with the biases such as GOTHiC [<xref ref-type="bibr" rid="CR5">5</xref>], HiCNorm [<xref ref-type="bibr" rid="CR6">6</xref>], and Fit-Hi-C [<xref ref-type="bibr" rid="CR7">7</xref>]. GOTHiC is a method proposed by Mifsud et al. It uses cumulative binomial tests to identify significant interactions between distal genomic loci that have significantly more reads than expected by chance in Hi-C experiments. It can be used for both Hi-C and capture Hi-C experiments. HiCNorm models biases at lower resolutions and uses Poisson regression to normalize read counts between two-locus pair. Another method, Fit-Hi-C uses the binomial distribution to model these interactions. This method modifies the binning procedure with a two-step spline-fitting procedure. This method replaces the binning procedure with a spline-fitting procedure.</p>
    <p id="Par12">One of the main issues with these methods are that they accept a contact map in a very strict format. In other words, users need to convert the Hi-C contact map generated by Hi-C data analysis tools such as HiCUP [<xref ref-type="bibr" rid="CR8">8</xref>] or HiC-Pro [<xref ref-type="bibr" rid="CR9">9</xref>] to a specific format that is accepted by each background model.</p>
    <p id="Par13">In order to address the above mentioned challenges in Hi-C tools, we have developed an integrated tool called “MHiC” (Multi-function Hi-C data analysis software), which uses GOTHiC, HiCNorm and Fit-Hi-C methods with a graphical user interface (GUI) to identify statistically significant interactions in Hi-C contact maps generated by different Hi-C analysis tool. MHiC accepts HiCUP [<xref ref-type="bibr" rid="CR8">8</xref>], HiC-Pro [<xref ref-type="bibr" rid="CR9">9</xref>] and HOMER [<xref ref-type="bibr" rid="CR10">10</xref>] outputs which are used to analyze raw Hi-C data and generate a Hi-C contact map, as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. MHiC also offers a flexible visualization interface to visualize raw Hi-C contact map or statistically significant interactions in both an Arc diagram and a standard Hi-C contact map (Heatmap diagram). Arc diagrams use circular nodes to show locus positions. For each interaction, an Arc link is drawn between two nodes.
<fig id="Fig1"><label>Fig. 1</label><caption><p>MHiC overview flowchart</p></caption><graphic xlink:href="12864_2020_6636_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par14">In the next sections, we describe the implemented background models in MHiC and the visualization part (Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>). We applied MHiC on a mouse embryonic stem cell sample from the Dixon database [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Method and materials</title>
    <sec id="Sec3">
      <title>Input data for MHiC</title>
      <p id="Par15">MHiC accepts contact maps (Hi-C interactions) on three different formats generated by leading Hi-C analysis tools HiCUP, HiC-Pro, and Homer. MHiC accepts contact maps (Hi-C interactions) on three different formats generated by leading Hi-C analysis tools HiCUP, HiC-Pro, and Homer. After getting contact maps from these tools, MHiC converts it to a single matrix with at least 5 columns: id, fragment 1 chromosome, fragment 2 chromosome, fragment 1 start position, and fragment 2 start position (for HiCNorm method this matrix has 8 columns including GC content, effective length, and mappability features). Then, MHiC does some preprocess on data; such as changing the data resolution, calculating mid locus positions or removing diagonal interactions. In the next step, data format changes to GOTHiC, HiCNorm, or Fit-Hi-C background models formats based on user needs. In the final step, MHiC store and visualize the result from the modeling result.</p>
    </sec>
    <sec id="Sec4">
      <title>HiCUP</title>
      <p id="Par16">HiCUP [<xref ref-type="bibr" rid="CR8">8</xref>] is a pipeline produced by the Babraham Institute to map and perform quality control on Hi-C data. HiCUP outputs include two text files. The first is a file with four columns: id, flag, chromosome and locus position. The second is a digest file which includes chromosome ID, fragment start position and fragment end position. In the first file, two separate rows with the same ID define an interaction. In order to create this structure, users should use the hicup2gothic script, which is available as a HiCUP tool.</p>
    </sec>
    <sec id="Sec5">
      <title>HiC-pro</title>
      <p id="Par17">HiC-Pro [<xref ref-type="bibr" rid="CR9">9</xref>] is developed by Nicolas Servant to process Hi-C data from raw FASTQ files into the normalized contact maps. The HiC-Pro output is a matrix file with three columns: Locus1 ID, Locus2 ID and Interaction counts (number of interacting read between two locus), and a bed file with four columns: chromosome ID, fragment start position, fragment end position, and fragment ID.</p>
    </sec>
    <sec id="Sec6">
      <title>Homer</title>
      <p id="Par18">HOMER [<xref ref-type="bibr" rid="CR10">10</xref>] is an analysis tool that contains several programs and analysis routines to facilitate the analysis of Hi-C data. In the Hi-C data processing section, HOMER process FASTQ and bowtie2 files to map and perform quality control on Hi-C data. In this process, HOMER creates some CSV files to define Hi-C interactions for the next processing steps. In order to create this structure, users should visit the HOMER website (<ext-link ext-link-type="uri" xlink:href="http://homer.ucsd.edu">http://homer.ucsd.edu</ext-link>).</p>
      <p id="Par19">To identify Hi-C significant interactions and visualize Hi-C contact maps, we have developed MHiC in two main modules. The first module of MHiC is implemented as an R package to provide multiple backgrounds and correction models. The second module is a user-friendly graphical interface, which provides an interactive environment for users to plot Hi-C interactions in both an Arc diagram and a contact map diagram. MHiC accepts input data from different tools such as HiCUP, HiC-Pro and HOMER and then identifies significant interactions through the GOTHiC, HiCNorm and Fit-Hi-C methods at a desired resolution of the contact map.</p>
    </sec>
    <sec id="Sec7">
      <title>Identifying significant interaction with MHiC</title>
      <p id="Par20">We developed MHiC based on the GOTHiC, HiCNorm, and Fit-Hi-C background models. These methods use different mathematical models to identify significant interactions. In the following, we explain each of the models in detail.</p>
    </sec>
    <sec id="Sec8">
      <title>GOTHiC</title>
      <p id="Par21">GOTHiC was developed by Mifsud et al. This method assumes both ends of each read-pair are affected by biases. Therefore, the probability of observing <italic>n</italic><sub><italic>j</italic>, <italic>h</italic></sub> or more read-pairs between two loci, j and h, by chance in a dataset of N reads is given by the cumulative binomial density:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ pva{l}_{j,h}=1-{\sum}_{i=0}^{n_{j,h}-1}\left(\underset{i}{N}\right){\left({p}_{j,h}\right)}^i\left(1-{p}_{j,h}\right){N}^{-i} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi mathvariant="italic">pva</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>∑</mml:mo><mml:msubsup><mml:mrow/><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:munder><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:munder></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where the probability that a read pair is the consequence of a spurious ligation between two sites is:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_{j,h}=2\ast relativecoverag{e}_j\ast relativecoverag{e}_h $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">relativecoverag</mml:mtext><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">relativecoverag</mml:mtext><mml:msub><mml:mi>e</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par22">Immediately following eq. <xref rid="Equ2" ref-type="">2</xref>, the relative coverage of a given site or region is:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ relativecoverag{e}_j=\frac{reads_j}{2N} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mtext mathvariant="italic">relativecoverag</mml:mtext><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mtext mathvariant="italic">reads</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>reads</italic><sub><italic>j</italic></sub> is the mapped read count for genomic locus<sub>j</sub>. After calculating the probabilities, this method uses the Benjamini-Hochberg multiple-testing correction to obtain a false discovery rate adjusted <italic>p</italic>-value (q-value), which is used to find significant interactions. The Benjamini-Hochberg Procedure is a technique that decreases the false discovery rate. Adjusting the rate helps to control the fact that sometimes small <italic>p</italic>-values (less than 5%) happen by chance, which could lead you to incorrectly reject the true null hypotheses. In this method, the p-values are first sorted and ranked. Then, each p-value is multiplied by m, the number of comparisons, and divided by its assigned rank, r<sub>j, h</sub>, to give the adjusted p-values.
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ qva{l}_{j,h}= pva{l}_{j,h}\ast \frac{m}{r_{j,h}} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi mathvariant="italic">qva</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">pva</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par23">In this method <italic>m</italic> is described as maximum number of interactions between all regions.</p>
    </sec>
    <sec id="Sec9">
      <title>HiCNorm</title>
      <p id="Par24">HiCNorm was developed by Ming Hu et al.<italic>.</italic> HiCNorm assumes a Poisson distribution to model sequencing errors and artefacts. It normalizes Hi-C contact maps and estimate the bias effects by using the effective length feature and the GC content feature while fixing the mappability feature as a Poisson offset. In this process, the normalized Hi-C contact map (<italic>e</italic>) for chromosome <italic>i</italic> at locus <italic>j</italic> and <italic>h</italic> is calculated based on effective length feature (<italic>x</italic>), GC content feature (<italic>y</italic>), the mappability feature (<italic>z</italic>) and Hi-C contact map <italic>u</italic>. The equations for intra-chromosomal Hi-C interactions follow as:
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {e}_{j,h}^i=\frac{u_{j,h}^i}{t_{j,h}^i} $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>t</italic> calculated by:
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {t}_{j,h}^i=\exp \left[{\beta}_0^i+{\beta}_{len}^i\lg \left({x}_j^i{x}_h^i\right)+{\beta}_{gc}^i\lg \left({y}_j^i{y}_h^i\right)+\lg \left({z}_j^i{z}_h^i\right)\right] $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi mathvariant="italic">len</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>lg</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gc</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>lg</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>lg</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>z</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par25">Equations for the intra-chromosomal Hi-C interactions between chromosomes <italic>i</italic><sub>1</sub> and <italic>i</italic><sub>2</sub> are:
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {e}_{j,h}^{i_1{i}_2}=\frac{u_{j,h}^{i_1{i}_2}}{t_{j,h}^{i_1{i}_2}} $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>t</italic> is calculated by:
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {t}_{j,h}^{i_1{i}_2}=\exp \left[{\beta}_0^{i_1{i}_2}+{\beta}_{len}^{i_1{i}_2}\lg \left({x}_j^{i_1}{x}_h^{i_2}\right)+{\beta}_{gc}^{i_1{i}_2}\lg \left({y}_j^{i_1}{y}_h^{i_2}\right)+\lg \left({z}_j^{i_1}{z}_h^{i_2}\right)\right] $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi mathvariant="italic">len</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>lg</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gc</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>lg</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>lg</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>z</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec10">
      <title>Fit-Hi-C</title>
      <p id="Par26">The Fit-Hi-C method was developed by Ferhat Ay et al.. This method uses a binomial distribution and works on intra-chromosomal interactions. In the first step, this method assumes that a single observed contact is equally likely to come from any of the M possible pairs of loci, so the null probability of this contact being between a specific locus pair is <italic>p</italic> = 1/M. Therefore, the probability of a given pair that has an exactly k contact count is:
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathit{\Pr}\left(K=k\right)=\left(\begin{array}{l}N\\ {}k\end{array}\right){p}^k{\left(1-p\right)}^{N-k} $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mo mathvariant="italic">Pr</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:msup><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par27">The <italic>P</italic>-value is the corresponding cumulative probability of observing at least k contacts is:
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left(K\ge k\right)=\sum \limits_{i=K}^N\mathit{\Pr}\left(\mathrm{K}=\mathrm{i}\right) $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>≥</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo mathvariant="italic">Pr</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par28">In the second step, this method replaces the binned binomial method (contact probability <italic>p)</italic> with a spline-fitting procedure that provides a more precise estimate of the probability of observing a contact with a specified genomic distance (<italic>d</italic><sub><italic>j</italic>, <italic>h</italic></sub>). In other words, Fit-Hi-C replaces in Eq. (<xref rid="Equ9" ref-type="">9</xref>) the contact probability p with a function f <sup>(1)</sup>(d) which is computed by a spline fit to observe contact probabilities of locus pairs based on their genomic distances. To achieve a smooth spline fit, this method segregate the locus pairs into <italic>b</italic> equal-occupancy bins (in this method b = 200). The smallest distances in bin <italic>i</italic> and bin <italic>i + 1</italic> define the lower and upper genomic distance boundaries, <italic>s</italic><sub><italic>i</italic></sub> and <italic>e</italic><sub><italic>i</italic></sub>, respectively, for bin <italic>i</italic>. Then, for each bin <italic>i</italic>, this method computes three values: (1) the average number of contact counts per locus pair (<italic>c</italic><sub><italic>i</italic></sub>); (2) the prior contact probability that a given mid-range read comes from one specific locus pair in this bin <inline-formula id="IEq1"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{{\mathrm{c}}_{\mathrm{i}}}{\mathrm{N}} $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:mfrac><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mi mathvariant="normal">N</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12864_2020_6636_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>N</italic> is the total number of mid-range reads; and (3) the average interaction distance <italic>d</italic><sub><italic>i</italic></sub> over all locus pairs in the bin, including pairs that have a contact count of zero. This method then fits a univariate spline to the resulting b points <inline-formula id="IEq2"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left(\left({d}_i,\frac{c_i}{\mathrm{N}}\right),\dots, \left(\ {d}_b,\frac{c_i}{\mathrm{N}}\right)\right) $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:mfenced close=")" open="(" separators=",,"><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="normal">N</mml:mi></mml:mfrac></mml:mfenced><mml:mo>…</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mspace width="0.25em"/><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mfrac><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="normal">N</mml:mi></mml:mfrac></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6636_Article_IEq2.gif"/></alternatives></inline-formula>.
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}^{(1)}(d)=\sum \limits_{i=K}^b{f}^{(1)}\left({d}_i\right){\mathrm{f}}_i(d) $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msup><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>d</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:munderover><mml:msup><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:msub><mml:mi mathvariant="normal">f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>d</mml:mi></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6636_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par29">In the third step, this method uses a two-phase spline fitting procedure to modify the binning method, which involves producing a more accurate estimate of the null distribution by excluding contacts that are likely to be real.</p>
    </sec>
    <sec id="Sec11">
      <title>Visualize Hi-C interactions</title>
      <p id="Par30">In MHiC, we developed a Graphical User Interface for MHiC. The Interface enables the user to set parameters, generate significant interactions and also visualize Hi-C contact maps. We implemented the visualization as a HTML page to show Hi-C interactions on an Arc diagram or a Heatmap. The MHiC user interface contains two sections: 1) call background models to detect statistically significant interactions; 2) visualization options to visualize a Hi-C contact map. You can find more details about parameters related to each section in the user manual supplementary file.</p>
    </sec>
    <sec id="Sec12">
      <title>Data</title>
      <p id="Par31">The visualization part of MHiC needs a file with five columns (chr1, locus1, chr2, locus2 and readCount) to create an Arc diagram or a Heatmap diagram.</p>
    </sec>
    <sec id="Sec13">
      <title>Arc diagram</title>
      <p id="Par32">The Arc diagram only works on cis interactions. The number of interacting reads between two regions impacts on the thickness of the Arc link. Users can change the data resolution without doing any process of changing data resolution. In addition, MHiC can visualize interactions in a specific range of fragments and also users can select each fragment and visualize that region’s interactions. In addition, users can easily set a threshold for read counts to remove interactions that has fewer read counts than the threshold. MHiC can import different annotation files to show on top of the Arc Diagram and it can show valid interactions by changing colors or removing invalid interactions. This is also noticeable that the user can change the diagram’s colors if they need it.</p>
    </sec>
    <sec id="Sec14">
      <title>Contact map Heatmap</title>
      <p id="Par33">The Contact map diagram draws a Heatmap of interactions. The Heatmap Diagram can show interactions within a single chromosome multiple chromosomes or whole genome. In this diagram, the number of interacting reads or <italic>p</italic>-value between two regions impacts on the interaction’s color. Users can select interactions color range so when a user selects yellow and black, the interaction read count will show in the range between these colors. Also, the contact map diagram has the same options as the Arc Diagram except it can show the whole genome or inter-interactions.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Results</title>
    <p id="Par34">To examine the performance of MHiC, we applied MHiC on data from mouse embryonic stem cell sample from Dixon database. All the analysis was performed on a system with 8-Gigabyte ram and core i7 CPU.</p>
    <p id="Par35">First, we used HiC-Pro to generate Hi-C interactions and make the contact maps on bin-size 500Kb and 1 Mb. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the database histogram, and Table <xref rid="Tab1" ref-type="table">1</xref> presents the statistical summary of HiC-Pro. As one can see in this table, HiC-Pro detected 41,006,364 interactions. We used these interactions as the input for MHiC.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Database histogram. <bold>a</bold> Dixon Chromosome 1 interactions histogram in 500Kb resolution. <bold>b</bold> Dixon Chromosome 1 interactions histogram in 1 Mb resolution</p></caption><graphic xlink:href="12864_2020_6636_Fig2_HTML" id="MO2"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Dixon Database information after applying to HiC-Pack</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Interaction Counts</th><th>Average read counts</th><th>bin-size</th><th>Total read counts</th><th>intra-chromosomal interactions</th><th>inter-chromosomal interactions</th></tr></thead><tbody><tr><td>41,006,364</td><td char="." align="left">1.36</td><td>100 kb</td><td char="." align="left">56,168,196</td><td char="." align="left">5,225,136</td><td char="." align="left">35,781,228</td></tr></tbody></table></table-wrap></p>
    <p id="Par36">We run MHiC with two different settings (for GOTHiC and Fit-Hi-C methods) to create background models from the Dixon dataset chromosome 1. GOTHiC and Fit-Hi-C identified 5362 and 12,351 significant interactions on bin-size 500Kb and 3027 and 7062 significant interactions on bin-size 1 Mb. Also, for this dataset HiCNorm method need at least 12-Gigabyte ram to run smoothly. Therefore, we did not use this method outputs in results. These results are available in Table <xref rid="Tab2" ref-type="table">2</xref>. Then, we used both raw Hi-C interactions and significant interactions identified by GOTHiC and Fit-Hi-C to visualize the interactions in both the Arc diagram and Heatmap plots (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Dixon database Chromosome 1 information after applying HiC-Pack to MHiC at 500Kb and 1 Mb. In this table, the first row shows the number of interactions and average read counts before applying to MHiC. The GOTHiC and Fit-Hi-C rows show the number of significant interactions and its average read counts for each method</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Methods</th><th>Interactions in 500Kb</th><th>Average read counts</th><th>Interactions in 1 Mb</th><th>Average read counts</th></tr></thead><tbody><tr><td>Raw</td><td>Total: 98912</td><td>11.73</td><td>Total: 26302</td><td>40.49</td></tr><tr><td>GOTHiC</td><td>Significant: 5362</td><td>84.12</td><td>Significant: 3027</td><td>153.49</td></tr><tr><td>Fit-Hi-C</td><td>Significant: 12351</td><td>76.91</td><td>Significant: 7062</td><td>141.07</td></tr></tbody></table></table-wrap>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Hi-C interactions Heatmap diagram at 500Kb and 1 Mb resolutions for the entire Dixon chromosome 1, which was modeled by GOTHiC. <bold>a</bold> raw interactions contact map for chromosome 1 at 1 Mb resolution. <bold>b</bold> valid interactions contact map for chromosome 1 showed with red color for 500Kb and 1 Mb resolution</p></caption><graphic xlink:href="12864_2020_6636_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Hi-C interactions Arc diagram at 500Kb and 1 Mb resolutions for the entire Dixon chromosome 1, which was modeled by GOTHiC. <bold>a</bold> Arc diagrams to show interactions which have at least 50 read counts for 500Kb resolution and 100 read counts for 1 Mb resolution. <bold>b</bold> significant interactions’ Arc diagram</p></caption><graphic xlink:href="12864_2020_6636_Fig4_HTML" id="MO4"/></fig>
<fig id="Fig5"><label>Fig. 5</label><caption><p>Hi-C interactions Heatmap diagram and Arc diagram at 500Kb and 1 Mb resolutions for the entire Dixon chromosome 1, which was modeled by Fit-Hi-C. <bold>a</bold> interactions contact map for chromosome 1. <bold>b</bold> Arc diagrams to show interactions which have at least 50 read counts for 500Kb resolution and 100 read counts for 1 Mb resolution</p></caption><graphic xlink:href="12864_2020_6636_Fig5_HTML" id="MO5"/></fig></p>
    <p id="Par37">In the Arc diagrams the annotations are shown on the top. We used an option in MHiC to annotate Hi-C interactions by ENCODE predicted promoters and enhancers. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows enhancers and promoters coloured yellow and the promoters strand direction shown in blue. We also also generate a whole-genome contact map in 1 Mb bin-size from GOTHiC output which show interactions have at least 100 read counts (Fig. <xref rid="Fig7" ref-type="fig">7</xref>).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Hi-C interactions Heatmap diagram and Arc diagram with annotations at 1 Mb resolutions for the entire Dixon chromosome 19, which was modeled by GOTHiC. <bold>a</bold> raw interactions contact map. <bold>b</bold> Arc diagram to shows interactions that have at least 100 read counts with annotation</p></caption><graphic xlink:href="12864_2020_6636_Fig6_HTML" id="MO6"/></fig>
<fig id="Fig7"><label>Fig. 7</label><caption><p>Hi-C interactions Heatmap diagram and Arc diagram with annotations at 1 Mb resolutions for the entire Dixon dataset. This diagram shows interactions that have at least 100 read counts</p></caption><graphic xlink:href="12864_2020_6636_Fig7_HTML" id="MO7"/></fig></p>
  </sec>
  <sec id="Sec16">
    <title>Conclusions</title>
    <p id="Par38">In this article, we introduce MHiC. Currently MHiC has two main sections for modeling and visualizing Hi-C data. The tool is capable of receiving procced Hi-C data from different pipelines and identify statistically significant interactions by different Hi-C background models. MHiC also enables users to visualize interactions. The visualization section is able to create an Arc or Heatmap diagram from both the raw or the significant interactions.</p>
  </sec>
  <sec id="Sec17">
    <title>Availability and requirements</title>
    <p id="Par39">Project name: MHiC</p>
    <p id="Par40">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/MHi-C/MHiC">https://github.com/MHi-C/MHiC</ext-link></p>
    <p id="Par41">Operating system(s): Platform independent</p>
    <p id="Par42">Programming language: R and JavaScript</p>
    <p id="Par43">Other requirements: R 3.6.1</p>
    <p id="Par44">License: GNU GPL.</p>
    <p id="Par45">Any restrictions to use by non-academics: License is not needed.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2020_6636_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> MHiC classes and functions. Description of all functions and classes available in MHiC.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2020_6636_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> MHiC user interface. Description of MHiC UI and MHiC visualization section.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>3C</term>
        <def>
          <p id="Par4">Chromosome conformation capture</p>
        </def>
      </def-item>
      <def-item>
        <term>4C</term>
        <def>
          <p id="Par5">Chromosome conformation capture-on-chip</p>
        </def>
      </def-item>
      <def-item>
        <term>5C</term>
        <def>
          <p id="Par6">Chromosome conformation capture carbon copy</p>
        </def>
      </def-item>
      <def-item>
        <term>GC</term>
        <def>
          <p id="Par7">Guanine-cytosine</p>
        </def>
      </def-item>
      <def-item>
        <term>Hi-C</term>
        <def>
          <p id="Par8">High-throughput chromosome conformation capture</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-020-6636-7.</p>
  </sec>
  <ack>
    <p>Not Applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>HAR designed the study. SK wrote the manuscript. HAR, MR, and SK edited the manuscript. HAR, MR, AAP, and MF participated in setting requirements, testing the software and suggesting improvements. SK carried out all the analyses including the tool implementation, statistical analyses, and visualization. SK generated all figures and tables. All authors have read and approved the final version of the paper.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by grants to HAR and MR. HAR is currently supported by the UNSW Scientia Fellowship. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>In this paper, we use mouse embryonic stem cell sample from Dixon database which can be accessed at <ext-link ext-link-type="uri" xlink:href="http://promoter.bx.psu.edu/hi-c/download.html">http://promoter.bx.psu.edu/hi-c/download.html</ext-link>. Also, the MHiC source code available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MHi-C/MHiC">https://github.com/MHi-C/MHiC</ext-link>. The HiC-Pro Outputs from Dixon dataset and MHiC user interface can be accessed at <ext-link ext-link-type="uri" xlink:href="https://github.com/MHi-C/MHiCUI">https://github.com/MHi-C/MHiCUI</ext-link>. For more details about each parameter, please visit the GitHub page of the project.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par46">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par47">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par48">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rippe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kleckner</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Capturing chromosome conformation</article-title>
        <source>Science (80- )</source>
        <year>2002</year>
        <volume>295</volume>
        <fpage>1306</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1067799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simonis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klous</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Splinter</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Moshkin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Willemsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>De Wit</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture-on-chip (4C)</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>1348</fpage>
        <lpage>1354</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1896</pub-id>
        <?supplied-pmid 17033623?>
        <pub-id pub-id-type="pmid">17033623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Arnaout</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Selzer</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Honan</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome conformation capture carbon copy (5C): a massively parallel solution for mapping interactions between genomic elements</article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>1299</fpage>
        <lpage>1309</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5571506</pub-id>
        <?supplied-pmid 16954542?>
        <pub-id pub-id-type="pmid">16954542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science (80- )</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Mifsud B, Martincorena I, Darbo E, Sugar R, Schoenfelder S, Fraser P, et al. GOTHiC, a probabilistic model to resolve complex biases and to identify real interactions in Hi-C data. PLoS One. 2017;12. 10.1371/journal.pone.0174744.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>HiCNorm: removing biases in Hi-C data via Poisson regression</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3131</fpage>
        <lpage>3133</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts570</pub-id>
        <?supplied-pmid 23023982?>
        <pub-id pub-id-type="pmid">23023982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>999</fpage>
        <lpage>1011</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.160374.113</pub-id>
        <?supplied-pmid 24501021?>
        <pub-id pub-id-type="pmid">24501021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Wingett S, Ewels P, Furlan-Magaril M, Nagano T, Schoenfelder S, Fraser P, <italic>et al</italic>. HiCUP: Pipeline for mapping and processing Hi-C data. F1000Research 2015;4. doi:10.12688/f1000research.7334.1.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Servant N, Varoquaux N, Lajoie BR, Viara E, Chen CJ, Vert JP, et al. HiC-pro: an optimized and flexible pipeline for Hi-C data processing. Genome Biol. 2015;16. 10.1186/s13059-015-0831-x.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Laslo</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <?supplied-pmid 2898526?>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <?supplied-pmid 22495300?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
