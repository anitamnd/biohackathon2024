<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6915855</article-id>
    <article-id pub-id-type="publisher-id">3204</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3204-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Deconvoluting the diversity of within-host pathogen strains in a multi-locus sequence typing framework</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gan</surname>
          <given-names>Guo Liang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Willie</surname>
          <given-names>Elijah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chauve</surname>
          <given-names>Cedric</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chindelevitch</surname>
          <given-names>Leonid</given-names>
        </name>
        <address>
          <email>leonid@sfu.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7494</institution-id><institution-id institution-id-type="GRID">grid.61971.38</institution-id><institution>School of Computing Science, Simon Fraser University, </institution></institution-wrap>8888 University Drive, Burnaby (BC), V5A 1S6 Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7494</institution-id><institution-id institution-id-type="GRID">grid.61971.38</institution-id><institution>Department of Mathematics, </institution><institution>Simon Fraser University, </institution></institution-wrap>8888 University Drive, Burnaby (BC), V5A 1S6 Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2289 8198</institution-id><institution-id institution-id-type="GRID">grid.503269.b</institution-id><institution>LaBRI, Université de Bordeaux, </institution></institution-wrap>351 Cours de la Libération, Talence, 33405 France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 20</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>637</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Bacterial pathogens exhibit an impressive amount of genomic diversity. This diversity can be informative of evolutionary adaptations, host-pathogen interactions, and disease transmission patterns. However, capturing this diversity directly from biological samples is challenging.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We introduce a framework for understanding the within-host diversity of a pathogen using multi-locus sequence types (MLST) from whole-genome sequencing (WGS) data. Our approach consists of two stages. First we process each sample individually by assigning it, for each locus in the MLST scheme, a set of alleles and a proportion for each allele. Next, we associate to each sample a set of strain types using the alleles and the strain proportions obtained in the first step. We achieve this by using the smallest possible number of previously unobserved strains across all samples, while using those unobserved strains which are as close to the observed ones as possible, at the same time respecting the allele proportions as closely as possible. We solve both problems using mixed integer linear programming (MILP). Our method performs accurately on simulated data and generates results on a real data set of <italic>Borrelia burgdorferi</italic> genomes suggesting a high level of diversity for this pathogen.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Our approach can apply to any bacterial pathogen with an MLST scheme, even though we developed it with <italic>Borrelia burgdorferi</italic>, the etiological agent of Lyme disease, in mind. Our work paves the way for robust strain typing in the presence of within-host heterogeneity, overcoming an essential challenge currently not addressed by any existing methodology for pathogen genomics.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Multi-Locus Sequence Typing</kwd>
      <kwd>Bacterial diversity</kwd>
      <kwd>Integer Linear Programming</kwd>
    </kwd-group>
    <conference xlink:href="https://recombcg2019.bitbucket.io/">
      <conf-name>17th RECOMB Satellite Conference on Comparative Genomics</conf-name>
      <conf-acronym>RECOMB-CG 2019</conf-acronym>
      <conf-loc>Montpellier, France</conf-loc>
      <conf-date>1-4 October 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The study of bacterial pathogens has revealed an impressive genetic diversity that had not been fully suspected prior to the advent of genome sequencing technologies. This diversity may indicate an adaptive response to challenges such as the variability in host genetics, environmental conditions, and, in the case of pathogens affecting humans, the introduction of antibacterial drugs [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>One bacterial pathogen that is particularly well-known for its genetic diversity is <italic>Borrelia burgdorferi</italic>, the etiological agent of Lyme disease. It has been found that up to six genetically different strains can affect a single host [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Furthermore, this diversity may result from both clonal evolution within the host as well as multiple infection events [<xref ref-type="bibr" rid="CR7">7</xref>]. Unfortunately, techniques such as bacterial culture are difficult to apply to reveal the whole range of diversity in bacteria like <italic>B. burgdorferi</italic>, a situation common to many bacterial pathogens. Next-generation sequencing (NGS) techniques such as whole-genome sequencing (WGS) with short reads have revolutionized our ability to investigate the genomic diversity of bacteria and other organisms [<xref ref-type="bibr" rid="CR8">8</xref>]. Recently, an adaptation of WGS technology to <italic>B. burgdorferi</italic>, called whole-genome capture, has been proposed which is able to reliably filter out irrelevant DNA (such as host DNA) [<xref ref-type="bibr" rid="CR9">9</xref>]. This novel approach for generating sequence data for <italic>B. burgdorferi</italic> nicely complements a highly reproducible strain-typing scheme known as multi-locus sequence typing (MLST), which has been developed and found to be useful for different pathogens in a number of contexts [<xref ref-type="bibr" rid="CR10">10</xref>]. MLST is a summary of the bacterial genotype using the alleles of several (typically 6 to 9) housekeeping genes, which may be further grouped into closely related strain types. In the case of <italic>B. burgdorferi</italic>, several hundred strain types have been characterized using the MLST scheme developed in [<xref ref-type="bibr" rid="CR11">11</xref>], while only 111 fully sequenced <italic>B. burgdorferi</italic> genomes<xref ref-type="fn" rid="Fn1">1</xref> are currently available in the NCBI databases. MLST strain types thus provide a finer-grained picture of the strain diversity of this pathogen, which motivates the need for developing novel diversity estimation methods that combine NGS data and the wealth of strain types already characterized by MLST.</p>
    <p>In principle, this problem is a special instance of estimating the diversity and abundance of microbial strains from metagenomics data, a problem for which several accurate methods have recently been developed (e.g. [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]). De novo methods, such as DESMAN [<xref ref-type="bibr" rid="CR12">12</xref>], cannot take advantage of known reference strains or alleles and are likely to be confounded by the high similarity observed between strain types. Other methods such as strainEST [<xref ref-type="bibr" rid="CR13">13</xref>] are able to consider a large set of reference genomes, which in our case can be defined by the concatenated allele sequences of the known <italic>B. burgdorferi</italic> strain types, but again, their diversity models are not well adapted to handle the very high similarity between strain types. Moreover, none of the reference-based methods consider the detection of novel strain types.</p>
    <p>We introduce the first paradigm for extracting MLST information in the presence of within-host heterogeneity, which is also able to simultaneously take multiple samples into account and detect novel strains. Our method is based on mixed integer linear programming (MILP), and consists of two main stages. It starts by filtering the short reads in each sample, selecting those that closely match known alleles in at least one of the housekeeping genes in the MLST scheme, and then assigns fractional abundances to each allele of each gene, ensuring that as few such alleles as possible are used to explain the data. In the second stage, it assigns combinations of these alleles, with corresponding proportions, to each sample, while maximizing the usage of known strains and minimizing the number of novel strains, a parsimony-based approach that has been shown to perform well in related contexts [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p>We evaluate our approach on simulated samples and find that it is accurate in identifying both the fractional allele composition at each housekeeping gene, as well as the complete strain types present in each sample. We then apply it to a dataset of 24 real tick samples containing <italic>B. burgdorferi</italic> extracted via whole-genome capture, and find a substantial amount of diversity, as well as a number of new strains. In conclusion, our work provides a robust and reproducible pipeline for accurate strain typing via MLST from WGS data even in the presence of substantial within-host heterogeneity.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p><bold>Terminology.</bold>An <italic>MLST scheme</italic> is composed of a set of loci together with a database of known alleles for each locus [<xref ref-type="bibr" rid="CR16">16</xref>]. An <italic>allele distribution</italic> for a given locus is a set of alleles for this locus together with a proportion assigned to each allele; the proportions must be non-negative and add up to 1. A <italic>strain type</italic> is an assignment of a specific allele to each gene of the MLST scheme. A <italic>strain type distribution</italic> is a set of strain types together with a proportion assigned to each strain type; the proportions must once again be non-negative and add up to 1. A <italic>sample</italic> is a WGS dataset obtained from a single host that contains the sequence data from one or several pathogen strains present in the host (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>A dataset with two samples and an MLST scheme of three loci (genes clpA, clpX, nifS). The strain type distributions require 5 different strains as the strain (clpA_1,clpX_1, nifS_7) appears in both distributions</p></caption><graphic xlink:href="12859_2019_3204_Fig1_HTML" id="MO1"/></fig></p>
    <p><bold>Data.</bold>In the present work we use the traditional <italic>B. burgdorferi</italic> MLST scheme [<xref ref-type="bibr" rid="CR11">11</xref>] composed of 8 housekeeping genes having a combined total of 1726 known alleles. For each locus, the various known alleles differ from one another primarily by single nucleotide polymorphisms (SNPs), with small indels also appearing in 4 out of the 8 genes. The number of known strain types is 753.</p>
    <p><bold>Problems and contribution overview.</bold>The problems we address in this work take as input (1) an MLST scheme together with databases of known alleles and strain types and (2) WGS data for a set of samples that are mapped using a short-read mapper of choice onto the database of known alleles for the provided MLST scheme. It then proceeds in two stages, each addressing a specific problems:
<list list-type="bullet"><list-item><p>The Allele Diversity Problem. For a given sample and a given locus of the MLST scheme, given the mappings of DNA reads onto the known alleles for this locus, detect the alleles present in the sample and the corresponding allele distribution.</p></list-item><list-item><p>The Strain Diversity Problem. Given a set of samples and an allele distribution for each locus at each sample, compute a strain type distribution per sample that requires the smallest number of novel strain types <italic>among all considered samples</italic>, which are as similar as possible to known strains.</p></list-item></list></p>
    <sec id="Sec6">
      <title>The Allele Diversity Problem</title>
      <p>We formulate the problem of allele detection as a variant of the Set Cover problem as follows. The input of the Allele Diversity Problem (ADP) is composed of a set of <italic>m</italic> reads <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}= \{r_{1},\dots \,r_{m}\}$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq1.gif"/></alternatives></inline-formula>, a set of <italic>n</italic> alleles <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {A} = \{a_{1},\dots,a_{n}\}$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq2.gif"/></alternatives></inline-formula> for the chosen locus, and a set of mappings of the reads onto the alleles, encoded by a matrix <italic>M</italic>, where <italic>m</italic><sub><italic>ij</italic></sub> is the sum of the normalized Phred scores of the mismatched bases in the mapping of read <italic>r</italic><sub><italic>i</italic></sub> onto allele <italic>a</italic><sub><italic>j</italic></sub> (we set it to <italic>∞</italic> if <italic>r</italic><sub><italic>i</italic></sub> does not map onto <italic>a</italic><sub><italic>j</italic></sub>). For instance, assuming that the range of acceptable Phred scores is from 33 to 126, if read <italic>r</italic><sub><italic>i</italic></sub> maps to allele <italic>a</italic><sub><italic>j</italic></sub> with 2 mismatches with base quality scores of 60 and 80, respectively, then <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$m_{ij}=\frac {60-33}{126-33} + \frac {80-33}{126-33} = 0.796$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>60</mml:mn><mml:mo>−</mml:mo><mml:mn>33</mml:mn></mml:mrow><mml:mrow><mml:mn>126</mml:mn><mml:mo>−</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>80</mml:mn><mml:mo>−</mml:mo><mml:mn>33</mml:mn></mml:mrow><mml:mrow><mml:mn>126</mml:mn><mml:mo>−</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.796</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq3.gif"/></alternatives></inline-formula>. Each allele <italic>a</italic><sub><italic>j</italic></sub> implicitly defines a subset of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq4.gif"/></alternatives></inline-formula> (the reads aligning with the allele), with each read <italic>r</italic><sub><italic>i</italic></sub> being weighted by <italic>m</italic><sub><italic>ij</italic></sub>. Informally, we then aim at selecting a subset of alleles covering the set of reads, while minimizing the sum of the number of required alleles and the sum of the corresponding weights. The ADP is thus very similar to the Uncapacitated Facility Location Problem, and we discuss this observation in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p>Formally, we define an edge-weighted bipartite graph whose vertex set is <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R} \cup \mathcal {A}$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">R</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq5.gif"/></alternatives></inline-formula> and whose weighted incidence matrix is <italic>M</italic>. A <italic>read cover</italic> is a subset of edges of this graph such that each read belongs to exactly one edge; the cost of a read cover is the number of allele vertices it is incident to plus the sum of the weights of the edges in the cover. The ADP aims at finding a read cover of minimum weight, the allele vertices incident on the edges of the cover representing the selected alleles.</p>
      <sec id="d29e771">
        <title>
          <bold>Theorem 1</bold>
        </title>
        <p>The Allele Diversity Problem is NP-hard.</p>
        <p>The proof of Theorem 1 relies on a reduction from the 3-dimensional matching problem and is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Before describing our ILP we comment on the relevance of our formulation for selecting a set of alleles from short reads. Our objective function aims to minimize the sum of the number of alleles and the weight of each read based on the Phred scores; the latter part aims at explaining the data (reads) using as few errors/mismatches as possible, accounting for the base quality score of the mismatches, while the former part ensures that an allele is not introduced unnecessarily to reduce the contribution of the mismatches and their quality for a small number of reads. Our experiments on simulated data show that this objective function leads to extremely accurate results.</p>
        <p><bold>An Integer Linear Program for the Allele Diversity Problem.</bold>First we introduce the following notation: <italic>R</italic><sub><italic>j</italic></sub>={<italic>r</italic><sub><italic>i</italic></sub>:<italic>m</italic><sub><italic>ij</italic></sub>≠<italic>∞</italic>} represents the set of reads mapping onto allele <italic>a</italic><sub><italic>j</italic></sub> (i.e. covered by allele <italic>a</italic><sub><italic>j</italic></sub>), and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\ M_{i} = \{m_{ij} | 1 \leq j \leq n\} - \{\infty \} = \{q_{i1},..., q_{i|M_{i}|}\}$\end{document}</tex-math><mml:math id="M12"><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>−</mml:mo><mml:mo>{</mml:mo><mml:mi>∞</mml:mi><mml:mo>}</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq6.gif"/></alternatives></inline-formula> represents the distinct summed Phred scores for read <italic>r</italic><sub><italic>i</italic></sub>. The decision variables of the ILP are:
<list list-type="bullet"><list-item><p><italic>x</italic><sub><italic>j</italic></sub>=1 if allele <italic>a</italic><sub><italic>j</italic></sub> is chosen, and 0 otherwise.</p></list-item><list-item><p><italic>y</italic><sub><italic>ik</italic></sub>=1 if a mapping of read <italic>r</italic><sub><italic>i</italic></sub> with score <italic>q</italic><sub><italic>ik</italic></sub> is chosen, and 0 otherwise.</p></list-item></list></p>
        <p>The objective function is <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\min \!\left (\! \sum _{i=1}^{|\mathcal {R}|}\! \sum _{k=1}^{|M_{i}|} q_{ik}\! \cdot \! y_{ik}\! +\!\! \sum _{j=1}^{n}\! x_{j}\!\right)$\end{document}</tex-math><mml:math id="M14"><mml:mo>min</mml:mo><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mspace width="0.3em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>·</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
        <p>Finally, the constraints of the ILP are the following ones:
<list list-type="bullet"><list-item><p>If <italic>y</italic><sub><italic>ik</italic></sub>=1, there exists some allele <italic>a</italic><sub><italic>j</italic></sub> onto which <italic>r</italic><sub><italic>i</italic></sub> maps with score <italic>q</italic><sub><italic>ik</italic></sub>.</p></list-item><list-item><p>There is a unique score with which read <italic>r</italic><sub><italic>i</italic></sub> is mapped onto the selected alleles.</p></list-item></list></p>
        <p>These constraints can be represented as follows:
<disp-formula id="Equa"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sum_{\{j\ |\ r_{i} \in R_{j}, m_{ij} = q_{ik}\}} x_{j} \geq y_{ik} \, \forall \, i,k \hspace{1cm}\sum_{k=1}^{|M_{i}|} y_{ik} = 1 \, \forall \, i. $$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mspace width="28.45274pt"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mspace width="0.3em"/><mml:mi>i.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3204_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p><bold>Post-processing.</bold>If the above 0-1 ILP has multiple optimal solutions, we resort to a likelihood based method to select one, namely GAML [<xref ref-type="bibr" rid="CR17">17</xref>], a probabilistic model for genome assembly. Given a set of solutions where each solution represents a set of alleles, we measure the likelihood of observing the set of reads given a solution and pick the solution which maximizes the likelihood criterion. If there are multiple solutions maximizing the likelihood criterion, we pick one arbitrarily.</p>
        <p><bold>Computing allele proportions.</bold>Finally, once the alleles have been identified for a given locus, we compute the proportion of each allele. The principle is to assign a weight to each allele based on the read mappings (edges) selected by the ILP, and to normalize these weights to obtain proportions. First, we filter out any read that maps equally well (i.e. with the same score <italic>k</italic>) onto all selected alleles. Then every chosen allele gets an initial weight of 0. Next, for every non-discarded read, say <italic>r</italic><sub><italic>i</italic></sub>, we consider all the alleles it maps onto with optimal score (say <italic>q</italic><sub><italic>ik</italic></sub> if <italic>y</italic><sub><italic>ik</italic></sub>=1); assuming there are <italic>h</italic> such alleles, we increase the weight of each by 1/<italic>h</italic>. We then normalize the weights of the alleles to define their respective proportions.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>The Strain Diversity Problem</title>
      <p>Once the alleles present in each sample and their proportions have been identified, this information is passed to the second stage of the pipeline. Its goal is to compute strain types and proportions in all samples <italic>jointly</italic>, minimizing the number of novel strains required to explain the given allele distributions plus an error term measuring the total discrepancy between each given allele proportion and the proportions of strains having this allele. The rationale behind minimizing the number of new strains is driven by parsimony considerations; we would like to explain the data present in all samples using known strains as much as possible. The error terms allow some flexibility to modify the allele proportions by bounding each error to be ≤<italic>ε</italic> (in our analysis we set the bound to <italic>ε</italic>=0.1, or 10%).</p>
      <p><bold>The Strain Diversity Problem: problem definition and tractability.</bold>The Strain Diversity Problem (SDP) can be defined as follows. It takes as input four elements: (1) the set <italic>G</italic><sub><italic>ij</italic></sub>={<italic>g</italic><sub><italic>i</italic><italic>j</italic>1</sub>,<italic>g</italic><sub><italic>i</italic><italic>j</italic>2</sub>,… } of all alleles selected for locus <italic>j</italic> in sample <italic>i</italic> (2) the set <italic>P</italic><sub><italic>ij</italic></sub>={<italic>p</italic><sub><italic>i</italic><italic>j</italic>1</sub>,<italic>p</italic><sub><italic>i</italic><italic>j</italic>2</sub>,… } of proportions of these alleles, (3) a database <italic>Ω</italic> of known strain types, (4) an error bound <italic>ε</italic>∈[0,1]. From now on, we assume that there are <italic>ℓ</italic> loci and <italic>m</italic> samples.</p>
      <p>From this input, we generate the set of all possible strain types for each sample <italic>i</italic>, defined as the Cartesian product <italic>G</italic><sub><italic>i</italic>1</sub>×<italic>G</italic><sub><italic>i</italic>2</sub>×⋯×<italic>G</italic><sub><italic>i</italic><italic>ℓ</italic></sub> which we denote by <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$V_{i} = \{V_{i1}, V_{i2}, \dots,V_{iH_{i}}\}$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq8.gif"/></alternatives></inline-formula> with <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{i} = \prod _{j=1}^{\ell }|G_{ij}|$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:munderover><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq9.gif"/></alternatives></inline-formula>. We also denote by <italic>K</italic> the number of strain types that appear in at least one <italic>V</italic><sub><italic>i</italic></sub> and we define the set <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}=\{S_{1}, \dots, S_{K}\}$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq10.gif"/></alternatives></inline-formula> of all such strain types. We assign a weight <italic>w</italic><sub><italic>j</italic></sub> to each <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}_{j} \in \mathcal {S}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq11.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{j} = N \cdot \min _{\{s \in \Omega \}} d(s, \mathcal {S}_{j})$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>·</mml:mo><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq12.gif"/></alternatives></inline-formula>, where <italic>d</italic> is the edit distance metric and <italic>N</italic> is a normalization constant that rescales the weights to the interval [0,1]. These weights measure the distance to the closest known strain; the strains in <italic>Ω</italic> are assigned a weight of 0.</p>
      <p>A solution to the SDP is fully described by assigning to every strain type <italic>V</italic><sub><italic>ih</italic></sub> from <italic>V</italic><sub><italic>i</italic></sub> a proportion <italic>π</italic><sub><italic>ih</italic></sub> for this strain type in sample <italic>i</italic> (where <italic>π</italic><sub><italic>ih</italic></sub> is 0 if the strain type is deemed to be absent from sample <italic>i</italic>). A strain type from <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S} \setminus \Omega $\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">S</mml:mi><mml:mo>∖</mml:mo><mml:mi>Ω</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq13.gif"/></alternatives></inline-formula> is said to be present in a solution if it is given a non-zero proportion in at least one sample; we denote by <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}_{n}$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq14.gif"/></alternatives></inline-formula> the set of such novel strain types. The cost of a solution is then defined as
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \sum_{\{h | \mathcal{S}_{h} \in \mathcal{S}_{n} \}} w_{h} + \sum_{i,j} e_{ij}  $$ \end{document}</tex-math><mml:math id="M32"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>h</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2019_3204_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where the latter term of the cost represents the deviation from the input alleles proportions for sample <italic>i</italic> at locus <italic>j</italic>. This cost function penalizes the introduction of novel strains that are very different from known strains and the error introduced in the proportions of the selected alleles. The SDP aims at finding a solution of minimum cost, i.e. one that explains the provided allele distributions as much as possible with known strains and novel strains which are close to the known strains, and also adheres to the desired proportions as closely as possible. As expected, this problem is intractable; its decision version is proven to be NP-complete in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, by a reduction from the 3-partition problem.</p>
      <sec id="d29e1753">
        <title>
          <bold>Theorem 2</bold>
        </title>
        <p>The Strain Diversity Problem is NP-hard.</p>
        <p><bold>An MILP for the Strain Diversity Problem.</bold>We now describe an MILP that solves the SDP. The decision variables of the MILP are the following:
<list list-type="bullet"><list-item><p>Binary variables <italic>a</italic><sub><italic>k</italic></sub>,1≤<italic>k</italic>≤<italic>K</italic>, where <italic>a</italic><sub><italic>k</italic></sub>=1 if strain type <italic>S</italic><sub><italic>k</italic></sub> is chosen to explain the observed allele distribution in at least one sample, and 0 otherwise.</p></list-item><list-item><p>Proportion variables <italic>π</italic><sub><italic>ih</italic></sub> encoding the proportion of strain type <italic>V</italic><sub><italic>ih</italic></sub> in sample <italic>i</italic>; their values are constrained to be in [0,1].</p></list-item><list-item><p>Variables <italic>e</italic><sub><italic>ijk</italic></sub>∈[0,<italic>ε</italic>] encoding the absolute error of the observed proportion <italic>p</italic><sub><italic>ijk</italic></sub> of allele <italic>g</italic><sub><italic>ijk</italic></sub> for locus <italic>j</italic> in sample <italic>i</italic> from the assigned proportions, in sample <italic>i</italic>, of the strain types containing this allele.</p></list-item></list></p>
        <p>The objective function of the MILP is
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \min\left(\sum_{\{k\ |\ S_{k} \notin \Omega\}} w_{k} a_{k} + \sum_{i,j,k} e_{ijk}\right)  $$ \end{document}</tex-math><mml:math id="M34"><mml:mo>min</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>k</mml:mi><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∉</mml:mo><mml:mi>Ω</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_3204_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Finally the constraints of the MILP are the following:
<list list-type="bullet"><list-item><p>For any allele <italic>g</italic><sub><italic>ijk</italic></sub>∈<italic>G</italic><sub><italic>ij</italic></sub>, the sum of the proportions of the strain types from <italic>V</italic><sub><italic>i</italic></sub> that contain this allele, denoted <italic>ν</italic><sub><italic>ijk</italic></sub>, belongs to [<italic>p</italic><sub><italic>ijk</italic></sub>−<italic>ε</italic>,<italic>p</italic><sub><italic>ijk</italic></sub>+<italic>ε</italic>].</p></list-item><list-item><p>For each sample <italic>i</italic>, the strain type proportions must form a distribution: <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{h=1}^{H_{i}}\pi _{ih} = 1$\end{document}</tex-math><mml:math id="M36"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq15.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p>If the assigned proportion for some strain type <italic>V</italic><sub><italic>ih</italic></sub>=<italic>S</italic><sub><italic>k</italic></sub> in a sample <italic>i</italic> is non-zero, then <italic>S</italic><sub><italic>k</italic></sub> must be chosen: <italic>a</italic><sub><italic>k</italic></sub>≥<italic>π</italic><sub><italic>ih</italic></sub>.</p></list-item><list-item><p>Conversely, if a strain is chosen, it must be assigned a non-zero proportion:
<disp-formula id="Equb"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$0 \leq a_{k} - \frac{1}{|\{\pi_{ih}\ |\ V_{ih} = S_{k}\}|} \cdot \sum_{\{ (i,h) | V_{ih} = S_{k}\}} \pi_{ih} \leq 1 - \delta$$ \end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3204_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>δ</italic> is a tolerance chosen to match the smallest allowed proportion; we use <italic>δ</italic>=0.001. This constraint is needed because the binary decision variables for the usage of existing strains have coefficient 0 in the objective function, so setting these variables to 1 will not incur any cost in the objective function. If we do not impose such a constraint, we could end up with an incorrect solution where some existing strains have zero proportions, while the strain usage variables are set to 1, which would then need to be post-processed. Including this constraint eliminates the possibility of such a spurious solution.</p></list-item><list-item><p>The absolute error between the input proportion and the assigned proportion for allele <italic>g</italic><sub><italic>ijk</italic></sub> for locus <italic>j</italic> in sample <italic>i</italic>: <italic>e</italic><sub><italic>ijk</italic></sub>=|<italic>p</italic><sub><italic>ijk</italic></sub>−<italic>ν</italic><sub><italic>ijk</italic></sub>|. This is encoded by the following 2 constraints: <italic>e</italic><sub><italic>ijk</italic></sub>≥<italic>T</italic><sub><italic>ijk</italic></sub>−<italic>p</italic><sub><italic>ijk</italic></sub> and <italic>e</italic><sub><italic>ijk</italic></sub>≥<italic>p</italic><sub><italic>ijk</italic></sub>−<italic>T</italic><sub><italic>ijk</italic></sub> where <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{ijk}=\sum _{\{k\ |\ g_{ijk} \in V_{ik}\}}\pi _{ik}$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>k</mml:mi><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq16.gif"/></alternatives></inline-formula>. Note that since <italic>e</italic><sub><italic>ijk</italic></sub> is part of the objective function to be minimized, it will be equal to the error in any optimal solution.</p></list-item></list></p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Implementation</title>
      <p>All scripts are written in Python 2.7. Both ILPs are formulated and solved using the Python API of IBM’s CPLEX 12.6.3.0. For the ADP, each sample and each locus may require a different number of variables in the ILP. To evaluate the practical resources requirements of our ILP, we choose the sample SRR2034336, which has the largest number of reads among our samples. The average number of variables across each gene for this sample is 20,112, the maximum RAM usage is ∼1.5GB, and the time taken for all 8 genes is ∼33 min on a 4 CPUs Intel<sup>®</sup> Xeon<sup>®</sup> machine. The total time taken for each sample is presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. For the MILP solving the SDP on all 30 samples, there are a total of 21,885 variables, with 10,682 strain type variables, 10,795 proportion variables and 408 error variables. Due to the computational complexity of the MILP, we output a solution as long as the relative gap tolerance is within 10% and after a time limit of 24 h. Our code is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/WGS-TB/MLST">https://github.com/WGS-TB/MLST</ext-link>.</p>
    </sec>
    <sec id="Sec14">
      <title>Data simulation</title>
      <p>Given the absence of benchmarks available for estimating diversity at the level of precision considered in this work, we conducted several simulations. All reads are simulated using ART [<xref ref-type="bibr" rid="CR18">18</xref>], following the characteristics of the reads from the real data set described in “<xref rid="Sec24" ref-type="sec">Application to real data</xref>” section.</p>
      <p><bold>ADP simulation.</bold>For each locus of the <italic>Borrelia</italic> MLST scheme, we drew a random number <italic>k</italic>∈[2,7], selected a random allele from the database and selected <italic>k</italic>−1 other alleles, each at edit distance at most <italic>d</italic> (a given parameter) from the first one chosen. Next, we randomly assigned proportions to each selected allele, which sum up to 1, then generated reads with coverage <italic>c</italic>. To align the simulated reads to the alleles of the database, we used Bowtie v0.12.7 [<xref ref-type="bibr" rid="CR19">19</xref>]. We used parameters <italic>c</italic>∈{30,100,300} and <italic>d</italic>∈{5,10,15,20,25} and we ran 40 simulations for each combination of these parameters. For this experiment, we compared our results with the results obtained with Kallisto [<xref ref-type="bibr" rid="CR20">20</xref>], a recent method for isoform abundance estimation that has also been applied to metagenomics.</p>
      <p><bold>SDP simulation</bold>For this simulation we selected random strain type distributions and tested the ability of our SDP method to recover the true diversity given perfect allele calls. We considered 5 different mechanisms to generate strain types distributions. EvoMod1: We select a random existing strain <italic>S</italic>, which is then mutated <italic>m</italic>=2 times to obtain a new strain <italic>S</italic><sup>′</sup>, where each mutation results in an allele which has edit distance at most <italic>d</italic>=15 from the original allele in <italic>S</italic>. The total number of strains simulated is 2 (1 existing and 1 novel). EvoMod2: We repeat EvoMod1 in parallel from two starting existing strains. The total number of strains simulated is 4 (2 existing and 2 novel). EvoMod2e/EvoMod2n: We apply EvoMod2 then remove a random existing/novel strain. EvoMod3: we apply EvoMod2, then apply a recombination (allele exchange) event on two randomly chosen strains out of the 4 available strains. For all experiments, we assigned random proportions to the chosen strains.</p>
      <p><bold>Full pipeline simulation.</bold>We generated strain type distributions as in the SDP simulations above, then generated reads as in the ADP simulations. The generated reads were then fed to the ADP solver, and the ADP results were provided as input to the SDP solver. We compared our pipeline with strainEST [<xref ref-type="bibr" rid="CR13">13</xref>], a recent method to estimate the strain composition and abundance in metagenomics datasets. However, strainEST does not predict novel strain types. Hence, to complement EvoMod1, 2, 2e and 2n, we added an additional simulation where we randomly pick <italic>k</italic>={1,2} existing strains and assign them random proportions.</p>
      <p><bold>Statistics.</bold>For each experiment, we recorded the following statistics: Precision, Recall and Total Variation Distance. Precision and recall are defined as <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {TP}{TP+FP}$\end{document}</tex-math><mml:math id="M42"><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {TP}{TP+FN}$\end{document}</tex-math><mml:math id="M44"><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq18.gif"/></alternatives></inline-formula>, where <italic>T</italic><italic>P</italic>, <italic>F</italic><italic>P</italic>, <italic>F</italic><italic>N</italic> are the number of true positive calls, false positive calls, and false negative calls, respectively. The Total Variation Distance (TVD) [<xref ref-type="bibr" rid="CR21">21, p. 50</xref>] is defined as <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$TVD = \frac {1}{2}\sum _{a \in S}|Pred(a) - True(a)|$\end{document}</tex-math><mml:math id="M46"><mml:mtext mathvariant="italic">TVD</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mtext mathvariant="italic">Pred</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">True</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3204_Article_IEq19.gif"/></alternatives></inline-formula>, where <italic>Pred</italic> and <italic>True</italic> are the predicted distribution and the true distribution, respectively, and <italic>S</italic> is the set of all possible outcomes. The TVD basically describes the average amount of distribution to “move” from <italic>Pred</italic> to <italic>True</italic> or vice versa.</p>
      <p>The statistics described above rely on a stringent measure of accuracy in calling alleles, strain types or proportions. For example, a novel strain type called which differs from the true simulated strain type by a single SNP would be considered as a False Positive. To account for this, we considered 3 additional statistics: Earth-Mover’s distance (EMD), soft-precision and soft-recall. Soft precision and soft recall are similar to precision and recall, however, a strain is considered a TP if it differs from the true strain type by at most 5 SNPs. The EMD [<xref ref-type="bibr" rid="CR22">22</xref>] is similar in principle to the TVD, but is more refined as it considers the edit distances between strains and is commonly used in genomics to evaluate haplotype reconstruction methods [<xref ref-type="bibr" rid="CR23">23</xref>]. We provide a full definition in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
  </sec>
  <sec id="Sec19" sec-type="results">
    <title>Results</title>
    <sec id="Sec20">
      <title>Simulated data</title>
      <p>We describe several sets of experiments based on simulated data. In the first one we evaluate our method for the ADP problem and compare it with Kallisto. In the second experiment, we evaluate our method for the SDP, using simulated allele frequencies, i.e. perfect input to the SDP, and 4 different evolutionary models explaining the diversity within a sample, from a simple model based on within-host mutations to a complex model based on co-infection and recombination. We then repeat the same experiment using simulated short reads, to evaluate our pipeline on ADP + SDP. Finally, we compare our method to strainEST using simulated datasets with no novel strains (the ideal case for strainEST) and then datasets simulated using evolutionary modes identical to the ones in the previous experiment.</p>
      <p><bold>ADP simulation.</bold>Table <xref rid="Tab1" ref-type="table">1</xref> shows the performance of our method. Overall, our method obtained very high precision and recall statistics. Compared to Kallisto, our method performs better in terms of precision and comparable in terms of TVD, while Kallisto performs better in terms of recall. Gene-by-gene boxplots for our method and Kallisto are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Average and standard deviation of precision, recall and TVD for each gene of the <italic>Borellia</italic> MLST scheme (B-MLST) and Kallisto, across all parameters combination</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">Precision</td><td align="left">clpA</td><td align="left">clpX</td><td align="left">nifS</td><td align="left">pepX</td></tr><tr><td align="left">B-MLST</td><td align="left">0.99 ±0.009</td><td align="left">0.98 ±0.012</td><td align="left">0.96 ±0.024</td><td align="left">0.96 ±0.016</td></tr><tr><td align="left">Kallisto</td><td align="left">0.97 ±0.014</td><td align="left">0.94 ±0.014</td><td align="left">0.89 ±0.027</td><td align="left">0.93 ±0.03</td></tr><tr><td align="left">Recall</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">B-MLST</td><td align="left">0.95 ±0.022</td><td align="left">0.94 ±0.027</td><td align="left">0.90 ±0.05</td><td align="left">0.94 ±0.034</td></tr><tr><td align="left">Kallisto</td><td align="left">0.99 ±0.004</td><td align="left">0.99 ±0.005</td><td align="left">0.99 ±0.003</td><td align="left">0.99 ±0.006</td></tr><tr><td align="left">TVD</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">B-MLST</td><td align="left">0.077 ±0.015</td><td align="left">0.080 ±0.01</td><td align="left">0.119 ±0.039</td><td align="left">0.087 ±0.024</td></tr><tr><td align="left">Kallisto</td><td align="left">0.029 ±0.011</td><td align="left">0.041 ±0.015</td><td align="left">0.085 ±0.028</td><td align="left">0.046 ±0.022</td></tr><tr><td align="left">Precision</td><td align="left">pyrG</td><td align="left">recG</td><td align="left">rplB</td><td align="left">uvrA</td></tr><tr><td align="left">B-MLST</td><td align="left">0.97 ±0.024</td><td align="left">0.98 ±0.013</td><td align="left">0.99 ±0.007</td><td align="left">0.98 ±0.011</td></tr><tr><td align="left">Kallisto</td><td align="left">0.93 ±0.02</td><td align="left">0.89 ±0.021</td><td align="left">0.95 ±0.012</td><td align="left">0.93 ±0.023</td></tr><tr><td align="left">Recall</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">B-MLST</td><td align="left">0.92 ±0.032</td><td align="left">0.95 ±0.028</td><td align="left">0.94 ±0.043</td><td align="left">0.96 ±0.026</td></tr><tr><td align="left">Kallisto</td><td align="left">0.98 ±0.006</td><td align="left">0.99 ±0.011</td><td align="left">0.99 ±0.006</td><td align="left">0.99 ±0.005</td></tr><tr><td align="left">TVD</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">B-MLST</td><td align="left">0.110 ±0.019</td><td align="left">0.082 ±0.028</td><td align="left">0.089 ±0.03</td><td align="left">0.069 ±0.02</td></tr><tr><td align="left">Kallisto</td><td align="left">0.0047 ±0.018</td><td align="left">0.068 ±0.018</td><td align="left">0.032 ±0.011</td><td align="left">0.05 ±0.022</td></tr></tbody></table></table-wrap></p>
      <p><bold>SDP and full pipeline simulation.</bold>The results are presented in Table <xref rid="Tab2" ref-type="table">2</xref>. Given perfect input data, our SDP algorithm performed extremely well for each mechanism, maintaining a precision and recall of almost 75% with EvoMod3, the model that involves recombination. For the full pipeline simulation, our pipeline performs extremely well on the ADP, which is consistent with our observations in the ADP simulation. However, the full pipeline’s performance suffered in the SDP. Soft precision and recall are still high, but exact precision and recall are much lower. We can observe a dramatic impact on the SDP from relatively small errors in the ADP (i.e. wrong allele identification or discrepancy in the allele proportion estimation).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Average and standard deviation of different statistics for each evolutionary mechanisms</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left"/><td align="left">Soft-Precision</td><td align="left">Soft-Recall</td><td align="left">EMD</td><td align="left">Precision</td><td align="left">Recall</td><td align="left">TVD</td></tr><tr><td align="left">EM1</td><td align="left">0.98 ±0.11</td><td align="left">0.96 ±0.13</td><td align="left">0.64 ±1.7</td><td align="left">0.85 ±0.28</td><td align="left">0.86 ±0.23</td><td align="left">0.15 ±0.29</td></tr><tr><td align="left">EM2</td><td align="left">0.96 ±0.12</td><td align="left">0.98 ±0.076</td><td align="left">0.71 ±1.18</td><td align="left">0.81 ±0.21</td><td align="left">0.88 ±0.14</td><td align="left">0.17 ±0.22</td></tr><tr><td align="left">EM2e</td><td align="left">0.98 ±0.11</td><td align="left">0.97 ±0.1</td><td align="left">0.34 ±0.81</td><td align="left">0.91 ±0.20</td><td align="left">0.92 ±0.17</td><td align="left">0.1 ±0.23</td></tr><tr><td align="left">EM2n</td><td align="left">0.96 ±0.13</td><td align="left">0.95 ±0.12</td><td align="left">0.6 ±1.35</td><td align="left">0.86 ±0.23</td><td align="left">0.88 ±0.16</td><td align="left">0.14 ±0.25</td></tr><tr><td align="left">EM3</td><td align="left">0.90 ±0.17</td><td align="left">0.88 ±0.13</td><td align="left">4.6 ±7.58</td><td align="left">0.76 ±0.21</td><td align="left">0.76 ±0.17</td><td align="left">0.22 ±0.24</td></tr><tr><td align="left"/><td align="left">ADP-Precision</td><td align="left">ADP-Recall</td><td align="left">ADP-TVD</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">EM1</td><td align="left">0.96 ±0.07</td><td align="left">0.91 ±0.09</td><td align="left">0.07 ±0.058</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">EM2</td><td align="left">0.93 ±0.07</td><td align="left">0.91 ±0.07</td><td align="left">0.26 ±0.16</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">EM2e</td><td align="left">0.93 ±0.08</td><td align="left">0.91 ±0.08</td><td align="left">0.34 ±0.25</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">EM2n</td><td align="left">0.92 ±0.09</td><td align="left">0.9 ±0.09</td><td align="left">0.34 ±0.25</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">EM3</td><td align="left">0.94 ±0.07</td><td align="left">0.92 ±0.08</td><td align="left">0.29 ±0.15</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"/><td align="left">Soft-Precision</td><td align="left">Soft-Recall</td><td align="left">EMD</td><td align="left">Precision</td><td align="left">Recall</td><td align="left">TVD</td></tr><tr><td align="left">EM1</td><td align="left">0.96 ±0.14</td><td align="left">0.99 ±0.079</td><td align="left">4.1 ±7.0</td><td align="left">0.44 ±0.34</td><td align="left">0.58 ±0.40</td><td align="left">0.62 ±0.37</td></tr><tr><td align="left">EM2</td><td align="left">0.79 ±0.21</td><td align="left">0.91 ±0.16</td><td align="left">68.8 ±74.6</td><td align="left">0.32 ±0.19</td><td align="left">0.44 ±0.27</td><td align="left">0.78 ±0.2</td></tr><tr><td align="left">EM2e</td><td align="left">0.72 ±0.24</td><td align="left">0.88 ±0.22</td><td align="left">98.9 ±89.4</td><td align="left">0.36 ±0.26</td><td align="left">0.5 ±0.30</td><td align="left">0.72 ±0.26</td></tr><tr><td align="left">EM2n</td><td align="left">0.76 ±0.23</td><td align="left">0.9 ±0.19</td><td align="left">98.6 ±90</td><td align="left">0.36 ±0.25</td><td align="left">0.52 ±0.30</td><td align="left">0.71 ±0.24</td></tr><tr><td align="left">EM3</td><td align="left">0.68 ±0.20</td><td align="left">0.79 ±0.2</td><td align="left">83.7 ±64</td><td align="left">0.29 ±0.2</td><td align="left">0.35 ±0.22</td><td align="left">0.83 ±0.16</td></tr></tbody></table><table-wrap-foot><p>(Top) SDP simulation (Middle/Bottom) Full pipeline simulation: (Middle) ADP statistics, (Bottom) SDP statistics</p></table-wrap-foot></table-wrap></p>
      <p><bold>Comparison to strainEST.</bold>We compared our methods to strainEST in the full pipeline simulation with 2 sets of experiments: (1) benchmark simulation where only existing strains are simulated (2) 4 different evolutionary mechanisms, where novel strains are involved. Our method outperforms strainEST in all situations. We refer the readers to the Additional file <xref rid="MOESM1" ref-type="media">1</xref> for the detailed results.</p>
    </sec>
    <sec id="Sec24">
      <title>Application to real data</title>
      <p>The sequencing data we analyzed are from 24 tick samples infected with <italic>B. burgdorferi</italic>, collected using the standard tick dragging method [<xref ref-type="bibr" rid="CR24">24</xref>] in 2007 from 8 different sites in Vermont, New York, Massachusetts and Connecticut. For each tick sample, the <italic>B. burgdorferi</italic> genome was captured as described in [<xref ref-type="bibr" rid="CR9">9</xref>]. The sequencing data is composed of 2×76bp paired-end reads and the number of read pairs ranges from 2.7·10<sup>4</sup> to 2.7·10<sup>6</sup> over all tick samples (coverages ranging from 5X to 500X).</p>
      <p>Based on the output of the pipeline, 60 novel and 10 existing strains were inferred to be potential candidates for explaining the strain diversity in this large sample of ticks. The total error component of the objective function of the MILP solving the SDP amounts to 1.258, or an average of 0.05 per sample. The total proportion of new strains is 14.67 in these 24 samples, for an average of 61%. For each sample having novel strains, 76% of its genotype is composed of novel strains. Figure <xref rid="Fig2" ref-type="fig">2</xref> further illustrates the diversity, showing a wide range of strain composition in each of the 30 samples, with an average of 3 strains and a maximum of 9 strains infecting each sample, consistent with previous reports [<xref ref-type="bibr" rid="CR5">5</xref>]. This suggest that the diversity of the <italic>B. burgdorferi</italic> strain types might be much larger than what was known so far. To further refine our analysis, Fig. <xref rid="Fig3" ref-type="fig">3</xref> illustrates the distribution of strain types in the 30 tick samples and the respective contribution to the total diversity of each strain type. Although we observe that 2 of the 10 detected existing strains are present in more than one sample, only 5 out of the 60 novel strains appear in more than one sample.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Distribution of the number of existing and novel strains per tick sample</p></caption><graphic xlink:href="12859_2019_3204_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>(Left) Cumulative proportion of the 10 existing strains in all 24 samples (within each bar, different colors represent different samples). (Right) Similar graph for the 60 novel strains</p></caption><graphic xlink:href="12859_2019_3204_Fig3_HTML" id="MO3"/></fig></p>
      <p>It is striking to observe that most strain types appear in exactly one tick sample each. We can also observe that for 11 of the 24 samples, we do not detect any existing strains. This suggests that some of these strain types could have been improperly called, and that the correct call should have been another strain type, extremely close to this one in terms of sequence similarity; a reasonable cause for such errors could be a mistake while solving the ADP, in which case a wrongly called allele could be very similar to the correct allele. Due to possibility of wrong allele calls leading to introducing novel strains, we also computed a minimum spanning tree (MST) of the 70 strains found in these 24 samples, with edges weighted by the edit distance between the sequences of the alleles over the 8 genes of the MLST scheme. The MST figures are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We can observe clusters of predicted strains that are very close to each other, such as, for example, a cluster of 8 novel strains and 2 existing strains that are all within edit distance 5 from each other. This suggests, in line with the level of precision and recall we observe in our simulations, that some of these strains might result from a limited level of erroneous allele calls, off by a couple of SNPs from the correct call, that result in this apparent high level of diversity.</p>
    </sec>
  </sec>
  <sec id="Sec25" sec-type="conclusion">
    <title>Conclusion</title>
    <p>We presented an optimization-based pipeline for estimating the within-host strain diversity of a pathogen from WGS data analyzed in the MLST framework. This is a specific instance of estimating the diversity of a bacterial pathogen from metagenomics data, focusing on within-host diversity and taking advantage of the availability of a large database of known MLST strain types.</p>
    <p>Our approach is composed of two main steps, each of a different nature; the first step detects the alleles present in a sample from the sequence data, while the second step estimates the strain diversity based on the output of the first one. In both steps we follow a parsimonious approach that aims at explaining the input using as few alleles or novel strains as possible. The main contribution of our work is the formulation and the solution of the Strain Diversity Problem for a group of samples. The main challenge of this problem is the need to consider a potentially large set of samples at once. While this leads to a relatively complex MILP, with a large number of variables (whose number is determined by the number of potentially present novel strain types), we believe that the ability to consider a large set of samples at once is an important part of the model, for example for analyzing sequencing data from pathogen hosts originating from a single geographical area. Our work shows that this problem, despite its complexity, can actually be solved to a good accuracy using reasonable amounts of computational resources.</p>
    <p>Our experiments on real data suggest avenues for future research; in particular, the multiplicity of optimal solutions is obviously problematic, as calling a wrong allele in a single sample during the first step might force the MILP computing the strain types to introduce a new strain type. We can observe in our results on real data several groups of very closely related strain types, sometimes differing by a single SNP, which likely results from this issue. At the moment, our approach to this problem is to post-process the result of our pipeline to identify clusters of closely related strains, but other more principled approaches should be explored. Notwithstanding the aforementioned issues, our experiments suggest a strikingly high diversity in our dataset of 24 tick samples. This is not altogether surprising since the library of known strains might be limited, and within-host (or, more precisely, within-vector) evolution might result in the presence of a number of strains that only differ by a small number of SNPs in one or two loci of the MLST scheme.</p>
    <p>Our work is, to our knowledge, the first comprehensive approach to the problem of reference-based detection of pathogen diversity in a collection of related samples that considers novel strain types. Our two-step pipeline, based on the principle of parsimony implemented through mixed integer linear programming, appears to perform extremely well on simulated data and produces reasonable results on a real dataset. We expect that both our approach and our publicly available pipeline will contribute to the development of accurate and efficient tools for quantifying the within-host diversity of bacterial pathogens.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec26">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3204_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary methods, figures and tables.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ADP</term>
        <def>
          <p>Allele Diversity problem</p>
        </def>
      </def-item>
      <def-item>
        <term>EMD</term>
        <def>
          <p>Earth-Mover’s Distance</p>
        </def>
      </def-item>
      <def-item>
        <term>FN</term>
        <def>
          <p>False Negative</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p>False Positive</p>
        </def>
      </def-item>
      <def-item>
        <term>ILP</term>
        <def>
          <p>Integer Linear Programming</p>
        </def>
      </def-item>
      <def-item>
        <term>MILP</term>
        <def>
          <p>Mixed Integer Linear Programming</p>
        </def>
      </def-item>
      <def-item>
        <term>MLST</term>
        <def>
          <p>Multi-Locus Sequence Typing</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p>Minimum Spanning Tree</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next-Generation Sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SDP</term>
        <def>
          <p>Strain Diversity Problem</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>Single-Nucleotide Polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>TN</term>
        <def>
          <p>True Negative</p>
        </def>
      </def-item>
      <def-item>
        <term>TP</term>
        <def>
          <p>True Positive</p>
        </def>
      </def-item>
      <def-item>
        <term>TVD</term>
        <def>
          <p>Total Variation Distance</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p>Whole-Genome Sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p><ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/genome/genomes/738">https://www.ncbi.nlm.nih.gov/genome/genomes/738</ext-link>, accessed June 25, 2019.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Guo Liang Gan and Elijah Willie contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3204-8.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like thank Maria Diuk-Wasser, Katharine Walter and Ben Adams for suggesting the problem as well as helpful discussions with regards to the data provenance and analysis.</p>
    <sec id="d29e3325">
      <title>About this supplement</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics Volume 20 Supplement 20, 2019: Proceedings of the 17th Annual Research in Computational Molecular Biology (RECOMB) Comparative Genomics Satellite Workshop: Bioinformatics</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-20">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-20</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LC designed the project, LC, CC, GLG, EW designed the methods, GLG and EW implemented the methods and ran the experiments, LC, CC, GLG, EW analyzed the results and wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>LC acknowledges support from NSERC, CIHR, Genome Canada and the Sloan Foundation. CC acknowledges support from NSERC. GLG was partially funded by an NSERC CREATE scholarship. EW was partially funded by an SFU KEY fellowship. Publication costs are funded by the SFU Central Open Access Fund.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Didelot</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Peto</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Crook</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Within-host evolution of bacterial pathogens</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2016</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>150</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2015.13</pub-id>
        <pub-id pub-id-type="pmid">26806595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cadena</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Fortune</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Heterogeneity in tuberculosis</article-title>
        <source>Nat Rev Immunol</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>691</fpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.69</pub-id>
        <pub-id pub-id-type="pmid">28736436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyler</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Randell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baikie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antonation</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Janella</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Christianson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tyrrell</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Domselaar</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>Application of whole genome sequence analysis to the study of <italic>Mycobacterium tuberculosis</italic> in Nunavut, Canada</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>10</issue>
        <fpage>0185656</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0185656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alizon</surname>
            <given-names>Samuel</given-names>
          </name>
          <name>
            <surname>de Roode</surname>
            <given-names>Jacobus C.</given-names>
          </name>
          <name>
            <surname>Michalakis</surname>
            <given-names>Yannis</given-names>
          </name>
        </person-group>
        <article-title>Multiple infections and the evolution of virulence</article-title>
        <source>Ecology Letters</source>
        <year>2013</year>
        <volume>16</volume>
        <issue>4</issue>
        <fpage>556</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1111/ele.12076</pub-id>
        <pub-id pub-id-type="pmid">23347009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strandh</surname>
            <given-names>Maria</given-names>
          </name>
          <name>
            <surname>Råberg</surname>
            <given-names>Lars</given-names>
          </name>
        </person-group>
        <article-title>Within-host competition between Borrelia afzelii ospC strains in wild hosts as revealed by massively parallel amplicon sequencing</article-title>
        <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>
        <year>2015</year>
        <volume>370</volume>
        <issue>1675</issue>
        <fpage>20140293</fpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2014.0293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brisson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baxamusa</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wormser</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Biodiversity of <italic>Borrelia burgdorferi</italic> strains in tissues of Lyme disease patients</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>8</issue>
        <fpage>22926</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0022926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walter</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Carpi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Caccone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diuk-Wasser</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Vectors as epidemiological sentinels: Patterns of within-tick <italic>Borrelia burgdorferi</italic> diversity</article-title>
        <source>PLoS Pathog</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>7</issue>
        <fpage>1005759</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1005759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lynch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Petkau</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Domselaar</surname>
            <given-names>GV</given-names>
          </name>
        </person-group>
        <article-title>A primer on infectious disease bacterial genomics</article-title>
        <source>Clin Microbiol Rev</source>
        <year>2016</year>
        <volume>29</volume>
        <issue>4</issue>
        <fpage>881</fpage>
        <lpage>913</lpage>
        <pub-id pub-id-type="doi">10.1128/CMR.00001-16</pub-id>
        <pub-id pub-id-type="pmid">28590251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Carpi G, Walter KS, Bent SJ, Hoen AG, Diuk-Wasser M, Caccone A. Whole genome capture of vector-borne pathogens from mixed DNA samples: a case study of <italic>Borrelia burgdorferi</italic>. BMC Genomics. 2015; 16(1). 10.1186/s12864-015-1634-x.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maiden</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Bygraves</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Feil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Morelli</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Urwin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zurth</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Caugant</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Feavers</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Achtman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spratt</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>Multilocus sequence typing: a portable approach to the identification of clones within populations of pathogenic microorganisms</article-title>
        <source>PNAS</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>6</issue>
        <fpage>3140</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.6.3140</pub-id>
        <pub-id pub-id-type="pmid">9501229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gatewood</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Aanensen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hanincova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Terekhova</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vollmer</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Cornet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Piesman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Donaghy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bormane</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hurn</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Feil</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Fish</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Casjens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wormser</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kurtenbach</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MLST of housekeeping genes captures geographic population structure and suggests a european origin of <italic>Borrelia burgdorferi</italic></article-title>
        <source>PNAS</source>
        <year>2008</year>
        <volume>105</volume>
        <issue>25</issue>
        <fpage>8730</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0800323105</pub-id>
        <pub-id pub-id-type="pmid">18574151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delmont</surname>
            <given-names>TO</given-names>
          </name>
          <name>
            <surname>Raguideau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alneberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Eren</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>DESMAN: a new tool for de novo extraction of strains from metagenomes</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>181</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1309-9</pub-id>
        <pub-id pub-id-type="pmid">28934976</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albanese</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Donati</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Strain profiling and epidemiology of bacterial species from metagenomic sequencing</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>2260</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02209-5</pub-id>
        <pub-id pub-id-type="pmid">29273717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>GPA: A microbial genetic polymorphisms assignments tool in metagenomic analysis by bayesian estimation</article-title>
        <source>Genomics Proteomics Bioinforma</source>
        <year>2019</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>106</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gpb.2018.12.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chindelevitch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Moodley</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Else</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>ClassTR: Classifying within-host heterogeneity based on tandem repeats with application to <italic>Mycobacterium tuberculosis</italic> infections</article-title>
        <source>PLOS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Carleton</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Seemann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Keane</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Comparison of Multi-Locus Sequence Typing software for Next Generation Sequencing data</article-title>
        <source>Microb Genom</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>000124</fpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boža</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Brejová</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vinař</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>GAML: genome assembly by maximum likelihood</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-015-0052-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>ART: a Next-Generation Sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat Biotech</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>5</issue>
        <fpage>525</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Levin DA, Peres Y, Wilmer EL. Markov chains and mixing times. Am Math Soc. 2009. 10.1090/mbk/058.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peleg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Werman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rom</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A unified approach to the change of resolution: space and gray-level</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>1989</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>739</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1109/34.192468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Knyazev S, Tsyvina V, Melnyk A, Artyomenko A, Malygina T, Porozov YB, Campbell E, Switzer WM, Skums P, Zelikovsky A. CliqueSNV: Scalable reconstruction of intra-host viral populations from NGS reads. bioRxiv. 2018. 10.1101/264242.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falco</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Fish</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods for sampling the deer tick, <italic>Ixodes dammini</italic>, in a Lyme disease endemic area</article-title>
        <source>Exp Appl Acarol</source>
        <year>1992</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>165</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01219108</pub-id>
        <pub-id pub-id-type="pmid">1638929</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
