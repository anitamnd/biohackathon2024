<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Virus Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Virus Evol</journal-id>
    <journal-id journal-id-type="publisher-id">vevolu</journal-id>
    <journal-title-group>
      <journal-title>Virus Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-1577</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6863187</article-id>
    <article-id pub-id-type="doi">10.1093/ve/vez050</article-id>
    <article-id pub-id-type="publisher-id">vez050</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SNAPPy: A snakemake pipeline for scalable HIV-1 subtyping by phylogenetic pairing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Araújo</surname>
          <given-names>Pedro M M</given-names>
        </name>
        <xref ref-type="aff" rid="vez050-aff1">1</xref>
        <xref ref-type="aff" rid="vez050-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Martins</surname>
          <given-names>Joana S</given-names>
        </name>
        <xref ref-type="aff" rid="vez050-aff1">1</xref>
        <xref ref-type="aff" rid="vez050-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0949-5399</contrib-id>
        <name>
          <surname>Osório</surname>
          <given-names>Nuno S</given-names>
        </name>
        <xref ref-type="aff" rid="vez050-aff1">1</xref>
        <xref ref-type="aff" rid="vez050-aff2">2</xref>
        <xref ref-type="corresp" rid="vez050-cor1"/>
        <!--<email>nosorio@med.uminho.pt</email>-->
      </contrib>
    </contrib-group>
    <aff id="vez050-aff1"><label>1</label><institution>Life and Health Sciences Research institute (ICVS), School of Medicine, University of Minho</institution>, Braga, <country country="PT">Portugal</country></aff>
    <aff id="vez050-aff2"><label>2</label><institution>ICVS/3B’s - PT Government Associate Laboratory, Braga, Guimarães</institution>, <country country="PT">Portugal</country></aff>
    <author-notes>
      <corresp id="vez050-cor1">Corresponding author: E-mail: <email>nosorio@med.uminho.pt</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-11-19">
      <day>19</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>5</volume>
    <issue>2</issue>
    <elocation-id>vez050</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vez050.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Human immunodeficiency virus 1 (HIV-1) genome sequencing is routinely done for drug resistance monitoring in hospitals worldwide. Subtyping these extensive datasets of HIV-1 sequences is a critical first step in molecular epidemiology and evolution studies. The clinical relevance of HIV-1 subtypes is increasingly recognized. Several studies suggest subtype-related differences in disease progression, transmission route efficiency, immune evasion, and even therapeutic outcomes. HIV-1 subtyping is mainly done using web-servers. These tools have limitations in scalability and potential noncompliance with data protection legislation. Thus, the aim of this work was to develop an efficient method for large-scale local HIV-1 subtyping. We designed SNAPPy: a snakemake pipeline for scalable HIV-1 subtyping by phylogenetic pairing. It contains several tasks of phylogenetic inference and BLAST queries, which can be executed sequentially or in parallel, taking advantage of multiple-core processing units. Although it was built for subtyping, SNAPPy is also useful to perform extensive HIV-1 alignments. This tool facilitates large-scale sequence-based HIV-1 research by providing a local, resource efficient and scalable alternative for HIV-1 subtyping. It is capable of analyzing full-length genomes or partial HIV-1 genomic regions (GAG, POL, and ENV) and recognizes more than ninety circulating recombinant forms. SNAPPy is freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/PMMAraujo/snappy/releases">https://github.com/PMMAraujo/snappy/releases</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>HIV-1</kwd>
      <kwd>subtyping</kwd>
      <kwd>genetic diversity</kwd>
      <kwd>scalability</kwd>
      <kwd>phylogeny</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">FEDER</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002924</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">COMPETE</named-content>
          <named-content content-type="funder-identifier">10.13039/501100011929</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">FCT</named-content>
          <named-content content-type="funder-identifier">10.13039/100006129</named-content>
        </funding-source>
        <award-id>NORTE-01-0145-FEDER-000013</award-id>
        <award-id>POCI-01-0145-FEDER-007038</award-id>
        <award-id>IF/00474/2014</award-id>
        <award-id>PDE/BDE/113599/2015</award-id>
        <award-id>IF/00474/2014</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1. Introduction</title>
    <p>The number of HIV-1 partial or complete genomic sequences in databases largely increased along the years after a noteworthy surge of almost tenfold in the 2000s. HIV-1 genomic data are extremely valuable for fundamental research, translating into several epidemiological applications such as antiretroviral resistance surveillance or transmission history reconstruction (<xref rid="vez050-B3" ref-type="bibr">Abecasis et al. 2013</xref>; <xref rid="vez050-B43" ref-type="bibr">Yebra et al. 2015</xref>; <xref rid="vez050-B5" ref-type="bibr">Araujo et al. 2019</xref>). Subtyping is a primary analysis done on HIV-1 sequences to allow further investigation.</p>
    <p>HIV-1 was consensually divided in four groups (M, N, O, and P), a consequence of multiple cross-species transmission events from non-human primates to humans. M group is the only with a worldwide dispersion, and due to genetic differences and divergent evolutionary stories viruses from this group were divided into nine Subtypes (A to D, F to H, J, and K) and Sub-subtypes (e.g. A1, A2, F1, and F2). HIV-1 genomes composed of parts of different subtypes are known as recombinant forms, which can be named circulating recombinant forms (CRFs) if several cases are detected or unique recombinant forms (URFs) for more sporadic cases (<xref rid="vez050-B35" ref-type="bibr">Robertson et al. 2000</xref>; <xref rid="vez050-B18" ref-type="bibr">Hemelaar 2013</xref>). It has been reported that different HIV-1 subtypes may be better adapted for specific transmission routes (<xref rid="vez050-B34" ref-type="bibr">Renjifo et al. 2004</xref>; <xref rid="vez050-B20" ref-type="bibr">John-Stewart et al. 2005</xref>), contain higher prevalence of polymorphisms known to influence immune systems (<xref rid="vez050-B8" ref-type="bibr">Bartolo et al. 2011</xref>; <xref rid="vez050-B38" ref-type="bibr">Serwanga et al. 2015</xref>) or antiretroviral treatment evasion (<xref rid="vez050-B9" ref-type="bibr">Brenner et al. 2003</xref>; <xref rid="vez050-B1" ref-type="bibr">Abecasis et al. 2005</xref>; <xref rid="vez050-B11" ref-type="bibr">Camacho and Vandamme 2007</xref>), and lead to differences in the disease progression rate (<xref rid="vez050-B7" ref-type="bibr">Baeten et al. 2007</xref>; <xref rid="vez050-B22" ref-type="bibr">Kiwanuka et al. 2008</xref>; <xref rid="vez050-B14" ref-type="bibr">Easterbrook et al. 2010</xref>; <xref rid="vez050-B5" ref-type="bibr">Araujo et al. 2019</xref>).</p>
    <p>There are three main classes of approaches to perform HIV-1 subtyping: similarity-based (e.g. Stanford (<xref rid="vez050-B27" ref-type="bibr">Liu and Shafer 2006</xref>) and NCBI subtyping tool (<xref rid="vez050-B36" ref-type="bibr">Rozanov et al. 2004</xref>)); statistical-based (e.g. COMET (<xref rid="vez050-B40" ref-type="bibr">Struck et al. 2014</xref>), jpHMM (<xref rid="vez050-B37" ref-type="bibr">Schultz et al. 2009</xref>), and STAR (<xref rid="vez050-B29" ref-type="bibr">Myers et al. 2005</xref>)); and phylogenetic-based (e.g. REGA (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>) and SCUEAL (<xref rid="vez050-B23" ref-type="bibr">Kosakovsky Pond et al. 2009</xref>)). Phylogenetic-based tools are considered the most sensitive and specific but also more time and computational resource consuming (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>; <xref rid="vez050-B15" ref-type="bibr">Fabeni et al. 2017</xref>). Most of the currently available tools are made available in the form of web-servers, making them easy to access and use. Nevertheless, this distribution mode raises issues regarding the scalability of the implementation; it is unreasonable to provide a web-server without limitations in the input size or number of jobs. Making large-scale analysis like multicenter molecular epidemiology studies, systematic reviews or databases curations practically impossible. Moreover, the HIV-1 genomic material corresponds to a clinical result and is often under data protection legislation as such, requiring in many cases an ethic approval for data sharing or submission in external servers.</p>
    <p>Despite the large interest in using phylogeny for HIV-1 subtyping, existing tools have failed to address scalability and privacy issues. To answer these limitations, we used the Snakemake workflow management system (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>) to create a reproducible and scalable HIV-1 subtyping method based on phylogenetic pairing (SNAPPy). By combining established tools with an innovative approach, this pipeline is capable of scaling according to the available computational resources, allowing the local analysis of large amounts (tens of thousands) of HIV-1 genomes. SNAPPy was built on top of the assumption that the phylogenetic relationship provides the best possible identification of the HIV-1 subtype (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>; <xref rid="vez050-B15" ref-type="bibr">Fabeni et al. 2017</xref>). However, recombination events represent exceptions to the assumption of a common ancestor (coalescent) (<xref rid="vez050-B32" ref-type="bibr">Pérez-Losada et al. 2015</xref>). Therefore, we complemented the phylogenetic inference with the similarity search method BLAST (<xref rid="vez050-B10" ref-type="bibr">Camacho et al. 2009</xref>). Reproducibility and efficient transmission of protocols are current challenges in bioinformatics, critical to share domain-specific knowledge (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>; <xref rid="vez050-B13" ref-type="bibr">Di Tommaso et al. 2017</xref>). Therefore, one of the focus in SNAPPy is to give the user access to all the relevant intermediate files created and how the final subtyping decision was performed.</p>
    <p>Overall, we present a problem-solving pipeline to allow local large-scale HIV-1 subtyping, based on phylogenetic inference and complemented with similarity search tasks.</p>
  </sec>
  <sec>
    <title>2. Implementation</title>
    <sec>
      <title>2.1 SNAPPy architecture</title>
      <p>The SNAPPy pipeline was built on the Snakemake workflow management system (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>). Several tools/software were used to perform different tasks within this pipeline: MAFFT v7.245 (<xref rid="vez050-B21" ref-type="bibr">Katoh and Standley 2013</xref>) for multiple sequence alignment (MSA); the Biopython v1.72 (<xref rid="vez050-B12" ref-type="bibr">Cock et al. 2009</xref>) module SeqIO and the ETE Toolkit (ete3) v3.1.1 (<xref rid="vez050-B19" ref-type="bibr">Huerta-Cepas, Serra and Bork 2016</xref>) for data parsing and manipulation; BLAST v2.7.1 (<xref rid="vez050-B10" ref-type="bibr">Camacho et al. 2009</xref>) for local database search; IQ-TREE v1.6.9 (<xref rid="vez050-B30" ref-type="bibr">Nguyen et al. 2015</xref>) for phylogenetic inference. Other Python v3.6 (<xref rid="vez050-B42" ref-type="bibr">Van Rossum and Drake 2009</xref>) packages were also used to create tests, pytest (<xref rid="vez050-B25" ref-type="bibr">Krekel et al. 2019</xref>), and data manipulation, numpy (<xref rid="vez050-B31" ref-type="bibr">Oliphant 2006</xref>) and pandas (<xref rid="vez050-B28" ref-type="bibr">McKinney 2010</xref>). For package management and to create a contained environment for SNAPPy, we recommend Conda (<xref rid="vez050-B4" ref-type="bibr">Anaconda Software Distribution 2019</xref>), and provided a ready to use file to this end (‘environment.yaml’) as well as instructions on how to install and utilize it in SNAPPy’s documentation page (<xref rid="vez050-B6" ref-type="bibr">Araújo, Martins and Osório 2019</xref>).</p>
      <p>The term ‘target’ used in this manuscript refers to the file currently being processed by SNAPPy. When used for subtyping, SNAPPy performs the following tasks to a given target sequence: 1) split the input in multiple single FASTA files; 2) alignment to the reference genome; 3) BLAST against a set of HIV-1 reference sequences; 4) perform phylogenetic inferences using the BLAST top hits, the target, and an outgroup sequence; 5) sliding window BLAST against a database of HIV-1 reference sequences; 6) concatenation and analysis of the results obtained in the previous tasks and creation of the output results. <xref ref-type="fig" rid="vez050-F1">Fig. 1</xref> is a schematic representation of this pipeline. At the end of the subtyping task, SNAPPy produces two files the ‘subtype_results.csv’ and the ‘report_subtype_results.csv’, corresponding to a simplified version of the subtyping result and a more extensive report of all the outputs created by SNAPPy.
</p>
      <fig id="vez050-F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>SNAPPy workflow diagram.</p>
        </caption>
        <graphic xlink:href="vez050f1"/>
      </fig>
      <p>Alternatively, as any other Snakemake (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>) pipeline, intermediate tasks can be performed without the execution of the entire pipeline, making SNAPPy extremely useful for HIV-1 MSA (<xref ref-type="fig" rid="vez050-F1">Fig. 1</xref>, Point 7). To match the names of the intermediate files created by SNAPPy and the header of the target sequences, a file named ‘keys_and_ids.csv’ is created. An in-depth description of each of these general steps can be seen in the following sections.</p>
      <sec>
        <title>2.1.1 Reference sequences</title>
        <p>In all instances of SNAPPy, the HXB2 (GenBank: <ext-link ext-link-type="gen" xlink:href="K03455">K03455</ext-link>) reference genome was used as a genomic position reference. The outgroup sequence used in the phylogenetic analysis corresponds to the CONSENSUS_CPZ sequence from the HIV sequence database (<xref rid="vez050-B41" ref-type="bibr">Theoretical Biology and Biophysics Group 2019</xref>) (Alignment type: Consensus/Ancestral, Year: 2002, Organism: Other SIV, Alignment ID: S02CG1). The creation of a comprehensive set of HIV-1 reference sequences proved to be a challenge. We based our dataset creation on the previously curated ‘HIV sequence database 2010 subtype reference genomes sequences compendium’ (<xref rid="vez050-B26" ref-type="bibr">Kuiken et al. 2010</xref>) and the ‘HIV Drug Resistance Database reference sequences’ (<xref rid="vez050-B39" ref-type="bibr">Shafer 2006</xref>). The final subtype reference dataset for SNAPPy consisted of 491 genomic sequences. It included references for groups N, O, P, and within group M for Subtypes B, C, D, G, H, J, and K, Sub-subtypes A1, A2, F1, and F2 and CRFs until the number 99. Please notice that some CRFs are not represented due to lack of at least two high-quality genomes available (CRFs numbered 30, 66, 75, 76, 84, 89, 91, 95, 97, and 98). The full reference dataset (491 sequences) is used for the BLAST task (see Section 2.1.3) and a subset only containing groups, subtypes, Sub-subtypes and CRFs 1 and 2 references (56 sequences) is used in the sliding window BLAST (see Section 2.1.5). For more information on these reference datasets please consult the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>.</p>
      </sec>
      <sec>
        <title>2.1.2 Alignment to reference</title>
        <p>After splitting the MSA into several single sequence FASTA files, each of them is aligned to the HIV-1 reference genome (HXB2). The module SeqIO from Biopython (<xref rid="vez050-B12" ref-type="bibr">Cock et al. 2009</xref>) is used to parse and manipulate the FASTA files in SNAPPy. The alignment is done using MAFFT (<xref rid="vez050-B21" ref-type="bibr">Katoh and Standley 2013</xref>). The alignment method used does not allow the insertion of gaps in the reference sequence. After the alignment is performed, the target sequence is trimmed to only contain the genomic region specified by the user in the ‘config.yaml’ file. Being the currently available options ‘GAG’, ‘PR’, ‘RT’, ‘PR-RT’, ‘INT’, ‘POL’, ‘ENV’, and ‘GAG-POL-ENV’, which correspond to the HIV-1 genomic regions with the same names in the HXB2 reference genome. The resulting files are them written to the ‘aligned’ folder.</p>
      </sec>
      <sec>
        <title>2.1.3 BLAST</title>
        <p>The obtained alignments are them BLASTed against a local database of 491 HIV-1 reference sequences (see Section 2.1.1). For this task, BLAST (<xref rid="vez050-B10" ref-type="bibr">Camacho et al. 2009</xref>) is used. The results were sorted by bitscore (considering higher is better) and the best scoring result is outputted in the ‘report_subtype_results.csv’ file in the column ‘closser_ref’. The BLAST results are also used to make three groups of references sequences: containing the first forty-eight results; containing the first forty-eight results of only subtype references; containing the first forty-eight results of only CRF references. These three groups of reference sequences are then used in the phylogenetic analysis. The selected number of sequences (forty-eight) showed good compromise between analysis time and reproducibility, as discussed in Section 2.1.4. Since this BLAST task is done as preparation step to the phylogenetic analysis, it must have high sensitivity, so no related reference sequences are missed. To achieve this, the word size parameter was set to 10. We also restricted the cutoff E-value to 1.0e-10 to avoid the creation of large output files, without restricting the results. The intermediate files of the BLAST analysis are outputted to the ‘blast’ folder, being available for further consulting. For the split in subtype and CRF references in this step of SNAPPy, CRFs 1 and 2 are treated as subtypes, not CRFs. This decision was made based on the high prevalence of these CRFs and their ambiguous origin (<xref rid="vez050-B16" ref-type="bibr">Gao et al. 1996</xref>; <xref rid="vez050-B2" ref-type="bibr">Abecasis et al. 2007</xref>).</p>
      </sec>
      <sec>
        <title>2.1.4 Phylogenetic inference</title>
        <p>To the three previously selected groups of forty-eight references (see Section 2.1.3), the target sequence and a non-HIV-1 sequence for rooting (see Section 2.1.1) are added. Obtaining three sets of fifty sequences that will serve as inputs for the phylogenetic analysis. Groups of fifty sequences showed to be contained and yet a comprehensive set of sequences to perform the phylogenetic inference. To perform the phylogenetic analysis, IQ-TREE (<xref rid="vez050-B30" ref-type="bibr">Nguyen et al. 2015</xref>) was used with the general time reversible (GTR) nucleotide substitution model, empirical base frequencies (+F), and a discrete Gamma model with four rate categories (+G4), with the fast tree search mode, and zero as seed number. The ETE toolkit (<xref rid="vez050-B19" ref-type="bibr">Huerta-Cepas, Serra and Bork 2016</xref>) was applied to parse and manipulate the phylogenetic trees created within SNAPPy. After rooting on the outgroup; it is inferred if the target sequence belongs to a monophyletic clade with sequences of one, and only one, subtype or CRF. If this happened, we consider that there is phylogenetic evidence of the relationship between the target sequence and a reference subtype/CRF. The result of this inference, together with the support values for that node (Shimodaira-Hasegawa like approximate likelihood ratio test with 1,000 replicates test, as implemented in IQ-TREE), are then outputted to the ‘report_subtype_results.csv’ file. Resulting in six output columns: ‘node_all_refs’, ‘s_node_all_refs’, ‘node_pure_refs’, ‘s_node_pure_refs’, ‘node_recomb_refs’, and ‘s_node_recomb_refs’. The intermediate files of the phylogenetic analysis are outputted to the ‘trees’ folder. The notation ‘all’, ‘pure’, and ‘recomb’ refers to the set of references used for that phylogenetic reconstruction.</p>
      </sec>
      <sec>
        <title>2.1.5 Sliding window BLAST</title>
        <p>The sliding window BLAST can be performed in parallel with the tasks described in Sections 2.1.3 and 2.1.4, being only dependent on the outputs from the Alignment to the reference task (Section 2.1.2). Initially, the positions in the target sequence corresponding to gaps (‘-’) are excluded. For this task, BLAST (<xref rid="vez050-B10" ref-type="bibr">Camacho et al. 2009</xref>) is used. The length of the sliding window was set to 400 nucleotides, a size previously reported to allow phylogenetic inference in HIV-1 (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>). Smaller fragments/sequences are not processed by this method. The step size used is fifty nucleotides, creating eight bins for each window. The result for each BLAST window, and consequently its eight bins, is the subtype of the top result (bitscore) reference sequence. If more than one sequence of different subtypes has the same top score, the output for all bins of that window is null (‘-’). If the method fails to produce an output, the result for all bins of that window is null. After all possible sliding windows have been BLASTed, several bins will have multiple outputs. Then, a majority rule is applied to decide the final subtype for that bin. In case of a tie, the result for that bin is null. <xref ref-type="fig" rid="vez050-F2">Fig. 2</xref> contains a schematic representation of this process. The database used to BLAST against in this task only contains the group, subtype, sub-subtype and CRF1 1 and 2 references, as described in the references section (fifty-six sequences). The word size parameter applied was 30, with the purpose of obtaining high specificity. Values higher than this showed to cause instability in our tests (low reproducibility). An E-value cutoff of 1.e-50 was used to ensure the generated outputs were not too large, without losing real BLAST hits. The outputs of this inference are written to the ‘report_subtype_results.csv’ file in the column ‘recomb_result’ and the resulting files from these tasks are outputted to the ‘blast’ folder.
</p>
        <fig id="vez050-F2" orientation="portrait" position="float">
          <label>Figure 2.</label>
          <caption>
            <p>Sliding window BLAST schematic representation.</p>
          </caption>
          <graphic xlink:href="vez050f2"/>
        </fig>
      </sec>
      <sec>
        <title>2.1.6 Decision rules</title>
        <p>The results generated by the full sequence BLAST, phylogenetic analysis, and the sliding window BLAST are then processed using a set of rules to produce the final output. These rules are executed in order, meaning that the second rule is only applied if the first rule criteria were not met, and so forth. The list of these rules can be consulted in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>. At the end of the process, two final outputs are created in the snappy folder: ‘subtype_results.csv’ and ‘report_subtype_results.csv’, as mentioned earlier.</p>
      </sec>
      <sec>
        <title>2.1.7 System management</title>
        <p>SNAPPy is a pipeline that performs several tasks, some of them generate a relatively large number of outputs. Therefore, in order to avoid wasting unnecessary disk space and simplifying the user experience, some of the intermediate files produced by SNAPPy are deleted before the end of the process. However, all the relevant files for the subtyping decision are kept and available for consulting after the pipeline finishes. At the end of each SNAPPy run, a snakemake hidden folder named ‘.snakemake’ is deleted because it occupies a substantial amount of space. However, this folder contains all the logs about the tasks performed and may be useful for debugging.</p>
        <p>SNAPPy is distributed with a series of built-in tests created using pytest (<xref rid="vez050-B25" ref-type="bibr">Krekel et al. 2019</xref>). After installing SNAPPy or after making alterations in SNAPPy’s folder is recommended to run the tests to infer if the pipeline is behaving as expected.</p>
        <p>SNAPPy’s documentation (Araújo, Martins and Osório 2019) includes detailed instructions on: pipeline installation; tutorials on how to use it; a list of available commands; an in-depth description of each pipeline step; FAQ; and how to cite and user license information.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Pipeline evaluation</title>
      <sec>
        <title>2.2.1 Reproducibility</title>
        <p>One of the bases of SNAPPy is phylogenetic inference, which has some stochasticity involved. As implemented in IQ-TREE (<xref rid="vez050-B30" ref-type="bibr">Nguyen et al. 2015</xref>), the initial topologies are constructed based on heuristic methods, which afterwards is optimized with maximum-likelihood rearrangements. In theory, this could lead to variance in the output of the subtyping pipeline. Furthermore, for the evaluation of the branch support, we were faced with the possibility of using statistic-based (e.g. Shimodaira-Hasegawa test) or sampling-based (e.g. bootstrapping) methods. In our tests, we found that the usage of bootstrapping approaches leads to some lack of reproducibility in the pipeline outputs, even at one thousand replicates, as previously reported (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>). Which may be explained by the low percentage of informative sites found in the tested HIV-1 sequences, which are extremely similar among each other. The increment of the bootstrapping replicates would lead to an exponential increment of the phylogenetic inference step computational time, making the pipeline much slower. Therefore, we decided to use a statistic-based branch support inference method, the Shimodaira-Hasegawa test, for phylogenetic inference in SNAPPy. As stated in the Sections 2.1.3 and 2.1.5, when using BLAST, the word size and cutoff parameters were selected to achieve the desired objectives (sensitivity or specificity) and ensure the stability of the analysis. After the pipeline was constructed, we performed 6 sets of 3 independent SNAPPy runs with a test set of 5,285 sequences (see Section 2.2.2) and compared the outputs of each independent run in terms of reproducibility. The obtained result was 100% reproducibility, meaning that the output file ‘subtyping_results.csv’ for each of the independent runs were exactly the same.</p>
      </sec>
      <sec>
        <title>2.2.2 Scalability</title>
        <p>SNAPPy was built for large-scale analysis, taking advantage of modern multi core/thread CPUs. The usage of Snakemake (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>) as a workflow manager allows the construction of a directed acyclic graph of jobs, inferring which tasks need to be performed sequential and which can run in parallel. To infer the overall scalability of SNAPPy regarding multithreading, we performed the subtyping of a test set of 5,285 sequences with the following number of CPU threads: 1, 2, 4, 8, 16, and 32. The selection of these numbers was made having as objective the comparison of the computation time reduction by half (halving) when doubling the amount of computational resources. In <xref ref-type="fig" rid="vez050-F3">Fig. 3</xref>, there is a comparison of the real time that SNAPPy took to subtype the test set versus the expected halving time. This expected time reduction is purely theoretical and constructed based on the time SNAPPy took to subtype the test set with one core and subsequence duplication of the number of computational resources used. The performance regarding smaller test sets and for specific genomic regions was also evaluated and can be consulted in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. These tests were performed in a server with double Xeon E5-2680 2.50 GHz CPU (twelve cores/twenty-four threads), 128 GB of ram 2,133 MHz, in a SATA III SSD hard drive.
</p>
        <fig id="vez050-F3" orientation="portrait" position="float">
          <label>Figure 3.</label>
          <caption>
            <p>Multiple thread CPU time performance and associated percentage loss.</p>
          </caption>
          <graphic xlink:href="vez050f3"/>
        </fig>
        <p>SNAPPy manages the generated files in order to give the user all the information needed to understand the results and decisions made. This feature is a tradeoff purposely made to give users the maximum amount of information without wasting disk space. Nevertheless, when used for large-scale analysis (tens of thousands of sequences), SNAPPy will create a large number of small files that together occupy a considerable amount of disk space. As an indicator, a SNAPPy run of 50,000 HIV-1 sequences occupied at the peak 59 GB and &lt;4 GB after the depletion of the snakemake hidden logs folder.</p>
      </sec>
      <sec>
        <title>2.2.3 Subtyping methods comparison</title>
        <p>The division of HIV-1 in groups, subtypes, and sub-subtypes is extremely valuable for epidemiological inferences (<xref rid="vez050-B3" ref-type="bibr">Abecasis et al. 2013</xref>; <xref rid="vez050-B43" ref-type="bibr">Yebra et al. 2015</xref>; <xref rid="vez050-B5" ref-type="bibr">Araujo et al. 2019</xref>). However, this division is a man-made construction that only makes sense in the eyes of a phylogenetic or epidemy reconstruction (<xref rid="vez050-B18" ref-type="bibr">Hemelaar 2013</xref>; <xref rid="vez050-B5" ref-type="bibr">Araujo et al. 2019</xref>). Therefore, it makes sense to argue that phylogenetic reconstruction is the gold standard for HIV-1 subtyping (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>; <xref rid="vez050-B15" ref-type="bibr">Fabeni et al. 2017</xref>), with the exception of recombination events that represent a deviation from the coalescent assumption (<xref rid="vez050-B32" ref-type="bibr">Pérez-Losada et al. 2015</xref>). Since SNAPPy is based on phylogenetic inference, using phylogeny to evaluate SNAPPy’s performance would be poorly informative. Given this limitation, we decided to test SNAPPy against a set of other HIV-1 subtyping methods, evaluating their convergence and divergence. The selected HIV-1 subtyping methods were REGA v3.0 (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>), COMET v2.3 (<xref rid="vez050-B40" ref-type="bibr">Struck et al. 2014</xref>), and SCUEAL (<xref rid="vez050-B23" ref-type="bibr">Kosakovsky Pond et al. 2009</xref>). This selection was made based on our best knowledge of available tools including statistical and phylogeny-based methods.</p>
        <p>For this comparison, a test set of 5,285 sequences was created (the ids of the test set sequences can be consulted in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). From all the available complete HIV-1 genomes (&gt;9,100) in the HIV-1 sequence database (Theoretical Biology and Biophysics Group 2019) 10% of sequences for each of the subtypes present (according to the database) were selected at random, comprising a total of 1,057 genomes. Those genomes were then trimmed for four genomic regions: ENV, GAG, POL, and PR-RT. Together, the full genome sequences and the trimmed replicates compose the full test set (5,285 sequences). This test set was designed to explore the capabilities of each subtyping method in an extensive variety of subtypes while using different HIV-1 genomic regions as input. However, there are differences in the methods implementations; SCUEAL only subtypes sequences of the POL region, therefore the comparison dataset for this tool is smaller (1,057 sequences × 3 regions = 3,171 sequences), and is capable of recognizing CRFs until the number 43; REGA is able to recognize CRFs until the number 47; COMET is cable of recognizing CRFs until the number 96. The outputs for each subtyping tool required some manipulation in order to achieve a ‘common language’, making it possible to compare all the tools outputs. Regarding REGA outputs, the terms ‘like’ and ‘potential recombinant’ were excluded, maintaining the assigned subtype; the outputs with ‘recombination of’ were named URFs of the described subtypes or URF_CPX if there was an indication of more than two recombining subtypes. REGA results marked only with the information of ‘Recombinant’ were transformed into URF_CPX; and when the outputs were ‘Check the report’ no subtyping result was assigned. For the COMET outputs the only transformation was to change ‘unassigned’ to URFs of the subtypes present or URF_CPX if more than two subtypes were reported. Concerning the SCUEAL outputs, the words ‘ancestral’ and ‘like’ were excluded; ‘Complex’ was converted to URF_CPX and ‘AE’ to CRF_01. The SCUEAL results with ‘recombinant’ and more than two subtypes were converted to URF_CPX and those with less than two subtypes converted to URFs; for outputs with ‘U’ and ‘FAILED’ no subtyping result was assigned. The comparison between the four subtyping methods results can be seen in <xref ref-type="fig" rid="vez050-F4">Fig. 4</xref>. The highest level of agreement was observed between SNAPPy and COMET (83%), whereas SCUEAL and REGA had the lowest concordance (61%). The remaining pairs showed results in the range between 72 and 78%.
</p>
        <fig id="vez050-F4" orientation="portrait" position="float">
          <label>Figure 4.</label>
          <caption>
            <p>Percentage of agreement observed among the HIV-1 subtyping tools tested.</p>
          </caption>
          <graphic xlink:href="vez050f4"/>
        </fig>
        <p>We also calculated the precision, recall, and F1 scores (balance of precision and recall) for the three subtyping methods tested (REGA, SCUEAL, and COMET) versus SNAPPy (<xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S5–S7</xref>). This analysis was performed to give an indication for users comparing results obtained with other tools and SNAPPy, for each HIV-1 group, subtype, sub-subtype, CRF, and URF. The precision and recall metrics can be seen as indicators if SNAPPy is classifying a given subtype in the test set more or less often, respectively, than the subtyping method it is being compared with. Without surprise, in the test set the results for Subtypes B and C (the most abundant) and non-M HIV-1 groups (N, O, and P) showed the highest F1 scores. The results for URFs and CRFs showed great variability.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3. Discussion and conclusions</title>
    <p>The quantity of available HIV-1 genomes is ever increasing; the manual handling of such large amounts of data is impractical, leading to the need of creating analysis pipelines. Such pipelines targeting specific challenges are a practical and effective way of disseminating domain knowledge and increasing reproducibility (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>; <xref rid="vez050-B13" ref-type="bibr">Di Tommaso et al. 2017</xref>). The test set used for the different metrics evaluated here is composed of 1,057 sequences of HIV-1 genomes and the same sequences trimmed for the genomic regions ENV, GAG, POL, and PR-RT corresponding to a total of 5,285 sequences.</p>
    <p>There is some stochasticity involved in the phylogenetic inference process as established in IQ-TREE (<xref rid="vez050-B30" ref-type="bibr">Nguyen et al. 2015</xref>). Nevertheless, the parameters selected for the branching support evaluation and the number of samples per tree allowed 100% reproducibility among independent SNAPPy runs results in an extremely diverse test set. This outcome highlights the versatility and reliability of this pipeline.</p>
    <p>Together with the increment in the amount of data available, there have been hardware improvements, particularly in recent years CPUs with a high number of cores/threads (≥8) have reached the mainstream segment of the market. Therefore, tool building should be done to take maximum advantage of these resources. Snakemake (<xref rid="vez050-B24" ref-type="bibr">Koster and Rahmann 2012</xref>), the pipeline workflow management systems that SNAPPy is built upon, allows an almost linear scaling in the ratio of computational time/number of CPU cores used. The expected reduction by half of the computational time by doubling the number of threads used was observed in SNAPPy runs of the test set with minor percentage lost when using 2, 4, 8, or 16 CPU threads (1, 2, 5, and 9%, respectively). However, for the runs with thirty-two threads, the drop from the expected halving time was almost 35%. This drop may be a consequence of the hardware used, since it is composed of twenty-four independent CPU cores (two CPUs × twelve cores) passing that number may cause single thread performance loss. Therefore, we do not advice the usage of SNAPPy multithreading capabilities in more instances than the number of physical CPU cores of the machine used.</p>
    <p>The classification of different HIV-1 sequences in groups, subtypes, sub-subtypes, or recombinant forms is a challenging and sometimes ambiguous process. Sequence-based phylogenetic reconstruction of the evolutionary history assuming a common ancestry of the viral samples is consensually identified as the best approach for HIV-1 subtyping (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>; <xref rid="vez050-B15" ref-type="bibr">Fabeni et al. 2017</xref>). However, the coalescent assumption is not fulfilled in the cases of recombination (<xref rid="vez050-B32" ref-type="bibr">Pérez-Losada et al. 2015</xref>). Therefore, two complementary approaches were used in SNAPPY, one based on BLAST (<xref rid="vez050-B10" ref-type="bibr">Camacho et al. 2009</xref>) similarity searches and another based on the phylogenetic inference (IQ-TREE, <xref rid="vez050-B30" ref-type="bibr">Nguyen et al. 2015</xref>).</p>
    <p>The side-by-side comparison of different HIV-1 subtyping methodologies is complex and sometimes impossible. Here, we compared SNAPPy, REGA (<xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>), COMET (<xref rid="vez050-B40" ref-type="bibr">Struck et al. 2014</xref>), and SCUEAL (<xref rid="vez050-B23" ref-type="bibr">Kosakovsky Pond et al. 2009</xref>) outputs for a test set of 5,285 sequences (<xref ref-type="fig" rid="vez050-F4">Fig. 4</xref>). As described in the methods section, the regions of the HIV-1 genome these tools are capable of subtyping and the number of CRFs they are able to identify varies. Without surprise, COMET and SNAPPy have the highest value of accordance (&gt;80%) among the tested tools. This outcome is highly influenced by the fact that these tools are prepared to identify a large number of CRFs (&gt;90) in comparison with the remaining two tools in this test. The lowest accordance was observed between the pair REGA and SCUEAL (61%). The lowest pairing for SNAPPy was REGA with 73% followed by SCUEAL with 77%.</p>
    <p>In <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S5–S7</xref>, we show the precision, recall, and F1 scores resulting from the comparison of three subtyping methods (REGA, COMET and SCUEAL) with SNAPPy, for each HIV-1 group, subtype, sub-subtype, CRF, and URF. The overall F1 scores for REGA and SCUEAL suffer from the fact that these tools identify a narrower range of CRFs than SNAPPy. Moreover, SCUEAL only subtypes sequences for the POL HIV-1 genomic region, being sequences from the remaining regions treated as missing data, and therefore driving the F1 score further down. Nevertheless, is it expected a great reproducibility among these two tools and SNAPPy for Subtypes B and C, group N and several CRFs (1, 5, 13, 27, 35, 40, 42, and 47 for REGA and 5, 17, 18, 19, 24, 31, and 33 for SCUEAL). On the other hand, COMET is capable of identifying a wide range of CRFs, similarly to SNAPPy, which is observed in the overall F1 score (0.83), precision (0.87), and recall (0.83) results. Regarding the test set, these two tools identified CRFs 17, 27, 34, 40, 47, 68, and 74 in exactly the same cases and Subtypes B and C, and Groups N, P, and O with a high similarity rate (F1 scores, respectively: 0.99, 0.94, 1.0, 1.0, and 0.96). The results for subtypes that showed less reproducibility among the three tested methods and SNAPPy, were Subtypes H and K and sub-Subtype A2 and F2.</p>
    <p>These results highlight the variability observed among HIV-1 subtyping tools, which is expected (<xref rid="vez050-B17" ref-type="bibr">Gifford et al. 2006</xref>; <xref rid="vez050-B33" ref-type="bibr">Pineda-Peña et al. 2013</xref>; <xref rid="vez050-B15" ref-type="bibr">Fabeni et al. 2017</xref>) and should not be seen as a drawback but instead as an interval of possibilities around a subtyping result. Moreover, these results demonstrate that when several HIV-1 tools agree in one result, there is a high degree of confidence in that outcome. SNAPPy is not strictly better or worse than the other tools regarding the final result, but it is a needed addition to this space, allowing local large-scale HIV-1 subtyping while being versatile, reliable and cable of scaling. The results reported here emphasized the importance of SNAPPy to facilitate the subtype annotation of large datasets of HIV-1 genomic sequences. This work represents a novel approach for HIV-1 subtyping that can contribute significantly towards a better understanding of the relevant roles and traits of the different HIV-1 subtypes.</p>
    <p>
      <boxed-text id="vez050-BOX1" position="float" orientation="portrait">
        <sec>
          <title>Key points</title>
          <p>
            <list list-type="simple">
              <list-item>
                <p>● The amount of available HIV-1 genomic information is increasing, therefore there is a need to create tools to perform scalable analysis of HIV-1 subtypes.</p>
              </list-item>
              <list-item>
                <p>● HIV-1 subtyping methods have considerable differences in their implementations and, consequently, their outputs.</p>
              </list-item>
              <list-item>
                <p>● SNAPPy is capable of local large-scale HIV-1 subtyping with great reproducibility while being able to scale according to the computational resources available.</p>
              </list-item>
            </list>
          </p>
        </sec>
      </boxed-text>
    </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>SNAPPy source code is freely available via GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/PMMAraujo/snappy/releases">https://github.com/PMMAraujo/snappy/releases</ext-link>. SNAPPy documentation can be consulted at: <ext-link ext-link-type="uri" xlink:href="https://snappy-hiv1-subtyping.readthedocs.io/">https://snappy-hiv1-subtyping.readthedocs.io/</ext-link>.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by FEDER, COMPETE, and FCT by the projects NORTE-01-0145-FEDER-000013, POCI-01-0145-FEDER-007038, and IF/00474/2014; FCT PhD scholarship PDE/BDE/113599/2015; FCT contract IF/00474/2014.</p>
    <p><bold>Conflict of interest:</bold> None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>vez050_Supplementary_Data</label>
      <media xlink:href="vez050_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vez050-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Abecasis</surname><given-names>A. B.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) ‘<article-title>Protease Mutation M89I/V Is Linked to Therapy Failure in Patients Infected with the HIV-1 non-B Subtypes C, F or G</article-title>’, <source>AIDS</source>, <volume>19</volume>: <fpage>1799</fpage>–<lpage>806</lpage>.<pub-id pub-id-type="pmid">16227787</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Abecasis</surname><given-names>A. B.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) ‘<article-title>Recombination Confounds the Early Evolutionary History of Human Immunodeficiency Virus Type 1: Subtype G Is a Circulating Recombinant Form</article-title>’, <source>Journal of Virology</source>, <volume>81</volume>: <fpage>8543</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">17553886</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Abecasis</surname><given-names>A. B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) ‘<article-title>HIV-1 Subtype Distribution and Its Demographic Determinants in Newly Diagnosed Patients in Europe Suggest Highly Compartmentalized Epidemics</article-title>’, <source>Retrovirology</source>, <volume>10</volume>: <fpage>7</fpage>.<pub-id pub-id-type="pmid">23317093</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B4">
      <mixed-citation publication-type="other">Anaconda Software Distribution. Computer Software. Vers. 3-4.6.14. Miniconda, April <year>2019</year> &lt;<ext-link ext-link-type="uri" xlink:href="https://anaconda.com">https://anaconda.com</ext-link>&gt;</mixed-citation>
    </ref>
    <ref id="vez050-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Araujo</surname><given-names>P. M. M.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) ‘<article-title>Characterization of a Large Cluster of HIV-1 A1 Infections Detected in Portugal and Connected to Several Western European Countries</article-title>’, <source>Scientific Report</source>, <volume>9</volume>: <fpage>7223</fpage>.</mixed-citation>
    </ref>
    <ref id="vez050-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Araújo</surname><given-names>P. M. M.</given-names></name>, <name name-style="western"><surname>Martins</surname><given-names>J. S.</given-names></name>, <name name-style="western"><surname>Osório</surname><given-names>N. S.</given-names></name></person-group> SNAPPy documentation. September <year>2019</year> &lt;<ext-link ext-link-type="uri" xlink:href="https://snappy-hiv1-subtyping.readthedocs.io/en/latest/">https://snappy-hiv1-subtyping.readthedocs.io/en/latest/</ext-link>&gt;</mixed-citation>
    </ref>
    <ref id="vez050-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baeten</surname><given-names>J. M.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) ‘<article-title>HIV-1 Subtype D infection is associated with Faster Disease Progression than Subtype a in Spite of Similar Plasma HIV-1 Loads</article-title>’, <source>The Journal of Infectious Diseases</source>, <volume>195</volume>: <fpage>1177</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">17357054</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bartolo</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) ‘<article-title>Origin and Epidemiological History of HIV-1 CRF14_BG</article-title>’, <source>PLoS One</source>, <volume>6</volume>: <fpage>e24130</fpage>.<pub-id pub-id-type="pmid">21969855</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brenner</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) ‘<article-title>A V106M Mutation in HIV-1 Clade C Viruses Exposed to Efavirenz Confers Cross-Resistance to Non-Nucleoside Reverse Transcriptase Inhibitors</article-title>’, <source>AIDS</source>, <volume>17</volume>: <fpage>F1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">12478089</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Camacho</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) ‘<article-title>BLAST+: Architecture and Applications</article-title>’, <source>BMC Bioinformatics</source>, <volume>10</volume>: <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Camacho</surname><given-names>R. J.</given-names></name>, <name name-style="western"><surname>Vandamme</surname><given-names>A.-M.</given-names></name></person-group> (<year>2007</year>) ‘<article-title>Antiretroviral Resistance in Different HIV-1 Subtypes: Impact on Therapy Outcomes and Resistance Testing Interpretation</article-title>’, <source>Current Opinion in HIV and AIDS</source>, <volume>2</volume>: <fpage>123</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19372877</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cock</surname><given-names>P. J. A.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) ‘<article-title>Biopython: Freely Available Python Tools for Computational Molecular Biology and Bioinformatics</article-title>’, <source>Bioinformatics</source>, <volume>25</volume>: <fpage>1422</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Di Tommaso</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) ‘<article-title>Nextflow Enables Reproducible Computational Workflows</article-title>’, <source>Nature Biotechnology</source>, <volume>35</volume>: <fpage>316</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="vez050-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Easterbrook</surname><given-names>P. J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) ‘<article-title>Impact of HIV-1 Viral Subtype on Disease Progression and Response to Antiretroviral Therapy</article-title>’, <source>Journal of the International Aids Society</source>, <volume>13</volume>: <fpage>4</fpage>.<pub-id pub-id-type="pmid">20205896</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fabeni</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) ‘<article-title>Comparative Evaluation of Subtyping Tools for Surveillance of Newly Emerging HIV-1 Strains</article-title>’, <source>Journal of Clinical Microbiology</source>, <volume>55</volume>: <fpage>2827</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">28701420</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gao</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>) ‘<article-title>The Heterosexual Human Immunodeficiency Virus Type 1 Epidemic in Thailand Is Caused by an Intersubtype (a/E) Recombinant of African Origin</article-title>’, <source>Journal of Virology</source>, <volume>70</volume>: <fpage>7013</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">8794346</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gifford</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) ‘<article-title>Assessment of Automated Genotyping Protocols as Tools for Surveillance of HIV-1 Genetic Diversity</article-title>’, <source>AIDS</source>, <volume>20</volume>: <fpage>1521</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">16847407</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hemelaar</surname><given-names>J.</given-names></name></person-group> (<year>2013</year>) ‘<article-title>Implications of HIV Diversity for the HIV-1 Pandemic</article-title>’, <source>Journal of Infection</source>, <volume>66</volume>: <fpage>391</fpage>–<lpage>400</lpage>.<pub-id pub-id-type="pmid">23103289</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huerta-Cepas</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Serra</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Bork</surname><given-names>P.</given-names></name></person-group> (<year>2016</year>) ‘<article-title>ETE 3: Reconstruction, Analysis, and Visualization of Phylogenomic Data</article-title>’, <source>Molecular Biology and Evolution</source>, <volume>33</volume>: <fpage>1635</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>John-Stewart</surname><given-names>G. C.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) ‘<article-title>Subtype C Is Associated with Increased Vaginal Shedding of HIV-1</article-title>’, <source>The Journal of Infectious Diseases</source>, <volume>192</volume>: <fpage>492</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">15995964</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Standley</surname><given-names>D. M.</given-names></name></person-group> (<year>2013</year>) ‘<article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>’, <source>Molecular Biology and Evolution</source>, <volume>30</volume>: <fpage>772</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiwanuka</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) ‘<article-title>Effect of Human Immunodeficiency Virus Type 1 (HIV-1) Subtype on Disease Progression in Persons from Rakai, Uganda, with Incident HIV-1 Infection</article-title>’, <source>The Journal of Infectious Diseases</source>, <volume>197</volume>: <fpage>707</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">18266607</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kosakovsky Pond</surname><given-names>S. L.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) ‘<article-title>An Evolutionary Model-Based Algorithm for Accurate Phylogenetic Breakpoint Mapping and Subtype Prediction in HIV-1</article-title>’, <source>PLoS Computational Biology</source>, <volume>5</volume>: <fpage>e1000581</fpage>.<pub-id pub-id-type="pmid">19956739</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koster</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) ‘<article-title>Snakemake–a Scalable Bioinformatics Workflow Engine</article-title>’, <source>Bioinformatics</source>, <volume>28</volume>: <fpage>2520</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Krekel</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> Computer software. Vers. 4.5.0. Pytest, April <year>2019</year> &lt;<ext-link ext-link-type="uri" xlink:href="https://docs.pytest.org/en/latest/">https://docs.pytest.org/en/latest/</ext-link>&gt;</mixed-citation>
    </ref>
    <ref id="vez050-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="editor"><name name-style="western"><surname>Kuiken</surname><given-names>C.</given-names></name></person-group><etal>et al</etal>, eds. (<year>2010</year>). <italic>HIV Sequence Compendium</italic> NM: Theoretical Biology and Biophysics Group, Los Alamos National Laboratory, LA-UR <fpage>10</fpage>–<lpage>03684</lpage>.</mixed-citation>
    </ref>
    <ref id="vez050-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>T. F.</given-names></name>, <name name-style="western"><surname>Shafer</surname><given-names>R. W.</given-names></name></person-group> (<year>2006</year>) ‘<article-title>Web Resources for HIV Type 1 Genotypic-Resistance Test Interpretation</article-title>’, <source>Clinical Infectious Diseases : An Official Publication of the Infectious Diseases Society of America</source>, <volume>42</volume>: <fpage>1608</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">16652319</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="editor"><name name-style="western"><surname>McKinney</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>van der Walt,</surname><given-names>S.</given-names></name> and <name name-style="western"><surname>Millman</surname><given-names>J.</given-names></name> (eds)</person-group> (<year>2010</year>) ‘Data Structures for Statistical Computing in Python’. in van der Walt S. and Millman, J. (eds)  <italic>Proceedings of the 9th Python in Science Conference</italic>, pp. <fpage>51</fpage>–<lpage>6</lpage>. <ext-link ext-link-type="uri" xlink:href="http://conference.scipy.org/proceedings/scipy2010/mckinney.html">http://conference.scipy.org/proceedings/scipy2010/mckinney.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="vez050-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Myers</surname><given-names>R. E.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) ‘<article-title>A Statistical Model for HIV-1 Sequence Classification Using the Subtype Analyser (STAR)</article-title>’, <source>Bioinformatics</source>, <volume>21</volume>: <fpage>3535</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">16046498</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nguyen</surname><given-names>L.-T.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>IQ-TREE: A Fast and Effective Stochastic Algorithm for Estimating Maximum-Likelihood Phylogenies</article-title>’, <source>Molecular Biology and Evolution</source>, <volume>32</volume>: <fpage>268</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">25371430</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Oliphant</surname><given-names>T. E.</given-names></name></person-group> (<year>2006</year>) <source>A Guide to NumPy</source>. <publisher-loc>USA</publisher-loc>: <publisher-name>Trelgol Publishing</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vez050-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pérez-Losada</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>Recombination in Viruses: Mechanisms, Methods of Study, and Evolutionary Consequences</article-title>’, <source>Infection, Genetics and Evolution</source>, <volume>30</volume>: <fpage>296</fpage>–<lpage>307</lpage>.</mixed-citation>
    </ref>
    <ref id="vez050-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pineda-Peña</surname><given-names>A.-C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) ‘<article-title>Automated Subtyping of HIV-1 Genetic Sequences for Clinical and Surveillance Purposes: Performance Evaluation of the New REGA Version 3 and Seven Other Tools</article-title>’, <source>Infection, Genetics and Evolution</source>, <volume>19</volume>: <fpage>337</fpage>–<lpage>48</lpage>.</mixed-citation>
    </ref>
    <ref id="vez050-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Renjifo</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) ‘<article-title>Preferential in-Utero Transmission of HIV-1 Subtype C as Compared to HIV-1 Subtype a or D</article-title>’, <source>AIDS</source>, <volume>18</volume>: <fpage>1629</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">15280773</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robertson</surname><given-names>D. L.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) ‘<article-title>HIV-1 Nomenclature Proposal</article-title>’, <source>Science</source>, <volume>288</volume>: <fpage>55</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">10766634</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rozanov</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) ‘<article-title>A Web-Based Genotyping Resource for Viral Sequences</article-title>’, <source>Nucleic Acids Research</source>, <volume>32</volume>: <fpage>W654</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15215470</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schultz</surname><given-names>A.-K.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) ‘<article-title>jpHMM: Improving the Reliability of Recombination Prediction in HIV-1</article-title>’, <source>Nucleic Acids Research</source>, <volume>37</volume>: <fpage>W647</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">19443440</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Serwanga</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>Frequencies of Gag-Restricted T-Cell Escape ‘Footprints’ Differ across HIV-1 Clades A1 and D Chronically Infected Ugandans Irrespective of Host HLA B Alleles</article-title>’, <source>Vaccine</source>, <volume>33</volume>: <fpage>1664</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">25728323</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shafer</surname><given-names>R. W.</given-names></name></person-group> (<year>2006</year>) ‘<article-title>Rationale and Uses of a Public HIV Drug-Resistance Database</article-title>’, <source>The Journal of Infectious Diseases</source>, <volume>194(Suppl</volume>): <fpage>S51</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">16921473</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Struck</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) ‘<article-title>COMET: Adaptive Context-Based Modeling for Ultrafast HIV-1 Subtype Identification</article-title>’, <source>Nucleic Acids Research</source>, <volume>42</volume>: <fpage>e144</fpage>.<pub-id pub-id-type="pmid">25120265</pub-id></mixed-citation>
    </ref>
    <ref id="vez050-B41">
      <mixed-citation publication-type="other">Theoretical Biology and Biophysics Group, Los Alamos National Laboratory, HIV sequence database, April <year>2019</year> &lt;<ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/">http://www.hiv.lanl.gov/</ext-link>&gt;</mixed-citation>
    </ref>
    <ref id="vez050-B42">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Van Rossum</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Drake</surname><given-names>F. L.</given-names></name></person-group> (<year>2009</year>) <source>Python 3 Reference Manual</source>. <publisher-loc>CA</publisher-loc>: <publisher-name>CreateSpace</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vez050-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yebra</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>Analysis of the History and Spread of HIV-1 in Uganda Using Phylodynamics</article-title>’, <source>Journal of General Virology</source>, <volume>96</volume>: <fpage>1890</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25724670</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
