<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub April-5-2010?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2919714</article-id>
    <article-id pub-id-type="pmid">20371516</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkq211</article-id>
    <article-id pub-id-type="publisher-id">gkq211</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Detection of splice junctions from paired-end RNA-seq data by SpliceMap</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Au</surname>
          <given-names>Kin Fai</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Hui</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Lan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xing</surname>
          <given-names>Yi</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wong</surname>
          <given-names>Wing Hung</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Department of Statistics, Stanford University, Stanford, CA 94305, <sup>2</sup>Stanford Genome Technology Center, 855 California Ave, Palo Alto, CA 94304 and <sup>3</sup>Department of Internal Medicine and Department of Biomedical Engineering, University of Iowa, Iowa City, IA, 52242, USA</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+1 650 725 2915</phone>; Fax: <fax>+1 650 725 8977</fax>; Email: <email>whwong@stanford.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>38</volume>
    <issue>14</issue>
    <fpage>4570</fpage>
    <lpage>4578</lpage>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>12</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>3</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>3</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Alternative splicing is a prevalent post-transcriptional process, which is not only important to normal cellular function but is also involved in human diseases. The newly developed second generation sequencing technique provides high-throughput data (RNA-seq data) to study alternative splicing events in different types of cells. Here, we present a computational method, SpliceMap, to detect splice junctions from RNA-seq data. This method does not depend on any existing annotation of gene structures and is capable of finding novel splice junctions with high sensitivity and specificity. It can handle long reads (50–100 nt) and can exploit paired-read information to improve mapping accuracy. Several parameters are included in the output to indicate the reliability of the predicted junction and help filter out false predictions. We applied SpliceMap to analyze 23 million paired 50-nt reads from human brain tissue. The results show at this depth of sequencing, RNA-seq can support reliable detection of splice junctions except for those that are present at very low level. Compared to current methods, SpliceMap can achieve 12% higher sensitivity without sacrificing specificity.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>RNA splicing is an important post-transcriptional step where one or more segments of the pre-mRNA are spliced out and the remaining segments (exons) are concatenated to form the mature mRNA product. By alternative splicing, it is possible to produce different transcripts (isoforms) from the same genetic locus. This process occurs in over 90% of multi-exon human genes (<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>) and greatly increases the diversity of possible transcripts in the transcriptome. Aberrant RNA splicing has been found to be associated with many human diseases (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>). For this reason, techniques to identify and quantify splicing events are important to biology and medicine.</p>
    <p>The most popular way to study the structure and abundance of spliced transcripts is through sequencing of expressed sequence tags (ESTs) (<xref ref-type="bibr" rid="B5">5</xref>). Traditionally, such studies were expensive and inefficient due to the low throughput of the Sanger method which was the main sequencing technology used in EST projects. However, with the recent advent of second generation sequencing technology (SGS), it is now feasible to conduct deep and comprehensive sequencing of transcriptomes in a high throughput and cost effective manner (<xref ref-type="bibr" rid="B6 B7 B8">6–8</xref>), making it possible to detect rare alternative splicing events. In such RNA-seq projects, tens or hundreds of millions of short sequences (30–100 nt) are read randomly from the population of transcripts under study. The first step of the analysis is thus the mapping of each short read to a reference genome to determine the genetic loci that may give rise to this read. For reads that are sampled completely within exonic regions, this mapping task can be handled by any existing short-read mapping programs, such as ELAND (Cox, unpublished software) and SeqMap (<xref ref-type="bibr" rid="B9">9</xref>).</p>
    <p>However, the reads that are of most interest to us for novel isoform discovery are the ones that span across exon-exon junctions. These ‘junction reads’ cannot be mapped directly to the genome. One approach is to map the reads onto the known transcript sequences from the currently annotated exon library. Since the exon library is incomplete, this method cannot find the junctions that involve novel splicing events (<xref ref-type="bibr" rid="B10">10</xref>). In another approach, used in the recently developed TopHat (<xref ref-type="bibr" rid="B11">11</xref>) program, reads that are mappable on the reference genome are grouped into distinct clusters such that the reads within each cluster are linked together through overlapping regions. Each cluster then defines a putative exonic region. Subsequently, exon-exon junctions can be searched based on these putative exon definitions.</p>
    <p>Clustering is a natural approach to find novel junctions in the first RNA-seq experiments (<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B12 B13 B14 B15 B16 B17">12–17</xref>) because the data generated at the early stage of the development of SGS are mostly very short reads (25–36 nt) that are not suitable for direct <italic>de novo</italic> detection of exon–exon junctions. However, the technology is improving rapidly, and currently the usable length of reads from some SGS instruments like the Illumina Genome Analyzer are typically in the range of 50–100 nt. The increased read length opens up the possibility to directly map the exon-exon junction without any reference to putative or annotated exons. Here we report a novel algorithm, based on the idea of using the mapping of half-reads as a way to identify the approximate location of a junction. Moreover, this method can be adapted to incorporate the extra information contained in paired-end sequencing data, to achieve a much higher level of specificity than attainable by single end sequencing. The method is implemented in a freely available Python program named SpliceMap (<ext-link ext-link-type="uri" xlink:href="http://biogibbs.stanford.edu/~kinfai/SpliceMap/">http://biogibbs.stanford.edu/∼kinfai/SpliceMap/</ext-link>).</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <p>SpliceMap utilizes merely the reference genomic sequence to find the junction independently of existing exon annotation. It is possible to explore all exon splicing events, including known and novel ones, if the sequencing is of sufficient depth. The core notion is to pin down first the junction boundary on one of the two exons that are involved in the splicing event, before the mapping of the full junction. A read that spans a junction must have a match in the reference genome that is not shorter than its half length. Such a match then provides a seeding that can be used to identify a small genomic region for the search of the corresponding junction. There are four main steps in SpliceMap: half-read mapping, seeding selection, junction search and paired-end filtering (<xref ref-type="fig" rid="F1">Figure 1</xref>). The last step is not applied when the data is not paired-end. For reads longer than 50 nt, we extract from them several overlapped 50-nt reads and then apply the standard method. For example, we split a 100-nt read to three segments (1–50, 26–75 and 51–100). An extra filter is added in the post-processing step for the long-read data to check the results with the full length information. In this way, we can find multiply junctions from a single long read.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Workflow of standard SpliceMap and outline of junction search based on half-read mapping: (<bold>a</bold>) SpliceMap consists of four steps: half-read mapping, seeding selection, junction search and paired-end filtering. SpliceMap outputs coverage plot and junctions detected. (<bold>b</bold>) Each half-read is aligned to the genome and extended to obtain the partial alignment. The remaining part of the read, if at least 10 nt, will be used to search for its matches within a neighborhood (400000 nt). The GT–AG splicing signal is also used to filter the matches.</p></caption><graphic xlink:href="gkq211f1"/></fig></p>
    <sec>
      <title>Half-read mapping</title>
      <p>Taking advantage of the reasonably long reads (50 nt) offered by the newest models of second-generation sequencers, the half length (25 nt) can be reliably aligned to the reference genomic sequence with high probability. In this step, SpliceMap maps both halves of the read to the reference genome by any currently available short read mapping tools, such as SeqMap (<xref ref-type="bibr" rid="B9">9</xref>) and ELAND. The maximum mismatch allowed for the half read mapping can be chosen accordingly, based on the quality of data and read length. After mapping, the following steps are carried out chromosome by chromosome.</p>
    </sec>
    <sec>
      <title>Seeding selection</title>
      <p>We use the mapped hits of a half-read to narrow the search regions of the junction. These hits are extended base by base in the following step. Thus, we call the half-read mapped hit ‘seeding’. The mapped hits from the above steps are examined for seeding selection. Although the uniquely mapped hits are more reliable as seeding for junction search, one should not simply exclude all multiply mapped reads (i.e. reads mapped to more than one location) because doing so will greatly diminish the chance of detecting junctions with homologous sequences elsewhere, such as those in paralogous genes or pseudogenes. Instead of rejecting all multiply mapped hits, SpliceMap excludes only those hits that are within 400 000 nt of another hit from the same half-read. Because if two regions are identical within a distance of 400 000 nt, false splice predictions tend to form between these two regions which match the reads perfectly.</p>
    </sec>
    <sec>
      <title>Junction search</title>
      <p>For each seeding identified, the alignment on the reference genome is then extended base by base to find the splicing point (<xref ref-type="fig" rid="F1">Figure 1</xref>). SpliceMap subsequently tries to find the partner splicing point that provides perfect match of the corresponding residual sequence of the original read, within a user-specified distance (set to be 400 000 nt in our examples). When the full reads are 50 nt in size, candidates of splicing point must meet two criteria: first, the alignment extension cannot be longer than 40 nt and the residual length has to be at least 10 nt; and second, the splicing point must be next to the canonical dinucleotides splicing signal GT and AG for donor and acceptor sites, because they appears in 98% known splice sites (<xref ref-type="bibr" rid="B18">18</xref>). The mapping of the residual sequence is achieved by searching 10-nt seeding in a pre-computed chromosome-wide hash table and then extending to complete the full alignment. In order to reduce false positive junctions, the results are discarded if the search yields multiple matches of the residual sequence satisfying the above criteria.</p>
    </sec>
    <sec>
      <title>Paired-end filtering</title>
      <p>When paired-end reads are available, the pairing information is used in this step to improve the specificity of junction detection. First, in the previous steps, three types of hits are identified as ‘good hits’, namely exonic hits, extension hits and junction hits. An exonic hit occurs if the two halves of a full read are mapped to locations that differ by exactly half of the read length. On the other hand, if a half-read hit can be extended maximally to an alignment length that is suitably long but yet shorter than the full read length, then it is regarded as an extension hit. Finally, junction hits are identified as above. To qualify as reliable hits, the hits generated from the two reads from a paired-end reads must satisfy the following conditions (i) both hits are ‘good hits’; (ii) their distance is not longer than 400 000 nt; (iii) the mapping direction and the positional order on the reference genomic sequence of two hits are in the consistent order with the experimental design (<xref ref-type="fig" rid="F2">Figure 2</xref>).
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>The direction and positional order of the paired-end reads (R1–R2). If the sequencing sample is the same as the original copy, the read R1 should be mappable in forward direction in 5′-end and R2 in reverse direction in 3′-end. If the sequencing sample is the complementary copy, the read R1 should be mappable in reverse direction in 3′-end and R1 in forward direction in 5′-end.</p></caption><graphic xlink:href="gkq211f2"/></fig></p>
    </sec>
    <sec>
      <title>Parameters for assessment of reliability and optional filtering</title>
      <p>SpliceMap provided several parameters to facilitate the assessment of the reliability and the abundance of the detected junctions. For each junction, SpliceMap computes its nR (number of reads supporting this junction), nNR (number of non-redundant supporting reads), nUM (number of uniquely mapped supporting reads), nUP and nDOWN (number of mapped reads in upstream or downstream adjacent regions respectively) (<xref ref-type="fig" rid="F3">Figure 3</xref>). We examined these parameters on a RNA-seq data set of 23 412 226 paired 50-nt reads provided to us by Illumina. The various requirements of these parameters lead to different optional parametric filterings.
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>Schematic of the parameters to assess junctions in SpliceMap. The deep green reads are uniquely mapped supporting reads (nUM = 4) and the wheat reads are multiply mapped supporting reads. Thus, nR of this junction is 6. But some supporting reads are redundant, so nNR = 4. There are four and three uniquely mapped reads (grey green) in upstream and downstream adjacent regions of 40 nt respectively, so nUP = 4 and nDOWN = 3.</p></caption><graphic xlink:href="gkq211f3"/></fig></p>
      <p>We found that for splice junctions near the 3′-end on a gene annotated by RefSeq as having only a single isoform, the number of supporting reads (nR) is significantly correlated with the overall expression (<italic>R</italic><sup>2</sup> = 0.7173) of the gene as measured by RPKM (number of reads per kb of transcript per million mappable reads) (<xref ref-type="bibr" rid="B10">10</xref>). This suggests that when alternative splicing may occur at a junction, we can use nR as an index for its usage. <xref ref-type="table" rid="T1">Table 1</xref> shows the distribution of nR among predicted junctions before any optional parametric filtering. While overall only 29% of predicted junctions has nR = 1, this percentage increases to 74% among novel junctions. This is consistent with the notion that junctions not included in current annotations are likely to be relatively rare.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Distributions of nR among all junctions and among novel junctions predicted by SpliceMap from paired-end data (without any optional parametric filtering)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">nR</th><th rowspan="1" colspan="1">All junctions</th><th rowspan="1" colspan="1">Novel junctions<xref ref-type="table-fn" rid="TF1"><sup>a</sup></xref></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">49 888 (28.75%)</td><td rowspan="1" colspan="1">26 744 (74.10%)</td></tr><tr><td rowspan="1" colspan="1">2–5</td><td rowspan="1" colspan="1">49 462 (28.51%)</td><td rowspan="1" colspan="1">7942 (22.00%)</td></tr><tr><td rowspan="1" colspan="1">6–20</td><td rowspan="1" colspan="1">44 577 (25.69%)</td><td rowspan="1" colspan="1">1222 (3.39%)</td></tr><tr><td rowspan="1" colspan="1">21 ∼ 50</td><td rowspan="1" colspan="1">19 074 (10.99%)</td><td rowspan="1" colspan="1">147 (0.41%)</td></tr><tr><td rowspan="1" colspan="1">51 ∼ 200</td><td rowspan="1" colspan="1">10 478 (6.04%)</td><td rowspan="1" colspan="1">34 (0.09%)</td></tr><tr><td rowspan="1" colspan="1">201 ∼ 1000</td><td rowspan="1" colspan="1">1787 (1.03%)</td><td rowspan="1" colspan="1">2 (0.01%)</td></tr><tr><td rowspan="1" colspan="1">1000+</td><td rowspan="1" colspan="1">135 (0.08%)</td><td rowspan="1" colspan="1">0 (0%)</td></tr></tbody></table><table-wrap-foot><fn id="TF1"><p><sup>a</sup>Novel junctions are the ones that are not in RefSeq, Ensembl and KnownGene.</p></fn></table-wrap-foot></table-wrap></p>
      <p>The nR of a junction is affected by the randomness in the representation or amplification of the RNA fragments in the library to be sequenced. If an RNA fragment is readily captured by the library preparation protocol (random hexamer priming in this case) and then highly amplified then it is likely to generate multiple reads of identical sequence. We call these ‘redundant’ reads. For junctions in low abundance isoforms, if two or more supporting reads are identical in sequence then they are likely to be redundant. In such cases, even if nR &gt; 1 we still may not have a reliable prediction. We can greatly increase the specificity of our prediction by requiring that the junction be supported by more than one ‘non-redundant’ reads (nNR &gt; 1). We can see that the EST validation rate is remarkably high once we require nNR &gt; 1 (114 990/121 718 = 94%). When we restrict to novel junctions, the EST validation of predictions with nNR &gt; 1 is still high (4494/7757 = 58%) (<xref ref-type="table" rid="T2">Table 2</xref>). Since the EST data is likely to be incomplete in its coverage of novel junctions in rare isoforms, the specificity of predictions with nNR &gt; 1 should be considerably higher than 58%. We will examine this issue further in our discussion of our experimental validation results.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>The numbers of detected junctions and the EST validation rates for various optional parametric filters</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th colspan="5" align="center" rowspan="1">SpliceMap<hr/></th></tr><tr><th rowspan="1" colspan="1">Optional filters<sup>#</sup></th><th rowspan="1" colspan="1">–</th><th rowspan="1" colspan="1">nUM</th><th rowspan="1" colspan="1">nUP/nDOWN</th><th rowspan="1" colspan="1">nNR</th><th rowspan="1" colspan="1">nUM + nUP/nDOWN</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Total junctions</td><td align="center" rowspan="1" colspan="1">175 401</td><td align="center" rowspan="1" colspan="1">168 807</td><td align="center" rowspan="1" colspan="1">162 060</td><td align="center" rowspan="1" colspan="1">121 718</td><td align="center" rowspan="1" colspan="1">151 317</td></tr><tr><td rowspan="1" colspan="1">Novel junctions</td><td align="center" rowspan="1" colspan="1">36 091</td><td align="center" rowspan="1" colspan="1">32 060</td><td align="center" rowspan="1" colspan="1">27 497</td><td align="center" rowspan="1" colspan="1">7757</td><td align="center" rowspan="1" colspan="1">23 020</td></tr><tr><td rowspan="1" colspan="1">Junctions with EST validation</td><td align="center" rowspan="1" colspan="1">145 517</td><td align="center" rowspan="1" colspan="1">142 610</td><td align="center" rowspan="1" colspan="1">139 880</td><td align="center" rowspan="1" colspan="1">114 990</td><td align="center" rowspan="1" colspan="1">133 010</td></tr><tr><td rowspan="1" colspan="1">Novel junctions with EST</td><td align="center" rowspan="1" colspan="1">12 053</td><td align="center" rowspan="1" colspan="1">11 549</td><td align="center" rowspan="1" colspan="1">10 562</td><td align="center" rowspan="1" colspan="1">4494</td><td align="center" rowspan="1" colspan="1">9493</td></tr><tr><td rowspan="1" colspan="1">EST validation rate</td><td align="center" rowspan="1" colspan="1">82.96%</td><td align="center" rowspan="1" colspan="1">84.48%</td><td align="center" rowspan="1" colspan="1">86.31%</td><td align="center" rowspan="1" colspan="1">94.47%</td><td align="center" rowspan="1" colspan="1">87.90%</td></tr><tr><td rowspan="1" colspan="1">EST validation rate (novel)</td><td align="center" rowspan="1" colspan="1">33.40%</td><td align="center" rowspan="1" colspan="1">36.02%</td><td align="center" rowspan="1" colspan="1">38.41%</td><td align="center" rowspan="1" colspan="1">57.93%</td><td align="center" rowspan="1" colspan="1">41.24%</td></tr></tbody></table><table-wrap-foot><fn id="TF2"><p># ‘–’ represents no application of any parametric filters; ‘nUM’ filter requires nUM&gt;0; ‘nUP/nDOWN’ filter requires nUP + nDOWN &gt; 0; and ‘nNR’ filter requires nNR&gt;1. For all ‘nUP/nDOWN’ filters, we set <italic>K</italic> = 40.</p></fn></table-wrap-foot></table-wrap></p>
      <p>Although requiring nNR &gt; 1 was effective in ensuring very high specificity of junction prediction, it reduced the number of predicted junctions by about 31%. Among novel predictions, the potential loss of sensitivity was even greater, i.e. from 36 091 to 7757. This motivated us to design optional filters to discriminate reliable versus unreliable predictions among junctions with nNR = 1. Instead of filtering junction prediction by nR or nNR, we require that the junction must be supported by at least one uniquely mapped reads (nUM &gt; 0). This requirement excludes 3.8% junctions but increases the total specificity from 82.96 to 84.48% (<xref ref-type="table" rid="T2">Table 2</xref>).</p>
      <p>The other optional filter is the requirements of a sufficient number of reads mapped adjacent to the splice site, on each side of the putative junction. To do this, recall that nUP is the numbers of reads (exon or junction reads) falling within a small region (say with a neighborhood size of <italic>K</italic> nt) upstream of the splice site of interest in the transcript, and nDOWN is the corresponding downstream adjacent reads. Thus our filter is to require each of nUP or nDOWN to be at least 1. <xref ref-type="table" rid="T3">Table 3</xref> shows the number of detected junctions and the EST validation rates for neighborhood size <italic>K</italic> = 40, 80 and 160. We can see that this filtering excludes some junctions but improves the specificity as <italic>K</italic> decreases. By adjusting <italic>K</italic>, we can achieve a suitable balance of sensitivity and specificity in our junction predictions. When <italic>K</italic> = 40, it excludes 7.6% junctions but increases the total specificity from 82.96 to 86.91% (<xref ref-type="table" rid="T3">Table 3</xref>). The gains and losses of various optional parametric filterings are compared in <xref ref-type="table" rid="T2">Table 2</xref>.
<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>The numbers of detected junctions and the EST validation rates for various neighborhood sizes used for nUP/nDOWN filtering right after the standard paired-end SpliceMap</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"><italic>K</italic> = 40</th><th rowspan="1" colspan="1"><italic>K</italic> = 80</th><th rowspan="1" colspan="1"><italic>K</italic> = 160</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Total junctions</td><td align="center" rowspan="1" colspan="1">156 015</td><td align="center" rowspan="1" colspan="1">162 060</td><td align="center" rowspan="1" colspan="1">165 452</td></tr><tr><td rowspan="1" colspan="1">Novel junctions</td><td align="center" rowspan="1" colspan="1">25 441</td><td align="center" rowspan="1" colspan="1">27 497</td><td align="center" rowspan="1" colspan="1">29 342</td></tr><tr><td rowspan="1" colspan="1">Junctions with EST validation</td><td align="center" rowspan="1" colspan="1">135 586</td><td align="center" rowspan="1" colspan="1">139 880</td><td align="center" rowspan="1" colspan="1">141 758</td></tr><tr><td rowspan="1" colspan="1">Novel junctions with EST</td><td align="center" rowspan="1" colspan="1">9901</td><td align="center" rowspan="1" colspan="1">10 562</td><td align="center" rowspan="1" colspan="1">11 062</td></tr><tr><td rowspan="1" colspan="1">EST validation rate</td><td align="center" rowspan="1" colspan="1">86.91%</td><td align="center" rowspan="1" colspan="1">86.31%</td><td align="center" rowspan="1" colspan="1">85.68%</td></tr><tr><td rowspan="1" colspan="1">EST validation rate (novel)</td><td align="center" rowspan="1" colspan="1">38.92%</td><td align="center" rowspan="1" colspan="1">38.41%</td><td align="center" rowspan="1" colspan="1">37.70%</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <sec>
      <title>Specificity</title>
      <p>We tested SpliceMap and TopHat on a RNA-seq data set of 23 412 226 paired 50-nt reads provided to us by Illumina. mRNA was purified from total RNA from human brain tissue with oligo-dT magnetic beads. cDNA was synthesized with random primer priming. ds–cDNA was sequenced using Illumina Genome Analyzers as recommended by the manufacturer. The data is publicly available in database GEO with accession number GSE19166. In this test, SpliceMap requires the reads to cover at least 10 nt on each side of the junction. One mismatch was allowed in seeding mapping based on 25-nt half-reads, but the mapping of the residual sequence is required to be perfect match. The allowance for mismatch on the seeding mapping allows detection of junctions with SNPs in the flanking exon sequences and also accommodates sequencing errors.</p>
      <p>Here we report the results found by paired-end SpliceMap followed by the nUP/nDOWN filtering (<italic>K</italic> = 40) and the nUM filtering. In total, SpliceMap found 151 317 exon junctions, including 23 020 novel junctions, which were not reported in RefSeq (<xref ref-type="bibr" rid="B19">19</xref>), Ensembl (<xref ref-type="bibr" rid="B20">20</xref>) and KnownGene (<xref ref-type="bibr" rid="B21">21</xref>). In order to assess SpliceMap’s specificity, the detected junctions are aligned to human ESTs in GenBank (<xref ref-type="bibr" rid="B22">22</xref>). Because ESTs are 200–600 nt single reads, they are typically long enough to identify unique transcript fragments with high reliability. Thus if a match can be found in an EST sequence for a junction that was detected by our <italic>de novo</italic> splice discovery algorithm, then this can be regarded as independent experimental validation of the existence of the junction. As a comparison we also present the corresponding results by TopHat 1.0.12 (<xref ref-type="bibr" rid="B11">11</xref>) (the latest version as of 28 October 2009) (<xref ref-type="table" rid="T4">Table 4</xref> and <xref ref-type="fig" rid="F4">Figure 4</xref>).
<table-wrap id="T4" position="float"><label>Table 4.</label><caption><p>The statistics of the results by TopHat and SpliceMap after nUM and nUP/nDOWN (<italic>K</italic> = 40) filterings</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">SpliceMap</th><th rowspan="1" colspan="1">TopHat</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Total junctions</td><td align="center" rowspan="1" colspan="1">151 317</td><td align="center" rowspan="1" colspan="1">133 722</td></tr><tr><td rowspan="1" colspan="1">Novel junctions<xref ref-type="table-fn" rid="TF3"><sup>a</sup></xref></td><td align="center" rowspan="1" colspan="1">23 020</td><td align="center" rowspan="1" colspan="1">19 777</td></tr><tr><td rowspan="1" colspan="1">Junctions with EST validation<xref ref-type="table-fn" rid="TF4"><sup>b</sup></xref></td><td align="center" rowspan="1" colspan="1">133 010 (87.90%)</td><td align="center" rowspan="1" colspan="1">117 113 (87.58%)</td></tr><tr><td rowspan="1" colspan="1">Junctions with nNR &gt; 1 (multiple non-redundant reads)</td><td align="center" rowspan="1" colspan="1">119 298</td><td align="center" rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Novel junctions with EST</td><td align="center" rowspan="1" colspan="1">9493 (41.24%)</td><td align="center" rowspan="1" colspan="1">7273 (36.78%)</td></tr><tr><td rowspan="1" colspan="1">Novel junctions with nNR &gt; 1</td><td align="center" rowspan="1" colspan="1">7187</td><td align="center" rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Junctions with EST and with nNR &gt; 1</td><td align="center" rowspan="1" colspan="1">112 962</td><td align="center" rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Novel junctions with EST and with nNR &gt; 1</td><td align="center" rowspan="1" colspan="1">4242</td><td align="center" rowspan="1" colspan="1">–</td></tr></tbody></table><table-wrap-foot><fn id="TF6"><p><sup>a</sup>Novel junctions are the ones that are not in RefSeq, Ensembl and KnownGene.</p></fn><fn id="TF7"><p><sup>b</sup>The percentage in the parentheses is the EST validation rate.</p></fn></table-wrap-foot></table-wrap>
<fig id="F4" position="float"><label>Figure 4.</label><caption><p>The Venn diagram of the distribution of redundancy, novelty and EST evidence of the junctions predicted by SpliceMap. Only 1389 known junctions are with single non-redundant read and not supported by EST evidence.</p></caption><graphic xlink:href="gkq211f4"/></fig></p>
      <p>We found that 87.9% (133 010) of the junctions detected by SpliceMap are supported by EST evidence. If we restrict to the 23 020 novel junctions predicted by SpliceMap, the percentage becomes lower (41.2%) (9493 junctions) but still represents a reasonable degree of EST support. We note that EST sequences are not comprehensive representation of the transcriptome and the percentage of junctions supported by EST is only a conservative estimate of specificity. We can see that SpliceMap has the similar EST validation rate but detected more junctions (151 317 versus 133 722) compared with TopHat.</p>
    </sec>
    <sec>
      <title>Sensitivity</title>
      <p><xref ref-type="table" rid="T5">Table 5</xref> gives the sensitivity of SpliceMap for detecting junctions in the 12 755 genes with a single isoform in RefSeq. The junctions are binned according to the expression level (in RKPM) of the corresponding gene, and the rate of detection is computed for each bin. It is seen that SpliceMap achieves very high sensitivity (&gt;95%) for genes with high expression (RKPM &gt; 20). The sensitivity is still high (90%) for genes with medium expression (5 &lt; RKPM &lt; 20) and remains substantial (40–67%) for genes with relatively low expression (1 &lt; RKPM &lt; 5). However, for genes with very low expression (RKPM &lt; 1) the sensitivity drops to below 7%. Our result suggests that much deeper sequencing than 23 million paired-reads will be necessary for the analysis of such rare transcripts. Finally, <xref ref-type="table" rid="T5">Table 5</xref> also shows that at all levels of gene expression, SpliceMap can detect more RefSeq annotated junctions than a representative of current method (TopHat).
<table-wrap id="T5" position="float"><label>Table 5.</label><caption><p>The junction detection sensitivity for genes with different RPKM</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">SpliceMap (%)</th><th rowspan="1" colspan="1">TopHat (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">0 &lt; RPKM ≤ 1 (2993)</td><td rowspan="1" colspan="1">6.76</td><td rowspan="1" colspan="1">5.54</td></tr><tr><td rowspan="1" colspan="1">1 &lt; RPKM ≤ 2 (1199)</td><td rowspan="1" colspan="1">40.86</td><td rowspan="1" colspan="1">27.74</td></tr><tr><td rowspan="1" colspan="1">2 &lt; RPKM ≤ 5 (2049)</td><td rowspan="1" colspan="1">67.23</td><td rowspan="1" colspan="1">52.24</td></tr><tr><td rowspan="1" colspan="1">5 &lt; RPKM ≤ 20 (3245)</td><td rowspan="1" colspan="1">89.55</td><td rowspan="1" colspan="1">80.95</td></tr><tr><td rowspan="1" colspan="1">20 &lt; RPKM ≤ 50 (1340)</td><td rowspan="1" colspan="1">95.55</td><td rowspan="1" colspan="1">91.10</td></tr><tr><td rowspan="1" colspan="1">50 &lt; RPKM ≤ 100 (522)</td><td rowspan="1" colspan="1">97.18</td><td rowspan="1" colspan="1">93.87</td></tr><tr><td rowspan="1" colspan="1">RPKM &gt; 100 (408)</td><td rowspan="1" colspan="1">95.66</td><td rowspan="1" colspan="1">88.58</td></tr></tbody></table></table-wrap></p>
      <p>We also examine the degree of junction recovery for the genes with single RefSeq isoform. For each gene, we measure its degree of junction discovery by computing the percentage of junctions that have been detected. The results are presented in <xref ref-type="table" rid="T6">Table 6</xref>. We can see that more genes detected by SpliceMap are of higher degree (80–100%) of completeness in junction discovery. In particular, this completeness may be important in downstream analyses such as isoform reconstruction and abundance estimation.
<table-wrap id="T6" position="float"><label>Table 6.</label><caption><p>The distribution of genes with junction recovery</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">SpliceMap</th><th rowspan="1" colspan="1">TopHat</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Number of genes detected<xref ref-type="table-fn" rid="TF5"><sup>a</sup></xref></td><td rowspan="1" colspan="1">8939</td><td rowspan="1" colspan="1">8777</td></tr><tr><td rowspan="1" colspan="1">1 ≤ <italic>P</italic><xref ref-type="table-fn" rid="TF6"><sup>b</sup></xref> &lt; 50</td><td rowspan="1" colspan="1">1076</td><td rowspan="1" colspan="1">1729</td></tr><tr><td rowspan="1" colspan="1">51 ≤ <italic>P</italic> &lt; 80</td><td rowspan="1" colspan="1">1812</td><td rowspan="1" colspan="1">2319</td></tr><tr><td rowspan="1" colspan="1">81 ≤ <italic>P</italic>&lt;100</td><td rowspan="1" colspan="1">1600</td><td rowspan="1" colspan="1">1347</td></tr><tr><td rowspan="1" colspan="1"><italic>P</italic> = 100</td><td rowspan="1" colspan="1">4451</td><td rowspan="1" colspan="1">3382</td></tr></tbody></table><table-wrap-foot><fn id="TF3"><p><sup>a</sup>A gene is detected if at least one junction of the gene is detected.</p></fn><fn id="TF4"><p><sup>b</sup><italic>P</italic> is the rate (in %) of detection for junctions on the genes within the bin.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>PCR validation</title>
      <p>In addition to the evidence from EST, our novel junctions are validated experimentally by PCR experiments. Twenty predictions were randomly selected, including 18 novel exon skipping events and two novel exons detections, all without any currently known EST or human mRNA evidence. Eighteen novel skipping events come from five bins with different numbers of non-redundant reads: 1, 2, 3–5, 6–10 and &gt;10. Three to four predictions were randomly selected from each bins. PCR validation showed that 17 (85%) were validated. Of the three false predictions, two occur in the bin of single non-redundant read. Thus, among novel predictions with nNR &gt; 1, the PCR validation rate is 13/14 = 92.86%. This is significantly higher (using <italic>Z</italic> test, the <italic>P</italic>-value is 0.004) than the EST validation rate of 58% which we believe is an underestimate of specificity because of incomplete EST coverage for rare isoforms.</p>
    </sec>
    <sec>
      <title>Comparison with ERANGE</title>
      <p>To see how SpliceMap compares with a simple approach that does use the reference annotation; we also ran an annotation-dependent tool ERANGE (<xref ref-type="bibr" rid="B10">10</xref>) on the same data set. ERANGE identified 160 899 junctions, among which 127 043 junctions were also detected by SpliceMap. All results found by ERANGE are not novel but include some junctions that are not detected by SpliceMap, because ERANGE has relaxed requirements of the length of the minor flanking sequence. ERANGE requires at least 4 nt on each flanking sequence, while at least 10 nt is required by SpliceMap. The stricter requirement guarantees the reasonable reliability of the predictions of novel junction by SpliceMap. Novel junction discovery is the major function of SpliceMap, which therefore cannot be replaceable by annotation-independent ERANGE. Among 151 317 junctions found by SpliceMap, 24 274 are not reported by ERANGE, 23 020 of which are novel.</p>
    </sec>
    <sec>
      <title>Comparison with BLAT</title>
      <p>We also compared SpliceMap with BLAT, a tool commonly used for aligning EST sequences. In order to make a fair comparison, we optimized the parametric setting in BLAT and also filter the results by requiring the presence of canonical splicing signal. We found that when BLAT was run with the most non-stringent parameters and with no filtering, its sensitivity is ∼55% that of SpliceMap. However, in this non-stringent setting the junctions detected by BLAT are mostly false-positives (specificity is only 3%). With more stringent parameters and with the addition of post-alignment filtering steps, we can improve the specificity very substantially but at the expense of further loss of sensitivity. At its best setting, BLAT achieved a similar but still slightly lower level of specificity with a much lower sensitivity (70% lower) as compared to SpliceMap. The details of the comparison between the two methods on the Illumina Brain data set are presented in <xref ref-type="table" rid="T7">Table 7</xref>.
<table-wrap id="T7" position="float"><label>Table 7.</label><caption><p>The comparison of various BLAT setting with SpliceMap</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th colspan="4" align="center" rowspan="1">BLAT</th><th rowspan="1" colspan="1">SpliceMap</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Max intron size (nt)</td><td align="center" rowspan="1" colspan="1">750 000</td><td align="center" rowspan="1" colspan="1">750 000</td><td align="center" rowspan="1" colspan="1">400 000</td><td align="center" rowspan="1" colspan="1">400 000</td><td align="center" rowspan="1" colspan="1">400 000</td></tr><tr><td rowspan="1" colspan="1">Tile size (nt)</td><td align="center" rowspan="1" colspan="1">8–12</td><td align="center" rowspan="1" colspan="1">8–12</td><td align="center" rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">Minscore</td><td align="center" rowspan="1" colspan="1">30</td><td align="center" rowspan="1" colspan="1">30</td><td align="center" rowspan="1" colspan="1">50</td><td align="center" rowspan="1" colspan="1">50</td><td align="center" rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">Mismatch</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1">No. of splices</td><td align="center" rowspan="1" colspan="1">–</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1">Min length of flanking seq.</td><td align="center" rowspan="1" colspan="1">–</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">10</td></tr><tr><td rowspan="1" colspan="1">Canonical splicing signal</td><td align="center" rowspan="1" colspan="1">–</td><td align="center" rowspan="1" colspan="1">–</td><td align="center" rowspan="1" colspan="1">–</td><td align="center" rowspan="1" colspan="1">required</td><td align="center" rowspan="1" colspan="1">required</td></tr><tr><td rowspan="1" colspan="1">Total junctions</td><td align="center" rowspan="1" colspan="1">2 404 632</td><td align="center" rowspan="1" colspan="1">345 195</td><td align="center" rowspan="1" colspan="1">209 673</td><td align="center" rowspan="1" colspan="1">51 325</td><td align="center" rowspan="1" colspan="1">160 076</td></tr><tr><td rowspan="1" colspan="1">Valid junctions</td><td align="center" rowspan="1" colspan="1">75 147</td><td align="center" rowspan="1" colspan="1">61 671</td><td align="center" rowspan="1" colspan="1">45 714</td><td align="center" rowspan="1" colspan="1">41 173</td><td align="center" rowspan="1" colspan="1">137 965</td></tr><tr><td rowspan="1" colspan="1">Specificity</td><td align="center" rowspan="1" colspan="1">3.12%</td><td align="center" rowspan="1" colspan="1">17.87%</td><td align="center" rowspan="1" colspan="1">21.80%</td><td align="center" rowspan="1" colspan="1">80.22%</td><td align="center" rowspan="1" colspan="1">86.19%</td></tr></tbody></table><table-wrap-foot><fn id="TF5"><p>The first column corresponds to the default setting in BLAT. SpliceMap was run without paired-end information.</p></fn></table-wrap-foot></table-wrap></p>
      <p>BLAT is a well-optimized alignment tool but it was not designed specifically for exon junction detection from short reads. Both SpliceMap and BLAT are based on using fast mapping of segments (seedings) of the reads to narrow the search regions for more detail alignment of the reads. As a splice detection tool specific for short RNA-seq data, SpliceMap uses 25-nt seeding while BLAT usually uses about 8- to 12-nt seeding. SpliceMap generates the seeding by using short-read alignment tools such as ELAND and SeqMap, while BLAT makes use of a hash table. The short seeding allows BLAT to find the splices that span small exons, but leads to many false mappings. As discussed in the above, these false predictions can be detected and removed in post-processing steps based on canonical splicing signal and paired-end information. However the post-processing filters cannot rescue the loss of sensitivity in the BLAT that is evident even when BLAT is run with the most tolerant parameter setting. BLAT has its own ad hoc post-processing steps that are not specially designed for exon junction detection. When the reads are short, these steps may remove many correct splices. Although we expect that BLAT’s performance may improve as the read length increases, for current RNA-seq data, it cannot replace a custom-designed tool for junction detection such as SpliceMap.</p>
    </sec>
    <sec>
      <title>Running time</title>
      <p>The better performance of SpliceMap is achieved at the cost of longer running time—it took SpliceMap 66 CPU hours to process all the 23 million reads. As a comparison, it took TopHat 12 CPU hours to process the same data set. However, it is worth pointing out that this may be due to the fact that SpliceMap was written in Python, while TopHat was written in C++. Moreover, in our experiments we used a 16-core server so that the overall running time was greatly reduced. The Python part of SpiceMap has been rewritten in C++ and speeds up about 4 times.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>DISCUSSION</title>
    <p>The use of paired-end sequencing with long reads (50-nt or longer) promises to greatly enhance our ability to characterize transcript isoforms, but this promise can be fulfilled only if suitable computational methods are available to analyze the data. In this paper we reported that 50-nt reads can support an approach of direct <italic>de novo</italic> detection of splice junctions without the need to first cluster reads to identify putative exons, and that this approach can achieve significantly higher sensitivity in junction detection than current leading methods of RNA-seq analysis. Our results were demonstrated by a systematic analysis of a new data set consisting of 23 million paired 50-nt reads from human brain tissue. Using EST sequences as validation, we found that our method SpliceMap can predict a junction with very high validation rate (95%) if the prediction is supported by at least two non-redundant reads (nNR &gt; 1). However, even predictions supported by only single non-redundant read (nNR = 1) can have high specificity if we implement suitable additional filters to remove unreliable predictions. Including predictions with nNR = 1 that passed these filters greatly increased the sensitivity of detection and still maintained good validation rate (87.9%). Furthermore, EST validation rate is likely to underestimate the specificity of novel predictions, and this was confirmed by our experimental tests of a subset of novel predictions by PCR-based method.</p>
    <p>The question of the sensitivity of junction detection from RNA-seq is an important issue that has not be thoroughly examined in the current literature. One way to frame this question is to ask, for a given sequencing depth, what is the C<sub>50</sub> which is defined as the lower limit of copy number per cell in order for a given junction to have a 50% chance of being detected. Based on the assumption that one RKPM corresponds to about 0.3 copies per cell for the protocol used in this study (<xref ref-type="bibr" rid="B10">10</xref>), we can estimate from <xref ref-type="table" rid="T5">Table 5</xref> that for a RNA-seq with a depth of 23 million paired 50-nt reads, the C<sub>50</sub> is about one copy per cell.</p>
    <p>We found that paired-read information can help to reduce false discoveries. For the Illumina protocol used in to produce our data, the distance between two paired-end reads is about 200 nt in the mRNA and there may sometimes exist an intron between the two reads. Since the overwhelming majority of introns are smaller than 400 000 nt in size, SpliceMap will filter out any paired hits that are separated by more than 400 000 nt from all subsequent computations. <xref ref-type="fig" rid="F5">Figure 5</xref> shows an example of false predictions eliminated by the use of paired-end filtering. Compared to using only single reads (i.e. treating the same data set as 46 million unpaired 50-nt reads), the use of paired-end filtering increases the EST validation rate from 86.19 to 87.9% for all predictions and from 38.53 to 41.24% for novel predictions, without compromising the sensitivity of detection of annotated junctions. Although, single-end SpliceMap still makes better performance than TopHat, we recommend researchers using paired-end sequencing if possible. Since the EST validation rate underestimates the true specificity of novel predictions, the reduction of false predictions should be more substantial than indicated by the above numbers.
<fig id="F5" position="float"><label>Figure 5.</label><caption><p>Filtering by paired-end information. The top two tracks are the results from single-end SpliceMap and paired-end SpliceMap before nUP, nDOWN and nUM filtering, respectively. The known junctions detected are in black and the novel ones in red. Single read analysis predicts several junctions that are very long and jump across genes. These are false positive results and the paired-end information helps to remove them.</p></caption><graphic xlink:href="gkq211f5"/></fig></p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p><funding-source>National Institutes of Health</funding-source> (<award-id>1R01HG004634</award-id> to W.H.W.); Junior faculty grant from the Edward Mallinckrodt Jr. Foundation (to Y.X.) Funding for open access charge: 1R01HG004634.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec>
    <title>AUTHOR CONTRIBUTIONS</title>
    <p>KFA, HJ and WHW conceived the study, designed the algorithm and carried out data analyses. KFA implemented the algorithm and drafted the manuscript. HJ and WHW revised the manuscript. L.L and XY. performed the experimental validation.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>Shujun Luo and Gary Schroth of Illumina Inc. provided the RNA sequencing data. Gary Schroth also provided helpful comments on the manuscript.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kingsmore</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>462</volume>
        <fpage>470</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matlin</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <article-title>Understanding alternative splicing: towards a cellular code</article-title>
        <source>Nat. Rev. Mol. Cell. Biol.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>386</fpage>
        <lpage>398</lpage>
        <pub-id pub-id-type="pmid">15956978</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Togawa</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fujii</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Uchikawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kohno</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miyashita</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Detecting tissue-specific alternative splicing and disease-associated aberrant splicing of the PTCH gene with exon junction microarrays</article-title>
        <source>Hum. Mol. Genet.</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>3379</fpage>
        <lpage>3388</lpage>
        <pub-id pub-id-type="pmid">16203740</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hubbell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cline</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Siani-Rose</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ares</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kulp</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene structure-based splice variant deconvolution using a microarray platform</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>315</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="pmid">12538267</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Kerlavage</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Rapid cDNA sequencing (expressed sequence tags) from a directionally cloned human infant brain cDNA library</article-title>
        <source>Nat. Genet.</source>
        <year>1993</year>
        <volume>4</volume>
        <fpage>373</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">8401585</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The beginning of the end for microarrays? <italic>Nat</italic></article-title>
        <source>Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>585</fpage>
        <lpage>587</lpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>SeqMap: mapping massive amount of oligonucleotides to the genome</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2395</fpage>
        <lpage>2396</lpage>
        <pub-id pub-id-type="pmid">18697769</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>TopHat: discovering splice junctions with RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagalakshmi</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Waern</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1344</fpage>
        <lpage>1349</lpage>
        <pub-id pub-id-type="pmid">18451266</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilhelm</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Marguerat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Watt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Goodhead</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Penkett</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bähler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Dynamic repertoire of a eukaryotic transcriptome surveyed at single-nucleotide resolution</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>453</volume>
        <fpage>1239</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="pmid">18488015</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lister</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>O'Malley</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Tonti-Filippini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gregory</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Millar</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Highly integrated single-base resolution maps of the epigenome in Arabidopsis</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>133</volume>
        <fpage>523</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="pmid">18423832</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cloonan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kolle</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gardiner</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Faulkner</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Steptoe</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Wani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bethel</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stem cell transcriptome profiling via massive-scale mRNA sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>613</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="pmid">18516046</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Richard</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Magen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klingenhoff</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seifert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Soldatov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parkhomchuk</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burset</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seledtsov</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Solovyev</surname>
            <given-names>VV</given-names>
          </name>
        </person-group>
        <article-title>Analysis of canonical and non-canonical splice sites in mammalian genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>4364</fpage>
        <lpage>4375</lpage>
        <pub-id pub-id-type="pmid">11058137</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI reference sequences (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>501</fpage>
        <lpage>504</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Curwen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Eyras</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mongin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Ensembl automatic gene annotation system</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>942</fpage>
        <lpage>950</lpage>
        <pub-id pub-id-type="pmid">15123590</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Clawson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The UCSC known genes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1036</fpage>
        <lpage>1046</lpage>
        <pub-id pub-id-type="pmid">16500937</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boguski</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tolstoshev</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>dbEST–database for “expressed sequence tags”</article-title>
        <source>Nat. Genet.</source>
        <year>1993</year>
        <volume>4</volume>
        <fpage>332</fpage>
        <lpage>333</lpage>
        <pub-id pub-id-type="pmid">8401577</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
