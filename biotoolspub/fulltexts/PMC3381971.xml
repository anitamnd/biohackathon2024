<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3381971</article-id>
    <article-id pub-id-type="pmid">22563066</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts260</article-id>
    <article-id pub-id-type="publisher-id">bts260</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Identifying differentially expressed transcripts from RNA-seq data with biological variation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Glaus</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Honkela</surname>
          <given-names>Antti</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rattray</surname>
          <given-names>Magnus</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>School of Computer Science, University of Manchester, Oxford Road, Manchester M13 9PL, UK, <sup>2</sup>Helsinki Institute for Information Technology HIIT, Department of Computer Science, University of Helsinki, P.O. Box 68, FI-00014 University of Helsinki, Finland and <sup>3</sup>Department of Computer Science and Sheffield Institute for Translational Neuroscience, University of Sheffield, Sheffield S10 2HQ, UK</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Janet Kelso</p>
      </fn>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the last two authors should be regarded as joint Last Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>28</volume>
    <issue>13</issue>
    <fpage>1721</fpage>
    <lpage>1728</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>4</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> High-throughput sequencing enables expression analysis at the level of individual transcripts. The analysis of transcriptome expression levels and differential expression (DE) estimation requires a probabilistic approach to properly account for ambiguity caused by shared exons and finite read sampling as well as the intrinsic biological variance of transcript expression.</p>
      <p><bold>Results:</bold> We present Bayesian inference of transcripts from sequencing data (BitSeq), a Bayesian approach for estimation of transcript expression level from RNA-seq experiments. Inferred relative expression is represented by Markov chain Monte Carlo samples from the posterior probability distribution of a generative model of the read data. We propose a novel method for DE analysis across replicates which propagates uncertainty from the sample-level model while modelling biological variance using an expression-level-dependent prior. We demonstrate the advantages of our method using simulated data as well as an RNA-seq dataset with technical and biological replication for both studied conditions.</p>
      <p><bold>Availability:</bold> The implementation of the transcriptome expression estimation and differential expression analysis, BitSeq, has been written in <monospace>C++</monospace> and <monospace>Python</monospace>. The software is available online from <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/bitseq/">http://code.google.com/p/bitseq/</ext-link>, version 0.4 was used for generating results presented in this article.</p>
      <p><bold>Contact:</bold><email>glaus@cs.man.ac.uk</email>, <email>antti.honkela@hiit.fi</email> or <email>m.rattray@sheffield.ac.uk</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>High-throughput sequencing is an effective approach for transcriptome analysis. This methodology, also called RNA-seq, has been used to analyze unknown transcript sequences, estimate gene expression levels and study single nucleotide polymorphisms (<xref ref-type="bibr" rid="B29">Wang <italic>et al.</italic>, 2009</xref>). As shown by other researchers (<xref ref-type="bibr" rid="B17">Mortazavi <italic>et al.</italic>, 2008</xref>), RNA-seq provides many advantages over microarray technology, although effective analysis of RNA-seq data remains a challenge.</p>
    <p>A fundamental task in the analysis of RNA-seq data is the identification of a set of differentially expressed genes or transcripts. Results from a differential expression (DE) analysis of individual transcripts are essential in a diverse range of problems such as identifying differences between tissues (<xref ref-type="bibr" rid="B17">Mortazavi <italic>et al.</italic>, 2008</xref>), understanding developmental changes (<xref ref-type="bibr" rid="B7">Graveley <italic>et al.</italic>, 2011</xref>) and microRNA target prediction (<xref ref-type="bibr" rid="B31">Xu <italic>et al.</italic>, 2010</xref>). To perform an effective DE analysis, it is important to obtain accurate estimates of expression for each sample, but it is equally important to properly account for all sources of variation, technical and biological, to avoid spurious DE calls (<xref ref-type="bibr" rid="B23">Robinson and Smyth, 2007</xref>; <xref ref-type="bibr" rid="B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="B19">Oshlack <italic>et al.</italic>, 2010</xref>). In this contribution, we address both of these problems by developing integrated probabilistic models of the read generation process and the biological replication process in an RNA-seq experiment.</p>
    <p>During the RNA-seq experimental procedure, a studied specimen of transcriptome is synthesized into cDNA, amplified, fragmented and then sequenced by a high-throughput sequencing device. This process results in a dataset consisting of up to hundreds of millions of short sequences, or reads, encoding observed nucleotide sequences. The length of the reads depends on the sequencing platform and currently typically ranges from 25 to 300 basepairs. Reads have to be either assembled into transcript sequences or aligned to a reference genome by an aligning tool, to determine the sequence they originate from.</p>
    <p>With proper sample preparation, the number of reads aligning to a certain gene is approximately proportional to the abundance of fragments of transcripts for that gene within the sample (<xref ref-type="bibr" rid="B17">Mortazavi <italic>et al.</italic>, 2008</xref>) allowing researchers to study gene expression (<xref ref-type="bibr" rid="B3">Cloonan <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B16">Marioni <italic>et al.</italic>, 2008</xref>). However, during the process of transcription, most eukaryotic genes can be spliced into different transcripts which share parts of their sequence. As it is the transcripts of genes that are being sequenced during RNA-seq, it is possible to distinguish between individual transcripts of a gene. Several methods have been proposed to estimate transcript expression levels (<xref ref-type="bibr" rid="B10">Katz <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B15">Li <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B18">Nicolae <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B27">Turro <italic>et al.</italic>, 2011</xref>). Furthermore, (<xref ref-type="bibr" rid="B28">Wang <italic>et al.</italic>, 2010</xref>) showed that estimating gene expression as a sum of transcript expression levels yields more precise results than inferring the gene expression by summing reads over all exons.</p>
    <p>As the transcript of origin is uncertain for reads aligning to shared subsequence, estimation of transcript expression levels has to be completed in a probabilistic manner. Initial studies of transcript expression used the expectation–maximization (EM) approach (<xref ref-type="bibr" rid="B15">Li <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B18">Nicolae <italic>et al.</italic>, 2010</xref>). This is a maximum-likelihood procedure which only provides a point estimate of transcript abundance and does not measure the uncertainty in these estimates. To overcome this limitation, <xref ref-type="bibr" rid="B10">Katz <italic>et al.</italic> (2010</xref>) used a Bayesian approach to capture the posterior distribution of the transcript expression levels using a Markov chain Monte Carlo (MCMC) algorithm. <xref ref-type="bibr" rid="B27">Turro <italic>et al.</italic> (2011</xref>) have also proposed MCMC estimation for a model of read counts over regions that can correspond to exons or other suitable subparts of transcripts.</p>
    <p>In this contribution, we present BitSeq (Bayesian inference of transcripts from sequencing data), a new method for inferring transcript expression and analyzing expression changes between conditions. We use a probabilistic model of the read generation process similar to the model of <xref ref-type="bibr" rid="B15">Li <italic>et al.</italic> (2010</xref>) and we develop an MCMC algorithm for Bayesian inference over the model. <xref ref-type="bibr" rid="B10">Katz <italic>et al.</italic> (2010</xref>) developed an MCMC algorithm for a similar generative model, but our model differs from theirs because we allow for multialigned reads mapping to different genes. Furthermore, we infer the overall relative expression of transcripts across the transcriptome whereas <xref ref-type="bibr" rid="B10">Katz <italic>et al.</italic> (2010</xref>) focus on relative expression of transcripts from the same gene. We have implemented MCMC using a collapsed Gibbs sampler to sample from the posterior distribution of model parameters.</p>
    <p>In many gene expression studies, expression levels are used to select genes with differences in expression in two conditions, a process referred to as a DE analysis. We propose a novel method for DE analysis that includes a model of biological variance while also allowing for the technical uncertainty of transcript expression which is represented by samples from the posterior probability distribution obtained from the probabilistic model of read generation. By retaining the full posterior distribution, rather than a point estimate summary, we can propagate uncertainty from the initial read summarization stage of analysis into the DE analysis. Similar strategies have been shown to be effective in the DE analysis of microarray data (<xref ref-type="bibr" rid="B13">Liu <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="B20">Rattray <italic>et al.</italic>, 2006</xref>) but given the inherent uncertainty of reads mapping to multiple transcripts, we expect the approach to bring even more advantages for transcript-level DE analyses. Furthermore, this method accounts for decreased technical reproducibility of RNA-seq for low-expressed transcripts recently reported by <xref ref-type="bibr" rid="B11">Łabaj <italic>et al.</italic> (2011</xref>) and can decrease the number of transcripts falsely identified as differentially expressed.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS</title>
    <p>The BitSeq analysis pipeline consists of two main stages: transcript expression estimation and DE assessment (<xref ref-type="fig" rid="F1">Fig. 1</xref>). For the transcript expression estimation, the input data are single-end or paired-end reads from a single sequencing run. The method produces samples from the inferred probability distribution over transcripts' expression levels. This distribution can be summarized by the sample mean in the case that only expression level estimates are required.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Diagram showing the BitSeq analysis pipeline divided into two separate stages. In Stage 1, transcript expression levels are estimated using reads from individual sequencing experiments. In Step 1, reads are aligned to the transcriptome. In Step 2, the probability of a read originating from a given transcript <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>I</italic><sub><italic>n</italic></sub>) is computed for each alignment based on Equation (<xref ref-type="disp-formula" rid="M1">1</xref>). These probabilities are used in Step 3 of the analysis, MCMC sampling from the posterior distribution in Equation (<xref ref-type="disp-formula" rid="M3">3</xref>). In Stage 2 of the analysis, the posterior distributions of transcript expression levels from multiple conditions and replicates are used to infer the probability that transcripts are differentially expressed. In Step 4, a suitable normalization for each experiment is estimated. The normalized expression samples are further used to infer expression-dependent variance hyperparameters in Step 5. Using these results, replicates are summarized by estimating the percondition mean expression for each transcript, Equation (<xref ref-type="disp-formula" rid="M4">4</xref>), in Step 6. Finally, in Step 7, samples representing the distribution of within-condition expression are used to estimate the probability of positive log ratio (PPLR) between conditions, which is used to rank transcripts based on DE belief</p></caption><graphic xlink:href="bts260f1"/></fig></p>
    <p>The DE analysis uses posterior samples of expression levels from two or more conditions and all available replicates. The conditions are summarized by inferring the posterior distribution of condition mean expression. Samples from the posterior distributions are compared with score the transcripts based on the belief in change of expression level between conditions.</p>
    <sec id="SEC2.1">
      <title>2.1 Stage 1: transcript expression estimation</title>
      <p>The initial interest when dealing with RNA-seq data is estimation of expression levels within a sample. In this work, we focus on the transcript expression levels, mainly represented by <bold>θ</bold>=(θ<sub>1</sub>,…, θ<sub><italic>M</italic></sub>), the relative abundance of transcripts' fragments within the studied sample, where <italic>M</italic> is the total number of transcripts. This can be further transformed into relative expression of transcripts θ<sub><italic>m</italic></sub><sup>(*)</sup>=θ<sub><italic>m</italic></sub>/(<italic>l</italic><sub><italic>m</italic></sub>(∑<sub><italic>i</italic>=1</sub><sup><italic>M</italic></sup> θ<sub><italic>i</italic></sub>/<italic>l</italic><sub><italic>i</italic></sub>)), where <italic>l</italic><sub><italic>m</italic></sub> is the length of the <italic>m</italic>-th transcript. Alternatively, expression can be represented by <italic>reads per kilobase per million mapped reads</italic>, <italic>RPKM</italic><sub><italic>m</italic></sub>=θ<sub><italic>m</italic></sub>×10<sup>9</sup>/<italic>l</italic><sub><italic>m</italic></sub>, introduced by <xref ref-type="bibr" rid="B17">Mortazavi <italic>et al.</italic> (2008</xref>).</p>
      <p>We use a generative model of the data, depicted in <xref ref-type="fig" rid="F2">Figure 2</xref>, which models the RNA-seq data as independent observations of individual reads <italic>r</italic><sub><italic>n</italic></sub>∈<italic>R</italic>={<italic>r</italic><sub>1</sub>,…, <italic>r</italic><sub><italic>N</italic></sub>}, depending on the relative abundance of transcripts' fragments <bold>θ</bold> and a noise parameter θ<sup>act</sup>. The parameter θ<sup>act</sup> determines the number of reads regarded as noise and enables the model to account for unmapped reads as well as for low-quality reads within a sample.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Graphical representation of the RNA-seq data probabilistic model. We can consider the observation of reads <italic>R</italic>=(<italic>r</italic><sub>1</sub>,…, <italic>r</italic><sub><italic>N</italic></sub>) as <italic>N</italic> conditionally independent events, with each observation of a read <italic>r</italic><sub><italic>n</italic></sub> depending on the transcript (or isoform) it originated from <italic>I</italic><sub><italic>n</italic></sub>. The probability of sequencing a given transcript <italic>I</italic><sub><italic>n</italic></sub> depends on the relative expression of fragments <bold>θ</bold> and the noise indicator <italic>Z</italic><sub><italic>n</italic></sub><sup>act</sup>. The noise indicator variable <italic>Z</italic><sub><italic>n</italic></sub><sup>act</sup> depends on noise parameter θ<sup>act</sup> and indicates that the transcript being sequenced is regarded as noise, which enables observation of low-quality and unmappable reads</p></caption><graphic xlink:href="bts260f2"/></fig></p>
      <p>Based on the parameter θ<sup>act</sup>, indicator variable <italic>Z</italic><sub><italic>n</italic></sub><sup>act</sup>∼Bern(θ<sup>act</sup>) determines whether read <italic>r</italic><sub><italic>n</italic></sub> is considered as noise or a valid sequence. For a valid sequence, the process of sequencing is being modelled. Under the assumption of reads being uniformly sequenced from the molecule fragments, each read is assigned to a transcript of origin by the indicator variable <italic>I</italic><sub><italic>n</italic></sub>, which is given by categorical distribution <italic>I</italic><sub><italic>n</italic></sub>∼Cat(<bold>θ</bold>).</p>
      <p>For a transcript <italic>m</italic>, we can express the probability of an observed alignment as the probability of choosing a specific position <italic>p</italic> and sequencing a sequence of given length with all its mismatches, <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>I</italic><sub><italic>n</italic></sub>=<italic>m</italic>)=<italic>P</italic>(<italic>p</italic>|<italic>m</italic>)<italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|seq<sub><italic>mp</italic></sub>). For paired-end reads, we compute the joint probability of the alignment of a whole pair, in which case, we also have to consider fragment length distribution <italic>P</italic>(<italic>l</italic>),
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="bts260m1"/></disp-formula>
Details of alignment probability computation including optional position and sequence-specific bias correction methods are presented in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Material</ext-link>. For every aligned read, we also calculate the probability that the read is from neither of the aligned transcripts but is regarded as sequencing error or noise <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|noise). This value is calculated by taking the probability of the least probable valid alignment corrupted with two extra base mismatches.</p>
      <p>The joint probability distribution of the model can now be written as
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="bts260m2"/></disp-formula>
where we use weak conjugate Dirichlet and Beta prior distributions for <bold>θ</bold> and θ<sup>act</sup>, respectively. The posterior distribution of the model's parameters given the data <italic>R</italic> can be simplified by integrating over all possible values of <italic>Z</italic><sup>act</sup>:
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="bts260m3"/></disp-formula>
According to the model, any read can be a result of sequencing either strand of an arbitrary transcript at a random position. However, the probability of a read originating from a location where it does not align is negligible. Thus, the term <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>I</italic><sub><italic>n</italic></sub>)Cat(<italic>I</italic><sub><italic>n</italic></sub>|<bold>θ)</bold>θ<sup>act</sup> has to be evaluated only for transcripts and positions to which the read does align. To accomplish this, we first align the reads to the transcript sequences using the <italic>Bowtie</italic> alignment tool (<xref ref-type="bibr" rid="B12">Langmead <italic>et al.</italic>, 2009</xref>), preserving possible multiple alignments to different transcripts. We then precompute <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>I</italic><sub><italic>n</italic></sub>) only for the valid alignments. (See Steps 1 and 2 in <xref ref-type="fig" rid="F1">Fig. 1</xref>.)</p>
      <p>The closed form of the posterior distribution is not analytically tractable and an approximation has to be used. We can analytically marginalize <bold>θ</bold> and apply a collapsed Gibbs sampler to produce samples from the posterior probability distribution over <italic>I</italic><sub><italic>n</italic></sub> (<xref ref-type="bibr" rid="B6">Geman and Geman, 1993</xref>; <xref ref-type="bibr" rid="B8">Griffiths and Steyvers, 2004</xref>). These are used to compute a posterior for <bold>θ</bold>, which is the main variable of interest. Full update equations for the sampler are given in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Material</ext-link>.</p>
      <p>In the MCMC approach, multiple chains are sampled at the same time and convergence is monitored using the <inline-formula><inline-graphic xlink:href="bts260i1.jpg"/></inline-formula> statistic (<xref ref-type="bibr" rid="B5">Gelman <italic>et al.</italic>, 2003</xref>). The <inline-formula><inline-graphic xlink:href="bts260i2.jpg"/></inline-formula> statistic is an estimate of a possible scale reduction of the marginal posterior variance and provides a measure of usefulness of producing more samples. We use the marginal posterior variance estimate and between chain variance to calculate the effective number of samples for each transcript as described by <xref ref-type="bibr" rid="B5">Gelman <italic>et al.</italic> (2003</xref>), to determine the number of iterations needed for convergence.</p>
      <p>Posterior samples of <bold>θ</bold> provide an assessment of the abundance of individual transcripts. As well as providing an accurate point estimate of the expression levels through the mean of the posterior, the probability distribution provides a measure of confidence for the results, which can be used in further analyses.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Stage 2: combining data from multiple replicates and estimating DE</title>
      <p>To identify transcripts that are truly differentially expressed, it is necessary to account for biological variation by using replication for each experimental condition. Our method summarizes these replicates by estimating the biological variance and inferring percondition Mean expression levels for each transcript. During the DE analysis, we consider the logarithm of transcript expression levels <italic>y</italic><sub><italic>m</italic></sub>=logθ<sub><italic>m</italic></sub>. The model for data originating from multiple replicates is illustrated in <xref ref-type="fig" rid="F3">Figure 3</xref>. We use a hierarchical log-normal model of within-condition expression. The prior over the biological variance is dependent on the mean expression level across conditions and the prior parameters (hyper-parameters) are learned from all of the data by fitting a nonparametric regression model. We fit a model for each gene using the expression estimates from Stage 1.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Graphical model of the biological variance in transcript expression experiment. For replicate <italic>r</italic>, condition <italic>c</italic> and transcript <italic>m</italic>, the observed log-expression level <italic>y</italic><sub><italic>m</italic></sub><sup>(<italic>cr</italic>)</sup> is normally distributed around the normalized condition mean expression μ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>+<italic>n</italic><sup>(<italic>cr</italic>)</sup> with biological variance 1/λ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>. The condition mean expression μ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup> for each condition is normally distributed with overall mean expression μ<sub><italic>m</italic></sub><sup>(0)</sup> and scaled variance 1/(λ<sup>(<italic>c</italic>)</sup><sub><italic>m</italic></sub>λ<sub>0</sub>). The inverse variance, or precision λ<sup>(<italic>c</italic>)</sup><sub><italic>m</italic></sub>, for a given transcript <italic>m</italic> follows a Gamma distribution with expression-dependent hyperparameters α<sub><italic>G</italic></sub>, β<sub><italic>G</italic></sub>, which are constant for a group of transcripts <italic>G</italic> with similar expression</p></caption><graphic xlink:href="bts260f3"/></fig></p>
      <p>A novel aspect of our Stage 2 approach is that we fit models to posterior samples obtained from the MCMC simulation from Stage 1, which can be considered ‘pseudo-data’ representing expression corrupted by technical noise. A pseudo-data vector is constructed using a single MCMC sample for each replicate across all conditions. The posterior distribution over per-condition means is inferred for each pseudo-data vector using the model in <xref ref-type="fig" rid="F3">Figure 3</xref> (described below). We then use Bayesian model averaging to combine the evidence from each pseudo-data vector and determine the probability of DE. This approach allows us to account for the intrinsic technical variance in the data; it is also computationally tractable because the model for a single pseudo-data vector is conjugate and therefore inference can be performed exactly. This effectively regularizes our variance estimate in the case that the number of replicates is low. As shown in <xref ref-type="sec" rid="SEC3.5">Section 3.5</xref>, this provides improved control of error rates for weakly expressed transcripts where the technical variance is large.</p>
      <p>For a condition <italic>c</italic>, we assume <italic>R</italic><sub><italic>c</italic></sub> replicate datasets. The log expression from replicate <italic>r</italic>, <italic>y</italic><sub><italic>m</italic></sub><sup>(<italic>cr</italic>)</sup> is assumed to be distributed according to a normal distribution with condition mean expression μ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>, normalized by replication-specific constant <italic>n</italic><sup>(<italic>cr</italic>)</sup>, and precision λ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>, <italic>y</italic><sub><italic>m</italic></sub><sup>(<italic>cr</italic>)</sup>∼Norm(μ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>+<italic>n</italic><sup>(<italic>cr</italic>)</sup>, 1/λ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>). As our parameters represent the relative expression levels in the sample, BitSeq implicitly incorporates normalization by the total number of reads or the RPKM measure, as Was done when generating the results in this publication. Further more, normalization can be implemented using the normalization constant <italic>n</italic><sup>(<italic>cr</italic>)</sup>, which is constant for all transcripts of a given replicate and can be estimated prior to probabilistic modelling using, for example, a quantile-based method (<xref ref-type="bibr" rid="B22">Robinson and Oshlack, 2010</xref>) or any other suitable technique.</p>
      <p>The condition mean expression is normally distributed μ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup> ∼ Norm (μ<sub><italic>m</italic></sub><sup>(0)</sup>, 1/(λ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>λ<sub>0</sub>)) with mean μ<sub><italic>m</italic></sub><sup>(0)</sup>, which is empirically calculated from multiple samples and scaled precision λ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup>λ<sub>0</sub>. The prior distribution over pertranscript, condition-specific precision λ<sub><italic>m</italic></sub><sup>(<italic>c</italic>)</sup> is a Gamma distribution with hyperparameters α<sub><italic>G</italic></sub>, β<sub><italic>G</italic></sub>, which are fixed for a group of transcripts with similar expression level, <italic>G</italic>.</p>
      <p>The hyperparameters α<sub><italic>G</italic></sub>, β<sub><italic>G</italic></sub> determine the distribution over pertranscript precision parameter <bold>λ</bold><sub><bold><italic>m</italic></bold></sub> which varies with the expression level of a transcript (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Figure 3</ext-link>). For this reason, we inferred these hyperparameters from the dataset for various levels of expression, prior to the estimation of precision <bold>λ</bold><sub><bold><italic>m</italic></bold></sub> and mean expression <bold>μ</bold><sub><bold><italic>m</italic></bold></sub>. We used the same model as <xref ref-type="fig" rid="F3">Figure 3</xref> applied jointly to multiple transcripts with similar empirical mean expression levels μ<sub><italic>m</italic></sub><sup>(0)</sup>. We set a uniform prior for the hyperparameters, marginalized out condition means and precision, and used an MCMC algorithm to sample α<sub><italic>G</italic></sub>, β<sub><italic>G</italic></sub>. The samples of α<sub><italic>G</italic></sub>, β<sub><italic>G</italic></sub> were smoothed by Lowess regression (<xref ref-type="bibr" rid="B2">Cleveland, 1981</xref>) against empirical mean expression to produce a single pair of hyperparameters for each group of transcripts with similar expression level.</p>
      <p>This model is conjugate and thus leads to a closed-form posterior distribution. This allows us to directly sample <bold>λ</bold><sub><italic>m</italic></sub> and <bold>μ</bold><sub><italic>m</italic></sub> given each pseudo-data vector <bold><italic>y</italic></bold><sub><bold><italic>m</italic></bold></sub> constructed from the Stage 1 MCMC samples:
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="bts260m4"/></disp-formula></p>
      <p>Samples of μ<sub><italic>m</italic></sub><sup>(<italic>c</italic><sub>1</sub>)</sup> and μ<sub><italic>m</italic></sub><sup>(<italic>c</italic><sub>2</sub>)</sup> are used to compute the probability of expression level of transcript <italic>m</italic> in condition <italic>c</italic><sub>1</sub> being greater than the expression level in condition <italic>c</italic><sub>2</sub>. This is done by counting the fraction of samples in which the mean expression from the first condition is greater, that is <italic>P</italic>(μ<sub><italic>m</italic></sub><sup>(<italic>c</italic><sub>1</sub>)</sup>&gt;μ<sub><italic>m</italic></sub><sup>(<italic>c</italic><sub>2</sub>)</sup>|<italic>R</italic>)=1/<italic>N</italic>∑<sub><italic>n</italic>=1</sub><sup><italic>N</italic></sup> δ(μ<sub><italic>m</italic>,<italic>n</italic></sub><sup><italic>(<italic>c</italic><sub>1</sub>)</italic></sup>&gt;μ<sub><italic>m</italic>,<italic>n</italic></sub><sup>(<italic>c</italic><sub>2</sub>)</sup>) which we refer to as the PPLR. Here, <italic>n</italic>=1… <italic>N</italic> represents one sample from the above posterior distribution for each of <italic>N</italic> independent pseudo-data vectors. Subsequently, ordering transcripts based on PPLR produces a ranking of most probable upregulated and downregulated transcripts. This kind of one-sided Bayesian test has previously been used for the analysis of microarray data (<xref ref-type="bibr" rid="B13">Liu <italic>et al.</italic>, 2006</xref>).</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS AND DISCUSSION</title>
    <sec id="SEC3.1">
      <title>3.1 Datasets</title>
      <p>We performed experiments evaluating both gene expression estimation accuracy as well as DE analysis precision. For the evaluation of bias correction effects as well as comparison with other methods (<xref ref-type="table" rid="T1">Table 1</xref>), we used paired-end RNA-seq data from the microarray quality control (MAQC) project (<xref ref-type="bibr" rid="B25">Shi <italic>et al.</italic>, 2006</xref>) (Short Read Archive accession number SRA012427), because it contains 907 transcripts which were also analyzed by TaqMan qRT-PCR, out of which 893 matched our reference annotation. The results from qRT-PCR probes are generally regarded as ground truth expression estimates for comparison of RNA-seq analysis methods (<xref ref-type="bibr" rid="B21">Roberts <italic>et al.</italic>, 2011</xref>). We used RefSeq refGene transcriptome annotation, assembly NCBI36/hg18 to keep results consistent with qRT-PCR data as well as previously published comparisons by <xref ref-type="bibr" rid="B21">Roberts <italic>et al.</italic> (2011</xref>).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of expression estimation accuracy against TaqMan qRT-PCR data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Read model</th><th rowspan="1" colspan="1">BitSeq</th><th rowspan="1" colspan="1">Cuff. 0.9.3</th><th rowspan="1" colspan="1">RSEM</th><th rowspan="1" colspan="1">MMSEQ</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Uniform</td><td rowspan="1" colspan="1"><bold>0.7677</bold></td><td rowspan="1" colspan="1">0.7503</td><td rowspan="1" colspan="1">0.7632</td><td rowspan="1" colspan="1">0.7614</td></tr><tr><td rowspan="1" colspan="1">Non-uniform</td><td rowspan="1" colspan="1">0.8011</td><td rowspan="1" colspan="1"><bold>0.8056</bold></td><td rowspan="1" colspan="1">0.7633</td><td rowspan="1" colspan="1">0.7990<xref ref-type="table-fn" rid="TF1"><sup>a</sup></xref></td></tr></tbody></table><table-wrap-foot><fn><p>The table shows the effect of non-uniform read distribution models using correlation coefficient <italic>R</italic><sup>2</sup> of average expression from three technical replicates with the 893 matching transcripts analysed by qRT-PCR, highest correlation is highlighted in bold. The sequencing data (SRA012427) are part of the MAQC project and was originally published by <xref ref-type="bibr" rid="B25">Shi <italic>et al.</italic> (2006</xref>).</p></fn><fn id="TF1"><p><sup>a</sup>We were not able to use the default bias correction provided by MMSEQ (<xref ref-type="bibr" rid="B27">Turro <italic>et al.</italic>, 2011</xref>) due to an error in an external <monospace>R</monospace> package mseq used for the bias correction. Instead, we provided the MMSEQ package with effective lengths computed by BitSeq bias correction algorithm to produce results for this comparison.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>The second dataset used in our evaluation was originally published by <xref ref-type="bibr" rid="B31">Xu <italic>et al.</italic> (2010</xref>) in a study focused on identification of microRNA targets and provides technical as well as biological replicates for both studied conditions. We use this data to illustrate the importance of biological replicates for DE analysis (<xref ref-type="fig" rid="F5">Fig. 5</xref>; <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Fig. 3</ext-link> for biological variance) and the advantages of using a Bayesian approach for both expression inference and DE analysis (<xref ref-type="fig" rid="F4">Fig. 4</xref>).
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>In plots (<bold>a</bold>) and (<bold>b</bold>), we show the posterior transcript expression density for pairs of transcripts from the same gene. This is a density map constructed using the MCMC expression samples for these three transcripts. In (<bold>c</bold>), we show the marginal posterior distribution of expression levels of the same transcripts as illustrated by histograms of MCMC samples. The sequencing data are from miRNA-155 study published by <xref ref-type="bibr" rid="B31">Xu <italic>et al.</italic> (2010</xref>)</p></caption><graphic xlink:href="bts260f4"/></fig></p>
      <p>For the purpose of evaluating and comparing BitSeq to existing DE analysis methods, we created artificial RNA-seq datasets with known expression levels and differentially expressed transcripts. We selected all transcripts of chromosome 1 from human genome assembly NCBI37/hg19 and simulated two biological replicates for each of the two conditions. We initially sample the expression for all replicates using the same mean relative expression and variation between replicates as were observed in the Xu <italic>et al.</italic> data estimates. Afterwards, we randomly choose one-third of the transcripts and shift one of the conditions up or down by a known fold change. Given the adjusted expression levels, we generated 300 k single-end reads uniformly distributed along the transcripts. The reads were reported in Fastq format with Phred scores randomly generated according to empirical distribution learned from the SRA012427 dataset. With the error probability given by a Phred score, we generated base mismatches along the reads.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Expression-level inference</title>
      <p><xref ref-type="fig" rid="F4">Figure 4</xref> demonstrates the ambiguity that may be present in the process of expression estimation. In <xref ref-type="fig" rid="F4">Figure 4</xref>a and <xref ref-type="fig" rid="F4">4</xref>b, we show the density of samples from the posterior distribution of expression levels for two pairs of transcripts. The expression levels of transcripts uc010oho.1 and uc010ohp.1 (<xref ref-type="fig" rid="F4">Fig. 4</xref>a) are negatively correlated. On the other hand, transcripts uc010oho.1 and uc001bwm.3 exhibit no visible correlation (<xref ref-type="fig" rid="F4">Fig. 4</xref>b) in their expression-level estimates. Even though this kind of correlation does not have to imply biological significance, it does point to technical difficulties in the estimation process. These transcripts share a significant amount of sequence and the consequent read mapping ambiguity leads to greater uncertainty in expression estimates (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Fig. 1</ext-link>d for transcript profile). Bayesian inference can be used to assess the uncertainty due to such confounding factors, unlike the maximum-likelihood point estimates provided by an EM algorithm. The marginal posterior probability of transcript expression for each transcript is shown in <xref ref-type="fig" rid="F4">Figure 4</xref>c. In our analysis pipeline, the marginal posterior distributions are propagated into the DE estimation stage, thus the uncertainty from expression estimation is taken into account when assessing whether there is strong evidence that transcripts are differentially expressed.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Expression estimation accuracy and read distribution bias correction</title>
      <p>Initially, it was assumed that high-throughput sequencing produces reads uniformly distributed along transcripts. However, more recent studies show biases in the read distribution depending on the position and surrounding sequence (<xref ref-type="bibr" rid="B4">Dohm <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B21">Roberts <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="B30">Wu <italic>et al.</italic>, 2011</xref>). Our generative model for transcript expression inference (<xref ref-type="fig" rid="F2">Fig. 2</xref>) includes a model of the underlying read distribution which is included in the <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>I</italic><sub><italic>n</italic></sub>=<italic>m</italic>) term that is calculated as a preprocessing step. The current BitSeq implementation contains the option of using a uniform read density model or using the model proposed by <xref ref-type="bibr" rid="B21">Roberts <italic>et al.</italic> (2011</xref>) which can account for positional and sequence bias. The effect of correcting for read distribution was analyzed using the SRA012427 dataset and results are presented in <xref ref-type="table" rid="T1">Table 1</xref>. We also compare BitSeq with three other transcript expression estimation methods: Cufflinks v0.9.3 (<xref ref-type="bibr" rid="B21">Roberts <italic>et al.</italic>, 2011</xref>), MMSEQ v0.9.18 (<xref ref-type="bibr" rid="B27">Turro <italic>et al.</italic>, 2011</xref>) and RSEM v1.1.14 (<xref ref-type="bibr" rid="B14">Li and Dewey, 2011</xref>).</p>
      <p>The dataset contains three technical replicates. These were analyzed separately and the resulting estimates for each method were averaged together. Subsequently, we calculated the squared Pearson correlation coefficient (<italic>R</italic><sup>2</sup>) of the average expression estimate and the results of qRT-PCR analysis. All four methods used with the default uniform read distribution model provide similar level of accuracy with BitSeq performing slightly better than the other three methods.</p>
      <p>Both BitSeq and Cufflinks use the same method for read distribution bias correction and provide improvement over the uniform model similar to improvements previously reported by <xref ref-type="bibr" rid="B21">Roberts <italic>et al.</italic> (2011</xref>). We used version 0.9.3 of Cufflinks (as used by Roberts <italic>et al.</italic>) since we found that the most recent stable version of Cufflinks (version 1.3.0) leads to much worse performance for both uniform and bias-corrected models (see Supplementary results <xref ref-type="sec" rid="SEC2.2">Section 2.2</xref>). The RSEM package uses its own method for bias correction based on the relative position of fragments, which in this case did not improve the expression estimation accuracy for the selected transcripts.</p>
      <p>In the case of BitSeq, the major improvement of accuracy originates from using the effective length normalization. To compare the results with qRT-PCR, the relative expression of fragments θ has to be converted into either relative expression of transcripts (θ<sup>*</sup>) or RPKM units. Using the bias-corrected effective length for this conversion leads to the higher correlation with qRT-PCR (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Table 1</ext-link>). This means that using an expression measure adjusted by the effective length, such as RPKM, is more suitable than normalized read counts for DE analysis.</p>
      <p>We also evaluated the accuracy of the four methods using three different expression measures on simulated data. First, we compared with transcripts' RPKM as an absolute expression measure. Second, we used relative within-gene expression in which transcript expression is the relative proportion within transcripts of the same gene. Finally, we used gene expression RPKM, the sum of transcript expression levels for each gene. The results are presented in <xref ref-type="table" rid="T2">Table 2</xref>. MMSEQ provides the best absolute expression accuracy with BitSeq and RSEM showing almost equally good results. For the relative within-gene expression levels, BitSeq is more accurate than the other methods. In spite of providing slightly better results in absolute measure, RSEM and MMSEQ show worse correlation in the relative within-gene measure as they tend to assign zero expression to some transcripts within one gene. This is most likely due to the use of maximum- likelihood parameter estimates as the starting point for the Gibbs sampling algorithm.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>The <italic>R</italic><sup>2</sup> correlation coefficient of estimated expression levels and ground truth</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Expression</th><th rowspan="1" colspan="1">Cutoff</th><th rowspan="1" colspan="1">BitSeq</th><th rowspan="1" colspan="1">Cuff. 0.9.3</th><th rowspan="1" colspan="1">RSEM</th><th rowspan="1" colspan="1">MMSEQ</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Transcript</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.994</td><td rowspan="1" colspan="1">0.764</td><td rowspan="1" colspan="1">0.995</td><td rowspan="1" colspan="1"><bold>0.997</bold></td></tr><tr><td rowspan="1" colspan="1">Relative</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1"><bold>0.945</bold></td><td rowspan="1" colspan="1">0.724</td><td rowspan="1" colspan="1">0.876</td><td rowspan="1" colspan="1">0.886</td></tr><tr><td rowspan="1" colspan="1">Relative</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1"><bold>0.963</bold></td><td rowspan="1" colspan="1">0.773</td><td rowspan="1" colspan="1">0.946</td><td rowspan="1" colspan="1">0.948</td></tr><tr><td rowspan="1" colspan="1">Gene</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.994</td><td rowspan="1" colspan="1">0.823</td><td rowspan="1" colspan="1">0.996</td><td rowspan="1" colspan="1"><bold>0.998</bold></td></tr></tbody></table><table-wrap-foot><fn><p>Three different expression measures were used: absolute transcript expression, relative within-gene transcript expression and gene expression. Comparison includes sites with at least 1 read per transcript for transcript expression, either 10 or 100 reads pre gene for within-gene transcript expression and at least 1 read per gene for gene expression. The highest correlation is in bold.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>For more details and results comparing the transcript expression estimation accuracy, please refer to <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Material</ext-link> Section 2.3.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 DE analysis</title>
      <p>We use the Xu <italic>et al.</italic> dataset to demonstrate the DE analysis process of BitSeq. This dataset contains technical and biological replication for both studied conditions. We observed significant difference between biological and technical variance of expression estimates (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary Fig. 3</ext-link>). Furthermore, the prominence of biological variance increases with transcript expression level. We illustrate how BitSeq handles biological replicates to account for this variance in <xref ref-type="fig" rid="F5">Figure 5</xref>, by showing the modelling process for one example transcript given only two biological replicates for each of two conditions.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>Comparison of BitSeq to naive approach for combining replicates within a condition for transcript uc001avk.2 of the Xu <italic>et al.</italic> dataset. (<bold>a</bold>) Initial posterior distributions of transcript expression levels for two conditions (labelled C0, C1), with two biological replicates each (labelled R0, R1). (<bold>b</bold>) Mean expression level for each condition using the naive approach for combining replicates. The posterior distributions from replicates are joined into one dataset for each condition. (<bold>c</bold>) Inferred posterior distribution of mean expression level for each condition using the probabilistic model in <xref ref-type="fig" rid="F3">Figure 3</xref>. (<bold>d</bold>) Distribution of differences between conditions from both approaches show that the naive approach leads to overconfident conclusion</p></caption><graphic xlink:href="bts260f5"/></fig></p>
      <p><xref ref-type="fig" rid="F5">Figure 5</xref>a shows histograms of expression-level samples produced in the first stage of our pipeline. BitSeq probabilistically infers condition mean expression levels using all replicates. For comparison, we used a naive way of combining two replicates by combining the posterior distributions of expression into a single distribution. The resulting posterior distributions for both approaches are depicted in <xref ref-type="fig" rid="F5">Figures 5</xref>b and <xref ref-type="fig" rid="F5">5</xref>c.</p>
      <p>The probability of DE for each transcript is assessed by computing the difference in posterior expression distributions of the two conditions. Resulting distributions of differences for both approaches are portrayed in <xref ref-type="fig" rid="F5">Figure 5</xref>d with obvious difference in the level of confidence. The naive approach reports high confidence of upregulation in the second condition, with the PPLR being 0.995. When biological variance is being considered by inferring the condition mean expression, the significance of DE is decreased to PPLR 0.836.</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Assessing DE performance with simulated data</title>
      <p>Using artificially simulated data with a predefined set of differentially expressed transcripts, we evaluated our approach and compared it with four other methods commonly used for DE analysis. DESeq v1.6.1 (<xref ref-type="bibr" rid="B1">Anders and Huber, 2010</xref>), edgeR v2.4.3 (<xref ref-type="bibr" rid="B24">Robinson <italic>et al.</italic>, 2010</xref>) and baySeq v1.8.1 (<xref ref-type="bibr" rid="B9">Hardcastle and Kelly, 2010</xref>) were designed to operate on the gene level and Cuffdiff v1.3.0 (<xref ref-type="bibr" rid="B26">Trapnell <italic>et al.</italic>, 2010</xref>) on the transcript level. Despite not being designed for this purpose, we consider the first three in this comparison as the use case is very similar and there are no other well-known alternatives besides Cuffdiff that would use replicates for transcript level DE analysis. All other methods beside Cuffdiff use BitSeq, Stage 1 transcript expression estimates converted to counts. Details regarding use of these methods are provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary material</ext-link>, Section 2.5. <xref ref-type="fig" rid="F6">Figure 6</xref> shows the overall results as well as split into three parts based on the expression of the transcripts. The receiver-operating characterization curves were generated by averaging over five runs with different transcripts being differentially expressed and the figures are focused on the most significant DE calls with false-positive rate below 0.2.
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>ROC evaluation of transcript level DE analysis using artificial dataset, comparing BitSeq with alternative approaches. DESeq, edgeR and baySeq use transcript expression estimates from BitSeq Stage 1 converted to counts. The curves are averaged over five runs with different set of transcripts being differentially expressed by fold change uniformly distributed in the interval (1.5,3.5). We discarded transcripts without any reads initially generated as these provide no signal. Panel (<bold>a</bold>) shows global average behaviour whereas in (<bold>b</bold>), (<bold>c</bold>) and (<bold>d</bold>) transcripts were divided into three equally sized groups based on the mean generative read count: [1,3), [3,19) and [19, ∞), respectively</p></caption><graphic xlink:href="bts260f6"/></fig></p>
      <p>Overall (<xref ref-type="fig" rid="F6">Figure 6</xref>a), BitSeq is the most accurate method, followed first by baySeq, then edgeR and DESeq with Cuffdiff further behind. This trend is especially clear for lower expression levels (<xref ref-type="fig" rid="F6">Fig. 6</xref>b and <xref ref-type="fig" rid="F6">6</xref>c). The overall performance here is fairly low because of high level of biological variance. For highest expressed transcripts (<xref ref-type="fig" rid="F6">Fig. 6</xref>d), DESeq and edgeR show slightly higher true positive rate than BitSeq and baySeq, especially at larger false- positive rates. Furthermore details and more results from the DE analysis comparison can be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts260/DC1">Supplementary material</ext-link> Section 2.5.</p>
    </sec>
    <sec id="SEC3.6">
      <title>3.6 Scalability and performance</title>
      <p>As BitSeq models individual read assignments, the running time complexity of the first stage of BitSeq increases with the number of aligned reads. Preprocessing the alignments and sampling a constant number of samples scales linearly with the number of reads. However, with more reads, the data become more complex and the Gibbs sampling algorithm needs more iterations to capture the whole posterior distribution.</p>
      <p>In <xref ref-type="table" rid="T3">Table 3</xref>, we present the running time for Stage 1, using simulated data generated from the UCSC NCBI37/hg19 knownGene reference. We ran the preprocessing of the reads with a uniform read distribution model on a single CPU and sampling with four parallel chains on four Intel Xeon 3.47 GHz CPUs. We set the sampler to run until it generates 1000 effective samples for at least 95% of transcripts. At the end, almost all transcripts converged according to the <inline-formula><inline-graphic xlink:href="bts260i3.jpg"/></inline-formula> statistic. The number of iterations necessary to produce the desired amount of effective samples seems to increase logarithmically with the number of reads.
<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Scalability and run-time complexity of BitSeq on different-sized datasets using simulated data with 9.9 up to 158.5 million paired-end reads</p></caption><table frame="hsides" rules="groups"><tbody><tr><td rowspan="1" colspan="1">Read pairs (M)</td><td rowspan="1" colspan="1">4.9</td><td rowspan="1" colspan="1">9.1</td><td rowspan="1" colspan="1">19.8</td><td rowspan="1" colspan="1">39.6</td><td rowspan="1" colspan="1">79.2</td></tr><tr><td rowspan="1" colspan="1">Alignments (M)</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">32</td><td rowspan="1" colspan="1">64</td><td rowspan="1" colspan="1">129</td><td rowspan="1" colspan="1">258</td></tr><tr><td rowspan="1" colspan="1">Preprocessing (m)</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">29</td><td rowspan="1" colspan="1">57</td><td rowspan="1" colspan="1">115</td></tr><tr><td rowspan="1" colspan="1">1000 samples (m)</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">32</td><td rowspan="1" colspan="1">56</td><td rowspan="1" colspan="1">71</td></tr><tr><td rowspan="1" colspan="1">Total time (h)</td><td rowspan="1" colspan="1">0:55</td><td rowspan="1" colspan="1">2:18</td><td rowspan="1" colspan="1">5:42</td><td rowspan="1" colspan="1">16:23</td><td rowspan="1" colspan="1">33:19</td></tr><tr><td rowspan="1" colspan="1">Convergence it.</td><td rowspan="1" colspan="1">5269</td><td rowspan="1" colspan="1">6900</td><td rowspan="1" colspan="1">8920</td><td rowspan="1" colspan="1">11970</td><td rowspan="1" colspan="1">15979</td></tr></tbody></table><table-wrap-foot><fn><p>The table shows wall clock running times to preprocess the aligned reads, generate 1000 samples and full time for the sampling algorithm on four CPUs. The last row contains the estimated number of iterations needed to reach convergence for at least 95% of transcripts.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>Running time of the DE analysis in Stage 2 does only depend on the number of reference transcripts, replicates and samples generated in Stage 1 for the analysis. Producing the result presented in <xref ref-type="sec" rid="SEC3.4">Section 3.4</xref> took 97 min on the Intel Xeon 3.47 GHz CPU.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 CONCLUSION</title>
    <p>We have presented methods for transcript expression level analysis and DE analysis that aim to model the uncertainty present in RNA-seq datasets. We used a Bayesian approach to provide a probabilistic model of transcriptome sequencing and to sample from the posterior distribution of the transcript expression levels. The model incorporates read and alignment quality, adjusts for non-uniform read distributions and accounts for an experiment-specific fragment length distribution in case of paired-end reads. The accuracy of inferred expression is comparable and in some cases, outperforms other competing methods. However, the major benefit of using BitSeq for transcript expression inference is the availability of the full posterior distribution which is useful for further analysis.</p>
    <p>The inferred distributions of transcript expression levels can be further analyzed by the second stage of BitSeq for DE analysis. Given biological replicates, BitSeq accounts for both intrinsic technical noise and biological variation to compute the posterior distribution of expression differences between conditions. It produces more reliable estimates of expression levels within each condition and associates these expression levels with a degree of credibility, thus providing fewer false DE calls. We want to highlight that to make accurate DE assessment, experimental designs must include biological replication and BitSeq is a method capable of combining information from biological replicates when comparing multiple conditions using RNA-Seq data.</p>
    <p>In our current work, we aim to reduce the computational complexity of BitSeq by replacing MCMC with a faster deterministic approximate inference algorithm and we are generalizing the model to include more complex experimental designs in the DE analysis stage.</p>
    <p><italic>Funding</italic>: European ERASysBio+ initiative project SYNERGY by the Biotechnology and Biological Sciences Research Council [BB/I004769/2 to M.R.] and Academy of Finland [135311 to A.H.]; Academy of Finland [121179 to A.H.]; and IST Programme of the European Community, under the PASCAL2 Network of Excellence [IST-2007-216886]. This publication only reflects the authors' views.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_28_13_1721__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_bts260_BitSeq-Supplementary_material.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>W. S.</given-names>
          </name>
        </person-group>
        <article-title>LOWESS: a program for smoothing scatterplots by robust locally weighted regression</article-title>
        <source>Am. Stat.</source>
        <year>1981</year>
        <volume>35</volume>
        <fpage>54</fpage>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cloonan</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stem cell transcriptome profiling via massive-scale mRNA sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>613</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="pmid">18516046</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>J. C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Bayesian Data Analysis.</source>
        <year>2003</year>
        <edition>2</edition>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geman</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Geman</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Stochastic relaxation, Gibbs distributions and the Bayesian restoration of image</article-title>
        <source>J. Appl. Stat.</source>
        <year>1993</year>
        <volume>20</volume>
        <fpage>25</fpage>
        <lpage>62</lpage>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graveley</surname>
            <given-names>B.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The developmental transcriptome of <italic>Drosophila melanogaster</italic></article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>471</volume>
        <fpage>473</fpage>
        <lpage>479</lpage>
        <pub-id pub-id-type="pmid">21179090</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths</surname>
            <given-names>T. L.</given-names>
          </name>
          <name>
            <surname>Steyvers</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Finding scientific topics</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>Suppl.</issue>
        <fpage>5228</fpage>
        <lpage>5235</lpage>
        <pub-id pub-id-type="pmid">14872004</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardcastle</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>K.A.</given-names>
          </name>
        </person-group>
        <article-title>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>422</fpage>
        <pub-id pub-id-type="pmid">20698981</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katz</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis and design of RNA sequencing experiments for identifying isoform regulation</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>1009</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="pmid">21057496</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Łabaj</surname>
            <given-names>P. P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization and improvement of RNA-Seq precision in quantitative transcript expression profiling</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>i383</fpage>
        <lpage>i391</lpage>
        <pub-id pub-id-type="pmid">21685096</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probe-level measurement error improves accuracy in detecting differential gene expression</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2107</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="pmid">16820429</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>C.N.</given-names>
          </name>
        </person-group>
        <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>323</fpage>
        <pub-id pub-id-type="pmid">21816040</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>493</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="pmid">20022975</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>J. C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolae</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Moulton</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Estimation of alternative splicing isoform frequencies from rna-seq data</article-title>
        <source>Algorithms in Bioinformatics, volume 6293 of Lecture Notes in Computer Science</source>
        <year>2010</year>
        <publisher-name>Springer Berlin/Heidelberg</publisher-name>
        <fpage>202</fpage>
        <lpage>214</lpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>From RNA-seq reads to differential expression results</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>220</fpage>
        <pub-id pub-id-type="pmid">21176179</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rattray</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Propagating uncertainty in microarray data analysis</article-title>
        <source>Brief Bioinform.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>37</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="pmid">16761363</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving RNA-Seq expression estimates by correcting for fragment bias</article-title>
        <source>Genome Biol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R22</fpage>
        <pub-id pub-id-type="pmid">21410973</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G.K.</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The MicroArray Quality Control (MAQC) project shows inter- and intraplatform reproducibility of gene expression measurements</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>1151</fpage>
        <lpage>1161</lpage>
        <pub-id pub-id-type="pmid">16964229</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>516</fpage>
        <lpage>520</lpage>
        <pub-id pub-id-type="pmid">20436463</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turro</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype and isoform specific expression estimation using multi-mapping RNA-seq reads</article-title>
        <source>Genome Biol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R13</fpage>
        <pub-id pub-id-type="pmid">21310039</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform abundance inference provides a more accurate estimation of gene expression levels in RNA-seq</article-title>
        <source>J. Bioinform. Comput. Biol.</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>177</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="pmid">21155027</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using non-uniform read distribution models to improve isoform expression inference in RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>502</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="pmid">21169371</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome and targetome analysis in MIR155 expressing cells using RNA-seq</article-title>
        <source>RNA</source>
        <year>2010</year>
        <fpage>1610</fpage>
        <lpage>1622</lpage>
        <pub-id pub-id-type="pmid">20584899</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
