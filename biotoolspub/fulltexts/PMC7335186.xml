<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7335186</article-id>
    <article-id pub-id-type="publisher-id">67513</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-67513-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Enhancing droplet-based single-nucleus RNA-seq resolution using the semi-supervised machine learning classifier DIEM</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Alvarez</surname>
          <given-names>Marcus</given-names>
        </name>
        <address>
          <email>malvarez@mednet.ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Rahmani</surname>
          <given-names>Elior</given-names>
        </name>
        <address>
          <email>elior.rahmani@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jew</surname>
          <given-names>Brandon</given-names>
        </name>
        <address>
          <email>brandon.jew@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garske</surname>
          <given-names>Kristina M.</given-names>
        </name>
        <address>
          <email>kmgarske@g.ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miao</surname>
          <given-names>Zong</given-names>
        </name>
        <address>
          <email>zmiao@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Benhammou</surname>
          <given-names>Jihane N.</given-names>
        </name>
        <address>
          <email>jbenhammou@mednet.ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Chun Jimmie</given-names>
        </name>
        <address>
          <email>jimmie.ye@ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pisegna</surname>
          <given-names>Joseph R.</given-names>
        </name>
        <address>
          <email>jpisegna@mednet.ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pietiläinen</surname>
          <given-names>Kirsi H.</given-names>
        </name>
        <address>
          <email>kirsi.pietilainen@helsinki.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Halperin</surname>
          <given-names>Eran</given-names>
        </name>
        <address>
          <email>eranhalperin@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pajukanta</surname>
          <given-names>Päivi</given-names>
        </name>
        <address>
          <email>ppajukanta@mednet.ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Human Genetics, </institution><institution>David Geffen School of Medicine at UCLA, </institution></institution-wrap>Los Angeles, CA 90095 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Computer Science, School of Engineering, </institution><institution>UCLA, </institution></institution-wrap>Los Angeles, CA 90095 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Bioinformatics Interdepartmental Program, </institution><institution>UCLA, </institution></institution-wrap>Los Angeles, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution>Department of Epidemiology and Biostatistics, Department of Bioengineering and Therapeutic Sciences, Institute for Human Genetics, </institution><institution>UCSF, </institution></institution-wrap>San Francisco, USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Vache and Tamar Manoukian Division of Digestive Diseases, </institution><institution>UCLA, </institution></institution-wrap>Los Angeles, CA USA </aff>
      <aff id="Aff6"><label>6</label>Obesity Research Unit, Research Programs Unit, Diabetes and Obesity, University of Helsinki, Biomedicum Helsinki, Helsinki, Finland </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9950 5666</institution-id><institution-id institution-id-type="GRID">grid.15485.3d</institution-id><institution>Obesity Center, Endocrinology, Abdominal Center, </institution><institution>Helsinki University Central Hospital and University of Helsinki, </institution></institution-wrap>Helsinki, Finland </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Human Genetics, Institute for Precision Health, </institution><institution>David Geffen School of Medicine at UCLA, </institution></institution-wrap>Gonda Center, Room 6335B, 695 Charles E. Young Drive South, Los Angeles, CA 90095-7088 USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0392 6765</institution-id><institution-id institution-id-type="GRID">grid.417816.d</institution-id><institution>Department of Anesthesiology, </institution><institution>UCLA Health, </institution></institution-wrap>Los Angeles, CA 90095 USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Computational Medicine, School of Medicine, </institution><institution>UCLA, </institution></institution-wrap>Los Angeles, CA 90095 USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Institute for Precision Health, School of Medicine, </institution><institution>UCLA, </institution></institution-wrap>Los Angeles, CA 90095 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>11019</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-nucleus RNA sequencing (snRNA-seq) measures gene expression in individual nuclei instead of cells, allowing for unbiased cell type characterization in solid tissues. We observe that snRNA-seq is commonly subject to contamination by high amounts of ambient RNA, which can lead to biased downstream analyses, such as identification of spurious cell types if overlooked. We present a novel approach to quantify contamination and filter droplets in snRNA-seq experiments, called Debris Identification using Expectation Maximization (DIEM). Our likelihood-based approach models the gene expression distribution of debris and cell types, which are estimated using EM. We evaluated DIEM using three snRNA-seq data sets: (1) human differentiating preadipocytes in vitro, (2) fresh mouse brain tissue, and (3) human frozen adipose tissue (AT) from six individuals. All three data sets showed evidence of extranuclear RNA contamination, and we observed that existing methods fail to account for contaminated droplets and led to spurious cell types. When compared to filtering using these state of the art methods, DIEM better removed droplets containing high levels of extranuclear RNA and led to higher quality clusters. Although DIEM was designed for snRNA-seq, our clustering strategy also successfully filtered single-cell RNA-seq data. To conclude, our novel method DIEM removes debris-contaminated droplets from single-cell-based data fast and effectively, leading to cleaner downstream analysis. Our code is freely available for use at <ext-link ext-link-type="uri" xlink:href="https://github.com/marcalva/diem">https://github.com/marcalva/diem</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Functional clustering</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Gene expression profiling</kwd>
      <kwd>Transcriptomics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Single-cell RNA sequencing (scRNA-seq) has grown considerably in use over the previous decade and permitted a transcriptomic view into the composition of heterogeneous mixtures of cells<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. Recent advances in droplet-based microfluidics have created a high-throughput opportunity to assay single cells by scaling up previous well-based technologies to tens to hundreds of thousands of cells<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Single-nucleus RNA sequencing (snRNA-seq), where nuclei are used instead of cells, has allowed the critical extension of single-cell based technologies to solid tissues where isolation and suspension of individual cells is difficult or impossible<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. For example, snRNA-seq has been used successfully to identify cell types in the brain<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Another practically important application of sequencing nuclei is identifying cell types in frozen tissue, from which it is often not feasible to isolate intact cells, whereas nuclei can still be successfully isolated<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>.</p>
    <p id="Par3">Droplet-based snRNA-seq encapsulates individual nuclei into a water-in-oil emulsion that contains reagents for generating cDNA and ligating droplet-specific oligonucleotide barcodes. After library construction and sequencing, the mapped reads can be assigned to droplets of origin. The input nuclei suspension is prepared so that all reads associated with one barcode originate from one nucleus. However, RNA originating from lysed cellular components (such as the cytoplasm) or from outside the cell can become encapsulated in droplets as well. Since these reads have the same barcode, contaminated RNA cannot be readily distinguished from nuclear RNA. To apply snRNA-seq to tissues, homogenization of the tissue is usually required to break apart the extracellular matrix and release nuclei from cells<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. This can release higher amounts of debris and lead to more background RNA contamination<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. This contamination of droplets with extranuclear RNA can lead to a biased increase in expression of these genes. Using mitochondrial RNA, we show that this results in clusters driven by background RNA, as well as contamination of clusters representing true cell types. As droplet-based snRNA-seq is increasingly applied to various solid tissues, there is an urgent need to accurately filter contaminated droplets.</p>
    <p id="Par4">A common practice to distinguish cell/nuclei- vs. background-containing barcodes relies on removing droplets below a hard cutoff of the number of reads, unique molecular indexes (UMI), or genes detected in a droplet<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. This ad hoc cutoff is typically set by ranking barcodes by their total UMI counts and visually selecting a knee point, where a steep dropoff in counts occurs<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. Droplets with higher counts are expected to contain cells or nuclei, whereas droplets with lower counts are expected to contain ambient RNA. However, a clear separation between the two may not occur, especially if the amount of debris is high and the droplet RNA content is low, as we show is the case with frozen solid tissues. Additionally, an ad hoc cutoff of the percent of reads originating from the mitochondria (a measure of extranuclear contamination) can help to filter droplets<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Again, the choice of a cutoff may be arbitrary or unclear. The recent method EmptyDrops<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> addresses this filtering issue for scRNA-seq by estimating a Dirichlet-Multinomial distribution of the ambient RNA. It then removes droplets by testing if their expression profile deviates significantly from the ambient profile using a Monte Carlo approach<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. However, while this works for single-cell, we show that these methods underperform when applied to snRNA-seq.</p>
    <p id="Par5">Here we show that, in snRNA-seq, using a hard cutoff to remove droplets can result in a substantial loss of nuclear droplets and inclusion of debris droplets. Importantly, we demonstrate that including these contaminated droplets can lead to spurious clustering and false positive cell types. To overcome this, we built a fast filtering pipeline that uses a likelihood-based approach to model debris and cell type RNA distributions with a multinomial distribution. The parameters of the model are inferred using semi-supervised EM<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>, where all droplets below a hard count threshold are fixed as debris. Then, the droplets are scored based on their expression of genes enriched in the debris set. This multinomial-based clustering approach has been successfully applied to the information retrieval and text mining fields<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Similar to reads, word occurrences in a document can be modeled with a multinomial distribution, and documents can belong to separate topics, leading to a mixture model.</p>
    <p id="Par6">We developed this pipeline into an approach, termed Debris Identification using EM (DIEM), which robustly removes background droplets from both scRNA-seq and snRNA-seq data. In contrast to hard count and EmptyDrops filtering, DIEM accurately models debris and cell types and can quantify the amount of contamination in individual droplets. This resulted in more accurate filtering and higher quality clustering of snRNA-seq data, particularly when applied to frozen tissue. We also found that DIEM can effectively filter scRNA-seq data.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>snRNA-seq produces clusters driven by high amounts of background RNA contamination</title>
      <p id="Par7">Isolation of nuclei for snRNA-seq relies on lysis of the cell membrane, releasing cytoplasmic RNA, in addition to cell-free RNA, into the solution. This extranuclear RNA can become encapsulated into droplets, with or without nuclei, and lead to biases in downstream analysis; particularly, it may lead to spurious or contaminated cell-types in downstream clustering. We evaluated the extent of contamination and its effect on clustering in three distinct snRNA-seq data sets: 1. in vitro differentiating human preadipocytes (DiffPA) (n = 1), 2. freshly dissected mouse brain tissue (n = 1), and 3. frozen human subcutaneous adipose tissue (AT) (n = 6). We initially ran a clustering analysis in the three data sets by filtering out droplets with a hard-count threshold<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. This threshold can be selected manually, as the knee point<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, or by dividing the total count of the 99% quantile of expected cells by 10<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Since we observed that the knee point could not be reliably estimated or was not evident in the AT samples (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), we used the quantile-based threshold for further analyses.<fig id="Fig1"><label>Figure 1</label><caption><p>Applying a hard count threshold fails to remove droplets contaminated with background RNA in snRNA-seq. (<bold>a</bold>) Barcode-rank plots showing the droplet size (the total number of UMI read counts) of each droplet in descending order for the differentiating preadipocytes (DiffPA), mouse brain, and six human frozen adipose tissue (AT) snRNA-seq samples. The dotted red line indicates the quantile-based threshold. (<bold>b</bold>) The number of droplets above and below the quantile-based hard-count threshold is shown. The height of the red bar indicates the number of background droplets in the category indicated in the x-axis, while the height of the blue bar indicates the number of nuclear droplets. Background and nuclear droplets are defined using the percent spliced reads. Ideally, all nuclear droplets would occur above the threshold and all background droplets would occur below. (<bold>c</bold>) UMAP<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> visualization of droplets in each of the three data sets with droplets colored by the percent of reads spliced. (<bold>d</bold>) The droplets above the quantile threshold were clustered using Seurat<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. The x-axis shows the clusters, and the y-axis shows the distribution of the percent of reads spliced for each cluster. Background droplets with a high percent of reads spliced tend to cluster together.</p></caption><graphic xlink:href="41598_2020_67513_Fig1_HTML" id="MO1"/></fig>
</p>
      <p id="Par8">To assess levels of extranuclear RNA contamination, we primarily used the percentage of reads that are spliced in a droplet. The poly-T capture probes used in drop-seq <sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and the 10X platform can also hybridize to adenosine tracts present in introns, allowing for quantification of unspliced pre-mRNAs<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. We expected that a higher percent of cytoplasmic ambient RNA would be spliced in comparison to nuclear RNA, and thus contaminated droplets would have a higher proportion of spliced reads. We found that in all three data sets, the percent of spliced reads correlated negatively with total UMI counts (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>a). Furthermore, we found that the percentage of reads spliced generally showed a bimodal distribution, with nuclear and background droplets centered below and above roughly 50%, respectively (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>b). For each of the 8 experiments, we calculated a midpoint to separate the nuclear and background distributions (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”). This was performed independently for each experiment as they exhibited distinct distributions (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>b). To evaluate clusters, we specified those with a mean percent of reads spliced of at least 50% as debris and classified those with less than 50% as cell types consistent with expressed marker genes, as we observed this was the average value across the experiments and that the 6 adipose tissue samples were combined. In addition to the percentage of reads spliced, we evaluated extranuclear contamination using the percentage of UMIs aligning to the mitochondria (MT%) and to the nuclear-localized lincRNA <italic>MALAT1</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (MALAT1%). We chose to incorporate mitochondrial RNA as a measure extranuclear RNA contamination because it is one of the only true sources of background RNA and is present in all snRNA-seq data sets. However, we note that other sources of extranuclear RNA can exist. Hemoglobin mRNA, which is predominantly expressed in erythrocytes, can also serve as another negative control for tissues where blood is present<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. We also found that the percentage of reads spliced correlated positively with MT% and negatively with MALAT1% (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>c, d). As the percentage of spliced reads is more independent from gene expression, we primarily used this metric as an estimate of contamination within droplets.</p>
      <p id="Par9">To test whether a hard count threshold could effectively remove debris-contaminated nuclei, we investigated the relationship between total counts and the percent of reads spliced. We selected the hard count threshold for each of the 8 independent samples based on a quantile<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). We found that this threshold failed to remove all background droplets and incorrectly removed nuclear droplets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, c). For example, in the DiffPA dataset, the quantile threshold correctly kept a large proportion of nuclear droplets (908 of 944) but incorrectly removed 457 droplets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Of the 11,331 passing droplets in the 6 adipose tissue samples, only 9,578 (84.5%) droplets were nuclear (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). We found that no single count threshold could effectively discriminate the nuclear and background droplets (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>a). We further investigated the downstream effect on clustering to see if there was any evidence of background RNA driving spurious clusters. In the DiffPA, mouse brain, and adipose tissue data sets, there were 2, 1, and 2 clusters that had a mean percent reads spliced greater than 50%, respectively (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Additionally, we observed droplets with a high MT% and clusters that were enriched for mitochondrial RNA (Fig. <xref rid="MOESM1" ref-type="media">S2</xref>). Overall, a hard count threshold failed to discriminate nucleus-containing droplets from debris droplets when using percent reads spliced and MT% to quantify contamination.</p>
    </sec>
    <sec id="Sec4">
      <title>Nuclear and debris droplets demonstrate distinct RNA profiles</title>
      <p id="Par10">Since the total UMI count in a droplet does not always distinguish nuclei from debris, we postulated that the expression profile of a droplet could be used to differentiate them if there were sufficient differences in RNA abundance between cell types and debris. Specifically, we hypothesized that there would be genes with sub-cellular localized RNA products that show differential abundance between droplets containing nuclear vs. ambient RNA. Thus, we evaluated the extent of differences between the debris and nuclear RNA profiles. We separated droplets into debris- and nuclear-enriched groups using a threshold of 100 total UMI counts. Although a large number of droplets above 100 UMI counts consist of debris and would lead to a loss of power, we use this threshold to ensure that no droplets below it contain nuclei. We evaluated the difference between the debris and nuclear RNA profiles by running a paired differential expression (DE) analysis in the six human AT samples. Of 19,934 genes detected, 3,417 (17.1%) were DE between the nuclear- and debris-enriched groups at a Bonferroni-adjusted p-value threshold of 0.05 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). To see if these differences were preserved across the DiffPA, mouse brain, and six AT data sets, we correlated the nuclear vs. debris log fold changes of the genes in common. Among the 8,924 genes expressed in all three data sets, we found that all log fold changes were significantly correlated (p &lt; 2.2 × 10<sup>−16</sup>) across all pairs (mean <italic>R</italic> = 0.56), with the human data sets showing the highest correlations (Fig .<xref rid="MOESM1" ref-type="media">S3</xref>).<fig id="Fig2"><label>Figure 2</label><caption><p>Debris-containing and nuclei-containing droplets show distinct gene expression profiles. (<bold>a</bold>) Differential expression (DE) between droplets with less than 100 UMI counts (debris) and greater than or equal to 100 UMI counts (nuclei) in the 6 human adipose tissue (AT) samples. The volcano plot shows the log fold change on the x-axis and negative log transformed p-value on the y-axis. The genes colored in blue are DE with a Bonferroni-corrected p-value &lt; 0.05. A positive log fold change indicates over-expression in the debris group. (<bold>b</bold>, <bold>c</bold>) For each of the 14 cell types identified after clustering the quantile filtered droplets, we ran differential expression between the cell type and the debris group, or between the cell type and all other cell types in the combined adipose tissue data set. Cell types are estimated from clustering droplets that pass quantile-based filtering. A (<bold>b</bold>) box plot shows the percent of expressed genes that are DE (Bonferroni p &lt; 0.05) between a cell type-debris pair, and a cell type-cell type pair. The p-value was calculated from a student’s t-test between cell type-debris percent and cell type-cell type percent. The (<bold>c</bold>) heatmap shows the percent of total genes expressed in the cell type (x-axis column) that are significantly differentially expressed between the debris droplets (first row) or droplets in all other cell types (second row). This shows that the DE between a cell type and the debris group is similar to the DE between different cell types.</p></caption><graphic xlink:href="41598_2020_67513_Fig2_HTML" id="MO2"/></fig>
</p>
      <p id="Par11">Since the nuclear-enriched group is not homogeneous, but rather originates from distinct cell types with different RNA distributions, we also looked at differences between the debris group and cell types. In addition, we compared the cell type-debris differences with the cell type-cell type differences. Using the six AT samples, we ran a paired DE analysis between the cell types and debris droplets (total UMI counts &lt; 100). Among 14 debris-cell type pairs, the average percent of genes that are DE was 5.8% (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). We then compared this to the DE between a cell type and all other cell types. Among these 14 pairs, the average percent of genes DE between cell types was slightly lower at 4.5% (t-test p = 0.23; Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, c). Overall, we found significant differences between debris and nuclei RNA profiles, and that the differences between debris and cell types were within the same order of magnitude as the cell type-cell type differences.</p>
    </sec>
    <sec id="Sec5">
      <title>Overview of a novel EM-based approach to cluster and remove debris droplets from snRNA-seq data</title>
      <p id="Par12">Since we observed differences in RNA abundance between cell types and debris, we developed an approach to remove debris-containing droplets based on the distribution of read counts. Our approach assigns individual debris scores to filter out droplets. We first cluster droplets using a multinomial mixture model<bold>.</bold> To estimate the parameters of the mixture model, we run semi-supervised expectation maximization<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup> by fixing droplets that fall below a threshold of 100 counts as debris. The majority of these droplets are assumed to contain ambient RNA, and thus we leverage this feature by fixing the labels throughout EM. After fitting the model, we assign droplets to clusters based on their posterior probability. Then, droplets are scored based on their expression of genes enriched in the debris set. DIEM then filters out droplets based on their individual scores. Figure <xref rid="Fig3" ref-type="fig">3</xref>a shows an overview of this model. We termed this method Debris Identification using Expectation Maximization (DIEM). We ran DIEM on the DiffPA, mouse brain, and six AT sample and compared our approach with the quantile-based method and the EmptyDrops method in the DropletUtils package<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.<fig id="Fig3"><label>Figure 3</label><caption><p>Debris scoring predicts background RNA contamination in snRNA-seq droplets. (<bold>a</bold>) Overview of DIEM approach to remove debris-contaminated droplets. Expectation Maximization (EM) is used to estimate the parameters of a multinomial mixture model consisting of debris and cell type groups. The label assignments of droplets below a pre-specified threshold (100 total counts) are fixed to the debris group, while the test set droplets above this rank are allowed to change group membership. The mixture model is initialized by running k-means. After parameter estimation, droplets are grouped into the debris cluster(s) or cell type clusters based on their posterior probabilities. Debris scores are calculated for each droplet by summing the normalized expression of debris-enriched genes, which are specified by differential expression between the debris and cell type clusters. Droplets can be filtered based on their cluster assignment or on their debris score. (<bold>b</bold>) The debris score of a droplet and the percent of reads spliced exhibit a significant correlation in the differentiating preadipocytes (DiffPA), mouse brain, and human frozen adipose tissue (AT) data sets (mean <italic>R</italic> = 0.89). The horizontal red line indicates the sample-specific midpoint that separates nuclear and background droplets. The vertical blue line indicates the threshold cutoff of 0.5 we used, where droplets with a debris score less than 0.5 are classified as clean. <bold>c,</bold> Scatterplots of droplets from snRNA-seq of the DiffPA, mouse brain, and AT data sets, with total unique molecular index (UMI) counts on the x-axis and total number of genes detected on the y-axis. Droplets are colored by the DIEM classification. Those in red are removed as debris while the blue droplets are kept as nuclei.</p></caption><graphic xlink:href="41598_2020_67513_Fig3_HTML" id="MO3"/></fig>
</p>
      <p id="Par13">Although debris scores are used to filter out individual droplets, we run clustering to better initialize the debris and cell type groups. Droplets are clustered using a multinomial mixture model and the parameters are fit using semi-supervised EM. To initialize the EM, we run k-means with a pre-specified number of cell types k. After the initialization, semi-supervised EM estimates the parameters of the multinomial mixture model while fixing the labels of the low-count droplets to the debris cluster. The mixture model consists of k + 1 clusters corresponding to the debris cluster along with the cell type clusters initialized by k-means (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Here, we set k to 20 for all experiments, although we noticed robust results across a range of k greater than 1 to 50 (Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). While it is possible to remove droplets that have high posterior probability of belonging to the debris cluster, we noticed that some of the cell type clusters produced by the mixture model contained contaminated droplets with high a percent of reads spliced in the snRNA-seq data sets (Fig. <xref rid="MOESM1" ref-type="media">S5</xref>). Since only removing the debris cluster would fail to account for this, we developed an approach to estimate contamination in individual droplets instead (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”). Briefly, DIEM runs differential expression between the droplets in the debris and cell type clusters and calculates a debris score based on the debris-enriched genes. We found that this debris score correlated highly with the percent of spliced reads in all 8 independent snRNA-seq experiments (mean Pearson <italic>R</italic> = 0.89; Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). To filter our droplets, we use a threshold <italic>t</italic> where those with a score above this value are removed. We investigated the effect of varying <italic>t</italic> from 0 to 1. As expected, the number of passing droplets increased with <italic>t</italic> (Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). However, the proportion of background droplets and contamination in the kept droplets also increased as <italic>t</italic> was increased (Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). We therefore set <italic>t</italic> to 0.5 for all experiments in the manuscript. Intuitively, this value represents the threshold that lies between the least contaminated cluster and the debris cluster.</p>
      <p id="Par14">The incorporation of clusters should result in a more realistic model of the snRNA-seq data. DIEM directly models debris and cell type clusters to more accurately specify the debris and cell type droplets for calculating the debris score. We asked whether the clusters identified by DIEM corresponded to valid biological cell types. DIEM identified 3 major cell types in the DiffPA, consisting of preadipocyte-like, fibroblast-like, and adipocyte cells (Fig. <xref rid="MOESM1" ref-type="media">S7</xref>a). In the adipose tissue data sets, we found that the up-regulated cluster markers corresponded to the known major cell types in adipose, including immune, endothelial, fibroblast, and adipocyte cell-types (Fig. <xref rid="MOESM1" ref-type="media">S7</xref>b). We then compared the DIEM clusters to those identified by the established method Seurat<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> We found that the Seurat clusters generally overlapped with the DIEM clusters (mean percent overlap 73.0% across the 8 independent samples; Fig. <xref rid="MOESM1" ref-type="media">S7</xref>c). Together, these results suggest that DIEM accurately identifies cell types and can leverage this cell-type heterogeneity to filter debris droplets.</p>
    </sec>
    <sec id="Sec6">
      <title>DIEM filtering results in a higher proportion of nuclear droplets and less contaminated clusters in snRNA-seq</title>
      <p id="Par15">We ran DIEM on the adipocyte, mouse brain, and six adipose tissue samples. We observed that DIEM removed droplets across a range of total UMI counts (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). We then evaluated the extent of extranuclear contamination, as well as its effect on clustering, across the quantile, EmptyDrops, and DIEM methods. We first quantified the number of nuclear and background droplets that passed filtering in each of the 8 experiments. In the DiffPA data set, the DIEM and quantile methods kept a larger proportion of nuclear droplets. Among the passing droplets, 1,337 of 1,339 (99.9%), 1,360 of 1,579 (86.1%), and 908 of 944 (96.2%) were nuclear in the DIEM, EmptyDrops, and quantile droplets, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). In the mouse brain data set, all three methods produced similar results. We found that 1,850 of 2,010 (92.0%), 1,868 of 2,080 (89.8%), and 1,832 of 2,083 (87.6%) passing droplets were nuclear in the DIEM, EmptyDrops, and quantile droplets, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Across all 6 adipose tissue samples, 12,117 of 12,715 (95.7%), 10,110 of 11,502 (87.9%), and 9,578 of 11,331 (84.5%) passing droplets were nuclear in the DIEM, EmptyDrops, and quantile droplets, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). We further investigated these filtering methods in each of the adipose tissue samples. We found that the percent of DIEM passing droplets that were nuclear was significantly higher when compared to EmptyDrops and the quantile approach (paired Wilcoxon p = 0.03). Overall, the DIEM method tended to keep a higher number and proportion of nuclear droplets in the 8 snRNA-seq experiments.<fig id="Fig4"><label>Figure 4</label><caption><p>DIEM filtering keeps an increased number and proportion of nuclear droplets in snRNA-seq. (<bold>a</bold>) The bar plots show the number and type of droplets that pass the indicated filtering method in the differentiating preadipocytes (DiffPA), mouse brain, and six human frozen adipose tissue (AT) snRNA-seq samples. The height of the blue bar indicates the number of nuclear droplets that pass filtering, while the height of the red bar indicates the number of background droplets. DIEM filtering tends to result in a higher number and proportion of nuclear droplets. Background and nuclear droplets are defined using the percent spliced reads. (<bold>b</bold>) The percent of reads spliced is shown in a boxplot for droplets that pass the indicated filtering method in the DiffPA, mouse brain, and six AT snRNA-seq samples. The horizontal red line indicates the sample-specific midpoint, where droplets above and below are background and nuclear, respectively. A Mann-Whitney U test was performed between DIEM and EmptyDrops<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and DIEM and quantile-filtered droplets. DIEM shows a decrease in percent spliced reads for all comparisons (black bar and asterisks) except for AT4 with EmptyDrops (red bar and asterisks). P-values were corrected for multiple testing using Bonferroni and are shown in the upper portion of the plot (*p &lt; 0.05; **p &lt; 0.005; ***p &lt; 0.0005). (<bold>c</bold>) UMAP<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> visualization of clusters after filtering with the indicated method in the combined adipose tissue snRNA-seq data set. Clusters were identified with Seurat<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> and classified as adipocyte (Adp), doublet (Dblt), myeloid (Myl), T cell, mast, and stromal (Stm) cell types according to their up-regulated genes. A cluster was classified as debris (Dbr) if it had a mean percent of spliced reads above 50%.</p></caption><graphic xlink:href="41598_2020_67513_Fig4_HTML" id="MO4"/></fig>
</p>
      <p id="Par16">Next, we compared the fraction of spliced reads in individual droplets for the independent experiments using a Mann–Whitney U test (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). When compared to EmptyDrops, DIEM had a significantly lower spliced reads fraction for the DiffPA, AT2, AT3, and AT6 samples. Although DIEM droplets had a lower mean of percent spliced reads for the AT4 sample, the Mann–Whitney U test yielded a significantly higher rank for the spliced reads fraction when compared to EmptyDrops (Bonferroni-corrected p &lt; 0.05; Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). When compared to the quantile-passing droplets, DIEM had a significantly lower spliced reads fraction for the mouse brain and 5 of the 6 adipose tissue samples (Bonferroni-corrected p &lt; 0.05; Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). None of the quantile-filtered droplets produced samples with a lower percent of reads spliced than DIEM, suggesting the quantile droplets contain more ambient RNA. Taken together, these results suggest that the DIEM-passing droplets comprise more nuclear droplets when using the percent of reads spliced as a measure of contamination.</p>
      <p id="Par17">We then looked at the effect of filtering on clustering results. We clustered passing droplets using Seurat<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> to unbiasedly evaluate the clustering results based on each of the three methods. We considered clusters with a mean percent spliced reads of at least 50% as debris clusters and classified those with less than 50% as cell types consistent with expressed marker genes (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”). In the DiffPA dataset, DIEM removed a debris cluster that was present after filtering with both the quantile and EmptyDrops methods (Fig. <xref rid="MOESM1" ref-type="media">S8</xref>a, b). Additionally, both EmptyDrops and DIEM identified a low count cluster that showed evidence of containing nuclei (Fig. <xref rid="MOESM1" ref-type="media">S9</xref>), highlighting how a hard count threshold can result in removing cell types with lower counts. In the mouse brain data set, both EmptyDrops and DIEM removed a background cluster (median spliced reads 88.5%) that was present in the quantile method (Fig. <xref rid="MOESM1" ref-type="media">S8</xref>c, d). For the adipose tissue data set, we combined the 6 individual filtered data sets and ran Seurat clustering with a resolution value of 2 to accommodate the larger number of droplets. DIEM resulted in 21 clusters, while EmptyDrops and the quantile method yielded 23 clusters. We then classified clusters based on their marker genes (Figs. <xref rid="Fig4" ref-type="fig">4</xref>c–e and S10). None of the DIEM clusters had a mean percent of reads spliced above 50% (Fig. <xref rid="MOESM1" ref-type="media">S11</xref>a). However, EmptyDrops filtering resulted in 3 debris clusters while the quantile approach yielded 4 (Fig. <xref rid="MOESM1" ref-type="media">S11</xref>a). There was a high overlap of over 50% in the major cell types between all 3 methods, but clusters consisting of smaller numbers of droplets tended to be spread across related cell types (Fig. <xref rid="MOESM1" ref-type="media">S11</xref>b). Overall, these results suggest that DIEM preserves cell types while removing clusters characterized by high extranuclear contamination when compared to the EmptyDrops and quantile approaches.</p>
    </sec>
    <sec id="Sec7">
      <title>DIEM filtering removes a higher proportion of contaminated droplets and clusters in snRNA-seq</title>
      <p id="Par18">We next investigated whether filtering incorrectly removed nucleus-containing droplets and possibly true cell types. Similar to the above analysis, we quantified the number of nuclear and debris droplets that were removed by each of the three methods. In the DiffPA dataset, 1,542 of 1,570 (98.2%), 1,325 of 1,330 (99.6%), and 1,508 of 1,965 (76.7%) removed droplets were background droplets after DIEM, EmptyDrops, and quantile filtering, respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). The DIEM and EmptyDrops methods performed similarly in the mouse brain data set, and both outperformed the quantile approach. We found that 117 of 171 (68.4%), 65 of 101 (64.4%), and 26 of 98 (26.5%) removed droplets were classified as background in the DIEM, EmptyDrops, and quantile filtering, respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Across all adipose tissue samples, we found that the DIEM-removed droplets consisted of a higher proportion of background-derived droplets. We found that 2,499 of 3,140 (79.6%), 1,651 of 4,353 (37.9%), 1,290 of 4,524 (28.5%) removed droplets were background droplets in the DIEM, EmptyDrops, and quantile filtering, respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We investigated the percent of background droplets in those removed in each of the 6 adipose tissue samples as well. The percent of the removed droplets that were background was significantly higher with DIEM when compared to EmptyDrops and the quantile approach (paired Wilcoxon p = 0.03). We found that EmptyDrops incorrectly removed a much higher number of nuclear droplets in the AT4 and AT5 samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). EmptyDrops filtered out 1,038 in the AT4 and 782 in the AT5 samples, whereas DIEM removed 63 and 36 nuclear droplets, respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Overall, DIEM tended to remove a higher number and proportion of background droplets than EmptyDrops or the quantile approach.<fig id="Fig5"><label>Figure 5</label><caption><p>DIEM filtering removes fewer numbers of nuclei in snRNA-seq. (<bold>a</bold>) The bar plots show the number and type of droplets that are removed by the indicated filtering method in the differentiating preadipocytes (DiffPA), mouse brain, and six human frozen adipose tissue (AT) snRNA-seq samples. The height of the blue bar indicates the number of nuclear droplets that are removed while the height of the red bar indicates the number of background droplets. Background and nuclear droplets are defined using the percent spliced reads. DIEM filtering tends to result in a higher number and proportion of nuclear droplets. Removal of large numbers of nuclear droplets and low numbers of background droplets indicates poor performance. (<bold>b</bold>) The percent of reads spliced is shown in a boxplot for droplets removed by the filtering method in the DiffPA, mouse brain, and six AT snRNA-seq samples. The horizontal red line indicates the sample-specific midpoint, where droplets above and below are background and nuclear, respectively. A Mann-Whitney U test was performed between DIEM and EmptyDrops<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and DIEM and quantile removed droplets. DIEM shows an increase in percent of reads spliced for all comparisons. P-values were corrected for multiple testing using Bonferroni and are shown in the upper portion of the plot (*p &lt; 0.05; **p &lt; 0.005; ***p &lt; 0.0005). (<bold>c</bold>) UMAP<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> visualization of clustering of removed droplets with the indicated method in the combined adipose tissue snRNA-seq data set. Clusters were classified as adipocyte (Adp), doublet (Dblt), myeloid (Myl), T cell, mast, and stromal (Stm) cell types according to their up-regulated genes. A cluster was classified as debris (Dbr) if it had a mean percent of spliced reads above 50%.</p></caption><graphic xlink:href="41598_2020_67513_Fig5_HTML" id="MO5"/></fig>
</p>
      <p id="Par19">We next investigated the amount of extranuclear contamination in the individual filtered-out droplets using a Mann–Whitney U test. We found that DIEM removed more background droplets with a significantly higher percent of reads spliced in all 8 experiments when compared to the quantile approach (Bonferroni-corrected p &lt; 0.05; Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). When compared to EmptyDrops, DIEM-removed droplets had a significantly higher percent of spliced reads for 5 of the 6 adipose tissue samples (Bonferroni-corrected p &lt; 0.05; Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Neither the EmptyDrops nor the quantile method resulted in significantly more contamination in the removed debris droplets than DIEM. These results suggest that the DIEM-removed droplets contained fewer nuclei when using the percent of reads spliced as a measure of contamination.</p>
      <p id="Par20">Among the droplets removed by the three filtering methods, we sought further evidence that they originated from cell types. We clustered the removed droplets in the adipose tissue and looked to see if they consisted of biological cell types. We again considered clusters with a mean percent of reads spliced of at least 50% as debris clusters and classified those with less than 50% as cell types consistent with expressed marker genes (Figs. <xref rid="MOESM1" ref-type="media">S1</xref> and <xref rid="MOESM1" ref-type="media">S12</xref>). Among the 8 clusters present in the DIEM-removed droplets, all had an average percent of reads spliced above 50%, suggesting that these consist of largely contaminated droplets (Figs. <xref rid="Fig5" ref-type="fig">5</xref>c and <xref rid="MOESM1" ref-type="media">S12</xref>a). The EmptyDrops-removed droplets formed 11 clusters, 6 of which were debris. The other 5 clusters consisted of adipocyte, vascular, and stromal cell types (Figs. <xref rid="Fig5" ref-type="fig">5</xref>d and <xref rid="MOESM1" ref-type="media">S12</xref>a). The quantile-removed droplets formed 7 cell type and 2 debris clusters. The cell type clusters consisted of adipocyte, stromal, T cell, myeloid, and mast cell types (Figs. <xref rid="Fig5" ref-type="fig">5</xref>e and <xref rid="MOESM1" ref-type="media">S12</xref>a). Taken together, we found that the clusters formed by DIEM-removed droplets had more extranuclear contamination than those from EmptyDrops and the quantile method.</p>
      <p id="Par21">Interestingly, we found that the debris clusters formed by all filtering methods exhibited cell type-specific expression (Fig. <xref rid="MOESM1" ref-type="media">S12</xref>b–e). This suggests that nucleus-containing droplets exhibit a range of extranuclear contamination in snRNA-seq experiments from frozen tissue. Furthermore, we found that droplets that had high read counts of the macrophage marker <italic>CD14</italic><sup><xref ref-type="bibr" rid="CR21">21</xref></sup> tended to have higher extranuclear contamination and were more often filtered out by DIEM (Figs. <xref rid="MOESM1" ref-type="media">S10</xref>f and S12d). This suggests that <italic>CD14</italic> + macrophages are more susceptible to damage or contamination and may imply that nuclei isolation or the snRNA-seq assay may introduce a bias in cell type capture.</p>
    </sec>
    <sec id="Sec8">
      <title>DIEM filtering removes debris from single-cell RNA-seq</title>
      <p id="Par22">In addition to filtering snRNA-seq, we also investigated whether our approach could be applied to single-cell RNA-seq data. We found that the debris scoring approach of individual droplets did not effectively distinguish empty vs. cell droplets in the 68,000 PBMC single-cell RNA-seq experiment<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (Fig. <xref rid="MOESM1" ref-type="media">S13</xref>). DIEM gave a high debris score to a cell type cluster with high read counts, suggesting the debris-enriched genes and thus the debris score were less specific in discriminating debris droplets from all cell types in this PBMC single-cell RNA-seq data set. Although the threshold could be increased to accommodate this cell type, we found that simply removing droplets belonging to the fixed debris cluster was effective in removing empty droplets in the single cell RNA-seq data. Both DIEM and EmptyDrops kept all 69,981 droplets that had at least 200 genes detected. To evaluate the effect of filtering, we removed this threshold to more completely characterize the two methods. Among 78,024 comparable droplets with at least 100 UMI counts, EmptyDrops kept 77,585 and DIEM kept 75,847. The 1,927 droplets unique to EmptyDrops showed a high percent of reads aligning to the mitochondria and to <italic>MALAT1</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). The 189 unique droplets to DIEM showed MT% and MALAT1% levels similar to the shared droplets that passed both filtering methods (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). Although these metrics no longer serve as negative and positive controls as they do in snRNA-seq, they are consistent with a ruptured cell membrane. This suggests that EmptyDrops retains droplets with dying cells whereas DIEM removes them. We next evaluated the clusters formed by these droplets. DIEM-filtered droplets formed 18 clusters while EmptyDrops resulted in 19 clusters. As expected, there was a general one-to-one correspondence between the clusters. However, the droplets with high MT% and MALAT1% formed a cluster that was absent in the DIEM results (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b, c). Overall, we found that EmptyDrops and DIEM provided similar results in the PBMC single-cell RNA-seq data.<fig id="Fig6"><label>Figure 6</label><caption><p>DIEM filtering in single-cell RNA-seq of fresh PBMCs results in robust cell type identification. (<bold>a</bold>) Boxplots showing the percent of unique molecular indices (UMIs) mapping to the mitochondria (left) and the percent of MALAT1 UMIs (right) in the fresh 68 K peripheral blood mononuclear cells (PBMC) data set<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The DIEM and EmptyDrops<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> set includes the droplets identified by both DIEM and EmptyDrops (n = 75,658), while the EmptyDrops only set (n = 1,927) and the DIEM only set (n = 189) include droplets uniquely kept by each method. The droplets uniquely kept by EmptyDrops have a higher percent of reads aligned to the mitochondrial and MALAT1 genes, consistent with a ruptured cell membrane. (<bold>b</bold>, <bold>c</bold>) Boxplots show the percent of UMIs aligning to the mitochondrial genome (MT%), to the nuclear-localized MALAT1<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (MALAT1%), and the log total number of UMIs in a droplet for clusters in the PBMC single-cell RNA-seq data set. These measures are plotted for the (<bold>b</bold>) clusters from the DIEM-kept droplets and the (<bold>c</bold>) clusters from the EmptyDrops-kept droplets. Clusters were identified with Seurat<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. The droplets uniquely kept by EmptyDrops form a distinct cluster with high MT% and MALAT1%.</p></caption><graphic xlink:href="41598_2020_67513_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par23">The snRNA-seq approach is an adaptation of scRNA-seq that allows for cell-type identification when isolation of a cell suspension is not possible, such as in frozen tissues. We have shown here that snRNA-seq is subject to background contamination from extranuclear RNA and that it can drive spurious clusters and false positive cell-types if not properly accounted for. We also show that current methods, such as the commonly applied hard count threshold, do not effectively address this problem in snRNA-seq. To this end, we searched for and found differences in the gene expression profiles from the debris and cell types. This motivated us to develop DIEM in order to use the RNA profile of a droplet for filtering contaminated snRNA-seq experiments. We found that DIEM efficiently removed debris-contaminated droplets while preserving cell types in snRNA-seq data from fresh cells, fresh tissue, and frozen tissue inputs.</p>
    <p id="Par24">DIEM first clusters all droplets generated from the experiment to identify droplets belonging either to the debris cluster or putative cell type clusters. This allows for a general separation of droplets into debris and cell type groups, and thus more accurate differential expression analysis between background and cell type droplets. Although it is possible to simply remove droplets that cluster as debris, we found that clusters with high amounts of contamination still existed in snRNA-seq. Therefore, scoring and filtering individual droplets allow for finer classification as well as quantification of the amount of contamination. The debris score threshold that removes droplets can be adjusted according to the desired tolerance for contamination. In addition, this estimate can be used as a covariate in downstream analyses, such as clustering and differential expression analyses. The debris score, however, cannot be assumed to exist on the same scale in independent experiments. The scores are normalized relative to the best and worst cluster means within the sample. Thus, when integrating multiple samples, the debris scores may not be comparable, particularly if the distribution of extranuclear RNA is different across the samples. Finally, the scoring approach relies on accurate estimation of debris-enriched genes. If there are little or no genes that are increased in the background distribution, the resulting debris score will likely be inaccurate. Although we found that the debris scores in all 8 snRNA-seq experiments were correlated with the level of extranuclear contamination as measured by the percent of reads spliced, this was less successful in the PBMC single-cell RNA-seq data. This may be due to smaller differences between the background and cell type profiles in scRNA-seq.</p>
    <p id="Par25">Since we found that extranuclear RNA contamination exists across a wide range of UMI counts, using a hard count threshold underperformed in comparison to EmptyDrops and DIEM. Both DIEM and EmptyDrops<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> remove droplets based on their expression distribution. When compared to the EmptyDrops method<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, however, we found that DIEM had a higher accuracy in filtering heterogeneous snRNA-seq data sets as assessed by the percent of reads that are spliced as a metric of extranuclear RNA. EmptyDrops, however, was originally developed and tested on single cell data and thus, the assumptions behind the model are different than that of DIEM. EmptyDrops only models the background RNA distribution and uses Monte Carlo sampling to determine how significant the deviation of a droplet is from it. It also safeguards from removing cell-types that are similar to the background by assuming that all droplets above a calculated knee point are true cell-containing droplets. DIEM directly models cell types by clustering and this may allow for more accurate grouping of debris droplets. We have shown that the difference between the cell types and the debris are within the same order of magnitude as the differences between the cell types, highlighting the need to account for heterogeneity. We found that both EmptyDrops and the quantile approach removed more nuclear droplets and kept a higher proportion of contaminated droplets, but the major adipose cell types were still identified. However, since the DIEM-filtered droplets contained less extranuclear contamination, the resulting clusters were also characterized by less debris on average. This is beneficial for both accurate cell type clustering and identification.</p>
    <p id="Par26">Even though snRNA-seq recovers less RNA than scRNA-seq and thus retrieves less information about cell types, there are advantages to using nuclei over cells. For example, snRNA-seq has been shown to reduce dissociation biases present in scRNA-seq, leading to more accurate profiling of cell types in tissue<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Another important reason to use snRNA-seq is that scRNA-seq may be practically impossible. This can occur with frozen tissues, since thawing cells is known to lyse the outer membranes and preclude a suspension of single cells required for droplet-based technologies<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. This prevents the application of scRNA-seq to biobanked snap-frozen human tissues. In order to leverage existing, phenotyped human datasets with biobanked tissues, snRNA-seq may be the only viable option to profile cell types. We have shown that snRNA-seq of frozen tissue results in contamination of droplets across a large range of UMI counts, making it difficult to remove background debris while maintaining an accurate cell type composition of the tissue. Even from fresh tissue and cells, we still observed downstream clusters affected by the extranuclear RNA. Therefore, we expect DIEM to help produce cleaner snRNA-seq data sets from a variety of input sources, but especially from frozen tissues.</p>
    <p id="Par27">We focused the application of our approach on snRNA-seq data because there is a pressing need for debris filtering in data sets with lower RNA content. In single-cell RNA-seq, the higher RNA content of cells typically allows the total UMI count of a droplet to serve as a sufficient discriminator between debris and cells<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, although this may not always be the case<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. However, running scRNA-seq on fresh human tissue at a large scale may be prohibitively difficult considering the requirement to immediately process a fresh biopsy for scRNA-seq. Therefore, snRNA-seq of frozen tissues offers a viable alternative to process samples at a higher throughput. Our method was designed to computationally remove background debris contamination from snRNA-seq data of frozen tissues. We expect that DIEM will enable the analysis of a larger number of samples from frozen tissue snRNA-seq data, thereby removing the need to coordinate the acquisition of fresh tissue samples and processing of single cell libraries.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Single-nucleus RNA-seq of human subcutaneous adipose tissue, differentiating preadipocytes, and mouse brain</title>
      <p id="Par28">Frozen subcutaneous adipose tissue was processed separately for each of the 6 samples. Tissue was minced over dry ice and transferred into ice-cold lysis buffer consisting of 0.1% IGEPAL, 10 mM Tris–Hcl, 10 mM NaCl, and 3 mM MgCl<sub>2</sub>. After a 10 min incubation period, the lysate was gently homogenized using a dounce homogenizer and filtered through a 70 μm MACS smart strainer (Miltenyi Biotec #130-098-462) to remove debris. Nuclei were centrifuged at 500×<italic>g</italic> for 5 min at 4 °C and washed in 1 ml of resuspension buffer (RSB) consisting of 1X PBS, 1.0% BSA, and 0.2 U/μl RNase inhibitor. We further filtered nuclei using a 40 μm Flowmi cell strainer (Sigma Aldrich # BAH136800040) and centrifuged at 500×<italic>g</italic> for 5 min at 4 °C. Pelleted nuclei were re-suspended in wash buffer and immediately processed with the 10X Chromium platform following the Single Cell 3′ v2 protocol. After library generation with the 10X platform, libraries were sequenced on an Illumina NovaSeq S2 at a sequencing depth of 50,000 reads per cell. Reads were aligned to the GRCh38 human genome reference with Gencode v26 gene annotations<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> using the 10X CellRanger 2.1.1 pipeline. A custom pre-mRNA reference was generated to account for unspliced mRNA by merging all introns and exons of a gene into a single meta-exon.</p>
      <p id="Par29">We obtained and cultured the primary human white preadipocyte cells as recommended by PromoCell (PromoCell C-12731, lot 395Z024) for preadipocyte growth and differentiation into adipocytes. Cell media (PromoCell) was supplemented with 1% penicillin–streptomycin. We maintained the cells at 37 °C in a humidified atmosphere at 5% CO2. On day 6 of differentiation, we rinsed the cells with 1 × PBS and added ice-cold lysis buffer (3 mM MgCl<sub>2</sub>, 10 mM Tris–HCl, 0.5% Igepal CA-630, 10 mM NaCl). The cells were gently scraped from the plate and centrifuged at 500×<italic>g</italic> for 5 min at 4 °C. Nuclei were washed with 1 ml of resuspension buffer (RSB; 1% BSA, 100 μl RNase inhibitor in 1 × PBS) and centrifuged again to remove cellular debris. After the second centrifugation, nuclei were washed with 1 ml RSB and filtered through a 40 μm filter. Cells were counted, then centrifuged again and resuspended in the proper volume of RSB to obtain 2000 nuclei/μl. The 10X library preparation, sequencing, and data processing were done using the same protocol as for the adipose tissue.</p>
      <p id="Par30">For the mouse brain data, we downloaded the raw UMI count data matrix from the 10X website. The data set titled “2K Brain Nuclei from an Adult Mouse (&gt; 8 weeks)” was downloaded from <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/nuclei_2k">https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/nuclei_2k</ext-link>. The 10X human 68K PBMC data were downloaded from <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/fresh_68k_pbmc_donor_a">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/fresh_68k_pbmc_donor_a</ext-link>.</p>
    </sec>
    <sec id="Sec12">
      <title>Filtering droplets using a quantile threshold, EmptyDrops, and DIEM</title>
      <p id="Par31">Common methods for removing debris from snRNA-seq data rely on using a hard count threshold<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. In the three data sets, we applied a quantile-based cutoff, similar to that implemented by the 10X CellRanger software. Droplets are ranked in decreasing order of total counts. The 99th percent quantile of the top <italic>C</italic> barcodes of total counts is divided by 10 to obtain the threshold <italic>T</italic>, where <italic>C</italic> is 3,000 for our analyses<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The 99th percentile is used to exclude any doublets from the derivation. Droplets with greater than or equal to <italic>T</italic> counts were included as nuclei. For comparison with EmptyDrops<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, we ran the method using default parameters. EmptyDrops calculates a Monte Carlo p-value that gives the probability that a droplet’s expression profile is the same as that of the ambient RNA. We removed droplets with a false discovery rate (FDR) q value greater than 0.05. For the six adipose tissue samples, we applied filtering to each sample independently, as these are the result of individual experiments. We also tested DIEM filtering after combining the counts in the 6 adipose tissue samples and observed similar results (Fig. <xref rid="MOESM1" ref-type="media">S14</xref>).</p>
    </sec>
    <sec id="Sec13">
      <title>Estimating extranuclear RNA contamination in droplets from snRNA-seq</title>
      <p id="Par32">We used three metrics to estimate contamination of background RNA in the snRNA-seq data sets. We quantified the fraction of spliced reads using velocyto<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. The BAM files from CellRanger were sorted by barcode ID using samtools<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, and spliced, unspliced, and ambiguous read counts were quantified for each gene. We then removed mitochondria (MT) reads to avoid confounding of the estimates, as the MT genes do not have introns. For each droplet, the unspliced and spliced UMI counts were added, and the percent of reads spliced was calculated as the fraction of all spliced reads over the sum of spliced and unspliced reads. We calculated the percent of UMIs aligned to the mitochondria (MT%) as the sum of reads aligned to the mitochondrial genome over the droplet’s total UMI counts. The percent of UMIs aligned to <italic>MALAT1</italic> (MALAT1%) was calculated similarly.</p>
      <p id="Par33">We classified droplets as background or nuclear according to their percent of reads spliced. Since this metric showed a bimodal distribution that was distinct in each sample, we calculated the midpoint between the two distributions. To do so, we modeled the percent of reads spliced as a mixture of two gaussians. We fit the parameters using EM with the R package mixtools<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Then, the midpoint was calculated as the value in which the probability density was equal in the two distributions. Droplets with a percent of reads spliced above and below the midpoint were classified as background and nuclear, respectively. For clusters, we specified those with an average percent of reads spliced of at least 50% as debris and classified those with less than 50% as nuclear, as we observed that 50% was the average value of the midpoint across the experiments and that the 6 adipose tissue samples were combined.</p>
    </sec>
    <sec id="Sec14">
      <title>Differential expression between nuclear-enriched and debris-enriched droplets</title>
      <p id="Par34">To identify genes differentially expressed (DE) between the background-enriched and nuclear-enriched groups, we set a hard count threshold to naively assign droplets to either group. Droplets with total UMI counts below 100 and greater than or equal to 100 were assigned to the background-enriched and nuclear-enriched groups, respectively. This ensures that the majority of droplets containing nuclei are found in the nuclear-enriched group. For each gene, reads were summed across all droplets in each of the two groups to estimate the RNA profiles. Read counts were normalized using trimmed mean of M-values (TMM) as implemented in edgeR<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. For identifying differentially expressed genes, we used a paired design with the six adipose tissue samples by treating the background-enriched and nuclear-enriched counts of an individual as a paired sample (total n = 12). We then used the edgeR package<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup> to run differential expression. We only kept genes with a counts per million (CPM) of greater than 0 in at least 6 of the 12 groups. Next, we used the estimateDisp function to estimate the dispersion with the paired design matrix. The quasi-likelihood fit and F test functions glmQLFit and glmQLFTest were used to calculate statistical significance. We adjusted for multiple testing using a Bonferroni-corrected p-value threshold of 0.05.</p>
      <p id="Par35">To identify DE genes between the debris and cell types, we used the clusters identified after quantile-based filtering to approximate the cell types. For each of the six samples, we subsampled the debris droplets (with total UMI counts less than 100) to 9,000 droplets to obtain a similar read depth as contained in the cell type groups. For the debris and cell type groups, reads were summed across the corresponding droplets to obtain the RNA profile used as input. Differential expression was performed by comparing debris vs. cell type or cell type vs. all other cell types using a paired design. The filtering and analysis was performed in the same manner as the debris vs. nuclear DE analysis above.</p>
    </sec>
    <sec id="Sec15">
      <title>DIEM algorithm</title>
      <p id="Par36">DIEM first assigns droplets as originating from debris or cell types, and then calculates the level of contamination within droplets using the debris-enriched genes. To assign droplets to either debris or cell types, our filtering approach models droplet-based single-cell or single-nucleus data with a mixture of multinomial distributions. Particularly, droplet read counts are assumed to follow a multinomial with parameters conditional on the cluster. However, the parameters and droplet assignments are unknown for the droplets of interest. In addition, it is assumed that the majority of low count droplets contain ambient RNA. Therefore, we estimate the parameters of the model using semi-supervised expectation maximization (EM)<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>. This allows us to calculate the probability of the latent group variable given the data, and thus group debris and cell type droplets. To initialize the parameters for EM, we cluster the droplets with k-means, where the number of cell types k is specified by the user. We include only droplets with at least 200 genes detected in this initialization step to avoid fitting clusters driven by empty debris droplets. After fitting the mixture model with EM, we calculate a debris score for each droplet based on the expression of genes enriched in the debris set.</p>
      <p id="Par37">In more detail, let <italic>X</italic> denote a <italic>g</italic> x <italic>N</italic> matrix containing the read/UMI counts from a single-cell or single-nucleus data set with <italic>g</italic> genes and <italic>N</italic> droplets. We include droplets with at least 1 read/UMI count. Our goal is to assign the <italic>N</italic> droplets into one of <italic>K</italic> + 1 groups (<italic>K</italic> cell types and debris). We define <italic>x</italic><sub><italic>i</italic></sub> as the <italic>i</italic>th column of <italic>X</italic> giving the counts of droplet <italic>i</italic> and assume that it follows a multinomial distribution with the gene probabilities <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\alpha }}_{{\varvec{k}}}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq1.gif"/></alternatives></inline-formula> = <italic>p</italic><sub><italic>1,k</italic></sub>, …, <italic>p</italic><sub><italic>G,k</italic></sub> conditional on group <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\in \{1,...,K, K+1\}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq2.gif"/></alternatives></inline-formula>. We model droplet expression using a multinomial distribution, and further model cell types and debris using a mixture of multinomials. The log-likelihood of the data is therefore:<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$logP({\varvec{X}}) ={\sum }_{i=1}^{N}log\left({\sum }_{k=1}^{K+1}{\pi }_{k}Mult({{\varvec{x}}}_{{\varvec{i}}}|{\boldsymbol{\alpha }}_{{\varvec{k}}},{u}_{i})\right)$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2020_67513_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par38">Here, <italic>u</italic><sub><italic>i</italic></sub> is the total number of read/UMI counts in droplet <italic>i</italic>, <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\alpha }}_{{\varvec{k}}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq3.gif"/></alternatives></inline-formula> contains the multinomial parameters for group <italic>k</italic>, <italic>π</italic><sub><italic>k</italic></sub> is the mixing coefficient for group <italic>k</italic>, and <italic>Mult</italic> denotes the probability mass function of the multinomial distribution. Since an analytical solution cannot be derived based on the likelihood of the model, we define <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i}\in \{1,...,K\}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq4.gif"/></alternatives></inline-formula> for each <italic>i</italic> as a latent indicator variable that describes the cell type or debris origin of the droplet. The complete log-likelihood of the data and the latent variables <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z={\left\{{z}_{i }\right\}}_{i=1}^{N}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="}" open="{" separators=""><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq5.gif"/></alternatives></inline-formula> now becomes:<disp-formula id="Equb"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$logP({\varvec{X}},{\varvec{Z}}) ={\sum }_{i=1}^{N}{\sum }_{k=1}^{K+1}{\mathbb{I}}\left\{{\mathrm{z}}_{\mathrm{i}}=\mathrm{k}\right\}[\mathrm{log}{\pi }_{k}+\mathrm{ log}Mult({{\varvec{x}}}_{{\varvec{i}}}|{\boldsymbol{\alpha }}_{{\varvec{k}}},{u}_{i})]$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:msub><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2020_67513_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par39">where <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{I}}\left\{{\mathrm{z}}_{\mathrm{i}}=\mathrm{k}\right\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:msub><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq6.gif"/></alternatives></inline-formula> is an indicator variable for the assignment of droplet i. This formulation allows us to employ an EM algorithm and estimate the parameters <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{1}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq7.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq8.gif"/></alternatives></inline-formula> and <italic>π</italic><sub><italic>1</italic></sub>, …, <italic>π</italic><sub><italic>k</italic></sub> by maximizing the expected complete data log-likelihood. The latent indicator variables for the debris droplets with UMI counts below 100 remain fixed, thus effectively resulting in a semi-supervised EM.</p>
      <p id="Par40">Although it is possible to remove droplets that contain a high posterior probability of belonging to the fixed debris cluster, we employ a scoring strategy to quantify the level of contamination within individual droplets. This provides both a finer resolution in debris filtering and a direct estimate that can be used as a covariate in downstream analysis.</p>
      <p id="Par41">Droplets are divided into a test set and a debris set. The test set consists of the droplets we would like to classify, while the debris set consists of droplets that we assume to contain debris with high probability. The labels of droplets in the debris set are fixed throughout the EM iterations, while those of the test set are allowed to change. We define the test set as those droplets with at least <italic>T</italic> total counts, where we set <italic>T</italic> to a default value of 100. Only expressed genes with a counts per million (CPM) &gt; 0 are included in the analysis.</p>
    </sec>
    <sec id="Sec16">
      <title>Initialization of parameters for EM</title>
      <p id="Par42">The EM algorithm requires starting values for the parameters of the model. The parameters <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\boldsymbol{\alpha }$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq9.gif"/></alternatives></inline-formula> and <bold><italic>π</italic></bold> are initialized from the PCs of the cluster set of droplets using k-means. A proper initialization is important because mixture models can be sensitive to local optima<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Therefore, we run k-means, which has been shown to provide reasonable initial values for EM<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>. As the test set may contain many more empty droplets than the droplets of interest, we further define a cluster set for k-means as those droplets with at least 200 genes detected <sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. K-means is run on the on the first 30 PCs of the data using the kmeans function in R. Before running PCA, we first select the top <italic>V</italic> = 2,000 variable genes<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. To do so, we first account for the relationship between the mean and variance<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. The mean and variance of the raw gene counts are calculated and log transformed. To learn the relationship, we fit a locally weighted smoothing (LOESS) regression line between the normalized mean and variance using the loess function in R with a span = 0.3. We correct the variance for the expression level of a gene by subtracting the fitted variance from the observed variance. Finally, we rank the genes by their standardized variance and take the top <italic>V</italic> = 2,000 genes. PCA is run on the normalized counts, where the total droplet read counts are scaled to sum to the median read depth and then log transformed. PCA is performed on the adjusted counts on the cluster set and the variable genes, and the top 30 principal components are returned. Finally, k-means is run on these PCs, with the number of cell types k specified by the user. We use k = 20 for all experiments in the manuscript, unless otherwise specified. The initial parameters are estimated from the droplets assigned to these resulting clusters.</p>
    </sec>
    <sec id="Sec17">
      <title>Estimation</title>
      <p id="Par43">The EM algorithm iteratively estimates the parameters and the posterior probabilities. Given <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\boldsymbol{\alpha }}$$\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\pi}}}$$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq11.gif"/></alternatives></inline-formula>, estimates of <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\boldsymbol{\alpha }$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq12.gif"/></alternatives></inline-formula> and <bold><italic>π</italic></bold>, we calculate the posterior probability that droplet <italic>X</italic><sub><italic>i</italic></sub> belongs to cluster <italic>k</italic><disp-formula id="Equc"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({z}_{i}=k \right|{\boldsymbol{ }{\varvec{x}}}_{{\varvec{i}}},{\widehat{\boldsymbol{\alpha }}}_{{\varvec{k}}},\widehat{{\varvec{\pi}}})=\frac{p\left({\widehat{{\varvec{\pi}}}}_{k}\right)p\left({{\varvec{x}}}_{{\varvec{i}}} \right| {{z}_{i}=k , \widehat{\boldsymbol{\alpha }}}_{{\varvec{k}}})}{{\sum }_{j=1}^{K}p\left({\widehat{{\varvec{\pi}}}}_{j}\right)p\left({{\varvec{x}}}_{{\varvec{i}}} \right| {{z}_{i}=j,\widehat{\boldsymbol{\alpha }}}_{{\varvec{j}}})}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close="|" open="(" separators=""><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mfenced><mml:msub><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close="|" open="(" separators=""><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close="|" open="(" separators=""><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="41598_2020_67513_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par44">where <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({X}_{i} \right| {{Z}_{i} , \alpha }_{k})$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close="|" open="(" separators=""><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq13.gif"/></alternatives></inline-formula> follows the multinomial given the parameters <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\alpha }}_{{\varvec{k}}}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq14.gif"/></alternatives></inline-formula> for cluster <italic>k</italic> and <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({\pi }_{k}\right)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq15.gif"/></alternatives></inline-formula> follows a categorical distribution. The debris droplets with total counts below <italic>T</italic> = 100 have their <italic>z</italic><sub><italic>i</italic></sub> values kept fixed to the debris group. The maximum likelihood estimate of <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\alpha }}_{{\varvec{k}}}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq16.gif"/></alternatives></inline-formula> is calculated as the mean of the droplet counts weighted by their posterior probability of belonging to cluster <italic>k</italic>. We add a pseudocount of 10<sup>−10</sup> to avoid collapsing the likelihood to 0. For <italic>π</italic><sub><italic>k</italic></sub>, the maximum likelihood estimate is calculated as the sum of <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({\varvec{Z}}=k \right| {\varvec{X}})$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close="|" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mfenced><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_67513_Article_IEq17.gif"/></alternatives></inline-formula> divided by the total number of droplets, so that <italic>π</italic><sub><italic>1</italic></sub>, …, <italic>π</italic><sub><italic>K</italic></sub> sum to one. These two steps iterate during EM, and the algorithm converges when the change in parameters is below ε, which we set to 10<sup>−4</sup>. Droplets are assigned to the cluster that gives the maximum posterior probability.</p>
    </sec>
    <sec id="Sec18">
      <title>Debris scoring and filtering of individual droplets</title>
      <p id="Par45">We assign a debris score to individual droplets to obtain a finer estimate of the amount of contamination. After clustering, we specify the set of debris clusters as the fixed cluster as well as any clusters that have an average number of genes detected less than <italic>d</italic>, where we set <italic>d</italic> to 200. The cell type group then consists of all other clusters. We estimate the debris score by summing a droplet’s expression values of genes enriched in this debris set. To identify debris-enriched genes, we first run a Welch’s t-test between the test set droplets in the debris and cell type clusters. Read counts are normalized by scaling the counts to sum to 1 and then log normalizing after adding a constant of 1. Then, genes with a log fold change greater than 0 and an FDR-corrected p-value less than 0.05 are specified as debris-enriched genes.</p>
      <p id="Par46">The debris score is estimated by summing the normalized expression values of the debris-enriched genes. Since the magnitude of this score is dependent on the number and expression of the debris-enriched genes, we scale the scores. We calculate the mean of all clusters, subtract the scores by the lowest cluster average, and divide them by average of the droplets in the debris cluster(s). This has the effect of setting the average of the lowest cluster to 0 and the debris cluster(s) to 1, so that scores are scaled relative to these clusters. Droplets in the snRNA-seq experiments are filtered using a threshold for the debris score. We keep droplets with a normalized debris score below <italic>t</italic>, where we set <italic>t</italic> to 0.5, although we note that these can be adjusted by the user accordingly.</p>
    </sec>
    <sec id="Sec19">
      <title>Identifying cell types after filtering droplets</title>
      <p id="Par47">For all experiments, we ran a standardized clustering pipeline using Seurat v3.1.2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. After applying filtering, we only considered droplets with at least 200 genes detected <sup><xref ref-type="bibr" rid="CR4">4</xref></sup> to ensure that each droplet had enough information for clustering. The count data were log-normalized using the NormalizeData function in Seurat, using a scaling factor equal to the median of total counts across droplets. For the six adipose tissue samples, we used a scaling factor equal to 1,000 to ensure that all samples were normalized equally. Additionally, we merged the normalized data of the six adipose tissue samples without batch correction, as we saw high overlap of clusters among the six samples (data not shown). The top 2,000 variable genes were then calculated using the FindVariableFeatures function.</p>
      <p id="Par48">Normalized read counts for each gene were scaled to mean 0 and variance 1. We calculated the first 30 PCs to use as input for clustering. We then ran the Seurat functions FindNeighbors and FindClusters with 30 PCs. In the FindClusters function, we used the default parameters with standard Louvain clustering and a default clustering resolution of 0.8, unless otherwise stated. For visualization, we ran UMAP<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> on the 30 PCs with default values. To identify marker genes for each cluster, we ran a Wilcoxon rank-sum test using the function FindAllMarkers with default parameters and only.pos = TRUE. We corrected for multiple testing using a false discovery rate (FDR) threshold of 0.05. Clusters were classified as doublets if the top marker genes consisted of an identifiable mixture of top markers between two cell types.</p>
    </sec>
    <sec id="Sec20">
      <title>Ethics approval and consent to participate</title>
      <p id="Par49">All research was performed in accordance with the relevant institutional guidelines and regulations. Each of the 6 participants gave a written informed consent. The study protocol was approved by the Ethics Committee at the Helsinki University Hospital, Helsinki, Finland.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_67513_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary file1 (PDF 5748 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Marcus Alvarez and Elior Rahmani.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-67513-5.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Finnish individuals who participated in the adipose tissue study, as well as Jaakko Kaprio and Aila Rissanen for their contributions. We also thank the Finnish Institute for Molecular Medicine Single Cell Analytics Core for performing library preparation and sequencing for the adipose tissue samples. This study was funded by the National Institutes of Health (NIH) grants HL-095056, HL-28481, and U01 DK105561. M.A. was supported by the HHMI Gilliam Fellowship and the NIH T32HG002536. JRP, JNB and PP were supported by an NIH DK41301 grant. E.H., B.J., and E.R. were partially supported by the National Science Foundation (Grant No. 1705197). E.H., E.R., and B.J. were partially supported by NIH/NHGRI HG010505-02. E.H. was also partially funded by NIH 1R56MD013312, NIH 1R01MH115979, NIH 5R25GM112625, and NIH 5UL1TR001881. B.J. was supported by the National Science Foundation Graduate Research Fellowship Program under Grant No. DGE-1650604. K.M.G. was supported by the NIH F31HL142180. Z.M was supported by the AHA grant 19PRE34430112. K.H.P. was supported by the Academy of Finland (272376, 266286, 314383, 315035), Finnish Medical Foundation, Finnish Diabetes Research Foundation, Novo Nordisk Foundation, Gyllenberg Foundation, Sigrid Juselius Foundation, Helsinki University Hospital Research Funds, Government Research Funds and University of Helsinki. J.N.B. was supported by the DDRC Pilot and Feasibility of the National Institutes of Health under award number DKP3041301 and the National Center for Advancing Translational Sciences at UCLA, CTSI Grant ULTR001881.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>M.A., E.R., E.H., and P.P. conceived the study and designed the analysis. M.A., K.M.G., and J.B. designed, performed, and interpreted nuclei isolation experiments. M.A. and K.M.G. designed and performed snRNA-seq experiments and collected data. M.A., E.R. B.J., Z.M., K.M.G., and J.B. analyzed and interpreted snRNA-seq data. M.A., E.R., E.H. and P.P designed the DIEM method. J.R.P., C.J.Y., K.H.P. and P.P. designed and supervised nuclei isolation and snRNA-seq experiments. M.A., E.R., B.J., Z.M., E.H., and P.P. wrote the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The human single nucleus RNA-seq datasets generated and analyzed during the current study are available upon request from the corresponding author. The DIEM program is freely available for use at <ext-link ext-link-type="uri" xlink:href="https://github.com/marcalva/diem">https://github.com/marcalva/diem</ext-link>. The code for the analysis is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/marcalva/DIEM2019">https://github.com/marcalva/DIEM2019</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par50">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>e4.346</fpage>
        <lpage>e4.360</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habib</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel single-nucleus RNA-seq with DroNc-seq</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>955</fpage>
        <lpage>958</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4407</pub-id>
        <pub-id pub-id-type="pmid">28846088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habib</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Div-Seq: single-nucleus RNA-seq reveals dynamics of rare adult newborn neurons</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>925</fpage>
        <lpage>928</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aad7038</pub-id>
        <pub-id pub-id-type="pmid">27471252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krishnaswami</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using single nuclei for RNA-seq to capture the transcriptome of postmortem neurons</article-title>
        <source>Nat. Protoc.</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>499</fpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2016.015</pub-id>
        <pub-id pub-id-type="pmid">26890679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kessenbrock</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Experimental considerations for single-cell RNA sequencing approaches</article-title>
        <source>Front. Cell Dev. Biol.</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>108</fpage>
        <pub-id pub-id-type="doi">10.3389/fcell.2018.00108</pub-id>
        <pub-id pub-id-type="pmid">30234113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting cell-type composition and activity-dependent transcriptional state in mammalian brains by massively parallel single-nucleus RNA-Seq</article-title>
        <source>Mol. Cell</source>
        <year>2017</year>
        <volume>68</volume>
        <fpage>1006</fpage>
        <lpage>1015.e7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.11.017</pub-id>
        <pub-id pub-id-type="pmid">29220646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lacar</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nuclear RNA-seq of single neurons reveals molecular signatures of activation</article-title>
        <source>Nat. Commun.</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>1586</fpage>
        <lpage>1590</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf1204</pub-id>
        <pub-id pub-id-type="pmid">27339989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-nucleus RNA-seq of differentiating human myoblasts reveals the extent of fate heterogeneity</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e158</fpage>
        <?supplied-pmid 27566152?>
        <pub-id pub-id-type="pmid">27566152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EmptyDrops: distinguishing cells from empty droplets in droplet-based single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>63</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1662-y</pub-id>
        <pub-id pub-id-type="pmid">30902100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>APP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J. R. Stat. Soc.</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>What is the expectation maximization algorithm?</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>897</fpage>
        <lpage>899</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1406</pub-id>
        <pub-id pub-id-type="pmid">18688245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nigam</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mccallum</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Thrun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Text classification from labeled and unlabeled documents using EM</article-title>
        <source>Mach. Learn.</source>
        <year>2000</year>
        <volume>39</volume>
        <fpage>103</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1007692713085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-016-0009-6</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>560</volume>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miyagawa</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of cis- and trans-acting factors involved in the localization of MALAT-1 noncoding RNA to nuclear speckles</article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>738</fpage>
        <lpage>741</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.028639.111</pub-id>
        <pub-id pub-id-type="pmid">22355166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Evolution of hemoglobin and its genes</article-title>
        <source>Cold Spring Harbor Perspect. Med.</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>a011627</fpage>
        <lpage>a011627</lpage>
        <pub-id pub-id-type="doi">10.1101/cshperspect.a011627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ziegler-Heitbrock</surname>
            <given-names>HWL</given-names>
          </name>
          <name>
            <surname>Ulevitch</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>CD14: cell surface receptor and differentiation marker</article-title>
        <source>Immunol. Today</source>
        <year>1993</year>
        <volume>14</volume>
        <fpage>121</fpage>
        <lpage>125</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-5699(93)90212-4</pub-id>
        <pub-id pub-id-type="pmid">7682078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kirita</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Humphreys</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <article-title>Advantages of single-nucleus over single-cell RNA sequencing of adult kidney: rare cell types and novel cell states revealed in fibrosis</article-title>
        <source>J. Am. Soc. Nephrol.</source>
        <year>2019</year>
        <volume>30</volume>
        <fpage>23</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1681/ASN.2018090912</pub-id>
        <pub-id pub-id-type="pmid">30510133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D766</fpage>
        <lpage>D773</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky955</pub-id>
        <pub-id pub-id-type="pmid">30357393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chauveau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Mixtools: an R package for analyzing finite mixture models</article-title>
        <source>J. Stat. Softw.</source>
        <year>2009</year>
        <volume>32</volume>
        <fpage>1</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v032.i06</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biernacki</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Celeux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Govaert</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Choosing starting values for the EM algorithm for getting the highest likelihood in multivariate Gaussian mixture models</article-title>
        <source>Comput. Stat. Data Anal.</source>
        <year>2003</year>
        <volume>41</volume>
        <fpage>561</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="doi">10.1016/S0167-9473(02)00163-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brusco</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Evaluating mixture modeling for clustering: recommendations and cautions</article-title>
        <source>Psychol. Methods</source>
        <year>2011</year>
        <volume>16</volume>
        <fpage>63</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1037/a0022673</pub-id>
        <pub-id pub-id-type="pmid">21319900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SX</given-names>
          </name>
          <name>
            <surname>Rathnayake</surname>
            <given-names>SI</given-names>
          </name>
        </person-group>
        <article-title>Finite mixture models</article-title>
        <source>Annu. Rev. Stat. Appl.</source>
        <year>2019</year>
        <volume>6</volume>
        <fpage>355</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-statistics-031017-100325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>1095</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1874-1</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>38</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
