<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7195715</article-id>
    <article-id pub-id-type="publisher-id">3506</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-3506-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Negative binomial additive model for RNA-Seq data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Xu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kuan</surname>
          <given-names>Pei-Fen</given-names>
        </name>
        <address>
          <email>peifen.kuan@stonybrook.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2216 9681</institution-id><institution-id institution-id-type="GRID">grid.36425.36</institution-id><institution>Department of Applied Mathematics and Statistics, Stony Brook University, </institution></institution-wrap>Stony Brook, 11794 NY USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>171</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">High-throughput sequencing experiments followed by differential expression analysis is a widely used approach for detecting genomic biomarkers. A fundamental step in differential expression analysis is to model the association between gene counts and covariates of interest. Existing models assume linear effect of covariates, which is restrictive and may not be sufficient for certain phenotypes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We introduce NBAMSeq, a flexible statistical model based on the generalized additive model and allows for information sharing across genes in variance estimation. Specifically, we model the logarithm of mean gene counts as sums of smooth functions with the smoothing parameters and coefficients estimated simultaneously within a nested iterative method. The variance is estimated by the Bayesian shrinkage approach to fully exploit the information across all genes.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Based on extensive simulations and case studies of RNA-Seq data, we show that NBAMSeq offers improved performance in detecting nonlinear effect and maintains equivalent performance in detecting linear effect compared to existing methods. The vignette and source code of NBAMSeq are available at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/NBAMSeq.html">http://bioconductor.org/packages/release/bioc/html/NBAMSeq.html</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Bayesian shrinkage</kwd>
      <kwd>Differential expression analysis</kwd>
      <kwd>Generalized additive model</kwd>
      <kwd>RNA-Seq</kwd>
      <kwd>Spline model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000125</institution-id>
            <institution>National Institute for Occupational Safety and Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01 OH011478</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <sec id="Sec2">
      <title>Introduction</title>
      <p>In recent years, RNA-Seq experiments have become the state-of-the-art method for quantifying mRNAs levels by measuring gene expression digitally in biological samples. An RNA-Seq experiment usually starts with isolating RNA sequences from biological samples using the Illumina Genome Analyzer, a commonly used platform for high-throughput sequencing data. These mRNA sequences are reverse transcribed into cDNA fragments. To reduce the sequencing cost and increase the speed of reading the cDNA fragments (typically a few thousands bp), these fragments are sheared into short reads (50-450 bp). These reads are mapped back to the original reference genomes/transcriptomes and the number of read counts mapping to each gene/transcript region are computed. RNA-Seq experiments are usually summarized as a count table with each row representing a gene/transcript and each column representing a sample.</p>
      <p>An important aspect of statistical inference in RNA-Seq data is the differential expression (DE) analysis, which is to perform statistical test on each gene to ascertain whether it is DE or not. Several methods have been developed for DE test using gene counts data, including DESeq2 [<xref ref-type="bibr" rid="CR1">1</xref>], edgeR [<xref ref-type="bibr" rid="CR2">2</xref>], which are based on negative binomial regression model; voom [<xref ref-type="bibr" rid="CR3">3</xref>], which is based on empirical Bayes model and BBSeq [<xref ref-type="bibr" rid="CR4">4</xref>], which is based on beta-binomial regression model. DESeq2 [<xref ref-type="bibr" rid="CR1">1</xref>] performs DE analysis in a three-step procedure. The normalization factors for sequencing depth adjustment are first estimated using median-to-ratio method. Both the coefficients and the dispersion parameters in negative binomial distribution are estimated by the Bayesian shrinkage approach to effectively borrow the information across all genes. Finally, the Wald tests or the likelihood ratio tests are performed to identify DE genes. edgeR also uses the negative binomial distribution to model gene counts. It assumes that the variance of gene counts depends on two dispersion parameters, namely the negative binomial dispersion and the quasi-likelihood dispersion. The negative binomial dispersion is estimated by fitting a mean-dispersion trend across all genes whereas the quasi-likelihood dispersion are estimated by Bayesian shrinkage approach [<xref ref-type="bibr" rid="CR5">5</xref>]. The DE statistical tests are conducted based on either the likelihood ratio tests [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] or the quasi-likelihood F-tests [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Both the DESeq2 and edgeR are widely used due in part to their shrinkage estimators which can improve the stability of DE test in a large range of RNA-Seq data or other technologies that generates read counts genomics data. voom [<xref ref-type="bibr" rid="CR3">3</xref>] is an alternative tool for DE analysis. It estimates the mean-variance relationship of the log-counts non-parametrically, followed by the limma empirical Bayes analysis pipeline [<xref ref-type="bibr" rid="CR10">10</xref>]. On the other hand, BBSeq [<xref ref-type="bibr" rid="CR4">4</xref>] assumes that the count data follows a beta-binomial distribution where the beta distribution is parameterized in a way such that the variance accounts for over dispersion. The parameters are estimated by the maximum likelihood approach and DE analysis is based on either the Wald test or the likelihood ratio test. Both the negative binomial and beta-binomial regression models belong to the generalized linear model (GLM) class. GLM is popular owing to the ease of implementation and interpretation, by assuming the link function is a linear combination of covariates. However, as illustrated in the motivating dataset below, the linearity assumption is not always appropriate and nonlinear models for linking the phenotype to gene expression in RNA-Seq data may be important. Stricker et al. (2017) [<xref ref-type="bibr" rid="CR11">11</xref>] proposed GenoGAM, which is a generalized additive model for ChIP-Seq data. However, GenoGAM was developed for a different purpose, i.e., the nonlinear component was to smooth the read count frequencies across genome, and not for relating a nonlinear association between the phenotype and read counts.</p>
      <p>In this paper, we introduce NBAMSeq, a generalized additive model for RNA-Seq data. NBAMSeq brings together the negative binomial additive model [<xref ref-type="bibr" rid="CR12">12</xref>] and information sharing across genes for variance estimation which enhances the power for detecting DE genes, since treating each gene independently suffers from power loss due to the high uncertainty of variance, especially when the sample size is small [<xref ref-type="bibr" rid="CR1">1</xref>]. By borrowing information across genes, NBAMSeq is able to model the nonlinear association while improving the accuracy of variance estimation and shows significant gain in power for detecting DE genes when the nonlinear relationship exists.</p>
    </sec>
    <sec id="Sec3">
      <title>Motivating datasets</title>
      <p>We start our exposition by demonstrating the existence of nonlinear relationship between gene counts and covariates/phenotypes of interest via three simple models and comparing them using ANOVA F-test. Two real RNA-Seq datasets are used. The first dataset is obtained from The Cancer Genome Atlas (TCGA) consortium, a rich repository consisting of high-throughput sequencing omics data for multiple types of cancers; downloadable from the Broad GDAC Firehose. For ease of exposition, we focus on the Glioblastoma multiforme (GBM), an aggressive form of brain cancer. The dataset consists of RNA-Seq count data on 20,501 genes and 158 samples generated using the Illumina HiSeq2000 platform. 16,092 genes were retained after filtering for genes with more than 10 samples having count per million (CPM) less than one. Gene counts are normalized using median-of-ratios as described in DESeq [<xref ref-type="bibr" rid="CR13">13</xref>] and DESeq2 to account for different library sizes across all samples. Age has been identified as an important prognostic marker for malignant cancers including GBM [<xref ref-type="bibr" rid="CR14">14</xref>]. To better understand the prognostic value of age in GBM, here we aim to identify age specific gene expression signature. For each individual gene <italic>i</italic>, three models were fitted: (i) base model: <italic>y</italic><sub><italic>ij</italic></sub>=<italic>β</italic><sub>0</sub>+<italic>β</italic><sub>1</sub><italic>x</italic><sub>1<italic>j</italic></sub>+<italic>β</italic><sub>2</sub><italic>x</italic><sub>2<italic>j</italic></sub>, (ii) linear model: <italic>y</italic><sub><italic>ij</italic></sub>=<italic>β</italic><sub>0</sub>+<italic>β</italic><sub>1</sub><italic>x</italic><sub>1<italic>j</italic></sub>+<italic>β</italic><sub>2</sub><italic>x</italic><sub>2<italic>j</italic></sub>+<italic>β</italic><sub>3</sub><italic>x</italic><sub>3<italic>j</italic></sub>, (iii) cubic spline regression with 3 knots: <italic>y</italic><sub><italic>ij</italic></sub>=<italic>β</italic><sub>0</sub>+<italic>β</italic><sub>1</sub><italic>x</italic><sub>1<italic>j</italic></sub>+<italic>β</italic><sub>2</sub><italic>x</italic><sub>2<italic>j</italic></sub>+<italic>f</italic>(<italic>x</italic><sub>3<italic>j</italic></sub>), where <italic>y</italic><sub><italic>ij</italic></sub> denotes logarithm transformed normalized counts of sample <italic>j</italic> and <italic>x</italic><sub>1<italic>j</italic></sub>,<italic>x</italic><sub>2<italic>j</italic></sub> and <italic>x</italic><sub>3<italic>j</italic></sub> denotes gender, race (Caucasian versus non-Caucasian) and age, respectively. We compared the three models using ANOVA F-test, and the <italic>p</italic>-values are adjusted using the Benjamini and Hochberg (1995) [<xref ref-type="bibr" rid="CR15">15</xref>] false discovery rate (FDR). The test statistics, degrees of freedom in F-statistics and number of significant genes at FDR &lt;0.05 are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. 250 genes are significant when comparing model (i) to model (iii). We further investigated the <italic>p</italic>-values of these 250 genes when comparing model (i) to model (ii) and found that 30 out of these 250 genes have FDR &gt;0.2 (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), implying that a simple linear regression is unable to identify these 30 genes even if a less stringent FDR threshold is used. Moreover, 9 genes are significant when comparing model (ii) to model (iii). Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the scatterplots of counts versus age of the most significant genes. For visualization, a local regression is fitted on each scatterplot, suggesting significant nonlinear relationships between normalized gene counts and age. Although only GBM is shown here, we observed similar nonlinear age effect for other types of cancer from Broad GDAC Firehose database (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Nonlinear relationship between gene counts and age in TCGA GBM data</p></caption><graphic xlink:href="12859_2020_3506_Fig1_HTML" id="MO1"/></fig></p>
      <p>The second dataset comes from our study of gene expression associated with posttraumatic stress disorder (PTSD) in the World Trade Center (WTC) responders [<xref ref-type="bibr" rid="CR16">16</xref>]. The dataset consists of RNA-Seq read counts of 25,830 genes in whole blood profiled in 324 WTC male responders. The phenotype of interest is the Posttraumatic Stress Disorder Checklist-Specific Version (PCL), a self-report questionnaire assessing the severity of WTC-related DSM-IV PTSD symptoms [<xref ref-type="bibr" rid="CR17">17</xref>]. To better understand the nonlinear effect of PTSD severity on gene expression, here we aim to identify gene expression signature related to PCL score. The gene filtering criterion and normalization method are similar to the framework used in the first motivating dataset and samples with missing clinical information were omitted from the analysis. 16,193 genes and 321 samples were retained for DE analysis. In addition, cell type proportions have been implicated in the analysis of whole blood samples. The proportions of CD8T, CD4T, natural killer, B-cell and monocytes were estimated as described in our previous paper [<xref ref-type="bibr" rid="CR18">18</xref>]. Similar to the first motivating dataset, the base model, linear model, and cubic spline regression model were fitted on each gene to study the effect of PCL score. Age, race, cell proportions of CD8T, CD4T, natural killer, B-cell and monocytes were adjusted in each model. When comparing the cubic spline regression model with base model using ANOVA F-test, 6 genes are significant at FDR &lt;0.05. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 shows the scatterplots of counts versus PCL score of these 6 genes. These plots show a consistent nonlinear pattern, i.e., gene expression first decrease and then gradually increase with the minimum at around PCL score 30.</p>
      <p>These observations indicate that the relationship between gene counts and covariate of interest may be nonlinear, and it can be challenging to capture the true underlying nonlinear relationship using parametric methods. Thus, more flexible statistical methods to characterize the nonlinear pattern in RNA-Seq data will improve the DE analysis of complex phenotypes. Negative binomial distribution has been shown to be a powerful model because it captures the over-dispersion of the nature of the count data generated by RNA-Seq experiments [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. To this end, we propose a negative binomial additive model to capture the nonlinear association in RNA-Seq data analysis.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Implementation</title>
    <p>NBAMSeq is implemented in R and its general work flow is summarized in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The foundations of generalized additive model, model fitting algorithm, parameter estimation, and statistical inference are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Information A. NBAMSeqDataSet is an R class used by NBAMSeq to store the count data and the estimated parameters during statistical analysis. To make NBAMSeq interoperable with other Bioconductor packages and facilitate downstream analysis of results, NBAMSeqDataSet is inherited from the Bioconductor core class SummarizedExperiment. Constructing a NBAMSeqDataSet object requires an RNASeq count matrix, a data frame which contains covariates of interest, and a design formula which specifies how to model the samples.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The workflow for NBAMSeq</p></caption><graphic xlink:href="12859_2020_3506_Fig2_HTML" id="MO2"/></fig></p>
    <p>DE analysis is performed by NBAMSeq function which takes NBAMSeqDataSet objects as input. NBAMSeq function contains a few internal steps. The initial smoothing parameters, gene-wise dispersions, and coefficients of the covariates are estimated by gam function in mgcv [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. These estimated values are saved in the NBAMSeqDataSet object to facilitate model fitting in the next steps. When using the gam function, to enforce smoother models we set the gamma argument to be 2.5 as the default value. The rationale of this default value is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 and S5. The dispersion trend and maximum a posterior (MAP) dispersions are estimated by estimateDispersionsFit and estimateDispersionsMAP functions in DESeq2. The final coefficients are estimated by gam function again, where the smoothing parameters and initial values of coefficients are the previously saved values in the NBAMSeqDataSet object. To speed up these steps, parallel computing is supported by using parallel = TRUE option in the NBAMSeq function.</p>
    <p>The DE test results can be obtained by the results function which takes the NBAMSeqDataSet after model fitting as input. The results can be visualized by the makeplot function.</p>
  </sec>
  <sec id="Sec5" sec-type="results">
    <title>Results</title>
    <sec id="Sec6">
      <title>Simulation</title>
      <p>To evaluate the performance of NBAMSeq, we designed simulation studies comparing NBAMSeq to DESeq2, edgeR and voom [<xref ref-type="bibr" rid="CR3">3</xref>], three of the most popular softwares for identifying DE genes in RNA-Seq data. Four scenarios were considered; the first was to evaluate the accuracy of dispersion estimates and power of detecting DE genes when the nonlinear effect is the true association. The second was to investigate the robustness of NBAMSeq when the linear effect is the true association. The third was to evaluate the error rate control when no gene is differentially expressed, and the last was to investigate the ability of NBAMSeq in differentiating DE genes with nonlinear from linear effect.</p>
      <p>In all scenarios, we assumed that the gene counts follow negative binomial distribution, i.e. <italic>K</italic><sub><italic>ij</italic></sub>∼NB(<italic>μ</italic><sub><italic>ij</italic></sub>,<italic>α</italic><sub><italic>i</italic></sub>),<italic>μ</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>j</italic></sub><italic>q</italic><sub><italic>ij</italic></sub>. For simplicity and without loss of generality, we set all normalization factors <italic>s</italic><sub><italic>j</italic></sub> to be 1. Since <italic>α</italic><sub><italic>i</italic></sub> decreases with increasing mean counts, we assumed that the true mean dispersion relationship is <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{i} = a/ \bar {\mu }_{i}+ 0.05$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.05</mml:mn></mml:math><inline-graphic xlink:href="12859_2020_3506_Article_IEq1.gif"/></alternatives></inline-formula>. The performance under different degrees of dispersion (<italic>a</italic>=1,3,5) were studied. In practice, although <italic>a</italic> could be larger than 5, the larger value of <italic>a</italic> is compensated by the larger mean counts. The magnitude of <italic>α</italic><sub><italic>i</italic></sub> is in similar scale regardless of <italic>a</italic>, and thus only <italic>a</italic>=1,3,5 were studied. The covariate of interest <italic>x</italic><sub><italic>j</italic></sub> was simulated from a uniform distribution U(<italic>u</italic><sub>1</sub>,<italic>u</italic><sub>2</sub>). For simplicity, we used <italic>u</italic><sub>1</sub>=20 and <italic>u</italic><sub>2</sub>=80 because 20 to 80 covers the range of age and PCL score in our motivating datasets.</p>
      <sec id="Sec7">
        <title>Scenario I</title>
        <p>The aim of this scenario was two-fold: (i) to evaluate the accuracy of NBAMSeq dispersion estimates when nonlinear effect is significant, and (ii) to investigate the power and error rate control of NBAMSeq.</p>
        <p>We simulated several count matrices which contain the same number of genes (<italic>n</italic>=15,000) across different sample sizes (<italic>m</italic> = 15, 20, 25, 30, 35, 40). We randomly selected 5% of the 15,000 genes to be DE. A comparison of other proportions of DE genes was given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 and S3, which shows that our proposed method is not sensitive to the DE proportions. Within each count matrix, the mean of negative binomial distribution <italic>μ</italic><sub><italic>ij</italic></sub> was simulated from
<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\eta_{ij} = \log_{2}(\mu_{ij}) = \left\{ \begin{array}{ll} b_{i0} + \sum_{q=1}^{5} b_{iq}B_{q}(x_{j}), &amp; i \in \{\text{DE indices} \} \\ b_{i0} + c, &amp; \text{otherwise} \end{array} \right. $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iq</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtext>DE indices</mml:mtext><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2020_3506_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> and <italic>μ</italic><sub><italic>ij</italic></sub> was calculated by <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}\mu _{ij} = 2^{\eta _{ij}}$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3506_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>B</italic>(·) are cubic B-Spline basis functions to induce a nonlinear effect on DE genes, and <italic>c</italic> is a constant to ensure that the count distribution of DE and non-DE genes are comparable. The cubic B-Spline basis functions were generated by the bs function in spline package [<xref ref-type="bibr" rid="CR24">24</xref>], and details of the recursive algorithm used by bs function can be found in Friedman et al. [<xref ref-type="bibr" rid="CR25">25</xref>]. Since any nonlinear spline function can be generated from linear combination of B-Spline basis functions [<xref ref-type="bibr" rid="CR26">26</xref>], we used the formula above to induce nonlinear effect in our simulations. The intercepts <italic>b</italic><sub><italic>i</italic>0</sub> were simulated from normal distribution, and the other coefficients <italic>b</italic><sub><italic>i</italic>1</sub>,<italic>b</italic><sub><italic>i</italic>2</sub>,...,<italic>b</italic><sub><italic>i</italic>5</sub> were simulated from a uniform distribution. The mean and standard deviation of normal distribution, as well as the lower/upper bound of uniform distribution were chosen such that the distribution of <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\mu }_{i} = \frac {1} {m}\sum _{j = 1}^{m} \mu _{ij}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3506_Article_IEq3.gif"/></alternatives></inline-formula> across all genes mimicked our second motivating dataset. Finally, the count of gene <italic>i</italic> in sample <italic>j</italic> was simulated from NB(<italic>μ</italic><sub><italic>ij</italic></sub>,<italic>α</italic><sub><italic>i</italic></sub>). The simulation was repeated 50 times for each combination of dispersion and sample size. Without loss of generality, here we used the link function with base 2 in generating <italic>μ</italic><sub><italic>ij</italic></sub>. One could also use link function with natural logarithm base in this simulation. Replacing base 2 with natural base only changes the coefficients of cubic B-Spline basis functions by a fixed constant, thus will not affect the accuracy of parameter estimation.</p>
        <p>To evaluate the accuracy of dispersion estimates, three methods were compared: (a) DESeq2; (b) edgeR; (c) NBAMSeq. voom was excluded from dispersion estimates comparison because the model was applied on a different scale, i.e., log-counts based on linear model with Gaussian error, thus the notion of dispersion is not applicable for this method. The hypothesis of interest is whether the expression value of each gene is associated with the covariate of interest <italic>x</italic><sub><italic>j</italic></sub>. For DESeq2 and edgeR, the design matrix is given by [<bold><italic>1</italic></bold>,<bold>X</bold><sup>∗</sup>], where <bold>X</bold><sup>∗</sup>=(<italic>x</italic><sub>1</sub>,<italic>x</italic><sub>2</sub>,...,<italic>x</italic><sub><italic>m</italic></sub>)<sup>T</sup>. The hypothesis can be formulated as testing whether the coefficient of <italic>x</italic><sub><italic>j</italic></sub> in the generalized linear model is equal to zero. For NBAMSeq the design matrix is constructed by the method in Model Fitting section, and the hypothesis test are given by Inference section in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Information A. To illustrate that information sharing across genes produces more accurate dispersion estimates, the gene-wise dispersion estimated by NBAMSeq (NBAMSeq gene-wise) without incorporating prior dispersion trend was also included in the comparison. The average mean squared error (MSE) across 50 repetitions was calculated as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Among the DE genes with nonlinear effect, NBAMSeq outperforms DESeq2 and edgeR across different sample sizes. On the other hand, among the non-DE genes, the MSE of edgeR, DESeq2 and NBAMSeq are comparable. NBAMSeq also has lower MSE than NBAMSeq (gene-wise), which shows that the Bayesian shrinkage estimation is better than gene-wise dispersion estimation. This simulation scenario shows that NBAMSeq is able to maintain good dispersion accuracy for non-DE genes and shows improvement in the accuracy over DESeq2 and edgeR for DE genes when the nonlinear association is significant.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Scenario I: MSE of dispersion estimates</p></caption><graphic xlink:href="12859_2020_3506_Fig3_HTML" id="MO3"/></fig></p>
        <p>Next, we compared the performance of DESeq2, edgeR, voom and NBAMSeq in DE analysis. The design matrix of voom is similar to DESeq2 and edgeR as given above. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the average number of DE genes, true positive rate (TPR), empirical false discovery rate (FDR), empirical false non-discovery rate (FNR), area under curve (AUC) and F1 score of these four methods. For edgeR, two approaches for DE are available, namely the quasi-likelihood (QL) and the likelihood ratio test (LRT) approach for calculating the test statistics as described in Lund et al. (2012) [<xref ref-type="bibr" rid="CR8">8</xref>]. The authors further showed that detecting DE genes using QL approach controls FDR better than the LRT approach. When calculating TPR, FDR, and FNR, genes are declared to be significant if nominal FDR is &lt;0.05 (i.e. FDR adjusted p-value &lt;0.05). The number of DE genes and TPR results indicate that our proposed method NBAMSeq has the highest power for detecting nonlinear DE genes regardless of the degrees of dispersion and sample sizes. In addition, NBAMSeq controls the FDR at 0.05 in all cases. The FNR results show that NBAMSeq has lower FNR compared to other methods. To ascertain that the power of NBAMSeq is not sensitive to the nominal FDR cutoff for DE genes, the AUC and F1 score comparisons show NBAMSeq is consistently more powerful in all cases. The observation also shows that the performance of DESeq2 and edgeR LRT approach are comparable, whereas edgeR QL approach is conservative as shown by the higher FNR. Additional comparisons of the QL approach for NBAMSeq and Gaussian additive models on logarithm transformed count data are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 and S5.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance metrics in Scenario I</p></caption><graphic xlink:href="12859_2020_3506_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec8">
        <title>Scenario II</title>
        <p>The goal of this scenario was to evaluate the robustness of NBAMSeq when the true association is a linear effect. The simulation setup in this scenario is similar to Scenario I except that <italic>η</italic><sub><italic>ij</italic></sub> is given by:
<disp-formula id="Equb"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\eta_{ij} = \log_{2}(\mu_{ij}) = \left\{ \begin{array}{ll} b_{i1}x_{j} + c_{1}, &amp; i \in \{\text{linear DE indices} \} \\ b_{i0} + c_{2}, &amp; \text{otherwise} \end{array}\right. $$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtext>linear DE indices</mml:mtext><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2020_3506_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> are constants to ensure that the DE and non-DE genes counts distribution are comparable to avoid bias in detecting DE genes. The linear coefficient <italic>b</italic><sub><italic>i</italic>1</sub> was simulated from normal distribution. Similar to Scenario I, the mean and standard deviation of normal distribution were chosen such that the distribution of <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\mu }_{i}$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3506_Article_IEq4.gif"/></alternatives></inline-formula> mimicked the distribution of mean normalized counts in real data. The simulation was repeated 50 times and the average MSE of dispersion estimates is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S6. The accuracy of NBAMSeq is comparable to the accuracy of DESeq2 and edgeR in almost all cases. This simulation shows that although NBAMSeq is designed to detect nonlinear effect, the method is robust and yields accurate dispersion estimates when the true association is linear.</p>
        <p>To evaluate the power and error rate control of our proposed model NBAMSeq in detecting DE genes with linear effect, we compare the TPR, FDR, FNR, and AUC at nominal FDR 0.05. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7 illustrates that NBAMSeq is a robust approach and maintains comparable performance to other methods.</p>
      </sec>
      <sec id="Sec9">
        <title>Scenario III</title>
        <p>The aim of this scenario was to investigate the error rate control of NBAMSeq in the absence of DE genes. The simulation setup in this scenario is similar to Scenario I and II except that <italic>η</italic><sub><italic>ij</italic></sub> is given by <italic>η</italic><sub><italic>ij</italic></sub>= log2(<italic>μ</italic><sub><italic>ij</italic></sub>)=<italic>b</italic><sub><italic>i</italic>0</sub>+<italic>c</italic>. To evaluate the error rate control of the methods, we calculated the type I error. For each individual gene, the type I error is defined as the number of false positives over the total number of repetitions. Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S8 shows the box-plot of type I error across all genes. The type I error of NBAMSeq is comparable to that of other methods. The MSE plots of dispersion estimates are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9, which shows the accuracy of dispersion estimates given by NBAMSeq is also comparable to the other methods.</p>
      </sec>
      <sec id="Sec10">
        <title>Scenario IV</title>
        <p>In real datasets, one could encounter scenarios in which both nonlinear and linear effect exist between gene counts and covariates. To mimic this situation, we considered a scenario where <italic>μ</italic><sub><italic>ij</italic></sub> was simulated from
<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\eta_{ij} = \log_{2}(\mu_{ij}) = \left\{ \begin{array}{ll} b_{i0} + \sum_{q=1}^{5} b_{iq}B_{q}(x_{j}), &amp; i \in \{\text{nonlinear DE indices} \} \\ b_{i1}x_{j} + c_{1}, &amp; i \in \{\text{linear DE indices} \} \\ b_{i0} + c_{2}, &amp; \text{otherwise} \\ \end{array}\right. $$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iq</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtext>nonlinear DE indices</mml:mtext><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtext>linear DE indices</mml:mtext><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2020_3506_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> A total of 5% genes was chosen to be DE genes, where 2.5% were nonlinear DE genes and the rest were linear DE genes. The median degree of dispersion (<italic>a</italic>=3) was studied. To determine whether a gene was differentially expressed or not, we used the same criteria as the previous scenarios, i.e., nominal FDR &lt;0.05 to identify DE genes. To differentiate the two types of DE genes (linear versus nonlinear effect), we considered two approaches. In the first approach, a DE gene is declared to have nonlinear effect if its estimated effective degrees of freedom (edf) in generalized additive model [<xref ref-type="bibr" rid="CR22">22</xref>] is above a certain threshold. Since a linear effect covariate only has one degree of freedom, we considered a DE gene as nonlinear if its edf &gt;1.5. In the second approach, we differentiated the nonlinear and linear effect by comparing the AIC/BIC computed from the nonlinear and linear model. The AIC and BIC for nonlinear model was given in our NBAMSeq output, where the number of parameters in AIC/BIC was defined as edf [<xref ref-type="bibr" rid="CR22">22</xref>]. We also fitted a linear model for each gene where the model fitting and parameter estimation procedure were similar to the “<xref rid="Sec4" ref-type="sec">Implementation</xref>” section except that only linear terms were included in the model. A gene was considered to be nonlinear if its AIC/BIC in nonlinear model was lower than linear model. The correct classification percentage (CCP), which is defined as the total correctly classified genes over all genes, is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4. The CCP for both approaches were high (&gt;0.97 for all sample sizes) since majority genes were non-DE genes, therefore they contributed most to the CCP. Thus, we also computed the CCP for differentiating nonlinear and linear effect among the DE genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). The results showed the edf approach has higher accuracy compared to AIC/BIC approach. One possible explanation is that the generalized additive model automatically shrinks to a linear model when the true effect is linear. As a result, the AIC/BIC for linear and nonlinear models are very close, making the direct comparison difficult. In our software, both options, i.e., edf and AIC/BIC are provided. Based on our simulation results, we recommended the edf approach. For cases where the edf is large, the users may also use AIC/BIC for model comparisons.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Real data analysis</title>
      <p>In this section, we applied DESeq2, edgeR with LRT approach, voom and our proposed method NBAMSeq to our motivating datasets (“<xref rid="Sec3" ref-type="sec">Motivating datasets</xref>” section), namely the TCGA GBM dataset and WTC dataset. In TCGA GBM dataset, the association between age and each gene expression was investigated, adjusting for sex and race. At FDR 0.05, 845, 784, 510 and 1,349 genes were detected by DESeq2, edgeR, voom and our proposed NBAMSeq, respectively. 323 genes were in common among the four methods, whereas 440 genes were unique to NBAMSeq (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10). To account for the fact that significant genes are sensitive to the FDR threshold, we investigated the adjusted p-value of genes detected by NBAMSeq but not DESeq2, edgeR or voom and vice versa (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>). A large proportion of the genes detected by NBAMSeq but not DESeq2, edgeR or voom have FDR above 0.1 for DESeq2, edgeR or voom, implying that these methods are unable to detect all the nonlinear genes even if a less stringent FDR threshold is used. However, for the genes detected by DESeq2, edgeR or voom but not NBAMSeq, the majority of their adjusted p-values in NBAMSeq are &lt;0.1, implying that NBAMSeq is able to detect almost all these genes at FDR &lt;0.1. Next, we performed the pathway analysis on DE genes using the hypergeometric tests implemented in the clusterProfiler software [<xref ref-type="bibr" rid="CR27">27</xref>] for both the Kyoto Encyclopedia of Genes and Genomes (KEGG) [<xref ref-type="bibr" rid="CR28">28</xref>] and Gene Ontology [<xref ref-type="bibr" rid="CR29">29</xref>] gene sets. Significant pathways were chosen at FDR 0.05. Gene sets with fewer than 15 genes or greater than 500 genes were omitted from the analysis. For the KEGG pathways, no gene set was significant among DESeq2, edgeR, or voom DE genes whereas 1 genes set was significant among NBAMSeq DE genes (Table <xref rid="Tab1" ref-type="table">1</xref>). This result is particularly interesting as cytokines dysregulation is involved in disrupting the immune system at older age via the loss of function to control systemic inflammation [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>], which could increase the susceptibility to age related diseases including cancer [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. In addition, the second gene set identified by NBAMSeq DE genes, i.e., Wnt signaling pathway (despite not making the FDR cutoff) was also an important pathway, as the mutations in Wnt signaling pathway is implicated in a variety of developmental defects in animals and associated with aging [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. For the Gene Ontology, a total of 5,000 gene sets were tested, 45, 12, 0 and 28 gene sets were identified by DESeq2, edgeR, voom and NBAMSeq, respectively and 23 gene sets were in common between DESeq2 and NBAMSeq. A full list of significant gene sets identified by these models are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8. Specifically, the gene sets unique to NBAMSeq DE genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9) are extracellular matrix pathways. Changes to extracellular matrix changes with aging has been implicated in the progression of cancer [<xref ref-type="bibr" rid="CR36">36</xref>]. These observations suggest that gene sets detected by the NBAMSeq provide additional insights to the development of cancer and aging as a risk factor.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Histogram of adjusted p-values. The dashed line is FDR cut-off 0.1. <bold>a</bold> Genes detected by NBAMSeq but not DESeq2. <bold>b</bold> Genes detected by NBAMSeq but not edgeR. <bold>c</bold> Genes detected by NBAMSeq but not voom. <bold>d</bold> Genes detected by DESeq2 but not NBAMSeq. <bold>e</bold> Genes detected by edgeR but not NBAMSeq. <bold>f</bold> Genes detected by voom but not NBAMSeq</p></caption><graphic xlink:href="12859_2020_3506_Fig5_HTML" id="MO5"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Top 5 KEGG pathways selected by NBAMSeq</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">ID</th><th align="left">Description</th><th align="left"><italic>p</italic>value</th><th align="left">p.adjust</th></tr></thead><tbody><tr><td align="left">hsa04060</td><td align="left">Cytokine-cytokine receptor interaction</td><td align="left">0.000154</td><td align="left">0.0463</td></tr><tr><td align="left">hsa04310</td><td align="left">Wnt signaling pathway</td><td align="left">0.001509</td><td align="left">0.2271</td></tr><tr><td align="left">hsa00260</td><td align="left">Glycine, serine and threonine metabolism</td><td align="left">0.003616</td><td align="left">0.3628</td></tr><tr><td align="left">hsa00350</td><td align="left">Tyrosine metabolism</td><td align="left">0.007484</td><td align="left">0.5632</td></tr><tr><td align="left">hsa04512</td><td align="left">ECM-receptor interaction</td><td align="left">0.010991</td><td align="left">0.6555</td></tr></tbody></table></table-wrap></p>
      <p>In the WTC dataset, the relationship between PCL and gene expression were investigated, adjusting for age, race and cell proportions (CD8T, CD4T, natural killer, B-cell, monocytes). At FDR 0.05, 836, 770, 887 and 803 genes were detected by DESeq2, edgeR, voom and NBAMSeq, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11). Unlike the TCGA GBM dataset, the genes detected by the four methods have a large overlap, implying that the primary effect of PCL on gene expression is linear. Although NBAMSeq identified fewer PCL gene expression signature compared to DESeq2, the 44 genes detected by DESeq2 but not NBAMSeq were marginal significant in NBAMSeq (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). However, for the genes unique to NBAMSeq, they were not necessarily significant in DESeq2, edgeR or voom. We performed pathway analysis on KEGG [<xref ref-type="bibr" rid="CR28">28</xref>], and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10 shows the significant KEGG pathways among NBAMSeq DE genes. As expected, these KEGG pathways were also significant among DESeq2 DE genes due to the large overlapping genes.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="discussion">
    <title>Discussion</title>
    <p>Although our model was developed for RNA-Seq data, it can be extended to identify nonlinear associations in other genomics biomarkers generated from high throughput sequencing which share similar features as RNA-Seq data (e.g., over dispersion in count data) as well as time-course RNA-Seq data. Compared to DESeq2, edgeR and voom, our proposed NBAMSeq method offers more flexibility as the degrees of freedom are estimated automatically within the model instead of being pre-specified. A closely related R package gam [<xref ref-type="bibr" rid="CR37">37</xref>] is also developed for fitting generalized additive models. However, this package does not support negative binomial distribution and the degrees of freedom have be pre-specified in the spline function. Our NBAMSeq framework allows for flexible models to be fitted on individual genes via mgcv [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. As shown in our simulation studies, the individual gene-wise dispersion estimate is less accurate compared to methods which model the information sharing across genes. Our proposed model is able to consider both the model flexibility for the non-linear relationships in the mean function as well as information sharing across genes in dispersion parameter estimation. In addition, NBAMSeq also offers the flexibility of differentiating the DE genes, i.e., linear versus nonlinear effect. In our simulation studies, we showed that the edf threshold 1.5 achieved good CCP, however future work includes determining the optimal edf threshold. Our simulation studies show that the proposed NBAMSeq is powerful when the underlying true association is nonlinear and robust when the underlying true association is linear compared to DESeq2, edgeR or voom. One might argue that the nonlinear association can be detected by fitting a spline regression with certain degrees of freedom and then incorporating the design matrix into DESeq2, edgeR or voom. The main disadvantage of this approach is that the degrees of freedom has to be fixed before using DESeq, edgeR or voom; and inappropriate choice of degrees of freedom leads to inflated FDR or underestimated TPR (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13 - S15). In addition, the real data analysis showed that NBAMSeq offers additional biological insights to the role of aging in the development of cancer by modeling the nonlinear age effect. Both the simulation and case studies suggest the advantageous of investigating potential nonlinear associations to detect more effective biomarkers, in order to better understand the biological underpinnings of complex diseases.</p>
    <p>NBAMSeq is developed for detecting nonlinear association between gene expression and continuous phenotypes. Our proposed framework is also applicable for scenarios in which the phenotype of interest is binary (e.g., cancer vs noncancer) and the model includes confounding variables which could be related to gene expression in a nonlinear pattern. On the other hand, for scenarios in which the phenotype of interest is ordinal, we recommend treating the variable as categorical if the number of categories is small (&lt;5). If the number of categories is five or more, then one can treat it as a continuous variable and apply NBAMSeq for detecting nonlinear effect. Similar to other softwares for RNA-Seq DE analysis, currently NBAMSeq is developed for inference at gene level in the absence of prior information. Recent methods which take into account the gene network structure in DE analysis have been shown to a powerful approach [<xref ref-type="bibr" rid="CR38">38</xref>]. Thus, an interesting future research direction is to incorporate the network topology in NBAMSeq to detect nonlinear association and decipher the collective dynamics and regulatory effects of gene expression. Currently, the computational time of NBAMSeq is longer compared to DESeq2, edgeR or voom due to the nested iteration algorithm. Future work includes approximating smoothing parameters by single iteration and reducing runtime cost.</p>
  </sec>
  <sec id="Sec13" sec-type="conclusion">
    <title>Conclusions</title>
    <p>This paper introduced a flexible negative binomial additive model combined with Bayesian shrinkage dispersion estimates for RNA-Seq data (NBAMSeq). Motivated by the nonlinear effect of age in TCGA GBM data and PTSD severity (PCL score) in WTC data, our model aimed to detect genes which exhibit nonlinear association with the phenotype of interest. The smoothing parameters and coefficients in NBAMSeq were estimated efficiently by adopting the nested iterative method implemented in mgcv [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. To increase the accuracy of the dispersion parameter estimation in small sample size scenario, the Bayesian shrinkage approach was applied to model the dispersion trend across all genes. Hypothesis tests to identify DE genes were based on chi-squared approximations. Finally, NBAMSeq is available as a Bioconductor package.</p>
  </sec>
  <sec id="Sec14">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> NBAMSeq <bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/NBAMSeq.html">http://bioconductor.org/packages/release/bioc/html/NBAMSeq.html</ext-link><bold>Operating system:</bold> Platform independent <bold>Programming language:</bold> R <bold>Other requirements:</bold> R 3.6 or higher <bold>License:</bold> GPL-2 <bold>Any restrictions to use by non-academics:</bold> none</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3506_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> This file contains supplementary information, figures and tables.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AUC</term>
        <def>
          <p>Area under curve</p>
        </def>
      </def-item>
      <def-item>
        <term>CPM</term>
        <def>
          <p>Count per million</p>
        </def>
      </def-item>
      <def-item>
        <term>DE</term>
        <def>
          <p>Differentially expression</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p>False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>FNR</term>
        <def>
          <p>False non-discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p>Glioblastoma multiforme</p>
        </def>
      </def-item>
      <def-item>
        <term>GLM</term>
        <def>
          <p>Generalized linear model</p>
        </def>
      </def-item>
      <def-item>
        <term>KEGG</term>
        <def>
          <p>Kyoto encyclopedia of genes and genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP</term>
        <def>
          <p>Maximize a posterior</p>
        </def>
      </def-item>
      <def-item>
        <term>MSE</term>
        <def>
          <p>Mean squared error</p>
        </def>
      </def-item>
      <def-item>
        <term>NBAMSeq</term>
        <def>
          <p>Negative binomial additive model for RNASeq dataset</p>
        </def>
      </def-item>
      <def-item>
        <term>PCL</term>
        <def>
          <p>PTSD Checklist-Specific Version</p>
        </def>
      </def-item>
      <def-item>
        <term>PTSD</term>
        <def>
          <p>Posttraumatic stress disorder</p>
        </def>
      </def-item>
      <def-item>
        <term>QL</term>
        <def>
          <p>Quasi-likelihood</p>
        </def>
      </def-item>
      <def-item>
        <term>TCGA</term>
        <def>
          <p>The cancer genome atlas</p>
        </def>
      </def-item>
      <def-item>
        <term>TPR</term>
        <def>
          <p>True positive rate</p>
        </def>
      </def-item>
      <def-item>
        <term>WTC</term>
        <def>
          <p>World trade center</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-3506-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>PK proposed and conceived the study. XR implemented the software and performed the analyses. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported in part by the CDC/NIOSH award U01 OH011478.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for rna-seq data with deseq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>voom: Precision weights unlock linear model analysis tools for rna-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>A powerful and flexible approach to the analysis of rna sequence count data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>19</issue>
        <fpage>2672</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr449</pub-id>
        <pub-id pub-id-type="pmid">21810900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>21</issue>
        <fpage>2881</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor rna-seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>4288</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">Chen Y, Lun AT, Smyth GK. Differential expression analysis of complex rna-seq experiments using edger. In: Statistical Analysis of Next Generation Sequencing Data. Springer: 2014. p. 51–74. 10.1007/978-3-319-07212-8_3.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Lund SP, Nettleton D, McCarthy DJ, Smyth GK. Detecting differential expression in rna-sequence data using quasi-likelihood with shrunken dispersion estimates. Stat Appl Genet Mol Biol. 2012; 11(5).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>It’s de-licious: a recipe for differential expression analyses of rna-seq experiments using quasi-likelihood methods in edger</article-title>
        <source>Statistical Genomics</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Humana Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stricker</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tresch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genogam: genome-wide generalized additive models for chip-seq analysis</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>15</issue>
        <fpage>2258</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx150</pub-id>
        <pub-id pub-id-type="pmid">28369277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thurston</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Wand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wiencke</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Negative binomial additive models</article-title>
        <source>Biometrics</source>
        <year>2000</year>
        <volume>56</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0006-341X.2000.00139.x</pub-id>
        <pub-id pub-id-type="pmid">10783788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20236492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bozdag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Riddick</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kotliarov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Baysan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Iwamoto</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Cam</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Kotliarova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fine</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>Age-specific signatures of glioblastoma at the genomic, genetic, and epigenetic levels</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>62982</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0062982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B (Methodol)</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuan</surname>
            <given-names>P-F</given-names>
          </name>
          <name>
            <surname>Waszczuk</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kotov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Clouston</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Glenn</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Gomez</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bromet</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression associated with ptsd in world trade center responders: An rna sequencing study</article-title>
        <source>Transl Psychiatry</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>12</issue>
        <fpage>1297</fpage>
        <pub-id pub-id-type="doi">10.1038/s41398-017-0050-1</pub-id>
        <pub-id pub-id-type="pmid">29249826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Weathers FW, Litz BT, Herman DS, Huska JA, Keane TM, et al.The PTSD checklist (PCL): Reliability, validity, and diagnostic utility. In: Annual Convention of the International Society for Traumatic Stress Studies, San Antonio, TX (Vol. 462). San Antonio: 1993. https://scholar.google.com.sg/scholar?q=the+ptsd+checklist+(pcl)+reliability+validity+ and+diagnostic+utility\&amp;hl=en&amp;as_sdt=0&amp;as_vis=1&amp;oi=scholart.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuan</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Waszczuk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kotov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guffanti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Koenen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bromet</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Luft</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Dna methylation associated with ptsd and depression in world trade center responders: An epigenome-wide study</article-title>
        <source>Biol Psychiatry</source>
        <year>2017</year>
        <volume>81</volume>
        <issue>10</issue>
        <fpage>365</fpage>
        <pub-id pub-id-type="doi">10.1016/j.biopsych.2017.02.629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Pya</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Säfken</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Smoothing parameter and model selection for general smooth models</article-title>
        <source>J Am Stat Assoc</source>
        <year>2016</year>
        <volume>111</volume>
        <issue>516</issue>
        <fpage>1548</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2016.1180986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Wood SN. J R Stat Soc Ser B (Stat Methodol). 2011; 73(1):3–36.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
        </person-group>
        <article-title>Stable and efficient multiple smoothing parameter estimation for generalized additive models</article-title>
        <source>J Am Stat Assoc</source>
        <year>2004</year>
        <volume>99</volume>
        <issue>467</issue>
        <fpage>673</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
        </person-group>
        <source>Generalized Additive Models: an Introduction with R</source>
        <year>2017</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>CRC press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
        </person-group>
        <article-title>Thin plate regression splines</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2003</year>
        <volume>65</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Core Team R. C. T. R.R: A Language and Environment for Statistical Computing. Vienna: R Foundation for Statistical Computing: 2013. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>The Elements of Statistical Learning, (vol. 1, No. 10)</source>
        <year>2001</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Prautzsch H, Boehm W, Paluszny M. Bézier and B-spline Techniques: Springer Science &amp; Business Media; 2013.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L-G</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Q-Y</given-names>
          </name>
        </person-group>
        <article-title>clusterprofiler: an r package for comparing biological themes among gene clusters</article-title>
        <source>Omics: J Integr Biol</source>
        <year>2012</year>
        <volume>16</volume>
        <issue>5</issue>
        <fpage>284</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Kegg: kyoto encyclopedia of genes and genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Eppig</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene ontology: tool for the unification of biology</article-title>
        <source>Nat Genet</source>
        <year>2000</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1038/75556</pub-id>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baumgartner</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Cytokine-related aging process</article-title>
        <source>J Gerontol Ser A Biol Sci Med Sci</source>
        <year>2004</year>
        <volume>59</volume>
        <issue>9</issue>
        <fpage>924</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/gerona/59.9.M924</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rea</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>McGilligan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McNerlan</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>OA</given-names>
          </name>
        </person-group>
        <article-title>Age and age-related diseases: role of inflammation triggers and cytokines</article-title>
        <source>Front Immunol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>586</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2018.00586</pub-id>
        <pub-id pub-id-type="pmid">29686666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Cesari</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marzetti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Giovannini</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Leeuwenburgh</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Molecular inflammation: underpinnings of aging and age-related diseases</article-title>
        <source>Ageing Res Rev</source>
        <year>2009</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1016/j.arr.2008.07.002</pub-id>
        <pub-id pub-id-type="pmid">18692159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franceschi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Campisi</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Chronic inflammation (inflammaging) and its potential contribution to age-associated diseases</article-title>
        <source>J Gerontol Ser A Biomed Sci Med Sci</source>
        <year>2014</year>
        <volume>69</volume>
        <issue>Suppl_1</issue>
        <fpage>4</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/gerona/glu057</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Clevers</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Wnt signalling in stem cells and cancer</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>434</volume>
        <issue>7035</issue>
        <fpage>843</fpage>
        <pub-id pub-id-type="doi">10.1038/nature03319</pub-id>
        <pub-id pub-id-type="pmid">15829953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruber</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yee</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tolwinski</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Developmental drift and the role of wnt signaling in aging</article-title>
        <source>Cancers</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>8</issue>
        <fpage>73</fpage>
        <pub-id pub-id-type="doi">10.3390/cancers8080073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sprenger</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Plymate</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Reed</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Aging-related alterations in the extracellular matrix modulate the microenvironment and influence tumor progression</article-title>
        <source>Int J Cancer</source>
        <year>2010</year>
        <volume>127</volume>
        <issue>12</issue>
        <fpage>2739</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.25615</pub-id>
        <pub-id pub-id-type="pmid">21351253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <mixed-citation publication-type="other">Hastie T, Package R. Generalized Additive Models. 2019. R package version, 1(1) <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/gam/index.html">http://cran.r-project.org/web/packages/gam/index.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jacob</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Neuvial</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>More power via graph-structured tests for differential expression of gene networks</article-title>
        <source>Ann Appl Stat</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>561</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS528</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
