<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010663.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9681064</article-id>
    <article-id pub-id-type="pmid">36355866</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010663</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-00602</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteomics</subject>
            <subj-group>
              <subject>Peptide Libraries</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
            <subj-group>
              <subject>Oligonucleotides</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Protein Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Protein Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Precipitation Techniques</subject>
          <subj-group>
            <subject>Immunoprecipitation</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Biochemical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Biochemical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Bacteriophages</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BIPS—A code base for designing and coding of a Phage ImmunoPrecipitation Oligo Library</article-title>
      <alt-title alt-title-type="running-head">BIPS—A code base for designing and coding of a Phage ImmunoPrecipitation Oligo Library</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2675-3257</contrib-id>
        <name>
          <surname>Leviatan</surname>
          <given-names>Sigal</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9375-2946</contrib-id>
        <name>
          <surname>Kalka</surname>
          <given-names>Iris N.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vogl</surname>
          <given-names>Thomas</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klompas</surname>
          <given-names>Shelley</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weinberger</surname>
          <given-names>Adina</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Segal</surname>
          <given-names>Eran</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Molecular Cell Biology, Weizmann Institute of Science, Rehovot, Israel</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Computer Science and Applied Mathematics, Weizmann Institute of Science, Rehovot, Israel</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schneidman</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>eran.segal@weizmann.ac.il</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>11</issue>
    <elocation-id>e1010663</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Leviatan et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Leviatan et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010663.pdf"/>
    <abstract>
      <p>BIPS (Build Phage ImmunoPrecipitation Sequencing library) is a software that converts a list of proteins into a custom DNA oligonucleotide library for the PhIP-Seq system. The tool creates constant-length oligonucleotides with internal barcodes, while maintaining the original length of the peptide. This allows using large libraries, of hundreds of thousands of oligonucleotides, while saving on the costs of sequencing and maintaining the accuracy of oligonucleotide reads identification. BIPS is available under GNU public license from: <ext-link xlink:href="https://github.com/kalkairis/BuildPhIPSeqLibrary" ext-link-type="uri">https://github.com/kalkairis/BuildPhIPSeqLibrary</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author(s) received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="0"/>
      <page-count count="8"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-11-22</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its <xref rid="sec012" ref-type="sec">Supporting Information</xref> files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its <xref rid="sec012" ref-type="sec">Supporting Information</xref> files.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The use of Phage immunoprecipitation sequencing (PhIP-Seq), based on phage-displayed synthetic oligonucleotide libraries [<xref rid="pcbi.1010663.ref001" ref-type="bibr">1</xref>], became a useful tool in scanning the reaction of the human immune system to large protein collections [<xref rid="pcbi.1010663.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1010663.ref005" ref-type="bibr">5</xref>]. PhIP-Seq allows testing for antibody reaction to hundreds of thousands of antigens in parallel, in contrast to peptide arrays and enzyme-linked immunosorbent assays (ELISAs) which have limited capacities, of at most a few thousand or a few tens of thousands of antigens [<xref rid="pcbi.1010663.ref006" ref-type="bibr">6</xref>]. However, creating a library of that many peptides is computationally challenging.</p>
    <p>Current state-of-the-art software for peptide library design includes Pepsyn [<xref rid="pcbi.1010663.ref007" ref-type="bibr">7</xref>], which uses representative selection for tiling protein sequences. Other previous works [<xref rid="pcbi.1010663.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1010663.ref008" ref-type="bibr">8</xref>] did not publish public software, but mention crucial steps in constructing peptide libraries. While Pepsyn is a reliable tool, it does not allow for representations of multiple variants of the same peptide sequence.</p>
    <p>Here, we present BIPS (BuildPhIPSeqLibrary), a software for rapid and simple construction of an oligonucleotide library from any input sets of proteins (<xref rid="pcbi.1010663.g001" ref-type="fig">Fig 1A</xref>). BIPS is intended for large peptide libraries and through the use of synonymous mutations, which was previously suggested [<xref rid="pcbi.1010663.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1010663.ref008" ref-type="bibr">8</xref>], enables the complete representation of multiple variants in an unambiguous manner, while allowing peptide identification without the need for full-length sequencing.</p>
    <fig position="float" id="pcbi.1010663.g001">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1010663.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Library construction and barcoding schematic representation.</title>
        <p><bold>a,</bold> Flow of inputs from peptide sequences, through software modules (arrows) including intermediate results. (1) protein sequences splitting into constant-length peptides with overlap. (2) reverse translation adhering to codon usage frequencies. (3) barcoding sequences’ tails. <bold>b,</bold> Three possible identification methodologies of oligos. In brown below are minimal sequencings required for correct identification. (1) External barcodes decrease the possible lengths of coding peptides via replacing the 3’ end with a short barcode. (2) No barcoding, requires sequencing of entire oligonucleotides. (3) Inline barcoding, requires intermediate length sequencing, and enables full-length coding peptides. <bold>c,</bold> Two possible inline barcodes of the same 5’ sequence (LL), with a hamming-distance of three and a six-nucleotide barcode (3x2 nucleotides). First oligonucleotide is barcoded without restrictions. Second oligonucleotide is restricted for three iterations, and permitted in the fourth. Figures were created with <ext-link xlink:href="http://BioRender.com" ext-link-type="uri">BioRender.com</ext-link>.</p>
      </caption>
      <graphic xlink:href="pcbi.1010663.g001" position="float"/>
    </fig>
    <p>We tested BIPS on simulated data, on all available infectious and allergic diseases from the Immune Epitope Database (IEDB). Through these, we showed the computational limits of BIPS.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>Design</title>
      <p>An overview of BIPS is presented in <xref rid="pcbi.1010663.g001" ref-type="fig">Fig 1A</xref>, and is detailed below.</p>
      <p>Construction of PhIP-Seq libraries begins with a large set of proteins provided by users. Usually these will be full-length or partial proteins, from one or many sources. Note that the advantages of a PhIP-Seq library are more pronounced when exact epitopes are unknown and a scanning of relatively long peptides or full proteins is required.</p>
      <p>In constructing a PhIP-Seq library the set of proteins must be cut into constant length peptides, so as not to create biases in PCR-amplification of the library and its cloning into phages. To this end, shorter input proteins or peptides are terminated by a stop codon, and padded with a random amino-acid sequence, as implemented in Pepsyn [<xref rid="pcbi.1010663.ref007" ref-type="bibr">7</xref>].</p>
      <p>The PhIP-Seq library is intended to present all potential linear epitopes (potential binding sites of the immune system antibodies) of the given set of proteins. In order to cover all potential linear-epitopes with potential for antibody binding, proteins are cut with a positive overlap. This overlap should be long enough so that linear epitopes, usually 6–20 amino acids long [<xref rid="pcbi.1010663.ref009" ref-type="bibr">9</xref>] appear in full in at least one of the peptides.</p>
      <p>BIPS produces a list of oligonucleotide sequences (oligos), to be synthesized and cloned into phages, that will infect and replicate in the appropriate bacteria. The common use is of bacteriophage T7 within <italic toggle="yes">Escherichia coli</italic>. All peptides must be coded using the host bacteria’s codon usage table, without including restricted sequences. Furthermore, in order to make the replication as efficient and as uniform as possible, it is preferable to also imitate the codon usage frequencies of the host bacteria (<xref rid="pcbi.1010663.g002" ref-type="fig">Fig 2A</xref>).</p>
      <fig position="float" id="pcbi.1010663.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010663.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Codon frequency in BIPS output.</title>
          <p><bold>a</bold>, Codon frequencies (summing to one per amino acid). In green the published frequencies for Escherichia coli. In red and yellow are coding frequencies of example outputs from IEDB’s infectious diseases and allergic diseases. <bold>b</bold>, <bold>c</bold>, Simulations of average number of barcodes for random oligos. Colors are defined by barcode-lengths and number of barcode parts. Simulations were performed on constant barcode length (<bold>b</bold>) or constant barcode parts’ lengths (<bold>c</bold>).</p>
        </caption>
        <graphic xlink:href="pcbi.1010663.g002" position="float"/>
      </fig>
      <p>After immunoprecipitation, the peptides in the bound phages are identified by sequencing the bound phages. In cases of libraries where there are many similar peptides due to research of deep mutagenesis [<xref rid="pcbi.1010663.ref003" ref-type="bibr">3</xref>], mutation scanning, homologous proteins or other, partially sequencing a peptide might not be sufficient for identification, and alternative methods must be explored. One method of identification is sequencing of entire oligos, however this is costly and prone to read errors. Another method is attachment of pre-planned barcodes at the 3’ end of each oligo, preceded by a stop codon, so that the barcode does not translate into a protein. Such barcodes are relatively short in length, thus requiring cheaper sequencing, and are designed to correct read errors via their pre-planned hamming-distance [<xref rid="pcbi.1010663.ref010" ref-type="bibr">10</xref>] from each other. These advantages come at a cost, the length of the barcode is added upon the length of the coding oligo, adding to the costs of library synthesis. Worse, this addition limits the length of actual coding oligo, as DNA synthesis technology is still limited. BIPS creates internal barcoding sequences by leveraging the multiple possibilities in coding amino-acids into oligos, while maintaining a requested hamming-distance between pairs. Barcodes are created at the coding stage as part of the oligo, thus they can be located at the 5’ end of the oligo eliminating the misidentification problem caused in cases of multiple inserts (<xref rid="pcbi.1010663.s002" ref-type="supplementary-material">S2 Text</xref>).</p>
      <p>If a constructed barcode does not adhere to the hamming-distance or the entire peptide includes restricted sequences, BIPS re-codes the barcode until either getting a successful barcode, or until reaching a pre-defined number of iterations. The concept of utilizing synonymous codons to allow unambiguous mapping has previously been discussed [<xref rid="pcbi.1010663.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1010663.ref008" ref-type="bibr">8</xref>], here, we have advanced this approach by using it in order to ensure a hamming distance between sequences. It is clear that coding many identical (or nearly identical) sequences in a single library will increase the use of relatively rare codons, however we have shown [<xref rid="pcbi.1010663.ref004" ref-type="bibr">4</xref>] that this does not cause a significant reduction in differential expression.</p>
      <p>When oligo libraries are large (hundreds of thousands of oligos) it is computationally infeasible to check the hamming distance of each newly proposed oligo vs. the library already created, therefore we construct a unique divide-and-conquer method to ensure the hamming distance. Given a required number of errors to correct n (usually one or two errors), and the respective hamming distance of 2<italic toggle="yes">n+1</italic> (three or five respectively), we split the barcode into 2<italic toggle="yes">n+1</italic> parts, and demand uniqueness for each of the parts. Uniqueness is less computationally complex to check, and ensures at least one difference per part, thus at least <italic toggle="yes">2n+1</italic> differences overall (i.e., a hamming distance of at least <italic toggle="yes">2n+1</italic>). Such internal barcodes are longer than pre-planned barcodes, however they allow using the full length of the oligo sequence as coded peptide. While in comparison to not barcoding at all, this methodology removes the need to sequence the entire oligo in order to identify it (<xref rid="pcbi.1010663.g001" ref-type="fig">Fig 1B and 1C</xref>).</p>
      <p>At the final stage of preparation, a constant prefix and suffix are added to each finalized oligo sequence, these include the restriction sites and primer binding region for library amplification. In order to produce the protein, a stop codon must appear downstream of the peptide, it is suggested to include this within the suffix, (at 3’ end), but it is not mandatory (in case C-terminal tags should be added or M13 phage display should be used). It is important to define in advance all relevant restriction sequences (including these restriction sites), so as not to allow them to be formed when coding the peptides into oligo, including in the barcodes.</p>
      <p>We present BIPS, a configurable software to build PhIP-Seq libraries. It receives sets of proteins (or partial proteins) as inputs, creating a library of internally barcoded oligos, spanning the entire input protein set. Final oligos are marked with all the original proteins and locations they were derived from, and mapped to all proteins containing them (<xref rid="pcbi.1010663.s003" ref-type="supplementary-material">S3 Text</xref>), allowing for the analysis of the bound peptides and their source proteins. There is still a lot of room for exploration via PhIP-Seq of antibody repertoires, and BIPS facilitates achieving this goal.</p>
    </sec>
    <sec id="sec004">
      <title>Software implementation</title>
      <p>All code was written in Python 3, and tested on multiple platforms (CentOS, IOS and Windows all in the Anaconda environment). The code consists of two main programs, the first converts multiple files of proteins to a single file of oligos for synthesis, and the second maps oligos to original files and peptides. The latter program takes a relatively long time, however it can be run offline. Both programs can utilize multithreading to reduce run-time, if available.</p>
      <p>All functions in the code have accompanying unit-tests. To ensure all dependencies and code versions are in order, it is advisory to run all tests on the code on the available platform.</p>
      <p>The program converting protein files to oligos takes as input from the configuration the path to a directory, where all protein files should be located. It is possible to add new protein files and re-run the program, adding their accompanying oligos to the library. However, it is not possible to change an existing input file without erasing the entire output directory first, and re-starting the library build. This limitation exists to maintain consistency between the input files and the complete library. At the end of the run a configured output directory will contain all output files created during the run. The different output files are described in the README.md file of the Data/Output directory, the most important of which is order_file.txt, a ready to order file containing only nucleotide sequences.</p>
      <p>The mapping program runs on two files: oligos_sequence.csv and sequences_ids.csv, both of which are created in the library constructing program. The program goes over all oligos and all protein sequences and maps the oligos to all possible perfect matches. This program produces a single mapped oligo file in the output directory under the name mapped_oligos_sequence.csv.</p>
      <p>After producing the library and performing PhageIPSeq experiments FASTQ files should be returned from sequencing machines. We supply an example code to identify the barcode. We note that this specific code example is configured to default configurations and should provide a roadmap to identifying sequencing results rather than be used directly.</p>
    </sec>
    <sec id="sec005">
      <title>Barcode length and error correction</title>
      <p>Our unique divide-and-conquer method allows a low-computational method of ensuring the required hamming distance between every pair of barcoded oligos.</p>
      <p>The idea is to ensure the correction of up to n-errors by using barcodes at hamming distance (<italic toggle="yes">2n+1</italic>) from each other, by dividing the length of the barcode in (<italic toggle="yes">2n+1</italic>) parts, as equally as possible, and never having two oligos with an identical sub-sequence at any of the barcode parts. Since checking for identity is easy (using a hash function, or inherently in code structures like python set) then it is computationally easy to ensure each part has at least one difference from any other oligo, and together at least (<italic toggle="yes">2n+1</italic>) differences.</p>
      <p>For example, a barcode length of 75 bps, divided into 5 sections of correcting for 2 read errors, and a random protein library, millions of oligos can be barcoded in this way (at most 4<sup>15</sup>≈10<sup>9</sup>, i.e. a billion). In practice, due to the uneven amino acid probabilities, and the amount of redundancy in the specific library, it is possible that some sequences will fail to code, for example there is only one way to code “MMMMM” so if two peptides beginning with “MMMMM” exist in the library and the first part of the barcode is of length 15 base pairs (5 amino acids), then the second peptide will not be codable.</p>
      <p>In essence there are three parameters here that need to be balanced, the length of the barcode (and thus the length one needs to sequence after immuno-precipitation), the number of errors one wants to correct, and the size and richness of the library. If the library contents are not diverse (for example a database which includes many versions of the same protein, e.g. many wheat protein variants as may appear in an allergens database), then a longer barcode will be needed to allow enough coding options.</p>
    </sec>
    <sec id="sec006">
      <title>Configuration</title>
      <p>A single configuration file allows defining all parameters: length of peptide, and overlap, in amino acids, location and lengths of barcode parts, codon table and frequencies, restricted sequences, and a prefix and suffix for all final oligonucleotides. As well as the input and output directories.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec007">
    <title>Results</title>
    <p>We tested the performance of BIPS on both simulated and real data.</p>
    <sec id="sec008">
      <title>Barcode construction simulations</title>
      <p>We simulated library and barcode construction to evaluate upper bounds of possible barcodes in a library. To that end, we first created random amino-acid sequences by sequentially randomly choosing each amino acid from E. coli amino-acid frequencies. From those we constructed barcodes for each sequence. Upon the first case of barcode construction failure (meaning that at least one of the barcode parts was non-unique) we halted the simulations. If there were no barcode construction failures, we halted each single simulation upon reaching 10<sup>7</sup> sequences.</p>
      <p>We note that all simulations, although providing insights about barcoding limitations, do not represent real life protein sequences. That is, in common proteins, the amino-acid order is non-random, and furthermore they often include recurring motifs.</p>
      <p>For the first set of simulations (<xref rid="pcbi.1010663.g002" ref-type="fig">Fig 2B</xref>), for each total barcode length we created barcodes split into 3, 5 and 7 parts. These in turn allow correction of 1, 2 or 3 errors respectively. We performed the simulations for total barcode lengths of 5aa-10aa (15–30 base-pairs). The split of barcode of total length <italic toggle="yes">l</italic> base pairs into <italic toggle="yes">m</italic> = 2<italic toggle="yes">n</italic>+1 barcode parts was performed by use of <inline-formula id="pcbi.1010663.e001"><alternatives><graphic xlink:href="pcbi.1010663.e001.jpg" id="pcbi.1010663.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="normal">II</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mi>%</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> base pairs for barcode part <italic toggle="yes">i</italic>. We note that some of the splits do not necessarily start or end at an amino-acid boundary (e.g., for a 6aa barcode of 5 parts barcodes will be of [4, 4, 4, 3, 3] base pairs).</p>
      <p>For the second set of simulations (<xref rid="pcbi.1010663.g002" ref-type="fig">Fig 2C</xref>), each simulation maintained a constant length of each barcode part. We performed the simulations for barcode part lengths ranging from 1aa to 4 aa. For each such simulation we constructed barcodes made of 1, 3 or 5 such parts. Note, that in this case, unlike in the first set of simulations, each barcode part includes complete amino-acid sequences and does not contain partial codons. Furthermore, in this simulation the barcode’s total length is dependent on the number of barcode parts and is not constant.</p>
    </sec>
    <sec id="sec009">
      <title>Performance on real data</title>
      <p>For understanding BIPS performance on real data we obtained two separate datasets from IEDB, infectious diseases and allergic diseases (<xref rid="pcbi.1010663.s001" ref-type="supplementary-material">S1 Text</xref>). We ran BIPS separately on each of these inputs, creating two separate libraries (with default parameters including oligo_aa_length = 64, oligo_aa_overlap = 20, and a 5-part barcode at the 5’ end of 15bp per part). Codon frequencies were calculated on the oligo sequences without the amplification prefix and suffix. The frequencies were compared to theoretical frequencies [<xref rid="pcbi.1010663.ref011" ref-type="bibr">11</xref>] (<xref rid="pcbi.1010663.g002" ref-type="fig">Fig 2A</xref>).</p>
      <p>For IEDB’s infectious diseases: of the 1,249 full protein sequences two could not be used (uniprot A0A2D4C4Z9 contained a non-amino acid letter “X”, uniprot Q8I4R2 had no amino acid sequence). The remaining 1,247 proteins were cut into a total of 24,456 peptides.</p>
      <p>Of the 24,456 peptides, 51 failed in conversion to a nucleotide sequence, because of restriction sites. After the initial coding 400 had to be recoded because of barcode collisions, of them 180 failed to recode. This run took 7 minutes on CentOS.</p>
      <p>For the IEDB’s allergic diseases: Of the 240 proteins two could not be used (no amino acid sequence for uniprot M0U687 and Q9URH1). The remaining 238 proteins were cut into 1,745 peptides.</p>
      <p>Of the 1,745 peptides, 1 failed in conversion to a nucleotide sequence, because of restriction sites. After the initial coding 10 had to be re-coded because of barcode collisions, all succeeded. This run took 10 seconds on CentOS.</p>
    </sec>
  </sec>
  <sec id="sec010">
    <title>Availability and future directions</title>
    <p>BIPS is open-source and freely available under the GNU public library; it is maintained on GitHub, enabling bug-reporting and community collaboration. It can be found at <ext-link xlink:href="https://github.com/kalkairis/BuildPhIPSeqLibrary" ext-link-type="uri">https://github.com/kalkairis/BuildPhIPSeqLibrary</ext-link>. The entire software was developed in Python 3, and includes internal tests and use-cases for the benefit of users.</p>
    <p>We plan to use BIPS in order to design a new PhIP-Seq library for a new cohort within our group. In the future we intend to develop a publicly available software to analyze results from PhIP-Seq sequencings.</p>
    <sec id="sec011">
      <title>Dependencies</title>
      <p>Code uses standard Python 3 libraries, in addition to: pandas (1.3.5), numpy (1.21.5), regex (2022.1.18). Code has been tested on Windows, IOS and CentOS.</p>
    </sec>
  </sec>
  <sec id="sec012" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010663.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Detailed information of test data use for checking this software library.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1010663.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010663.s002" position="float" content-type="local-data">
      <label>S2 Text</label>
      <caption>
        <title>Explanation of the misidentification problems, which might occur when adding a barcode at the 3’ end.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1010663.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010663.s003" position="float" content-type="local-data">
      <label>S3 Text</label>
      <caption>
        <title>Description of extra software supplied in order to identify the oligo source of each barcode sequenced, and all potential protein sources it may have been derived from.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1010663.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010663.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Larman</surname><given-names>HB</given-names></name>, <name><surname>Zhao</surname><given-names>Z</given-names></name>, <name><surname>Laserson</surname><given-names>U</given-names></name>, <name><surname>Li</surname><given-names>MZ</given-names></name>, <name><surname>Ciccia</surname><given-names>A</given-names></name>, <name><surname>Gakidis</surname><given-names>MAM</given-names></name>, <etal>et al</etal>. <article-title>Autoantigen discovery with a synthetic human peptidome</article-title>. <source>Nat Biotechnol</source>. <year>2011</year>;<volume>29</volume>: <fpage>535</fpage>–<lpage>541</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.1856</pub-id><?supplied-pmid 21602805?><pub-id pub-id-type="pmid">21602805</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>GJ</given-names></name>, <name><surname>Kula</surname><given-names>T</given-names></name>, <name><surname>Xu</surname><given-names>Q</given-names></name>, <name><surname>Li</surname><given-names>MZ</given-names></name>, <name><surname>Vernon</surname><given-names>SD</given-names></name>, <name><surname>Ndung’u</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Viral immunology. Comprehensive serological profiling of human populations using a synthetic human virome</article-title>. <source>Science</source>. <year>2015</year>;<volume>348</volume>: <fpage>aaa0698</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aaa0698</pub-id><?supplied-pmid 26045439?><pub-id pub-id-type="pmid">26045439</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Klompus</surname><given-names>S</given-names></name>, <name><surname>Leviatan</surname><given-names>S</given-names></name>, <name><surname>Vogl</surname><given-names>T</given-names></name>, <name><surname>Mazor</surname><given-names>RD</given-names></name>, <name><surname>Kalka</surname><given-names>IN</given-names></name>, <name><surname>Stoler-Barak</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Cross-reactive antibodies against human coronaviruses and the animal coronavirome suggest diagnostics for future zoonotic spillovers</article-title>. <source>Sci Immunol.</source><year>2021</year>;<fpage>6</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciimmunol.abe9950</pub-id><?supplied-pmid 34326184?><pub-id pub-id-type="pmid">34326184</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Vogl</surname><given-names>T</given-names></name>, <name><surname>Klompus</surname><given-names>S</given-names></name>, <name><surname>Leviatan</surname><given-names>S</given-names></name>, <name><surname>Kalka</surname><given-names>IN</given-names></name>, <name><surname>Weinberger</surname><given-names>A</given-names></name>, <name><surname>Wijmenga</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Population-wide diversity and stability of serum antibody epitope repertoires against human microbiota</article-title>. <source>Nat Med</source>. <year>2021</year>;<volume>27</volume>: <fpage>1442</fpage>–<lpage>1450</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41591-021-01409-3</pub-id><?supplied-pmid 34282338?><pub-id pub-id-type="pmid">34282338</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Singh</surname><given-names>H</given-names></name>, <name><surname>Ansari</surname><given-names>HR</given-names></name>, <name><surname>Raghava</surname><given-names>GPS</given-names></name>. <article-title>Improved method for linear B-cell epitope prediction using antigen’s primary sequence</article-title>. <source>PLoS ONE</source>. <year>2013</year>;<volume>8</volume>: <fpage>e62216</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0062216</pub-id><?supplied-pmid 23667458?><pub-id pub-id-type="pmid">23667458</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Paull</surname><given-names>ML</given-names></name>, <name><surname>Bozekowski</surname><given-names>JD</given-names></name>, <name><surname>Daugherty</surname><given-names>PS</given-names></name>. <article-title>Mapping antibody binding using multiplexed epitope substitution analysis</article-title>. <source>J Immunol Methods</source>. <year>2021</year>;<volume>499</volume>: <fpage>113178</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jim.2021.113178</pub-id><?supplied-pmid 34757083?><pub-id pub-id-type="pmid">34757083</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Mohan</surname><given-names>D</given-names></name>, <name><surname>Wansley</surname><given-names>DL</given-names></name>, <name><surname>Sie</surname><given-names>BM</given-names></name>, <name><surname>Noon</surname><given-names>MS</given-names></name>, <name><surname>Baer</surname><given-names>AN</given-names></name>, <name><surname>Laserson</surname><given-names>U</given-names></name>, <etal>et al</etal>. <article-title>PhIP-Seq characterization of serum antibodies using oligonucleotide-encoded peptidomes.</article-title><source>Nat Protoc</source>. <year>2018</year>;<volume>13</volume>: <fpage>1958</fpage>–<lpage>1978</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41596-018-0025-6</pub-id><?supplied-pmid 30190553?><pub-id pub-id-type="pmid">30190553</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Shrock</surname><given-names>E</given-names></name>, <name><surname>Fujimura</surname><given-names>E</given-names></name>, <name><surname>Kula</surname><given-names>T</given-names></name>, <name><surname>Timms</surname><given-names>RT</given-names></name>, <name><surname>Lee</surname><given-names>I-H</given-names></name>, <name><surname>Leng</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Viral epitope profiling of COVID-19 patients reveals cross-reactivity and correlates of severity</article-title>. <source>Science</source>. <year>2020</year>;<fpage>370</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.abd4250</pub-id><?supplied-pmid 32994364?><pub-id pub-id-type="pmid">32703862</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>El-Manzalawy</surname><given-names>Y</given-names></name>, <name><surname>Dobbs</surname><given-names>D</given-names></name>, <name><surname>Honavar</surname><given-names>V</given-names></name>. <article-title>Predicting flexible length linear B-cell epitopes</article-title>. <source>Comput Syst Bioinformatics Conf</source>. <year>2008</year>;<volume>7</volume>: <fpage>121</fpage>–<lpage>132</lpage>. <?supplied-pmid 19642274?><pub-id pub-id-type="pmid">19642274</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Hamming</surname><given-names>RW</given-names></name>. <article-title>Error Detecting and Error Correcting Codes</article-title>. <source>Bell System Technical Journal</source>. <year>1950</year>;<volume>29</volume>: <fpage>147</fpage>–<lpage>160</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/j.1538-7305.1950.tb00463.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010663.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Nakamura</surname><given-names>Y</given-names></name>, <name><surname>Gojobori</surname><given-names>T</given-names></name>, <name><surname>Ikemura</surname><given-names>T</given-names></name>. <article-title>Codon usage tabulated from international DNA sequence databases: status for the year 2000</article-title>. <source>Nucleic Acids Res</source>. <year>2000</year>;<volume>28</volume>: <fpage>292</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/28.1.292</pub-id><?supplied-pmid 10592250?><pub-id pub-id-type="pmid">10592250</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010663.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010663.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Dina Schneidman</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Dina Schneidman</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010663" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">3 Jul 2022</named-content>
    </p>
    <p>Dear Ms Leviatan,</p>
    <p>Thank you very much for submitting your manuscript "BIPS - a Code Base for Designing and Coding of a Phage Immuno-Precipitation Oligo Library" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: BIPS is a comprehensive tool to generate a Phage Immuno-precipitation library from Protein/peptide sequences of interest. The tool generates a library with desired oligo length and overlap.</p>
    <p>Novelty of the code lies in the embedded barcode. In commonly used methods the barcode is at the 5p end of the sequences that reduces the effective length of the oligo or on the 3p end that makes paired end sequencing necessary.</p>
    <p>This tool also ensures appropriate hamming distance between oligos.</p>
    <p>This tool generates a barcode of desired length within the sequence with an elegant use of codon optimization table. Internal barcoding reduces sequencing length requirement.</p>
    <p>I have some minor comments:</p>
    <p>1. Does the codon optimization reduce the probability of expression of that oligo, if there are large number of similar sequences?</p>
    <p>2. Would it be possible to use the code without using internal barcoding strategy?</p>
    <p>Reviewer #2: Leviatan et al have developed an informatics pipeline for converting protein sequences into DNA sequences encoding peptides to tile across the desired proteins (BIPS). The DNA sequences are then to be cloned en masse into phage display for the PhIP-Seq assay. PhIP-Seq has emerged as a powerful antibody profiling technology, so open source tools for library design will certainly be welcomed by users – especially since there remains a lack of established computational tools and standards. However, there are several unfortunate shortcomings of this manuscript that must be addressed before it is suitable for publication.</p>
    <p>Major Issues</p>
    <p>• Perhaps the most critical problem with this paper is that the open-source pipeline currently in use for PhIP-Seq library design, pepsyn (Mohan et al. Nat Prot), is not even referenced. Since it is not referenced, BIPS cannot be directly compared to the de facto standard.</p>
    <p>• A second critical issue is that codon-based barcoding has been incorporated into the design of multiple previously published PhIP-Seq libraries. It has been utilized in at least two contexts of which I am aware. In the first, Xu et al (Science) used codon barcoding to distinguish alanine scanning variants of public epitopes. In the second example, Shrock et al (Science) used codon barcoding to distinguish duplicate peptides that enhance assay robustness. Xu is referenced but not in the context of codon barcoding, and Shrock is not referenced at all. Since these prior examples are not referenced, the approach used by BIPS cannot be compared or contrasted.</p>
    <p>• The overall rationale for embedding codon barcodes is not articulated. It seemed to me that the main reason the authors would use codon-barcoding is for disambiguation of similar library members. However, for typical libraries and typical read lengths (say 50 nucleotides at minimum, but typically longer reads at incremental additional cost), the number of ambiguous library members would be extremely small. Of course, any number of ambiguous sequences is undesirable, but rescuing these sequences might not be the most compelling rationale. I suggest the authors emphasize additional reasons why codon barcoding is useful. Mutation scanning, deep mutagenesis, and peptide duplication are what I think of as the most important examples, but there are likely others. Reducing read length requirements might also be compelling to some users, but more specifics should be provided on the actual benefit for standard libraries and standard read lengths.</p>
    <p>• The authors are inconsistent with the PhIP-Seq abbreviation. PhageIP-Seq is used occasionally, but it is unclear if this is intentional or in error. The most commonly used long form seems to be Phage ImmunoPrecipitation Sequencing (with no hyphen like what is in the title).</p>
    <p>Minor Issues</p>
    <p>• In the first paragraph, it is mentioned that peptide arrays have at most a few thousand antigens. There are certainly examples of more than a few thousand antigen arrays.</p>
    <p>• Padding shorter peptides with random amino-acid sequences downstream of a stop codon is also a feature highlighted in the pepsyn software so should be referenced as such.</p>
    <p>• Typo “DNWA”</p>
    <p>• It is mentioned that the 3’ suffix must start with a stop codon. However, many users may want to have an epitope tag or some other fusion peptide C-terminal to the peptide. Requiring a stop codon would also make the design incompatible with M13 phage display, which may also be of interest to some of your readers.</p>
    <p>• It is not clear how restriction sites are avoided during the peptide coding process. Could you provide additional information?</p>
    <p>• I had a hard time evaluating Fig 2b/c since the font was so small.</p>
    <p>• I believe the Y-axis title of Fig 2b has a typo.</p>
    <p>• The term “infectious diseases” is used where I think it is meant “Infectious organisms”.</p>
    <p>• In the paragraph above “Code Availability” section, FASTA files are referred to, but I believe it is meant “FASTQ”.</p>
    <p>• Define “IRIs”.</p>
    <p>• At the end of the Test Case section, the number 24,456 appears to have been incorrectly copied from above. The replacement should be 1,745 if I am not mistaken.</p>
    <p>• In the “Finding the Source of a Barcode” section, the authors suggest doing sequencing read mapping by alignment with errors allowed. However, certain oligo synthesis errors may prematurely truncate the peptide or be otherwise deleterious. So the pros and cons of taking this approach should be presented.</p>
    <p>• Fig. 2 only referred to only in Supplementary/Methods?</p>
    <p>• A typical peptide length and corresponding barcode length should be given with numbers. The qualitative descriptions are nice to read but some numbers to get an order of magnitude would be helpful.</p>
    <p>• The sentence “Figures were created with <ext-link xlink:href="http://Biorender.com”" ext-link-type="uri">Biorender.com”</ext-link> seems to be in the wrong place</p>
    <p>• It seems in the text that the software has three options for barcoding, but after checking the code, it seems only be able to do the third. Please clarify.</p>
    <p>• The example and default configurations should be mentioned in the methods text</p>
    <p>• hamming distance (2n+1) … please explain n for the unfamiliar reader.</p>
    <p>• Please clarify the meaning of this sentence: Due to computational limitations we performed each single simulation up to 107 sequences</p>
    <p>• “Multiple inserts” should be defined for the unfamiliar reader.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: <bold>No: </bold>I did not attempt to confirm</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010663.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010663.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010663" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">14 Aug 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010663.s004" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Point_by_point.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010663.s004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010663.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010663.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Dina Schneidman</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Dina Schneidman</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010663" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Sep 2022</named-content>
    </p>
    <p>Dear Ms Leviatan,</p>
    <p>We are pleased to inform you that your manuscript 'BIPS - a Code Base for Designing and Coding of a Phage ImmunoPrecipitation Oligo Library' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Please address the Reviewer 2 comment in the final version.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have comprehensively addressed my concerns. I believe they have also addressed those of the other reviewer. I commend them for this effort.</p>
    <p>Reviewer #2: The authors have addressed the issues I raised. However, in testing their code, I discovered a flaw that either should be fixed. The peptide coding nucleotide sequences are selected to avoid certain sequences such as those that will be used for downstream cloning. Currently, this happens before addition of prefix and suffix sequences. It is therefore possible (and quite likely in fact) that the avoided sequences are inadvertently introduced at the junction of the prefix and peptide encoding sequence and/or at the junction between the peptide coding sequence and the suffix. This can of course lead to truncation or complete loss of peptides during the library cloning process.</p>
    <p>Minor point. In response to one my comments, the authors write:</p>
    <p>"We stand corrected. ELISAs are usually limited to a few hundreds or thousands of oligos, but other</p>
    <p>peptide arrays can indeed get to tens of thousands."</p>
    <p>I'm not sure what this is supposed to mean about ELISAs, since they don't use oligos and they typically are not done for more than a very small number of antigens (1 to 10). My point in the original critique was about peptide arrays. The authors said these are limited to tens of thousands, but I have seen some with many more (e.g. those produced with micromirrors and photochemistry). But it is true that most peptide or protein arrays are in the 10s of thousands of antigens or less.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010663.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010663.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Dina Schneidman</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Dina Schneidman</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010663" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">3 Nov 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-22-00602R1 </p>
    <p>BIPS - a Code Base for Designing and Coding of a Phage ImmunoPrecipitation Oligo Library</p>
    <p>Dear Dr Leviatan,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofia Freund</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
