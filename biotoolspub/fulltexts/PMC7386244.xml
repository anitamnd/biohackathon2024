<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7386244</article-id>
    <article-id pub-id-type="pmid">32664861</article-id>
    <article-id pub-id-type="publisher-id">6832</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-06832-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Seamless integration of image and molecular analysis for spatial transcriptomics workflows</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bergenstråhle</surname>
          <given-names>Joseph</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Larsson</surname>
          <given-names>Ludvig</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4313-1601</contrib-id>
        <name>
          <surname>Lundeberg</surname>
          <given-names>Joakim</given-names>
        </name>
        <address>
          <email>joakim.lundeberg@scilifelab.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5037.1</institution-id><institution-id institution-id-type="ISNI">0000000121581746</institution-id><institution>Science for Life Laboratory, Department of Gene Technology, </institution><institution>KTH Royal Institute of Technology, </institution></institution-wrap>Tomtebodavägen 23, SE-171 65 Solna, Sweden </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>482</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Recent advancements in in situ gene expression technologies constitute a new and rapidly evolving field of transcriptomics. With the recent launch of the 10x Genomics Visium platform, such methods have started to become widely adopted. The experimental protocol is conducted on individual tissue sections collected from a larger tissue sample. The two-dimensional nature of this data requires multiple consecutive sections to be collected from the sample in order to construct a comprehensive three-dimensional map of the tissue. However, there is currently no software available that lets the user process the images, align stacked experiments, and finally visualize them together in 3D to create a holistic view of the tissue.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We have developed an R package named STUtility that takes 10x Genomics Visium data as input and provides features to perform standardized data transformations, alignment of multiple tissue sections, regional annotation, and visualizations of the combined data in a 3D model framework.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">STUtility lets the user process, analyze and visualize multiple samples of spatially resolved RNA sequencing and image data from the 10x Genomics Visium platform. The package builds on the Seurat framework and uses familiar APIs and well-proven analysis methods. An introduction to the software package is available at <ext-link ext-link-type="uri" xlink:href="https://ludvigla.github.io/STUtility_web_site/">https://ludvigla.github.io/STUtility_web_site/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Spatial transcriptomics</kwd>
      <kwd>Transcriptomics</kwd>
      <kwd>Genomics</kwd>
      <kwd>Software</kwd>
      <kwd>Visualization</kwd>
      <kwd>Image processing</kwd>
      <kwd>Data analysis</kwd>
      <kwd>R-package</kwd>
      <kwd>3D</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004063</institution-id>
            <institution>Knut och Alice Wallenbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007436</institution-id>
            <institution>Familjen Erling-Perssons Stiftelse</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002794</institution-id>
            <institution>Cancerfonden</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001729</institution-id>
            <institution>Stiftelsen för Strategisk Forskning</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004359</institution-id>
            <institution>Vetenskapsrådet</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009252</institution-id>
            <institution>Science for Life Laboratory</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007601</institution-id>
            <institution>Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007028</institution-id>
            <institution>Leona M. and Harry B. Helmsley Charitable Trust</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">Gene expression analysis has become a standard tool for the study of gene regulation, cellular state and biological function in both bulk and single cell samples. However, the transcriptional profiles of individual cells are influenced by their localization in the tissue. As such, important information for the complete understanding of the biological underpinnings reflected in the transcriptional state requires simultaneous knowledge about morphological context [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Recent technological advances have enabled this spatial information to be simultaneously obtained together with quantitative transcript measurements.</p>
    <p id="Par13">Spatial Transcriptomics (ST) is a method [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>] that can be used to profile the transcriptome of tissues spatially and is today widely accessible using the 10x Genomics Visium platform. Overall, the spatial methods are quickly gaining traction among researchers, and lately several computational software packages have been released with support for spatial analyses [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. However, there is currently no software package for ST data that lets the user process the images, align stacked experiments, and finally visualize them together in 3D to create a holistic view of the tissue.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par14">Here, we present STUtility, an R package that conveniently enables the user to perform these tasks. STUtility can be used for normalization, identification of spatial expression patterns alignment of consecutive stacked tissue images and visualizations. STUtility builds on the Seurat framework and uses familiar APIs and well-proven analysis methods. STUtility uses RNA count and image data as input. Specifically, it is created with compatibility for using 10x Genomics Space Ranger output, which is a set of analysis pipelines provided by 10x Genomics that process raw Visium RNA-seq and image data (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/software">https://support.10xgenomics.com/spatial-gene-expression/software</ext-link>). All analysis, image processing and visualization in STUtility is conducted within R.</p>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <p id="Par15">The poly A targeted whole transcriptomics spatial methods are continuously improving the boundaries of cellular resolution. Nevertheless, the commercially available alternatives have not yet reached single-cell level, and, in their current format, typically capture transcripts from multiple cells in each spatial measurement spot. Although the data is derived from a mixture of cells, its characteristics are similar to those of single-cell RNA-seq (scRNA-seq) [<xref ref-type="bibr" rid="CR8">8</xref>]. One of the main challenges in both ST and scRNA-seq, from a data analysis perspective, is the sparsity of the data (capture efficiency). Moreover, differences in tissue permeabilization, reverse transcription efficiency and other sources of technical noise may elevate the challenges. Hence, data transformation and normalization prior to various downstream analysis steps plays a major role in the ability to correctly characterize meaningful biological regional differences in transcriptional profiles [<xref ref-type="bibr" rid="CR9">9</xref>]. Technical variation is further increased by the fact that comprehensive tissue models usually consist of multiple tissue sections, which may have been sequenced at different points in time, using different capture arrays, and with slightly different conditions. Various data transformation strategies have been proposed, and current state-of-the-art normalization methods for scRNA-seq data are based on statistical modeling. For example, SCTransform is a method available in the Seurat v3 R package [<xref ref-type="bibr" rid="CR8">8</xref>] that uses a regularized negative binomial regression model and manages to retain the biological heterogeneity within the tissue sections while still being able to remove much of the technical variation. Seurat is widely used within the field, displays good performance in benchmarking studies [<xref ref-type="bibr" rid="CR10">10</xref>], is frequently updated and works well with larger data sets [<xref ref-type="bibr" rid="CR11">11</xref>]. Accordingly, we have chosen to build our visualization tool on top of the Seurat framework.</p>
    <p id="Par16">As an introduction to STUtility, we have established a website (<ext-link ext-link-type="uri" xlink:href="https://ludvigla.github.io/STUtility_web_site/">https://ludvigla.github.io/STUtility_web_site/</ext-link>) that outlines its functionality and provides examples of the available features. Here, we give a short demonstration of the capabilities by using publicly available 10x Genomics Visium and in-house generated ST data. The complete STUtility workflow is conducted within R (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The input to STUtility consists of count files and bright field image data from Hematoxylin and Eosin (H&amp;E) stained tissue sections, and all Seurat functions for handling and transforming the data can be utilized. On top of this, STUtility adds multiple features for spatial analysis, image processing and visualization.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic overview of the procedure, from tissue collection to final visualization of the data analysis results. <bold>a</bold> Thin tissue sections are placed on the ST/Visium array. Barcoded capture-probes store spatial information which is added to the captured transcript prior to sequencing. Imaging data is obtained by microscopy of stained tissue sections. The sequencing data is used as input to demultiplexing and transcript quantification pipelines. The count data together with the image data are used as inputs to STUtility. Image processing (including masking and alignment), and all further data analysis (e.g. dimensionality reduction, factor analysis, identification of spatially correlated genes) is conducted within R. <bold>b</bold> Spatial autocorrelation. Two vectors are defined: (i) the original expression vector for each gene and each capture-spot and (ii) the Spatial lag expression vector, which for each capture-spot and gene takes the summed expression of up to six neighbors. Spatial autocorrelation is defined as the Pearson correlation between the two vectors (i) and (ii) with the rationale that genes with spatial structure will display a higher correlation to their neighbors. <bold>c</bold> The aligned images can be visualized in a turntable 3D model within R in which a combination of features can be visualized. Here, the NMF factors of the tissue are shown in the HSV color scale</p></caption><graphic xlink:href="12864_2020_6832_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par17">The image processing procedure includes (i) masking the tissue to remove the array background from the image, (ii) automatic alignment of multiple samples, or (iii) manual alignment with an interactive Shiny R application.</p>
    <p id="Par18">The masking procedure converts a low-resolution representation of the HE images into “superpixels”, followed by k-means clustering into two groups to segment out the areas located inside or outside of the tissue (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). For the automatic alignment strategy, a reference image is selected and the remaining images are then aligned to the reference using an iterative closest point algorithm (ICP) [<xref ref-type="bibr" rid="CR12">12</xref>] (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). The ICP algorithm finds a transformation matrix that maps coordinates from each sample to the reference and can handle rigid transformations, i.e. offsets along the x and y axis (translations), rotations and reflections. If the automatic alignment fails, the transformation matrix can be found by manually aligning the images in a user interface (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2). The user can choose to utilize the masked and aligned images in all subsequent STUtility plotting functions. Moreover, the aligned images can be stacked to create a turntable 3D model of the tissue, which e.g. can be used to visualize gradually shifting changes in gene expression (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3). This 3D model is constructed by running a simple cell segmentation on each aligned tissue section based on intensity differences compared to the non-nuclei compartments of the cell to produce 2D point patterns. Although not offering a precise cell segmentation, this approach is able to sufficiently capture the overall morphological structure of the tissue in a time efficient manner (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4). The complete 3D stack is then created by assigning a z-coordinate to each 2D point pattern of nuclei from each tissue section, whereupon various strategies for visualization can applied. For example, STUtility provides a multiple feature view using the HSV color scale (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5) to visualize the spatial localization of non-overlapping features as exemplified in mouse hippocampus. Each selected feature is assigned a unique color defined by splitting the hue parameter into even breaks. Next, the feature values are rescaled to values between 0 and 1 and encoded in the V-channel. Then, for each spot, the feature with the highest value is selected to color the spot based on the feature associated hue and value. A value of zero gives the capture area a black color regardless of feature, whereas higher values increase the intensity of the corresponding feature color. This allows for simultaneous visualization of multiple non-overlapping features, giving a clear representation of, for example, distinct factor-based transcriptomic profiles of interest.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Spatial analysis of sagittal mouse brain and human breast cancer samples. <bold>a</bold> NMF identifies multiple spatially distinct factors within the mouse brain (4 separate tissue sections) that are visualized in the HSV color scale. <bold>b</bold> Visualization of driver genes of some of the NMF factors seen in (<bold>a</bold>). <bold>c</bold> NMF factor with clear histological relevance corresponding to a tumor area within the breast cancer samples. <bold>d</bold> Example of a top-ranking gene, <italic>Fth1</italic>, according to the proposed spatial autocorrelation metric performed on two adjacent sections to increase the robustness of the analysis. <bold>e</bold> NMF factors were clustered in Seurat, and capture-spots neighboring to one of the tumor clusters were automatically extracted by STUtility (left) for a differential expression analysis between core and tumor edge. The core and tumor edge display significant differences in expression of various immunoglobulin and Extracellular Matrix (ECM) related genes (right)</p></caption><graphic xlink:href="12864_2020_6832_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par19">Added analysis functionality includes a Non-negative Matrix Factorization (NMF) [<xref ref-type="bibr" rid="CR13">13</xref>] to decompose ST data into a lower dimensional space (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-c), a test to rank genes by degree of spatial autocorrelation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and a method for identification and extraction of neighboring capture-spots to a region of interest within a connected spatial network (Figs. <xref rid="Fig1" ref-type="fig">1</xref>b and <xref rid="Fig2" ref-type="fig">2</xref>e). The ranking method makes use of connection networks (or neighboring graphs) where each capture-spot (node) is connected to neighboring spots located within or close to the minimum center to center distance (i.e. 100 μm for Visium arrays) to form a local neighborhood. Neighborhood networks can be defined across multiple sections simultaneously and then used to compute the spatial lag for each gene, defined as the summed expression of that gene across the connected spots. Each gene is then ranked by the Pearson correlation between the lag vector and the original expression vector in decreasing order. The same connection network can be used for extracting neighboring capture-spots for a region of interest. This method can for example be used on cancer tissue as a tool to automatically define the border surrounding a tumor region to study tumor heterogeneity represented by unique transcriptome signatures within the tumor core compared to tumors along the tumor front (edge) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e).</p>
    <p id="Par20">STUtility also includes a manual annotation tool based on the Shiny R framework. The manual annotation tool allows the user to interactively select and label individual or sets of capture areas. These labels are saved within the S4 object and can be used, for example, during supervised differential gene expression (DGE) between regions of interest.</p>
    <p id="Par21">To demonstrate the STUtility workflow for ST and 10x Visium data, we performed analyses of multiple tissues from mouse and humans (as exemplified below). An identical workflow was used for all sample types to demonstrate the usability of the general workflow: NMF was used to uncover low-dimensional structure of tissues based on the high-dimensional count data and the spatial autocorrelation test was used to find genes with clear spatial patterns. Various visualization strategies available in STUtility after the image processing steps where then utilized to explore the results.</p>
    <p id="Par22">In <italic>mouse brain</italic> samples, multiple distinct factors could be extracted with well-defined spatial patterns (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-b), and the top ranked genes from the spatial autocorrelation test displayed clear spatial dependencies in their expression (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6). In the <italic>breast cancer</italic> tissue samples, clearly separated areas of tumor cells can be defined from the H&amp;E images by histopathology. However, the morphological features alone do not show the remarkable heterogeneity of cellular states present within the tumor. Using the NMF based factor analysis in STUtility, this diversity can be comprehensibly visualized, and driver genes for the different tumor areas can be identified to strengthen the mechanistic interpretation (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7). The driver genes reveal a striking difference in ongoing cellular dynamics at the time of sampling. For example, one of the tumor areas factors (factor_3) is driven by immune response related genes (CPB1, HLA-B/C, PSMB8, IL6ST). Another factor instead displays a unique expression profile of markers previously shown to be dysregulated in various tumor types (e.g. <italic>MGP, S100, TFF3</italic>) [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. Factor_7 on the other hand is concentrated to a small region between tumor areas with a strong signature for the presence and regulation of T and B cells (CCL19, TRBC2, CD52, MS4A1, TRAC), possibly forming a tertiary lymphoid structure [<xref ref-type="bibr" rid="CR17">17</xref>]. Exploring further, observations from the outer region (leading edge) of the tumor area with elevated immune activity found earlier can be automatically extracted from the neighborhood network constructed by STUtility. Differential expression analysis (DEA) displays high expression of immunoglobulin genes in the outer (tumor leading edge) region compared to the inner core region of the tumor (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). Clusters can favorably be visualized using the split view functionality (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8). In the <italic>lymph node</italic> sample, the NMF based factor analysis reveals several distinct spatial patterns; factor_1 associated with an anti-viral response within a smaller sub-area of the lymph node and factor_2 and factor_4 showing clear signatures of T cell and Plasma cell activity (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S9). Finally, <italic>rheumatoid arthritis</italic> samples were used to demonstrate the 3D application to a sample set consisting of multiple consecutive ST sections. The user can contract or expand the space between the sections, in order to either create a dense point cloud reflecting actual distance or introduce spacing for easier identification of feature transitions between sections (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S10). Overall, the spatially resolved data, analyzed using STUtility, is able to present a landscape view about the ongoing cellular states of the tissue.</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p id="Par23">Most of the spatial transcriptomics methods to date are based on using thin tissue sections, approximately the thickness of a cell, resulting in a 2D picture of the transcriptional state at a certain point in time at the precise location of sampling within the whole tissue. In order to achieve a comprehensive profile, multiple sections can be consecutively sectioned and aligned. The aligned images can then also be used to create a 3D model for visualization purposes. However, there is currently no tool available that performs this alignment or visualization in an easy and automatic fashion. Moreover, manual alignment quickly becomes cumbersome for large image stacks.</p>
    <p id="Par24">Here, we presented STUtility, a tool that deliver a complete workflow for spatial transcriptomics data, from sequencing and image data processing to the creation of a final 3D model of the tissue. The tool handles data from previous ST arrays [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] and 10x Genomics Visium arrays and is delivered as an open and accessible R package.</p>
  </sec>
  <sec id="Sec5">
    <title>Availability and requirements</title>
    <p id="Par25">STUtility is compatible with R version &gt; = 3.6 and has the following dependencies: akima (&gt; = 0.6), imager (&gt; = 0.41), magick (&gt; = 2.0), Matrix (&gt; = 1.2), Morpho (&gt; = 2.7), Rvcg (&gt; = 0.18), Seurat (&gt; = 3.0.0), spatstat (&gt; = 1.61), viridis (&gt; = 0.5), data.table (&gt; = 1.12.2), ggplot2 (&gt; = 3.2), ggiraph (&gt; = 0.6), imagerExtra (&gt; = 1.3.2), NMLM (&gt; = 0.4.3), raster (&gt; = 3.0), reshape2 (&gt; = 1.4.3), scales (&gt; = 1.0), shinyjs (&gt; = 1.0), SingleCellExperiment (&gt; = 1.2). STUtility is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jbergenstrahle/STUtility">https://github.com/jbergenstrahle/STUtility</ext-link>.</p>
  </sec>
  <sec id="Sec6">
    <title>Methods</title>
    <sec id="Sec7">
      <title>Data input and transformation</title>
      <p id="Par26">The same workflow was used for all samples: The count and image data were used as input to STUtility, and filtering was performed to remove lowly abundant genes and capture-spots with too little information by thresholding on the raw count values. The <italic>SCTransform</italic> function in Seurat was used to normalize the data.</p>
    </sec>
    <sec id="Sec8">
      <title>Factor analysis and clustering</title>
      <p id="Par27">Non-negative Matrix Factorization (NMF) was used to decompose the normalized data into factor activities. The NMF method can be accessed through the <italic>RunNMF</italic> function in STUtility which is created based on a method described earlier [<xref ref-type="bibr" rid="CR13">13</xref>], using Independent Component Analysis (ICA) as initialization method and non-negative transformed Pearson residuals as input data. In short, the NMF method decomposes the gene expression matrix A into two non-negative matrices A = WH, where W is the feature loadings matrix (features x factors) and H is a matrix representing the data in a low dimensional space (factors x spots). Gene drivers were selected for each factor by extracting the top ranked features in the feature loadings matrix W. The low dimensional representation was then used as input to the Seurat functions <italic>FindNeighbors</italic> and <italic>FindClusters</italic>.</p>
    </sec>
    <sec id="Sec9">
      <title>Spatial autocorrelation</title>
      <p id="Par28">Specific genes demonstrating spatial patterns were obtained with a ranking method for spatial autocorrelation, where a connection network for each capture-spot is created based on the distance between the spot and its neighbors. The threshold for classifying a spot as a “neighbor” was set to 150 μm. The networks were used to compute the spatial lag for each gene, defined as the summed expression of that gene across the spots classified as neighbors to the capture-spot under consideration. The Pearson correlation between the spatial lag vector and the normalized count vector was then used to determine the overall spatial correlation across the tissue section. To demonstrate the validity of using the Pearson correlation for this usage, a code notebook demonstration is provided in Additional file <xref rid="MOESM6" ref-type="media">6</xref>.</p>
    </sec>
    <sec id="Sec10">
      <title>Differential gene expression</title>
      <p id="Par29">DEA between the outer and the inner region of the tumor was conducted with the <italic>FindMarkers</italic> function provided in the Seurat R package, after detecting the border capture-spots with the <italic>RegionNeighbours</italic> function in STUtility. The <italic>FindMarkers</italic> function was run with default parameters, which imply a non-parametric Wilcoxon rank sum test.</p>
    </sec>
    <sec id="Sec11">
      <title>Image processing – masking</title>
      <p id="Par30">Prior to visualization of results, image processing was performed. First, the H&amp;E images were downscaled to a width of 400 pixels with retained aspect ratios, do demonstrate this ability which is used to reduce memory demands. A threshold was put on the downscaled images using Otsu’s method as implemented in the threshold function of the imager R package. Isotropic blurring was applied to the images, and a Simple Linear Iterative Clustering (SLIC) algorithm was used to convert the images into superpixels [<xref ref-type="bibr" rid="CR19">19</xref>], i.e. a clustering of pixels based on color similarity in the image plane. Finally, k-means (<italic>kmeans</italic> function in the stats package, with k = 2) clustering was used to segment the images into two regions: inside/outside tissue. A visual demonstration of the masking process is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Image processing – alignment</title>
      <p id="Par31">Alignment of the tissue sections was performed by ICP as implemented in the R package Morpho, using the first image as reference. As input to the ICP algorithm, we used the pixel coordinates of the edges of the tissue defined during the masking procedure. First, the tissue edges are detected from the previously defined image masks by computing an image gradient (<italic>imgradient</italic> in imager R package). Next, the tissue edge pixel coordinates are extracted from the images and leveraged into the ICP method, computed for each pair of target samples and reference. The ICP method returns a transformation matrix for each sample that can be used to map coordinates between the sample and reference. The image alignment is then performed using the <italic>imwarp</italic> function (imager R package) using the transformation matrix defined by ICP as the mapping function. To achieve a smooth transformation of the images, the direction was set to “backward” with a “cubic” interpolation.</p>
      <p id="Par32">For specific parameters used during the filtering and factor analysis steps, see the individual RMarkdown files for each sample (Additional files <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec13">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12864_2020_6832_MOESM1_ESM.docx">
          <caption>
            <p><bold>Additional file 1:</bold> A step by step description of the masking procedure.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="12864_2020_6832_MOESM2_ESM.docx">
          <caption>
            <p><bold>Additional file 2:</bold> Supplementary figure S1-S10.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="12864_2020_6832_MOESM3_ESM.rmd">
          <caption>
            <p><bold>Additional file 3:</bold> RMarkdown which includes the analysis of the 10x Genomics public data sets.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="12864_2020_6832_MOESM4_ESM.rmd">
          <caption>
            <p><bold>Additional file 4:</bold> RMarkdown which includes the 3D view of rheumatoid arthritis data.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="12864_2020_6832_MOESM5_ESM.rmd">
          <caption>
            <p><bold>Additional file 5:</bold> RMarkdown on how to use the RegionNeighbours function.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="12864_2020_6832_MOESM6_ESM.html">
          <caption>
            <p><bold>Additional file 6:</bold> HTML notebook demonstrating spatial autocorrelation.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DGE</term>
        <def>
          <p id="Par4">Differential gene expression</p>
        </def>
      </def-item>
      <def-item>
        <term>HSV</term>
        <def>
          <p id="Par5">Hue, Saturation, and Value</p>
        </def>
      </def-item>
      <def-item>
        <term>ICA</term>
        <def>
          <p id="Par6">Independent Component Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>ICP</term>
        <def>
          <p id="Par7">Iterative closest point</p>
        </def>
      </def-item>
      <def-item>
        <term>NMF</term>
        <def>
          <p id="Par8">Non-negative matrix factorization</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par9">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SLIC</term>
        <def>
          <p id="Par10">Simple Linear Iterative Clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>ST</term>
        <def>
          <p id="Par11">Spatial transcriptomics</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-020-06832-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Ludvig Bergenstråhle for valuable feedback on the manuscript and the National Genomics Infrastructure (NGI), Sweden and SNIC/UPPMAX for providing sequencing and computational infrastructure support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>J.B and L. L contributed equally to this work. J. L supervised and gave valuable input to the project. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The work was financially supported by the Knut and Alice Wallenberg Foundation, Erling Persson Family Foundation, Swedish Cancer Society, Swedish Foundation for Strategic Research, Swedish Research Council, SciLifeLab, EU Horizon 2020 projects HUGODECA (ID 874741), discovAIR (ID 874656), EASI Genomics (824110) and the Helmsley Charitable Trust Gut Cell Atlas initiative. Open access funding provided by Royal Institute of Technology.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>STUtility is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jbergenstrahle/STUtility">https://github.com/jbergenstrahle/STUtility</ext-link>. The source code of STUtility is freely available under the MIT license. RMarkdown documents with the code to produce the results and figures are found in Additional files <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>. A tutorial and online documentation is provided at <ext-link ext-link-type="uri" xlink:href="https://ludvigla.github.io/STUtility_web_site/">https://ludvigla.github.io/STUtility_web_site/</ext-link>.</p>
    <p>ST mouse brain samples shown for demonstration purposes of image alignment are included in the R package as example data. These samples are processed according to the Spatial Transcriptomics method described earlier [<xref ref-type="bibr" rid="CR1">1</xref>]. For the RA samples, H&amp;E images and count matrices were downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.spatialresearch.org/resources-published-datasets/">https://www.spatialresearch.org/resources-published-datasets/</ext-link> licensed under the Creative Commons Attribution license. 10x Visium data were downloaded from the publicly available datasets on the 10x Genomics website (<ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/resources/datasets/">https://www.10xgenomics.com/resources/datasets/</ext-link>) licensed under the Creative Commons Attribution license. Specifically, the following data sets were used: Mouse Brain Serial Sections (Sagittal-Posterior library T1T2-F3, H3 and Sagittal-Anterior library T1T2-G3, A4). Human Breast Cancer (Block A Section 1 and 2, library T1T2-F10 and T1T2-H10) Human Lymph Node (library T1T2-E3).</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par33">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par34">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par35">J.L is a scientific advisor at 10x Genomics Inc., which holds IP rights to the ST technology.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ståhl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Salmén</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lundmark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Westholm</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Huss</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>78</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id>
        <pub-id pub-id-type="pmid">27365449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maniatis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Braine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mollbrink</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fagegaltier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Andrusivová</surname>
            <given-names>Ž</given-names>
          </name>
          <name>
            <surname>Saarenpää</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saiz-Castro</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatiotemporal dynamics of molecular pathology in amyotrophic lateral sclerosis</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>364</volume>
        <fpage>89</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aav9776</pub-id>
        <pub-id pub-id-type="pmid">30948552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fürth</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wärdell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reimegård</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salmén</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <fpage>1647</fpage>
        <lpage>1660.e1619</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.11.025</pub-id>
        <pub-id pub-id-type="pmid">31835037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>SpatialDE: identification of spatially variable genes</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>343</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4636</pub-id>
        <pub-id pub-id-type="pmid">29553579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Queen R, Cheung K, Lisgo S, Coxhead J, Cockell S. Spaniel: analysis and interactive sharing of spatial transcriptomics data. bioRxiv. 2019:619197..</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edsgard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Johnsson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identification of spatial expression trends in single-cell gene expression data</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>339</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4634</pub-id>
        <pub-id pub-id-type="pmid">29553578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Dries R, Zhu Q, Eng C-HL, Sarkar A, Bao F, George RE, Pierson N, Cai L, Yuan G-C. Giotto, a pipeline for integrative analysis and visualization of single-cell spatial transcriptomic data. bioRxiv. 2019:701680.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>296</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1874-1</pub-id>
        <pub-id pub-id-type="pmid">31870423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1145</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3711</pub-id>
        <pub-id pub-id-type="pmid">27824854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duò</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</article-title>
        <source>F1000Res</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>1141</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.15666.2</pub-id>
        <pub-id pub-id-type="pmid">30271584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Székely</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Statistical shape and deformation analysis: methods, implementation and applications</source>
        <year>2017</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Academic, an imprint of Elsevier</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Lin X, Boutros PC. Optimization and expansion of non-negative matrix factorization. BMC Bioinformatics. 2020;21:7.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caiado</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Conceição</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tiago</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Marreiros</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vicente</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Enriquez</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Antunes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guerreiro</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Caldeira</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cancela</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of MGP gene expression in colorectal cancer</article-title>
        <source>Gene</source>
        <year>2020</year>
        <volume>723</volume>
        <fpage>144120</fpage>
        <pub-id pub-id-type="doi">10.1016/j.gene.2019.144120</pub-id>
        <pub-id pub-id-type="pmid">31589964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y-L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J-X</given-names>
          </name>
        </person-group>
        <article-title>Prognostic roles of mRNA expression of S100 in non-small-cell lung cancer</article-title>
        <source>Biomed Res Int</source>
        <year>2018</year>
        <volume>2018</volume>
        <fpage>11</fpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Overexpression of trefoil factor 3 (TFF3) contributes to the malignant progression in cervical cancer cells</article-title>
        <source>Cancer Cell Int</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s12935-016-0379-1</pub-id>
        <pub-id pub-id-type="pmid">28070169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neyt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Perros</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>GeurtsvanKessel</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Hammad</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Tertiary lymphoid organs in infection and autoimmunity</article-title>
        <source>Trends Immunol</source>
        <year>2012</year>
        <volume>33</volume>
        <fpage>297</fpage>
        <lpage>305</lpage>
        <pub-id pub-id-type="doi">10.1016/j.it.2012.04.006</pub-id>
        <pub-id pub-id-type="pmid">22622061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carlberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Korotkova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Catrina</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Ståhl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Malmström</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Exploring inflammatory signatures in arthritic joint biopsies with spatial Transcriptomics</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>18975</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-55441-y</pub-id>
        <pub-id pub-id-type="pmid">31831833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stutz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hermans</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leibe</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Superpixels: an evaluation of the state-of-the-art</article-title>
        <source>Comput Vis Image Underst</source>
        <year>2018</year>
        <volume>166</volume>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cviu.2017.03.007</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
