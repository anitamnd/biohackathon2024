<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5354375</article-id>
    <article-id pub-id-type="pmid">28301504</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-16-41349</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0171142</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Visualization</subject>
          <subj-group>
            <subject>Infographics</subject>
            <subj-group>
              <subject>Graphs</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subj-group>
              <subject>Genetic Networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Genetic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Vertebrates</subject>
              <subj-group>
                <subject>Amniotes</subject>
                <subj-group>
                  <subject>Birds</subject>
                  <subj-group>
                    <subject>Fowl</subject>
                    <subj-group>
                      <subject>Gamefowl</subject>
                      <subj-group>
                        <subject>Chickens</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Vertebrates</subject>
              <subj-group>
                <subject>Amniotes</subject>
                <subj-group>
                  <subject>Birds</subject>
                  <subj-group>
                    <subject>Poultry</subject>
                    <subj-group>
                      <subject>Chickens</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Gene Regulatory Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Regulatory Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Graph Theory</subject>
          <subj-group>
            <subject>Directed Graphs</subject>
            <subj-group>
              <subject>Directed Acyclic Graphs</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Graph Theory</subject>
            <subj-group>
              <subject>Directed Graphs</subject>
              <subj-group>
                <subject>Directed Acyclic Graphs</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Probability Distribution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Identification of marginal causal relationships in gene networks from observational and interventional expression data</article-title>
      <alt-title alt-title-type="running-head">Marginal causal relationships in gene networks</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Monneret</surname>
          <given-names>Gilles</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jaffrézic</surname>
          <given-names>Florence</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rau</surname>
          <given-names>Andrea</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zerjal</surname>
          <given-names>Tatiana</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nuel</surname>
          <given-names>Grégory</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>UMR GABI, AgroParisTech, INRA, Université Paris-Saclay, 78350 Jouy-en-Josas, France</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>LPMA, UMR CNRS 7599, UPMC, Sorbonne Universités, 4 place Jussieu, 75005 Paris, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Emmert-Streib</surname>
          <given-names>Frank</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Tampere University of Technology, FINLAND</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>
          <list list-type="simple">
            <list-item>
              <p><bold>Conceptualization:</bold> GM FJ AR TZ GN.</p>
            </list-item>
            <list-item>
              <p><bold>Formal analysis:</bold> GM FJ AR GN.</p>
            </list-item>
            <list-item>
              <p><bold>Investigation:</bold> TZ.</p>
            </list-item>
            <list-item>
              <p><bold>Methodology:</bold> GM FJ AR TZ GN.</p>
            </list-item>
            <list-item>
              <p><bold>Resources:</bold> TZ.</p>
            </list-item>
            <list-item>
              <p><bold>Software:</bold> GM FJ AR TZ GN.</p>
            </list-item>
            <list-item>
              <p><bold>Validation:</bold> GM FJ AR TZ GN.</p>
            </list-item>
            <list-item>
              <p><bold>Writing – original draft:</bold> GM FJ AR.</p>
            </list-item>
          </list>
        </p>
      </fn>
      <corresp id="cor001">* E-mail: <email>gilles.monneret@upmc.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>3</issue>
    <elocation-id>e0171142</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Monneret et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Monneret et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0171142.pdf"/>
    <abstract>
      <p>Causal network inference is an important methodological challenge in biology as well as other areas of application. Although several causal network inference methods have been proposed in recent years, they are typically applicable for only a small number of genes, due to the large number of parameters to be estimated and the limited number of biological replicates available. In this work, we consider the specific case of transcriptomic studies made up of both observational and interventional data in which a single gene of biological interest is knocked out. We focus on a marginal causal estimation approach, based on the framework of Gaussian directed acyclic graphs, to infer causal relationships between the knocked-out gene and a large set of other genes. In a simulation study, we found that our proposed method accurately differentiates between downstream causal relationships and those that are upstream or simply associative. It also enables an estimation of the total causal effects between the gene of interest and the remaining genes. Our method performed very similarly to a classical differential analysis for experiments with a relatively large number of biological replicates, but has the advantage of providing a formal causal interpretation. Our proposed marginal causal approach is computationally efficient and may be applied to several thousands of genes simultaneously. In addition, it may help highlight subsets of genes of interest for a more thorough subsequent causal network inference. The method is implemented in an R package called <monospace>MarginalCausality</monospace> (available on <ext-link ext-link-type="uri" xlink:href="https://github.com/Monneret/MarginalCausality">GitHub</ext-link>).</p>
    </abstract>
    <funding-group>
      <funding-statement>The authors received 18500€ from Institut National de la Recherche Agronomique Jouy-en-Josas for this work (<ext-link ext-link-type="uri" xlink:href="http://www.jouy.inra.fr/">http://www.jouy.inra.fr/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="1"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>These data are available at GEO under the GEO accession number GSE91084.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>These data are available at GEO under the GEO accession number GSE91084.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Causal network inference is of great interest in systems biology, particularly for transcriptomic studies that aim to identify regulatory relationships among genes, i.e., gene regulatory networks. In the context of probabilistic graphical models, several algorithms have been proposed to infer the skeleton of directed, undirected, or partially-directed graphs using conditional independence tests [<xref rid="pone.0171142.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0171142.ref002" ref-type="bibr">2</xref>], score-based procedures [<xref rid="pone.0171142.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0171142.ref006" ref-type="bibr">6</xref>] or mutual information [<xref rid="pone.0171142.ref007" ref-type="bibr">7</xref>–<xref rid="pone.0171142.ref010" ref-type="bibr">10</xref>]. These skeletons correspond to an equivalence class, i.e. an indistinguishable subset of graphs. Undirected graphs can be used to obtain a supergraph of the skeleton of a directed graph, which is a good starting point to infer causality when the underlying graph is unknown. Several undirected network inference methods, based on the parsimonious estimation of the inverse covariance matrix, have also been proposed for Gaussian graphical models [<xref rid="pone.0171142.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0171142.ref012" ref-type="bibr">12</xref>]. Although methods based on mutual information can also be used to infer the full graph of undirected networks [<xref rid="pone.0171142.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0171142.ref014" ref-type="bibr">14</xref>], estimating causal networks with these algorithms tends to be very computationally demanding and applicable only for low-dimensional networks. In addition, such approaches require a significant amount of interventional data to reduce the space of equivalent networks [<xref rid="pone.0171142.ref015" ref-type="bibr">15</xref>]. However, even with a sufficient amount of interventional data, i.e. roughly one knock-out for each gene, a directed acyclic graph (DAG) cannot generally be accurately estimated [<xref rid="pone.0171142.ref016" ref-type="bibr">16</xref>], perhaps due to the heterogeneous coverage of the gene network space [<xref rid="pone.0171142.ref017" ref-type="bibr">17</xref>]. As such, in this work we focus on estimating a few causal effects rather than attempting to infer the full network [<xref rid="pone.0171142.ref018" ref-type="bibr">18</xref>].</p>
    <p>In order to reduce the complexity of the parameter search space, a topological ordering of nodes in the graph can be estimated instead of an exact network. As shown by Rau <italic>et al.</italic> [<xref rid="pone.0171142.ref019" ref-type="bibr">19</xref>], a rich set of interventional data allows the node ordering associated with a DAG to be identified. In many transcriptomic experiments, however, only a small number of interventions are available; in this work, we consider the specific case of a knock-out intervention being performed on a single gene of interest. In such a case, only a restricted equivalence class is identifiable [<xref rid="pone.0171142.ref020" ref-type="bibr">20</xref>], and it is reasonable to instead consider a marginal approach to estimate only the causal effects of the knocked-out gene of interest on another set of genes.</p>
    <p>To this end, we propose a method to identify downstream causal relationships between a knocked-out gene and all other genes from replicated observational (steady state) transcriptomic data arising from an unknown graph. We first present a brief introduction to graphical models, which we use to define our model and hypothesis. The use of a mathematical operator to describe the intervention process, as defined by Pearl [<xref rid="pone.0171142.ref021" ref-type="bibr">21</xref>], allows the idea of causality to be formally defined in the model. This enables a closed-form expression of the likelihood to be obtained. We then illustrate the interest of our method on a set of simulated data, and we apply it to a set of microarray data from chickens carrying a functional knock-out of the growth hormone receptor gene [<xref rid="pone.0171142.ref022" ref-type="bibr">22</xref>]. The main advantages of the proposed marginal causal approach are that 1) it enables the accurate differentiation of downstream causal relationships from those that are upstream or simply associative; 2) it is computationally efficient, and thus simultaneously applicable to several thousands of genes; and 3) it provides a formal framework for causal interpetation. The proposed method is implemented in an R package called <monospace>MarginalCausality</monospace>, freely available on <ext-link ext-link-type="uri" xlink:href="https://github.com/Monneret/MarginalCausality">GitHub</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Gaussian causal models</title>
      <p>A directed graph <inline-formula id="pone.0171142.e001"><alternatives><graphic xlink:href="pone.0171142.e001.jpg" id="pone.0171142.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> is a set of nodes <bold><italic>V</italic></bold> and edges <inline-formula id="pone.0171142.e002"><alternatives><graphic xlink:href="pone.0171142.e002.jpg" id="pone.0171142.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mi mathvariant="script">E</mml:mi></mml:math></alternatives></inline-formula>. For <inline-formula id="pone.0171142.e003"><alternatives><graphic xlink:href="pone.0171142.e003.jpg" id="pone.0171142.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script">E</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <italic>X</italic> is said to be a parent of <italic>Y</italic> (<italic>X</italic> ∈ <monospace>pa</monospace>(<italic>Y</italic>)), or <italic>Y</italic> a child of <italic>X</italic>, if an edge starts at <italic>X</italic> and points to <italic>Y</italic>. A directed path is a succession of nodes such that each element is a parent of the following node. A graph is said to be acyclic if there is no directed path from a node back to itself. It is then called a DAG.</p>
      <p>A probability density <italic>P</italic> can be associated with a DAG. Assuming that all variables are Gaussian, such that the joint probability is a multivariate Gaussian distribution, the following factorization holds for the joint density of the graph:
<disp-formula id="pone.0171142.e004"><alternatives><graphic xlink:href="pone.0171142.e004.jpg" id="pone.0171142.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mtext mathvariant="monospace">pa</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
Two graphs are said to be Markov equivalent if they have the same joint probability distribution; in this case, they belong to the same equivalence class. The mathematical <monospace>do</monospace>(<italic>X</italic> = <italic>x</italic>) operator [<xref rid="pone.0171142.ref021" ref-type="bibr">21</xref>] can be graphically defined by deleting all edges pointing from <monospace>pa</monospace>(<italic>X</italic>) to <italic>X</italic>. For the associated probability distribution, this corresponds to replacing the conditional distribution <italic>f</italic> (<italic>X</italic>| <monospace>pa</monospace>(<italic>X</italic>)) by <bold>1</bold><sub><italic>X</italic> = <italic>x</italic></sub>.</p>
    </sec>
    <sec id="sec004">
      <title>Model selection</title>
      <p>Consider a graph <inline-formula id="pone.0171142.e005"><alternatives><graphic xlink:href="pone.0171142.e005.jpg" id="pone.0171142.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> where an intervention was performed on a single node of interest <italic>G</italic>. Two kinds of causality can be defined: 1) upstream causality, which refers to edges pointing to <italic>G</italic>; and 2) downstream causality, which refers to edges pointing away from <italic>G</italic>. With the <monospace>do</monospace> operator defined above, when an intervention is performed on a single node <italic>G</italic>, it is possible to identify genes with a downstream causal relationship to <italic>G</italic>, i.e. the causal effects of <italic>G</italic> on all of the other nodes in the network (see <xref ref-type="fig" rid="pone.0171142.g001">Fig 1</xref> for an illustration of upstream and downstream causal relationships).</p>
      <fig id="pone.0171142.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Illustration of upstream and downstream causality.</title>
          <p>Nodes <italic>X</italic><sub>0</sub> and <italic>X</italic><sub>1</sub> are both upstream causally related to knocked-out gene <italic>G</italic>, while nodes <italic>X</italic><sub>2</sub> and <italic>X</italic><sub>3</sub> are both downstream causally related to <italic>G</italic>.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g001"/>
      </fig>
      <p>Our goal is to identify genes with downstream causal relationships to a knocked-out gene of interest when the underlying graph is unknown. It is well known that when observational data alone are available, only an equivalence class for the DAG is identifiable [<xref rid="pone.0171142.ref021" ref-type="bibr">21</xref>]. With the addition of interventions, it is possible to reduce this set of equivalence classes, but it is still often not possible to identify a unique DAG. For this reason, we consider a marginal approach to estimate only the causal downstream relationships from a single node of interest.</p>
      <p>Using the framework of Gaussian structural equations, three possible cases may be defined for each node <italic>X</italic> of the graph. First, if <italic>X</italic> is a child of the node of interest <italic>G</italic>, the following equation holds:
<disp-formula id="pone.0171142.e006"><alternatives><graphic xlink:href="pone.0171142.e006.jpg" id="pone.0171142.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mspace width="1.em"/><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>μ</italic><sub><italic>X</italic></sub> is the residual mean of <italic>X</italic>, <italic>α</italic> is the total causal effect from <italic>G</italic> to <italic>X</italic>, and <italic>ε</italic><sub><italic>X</italic></sub> is centered Gaussian noise with variance <inline-formula id="pone.0171142.e007"><alternatives><graphic xlink:href="pone.0171142.e007.jpg" id="pone.0171142.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>. On the other hand, if <italic>X</italic> is a parent of <italic>G</italic>, the following equation can similarly be written:
<disp-formula id="pone.0171142.e008"><alternatives><graphic xlink:href="pone.0171142.e008.jpg" id="pone.0171142.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mspace width="1.em"/><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>X</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>μ</italic><sub><italic>G</italic></sub> is the residual mean of <italic>G</italic>, <italic>α</italic> is the total causal effect from <italic>X</italic> to <italic>G</italic>, and <italic>σ</italic><sub><italic>G</italic></sub> the residual standard deviation of <italic>G</italic>. Finally, if <italic>X</italic> is neither a child (descendant) nor a parent (ancestor) of <italic>G</italic>, the model can no longer be expressed in terms of a Gaussian structural equation. However, as the pair of variables <italic>X</italic> and <italic>G</italic> may still be correlated, the pair (<italic>X</italic>, <italic>G</italic>) can be considered to be a random variable following a bivariate Gaussian distribution.</p>
      <p>We next must compute the likelihood functions associated with each of these three cases when both observational and interventional data are available. However, as illustrated in <xref ref-type="fig" rid="pone.0171142.g002">Fig 2</xref>, even with the availability of interventional data, the causal downstream model and the correlated model cannot be distinguished from one another, as their likelihoods are identical. In Model <italic>M</italic><sub>1</sub> (the downstream case), the distribution of <italic>X</italic> under the <monospace>do</monospace> operator is needed. In Model <italic>M</italic><sub>0</sub> (the upstream or correlation cases), the marginal distribution of <italic>X</italic> must be used. Using the Markov equivalence for observational data, all models can be reparameterized as a downstream model. Our models may thus written as follows:
<disp-formula id="pone.0171142.e009"><alternatives><graphic xlink:href="pone.0171142.e009.jpg" id="pone.0171142.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e010"><alternatives><graphic xlink:href="pone.0171142.e010.jpg" id="pone.0171142.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e011"><alternatives><graphic xlink:href="pone.0171142.e011.jpg" id="pone.0171142.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mtext> </mml:mtext><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e012"><alternatives><graphic xlink:href="pone.0171142.e012.jpg" id="pone.0171142.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e013"><alternatives><graphic xlink:href="pone.0171142.e013.jpg" id="pone.0171142.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mspace width="5.0pt"/><mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>G</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
We can now explicitly write the following equalities:
<disp-formula id="pone.0171142.e014"><alternatives><graphic xlink:href="pone.0171142.e014.jpg" id="pone.0171142.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e015"><alternatives><graphic xlink:href="pone.0171142.e015.jpg" id="pone.0171142.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e016"><alternatives><graphic xlink:href="pone.0171142.e016.jpg" id="pone.0171142.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0171142.e017"><alternatives><graphic xlink:href="pone.0171142.e017.jpg" id="pone.0171142.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <fig id="pone.0171142.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Models given observational or interventional data.</title>
          <p>Graphical representation of the <italic>M</italic><sub>1</sub> (downstream) and <italic>M</italic><sub>0</sub> (upstream or correlated) models under observational and interventional data.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g002"/>
      </fig>
      <p>We have thus obtained all of the necessary distributions to compute the respective likelihoods for each model: the joint distribution, the conditional distribution of <italic>X</italic> given <italic>G</italic>, and the marginal distribution of <italic>X</italic>, all with the same set of parameters. For simplification, we define {<italic>μ</italic><sub><italic>X</italic></sub>, <italic>σ</italic><sub><italic>X</italic></sub>} and {<italic>μ</italic><sub><italic>G</italic></sub>, <italic>σ</italic><sub><italic>G</italic></sub>} to be the set of residual parameters associated with <italic>X</italic> and <italic>G</italic>, respectively, and <italic>θ</italic> the full set of parameters. We obtain two likelihood functions, where WT (wild type) represents the observational data, and KO (knock-out) the interventional data:
<disp-formula id="pone.0171142.e018"><alternatives><graphic xlink:href="pone.0171142.e018.jpg" id="pone.0171142.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mtext>WT</mml:mtext></mml:mrow></mml:munder></mml:mstyle><mml:mtext>log</mml:mtext><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>KO</mml:mtext></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mtext>KO</mml:mtext></mml:mrow></mml:munder></mml:mstyle><mml:mtext>log</mml:mtext><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>KO</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mtext>KO</mml:mtext></mml:mrow></mml:munder></mml:mstyle><mml:mtext>log</mml:mtext><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>KO</mml:mtext></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pone.0171142.e019"><alternatives><graphic xlink:href="pone.0171142.e019.jpg" id="pone.0171142.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="script">l</mml:mi><mml:mrow><mml:mtext>KO</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></alternatives><label>(2)</label></disp-formula>
Once the likelihoods in Eqs (<xref ref-type="disp-formula" rid="pone.0171142.e018">1</xref>) and (<xref ref-type="disp-formula" rid="pone.0171142.e019">2</xref>) have been maximized, a Bayes factor can be calculated for each gene to choose the most probable model between <italic>M</italic><sub>0</sub> and <italic>M</italic><sub>1</sub>:
<disp-formula id="pone.0171142.e020"><alternatives><graphic xlink:href="pone.0171142.e020.jpg" id="pone.0171142.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mtext>data</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mtext>data</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mtext>data</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mtext>data</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
The Bayes factor may then be used to order the nodes according to the strength of the downstream causal relationship with node <italic>G</italic>. If it is greater than 1, model <italic>M</italic><sub>0</sub> is preferred, whereas if it is less than 1, model <italic>M</italic><sub>1</sub> is preferred.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec005">
    <title>Results</title>
    <sec id="sec006">
      <title>Simulation study</title>
      <p>In order to assess the performance of our proposed method, we performed a simulation study to ensure that it correctly distinguishes downstream causality from correlation. We considered a simulation setting similar to the experimental design of the transcriptomic data presented below. For 100 independent genes, we simulated 24 replicates in both the observational and the single-KO interventional data, using a Gaussian framework as presented in the Methods section with either a downstream causal or correlated relationship with the KO gene. For each of the 100 simulations, the Bayes factor was then calculated. Two sets of simulations were performed for each model with the same means and causal effects, but with different residual variances.</p>
      <p>Results for the four simulation settings are presented in <xref ref-type="fig" rid="pone.0171142.g003">Fig 3</xref>. On the left, data were simulated with <italic>σ</italic><sub><italic>G</italic></sub> = 0.09, <italic>σ</italic><sub><italic>X</italic></sub> = 0.15, and on the right, <italic>σ</italic><sub><italic>G</italic></sub> = 0.3, <italic>σ</italic><sub><italic>X</italic></sub> = 0.5. This range of values was chosen based on the transcriptomic data presented in the following section, representing small variances (within the lower quantile) and large variances (within the upper quantile), respectively. We note that for small variances, the logarithm of the Bayes factor is strongly negative for the downstream causal model, while it is around zero for the correlation model. A similar pattern is obtained for larger variances, with smaller differences between the correlation and downstream causality cases.</p>
      <fig id="pone.0171142.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Bayes factor for the correlation (<italic>M</italic><sub>0</sub>) and downstream (<italic>M</italic><sub>1</sub>) models.</title>
          <p>log<sub>10</sub> Bayes factor for simulated data under the downstream model (“down”) and correlation model (“cor”), with low (left; <italic>σ</italic><sub><italic>G</italic></sub> = 0.09, <italic>σ</italic><sub><italic>X</italic></sub> = 0.15) and high (right; <italic>σ</italic><sub><italic>G</italic></sub> = 0.3, <italic>σ</italic><sub><italic>X</italic></sub> = 0.5) variance.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g003"/>
      </fig>
      <p>In a second simulation, we investigated whether the proposed method is able to identify marginal downstream causal partners from a simulated graph. Data were simulated under a Gaussian structural equation according to the DAG structure presented in <xref ref-type="fig" rid="pone.0171142.g004">Fig 4</xref>. We simulated a knock-out intervention on Gene 6 alone; as before, 24 replicates were simulated for both the observational and interventional data for each of the other genes in the network in 100 independent runs. We note that the intervention node, represented in yellow in <xref ref-type="fig" rid="pone.0171142.g004">Fig 4</xref>, has several types of relationships with the other nodes: causal upstream ancestors (in blue), downstream causal genes (in red), and simply correlated genes (in green).</p>
      <fig id="pone.0171142.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Simulated graph structure.</title>
          <p>KO interventions were simulated for Gene 6 (yellow) alone. This DAG encompasses various types of relationships with respect to the yellow node: causal upstream ancestors (blue), downstream causal genes (red), and simple correlations (green). Numbers along edges indicate the strength of direct causal effects.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g004"/>
      </fig>
      <p>The values of the Bayes factor for each gene in the network are plotted in <xref ref-type="fig" rid="pone.0171142.g005">Fig 5</xref>. As before, the more strongly negative the logarithm of the Bayes factor, the more evidence there is for a downstream causal model. We note that for the genes with a truly downstream causal relationship with the KO gene (in red), the Bayes factor indeed tends to be strongly negative. Only node 11 is not detected as a descendent; this can be explained by the weak total causal effect for this node, equal to −0.015 from node 6 (the knocked-out gene) to node 11. These simulations thus confirm the ability of the proposed method to differentiate downstream causal relationships from upstream or simple correlation ones in a directed acyclic graph. An additional advantage of the marginal causal approach is that it provides an estimation of the total causal effect between the KO gene of interest and each of the others. The simulated values for these effects, as well as the estimations obtained for various numbers of replicates are provided in <xref rid="pone.0171142.t001" ref-type="table">Table 1</xref>. The accuracy of the estimation is very robust even with a low number of replicates, with very low variability across simulations. These effects thus appear to be generally well-estimated with the proposed method.</p>
      <table-wrap id="pone.0171142.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Estimated total causal effects for simulated graph structure.</title>
          <p>Mean (standard deviation) of the true and estimated total causal effects over 100 simulations for various numbers of replicates.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0171142.t001g" xlink:href="pone.0171142.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Gene</th>
                <th align="right" rowspan="1" colspan="1">True value</th>
                <th align="right" rowspan="1" colspan="1">6 WT / 6 KO</th>
                <th align="right" rowspan="1" colspan="1">12 WT / 12 KO</th>
                <th align="right" rowspan="1" colspan="1">24 WT / 24 KO</th>
                <th align="right" rowspan="1" colspan="1">48 WT / 48 KO</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">0.01 (0.21)</td>
                <td align="right" rowspan="1" colspan="1">0.04 (0.15)</td>
                <td align="right" rowspan="1" colspan="1">0.04 (0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.02 (0.07)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">-0.03 (0.06)</td>
                <td align="right" rowspan="1" colspan="1">-0.04 (0.04)</td>
                <td align="right" rowspan="1" colspan="1">-0.04 (0.02)</td>
                <td align="right" rowspan="1" colspan="1">-0.04 (0.02)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">0.08 (0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.10 (0.07)</td>
                <td align="right" rowspan="1" colspan="1">0.09 (0.05)</td>
                <td align="right" rowspan="1" colspan="1">0.09 (0.03)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">0.00 (0.06)</td>
                <td align="right" rowspan="1" colspan="1">-0.02 (0.04)</td>
                <td align="right" rowspan="1" colspan="1">-0.01 (0.02)</td>
                <td align="right" rowspan="1" colspan="1">-0.02 (0.02)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">-0.01 (0.04)</td>
                <td align="right" rowspan="1" colspan="1">0.00 (0.03)</td>
                <td align="right" rowspan="1" colspan="1">-0.01 (0.02)</td>
                <td align="right" rowspan="1" colspan="1">-0.01 (0.01)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">0.03 (0.08)</td>
                <td align="right" rowspan="1" colspan="1">0.05 (0.05)</td>
                <td align="right" rowspan="1" colspan="1">0.04 (0.04)</td>
                <td align="right" rowspan="1" colspan="1">0.04 (0.03)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00</td>
                <td align="right" rowspan="1" colspan="1">0.04 (0.27)</td>
                <td align="right" rowspan="1" colspan="1">-0.01 (0.18)</td>
                <td align="right" rowspan="1" colspan="1">0.01 (0.16)</td>
                <td align="right" rowspan="1" colspan="1">0.01 (0.10)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="char" char="." rowspan="1" colspan="1">3.00</td>
                <td align="right" rowspan="1" colspan="1">2.99 (0.17)</td>
                <td align="right" rowspan="1" colspan="1">2.98 (0.08)</td>
                <td align="right" rowspan="1" colspan="1">2.99 (0.23)</td>
                <td align="right" rowspan="1" colspan="1">2.99 (0.10)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.30</td>
                <td align="right" rowspan="1" colspan="1">-1.31 (0.08)</td>
                <td align="right" rowspan="1" colspan="1">-1.30 (0.05)</td>
                <td align="right" rowspan="1" colspan="1">-1.30 (0.04)</td>
                <td align="right" rowspan="1" colspan="1">-1.31 (0.03)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.02</td>
                <td align="right" rowspan="1" colspan="1">-0.02 (0.06)</td>
                <td align="right" rowspan="1" colspan="1">-0.02 (0.04)</td>
                <td align="right" rowspan="1" colspan="1">-0.01 (0.03)</td>
                <td align="right" rowspan="1" colspan="1">-0.02 (0.02)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="char" char="." rowspan="1" colspan="1">3.00</td>
                <td align="right" rowspan="1" colspan="1">3.00 (0.11)</td>
                <td align="right" rowspan="1" colspan="1">2.97 (0.24)</td>
                <td align="right" rowspan="1" colspan="1">3.00 (0.14)</td>
                <td align="right" rowspan="1" colspan="1">3.00 (0.04)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.30</td>
                <td align="right" rowspan="1" colspan="1">-1.32 (0.16)</td>
                <td align="right" rowspan="1" colspan="1">-1.29 (0.09)</td>
                <td align="right" rowspan="1" colspan="1">-1.30 (0.10)</td>
                <td align="right" rowspan="1" colspan="1">-1.31 (0.05)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <fig id="pone.0171142.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Bayes factor for the simulated graph structure.</title>
          <p>Results from 100 simulations based on the graph in <xref ref-type="fig" rid="pone.0171142.g004">Fig 4</xref>. Nodes simulated under the upstream/correlation model (<italic>M</italic><sub>0</sub>) appear to the left in black, and those simulated under the downstream model (<italic>M</italic><sub>1</sub>) appear to the right in red.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g005"/>
      </fig>
      <p>In order to compare the results of our marginal causal approach with another marginal (but non-causal) approach routinely used in practice for comparisons between two groups (here, observational and interventional), we also performed a classical differential analysis on the same set of simulated data using the R/Bioconductor limma package [<xref rid="pone.0171142.ref023" ref-type="bibr">23</xref>]. Briefly, limma makes use of a robust moderated two-sample t-test between the observational and interventional samples for each gene, where an empirical Bayes method is used to shrink per-gene sample variances towards a common value. We calculated the area under the receiver operating characteristic (ROC) curve (AUC) over 100 simulations to compare the sensitivity and specificity of the marginal causal approach and the differential analysis to detect downstream causal relationships. Results are presented in <xref ref-type="fig" rid="pone.0171142.g006">Fig 6</xref>. We note that for a relatively large number of replicates (10 WT / 10 KO or 25 WT / 25 KO), both methods perform very similarly, with slightly better results for the proposed causal approach. In the simulation setting with a small number of replicates (5 WT / 5 WO), the performance of the differential analysis tends to deteriorate more strongly than that of the causal approach; in particular, the AUC values much lower than in the other settings, with a large variability across the 100 simulations.</p>
      <fig id="pone.0171142.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>AUC for the simulated graph structure.</title>
          <p>Results from 100 simulations under three settings (5 WT / 5 KO, 10 WT / 10 KO, 25 WT / 25 KO) based on the graph in <xref ref-type="fig" rid="pone.0171142.g004">Fig 4</xref>. “Bayes” (left) corresponds to the causal marginal method, and “p-val” (right) to the <italic>p</italic>-values obtained using limma.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g006"/>
      </fig>
      <p>Finally, although our approach focuses on marginal causal effects and not the full network, it is of interest to compare it to a more global network-wide approach. As an illustration, we make use of the Greedy Interventional Equivalence Search (GIES) algorithm, a score-based method to infer the full directed acyclic graph based on observational and interventional data [<xref rid="pone.0171142.ref024" ref-type="bibr">24</xref>]. For this comparison, we focus only on the downstream causal relationships from the KO gene of interest. We use the graph structure in <xref ref-type="fig" rid="pone.0171142.g004">Fig 4</xref> to simulate data as above (100 datasets, with 24 replicates in each of the WT and KO groups), and we define an F-score to assess the performance of each algorithm:
<disp-formula id="pone.0171142.e021"><alternatives><graphic xlink:href="pone.0171142.e021.jpg" id="pone.0171142.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>+</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>P</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>+</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>FP</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>F-score</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>+</mml:mo><mml:mtext>P</mml:mtext></mml:mrow><mml:mrow><mml:mtext>RP</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where “TP” corresponds to nodes that were simulated to be downstream of the KO gene and were correctly identified by a given method, “FP” corresponds to nodes that were not simulated to be downstream of the KO gene but were incorrectly identified by a given method, and “FN” corresponds to nodes that were simulated to be correlated/upstream of the KO gene but were incorrectly missed by a given method.</p>
      <p>The boxplot of F-scores for each method is shown in <xref ref-type="fig" rid="pone.0171142.g007">Fig 7</xref>, as well as the same simulation for upstream/correlation links. As our marginal approach focuses on the downstream links and does not try to infer the topology of a full network, it obtains more consistent results than the GIES algorithm. This suggests that in cases where interest is on the downstream causal links with a single KO gene, attempting to infer a complete network topology may lead to more inaccurate results than focusing on marginal causal effects.</p>
      <fig id="pone.0171142.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>F-score of the marginal causal approach and GIES algorithm.</title>
          <p>The F-score is based on downstream (left) or not-downstream (right) links. For the marginal approach, a hard threshold of -0.5 is used for the log<sub>10</sub> Bayes factor to select between models. For the GIES algorithm, the inferred topology is used to classify nodes as downstream or not.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g007"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>Real data analysis</title>
      <p>We applied our marginal causal method to a set of transcriptomic data in the context of gene regulatory networks [<xref rid="pone.0171142.ref025" ref-type="bibr">25</xref>]. These data were produced at the French National Institute for Agricultural Research (INRA), in a study investigating gene expression differences between wild-type chickens and their siblings carrying a functionally inactive growth hormone receptor (GHR) gene, leading to a dwarf phenotype; in this case, a functional KO refers to a mutation for which the associated protein is generated but can no longer fulfill its role [<xref rid="pone.0171142.ref022" ref-type="bibr">22</xref>]. We considered the mutation of the GHR gene to be an experimental knock-out, and the expression level of the GHR gene was set to a value close to zero for the dwarf chickens. Customized Agilent microarrays were used to measure gene expression from liver samples taken from 24 wild type and 24 knock-out chickens for 18,855 genes. These data are available at GEO under the GEO accession number GSE91084.</p>
      <p>After standard preprocessing and normalization steps, we aimed to identify genes that are downstream causally related to the GHR gene using the marginal causal method presented in this work. A classical per-gene differential analysis was also performed between wild-type and dwarf chickens using limma [<xref rid="pone.0171142.ref023" ref-type="bibr">23</xref>]. <xref ref-type="fig" rid="pone.0171142.g008">Fig 8</xref> compares the Bayes factors obtained with the marginal causal method and the <italic>p</italic>-values of the differential analysis. In this case, the results are very similar for the two analyses, with a clear linear trend in the scatter plot. This follows the results obtained in the simulation study for more than 10 biological replicates; the added value provided by the marginal causal method, however, is that it provides a formal interpretation of the differential analysis in terms of downstream causal relationships. A similar result may be seen in <xref ref-type="fig" rid="pone.0171142.g009">Fig 9</xref>, which shows a clear correspondence between the fifty most highly ranked genes according to the Bayes Factor and <italic>p</italic>-values of the differential analysis. Interestingly, it also illustrates the similarity in using the estimated total causal effects and the log fold-change values (both in absolute value) to rank genes that are downstream causally related to the GHR gene.</p>
      <fig id="pone.0171142.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Comparison between the differential analysis and the marginal causal approach on chicken microarray data.</title>
          <p>Each point corresponds to a gene for which the differential and marginal causal analyses have been applied.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g008"/>
      </fig>
      <fig id="pone.0171142.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0171142.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Venn diagram for the top 50 genes ranked according to the differential analysis (p-value or log-fold change) and marginal causal approach (Bayes factor or total causal effects.</title>
          <p>Ranking was performed from lowest to highest for p-values and highest to lowest for absolute total effect, absolute log fold-change, and Bayes factor.</p>
        </caption>
        <graphic xlink:href="pone.0171142.g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>We have proposed a novel approach to detect marginal causal relationships in high dimensional data when interventions are available for a single node of interest. This method was developed in the context of transcriptomic data, and can be particularly useful to perform a pre-selection of genes prior to a more thorough causal network inference. It is computationally efficient and can be simultaneously applied thousands of genes. In addition, our simulation study illustrated that the proposed method was able to accurately classify between downstream causal relationships and upstream or simple correlation relationships when the underlying DAG is unknown.</p>
    <p>We showed that the results of differential analyses comparing KO to WT samples can indeed be interpreted as causal, given their similarity to the causal Gaussian Bayesian network. It is true that the new approach described here provides little or no improvement over classical differential analysis hypothesis tests. However, it is precisely through the new causal interpretation of these classical tests that our approach shows promise. For example, with the development of CRISPR/Cas9 genome editing [<xref rid="pone.0171142.ref026" ref-type="bibr">26</xref>], it is clear that the number of intervention experiments in molecular biology will increase dramatically in the coming years. In this context, although differential analysis is clearly a natural way to deal with fully controlled experiments (like randomized clinical trials), it is not particularly well-adapted for analyzing multi-factorial experiments and/or partially complete intervention designs. For these more complex types of studies, we believe that a test based on causal Gaussian Bayesian networks will be an innovative and efficient way to test and infer causality.</p>
    <p>The proposed method relies on structural Gaussian equations, which assume linear relationships and graph acyclicity. Though not always biologically relevant, these assumptions are often made in causal gene network inference as they allow closed-form formulae of the likelihood functions to be obtained, which makes the proposed model very computationally efficient. It would be interesting in the future to evaluate whether results hold under less restrictive assumptions. The method presented here is defined in the context of interventions on one of the nodes of the network. It could similarly be applied to several interventions, if they are assumed independent of one another. However, if the interventions are causally linked, adjustments to the model would have to be considered. Finally, the proposed method was derived within an empirical Bayesian framework, where the maximum likelihood estimators were used. It would be interesting to investigate a fully Bayesian approach, using priors on the parameters that could include informative biological knowledge.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0171142.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Pinna</surname><given-names>A</given-names></name>, <name><surname>Heise</surname><given-names>S</given-names></name>, <name><surname>Flassig</surname><given-names>RJ</given-names></name>, <name><surname>de la Fuente</surname><given-names>A</given-names></name>, <name><surname>Klamt</surname><given-names>S</given-names></name>. <article-title>Reconstruction of large-scale regulatory networks based on perturbation graphs and transitive reduction: improved methods and their evaluation</article-title>. <source>BMC Systems Biology</source>. <year>2013</year>;<volume>7</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1186/1752-0509-7-73</pub-id><?supplied-pmid 23924435?><pub-id pub-id-type="pmid">23924435</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Kalisch</surname><given-names>M</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>. <article-title>Estimating high-dimensional directed acyclic graphs with the PC-algorithm</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2007</year>;<volume>8</volume>:<fpage>613</fpage>–<lpage>636</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Pinna</surname><given-names>A</given-names></name>, <name><surname>Soranzo</surname><given-names>N</given-names></name>, <name><surname>De La Fuente</surname><given-names>A</given-names></name>. <article-title>From knockouts to networks: establishing direct cause-effect relationships through graph analysis</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>(<issue>10</issue>):<fpage>e12912</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0012912</pub-id><?supplied-pmid 20949005?><pub-id pub-id-type="pmid">20949005</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Chickering</surname><given-names>DM</given-names></name>. <article-title>Optimal structure identification with greedy search</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2003</year>;<volume>3</volume>:<fpage>507</fpage>–<lpage>554</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Bühlmann</surname><given-names>P</given-names></name>, <name><surname>Kalisch</surname><given-names>M</given-names></name>, <name><surname>Meier</surname><given-names>L</given-names></name>. <article-title>High-Dimensional Statistics with a View Toward Applications in Biology</article-title>. <source>Annual Review of Statistics and Its Application</source>. <year>2014</year>;<volume>1</volume>:<fpage>255</fpage>–<lpage>278</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-statistics-022513-115545</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref006">
      <label>6</label>
      <mixed-citation publication-type="other">Chickering DM, Heckerman D, Meek C. A Bayesian approach to learning Bayesian networks with local structure. In: Proceedings of the Thirteenth conference on Uncertainty in artificial intelligence. Morgan Kaufmann Publishers Inc.; 1997. p. 80–89.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>W</given-names></name>, <name><surname>Hankenson</surname><given-names>KD</given-names></name>, <name><surname>Woolf</surname><given-names>PJ</given-names></name>. <article-title>Learning transcriptional regulatory networks from high throughput gene expression data using continuous three-way mutual information</article-title>. <source>BMC bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-467</pub-id><?supplied-pmid 18980677?><pub-id pub-id-type="pmid">18173834</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Watkinson</surname><given-names>J</given-names></name>, <name><surname>Liang</surname><given-names>Kc</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Zheng</surname><given-names>T</given-names></name>, <name><surname>Anastassiou</surname><given-names>D</given-names></name>. <article-title>Inference of Regulatory Gene Interactions from Expression Data Using Three-Way Mutual Information</article-title>. <source>Annals of the New York Academy of Sciences</source>. <year>2009</year>;<volume>1158</volume>(<issue>1</issue>):<fpage>302</fpage>–<lpage>313</lpage>. <pub-id pub-id-type="doi">10.1111/j.1749-6632.2008.03757.x</pub-id><?supplied-pmid 19348651?><pub-id pub-id-type="pmid">19348651</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Emmert-Streib</surname><given-names>F</given-names></name>, <name><surname>Glazko</surname><given-names>G</given-names></name>, <name><surname>De Matos Simoes</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Statistical inference and reverse engineering of gene regulatory networks from observational expression data</article-title>. <source>Frontiers in genetics</source>. <year>2012</year>;<volume>3</volume>:<fpage>8</fpage><pub-id pub-id-type="doi">10.3389/fgene.2012.00008</pub-id><?supplied-pmid 22408642?><pub-id pub-id-type="pmid">22408642</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>de Matos Simoes</surname><given-names>R</given-names></name>, <name><surname>Dehmer</surname><given-names>M</given-names></name>, <name><surname>Emmert-Streib</surname><given-names>F</given-names></name>. <article-title>Interfacing cellular networks of S. cerevisiae and E. coli: Connecting dynamic and genetic information</article-title>. <source>BMC genomics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-14-324</pub-id><?supplied-pmid 23663484?><pub-id pub-id-type="pmid">23323973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source>. <year>2008</year>;<volume>9</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>441</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxm045</pub-id><?supplied-pmid 18079126?><pub-id pub-id-type="pmid">18079126</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>F</given-names></name>, <name><surname>Zhou</surname><given-names>Q</given-names></name>. <article-title>Learning sparse causal Gaussian networks with experimental intervention: regularization and coordinate descent</article-title>. <source>Journal of the American Statistical Association</source>. <year>2013</year>;<volume>108</volume>(<issue>501</issue>):<fpage>288</fpage>–<lpage>300</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.2012.754359</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>de Matos Simoes</surname><given-names>R</given-names></name>, <name><surname>Emmert-Streib</surname><given-names>F</given-names></name>. <article-title>Bagging statistical network inference from large-scale gene expression data</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>(<issue>3</issue>):<fpage>e33624</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0033624</pub-id><?supplied-pmid 22479422?><pub-id pub-id-type="pmid">22479422</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Basso</surname><given-names>K</given-names></name>, <name><surname>Margolin</surname><given-names>AA</given-names></name>, <name><surname>Stolovitzky</surname><given-names>G</given-names></name>, <name><surname>Klein</surname><given-names>U</given-names></name>, <name><surname>Dalla-Favera</surname><given-names>R</given-names></name>, <name><surname>Califano</surname><given-names>A</given-names></name>. <article-title>Reverse engineering of regulatory networks in human B cells</article-title>. <source>Nature genetics</source>. <year>2005</year>;<volume>37</volume>(<issue>4</issue>):<fpage>382</fpage>–<lpage>390</lpage>. <pub-id pub-id-type="doi">10.1038/ng1532</pub-id><?supplied-pmid 15778709?><pub-id pub-id-type="pmid">15778709</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref015">
      <label>15</label>
      <mixed-citation publication-type="other">Judea Pearl, TS Verma Equivalence and synthesis of causal models. In: Proceedings of Sixth Conference on Uncertainty in Artijicial Intelligence; 1991. p. 220–227.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Prill</surname><given-names>RJ</given-names></name>, <name><surname>Schaffter</surname><given-names>T</given-names></name>, <name><surname>Mattiussi</surname><given-names>C</given-names></name>, <name><surname>Floreano</surname><given-names>D</given-names></name>, <name><surname>Stolovitzky</surname><given-names>G</given-names></name>. <article-title>Revealing strengths and weaknesses of methods for gene network inference</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2010</year>;<volume>107</volume>(<issue>14</issue>):<fpage>6286</fpage>–<lpage>6291</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0913357107</pub-id><?supplied-pmid 20308593?><pub-id pub-id-type="pmid">20308593</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Altay</surname><given-names>G</given-names></name>, <name><surname>Emmert-Streib</surname><given-names>F</given-names></name>. <article-title>Inferring the conservative causal core of gene regulatory networks</article-title>. <source>BMC Systems Biology</source>. <year>2010</year>;<volume>4</volume>(<issue>1</issue>):<fpage>132</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-4-132</pub-id><?supplied-pmid 20920161?><pub-id pub-id-type="pmid">20920161</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Maathuis</surname><given-names>MH</given-names></name>, <name><surname>Kalisch</surname><given-names>M</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Estimating high-dimensional intervention effects from observational data</article-title>. <source>The Annals of Statistics</source>. <year>2009</year>;<volume>37</volume>(<issue>6A</issue>):<fpage>3133</fpage>–<lpage>3164</lpage>. <pub-id pub-id-type="doi">10.1214/09-AOS685</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Rau</surname><given-names>A</given-names></name>, <name><surname>Jaffrézic</surname><given-names>F</given-names></name>, <name><surname>Nuel</surname><given-names>G</given-names></name>. <article-title>Joint estimation of causal effects from observational and intervention gene expression data</article-title>. <source>BMC Systems Biology</source>. <year>2013</year>;<volume>7</volume>(<issue>1</issue>):<fpage>111</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-7-111</pub-id><?supplied-pmid 24172639?><pub-id pub-id-type="pmid">24172639</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref020">
      <label>20</label>
      <mixed-citation publication-type="book"><name><surname>Spirtes</surname><given-names>P</given-names></name>, <name><surname>Glymour</surname><given-names>CN</given-names></name>, <name><surname>Scheines</surname><given-names>R</given-names></name>. <source>Causation, prediction, and search</source>. <volume>vol. 81</volume><publisher-name>MIT press</publisher-name>; <year>2000</year>.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref021">
      <label>21</label>
      <mixed-citation publication-type="book"><name><surname>Pearl</surname><given-names>J</given-names></name>. <source>Causality: models, reasoning and inference</source>. <volume>vol. 29</volume><publisher-name>Cambridge Univ Press</publisher-name>; <year>2000</year>.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Duriez</surname><given-names>B</given-names></name>, <name><surname>Sobrier</surname><given-names>M</given-names></name>, <name><surname>Duquesnoy</surname><given-names>P</given-names></name>, <name><surname>Tixier-Boichard</surname><given-names>M</given-names></name>, <name><surname>Decuypere</surname><given-names>E</given-names></name>, <name><surname>Coquerelle</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>A naturally occurring growth hormone receptor mutation: in vivo and in vitro evidence for the functional importance of the WS motif common to all members of the cytokine receptor superfamily</article-title>. <source>Molecular endocrinology</source>. <year>1993</year>;<volume>7</volume>(<issue>6</issue>):<fpage>806</fpage>–<lpage>814</lpage>. <pub-id pub-id-type="doi">10.1210/me.7.6.806</pub-id><?supplied-pmid 8361502?><pub-id pub-id-type="pmid">8361502</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>Linear Models and Empirical Bayes Methods for Assessing Differential Expression in Microarray Experiments</article-title>. In: <source>Statistical Applications in Genetics and Molecular Biology</source>; <year>2004</year> p. <fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id>
<?supplied-pmid 16646809?><pub-id pub-id-type="pmid">16646809</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Hauser</surname><given-names>A</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>. <article-title>Characterization and greedy learning of interventional Markov equivalence classes of directed acyclic graphs</article-title>. <source>Journal of Machine Learning Research</source>. <year>2012</year>;<volume>13</volume>(<issue>Aug</issue>):<fpage>2409</fpage>–<lpage>2464</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0171142.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Emmert-Streib</surname><given-names>F</given-names></name>, <name><surname>Dehmer</surname><given-names>M</given-names></name>, <name><surname>Haibe-Kains</surname><given-names>B</given-names></name>. <article-title>Gene regulatory networks and their applications: understanding biological and medical problems in terms of networks</article-title>. <source>Frontiers in cell and developmental biology</source>. <year>2014</year>;<volume>2</volume>:<fpage>38</fpage><pub-id pub-id-type="doi">10.3389/fcell.2014.00038</pub-id><?supplied-pmid 25364745?><pub-id pub-id-type="pmid">25364745</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0171142.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Hsu</surname><given-names>PD</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>. <article-title>Development and applications of CRISPR-Cas9 for genome engineering</article-title>. <source>Cell</source>. <year>2014</year>;<volume>157</volume>(<issue>6</issue>):<fpage>1262</fpage>–<lpage>1278</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2014.05.010</pub-id><?supplied-pmid 24906146?><pub-id pub-id-type="pmid">24906146</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
