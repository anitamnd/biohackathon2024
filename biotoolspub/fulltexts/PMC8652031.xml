<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8652031</article-id>
    <article-id pub-id-type="pmid">34175927</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab476</article-id>
    <article-id pub-id-type="publisher-id">btab476</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TimeCycle: topology inspired method for the detection of cycling transcripts in circadian time-series data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3935-6667</contrib-id>
        <name>
          <surname>Ness-Cohn</surname>
          <given-names>Elan</given-names>
        </name>
        <aff><institution>Department of Molecular Biosciences, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
        <aff><institution>Biostatistics Division, Department of Preventive Medicine, Northwestern University</institution>, Chicago, IL 60611, <country country="US">USA</country></aff>
        <aff><institution>NSF-Simons Center for Quantitative Biology, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Braun</surname>
          <given-names>Rosemary</given-names>
        </name>
        <xref rid="btab476-cor1" ref-type="corresp"/>
        <aff><institution>Department of Molecular Biosciences, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
        <aff><institution>Biostatistics Division, Department of Preventive Medicine, Northwestern University</institution>, Chicago, IL 60611, <country country="US">USA</country></aff>
        <aff><institution>NSF-Simons Center for Quantitative Biology, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
        <aff><institution>Department of Engineering Sciences and Applied Mathematics, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
        <aff><institution>Department of Physics and Astronomy, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
        <aff><institution>Northwestern Institute on Complex Systems, Northwestern University</institution>, Evanston, IL 60208, <country country="US">USA</country></aff>
        <!--rbraun@northwestern.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab476-cor1">To whom correspondence should be addressed. <email>rbraun@northwestern.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-06-27">
      <day>27</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>23</issue>
    <fpage>4405</fpage>
    <lpage>4413</lpage>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>22</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab476.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The circadian rhythm drives the oscillatory expression of thousands of genes across all tissues. The recent revolution in high-throughput transcriptomics, coupled with the significant implications of the circadian clock for human health, has sparked an interest in circadian profiling studies to discover genes under circadian control.</p>
      </sec>
      <sec id="s2">
        <title>Result</title>
        <p>We present TimeCycle: a topology-based rhythm detection method designed to identify cycling transcripts. For a given time-series, the method reconstructs the state space using time-delay embedding, a data transformation technique from dynamical systems theory. In the embedded space, Takens’ theorem proves that the dynamics of a rhythmic signal will exhibit circular patterns. The degree of circularity of the embedding is calculated as a persistence score using persistent homology, an algebraic method for discerning the topological features of data. By comparing the persistence scores to a bootstrapped null distribution, cycling genes are identified. Results in both synthetic and biological data highlight TimeCycle’s ability to identify cycling genes across a range of sampling schemes, number of replicates and missing data. Comparison to competing methods highlights their relative strengths, providing guidance as to the optimal choice of cycling detection method.</p>
      </sec>
      <sec id="s3">
        <title>Availabilityand implementation</title>
        <p>A fully documented open-source R package implementing TimeCycle is available at: <ext-link xlink:href="https://nesscoder.github.io/TimeCycle/" ext-link-type="uri">https://nesscoder.github.io/TimeCycle/</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Simons Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000893</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>597491-RWC</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1764421</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Simons Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000893</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Circadian rhythms—physiological, behavioral and metabolic oscillations with an approximate 24-h period—are controlled by an evolutionarily conserved set of core clock genes operating at the transcriptional and protein level. Entrained by Zeitgebers (external environmental stimuli such as light, temperature and food) that modulate time-of-day specific functions, the circadian clock orchestrates a multitude of cellular processes, including nearly half of genes across all tissues (<xref rid="btab476-B48" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2014</xref>). Although various epidemiological studies have established significant links between circadian rhythms and human health (<xref rid="btab476-B4" ref-type="bibr">Braun <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab476-B5" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab476-B20" ref-type="bibr">Kathale and Liu, 2014</xref>; <xref rid="btab476-B23" ref-type="bibr">Levine <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab476-B22" ref-type="bibr">Levi and Schibler, 2007</xref>; <xref rid="btab476-B32" ref-type="bibr">Patke <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab476-B34" ref-type="bibr">Puttonen <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B36" ref-type="bibr">Roenneberg <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btab476-B42" ref-type="bibr">Videnovic <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab476-B48" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2014</xref>), the underlying biological mechanisms coupling these phenomena remain poorly understood.</p>
    <p>Facilitated by the development of high-throughput assays, researchers can now interrogate biological mechanisms at the molecular level by analyzing transcriptomic time-series data to identify genes under circadian control. This capability presents researchers with new analytical challenges of how best to reliably extract rhythmic signals from transcriptomic time-series data (<xref rid="btab476-B16" ref-type="bibr"> Hutchisona and Dinner, 2017</xref>). First, experimental costs constrain the frequency and length of sampling, requiring conclusions to be made from sparse or short time-series measurements. Second, circadian expression profiles often do not follow precise sinusoidal waveforms, but exhibit asymmetries, sharp peaks, additive trends and noisy fluctuations (<xref rid="btab476-B28" ref-type="bibr">Michael <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>, <xref rid="btab476-B41" ref-type="bibr">2016</xref>; <xref rid="btab476-B45" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2016</xref>). To address these challenges, a variety of cycling detection methods have been proposed (<xref rid="btab476-B1" ref-type="bibr">Ahdesmäki <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btab476-B6" ref-type="bibr">de Lichtenberg <italic toggle="yes">et al.</italic>, 2005</xref>; <xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B19" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab476-B24" ref-type="bibr">Levine <italic toggle="yes">et al.</italic>, 2002</xref>; <xref rid="btab476-B28" ref-type="bibr">Michael <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab476-B38" ref-type="bibr">Straume, 2004</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>; <xref rid="btab476-B43" ref-type="bibr">Wichert <italic toggle="yes">et al.</italic>, 2004</xref>; <xref rid="btab476-B45" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab476-B46" ref-type="bibr">Yang and Su, 2010</xref>). However, benchmarking studies indicate that no method is universally optimal, and different algorithms may yield conflicting results on the same data (<xref rid="btab476-B7" ref-type="bibr">Deckard <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab476-B21" ref-type="bibr">Laloum and Robinson-Rechavi, 2020</xref>; <xref rid="btab476-B27" ref-type="bibr">Mei <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab476-B44" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
    <p>Early cycling detection methods used parametric approaches employing auto-correlation, curve fitting and Fourier analysis to decompose expression patterns into harmonic components of varying amplitude and phase (<xref rid="btab476-B24" ref-type="bibr">Levine <italic toggle="yes">et al.</italic>, 2002</xref>; <xref rid="btab476-B38" ref-type="bibr">Straume, 2004</xref>; <xref rid="btab476-B43" ref-type="bibr">Wichert <italic toggle="yes">et al.</italic>, 2004</xref>). These methods could successfully identify genes with relatively symmetric waveform shapes, but had poor performance on asymmetric and sharply peaked waveforms (<xref rid="btab476-B28" ref-type="bibr">Michael <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>). To address these shortcomings, a range of non-parametric methods were developed (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B19" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>; <xref rid="btab476-B45" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab476-B46" ref-type="bibr">Yang and Su, 2010</xref>). While non-parametric methods sacrifice statistical power relative to parametric methods (<xref rid="btab476-B21" ref-type="bibr">Laloum and Robinson-Rechavi, 2020</xref>), they are applicable to a broader range of cycling waveforms and generally outperform parametric methods (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B18" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2015</xref>, <xref rid="btab476-B19" ref-type="bibr">2018</xref>; <xref rid="btab476-B46" ref-type="bibr">Yang and Su, 2010</xref>).</p>
    <p>Nevertheless, limitations remain in current methods (<xref rid="btab476-B16" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab476-B17" ref-type="bibr">Hutchison and Dinner, 2017</xref>; <xref rid="btab476-B21" ref-type="bibr">Laloum and Robinson-Rechavi, 2020</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>). A common approach is to compare the observed gene expression time-series to a user-defined set of reference waveforms (e.g. oscillations with different degrees of sawtooth asymmetry) to calculate a periodicity score (e.g. via the Kendall <italic toggle="yes">τ</italic> rank correlation). Such methods may fail to detect cyclic patterns that do not fall into the predetermined profiles of reference signals, effectively limiting the scope of discovery. Moreover, these methods typically assess the statistical significance relative to a null model of a randomized time-series. Since randomized time-series may jump from low to high gene expression faster than biological translation and degradation processes allow, these methods may produce unrealistic null models and misleading significance tests.</p>
    <p>In addition to methodological hurdles, there are also considerations of various methods’ abilities to handle replicates, uneven sampling, missing data and computational efficiency. In practice, the ability of methods to adequately handle these features directly affects flexibility in experimental design. For instance, a method that can accommodate uneven sampling can allow for dense sampling at times of interest, with sparser sampling at other times. Because missing data often occur as a result of sequencing errors with greater likelihood as sample size increases (<xref rid="btab476-B12" ref-type="bibr">Gierliński <italic toggle="yes">et al.</italic>, 2015</xref>), researchers benefit from algorithms that can adequately handle missingness. Finally, computational efficiency allows sample sizes to grow while still processing the data in a reasonable amount of time.</p>
    <p>Results from dynamical systems theory and toplogogical data analysis provide alternative strategies to overcome the limitations of curve-fitting and template-based analysis methods. The recent ‘SW1PerS’ method (<xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>) uses time–delay embedding (<xref rid="btab476-B39" ref-type="bibr">Takens, 1981</xref>) to transform sliding windows of the time-series into a high-dimensional point cloud, and quantifies the circularity of the transformed signal as a measure of its periodicity. However, because the rhythmicity scores do not follow a well-defined distribution and the computational complexity of the algorithm precludes permutation tests, SW1PerS does not provide a <italic toggle="yes">P</italic>-value testing whether a gene is cycling.</p>
    <p>To address these challenges, we introduce TimeCycle: a non-parametric, template–free algorithm based on topological data analysis with a bootstrapping procedure for statistical inference of cycling genes. Results demonstrate that TimeCycle reliably discriminates cycling and non-cycling profiles in synthetic data and reproducibly detects known circadian genes in experimental data. Below we describe the method, illustrate its application to multiple datasets, and provide a comparison to several competing methods.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Generating synthetic data</title>
      <p>A total of 144 unique synthetic time-course datasets, each comprising 11 000 expression profiles, were generated in R using the code outlined in (<xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>). Each dataset consisted of a different number of replicates (1, 2, 3), sampling intervals (1-h, 2-h, 4-h), sampling durations (36-h, 48-h, 72-h, 96-h) and noise levels (10%, 20%, 30%, 40% of the waveform amplitude). Within each condition, 11 base waveforms were simulated to mimic expression patterns observed in nature: periodic patterns, non-periodic patterns, and dynamics that have a cyclic component but do not meet the strict definition of periodicity. Seven of these 11 shapes were considered cyclic (sine, peak, sawtooth, linear trend, damped, amplified, contractile), and 4 were considered non-cyclic (flat, linear, sigmoid and exponential). Further details may be found in (<xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Processing synthetic data</title>
      <p>All 144 synthetic datasets were processed by all four cycling detection methods [TimeCycle, JTK_CYCLE (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>), RAIN (<xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>), GeneCycle (<xref rid="btab476-B1" ref-type="bibr">Ahdesmäki <italic toggle="yes">et al.</italic>, 2007</xref>) and SW1PerS (<xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>)], using each method’s recommended parameter settings as defined by the method’s documentation. Since GeneCycle and SW1PerS do not have a built-in function for dealing with replicates, replicates were averaged together, following the recommended common practice in the field (<xref rid="btab476-B16" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>). TimeCycle, JTK_CYCLE and RAIN used the replicate procedures recommended in their documentation. See the Supplement and <ext-link xlink:href="https://github.com/nesscoder/TimeCycle-data" ext-link-type="uri">https://github.com/nesscoder/TimeCycle-data</ext-link> for a complete list of the experimental parameters and associated source code.</p>
      <sec>
        <label>2.2.1</label>
        <title>Computing ROC, AUC and percent correct classification</title>
        <p>For each method across all 144 synthetic datasets and missing data analysis, the receiver operating characteristic (ROC) and accompanying area under the curve (AUC) were computed using the pROC R package (<xref rid="btab476-B35" ref-type="bibr">Robin <italic toggle="yes">et al.</italic>, 2011</xref>). The optimal threshold for computing each methods’ percent correct classification is defined by Youden’s <italic toggle="yes">J</italic> statistic (<xref rid="btab476-B47" ref-type="bibr">Youden, 1950</xref>), again computed using pROC. For each waveform shape at the classification threshold defined by the Youden’s <italic toggle="yes">J</italic> index, the percent correct classification was computed by dividing the number of synthetic genes called as (non-)cyclers out of the total possible (non-)cyclers.</p>
      </sec>
      <sec>
        <label>2.2.2</label>
        <title>Missing data analysis</title>
        <p>To evaluate TimeCycle’s ability to handle missing data, we analyzed synthetic data sampled every 2-h for 48-h with one replicate at varying noise levels with a range of missing values. For each of the 11 000 genes in each dataset, time-points were randomly removed by sweeping from 0% missingness until only 2 points remained. ROC plots and AUC scores depicted in <xref rid="btab476-F4" ref-type="fig">Figure 4</xref> were computed as described above.</p>
      </sec>
      <sec>
        <label>2.2.3</label>
        <title>Outlier analysis</title>
        <p>To evaluate TimeCycle’s ability to handle outliers, we analyzed 36 synthetic datasets all with a 48-h sampling length. Each dataset consisted of a different number of replicates (1, 2, 3) and sampling intervals (1-h, 2-h, 4-h). Following (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>) and (<xref rid="btab476-B37" ref-type="bibr">Salkovic <italic toggle="yes">et al.</italic>, 2020</xref>), for all sampled time–points, outliers were injected into the time–series at a rate of 1%. Outliers were drawn from a uniformly distribution between <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>μ</mml:mo><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>σ</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>σ</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> of the diurnal mean <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for each time–series (<xref rid="btab476-B37" ref-type="bibr">Salkovic <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Preprocessing and analysis of microarray data</title>
      <p>Microarray data was preprocessed as described in <italic toggle="yes">Methods—Preprocessing Microarray Data</italic> of <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic> (2020)</xref>. (See <ext-link xlink:href="https://github.com/nesscoder/TimeTrial" ext-link-type="uri">https://github.com/nesscoder/TimeTrial</ext-link> for associated source code.<italic toggle="yes">)</italic></p>
      <p>To characterize the effects of sampling schemes using real data, the three datasets were processed to ensure comparability across datasets. The <xref rid="btab476-B15" ref-type="bibr">Hughes (2012)</xref> and <xref rid="btab476-B48" ref-type="bibr">Zhang (2014)</xref> datasets were sampled every 2-h for 48-h. The Hogenesch 2009 (<xref rid="btab476-B13" ref-type="bibr">Hughes <italic toggle="yes">et al</italic>., 2009</xref>) dataset, comprising data sampled every 1-h for 48-h, was down-sampled into 2 datasets sampled every 2-h for 48-h. All four datasets (2 original and 2 down-sampled) were processed by TimeCycle, JTK_CYCLE, RAIN and GeneCycle, using each method’s recommended parameter settings as defined by the method’s documentation (SW1PerS was omitted from the microarray analysis since the algorithm does not produce a <italic toggle="yes">P</italic>-value and thus could not be meaningfully compared to the other methods). Further details may be found in the Supplement.</p>
      <sec>
        <label>2.3.1</label>
        <title>Gene dynamics reproducibility assessment via rank correlation CDF</title>
        <p>The distribution of Spearman rank correlations were computed by comparing genes identified by each method with an FDR &lt; 0.05 and LogFC &lt; 2 in one dataset (e.g. <xref rid="btab476-B13" ref-type="bibr">Hughes <italic toggle="yes">et al</italic>., 2009</xref>; <xref rid="btab476-B15" ref-type="bibr">Hughes 2012</xref>; <xref rid="btab476-B48" ref-type="bibr">Zhang 2014</xref>) with their pairwise expression in the other datasets. To account for the 6-h phase shift in sampling start time between the Hughes dataset (start <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) and the Hogenesch/Zhang (start <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) datasets, the last three time points (e.g. 6-h) in the Hughes dataset were moved to the start of the time-series before computing the correlation (<xref rid="btab476-F5" ref-type="fig">Fig. 5D</xref>). The distribution of cycling gene correlations was compared to both the all-gene correlations and a null distribution of correlations. The all-gene correlation represents the rank correlation on a per-gene basis for all 12 868 genes, whether or not they were identified as cycling. The null distribution of correlation coefficients was constructed by randomly resampling the 12 868 genes in each dataset (thereby generating correlation coefficients from different, rather than the same, genes). </p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>TimeCycle is a method for classifying and quantifying cyclic patterns of gene expression in transciptomic time-series data. Application to both synthetic and experimental data demonstrate TimeCycle’s ability to efficiently discriminate cycling genes from non-cycling genes across a range of sampling schemes, number of replicates and missing data.</p>
    <sec>
      <title>3.1 The TimeCycle method</title>
      <p>TimeCycle’s basic framework consists of a rescaling/normalization step, reconstruction of the state space via time-delay embedding, isolation of non-linear patterns via manifold learning and dimension reduction, quantification of the circularity of the signal using persistent homology, and comparison of that measure to a bootstrapped null distribution to assess statistical significance (<xref rid="btab476-F1" ref-type="fig">Fig. 1B</xref>). We describe the main steps of the method here; a complete description pertaining to the methods preprocessing, null distribution and period estimation can be found in the supplement and TimeCycle’s documentation available at <ext-link xlink:href="https://nesscoder.github.io/TimeCycle/" ext-link-type="uri">https://nesscoder.github.io/TimeCycle/</ext-link>.</p>
      <fig position="float" id="btab476-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>TimeCycle Theory and Implementation. (<bold>A</bold>) Takens’ theorem proves that the dynamics of a periodic signal will exhibit circular patterns in the embedded space. A periodic function (Top) embedded in the state space forms a circle. A non-periodic function (Bottom) embedded in the state space forms a mass. (<bold>B</bold>) The TimeCycle algorithm assesses statistical significance with respect to a null distribution of persistence scores generated from random time-series with the same marginal distribution of finite differences as the original time-series; this ensures that the random time-series are constrained by the same transcription and degradation rates present in the original data. Period, phase and amplitude are estimated separately using a fast Fourier transform procedure. (<bold>C</bold>) Left: For a given time-series, the method reconstructs the state space using time-delay embedding, a data transformation technique for dynamic systems. Middle: Dampened and trending signals form spirals and helices in the embedded space. Non-linear dimension reduction using Laplacian Eigenmaps yields embedded points preserving the local circular geometry of the 3-D helix in a 2-D space. Right: Persistent Homology is used to parameterize the circularity of the 2-D embedding. Points in the embedding are connected if they are at most a distance <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula> apart, as the radius <italic toggle="yes">ϵ</italic> increases. A topological cycle appears at some <italic toggle="yes">ϵ<sub>birth</sub></italic> and disappears at <italic toggle="yes">ϵ</italic><sub>death</sub>, and a persistence score is calculated as <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Persistence</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mtext>death</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mtext>birth</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Periodic signals have high persistence, while non-periodic signals have low persistence.</p>
        </caption>
        <graphic xlink:href="btab476f1" position="float"/>
      </fig>
      <sec>
        <label>3.1.1</label>
        <title>Reconstructing dynamical cycles via Takens’ theorem</title>
        <p>TimeCycle exploits Takens’ theorem, a result from dynamical systems theory that proves that the time–delay embedding of a single variable observed over time will reconstruct (up to diffeomorphism) the state space of a multivariate dynamical system (<xref rid="btab476-B39" ref-type="bibr">Takens, 1981</xref>). A <italic toggle="yes">d</italic>-dimensional time–delay embedding of a time-series <italic toggle="yes">X</italic> is defined as a representation of that time–series in a <italic toggle="yes">d</italic>-dimensional space where each point is given by the coordinates <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mo>τ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>τ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>τ</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. As a consequence of Takens’ theorem, a dynamical system with a cycle will exhibit circular patterns in the time–delay space, whereas non-periodic signals will form a mass (<xref rid="btab476-F1" ref-type="fig">Fig. 1A</xref>). Using this logic, TimeCycle reconstructs the state space for each gene using time-delay embedding and quantifies the circularity of the embedding as a measure of the evidence of cycling dynamics.</p>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Parameter choice and detrending via dimension reduction</title>
        <p>Time-delay embedding requires two parameters, the embedding dimensionality <italic toggle="yes">d</italic> and the delay lag <italic toggle="yes">τ</italic>. A perfectly sinusoidal signal will form a circle in <italic toggle="yes">d </italic>=<italic toggle="yes"> </italic>2 dimensions, and hence a two-dimensional embedding would be sufficient in the ideal case. However, biological signals are often not strictly periodic, but exhibit drifts in the oscillation. A common approach is to detrend the time-series by fitting it to a line and analyzing the residuals (<xref rid="btab476-B46" ref-type="bibr">Yang and Su, 2010</xref>). While this removes linear trends, the detrending procedure can introduce false positives (<xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>), as non-rhythmic signals—e.g. sigmoidal and exponential—may appear rhythmic after detrending (Supplementary Fig. S1). Instead, we observe that any non-periodic component of the signal may be represented by higher dimensions in the embedded space. Hence, we embed the time-series in three dimensions <bold>(</bold><xref rid="btab476-F1" ref-type="fig">Fig. 1C:</xref> Left) and use non-linear dimension reduction to recover the periodic component. An illustrative example is given in <xref rid="btab476-F1" ref-type="fig">Figure 1C</xref> (Middle). A drifting oscillation will form a helix in the 3-D embedded space, with the linear trend contributing to the elongation of the helix along one coordinate and the circular component preserved in the other two. TimeCycle uses Laplacian Eigenmaps (<xref rid="btab476-B3" ref-type="bibr">Belkin and Niyogi, 2003</xref>), a non-linear dimension reduction (NLDR) technique, to project the 3-D embedded data back into a 2-D space, preserving the circular geometry.</p>
        <p>This approach has two advantages over linear-fit detrending. First, it is in principle applicable to any type of drift, and is not necessarily confined to removing linear trends. Second, it will only yield a circular pattern in the 2-D space if the periodic component is strong relative to the drift. That is, if the ‘drift coordinate’ (e.g. the axis of the helix in <xref rid="btab476-F1" ref-type="fig">Fig. 1C</xref>) more faithfully preserves the local geometry of the data than the circular ‘cycling coordinates’, it will be chosen by the NLDR, and the resulting 2-D representation will not have a detectable circular topology. Together, these features overcome the drawbacks of linear-fit detrending.</p>
        <p>The optimal choice for the other parameter, the lag <italic toggle="yes">τ</italic>, is less obvious. While the underlying mathematical theory holds for all <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref rid="btab476-B39" ref-type="bibr">Takens, 1981</xref>), in practice the presence of noise and short time-series lengths lead to differences in the embedding as a function of <italic toggle="yes">τ</italic> (<xref rid="btab476-B11" ref-type="bibr">Garland <italic toggle="yes">et al.</italic>, 2016</xref>). Because the underlying theory is insensitive to <italic toggle="yes">τ</italic>, it yields no guidance on how to derive an ‘optimal’ lag or set criteria for its selection. A common approach, due to Fraser and Swinney, is to choose <italic toggle="yes">τ</italic> to maximize the independence between embedded points (<xref rid="btab476-B10" ref-type="bibr">Fraser and Swinney, 1986</xref>); more recently, Meiss and colleagues proposed a method to choose <italic toggle="yes">τ</italic> that minimizes the curvature (<xref rid="btab476-B8" ref-type="bibr">Deshmukh <italic toggle="yes">et al.</italic>, 2020</xref>). In practice, however, the best choice is often application–dependent. Because our goal here is to detect rhythmicity (rather than fully reconstruct the state space), we sweep through values of <italic toggle="yes">τ</italic>, computing the degree of circularity for each. If a signal is truly rhythmic, on average the state space manifold across lags should be approximately circular.</p>
      </sec>
      <sec>
        <label>3.1.3</label>
        <title>Quantification of cycling via persistent homology</title>
        <p>We quantify the circularity of the embedded data using <italic toggle="yes">persistent homology</italic> (PH) (<xref rid="btab476-B9" ref-type="bibr">Edelsbrunner <italic toggle="yes">et al.</italic>, 2002</xref>), an algebraic means to measure topological structures (i.e. components, holes, voids and higher dimensional analogs) in a dataset. From each point of the embedded signal, a <italic toggle="yes">d</italic>-sphere of radius <italic toggle="yes">ϵ</italic> is incrementally grown (<xref rid="btab476-F1" ref-type="fig">Fig. 1C:</xref> Right). When a pair of points have intersecting spheres (i.e. are at most <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula> apart), a line is drawn between those points. When a complete cycle is formed amongst a set of points at some <italic toggle="yes">ϵ<sub>b</sub></italic>, this is defined as a ‘birth event’: the initial appearance of a topological hole, a closed cycle lying entirely inside the spheres surrounding the embedded data. As <italic toggle="yes">ϵ</italic> is increased, the topological hole eventually closes at a radius <italic toggle="yes">ϵ<sub>d</sub></italic> defining the ‘death event’. The persistence score of a topological feature is defined as the difference between the death and birth radii <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Several such features, with associated persistence scores, may be present in the data, the largest of which corresponds to the most unambigously periodic dynamics. A rhythmic signal will produce a more circular embedding, resulting in a larger maximum persistence score, than a non-rhythmic signal.</p>
      </sec>
      <sec>
        <label>3.1.4</label>
        <title>Significance testing</title>
        <p>A common approach for assessing statistical significance in cycling detection algorithms is to compare the statistics of an observed signal to a null model comprising random time series (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B19" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>). Such null models may be unrealistic, however, since gene expression in the biological context is constrained by transcription and degradation rates, and an assumption of random, independent time-series may contain changes in gene expression that are biologically unattainable. Instead, TimeCycle’s null model is obtained by permuting the finite differences in gene expression between sampled time-points. The distribution of gene expression changes under the null is thus identical to that of the observed data, ensuring that the resulting random time-series reflect biological transcription and degradation constraints (<xref rid="btab476-F1" ref-type="fig">Fig. 1B</xref>). A persistence score is computed for each resampled time-series to generate a reference distribution of persistence scores under the null (no cycling), conditioned on the observed rates of change. The observed persistence score is then compared to this reference distribution to obtain a <italic toggle="yes">P</italic>-value.</p>
        <p>A significant consideration for this method is the computational complexity of the persistence score calculation [<inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the number of time points for 2-<italic toggle="yes">d</italic> data], which will need to be performed for each gene and each resampled time-series. Indeed, a drawback of the SW1PerS algorithm is its inability into compute a <italic toggle="yes">P</italic>-value due to the computational cost of the method. To overcome this challenge, we devised a scheme to allow for hypothesis testing with improved computational efficiency: prior to the embedding and PH analysis, each gene is mean centered and scaled to unit variance, allowing a common set of permuted time-series to be used for all genes to test the statistical significance of cycling.</p>
      </sec>
      <sec>
        <label>3.1.5</label>
        <title>Parameter estimation</title>
        <p>Often, researchers desire estimates of the period, phase and amplitude of the genes detected as cycling. Because the time-delay embedding and PH computation does not provide these estimates, a separate computation in TimeCycle is used to generate these results. To estimate the period, amplitude and phase of the oscillations (<xref rid="btab476-F1" ref-type="fig">Fig. 1B</xref>), signals are linearly detrended and smoothed via a moving average before fitting the signal to the first three harmonics of the fast Fourier transform (FFT). The period, phase and amplitude are computed from the FFT fit. (Note that when performing the less computationally costly parameter estimation, the rescaling procedure used in the cycle detection step is omitted to preserve amplitude measures.<italic toggle="yes">)</italic></p>
      </sec>
      <sec>
        <label>3.1.6</label>
        <title>Replicate time-points</title>
        <p>A practical consideration when designing transcriptomic time-series experiment is the trade-off between replicates, sampling resolution and sampling length in relation to experimental cost (<xref rid="btab476-B16" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>). While cycling detection methods do not require replicates (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B18" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2015</xref>, <xref rid="btab476-B19" ref-type="bibr">2018</xref>; <xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>; <xref rid="btab476-B44" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab476-B46" ref-type="bibr">Yang and Su, 2010</xref>); technical replicates are necessary for performing additional analysis beyond the scope of cycling detection—e.g. differential expression and differential time-course profiles (<xref rid="btab476-B2" ref-type="bibr">Anders and Huber, 2010</xref>; <xref rid="btab476-B26" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>). As such, researchers benefit from algorithms that can incorporate replicates to improve detection of cycling genes (<xref rid="btab476-B18" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2015</xref>). Adhering to best practice guidelines outlined in previous studies (<xref rid="btab476-B16" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>), TimeCycle averages replicate time-points. The averaged signal is then processed following all steps outlined above.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Application and evaluation using simulated gene expression data</title>
      <p>To comprehensively evaluate TimeCycle’s capabilities across different patterns of temporal gene expression, we applied TimeCycle and four other methods—JTK_CYCLE (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>), RAIN (<xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>), GeneCycle (<xref rid="btab476-B1" ref-type="bibr">Ahdesmäki <italic toggle="yes">et al.</italic>, 2007</xref>) and SW1PerS (<xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>)—to synthetic data described in our previous benchmarking work (<xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>). JTK_CYCLE and RAIN were selected for comparison as the primary methods used in the field of circadian rhythm detection. GeneCycle was selected as an alternative method highlighted in previous benchmarking studies to be robust to outliers (<xref rid="btab476-B1" ref-type="bibr">Ahdesmäki <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btab476-B7" ref-type="bibr">Deckard <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab476-B21" ref-type="bibr">Laloum and Robinson-Rechavi, 2020</xref>). SW1PerS was selected as the only other method utilizing topological data analysis. While other methods such as ARSER (<xref rid="btab476-B46" ref-type="bibr">Yang and Su, 2010</xref>) and booteJTK (<xref rid="btab476-B19" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2018</xref>) were considered based on previous benchmarking studies (<xref rid="btab476-B7" ref-type="bibr">Deckard <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab476-B21" ref-type="bibr">Laloum and Robinson-Rechavi, 2020</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab476-B44" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>), they were ultimately omitted from analysis as they do not natively handle missing data. Synthetic datasets varied in number of replicates (1, 2, 3), sampling intervals (1-h, 2-h, 4-h), sampling length (36-h, 48-h, 72-h, 96-h) and noise levels (10%, 20%, 30%, 40% of signal amplitude), across 11 base waveform shapes. Seven of these 11 shapes were considered cyclic (sine, peak, sawtooth, oscillations about a linear trend, damped, amplified, contractile) and 4 were considered non-cyclic (flat, linear, sigmoid and exponential). For each waveform in each condition, 1000 ‘genes’ were simulated with varying amplitudes, phases and shape parameters (e.g. the envelope for damped/amplified waves), yielding in total 11 000 simulated genes for each of the 144 sampling and noise conditions. [Further details of the synthetic datasets can be found in the Methods section and <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref> of <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic> (2020)</xref>.]</p>
      <sec>
        <label>3.2.1</label>
        <title>Accuracy and sampling considerations</title>
        <p>A summary of TimeCycle results in the synthetic data is found in <xref rid="btab476-F2" ref-type="fig">Figure 2</xref>. Receiver-operating characteristic (ROC) curves were computed for each of the 144 synthetic datasets, and the area under the curve (AUC) was used to compare classification accuracy across methods. An AUC of 1 represents perfect classification, while an AUC of 0.5 represents a classification no better than pure chance. AUC values are shown as a function of the number of samples collected per time-series. TimeCycle exhibits AUCs <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> across most sampling schemes, with the best performance observed for data sampled every 2-h for 48-h—the scheme primarily used in previous benchmarking studies (<xref rid="btab476-B7" ref-type="bibr">Deckard <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab476-B19" ref-type="bibr">Hutchison <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab476-B33" ref-type="bibr">Perea <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab476-B40" ref-type="bibr">Thaben and Westermark, 2014</xref>; <xref rid="btab476-B44" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
        <fig position="float" id="btab476-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>Synthetic data overview. (<bold>A</bold>) A total of 144 unique synthetic time-course datasets were generated in R with known ground truth, as described in <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic> (2020)</xref>. Each dataset consisted of a different number of replicates (1,2,3), sampling intervals (1-h, 2-h, 4-h), sampling lengths (36-h, 48-h, 72-h, 96-h) and noise levels (10%, 20%, 30%, 40%) as a percentage of the waveform amplitude. AUC scores for each method were computed across all 144 datasets. Lines represent the best linear fit across replicates and noise levels within a specified sampling scheme. Replicate time-series were averaged together for the GeneCycle and SW1PerS algorithm, since neither algorithm has a built-in method for handling replicates. (<bold>B</bold>) Type I and Type II error rates at varying FDR thresholds across methods for synthetic data sampled every 2-h for 48-h with 1 replicate. <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> marked by gray vertical line. (SW1PerS does not compute a <italic toggle="yes">P</italic>-value, but rather a periodicity score and was thus omitted from analysis.)</p>
          </caption>
          <graphic xlink:href="btab476f2" position="float"/>
        </fig>
        <p>Examining the type I and type II error rates relative to the FDR adjusted <italic toggle="yes">P</italic>-values across the varying noise levels, we find that TimeCycle and JTK_Cycle are more conservative in comparison to RAIN and GeneCycle (<xref rid="btab476-F2" ref-type="fig">Fig. 2B</xref>). This can also be seen in Supplementary Figure S2, which illustrates that the null distribution of <italic toggle="yes">P</italic>-values is biased toward 1 for both TimeCycle and JTK_Cycle (more strongly biased for JTK_Cycle), whereas small <italic toggle="yes">P</italic>-values are overrepresented under the null for RAIN and GeneCycle (leading to a greater chance of false positives) for non-cycling genes. Across all methods, false negative error rates increase with noise. (SW1PeRS was omitted from the type I and type II error analysis as it does not produce <italic toggle="yes">P</italic>-values, but rather a periodicity score.)</p>
        <p>Outside the 48-h sampling schemes, TimeCycle exhibits good performance for longer time-series sampled every 1 or 2-h, but reduced performance for sparser sampling (every 4-h compared to 1-h and 2-h), even for longer time-series. This is attributable to sparsely sampled manifolds in the reconstructed state space, resulting in an insufficient number of data-points for cycle formation. This suggests that, for a fixed number of samples, denser sampling for a shorter duration may be favorable to longer, sparser sampling.</p>
        <p>It is also instructive to examine how the classification accuracy for different waveforms changes with the sampling strategy. We find that for time-series lasting 36-h, strong symmetric cyclers are robustly detected, while asymmetric cyclers (such as the sawtooth) do not have sufficient points to close the cycle in the embedded space (that is, observations along the ‘sharp’ rise or fall of an asymmetric waveform may be missed when fewer than two complete periods are assayed, leading to a ‘C’ shape in the embedded space). At 72-h and 96-h, linear trending and damped oscillations are more likely to be classified as non-cycling due to the fact that as the time-series sampling is extended, the trends and dampening become more pronounced, dominating the underlying oscillation. Because these signals are not in fact strictly periodic (returning to precisely the same state at regular intervals), this can be a desirable or undesirable behavior depending on whether the user wishes to classify linear trending and damped oscillations as cycling. Details for an implementation with alternative parameters to detect oscillations with linear trends can be found in TimeCycle’s documentation.</p>
      </sec>
      <sec>
        <label>3.2.2</label>
        <title>Comparison to other methods</title>
        <p>To compare TimeCycle’s ability to distinguish cycling from non-cycling waveforms to that of other methods, we examined the pairwise comparison of raw <italic toggle="yes">P</italic>-values generated by each method. To simulate results for an ideal dataset, comparisons were made using the recommended sampling scheme—every 2-h for 48-h with one replicate—under low (10%) noise conditions (<xref rid="btab476-F3" ref-type="fig">Fig. 3</xref>). (Similar plots for varying noise levels can be found in Supplementary Figs S3–S5).</p>
        <fig position="float" id="btab476-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>48 h Synthetic Data Method Comparison—Noise Level 0.1. Comparison of TimeCycle, JTK_CYCLE, RAIN, SW1PerS and GeneCycle results for synthetic data of various waveform shapes. LOWER TRIANGLE: scatterplot of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> for each synthetic gene. The larger colored points represent the average <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> designated by waveform shape. DIAGONAL: Histogram of <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> for each synthetic gene by method. UPPER TRIANGLE: Classification accuracy comparison by waveform category. Darker bars correspond to the method listed in the row; lighter bars correspond to the method listed in the column. Each value corresponds to the fraction of correctly classified genes (true positive for cycling/non-cycling as appropriate) for a given waveform type, using a classification threshold obtained from Youden’s <italic toggle="yes">J</italic> index for the ROC across all genes. * SW1PerS does not compute a <italic toggle="yes">P</italic>-value, but rather a periodicity score. <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo>†</mml:mo></mml:math></inline-formula> GeneCycle results of <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>0 were set to machine precision (<inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mn>2.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) for visualization purposes.</p>
          </caption>
          <graphic xlink:href="btab476f3" position="float"/>
        </fig>
        <p>The lower triangle of <xref rid="btab476-F3" ref-type="fig">Figure 3</xref> depicts the pairwise scatterplot of the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> for each synthetic gene across methods, with the larger points designating the average <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> for a given waveform shape. (Note that, as previously discussed, SW1PerS does not compute a <italic toggle="yes">P</italic>-value; instead, the periodicity score is shown.) The results are generally well-correlated, with non-cycling waveforms clustering at low significance and sinusoidal waveforms ranked high; differences between methods are most noticeable for trending, sawtooth and contractile waveforms. Given the algorithmic similarities of RAIN/JTK_CYCLE (via the Jonckheere-Terpstra test) and TimeCycle/SW1PerS (via topological analysis), it is unsurprising that these methods are more highly correlated within method pairings than across methodological approaches.</p>
        <p>The upper triangle of <xref rid="btab476-F3" ref-type="fig">Figure 3</xref> measures the fraction of correctly classified signals for each waveform shape, i.e. the conditional probability of correctly classifying the gene as cycling or non-cycling given the waveform. Here, the decision threshold for classifying a given gene as cycling was chosen via Youden’s <italic toggle="yes">J</italic> statistic (<xref rid="btab476-B47" ref-type="bibr">Youden, 1950</xref>) computed from AUC over all genes. For the sampling scheme of 48-h every 2-h, TimeCycle’s accuracy was comparable to other methods for most waveform shapes with three exceptions: First, TimeCycle shows improved performance in detecting peaked and contractile waveforms across methods when samples are taken every 2-h across 48-h. Second, TimeCycle also shows improved detection of peaked waveforms in comparison to JTK_CYCLE, RAIN and GeneCycle, with a slight decrease in comparison to SW1PerS. Third, TimeCycle shows decreased performance in detecting linear trends across all methods. To mitigate this shortcoming, alternative parameters for the improved detection of genes with linear trends can be found in TimeCycle’s documentation. While TimeCycle outperforms other methods in certain circumstances, our result suggest that no method is uniformly best at picking up all types of circadian dynamics under all sampling schemes.</p>
      </sec>
      <sec>
        <title>3.2.3 Missing data and outliers</title>
        <p>Since missing data often occur as a result of sequencing errors with greater probability as the sample size increases (<xref rid="btab476-B12" ref-type="bibr">Gierliński <italic toggle="yes">et al.</italic>, 2015</xref>), researchers benefit from algorithms that can handle missingness. TimeCycle imputes the missing points via the linear interpolation algorithm as described by Moritz <italic toggle="yes">et al</italic> in their imputeTS R package (<xref rid="btab476-B29" ref-type="bibr">Moritz and Bartz-Beielstein, 2017</xref>). However, by introducing imputed data, one also introduces new assumptions—specifically, smoothness in the trajectory and hence small gene expression changes before/after the missing observation. These properties must be shared by the null model to ensure that the significance testing is not biased by the imputation. Hence, we perform the previously–described resampling procedure post-imputation, effectively taking the imputation assumptions into account when defining the null distribution.</p>
        <p>To investigate how TimeCycle performs when data are missing, we simulated missingness in the synthetic datasets (<xref rid="btab476-F4" ref-type="fig">Fig. 4</xref>). For each of the 11 000 genes, we randomly removed points sweeping from 0% missingness until only 2 points remained. The AUC was computed at each missingness value (<xref rid="btab476-F4" ref-type="fig">Fig. 4A</xref>). At 50% missingness in the synthetic data, TimeCycle shows robust classification with a slow decrease in AUC for each noise level. We observe that the difference in AUC between noise levels is greater than the degradation in AUC as a function of missingness (<xref rid="btab476-F4" ref-type="fig">Fig. 4A and B</xref>). The differences are primarily attributable to decreases in sensitivity, with high levels of noise and missingness compromising the ability to detect cycling genes. We find little decrease in specificity, confirming that the ‘smoothing’ induced by the imputation procedure does not generate false positives. Missing data analyses for JTK_CYCLE, RAIN and GeneCycle can be found in Supplementary Figures S6–S8.</p>
        <fig position="float" id="btab476-F4">
          <label>Fig. 4.</label>
          <caption>
            <p>Missing data results. (<bold>A</bold>) TimeCycle AUC scores across varying levels of percent missingness per gene when sampled every 2-h for 48 h with one replicate. Results are shown for each level of noise. 50% missingness is highlighted by the vertical orange line. (<bold>B</bold>) TOP: ROC curves for each percent missingness depicted in the AUC score plot in panel A above. ROC curves scaled from Blue (0% missingness) to gray (96% missingness). 50% missingness is again highlighted by the orange curve. BOTTOM: Histogram of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at the different noise levels corresponding to the orange 50% missingness ROC plot.</p>
          </caption>
          <graphic xlink:href="btab476f4" position="float"/>
        </fig>
        <p>As an additional check of method robustness, we performed an outlier analysis across all 36 variants of the 48-h sampling lengths. Outliers were injected into the time–series at a rate of 1% of all sampled time–points and were drawn from a uniform distribution between <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>μ</mml:mo><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>σ</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>σ</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> of the diurnal mean (<italic toggle="yes">μ</italic>) for each time–series, following previous studies (<xref rid="btab476-B14" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab476-B37" ref-type="bibr">Salkovic <italic toggle="yes">et al.</italic>, 2020</xref>). TimeCycle exhibited a very slight and non-significant decrease in average AUC <sub><bold>±</bold></sub> SD across all noise levels (<inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.86</mml:mn><mml:mo>±</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> versus <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.87</mml:mn><mml:mo>±</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, with and without outliers, respectively); other methods also remained unchanged (Supplementary Fig. S9). As expected from the unchanged AUC, the type I and type II error rates were also unaltered. This suggests that the performance of TimeCycle, as well as other methods, is robust to outliers.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Application to biological data: reproducibility analysis</title>
      <p>While synthetic data has the advantage of known ground truth, it also has the drawback of not necessarily being representative of the real biological datasets. On the other hand, measuring a method’s accuracy using real data is limited, as the ground truth is not generally known. Instead, one may test the reproducibility of the results, under the assumption that a true biological signal should be consistently detected across multiple studies of the same condition.</p>
      <p>To this end, we took a ‘cross-study concordance’ approach in which we tested the ability of each method to consistently characterize a set of 12 868 genes measured in three independent mouse liver time-series expression sets (<xref rid="btab476-B13" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2009</xref>, <xref rid="btab476-B15" ref-type="bibr">2012</xref>; <xref rid="btab476-B48" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2014</xref>). We expect that a method that accurately detects cycling genes should do so reproducibly in all three datasets, whereas a method that is no better than chance will yield divergent results in the three datasets. Moreover, the genes detected as cycling in common across the dataset should exhibit similar dynamics across all three datasets. By contrast, if a method is overly permissive, leading to a high false-positive rate, genes may be classified as ‘cycling’ across datasets without actually having any commonality in their dynamics. We evaluate both of these by (i) examining the overlap in genes classified as cycling in the various datasets [following the Methods of <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic> (2020)</xref>] and (ii) computing the rank correlation <italic toggle="yes">ρ</italic> of the expression profiles of the genes detected as cycling at <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mtext>LogFC</mml:mtext><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Together, our analysis quantifies whether the cycling detection is reproducible.</p>
      <p>The datasets used in this analysis were comparable, but independent time-series studies of gene expression in mouse liver, referred to hereafter as Hogenesch (<xref rid="btab476-B13" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2009</xref>), Hughes (<xref rid="btab476-B15" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2012</xref>) and Zhang (<xref rid="btab476-B48" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2014</xref>). These datasets are summarized in <xref rid="btab476-T1" ref-type="table">Table 1</xref>. The Hogenesch dataset (<xref rid="btab476-B13" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2009</xref>) was downsampled to two datasets sampled every 2-h for 48-h (Hogenesch 2A and Hogenesch 2B) to be consistent with the sampling schemes of the Hughes (<xref rid="btab476-B15" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2012</xref>) and Zhang (<xref rid="btab476-B48" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2014</xref>) studies. Following application of TimeCycle, genes with <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> were classified as cycling; the overlap in the cycling genes for the various datasets is given (<xref rid="btab476-F5" ref-type="fig">Fig. 5A:</xref> Top). Comparing the distribution of the FDR-corrected <italic toggle="yes">P</italic>-values for the known circadian genes relative to all genes shows a statistically significant shift across all four datasets, with circadian genes more likely to have significant <italic toggle="yes">P</italic>-values (<xref rid="btab476-F5" ref-type="fig">Fig. 5A:</xref> Bottom), confirming the intuition that known circadian genes should show enriched cycling. Furthermore, the known circadian genes Per1, Cry1, Npas2 and Clock were detected across multiple studies.</p>
      <fig position="float" id="btab476-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>TimeCycle Biological Data Results. (<bold>A</bold>) TOP: Upset plot showing overlap between significant cycling genes sets detected by TimeCycle at an FDR &lt; 0.05 across 3 distinct mouse liver time-series datasets as described in (<xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>).The Zhang and Hughes datasets were sampled every 2-h for 48-h. The Hogenesch study, sampled every 1-h for 48-h, was downsampled into two datasets sampled every 2-h for 48-h (Hogenesch 2A and Hogenesch 2B). BOTTOM: Distribution of FDR-adjusted <italic toggle="yes">P</italic>-values of the known circadian genes (orange) versus all genes (gray). Circadian genes were extracted from the CGDB database (<xref rid="btab476-B25" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2017</xref>). Only circadian genes that were experimentally validated in mouse liver tissue through low-throughput methods were included in the analysis. (<bold>B</bold>) Percentage of genes concordantly called cycling or non-cycling across studies at varying FDR thresholds in each pair of studies; comparisons to other methods are also shown. (<bold>C</bold>) LogFC amplitude, period and phase scatterplot comparison of genes identified as cycling in both the Zhang and Hughes datasets with an FDR &lt; 0.05. (<bold>D</bold>) Heatmap of the cycling genes detected in each dataset with an FDR &lt; 0.05 ordered by phase. Orange and gray represents gene expression above and below diurnal mean, respectively. (<bold>E</bold>) Rank correlation CDFs of genes identified by each method with an FDR &lt; 0.05 and LogFC &lt; 2 in one dataset compared to their pairwise expression in the other datasets. The null distribution represents the rank correlation of a random sampling of all 12 868 genes with replacement in the pairwise comparisons of all datasets. All gene correlation represents the rank correlation on a per gene basis for all 12 868 genes in the pairwise comparisons of all datasets.</p>
        </caption>
        <graphic xlink:href="btab476f5" position="float"/>
      </fig>
      <table-wrap position="float" id="btab476-T1">
        <label>Table 1.</label>
        <caption>
          <p>Experimental design biological data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Hogenesch <xref rid="btab476-B13" ref-type="bibr">(Hughes 2009)</xref></th>
              <th rowspan="1" colspan="1">Hughes <xref rid="btab476-B15" ref-type="bibr">(Hughes 2012)</xref></th>
              <th rowspan="1" colspan="1">Zhang <xref rid="btab476-B48" ref-type="bibr">(Zhang 2014)</xref></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Genotype</td>
              <td rowspan="1" colspan="1">Wild-type C57BL/6J</td>
              <td rowspan="1" colspan="1">Wild-type C57BL/6J</td>
              <td rowspan="1" colspan="1">Wild-type C57BL/6J</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Age</td>
              <td rowspan="1" colspan="1">6 weeks</td>
              <td rowspan="1" colspan="1">Not Specified</td>
              <td rowspan="1" colspan="1">6 weeks</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Entertainment condition</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE30">
                  <mml:math id="IM30" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>12</mml:mn>
                      <mml:mi>h</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:mn>12</mml:mn>
                      <mml:mi>h</mml:mi>
                      <mml:mi>L</mml:mi>
                      <mml:mi>D</mml:mi>
                      <mml:mo>→</mml:mo>
                      <mml:mi>D</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE31">
                  <mml:math id="IM31" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>12</mml:mn>
                      <mml:mi>h</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:mn>12</mml:mn>
                      <mml:mi>h</mml:mi>
                      <mml:mi>L</mml:mi>
                      <mml:mi>D</mml:mi>
                      <mml:mo>→</mml:mo>
                      <mml:mi>D</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE32">
                  <mml:math id="IM32" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>12</mml:mn>
                      <mml:mi>h</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:mn>12</mml:mn>
                      <mml:mi>h</mml:mi>
                      <mml:mi>L</mml:mi>
                      <mml:mi>D</mml:mi>
                      <mml:mo>→</mml:mo>
                      <mml:mi>D</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Entrainment length</td>
              <td rowspan="1" colspan="1">1 Week</td>
              <td rowspan="1" colspan="1">1 Week</td>
              <td rowspan="1" colspan="1">1 Week</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Microarray platform</td>
              <td rowspan="1" colspan="1">Affy Mouse 430 2.0</td>
              <td rowspan="1" colspan="1">Affy MoEx 1.0 ST</td>
              <td rowspan="1" colspan="1">Affy MoGe 1.0 ST</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Sampling scheme</td>
              <td rowspan="1" colspan="1">Every 1-h for 48-h</td>
              <td rowspan="1" colspan="1">Every 2-h for 48-h</td>
              <td rowspan="1" colspan="1">Every 2-h for 48-h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ZT start time</td>
              <td rowspan="1" colspan="1">ZT 18</td>
              <td rowspan="1" colspan="1">ZT 0</td>
              <td rowspan="1" colspan="1">ZT 18</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Samples per time point</td>
              <td rowspan="1" colspan="1">3–5 Male</td>
              <td rowspan="1" colspan="1">2 Male and 2 Female</td>
              <td rowspan="1" colspan="1">3 Male</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GEO accession number</td>
              <td rowspan="1" colspan="1">GSE11923</td>
              <td rowspan="1" colspan="1">GSE30411</td>
              <td rowspan="1" colspan="1">GSE54650</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: Three mouse liver time-series expression sets (<xref rid="btab476-B13" ref-type="bibr">Hughes 2009</xref>; <xref rid="btab476-B15" ref-type="bibr">Hughes 2012</xref>; <xref rid="btab476-B48" ref-type="bibr">Zhang 2014</xref>) were analyzed from the Gene Expression Omnibus database (GEO). In each experiment, Wild-type C57BL/6J mice where entrained to a 12-h light, 12-h dark environment for a week before being released into constant darkness, a standard practice in the field for assessing circadian function. The Hogenesch study sampled mice every 1-h for 48-h, while the Hughes and Zhang studies sampled every 2-h for 48-h. Other variations in the datasets include microarray platform, ZT time of sampling and number of mice sampled per time point. Adapted from <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic> (2020)</xref>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To investigate whether the reproducibility was robust to the (somewhat arbitrary) choice of significance threshold, we calculated the percent of genes concordantly classified as cycling or non-cycling for each pair of studies as a function of the FDR significance threshold (<xref rid="btab476-F5" ref-type="fig">Fig. 5B</xref>). The concordance is generally higher for TimeCycle relative to other methods at conservative significance thresholds <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. This implies that genes identified as cycling by TimeCycle are likely to be reproducible.</p>
      <p>The Hughes and Zhang studies differed in the sampling start phase by 6-h, presenting an opportunity to examine whether genes detected as cycling in both had similar estimated periods and amplitudes, but differing phases, as would be expected if the cycling detection is accurate (<xref rid="btab476-B31" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2021</xref>). We find that genes detected as cycling in both the Zhang and Hughes datasets with an FDR &lt; 0.05 also had highly reproducible amplitudes across the various datasets (Pearson correlation <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0.9, <xref rid="btab476-F5" ref-type="fig">Fig. 5C</xref>). We also find that genes identified as cycling clustered around a period of 24 h, indicating that these are indeed circadian oscillators. Finally, plotting the computed phase of genes detected reflects the 6-h phase shift (modulo 24 h) as expected (<xref rid="btab476-F5" ref-type="fig">Fig. 5C</xref>). Heatmaps of cycling genes detected across datasets are shown (<xref rid="btab476-F5" ref-type="fig">Fig. 5D</xref>).</p>
      <p>We then examined more broadly whether genes that are detected as cycling across different studies exhibit similar dynamics, and compared TimeCycle’s results to other methods. A method that has a high rate of false-positives may indeed identify many genes as cycling in common across studies, but by chance rather than detecting a meaningful signal. Hence, we assess whether the genes that are identified as cycling in multiple studies of the same tissue also have reproducible dynamics. For each study and each gene, we computed the rank correlation of its time-series in the reference study with the same gene’s time-series in the other studies. We expect that genes under true circadian control should exhibit more correlated dynamics amongst the studies than the set of all genes. We thus computed empirical CDFs of the correlations for genes identified as cycling (<inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>) by each method (Since SW1PerS does not produce a <italic toggle="yes">P</italic>-value to classify genes as cycling/non-cycling, it was omitted from this comparison.) (<xref rid="btab476-F5" ref-type="fig">Fig. 5E</xref>). In this figure, the null distribution represents the rank correlation of a random sampling of all 12 868 genes with replacement in the pairwise comparisons of all datasets, and the all-gene correlation represents the rank correlations for all 12 868 genes in the pairwise comparisons of all datasets. TimeCycle, JTK_CYCLE and GeneCycle show a statistically significant shift in the distribution of rank correlations in comparison to RAIN, the all-gene correlation and the null distribution in all datasets (all <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mn>2.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, Kolmogorov-Smirnov test). We conclude from this that TimeCycle reliably detects cycling dynamics across multiple studies of the same tissue.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have presented TimeCycle, a new method that leverages results from dynamical systems theory and topology to detect patterns of cyclic expression in time-series experiments. TimeCycle reconstructs the state space for the dynamical system governing each gene using time-delay embedding, and quantifies how cyclic the embedding is using persistence homology. Statistical significance is assessed by comparing the persistence scores to those that obtain from a resampled null model. TimeCycle accurately detects rhythmic transcripts in both synthetic and real biological data, and is robust to missingness, noise and non-cyclic components in the dynamics.</p>
    <p>A few methodological innovations distinguish TimeCycle from other cycling-detection algorithms. In contrast to methods that compare gene expression profiles to templates of expected cycling patterns, TimeCycle reconstructs the underlying dynamical system directly from the observed data. This enables TimeCycle to articulate more complex dynamics than can be easily considered using template-based approaches. Additionally, the method to construct the null distribution is both computationally efficient and biologically representative. SW1PerS (a prior method that also used persistence homology rather than a template) did not implement hypothesis testing due to the computational cost, while template-based methods that implement hypothesis testing do so by resampling the time-series in a manner that can generate biologically implausible null models. TimeCycle is thus an improvement in both regards.</p>
    <p>From a practical standpoint, we identified strengths and weaknesses of TimeCycle’s ability to detect cycling transcripts under varying conditions. We find that TimeCycle is better able to detect sharply peaked waveforms and waveforms where the period appears variable, while JTK_Cycle, RAIN and GeneCycle are more robust with respect to linear trends. This is in keeping with prior work (<xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>) demonstrating that no cycling detection method is consistently ‘best’ for all genes. Instead, it is incumbent upon the researcher to consider the patterns of gene expression that are of the greatest interest and choose a method accordingly.</p>
    <p>The results also highlight the importance of constructing biologically representative null models. By resampling the finite differences from the gene expression time-series to construct a null distribution of persistence scores, TimeCycle tests whether an observed gene has a stronger cycling behavior than expected by chance, conditioned upon the speed at which the expression is capable of changing. This improves upon SW1PerS, which does not compute a <italic toggle="yes">P</italic>-value, and also upon methods such as RAIN that randomize the time-series itself. We note that this method for constructing the null distributions could also be adapted for other methods, and emphasize the need for method developers to consider biological constraints when devising null models.</p>
    <p>A practical consequence of TimeCycle’s methodological features is that the genes detected as cycling by TimeCycle are highly reproducible. Applied to three independent studies of mouse live gene expression, TimeCycle consistently identified genes as cycling in multiple studies, and those genes were shown to exhibit reproducible dynamics.</p>
    <p>Finally, we note that the experimental sampling design remains a crucial factor for the reliability of any cycling detection method. As with other methods (<xref rid="btab476-B16" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab476-B30" ref-type="bibr">Ness-Cohn <italic toggle="yes">et al.</italic>, 2020</xref>), TimeCycle performs best when applied to time-series spanning 48-h sampled every 2-h, and is considerably less accurate for shorter and sparser sampling. These findings underscore the important role that experimental design—not only the method choice—plays in the analysis of circadian data.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>Research reported in this publication was supported by the NSF-Simons Center for Quantitative Biology at Northwestern University, an NSF-Simons MathBioSys Research Center. This work was supported by a grant from the Simons Foundation/SFARI [597491-RWC] and the National Science Foundation [1764421]. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Science Foundation and Simons Foundation. This research was supported in part through the computational resources and staff contributions provided for the Quest high performance computing facility at Northwestern University which is jointly supported by the Office of the Provost, the Office for Research, and Northwestern University Information Technology.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Data and source code to reproduce the analysis and figures in this article are available at: <ext-link xlink:href="https://github.com/nesscoder/TimeCycle-data" ext-link-type="uri">https://github.com/nesscoder/TimeCycle-data</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab476_Supplementary_Data</label>
      <media xlink:href="btab476_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>E.N.C. and R.B. devised the TimeCycle method and designed the study; E.N.C developed the TimeCycle package, analyzed the data and produced the tutorials/documentation; E.N.C. and R.B. wrote the article.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab476-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahdesmäki</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) <article-title>Robust regression for periodicity detection in non-uniformly sampled time-course gene expression data</article-title>. <source>BMC Bioinformatics</source>, <volume>8</volume>, <fpage>233</fpage>.<pub-id pub-id-type="pmid">17605777</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname><given-names>S.</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belkin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Niyogi</surname><given-names>P.</given-names></string-name></person-group> (<year>2003</year>) <article-title>Laplacian eigenmaps for dimensionality reduction and data representation</article-title>. <source>Neural Comput</source>., <volume>15</volume>, <fpage>1373</fpage>–<lpage>1396</lpage>.</mixed-citation>
    </ref>
    <ref id="btab476-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Braun</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Universal method for robust detection of circadian state from gene expression</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>115</volume>, <fpage>E9247</fpage>–<lpage>E9256</lpage>.<pub-id pub-id-type="pmid">30201705</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Sleep timing and circadian phase in delayed sleep phase syndrome</article-title>. <source>J. Biol. Rhythms</source>, <volume>24</volume>, <fpage>313</fpage>–<lpage>321</lpage>.<pub-id pub-id-type="pmid">19625733</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Lichtenberg</surname><given-names>U.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>Comparison of computational methods for the identification of cell cycle-regulated genes</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>1164</fpage>–<lpage>1171</lpage>.<pub-id pub-id-type="pmid">15513999</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deckard</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Design and analysis of large-scale biological rhythm studies: a comparison of algorithms for detecting periodic signals in biological data</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>3174</fpage>–<lpage>3180</lpage>.<pub-id pub-id-type="pmid">24058056</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deshmukh</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Using curvature to select the time lag for delay reconstruction</article-title>. <source>Chaos</source>, <volume>30</volume>, <fpage>063143</fpage>.<pub-id pub-id-type="pmid">32611109</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Edelsbrunner</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) <article-title>Topological persistence and simplification</article-title>. <source>Discrete Comput. Geometry</source>, <volume>28</volume>, <fpage>511</fpage>–<lpage>533</lpage>.</mixed-citation>
    </ref>
    <ref id="btab476-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fraser</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Swinney</surname><given-names>H.L.</given-names></string-name></person-group> (<year>1986</year>) <article-title>Independent coordinates for strange attractors from mutual information</article-title>. <source>Phys. Rev. A</source>, <volume>33</volume>, <fpage>1134</fpage>–<lpage>1140</lpage>.</mixed-citation>
    </ref>
    <ref id="btab476-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garland</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Leveraging information storage to select forecast-optimal parameters for delay-coordinate reconstructions</article-title>. <source>Phys. Rev. E</source>, <volume>93</volume>, <fpage>022221</fpage>.<pub-id pub-id-type="pmid">26986345</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gierliński</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Statistical models for RNA-seq data derived from a two-condition 48-replicate experiment</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3625</fpage>–<lpage>3630</lpage>.<pub-id pub-id-type="pmid">26206307</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hughes</surname><given-names>M.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Harmonics of circadian gene transcription in mammals</article-title>. <source>PLoS Genet</source>., <volume>5</volume>, <fpage>e1000442</fpage>.<pub-id pub-id-type="pmid">19343201</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hughes</surname><given-names>M.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>JTK_CYCLE: an efficient nonparametric algorithm for detecting rhythmic components in genome-scale data sets</article-title>. <source>J. Biol. Rhythms</source>, <volume>25</volume>, <fpage>372</fpage>–<lpage>380</lpage>.<pub-id pub-id-type="pmid">20876817</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hughes</surname><given-names>M.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Brain-specific rescue of Clock reveals system-driven transcriptional rhythms in peripheral tissue</article-title>. <source>PLoS Genet</source>., <volume>8</volume>, <fpage>e1002835</fpage>.<pub-id pub-id-type="pmid">22844252</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hughes</surname><given-names>M.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Guidelines for genome-scale analysis of biological rhythms</article-title>. <source>J. Biol. Rhythms</source>, <volume>32</volume>, <fpage>380</fpage>–<lpage>393</lpage>.<pub-id pub-id-type="pmid">29098954</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hutchison</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Dinner</surname><given-names>A.R.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Correcting for dependent P-values in Rhythm Detection</article-title>. <source>bioRxiv</source>, <fpage>118547</fpage>. <pub-id pub-id-type="doi">10.1101/118547</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hutchison</surname><given-names>A.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Improved statistical methods enable greater sensitivity in rhythm detection for genome-wide data</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004094</fpage>.<pub-id pub-id-type="pmid">25793520</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hutchison</surname><given-names>A.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Bootstrapping and empirical bayes methods improve rhythm detection in sparsely sampled data</article-title>. <source>J. Biol. Rhythms</source>, <volume>33</volume>, <fpage>339</fpage>–<lpage>349</lpage>.<pub-id pub-id-type="pmid">30101659</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kathale</surname>,<given-names>N.D.</given-names></string-name>, <string-name><surname>Liu</surname>,<given-names>A.C.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Prevalence of cycling genes and drug targets calls for prospective chronotherapeutics</article-title>. <source><italic toggle="yes">Proceedings of the National Academy of Sciences of the United States of America</italic></source>, <volume>111</volume>, <fpage>15869</fpage>–<lpage>15870</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1418570111</pub-id> 25368193<pub-id pub-id-type="pmid">25368193</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laloum</surname><given-names>D.</given-names></string-name>, <string-name><surname>Robinson-Rechavi</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Methods detecting rhythmic gene expression are biologically relevant only for strong signal</article-title>. <source>PLoS Comput. Biol</source>., <volume>16</volume>, <fpage>e1007666</fpage>.<pub-id pub-id-type="pmid">32182235</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levi</surname><given-names>F.</given-names></string-name>, <string-name><surname>Schibler</surname><given-names>U.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Circadian rhythms: mechanisms and therapeutic implications</article-title>. <source>Annu. Rev. Pharmacol. Toxicol</source>., <volume>47</volume>, <fpage>593</fpage>–<lpage>628</lpage>.<pub-id pub-id-type="pmid">17209800</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>D.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>NAD+ controls circadian reprogramming through PER2 nuclear translocation to counter aging</article-title>. <source>Mol. Cell</source>, <volume>78</volume>, <fpage>835</fpage>–<lpage>849.e7</lpage>.<pub-id pub-id-type="pmid">32369735</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) <article-title>Signal analysis of behavioral and molecular cycles</article-title>. <source>BMC Neuroscience</source>, <volume>3</volume>, <fpage>1</fpage>.<pub-id pub-id-type="pmid">11825337</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>CGDB: a database of circadian genes in eukaryotes</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D397</fpage>–<lpage>D403</lpage>.<pub-id pub-id-type="pmid">27789706</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>M.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mei</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Genome-wide circadian rhythm detection methods: systematic evaluations and practical guidelines</article-title>. <source>Brief. Bioinf</source>., <volume>22</volume>, <fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="btab476-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Michael</surname><given-names>T.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Network discovery pipeline elucidates conserved time-of-day-specific cis-regulatory modules</article-title>. <source>PLoS Genet</source>., <volume>4</volume>, <fpage>e14</fpage>.<pub-id pub-id-type="pmid">18248097</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moritz</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bartz-Beielstein</surname><given-names>T.</given-names></string-name></person-group> (<year>2017</year>) <article-title>imputeTS: time series missing value imputation in R</article-title>. <source>R. J</source>., <volume>9</volume>, <fpage>207</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="btab476-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ness-Cohn</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>TimeTrial: an interactive application for optimizing the design and analysis of transcriptomic time-series data in circadian biology research</article-title>. <source>J. Biol. Rhythms</source>, <volume>35</volume>, <fpage>439</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">32613882</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ness-Cohn</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Comment on “Circadian rhythms in the absence of the clock gene Bmal1”</article-title>. <source>Science</source>, <volume>372</volume>, <fpage>eabe9230</fpage>.<pub-id pub-id-type="pmid">33859007</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patke</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Mutation of the human circadian clock gene CRY1 in familial delayed sleep phase disorder</article-title>. <source>Cell</source>, <volume>169</volume>, <fpage>203</fpage>–<lpage>215.e13</lpage>.<pub-id pub-id-type="pmid">28388406</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perea</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>SW1PerS: sliding windows and 1-persistence scoring; discovering periodicity in gene expression time series data</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>257</fpage>.<pub-id pub-id-type="pmid">26277424</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B34">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Puttonen</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) Shift work and cardiovascular disease – pathways from circadian stress to morbidity.</mixed-citation>
    </ref>
    <ref id="btab476-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robin</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>77</fpage>.<pub-id pub-id-type="pmid">21414208</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roenneberg</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) <article-title>Epidemiology of the human circadian clock</article-title>. <source>Sleep Med. Rev</source>., <volume>11</volume>, <fpage>429</fpage>–<lpage>438</lpage>.<pub-id pub-id-type="pmid">17936039</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salkovic</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>OutPyR: Bayesian inference for RNA-Seq outlier detection</article-title>. <source>J. Comput. Sci</source>., <volume>47</volume>, <fpage>101245</fpage>.</mixed-citation>
    </ref>
    <ref id="btab476-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Straume</surname><given-names>M.</given-names></string-name></person-group> (<year>2004</year>) <article-title>DNA microarray time series analysis: automated statistical assessment of circadian rhythms in gene expression patterning</article-title>. <source>Methods Enzymol</source>., <volume>383</volume>, <fpage>149</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">15063650</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B39">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Takens</surname><given-names>F.</given-names></string-name></person-group> (<year>1981</year>) Detecting strange attractors in turbulence. In: Rand D., Young LS. (eds) Dynamical Systems and Turbulence, Warwick 1980. Lecture Notes in Mathematics, vol 898. Springer, Berlin, Heidelberg.</mixed-citation>
    </ref>
    <ref id="btab476-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thaben</surname><given-names>P.F.</given-names></string-name>, <string-name><surname>Westermark</surname><given-names>P.O.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Detecting rhythms in time series with RAIN</article-title>. <source>J. Biol. Rhythms</source>, <volume>29</volume>, <fpage>391</fpage>–<lpage>400</lpage>.<pub-id pub-id-type="pmid">25326247</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thaben</surname><given-names>P.F</given-names></string-name>, <string-name><surname>Westermark</surname><given-names>P.O.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Differential rhythmicity: detecting altered rhythmicity in biological data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2800</fpage>–<lpage>2808</lpage>.<pub-id pub-id-type="pmid">27207944</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Videnovic</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Circadian melatonin rhythm and excessive daytime sleepiness in Parkinson disease</article-title>. <source>JAMA Neurol</source>., <volume>71</volume>, <fpage>463</fpage>–<lpage>469</lpage>.<pub-id pub-id-type="pmid">24566763</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wichert</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) <article-title>Identifying periodically expressed trascripts in microarry time series data</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>5</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">14693803</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Evaluation of five methods for genome-wide circadian gene identification</article-title>. <source>J. Biol. Rhythms</source>, <volume>29</volume>, <fpage>231</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">25238853</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>MetaCycle: an integrated R package to evaluate periodicity in large scale data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3351</fpage>–<lpage>3353</lpage>.<pub-id pub-id-type="pmid">27378304</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Su</surname><given-names>Z.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Analyzing circadian expression data by harmonic regression based on autoregressive spectral estimation</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>i168</fpage>–<lpage>i174</lpage>.<pub-id pub-id-type="pmid">20529902</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Youden</surname><given-names>W.J.</given-names></string-name></person-group> (<year>1950</year>) <article-title>Index for rating diagnostic tests</article-title>. <source>Cancer</source>, <volume>3</volume>, <fpage>32</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">15405679</pub-id></mixed-citation>
    </ref>
    <ref id="btab476-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>A circadian gene expression atlas in mammals: implications for biology and medicine</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>111</volume>, <fpage>16219</fpage>–<lpage>16224</lpage>.<pub-id pub-id-type="pmid">25349387</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
