<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6929335</article-id>
    <article-id pub-id-type="publisher-id">3211</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3211-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scDC: single cell differential composition analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cao</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Yingxin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ormerod</surname>
          <given-names>John T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Pengyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Jean Y.H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9392-512X</contrib-id>
        <name>
          <surname>Lo</surname>
          <given-names>Kitty K.</given-names>
        </name>
        <address>
          <email>kitty.lo@sydney.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 834X</institution-id><institution-id institution-id-type="GRID">grid.1013.3</institution-id><institution>School of Mathematics and Statistics, The University of Sydney, </institution></institution-wrap>Sydney, NSW 2006 Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 834X</institution-id><institution-id institution-id-type="GRID">grid.1013.3</institution-id><institution>Charles Perkins Centre, The University of Sydney, </institution></institution-wrap>Sydney, NSW 2006 Australia </aff>
      <aff id="Aff3"><label>3</label>Children’s Medical Research Institute, Faculty of Medicine and Health, The University of Sydney, Sydney, NSW 2145 Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 19</issue>
    <elocation-id>721</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Differences in cell-type composition across subjects and conditions often carry biological significance. Recent advancements in single cell sequencing technologies enable cell-types to be identified at the single cell level, and as a result, cell-type composition of tissues can now be studied in exquisite detail. However, a number of challenges remain with cell-type composition analysis – none of the existing methods can identify cell-type perfectly and variability related to cell sampling exists in any single cell experiment. This necessitates the development of method for estimating uncertainty in cell-type composition.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed a novel single cell differential composition (scDC) analysis method that performs differential cell-type composition analysis via bootstrap resampling. scDC captures the uncertainty associated with cell-type proportions of each subject via bias-corrected and accelerated bootstrap confidence intervals. We assessed the performance of our method using a number of simulated datasets and synthetic datasets curated from publicly available single cell datasets. In simulated datasets, scDC correctly recovered the true cell-type proportions. In synthetic datasets, the cell-type compositions returned by scDC were highly concordant with reference cell-type compositions from the original data. Since the majority of datasets tested in this study have only 2 to 5 subjects per condition, the addition of confidence intervals enabled better comparisons of compositional differences between subjects and across conditions.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">scDC is a novel statistical method for performing differential cell-type composition analysis for scRNA-seq data. It uses bootstrap resampling to estimate the standard errors associated with cell-type proportion estimates and performs significance testing through GLM and GLMM models. We have made this method available to the scientific community as part of the <italic>scdney</italic> package (<bold>S</bold>ingle <bold>C</bold>ell <bold>D</bold>ata I<bold>n</bold>t<bold>e</bold>grative Anal<bold>y</bold>sis) R package, available from <ext-link ext-link-type="uri" xlink:href="https://github.com/SydneyBioX/scdney">https://github.com/SydneyBioX/scdney</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single cell</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>scRNA-seq</kwd>
      <kwd>Composition analysis</kwd>
    </kwd-group>
    <conference xlink:href="https://incob2019.org/">
      <conf-name>International Conference on Bioinformatics (InCoB 2019)</conf-name>
      <conf-acronym>InCoB 2019</conf-acronym>
      <conf-loc>Jakarta, Indonesia</conf-loc>
      <conf-date>10-12 Septemebr 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Tissues are composed of many heterogeneous cell-types and differences in cell-type proportions often carry biological significance. For example, cell-type compositional differences can shed light on disease mechanisms [<xref ref-type="bibr" rid="CR1">1</xref>], immune response in cancer [<xref ref-type="bibr" rid="CR2">2</xref>] and developmental processes [<xref ref-type="bibr" rid="CR3">3</xref>]. In recent years, single cell RNA sequencing (scRNA-seq) has become an increasingly popular technology as it allows the cell-type identity of each individual cell sequenced to be inferred. This has enabled generation of insights through comparison of cell-type composition between samples.</p>
    <p>There are many challenges associated with estimating cell-type composition. First, there could be technical biases for each cell-type. Certain cell-types may be more prone to damage under existing scRNA-seq protocols [<xref ref-type="bibr" rid="CR4">4</xref>], leading to bias and perhaps a larger variance in cell-type proportions. Second, there are many proposed methods for cell-type identification and none of them guarantees perfect identification accuracy. A systematic evaluation of 14 common clustering algorithms revealed differences in performance and clustering result [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. A further evaluation on similarity metrics in clustering algorithms illustrates further inconsistency in results due to the different metrics used for measuring differences in cell transcriptomes [<xref ref-type="bibr" rid="CR7">7</xref>]. In addition, as the compositions sum to one, this transforms the data from the Euclidean space into a simplex space. Canonical statistical tests such as t-test may not be reliable, as these are not designed for relative proportion data [<xref ref-type="bibr" rid="CR8">8</xref>]. These issues all highlight the difficulty and uncertainty associated with cell-type identification. However, there is a current lack of methodological research on cell-type compositional analysis for single cell data. Whilst some research papers draw observations on compositional differences of cell-types between conditions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], such observations are not accompanied by a measure of uncertainty associated with the estimates. In contrast to the lack of such studies in the field of single cell analysis, compositional analysis has been an active and ongoing area in microbiome research, due to the compositional nature of microbiome data. Dirichlet – multinomial models have been used extensively for microbiome research, in which Dirichlet Monte Carlo procedures are used to obtain posterior distributions of sample proportions [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. However, due to the small sample size of scRNA-seq data, fitting a Dirichlet multinomial is not currently feasible.</p>
    <p>In this paper, we present <bold>s</bold>ingle <bold>c</bold>ell <bold>D</bold>ifferential <bold>C</bold>omposition (scDC), a method for estimating uncertainty in cell-type proportions via bootstrapping. Our method provides a bias-corrected estimate of cell-type proportions confidence intervals, and by performing clustering within each bootstrap iteration it also captures the uncertainty associated with cell-type identification. In scRNA-seq experiments with small sample sizes, such estimates of cell-type proportion uncertainties would be useful in determining the significance of cell-type compositional differences between conditions. In the future where multi-sample comparative scRNA-seq experiments are likely to become common place, our method offers a statistically robust way to propagate uncertainty in downstream analysis. We demonstrate this using two synthetic datasets derived from published experimental data. Finally, we implemented scDC as part of the <italic>scdney</italic> R package which is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/SydneyBioX/scdney">https://github.com/SydneyBioX/scdney</ext-link>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of single cell differential composition analysis (scDC)</title>
      <p>We developed scDC (workflow shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>), a novel approach based on bootstrap resampling, to perform differential cell-type composition analysis. Let <italic>Y</italic><sub><italic>ij</italic></sub> be a matrix of cell counts from <italic>i</italic>=1,…,<italic>C</italic> cell-types and <italic>j</italic>=1,…,<italic>R</italic> subjects. The first step of scDC involves stratified bootstrap resampling where we sampled with replacement <italic>N</italic><sub><italic>j</italic></sub> cells from the cell count matrix <italic>Y</italic><sub><italic>ij</italic></sub> for subject <italic>j</italic>. Stratification by subject is important because it ensures unbiased bootstrap estimates and captures subject to subject variability. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{bj}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq1.gif"/></alternatives></inline-formula> be the <italic>b</italic><sup><italic>t</italic><italic>h</italic></sup> bootstrap sample for the <italic>j</italic><sup><italic>t</italic><italic>h</italic></sup> subject. Subsequently, for each bootstrap iteration, we combined resampled cell counts <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{b1},\ldots,Y^{*}_{bR}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bR</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq2.gif"/></alternatives></inline-formula> for all <italic>R</italic> subjects.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of scDC workflow. This illustrates the main components of the scDC procedure. The key functions have been included on top of each sub-figure, where relevant. <bold>a</bold> Single cell data is collected and analysed. Publicly available experimental data is obtained. Simulated data is generated using R package <italic>PowSimR</italic>. <bold>b</bold> This corresponds to step 1 and 2 of the 4-step procedure. Resampled data is generated using stratified bootstrap and then clustered using clustering algorithm. Each cluster is matched to cell-type using reference cell labels in the original dataset. This step is repeated <italic>n</italic> times. <bold>c</bold> In step 3 and 4, cell count output from each bootstrap is fitted using GLM. The coefficient estimates from each individual GLM model are pooled using Rubin’s rules and tested for significance. <bold>d</bold> User can extract the overall estimates of statistics. <bold>e</bold> Each bootstrap re-sampling gives an estimated distribution of cell-types composition for each patient. <bold>f</bold> the result can be visualised graphically</p></caption><graphic xlink:href="12859_2019_3211_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>The next step involved cell-type identification of each bootstrap sample using clustering. Here, we performed PCA dimension reduction followed by k-means clustering (using Pearson correlation as distance metric [<xref ref-type="bibr" rid="CR7">7</xref>]). For each bootstrap sample, this generated cell-type proportions <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p^{*}_{b1},\ldots p^{*}_{bC}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq3.gif"/></alternatives></inline-formula> which we later used to calculate bootstrap standard errors (SE) for each of the cell-type proportions <italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub><italic>C</italic></sub>. In parallel, for experiments with two conditions A and B, to assess changes in cell-type compositions between conditions, we modelled the data using a log-linear model accounting for cell-types, conditions, subjects and interaction effects between cell-types and conditions. A log-linear model was fitted to each bootstrap sample <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{b}$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq4.gif"/></alternatives></inline-formula> and the results were pooled using Rubin’s pooled estimate (see “<xref rid="Sec11" ref-type="sec">Methods</xref>” section) [<xref ref-type="bibr" rid="CR14">14</xref>]. This log-linear model can also be fitted as a mixed effect model by giving each subject a random effect and both options are available in our scDC framework.</p>
    </sec>
    <sec id="Sec4">
      <title>Stratified bootstrap procedure provides good estimation of sampling error for cell-type proportions</title>
      <p>First, we examined the validity of our stratified bootstrap procedure using simulation data (Table <xref rid="Tab1" ref-type="table">1</xref>). In Fig.<xref rid="Fig2" ref-type="fig">2</xref>a each point represents the sampling standard error and the bootstrap standard error associated with a particular subject. The figure clearly shows a high concordance between bootstrap standard error and sampling standard error. Therefore, bootstrap resampling should provide a reasonable estimate of uncertainty for cell-type proportion.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Stratified bootstrap provides good estimate of standard error. <bold>a</bold> Using four simulated datasets, stratified bootstrap was performed to estimate cell-type proportions in each bootstrap. Each dot on the figure represents a pair of value containing the mean standard error of bootstrap (x-axis) and standard error from sampling (y-axis). <bold>b</bold> Each horizontal bar shows confidence interval associated with proportion estimate</p></caption><graphic xlink:href="12859_2019_3211_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Simulation cases with one condition</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Datasets</th><th align="left"><italic>C</italic></th><th align="left">Number of replicates (<italic>R</italic>)</th><th align="left"><italic>p</italic><sub>1</sub></th><th align="left"><italic>p</italic><sub>2</sub></th><th align="left"><italic>p</italic><sub>3</sub></th><th align="left"><italic>p</italic><sub>4</sub></th></tr></thead><tbody><tr><td align="left">Sim1</td><td align="left">500</td><td align="left">10</td><td align="left">0.1</td><td align="left">0.2</td><td align="left">0.3</td><td align="left">0.4</td></tr><tr><td align="left">Sim2</td><td align="left">100</td><td align="left">50</td><td align="left">0.1</td><td align="left">0.2</td><td align="left">0.3</td><td align="left">0.4</td></tr><tr><td align="left">Sim3</td><td align="left">50</td><td align="left">100</td><td align="left">0.1</td><td align="left">0.2</td><td align="left">0.3</td><td align="left">0.4</td></tr><tr><td align="left">Sim4</td><td align="left">100</td><td align="left">50</td><td align="left">0.05</td><td align="left">0.25</td><td align="left">0.3</td><td align="left">0.4</td></tr></tbody></table><table-wrap-foot><p>Four simulation datasets were made, each dataset containing 5000 cells. <italic>C</italic> represents the number of cells from one replicate. <italic>p</italic><sub>1</sub>,<italic>p</italic><sub>2</sub>,<italic>p</italic><sub>3</sub>,<italic>p</italic><sub>4</sub> corresponds to the proportion of the four cell-types <italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>1</sub>, <italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>2</sub>, <italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>3</sub> and <italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>4</sub> respectively</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec5">
      <title>Bias-corrected and accelerated (BCa) bootstrap confidence interval for single subject cell-type proportions</title>
      <p>We examined the effectiveness of various approaches to estimate confidence intervals (CI) associated with cell-type proportions at the single subject level. Cell-type proportions from a single cell experiment can be modeled using a multinomial distribution with <italic>C</italic> proportion parameters <italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub><italic>C</italic></sub>. The simple standard error (SE) measure, commonly used to illustrate error bars, assumes symmetric CIs and therefore is not an appropriate representation of the CI of cell-type proportions. The SE estimate is especially problematic for rare cell-types, as it can generate CI estimates with endpoints that extend outside [0,1]. Existing approaches to estimate CIs for multinomial proportions require large expected cell counts [<xref ref-type="bibr" rid="CR15">15</xref>]. For rare cell-types, cell counts may not be adequate to ensure the appropriate overall coverage probability.</p>
      <p>To address this issue, we considered three methods to estimate CI of cell-type proportions: (1) the model-based approach of May and Johnson (2000) [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], which constructs simultaneous CIs for multinomial proportions; (2) the bootstrap percentile method, and (3) the bootstrap BCa method [<xref ref-type="bibr" rid="CR18">18</xref>]. Figure <xref rid="Fig2" ref-type="fig">2</xref>b shows CI estimates using these three methods on four sets of simulated data. Comparing simulation data Sim1 with 500 cells per replicate, Sim2 with 100 cells per replicate and Sim3 with 50 cells per replicate, it is clear that the width of all three types of confidence intervals increases with decreasing number of cells. The width of BCa CI is similar to multinomial and percentile in all cases, but is significantly shorter when there was presence of rare cell-types and small number of cells per replicate, as shown by the cell-type n4. This suggests that BCa provides better estimates for rare cell-types.</p>
    </sec>
    <sec id="Sec6">
      <title>scDC correctly estimates the cell-type proportions and corresponding standard error in simulation data</title>
      <p>Using a series of simulation data, we evaluated whether scDC can accurately recover true cell-type proportions and the corresponding standard errors within each condition and subject. For simulated data SimP1 and SimP2, we simulated the situation where biological replicates are available; for simulated data SimP3 and SimP4, we also modelled the subject to subject variability as random effects. The detailed simulation settings are listed in Table <xref rid="Tab2" ref-type="table">2</xref> and described in detail in “<xref rid="Sec11" ref-type="sec">Methods</xref>” section. Figure <xref rid="Fig3" ref-type="fig">3</xref>a shows that in all four simulations, scDC correctly recovers the true cell-type proportions; Fig. <xref rid="Fig3" ref-type="fig">3</xref>b shows the corresponding bootstrap confidence intervals calculated using the BCa method. Visually, the confidence intervals overlap between conditions where cell-type proportions differ by 10%. When we used GLMs to test for significance, we found that there is significant interaction effect for cell-type 2 in simulation data SimP1 (<italic>p</italic>=0.01; Table <xref rid="Tab3" ref-type="table">3</xref>) but not for cell-types 3 and 4. This shows concordance with the true underlying model.
<fig id="Fig3"><label>Fig. 3</label><caption><p>scDC on simulated dataset. scDC has been applied to four simulated datasets. <bold>a</bold> Each dot represents a pair of values containing the mean proportion estimate calculated from scDC (x-axis) and the true proportion from the simulation data (y-axis). Across all four datasets, all dots lie on the diagonal line, even when the proportion of a cell-type is as low as 5%. This demonstrates that scDC is highly accurate in estimating cell-type composition. <bold>b</bold> Each simulated dataset contains two conditions, represented suing colours red and blue. The bar chart shows proportion estimates of each cell-type <italic>n</italic>1 to <italic>n</italic>4 for each subject in the dataset. The horizontal black line represents the BCa confidence interval associated with the proportion estimate</p></caption><graphic xlink:href="12859_2019_3211_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Simulation cases with two conditions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="4">Condition 1</th><th align="left" colspan="4">Condition 2</th></tr><tr><th align="left">Datasets</th><th align="left"><italic>p</italic><sub>11</sub></th><th align="left"><italic>p</italic><sub>21</sub></th><th align="left"><italic>p</italic><sub>31</sub></th><th align="left"><italic>p</italic><sub>41</sub></th><th align="left"><italic>p</italic><sub>12</sub></th><th align="left"><italic>p</italic><sub>22</sub></th><th align="left"><italic>p</italic><sub>32</sub></th><th align="left"><italic>p</italic><sub>42</sub></th></tr></thead><tbody><tr><td align="left">SimP1</td><td align="left">0.4</td><td align="left">0.4</td><td align="left">0.2</td><td align="left">0.2</td><td align="left">0.3</td><td align="left">0.5</td><td align="left">0.2</td><td align="left">0.2</td></tr><tr><td align="left">SimP2</td><td align="left">0.7</td><td align="left">0.1</td><td align="left">0.1</td><td align="left">0.1</td><td align="left">0.6</td><td align="left">0.2</td><td align="left">0.1</td><td align="left">0.1</td></tr><tr><td align="left">SimP3</td><td align="left">0.4</td><td align="left">0.4</td><td align="left">0.2</td><td align="left">0.2</td><td align="left">0.3</td><td align="left">0.5</td><td align="left">0.2</td><td align="left">0.2</td></tr><tr><td align="left">SimP4</td><td align="left">0.7</td><td align="left">0.1</td><td align="left">0.1</td><td align="left">0.1</td><td align="left">0.6</td><td align="left">0.2</td><td align="left">0.1</td><td align="left">0.1</td></tr></tbody></table><table-wrap-foot><p>Four simulation datasets are made, each contains 6000 cells. <italic>p</italic><sub><italic>ij</italic></sub> corresponds to the proportion of cell-type in cell-type <italic>i</italic> and condition <italic>j</italic></p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Summary of pooled estimates from fitting GLMM to bootstrap samples from simulation data <italic>SimP1</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="4">Mixed effect model - Simulation data SimP1</th><th align="left"/></tr><tr><th align="left"/><th align="left">Estimate</th><th align="left">std.error</th><th align="left">Statistic</th><th align="left">df</th><th align="left"><italic>p</italic>.value</th></tr></thead><tbody><tr><td align="left">(Intercept)</td><td align="left">4.32</td><td align="left">1.24</td><td align="left">3.49</td><td align="left">6.11</td><td align="left">0.01</td></tr><tr><td align="left"><italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>2</sub></td><td align="left">-0.17</td><td align="left">0.14</td><td align="left">-1.22</td><td align="left">5.86</td><td align="left">0.26</td></tr><tr><td align="left"><italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>3</sub></td><td align="left">-1.50</td><td align="left">0.23</td><td align="left">-6.64</td><td align="left">5.52</td><td align="left">0.00</td></tr><tr><td align="left"><italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>4</sub></td><td align="left">-1.35</td><td align="left">0.19</td><td align="left">-7.04</td><td align="left">6.79</td><td align="left">0.00</td></tr><tr><td align="left">Condition2</td><td align="left">-0.02</td><td align="left">1.81</td><td align="left">-0.01</td><td align="left">5.59</td><td align="left">0.99</td></tr><tr><td align="left"><italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>2</sub>:Condition2</td><td align="left">0.68</td><td align="left">0.19</td><td align="left">3.53</td><td align="left">6.20</td><td align="left">0.01</td></tr><tr><td align="left"><italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>3</sub>:Condition2</td><td align="left">0.41</td><td align="left">0.32</td><td align="left">1.29</td><td align="left">5.55</td><td align="left">0.23</td></tr><tr><td align="left"><italic>C</italic><italic>e</italic><italic>l</italic><italic>l</italic><sub>4</sub>:Condition2</td><td align="left">0.25</td><td align="left">0.26</td><td align="left">0.95</td><td align="left">7.97</td><td align="left">0.37</td></tr></tbody></table></table-wrap>
</p>
      <p>We also examined scDC’s performance on estimating cell-types proportions in datasets where there are highly correlated cell-types and rare cell-types, as these situations are often observed in real experimental datasets. Using eight simulated datasets SimS1 to SimS8, we demonstrated that scDC is highly accurate in recovering rare cell-types proportion as low as 1% and is only slightly affected when there is high degree of correlation between two cell-types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). The detailed simulation settings are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2)</p>
      <p>Lastly, we simulated a dataset composed of 4000 cells and 10 cell-types with 3 rare cell-types, replicating the size and the complexity of real experimental dataset. scDC result shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 clearly revealed that scDC accurately recovered true cell-types proportion. In addition, we observed that BCa produced the tightest CI interval around the density distribution of proportion estimates for the three rare cell-types, n1, n2 and n3. In contrast, both percentile and multinomial CI produced much wider CI in some cases. For the other seven cell-types, the three CI estimates were similar. This is consistent with our findings in the previous subsection.</p>
    </sec>
    <sec id="Sec7">
      <title>Impact of specifying incorrect number of cell-types</title>
      <p>In practice, the true number of cell-types are often unknown. To investigate the impact on scDC result when the number of cell-types is incorrectly determined, we simulated a dataset containing 500 cells and 4 cell-types and evaluated scDC with the number of cell-types specified as 2, 3, 4 and 5. Figure <xref rid="Fig4" ref-type="fig">4</xref> clearly shows that in all cases when the input number of cell-types is incorrect, the resulting confidence intervals are very wide. Some of the confidence intervals appeared to be out of place compared to the density distribution. Only when scDC was ran with number of cell-types being 4 did the confidence intervals form reasonably CI estimate as seen from close bands surrounding the density distributions.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Impact of incorrectly specified numbers of cell-types. We simulated a dataset containing 4 cell-types and ran scDC with number of cell-types specified to be 2, 3, 4 and 5. <bold>a</bold> shows the width of the three types of confidence intervals. <bold>b</bold> shows the density distribution of proportion estimates</p></caption><graphic xlink:href="12859_2019_3211_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
    <sec id="Sec8">
      <title>Application of scDC reveals differential cell-type proportions in two synthetic datasets</title>
      <p>To demonstrate the applicability of our method on data containing realistic variability from single cell experiments, we examined two synthetic datasets constructed from two sets of real experimental data — Pancreas [<xref ref-type="bibr" rid="CR1">1</xref>] and Neuronal [<xref ref-type="bibr" rid="CR3">3</xref>] (see “<xref rid="Sec11" ref-type="sec">Methods</xref>” section).</p>
      <p>In the Pancreas dataset that examines subjects with type two diabetes (T2D) and healthy subjects, we observed subject to subject variation. Despite the overall proportion of beta cells being lower with subjects with T2D compared with healthy controls, our analysis confirms the original finding that 1 of the 4 subjects has a higher beta cell value. The boxplot for this patient has a small interquartile range, suggesting that there is high confidence that the high value observed with this subject is not due to an error or random chance, for example, in the clustering procedure. The overall boxplot (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d-f) summarising the average cell proportion across subjects further shows that the interquartile range of the beta cell proportion of normal subjects is not overlapping with the interquartile range of the beta cell proportion of T2D subjects. This confirms that, despite one of the T2D subjects being an outlier, the overall beta cell proportion of T2D subjects is lower than for normal subjects. Inspecting output from random effect and fixed effect model revealed a difference in subject variability and the pooled fixed effect model also suggests the beta cell-type and subject interaction effect is significant (<italic>p</italic>=0.02). This again highlights that in the beta cell, there is a lower proportion in T2D compared to healthy and such difference in proportion isn’t in the alpha cell-type. The details of the GLM and GLMM results are presented in Table <xref rid="Tab4" ref-type="table">4</xref>.
<fig id="Fig5"><label>Fig. 5</label><caption><p>scDC on synthetic dataset. scDC has been applied on two different synthetic datasets, <bold>a-c</bold> shows result on neuronal dataset and <bold>d-f</bold> shows result on pancreas dataset. <bold>a</bold> Subjects are samples taken at different developmental time point. Each time point has two or three samples, as indicated by the labels on the x-axis. Boxplot represents 100 cell proportion values obtained from performing scDC. The diamond symbol in each boxplot represents the reference cell proportion value calculated from the original dataset. <bold>b</bold> Each boxplot is drawn by taking the mean of subjects at each time point. Thus wider boxplot indicates greater subject to subject variability. <bold>c</bold> This plots the mean cell composition of each subject from the 100 cell proportion values obtained from scDC and compares across the developmental time point. A trend in proportional change of the four cell-types is visible. <bold>d</bold> Subjects are samples taken from normal subjects and type 2 diabetes subjects. <bold>e</bold> Averaging across subjects for each cell-type reveals a clear difference in beta cell proportions between normal and type two diabetes subjects. <bold>f</bold> Compared to mouse data (<bold>c</bold>), human data exhibit much greater between subject variability</p></caption><graphic xlink:href="12859_2019_3211_Fig5_HTML" id="MO5"/></fig><table-wrap id="Tab4"><label>Table 4</label><caption><p>Summary of pooled estimates from fitting GLM and GLMM to bootstrap samples from Pancreas dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="4">Fixed effect model - Pancreas</th><th align="left"/></tr></thead><tbody><tr><td align="left"/><td align="left">Estimate</td><td align="left">std.error</td><td align="left">Statistic</td><td align="left">df</td><td align="left"><italic>p</italic>.value</td></tr><tr><td align="left">(Intercept)</td><td align="left">4.68</td><td align="left">0.09</td><td align="left">52.09</td><td align="left">9.84</td><td align="left">0.00</td></tr><tr><td align="left">Beta</td><td align="left">-0.94</td><td align="left">0.16</td><td align="left">-5.87</td><td align="left">4.10</td><td align="left">0.00</td></tr><tr><td align="left">Ductal</td><td align="left">-1.14</td><td align="left">0.14</td><td align="left">-7.91</td><td align="left">5.87</td><td align="left">0.00</td></tr><tr><td align="left">T2D</td><td align="left">0.06</td><td align="left">0.12</td><td align="left">0.51</td><td align="left">10.22</td><td align="left">0.62</td></tr><tr><td align="left">patientHP1504101_T2D</td><td align="left">-0.28</td><td align="left">0.14</td><td align="left">-2.05</td><td align="left">7.41</td><td align="left">0.06</td></tr><tr><td align="left">patientHP1504901</td><td align="left">-0.27</td><td align="left">0.11</td><td align="left">-2.38</td><td align="left">12.35</td><td align="left">0.03</td></tr><tr><td align="left">patientHP1506401</td><td align="left">-0.39</td><td align="left">0.12</td><td align="left">-3.34</td><td align="left">12.35</td><td align="left">0.01</td></tr><tr><td align="left">patientHP1507101</td><td align="left">-0.03</td><td align="left">0.11</td><td align="left">-0.32</td><td align="left">12.35</td><td align="left">0.76</td></tr><tr><td align="left">patientHP1508501_T2D</td><td align="left">0.01</td><td align="left">0.10</td><td align="left">0.10</td><td align="left">12.35</td><td align="left">0.92</td></tr><tr><td align="left">patientHP1509101</td><td align="left">-0.87</td><td align="left">0.14</td><td align="left">-6.42</td><td align="left">12.35</td><td align="left">0.00</td></tr><tr><td align="left">patientHP1525301_T2D</td><td align="left">0.07</td><td align="left">0.10</td><td align="left">0.77</td><td align="left">12.35</td><td align="left">0.45</td></tr><tr><td align="left">beta:T2D</td><td align="left">-0.52</td><td align="left">0.22</td><td align="left">-2.40</td><td align="left">5.41</td><td align="left">0.03</td></tr><tr><td align="left">ductal:T2D</td><td align="left">0.59</td><td align="left">0.19</td><td align="left">3.12</td><td align="left">5.54</td><td align="left">0.01</td></tr><tr><td align="left"/><td align="left" colspan="4">Mixed effect model - Pancreas</td><td align="left"/></tr><tr><td align="left"/><td align="left">Estimate</td><td align="left">std.error</td><td align="left">Statistic</td><td align="left">df</td><td align="left"><italic>p</italic>.value</td></tr><tr><td align="left">(Intercept)</td><td align="left">4.37</td><td align="left">0.12</td><td align="left">36.20</td><td align="left">16.21</td><td align="left">0.00</td></tr><tr><td align="left">Beta</td><td align="left">-0.94</td><td align="left">0.16</td><td align="left">-5.87</td><td align="left">5.99</td><td align="left">0.00</td></tr><tr><td align="left">Ductal</td><td align="left">-1.14</td><td align="left">0.14</td><td align="left">-7.91</td><td align="left">8.59</td><td align="left">0.00</td></tr><tr><td align="left">T2D</td><td align="left">0.31</td><td align="left">0.17</td><td align="left">1.80</td><td align="left">16.90</td><td align="left">0.09</td></tr><tr><td align="left">beta:T2D</td><td align="left">-0.52</td><td align="left">0.22</td><td align="left">-2.40</td><td align="left">7.92</td><td align="left">0.03</td></tr><tr><td align="left">ductal:T2D</td><td align="left">0.59</td><td align="left">0.19</td><td align="left">3.12</td><td align="left">8.14</td><td align="left">0.01</td></tr></tbody></table><table-wrap-foot><p>Beta, ductal are the cell-type effect. T2D is abbreviation of type two diabetes effect. Subject ID followed by underscore of T2D represents type two diabetes subject. Subject ID without underscore of T2D represents normal subject</p></table-wrap-foot></table-wrap>
</p>
      <p>The Neuronal dataset contains samples from inbred mice at different developmental time points. With the neuronal dataset, we examined the mesoderm, neural crest, neural crest neurons, and progenitor cell-types. Here, the subject to subject variability are substantially smaller (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a-c). Application of scDC reveals a clear trend in the relative proportion of these four cell-types. In particular, there is a clear increase in the relative proportion of progenitor, neural crest and neural crest neurons, and a decrease in the relative proportion of mesoderm. The GLM and GLMM analysis show a significant interaction effect between cell-types and time points (<italic>p</italic>&lt;0.001). The details of the GLM and GLMM results are presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. The original paper examined the change in progenitor compared to neurons and stated that the percentage of progenitor increased as the percentage of neurons decreased. Our findings suggest that, by excluding neurons from analysis, there is a visible increase in the percentage of progenitor cells over time. This finding is worth further investigation, as progenitor cells is a key player in neurogenesis which gives rise to neuronal cells.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p>We present a novel statistical framework, scDC, to assess cell-type composition differences between conditions of interest. This involves developing approaches to estimate standard error of cell-type proportions estimates in scRNA-seq data via bootstrapping and adapting a missing values framework to facilitate Wald testing from bootstrap log-linear model and generalized linear mixed model analyses. By applying scDC to simulated data, we demonstrate that our method can accurately recover the correct confidence interval of cell-type proportions in an unbiased manner. Furthermore, we show in two synthetic datasets that cell-type composition differences can be accurately determined following the scDC procedure.</p>
    <p>All confidence interval estimation procedures discussed in this paper can be extended to directly calculate the confidence interval associated with the difference in <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> cell-type proportions. This provides an alternative approach to the CI constructed based on <italic>S</italic><italic>E</italic><sub><italic>pooled</italic></sub> that will be symmetric by default. These various CI estimation procedures generate different CIs with different coverage probabilities and interval lengths. The ability to calculate the correct coverage probability with the smallest interval length is an important component of power calculations as it leads to a reduction of sample size needed to achieve detection of differences between two cell-types.</p>
    <p>Comparisons between the two datasets confirm the widely accepted phenomena that human data contain much higher subject to subject variability than mouse data. The lower mouse to mouse variability could be due to two factors. First, cell-types in mouse are easier to distinguish, resulting in greater stability in clustering process. Second, inbred mice might exhibit much less variability than humans. Our scDC method provides and encourages the visualization of SE associated with cell-type proportions estimates at different level. For example, in the Pancreas dataset, despite there being only one T2D subject with a higher beta cell proportion, there is still a significant interaction effect between T2D and beta cell proportions when taking account of all subject. This opens up a potential problem of hierarchical compositional analysis where one identifies the proportion of population within T2D that demonstrates a higher beta-cell proportion versus the proportion of population within T2D that has a lower beta-cell proportion, and what sample size of subject is required to achieve this.</p>
    <p>As with all bootstrap approximations, we are limited by the initial sampling procedure. This is more complicated in data with samples from different human subjects, where the cell-type proportions in each sample vary greatly. In addition, comparing Sim1 and Sim3 from Fig.<xref rid="Fig2" ref-type="fig">2</xref>b, it is clear that the width of the confidence interval increases greatly as the number of cells in dataset decrease. Similar situation is likely to be observed in experimental datasets, where the number of cells obtained from each sample may differ, particularly after quality control. scDC utilizes stratified bootstrap sampling, stratifying based on each subject. Without stratified bootstrap sampling, we will over-estimate the SE - this is a natural consequence of large subject to subject variability. It is not appropriate to assume that all subjects share the same cell-type proportions and be from the same multinomial distribution. In the stratified bootstrap, we assume that each subject has a different cell-type proportion and draws from a different multinomial distribution.</p>
    <p>Finally, we implemented scDC as part of the package <italic>scdney</italic> for use by the scientific community. This package performs stratified bootstrap, builds GLM models and provides visualizations of the bootstrap results.</p>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In this paper, we present scDC, a novel statistical framework for performing differential composition analysis in scRNA-seq experiments. scDC utilizes bootstrap resampling to estimate the standard errors in cell-type proportions, and enables significance testing from bootstrap GLM and GLMM analysis. We applied scDC to both simulation and synthetic data sets and showed that it can accurately recover true cell-type proportions and estimate the variance in cell-type proportions. By pooling estimates from GLM analyses in each bootstrap resample, we also showed that we can perform significance testing of composition differences across subjects and conditions. scDC is implemented as an R package and can be freely downloaded from our GitHub repository. Our implementation supports direct input from sc-RNA expression matrix.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Simulated data generation</title>
      <p>The R package <italic>powsimR</italic> was used to simulate the single-cell RNA-seq data [<xref ref-type="bibr" rid="CR19">19</xref>]. We selected 10% of genes to be differentially expressed between two cell-types, with fold changes sampled from a multivariate normal distribution. Gene specific distributional parameters are estimated by a dataset from mouse embryonic stem cells [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p><italic>Simulation with one condition</italic>To validate the bootstrapping estimation, we simulated a population of 5000 cells consisting of 4 cells types. Four different simulations were set up, with three simulations consisting of 4 cell-types with proportion of 10%, 20%, 30% and 40% (Simulated data Sim1, Sim2, Sim3), and one simulation with proportion 5%, 25%, 30% and 40% (Simulated data Sim4). Simulated data Sim1 has 10 replicates, with 500 cells in each replicates. Four replicates were randomly chosen and bootstrapped. Simulated data Sim2 has 50 replicates in total, with 100 cells in each replicate. Five replicates were randomly chosen and bootstrapped. Simulated data Sim3 has 100 replicates in total, with 50 cells in each replicate. 20 replicates were chosen and bootstrapped. Simulated data Sim4 has 50 replicates in total, with 100 cells in each replicate. We chose 20 replicates to be bootstrapped (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p><italic>Simulation with two condition</italic>To validate our scDC procedure in-silico, we simulated a population of 6000 cells of four cell-types, with two conditions with different cell-type proportions. Each condition is divided into three subsets, which can be considered as the subpopulation of three subjects. Then we randomly sampled 200 cells from each subpopulation to create a simulated dataset with 1200 cells. Simulated data SimP1 and SimP2 represents the situation when the biological replicates are available. Here we sample from the same multinomial distribution with true cell-type proportions given in Table <xref rid="Tab2" ref-type="table">2</xref>. Simulated data SimP3 and SimP4 represents the situation where the variability between subjects follows a <italic>N</italic>(0,<italic>σ</italic><sup>2</sup>) distribution, where <italic>σ</italic>=0.02. The detailed cell-type composition settings of each simulation are listed in Table <xref rid="Tab2" ref-type="table">2</xref>.</p>
      <p><italic>Simulation with rare cell-types and correlated cell-types</italic>We simulated four datasets that have different degree of correlation between cell-types and four datasets that have rare cell-types of different proportions. For each dataset, we first simulated a population of 2400 cells, then we randomly sampled 1200 cells to create the final dataset. Each dataset is made up of two conditions with different cell-type proportions and three replicates in each condition. Variability between subjects are introduced by modelling a <italic>N</italic>(0,<italic>σ</italic><sup>2</sup>) distribution, where <italic>σ</italic>=0.02. The detailed cell-type composition settings of each simulation are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
      <p><italic>Simulation of complex dataset</italic>To test scDC on a dataset with complexity similar to the characteristics of experimental dataset, we simulated one dataset with 8000 cells and 10 cell-types and randomly selected 4000 cells to create the final dataset. The 10 cell-types contains 3 rare cell-types with proportion as low as 1%. This dataset is composed of 2 conditions and 4 replicate subjects in each condition. Variability between subjects are introduced by modelling a <italic>N</italic>(0,<italic>σ</italic><sup>2</sup>) distribution, where <italic>σ</italic>=0.02. Detailed cell-type composition settings for this simulation are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2.</p>
    </sec>
    <sec id="Sec13">
      <title>Synthetic data</title>
      <p>We generated two synthetic datasets from two publicly available datasets [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. All data were first normalized by TPM (transcripts per million) and log-transformed. Any samples with a total of less than 50 cells of interest or with less than 10 cells of any cell-types of interest were excluded.</p>
      <p><italic>Synthetic Pancreas Dataset</italic>The Pancreas dataset contains 2,209 single cells taken from the pancreas of six healthy and four type 2 diabetic human cadaveric donors (E-MTAB-5061) [<xref ref-type="bibr" rid="CR1">1</xref>]. Alpha, beta and ductal cells were selected to create the synthetic dataset. Cell labels were provided for all cells by the authors.</p>
      <p><italic>Synthetic Neuronal Dataset</italic>The Neuronal dataset contains 21,465 single cells taken from neural tubes of mouse embryo at five developmental time points from e9.5 to e13.5 [<xref ref-type="bibr" rid="CR3">3</xref>]. Raw data is made available by the author on their GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/juliendelile/MouseSpinalCordAtlas">https://github.com/juliendelile/MouseSpinalCordAtlas</ext-link>. The cell-types mesoderm, neural crest, neural crest neurons and progenitor were selected to create the synthetic dataset. Cell-type labels were provided by the original authors through assessing the expression of a list of curated genes.</p>
    </sec>
    <sec id="Sec14">
      <title>Bootstrap confidence intervals</title>
      <p>Let <italic>n</italic><sub><italic>ij</italic></sub> be the number of cells of cell-type <italic>i</italic> and subject <italic>j</italic>, <italic>i</italic>=1,…,<italic>C</italic>,<italic>j</italic>=1,…,<italic>R</italic>; <italic>N</italic><sub><italic>j</italic></sub> be the number of cells within the subject <italic>j</italic>; and <italic>N</italic> be the total number of cells in the dataset. For a typical subject <italic>j</italic>, the <italic>i</italic>th cell-type proportion is defined as <italic>p</italic><sub><italic>ij</italic></sub> and calculated by
<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$p_{ij} = \frac{n_{ij}}{\sum_{i} n_{ij}} = \frac{n_{ij}}{N_{j}}.$$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p><italic>The percentile method</italic>This is an intuitive method for estimating the bootstrap confidence interval by first estimating the empirical distribution of <italic>p</italic><sub><italic>ij</italic></sub>. Let <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij(\alpha)}^{*}$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq5.gif"/></alternatives></inline-formula> represent the 100<italic>α</italic>-th percentile of <italic>B</italic> bootstrap replications, <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij(1)}^{*}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij(2)}^{*},\ldots,\hat {p}_{ij(B)}^{*}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq7.gif"/></alternatives></inline-formula>, with
<disp-formula id="Equb"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat{p}_{ij(1)}^{*} \leq \hat{p}_{ij(2)}^{*}\leq \hat{p}_{ij(3)}^{*} \leq... \leq \hat{p}_{ij(B)}^{*},$$ \end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mn>3</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>...</mml:mi><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>B</italic>=10000 by default. Then the percentile interval of 100(1−<italic>α</italic>)<italic>%</italic> for <italic>p</italic><sub><italic>ij</italic></sub> is estimated by
<disp-formula id="Equc"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\left[\hat{p}_{ij(B\alpha/2)}^{*}, \hat{p}_{ij(B(1-\alpha/2))}^{*}\right].$$ \end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>Bα</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p><italic>The BCa method</italic>To account for skewness in the confidence interval, we used the Bias-corrected and accelerated (BCa) confidence intervals proposed by Efron (1987) [<xref ref-type="bibr" rid="CR21">21</xref>]. The BCa method uses percentiles of bootstrap distribution described above, but depends on an acceleration parameter <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {a}$\end{document}</tex-math><mml:math id="M22"><mml:mi>â</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq8.gif"/></alternatives></inline-formula> and a bias-correction factor <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {z}_{0}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq9.gif"/></alternatives></inline-formula>. The 100(1−<italic>α</italic>)<italic>%</italic> BCa interval of <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}^{*}_{ij}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq10.gif"/></alternatives></inline-formula> can be calculated by
<disp-formula id="Equd"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\left[\hat{p}_{ij(\alpha_{1})}^{*}, \hat{p}_{ij(\alpha_{2})}^{*}\right],$$ \end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where
<disp-formula id="Eque"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\alpha_{1} = \Phi\left(\hat{z}_{0} + \frac{\hat{z}_{0} + z_{(\alpha)}}{1-\hat{a}(\hat{z}_{0} + z_{(\alpha)})} \right);$$ \end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>â</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>;</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\alpha_{2} = \Phi\left(\hat{z}_{0} + \frac{\hat{z}_{0} + z_{(1-\alpha)}}{1-\hat{a}(\hat{z}_{0} + z_{(1-\alpha)})} \right).$$ \end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>â</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> Here <italic>Φ</italic>(·) is the cumulative distribution function of standard normal distribution, and <italic>z</italic><sub>(<italic>α</italic>)</sub> indicates the 100<italic>α</italic>-th percentile point of a standard normal distribution.</p>
      <p>This method estimates two adjustment factors. First, the bias-correction factor which estimates the proportion of the bootstrap replication less than the original estimate. This is calculated by
<disp-formula id="Equg"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat{z}_{0} = \Phi^{-1}(\#\{\hat{p}_{ij(b)}^{*}&lt;\hat{p}_{ij}\}/B),$$ \end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Φ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>#</mml:mi><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>/</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> where <italic>Φ</italic><sup>−1</sup> is the inverse cumulative distribution function of standard normal and <inline-formula id="IEq11"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij}$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq11.gif"/></alternatives></inline-formula> is the original estimate of proportion, derived from Step 2 of clustering in the scDC procedure.</p>
      <p>The second is the acceleration factor which quantifies the rate of change of the standard error of <inline-formula id="IEq12"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij}$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq12.gif"/></alternatives></inline-formula> with respect to the original estimate <italic>p</italic><sub><italic>ij</italic></sub>. This is calculated using a jackknife approach as follows,
<disp-formula id="Equh"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat{a} = \frac{\sum_{n=1}^{N} (\hat{p}_{ij(\cdot)}-\hat{p}_{ij(n)})^{3}}{6\left\{\sum_{n=1}^{N} (\hat{p}_{ij(\cdot)}-\hat{p}_{ij(n)})^{2}\right\}^{3/2}},$$ \end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>â</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:msup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq13"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij(n)}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq13.gif"/></alternatives></inline-formula> is the estimate of <italic>p</italic><sub><italic>ij</italic></sub> holding out cell <italic>n</italic> in the data, and <inline-formula id="IEq14"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{ij(\cdot)} = \frac {1}{N}\sum _{n=1}^{N} \hat {p}_{ij(n)}$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq14.gif"/></alternatives></inline-formula>. We modifies the implementation of function <italic>bcanon</italic> in <italic>bootstrap</italic> package to estimate BCa intervals for cell-type proportions of each subject [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
      <p>Note that, for data with only one subject, we can still estimate the CIs with <italic>j</italic>=1.</p>
    </sec>
    <sec id="Sec15">
      <title>Single cell differential composition analysis (scDC)</title>
      <p>scDC is a 4-step procedure that tests for differences in cell-type composition between conditions.</p>
      <p><italic>Step 1: Stratified bootstrap</italic>This is used to generate <italic>B</italic> bootstrap samples by sampling with replacement and stratified by subjects. We denote each bootstrap sample data of subject <italic>j</italic> as <inline-formula id="IEq15"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{bj}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq15.gif"/></alternatives></inline-formula>. All genes with zero variance in each of the <italic>B</italic> bootstrap sample <inline-formula id="IEq16"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{bj}$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq16.gif"/></alternatives></inline-formula> are removed as they are not informative for cell-type determination.</p>
      <p><italic>Step 2: Cell-type identification</italic>We estimate the cell-type identity of each cell by clustering each bootstrap resample <inline-formula id="IEq17"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{bj}$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq17.gif"/></alternatives></inline-formula> and estimate the bootstrap cell-type proportions <inline-formula id="IEq18"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}^{*}_{b1}, \hat {p}^{*}_{b2}, \ldots, \hat {p}^{*}_{bC}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq18.gif"/></alternatives></inline-formula> for all <italic>C</italic> cell-types via clustering The clustering first performed dimension reduction using PCA (R package <italic>stats</italic> [<xref ref-type="bibr" rid="CR23">23</xref>]) to the first 10 principal component, follow by k-means clustering with Pearson correlation as the similarity measure using function <italic>scClust</italic> in R package <italic>scdney</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]. The number of clusters, <italic>K</italic>, was initially set to be the number of cell-types <italic>C</italic> in the data. Cluster identity was assigned based on the majority cell-types in a cluster.</p>
      <p>In cases where the clustering result do not recover all the cell-types, clustering was re-run with the number of clusters <italic>K</italic> increased by one. We repeated the clustering procedure until each cell-type has been assigned to at least one cluster. We then recorded the number of cells in each cell-type labelled cluster that belongs to each subject or replicate <italic>j</italic>.</p>
      <p><italic>Step 3: Pooled estimates from B complete linear model</italic><italic>analyses.</italic>For each bootstrap resample <inline-formula id="IEq19"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y^{*}_{bj}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq19.gif"/></alternatives></inline-formula>, a Generalized Linear Model was fitted to assess the significance associated with each predictor variable. The R package <italic>lme4</italic> was used to fit the model [<xref ref-type="bibr" rid="CR24">24</xref>]. Two types of models were considered — the fixed effect model (GLM) and the mixed effect model (GLMM) by treating the subject as a random effect. For the fixed effect model (GLM) the following R code</p>
      <p><graphic position="anchor" xlink:href="12859_2019_3211_Figa_HTML" id="MO6"/> was used.</p>
      <p>For the mixed effect model (GLMM), the following R code</p>
      <p><graphic position="anchor" xlink:href="12859_2019_3211_Figb_HTML" id="MO7"/> was used.</p>
      <p>This generated <italic>B</italic> bootstrap coefficient estimates <inline-formula id="IEq20"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\beta }}^{*}_{1}, \hat {\boldsymbol {\beta }}^{*}_{2}, \ldots \hat {\boldsymbol {\beta }}^{*}_{B}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq20.gif"/></alternatives></inline-formula> from the GLM or GLMM model. <italic>B</italic>=100 by default if user does not require any confidence interval to be estimated, otherwise <italic>B</italic>=10000 by default. The pooled model estimate based on Rubin’s rules [<xref ref-type="bibr" rid="CR14">14</xref>] is
<disp-formula id="Equi"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\bar{\boldsymbol{\beta}}^{*} = \frac {1}{B} \sum_{b=1}^{B}{\hat{{\boldsymbol{\beta}}}_{b}^{*}}, $$ \end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\hat {{\boldsymbol {\beta }}}_{b}^{*}} $\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq21.gif"/></alternatives></inline-formula> is the coefficients estimates from the GLM model fitted with the <italic>b</italic><sup><italic>t</italic><italic>h</italic></sup> bootstrap resample. The corresponding estimated pooled standard error is
<disp-formula id="Equj"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${SE}_{pooled}=\sqrt {{V}_{within}+{V}_{between}+\frac {{V}_{between}}{B}},$$ \end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">SE</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pooled</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">within</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">between</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">between</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> with <italic>V</italic><sub><italic>within</italic></sub> and <italic>V</italic><sub><italic>between</italic></sub> denotes the within and between imputation variance respectively. These are calculated by
<disp-formula id="Equk"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${V}_{within} = \frac {1}{B} \sum_{b=1}^{B}{{SE}_{b}^{*2}},$$ \end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">within</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="italic">SE</mml:mtext></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> with <inline-formula id="IEq22"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${SE}_{b}^{*2}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mtext mathvariant="italic">SE</mml:mtext></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq22.gif"/></alternatives></inline-formula> represents the sum of the squared Standard Error (SE), estimated in each bootstrap dataset <italic>b</italic>. and
<disp-formula id="Equl"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${V}_{between} = \sqrt {\frac {\sum_{b=1}^{B}({{\hat{\boldsymbol{\beta}}^{*}_{b}}-\bar{\boldsymbol{\beta}}^{*})^{2}}}{B-1}}.$$ \end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">between</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> We used the pool function in the R package <italic>MICE</italic> [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
      <p><italic>Step 4: Significance testing</italic>For significance testing of any of the pooled parameters of interest such as the interaction effect between cell-types and conditions, the univariate Wald test [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] is used and the test statistics is defined as:
<disp-formula id="Equm"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$W_{pooled} = \frac{\bar{{\beta}}^{*2}_{i}}{SE_{pooled}}, $$ \end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pooled</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pooled</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3211_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq23"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {{\beta }}^{*}_{i}$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq23.gif"/></alternatives></inline-formula> is the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> element of the pooled coefficient vector <inline-formula id="IEq24"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\boldsymbol {\beta }}^{*}$\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3211_Article_IEq24.gif"/></alternatives></inline-formula>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3211_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary Tables and Figures. <bold>Table S1.</bold> Simulation cases with correlated and rare cell-types. <bold>Table S2.</bold> Simulation of complex dataset. <bold>Table S3.</bold> Summary from Pooled GLM on neuronal dataset. <bold>Figure S1.</bold> scDC on correlated and rare cell-types. <bold>Figure S2.</bold> scDC on complex dataset. <bold>Figure S3.</bold> Runtime of scDC with varying number of cells and cell-types.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BCa</term>
        <def>
          <p>Bias-corrected and accelerated</p>
        </def>
      </def-item>
      <def-item>
        <term>CI</term>
        <def>
          <p>Confidence interval</p>
        </def>
      </def-item>
      <def-item>
        <term>GLM</term>
        <def>
          <p>Generalized linear model</p>
        </def>
      </def-item>
      <def-item>
        <term>GLMM</term>
        <def>
          <p>Generalized linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>scDC</term>
        <def>
          <p>Single cell differential composition</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p>Single cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SE</term>
        <def>
          <p>Standard error</p>
        </def>
      </def-item>
      <def-item>
        <term>T2D</term>
        <def>
          <p>Type two diabetes</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>† Yue Cao and Yingxin Lin are co-first authors;</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3211-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank all their colleagues, particularly at The University of Sydney, School of Mathematics and Statistics, for their support and intellectual engagement. In particular to Weichang Yu for discussion in multinomial simulation.</p>
    <sec id="d29e4043">
      <title>About this supplement</title>
      <p>This article has been published as part of BMC Bioinformatics, Volume 20 Supplement 19, 2019: 18th International Conference on Bioinformatics. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-19">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-19</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JYHY and KKL conceived the study with input from PY and JTO; YC and YL led the method development and data analysis with input from JTO, KKL, PY and JYHY; JYHY, KKL, YL and YC interpreted the results with input from PY; YL and YC processed and curated the data and implemented the R package. YC, JYHY, PY, YL, and KKL wrote the manuscript with input from JTO; All authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Publication of this supplement is funded by the following sources for each author. Australian Research Council Discovery Project grant (DP170100654) to JYHY, JTO, PY; Discovery Early Career Researcher Award (DE170100759) to PY; Australia NHMRC Career Developmental Fellowship (APP1111338) to JYHY and the Judith and David Coffey Life Lab at the Charles Perkins Centre, The University of Sydney to YL. Research Training Program Tuition Fee Offset and Stipend Scholarship to YL. The funding source had no role in the study design; in the collection, analysis, and interpretation of data, in the writing of the manuscript, and in the decision to submit the manuscript for publication.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The method scDC is implemented in R package <italic>scdney</italic>, available from <ext-link ext-link-type="uri" xlink:href="https://github.com/SydneyBioX/scdney">https://github.com/SydneyBioX/scdney</ext-link>. Data used in this paper are available through the following link.</p>
    <p>The human pancreas dataset is available at <ext-link ext-link-type="uri" xlink:href="http://sandberg.cmb.ki.se/pancreas/">http://sandberg.cmb.ki.se/pancreas/</ext-link>. Date accessed 4 September 2019.</p>
    <p>The mouse neuronal dataset can be found at <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-7320">http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-7320</ext-link>. Date accessed 4 September 2019.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Andreasson</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kasper</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ammala</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell Transcriptome Profiling of Human Pancreatic Islets in Health and Type 2 Diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ali</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Chlon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pharoah</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Caldas</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Patterns of immune infiltration in breast cancer and their clinical implications: a gene-expression-based retrospective study</article-title>
        <source>PLoS Med</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1002194</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1002194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delile</surname>
            <given-names>Julien</given-names>
          </name>
          <name>
            <surname>Rayon</surname>
            <given-names>Teresa</given-names>
          </name>
          <name>
            <surname>Melchionda</surname>
            <given-names>Manuela</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>Amelia</given-names>
          </name>
          <name>
            <surname>Briscoe</surname>
            <given-names>James</given-names>
          </name>
          <name>
            <surname>Sagner</surname>
            <given-names>Andreas</given-names>
          </name>
        </person-group>
        <article-title>Single cell transcriptomics reveals spatial and temporal dynamics of gene expression in the developing mouse spinal cord</article-title>
        <source>Development</source>
        <year>2019</year>
        <volume>146</volume>
        <issue>12</issue>
        <fpage>dev173807</fpage>
        <pub-id pub-id-type="doi">10.1242/dev.173807</pub-id>
        <pub-id pub-id-type="pmid">30846445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ilicic</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Bagger</surname>
            <given-names>FO</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Classification of low quality cells from single-cell rna-seq data</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0888-1</pub-id>
        <pub-id pub-id-type="pmid">26887813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duò</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>D. Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A systematic performance evaluation of clustering methods for single-cell rna-seq data</article-title>
        <source>F1000Research</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>1141</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.15666.1</pub-id>
        <pub-id pub-id-type="pmid">30271584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freytag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lönnstedt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bahlo</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Comparison of clustering tools in r for medium-sized 10x genomics single-cell rna-sequencing data</article-title>
        <source>F1000Research</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>1297</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.15809.1</pub-id>
        <pub-id pub-id-type="pmid">30228881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">Kim T, Chen IR, Lin Y, Wang AY-Y, Yang JYH, Yang P. Impact of similarity metrics on single-cell rna-seq data clustering. Brief Bioinform. 2018. 10.1093/bib/bby076.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Aitchison J. The single principle of compositional data analysis, continuing fallacies, confusions and misunderstandings and some suggested remedies. Keynote address, CODAWORK 2008. 2019. <ext-link ext-link-type="uri" xlink:href="https://core.ac.uk/download/pdf/132548276.pdf">https://core.ac.uk/download/pdf/132548276.pdf</ext-link>. Accessed 20 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shih</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Menzin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Whyte</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lovecchio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liew</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khalili</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bhuiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gregersen</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AT</given-names>
          </name>
        </person-group>
        <article-title>Identification of grade and origin specific cell populations in serous epithelial ovarian cancer by single cell rna-seq</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0206785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Rosa</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Deych</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Boone</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Sodergren</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shannon</surname>
            <given-names>WD</given-names>
          </name>
        </person-group>
        <article-title>Hypothesis testing and power calculations for taxonomic-based human microbiome data</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>12</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0052078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Variable selection for sparse dirichlet-multinomial regression with an application to microbiome data analysis</article-title>
        <source>The Ann Appl Stat</source>
        <year>2013</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>418</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1214/12-AOAS592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Bian G, Gloor GB, Gong A, Jia C, Zhang W, Hu J, Zhang H, Zhang Y, Zhou Z, Zhang J, Burton JP, Reid G, Xiao Y, Zeng Q, Yang K, Li J. The gut microbiota of healthy aged chinese is similar to that of the healthy young. mSphere. 2017; 2(5). 10.1128/mSphere.00327-17. http://arxiv.org/abs/https://msphere.asm.org/content/2/5/e00327-17.full.pdf.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Rivera-Pinto J, Egozcue JJ, Pawlowsky-Glahn V, Paredes R, Noguera-Julian M, Calle ML. Balances: a new perspective for microbiome analysis. mSystems. 2018; 3(4). 10.1128/mSystems.00053-18. http://arxiv.org/abs/https://msystems.asm.org/content/3/4/e00053-18.full.pdf.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toutenburg</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Rubin, d.b.: Multiple imputation for nonresponse in surveys</article-title>
        <source>Stat Pap</source>
        <year>1990</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>180</fpage>
        <pub-id pub-id-type="doi">10.1007/BF02924688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesenberry</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Hurst</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Large sample simultaneous confidence intervals for multinomial proportions</article-title>
        <source>Technometrics</source>
        <year>1964</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>191</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1080/00401706.1964.10490163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>May</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>WD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Constructing two-sided simultaneous confidence intervals for multinomial proportions for small counts in a large number of cells</article-title>
        <source>J Stat Softw</source>
        <year>2000</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v005.i06</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sison</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Glaz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous confidence intervals and sample size determination for multinomial proportions</article-title>
        <source>J Am Stat Assoc</source>
        <year>1995</year>
        <volume>90</volume>
        <issue>429</issue>
        <fpage>366</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1995.10476521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <source>An Introduction to the Bootstrap. Monographs on Statistics and Applied Probability, vol. 57</source>
        <year>1993</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieth</surname>
            <given-names>Beate</given-names>
          </name>
          <name>
            <surname>Ziegenhain</surname>
            <given-names>Christoph</given-names>
          </name>
          <name>
            <surname>Parekh</surname>
            <given-names>Swati</given-names>
          </name>
          <name>
            <surname>Enard</surname>
            <given-names>Wolfgang</given-names>
          </name>
          <name>
            <surname>Hellmann</surname>
            <given-names>Ines</given-names>
          </name>
        </person-group>
        <article-title>powsimR: power analysis for bulk and single cell RNA-seq experiments</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>21</issue>
        <fpage>3486</fpage>
        <lpage>3488</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx435</pub-id>
        <pub-id pub-id-type="pmid">29036287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>Aleksandra A.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Jong Kyoung</given-names>
          </name>
          <name>
            <surname>Tsang</surname>
            <given-names>Jason C.H.</given-names>
          </name>
          <name>
            <surname>Ilicic</surname>
            <given-names>Tomislav</given-names>
          </name>
          <name>
            <surname>Henriksson</surname>
            <given-names>Johan</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>Kedar N.</given-names>
          </name>
          <name>
            <surname>Tuck</surname>
            <given-names>Alex C.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Xuefei</given-names>
          </name>
          <name>
            <surname>Bühler</surname>
            <given-names>Marc</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Pentao</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A.</given-names>
          </name>
        </person-group>
        <article-title>Single Cell RNA-Sequencing of Pluripotent States Unlocks Modular Transcriptional Variation</article-title>
        <source>Cell Stem Cell</source>
        <year>2015</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>471</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2015.09.011</pub-id>
        <pub-id pub-id-type="pmid">26431182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Better bootstrap confidence intervals</article-title>
        <source>J Am Stat Assoc</source>
        <year>1987</year>
        <volume>82</volume>
        <issue>397</issue>
        <fpage>171</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1987.10478410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>Roger W.</given-names>
          </name>
        </person-group>
        <article-title>An Introduction to the Bootstrap</article-title>
        <source>Teaching Statistics</source>
        <year>2001</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>49</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9639.00050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2018</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>J Stat Softw</source>
        <year>2015</year>
        <volume>67</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Buuren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Groothuis-Oudshoorn</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>mice: Multivariate imputation by chained equations in r</article-title>
        <source>J Stat Softw</source>
        <year>2011</year>
        <volume>45</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
