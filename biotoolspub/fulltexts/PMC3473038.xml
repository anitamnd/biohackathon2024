<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3473038</article-id>
    <article-id pub-id-type="pmid">23091593</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-12-10650</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0045160</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic Acids</subject>
            <subj-group>
              <subject>RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Mathematics</subject>
        <subj-group>
          <subject>Statistics</subject>
          <subj-group>
            <subject>Statistical Theories</subject>
            <subj-group>
              <subject>Equilibrium Statistical Theory</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Physics</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Nucleic Acids</subject>
            <subj-group>
              <subject>RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Integrating Chemical Footprinting Data into RNA Secondary Structure Prediction</article-title>
      <alt-title alt-title-type="running-head">Chemical Footprinting and RNA Structure Prediction</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zarringhalam</surname>
          <given-names>Kourosh</given-names>
        </name>
        <xref ref-type="author-notes" rid="fn1">
          <sup>¤a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meyer</surname>
          <given-names>Michelle M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dotu</surname>
          <given-names>Ivan</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chuang</surname>
          <given-names>Jeffrey H.</given-names>
        </name>
        <xref ref-type="author-notes" rid="fn2">
          <sup>¤b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clote</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Department of Biology, Boston College, Chestnut Hill, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gibas</surname>
          <given-names>Cynthia</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of North Carolina at Charlotte, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>peter.clote@bc.edu</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: PC KZ MMM ID JHC. Performed the experiments: KZ MMM PC. Analyzed the data: KZ MMM ID JHC PC. Contributed reagents/materials/analysis tools: KZ MMM PC. Wrote the paper: KZ MMM ID JHC PC.</p>
      </fn>
      <fn id="fn1" fn-type="current-aff">
        <label>¤a</label>
        <p>Current address: Department of Mathematics, University of Massachusetts Boston, Boston, Massachusetts, United States of America</p>
      </fn>
      <fn id="fn2" fn-type="current-aff">
        <label>¤b</label>
        <p>Current address: The Jackson Laboratory for Genomic Medicine, Farmington, Connecticut, United States of America</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>10</month>
      <year>2012</year>
    </pub-date>
    <volume>7</volume>
    <issue>10</issue>
    <elocation-id>e45160</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>4</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>8</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2012 Zarringhalam et al</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Zarringhalam et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Chemical and enzymatic footprinting experiments, such as shape (selective 2′-hydroxyl acylation analyzed by primer extension), yield important information about RNA secondary structure. Indeed, since the <inline-formula><inline-graphic xlink:href="pone.0045160.e001.jpg"/></inline-formula>-hydroxyl is reactive at flexible (loop) regions, but unreactive at base-paired regions, shape yields quantitative data about which RNA nucleotides are base-paired. Recently, low error rates in secondary structure prediction have been reported for three RNAs of moderate size, by including base stacking pseudo-energy terms derived from shape data into the computation of minimum free energy secondary structure. Here, we describe a novel method, RNAsc (<italic>RNA soft constraints</italic>), which includes pseudo-energy terms for each nucleotide position, rather than only for base stacking positions. We prove that RNAsc is <italic>self-consistent</italic>, in the sense that the nucleotide-specific probabilities of being unpaired in the low energy Boltzmann ensemble always become more closely correlated with the input shape data after application of RNAsc. From this mathematical perspective, the secondary structure predicted by RNAsc should be ‘correct’, in as much as the shape data is ‘correct’. We benchmark RNAsc against the previously mentioned method for eight RNAs, for which both shape data and native structures are known, to find the same accuracy in 7 out of 8 cases, and an improvement of 25% in one case. Furthermore, we present what appears to be the first direct comparison of shape data and in-line probing data, by comparing yeast asp-tRNA shape data from the literature with data from in-line probing experiments we have recently performed. With respect to several criteria, we find that shape data appear to be more robust than in-line probing data, at least in the case of asp-tRNA.</p>
    </abstract>
    <funding-group>
      <funding-statement>No current external funding sources for this study.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>RNA is an important biomolecule, known to play both an <italic>information carrying</italic> and a <italic>catalytic</italic> role. RNA plays roles in numerous biological processes, including <italic>retranslation</italic> of the genetic code (selenocysteine insertion, ribosomal frameshift), transcriptional and translational gene regulation, temperature-dependent allosteric regulation, chemical modification of specific nucleotides in the ribosome, regulation of alternative splicing, apparent regulation of the formation of heterochromatin, etc. (See <xref rid="pone.0045160-Washietl1" ref-type="bibr">[1]</xref> for a recent review on the analysis of sequence and structure of such noncoding RNA.) Since the function of non-coding RNA largely depends on its structure and since it is believed that RNA plays many yet undiscovered roles in cellular processes, it is important to determine the structure of RNA.</p>
    <p>A secondary structure for a given RNA nucleotide sequence <inline-formula><inline-graphic xlink:href="pone.0045160.e002.jpg"/></inline-formula> is a set <inline-formula><inline-graphic xlink:href="pone.0045160.e003.jpg"/></inline-formula> of base pairs <inline-formula><inline-graphic xlink:href="pone.0045160.e004.jpg"/></inline-formula>, such that <inline-formula><inline-graphic xlink:href="pone.0045160.e005.jpg"/></inline-formula> forms either a Watson-Crick or GU (wobble) base pair, and such that there are no <italic>base triples</italic> or <italic>pseudoknots</italic> in <inline-formula><inline-graphic xlink:href="pone.0045160.e006.jpg"/></inline-formula>. In this context, a base triple in <inline-formula><inline-graphic xlink:href="pone.0045160.e007.jpg"/></inline-formula> consists of two base pairs <inline-formula><inline-graphic xlink:href="pone.0045160.e008.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e009.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0045160.e010.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e011.jpg"/></inline-formula>. A pseudoknot in <inline-formula><inline-graphic xlink:href="pone.0045160.e012.jpg"/></inline-formula> consists of two base pairs <inline-formula><inline-graphic xlink:href="pone.0045160.e013.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e014.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0045160.e015.jpg"/></inline-formula>. Although it is NP-hard <xref rid="pone.0045160-Garey1" ref-type="bibr">[2]</xref> to compute the minimum free energy (MFE) tertiary (or even pseudoknotted) structure of RNA <xref rid="pone.0045160-Lyngso1" ref-type="bibr">[3]</xref>, the MFE secondary structure can be computed in time that is cubic in the input sequence length <xref rid="pone.0045160-Zuker1" ref-type="bibr">[4]</xref>. Moreover, it is widely believed that RNA folds in a hierarchical fashion <xref rid="pone.0045160-Tinoco1" ref-type="bibr">[5]</xref>–<xref rid="pone.0045160-Bailor1" ref-type="bibr">[8]</xref>, with the secondary structure acting as a scaffold for tertiary structure, although this is not universally accepted <xref rid="pone.0045160-Wilkinson1" ref-type="bibr">[9]</xref>.</p>
    <p>RNA secondary structure can be predicted by Zuker and Stiegler's algorithm <xref rid="pone.0045160-Zuker1" ref-type="bibr">[4]</xref>, implemented in mfold <xref rid="pone.0045160-Zuker2" ref-type="bibr">[10]</xref>, RNAfold <xref rid="pone.0045160-Hofacker1" ref-type="bibr">[11]</xref>, and RNAstructure <xref rid="pone.0045160-Mathews1" ref-type="bibr">[12]</xref>. This algorithm uses dynamic programming with free energy parameters from the Turner energy model <xref rid="pone.0045160-Xia1" ref-type="bibr">[13]</xref> to compute the minimum free energy (MFE) structure.</p>
    <p>A first step towards integrating chemical/enzymatic probing data was taken by Mathews et al. <xref rid="pone.0045160-Mathews2" ref-type="bibr">[14]</xref>, where Zuker and Stiegler's algorithm was modified to support <italic>hard constraints</italic> reflecting the experimental data. In particular, given an RNA sequence, the software RNAstructure <xref rid="pone.0045160-Mathews2" ref-type="bibr">[14]</xref> computed the minimum free energy (MFE) secondary structure subject to user-defined constraints, such as stipulating that particular nucleotides remain unpaired, that pairs of specific nucleotides form a base pair, etc. Mathews et al. reported that the MFE structure prediction with (hard) constraints corresponding to chemical modification (1-cyclohexyl-3-(2-morpholinoethyl) carbodiimide metho-p-toluene sulfonate, dimethyl sulfate, and kethoxal) yielded an improvement in base-pair accuracy for 5S rRNA of <italic>E. coli</italic> from 26.3% to 86.8% <xref rid="pone.0045160-Mathews2" ref-type="bibr">[14]</xref>. (See <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> for more remarks and a less optimistic evaluation of RNAstructure with hard constraints on 16S rRNA.)</p>
    <p>Chemical/enzymatic probing data is probabilistic in nature, as exemplified in pars footprinting data <xref rid="pone.0045160-Kertesz1" ref-type="bibr">[16]</xref>. Rarely is it absolutely clear that certain positions are unpaired, or that certain base pairs are formed; instead, there is a certain probability of these events. In moving away from error-prone <italic>hard</italic> constraints, Deigan et al. <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> took a second step of incorporating shape (selective <inline-formula><inline-graphic xlink:href="pone.0045160.e016.jpg"/></inline-formula>-hydroxyl acylation analyzed by primer extension) data <xref rid="pone.0045160-Merino1" ref-type="bibr">[17]</xref>, <xref rid="pone.0045160-Wilkinson2" ref-type="bibr">[18]</xref>, whose numerical values (continuously) range from 0 to approximately 2.2, by incorporating a <italic>pseudo free energy</italic> for base stacking into the Zuker algorithm. The pseudo free energy term in <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> was defined to be<disp-formula id="pone.0045160.e017"><graphic xlink:href="pone.0045160.e017.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0045160.e018.jpg"/></inline-formula> kcal/mol and <inline-formula><inline-graphic xlink:href="pone.0045160.e019.jpg"/></inline-formula> kcal/mol, for each position <inline-formula><inline-graphic xlink:href="pone.0045160.e020.jpg"/></inline-formula> occurring in a base pairing stack; if <inline-formula><inline-graphic xlink:href="pone.0045160.e021.jpg"/></inline-formula> is unpaired, then no pseudo free energy is added. (The position <inline-formula><inline-graphic xlink:href="pone.0045160.e022.jpg"/></inline-formula> is in a base pairing stack if <inline-formula><inline-graphic xlink:href="pone.0045160.e023.jpg"/></inline-formula> are base pairs, or if <inline-formula><inline-graphic xlink:href="pone.0045160.e024.jpg"/></inline-formula> are base pairs belonging to the secondary structure. For base pairs <inline-formula><inline-graphic xlink:href="pone.0045160.e025.jpg"/></inline-formula> that are surrounded by base pair neighbors <inline-formula><inline-graphic xlink:href="pone.0045160.e026.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e027.jpg"/></inline-formula>, the pseudo-energy term is applied twice.) The resulting modified version of Zuker and Stiegler's algorithm, as implemented in RNAstructure was reported to yield secondary structure prediction accuracies of up to <inline-formula><inline-graphic xlink:href="pone.0045160.e028.jpg"/></inline-formula> for three moderate-sized RNAs (<inline-formula><inline-graphic xlink:href="pone.0045160.e029.jpg"/></inline-formula> nt) and for 16S rRNA (<inline-formula><inline-graphic xlink:href="pone.0045160.e030.jpg"/></inline-formula> nt). Wilkinson et al. <xref rid="pone.0045160-Wilkinson3" ref-type="bibr">[19]</xref> later described a model for the secondary structure of the HIV-1 genome, as computed by RNAstructure with shape pseudo energies defined in <xref ref-type="disp-formula" rid="pone.0045160.e017">equation 1</xref>. If correct, this is a remarkable feat, given that the size of the HIV-1 genome is generally just under 10,000 nt (see <ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov">http://www.hiv.lanl.gov</ext-link>), hence several times larger than the ribosome, whose crystal structure was only determined after years of painstaking work (the large unit, PDB code 1FFK <xref rid="pone.0045160-Ban1" ref-type="bibr">[20]</xref>, of the ribosome of <italic>Haloarcula marismortui</italic> consists of a 23S chain of length 2,922 nt and a 5S chain of 122 nt).</p>
    <p>One issue with this approach is that it takes into consideration shape data only for base-stacked positions, i.e., a pseudo free energy term corresponding to shape data is applied at positions where a stacked base pair occurs, but not where nucleotides are unpaired. By ignoring shape data for unpaired nucleotide positions, this approach can thus bias structure prediction to form base pairs even at positions, which shape data may suggest are flexible. Indeed the expected distance of predicted base pairing probabilities computed by RNAstructure with shape values increases after the incorporation of the shape pseudo energy terms (see <xref ref-type="table" rid="pone-0045160-t001">Table 1</xref>). (As later defined, RNAstructure and RNAsc both compute the probability <inline-formula><inline-graphic xlink:href="pone.0045160.e031.jpg"/></inline-formula> that base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e032.jpg"/></inline-formula> belongs to a structure in the low energy Boltzmann ensemble. Since the pseudo energy model for shape data incorporation is different in RNAstructure and RNAsc, the base pairing probabilities and Boltzmann low energy ensembles may be different.) In contrast to the pseudo energies of RNAstructure, our algorithm RNAsc, will always shift the distribution of conformations towards the shape measurements (see <xref ref-type="sec" rid="s2">Methods</xref> for a mathematical proof).</p>
    <table-wrap id="pone-0045160-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0045160.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Benchmark results.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0045160-t001-1" xlink:href="pone.0045160.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td colspan="12" align="left" rowspan="1">Secondary structure prediction accuracy</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">RNA</td>
              <td align="left" rowspan="1" colspan="1">len</td>
              <td align="left" rowspan="1" colspan="1">test</td>
              <td align="left" rowspan="1" colspan="1">(A)</td>
              <td align="left" rowspan="1" colspan="1">(B)</td>
              <td align="left" rowspan="1" colspan="1">(C)</td>
              <td align="left" rowspan="1" colspan="1">RNA</td>
              <td align="left" rowspan="1" colspan="1">len</td>
              <td align="left" rowspan="1" colspan="1">test</td>
              <td align="left" rowspan="1" colspan="1">(A)</td>
              <td align="left" rowspan="1" colspan="1">(B)</td>
              <td align="left" rowspan="1" colspan="1">(C)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">asp-tRNA</td>
              <td align="left" rowspan="1" colspan="1">75</td>
              <td align="left" rowspan="1" colspan="1">sens.</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">0.76</td>
              <td align="left" rowspan="1" colspan="1">phe-tRNA</td>
              <td align="left" rowspan="1" colspan="1">76</td>
              <td align="left" rowspan="1" colspan="1">sens.</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">0.75</td>
              <td align="left" rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ppv</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">0.76</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ppv</td>
              <td align="left" rowspan="1" colspan="1">0.95</td>
              <td align="left" rowspan="1" colspan="1">0.71</td>
              <td align="left" rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ave ent.</td>
              <td align="left" rowspan="1" colspan="1">0.21</td>
              <td align="left" rowspan="1" colspan="1">0.17</td>
              <td align="left" rowspan="1" colspan="1">0.27</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ave ent.</td>
              <td align="left" rowspan="1" colspan="1">0.2</td>
              <td align="left" rowspan="1" colspan="1">0.17</td>
              <td align="left" rowspan="1" colspan="1">0.46</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">str. div.</td>
              <td align="left" rowspan="1" colspan="1">19.53</td>
              <td align="left" rowspan="1" colspan="1">17.17</td>
              <td align="left" rowspan="1" colspan="1">22.60</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">str. div.</td>
              <td align="left" rowspan="1" colspan="1">11.37</td>
              <td align="left" rowspan="1" colspan="1">9.38</td>
              <td align="left" rowspan="1" colspan="1">34.37</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">edist.</td>
              <td align="left" rowspan="1" colspan="1">23.7</td>
              <td align="left" rowspan="1" colspan="1">61.77</td>
              <td align="left" rowspan="1" colspan="1">24.9</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">edist.</td>
              <td align="left" rowspan="1" colspan="1">29.51</td>
              <td align="left" rowspan="1" colspan="1">61.77</td>
              <td align="left" rowspan="1" colspan="1">33.68</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">HCV IRES</td>
              <td align="left" rowspan="1" colspan="1">95</td>
              <td align="left" rowspan="1" colspan="1">sens.</td>
              <td align="left" rowspan="1" colspan="1">0.96</td>
              <td align="left" rowspan="1" colspan="1">0.96</td>
              <td align="left" rowspan="1" colspan="1">0.96</td>
              <td align="left" rowspan="1" colspan="1">5S rRNA</td>
              <td align="left" rowspan="1" colspan="1">120</td>
              <td align="left" rowspan="1" colspan="1">sens.</td>
              <td align="left" rowspan="1" colspan="1">0.94</td>
              <td align="left" rowspan="1" colspan="1">0.94</td>
              <td align="left" rowspan="1" colspan="1">0.26</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ppv</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ppv</td>
              <td align="left" rowspan="1" colspan="1">0.82</td>
              <td align="left" rowspan="1" colspan="1">0.82</td>
              <td align="left" rowspan="1" colspan="1">0.22</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ave ent.</td>
              <td align="left" rowspan="1" colspan="1">0.05</td>
              <td align="left" rowspan="1" colspan="1">0.06</td>
              <td align="left" rowspan="1" colspan="1">0.27</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ave ent.</td>
              <td align="left" rowspan="1" colspan="1">0.30</td>
              <td align="left" rowspan="1" colspan="1">0.17</td>
              <td align="left" rowspan="1" colspan="1">0.27</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">str. div.</td>
              <td align="left" rowspan="1" colspan="1">3.20</td>
              <td align="left" rowspan="1" colspan="1">3.57</td>
              <td align="left" rowspan="1" colspan="1">21.45</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">str. div.</td>
              <td align="left" rowspan="1" colspan="1">46.93</td>
              <td align="left" rowspan="1" colspan="1">20.70</td>
              <td align="left" rowspan="1" colspan="1">32.90</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">edist.</td>
              <td align="left" rowspan="1" colspan="1">31.36</td>
              <td align="left" rowspan="1" colspan="1">52.48</td>
              <td align="left" rowspan="1" colspan="1">36.53</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">edist.</td>
              <td align="left" rowspan="1" colspan="1">42.57</td>
              <td align="left" rowspan="1" colspan="1">54.01</td>
              <td align="left" rowspan="1" colspan="1">46.41</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">P546</td>
              <td align="left" rowspan="1" colspan="1">155</td>
              <td align="left" rowspan="1" colspan="1">sens.</td>
              <td align="left" rowspan="1" colspan="1">0.95</td>
              <td align="left" rowspan="1" colspan="1">0.96</td>
              <td align="left" rowspan="1" colspan="1">0.43</td>
              <td align="left" rowspan="1" colspan="1">glycine</td>
              <td align="left" rowspan="1" colspan="1">162</td>
              <td align="left" rowspan="1" colspan="1">sens.</td>
              <td align="left" rowspan="1" colspan="1">0.92</td>
              <td align="left" rowspan="1" colspan="1">0.92</td>
              <td align="left" rowspan="1" colspan="1">0.70</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ppv</td>
              <td align="left" rowspan="1" colspan="1">0.96</td>
              <td align="left" rowspan="1" colspan="1">0.98</td>
              <td align="left" rowspan="1" colspan="1">0.44</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ppv</td>
              <td align="left" rowspan="1" colspan="1">0.84</td>
              <td align="left" rowspan="1" colspan="1">0.84</td>
              <td align="left" rowspan="1" colspan="1">0.61</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ave ent.</td>
              <td align="left" rowspan="1" colspan="1">0.18</td>
              <td align="left" rowspan="1" colspan="1">0.12</td>
              <td align="left" rowspan="1" colspan="1">0.38</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ave ent.</td>
              <td align="left" rowspan="1" colspan="1">0.11</td>
              <td align="left" rowspan="1" colspan="1">0.05</td>
              <td align="left" rowspan="1" colspan="1">0.30</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">str. div.</td>
              <td align="left" rowspan="1" colspan="1">27.7</td>
              <td align="left" rowspan="1" colspan="1">14.05</td>
              <td align="left" rowspan="1" colspan="1">66.50</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">str. div.</td>
              <td align="left" rowspan="1" colspan="1">15.14</td>
              <td align="left" rowspan="1" colspan="1">5.13</td>
              <td align="left" rowspan="1" colspan="1">44.16</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">edist.</td>
              <td align="left" rowspan="1" colspan="1">41.36</td>
              <td align="left" rowspan="1" colspan="1">131.77</td>
              <td align="left" rowspan="1" colspan="1">56.11</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">edist.</td>
              <td align="left" rowspan="1" colspan="1">53.90</td>
              <td align="left" rowspan="1" colspan="1">115.55</td>
              <td align="left" rowspan="1" colspan="1">60.29</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>A comparison of three secondary structure prediction algorithms, using shape data from Deigan et al. <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> for the three RNA molecules, yeast aspartyl tRNA (asp-tRNA), hepatitis C virus internal ribosomal entry site (HCV IRES), and the P546 domain from the bI3 group I intron (P546), along with shape data from <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref> for three additional RNA molecules, <italic>E. coli</italic> phenylalanine tRNA (phe-tRNA), <italic>E. coli</italic> 5S ribosomal RNA (5S rRNA), and <italic>F. nucleatum</italic> glycine riboswitch (glycine). The benchmark results are tabulated for (A) RNAsc+shape, (B) RNAstructure+shape, and (C) RNAstructure (with no shape data). Sensitivity <inline-formula><inline-graphic xlink:href="pone.0045160.e033.jpg"/></inline-formula> is abbreviated by sens., positive predictive value <inline-formula><inline-graphic xlink:href="pone.0045160.e034.jpg"/></inline-formula> is abbreviated by ppv. The average pointwise entropy, Morgan-Higgs structural diversity, and the expected distance of the computed probabilities to the probing data are abreviated by ave ent., str. div., and edist., respectively. Not shown: results for medloop and <italic>V. vulnificus</italic> adenine riboswitch (1Y26), for which all three methods have optima sensitivity and ppv values of 1.0.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Nonetheless, MFE dynamic programming methods that incorporate high throughput chemical/enzymatic footprinting data can yield important insights into the structure and function of RNA molecules, much faster than the labor-intensive X-ray diffraction methods.</p>
    <p>The motivation for our work is to develop a method that incorporates chemical/enzymatic footprinting data in a <italic>self-consistent</italic> manner. In particular, given experimental data of the form <inline-formula><inline-graphic xlink:href="pone.0045160.e035.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0045160.e036.jpg"/></inline-formula> is the experimental probability that the <inline-formula><inline-graphic xlink:href="pone.0045160.e037.jpg"/></inline-formula>th nucleotide is <italic>unpaired</italic> (or, more accurately, in a flexible region, as witnessed by high shape reactivity), our goal is to develop an algorithm incorporating footprinting data such that the <italic>recalculated</italic> probabilities <inline-formula><inline-graphic xlink:href="pone.0045160.e038.jpg"/></inline-formula> are guaranteed to be closer to the experimental measurements. If our algorithm is self-consistent in this manner, then we have strong mathematical evidence that the partition function computation and hence the MFE computation are both as correct as is the shape data. In contrast to the pseudo energies of RNAstructure, we prove that our algorithm RNAsc is self-consistent, and on average, the ensemble of low energy secondary structures produced by our method yields a footprinting pattern that closely resembles the pattern from input experimental shape data. We benchmark our method against the RNAstructure program <xref rid="pone.0045160-Wilkinson3" ref-type="bibr">[19]</xref> on eight RNAs, for which shape data and native structures are both available. The secondary structure predictions from our method and from RNAstructure are fairly similar and both significantly improve secondary structure prediction without incorporation of footprinting data (e.g. mfold, RNAfold). However, the expected distance of the computed probabilities with the shape data is lower in our method for all the test cases. It is worth noting that the mistakes in the predicted secondary structure usually occur in positions where the shape data might be inaccurate, or where the native structure and shape data structures could be somewhat different, due to quite different temperatures required by each experimental protocol. Recent studies have shown that different experimental mapping approaches can provide complementary structural information <xref rid="pone.0045160-Novikova1" ref-type="bibr">[21]</xref>. Thus, we additionally performed in-line probing <xref rid="pone.0045160-Mandal1" ref-type="bibr">[22]</xref>, <xref rid="pone.0045160-Meyer1" ref-type="bibr">[23]</xref> on asp-tRNA, in order to compare the results of shape and in-line probing in the context of our algorithm. The source code of RNAsc as well as a web server is available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAsc/">http://bioinformatics.bc.edu/clotelab/RNAsc/</ext-link>.</p>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>Methods</title>
    <sec id="s2a">
      <title>In-line probing experiments</title>
      <p>DNA oligonucleotides for the sequence and its reverse complement were purchased from MWG Operon; remaining reagents were obtained from Sigma-Aldrich. DNA oligonucleotides were annealed to create templates for T7 polymerase transcription, and the transcription products were purified by denaturing PAGE and eluted in 10 mM Tris-HCl (pH 7.5 at <inline-formula><inline-graphic xlink:href="pone.0045160.e039.jpg"/></inline-formula>C), 200 mM NaCl and 1 mM EDTA. Following in-line probing protocols designed by the Breaker Lab <xref rid="pone.0045160-Mandal1" ref-type="bibr">[22]</xref>, <xref rid="pone.0045160-Meyer1" ref-type="bibr">[23]</xref>, synthesized RNA molecules were dephosphorylated using alkaline phosphatase (Roche Diagnostics) and radiolabeled with [g-32P]ATP and T4 polynucleotide kinase (NEB) according to the manufacturers instructions. Spontaneous transesterification reactions using PAGE-purified, <inline-formula><inline-graphic xlink:href="pone.0045160.e040.jpg"/></inline-formula> endlabeled RNAs were assembled as described in <xref rid="pone.0045160-Meyer1" ref-type="bibr">[23]</xref>. Incubations were performed for approximately 40 h at <inline-formula><inline-graphic xlink:href="pone.0045160.e041.jpg"/></inline-formula>C in 10-uL volumes containing 50 mM Tris-HCl (pH 8.3 at <inline-formula><inline-graphic xlink:href="pone.0045160.e042.jpg"/></inline-formula>C), 20 mM MgCl2, 100 mM KCl and <inline-formula><inline-graphic xlink:href="pone.0045160.e043.jpg"/></inline-formula> nM RNA. RNA fragments resulting from spontaneous transesterification were resolved by denaturing 10% PAGE, and imaged with a Molecular Dynamics STORM PhosphorImager. Quantification of gels were performed using SAFA (Semi-Automated Footprinting Analysis) <xref rid="pone.0045160-Das1" ref-type="bibr">[24]</xref>. In-line probing experiments were repeated an additional two times, resulting in gels with comparable data (data not shown). <xref ref-type="fig" rid="pone-0045160-g001">Fig. 1</xref> is an image of the in-line probing gel for yeast asp-tRNA.</p>
      <fig id="pone-0045160-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>In-line probing.</title>
          <p>Spontaneous cleavage pattern resulting from in-line probing of yeast asp-tRNA, nucleotides with larger backbone flexibility will have higher rates of cleavage and thus bands of greater intensity. Lanes for no reaction, T1 RNase (cleavage following only guanosines), and partial hydroxyl cleavage (-OH, cleavage after each base) are indicated. Due to the high resolution of the gel, double bands appear for nucleotides 2–9. These bands correspond to RNA molecules where the <inline-formula><inline-graphic xlink:href="pone.0045160.e044.jpg"/></inline-formula> cyclic phosphate intermediate has hydrolyzed to leave either no phosphate, or a mixture of <inline-formula><inline-graphic xlink:href="pone.0045160.e045.jpg"/></inline-formula>- and <inline-formula><inline-graphic xlink:href="pone.0045160.e046.jpg"/></inline-formula>-phosphate products which migrate more quickly on the gel. Quantifcation of these positions combined the bands corresponding to both products. The precursor RNA and T1 RNase cleavage products are marked. Not all guanosines show cleavage due to retention of secondary structure at 5 M urea and elevated temperature.</p>
        </caption>
        <graphic xlink:href="pone.0045160.g001"/>
      </fig>
    </sec>
    <sec id="s2b">
      <title>Computational methods</title>
      <p>Briefly stated, our algorithm, RNAsc (<italic>RNA soft constraints</italic>), consists of a preprocessing step, that normalizes shape data to the range <inline-formula><inline-graphic xlink:href="pone.0045160.e047.jpg"/></inline-formula>, followed by a computation of the minimum free energy [resp. partition function], which incorporates pseudo-energy terms [resp. Boltzmann factors of pseudo-energy terms] for each nucleotide position. We begin by discussion of the normalization of shape data.</p>
      <sec id="s2b1">
        <title>Normalization of shape</title>
        <p>In experiments reported by the Weeks Lab <xref rid="pone.0045160-Wilkinson4" ref-type="bibr">[25]</xref> as well as the Das Lab <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref>, shape reactivities range from <inline-formula><inline-graphic xlink:href="pone.0045160.e048.jpg"/></inline-formula> to roughly <inline-formula><inline-graphic xlink:href="pone.0045160.e049.jpg"/></inline-formula>. Large reactivities suggest that the position is unpaired; small reactivities suggest that the position is base-paired. More specifically, nucleotides with shape reactivities <inline-formula><inline-graphic xlink:href="pone.0045160.e050.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0045160.e051.jpg"/></inline-formula> are considered highly and moderately reactive, respectively <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>. The normalization is carried out in a piecewise linear fashion where <inline-formula><inline-graphic xlink:href="pone.0045160.e052.jpg"/></inline-formula> will be roughly mapped to <inline-formula><inline-graphic xlink:href="pone.0045160.e053.jpg"/></inline-formula>. However, very low shape reactivities should not be mapped close to <inline-formula><inline-graphic xlink:href="pone.0045160.e054.jpg"/></inline-formula> either as it will bias the shape values toward unpaired nucleotides. For this reason the shape reactivity values <inline-formula><inline-graphic xlink:href="pone.0045160.e055.jpg"/></inline-formula> are linearly mapped to the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e056.jpg"/></inline-formula>, the reactivity values in <inline-formula><inline-graphic xlink:href="pone.0045160.e057.jpg"/></inline-formula> are linearly mapped to the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e058.jpg"/></inline-formula>, the reactivity values in <inline-formula><inline-graphic xlink:href="pone.0045160.e059.jpg"/></inline-formula> are linearly mapped to the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e060.jpg"/></inline-formula>, and lastly, the reactivities <inline-formula><inline-graphic xlink:href="pone.0045160.e061.jpg"/></inline-formula> are linearly mapped to the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e062.jpg"/></inline-formula>. The selection of the threshold values are motivated by the moderate and high reactivity thresholds as reported in <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> and the examination of the cumulative distribution of the shape data (see <xref ref-type="supplementary-material" rid="pone.0045160.s001">File S1</xref>). The in-line probing data was normalized by mapping the outliers at the <inline-formula><inline-graphic xlink:href="pone.0045160.e063.jpg"/></inline-formula> and the <inline-formula><inline-graphic xlink:href="pone.0045160.e064.jpg"/></inline-formula> quantiles to <inline-formula><inline-graphic xlink:href="pone.0045160.e065.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e066.jpg"/></inline-formula> respectively and normalizing the rest of the data to <inline-formula><inline-graphic xlink:href="pone.0045160.e067.jpg"/></inline-formula> linearly. <xref ref-type="fig" rid="pone-0045160-g002">Fig. 2</xref> shows a plot of the normalized and raw shape values as well as the normalization map.</p>
        <fig id="pone-0045160-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Normalization.</title>
            <p>Normalized (blue circles) and raw (red diamonds) shape values. Gray bars indicate the missing shape values. The subplots shows the piecewise normalization map.</p>
          </caption>
          <graphic xlink:href="pone.0045160.g002"/>
        </fig>
      </sec>
      <sec id="s2b2">
        <title>Boltzmann weights</title>
        <p>Let <inline-formula><inline-graphic xlink:href="pone.0045160.e068.jpg"/></inline-formula> be a fixed RNA sequence of length <inline-formula><inline-graphic xlink:href="pone.0045160.e069.jpg"/></inline-formula>, for which we are given normalized shape or in-line probing reactivity data <inline-formula><inline-graphic xlink:href="pone.0045160.e070.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0045160.e071.jpg"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="pone.0045160.e072.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e073.jpg"/></inline-formula>, define the Boltzmann weight<disp-formula id="pone.0045160.e074"><graphic xlink:href="pone.0045160.e074.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0045160.e075.jpg"/></inline-formula> is a scaling parameter, and <inline-formula><inline-graphic xlink:href="pone.0045160.e076.jpg"/></inline-formula> measures the discrepancy between <inline-formula><inline-graphic xlink:href="pone.0045160.e077.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e078.jpg"/></inline-formula>. We will later incorporate Boltzmann weights in a <italic>weighted</italic> partition function <inline-formula><inline-graphic xlink:href="pone.0045160.e079.jpg"/></inline-formula>, in a manner that reweights the ensemble of low energy conformations towards the shape data. When later used in recurrence relations for <inline-formula><inline-graphic xlink:href="pone.0045160.e080.jpg"/></inline-formula>, the variable <inline-formula><inline-graphic xlink:href="pone.0045160.e081.jpg"/></inline-formula> is the indicator function for whether a position is unpaired <inline-formula><inline-graphic xlink:href="pone.0045160.e082.jpg"/></inline-formula> or paired <inline-formula><inline-graphic xlink:href="pone.0045160.e083.jpg"/></inline-formula> in a secondary structure under consideration. In the case of missing values, <inline-formula><inline-graphic xlink:href="pone.0045160.e084.jpg"/></inline-formula> may be assigned to <inline-formula><inline-graphic xlink:href="pone.0045160.e085.jpg"/></inline-formula>, which represents no information about base pairing.</p>
      </sec>
      <sec id="s2b3">
        <title>Weighting the partition function</title>
        <p>In this section, we describe how to integrate Boltzmann weights into the computation of the partition function for secondary structures of a given RNA sequence.This allows us to compute the probability <inline-formula><inline-graphic xlink:href="pone.0045160.e086.jpg"/></inline-formula> [resp. <inline-formula><inline-graphic xlink:href="pone.0045160.e087.jpg"/></inline-formula>] that <inline-formula><inline-graphic xlink:href="pone.0045160.e088.jpg"/></inline-formula> is a base pair in the Boltzmann ensemble of structures, where weights for shape or in-line probing have not [resp. have] been taken into consideration. As later explained, we will compare the probability <inline-formula><inline-graphic xlink:href="pone.0045160.e089.jpg"/></inline-formula> with normalized shape reactivity <inline-formula><inline-graphic xlink:href="pone.0045160.e090.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0045160.e091.jpg"/></inline-formula> denote the subsequence <inline-formula><inline-graphic xlink:href="pone.0045160.e092.jpg"/></inline-formula> of a given, fixed RNA sequence <inline-formula><inline-graphic xlink:href="pone.0045160.e093.jpg"/></inline-formula> of length <inline-formula><inline-graphic xlink:href="pone.0045160.e094.jpg"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="pone.0045160.e095.jpg"/></inline-formula>, the McCaskill <xref rid="pone.0045160-McCaskill1" ref-type="bibr">[27]</xref> partition function <inline-formula><inline-graphic xlink:href="pone.0045160.e096.jpg"/></inline-formula> is defined by <inline-formula><inline-graphic xlink:href="pone.0045160.e097.jpg"/></inline-formula>, where the sum is taken over all secondary structures <inline-formula><inline-graphic xlink:href="pone.0045160.e098.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0045160.e099.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e100.jpg"/></inline-formula> is the free energy of <inline-formula><inline-graphic xlink:href="pone.0045160.e101.jpg"/></inline-formula> with respect to the Turner energy model <xref rid="pone.0045160-Xia1" ref-type="bibr">[13]</xref>, <xref rid="pone.0045160-Matthews1" ref-type="bibr">[28]</xref>, <inline-formula><inline-graphic xlink:href="pone.0045160.e102.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="pone.0045160.e103.jpg"/></inline-formula> is the universal gas constant, and <inline-formula><inline-graphic xlink:href="pone.0045160.e104.jpg"/></inline-formula> absolute temperature. The goal of the current paper is to integrate the previously defined weights into the partition function. We first require some notation. Here, we write <inline-formula><inline-graphic xlink:href="pone.0045160.e105.jpg"/></inline-formula>, etc. instead of the more cumbersome notation <inline-formula><inline-graphic xlink:href="pone.0045160.e106.jpg"/></inline-formula>, etc. Thus <inline-formula><inline-graphic xlink:href="pone.0045160.e107.jpg"/></inline-formula> etc. depend on the normalized footprinting data <inline-formula><inline-graphic xlink:href="pone.0045160.e108.jpg"/></inline-formula>, although <inline-formula><inline-graphic xlink:href="pone.0045160.e109.jpg"/></inline-formula> will not be explicitly mentioned.</p>
      </sec>
      <sec id="s2b4">
        <title>Definition 1 (Weighted partition function)</title>
        <p>
          <italic>Define</italic>
        </p>
        <list list-type="bullet">
          <list-item>
            <p><inline-formula><inline-graphic xlink:href="pone.0045160.e110.jpg"/></inline-formula>: weighted partition function over all secondary structures of <inline-formula><inline-graphic xlink:href="pone.0045160.e111.jpg"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p><inline-formula><inline-graphic xlink:href="pone.0045160.e112.jpg"/></inline-formula>: weighted partition function over all secondary structures of <inline-formula><inline-graphic xlink:href="pone.0045160.e113.jpg"/></inline-formula>, which contain the base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e114.jpg"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p><inline-formula><inline-graphic xlink:href="pone.0045160.e115.jpg"/></inline-formula>: weighted partition function over all secondary structures of <inline-formula><inline-graphic xlink:href="pone.0045160.e116.jpg"/></inline-formula>, subject to the constraint that <inline-formula><inline-graphic xlink:href="pone.0045160.e117.jpg"/></inline-formula> is part of a multiloop and has <italic>at least</italic> one component.</p>
          </list-item>
          <list-item>
            <p><inline-formula><inline-graphic xlink:href="pone.0045160.e118.jpg"/></inline-formula>: weighted partition function over all secondary structures of <inline-formula><inline-graphic xlink:href="pone.0045160.e119.jpg"/></inline-formula>, subject to the constraint that <inline-formula><inline-graphic xlink:href="pone.0045160.e120.jpg"/></inline-formula> is part of a multiloop and has <italic>exactly</italic> one component. Moreover, it is <italic>required</italic> that <inline-formula><inline-graphic xlink:href="pone.0045160.e121.jpg"/></inline-formula> base-pair in the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e122.jpg"/></inline-formula>; i.e. <inline-formula><inline-graphic xlink:href="pone.0045160.e123.jpg"/></inline-formula> is a base pair, for some <inline-formula><inline-graphic xlink:href="pone.0045160.e124.jpg"/></inline-formula>.</p>
          </list-item>
        </list>
        <p>To compute partition function <inline-formula><inline-graphic xlink:href="pone.0045160.e125.jpg"/></inline-formula>, we compute by dynamic programming <inline-formula><inline-graphic xlink:href="pone.0045160.e126.jpg"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="pone.0045160.e127.jpg"/></inline-formula> by increasing values of <inline-formula><inline-graphic xlink:href="pone.0045160.e128.jpg"/></inline-formula>. Structures on <inline-formula><inline-graphic xlink:href="pone.0045160.e129.jpg"/></inline-formula> can be subdivided into those for which <inline-formula><inline-graphic xlink:href="pone.0045160.e130.jpg"/></inline-formula> is unpaired in <inline-formula><inline-graphic xlink:href="pone.0045160.e131.jpg"/></inline-formula>, thus contributing <inline-formula><inline-graphic xlink:href="pone.0045160.e132.jpg"/></inline-formula> times Boltzmann factor for <inline-formula><inline-graphic xlink:href="pone.0045160.e133.jpg"/></inline-formula> to be unpaired, and those for which <inline-formula><inline-graphic xlink:href="pone.0045160.e134.jpg"/></inline-formula> is paired with <inline-formula><inline-graphic xlink:href="pone.0045160.e135.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0045160.e136.jpg"/></inline-formula>, thus contributing <inline-formula><inline-graphic xlink:href="pone.0045160.e137.jpg"/></inline-formula> times Boltzmann factor for <inline-formula><inline-graphic xlink:href="pone.0045160.e138.jpg"/></inline-formula> to be paired. Subsequently <inline-formula><inline-graphic xlink:href="pone.0045160.e139.jpg"/></inline-formula> is computed by adding a contribution for all loops closed by base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e140.jpg"/></inline-formula>, i.e., hairpins, bulges, internal loops and multi loops whose latter contribution is recursively computed by jultiloop partition functions <inline-formula><inline-graphic xlink:href="pone.0045160.e141.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e142.jpg"/></inline-formula>. In essence, we apply Boltzmann weights to each nucleotide position <inline-formula><inline-graphic xlink:href="pone.0045160.e143.jpg"/></inline-formula>, while accounting for a distinct weight depending on whether <inline-formula><inline-graphic xlink:href="pone.0045160.e144.jpg"/></inline-formula> is paired or unpaired in the structure <inline-formula><inline-graphic xlink:href="pone.0045160.e145.jpg"/></inline-formula> under consideration: weight <inline-formula><inline-graphic xlink:href="pone.0045160.e146.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="pone.0045160.e147.jpg"/></inline-formula> is unpaired in <inline-formula><inline-graphic xlink:href="pone.0045160.e148.jpg"/></inline-formula>, weight <inline-formula><inline-graphic xlink:href="pone.0045160.e149.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="pone.0045160.e150.jpg"/></inline-formula> is base-paired in <inline-formula><inline-graphic xlink:href="pone.0045160.e151.jpg"/></inline-formula>. If all weights were set to <inline-formula><inline-graphic xlink:href="pone.0045160.e152.jpg"/></inline-formula>, then the weighted partition function would be equivalent to the classic partition function. Similar forms of rearranging and reweighting of the partition function have been applied in the context of single stranded RNA binding proteins <xref rid="pone.0045160-Forties1" ref-type="bibr">[29]</xref>. Details now follow. It will be expedient to define the function <inline-formula><inline-graphic xlink:href="pone.0045160.e153.jpg"/></inline-formula>, which represents the weight corresponding to a <italic>loop</italic> region in which <inline-formula><inline-graphic xlink:href="pone.0045160.e154.jpg"/></inline-formula> are unpaired. For <inline-formula><inline-graphic xlink:href="pone.0045160.e155.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e156.jpg"/></inline-formula>, while for <inline-formula><inline-graphic xlink:href="pone.0045160.e157.jpg"/></inline-formula>,<disp-formula id="pone.0045160.e158"><graphic xlink:href="pone.0045160.e158.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>In the base case, we define <inline-formula><inline-graphic xlink:href="pone.0045160.e159.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e160.jpg"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="pone.0045160.e161.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0045160.e162.jpg"/></inline-formula> is the minimum number of unpaired bases in a hairpin loop (generally <inline-formula><inline-graphic xlink:href="pone.0045160.e163.jpg"/></inline-formula>). In the inductive case, where <inline-formula><inline-graphic xlink:href="pone.0045160.e164.jpg"/></inline-formula>, we define<disp-formula id="pone.0045160.e165"><graphic xlink:href="pone.0045160.e165.jpg" position="anchor" orientation="portrait"/><label>(4)</label></disp-formula>Note that in the above equation <inline-formula><inline-graphic xlink:href="pone.0045160.e166.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e167.jpg"/></inline-formula> correspond to the weights for the nucleotides <inline-formula><inline-graphic xlink:href="pone.0045160.e168.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e169.jpg"/></inline-formula> being paired, but not necessarily to one another. If extra information on the pairing status of the nucleotides is available, (e.g., as in ‘mutate and map’ experiments <xref rid="pone.0045160-Kladwang2" ref-type="bibr">[30]</xref>), these weights may be corrected accordingly to reflect the weight for the pairing of the <inline-formula><inline-graphic xlink:href="pone.0045160.e170.jpg"/></inline-formula>th and the <inline-formula><inline-graphic xlink:href="pone.0045160.e171.jpg"/></inline-formula>th nucleotides. Let <inline-formula><inline-graphic xlink:href="pone.0045160.e172.jpg"/></inline-formula> denote the free energy of a hairpin and let <inline-formula><inline-graphic xlink:href="pone.0045160.e173.jpg"/></inline-formula> denote the free energy of an internal loop (which combines the cases of stacked base pair, bulge and proper internal loop). The free energy for a multiloop containing <inline-formula><inline-graphic xlink:href="pone.0045160.e174.jpg"/></inline-formula> base pairs and <inline-formula><inline-graphic xlink:href="pone.0045160.e175.jpg"/></inline-formula> unpaired bases is given by the affine approximation <inline-formula><inline-graphic xlink:href="pone.0045160.e176.jpg"/></inline-formula>. The weighted partition function closed by base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e177.jpg"/></inline-formula> is given by<disp-formula id="pone.0045160.e178"><graphic xlink:href="pone.0045160.e178.jpg" position="anchor" orientation="portrait"/><label>(5)</label></disp-formula>The weighted multiloop partition function with a single component and where position <inline-formula><inline-graphic xlink:href="pone.0045160.e179.jpg"/></inline-formula> is required to base-pair in the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e180.jpg"/></inline-formula> is given by<disp-formula id="pone.0045160.e181"><graphic xlink:href="pone.0045160.e181.jpg" position="anchor" orientation="portrait"/><label>(6)</label></disp-formula>Finally, the weighted multiloop partition function with one or more components, having no requirement that position <inline-formula><inline-graphic xlink:href="pone.0045160.e182.jpg"/></inline-formula> base-pair in the interval <inline-formula><inline-graphic xlink:href="pone.0045160.e183.jpg"/></inline-formula> is given by<disp-formula id="pone.0045160.e184"><graphic xlink:href="pone.0045160.e184.jpg" position="anchor" orientation="portrait"/><label>(7)</label></disp-formula>The weighted Boltzmann probability of base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e185.jpg"/></inline-formula> is defined by<disp-formula id="pone.0045160.e186"><graphic xlink:href="pone.0045160.e186.jpg" position="anchor" orientation="portrait"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0045160.e187.jpg"/></inline-formula> – see <xref ref-type="sec" rid="s2">Methods</xref>. Following Zuker <xref rid="pone.0045160-Zuker3" ref-type="bibr">[31]</xref>, the inner and outer partition function is computed, from which we easily obtain <inline-formula><inline-graphic xlink:href="pone.0045160.e188.jpg"/></inline-formula>.</p>
        <p>The minimum free energy (MFE) structure can be computed by a modification of McCaskill's algorithm <xref rid="pone.0045160-McCaskill1" ref-type="bibr">[27]</xref>, where the weighted partition function is modified by replacing summations by minimizations, products by sums, and replacing the weights by <inline-formula><inline-graphic xlink:href="pone.0045160.e189.jpg"/></inline-formula>. Although we did implement this algorithm, it does not include energy contributions for stacked, single-stranded nucleotides (dangles) or coaxial stacking, both known to be important in improving secondary structure prediction accuracy. For this reason, we modified the source code of RNAstructure, for both the MFE as well as the partition function computation which implements dangles and coaxial stacking. See <xref ref-type="supplementary-material" rid="pone.0045160.s001">File S1</xref> for details. As in <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>, the value of the scaling parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e190.jpg"/></inline-formula>, is determined by a search to optimize positive predictive value and sensitivity.</p>
      </sec>
      <sec id="s2b5">
        <title>Measures of uncertainty in the predicted low-energy ensemble of conformations</title>
        <p>Pointwise entropy and Morgan-Higgs structural diversity <xref rid="pone.0045160-Higgs1" ref-type="bibr">[32]</xref> were used as measures of uncertainty in the prediction of the secondary structure. The poinwise entropy is defined as follows. For each <italic>fixed</italic>
<inline-formula><inline-graphic xlink:href="pone.0045160.e191.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0045160.e192.jpg"/></inline-formula>, define probability distribution <inline-formula><inline-graphic xlink:href="pone.0045160.e193.jpg"/></inline-formula> on <inline-formula><inline-graphic xlink:href="pone.0045160.e194.jpg"/></inline-formula> by setting <inline-formula><inline-graphic xlink:href="pone.0045160.e195.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0045160.e196.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e197.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0045160.e198.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0045160.e199.jpg"/></inline-formula>. Pointwise entropy <inline-formula><inline-graphic xlink:href="pone.0045160.e200.jpg"/></inline-formula> measures the <italic>variability</italic> in nucleotides found to be base-paired with <inline-formula><inline-graphic xlink:href="pone.0045160.e201.jpg"/></inline-formula> in the Boltzmann ensemble of low energy structures. The pointwise entropy without the probing data is computed similarly using the probabilities <inline-formula><inline-graphic xlink:href="pone.0045160.e202.jpg"/></inline-formula>. To reflect the nature of the probing data, we modified this definition as follows. Define the binary pointwise entropy at position <inline-formula><inline-graphic xlink:href="pone.0045160.e203.jpg"/></inline-formula> by <inline-formula><inline-graphic xlink:href="pone.0045160.e204.jpg"/></inline-formula>. Binary entropy measures the uncertainty in the <inline-formula><inline-graphic xlink:href="pone.0045160.e205.jpg"/></inline-formula>th nucleotide being paired or unpaired, reflecting the signal detected by probing data. Similar computations were done with <inline-formula><inline-graphic xlink:href="pone.0045160.e206.jpg"/></inline-formula> (the base pairing probabilities without the integration of the weights). The Morgan-Higgs structural diversity is defined by <inline-formula><inline-graphic xlink:href="pone.0045160.e207.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0045160.e208.jpg"/></inline-formula> is defined by <inline-formula><inline-graphic xlink:href="pone.0045160.e209.jpg"/></inline-formula>. Similar computations were done with <inline-formula><inline-graphic xlink:href="pone.0045160.e210.jpg"/></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="s2c">
      <title>RNAsc is guaranteed to improve agreement with shape data</title>
      <p>In this section, we show that on average, the ensemble of low energy secondary structures produced by our method yields a footprinting pattern that more closely resembles the pattern from input experimental shape data; in particular, we prove that the expected distance from (normalized) shape data for the ensemble of low energy structures (our algorithm) is strictly less than the expected distance from shape data for the Boltzmann ensemble of low energy structures (McCaskill's algorithm). First, we require some definitions. All secondary structures <inline-formula><inline-graphic xlink:href="pone.0045160.e211.jpg"/></inline-formula> considered in this section will be tacitly assumed to be secondary structures of the RNA molecule <inline-formula><inline-graphic xlink:href="pone.0045160.e212.jpg"/></inline-formula>. Each secondary structure <inline-formula><inline-graphic xlink:href="pone.0045160.e213.jpg"/></inline-formula> can be assigned a binary sequence <inline-formula><inline-graphic xlink:href="pone.0045160.e214.jpg"/></inline-formula> so that <inline-formula><inline-graphic xlink:href="pone.0045160.e215.jpg"/></inline-formula> if the nucleotide <inline-formula><inline-graphic xlink:href="pone.0045160.e216.jpg"/></inline-formula> is paired and <inline-formula><inline-graphic xlink:href="pone.0045160.e217.jpg"/></inline-formula> otherwise. Given experimental shape data yielding probabilities <inline-formula><inline-graphic xlink:href="pone.0045160.e218.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0045160.e219.jpg"/></inline-formula> is the probability that nucleotide <inline-formula><inline-graphic xlink:href="pone.0045160.e220.jpg"/></inline-formula> is <italic>unpaired</italic>, the distance of <inline-formula><inline-graphic xlink:href="pone.0045160.e221.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0045160.e222.jpg"/></inline-formula> is defined by:<disp-formula id="pone.0045160.e223"><graphic xlink:href="pone.0045160.e223.jpg" position="anchor" orientation="portrait"/><label>(9)</label></disp-formula>The shape <italic>weight</italic> of <inline-formula><inline-graphic xlink:href="pone.0045160.e224.jpg"/></inline-formula> is defined to be<disp-formula id="pone.0045160.e225"><graphic xlink:href="pone.0045160.e225.jpg" position="anchor" orientation="portrait"/><label>(10)</label></disp-formula>The weighted partition function then becomes<disp-formula id="pone.0045160.e226"><graphic xlink:href="pone.0045160.e226.jpg" position="anchor" orientation="portrait"/><label>(11)</label></disp-formula>The <italic>Boltzmann probability</italic>
<inline-formula><inline-graphic xlink:href="pone.0045160.e227.jpg"/></inline-formula> of secondary structure <inline-formula><inline-graphic xlink:href="pone.0045160.e228.jpg"/></inline-formula> is defined by<disp-formula id="pone.0045160.e229"><graphic xlink:href="pone.0045160.e229.jpg" position="anchor" orientation="portrait"/><label>(12)</label></disp-formula>and the <italic>weighted Boltzmann probabity</italic>
<inline-formula><inline-graphic xlink:href="pone.0045160.e230.jpg"/></inline-formula> is defined by<disp-formula id="pone.0045160.e231"><graphic xlink:href="pone.0045160.e231.jpg" position="anchor" orientation="portrait"/><label>(13)</label></disp-formula>Define the <italic>critical distance</italic>
<inline-formula><inline-graphic xlink:href="pone.0045160.e232.jpg"/></inline-formula> by<disp-formula id="pone.0045160.e233"><graphic xlink:href="pone.0045160.e233.jpg" position="anchor" orientation="portrait"/><label>(14)</label></disp-formula>Note that <inline-formula><inline-graphic xlink:href="pone.0045160.e234.jpg"/></inline-formula> does not depend on any particular secondary structure <inline-formula><inline-graphic xlink:href="pone.0045160.e235.jpg"/></inline-formula>, although it does depend on <inline-formula><inline-graphic xlink:href="pone.0045160.e236.jpg"/></inline-formula> and of course the input RNA sequence <inline-formula><inline-graphic xlink:href="pone.0045160.e237.jpg"/></inline-formula>. It follows from definitions that for any secondary structure <inline-formula><inline-graphic xlink:href="pone.0045160.e238.jpg"/></inline-formula>,<disp-formula id="pone.0045160.e239"><graphic xlink:href="pone.0045160.e239.jpg" position="anchor" orientation="portrait"/><label>(15)</label></disp-formula>and strict inequalities hold as well. Indeed, since the exponential function is increasing, we have <inline-formula><inline-graphic xlink:href="pone.0045160.e240.jpg"/></inline-formula> if and only if<disp-formula id="pone.0045160.e241"><graphic xlink:href="pone.0045160.e241.jpg" position="anchor" orientation="portrait"/></disp-formula>Multiplying each side by <inline-formula><inline-graphic xlink:href="pone.0045160.e242.jpg"/></inline-formula>, the above inequality can be written as<disp-formula id="pone.0045160.e243"><graphic xlink:href="pone.0045160.e243.jpg" position="anchor" orientation="portrait"/></disp-formula>from which (15) follows. Similarly,<disp-formula id="pone.0045160.e244"><graphic xlink:href="pone.0045160.e244.jpg" position="anchor" orientation="portrait"/><label>(16)</label></disp-formula>
</p>
      <p>Next, define the expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e245.jpg"/></inline-formula> between <inline-formula><inline-graphic xlink:href="pone.0045160.e246.jpg"/></inline-formula>, obtained by normalizing shape data, and the ensemble of low energy structures as follows:<disp-formula id="pone.0045160.e247"><graphic xlink:href="pone.0045160.e247.jpg" position="anchor" orientation="portrait"/><label>(17)</label></disp-formula>Similarly, define the SHAPE <italic>weighted expected distance</italic>
<inline-formula><inline-graphic xlink:href="pone.0045160.e248.jpg"/></inline-formula> between <inline-formula><inline-graphic xlink:href="pone.0045160.e249.jpg"/></inline-formula> and the ensemble of low energy structures by<disp-formula id="pone.0045160.e250"><graphic xlink:href="pone.0045160.e250.jpg" position="anchor" orientation="portrait"/><label>(18)</label></disp-formula>Let <inline-formula><inline-graphic xlink:href="pone.0045160.e251.jpg"/></inline-formula> represent the sorted distances <inline-formula><inline-graphic xlink:href="pone.0045160.e252.jpg"/></inline-formula> between all secondary structures of <inline-formula><inline-graphic xlink:href="pone.0045160.e253.jpg"/></inline-formula>, for given normalized <sc>shape</sc> data <inline-formula><inline-graphic xlink:href="pone.0045160.e254.jpg"/></inline-formula>. Here <inline-formula><inline-graphic xlink:href="pone.0045160.e255.jpg"/></inline-formula> denotes the total number of secondary structures. Note that there may be many distinct secondary structures that have a given distance <inline-formula><inline-graphic xlink:href="pone.0045160.e256.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0045160.e257.jpg"/></inline-formula>; i.e. possibly many distinct <inline-formula><inline-graphic xlink:href="pone.0045160.e258.jpg"/></inline-formula> for which <inline-formula><inline-graphic xlink:href="pone.0045160.e259.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0045160.e260.jpg"/></inline-formula> be the largest index <inline-formula><inline-graphic xlink:href="pone.0045160.e261.jpg"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="pone.0045160.e262.jpg"/></inline-formula>; it follows that <inline-formula><inline-graphic xlink:href="pone.0045160.e263.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e264.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0045160.e265.jpg"/></inline-formula> [resp. <inline-formula><inline-graphic xlink:href="pone.0045160.e266.jpg"/></inline-formula>] consist of those secondary structures <inline-formula><inline-graphic xlink:href="pone.0045160.e267.jpg"/></inline-formula>, such that <inline-formula><inline-graphic xlink:href="pone.0045160.e268.jpg"/></inline-formula> [resp. <inline-formula><inline-graphic xlink:href="pone.0045160.e269.jpg"/></inline-formula>]; in other words<disp-formula id="pone.0045160.e270"><graphic xlink:href="pone.0045160.e270.jpg" position="anchor" orientation="portrait"/></disp-formula>
<disp-formula id="pone.0045160.e271"><graphic xlink:href="pone.0045160.e271.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      <p>T<sc>heorem</sc> 1: For any given RNA sequence <inline-formula><inline-graphic xlink:href="pone.0045160.e272.jpg"/></inline-formula> and normalized SHAPE data <inline-formula><inline-graphic xlink:href="pone.0045160.e273.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e274.jpg"/></inline-formula>.</p>
      <p>P<sc>roof</sc>:<disp-formula id="pone.0045160.e275"><graphic xlink:href="pone.0045160.e275.jpg" position="anchor" orientation="portrait"/></disp-formula>
<disp-formula id="pone.0045160.e276"><graphic xlink:href="pone.0045160.e276.jpg" position="anchor" orientation="portrait"/></disp-formula>
<disp-formula id="pone.0045160.e277"><graphic xlink:href="pone.0045160.e277.jpg" position="anchor" orientation="portrait"/></disp-formula>To justify the inequality, note that for <inline-formula><inline-graphic xlink:href="pone.0045160.e278.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e279.jpg"/></inline-formula>, hence for <inline-formula><inline-graphic xlink:href="pone.0045160.e280.jpg"/></inline-formula>, we have <inline-formula><inline-graphic xlink:href="pone.0045160.e281.jpg"/></inline-formula>. On the other hand, for <inline-formula><inline-graphic xlink:href="pone.0045160.e282.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e283.jpg"/></inline-formula>, hence for <inline-formula><inline-graphic xlink:href="pone.0045160.e284.jpg"/></inline-formula>, we also have <inline-formula><inline-graphic xlink:href="pone.0045160.e285.jpg"/></inline-formula>. Finally, the last line follows from the fact that <inline-formula><inline-graphic xlink:href="pone.0045160.e286.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e287.jpg"/></inline-formula> are both probability distributions, hence <inline-formula><inline-graphic xlink:href="pone.0045160.e288.jpg"/></inline-formula>. This completes the proof that <inline-formula><inline-graphic xlink:href="pone.0045160.e289.jpg"/></inline-formula>.</p>
      <p>The above theorem can be generalized; however, we first require some notation. The weighted partition function <inline-formula><inline-graphic xlink:href="pone.0045160.e290.jpg"/></inline-formula>, weighted Boltzmann probability <inline-formula><inline-graphic xlink:href="pone.0045160.e291.jpg"/></inline-formula>, and weighted expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e292.jpg"/></inline-formula> were respectively defined in <xref ref-type="disp-formula" rid="pone.0045160.e226">Equations (11)</xref>,<xref ref-type="disp-formula" rid="pone.0045160.e231">(13)</xref>, and <xref ref-type="disp-formula" rid="pone.0045160.e250">(18)</xref>. When we wish to make the weighting parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e293.jpg"/></inline-formula> explicit, we instead write <inline-formula><inline-graphic xlink:href="pone.0045160.e294.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e295.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e296.jpg"/></inline-formula>. The following theorem shows that as the parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e297.jpg"/></inline-formula> increases, the expected distance to normalized shape data decreases:</p>
      <p>T<sc>heorem</sc> 2: For any given RNA sequence <inline-formula><inline-graphic xlink:href="pone.0045160.e298.jpg"/></inline-formula>, normalized SHAPE data <inline-formula><inline-graphic xlink:href="pone.0045160.e299.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e300.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e301.jpg"/></inline-formula>; moreover, strict inequalities hold as well.</p>
      <p>The proof the the theorem can be found in <xref ref-type="supplementary-material" rid="pone.0045160.s001">File S1</xref>.</p>
    </sec>
    <sec id="s2d">
      <title>Quadratic time computation of expected distance from shape data</title>
      <p>Given RNAsc parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e302.jpg"/></inline-formula>, recall that we defined the <inline-formula><inline-graphic xlink:href="pone.0045160.e303.jpg"/></inline-formula>-expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e304.jpg"/></inline-formula> between <inline-formula><inline-graphic xlink:href="pone.0045160.e305.jpg"/></inline-formula>, obtained by normalizing <sc>shape</sc> data, and the ensemble of low energy structures by<disp-formula id="pone.0045160.e306"><graphic xlink:href="pone.0045160.e306.jpg" position="anchor" orientation="portrait"/><label>(19)</label></disp-formula>In the main text, we wrote <inline-formula><inline-graphic xlink:href="pone.0045160.e307.jpg"/></inline-formula>, instead of <inline-formula><inline-graphic xlink:href="pone.0045160.e308.jpg"/></inline-formula> when <inline-formula><inline-graphic xlink:href="pone.0045160.e309.jpg"/></inline-formula>.</p>
      <p>In trying to compute <inline-formula><inline-graphic xlink:href="pone.0045160.e310.jpg"/></inline-formula> by definition, we seemingly require the sum over exponentially many secondary structures, or at least to approximate this sum by summing over a reprentative sample of structures, sampled from the low energy ensemble. This is not necessary. Here, we show how to compute <inline-formula><inline-graphic xlink:href="pone.0045160.e311.jpg"/></inline-formula> from the base pairing probabilities <inline-formula><inline-graphic xlink:href="pone.0045160.e312.jpg"/></inline-formula>, thus leading to a quadratic time algorithm.</p>
      <p>By definition,<disp-formula id="pone.0045160.e313"><graphic xlink:href="pone.0045160.e313.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0045160.e314.jpg"/></inline-formula> is denotes the indicator function. Now for any fixed <inline-formula><inline-graphic xlink:href="pone.0045160.e315.jpg"/></inline-formula>,<disp-formula id="pone.0045160.e316"><graphic xlink:href="pone.0045160.e316.jpg" position="anchor" orientation="portrait"/></disp-formula>is equal to<disp-formula id="pone.0045160.e317"><graphic xlink:href="pone.0045160.e317.jpg" position="anchor" orientation="portrait"/><label>(20)</label></disp-formula>Since <inline-formula><inline-graphic xlink:href="pone.0045160.e318.jpg"/></inline-formula>, it follows that <xref ref-type="disp-formula" rid="pone.0045160.e317">Equation (20)</xref> is equal to<disp-formula id="pone.0045160.e319"><graphic xlink:href="pone.0045160.e319.jpg" position="anchor" orientation="portrait"/><label>(21)</label></disp-formula>It follows that<disp-formula id="pone.0045160.e320"><graphic xlink:href="pone.0045160.e320.jpg" position="anchor" orientation="portrait"/></disp-formula>The values <inline-formula><inline-graphic xlink:href="pone.0045160.e321.jpg"/></inline-formula> are computed in quadratic time from McCaskill's algorithm, and subsequently stored in an array. If follows that <inline-formula><inline-graphic xlink:href="pone.0045160.e322.jpg"/></inline-formula> can be computed in quadratic time.</p>
      <p>Since RNAstructure of Deigan et al. <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> takes unnormalized <sc>shape</sc> data in the range from <inline-formula><inline-graphic xlink:href="pone.0045160.e323.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0045160.e324.jpg"/></inline-formula>, we define the expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e325.jpg"/></inline-formula> between <italic>unnormalized</italic> shape data and structure <inline-formula><inline-graphic xlink:href="pone.0045160.e326.jpg"/></inline-formula> to be<disp-formula id="pone.0045160.e327"><graphic xlink:href="pone.0045160.e327.jpg" position="anchor" orientation="portrait"/><label>(22)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0045160.e328.jpg"/></inline-formula> denotes the unnormalized shape data at position <inline-formula><inline-graphic xlink:href="pone.0045160.e329.jpg"/></inline-formula>. The expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e330.jpg"/></inline-formula> between <italic>unnormalized</italic>
<sc>shape</sc> data and the ensemble of low energy structures computed by RNAstructure with incorporated shape data by<disp-formula id="pone.0045160.e331"><graphic xlink:href="pone.0045160.e331.jpg" position="anchor" orientation="portrait"/><label>(23)</label></disp-formula>Scrutiny of the proof just given yields an efficient computation of<disp-formula id="pone.0045160.e332"><graphic xlink:href="pone.0045160.e332.jpg" position="anchor" orientation="portrait"/><label>(24)</label></disp-formula>
</p>
      <p>Since the approach in <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> only considers stacked base pairs, it seems very likely that <inline-formula><inline-graphic xlink:href="pone.0045160.e333.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0045160.e334.jpg"/></inline-formula> denotes the expected distance from <sc>shape</sc> data for the Boltzmann ensemble of low energy structures after the incorporation of the <sc>shape</sc> pseudo energy terms as in <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>. Indeed, the expected distance we obtain between <italic>u</italic>nnormalized input shape data <inline-formula><inline-graphic xlink:href="pone.0045160.e335.jpg"/></inline-formula> and the computed probabilities <inline-formula><inline-graphic xlink:href="pone.0045160.e336.jpg"/></inline-formula> demonstrates this fact (see <xref ref-type="table" rid="pone-0045160-t001">Table 1</xref>).</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <p>In this section we present the benchmarking results for our algorithm RNAsc, a novel algorithm that recalibrates probing data as probabilities of nucleotides being unpaired and integrates this information as ‘soft constraints’ into the computation of minimum free energy secondary structure (see <xref ref-type="sec" rid="s2">Methods</xref>). Furthermore, we present a direct comparison of in-line probing data and shape data for yeast asp-tRNA.</p>
    <sec id="s3a">
      <title>Analysis of shape and in-line probing for structure prediction</title>
      <p>In order to directly characterize how well shape data reflects RNA secondary structure, we compared normalized <sc>shape</sc> data with base pairing status, as determined from crystallographic or NMR structures. We define <sc>shape</sc>
<italic>distance</italic> to equal the difference between <italic>normalized</italic>
<sc>shape</sc> reactivity (see <xref ref-type="sec" rid="s2">Methods</xref>), scaled from <inline-formula><inline-graphic xlink:href="pone.0045160.e337.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0045160.e338.jpg"/></inline-formula> (see section Normalization of shape) and binary base pairing status, with 0 for paired, 1 for unpaired, as derived from NMR or crystal structure. Using <sc>shape</sc> data for <italic>S. cerevisiae</italic> apartyl-tRNA <xref rid="pone.0045160-Wilkinson4" ref-type="bibr">[25]</xref>, HCV IRES <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>, bI3 group I intron p456 <xref rid="pone.0045160-Duncan1" ref-type="bibr">[33]</xref>, <italic>E. coli</italic> phenylalanine-tRNA <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref>, <italic>E. coli</italic> 5S RNA <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref>, and <italic>Fusobacterium nucleatum</italic> glycine riboswitch <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref>, we computed <sc>shape</sc> distance at each nucleotide. We observed that at many positions the <sc>shape</sc> distance has an absolute value greater than 0.5, thus indicating a significant difference between <sc>shape</sc> reactivity and the actual secondary structure. We refer to these positions as discrepancies. Over the the set of RNAs we examined, between <inline-formula><inline-graphic xlink:href="pone.0045160.e339.jpg"/></inline-formula> of the total data corresponded to such discrepancies (<xref ref-type="fig" rid="pone-0045160-g003">Fig. 3</xref> and <xref ref-type="supplementary-material" rid="pone.0045160.s001">File S1</xref>). Many factors can account for these discrepancies, including differences between the crystal structure and the ensemble of structures in solution, potential tertiary contacts, and differential reactivity to the chemical agent.</p>
      <fig id="pone-0045160-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Shape discrepancies.</title>
          <p>Distribution of shape discrepancies in yeast asp-tRNA <italic>(top)</italic> and <italic>E. coli</italic> phe-tRNA <italic>(bottom)</italic>. shape data for asp-tRNA [resp. phe-tRNA] from the Weeks Lab <xref rid="pone.0045160-Wilkinson4" ref-type="bibr">[25]</xref> [resp. Das Lab <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref>]. Using crystal structure as ‘gold standard’, red squares indicate locations where the absolute value of the difference of shape data and crystal structure (1 unpaired, 0 paired) exceeds 0.5. The plots on the right show the distribution of the discrepancy in shape as well as the error rate.</p>
        </caption>
        <graphic xlink:href="pone.0045160.g003"/>
      </fig>
      <p>To assess whether an alternative experimental method might yield data that more accurately reflects the secondary structure, we performed in-line probing on the <italic>S. cereviseae</italic> aspartyl-tRNA, for which shape data is available <xref rid="pone.0045160-Wilkinson4" ref-type="bibr">[25]</xref>. Like <sc>shape</sc>, in-line probing is a measure of backbone flexibility, where nucleotides in loops and other unpaired regions are generally more reactive than those that are base-paired <xref rid="pone.0045160-Soukup1" ref-type="bibr">[34]</xref>. In-line probing takes advantage of the spontaneous transesterification reactions responsible for RNA degradation that occur only when the <inline-formula><inline-graphic xlink:href="pone.0045160.e340.jpg"/></inline-formula>O from one nucleotide and the <inline-formula><inline-graphic xlink:href="pone.0045160.e341.jpg"/></inline-formula>O of the next align in a 180 degree conformation around the phosphate. This conformation does not occur in the A-form helix, thus protecting linkages within the helix from cleavage. In-line probing and shape are thus likely to yield similar, but not equivalent data <xref rid="pone.0045160-Dann1" ref-type="bibr">[35]</xref>.</p>
      <p>Our analysis indicates that in-line probing and shape reactivity profiles are quite distinct from one another. See <xref ref-type="fig" rid="pone-0045160-g004">Fig. 4</xref> for a comparison of shape and in-line probing profiles and <xref ref-type="supplementary-material" rid="pone.0045160.s001">File S1</xref> for shape reactivity profiles of other RNA molecules.</p>
      <fig id="pone-0045160-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Comparison of In-line probing and shape.</title>
          <p>Distribution of reactivities of data from in-line probing <italic>(A)</italic> and shape <italic>(B)</italic>. In-line probing reactivities were determined using SAFA <xref rid="pone.0045160-Das1" ref-type="bibr">[24]</xref> and then normalized to range <inline-formula><inline-graphic xlink:href="pone.0045160.e342.jpg"/></inline-formula>, in order to be comparable with shape reactivities. Histograms suggest that in-line probing signal is more diffuse than that from shape. The fraction of base-pairs in asp-tRNA is <inline-formula><inline-graphic xlink:href="pone.0045160.e343.jpg"/></inline-formula> which could be used to estimate the threshold shape moderate reactivity.</p>
        </caption>
        <graphic xlink:href="pone.0045160.g004"/>
      </fig>
      <p>The signal from in-line probing is significantly more diffuse than that from shape, and the error rate, as calculated above for shape, is significantly higher (<inline-formula><inline-graphic xlink:href="pone.0045160.e344.jpg"/></inline-formula> vs. <inline-formula><inline-graphic xlink:href="pone.0045160.e345.jpg"/></inline-formula>). Thus shape is a better reflection of secondary structure than in-line probing, at least in the case of asp-tRNA.</p>
      <p>Integrating shape and in-line probing data into our new algorithm RNAsc also shows that shape has an edge over in-line probing. The structures predicted by RNAsc for yeast asp-tRNA using in-line probing and shape data are both identical to the crystal structure. However, one measure of the robustness of the data in the context of our secondary structure prediction algorithm RNAsc is the range of the scaling parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e346.jpg"/></inline-formula> over which the correct structure can be recovered. Recall that <inline-formula><inline-graphic xlink:href="pone.0045160.e347.jpg"/></inline-formula> is a weight parameter (see section Boltzmann Weights for details). We conducted a search for parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e348.jpg"/></inline-formula> for yeast asp-tRNA, using both in-line probing data and <sc>shape</sc> data. We found that when using in-line probing data, RNAsc produced the target structure for asp-tRNA only for a very narrow range of <inline-formula><inline-graphic xlink:href="pone.0045160.e349.jpg"/></inline-formula>, while when using shape data, this range was much larger (see <xref ref-type="fig" rid="pone-0045160-g005">Fig. 5</xref>). See <xref ref-type="fig" rid="pone-0045160-g006">Fig. 6</xref> for a heat map of in-line vs. shape reactivity for asp-tRNA.</p>
      <fig id="pone-0045160-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Optimal parameter value.</title>
          <p>The plots show heat maps displaying ppv (<inline-formula><inline-graphic xlink:href="pone.0045160.e350.jpg"/></inline-formula>) as a function of parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e351.jpg"/></inline-formula> for RNAsc with data from shape and in-line probing <italic>(asp-tRNA</italic>
<inline-formula><inline-graphic xlink:href="pone.0045160.e352.jpg"/></inline-formula>
<italic>)</italic>. Note the much larger area for good parameter choices when using shape data, rather than in-line probing data. This data suggests that shape data is more robust than in-line probing data, when used in computing MFE structure with RNAsc. Computations were done at 37<inline-formula><inline-graphic xlink:href="pone.0045160.e353.jpg"/></inline-formula>C.</p>
        </caption>
        <graphic xlink:href="pone.0045160.g005"/>
      </fig>
      <fig id="pone-0045160-g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Heat maps of in-line probing and shape.</title>
          <p>Heat maps illustrating differences between in-line probing <italic>(left)</italic> and shape <italic>(right)</italic> analysis of the yeast asp-tRNA. Nucleotides are colored corresponding to cumulative activities described in <xref ref-type="fig" rid="pone-0045160-g003">Figure 3</xref>, where the least reactive <inline-formula><inline-graphic xlink:href="pone.0045160.e354.jpg"/></inline-formula> of bases are black (<inline-formula><inline-graphic xlink:href="pone.0045160.e355.jpg"/></inline-formula> of bases are paired in the crystal structure), the most reactive <inline-formula><inline-graphic xlink:href="pone.0045160.e356.jpg"/></inline-formula> of bases are red, and the next most reactive <inline-formula><inline-graphic xlink:href="pone.0045160.e357.jpg"/></inline-formula> are yellow. Gray bases are bases for which there is no data available.</p>
        </caption>
        <graphic xlink:href="pone.0045160.g006"/>
      </fig>
      <p>In a second analysis, we compared the pointwise entropy at each nucleotide using no data, shape data, and in-line probing data (see <xref ref-type="fig" rid="pone-0045160-g007">Fig. 7</xref>). We observe that shape data decreases the average entropy more than in-line probing data. However, we also observe that there are positions where the in-line probing decreases the entropy more than shape, suggesting that combinations of different experimental approaches may be able to yield additional information.</p>
      <fig id="pone-0045160-g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g007</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Pointwise entropies.</title>
          <p>Pointwise entropy of yeast asp-tRNA, computed from RNAsc using shape data (red squares), in-line probing (blue diamonds), and using no probing data (black circles). Average pointwise entropies: 0.210 (shape data), 0.267 (in-line probing), 0.269 (no data). As expected, by integrating either shape or in-line probing data into RNAsc, the variability (entropy) decreases; however, it appears that variability (entropy) is decreased more by shape than by in-line probing data – again, suggesting that shape data is more robust than in-line probing data when used with RNAsc.</p>
        </caption>
        <graphic xlink:href="pone.0045160.g007"/>
      </fig>
    </sec>
    <sec id="s3b">
      <title>Validation of RNAsc</title>
      <p>Using <sc>shape</sc> data from the Weeks Lab, we tested RNAsc on aspartyl-tRNA from <italic>S. cerevisiae</italic>, domain II of the hepatitis C virus internal ribosomal entry site (HCV IRES), and the P546 domain of the bI3 group I intron, from <italic>E. coli</italic>. Additionally, using shape data from the Das Lab, we tested RNAsc on <italic>E. coli</italic> phenylalanine tRNA (phe-tRNA), <italic>E. coli</italic> 5S ribosomal RNA (5S rRNA), and the glycine riboswitch from <italic>F. nucleatum</italic> with PDB code 3P49. As ‘gold standard’ structures, we used NMR structure for P546, and X-ray structures for remaining RNAs. Parameter used for RNAsc is <inline-formula><inline-graphic xlink:href="pone.0045160.e358.jpg"/></inline-formula>, determined by search (see <xref ref-type="fig" rid="pone-0045160-g005">Fig. 5</xref>) to optimize sensitivity (proportion of true positives that are correctly identified) and positive predictive value (proportion of positive results that are true positives). Slippage of <inline-formula><inline-graphic xlink:href="pone.0045160.e359.jpg"/></inline-formula>
<xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>, <xref rid="pone.0045160-Mathews3" ref-type="bibr">[36]</xref> is <italic>not</italic> allowed, contrary to benchmarking results of some authors. Here, slippage <xref rid="pone.0045160-Mathews3" ref-type="bibr">[36]</xref> means that if base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e360.jpg"/></inline-formula> is in the true structure, then the base pair <inline-formula><inline-graphic xlink:href="pone.0045160.e361.jpg"/></inline-formula> is counted as “correctly” predicted, if one of the base pairs <inline-formula><inline-graphic xlink:href="pone.0045160.e362.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e363.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e364.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e365.jpg"/></inline-formula> appears in the predicted structure – we do <italic>not</italic> allow slippage in the results of this paper.</p>
      <p><xref ref-type="table" rid="pone-0045160-t001">Table 1</xref> presents a comparison of RNAsc with RNAstructure, including a comparison of structural variation in the ensemble of low energy structures. This variation is computed by pointwise entropy and Morgan-Higgs structural diversity (see <xref ref-type="sec" rid="s2">Methods</xref>). The table shows that the low energy ensemble, as computed by RNAsc with integration of shape data, has intermediate variation between that computed by RNAstructure with and without shape data. The fact that RNAstructure with incorporated shape data computes an ensemble of structures with less variation appears to be expected, given the parameters used in the algorithm of Deigan et al. <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>.</p>
      <p>As explained in Deigan et al. <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>, RNAstructure incorporates shape data by including a pseudo free energy term<disp-formula id="pone.0045160.e366"><graphic xlink:href="pone.0045160.e366.jpg" position="anchor" orientation="portrait"/><label>(25)</label></disp-formula>for a nucleotide position <inline-formula><inline-graphic xlink:href="pone.0045160.e367.jpg"/></inline-formula>. In the source code RNAstructure, it is clear that the pseudo free energy term <inline-formula><inline-graphic xlink:href="pone.0045160.e368.jpg"/></inline-formula> is applied <italic>only</italic> for positions <inline-formula><inline-graphic xlink:href="pone.0045160.e369.jpg"/></inline-formula> involved in a stacked base pair. The optimal values for slope <inline-formula><inline-graphic xlink:href="pone.0045160.e370.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e371.jpg"/></inline-formula>-intercept <inline-formula><inline-graphic xlink:href="pone.0045160.e372.jpg"/></inline-formula> are obtained by grid search when maximizing structure prediction accuracy on certain known structures. Optimal slope and intercept values reported in <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref> are <inline-formula><inline-graphic xlink:href="pone.0045160.e373.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e374.jpg"/></inline-formula> kcal/mol.</p>
      <p>We now show that the smaller structural variation in the RNAstructure ensemble appears to be an artifact of the magnitude of parameters <inline-formula><inline-graphic xlink:href="pone.0045160.e375.jpg"/></inline-formula>. Consider the two most extreme cases: (1) position <inline-formula><inline-graphic xlink:href="pone.0045160.e376.jpg"/></inline-formula> in structure <inline-formula><inline-graphic xlink:href="pone.0045160.e377.jpg"/></inline-formula> is base-paired, but shape reactivity is a maximum, (2) position <inline-formula><inline-graphic xlink:href="pone.0045160.e378.jpg"/></inline-formula> in structure <inline-formula><inline-graphic xlink:href="pone.0045160.e379.jpg"/></inline-formula> is not paired, but shape reactivity is a minimum.</p>
      <p>Suppose that position <inline-formula><inline-graphic xlink:href="pone.0045160.e380.jpg"/></inline-formula> is in a base-stacked region but the shape reactivity at position <inline-formula><inline-graphic xlink:href="pone.0045160.e381.jpg"/></inline-formula> is <inline-formula><inline-graphic xlink:href="pone.0045160.e382.jpg"/></inline-formula>, a maximum, though there are sometimes shape reactivities larger than <inline-formula><inline-graphic xlink:href="pone.0045160.e383.jpg"/></inline-formula>. With the default parameters for <inline-formula><inline-graphic xlink:href="pone.0045160.e384.jpg"/></inline-formula>, the pseudo free energy contribution of RNAstructure is <inline-formula><inline-graphic xlink:href="pone.0045160.e385.jpg"/></inline-formula>, an energetic penalty. This penalty is quite large, given the fact that the largest (in absolute value) free energy contribution for base stacking is <inline-formula><inline-graphic xlink:href="pone.0045160.e386.jpg"/></inline-formula> kcal/mol <xref rid="pone.0045160-Turner1" ref-type="bibr">[37]</xref>. Under the same assumptions, RNAsc would have a pseudo free energy of <inline-formula><inline-graphic xlink:href="pone.0045160.e387.jpg"/></inline-formula>, also an energetic penalty, yet much smaller than that of RNAstructure.</p>
      <p>Suppose now that position <inline-formula><inline-graphic xlink:href="pone.0045160.e388.jpg"/></inline-formula> is in a loop region but the shape reactivity at position <inline-formula><inline-graphic xlink:href="pone.0045160.e389.jpg"/></inline-formula> is <inline-formula><inline-graphic xlink:href="pone.0045160.e390.jpg"/></inline-formula>, the least possible value. Using the default parameters <inline-formula><inline-graphic xlink:href="pone.0045160.e391.jpg"/></inline-formula> kcal/mol, the pseudo free energy contribution of RNAstructure, <italic>if</italic> applied in this case, would then be <inline-formula><inline-graphic xlink:href="pone.0045160.e392.jpg"/></inline-formula>. This value, paradoxically, would be an energetic bonus, although the predicted structure disagrees with shape data! It is presumably for this reason that Deigan et al. do not apply any pseudo free energy term to nucleotide positions <inline-formula><inline-graphic xlink:href="pone.0045160.e393.jpg"/></inline-formula> located in a loop region. In contrast, under the same assumptions, RNAsc would have a pseudo free energy of <inline-formula><inline-graphic xlink:href="pone.0045160.e394.jpg"/></inline-formula>, again a penalty – moreover, the same penalty of <inline-formula><inline-graphic xlink:href="pone.0045160.e395.jpg"/></inline-formula> kcal/mol is applied in each of the cases (1) and (2) just discussed.</p>
      <p>From these illustrative examples, it is suggestive that structural <italic>variability</italic>, as measured by pointwise entropy and structural diversity, in the low energy ensemble calculated by RNAstructure is <italic>higher</italic> than that of the RNAsc low energy ensemble, due to the magnitude of the parameters <inline-formula><inline-graphic xlink:href="pone.0045160.e396.jpg"/></inline-formula> used in RNAsc.</p>
      <p>Note that the average relative decrease in expected distance of the computed probabilities to shape data from RNAstructure to RNAsc is <inline-formula><inline-graphic xlink:href="pone.0045160.e397.jpg"/></inline-formula>. In fact the expected distance of the computed probabilities to shape <italic>increases</italic> for RNAstructure and <italic>decreases</italic> for RNAsc after the incorporation of shape in each case. Apart from the ‘self-consistent’ nature of our algorithm, not shared by RNAstructure, the demonstrable expected distance of the computed probabilities to shape data provided by our approach, indicates that we account more fully for the shape data. It is worth mentioning that for higher values of <inline-formula><inline-graphic xlink:href="pone.0045160.e398.jpg"/></inline-formula> the predicted Boltzmann probabilities <inline-formula><inline-graphic xlink:href="pone.0045160.e399.jpg"/></inline-formula> can be made to agree very closely with the experimental values <inline-formula><inline-graphic xlink:href="pone.0045160.e400.jpg"/></inline-formula> (strong self-consistency). <xref ref-type="fig" rid="pone-0045160-g008">Fig. 8</xref> shows a plot of the expected distance of the computed probabilities to shape data for increasing values of <inline-formula><inline-graphic xlink:href="pone.0045160.e401.jpg"/></inline-formula> – see <xref ref-type="sec" rid="s2">Methods</xref> for a proof. Note however that since the experimental probabilities (or normalized shape values) are generally not in perfect agreement with the native structure, we took the closeness of the predicted structure to the native structure as a measure for choosing the parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e402.jpg"/></inline-formula>.</p>
      <fig id="pone-0045160-g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g008</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Expected distance of predicted probabilities with normalized shape data.</title>
          <p>The figure shows a plot of the expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e403.jpg"/></inline-formula> between normalized experimental shape values <inline-formula><inline-graphic xlink:href="pone.0045160.e404.jpg"/></inline-formula> and the low energy Boltzmann ensemble, as computed by RNAsc. The <inline-formula><inline-graphic xlink:href="pone.0045160.e405.jpg"/></inline-formula>-axis depicts increasing values of RNAsc parameter <inline-formula><inline-graphic xlink:href="pone.0045160.e406.jpg"/></inline-formula>, while the <inline-formula><inline-graphic xlink:href="pone.0045160.e407.jpg"/></inline-formula>-axis depicts expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e408.jpg"/></inline-formula>. The curves confirm the statement of Theorem 2, which states that as <inline-formula><inline-graphic xlink:href="pone.0045160.e409.jpg"/></inline-formula> increases, the expected distance <inline-formula><inline-graphic xlink:href="pone.0045160.e410.jpg"/></inline-formula> decreases. The figure also shows that for higher values of <inline-formula><inline-graphic xlink:href="pone.0045160.e411.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e412.jpg"/></inline-formula> can be made to agree very closely <inline-formula><inline-graphic xlink:href="pone.0045160.e413.jpg"/></inline-formula>. The expected distances of the predicted probabilities with <italic>u</italic>nnormalized shape values for RNAstructure are <inline-formula><inline-graphic xlink:href="pone.0045160.e414.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0045160.e415.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0045160.e416.jpg"/></inline-formula> for asp-tRNA, HCV, and P546 respectively using optimal parameter values (<inline-formula><inline-graphic xlink:href="pone.0045160.e417.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0045160.e418.jpg"/></inline-formula>).</p>
        </caption>
        <graphic xlink:href="pone.0045160.g008"/>
      </fig>
      <p>We believe RNAsc may be helpful long-term in elucidating the nature of discrepancies between shape and the native structure. As in any experimental protocol, there is a Gaussian error term; however, our data (not shown) indicates that shape discrepancy is positively correlated with high pointwise entropy. Indeed, it seems plausible that a region of the RNA molecule which fluctuates due to thermal motion, thus having higher pointwise entropy, might entail a more variable accessibility for the chemical probe NMIA, thus causing a greater shape discrepancy with the X-ray structure. The program RNAsc allows the user to determine such regions of high pointwise entropy, and to see the structure variability in that region by sampling. It may be possible to confirm or refute our hypothesis concerning the non-Gaussian nature of shape discrepancy (“error”), by performing additional shape probing experiments at lower temperatures. It follows that RNAsc could prove to be a valuable tool in this line of research.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>Widespread accessibility of quantitative RNA structural mapping techniques and medium- to high-throughput quantification of the data have motivated the development of computational tools to predict structures from such information. The integration of experimental data as “constraints” in the thermodynamic algorithm when computing minimum free energy (MFE) structure can significantly improve the accuracy of RNA structure prediction. However, such methods are also dependent on the quality of the data used for the constraints <xref rid="pone.0045160-Kladwang1" ref-type="bibr">[26]</xref>. It is worth mentioning that the errors in our algorithm RNAsc are directly related to the errors in the experimental data. <xref ref-type="fig" rid="pone-0045160-g009">Fig. 9</xref> shows shape distance to the native structure at the nucleotides where the secondary structure is predicted incorrectly for glycine riboswitch. As can be seen, the shape distances to the native structure are very large for <inline-formula><inline-graphic xlink:href="pone.0045160.e419.jpg"/></inline-formula> out of the <inline-formula><inline-graphic xlink:href="pone.0045160.e420.jpg"/></inline-formula> incorrectly predicted positions. Thus the prediction errors are due to the quality of the input data rather than limitations of the algorithm.</p>
    <fig id="pone-0045160-g009" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0045160.g009</object-id>
      <label>Figure 9</label>
      <caption>
        <title>Errors in the prediction of the secondary structure of glycine riboswitch by RNAsc.</title>
        <p>On the <inline-formula><inline-graphic xlink:href="pone.0045160.e421.jpg"/></inline-formula>-axis, nucleotide positions are displayed, where the algorithm predicts the structure incorrectly. The <inline-formula><inline-graphic xlink:href="pone.0045160.e422.jpg"/></inline-formula>-axis represents the shape distance to the native structure at the given nucleotide. A shape distance with absolute value <inline-formula><inline-graphic xlink:href="pone.0045160.e423.jpg"/></inline-formula> indicates an error.</p>
      </caption>
      <graphic xlink:href="pone.0045160.g009"/>
    </fig>
    <p>Two recent approaches towards overcoming this error include the iterative ‘sample and select’ approach of Quarrier et al. <xref rid="pone.0045160-Quarrier1" ref-type="bibr">[38]</xref> and the ‘mutate and map’ strategy of Kladwang et al. <xref rid="pone.0045160-Kladwang2" ref-type="bibr">[30]</xref>. The ‘sample and select’ strategy involves multiple mapping, followed by a simple filtering step, which removes the suboptimal structures (sampled from the low energy ensemble using the Sfold software <xref rid="pone.0045160-Ding1" ref-type="bibr">[39]</xref>) that are incompatible with mapping data. In contrast, the ‘mutate and map’ strategy involves high-throughput structural probing of all single-nucleotide mutants, resulting in 2D shape data, followed by a computation of the minimum free energy structure, in which pseudo-energy base stacking terms have been added that correspond to Z-scores from 2D shape data. Although high-throughput ‘mutate and map’ strategies <xref rid="pone.0045160-Kladwang2" ref-type="bibr">[30]</xref>, using either shape -CE (capillary electrophoresis) or shape -Seq <xref rid="pone.0045160-Lucks1" ref-type="bibr">[40]</xref>, provide very high secondary structure prediction accuracy, such methods also represent a significant increase in both experimental manipulation and cost that is often not warranted for more specific studies. Especially in such cases, we believe that our method, RNAsc, may be the tool of choice. On the other hand, the ‘mutate and map’ strategy can be normalized in such a way as to obtain base pairing probabilities. Since shape experiments can potentially probe tertiary interactions (as mentioned in the previous section), not only could we obtain probabilities for secondary interactions and canonical base pairs, but also for tertiary and long range interactions as well as non-canonical base pairs. These probabilities can later be used as input to algorithms such as Probknot <xref rid="pone.0045160-Bellaousov1" ref-type="bibr">[41]</xref> or even to a Maximum Weight Matching algorithm <xref rid="pone.0045160-Tabaska1" ref-type="bibr">[42]</xref> to predict pseudoknotted structures and non-canonical base pairs. We are currently pursuing this line of research.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0045160.s001">
      <label>File S1</label>
      <caption>
        <p>Supplementary information.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0045160.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank D.H. Mathews for discussions and for making available the source code of RNAstructure <xref rid="pone.0045160-Reuter1" ref-type="bibr">[43]</xref>, including the extension which incorporates base stacking pseudo-energies for shape data <xref rid="pone.0045160-Deigan1" ref-type="bibr">[15]</xref>. Thanks as well to R. Das for pointing us to the Stanford RNA Mapping Database <ext-link ext-link-type="uri" xlink:href="http://rmdb.stanford.edu/and">http://rmdb.stanford.edu/and</ext-link> for a preprint of his paper on the ‘mutate and map’ strategy. We would like to thank the anonymous referees for helpful remarks.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0045160-Washietl1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Washietl</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Sequence and structure analysis of noncoding RNAs</article-title>. <source>Methods in molecular biology (Clifton, NJ)</source>
<volume>609</volume>: <fpage>285</fpage>–<lpage>306</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Garey1">
      <label>2</label>
      <mixed-citation publication-type="other">Garey M, Johnson D (1990) Computers and Intractability: A Guide to the Theory of NPCompleteness. W.H. Freeman &amp; Co., 338 pages pp. New York.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Lyngso1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Lyngso</surname><given-names>RB</given-names></name>, <name><surname>Pedersen</surname><given-names>CN</given-names></name> (<year>2000</year>) <article-title>RNA pseudoknot prediction in energy-based models</article-title>. <source>J Comput Biol</source>
<volume>7</volume>: <fpage>409</fpage>–<lpage>427</lpage>.<pub-id pub-id-type="pmid">11108471</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Zuker1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Stiegler</surname><given-names>P</given-names></name> (<year>1981</year>) <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>. <source>Nucleic Acids Res</source>
<volume>9</volume>: <fpage>133</fpage>–<lpage>148</lpage>.<pub-id pub-id-type="pmid">6163133</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Tinoco1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Tinoco</surname><given-names>JI</given-names></name>, <name><surname>Bustamante</surname><given-names>C</given-names></name> (<year>1999</year>) <article-title>How RNA folds</article-title>. <source>Journal of Molecular Biology</source>
<volume>293</volume>: <fpage>271</fpage>–<lpage>281</lpage>.<pub-id pub-id-type="pmid">10550208</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Banerjee1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Banerjee</surname><given-names>A</given-names></name>, <name><surname>Jaeger</surname><given-names>J</given-names></name>, <name><surname>Turner</surname><given-names>D</given-names></name> (<year>1993</year>) <article-title>Thermal unfolding of a group I ribozyme: The lowtemperature transition is primarily disruption of tertiary structure</article-title>. <source>Biochemistry</source>
<volume>32</volume>: <fpage>153</fpage>–<lpage>163</lpage>.<pub-id pub-id-type="pmid">8418835</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Cho1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Cho</surname><given-names>SS</given-names></name>, <name><surname>Pincus</surname><given-names>DL</given-names></name>, <name><surname>Thirumalai</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Assembly mechanisms of RNA pseudoknots are determined by the stabilities of constituent secondary structures</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>106</volume>: <fpage>17349</fpage>–<lpage>17354</lpage>.<pub-id pub-id-type="pmid">19805055</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Bailor1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bailor</surname><given-names>MH</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>, <name><surname>Al-Hashimi</surname><given-names>HM</given-names></name> (<year>2010</year>) <article-title>Topology links RNA secondary structure with global conformation, dynamics, and adaptation</article-title>. <source>Science</source>
<volume>327</volume>: <fpage>202</fpage>–<lpage>206</lpage>.<pub-id pub-id-type="pmid">20056889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Wilkinson1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wilkinson</surname><given-names>K</given-names></name>, <name><surname>Merino</surname><given-names>E</given-names></name>, <name><surname>Weeks</surname><given-names>K</given-names></name> (<year>2005</year>) <article-title>RNA SHAPE chemistry reveals nonhierarchical interactions dominate equilibrium structural transitions in tRNAAsp</article-title>. <source>J Am Chem Soc</source>
<volume>127</volume>: <fpage>4659</fpage>–<lpage>4667</lpage>.<pub-id pub-id-type="pmid">15796531</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Zuker2">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Zuker</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Mfold web server for nucleic acid folding and hybridization prediction</article-title>. <source>Nucleic Acids Res</source>
<volume>31</volume> (<issue>13</issue>) <fpage>3406</fpage>–<lpage>3415</lpage>.<pub-id pub-id-type="pmid">12824337</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Hofacker1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Hofacker</surname><given-names>I</given-names></name>, <name><surname>Fontana</surname><given-names>W</given-names></name>, <name><surname>Stadler</surname><given-names>P</given-names></name>, <name><surname>Bonhoeffer</surname><given-names>L</given-names></name>, <name><surname>Tacker</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>1994</year>) <article-title>Fast folding and comparison of RNA secondary structures</article-title>. <source>Monatsch Chem</source>
<volume>125</volume>: <fpage>167</fpage>–<lpage>188</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Mathews1">
      <label>12</label>
      <mixed-citation publication-type="other">Mathews D, Turner D, Zuker M (2000) Secondary structure prediction. In: Beaucage S, Bergstrom D, Glick G, Jones R, editors, Current Protocols in Nucleic Acid Chemistry, New York: John Wiley &amp; Sons. pp. 11.2.1–11.2.10.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Xia1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Xia</surname><given-names>T</given-names></name>, <name><surname>SantaLucia</surname><given-names>J</given-names></name>, <name><surname>Burkard</surname><given-names>M</given-names></name>, <name><surname>Kierzek</surname><given-names>R</given-names></name>, <name><surname>Schroeder</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>1999</year>) <article-title>Thermodynamic parameters for an expanded nearest-neighbor model for formation of RNA duplexes with Watson-Crick base pairs</article-title>. <source>Biochemistry</source>
<volume>37</volume>: <fpage>14719</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Mathews2">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Mathews</surname><given-names>DH</given-names></name>, <name><surname>Disney</surname><given-names>MD</given-names></name>, <name><surname>Childs</surname><given-names>JL</given-names></name>, <name><surname>Schroeder</surname><given-names>SJ</given-names></name>, <name><surname>Zuker</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2004</year>) <article-title>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>101</volume>: <fpage>7287</fpage>–<lpage>7292</lpage>.<pub-id pub-id-type="pmid">15123812</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Deigan1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Deigan</surname><given-names>KE</given-names></name>, <name><surname>Li</surname><given-names>TW</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name>, <name><surname>Weeks</surname><given-names>KM</given-names></name> (<year>2009</year>) <article-title>Accurate SHAPE-directed RNA structure determination</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>106</volume>: <fpage>97</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">19109441</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Kertesz1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Kertesz</surname><given-names>M</given-names></name>, <name><surname>Wan</surname><given-names>Y</given-names></name>, <name><surname>Mazor</surname><given-names>E</given-names></name>, <name><surname>Rinn</surname><given-names>JL</given-names></name>, <name><surname>Nutter</surname><given-names>RC</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Genome-wide measurement of RNA secondary structure in yeast</article-title>. <source>Nature</source>
<volume>467</volume>: <fpage>103</fpage>–<lpage>107</lpage>.<pub-id pub-id-type="pmid">20811459</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Merino1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Merino</surname><given-names>EJ</given-names></name>, <name><surname>Wilkinson</surname><given-names>KA</given-names></name>, <name><surname>Coughlan</surname><given-names>JL</given-names></name>, <name><surname>Weeks</surname><given-names>KM</given-names></name> (<year>2005</year>) <article-title>RNA structure analysis at single nucleotide resolution by selective 2′-hydroxyl acylation and primer extension (SHAPE)</article-title>. <source>J Am Chem Soc</source>
<volume>127</volume>: <fpage>4223</fpage>–<lpage>4231</lpage>.<pub-id pub-id-type="pmid">15783204</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Wilkinson2">
      <label>18</label>
      <mixed-citation publication-type="other">Wilkinson K, Merino E, Weeks K (2006) Selective 20-hydroxyl acylation analyzed by primer extension (SHAPE): quantitative RNA structure analysis at single nucleotide resolution. NATURE PROTOCOLS-ELECTRONIC EDITION- 1: 1610.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Wilkinson3">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Wilkinson</surname><given-names>KA</given-names></name>, <name><surname>Gorelick</surname><given-names>RJ</given-names></name>, <name><surname>Vasa</surname><given-names>SM</given-names></name>, <name><surname>Guex</surname><given-names>N</given-names></name>, <name><surname>Rein</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>High-throughput SHAPE analysis reveals structures in HIV-1 genomic RNA strongly conserved across distinct biological states</article-title>. <source>PLoS Biol</source>
<volume>6</volume>: <fpage>e96</fpage>.<pub-id pub-id-type="pmid">18447581</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Ban1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Ban</surname><given-names>N</given-names></name>, <name><surname>Nissen</surname><given-names>P</given-names></name>, <name><surname>Hansen</surname><given-names>J</given-names></name>, <name><surname>Moore</surname><given-names>PB</given-names></name>, <name><surname>Steitz</surname><given-names>TA</given-names></name> (<year>2000</year>) <article-title>The complete atomic structure of the large ribosomal subunit at 2.4 A resolution</article-title>. <source>Science</source>
<volume>289</volume>: <fpage>905</fpage>–<lpage>920</lpage>.<pub-id pub-id-type="pmid">10937989</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Novikova1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Novikova</surname><given-names>IV</given-names></name>, <name><surname>Hennelly</surname><given-names>SP</given-names></name>, <name><surname>Sanbonmatsu</surname><given-names>KY</given-names></name> (<year>2012</year>) <article-title>Structural architecture of the human long non-coding RNA, steroid receptor RNA activator</article-title>. <source>Nucleic Acids Research</source>
</mixed-citation>
    </ref>
    <ref id="pone.0045160-Mandal1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Mandal</surname><given-names>M</given-names></name>, <name><surname>Boese</surname><given-names>B</given-names></name>, <name><surname>Barrick</surname><given-names>J</given-names></name>, <name><surname>Winkler</surname><given-names>W</given-names></name>, <name><surname>Breaker</surname><given-names>R</given-names></name> (<year>2003</year>) <article-title>Riboswitches control fundamental biochemical pathways in Bacillus subtilis and other bacteria</article-title>. <source>Cell</source>
<volume>113</volume> (<issue>5</issue>) <fpage>577</fpage>–<lpage>586</lpage>.<pub-id pub-id-type="pmid">12787499</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Meyer1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>M</given-names></name>, <name><surname>Roth</surname><given-names>A</given-names></name>, <name><surname>Chervin</surname><given-names>S</given-names></name>, <name><surname>Garcia</surname><given-names>G</given-names></name>, <name><surname>Breaker</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Confirmation of a second natural preQ1 aptamer class in Streptococcaceae bacteria</article-title>. <source>RNA</source>
<volume>14</volume>: <fpage>685</fpage>–<lpage>695</lpage>.<pub-id pub-id-type="pmid">18305186</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Das1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Das</surname><given-names>R</given-names></name>, <name><surname>Laederach</surname><given-names>A</given-names></name>, <name><surname>Pearlman</surname><given-names>SM</given-names></name>, <name><surname>Herschlag</surname><given-names>D</given-names></name>, <name><surname>Altman</surname><given-names>RB</given-names></name> (<year>2005</year>) <article-title>SAFA: semi-automated footprinting analysis software for high-throughput quantification of nucleic acid footprinting experiments</article-title>. <source>RNA</source>
<volume>11</volume>: <fpage>344</fpage>–<lpage>354</lpage>.<pub-id pub-id-type="pmid">15701734</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Wilkinson4">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Wilkinson</surname><given-names>K</given-names></name>, <name><surname>Merino</surname><given-names>E</given-names></name>, <name><surname>Weeks</surname><given-names>K</given-names></name> (<year>2005</year>) <article-title>RNA SHAPE chemistry reveals nonhierarchical interactions dominate equilibrium structural transitions in tRNAAsp transcripts</article-title>. <source>Journal of the American Chemical Society</source>
<volume>127</volume>: <fpage>4659</fpage>–<lpage>4667</lpage>.<pub-id pub-id-type="pmid">15796531</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Kladwang1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Kladwang</surname><given-names>W</given-names></name>, <name><surname>Vanlang</surname><given-names>CC</given-names></name>, <name><surname>Cordero</surname><given-names>P</given-names></name>, <name><surname>Das</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>Understanding the Errors of SHAPE-Directed RNA Structure Modeling</article-title>. <source>Biochemistry</source>
<volume>50</volume>: <fpage>8049</fpage>–<lpage>8056</lpage>.<pub-id pub-id-type="pmid">21842868</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-McCaskill1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>McCaskill</surname><given-names>J</given-names></name> (<year>1990</year>) <article-title>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</article-title>. <source>Biopolymers</source>
<volume>29</volume>: <fpage>1105</fpage>–<lpage>1119</lpage>.<pub-id pub-id-type="pmid">1695107</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Matthews1">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Matthews</surname><given-names>D</given-names></name>, <name><surname>Sabina</surname><given-names>J</given-names></name>, <name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Turner</surname><given-names>D</given-names></name> (<year>1999</year>) <article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</article-title>. <source>J Mol Biol</source>
<volume>288</volume>: <fpage>911</fpage>–<lpage>940</lpage>.<pub-id pub-id-type="pmid">10329189</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Forties1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Forties</surname><given-names>RA</given-names></name>, <name><surname>Bundschuh</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Modeling the interplay of single-stranded binding proteins and nucleic acid secondary structure</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>61</fpage>–<lpage>67</lpage>.<pub-id pub-id-type="pmid">19889798</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Kladwang2">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Kladwang</surname><given-names>W</given-names></name>, <name><surname>Cordero</surname><given-names>P</given-names></name>, <name><surname>Das</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>A mutate-and-map strategy accurately infers the base pairs of a 35-nucleotide model RNA</article-title>. <source>RNA</source>
<volume>17</volume>: <fpage>522</fpage>–<lpage>534</lpage>.<pub-id pub-id-type="pmid">21239468</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Zuker3">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Zuker</surname><given-names>M</given-names></name> (<year>1989</year>) <article-title>On finding all suboptimal foldings of an RNA molecule</article-title>. <source>Science</source>
<volume>244</volume>: <fpage>48</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">2468181</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Higgs1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Higgs</surname><given-names>PG</given-names></name> (<year>1996</year>) <article-title>Overlaps between RNA secondary structures</article-title>. <source>Physical Review Letters</source>
<volume>76</volume>: <fpage>704</fpage>–<lpage>707</lpage>.<pub-id pub-id-type="pmid">10061526</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Duncan1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Duncan</surname><given-names>C</given-names></name>, <name><surname>Weeks</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Shape analysis of long-range interactions reveals extensive and thermodynamically preferred misfolding in a fragile group i intron RNA</article-title>. <source>Biochemistry</source>
<volume>47</volume>: <fpage>8504</fpage>–<lpage>8513</lpage>.<pub-id pub-id-type="pmid">18642882</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Soukup1">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Soukup</surname><given-names>G</given-names></name>, <name><surname>Breaker</surname><given-names>R</given-names></name> (<year>1999</year>) <article-title>Relationship between internucleotide linkage geometry and the stability of RNA</article-title>. <source>RNA</source>
<volume>5</volume>: <fpage>1308</fpage>–<lpage>1325</lpage>.<pub-id pub-id-type="pmid">10573122</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Dann1">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Dann</surname><given-names>CE</given-names></name>, <name><surname>Wakeman</surname><given-names>C</given-names></name>, <name><surname>Sieling</surname><given-names>C</given-names></name>, <name><surname>Baker</surname><given-names>S</given-names></name>, <name><surname>Irnov</surname><given-names>I</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Structure and mechanism of a metal-sensing regulatory RNA</article-title>. <source>Cell</source>
<volume>130</volume>: <fpage>878</fpage>–<lpage>892</lpage>.<pub-id pub-id-type="pmid">17803910</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Mathews3">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Mathews</surname><given-names>D</given-names></name> (<year>2005</year>) <article-title>Predicting a set of minimal free energy RNA secondary structures common to two sequences</article-title>. <source>Bioinformatics</source>
<volume>15</volume>: <fpage>2246</fpage>–<lpage>2253</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Turner1">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>DH</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name> (<year>2010</year>) <article-title>Nndb: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic acids research</source>
<volume>38</volume>: <fpage>D280</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">19880381</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Quarrier1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Quarrier</surname><given-names>S</given-names></name>, <name><surname>Martin</surname><given-names>J</given-names></name>, <name><surname>Davis-Neulander</surname><given-names>L</given-names></name>, <name><surname>Beauregard</surname><given-names>A</given-names></name>, <name><surname>Laederach</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>Evaluation of the information content of RNA structure mapping data for secondary structure prediction</article-title>. <source>RNA</source>
<volume>16</volume>: <fpage>1108</fpage>–<lpage>1117</lpage>.<pub-id pub-id-type="pmid">20413617</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Ding1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>Y</given-names></name>, <name><surname>Chan</surname><given-names>CY</given-names></name>, <name><surname>Lawrence</surname><given-names>CE</given-names></name> (<year>2004</year>) <article-title>Sfold web server for statistical folding and rational design of nucleic acids</article-title>. <source>Nucleic Acids Res</source>
<volume>32</volume>: <fpage>0</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Lucks1">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Lucks</surname><given-names>JB</given-names></name>, <name><surname>Mortimer</surname><given-names>SA</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Luo</surname><given-names>S</given-names></name>, <name><surname>Aviran</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Multiplexed RNA structure characterization with selective 2′-hydroxyl acylation analyzed by primer extension sequencing (SHAPE-Seq)</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>
<volume>108</volume>: <fpage>11063</fpage>–<lpage>11068</lpage>.<pub-id pub-id-type="pmid">21642531</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Bellaousov1">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Bellaousov</surname><given-names>S</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name> (<year>2010</year>) <article-title>Probknot: fast prediction of RNA secondary structure including pseudoknots</article-title>. <source>RNA (New York, NY)</source>
<volume>16</volume>: <fpage>1870</fpage>–<lpage>1880</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0045160-Tabaska1">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tabaska</surname><given-names>J</given-names></name>, <name><surname>Cary</surname><given-names>R</given-names></name>, <name><surname>Gabow</surname><given-names>H</given-names></name>, <name><surname>Stormo</surname><given-names>G</given-names></name> (<year>1998</year>) <article-title>An RNA folding method capable of identifying pseudoknots and base triples</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>691</fpage>–<lpage>699</lpage>.<pub-id pub-id-type="pmid">9789095</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0045160-Reuter1">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Reuter</surname><given-names>JS</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name> (<year>2010</year>) <article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>: <fpage>129</fpage>.<pub-id pub-id-type="pmid">20230624</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
