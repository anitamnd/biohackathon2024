<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Immunol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Immunol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Immunol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Immunology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-3224</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9523212</article-id>
    <article-id pub-id-type="doi">10.3389/fimmu.2022.960985</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Immunology</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SEMA: Antigen B-cell conformational epitope prediction using deep transfer learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shashkova</surname>
          <given-names>Tatiana I.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1845345"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Umerenkov</surname>
          <given-names>Dmitriy</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salnikov</surname>
          <given-names>Mikhail</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strashnov</surname>
          <given-names>Pavel V.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Konstantinova</surname>
          <given-names>Alina V.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lebed</surname>
          <given-names>Ivan</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shcherbinin</surname>
          <given-names>Dmitriy N.</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Asatryan</surname>
          <given-names>Marina N.</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kardymon</surname>
          <given-names>Olga L.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1932814"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ivanisenko</surname>
          <given-names>Nikita V.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="fn001" ref-type="author-notes">
          <sup>*</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1840962"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Artificial Intelligence Research Institute</institution>, <addr-line>Moscow</addr-line>, <country>Russia</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Sber AI Lab</institution>, <addr-line>Moscow</addr-line>, <country>Russia</country></aff>
    <aff id="aff3"><sup>3</sup><institution>AI Center Block Services, Sber</institution>, <addr-line>Moscow</addr-line>, <country>Russia</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Federal Research Centre of Epidemiology and Microbiology named after Honorary Academician N. F. Gamaleya, Ministry of Health</institution>, <addr-line>Moscow</addr-line>, <country>Russia</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Laboratory of Computational Proteomics, Institute of Cytology and Genetics Siberian Branch of the Russian Academy of Sciences</institution>, <addr-line>Novosibirsk</addr-line>, <country>Russia</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Pedro A. Reche, Complutense University of Madrid, Spain</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Balachandran Manavalan, Sungkyunkwan University, South Korea; Manojit Bhattacharya, Fakir Mohan University, India</p>
      </fn>
      <corresp id="fn001">*Correspondence: Nikita V. Ivanisenko, <email xlink:href="mailto:ivanisenko@airi.net">ivanisenko@airi.net</email>
</corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Vaccines and Molecular Therapeutics, a section of the journal Frontiers in Immunology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>960985</elocation-id>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â© 2022 Shashkova, Umerenkov, Salnikov, Strashnov, Konstantinova, Lebed, Shcherbinin, Asatryan, Kardymon and Ivanisenko</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Shashkova, Umerenkov, Salnikov, Strashnov, Konstantinova, Lebed, Shcherbinin, Asatryan, Kardymon and Ivanisenko</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>One of the primary tasks in vaccine design and development of immunotherapeutic drugs is to predict conformational B-cell epitopes corresponding to primary antibody binding sites within the antigen tertiary structure. To date, multiple approaches have been developed to address this issue. However, for a wide range of antigens their accuracy is limited. In this paper, we applied the transfer learning approach using pretrained deep learning models to develop a model that predicts conformational B-cell epitopes based on the primary antigen sequence and tertiary structure. A pretrained protein language model, ESM-1v, and an inverse folding model, ESM-IF1, were fine-tuned to quantitatively predict antibody-antigen interaction features and distinguish between epitope and non-epitope residues. The resulting model called SEMA demonstrated the best performance on an independent test set with ROC AUC of 0.76 compared to peer-reviewed tools. We show that SEMA can quantitatively rank the immunodominant regions within the SARS-CoV-2 RBD domain. SEMA is available at <uri xlink:href="https://github.com/AIRI-Institute/SEMAi">https://github.com/AIRI-Institute/SEMAi</uri> and the web-interface <uri xlink:href="http://sema.airi.net">http://sema.airi.net</uri>.</p>
    </abstract>
    <kwd-group>
      <kwd>epitopes</kwd>
      <kwd>conformational B-cell epitopes</kwd>
      <kwd>protein language model</kwd>
      <kwd>GVP</kwd>
      <kwd>transfer learning</kwd>
      <kwd>transformer</kwd>
      <kwd>antibody - antigen complex</kwd>
    </kwd-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="1"/>
      <equation-count count="0"/>
      <ref-count count="22"/>
      <page-count count="11"/>
      <word-count count="4914"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1 Introduction</title>
    <p>Selection of B-cell antibodies specifically targeting the external antigen proteins is a natural immune response <italic>in vivo</italic>. Corresponding antibody binding sites are called conformational B-cell epitopes, and their knowledge is important for the effective design of peptide- and protein-based vaccines and development of immunotherapeutic drugs (<xref rid="B1" ref-type="bibr">1</xref>). To date, multiple methods have been developed using machine learning and other approaches to predict conformational B-cell epitopes within an antigen sequence. For example, widely used tools include SEPPA3, BepiPred2.0, PEPITO, Epitopa, DiscoTope, iBCE-EL and iLBE (<xref rid="B2" ref-type="bibr">2</xref>â<xref rid="B8" ref-type="bibr">8</xref>). These tools are commonly based on conventional machine learning methods, including linear regression, random forest, support vector machines, or combinations thereof. Physico-chemical and structural properties such as atomic coordinates, relative surface accessibility, protrusion index are extracted to train the model or to derive more complex features. Existing methods demonstrate good performance, however, improving the accuracy of prediction of conformational B-cell epitopes is still of great importance. Improving the performance of conformational epitope prediction tools is a challenging task, in particular due to the limited amount of available experimental data, uncertainties in defining epitope residues and extracting reliable antigen features for model construction.</p>
    <p>Deep learning approaches are increasingly often applied to protein analysis and design tasks. One such approach is transfer learning using latent space vector representations of amino acid residues extracted from large pretrained protein language models. These representations are able to implicitly encode context-dependent structural, functional and physico-chemical protein properties (<xref rid="B9" ref-type="bibr">9</xref>â<xref rid="B11" ref-type="bibr">11</xref>), which makes them attractive to develop new models to capture the immunogenic properties of amino acid residues.</p>
    <p>The ESM-1v model is one of the largest transformer-based protein language models trained in a self-supervised fashion (<xref rid="B9" ref-type="bibr">9</xref>). Recently, the ESM-IF1 model, a sequence-to-sequence transformer with invariant geometric input processing layers, has been developed to predict the protein sequence based on its tertiary fold (<xref rid="B12" ref-type="bibr">12</xref>). ESM-IF1 is based on GVP-GNN (<xref rid="B13" ref-type="bibr">13</xref>) and generic autoregressive encoder-decoder Transformer architectures (<xref rid="B14" ref-type="bibr">14</xref>). The ESM-IF1 model allows to solve a variety of tasks, including inverse protein folding problem and predicting the effect of mutations.</p>
    <p>In this paper we demonstrate that prediction of B-cell conformational epitopes can be significantly improved by applying transfer learning approaches using both pretrained ESM-1v and ESM-IF1 models. We fine-tuned ESM-1v and ESM-IF1 models to predict residues comprising B-cell epitopes by providing an interpretable score corresponding to the expected number of contacts of an amino acid residue with the target antibody.</p>
    <p>Taking into consideration uncertainties in the epitope residue assignment we generated a benchmark that included antigens with classified epitope residues based on two distance cut-off values. The first distance defines the presence of a contact between the antigen and antibody residues, while the second distance indicates if the residue is too distant from the epitope and should be ignored in metric calculations or model training. This allows to evaluate the robustness of the model to selected cut-off radii as well as exclude ambiguous labels from the training set.</p>
    <p>The best performing model across all benchmark tasks was called SEMA (Spatial Epitope Modelling with Artificial Intelligence). We evaluated SEMA against an independent retrospective benchmark composed of antigen residues with no prior information on antibody binding sites before the 2020 release date. SEMA was compared with BepiPred-2.0Â  (<xref rid="B3" ref-type="bibr">3</xref>), SEPPA3.0Â  (<xref rid="B2" ref-type="bibr">2</xref>), PEPITOÂ  (<xref rid="B4" ref-type="bibr">4</xref>), ElliProÂ  (<xref rid="B15" ref-type="bibr">15</xref>) and DiscoTope-2.0Â  (<xref rid="B6" ref-type="bibr">6</xref>) and outperformed these tools, demonstrating the highest ROC AUC value of 0.76. The SEMA prediction score was shown to correlate with the estimated immunogenicity of epitope residues according to statistical analysis of the interaction between SARS-CoV-2 RBD domain and target antibodies. SEMA is available as an online-tool and could be used for predicting B-cell conformational epitopes.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>2 Method</title>
    <sec id="s2_1">
      <title>2.1 Benchmark generation</title>
      <p>We generated a non-redundant conformational epitope data set based on the available data on antigen-antibody complexes in the PDB database. The pipeline used to generate the conformational epitope data set included the following steps:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) The ANARCI tool was used to screen sequences of protein structures published in the PDB database that comprise heavy and light chains of FabsÂ  (<xref rid="B16" ref-type="bibr">16</xref>).</p>
        </list-item>
        <list-item>
          <p>(2) Heavy/light Fab pairings were identified by calculating the distances between subunit residues corresponding to heavy and light chains, and only heavy and light chains with direct contacts of non-CDR regions within the distance of 4.5 Ã were considered as the heavy/light pair. CDR loops were defined using Chothia numbering based on annotation by the ANARCI tool. Identified Fab pairs were manually inspected to filter out artefacts.</p>
        </list-item>
        <list-item>
          <p>(3) Protein subunits that were not annotated as an antibody and had at least 5 residues interacting with antibody residues within the radius of 4.5 Ã with L1/L2/L3 or H1/H2/H3 CDR loops of antibodies were considered as antigens.</p>
        </list-item>
        <list-item>
          <p>(4) The contact number was calculated as the number of interactions of antigen residue atoms with antibody atoms within a sphere of radius <italic>R</italic>. For each antigen residue, we considered two options for estimating the contact number based on the selected radius <italic>R</italic>: in the first case, we calculated the number of atoms of antibody residues in contact with any atom of antigen residue <sub><italic>i</italic></sub> within the distance radius <italic>R</italic> (cn_atom). In the second case, we calculated the number of antibody residues in contact with any atom of antigen residue <sub><italic>i</italic></sub> within the distance radius <italic>R</italic> (cn_aa).</p>
        </list-item>
        <list-item>
          <p>(5) The calculated contact numbers were mapped on the complete amino acid sequence of the antigen. The complete sequence was extracted from PDBSeqRes records. All residues missing in the protein tertiary structure but present in the sequence were labelled as âunknownâ. âUnknownâ residues were excluded during model training.</p>
        </list-item>
        <list-item>
          <p>(6) To avoid redundancy, antigen sequences were clustered according to the degree of sequence identity (&gt; 95%) using MMseqs2 softwareÂ  (<xref rid="B17" ref-type="bibr">17</xref>). MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets. Sequences from the same cluster were aligned using MAFFTÂ  (<xref rid="B18" ref-type="bibr">18</xref>) and consensus epitope labels were assigned to the center of the cluster. For each residue in the reference sequence, the consensus contact number value was assigned as the maximum contact number observed among antigen-antibody complexes in the data set within an identity cluster.</p>
        </list-item>
        <list-item>
          <p>(7) Each antigen residue was assigned one of the following three labels. The âepitopeâ label was assigned according to the distance radius R1 within which at least one Fab pair residue was observed. The following values of <italic>R</italic>1 were considered: 4.5, 6.0 and 8.0 Ã. The âcloseâ label was assigned when the antigen residue was located outside <italic>R</italic>1 but within the radius <italic>R</italic>2 (<italic>R</italic>2 &gt; <italic>R</italic>1) of the closest antibody residue. The following values of <italic>R</italic>2 were considered: 12.0, 14.0 and 16.0 Ã or infinite. Remaining antigen residues were labeled âdistantâ. Both âcloseâ and âdistantâ residues were considered as non-epitope residues.</p>
        </list-item>
        <list-item>
          <p>(8) To fairly compare the precision of SEMA with other tools, we generated a retrospective data set. The data set was split into training and test sets according to the structure release date. The test set included structures that were first released in the PDB database after January 1, 2020 with no available homologues with a degree of sequence identity of &gt;70% before this date. The remaining antigens were divided into training and validation sets in a ratio of 9:1.</p>
        </list-item>
      </list>
    </sec>
    <sec id="s2_2">
      <title>2.2 SEMA-1D and SEMA-3D models construction</title>
      <p>SEMA-1D and SEMA-3D regression models were developed independently by adding a fully-connected linear layer on top of the ESM-1v and ESM-IF1 pretrained models, respectively. The last layers of the corresponding pretrained models provide amino acid residue representations with embedding size of 1280 and 512. The added fully-connected layer of each model takes an input from the last layer of the respective pretrained model and returns a one-dimensional vector. Each element of this vector is used to predict the log-scaled contact number value of corresponding amino acid residue position.</p>
      <p>We used the Adam optimizer and the masked mean squared error loss defined as a mean squared error loss function ignoring masked residues labeled as âdistantâ and âunknownâ residues class.</p>
      <p>SEMA-1D and SEMA-3D models were fine-tuned independently. The SEMA-1D model was trained for two epochs with a starting learning rate of 1e â 5 and linear learning rate decay. The SEMA-3D model was trained for two epochs with a starting learning rate of 1e â 4 and linear learning rate decay.</p>
      <p>The final models were obtained as an ensemble of five models fine-tuned independently from the same pretrained checkpoint.</p>
      <p>As a limitation, the original ESM-1v model was pretrained with a maximum sequence length of 1022. Accordingly, sequences longer than 1022 residues were trimmed from C-terminus to the length of 1022.</p>
    </sec>
    <sec id="s2_3">
      <title>2.3 Prediction using peer methods</title>
      <p>Protein sequences of the tested antigens were submitted to the BepiPred 2.0 server (<uri xlink:href="https://services.healthtech.dtu.dk/service.php?BepiPred-2.0">https://services.healthtech.dtu.dk/service.php?BepiPred-2.0</uri>), and the results were downloaded in csv format (50 per run). Discotope has a stand-alone implementation on Python and was run on our own serverÂ  (<xref rid="B6" ref-type="bibr">6</xref>). ElliPro has a stand-alone implementation on Java and was run on our own serverÂ  (<xref rid="B15" ref-type="bibr">15</xref>). Antigen structures were submitted to the BePro server, also known as PEPITO (<uri xlink:href="http://pepito.proteomics.ics.uci.edu">http://pepito.proteomics.ics.uci.edu</uri>). The same PDB identifiers and chains were selected for submission to the SEPPA3.0 prediction server (<uri xlink:href="http://lifecenter.sgst.cn/seppa/index.php">http://lifecenter.sgst.cn/seppa/index.php</uri>) and score files were retrieved and used for metrics evaluation. All tools were run with default options.</p>
    </sec>
    <sec id="s2_4">
      <title>2.4 Model performance metrics</title>
      <p>Performance of the models was assessed using AUC, Matthews correlation coefficient (MCC), positive predictive value (PPV) and sensitivity metrics. To calculate MCC, PPV and sensitivity we converted prediction values to a binary values applying a threshold. Threshold was set as an optimal cut-off provided by ROC AUC analysis corresponding to the highest true positive rate together with the lowest false positive rate. Taking into account imbalance between epitope and non-epitope classes in the data sets, PPV and sensitivity metrics were calculated for each class, and then their unweighted mean was found.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>3 Results</title>
    <sec id="s3_1">
      <title>3.1 Benchmark for predicting epitope features</title>
      <p>Crystallographic data on antigen-antibody structures are commonly used to identify conformational B-cell epitopes. In this paper, we screened the PDB database to select the antigen epitope residues interacting with the antibody. For each antigen residue, we calculated the contact number feature, which indicates the number of contacts of the antigen residue with antibody residues within the distance radius <italic>R</italic>1. The resulting benchmark generated using the pipeline (see Methods) contained a total of 4,739 records, with 884 antigen sequences clustered based on the degree of identity of 95%. The test set included 101 antigen sequences.</p>
      <p>Antigen residues were considered as epitope if the distance to the interacting antibody was lower than specified cut-off value (<italic>R</italic>1). <italic>R</italic>1 was selected in the range of 4.5, 6.0 and 8.0 Ã. The cut-off value of 4.5 Ã reflects the presence of direct interaction with antibody residues. Radius values of 6.0 Ã and 8.0 Ã additionally include residues involved in long-range interaction. It is well known that epitopes can be spatially distributed on the antigen structure and for some cases such experimental information might be missing. To take this into account, we split non-epitope residues based on the distance from the interacting antibody (<italic>R</italic>2) into âcloseâ (<italic>R</italic> &lt; <italic>R</italic>2) and âdistantâ (<italic>R</italic> &gt; <italic>R</italic>2) (<xref rid="f1" ref-type="fig"><bold>FigureÂ 1</bold></xref>). We selected <italic>R</italic>2 equal to either 12.0, 14.0 or 16.0 Ã to analyze the effect of epitope boundary region information on model accuracy.</p>
      <fig position="float" id="f1">
        <label>FigureÂ 1</label>
        <caption>
          <p>Epitope data set generation. For each residue, the contact number interaction feature was calculated, which corresponds to the log-scaled number of contacts of antigen residues with antibody residues within the radius <italic>R</italic>1. Antigen residues within <italic>R</italic>1 and <italic>R</italic>2 distance of the antibody were classified as non-epitope (brown color). Residues located further away than <italic>R</italic>2 were either considered as non-epitope (the âunmaskedâ data set) or ignored in the model training and and calculation of the relevant metrics (the âmaskedâ data set, highlighted in gray). The color gradient from light cyan to dark cyan corresponds to the contact number value ranked from low to high, respectively. The color map is shown in the top right-hand corner of the figure. Epitopes obtained from distinct antigen-antibody complexes from the PDB database were merged to provide the final antigen epitopes data set.</p>
        </caption>
        <graphic xlink:href="fimmu-13-960985-g001" position="float"/>
      </fig>
      <p>In addition to conventional classification of epitope residues, for each antigen residue we calculated the contact number interaction feature. The contact number is a measure of the number of contacts of an antigen residue with atoms of antibody residues. Contact numbers may provide an additional interpretive score reflecting how deeply the residue is buried in the antigen/antibody interface. This might improve training efficiency by providing additional spatial information to the model. Finally, we combined information on different antibodies for the same antigen into consensus mask. The summary of the generated consensus mask is shown in <xref rid="f1" ref-type="fig"><bold>FigureÂ 1</bold></xref>.</p>
      <p>This data set was used to train and evaluate the models to solve the following tasks: (1) the conventional task of binary classification of antigen residues into epitope/non-epitope residues (with both âcloseâ and âdistantâ residues classed as ânon-epitopeâ); (2) prediction of epitope residues on the âmaskedâ data set, that includes only âepitopeâ residues and residues localized âcloseâ to epitope, excluding âdistantâ residues from model training and metrics calculation; (3) quantitative prediction of contact number features of antigen residues. We suggest that evaluation of the model on the different data sets generated using a wide range of <italic>R</italic>1 and <italic>R</italic>2 radii could allow to evaluate the robustness of the model in terms of predicting epitope residues independent of the ambiguities in the epitope definition.</p>
    </sec>
    <sec id="s3_2">
      <title>3.2 Fine-tuning the models and internal validation of SEMA</title>
      <p>The generated conformational epitope data set was used to train SEMA-1D and SEMA-3D models based on pretrained ESM-1v and ESM-IF1 models to predict the contact number antigen-antibody interaction features together with binary classification into epitope/non-epitope residues. ROC AUC metric was used to estimate model performance. We analyzed the performance of the models for two groups of test sets: (1) âunmaskedâ test sets, in which all antigen residues were classified as epitope or non-epitope according to selected radii <italic>R</italic>1 (4.5, 6.0 and 8.0 Ã); (2) âmaskedâ test sets, in which all antigen residues located further than <italic>R</italic>2 (12.0, 14.0, 16.0 and infinity Ã) from the antibody were âmaskedâ and ignored in ROC AUC calculations.</p>
      <p>We also evaluated sets of <italic>R</italic>1 and <italic>R</italic>2 radii values for training set generation to select a model that performs best on both âmaskedâ and âunmaskedâ test sets regardless of the selected radii. Additionally, we evaluated two approaches to calculating the contact number: in the first case, we counted the number of antibody atoms contacting antigen within the radius <italic>R</italic>1 (cn_atom), whereas in the second case, we calculated the number of residues with at least one contact within the radius <italic>R</italic>1, which resulted in a lower value (cn_aa).</p>
      <p>For most radii variants, the models showed better performance when trained to predict cn_atom rather than cn_aa; this was further used for the selection of the final models (<xref rid="SM1" ref-type="supplementary-material"><bold>Supplementary Figures S1</bold></xref>, <xref rid="SM1" ref-type="supplementary-material"><bold>S2</bold></xref>). For both ESM-IF1 and ESM-1v, the highest ROC AUC values (0.77 and 0.72, respectively) were obtained for âunmaskedâ test sets with <italic>R</italic>1=4.5 Ã (<xref rid="f2" ref-type="fig"><bold>FigureÂ 2</bold></xref>, <xref rid="SM1" ref-type="supplementary-material"><bold>Supplementary Figures S1</bold></xref>, <xref rid="SM1" ref-type="supplementary-material"><bold>S2</bold></xref>). However, the same models exhibited worse performance for âmaskedâ test set. This might be due to the fact that classification of antigen residues located close to epitope is a more challenging task.</p>
      <fig position="float" id="f2">
        <label>FigureÂ 2</label>
        <caption>
          <p>Model performance metrics estimated for the âmaskedâ and âunmaskedâ test and training sets. <bold>(A)</bold> ROC AUC values for SEMA-1D. <bold>(B)</bold> ROC AUC values for SEMA-3D. The color gradient indicates the ROC AUC value from low (brown) to high (cyan).</p>
        </caption>
        <graphic xlink:href="fimmu-13-960985-g002" position="float"/>
      </fig>
      <p>The models trained on <italic>R</italic>1 = 8.0 Ã and <italic>R</italic>2 = 16.0 Ã achieved a robust performance on all test sets regardless of the selected radii. Finally, ROC AUC values obtained by the fine-tuned ESM-1v model was 0.7 and 0.67 for âmaskedâ and âunmaskedâ test sets, respectively (<xref rid="f2" ref-type="fig"><bold>FigureÂ 2A</bold></xref>). ROC AUC values for ESM-IF1 fine-tuned models were 0.75 and 0.73 for âmaskedâ and âunmaskedâ test set, correspondingly (<xref rid="f2" ref-type="fig"><bold>FigureÂ 2B</bold></xref>).</p>
      <p>The final fine-tuned models were called SEMA. SEMA involves the use of sequence-based (SEMA-1D) and structure-based (SEMA-3D) approaches to predict the conformational B-cell epitopes and provide an interpretable score indicating the log-scaled expected number of contacts with antibody residues (<xref rid="f3" ref-type="fig"><bold>FigureÂ 3</bold></xref>).</p>
      <fig position="float" id="f3">
        <label>FigureÂ 3</label>
        <caption>
          <p>Scheme of SEMA. SEMA comprises fine-tuned ESM-1v (SEMA-1D) for the sequence-based and fine-tuned ESM-IF1 (SEMA-3D) for the structure-based prediction of epitopes.</p>
        </caption>
        <graphic xlink:href="fimmu-13-960985-g003" position="float"/>
      </fig>
      <p>We found that calculating an ensemble of models obtained with different initialization parameters led to a noticeable improvement in the prediction of epitope residues. Thus, the final model was obtained as an ensemble of five models averaging their results. SEMA-1D achieved the best ROC AUC of 0.76/0.71 on âunmaskedâ and âmaskedâ test sets respectively, whereas the SEMA-3D achieved best ROC AUC score of 0.76/0.73 (<xref rid="f4" ref-type="fig"><bold>FigureÂ 4</bold></xref>).</p>
      <fig position="float" id="f4">
        <label>FigureÂ 4</label>
        <caption>
          <p>ROC AUC metrics calculated using peer methods, SEMA-1D and SEMA-3D on two test sets: âmaskedâ (<italic>R</italic>1 = 4.5 Ã; <italic>R</italic>2 = 16.0 Ã) and âunmaskedâ (<italic>R</italic>1 = 4.5Ã; <italic>R</italic>2 = <italic>infinite</italic>).</p>
        </caption>
        <graphic xlink:href="fimmu-13-960985-g004" position="float"/>
      </fig>
    </sec>
    <sec id="s3_3">
      <title>3.3 Comparison with peer methods</title>
      <p>The list of peer methods included BepiPred-2.0Â  (<xref rid="B3" ref-type="bibr">3</xref>), DiscoTope 2.0Â  (<xref rid="B6" ref-type="bibr">6</xref>), PEPITOÂ  (<xref rid="B4" ref-type="bibr">4</xref>), Epitopia (<xref rid="B5" ref-type="bibr">5</xref>) and SEPPAÂ 3.0Â  (<xref rid="B2" ref-type="bibr">2</xref>). Model performance was evaluated against collected benchmarks (see Methods). Benchmarks included antigens with no prior information in the PDB database before January 1, 2020. These cases were not included in any training set, which enabled a fair comparison of tools with each other.</p>
      <p>We compared the performance metrics including AUC, MCC, PPV and sensitivity for both âmaskedâ and âunmaskedâ test sets (<xref rid="T1" ref-type="table"><bold>TableÂ 1</bold></xref>, <xref rid="f4" ref-type="fig"><bold>FigureÂ 4</bold></xref>). For the test set classification into epitope and non-epitope residues, <italic>R</italic>1 was set equal to 4.5 Ã, which was also used in the training set for other tools. In the masked test set, <italic>R</italic>2 was set to 16.0 Ã.</p>
      <table-wrap position="float" id="T1">
        <label>TableÂ 1</label>
        <caption>
          <p>Performance comparison of SEMA-1D and SEMA-3D with other peer methods on two test sets: âmaskedâ ( <italic>R</italic>1 = 4.5 Ã; <italic>R</italic>2 = 16.0 Ã) and âunmaskedâ (<italic>R</italic>1 = 4.5 Ã; <italic>R</italic>2 = <italic>Infinite</italic>).</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Test set</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Method</th>
              <th valign="top" align="center" rowspan="1" colspan="1">AUC</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Threshold</th>
              <th valign="top" align="center" rowspan="1" colspan="1">MCC</th>
              <th valign="top" align="center" rowspan="1" colspan="1">PPV</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Sensetivity</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">SEPPA 3.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.627</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.048</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.176</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.772</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.436</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">ElliPro</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.676</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.582</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.218</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.754</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.645</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">PEPITO</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.680</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.110</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.218</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.756</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.559</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">âmaskedâ</td>
              <td valign="top" align="left" rowspan="1" colspan="1">DiscoTope 2.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.671</td>
              <td valign="top" align="center" rowspan="1" colspan="1">-10.954</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.206</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.748</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.626</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">BepiPred-2.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.629</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.485</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.167</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.747</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.548</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">SEMA-1D</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.714</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.491</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.258</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.774</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.639</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">SEMA-3D</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.733</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.210</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.269</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.778</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.646</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">SEPPA 3.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.632</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.048</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.133</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.890</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.392</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">ElliPro</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.652</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.582</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.128</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.883</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.621</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">PEPITO</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.670</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.070</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.144</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.884</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.506</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">âunmaskedâ</td>
              <td valign="top" align="left" rowspan="1" colspan="1">DiscoTope 2.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.664</td>
              <td valign="top" align="center" rowspan="1" colspan="1">-13.130</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.132</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.890</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.500</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">BepiPred-2.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.655</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.485</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.133</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.888</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.560</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">SEMA-1D</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.756</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.491</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.217</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.900</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.689</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1">SEMA-3D</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.759</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.029</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.202</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.905</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.593</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>Threshold is an optimal cut-off chosen by ROC AUC analysis corresponding to the highest true positive rate together with the lowest false positive rate. AUC â area under curve, MCC â Matthews correlation coefficient, PPV â positive predictive value.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The results show that the sequence-based methods, as well as SEPPA 3.0 and SEMA-3D perform better on conventional epitope prediction task on the âunmaskedâ test set compared to the âmaskedâ test set. This indicates poorer performance in classification of non-epitope residues located close to epitope and predicting epitope borders. In contrast, PEPITO, ElliPro and Discotope 2.0 tools demonstrate the highest ROC AUC value on the âmaskedâ test set (<xref rid="f4" ref-type="fig"><bold>FigureÂ 4</bold></xref>). Compared to other methods, both SEMA-1D and SEMA-3D models have the highest performance metrics across all the benchmark tasks. The results of predictions for other values of <italic>R</italic>1 and <italic>R</italic>2 exhibit a similar trend and are shown in Supplementary table (see <xref rid="SM2" ref-type="supplementary-material"><bold>Supplementary Tables S1</bold></xref>, <xref rid="SM2" ref-type="supplementary-material"><bold>S2</bold></xref>). As expected, in line with SEMA, all tools have lower AUC, PPV and sensitivity values and higher MCC values for higher <italic>R</italic>1 radii values, while selecting finite <italic>R</italic>2 (<italic>R</italic>2 &lt; <italic>Inf</italic>) radius does not significantly affect the results.</p>
    </sec>
    <sec id="s3_4">
      <title>3.4 Case study: Prediction of immunodominant regions of the SARS-CoV-2 RBD domain</title>
      <p>The RBD domain of the S-protein of SARS-CoV-2 is one of the most well structurally characterized antigens to date. We conducted an analysis of the RBD domain instead of the full-length S-protein to exclude the putative effects of glycosylation that is currently not considered in the SEMAÂ  (<xref rid="B19" ref-type="bibr">19</xref>). To evaluate the performance of SEMA, during model training we excluded all sequences homologous to S-protein (with a degree of identity of &gt; 70%), in particular S-proteins of MERS and SARS-CoV. SEMA-3D was evaluated on the three following tasks: (1) correctly assigning epitope and non-epitope residues; (2) correctly predicting the contact number features; (3) predicting the immunodominant epitope residues. The immunodominant residues of the RBD were estimated according to the ratio of RBD/antibody complexes in the PDB database, in which the RBD residue was in direct contact with antibody. We assume that the calculated ratio allow to estimate the immunogenicity of RBD residues, with a high ratio corresponding to immunodominant residues.</p>
      <p>As shown in the <xref rid="f5" ref-type="fig"><bold>FigureÂ 5</bold></xref>, SEMA-3D provides high correlation coefficients for both contact number values and estimated immunogenicity score. Additionally, we calculated the ROC AUC metrics of the model to differentiate immunodominant residues (high ratio) from other residues (low ratio), based on the ratio threshold. This provides a more reliable estimation of model performance, since most of the solvent-exposed residues of the RBD domain are labeled as epitope due to the presence of at least one structure where corresponding residues interact with the antibody. As can be seen from the score cut-off values, SEMA-3D achieves the average ROC AUC score of 0.75 on this task.</p>
      <fig position="float" id="f5">
        <label>FigureÂ 5</label>
        <caption>
          <p>Prediction of RBD immunodominant epitopes with SEMA. <bold>(A)</bold> RBD domain of SARS-CoV-2 (PDB ID: 7KS9, chain B) colored according to the SEMA predicted score (left), immunogenicity score (center) and contact number values (right). Residues colored from brown (low value) to cyan (high value). Immunogenicity was estimated as the ratio of RBD/antibody complexes in the PDB database in which RBD residue was in contact with antibody within 8.0 (Ã) <bold>(B)</bold> Correlation between the SEMA score and the log-scaled antigen contact number feature. Pearson correlation coefficient is shown. <bold>(C)</bold> Correlation between the SEMA score and the immunogenicity score. Pearson correlation coefficient is shown. <bold>(D)</bold> ROC AUC values calculated for different epitope/non-epitope residue classification based on the immunogenicity score threshold. ROC AUC values and threshold values for classification are denoted.</p>
        </caption>
        <graphic xlink:href="fimmu-13-960985-g005" position="float"/>
      </fig>
    </sec>
    <sec id="s3_5">
      <title>3.5 Web-interface</title>
      <p>We developed a web-interface (<uri xlink:href="http://sema.airi.net">http://sema.airi.net</uri>) for convenient usage of SEMA. A user can either submit a protein sequence to run SEMA-1D (fine-tuned ESM-1v model) or a protein structure in the PDB format to run SEMA-3D (fine-tuned ESM-IF1 model). The output includes predicted epitope scores for each residue in the protein sequence. To visualize the results, the output sequence in the web-interface is colored based on the predicted contact number, with colors ranging from brown (non-epitope) to cyan (epitope) (<xref rid="f6" ref-type="fig"><bold>FigureÂ 6</bold></xref>). In case of SEMA-3D, output includes 3D structure of protein colored using the same color scheme as in SEMA-1D (<xref rid="f6" ref-type="fig"><bold>FigureÂ 6</bold></xref>). A user can download the results in JSON and CSV format. We also provide the code of the model implemented as the Jupyter Notebook on GitHub available <italic>via</italic> link <uri xlink:href="https://github.com/AIRI-Institute/SEMAi">https://github.com/AIRI-Institute/SEMAi</uri>. We encourage using this implementation for comprehensive analysis including multiple protein sequences.</p>
      <fig position="float" id="f6">
        <label>FigureÂ 6</label>
        <caption>
          <p>Example of SEMA-3D graphical output (PDB ID: 6TXZ, chain D). Residues are colored from brown (non-epitope) to cyan (epitope).</p>
        </caption>
        <graphic xlink:href="fimmu-13-960985-g006" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>4 Discussion</title>
    <p>Computational prediction of conformational epitopes is of great importance for vaccine design and therapeutics development. Conformational epitope residues are conventionally defined by a distance cut-off radius between antigen and antibody residues in the interacting complex. A residue is classified as non-epitope if it does not interact with the antigen. However, an arbitrary choice of a distance cut-off radius might lead to ambiguity in labeling epitope residues. Additionally in case of limited availability of data on the analyzed antigen, negative labels might be assigned incorrectly. In particular, for the S-protein of SARS-CoV-2, crystallographic analysis initially discovered epitopes on the RBD domain (<xref rid="B20" ref-type="bibr">20</xref>), but later immunodominant epitopes within the NTD domain and other regions of the S-protein were also identified (<xref rid="B21" ref-type="bibr">21</xref>).</p>
    <p>To take this problems into account, we generated a benchmark that included antigens with classified epitope residues based on two distance cut-off values. The first distance, <italic>R</italic>1, defined the positive epitope label class, while the second distance, <italic>R</italic>2, defined if the residue was too remote from the epitope and was ignored in metric calculations. Finite <italic>R</italic>2 radii made it possible to evaluate the modelâs ability to predict the boundaries of epitopes. Additionally, for each antigen residue we calculated the contact number feature corresponding to the number of atoms of the antibody located within the radius <italic>R</italic>1 of antigen residue. This feature was introduced for model training to provide additional spatial information on interaction between the antibody and antigen. Moreover, this feature alone was demonstrated to be a good predictor of epitope residues for a wide range of <italic>R</italic>1 values.</p>
    <p>Transfer learning has been proven to be an efficient approach in the case of a limited set of examplesÂ  (<xref rid="B22" ref-type="bibr">22</xref>). In this paper, we show that a fine-tuned protein language model (ESM-1v) and an inverse folding model (ESM-IF1) perform well when predicting conformational epitopes. More specifically, the model was fine-tuned on a non-redundant set of only 783 antigen records with epitope residues assigned according to available antigen/antibody structures in the PDB database and selected <italic>R</italic>1 and <italic>R</italic>2 radii values.</p>
    <p>To fine-tune the model, we screened various training sets generated using a wide range of <italic>R</italic>1 and <italic>R</italic>2 radii values and selected the model that performed best across all benchmark tasks. The final model was called SEMA; it comprises SEMA-1D (fine-tuned ESM-1v) and SEMA-3D (fine-tuned ESM-IF1) models for sequence-based and structure-based conformational B-cell epitopes prediction, respectively. SEMA was trained on the masked data set with <italic>R</italic>1 = 8.0 Ã and <italic>R</italic>2 = 16.0 Ã.</p>
    <p>The high performance of SEMA can be explained by ability of protein language models to capture multiple structural and functional protein properties necessary to predict the epitope residues. In this work SEMA model was trained to automatically derive the immunogenic properties of antigen residues from representations of fine-tuned protein language models. In particular, we show that SEMA can be applied to predict immunogenicity of the RBD domain residues.</p>
    <p>In this study, we developed B-cell conformational epitope prediction tools SEMA-1D and SEMA-3D based on the pretrained ESM-1v protein language model and ESM-IF1 inverse folding model. SEMA-1D/3D provides an interpretable score correlated with immunogenic properties of the antigen. This model demonstrated robust performance and can be applied for a wide range of antigen analysis tasks.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data availability statement</title>
    <p>The original contributions presented in the study are included in the article/<xref rid="SM1" ref-type="supplementary-material"><bold>Supplementary Material</bold></xref>. Further inquiries can be directed to the corresponding author.</p>
  </sec>
  <sec sec-type="author-contributions" id="s6">
    <title>Author contributions</title>
    <p>TS and NI carried out model training, data set generation and analysis. DU wrote the code for models fine-tuning. TS and AK carried out the analysis of published epitope tools performance. IL carried out the data set analysis. DS, MA, PS, TS and NI carried out manuscript writing. MS and TS developed web-interface. OK, DS, MA, NI designed the study. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec sec-type="COI-statement" id="s7">
    <title>Conflict of interest</title>
    <p>Authorâs DU and IL were employed by Sber.</p>
    <p>The remaining authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s8">
    <title>Publisherâs note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
</body>
<back>
  <sec sec-type="supplementary-material" id="s9">
    <title>Supplementary material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fimmu.2022.960985/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fimmu.2022.960985/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SM1" position="float" content-type="local-data">
      <media xlink:href="DataSheet_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM2" position="float" content-type="local-data">
      <media xlink:href="Table_1.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershoni</surname><given-names>JM</given-names></name><name><surname>Roitburd-Berman</surname><given-names>A</given-names></name><name><surname>Siman-Tov</surname><given-names>DD</given-names></name><name><surname>Freund</surname><given-names>NT</given-names></name><name><surname>Weiss</surname><given-names>Y</given-names></name></person-group>. <article-title>Epitope mapping</article-title>. <source>BioDrugs</source> (<year>2007</year>) <volume>21</volume>:<page-range>145â56</page-range>. doi: <pub-id pub-id-type="doi">10.2165/00063030-200721030-00002</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Yan</surname><given-names>D</given-names></name><name><surname>Mao</surname><given-names>T</given-names></name><name><surname>Tang</surname><given-names>K</given-names></name><etal/></person-group>. <article-title>Seppa 3.0âenhanced spatial epitope prediction enabling glycoprotein antigens</article-title>. <source>Nucleic Acids Res</source> (<year>2019</year>) <volume>47</volume>:<page-range>W388â94</page-range>. doi:Â <pub-id pub-id-type="doi">10.1093/nar/gkz413</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jespersen</surname><given-names>MC</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Marcatili</surname><given-names>P</given-names></name></person-group>. <article-title>Bepipred-2.0: improving sequence-based b-cell epitope prediction using conformational epitopes</article-title>. <source>Nucleic Acids Res</source> (<year>2017</year>) <volume>45</volume>:<page-range>W24â9</page-range>. doi:Â <pub-id pub-id-type="doi">10.1093/nar/gkx346</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sweredoski</surname><given-names>MJ</given-names></name><name><surname>Baldi</surname><given-names>P</given-names></name></person-group>. <article-title>Pepito: improved discontinuous b-cell epitope prediction using multiple distance thresholds and half sphere exposure</article-title>. <source>Bioinformatics</source> (<year>2008</year>) <volume>24</volume>:<page-range>1459â60</page-range>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btn199</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubinstein</surname><given-names>ND</given-names></name><name><surname>Mayrose</surname><given-names>I</given-names></name><name><surname>Martz</surname><given-names>E</given-names></name><name><surname>Pupko</surname><given-names>T</given-names></name></person-group>. <article-title>Epitopia: a web-server for predicting b-cell epitopes</article-title>. <source>BMC Bioinf</source> (<year>2009</year>) <volume>10</volume>:<fpage>1</fpage>â<lpage>6</lpage>. doi: <pub-id pub-id-type="doi">10.1186/1471-2105-10-287</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kringelum</surname><given-names>JV</given-names></name><name><surname>Lundegaard</surname><given-names>C</given-names></name><name><surname>Lund</surname><given-names>O</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group>. <article-title>Reliable b cell epitope predictions: impacts of method development and improved benchmarking</article-title>. <source>PloS Comput Biol</source> (<year>2012</year>) <volume>8</volume>:<elocation-id>e1002829</elocation-id>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002829</pub-id>
<pub-id pub-id-type="pmid">23300419</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manavalan</surname><given-names>B</given-names></name><name><surname>Govindaraj</surname><given-names>RG</given-names></name><name><surname>Shin</surname><given-names>TH</given-names></name><name><surname>Kim</surname><given-names>MO</given-names></name><name><surname>Lee</surname><given-names>G</given-names></name></person-group>. <article-title>Ibce-el: a new ensemble learning framework for improved linear b-cell epitope prediction</article-title>. <source>Front Immunol</source> (<year>2018</year>) <volume>9</volume>:<elocation-id>1695</elocation-id>. doi: <pub-id pub-id-type="doi">10.3389/fimmu.2018.01695</pub-id>
<pub-id pub-id-type="pmid">30100904</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasan</surname><given-names>MM</given-names></name><name><surname>Khatun</surname><given-names>MS</given-names></name><name><surname>Kurata</surname><given-names>H</given-names></name></person-group>. <article-title>Ilbe for computational identification of linear b-cell epitopes by integrating sequence and evolutionary features</article-title>. <source>Genomics Proteomics Bioinf</source> (<year>2020</year>) <volume>18</volume>:<fpage>593</fpage>â<lpage>600</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.gpb.2019.04.004</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rives</surname><given-names>A</given-names></name><name><surname>Meier</surname><given-names>J</given-names></name><name><surname>Sercu</surname><given-names>T</given-names></name><name><surname>Goyal</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><etal/></person-group>. <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>. <source>Proc Natl Acad Sci</source> (<year>2021</year>) <volume>118</volume>:<elocation-id>e2016239118</elocation-id>. doi: <pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id>
<pub-id pub-id-type="pmid">33876751</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elnaggar</surname><given-names>A</given-names></name><name><surname>Heinzinger</surname><given-names>M</given-names></name><name><surname>Dallago</surname><given-names>C</given-names></name><name><surname>Rehawi</surname><given-names>G</given-names></name><name><surname>Yu</surname><given-names>W</given-names></name><name><surname>Jones</surname><given-names>L</given-names></name><etal/></person-group>. <article-title>Prottrans: Towards cracking the language of lifes code through self-supervised deep learning and high performance computing</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source> (<year>2021</year>). doi:Â <pub-id pub-id-type="doi">10.1109/TPAMI.2021.3095381</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chowdhury</surname><given-names>R</given-names></name><name><surname>Bouatta</surname><given-names>N</given-names></name><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Rochereau</surname><given-names>C</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>Sorger</surname><given-names>PK</given-names></name><etal/></person-group>. <article-title>Single-sequence protein structure prediction using language models from deep learning</article-title>. <source>bioRxiv</source> (<year>2021</year>). doi:Â <pub-id pub-id-type="doi">10.1101/2021.08.02.454840</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsu</surname><given-names>C</given-names></name><name><surname>Verkuil</surname><given-names>R</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Hie</surname><given-names>B</given-names></name><name><surname>Sercu</surname><given-names>T</given-names></name><etal/></person-group>. <article-title>Learning inverse folding from millions of predicted structures</article-title>. <source>bioRxiv</source> (<year>2022</year>). doi:Â <pub-id pub-id-type="doi">10.1101/2022.04.10.487779</pub-id>
</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jing</surname><given-names>B</given-names></name><name><surname>Eismann</surname><given-names>S</given-names></name><name><surname>Suriana</surname><given-names>P</given-names></name><name><surname>Townshend</surname><given-names>RJ</given-names></name><name><surname>Dror</surname><given-names>R</given-names></name></person-group>. <article-title>Learning from protein structure with geometric vector perceptrons</article-title>. <source>arXiv</source> (<year>2020</year>). doi:Â <pub-id pub-id-type="doi">10.48550/arXiv.2009.01411</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaswani</surname><given-names>A</given-names></name><name><surname>Shazeer</surname><given-names>N</given-names></name><name><surname>Parmar</surname><given-names>N</given-names></name><name><surname>Uszkoreit</surname><given-names>J</given-names></name><name><surname>Jones</surname><given-names>L</given-names></name><name><surname>Gomez</surname><given-names>AN</given-names></name><etal/></person-group>. <article-title>Attention is all you need</article-title>. <source>Advances in neural information processing systems</source>, (<year>2017</year>) <volume>30</volume>. Available at: <uri xlink:href="https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf">https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</uri></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponomarenko</surname><given-names>J</given-names></name><name><surname>Bui</surname><given-names>HH</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Fusseder</surname><given-names>N</given-names></name><name><surname>Bourne</surname><given-names>PE</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Ellipro: a new structure-based tool for the prediction of antibody epitopes</article-title>. <source>BMC Bioinf</source> (<year>2008</year>) <volume>9</volume>:<fpage>1</fpage>â<lpage>8</lpage>. doi: <pub-id pub-id-type="doi">10.1186/1471-2105-9-514</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunbar</surname><given-names>J</given-names></name><name><surname>Deane</surname><given-names>CM</given-names></name></person-group>. <article-title>Anarci: antigen receptor numbering and receptor classification</article-title>. <source>Bioinformatics</source> (<year>2016</year>) <volume>32</volume>:<fpage>298</fpage>â<lpage>300</lpage>. doi:Â <pub-id pub-id-type="doi">10.1093/bioinformatics/btv552</pub-id>
<pub-id pub-id-type="pmid">26424857</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirdita</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>SÃ¶ding</surname><given-names>J</given-names></name></person-group>. <article-title>Mmseqs2 desktop and local web server app for fast, interactive sequence searches</article-title>. <source>Bioinformatics</source> (<year>2019</year>) <volume>35</volume>:<page-range>2856â8</page-range>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1057</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>K</given-names></name><name><surname>Standley</surname><given-names>DM</given-names></name></person-group>. <article-title>Mafft multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source> (<year>2013</year>) <volume>30</volume>:<page-range>772â80</page-range>. doi: <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reis</surname><given-names>CA</given-names></name><name><surname>Tauber</surname><given-names>R</given-names></name><name><surname>Blanchard</surname><given-names>V</given-names></name></person-group>. <article-title>Glycosylation is a key in sars-cov-2 infection</article-title>. <source>J Mol Med</source> (<year>2021</year>) <volume>99</volume>:<page-range>1023â31</page-range>. doi: <pub-id pub-id-type="doi">10.1007/s00109-021-02092-0</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Lee</surname><given-names>CCD</given-names></name><name><surname>So</surname><given-names>RT</given-names></name><name><surname>Lv</surname><given-names>H</given-names></name><etal/></person-group>. <article-title>A highly conserved cryptic epitope in the receptor binding domains of sars-cov-2 and sars-cov</article-title>. <source>Science</source> (<year>2020</year>) <volume>368</volume>:<page-range>630â3</page-range>. doi: <pub-id pub-id-type="doi">10.1126/science.abb7269</pub-id>
</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cerutti</surname><given-names>G</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Gorman</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>M</given-names></name><name><surname>Rapp</surname><given-names>M</given-names></name><etal/></person-group>. <article-title>Potent sars-cov-2 neutralizing antibodies directed against spike n-terminal domain target a single supersite</article-title>. <source>Cell Host Microbe</source> (<year>2021</year>) <volume>29</volume>:<page-range>819â33</page-range>. doi: <pub-id pub-id-type="doi">10.1016/j.chom.2021.03.005</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howard</surname><given-names>J</given-names></name><name><surname>Ruder</surname><given-names>S</given-names></name></person-group>. <article-title>Universal language model fine-tuning for text classification</article-title>. <source>arXiv</source> (<year>2018</year>). doi:Â <pub-id pub-id-type="doi">10.48550/arXiv.1801.06146</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
