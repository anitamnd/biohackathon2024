<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870712</article-id>
    <article-id pub-id-type="pmid">28645171</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx364</article-id>
    <article-id pub-id-type="publisher-id">btx364</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UpSetR: an R package for the visualization of intersecting sets and their properties</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Conway</surname>
          <given-names>Jake R</given-names>
        </name>
        <xref ref-type="aff" rid="btx364-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lex</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="btx364-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gehlenborg</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="btx364-aff1">1</xref>
        <xref ref-type="corresp" rid="btx364-cor1"/>
        <!--<email>nils@hms.harvard.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx364-aff1"><label>1</label>Department of Biomedical Informatics, Harvard Medical School, Boston, MA, USA</aff>
    <aff id="btx364-aff2"><label>2</label>SCI Institute, School of Computing, University of Utah, Salt Lake City, UT, USA</aff>
    <author-notes>
      <corresp id="btx364-cor1">To whom correspondence should be addressed. Email: <email>nils@hms.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-06-22">
      <day>22</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>18</issue>
    <fpage>2938</fpage>
    <lpage>2940</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>6</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits 
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx364.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Venn and Euler diagrams are a popular yet inadequate solution for quantitative visualization of set intersections. A scalable alternative to Venn and Euler diagrams for visualizing intersecting sets and their properties is needed.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We developed UpSetR, an open source R package that employs a scalable matrix-based visualization to show intersections of sets, their size, and other properties.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and implementation</title>
        <p>UpSetR is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/hms-dbmi/UpSetR/">https://github.com/hms-dbmi/UpSetR/</ext-link> and released under the MIT License. A Shiny app is available at <ext-link ext-link-type="uri" xlink:href="https://gehlenborglab.shinyapps.io/upsetr/">https://gehlenborglab.shinyapps.io/upsetr/</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>R00HG007583</award-id>
        <award-id>U54HG007963</award-id>
        <award-id>U01CA198935</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The visualization of sets and their intersections is a common challenge for researchers who are dealing with biological and biomedical data. For example, a researcher might need to compare multiple algorithms that identify single nucleotide polymorphisms (<xref rid="btx364-B9" ref-type="bibr">Xu <italic>et al.</italic>, 2012</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>) or show orthologs of genes in newly sequenced species across genomes of related species (<xref rid="btx364-B4" ref-type="bibr">D’Hont <italic>et al.</italic>, 2012</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). Although many alternative set visualization techniques exist (<xref rid="btx364-B1" ref-type="bibr">Alsallakh <italic>et al.</italic>, 2016</xref>), such data are typically visualized using Venn and Euler diagrams. Such diagrams can be generated with R packages such as <italic>venneuler</italic> (<xref rid="btx364-B8" ref-type="bibr">Wilkinson, 2012</xref>) and <italic>VennDiagram</italic> (<xref rid="btx364-B2" ref-type="bibr">Chen and Boutros, 2011</xref>). These closely related techniques have well known shortcomings, as they are hard to generate for more than a small number of sets. The visual representation of intersection size by irregularly shaped and unaligned areas makes it hard to answer essential questions such as ‘What is the biggest intersection?’ or ‘Is intersection <italic>X</italic> larger than intersection <italic>Y</italic>?’ (<xref rid="btx364-B3" ref-type="bibr">Cleveland and McGill, 1984</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Here we present an R package named ‘UpSetR’ based on the ‘UpSet’ technique (<xref rid="btx364-B6" ref-type="bibr">Lex <italic>et al.</italic>, 2014</xref>; <xref rid="btx364-B5" ref-type="bibr">Lex and Gehlenborg, 2014</xref>) that employs a matrix-based layout to show intersections of sets and their sizes. It is implemented using ggplot2 (<xref rid="btx364-B7" ref-type="bibr">Wickham, 2009</xref>) and allows data analysts to easily generate generate UpSet plots for their own data. UpSetR support three input formats: (i) a table in which the rows represent elements and columns include set assignments and additional attributes; (ii) sets of elements names; and (iii) an expression describing the size of the set intersections as introduced by the <italic>venneuler</italic> package (<xref rid="btx364-B8" ref-type="bibr">Wilkinson, 2012</xref>). UpSetR provides support for the visualization of attributes associated with the elements contained in the sets, enabling researchers to explore and characterize the intersections. UpSetR differs from the original UpSet technique as it is optimized for static plots and for integration into typical bioinformatics workflows. We also provide a Shiny app that allows researchers to create publication-quality UpSet plots directly in a web browser.</p>
    <p>UpSetR visualizes intersections of sets as a matrix in which the rows represent the sets and the columns represent their intersections (<xref ref-type="fig" rid="btx364-F1">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs. S1 and S2</xref> for comparisons of Venn and Euler diagrams with UpSetR plots). For each set that is part of a given intersection, a black filled circle is placed in the corresponding matrix cell. If a set is not part of the intersection, a light gray circle is shown. A vertical black line connects the topmost black circle with the bottommost black circle in each column to emphasize the column-based relationships. The size of the intersections is shown as a bar chart placed on top of the matrix so that each column lines up with exactly one bar. A second bar chart showing the size of the each set is shown to the left of the matrix.
</p>
    <fig id="btx364-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>An UpSetR plot of variants across eight ICGC cancer studies with three intersection queries, one element query, four attribute plots, and two set metadata plots. Data for LUSC-KR and LAML-KR are based on whole-genome sequencing, all others on whole-exome sequencing. The three intersection queries are the one-way intersections of LUSC-US (blue) and THCA-SA (purple), and the two-way intersection of LUSC-KR and LAML-KR (green). The element query (yellow) selects mutations classified as deletions. Three custom transition/transversion plots display the relative frequency of substitution events for the intersection queries. The bar plot attribute plot displays the contribution of variants unique to the THCA-SA cohort (purple) to each mutation type. Set metadata is plotted to the left of the set size bar (charts)</p>
      </caption>
      <graphic xlink:href="btx364f1"/>
    </fig>
  </sec>
  <sec>
    <title>3 Usage scenario</title>
    <p>To illustrate the utility and features of UpSetR, we retrieved variant calls for eight cancer studies from from the ICGC Data Portal (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Each cancer study represents a set and each variant represents an element that is contained in one or more sets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). UpSetR supports queries on the data to highlight features. <italic>Intersection queries</italic> can be used to select subsets of elements in the dataset defined by an intersection. Queries are assigned a unique color and their results are plotted on top of the intersection size bar chart. For example, this can be used to select elements in particular intersections (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). Additionally, UpSetR supports queries for the selection of elements based on attributes associated with the elements in the sets. Attributes can be numerical, Boolean or categorical. In our example, element attributes are chromosome, genomic location, and variant type (deletion, insertion, substitution) associated with each variant. UpSetR <italic>element queries</italic> select elements across intersections and sets based on particular attribute values. Basic built-in queries can be extended to arbitrarily complex queries by providing a custom query function that operates on any combination of attributes. Element queries can be used to select variants of a particular type, such as deletions, and to view them across intersections (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S5</xref>).</p>
    <p>UpSetR provides integration of additional <italic>attribute plots</italic> that visualize attributes of elements selected by an intersection or element query. Support for scatter plots and histograms is built into UpSetR. Additional plot types can be integrated by providing in a function that returns a <italic>ggplot</italic> object to visualize the data. When attribute or intersection queries are applied, query results can also be overlaid on attribute plots in addition to the intersection size bar plot. <xref ref-type="fig" rid="btx364-F1">Figure 1</xref> demonstrates how these features, including the visualization of metadata about the sets, can be combined into a plot that among other issues, reveals a notable over-representation of unique deletions among the variants in the THCA-SA study.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>UpSetR is a highly customizable tool for data exploration and generation of set visualizations. By making UpSetR compatible with the input formats of the existing popular Venn and Euler diagram packages and by offering a Shiny web interface, we incentivize the use of UpSet diagrams and enable users without programming skills to generate effective set visualizations. Through its seamless integration with ggplot2 and its ability to apply virtually any query, it is possible to customize and explore data in ways not supported by any other set visualization package. In addition, the integration of UpSetR with ggplot2 allows developers to extend UpSetR for use in their own software packages.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx364_supplementary.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge Megan Paul for her contributions and the National Institutes of Health for funding (R00HG007583, U54HG007963, U01CA198935).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx364-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alsallakh</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The State-of-the-Art of Set Visualization</article-title>. <source>Computer Graphics Forum</source>, <volume>35</volume>: <fpage>234</fpage>–<lpage>260</lpage>.</mixed-citation>
    </ref>
    <ref id="btx364-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Boutros</surname><given-names>P.C.</given-names></name></person-group> (<year>2011</year>) 
<article-title>VennDiagram: a package for the generation of highly-customizable Venn &amp; Euler diagrams in R</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>35.</fpage><pub-id pub-id-type="pmid">21269502</pub-id></mixed-citation>
    </ref>
    <ref id="btx364-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cleveland</surname><given-names>W.S.</given-names></name>, <name name-style="western"><surname>McGill</surname><given-names>R.</given-names></name></person-group> (<year>1984</year>) 
<article-title>Graphical perception: Theory, experimentation, and application to the development of graphical methods</article-title>. <source>J. Am. Stat. Assoc</source>, <volume>79</volume>, <fpage>531</fpage>–<lpage>554</lpage>.</mixed-citation>
    </ref>
    <ref id="btx364-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>D’Hont</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>The banana (musa acuminata) genome and the evolution of monocotyledonous plants</article-title>. <source>Nature</source>, <volume>488</volume>, <fpage>213</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">22801500</pub-id></mixed-citation>
    </ref>
    <ref id="btx364-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lex</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Gehlenborg</surname><given-names>N.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Sets &amp; intersections</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>779.</fpage></mixed-citation>
    </ref>
    <ref id="btx364-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lex</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>UpSet: Visualization of intersecting sets</article-title>. <source>IEEE Trans. Vis. Comput. Graph</source>., <volume>20</volume>, <fpage>1983</fpage>–<lpage>1992</lpage>.<pub-id pub-id-type="pmid">26356912</pub-id></mixed-citation>
    </ref>
    <ref id="btx364-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wickham</surname><given-names>H.</given-names></name></person-group> (<year>2009</year>). <source>ggplot2: Elegant Graphics for Data Analysis</source>. 
<publisher-name>Springer, New York</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btx364-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilkinson</surname><given-names>L.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Exact and approximate area-proportional circular Venn and Euler diagrams</article-title>. <source>IEEE Trans. Vis. Comput. Graph</source>., <volume>18</volume>, <fpage>321</fpage>–<lpage>331</lpage>.<pub-id pub-id-type="pmid">21383412</pub-id></mixed-citation>
    </ref>
    <ref id="btx364-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>A fast and accurate SNP detection algorithm for next-generation sequencing data</article-title>. <source>Nat. Commun</source>., <volume>3</volume>, <fpage>1258.</fpage><pub-id pub-id-type="pmid">23212387</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
