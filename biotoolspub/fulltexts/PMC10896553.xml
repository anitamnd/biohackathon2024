<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Anal Chem</journal-id>
    <journal-id journal-id-type="iso-abbrev">Anal Chem</journal-id>
    <journal-id journal-id-type="publisher-id">ac</journal-id>
    <journal-id journal-id-type="coden">ancham</journal-id>
    <journal-title-group>
      <journal-title>Analytical Chemistry</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0003-2700</issn>
    <issn pub-type="epub">1520-6882</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10896553</article-id>
    <article-id pub-id-type="pmid">38273718</article-id>
    <article-id pub-id-type="doi">10.1021/acs.analchem.3c03078</article-id>
    <article-categories>
      <subj-group>
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SAND: Automated
Time-Domain Modeling of NMR Spectra
Applied to Metabolite Quantification</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="ath1">
        <name>
          <surname>Wu</surname>
          <given-names>Yue</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <name>
          <surname>Sanati</surname>
          <given-names>Omid</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath3">
        <name>
          <surname>Uchimiya</surname>
          <given-names>Mario</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath4">
        <name>
          <surname>Krishnamurthy</surname>
          <given-names>Krish</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">∥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath5">
        <name>
          <surname>Wedell</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref rid="aff5" ref-type="aff">⊥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath6">
        <name>
          <surname>Hoch</surname>
          <given-names>Jeffrey C.</given-names>
        </name>
        <xref rid="aff6" ref-type="aff">#</xref>
      </contrib>
      <contrib contrib-type="author" id="ath7">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5686-2350</contrib-id>
        <name>
          <surname>Edison</surname>
          <given-names>Arthur S.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
        <xref rid="aff7" ref-type="aff">∇</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="ath8">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1264-2556</contrib-id>
        <name>
          <surname>Delaglio</surname>
          <given-names>Frank</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
        <xref rid="aff8" ref-type="aff">○</xref>
      </contrib>
      <aff id="aff1"><label>†</label>Institute
of Bioinformatics, <institution>University of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff2"><label>‡</label>School
of Electrical and Computer Engineering, <institution>University of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff3"><label>§</label>Complex
Carbohydrate Research Center, <institution>University
of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff4"><label>∥</label><institution>Chempacker
LLC</institution>, San Jose, California 95135, <country>United States</country></aff>
      <aff id="aff5"><label>⊥</label>National
Magnetic Resonance Facility, <institution>University
of Wisconsin-Madison</institution>, Madison, Wisconsin 53706, <country>United States</country></aff>
      <aff id="aff6"><label>#</label>Department
of Molecular Biology and Biophysics, <institution>University
of Connecticut</institution>, Farmington, Connecticut 06030-3305, <country>United States</country></aff>
      <aff id="aff7"><label>∇</label>Department
of Biochemistry and Molecular Biology, <institution>University
of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff8"><label>○</label>Institute
for Bioscience and Biotechnology Research, <institution>National Institute of Standards and Technology and the University
of Maryland</institution>, Rockville, Maryland 20850, <country>United States</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Email: <email>frank.delaglio@nist.gov</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>01</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <day>06</day>
      <month>02</month>
      <year>2024</year>
    </pub-date>
    <volume>96</volume>
    <issue>5</issue>
    <fpage>1843</fpage>
    <lpage>1851</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>07</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>01</month>
        <year>2024</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>01</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 American Chemical Society</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>American Chemical Society</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>Permits non-commercial access and re-use, provided that author attribution and integrity are maintained; but does not permit creation of adaptations or other derivative works (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">https://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0005" id="ab-tgr1"/>
      </p>
      <p>Developments in untargeted nuclear magnetic resonance
(NMR) metabolomics
enable the profiling of thousands of biological samples. The exploitation
of this rich source of information requires a detailed quantification
of spectral features. However, the development of a consistent and
automatic workflow has been challenging because of extensive signal
overlap. To address this challenge, we introduce the software Spectral
Automated NMR Decomposition (SAND). SAND follows on from the previous
success of time-domain modeling and automatically quantifies entire
spectra without manual interaction. The SAND approach uses hybrid
optimization with Markov chain Monte Carlo methods, employing subsampling
in both time and frequency domains. In particular, SAND randomly divides
the time-domain data into training and validation sets to help avoid
overfitting. We demonstrate the accuracy of SAND, which provides a
correlation of ∼0.9 with ground truth on cases including highly
overlapped simulated data sets, a two-compound mixture, and a urine
sample spiked with different amounts of a four-compound mixture. We
further demonstrate an automated annotation using correlation networks
derived from SAND decomposed peaks, and on average, 74% of peaks for
each compound can be recovered in single clusters. SAND is available
in NMRbox, the cloud computing environment for NMR software hosted
by the Network for Advanced NMR (NAN). Since the SAND method uses
time-domain subsampling (i.e., random subset of time-domain points),
it has the potential to be extended to a higher dimensionality and
nonuniformly sampled data.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Division of Biological Infrastructure</institution>
            <institution-id institution-id-type="doi">10.13039/100000153</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1946970</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>ac3c03078</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>ac3c03078</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <p id="sec1">Metabolomics techniques have advanced in both capability and importance,
producing untargeted profiling on a diverse set of biological systems.<sup><xref ref-type="bibr" rid="ref1">1</xref>−<xref ref-type="bibr" rid="ref8">8</xref></sup> Nuclear magnetic resonance (NMR) spectroscopy has enabled nondestructive
and even in vivo metabolic measurements of samples.<sup><xref ref-type="bibr" rid="ref1">1</xref>,<xref ref-type="bibr" rid="ref9">9</xref></sup> Such
untargeted profiling provides a detailed description of the metabolic
landscape, metabolic dynamics,<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> gene–environment
interactions,<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> and possible biomarkers.<sup><xref ref-type="bibr" rid="ref4">4</xref></sup></p>
  <p>Metabolomics data sets are intricate and
rich in information. NMR
data are collected as time-domain signals (free induction decay; FID),
and FIDs are usually Fourier-transformed (FT) into frequency-domain
spectra.<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> While the information content
in the time domain and frequency domain is similar, the FT converts
the complex set of decaying sinusoidal signals in the time domain
into localized individual peaks in the frequency domain and enables
a clear visual analysis. However, in metabolomics studies, there are
often hundreds of spectra, and each spectrum contains hundreds to
thousands of peaks from tens to hundreds of compounds; therefore,
the need to identify and characterize individual peaks is a serious
analysis bottleneck. In addition, the spectral signals are often highly
overlapped, hindering peak quantification and obstructing efficient
annotation. These problems are exacerbated by baseline distortion
and by the presence of broad signals from components with large molecular
weights.<sup><xref ref-type="bibr" rid="ref1">1</xref></sup></p>
  <p>The challenge of spectral
overlap has been approached from both
experimental and computational directions. A variety of experimental
methods have been developed to partially address the overlap problem,
including “pure shift” broadband decoupling to simplify
spectra.<sup><xref ref-type="bibr" rid="ref13">13</xref>−<xref ref-type="bibr" rid="ref17">17</xref></sup> New computational approaches are needed and are the focus of this
study. Spectra are often quantified by the intensity or integral after
peak picking or binning, but the quantification is highly affected
by overlap.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> Reference-library-based quantification
can target routine spectra and compounds, but this is restricted to
available libraries. For instance, Bayesian automated metabolite analyzer
for NMR (BATMAN) relies on precise template libraries, but its targeted
metabolite quantification leaves unknown features unresolved.<sup><xref ref-type="bibr" rid="ref19">19</xref>−<xref ref-type="bibr" rid="ref22">22</xref></sup></p>
  <p>Bayesil has restrictions on sample types and NMR procedures
and
is limited to a defined list of compounds.<sup><xref ref-type="bibr" rid="ref23">23</xref></sup> Chenomx provides a commercial solution to library-based fitting,
but it needs time-consuming manual interactions<sup><xref ref-type="bibr" rid="ref20">20</xref></sup> and has operator-dependent divergences in quantification.<sup><xref ref-type="bibr" rid="ref24">24</xref></sup></p>
  <p>A more general approach is to model the
spectra in an untargeted
and direct way through optimization.<sup><xref ref-type="bibr" rid="ref25">25</xref>,<xref ref-type="bibr" rid="ref26">26</xref></sup> In particular,
time-domain signal modeling directly tackles the overlap problem and
is advantageous for nonuniformly sampled data and data with baseline
problems.<sup><xref ref-type="bibr" rid="ref27">27</xref>−<xref ref-type="bibr" rid="ref29">29</xref></sup> The utility of time-domain modeling is demonstrated
by CRAFT, which is the complete reduction to amplitude frequency table
method. CRAFT, which is based upon a Bayesian framework, has been
used to decompose 1D and 2D NMR spectra by time-domain modeling, and
while CRAFT workflows can involve interactive partitioning of spectral
regions, CRAFT performance is robust with respect to any user-defined
parameters, and so it does have the potential for complete automation.<sup><xref ref-type="bibr" rid="ref27">27</xref>−<xref ref-type="bibr" rid="ref31">31</xref></sup> Similar ideas have been tested by researchers including Rubtsov
et al., but extensive validation and consistent workflows are not
available.<sup><xref ref-type="bibr" rid="ref32">32</xref>−<xref ref-type="bibr" rid="ref35">35</xref></sup> Singular value decomposition (SVD) and linear prediction-based methods
provide alternative solutions, but the tuning parameter, namely, the
reduced order, is hard to select for real-world data sets.<sup><xref ref-type="bibr" rid="ref36">36</xref>−<xref ref-type="bibr" rid="ref42">42</xref></sup> Alternatively, global spectral deconvolution (GSD)<sup><xref ref-type="bibr" rid="ref43">43</xref></sup> provides a convenient commercial solution that automatically
fits frequency-domain data, but in crowded regions, it tends to overfit
by using many non-ideal and nonphysical peaks. Therefore, an automated
untargeted method to decompose NMR spectra is still needed.</p>
  <p>We designed the spectral automatic NMR decomposition (SAND) method
and tested it on both simulated and experimental data sets. SAND automatically
decomposes NMR data into signal tables and accurately quantifies overlapped
peaks, and the SAND results can be used to extract compound annotations
from untargeted metabolomics data sets. SAND is integrated with the
computational facilities of NMRbox<sup><xref ref-type="bibr" rid="ref44">44</xref></sup> through
the NMRPipe<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> platform and Network for
Advanced NMR (NAN), providing an end-to-end workflow from samples
to feature tables.</p>
  <sec id="sec2">
    <title>Materials and Methods</title>
    <sec id="sec2.1">
      <title>Modeling in the Time Domain</title>
      <p>Since an ideal NMR signal
is considered to have an exponential decay and because the analytical
Fourier transform of an ideal exponential signal is a Lorentzian,
NMR spectra are commonly modeled in the frequency domain using Lorentzian
functions. However, NMR spectra are usually generated by discrete
Fourier transform so that, in practice, the corresponding signals
are not perfect Lorentzians even for noise-free ideal time-domain
data. As the number of time-domain points becomes small, the line
shape observed in the Fourier spectrum becomes increasingly broad
and non-ideal, including the appearance of increasingly prominent
truncation artifacts. Furthermore, the use of apodization functions
other than exponentials changes the corresponding Fourier lineshapes,
and apodization in general also changes the distribution of thermal
noise in the spectrum. Digital oversampling, which potentially distorts
early time-domain points, can therefore also change the corresponding
Fourier spectrum. Together, all of these effects are hard to analytically
model in the frequency domain but easy to accommodate numerically
in the time domain.</p>
      <p>Modeling in the time domain can also help
overcome the effects of baseline distortion on signal quantification.
Baseline distortions that extend over large portions of a spectrum
correspond to distortions in a small number of early points in the
time-domain. Therefore, time-domain modeling provides a chance to
mitigate the effects of baseline distortion by down-weighting or skipping
the early first points in the time-domain data.</p>
    </sec>
    <sec id="sec2.2">
      <title>Overview of SAND Decomposition</title>
      <p>The SAND workflow is
illustrated in <xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>. The input NMR spectra for the workflow are collected and pre-processed
automatically. They are then adaptively separated by an automated
procedure into smaller frequency buckets (bins) and inversely Fourier-processed
to generate time domain data, giving an FID for each bin. This helps
speed the analysis by reducing the number of signals that must be
optimized simultaneously and also allows for parallel computation.
In each bin, the FID is modeled as a sum of decaying complex sinusoidal
signals (<xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref>), one for
each signal. Each signal <italic>X</italic><sub><italic>k</italic></sub> is represented by a sequence of complex numbers through time
and is defined by four parameters: amplitude (<italic>A</italic><sub><italic>k</italic></sub>), frequency (<italic>f</italic><sub><italic>k</italic></sub>), decay (λ<sub><italic>k</italic></sub>),
and phase (ϕ<sub><italic>k</italic></sub>):<disp-formula id="eq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m001" position="anchor"/><label>1</label></disp-formula></p>
      <fig id="fig1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Key aspects of the SAND
workflow. (A) In order to minimize the
number of signals that need to be optimized simultaneously and enable
parallel processing, the measured spectrum (blue) is divided into
buckets by an adaptive automated procedure and an overlapping series
of raised cosine masks are generated according to the bucket boundaries
(gold dashed lines); one such mask is shown in in green. A given isolated
bucket (purple) is generated from the product of the measured spectrum
and a mask. (B) A given isolated bucket is inverse Fourier-processed
into the time domain (gray), and the points are randomly divided into
a training set (black points) and a validation set (red points). Then,
a series of models with increasing numbers of signals is proposed
and optimized to fit the training set with each signal modeled as
a complex decaying sinusoid. For each optimized model, a series of
statistics including RMSD are calculated to measure the agreement
between the model and validation set (pink graph), and the optimal
number of signals is identified when additional signals no longer
improve the model (gray dashed line) or if other stop criteria are
reached. (C) The result of SAND optimization is a signal table with
estimated model parameters of frequency, decay, and amplitude. The
parameters can optionally be used to generate simulated time domain
data, which is Fourier-processed in the same way as the measured spectrum
to allow a visual evaluation.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0001" id="gr1" position="float"/>
      </fig>
      <p>Frequency and time domains retain similar information
content.
For each FID, the decomposition process involves an iteration of the
initial value estimation, hybrid optimization of peak parameters,
and stop-criteria checking. Each iteration adds one more peak until
the stop criteria (later section) are met. More details of the process
are covered in later sections. We also provide a user-friendly version
available on NMRbox with an interface where selected parameters mentioned
in the following sections can be provided by the user.</p>
    </sec>
    <sec id="sec2.3">
      <title>NMR Spectral Pre-processing</title>
      <p>The pre-processing was
implemented in NMRPipe and MATLAB and included zero filling (ZF),
FT, phasing, line broadening, referencing, scaling, and format conversion.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> Spectra requiring only zero-order phasing were
corrected automatically, and interactive phasing was used when a first-order
phase correction was needed. Sample scripts for spectra processing
can be found here <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/edisonomics/SAND">https://github.com/edisonomics/SAND</uri>.</p>
    </sec>
    <sec id="sec2.4">
      <title>Automatic Binning of Metabolomics NMR Spectra</title>
      <p>Metabolic
NMR spectra often contain hundreds to thousands of peaks. Binning
separates the spectrum into smaller frequency regions to simplify
the process of optimization and parallelization.<sup><xref ref-type="bibr" rid="ref30">30</xref>,<xref ref-type="bibr" rid="ref41">41</xref></sup> We generate bins in the frequency domain with an adaptive automated
procedure using a bucket (bin) size parameter that gives the initial
size of bins and a slackness parameter that determines how much the
size of a given bin can be adjusted by the adaptive procedure.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> Our examples use a slackness of 0.99 and a bucket
size of 0.002. The bins are automatically adjusted so that each bin
contains at least one local optima, meaning at least one tentative
peak. We combine bins in groups of three to help ensure that a peak
will be evaluated with its neighbors. The binning can be performed
individually for each spectrum or once for a collection of related
samples with expected similarity between samples. The subspectra from
each bin were then post-processed. First, a subspectrum is shifted
to move its minimum to zero to remove any baseline offset. A raised-cosine
band function is then applied to each bin with a roll-off shoulder
of 0.02 ppm. This window function removes drastic changes in the bin
boundary and reduces artifacts in the inverse Fourier transformation
(IFT). The band-selected bin is then processed by Hilbert transform
to generate imaginary data and then inverse Fourier-processed to generate
an FID for each bin.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup></p>
    </sec>
    <sec id="sec2.5">
      <title>Resampling of Time-Domain Data</title>
      <p>Before the decomposition
iterations, the FID can be optionally truncated to exclude the trailing
noise. In the examples here, the first ∼6,000 of 16,384 complex
points in the beginning were used. The selected points from the FID
were then randomly sampled into three sets: “training”
for parameter optimization (70%), “validation” for checking
the stop criteria (20%), and “testing” for the final
evaluation (10%). This separation was intended to infer the reasonable
number of peaks in the stop-criteria checking step rather than strict
cross-validation in forecasting since it is expected that the time-series
samples can be autocorrelated.</p>
    </sec>
    <sec id="sec2.6">
      <title>Initial Parameter Estimation</title>
      <p>In each iteration, a new
peak is added if the stop criteria are not met. The initial values
were estimated to provide informative guesses and reduce the computational
cost of optimization. The initial values for the newly added peak
were estimated from the residual signals by sweeping through a frequency
grid:<disp-formula id="eq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m002" position="anchor"/><label>2</label></disp-formula></p>
      <p>The measured FID <italic>Y<sub>j</sub></italic>(<italic>t</italic>) of bin <italic>j</italic> was compared with the sum of <italic>n –</italic> 1 simulated
signals (<italic>k</italic> ∈ {1 ... <italic>n</italic><italic>–</italic> 1}) to produce the current residual. The signal
with a maximum amplitude was retrieved from the residual as the initial
guess for <italic>A</italic> and <italic>f</italic>. For such a guess,
the frequency was swept with 1,000 values and the default value was
used for and λ as the initial guess. The frequency was found
by the maximum product of the two complex vectors.</p>
    </sec>
    <sec id="sec2.7">
      <title>Parameter Optimization</title>
      <p>A hybrid optimization was used
to estimate peak parameters by minimizing the objective function (<xref rid="eq3" ref-type="disp-formula">eq <xref rid="eq3" ref-type="disp-formula">3</xref></xref>), where θ is the
vector of parameters of all peaks. For computational efficiency, the
optimization includes upper and lower bounds for the allowed values
of the decay λ. We used Metropolis sampling for the global parameter
search<sup><xref ref-type="bibr" rid="ref10">10</xref>,<xref ref-type="bibr" rid="ref46">46</xref></sup> and the interior-point method for the local
parameter refinement.<sup><xref ref-type="bibr" rid="ref47">47</xref></sup> The interior-point
method is the default option in MATLAB for the constrained nonlinear
multivariable function optimization. Metropolis sampling is one of
the Markov chain Monte Carlo (MCMC) methods and constructs a Markov
chain to capture the unknown model and generate results that are consistent
with the observation. The stochastic process can explore a complex
parameter space with many local optima and arrive at the global optima.
Good performance of MCMC has been demonstrated in statistical physics<sup><xref ref-type="bibr" rid="ref46">46</xref></sup> and Bayesian inference.<sup><xref ref-type="bibr" rid="ref48">48</xref>,<xref ref-type="bibr" rid="ref49">49</xref></sup> It has also been applied to biological problems where there are
a large number of parameters, but the measurement is sparse and noisy.<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> The introduction of MCMC can be found here.<sup><xref ref-type="bibr" rid="ref10">10</xref>,<xref ref-type="bibr" rid="ref46">46</xref>,<xref ref-type="bibr" rid="ref49">49</xref></sup><disp-formula id="eq3"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m003" position="anchor"/><label>3</label></disp-formula></p>
      <p>The optimization process
contained an outer loop (iteration) of MCMC optimization with local
refinement in the inner loop (step). One iteration (MCMC sweep) contains
4<italic>N</italic> steps, which is the number of optimizable parameters
(four times the number of peaks). In each MCMC step, a parameter is
selected at random and randomly perturbed. The perturbation depends
on the predefined parameter range and relative step size, which is
bounded by 10% in each step. The proposed perturbation is accepted
or rejected based on the probability (<xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref>) where the synthetic temperature is set to 80 by default
(<xref rid="eq5" ref-type="disp-formula">eq <xref rid="eq5" ref-type="disp-formula">5</xref></xref>). For each FID,
the temperature is adjusted with the estimated standard deviation
based on the FID end with no signals (<xref rid="eq5" ref-type="disp-formula">eq <xref rid="eq5" ref-type="disp-formula">5</xref></xref>). At every 100 MCMC iterations, local optimization
is used to refine the result. There are 4<italic>N</italic> steps
in one iteration and 2,000 iterations (by default) in the optimization
of one binned FID. Multiple optimization runs (default 3) with different
random seeds are performed, and the one with the best objective function
value is selected.<disp-formula id="eq4"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m004" position="anchor"/><label>4</label></disp-formula><disp-formula id="eq5"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m005" position="anchor"/><label>5</label></disp-formula></p>
    </sec>
    <sec id="sec2.8">
      <title>Stop Criteria</title>
      <p>The optimization is stopped when any
of the model complexity criteria are met. The first criterion regards
the improvement from the new signal. The criterion is met if the new
model does not improve the objective function by more than a threshold
(default 0.001). The second criterion regards the number of peaks
in the optimized bin, and the maximum was by default 7. This mostly
aimed to save computational resources for difficult regions as the
computational complexity increased with the maximal number of signals
by approximately a power of three. The third criterion regards the
initial guess amplitude of the new peak. It is true if the new peak
is less than by default 10% of the minimum of all existing peaks in
the bin.</p>
    </sec>
    <sec id="sec2.9">
      <title>Pre-processing Experimental NMR Spectra</title>
      <p>The prednisone–ibuprofen
mixtures were prepared in DMSO-<italic>d</italic><sub>6</sub>, and
the NMR data were collected with a Varian Inova 500 spectrometer.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> The spectra were processed in NMRPipe, including
additional formatting, baseline corrections by polynomial subtraction,
exponential line broadening (1.5 Hz), a scaling maximum to 1,000,
and chemical shift recalibration.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> The
spectra were analyzed with the same set of automated bins. The spike-in
data set was processed in NMRPipe, including manual phasing, a scaling
maximum to 1000, and exponential line broadening (0.3 Hz). Each spectrum
was then automatically binned individually. Pre-processing scripts
for experimental data sets are provided in GitHub.</p>
    </sec>
    <sec id="sec2.10">
      <title>Spike-In Data Set Collection</title>
      <p>A spike-in experiment
was conducted by adding a mixture of compounds to a urine sample.
540 μL of a human urine standard material (Golden West Diagnostics,
LLC) was mixed with 60 μL of phosphate buffer (1.5 mol L<sup>–1</sup> phosphate; 1.1 × 10<sup>–3</sup> mol
L<sup>–1</sup> DSS; pH 7.4) following a previous procedure,<sup><xref ref-type="bibr" rid="ref50">50</xref></sup> and 20 μL of a spike-in solution was sequentially
added to the sample (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>).
NMR spectra were acquired at 298 K using an Avance III 600 MHz spectrometer
equipped with a 5 mm TCI cryoprobe (Bruker). Data were collected using
a one-dimensional 1H detection experiment with water suppression (Bruker
nomenclature, noesypr1d) with the following acquisition parameters:
spectral width of 16.00 ppm, number of points of 32 K, number of scans
of 64, and relaxation delay of 4 s. The digitizer mode (DIGMOD) was
set to base-opt to collect spectra with no first-order phase distortion.
Raw data and parameter sets are available in the Metabolomics Workbench
(Study ST002718 doi: 10.21228/M8WT6H).</p>
    </sec>
    <sec id="sec2.11">
      <title>Correlation Network and Clustering</title>
      <p>To build the correlation
network, we matched peaks by the chemical shift distance between samples
and calculated the Spearman correlation. The edges were selected with
0.9 and 0.5 as the correlation threshold in the simulated data set
and in the prednisone–ibuprofen mixtures. For these two data
sets, the groups of peaks were clear and separated without clustering.</p>
    </sec>
    <sec id="sec2.12">
      <title>Benchmark Data Set Simulation</title>
      <p>The simulation was implemented
in the time domain with preset parameters (<xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref>). We made the simulation resemble the experimental
spectra. One urine spectrum was decomposed into a peak table. The
peak table was refined by selecting an approximately 1.50 ppm region,
removing distorted peak regions, cleaning peak clusters, randomly
sampling λ values, and adding the reference peak at 0.00 ppm.
The peak clusters with a dense overlap were cleaned by removing close
peaks by a threshold of 0.03 ppm. Approximately 100 peaks remained
after the filtering. λ values were uniformly sampled from 1
to 15, and the λ value of the reference peak was defined as
4. Concentrations were uniformly sampled, and the spectra were simulated
with noise. As in experimental data sets, the first point of the FID
was divided by two, and 76 zero points were added in the beginning.
In the simulation with broad peaks, three broad peaks with λ
values greater than or equal to 100 were added. In the simulation
with groups, 18 groups (compounds) were predefined, and within each
group, the peaks maintained a fixed relative ratio of the amplitude
like the peaks of one compound. In the simulation with zero-order
phase distortion, a 0.2 (in radian) phase distortion is added to all
peaks. The simulated NMR spectra then went through pre-processing
and binning steps.</p>
    </sec>
    <sec id="sec2.13">
      <title>Benchmark Evaluation</title>
      <p>SAND was evaluated on simulated
and experimental data sets. SAND results were compared with the peak
intensity, numerical integral, and CRAFT.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> In each bin before the combination, the minimum was shifted to zero,
the maximum intensity was determined, and then, the integral was calculated
by trapezoidal numerical integration. Extracted peaks in the simulated
data were then normalized to the reference peak at 0.00 ppm. Relative
intensities were compared for the ibuprofen–prednisone mixtures.</p>
      <p>The evaluation was based on the divergence between estimation and
ground truth, linearity, and correlation. The MSE (<xref rid="eq6" ref-type="disp-formula">eq <xref rid="eq6" ref-type="disp-formula">6</xref></xref>) was calculated for each matched
peak <italic>e</italic> (total number <italic>N</italic><sub><italic>e</italic></sub>) for one sample <italic>k</italic> and between estimation <italic>x</italic> and ground truth <italic>y</italic>. The relative MSE
(RMSE) had each deviation normalized by the mean (<xref rid="eq7" ref-type="disp-formula">eq <xref rid="eq7" ref-type="disp-formula">7</xref></xref>). The Pearson correlation was used
for correlation. The slope <italic>k</italic> was calculated by fitting
a linear regression model between the estimation and ground truth
with no intercept. Evaluations were calculated within each sample
from which the means and standard errors were calculated.</p>
      <p>
        <disp-formula id="eq6">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m006" position="anchor"/>
          <label>6</label>
        </disp-formula>
        <disp-formula id="eq7">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m007" position="anchor"/>
          <label>7</label>
        </disp-formula>
      </p>
    </sec>
    <sec id="sec2.14">
      <title>NMRbox Integration</title>
      <p>A command line interface was built
for SAND for general users particularly on NMRbox. We provided an
interface for direct control of parameters mentioned in previous sections.
Different FIDs can be assigned and computed by separate machines,
and the computation of the different bins runs in parallel. Parallel
processing through the HTCondor structure is also provided through
a bash shell script. The script assigns each FID to separate core
groups, and for each FID, one submission file is created and then
submitted to the pool.</p>
    </sec>
    <sec sec-type="data-availability" id="sec2.15">
      <title>Code and Data Availability</title>
      <p>The SAND program has been
implemented in MATLAB, R, C-shell, and bash shell. Codes are freely
available through GitHub (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/edisonomics/SAND">https://github.com/edisonomics/SAND</uri>). It was tested on a local iMac Pro computer, sapelo2 at the Georgia
Advance Computing Resource Center (GACRC), and NMRbox servers.<sup><xref ref-type="bibr" rid="ref44">44</xref></sup></p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <sec id="sec3.1">
      <title>Overview of the SAND Computational Workflow</title>
      <p>Given NMR
data as input, SAND uses time-domain models to automatically create
a table of signal parameters describing the corresponding spectrum,
allowing the quantification of individual chemical components (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>). SAND is demonstrated
here with respect to metabolomics data, but it is general and can
be applied to other applications (e.g., macromolecular NMR). Even
when time-domain analysis is used, many intermediate manipulations
are more convenient to perform in the frequency domain before a detailed
analysis including intensity normalization or calibration of chemical
shifts according to a reference compound signal. For this reason,
the usual SAND workflow starts with processed spectra, which are internally
inverse Fourier-processed by SAND as needed. In the examples presented,
NMR data were first collected from biological samples and automatically
processed by NMRPipe or MATLAB (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>B).</p>
      <p>Direct modeling of the whole spectra is computationally
difficult because of the number of parameters required. To simplify
the problem, SAND performs frequency-region-based spectral subsampling
followed by inverse Fourier processing of the subsampled regions (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>C).<sup><xref ref-type="bibr" rid="ref18">18</xref>,<xref ref-type="bibr" rid="ref30">30</xref></sup> SAND then decomposes the time-domain data by fitting a decaying
sinusoid model for each signal and estimating the frequency (often
expressed as a chemical shift for simplicity), decay (λ), amplitude,
and phase (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>D).</p>
      <p>While SAND as presented here uses exponentially decaying
sinusoids
as the underlying signal model, other models could be used, and for
the examples presented here, which use phased spectra as input, the
phase parameter was kept fixed at zero. Since the SAND analysis involves
a parameter space with multiple local optima, Markov chain Monte Carlo
methods are used, and similar approaches were employed by the Bayesian
engine used by CRAFT.<sup><xref ref-type="bibr" rid="ref27">27</xref>,<xref ref-type="bibr" rid="ref30">30</xref></sup> In addition, SAND employs multiple
controls for model complexity, including time-domain subsampling.
Because SAND uses time-domain subsampling (i.e., it analyzes a random
subset of the time-domain points), it is intrinsically suited to nonuniformly
sampled (NUS) applications.<sup><xref ref-type="bibr" rid="ref51">51</xref></sup> In the end,
a mixture spectrum is reduced to a feature table and a list of individual
peaks, quantifying the signals of the metabolome (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>E,F).</p>
    </sec>
    <sec id="sec3.2">
      <title>Evaluation of SAND on Benchmark Data Sets</title>
      <p>Multiple
data sets were simulated to test SAND performance under different
conditions (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figures S1 and S2</ext-link>, and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>). The simulation presented here (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>A) covered a range of 1.50
ppm with highly overlapped peaks and randomly generated concentrations,
and a broad peak overlap was added (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S2</ext-link>). The overall SAND model (black line in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B) agrees well with the measured spectrum
(red line in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B), and SAND uncovered and quantified most of the underlying peaks
accurately (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref> B,C). The estimation (blue peaks in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B) agrees well with the ground truth (green
peaks) even for highly overlapped regions. However, SAND will sometimes
not accurately determine the number of peaks for highly overlapped
regions, modeling a single peak as two smaller peaks (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B, around 7.3 and 7.95 ppm).</p>
      <fig id="fig2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>SAND performance
on simulated benchmarks. SAND was evaluated with
simulated benchmark spectra. (A) Stack plot of 20 simulated spectra
with both narrow and broad peaks. Peaks are highly overlapped with
randomly generated intensities, and the spectra are distinguished
by different colors. An example of a broad peak overlap can be found
in <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S2</ext-link>. (B) Two example regions of
the decomposition with simulated raw spectra are black; sum of decomposed
peaks (red), simulated ground truth peaks (green), and individual
decomposed peaks (blue). Stack spectra are used for plotting with
each individual spectrum shifted differently vertically for clear
visualization. (C) Scatter plot of ground truths (horizontal axis)
and SAND estimations (vertical axis) for the chemical shift, amplitude,
and peak width (λ) in the simulated mixture (A). For the amplitude
plot, data for peaks with closely overlapping peaks are shown in gray,
and data for peaks that are relatively far from neighbor peaks are
shown in red (threshold of 0.01 ppm).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0002" id="gr2" position="float"/>
      </fig>
      <p>This is a common problem for both manual inspection
and previous
decomposition approaches. Globally, the estimation for peak parameters
(chemical shift, amplitude, and peak widths) was accurate with most
points distributed on the diagonal line and a high correlation (∼0.9)
with ground truth (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>C). The effects of high noise and a large peak overlap were
tested on a series of cases with a small narrow peak in the presence
of two broad peaks (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S1</ext-link>). All three
simulated peaks were successfully decomposed in all conditions, and
the small narrow peak was quantified accurately with around 20% relative
error in the worst case even though these most overlapped cases would
be difficult to identify by eye (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S1A</ext-link>).</p>
      <p>SAND was compared with quantification by the peak intensity,
numerical
integral, and CRAFT analysis on simulated (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) and experimental data sets (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S5</ext-link>) with known ground truth (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>). Intensity and integrals can be extracted
automatically in an untargeted analysis. We evaluate the methods based
on the estimation divergencies (mean squared error (MSE) and relative
MSE), slope, and correlation (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>).
Among automatic methods, SAND was consistently better in the more
complex simulated data sets (correlation of 0.88 and <italic>k</italic> of around 0.9), and all methods have near-perfect performances in
the simpler ibuprofen–prednisone mixture. CRAFT has slightly
better performance in two data sets, and this is expected because
the CRAFT result uses the entire time-domain data rather than a subset.
This reveals a small deficit in SAND, where the model parameters are
determined from a subset of the data.</p>
      <p>The ibuprofen–prednisone
experimental mixture data set contains
11 different relative concentrations, and each was repeated three
times.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> There is less overlap in the ibuprofen–prednisone
mixture than in our simulated data set, and relative concentrations
were accurately estimated by SAND and other methods (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S3 and Table S3</ext-link>).</p>
      <p>SAND analysis focuses on phased
spectra but also decomposes spectra
with zero-order phasing problems (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S6</ext-link>), and the performance of parameter estimation is similar (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>).</p>
    </sec>
    <sec id="sec3.3">
      <title>Evaluation of SAND with Metabolomics Mixtures</title>
      <p>We then
tested SAND on experimental data sets with extensive overlap and complexity
(<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>). A mixture of standard compounds
containing <sc>l</sc>-valine, <sc>d</sc>(+)-glucose, 3-nitro-<sc>l</sc>-tyrosine, <italic>N</italic>-(1-carboxyethyl)-<sc>l</sc>-lysine,
and sodium dimethyl silapentane sulfonate (DSS)-<italic>d</italic><sub>6</sub> was spiked into a urine sample in different amounts
(0, 20, 40, 60, and 80 μL) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>), and the peaks were quantified (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). The spike-in changed the pH of the mixture,
and several peaks from both spike-in and urine samples also had chemical
shift changes.</p>
      <fig id="fig3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Decomposition of the spike-in data set. In a urine sample,
different
amounts of a four-compound mixture were spiked in to evaluate SAND
quantification. The orange spectrum is from the spiked-in mixture
alone. The mixture was spiked into the urine sample with different
volumes, and from low to high volumes, the spectra at the bottom are
visualized with darker colors, namely, gray to black. Above the orange
spike-in spectrum, selected regions from the 80 L spike-in urine sample
are shown with both SAND estimation (blue) and measured spectra (black).
On the top, selected examples of the spike-in volume versus signal
amplitude are shown. The axes are presented in the right-side figure
with an <italic>x</italic> axis for the spike-in volumes and <italic>y</italic> axis for the intensity quantification. All other figures
are with the same axes. Values from the spike-in compounds are expected
to vary linearly with the spike-in volume, and they have correlation
values of 0.98 and above (solid lines).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0003" id="gr3" position="float"/>
      </fig>
      <p>As shown in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>, all spectra were effectively decomposed by SAND.
The spike-in peak
amplitudes increased linearly with spike-in volumes (correlation close
to 1) with the slope defined by the relative peak intensity (solid
lines in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>).
The linearity holds for peaks of different relative intensities. For
peaks only in the original urine spectra (dashed lines in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>), the estimation
stayed relatively constant, though the overlap with spike-in compounds
influenced the quantification slightly. Glucose already existed in
the original urine sample, so the linear regression line has a nonzero <italic>Y</italic> intercept.</p>
    </sec>
    <sec id="sec3.4">
      <title>Automatic Annotation Inference</title>
      <p>In addition to compound
quantification, the decomposed features also inform the underlying
chemical associations and annotations. Different peaks of the same
compound should be perfectly correlated at multiple concentrations.
Statistical total correlation spectroscopy (STOCSY) used correlation
to find peaks associated with a targeted peak.<sup><xref ref-type="bibr" rid="ref52">52</xref></sup> A correlation network can also be built to find clusters
of peaks highly correlated with each other, which indicates a possible
compound annotation.<sup><xref ref-type="bibr" rid="ref53">53</xref></sup> Such an approach
can be automatic and untargeted and can characterize novel compounds
that are not in the database or known compounds without relying on
libraries. While peak overlap can introduce false positives, SAND
can improve the results by removing the spectral overlap.</p>
      <p>Annotation
was first tested on simulated mixtures (50 spectra) with 18 groups
of peaks, and in each group (“compound”), peaks were
simulated with fixed relative intensities, like different peaks in
a compound. The concentration of each compound is randomly sampled
from a maximum to 20%. SAND features were matched between samples
by the chemical shift, correlated, and then clustered (details in <xref rid="sec2" ref-type="other">Materials and Methods</xref>). Most peaks of the compounds
(red lines in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>) can be automatically decomposed, clustered, and recovered in one
cluster (blue lines in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>). For most compounds, more than 60% of the ground truth peaks
were recovered in one cluster (mean recovery ratio of 74%) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S4</ext-link>).</p>
      <fig id="fig4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Automatic annotation from SAND decomposition.
Each spectrum is
decomposed into a peak list, and matched peaks among 50 different
samples were correlated and clustered for annotation. One example
mixture spectrum is shown in black, the ground truth spectra in red,
and the estimated spectra of the matched clusters in blue.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0004" id="gr4" position="float"/>
      </fig>
      <p>Automatic annotation was then tested in the ibuprofen–prednisone
mixtures. Two main clusters were uncovered, and each contains many
peaks of the corresponding compound (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S5</ext-link>). One caveat of this data set is that, although the samples are
made from ibuprofen and prednisone, they still contain some other
impurity peaks, such as DMSO and water peaks.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4</label>
    <title>Conclusions</title>
    <p>We built SAND to decompose
the NMR spectra into feature tables.
SAND reduces the dimensionality of metabolomics spectra from tens
of thousands of points to hundreds of peaks, extracts the most interesting
peak features, and relieves the curse of dimensionality in the downstream
statistical analysis. Such an automatic process also frees researchers
from the tedious work of manual peak picking or binning.</p>
    <p>One
goal of SAND is to enable reproducible automatic quantification
of large-scale NMR metabolomic studies as in other omics approaches.<sup><xref ref-type="bibr" rid="ref54">54</xref>−<xref ref-type="bibr" rid="ref56">56</xref></sup> Currently, SAND can be used via NMRPipe<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> and the resources of NMRbox<sup><xref ref-type="bibr" rid="ref44">44</xref></sup> with analysis
initiated via a single command from a terminal window or shell script,
making it easy to integrate SAND with other workflows and analysis
tools on the NMRbox platform. An entire workflow can be run within
NMRbox, which provides high-capacity data storage and improves reproducibility.
SAND will be further built into the workflows for the Network for
Advanced NMR (NAN), which is an NSF-funded national network that facilitates
resource discovery, data collection, data storage and transfer, and
NMR data analysis. Metabolomics NMR spectra can be tagged and decomposed
automatically in this workflow, and clean peak tables are returned
to users. Initial pre-processing by the user using either autophasing
or manually adjusted phase values is preferred but not always needed
(<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S6</ext-link>).</p>
    <p>In our future plans
for SAND, we intend to replace the slow MATLAB
implementation with a faster, more readily parallelizable version
implemented in C/C++. The current version of SAND is tuned for high-resolution
metabolomics spectra; we also intend to accommodate other cases. Along
these lines, SAND can potentially be expanded to include nonexponential
signals. An example is given in <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S7</ext-link>, which shows a region of the prednisone spectrum with peaks identified
by SAND subject to a second round of optimization using an exponential
+ Gaussian model. Our ultimate goal is to explore the intriguing possibility
of adapting SAND to multidimensional applications. We note that this
has particular promise because SAND is a variety of nonuniform sampling
analyses, where quantification of time-domain data could potentially
avoid the need for complete spectral reconstruction.</p>
  </sec>
</body>
<back>
  <notes id="notes1" notes-type="si">
    <title>Supporting Information Available</title>
    <p>The Supporting Information
is
available free of charge at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/10.1021/acs.analchem.3c03078?goto=supporting-info">https://pubs.acs.org/doi/10.1021/acs.analchem.3c03078</ext-link>.<list id="silist" list-type="simple"><list-item><p>Simulation example for overlapping and moving peaks,
visualization of overlap between broad and narrow peaks, scatter plot
for the amplitude estimation in the ibuprofen–prednisone mixture
data set, performance of recovering clusters in the simulated data
set, automatic annotation in an experimental mixture, SAND performance
on simulated spectra with phase distortion, SAND peaks remodeled with
exponential + Gaussian model, list of compounds and concentrations
in the spike-in solution, design of the spike-in experiment, and performance
of different quantification methods (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">PDF</ext-link>)</p></list-item><list-item><p>Tutorial slides for using SAND via
NMRPipe (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_002.pdf">PDF</ext-link>)</p></list-item></list></p>
  </notes>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sifile1">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_si_001.pdf">
        <caption>
          <p>ac3c03078_si_001.pdf</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sifile2">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_si_002.pdf">
        <caption>
          <p>ac3c03078_si_002.pdf</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <notes notes-type="" id="notes2">
    <title>Author Contributions</title>
    <p>A.S.E., F.D.,
and Y.W. conceived the project idea. Y.W. and F.D. designed the SAND
program. Y.W. and O.S. wrote the SAND program. Y.W. and O.S. tested
the SAND program with different data, benchmarks, and environments.
F.D., O.S., and Y.W. tested SAND on NMRbox and built the tutorial.
M.U. collected the spike-in experiment data. K.K. ran the benchmark
on CRAFT. All authors contributed to the manuscript writing and have
given approval to the final version of the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement" id="notes3">
    <p>The authors
declare no competing financial interest.</p>
  </notes>
  <notes notes-type="" id="notes4">
    <title>Notes</title>
    <p>Certain commercial equipment, instruments, and
materials are identified in this paper in order to specify the experimental
procedure. Such identification does not imply recommendation or endorsement
by the National Institute of Standards and Technology, nor does it
imply that the material or equipment identified is necessarily the
best available for the purpose.</p>
  </notes>
  <notes notes-type="" id="notes5">
    <title>Notes</title>
    <p>Not
Human Subjects Research: The National Institute
of Standards and Technology Research Protections Office reviewed the
protocol for this project and determined it is “not human subjects
research” as defined in 15 CFR 27, the Common Rule for the
Protection of Human Subjects.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Sicong Zhang for providing the buffer for
the spike-in experiment. We thank Mark W. Maciejewski and Chad Rienstra
for useful discussions. We appreciate computational support from GACRC,
especially Shan-Ho Tsai and Zhuofei Hou. This work was supported by
the NSF no. 1946970: Midscale RI-2 Consortium: Network for Advanced
NMR. This study made use of NMRbox: National Center for Biomolecular
NMR Data Processing and Analysis, a Biomedical Technology Research
Resource (BTRR), which is supported by NIH grant no. P41GM111135 (NIGMS).
We appreciated Gerard Weatherby for supporting the computing in NMRbox.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Wu</surname><given-names>Y.</given-names></name>; <name><surname>Tayyari</surname><given-names>F.</given-names></name>; <name><surname>Hattori</surname><given-names>A.</given-names></name>; <name><surname>Glushka</surname><given-names>J.</given-names></name>; <name><surname>Ito</surname><given-names>T.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name><article-title>Continuous in vivo Metabolism by
NMR</article-title>. <source>Front. Mol. Biosci.</source><year>2019</year>, <volume>6</volume>, <fpage>26</fpage><pub-id pub-id-type="doi">10.3389/fmolb.2019.00026</pub-id>.<pub-id pub-id-type="pmid">31114791</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="journal" id="cit2"><name><surname>Link</surname><given-names>H.</given-names></name>; <name><surname>Fuhrer</surname><given-names>T.</given-names></name>; <name><surname>Gerosa</surname><given-names>L.</given-names></name>; <name><surname>Zamboni</surname><given-names>N.</given-names></name>; <name><surname>Sauer</surname><given-names>U.</given-names></name><article-title>Real-time
metabolome profiling of the metabolic switch between starvation and
growth</article-title>. <source>Nat. Methods</source><year>2015</year>, <volume>12</volume> (<issue>11</issue>), <fpage>1091</fpage>–<lpage>1097</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3584</pub-id>.<pub-id pub-id-type="pmid">26366986</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>Colonna</surname><given-names>M.</given-names></name>; <name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Holderman</surname><given-names>N. R.</given-names></name>; <name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Shen</surname><given-names>X. N.</given-names></name>; <name><surname>Zhang</surname><given-names>S. C.</given-names></name><article-title>NMR: Unique
Strengths
That Enhance Modern Metabolomics Research</article-title>. <source>Analytical
chemistry</source><year>2021</year>, <volume>93</volume> (<issue>1</issue>), <fpage>478</fpage>–<lpage>499</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.0c04414</pub-id>.<pub-id pub-id-type="pmid">33180470</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Bifarin</surname><given-names>O. O.</given-names></name>; <name><surname>Gaul</surname><given-names>D. A.</given-names></name>; <name><surname>Sah</surname><given-names>S.</given-names></name>; <name><surname>Arnold</surname><given-names>R. S.</given-names></name>; <name><surname>Ogan</surname><given-names>K.</given-names></name>; <name><surname>Master</surname><given-names>V. A.</given-names></name>; <name><surname>Roberts</surname><given-names>D. L.</given-names></name>; <name><surname>Bergquist</surname><given-names>S. H.</given-names></name>; <name><surname>Petros</surname><given-names>J. A.</given-names></name>; <name><surname>Fernandez</surname><given-names>F. M.</given-names></name>; et al. <article-title>Machine Learning-Enabled
Renal Cell Carcinoma Status Prediction Using Multiplatform Urine-Based
Metabolomics</article-title>. <source>J. Proteome Res.</source><year>2021</year>, <volume>20</volume> (<issue>7</issue>), <fpage>3629</fpage>–<lpage>3641</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.1c00213</pub-id>.<pub-id pub-id-type="pmid">34161092</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="journal" id="cit5"><name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Shaver</surname><given-names>A. O.</given-names></name>; <name><surname>Garcia</surname><given-names>B. M.</given-names></name>; <name><surname>Morse</surname><given-names>A. M.</given-names></name>; <name><surname>Andersen</surname><given-names>E. C.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>McIntyre</surname><given-names>L. M.</given-names></name><article-title>Long-Term Metabolomics Reference
Material</article-title>. <source>Analytical chemistry</source><year>2021</year>, <volume>93</volume> (<issue>26</issue>), <fpage>9193</fpage>–<lpage>9199</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.1c01294</pub-id>.<pub-id pub-id-type="pmid">34156835</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Maughon</surname><given-names>T. S.</given-names></name>; <name><surname>Shen</surname><given-names>X. N.</given-names></name>; <name><surname>Huang</surname><given-names>D. N.</given-names></name>; <name><surname>Michael</surname><given-names>A. O. A.</given-names></name>; <name><surname>Shockey</surname><given-names>W. A.</given-names></name>; <name><surname>Andrews</surname><given-names>S. H.</given-names></name>; <name><surname>McRae</surname><given-names>J. M.</given-names></name>; <name><surname>Platt</surname><given-names>M. O.</given-names></name>; <name><surname>Fernandez</surname><given-names>F. M.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; et al. <article-title>Metabolomics and cytokine profiling of mesenchymal
stromal cells identify markers predictive of T-cell suppression</article-title>. <source>Cytotherapy</source><year>2022</year>, <volume>24</volume> (<issue>2</issue>), <fpage>137</fpage>–<lpage>148</lpage>. <pub-id pub-id-type="doi">10.1016/j.jcyt.2021.08.002</pub-id>.<pub-id pub-id-type="pmid">34696960</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Shaver</surname><given-names>A. O.</given-names></name>; <name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Kirby</surname><given-names>P. S.</given-names></name>; <name><surname>Andersen</surname><given-names>E. C.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name><article-title>Culture
and Assay of Large-Scale Mixed-Stage Caenorhabditis elegans Populations</article-title>. <source>Jove-J. Vis Exp</source><year>2021</year>, <volume>171</volume>, <elocation-id>e61453</elocation-id><pub-id pub-id-type="doi">10.3791/61453</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>Choe</surname><given-names>A.</given-names></name>; <name><surname>Chuman</surname><given-names>T.</given-names></name>; <name><surname>von Reuss</surname><given-names>S. H.</given-names></name>; <name><surname>Dossey</surname><given-names>A. T.</given-names></name>; <name><surname>Yim</surname><given-names>J. J.</given-names></name>; <name><surname>Ajredini</surname><given-names>R.</given-names></name>; <name><surname>Kolawa</surname><given-names>A. A.</given-names></name>; <name><surname>Kaplan</surname><given-names>F.</given-names></name>; <name><surname>Alborn</surname><given-names>H. T.</given-names></name>; <name><surname>Teal</surname><given-names>P. E. A.</given-names></name>; et al. <article-title>Sex-specific mating pheromones in the nematode
Panagrellus redivivus</article-title>. <source>Proc. Natl. Acad. Sci.
U.S.A.</source><year>2012</year>, <volume>109</volume> (<issue>51</issue>), <fpage>20949</fpage>–<lpage>20954</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1218302109</pub-id>.<pub-id pub-id-type="pmid">23213209</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><person-group person-group-type="allauthors"><name><surname>Bastawrous</surname><given-names>M.</given-names></name>, <name><surname>Jenne</surname><given-names>A.</given-names></name>, <name><surname>Tabatabaei Anaraki</surname><given-names>M.</given-names></name>; <name><surname>Simpson</surname><given-names>A. J.</given-names></name></person-group><article-title>In-Vivo NMR Spectroscopy: A Powerful and Complimentary Tool for Understanding
Environmental Toxicity</article-title>. <source>Metabolites</source><year>2018</year>, <volume>8</volume> ( (<issue>2</issue>), ). DOI: <fpage>35</fpage><pub-id pub-id-type="doi">10.3390/metabo8020035</pub-id>.<pub-id pub-id-type="pmid">29795000</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Battogtokh</surname><given-names>D.</given-names></name>; <name><surname>Asch</surname><given-names>D. K.</given-names></name>; <name><surname>Case</surname><given-names>M. E.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name>; <name><surname>Schuttler</surname><given-names>H. B.</given-names></name><article-title>An ensemble
method for identifying regulatory circuits with special reference
to the qa gene cluster of Neurospora crassa</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2002</year>, <volume>99</volume> (<issue>26</issue>), <fpage>16904</fpage>–<lpage>16909</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.262658899</pub-id>.<pub-id pub-id-type="pmid">12477937</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><name><surname>Fuhrer</surname><given-names>T.</given-names></name>; <name><surname>Zampieri</surname><given-names>M.</given-names></name>; <name><surname>Sevin</surname><given-names>D. C.</given-names></name>; <name><surname>Sauer</surname><given-names>U.</given-names></name>; <name><surname>Zamboni</surname><given-names>N.</given-names></name><article-title>Genomewide
landscape of gene-metabolome associations in Escherichia coli</article-title>. <source>Mol. Syst. Biol.</source><year>2017</year>, <volume>13</volume> (<issue>1</issue>), <fpage>907</fpage><pub-id pub-id-type="doi">10.15252/msb.20167150</pub-id>.<pub-id pub-id-type="pmid">28093455</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="journal" id="cit12"><name><surname>Ernst</surname><given-names>R. R.</given-names></name>; <name><surname>Anderson</surname><given-names>W. A.</given-names></name><article-title>Application of Fourier Transform Spectroscopy to Magnetic
Resonance</article-title>. <source>Rev. Sci. Instrum.</source><year>1966</year>, <volume>37</volume> (<issue>1</issue>), <fpage>93</fpage><pub-id pub-id-type="doi">10.1063/1.1719961</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Whiley</surname><given-names>L.</given-names></name>; <name><surname>Chekmeneva</surname><given-names>E.</given-names></name>; <name><surname>Berry</surname><given-names>D. J.</given-names></name>; <name><surname>Jimenez</surname><given-names>B.</given-names></name>; <name><surname>Yuen</surname><given-names>A. H. Y.</given-names></name>; <name><surname>Salam</surname><given-names>A.</given-names></name>; <name><surname>Hussain</surname><given-names>H.</given-names></name>; <name><surname>Witt</surname><given-names>M.</given-names></name>; <name><surname>Takats</surname><given-names>Z.</given-names></name>; <name><surname>Nicholson</surname><given-names>J.</given-names></name>; et al. <article-title>Systematic Isolation and Structure Elucidation
of Urinary Metabolites Optimized for the Analytical-Scale Molecular
Profiling Laboratory</article-title>. <source>Analytical chemistry</source><year>2019</year>, <volume>91</volume> (<issue>14</issue>), <fpage>8873</fpage>–<lpage>8882</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.9b00241</pub-id>.<pub-id pub-id-type="pmid">31188566</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="journal" id="cit14"><name><surname>Johnson</surname><given-names>C. S.</given-names></name><article-title>Diffusion
ordered nuclear magnetic resonance spectroscopy: principles and applications</article-title>. <source>Prog. Nucl. Magn. Reson. Spectrosc.</source><year>1999</year>, <volume>34</volume> (<issue>3–4</issue>), <fpage>203</fpage>–<lpage>256</lpage>. <pub-id pub-id-type="doi">10.1016/S0079-6565(99)00003-5</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <mixed-citation publication-type="journal" id="cit15"><name><surname>Aue</surname><given-names>W. P.</given-names></name>; <name><surname>Karhan</surname><given-names>J.</given-names></name>; <name><surname>Ernst</surname><given-names>R. R.</given-names></name><article-title>Homonuclear
Broad-Band Decoupling
and 2-Dimensional J-Resolved Nmr-Spectroscopy</article-title>. <source>J. Chem. Phys.</source><year>1976</year>, <volume>64</volume> (<issue>10</issue>), <fpage>4226</fpage>–<lpage>4227</lpage>. <pub-id pub-id-type="doi">10.1063/1.431994</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <mixed-citation publication-type="journal" id="cit16"><name><surname>Meiboom</surname><given-names>S.</given-names></name>; <name><surname>Gill</surname><given-names>D.</given-names></name><article-title>Modified Spin-Echo
Method for Measuring Nuclear Relaxation Times</article-title>. <source>Rev. Sci. Instrum.</source><year>1958</year>, <volume>29</volume> (<issue>8</issue>), <fpage>688</fpage>–<lpage>691</lpage>. <pub-id pub-id-type="doi">10.1063/1.1716296</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <mixed-citation publication-type="journal" id="cit17"><name><surname>Carr</surname><given-names>H. Y.</given-names></name>; <name><surname>Purcell</surname><given-names>E. M.</given-names></name><article-title>Effects of Diffusion on Free Precession in Nuclear
Magnetic Resonance Experiments</article-title>. <source>Phys. Rev.</source><year>1954</year>, <volume>94</volume> (<issue>3</issue>), <fpage>630</fpage>–<lpage>638</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRev.94.630</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <mixed-citation publication-type="journal" id="cit18"><name><surname>Sousa</surname><given-names>S. A. A.</given-names></name>; <name><surname>Magalhaes</surname><given-names>A.</given-names></name>; <name><surname>Ferreira</surname><given-names>M. M. C.</given-names></name><article-title>Optimized bucketing for NMR spectra:
Three case studies</article-title>. <source>Chemometr. Intell. Lab.</source><year>2013</year>, <volume>122</volume>, <fpage>93</fpage>–<lpage>102</lpage>. <pub-id pub-id-type="doi">10.1016/j.chemolab.2013.01.006</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <mixed-citation publication-type="journal" id="cit19"><name><surname>Hao</surname><given-names>J.</given-names></name>; <name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Ebbels</surname><given-names>T. M. D.</given-names></name><article-title>BATMAN-an R package
for the automated quantification of metabolites from nuclear magnetic
resonance spectra using a Bayesian model</article-title>. <source>Bioinformatics</source><year>2012</year>, <volume>28</volume> (<issue>15</issue>), <fpage>2088</fpage>–<lpage>2090</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts308</pub-id>.<pub-id pub-id-type="pmid">22635605</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref20">
      <mixed-citation publication-type="journal" id="cit20"><name><surname>Hao</surname><given-names>J.</given-names></name>; <name><surname>Liebeke</surname><given-names>M.</given-names></name>; <name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Bundy</surname><given-names>J. G.</given-names></name>; <name><surname>Ebbels</surname><given-names>T. M. D.</given-names></name><article-title>Bayesian
deconvolution and quantification of metabolites
in complex 1D NMR spectra using BATMAN</article-title>. <source>Nature
protocols</source><year>2014</year>, <volume>9</volume> (<issue>6</issue>), <fpage>1416</fpage>–<lpage>1427</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2014.090</pub-id>.<pub-id pub-id-type="pmid">24853927</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref21">
      <mixed-citation publication-type="journal" id="cit21"><name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Richardson</surname><given-names>S.</given-names></name>; <name><surname>Stephens</surname><given-names>D.</given-names></name>; <name><surname>Ebbels</surname><given-names>T.</given-names></name><article-title>A Bayesian
Model of NMR Spectra for the Deconvolution and Quantification of Metabolites
in Complex Biological Mixtures</article-title>. <source>J. Am. Stat
Assoc</source><year>2012</year>, <volume>107</volume> (<issue>500</issue>), <fpage>1259</fpage>–<lpage>1271</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.2012.695661</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <mixed-citation publication-type="journal" id="cit22"><name><surname>Zheng</surname><given-names>C.</given-names></name>; <name><surname>Zhang</surname><given-names>S. C.</given-names></name>; <name><surname>Ragg</surname><given-names>S.</given-names></name>; <name><surname>Raftery</surname><given-names>D.</given-names></name>; <name><surname>Vitek</surname><given-names>O.</given-names></name><article-title>Identification
and quantification of metabolites in H-1 NMR spectra by Bayesian model
selection</article-title>. <source>Bioinformatics</source><year>2011</year>, <volume>27</volume> (<issue>12</issue>), <fpage>1637</fpage>–<lpage>1644</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr118</pub-id>.<pub-id pub-id-type="pmid">21398670</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref23">
      <mixed-citation publication-type="journal" id="cit23"><name><surname>Ravanbakhsh</surname><given-names>S.</given-names></name>; <name><surname>Liu</surname><given-names>P.</given-names></name>; <name><surname>Bjorndahl</surname><given-names>T. C.</given-names></name>; <name><surname>Mandal</surname><given-names>R.</given-names></name>; <name><surname>Grant</surname><given-names>J. R.</given-names></name>; <name><surname>Wilson</surname><given-names>M.</given-names></name>; <name><surname>Eisner</surname><given-names>R.</given-names></name>; <name><surname>Sinelnikov</surname><given-names>I.</given-names></name>; <name><surname>Hu</surname><given-names>X. Y.</given-names></name>; <name><surname>Luchinat</surname><given-names>C.</given-names></name>; et al. <article-title>Accurate,
Fully-Automated NMR Spectral Profiling for Metabolomics
(vol 10, e0124219, 2015)</article-title>. <source>PloS one</source><year>2015</year>, <volume>10</volume> (<issue>7</issue>), <elocation-id>e0132873</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0132873</pub-id>.<pub-id pub-id-type="pmid">26222058</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref24">
      <mixed-citation publication-type="journal" id="cit24"><name><surname>Tredwell</surname><given-names>G. D.</given-names></name>; <name><surname>Behrends</surname><given-names>V.</given-names></name>; <name><surname>Geier</surname><given-names>F. M.</given-names></name>; <name><surname>Liebeke</surname><given-names>M.</given-names></name>; <name><surname>Bundy</surname><given-names>J. G.</given-names></name><article-title>Between-Person
Comparison of Metabolite Fitting for NMR-Based Quantitative Metabolomics</article-title>. <source>Analytical chemistry</source><year>2011</year>, <volume>83</volume> (<issue>22</issue>), <fpage>8683</fpage>–<lpage>8687</lpage>. <pub-id pub-id-type="doi">10.1021/ac202123k</pub-id>.<pub-id pub-id-type="pmid">21988367</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref25">
      <mixed-citation publication-type="book" id="cit25"><person-group person-group-type="allauthors"><name><surname>de Beer</surname><given-names>R.</given-names></name>; <name><surname>van Ormondt</surname><given-names>D.</given-names></name></person-group> in <source>In-Vivo Magnetic Resonance
Spectroscopy I: Probeheads and Radiofrequency Pulses Spectrum Analysis</source> (ed <person-group person-group-type="editor"><string-name><given-names>M.</given-names>, <surname>Rudin</surname></string-name></person-group>) <fpage>201</fpage>–<lpage>248</lpage> (<publisher-name>Springer Berlin Heidelberg</publisher-name>, <year>1992</year>).</mixed-citation>
    </ref>
    <ref id="ref26">
      <mixed-citation publication-type="journal" id="cit26"><name><surname>Sekihara</surname><given-names>K.</given-names></name>; <name><surname>Ohyama</surname><given-names>N.</given-names></name><article-title>Parameter estimation
for in vivo magnetic resonance
spectroscopy (MRS) using simulated annealing</article-title>. <source>Magn Reson Med.</source><year>1990</year>, <volume>13</volume> (<issue>2</issue>), <fpage>332</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.1910130217</pub-id>.<pub-id pub-id-type="pmid">2314222</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref27">
      <mixed-citation publication-type="journal" id="cit27"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.1. Parameter-Estimation Using Quadrature Nmr Models</article-title>. <source>J. Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>533</fpage>–<lpage>551</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90287-J</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref28">
      <mixed-citation publication-type="journal" id="cit28"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.2. Signal-Detection and Model Selection</article-title>. <source>J.
Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>552</fpage>–<lpage>570</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90288-K</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <mixed-citation publication-type="journal" id="cit29"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.3. Applications to Nmr Signal-Detection, Model Selection, and Parameter-Estimation</article-title>. <source>J. Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>571</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90289-L</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref30">
      <mixed-citation publication-type="journal" id="cit30"><name><surname>Krishnamurthy</surname><given-names>K.</given-names></name><article-title>CRAFT (complete
reduction to amplitude frequency table) - robust and time-efficient
Bayesian approach for quantitative mixture analysis by NMR</article-title>. <source>Magn. Reson. Chem.</source><year>2013</year>, <volume>51</volume> (<issue>12</issue>), <fpage>821</fpage>–<lpage>829</lpage>. <pub-id pub-id-type="doi">10.1002/mrc.4022</pub-id>.<pub-id pub-id-type="pmid">24154986</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref31">
      <mixed-citation publication-type="journal" id="cit31"><name><surname>Krishnamurthy</surname><given-names>K.</given-names></name><article-title>Complete Reduction
to Amplitude Frequency Table (CRAFT)-A perspective</article-title>. <source>Magn. Reson. Chem.</source><year>2021</year>, <volume>59</volume> (<issue>8</issue>), <fpage>757</fpage>–<lpage>791</lpage>. <pub-id pub-id-type="doi">10.1002/mrc.5135</pub-id>.<pub-id pub-id-type="pmid">33486830</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref32">
      <mixed-citation publication-type="journal" id="cit32"><name><surname>Rubtsov</surname><given-names>D. V.</given-names></name>; <name><surname>Waterman</surname><given-names>C.</given-names></name>; <name><surname>Currie</surname><given-names>R. A.</given-names></name>; <name><surname>Waterfield</surname><given-names>C.</given-names></name>; <name><surname>Salazar</surname><given-names>J. D.</given-names></name>; <name><surname>Wright</surname><given-names>J.</given-names></name>; <name><surname>Griffin</surname><given-names>J. L.</given-names></name><article-title>Application
of a
Bayesian Deconvolution Approach for High-Resolution 1H NMR Spectra
to Assessing the Metabolic Effects of Acute Phenobarbital Exposure
in Liver Tissue</article-title>. <source>Analytical chemistry</source><year>2010</year>, <volume>82</volume> (<issue>11</issue>), <fpage>4479</fpage>–<lpage>4485</lpage>. <pub-id pub-id-type="doi">10.1021/ac100344m</pub-id>.<pub-id pub-id-type="pmid">20446676</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref33">
      <mixed-citation publication-type="journal" id="cit33"><name><surname>Rubtsov</surname><given-names>D.
V.</given-names></name>; <name><surname>Griffin</surname><given-names>J. L.</given-names></name><article-title>Time-domain
Bayesian detection and estimation of noisy
damped sinusoidal signals applied to NMR spectroscopy</article-title>. <source>J. Magn. Reson.</source><year>2007</year>, <volume>188</volume> (<issue>2</issue>), <fpage>367</fpage>–<lpage>379</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2007.08.008</pub-id>.<pub-id pub-id-type="pmid">17827043</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref34">
      <mixed-citation publication-type="journal" id="cit34"><name><surname>Matviychuk</surname><given-names>Y.</given-names></name>; <name><surname>von Harbou</surname><given-names>E.</given-names></name>; <name><surname>Holland</surname><given-names>D. J.</given-names></name><article-title>An experimental validation of a Bayesian
model for quantification in NMR spectroscopy</article-title>. <source>J. Magn. Reson.</source><year>2017</year>, <volume>285</volume>, <fpage>86</fpage>–<lpage>100</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2017.10.009</pub-id>.<pub-id pub-id-type="pmid">29127944</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <mixed-citation publication-type="journal" id="cit35"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>An Introduction
to Parameter-Estimation Using Bayesian Probability-Theory</article-title>. <source>Fund Theor</source><year>1990</year>, <volume>39</volume>, <fpage>53</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1007/978-94-009-0683-9_5</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref36">
      <mixed-citation publication-type="journal" id="cit36"><name><surname>Hoch</surname><given-names>J. C.</given-names></name><article-title>Modern
Spectrum Analysis in Nuclear Magnetic-Resonance - Alternatives to
the Fourier-Transform</article-title>. <source>Methods Enzymol.</source><year>1989</year>, <volume>176</volume>, <fpage>216</fpage>–<lpage>241</lpage>. <pub-id pub-id-type="doi">10.1016/0076-6879(89)76014-6</pub-id>.<pub-id pub-id-type="pmid">2811688</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <mixed-citation publication-type="journal" id="cit37"><name><surname>Barkhuijsen</surname><given-names>H.</given-names></name>; <name><surname>Debeer</surname><given-names>R.</given-names></name>; <name><surname>Bovee</surname><given-names>W. M. M. J.</given-names></name>; <name><surname>Vanormondt</surname><given-names>D.</given-names></name><article-title>Retrieval
of Frequencies, Amplitudes, Damping Factors, and Phases from Time-Domain
Signals Using a Linear Least-Squares Procedure</article-title>. <source>J. Magn. Reson.</source><year>1985</year>, <volume>61</volume> (<issue>3</issue>), <fpage>465</fpage>–<lpage>481</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(85)90187-8</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref38">
      <mixed-citation publication-type="journal" id="cit38"><name><surname>Barkhuijsen</surname><given-names>H.</given-names></name>; <name><surname>Debeer</surname><given-names>R.</given-names></name>; <name><surname>Vanormondt</surname><given-names>D.</given-names></name><article-title>Improved Algorithm
for Noniterative
Time-Domain Model-Fitting to Exponentially Damped Magnetic-Resonance
Signals</article-title>. <source>J. Magn. Reson.</source><year>1987</year>, <volume>73</volume> (<issue>3</issue>), <fpage>553</fpage>–<lpage>557</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(87)90023-0</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <mixed-citation publication-type="journal" id="cit39"><name><surname>Djermoune</surname><given-names>E. H.</given-names></name>; <name><surname>Tomczak</surname><given-names>M.</given-names></name>; <name><surname>Brie</surname><given-names>D.</given-names></name><article-title>NMR Data Analysis:
A Time-Domain
Parametric Approach Using Adaptive Subband Decomposition</article-title>. <source>Oil Gas Sci. Technol.</source><year>2014</year>, <volume>69</volume> (<issue>2</issue>), <fpage>229</fpage>–<lpage>244</lpage>. <pub-id pub-id-type="doi">10.2516/ogst/2012092</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref40">
      <mixed-citation publication-type="journal" id="cit40"><name><surname>Koehl</surname><given-names>P.</given-names></name><article-title>Linear prediction
spectral analysis of NMR data</article-title>. <source>Prog. Nucl. Magn.
Reson. Spectrosc.</source><year>1999</year>, <volume>34</volume> (<issue>3–4</issue>), <fpage>257</fpage>–<lpage>299</lpage>. <pub-id pub-id-type="doi">10.1016/S0079-6565(99)00002-3</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref41">
      <mixed-citation publication-type="journal" id="cit41"><name><surname>Tang</surname><given-names>J.</given-names></name>; <name><surname>Norris</surname><given-names>J.</given-names></name><article-title>LP-ZOOM, a linear prediction
method for local spectral
analysis of NMR signals</article-title>. <source>Journal of Magnetic
Resonance (1969)</source><year>1988</year>, <volume>79</volume> (<issue>1</issue>), <fpage>190</fpage>–<lpage>196</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(88)90338-1</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref42">
      <mixed-citation publication-type="journal" id="cit42"><name><surname>Mandelshtam</surname><given-names>V. A.</given-names></name>; <name><surname>Taylor</surname><given-names>H. S.</given-names></name><article-title>Multidimensional harmonic inversion
by filter-diagonalization</article-title>. <source>J. Chem. Phys.</source><year>1998</year>, <volume>108</volume> (<issue>24</issue>), <fpage>9970</fpage>–<lpage>9977</lpage>. <pub-id pub-id-type="doi">10.1063/1.476495</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref43">
      <mixed-citation publication-type="undeclared" id="cit43"><person-group person-group-type="allauthors"><name><surname>Cobas</surname><given-names>C.</given-names></name>, <name><surname>Seoane</surname><given-names>F.</given-names></name>, <name><surname>Sykora</surname><given-names>S.</given-names></name></person-group><source>Global Spectral
Deconvolution
(GSD) of 1D-NMR spectra</source>, &lt; <pub-id pub-id-type="doi">10.3247/sl2nmr08.011&gt;</pub-id> (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="ref44">
      <mixed-citation publication-type="journal" id="cit44"><name><surname>Maciejewski</surname><given-names>M. W.</given-names></name>; <name><surname>Schuyler</surname><given-names>A. D.</given-names></name>; <name><surname>Gryk</surname><given-names>M. R.</given-names></name>; <name><surname>Moraru</surname><given-names>I. I.</given-names></name>; <name><surname>Romero</surname><given-names>P. R.</given-names></name>; <name><surname>Ulrich</surname><given-names>E. L.</given-names></name>; <name><surname>Eghbalnia</surname><given-names>H. R.</given-names></name>; <name><surname>Livny</surname><given-names>M.</given-names></name>; <name><surname>Delaglio</surname><given-names>F.</given-names></name>; <name><surname>Hoch</surname><given-names>J. C.</given-names></name><article-title>NMRbox:
A Resource for Biomolecular NMR Computation</article-title>. <source>Biophys. J.</source><year>2017</year>, <volume>112</volume> (<issue>8</issue>), <fpage>1529</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2017.03.011</pub-id>.<pub-id pub-id-type="pmid">28445744</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref45">
      <mixed-citation publication-type="journal" id="cit45"><name><surname>Delaglio</surname><given-names>F.</given-names></name>; <name><surname>Grzesiek</surname><given-names>S.</given-names></name>; <name><surname>Vuister</surname><given-names>G. W.</given-names></name>; <name><surname>Zhu</surname><given-names>G.</given-names></name>; <name><surname>Pfeifer</surname><given-names>J.</given-names></name>; <name><surname>Bax</surname><given-names>A.</given-names></name><article-title>Nmrpipe - a Multidimensional Spectral
Processing System Based on
Unix Pipes</article-title>. <source>J. Biomol Nmr</source><year>1995</year>, <volume>6</volume> (<issue>3</issue>), <fpage>277</fpage>–<lpage>293</lpage>. <pub-id pub-id-type="doi">10.1007/BF00197809</pub-id>.<pub-id pub-id-type="pmid">8520220</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref46">
      <mixed-citation publication-type="book" id="cit46"><person-group person-group-type="allauthors"><name><surname>Landau</surname><given-names>D. P.</given-names></name>; <name><surname>Binder</surname><given-names>K.</given-names></name></person-group><source>A Guide to Monte Carlo
Simulations in Statistical Physics</source>. <edition>4</edition> edn,
(<publisher-name>Cambridge University Press</publisher-name>, <year>2014</year>).</mixed-citation>
    </ref>
    <ref id="ref47">
      <mixed-citation publication-type="journal" id="cit47"><name><surname>Byrd</surname><given-names>R. H.</given-names></name>; <name><surname>Gilbert</surname><given-names>J. C.</given-names></name>; <name><surname>Nocedal</surname><given-names>J.</given-names></name><article-title>A trust region
method based on interior
point techniques for nonlinear programming</article-title>. <source>Math Program</source><year>2000</year>, <volume>89</volume> (<issue>1</issue>), <fpage>149</fpage>–<lpage>185</lpage>. <pub-id pub-id-type="doi">10.1007/PL00011391</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref48">
      <mixed-citation publication-type="journal" id="cit48"><name><surname>Salvatier</surname><given-names>J.</given-names></name>; <name><surname>Wiecki</surname><given-names>T. V.</given-names></name>; <name><surname>Fonnesbeck</surname><given-names>C.</given-names></name><article-title>Probabilistic programming in Python
using PyMC3</article-title>. <source>Peerj Comput. Sci.</source><year>2016</year>, <volume>2</volume>, <elocation-id>e55</elocation-id><pub-id pub-id-type="doi">10.7717/peerj-cs.55</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref49">
      <mixed-citation publication-type="book" id="cit49"><person-group person-group-type="allauthors"><name><surname>Liu</surname><given-names>J. S.</given-names></name></person-group><source>Monte Carlo strategies
in scientific computing</source>. (<publisher-name>Springer</publisher-name>, <year>2001</year>).</mixed-citation>
    </ref>
    <ref id="ref50">
      <mixed-citation publication-type="journal" id="cit50"><name><surname>Dona</surname><given-names>A. C.</given-names></name>; <name><surname>Jimenez</surname><given-names>B.</given-names></name>; <name><surname>Schafer</surname><given-names>H.</given-names></name>; <name><surname>Humpfer</surname><given-names>E.</given-names></name>; <name><surname>Spraul</surname><given-names>M.</given-names></name>; <name><surname>Lewis</surname><given-names>M. R.</given-names></name>; <name><surname>Pearce</surname><given-names>J. T. M.</given-names></name>; <name><surname>Holmes</surname><given-names>E.</given-names></name>; <name><surname>Lindon</surname><given-names>J. C.</given-names></name>; <name><surname>Nicholson</surname><given-names>J. K.</given-names></name><article-title>Precision
High-Throughput Proton NMR Spectroscopy of
Human Urine, Serum, and Plasma for Large-Scale Metabolic Phenotyping</article-title>. <source>Analytical chemistry</source><year>2014</year>, <volume>86</volume> (<issue>19</issue>), <fpage>9887</fpage>–<lpage>9894</lpage>. <pub-id pub-id-type="doi">10.1021/ac5025039</pub-id>.<pub-id pub-id-type="pmid">25180432</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref51">
      <mixed-citation publication-type="book" id="cit51"><person-group person-group-type="allauthors"><name><surname>Robson</surname><given-names>S.</given-names></name>, <name><surname>Arthanari</surname><given-names>H.</given-names></name>, <name><surname>Hyberts</surname><given-names>S. G.</given-names></name>, <name><surname>Wagner</surname><given-names>G.</given-names></name></person-group> in <source>Methods in enzymology</source> Vol. <volume>614</volume> (ed <person-group person-group-type="editor"><string-name><given-names>A. Joshua</given-names>, <surname>Wand</surname></string-name></person-group>) <fpage>263</fpage>–<lpage>291</lpage> (<publisher-name>Academic Press</publisher-name>, <year>2019</year>).</mixed-citation>
    </ref>
    <ref id="ref52">
      <mixed-citation publication-type="journal" id="cit52"><name><surname>Cloarec</surname><given-names>O.</given-names></name>; <name><surname>Dumas</surname><given-names>M. E.</given-names></name>; <name><surname>Craig</surname><given-names>A.</given-names></name>; <name><surname>Barton</surname><given-names>R. H.</given-names></name>; <name><surname>Trygg</surname><given-names>J.</given-names></name>; <name><surname>Hudson</surname><given-names>J.</given-names></name>; <name><surname>Blancher</surname><given-names>C.</given-names></name>; <name><surname>Gauguier</surname><given-names>D.</given-names></name>; <name><surname>Lindon</surname><given-names>J. C.</given-names></name>; <name><surname>Holmes</surname><given-names>E.</given-names></name>; et al. <article-title>Statistical
total correlation spectroscopy: an exploratory
approach for latent biomarker identification from metabolic 1H NMR
data sets</article-title>. <source>Analytical chemistry</source><year>2005</year>, <volume>77</volume> (<issue>5</issue>), <fpage>1282</fpage>–<lpage>1289</lpage>. <pub-id pub-id-type="doi">10.1021/ac048630x</pub-id>.<pub-id pub-id-type="pmid">15732908</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref53">
      <mixed-citation publication-type="journal" id="cit53"><name><surname>Wu</surname><given-names>Y.</given-names></name>; <name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name><article-title>Uncovering in vivo
biochemical patterns from time-series metabolic dynamics</article-title>. <source>PloS one</source><year>2022</year>, <volume>17</volume> (<issue>5</issue>), <elocation-id>e0268394</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0268394</pub-id>.<pub-id pub-id-type="pmid">35550643</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref54">
      <mixed-citation publication-type="journal" id="cit54"><name><surname>Dobin</surname><given-names>A.</given-names></name>; <name><surname>Davis</surname><given-names>C. A.</given-names></name>; <name><surname>Schlesinger</surname><given-names>F.</given-names></name>; <name><surname>Drenkow</surname><given-names>J.</given-names></name>; <name><surname>Zaleski</surname><given-names>C.</given-names></name>; <name><surname>Jha</surname><given-names>S.</given-names></name>; <name><surname>Batut</surname><given-names>P.</given-names></name>; <name><surname>Chaisson</surname><given-names>M.</given-names></name>; <name><surname>Gingeras</surname><given-names>T. R.</given-names></name><article-title>STAR: ultrafast
universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><year>2013</year>, <volume>29</volume> (<issue>1</issue>), <fpage>15</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>.<pub-id pub-id-type="pmid">23104886</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref55">
      <mixed-citation publication-type="journal" id="cit55"><name><surname>Muzny</surname><given-names>D. M.</given-names></name>; <name><surname>Bainbridge</surname><given-names>M. N.</given-names></name>; <name><surname>Chang</surname><given-names>K.</given-names></name>; <name><surname>Dinh</surname><given-names>H. H.</given-names></name>; <name><surname>Drummond</surname><given-names>J. A.</given-names></name>; <name><surname>Fowler</surname><given-names>G.</given-names></name>; <name><surname>Kovar</surname><given-names>C. L.</given-names></name>; <name><surname>Lewis</surname><given-names>L. R.</given-names></name>; <name><surname>Morgan</surname><given-names>M. B.</given-names></name>; <name><surname>Newsham</surname><given-names>I. F.</given-names></name>; et al. <article-title>Comprehensive molecular characterization of
human colon and rectal cancer</article-title>. <source>Nature</source><year>2012</year>, <volume>487</volume> (<issue>7407</issue>), <fpage>330</fpage>–<lpage>337</lpage>. <pub-id pub-id-type="doi">10.1038/nature11252</pub-id>.<pub-id pub-id-type="pmid">22810696</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref56">
      <mixed-citation publication-type="journal" id="cit56"><name><surname>Li</surname><given-names>B.</given-names></name>; <name><surname>Dewey</surname><given-names>C. N.</given-names></name><article-title>RSEM: accurate transcript
quantification from RNA-Seq
data with or without a reference genome</article-title>. <source>BMC
bioinformatics</source><year>2011</year>, <volume>12</volume>, <fpage>323</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>.<pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Anal Chem</journal-id>
    <journal-id journal-id-type="iso-abbrev">Anal Chem</journal-id>
    <journal-id journal-id-type="publisher-id">ac</journal-id>
    <journal-id journal-id-type="coden">ancham</journal-id>
    <journal-title-group>
      <journal-title>Analytical Chemistry</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0003-2700</issn>
    <issn pub-type="epub">1520-6882</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10896553</article-id>
    <article-id pub-id-type="pmid">38273718</article-id>
    <article-id pub-id-type="doi">10.1021/acs.analchem.3c03078</article-id>
    <article-categories>
      <subj-group>
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SAND: Automated
Time-Domain Modeling of NMR Spectra
Applied to Metabolite Quantification</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="ath1">
        <name>
          <surname>Wu</surname>
          <given-names>Yue</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <name>
          <surname>Sanati</surname>
          <given-names>Omid</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath3">
        <name>
          <surname>Uchimiya</surname>
          <given-names>Mario</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath4">
        <name>
          <surname>Krishnamurthy</surname>
          <given-names>Krish</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">∥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath5">
        <name>
          <surname>Wedell</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref rid="aff5" ref-type="aff">⊥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath6">
        <name>
          <surname>Hoch</surname>
          <given-names>Jeffrey C.</given-names>
        </name>
        <xref rid="aff6" ref-type="aff">#</xref>
      </contrib>
      <contrib contrib-type="author" id="ath7">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5686-2350</contrib-id>
        <name>
          <surname>Edison</surname>
          <given-names>Arthur S.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
        <xref rid="aff7" ref-type="aff">∇</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="ath8">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1264-2556</contrib-id>
        <name>
          <surname>Delaglio</surname>
          <given-names>Frank</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
        <xref rid="aff8" ref-type="aff">○</xref>
      </contrib>
      <aff id="aff1"><label>†</label>Institute
of Bioinformatics, <institution>University of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff2"><label>‡</label>School
of Electrical and Computer Engineering, <institution>University of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff3"><label>§</label>Complex
Carbohydrate Research Center, <institution>University
of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff4"><label>∥</label><institution>Chempacker
LLC</institution>, San Jose, California 95135, <country>United States</country></aff>
      <aff id="aff5"><label>⊥</label>National
Magnetic Resonance Facility, <institution>University
of Wisconsin-Madison</institution>, Madison, Wisconsin 53706, <country>United States</country></aff>
      <aff id="aff6"><label>#</label>Department
of Molecular Biology and Biophysics, <institution>University
of Connecticut</institution>, Farmington, Connecticut 06030-3305, <country>United States</country></aff>
      <aff id="aff7"><label>∇</label>Department
of Biochemistry and Molecular Biology, <institution>University
of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff8"><label>○</label>Institute
for Bioscience and Biotechnology Research, <institution>National Institute of Standards and Technology and the University
of Maryland</institution>, Rockville, Maryland 20850, <country>United States</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Email: <email>frank.delaglio@nist.gov</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>01</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <day>06</day>
      <month>02</month>
      <year>2024</year>
    </pub-date>
    <volume>96</volume>
    <issue>5</issue>
    <fpage>1843</fpage>
    <lpage>1851</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>07</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>01</month>
        <year>2024</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>01</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 American Chemical Society</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>American Chemical Society</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>Permits non-commercial access and re-use, provided that author attribution and integrity are maintained; but does not permit creation of adaptations or other derivative works (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">https://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0005" id="ab-tgr1"/>
      </p>
      <p>Developments in untargeted nuclear magnetic resonance
(NMR) metabolomics
enable the profiling of thousands of biological samples. The exploitation
of this rich source of information requires a detailed quantification
of spectral features. However, the development of a consistent and
automatic workflow has been challenging because of extensive signal
overlap. To address this challenge, we introduce the software Spectral
Automated NMR Decomposition (SAND). SAND follows on from the previous
success of time-domain modeling and automatically quantifies entire
spectra without manual interaction. The SAND approach uses hybrid
optimization with Markov chain Monte Carlo methods, employing subsampling
in both time and frequency domains. In particular, SAND randomly divides
the time-domain data into training and validation sets to help avoid
overfitting. We demonstrate the accuracy of SAND, which provides a
correlation of ∼0.9 with ground truth on cases including highly
overlapped simulated data sets, a two-compound mixture, and a urine
sample spiked with different amounts of a four-compound mixture. We
further demonstrate an automated annotation using correlation networks
derived from SAND decomposed peaks, and on average, 74% of peaks for
each compound can be recovered in single clusters. SAND is available
in NMRbox, the cloud computing environment for NMR software hosted
by the Network for Advanced NMR (NAN). Since the SAND method uses
time-domain subsampling (i.e., random subset of time-domain points),
it has the potential to be extended to a higher dimensionality and
nonuniformly sampled data.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Division of Biological Infrastructure</institution>
            <institution-id institution-id-type="doi">10.13039/100000153</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1946970</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>ac3c03078</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>ac3c03078</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <p id="sec1">Metabolomics techniques have advanced in both capability and importance,
producing untargeted profiling on a diverse set of biological systems.<sup><xref ref-type="bibr" rid="ref1">1</xref>−<xref ref-type="bibr" rid="ref8">8</xref></sup> Nuclear magnetic resonance (NMR) spectroscopy has enabled nondestructive
and even in vivo metabolic measurements of samples.<sup><xref ref-type="bibr" rid="ref1">1</xref>,<xref ref-type="bibr" rid="ref9">9</xref></sup> Such
untargeted profiling provides a detailed description of the metabolic
landscape, metabolic dynamics,<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> gene–environment
interactions,<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> and possible biomarkers.<sup><xref ref-type="bibr" rid="ref4">4</xref></sup></p>
  <p>Metabolomics data sets are intricate and
rich in information. NMR
data are collected as time-domain signals (free induction decay; FID),
and FIDs are usually Fourier-transformed (FT) into frequency-domain
spectra.<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> While the information content
in the time domain and frequency domain is similar, the FT converts
the complex set of decaying sinusoidal signals in the time domain
into localized individual peaks in the frequency domain and enables
a clear visual analysis. However, in metabolomics studies, there are
often hundreds of spectra, and each spectrum contains hundreds to
thousands of peaks from tens to hundreds of compounds; therefore,
the need to identify and characterize individual peaks is a serious
analysis bottleneck. In addition, the spectral signals are often highly
overlapped, hindering peak quantification and obstructing efficient
annotation. These problems are exacerbated by baseline distortion
and by the presence of broad signals from components with large molecular
weights.<sup><xref ref-type="bibr" rid="ref1">1</xref></sup></p>
  <p>The challenge of spectral
overlap has been approached from both
experimental and computational directions. A variety of experimental
methods have been developed to partially address the overlap problem,
including “pure shift” broadband decoupling to simplify
spectra.<sup><xref ref-type="bibr" rid="ref13">13</xref>−<xref ref-type="bibr" rid="ref17">17</xref></sup> New computational approaches are needed and are the focus of this
study. Spectra are often quantified by the intensity or integral after
peak picking or binning, but the quantification is highly affected
by overlap.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> Reference-library-based quantification
can target routine spectra and compounds, but this is restricted to
available libraries. For instance, Bayesian automated metabolite analyzer
for NMR (BATMAN) relies on precise template libraries, but its targeted
metabolite quantification leaves unknown features unresolved.<sup><xref ref-type="bibr" rid="ref19">19</xref>−<xref ref-type="bibr" rid="ref22">22</xref></sup></p>
  <p>Bayesil has restrictions on sample types and NMR procedures
and
is limited to a defined list of compounds.<sup><xref ref-type="bibr" rid="ref23">23</xref></sup> Chenomx provides a commercial solution to library-based fitting,
but it needs time-consuming manual interactions<sup><xref ref-type="bibr" rid="ref20">20</xref></sup> and has operator-dependent divergences in quantification.<sup><xref ref-type="bibr" rid="ref24">24</xref></sup></p>
  <p>A more general approach is to model the
spectra in an untargeted
and direct way through optimization.<sup><xref ref-type="bibr" rid="ref25">25</xref>,<xref ref-type="bibr" rid="ref26">26</xref></sup> In particular,
time-domain signal modeling directly tackles the overlap problem and
is advantageous for nonuniformly sampled data and data with baseline
problems.<sup><xref ref-type="bibr" rid="ref27">27</xref>−<xref ref-type="bibr" rid="ref29">29</xref></sup> The utility of time-domain modeling is demonstrated
by CRAFT, which is the complete reduction to amplitude frequency table
method. CRAFT, which is based upon a Bayesian framework, has been
used to decompose 1D and 2D NMR spectra by time-domain modeling, and
while CRAFT workflows can involve interactive partitioning of spectral
regions, CRAFT performance is robust with respect to any user-defined
parameters, and so it does have the potential for complete automation.<sup><xref ref-type="bibr" rid="ref27">27</xref>−<xref ref-type="bibr" rid="ref31">31</xref></sup> Similar ideas have been tested by researchers including Rubtsov
et al., but extensive validation and consistent workflows are not
available.<sup><xref ref-type="bibr" rid="ref32">32</xref>−<xref ref-type="bibr" rid="ref35">35</xref></sup> Singular value decomposition (SVD) and linear prediction-based methods
provide alternative solutions, but the tuning parameter, namely, the
reduced order, is hard to select for real-world data sets.<sup><xref ref-type="bibr" rid="ref36">36</xref>−<xref ref-type="bibr" rid="ref42">42</xref></sup> Alternatively, global spectral deconvolution (GSD)<sup><xref ref-type="bibr" rid="ref43">43</xref></sup> provides a convenient commercial solution that automatically
fits frequency-domain data, but in crowded regions, it tends to overfit
by using many non-ideal and nonphysical peaks. Therefore, an automated
untargeted method to decompose NMR spectra is still needed.</p>
  <p>We designed the spectral automatic NMR decomposition (SAND) method
and tested it on both simulated and experimental data sets. SAND automatically
decomposes NMR data into signal tables and accurately quantifies overlapped
peaks, and the SAND results can be used to extract compound annotations
from untargeted metabolomics data sets. SAND is integrated with the
computational facilities of NMRbox<sup><xref ref-type="bibr" rid="ref44">44</xref></sup> through
the NMRPipe<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> platform and Network for
Advanced NMR (NAN), providing an end-to-end workflow from samples
to feature tables.</p>
  <sec id="sec2">
    <title>Materials and Methods</title>
    <sec id="sec2.1">
      <title>Modeling in the Time Domain</title>
      <p>Since an ideal NMR signal
is considered to have an exponential decay and because the analytical
Fourier transform of an ideal exponential signal is a Lorentzian,
NMR spectra are commonly modeled in the frequency domain using Lorentzian
functions. However, NMR spectra are usually generated by discrete
Fourier transform so that, in practice, the corresponding signals
are not perfect Lorentzians even for noise-free ideal time-domain
data. As the number of time-domain points becomes small, the line
shape observed in the Fourier spectrum becomes increasingly broad
and non-ideal, including the appearance of increasingly prominent
truncation artifacts. Furthermore, the use of apodization functions
other than exponentials changes the corresponding Fourier lineshapes,
and apodization in general also changes the distribution of thermal
noise in the spectrum. Digital oversampling, which potentially distorts
early time-domain points, can therefore also change the corresponding
Fourier spectrum. Together, all of these effects are hard to analytically
model in the frequency domain but easy to accommodate numerically
in the time domain.</p>
      <p>Modeling in the time domain can also help
overcome the effects of baseline distortion on signal quantification.
Baseline distortions that extend over large portions of a spectrum
correspond to distortions in a small number of early points in the
time-domain. Therefore, time-domain modeling provides a chance to
mitigate the effects of baseline distortion by down-weighting or skipping
the early first points in the time-domain data.</p>
    </sec>
    <sec id="sec2.2">
      <title>Overview of SAND Decomposition</title>
      <p>The SAND workflow is
illustrated in <xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>. The input NMR spectra for the workflow are collected and pre-processed
automatically. They are then adaptively separated by an automated
procedure into smaller frequency buckets (bins) and inversely Fourier-processed
to generate time domain data, giving an FID for each bin. This helps
speed the analysis by reducing the number of signals that must be
optimized simultaneously and also allows for parallel computation.
In each bin, the FID is modeled as a sum of decaying complex sinusoidal
signals (<xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref>), one for
each signal. Each signal <italic>X</italic><sub><italic>k</italic></sub> is represented by a sequence of complex numbers through time
and is defined by four parameters: amplitude (<italic>A</italic><sub><italic>k</italic></sub>), frequency (<italic>f</italic><sub><italic>k</italic></sub>), decay (λ<sub><italic>k</italic></sub>),
and phase (ϕ<sub><italic>k</italic></sub>):<disp-formula id="eq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m001" position="anchor"/><label>1</label></disp-formula></p>
      <fig id="fig1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Key aspects of the SAND
workflow. (A) In order to minimize the
number of signals that need to be optimized simultaneously and enable
parallel processing, the measured spectrum (blue) is divided into
buckets by an adaptive automated procedure and an overlapping series
of raised cosine masks are generated according to the bucket boundaries
(gold dashed lines); one such mask is shown in in green. A given isolated
bucket (purple) is generated from the product of the measured spectrum
and a mask. (B) A given isolated bucket is inverse Fourier-processed
into the time domain (gray), and the points are randomly divided into
a training set (black points) and a validation set (red points). Then,
a series of models with increasing numbers of signals is proposed
and optimized to fit the training set with each signal modeled as
a complex decaying sinusoid. For each optimized model, a series of
statistics including RMSD are calculated to measure the agreement
between the model and validation set (pink graph), and the optimal
number of signals is identified when additional signals no longer
improve the model (gray dashed line) or if other stop criteria are
reached. (C) The result of SAND optimization is a signal table with
estimated model parameters of frequency, decay, and amplitude. The
parameters can optionally be used to generate simulated time domain
data, which is Fourier-processed in the same way as the measured spectrum
to allow a visual evaluation.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0001" id="gr1" position="float"/>
      </fig>
      <p>Frequency and time domains retain similar information
content.
For each FID, the decomposition process involves an iteration of the
initial value estimation, hybrid optimization of peak parameters,
and stop-criteria checking. Each iteration adds one more peak until
the stop criteria (later section) are met. More details of the process
are covered in later sections. We also provide a user-friendly version
available on NMRbox with an interface where selected parameters mentioned
in the following sections can be provided by the user.</p>
    </sec>
    <sec id="sec2.3">
      <title>NMR Spectral Pre-processing</title>
      <p>The pre-processing was
implemented in NMRPipe and MATLAB and included zero filling (ZF),
FT, phasing, line broadening, referencing, scaling, and format conversion.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> Spectra requiring only zero-order phasing were
corrected automatically, and interactive phasing was used when a first-order
phase correction was needed. Sample scripts for spectra processing
can be found here <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/edisonomics/SAND">https://github.com/edisonomics/SAND</uri>.</p>
    </sec>
    <sec id="sec2.4">
      <title>Automatic Binning of Metabolomics NMR Spectra</title>
      <p>Metabolic
NMR spectra often contain hundreds to thousands of peaks. Binning
separates the spectrum into smaller frequency regions to simplify
the process of optimization and parallelization.<sup><xref ref-type="bibr" rid="ref30">30</xref>,<xref ref-type="bibr" rid="ref41">41</xref></sup> We generate bins in the frequency domain with an adaptive automated
procedure using a bucket (bin) size parameter that gives the initial
size of bins and a slackness parameter that determines how much the
size of a given bin can be adjusted by the adaptive procedure.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> Our examples use a slackness of 0.99 and a bucket
size of 0.002. The bins are automatically adjusted so that each bin
contains at least one local optima, meaning at least one tentative
peak. We combine bins in groups of three to help ensure that a peak
will be evaluated with its neighbors. The binning can be performed
individually for each spectrum or once for a collection of related
samples with expected similarity between samples. The subspectra from
each bin were then post-processed. First, a subspectrum is shifted
to move its minimum to zero to remove any baseline offset. A raised-cosine
band function is then applied to each bin with a roll-off shoulder
of 0.02 ppm. This window function removes drastic changes in the bin
boundary and reduces artifacts in the inverse Fourier transformation
(IFT). The band-selected bin is then processed by Hilbert transform
to generate imaginary data and then inverse Fourier-processed to generate
an FID for each bin.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup></p>
    </sec>
    <sec id="sec2.5">
      <title>Resampling of Time-Domain Data</title>
      <p>Before the decomposition
iterations, the FID can be optionally truncated to exclude the trailing
noise. In the examples here, the first ∼6,000 of 16,384 complex
points in the beginning were used. The selected points from the FID
were then randomly sampled into three sets: “training”
for parameter optimization (70%), “validation” for checking
the stop criteria (20%), and “testing” for the final
evaluation (10%). This separation was intended to infer the reasonable
number of peaks in the stop-criteria checking step rather than strict
cross-validation in forecasting since it is expected that the time-series
samples can be autocorrelated.</p>
    </sec>
    <sec id="sec2.6">
      <title>Initial Parameter Estimation</title>
      <p>In each iteration, a new
peak is added if the stop criteria are not met. The initial values
were estimated to provide informative guesses and reduce the computational
cost of optimization. The initial values for the newly added peak
were estimated from the residual signals by sweeping through a frequency
grid:<disp-formula id="eq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m002" position="anchor"/><label>2</label></disp-formula></p>
      <p>The measured FID <italic>Y<sub>j</sub></italic>(<italic>t</italic>) of bin <italic>j</italic> was compared with the sum of <italic>n –</italic> 1 simulated
signals (<italic>k</italic> ∈ {1 ... <italic>n</italic><italic>–</italic> 1}) to produce the current residual. The signal
with a maximum amplitude was retrieved from the residual as the initial
guess for <italic>A</italic> and <italic>f</italic>. For such a guess,
the frequency was swept with 1,000 values and the default value was
used for and λ as the initial guess. The frequency was found
by the maximum product of the two complex vectors.</p>
    </sec>
    <sec id="sec2.7">
      <title>Parameter Optimization</title>
      <p>A hybrid optimization was used
to estimate peak parameters by minimizing the objective function (<xref rid="eq3" ref-type="disp-formula">eq <xref rid="eq3" ref-type="disp-formula">3</xref></xref>), where θ is the
vector of parameters of all peaks. For computational efficiency, the
optimization includes upper and lower bounds for the allowed values
of the decay λ. We used Metropolis sampling for the global parameter
search<sup><xref ref-type="bibr" rid="ref10">10</xref>,<xref ref-type="bibr" rid="ref46">46</xref></sup> and the interior-point method for the local
parameter refinement.<sup><xref ref-type="bibr" rid="ref47">47</xref></sup> The interior-point
method is the default option in MATLAB for the constrained nonlinear
multivariable function optimization. Metropolis sampling is one of
the Markov chain Monte Carlo (MCMC) methods and constructs a Markov
chain to capture the unknown model and generate results that are consistent
with the observation. The stochastic process can explore a complex
parameter space with many local optima and arrive at the global optima.
Good performance of MCMC has been demonstrated in statistical physics<sup><xref ref-type="bibr" rid="ref46">46</xref></sup> and Bayesian inference.<sup><xref ref-type="bibr" rid="ref48">48</xref>,<xref ref-type="bibr" rid="ref49">49</xref></sup> It has also been applied to biological problems where there are
a large number of parameters, but the measurement is sparse and noisy.<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> The introduction of MCMC can be found here.<sup><xref ref-type="bibr" rid="ref10">10</xref>,<xref ref-type="bibr" rid="ref46">46</xref>,<xref ref-type="bibr" rid="ref49">49</xref></sup><disp-formula id="eq3"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m003" position="anchor"/><label>3</label></disp-formula></p>
      <p>The optimization process
contained an outer loop (iteration) of MCMC optimization with local
refinement in the inner loop (step). One iteration (MCMC sweep) contains
4<italic>N</italic> steps, which is the number of optimizable parameters
(four times the number of peaks). In each MCMC step, a parameter is
selected at random and randomly perturbed. The perturbation depends
on the predefined parameter range and relative step size, which is
bounded by 10% in each step. The proposed perturbation is accepted
or rejected based on the probability (<xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref>) where the synthetic temperature is set to 80 by default
(<xref rid="eq5" ref-type="disp-formula">eq <xref rid="eq5" ref-type="disp-formula">5</xref></xref>). For each FID,
the temperature is adjusted with the estimated standard deviation
based on the FID end with no signals (<xref rid="eq5" ref-type="disp-formula">eq <xref rid="eq5" ref-type="disp-formula">5</xref></xref>). At every 100 MCMC iterations, local optimization
is used to refine the result. There are 4<italic>N</italic> steps
in one iteration and 2,000 iterations (by default) in the optimization
of one binned FID. Multiple optimization runs (default 3) with different
random seeds are performed, and the one with the best objective function
value is selected.<disp-formula id="eq4"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m004" position="anchor"/><label>4</label></disp-formula><disp-formula id="eq5"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m005" position="anchor"/><label>5</label></disp-formula></p>
    </sec>
    <sec id="sec2.8">
      <title>Stop Criteria</title>
      <p>The optimization is stopped when any
of the model complexity criteria are met. The first criterion regards
the improvement from the new signal. The criterion is met if the new
model does not improve the objective function by more than a threshold
(default 0.001). The second criterion regards the number of peaks
in the optimized bin, and the maximum was by default 7. This mostly
aimed to save computational resources for difficult regions as the
computational complexity increased with the maximal number of signals
by approximately a power of three. The third criterion regards the
initial guess amplitude of the new peak. It is true if the new peak
is less than by default 10% of the minimum of all existing peaks in
the bin.</p>
    </sec>
    <sec id="sec2.9">
      <title>Pre-processing Experimental NMR Spectra</title>
      <p>The prednisone–ibuprofen
mixtures were prepared in DMSO-<italic>d</italic><sub>6</sub>, and
the NMR data were collected with a Varian Inova 500 spectrometer.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> The spectra were processed in NMRPipe, including
additional formatting, baseline corrections by polynomial subtraction,
exponential line broadening (1.5 Hz), a scaling maximum to 1,000,
and chemical shift recalibration.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> The
spectra were analyzed with the same set of automated bins. The spike-in
data set was processed in NMRPipe, including manual phasing, a scaling
maximum to 1000, and exponential line broadening (0.3 Hz). Each spectrum
was then automatically binned individually. Pre-processing scripts
for experimental data sets are provided in GitHub.</p>
    </sec>
    <sec id="sec2.10">
      <title>Spike-In Data Set Collection</title>
      <p>A spike-in experiment
was conducted by adding a mixture of compounds to a urine sample.
540 μL of a human urine standard material (Golden West Diagnostics,
LLC) was mixed with 60 μL of phosphate buffer (1.5 mol L<sup>–1</sup> phosphate; 1.1 × 10<sup>–3</sup> mol
L<sup>–1</sup> DSS; pH 7.4) following a previous procedure,<sup><xref ref-type="bibr" rid="ref50">50</xref></sup> and 20 μL of a spike-in solution was sequentially
added to the sample (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>).
NMR spectra were acquired at 298 K using an Avance III 600 MHz spectrometer
equipped with a 5 mm TCI cryoprobe (Bruker). Data were collected using
a one-dimensional 1H detection experiment with water suppression (Bruker
nomenclature, noesypr1d) with the following acquisition parameters:
spectral width of 16.00 ppm, number of points of 32 K, number of scans
of 64, and relaxation delay of 4 s. The digitizer mode (DIGMOD) was
set to base-opt to collect spectra with no first-order phase distortion.
Raw data and parameter sets are available in the Metabolomics Workbench
(Study ST002718 doi: 10.21228/M8WT6H).</p>
    </sec>
    <sec id="sec2.11">
      <title>Correlation Network and Clustering</title>
      <p>To build the correlation
network, we matched peaks by the chemical shift distance between samples
and calculated the Spearman correlation. The edges were selected with
0.9 and 0.5 as the correlation threshold in the simulated data set
and in the prednisone–ibuprofen mixtures. For these two data
sets, the groups of peaks were clear and separated without clustering.</p>
    </sec>
    <sec id="sec2.12">
      <title>Benchmark Data Set Simulation</title>
      <p>The simulation was implemented
in the time domain with preset parameters (<xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref>). We made the simulation resemble the experimental
spectra. One urine spectrum was decomposed into a peak table. The
peak table was refined by selecting an approximately 1.50 ppm region,
removing distorted peak regions, cleaning peak clusters, randomly
sampling λ values, and adding the reference peak at 0.00 ppm.
The peak clusters with a dense overlap were cleaned by removing close
peaks by a threshold of 0.03 ppm. Approximately 100 peaks remained
after the filtering. λ values were uniformly sampled from 1
to 15, and the λ value of the reference peak was defined as
4. Concentrations were uniformly sampled, and the spectra were simulated
with noise. As in experimental data sets, the first point of the FID
was divided by two, and 76 zero points were added in the beginning.
In the simulation with broad peaks, three broad peaks with λ
values greater than or equal to 100 were added. In the simulation
with groups, 18 groups (compounds) were predefined, and within each
group, the peaks maintained a fixed relative ratio of the amplitude
like the peaks of one compound. In the simulation with zero-order
phase distortion, a 0.2 (in radian) phase distortion is added to all
peaks. The simulated NMR spectra then went through pre-processing
and binning steps.</p>
    </sec>
    <sec id="sec2.13">
      <title>Benchmark Evaluation</title>
      <p>SAND was evaluated on simulated
and experimental data sets. SAND results were compared with the peak
intensity, numerical integral, and CRAFT.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> In each bin before the combination, the minimum was shifted to zero,
the maximum intensity was determined, and then, the integral was calculated
by trapezoidal numerical integration. Extracted peaks in the simulated
data were then normalized to the reference peak at 0.00 ppm. Relative
intensities were compared for the ibuprofen–prednisone mixtures.</p>
      <p>The evaluation was based on the divergence between estimation and
ground truth, linearity, and correlation. The MSE (<xref rid="eq6" ref-type="disp-formula">eq <xref rid="eq6" ref-type="disp-formula">6</xref></xref>) was calculated for each matched
peak <italic>e</italic> (total number <italic>N</italic><sub><italic>e</italic></sub>) for one sample <italic>k</italic> and between estimation <italic>x</italic> and ground truth <italic>y</italic>. The relative MSE
(RMSE) had each deviation normalized by the mean (<xref rid="eq7" ref-type="disp-formula">eq <xref rid="eq7" ref-type="disp-formula">7</xref></xref>). The Pearson correlation was used
for correlation. The slope <italic>k</italic> was calculated by fitting
a linear regression model between the estimation and ground truth
with no intercept. Evaluations were calculated within each sample
from which the means and standard errors were calculated.</p>
      <p>
        <disp-formula id="eq6">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m006" position="anchor"/>
          <label>6</label>
        </disp-formula>
        <disp-formula id="eq7">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m007" position="anchor"/>
          <label>7</label>
        </disp-formula>
      </p>
    </sec>
    <sec id="sec2.14">
      <title>NMRbox Integration</title>
      <p>A command line interface was built
for SAND for general users particularly on NMRbox. We provided an
interface for direct control of parameters mentioned in previous sections.
Different FIDs can be assigned and computed by separate machines,
and the computation of the different bins runs in parallel. Parallel
processing through the HTCondor structure is also provided through
a bash shell script. The script assigns each FID to separate core
groups, and for each FID, one submission file is created and then
submitted to the pool.</p>
    </sec>
    <sec sec-type="data-availability" id="sec2.15">
      <title>Code and Data Availability</title>
      <p>The SAND program has been
implemented in MATLAB, R, C-shell, and bash shell. Codes are freely
available through GitHub (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/edisonomics/SAND">https://github.com/edisonomics/SAND</uri>). It was tested on a local iMac Pro computer, sapelo2 at the Georgia
Advance Computing Resource Center (GACRC), and NMRbox servers.<sup><xref ref-type="bibr" rid="ref44">44</xref></sup></p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <sec id="sec3.1">
      <title>Overview of the SAND Computational Workflow</title>
      <p>Given NMR
data as input, SAND uses time-domain models to automatically create
a table of signal parameters describing the corresponding spectrum,
allowing the quantification of individual chemical components (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>). SAND is demonstrated
here with respect to metabolomics data, but it is general and can
be applied to other applications (e.g., macromolecular NMR). Even
when time-domain analysis is used, many intermediate manipulations
are more convenient to perform in the frequency domain before a detailed
analysis including intensity normalization or calibration of chemical
shifts according to a reference compound signal. For this reason,
the usual SAND workflow starts with processed spectra, which are internally
inverse Fourier-processed by SAND as needed. In the examples presented,
NMR data were first collected from biological samples and automatically
processed by NMRPipe or MATLAB (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>B).</p>
      <p>Direct modeling of the whole spectra is computationally
difficult because of the number of parameters required. To simplify
the problem, SAND performs frequency-region-based spectral subsampling
followed by inverse Fourier processing of the subsampled regions (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>C).<sup><xref ref-type="bibr" rid="ref18">18</xref>,<xref ref-type="bibr" rid="ref30">30</xref></sup> SAND then decomposes the time-domain data by fitting a decaying
sinusoid model for each signal and estimating the frequency (often
expressed as a chemical shift for simplicity), decay (λ), amplitude,
and phase (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>D).</p>
      <p>While SAND as presented here uses exponentially decaying
sinusoids
as the underlying signal model, other models could be used, and for
the examples presented here, which use phased spectra as input, the
phase parameter was kept fixed at zero. Since the SAND analysis involves
a parameter space with multiple local optima, Markov chain Monte Carlo
methods are used, and similar approaches were employed by the Bayesian
engine used by CRAFT.<sup><xref ref-type="bibr" rid="ref27">27</xref>,<xref ref-type="bibr" rid="ref30">30</xref></sup> In addition, SAND employs multiple
controls for model complexity, including time-domain subsampling.
Because SAND uses time-domain subsampling (i.e., it analyzes a random
subset of the time-domain points), it is intrinsically suited to nonuniformly
sampled (NUS) applications.<sup><xref ref-type="bibr" rid="ref51">51</xref></sup> In the end,
a mixture spectrum is reduced to a feature table and a list of individual
peaks, quantifying the signals of the metabolome (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>E,F).</p>
    </sec>
    <sec id="sec3.2">
      <title>Evaluation of SAND on Benchmark Data Sets</title>
      <p>Multiple
data sets were simulated to test SAND performance under different
conditions (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figures S1 and S2</ext-link>, and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>). The simulation presented here (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>A) covered a range of 1.50
ppm with highly overlapped peaks and randomly generated concentrations,
and a broad peak overlap was added (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S2</ext-link>). The overall SAND model (black line in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B) agrees well with the measured spectrum
(red line in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B), and SAND uncovered and quantified most of the underlying peaks
accurately (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref> B,C). The estimation (blue peaks in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B) agrees well with the ground truth (green
peaks) even for highly overlapped regions. However, SAND will sometimes
not accurately determine the number of peaks for highly overlapped
regions, modeling a single peak as two smaller peaks (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B, around 7.3 and 7.95 ppm).</p>
      <fig id="fig2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>SAND performance
on simulated benchmarks. SAND was evaluated with
simulated benchmark spectra. (A) Stack plot of 20 simulated spectra
with both narrow and broad peaks. Peaks are highly overlapped with
randomly generated intensities, and the spectra are distinguished
by different colors. An example of a broad peak overlap can be found
in <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S2</ext-link>. (B) Two example regions of
the decomposition with simulated raw spectra are black; sum of decomposed
peaks (red), simulated ground truth peaks (green), and individual
decomposed peaks (blue). Stack spectra are used for plotting with
each individual spectrum shifted differently vertically for clear
visualization. (C) Scatter plot of ground truths (horizontal axis)
and SAND estimations (vertical axis) for the chemical shift, amplitude,
and peak width (λ) in the simulated mixture (A). For the amplitude
plot, data for peaks with closely overlapping peaks are shown in gray,
and data for peaks that are relatively far from neighbor peaks are
shown in red (threshold of 0.01 ppm).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0002" id="gr2" position="float"/>
      </fig>
      <p>This is a common problem for both manual inspection
and previous
decomposition approaches. Globally, the estimation for peak parameters
(chemical shift, amplitude, and peak widths) was accurate with most
points distributed on the diagonal line and a high correlation (∼0.9)
with ground truth (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>C). The effects of high noise and a large peak overlap were
tested on a series of cases with a small narrow peak in the presence
of two broad peaks (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S1</ext-link>). All three
simulated peaks were successfully decomposed in all conditions, and
the small narrow peak was quantified accurately with around 20% relative
error in the worst case even though these most overlapped cases would
be difficult to identify by eye (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S1A</ext-link>).</p>
      <p>SAND was compared with quantification by the peak intensity,
numerical
integral, and CRAFT analysis on simulated (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) and experimental data sets (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S5</ext-link>) with known ground truth (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>). Intensity and integrals can be extracted
automatically in an untargeted analysis. We evaluate the methods based
on the estimation divergencies (mean squared error (MSE) and relative
MSE), slope, and correlation (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>).
Among automatic methods, SAND was consistently better in the more
complex simulated data sets (correlation of 0.88 and <italic>k</italic> of around 0.9), and all methods have near-perfect performances in
the simpler ibuprofen–prednisone mixture. CRAFT has slightly
better performance in two data sets, and this is expected because
the CRAFT result uses the entire time-domain data rather than a subset.
This reveals a small deficit in SAND, where the model parameters are
determined from a subset of the data.</p>
      <p>The ibuprofen–prednisone
experimental mixture data set contains
11 different relative concentrations, and each was repeated three
times.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> There is less overlap in the ibuprofen–prednisone
mixture than in our simulated data set, and relative concentrations
were accurately estimated by SAND and other methods (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S3 and Table S3</ext-link>).</p>
      <p>SAND analysis focuses on phased
spectra but also decomposes spectra
with zero-order phasing problems (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S6</ext-link>), and the performance of parameter estimation is similar (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>).</p>
    </sec>
    <sec id="sec3.3">
      <title>Evaluation of SAND with Metabolomics Mixtures</title>
      <p>We then
tested SAND on experimental data sets with extensive overlap and complexity
(<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>). A mixture of standard compounds
containing <sc>l</sc>-valine, <sc>d</sc>(+)-glucose, 3-nitro-<sc>l</sc>-tyrosine, <italic>N</italic>-(1-carboxyethyl)-<sc>l</sc>-lysine,
and sodium dimethyl silapentane sulfonate (DSS)-<italic>d</italic><sub>6</sub> was spiked into a urine sample in different amounts
(0, 20, 40, 60, and 80 μL) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>), and the peaks were quantified (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). The spike-in changed the pH of the mixture,
and several peaks from both spike-in and urine samples also had chemical
shift changes.</p>
      <fig id="fig3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Decomposition of the spike-in data set. In a urine sample,
different
amounts of a four-compound mixture were spiked in to evaluate SAND
quantification. The orange spectrum is from the spiked-in mixture
alone. The mixture was spiked into the urine sample with different
volumes, and from low to high volumes, the spectra at the bottom are
visualized with darker colors, namely, gray to black. Above the orange
spike-in spectrum, selected regions from the 80 L spike-in urine sample
are shown with both SAND estimation (blue) and measured spectra (black).
On the top, selected examples of the spike-in volume versus signal
amplitude are shown. The axes are presented in the right-side figure
with an <italic>x</italic> axis for the spike-in volumes and <italic>y</italic> axis for the intensity quantification. All other figures
are with the same axes. Values from the spike-in compounds are expected
to vary linearly with the spike-in volume, and they have correlation
values of 0.98 and above (solid lines).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0003" id="gr3" position="float"/>
      </fig>
      <p>As shown in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>, all spectra were effectively decomposed by SAND.
The spike-in peak
amplitudes increased linearly with spike-in volumes (correlation close
to 1) with the slope defined by the relative peak intensity (solid
lines in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>).
The linearity holds for peaks of different relative intensities. For
peaks only in the original urine spectra (dashed lines in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>), the estimation
stayed relatively constant, though the overlap with spike-in compounds
influenced the quantification slightly. Glucose already existed in
the original urine sample, so the linear regression line has a nonzero <italic>Y</italic> intercept.</p>
    </sec>
    <sec id="sec3.4">
      <title>Automatic Annotation Inference</title>
      <p>In addition to compound
quantification, the decomposed features also inform the underlying
chemical associations and annotations. Different peaks of the same
compound should be perfectly correlated at multiple concentrations.
Statistical total correlation spectroscopy (STOCSY) used correlation
to find peaks associated with a targeted peak.<sup><xref ref-type="bibr" rid="ref52">52</xref></sup> A correlation network can also be built to find clusters
of peaks highly correlated with each other, which indicates a possible
compound annotation.<sup><xref ref-type="bibr" rid="ref53">53</xref></sup> Such an approach
can be automatic and untargeted and can characterize novel compounds
that are not in the database or known compounds without relying on
libraries. While peak overlap can introduce false positives, SAND
can improve the results by removing the spectral overlap.</p>
      <p>Annotation
was first tested on simulated mixtures (50 spectra) with 18 groups
of peaks, and in each group (“compound”), peaks were
simulated with fixed relative intensities, like different peaks in
a compound. The concentration of each compound is randomly sampled
from a maximum to 20%. SAND features were matched between samples
by the chemical shift, correlated, and then clustered (details in <xref rid="sec2" ref-type="other">Materials and Methods</xref>). Most peaks of the compounds
(red lines in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>) can be automatically decomposed, clustered, and recovered in one
cluster (blue lines in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>). For most compounds, more than 60% of the ground truth peaks
were recovered in one cluster (mean recovery ratio of 74%) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S4</ext-link>).</p>
      <fig id="fig4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Automatic annotation from SAND decomposition.
Each spectrum is
decomposed into a peak list, and matched peaks among 50 different
samples were correlated and clustered for annotation. One example
mixture spectrum is shown in black, the ground truth spectra in red,
and the estimated spectra of the matched clusters in blue.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0004" id="gr4" position="float"/>
      </fig>
      <p>Automatic annotation was then tested in the ibuprofen–prednisone
mixtures. Two main clusters were uncovered, and each contains many
peaks of the corresponding compound (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S5</ext-link>). One caveat of this data set is that, although the samples are
made from ibuprofen and prednisone, they still contain some other
impurity peaks, such as DMSO and water peaks.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4</label>
    <title>Conclusions</title>
    <p>We built SAND to decompose
the NMR spectra into feature tables.
SAND reduces the dimensionality of metabolomics spectra from tens
of thousands of points to hundreds of peaks, extracts the most interesting
peak features, and relieves the curse of dimensionality in the downstream
statistical analysis. Such an automatic process also frees researchers
from the tedious work of manual peak picking or binning.</p>
    <p>One
goal of SAND is to enable reproducible automatic quantification
of large-scale NMR metabolomic studies as in other omics approaches.<sup><xref ref-type="bibr" rid="ref54">54</xref>−<xref ref-type="bibr" rid="ref56">56</xref></sup> Currently, SAND can be used via NMRPipe<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> and the resources of NMRbox<sup><xref ref-type="bibr" rid="ref44">44</xref></sup> with analysis
initiated via a single command from a terminal window or shell script,
making it easy to integrate SAND with other workflows and analysis
tools on the NMRbox platform. An entire workflow can be run within
NMRbox, which provides high-capacity data storage and improves reproducibility.
SAND will be further built into the workflows for the Network for
Advanced NMR (NAN), which is an NSF-funded national network that facilitates
resource discovery, data collection, data storage and transfer, and
NMR data analysis. Metabolomics NMR spectra can be tagged and decomposed
automatically in this workflow, and clean peak tables are returned
to users. Initial pre-processing by the user using either autophasing
or manually adjusted phase values is preferred but not always needed
(<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S6</ext-link>).</p>
    <p>In our future plans
for SAND, we intend to replace the slow MATLAB
implementation with a faster, more readily parallelizable version
implemented in C/C++. The current version of SAND is tuned for high-resolution
metabolomics spectra; we also intend to accommodate other cases. Along
these lines, SAND can potentially be expanded to include nonexponential
signals. An example is given in <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S7</ext-link>, which shows a region of the prednisone spectrum with peaks identified
by SAND subject to a second round of optimization using an exponential
+ Gaussian model. Our ultimate goal is to explore the intriguing possibility
of adapting SAND to multidimensional applications. We note that this
has particular promise because SAND is a variety of nonuniform sampling
analyses, where quantification of time-domain data could potentially
avoid the need for complete spectral reconstruction.</p>
  </sec>
</body>
<back>
  <notes id="notes1" notes-type="si">
    <title>Supporting Information Available</title>
    <p>The Supporting Information
is
available free of charge at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/10.1021/acs.analchem.3c03078?goto=supporting-info">https://pubs.acs.org/doi/10.1021/acs.analchem.3c03078</ext-link>.<list id="silist" list-type="simple"><list-item><p>Simulation example for overlapping and moving peaks,
visualization of overlap between broad and narrow peaks, scatter plot
for the amplitude estimation in the ibuprofen–prednisone mixture
data set, performance of recovering clusters in the simulated data
set, automatic annotation in an experimental mixture, SAND performance
on simulated spectra with phase distortion, SAND peaks remodeled with
exponential + Gaussian model, list of compounds and concentrations
in the spike-in solution, design of the spike-in experiment, and performance
of different quantification methods (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">PDF</ext-link>)</p></list-item><list-item><p>Tutorial slides for using SAND via
NMRPipe (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_002.pdf">PDF</ext-link>)</p></list-item></list></p>
  </notes>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sifile1">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_si_001.pdf">
        <caption>
          <p>ac3c03078_si_001.pdf</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sifile2">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_si_002.pdf">
        <caption>
          <p>ac3c03078_si_002.pdf</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <notes notes-type="" id="notes2">
    <title>Author Contributions</title>
    <p>A.S.E., F.D.,
and Y.W. conceived the project idea. Y.W. and F.D. designed the SAND
program. Y.W. and O.S. wrote the SAND program. Y.W. and O.S. tested
the SAND program with different data, benchmarks, and environments.
F.D., O.S., and Y.W. tested SAND on NMRbox and built the tutorial.
M.U. collected the spike-in experiment data. K.K. ran the benchmark
on CRAFT. All authors contributed to the manuscript writing and have
given approval to the final version of the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement" id="notes3">
    <p>The authors
declare no competing financial interest.</p>
  </notes>
  <notes notes-type="" id="notes4">
    <title>Notes</title>
    <p>Certain commercial equipment, instruments, and
materials are identified in this paper in order to specify the experimental
procedure. Such identification does not imply recommendation or endorsement
by the National Institute of Standards and Technology, nor does it
imply that the material or equipment identified is necessarily the
best available for the purpose.</p>
  </notes>
  <notes notes-type="" id="notes5">
    <title>Notes</title>
    <p>Not
Human Subjects Research: The National Institute
of Standards and Technology Research Protections Office reviewed the
protocol for this project and determined it is “not human subjects
research” as defined in 15 CFR 27, the Common Rule for the
Protection of Human Subjects.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Sicong Zhang for providing the buffer for
the spike-in experiment. We thank Mark W. Maciejewski and Chad Rienstra
for useful discussions. We appreciate computational support from GACRC,
especially Shan-Ho Tsai and Zhuofei Hou. This work was supported by
the NSF no. 1946970: Midscale RI-2 Consortium: Network for Advanced
NMR. This study made use of NMRbox: National Center for Biomolecular
NMR Data Processing and Analysis, a Biomedical Technology Research
Resource (BTRR), which is supported by NIH grant no. P41GM111135 (NIGMS).
We appreciated Gerard Weatherby for supporting the computing in NMRbox.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Wu</surname><given-names>Y.</given-names></name>; <name><surname>Tayyari</surname><given-names>F.</given-names></name>; <name><surname>Hattori</surname><given-names>A.</given-names></name>; <name><surname>Glushka</surname><given-names>J.</given-names></name>; <name><surname>Ito</surname><given-names>T.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name><article-title>Continuous in vivo Metabolism by
NMR</article-title>. <source>Front. Mol. Biosci.</source><year>2019</year>, <volume>6</volume>, <fpage>26</fpage><pub-id pub-id-type="doi">10.3389/fmolb.2019.00026</pub-id>.<pub-id pub-id-type="pmid">31114791</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="journal" id="cit2"><name><surname>Link</surname><given-names>H.</given-names></name>; <name><surname>Fuhrer</surname><given-names>T.</given-names></name>; <name><surname>Gerosa</surname><given-names>L.</given-names></name>; <name><surname>Zamboni</surname><given-names>N.</given-names></name>; <name><surname>Sauer</surname><given-names>U.</given-names></name><article-title>Real-time
metabolome profiling of the metabolic switch between starvation and
growth</article-title>. <source>Nat. Methods</source><year>2015</year>, <volume>12</volume> (<issue>11</issue>), <fpage>1091</fpage>–<lpage>1097</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3584</pub-id>.<pub-id pub-id-type="pmid">26366986</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>Colonna</surname><given-names>M.</given-names></name>; <name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Holderman</surname><given-names>N. R.</given-names></name>; <name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Shen</surname><given-names>X. N.</given-names></name>; <name><surname>Zhang</surname><given-names>S. C.</given-names></name><article-title>NMR: Unique
Strengths
That Enhance Modern Metabolomics Research</article-title>. <source>Analytical
chemistry</source><year>2021</year>, <volume>93</volume> (<issue>1</issue>), <fpage>478</fpage>–<lpage>499</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.0c04414</pub-id>.<pub-id pub-id-type="pmid">33180470</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Bifarin</surname><given-names>O. O.</given-names></name>; <name><surname>Gaul</surname><given-names>D. A.</given-names></name>; <name><surname>Sah</surname><given-names>S.</given-names></name>; <name><surname>Arnold</surname><given-names>R. S.</given-names></name>; <name><surname>Ogan</surname><given-names>K.</given-names></name>; <name><surname>Master</surname><given-names>V. A.</given-names></name>; <name><surname>Roberts</surname><given-names>D. L.</given-names></name>; <name><surname>Bergquist</surname><given-names>S. H.</given-names></name>; <name><surname>Petros</surname><given-names>J. A.</given-names></name>; <name><surname>Fernandez</surname><given-names>F. M.</given-names></name>; et al. <article-title>Machine Learning-Enabled
Renal Cell Carcinoma Status Prediction Using Multiplatform Urine-Based
Metabolomics</article-title>. <source>J. Proteome Res.</source><year>2021</year>, <volume>20</volume> (<issue>7</issue>), <fpage>3629</fpage>–<lpage>3641</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.1c00213</pub-id>.<pub-id pub-id-type="pmid">34161092</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="journal" id="cit5"><name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Shaver</surname><given-names>A. O.</given-names></name>; <name><surname>Garcia</surname><given-names>B. M.</given-names></name>; <name><surname>Morse</surname><given-names>A. M.</given-names></name>; <name><surname>Andersen</surname><given-names>E. C.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>McIntyre</surname><given-names>L. M.</given-names></name><article-title>Long-Term Metabolomics Reference
Material</article-title>. <source>Analytical chemistry</source><year>2021</year>, <volume>93</volume> (<issue>26</issue>), <fpage>9193</fpage>–<lpage>9199</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.1c01294</pub-id>.<pub-id pub-id-type="pmid">34156835</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Maughon</surname><given-names>T. S.</given-names></name>; <name><surname>Shen</surname><given-names>X. N.</given-names></name>; <name><surname>Huang</surname><given-names>D. N.</given-names></name>; <name><surname>Michael</surname><given-names>A. O. A.</given-names></name>; <name><surname>Shockey</surname><given-names>W. A.</given-names></name>; <name><surname>Andrews</surname><given-names>S. H.</given-names></name>; <name><surname>McRae</surname><given-names>J. M.</given-names></name>; <name><surname>Platt</surname><given-names>M. O.</given-names></name>; <name><surname>Fernandez</surname><given-names>F. M.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; et al. <article-title>Metabolomics and cytokine profiling of mesenchymal
stromal cells identify markers predictive of T-cell suppression</article-title>. <source>Cytotherapy</source><year>2022</year>, <volume>24</volume> (<issue>2</issue>), <fpage>137</fpage>–<lpage>148</lpage>. <pub-id pub-id-type="doi">10.1016/j.jcyt.2021.08.002</pub-id>.<pub-id pub-id-type="pmid">34696960</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Shaver</surname><given-names>A. O.</given-names></name>; <name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Kirby</surname><given-names>P. S.</given-names></name>; <name><surname>Andersen</surname><given-names>E. C.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name><article-title>Culture
and Assay of Large-Scale Mixed-Stage Caenorhabditis elegans Populations</article-title>. <source>Jove-J. Vis Exp</source><year>2021</year>, <volume>171</volume>, <elocation-id>e61453</elocation-id><pub-id pub-id-type="doi">10.3791/61453</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>Choe</surname><given-names>A.</given-names></name>; <name><surname>Chuman</surname><given-names>T.</given-names></name>; <name><surname>von Reuss</surname><given-names>S. H.</given-names></name>; <name><surname>Dossey</surname><given-names>A. T.</given-names></name>; <name><surname>Yim</surname><given-names>J. J.</given-names></name>; <name><surname>Ajredini</surname><given-names>R.</given-names></name>; <name><surname>Kolawa</surname><given-names>A. A.</given-names></name>; <name><surname>Kaplan</surname><given-names>F.</given-names></name>; <name><surname>Alborn</surname><given-names>H. T.</given-names></name>; <name><surname>Teal</surname><given-names>P. E. A.</given-names></name>; et al. <article-title>Sex-specific mating pheromones in the nematode
Panagrellus redivivus</article-title>. <source>Proc. Natl. Acad. Sci.
U.S.A.</source><year>2012</year>, <volume>109</volume> (<issue>51</issue>), <fpage>20949</fpage>–<lpage>20954</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1218302109</pub-id>.<pub-id pub-id-type="pmid">23213209</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><person-group person-group-type="allauthors"><name><surname>Bastawrous</surname><given-names>M.</given-names></name>, <name><surname>Jenne</surname><given-names>A.</given-names></name>, <name><surname>Tabatabaei Anaraki</surname><given-names>M.</given-names></name>; <name><surname>Simpson</surname><given-names>A. J.</given-names></name></person-group><article-title>In-Vivo NMR Spectroscopy: A Powerful and Complimentary Tool for Understanding
Environmental Toxicity</article-title>. <source>Metabolites</source><year>2018</year>, <volume>8</volume> ( (<issue>2</issue>), ). DOI: <fpage>35</fpage><pub-id pub-id-type="doi">10.3390/metabo8020035</pub-id>.<pub-id pub-id-type="pmid">29795000</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Battogtokh</surname><given-names>D.</given-names></name>; <name><surname>Asch</surname><given-names>D. K.</given-names></name>; <name><surname>Case</surname><given-names>M. E.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name>; <name><surname>Schuttler</surname><given-names>H. B.</given-names></name><article-title>An ensemble
method for identifying regulatory circuits with special reference
to the qa gene cluster of Neurospora crassa</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2002</year>, <volume>99</volume> (<issue>26</issue>), <fpage>16904</fpage>–<lpage>16909</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.262658899</pub-id>.<pub-id pub-id-type="pmid">12477937</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><name><surname>Fuhrer</surname><given-names>T.</given-names></name>; <name><surname>Zampieri</surname><given-names>M.</given-names></name>; <name><surname>Sevin</surname><given-names>D. C.</given-names></name>; <name><surname>Sauer</surname><given-names>U.</given-names></name>; <name><surname>Zamboni</surname><given-names>N.</given-names></name><article-title>Genomewide
landscape of gene-metabolome associations in Escherichia coli</article-title>. <source>Mol. Syst. Biol.</source><year>2017</year>, <volume>13</volume> (<issue>1</issue>), <fpage>907</fpage><pub-id pub-id-type="doi">10.15252/msb.20167150</pub-id>.<pub-id pub-id-type="pmid">28093455</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="journal" id="cit12"><name><surname>Ernst</surname><given-names>R. R.</given-names></name>; <name><surname>Anderson</surname><given-names>W. A.</given-names></name><article-title>Application of Fourier Transform Spectroscopy to Magnetic
Resonance</article-title>. <source>Rev. Sci. Instrum.</source><year>1966</year>, <volume>37</volume> (<issue>1</issue>), <fpage>93</fpage><pub-id pub-id-type="doi">10.1063/1.1719961</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Whiley</surname><given-names>L.</given-names></name>; <name><surname>Chekmeneva</surname><given-names>E.</given-names></name>; <name><surname>Berry</surname><given-names>D. J.</given-names></name>; <name><surname>Jimenez</surname><given-names>B.</given-names></name>; <name><surname>Yuen</surname><given-names>A. H. Y.</given-names></name>; <name><surname>Salam</surname><given-names>A.</given-names></name>; <name><surname>Hussain</surname><given-names>H.</given-names></name>; <name><surname>Witt</surname><given-names>M.</given-names></name>; <name><surname>Takats</surname><given-names>Z.</given-names></name>; <name><surname>Nicholson</surname><given-names>J.</given-names></name>; et al. <article-title>Systematic Isolation and Structure Elucidation
of Urinary Metabolites Optimized for the Analytical-Scale Molecular
Profiling Laboratory</article-title>. <source>Analytical chemistry</source><year>2019</year>, <volume>91</volume> (<issue>14</issue>), <fpage>8873</fpage>–<lpage>8882</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.9b00241</pub-id>.<pub-id pub-id-type="pmid">31188566</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="journal" id="cit14"><name><surname>Johnson</surname><given-names>C. S.</given-names></name><article-title>Diffusion
ordered nuclear magnetic resonance spectroscopy: principles and applications</article-title>. <source>Prog. Nucl. Magn. Reson. Spectrosc.</source><year>1999</year>, <volume>34</volume> (<issue>3–4</issue>), <fpage>203</fpage>–<lpage>256</lpage>. <pub-id pub-id-type="doi">10.1016/S0079-6565(99)00003-5</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <mixed-citation publication-type="journal" id="cit15"><name><surname>Aue</surname><given-names>W. P.</given-names></name>; <name><surname>Karhan</surname><given-names>J.</given-names></name>; <name><surname>Ernst</surname><given-names>R. R.</given-names></name><article-title>Homonuclear
Broad-Band Decoupling
and 2-Dimensional J-Resolved Nmr-Spectroscopy</article-title>. <source>J. Chem. Phys.</source><year>1976</year>, <volume>64</volume> (<issue>10</issue>), <fpage>4226</fpage>–<lpage>4227</lpage>. <pub-id pub-id-type="doi">10.1063/1.431994</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <mixed-citation publication-type="journal" id="cit16"><name><surname>Meiboom</surname><given-names>S.</given-names></name>; <name><surname>Gill</surname><given-names>D.</given-names></name><article-title>Modified Spin-Echo
Method for Measuring Nuclear Relaxation Times</article-title>. <source>Rev. Sci. Instrum.</source><year>1958</year>, <volume>29</volume> (<issue>8</issue>), <fpage>688</fpage>–<lpage>691</lpage>. <pub-id pub-id-type="doi">10.1063/1.1716296</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <mixed-citation publication-type="journal" id="cit17"><name><surname>Carr</surname><given-names>H. Y.</given-names></name>; <name><surname>Purcell</surname><given-names>E. M.</given-names></name><article-title>Effects of Diffusion on Free Precession in Nuclear
Magnetic Resonance Experiments</article-title>. <source>Phys. Rev.</source><year>1954</year>, <volume>94</volume> (<issue>3</issue>), <fpage>630</fpage>–<lpage>638</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRev.94.630</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <mixed-citation publication-type="journal" id="cit18"><name><surname>Sousa</surname><given-names>S. A. A.</given-names></name>; <name><surname>Magalhaes</surname><given-names>A.</given-names></name>; <name><surname>Ferreira</surname><given-names>M. M. C.</given-names></name><article-title>Optimized bucketing for NMR spectra:
Three case studies</article-title>. <source>Chemometr. Intell. Lab.</source><year>2013</year>, <volume>122</volume>, <fpage>93</fpage>–<lpage>102</lpage>. <pub-id pub-id-type="doi">10.1016/j.chemolab.2013.01.006</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <mixed-citation publication-type="journal" id="cit19"><name><surname>Hao</surname><given-names>J.</given-names></name>; <name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Ebbels</surname><given-names>T. M. D.</given-names></name><article-title>BATMAN-an R package
for the automated quantification of metabolites from nuclear magnetic
resonance spectra using a Bayesian model</article-title>. <source>Bioinformatics</source><year>2012</year>, <volume>28</volume> (<issue>15</issue>), <fpage>2088</fpage>–<lpage>2090</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts308</pub-id>.<pub-id pub-id-type="pmid">22635605</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref20">
      <mixed-citation publication-type="journal" id="cit20"><name><surname>Hao</surname><given-names>J.</given-names></name>; <name><surname>Liebeke</surname><given-names>M.</given-names></name>; <name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Bundy</surname><given-names>J. G.</given-names></name>; <name><surname>Ebbels</surname><given-names>T. M. D.</given-names></name><article-title>Bayesian
deconvolution and quantification of metabolites
in complex 1D NMR spectra using BATMAN</article-title>. <source>Nature
protocols</source><year>2014</year>, <volume>9</volume> (<issue>6</issue>), <fpage>1416</fpage>–<lpage>1427</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2014.090</pub-id>.<pub-id pub-id-type="pmid">24853927</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref21">
      <mixed-citation publication-type="journal" id="cit21"><name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Richardson</surname><given-names>S.</given-names></name>; <name><surname>Stephens</surname><given-names>D.</given-names></name>; <name><surname>Ebbels</surname><given-names>T.</given-names></name><article-title>A Bayesian
Model of NMR Spectra for the Deconvolution and Quantification of Metabolites
in Complex Biological Mixtures</article-title>. <source>J. Am. Stat
Assoc</source><year>2012</year>, <volume>107</volume> (<issue>500</issue>), <fpage>1259</fpage>–<lpage>1271</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.2012.695661</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <mixed-citation publication-type="journal" id="cit22"><name><surname>Zheng</surname><given-names>C.</given-names></name>; <name><surname>Zhang</surname><given-names>S. C.</given-names></name>; <name><surname>Ragg</surname><given-names>S.</given-names></name>; <name><surname>Raftery</surname><given-names>D.</given-names></name>; <name><surname>Vitek</surname><given-names>O.</given-names></name><article-title>Identification
and quantification of metabolites in H-1 NMR spectra by Bayesian model
selection</article-title>. <source>Bioinformatics</source><year>2011</year>, <volume>27</volume> (<issue>12</issue>), <fpage>1637</fpage>–<lpage>1644</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr118</pub-id>.<pub-id pub-id-type="pmid">21398670</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref23">
      <mixed-citation publication-type="journal" id="cit23"><name><surname>Ravanbakhsh</surname><given-names>S.</given-names></name>; <name><surname>Liu</surname><given-names>P.</given-names></name>; <name><surname>Bjorndahl</surname><given-names>T. C.</given-names></name>; <name><surname>Mandal</surname><given-names>R.</given-names></name>; <name><surname>Grant</surname><given-names>J. R.</given-names></name>; <name><surname>Wilson</surname><given-names>M.</given-names></name>; <name><surname>Eisner</surname><given-names>R.</given-names></name>; <name><surname>Sinelnikov</surname><given-names>I.</given-names></name>; <name><surname>Hu</surname><given-names>X. Y.</given-names></name>; <name><surname>Luchinat</surname><given-names>C.</given-names></name>; et al. <article-title>Accurate,
Fully-Automated NMR Spectral Profiling for Metabolomics
(vol 10, e0124219, 2015)</article-title>. <source>PloS one</source><year>2015</year>, <volume>10</volume> (<issue>7</issue>), <elocation-id>e0132873</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0132873</pub-id>.<pub-id pub-id-type="pmid">26222058</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref24">
      <mixed-citation publication-type="journal" id="cit24"><name><surname>Tredwell</surname><given-names>G. D.</given-names></name>; <name><surname>Behrends</surname><given-names>V.</given-names></name>; <name><surname>Geier</surname><given-names>F. M.</given-names></name>; <name><surname>Liebeke</surname><given-names>M.</given-names></name>; <name><surname>Bundy</surname><given-names>J. G.</given-names></name><article-title>Between-Person
Comparison of Metabolite Fitting for NMR-Based Quantitative Metabolomics</article-title>. <source>Analytical chemistry</source><year>2011</year>, <volume>83</volume> (<issue>22</issue>), <fpage>8683</fpage>–<lpage>8687</lpage>. <pub-id pub-id-type="doi">10.1021/ac202123k</pub-id>.<pub-id pub-id-type="pmid">21988367</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref25">
      <mixed-citation publication-type="book" id="cit25"><person-group person-group-type="allauthors"><name><surname>de Beer</surname><given-names>R.</given-names></name>; <name><surname>van Ormondt</surname><given-names>D.</given-names></name></person-group> in <source>In-Vivo Magnetic Resonance
Spectroscopy I: Probeheads and Radiofrequency Pulses Spectrum Analysis</source> (ed <person-group person-group-type="editor"><string-name><given-names>M.</given-names>, <surname>Rudin</surname></string-name></person-group>) <fpage>201</fpage>–<lpage>248</lpage> (<publisher-name>Springer Berlin Heidelberg</publisher-name>, <year>1992</year>).</mixed-citation>
    </ref>
    <ref id="ref26">
      <mixed-citation publication-type="journal" id="cit26"><name><surname>Sekihara</surname><given-names>K.</given-names></name>; <name><surname>Ohyama</surname><given-names>N.</given-names></name><article-title>Parameter estimation
for in vivo magnetic resonance
spectroscopy (MRS) using simulated annealing</article-title>. <source>Magn Reson Med.</source><year>1990</year>, <volume>13</volume> (<issue>2</issue>), <fpage>332</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.1910130217</pub-id>.<pub-id pub-id-type="pmid">2314222</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref27">
      <mixed-citation publication-type="journal" id="cit27"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.1. Parameter-Estimation Using Quadrature Nmr Models</article-title>. <source>J. Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>533</fpage>–<lpage>551</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90287-J</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref28">
      <mixed-citation publication-type="journal" id="cit28"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.2. Signal-Detection and Model Selection</article-title>. <source>J.
Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>552</fpage>–<lpage>570</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90288-K</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <mixed-citation publication-type="journal" id="cit29"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.3. Applications to Nmr Signal-Detection, Model Selection, and Parameter-Estimation</article-title>. <source>J. Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>571</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90289-L</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref30">
      <mixed-citation publication-type="journal" id="cit30"><name><surname>Krishnamurthy</surname><given-names>K.</given-names></name><article-title>CRAFT (complete
reduction to amplitude frequency table) - robust and time-efficient
Bayesian approach for quantitative mixture analysis by NMR</article-title>. <source>Magn. Reson. Chem.</source><year>2013</year>, <volume>51</volume> (<issue>12</issue>), <fpage>821</fpage>–<lpage>829</lpage>. <pub-id pub-id-type="doi">10.1002/mrc.4022</pub-id>.<pub-id pub-id-type="pmid">24154986</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref31">
      <mixed-citation publication-type="journal" id="cit31"><name><surname>Krishnamurthy</surname><given-names>K.</given-names></name><article-title>Complete Reduction
to Amplitude Frequency Table (CRAFT)-A perspective</article-title>. <source>Magn. Reson. Chem.</source><year>2021</year>, <volume>59</volume> (<issue>8</issue>), <fpage>757</fpage>–<lpage>791</lpage>. <pub-id pub-id-type="doi">10.1002/mrc.5135</pub-id>.<pub-id pub-id-type="pmid">33486830</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref32">
      <mixed-citation publication-type="journal" id="cit32"><name><surname>Rubtsov</surname><given-names>D. V.</given-names></name>; <name><surname>Waterman</surname><given-names>C.</given-names></name>; <name><surname>Currie</surname><given-names>R. A.</given-names></name>; <name><surname>Waterfield</surname><given-names>C.</given-names></name>; <name><surname>Salazar</surname><given-names>J. D.</given-names></name>; <name><surname>Wright</surname><given-names>J.</given-names></name>; <name><surname>Griffin</surname><given-names>J. L.</given-names></name><article-title>Application
of a
Bayesian Deconvolution Approach for High-Resolution 1H NMR Spectra
to Assessing the Metabolic Effects of Acute Phenobarbital Exposure
in Liver Tissue</article-title>. <source>Analytical chemistry</source><year>2010</year>, <volume>82</volume> (<issue>11</issue>), <fpage>4479</fpage>–<lpage>4485</lpage>. <pub-id pub-id-type="doi">10.1021/ac100344m</pub-id>.<pub-id pub-id-type="pmid">20446676</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref33">
      <mixed-citation publication-type="journal" id="cit33"><name><surname>Rubtsov</surname><given-names>D.
V.</given-names></name>; <name><surname>Griffin</surname><given-names>J. L.</given-names></name><article-title>Time-domain
Bayesian detection and estimation of noisy
damped sinusoidal signals applied to NMR spectroscopy</article-title>. <source>J. Magn. Reson.</source><year>2007</year>, <volume>188</volume> (<issue>2</issue>), <fpage>367</fpage>–<lpage>379</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2007.08.008</pub-id>.<pub-id pub-id-type="pmid">17827043</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref34">
      <mixed-citation publication-type="journal" id="cit34"><name><surname>Matviychuk</surname><given-names>Y.</given-names></name>; <name><surname>von Harbou</surname><given-names>E.</given-names></name>; <name><surname>Holland</surname><given-names>D. J.</given-names></name><article-title>An experimental validation of a Bayesian
model for quantification in NMR spectroscopy</article-title>. <source>J. Magn. Reson.</source><year>2017</year>, <volume>285</volume>, <fpage>86</fpage>–<lpage>100</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2017.10.009</pub-id>.<pub-id pub-id-type="pmid">29127944</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <mixed-citation publication-type="journal" id="cit35"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>An Introduction
to Parameter-Estimation Using Bayesian Probability-Theory</article-title>. <source>Fund Theor</source><year>1990</year>, <volume>39</volume>, <fpage>53</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1007/978-94-009-0683-9_5</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref36">
      <mixed-citation publication-type="journal" id="cit36"><name><surname>Hoch</surname><given-names>J. C.</given-names></name><article-title>Modern
Spectrum Analysis in Nuclear Magnetic-Resonance - Alternatives to
the Fourier-Transform</article-title>. <source>Methods Enzymol.</source><year>1989</year>, <volume>176</volume>, <fpage>216</fpage>–<lpage>241</lpage>. <pub-id pub-id-type="doi">10.1016/0076-6879(89)76014-6</pub-id>.<pub-id pub-id-type="pmid">2811688</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <mixed-citation publication-type="journal" id="cit37"><name><surname>Barkhuijsen</surname><given-names>H.</given-names></name>; <name><surname>Debeer</surname><given-names>R.</given-names></name>; <name><surname>Bovee</surname><given-names>W. M. M. J.</given-names></name>; <name><surname>Vanormondt</surname><given-names>D.</given-names></name><article-title>Retrieval
of Frequencies, Amplitudes, Damping Factors, and Phases from Time-Domain
Signals Using a Linear Least-Squares Procedure</article-title>. <source>J. Magn. Reson.</source><year>1985</year>, <volume>61</volume> (<issue>3</issue>), <fpage>465</fpage>–<lpage>481</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(85)90187-8</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref38">
      <mixed-citation publication-type="journal" id="cit38"><name><surname>Barkhuijsen</surname><given-names>H.</given-names></name>; <name><surname>Debeer</surname><given-names>R.</given-names></name>; <name><surname>Vanormondt</surname><given-names>D.</given-names></name><article-title>Improved Algorithm
for Noniterative
Time-Domain Model-Fitting to Exponentially Damped Magnetic-Resonance
Signals</article-title>. <source>J. Magn. Reson.</source><year>1987</year>, <volume>73</volume> (<issue>3</issue>), <fpage>553</fpage>–<lpage>557</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(87)90023-0</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <mixed-citation publication-type="journal" id="cit39"><name><surname>Djermoune</surname><given-names>E. H.</given-names></name>; <name><surname>Tomczak</surname><given-names>M.</given-names></name>; <name><surname>Brie</surname><given-names>D.</given-names></name><article-title>NMR Data Analysis:
A Time-Domain
Parametric Approach Using Adaptive Subband Decomposition</article-title>. <source>Oil Gas Sci. Technol.</source><year>2014</year>, <volume>69</volume> (<issue>2</issue>), <fpage>229</fpage>–<lpage>244</lpage>. <pub-id pub-id-type="doi">10.2516/ogst/2012092</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref40">
      <mixed-citation publication-type="journal" id="cit40"><name><surname>Koehl</surname><given-names>P.</given-names></name><article-title>Linear prediction
spectral analysis of NMR data</article-title>. <source>Prog. Nucl. Magn.
Reson. Spectrosc.</source><year>1999</year>, <volume>34</volume> (<issue>3–4</issue>), <fpage>257</fpage>–<lpage>299</lpage>. <pub-id pub-id-type="doi">10.1016/S0079-6565(99)00002-3</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref41">
      <mixed-citation publication-type="journal" id="cit41"><name><surname>Tang</surname><given-names>J.</given-names></name>; <name><surname>Norris</surname><given-names>J.</given-names></name><article-title>LP-ZOOM, a linear prediction
method for local spectral
analysis of NMR signals</article-title>. <source>Journal of Magnetic
Resonance (1969)</source><year>1988</year>, <volume>79</volume> (<issue>1</issue>), <fpage>190</fpage>–<lpage>196</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(88)90338-1</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref42">
      <mixed-citation publication-type="journal" id="cit42"><name><surname>Mandelshtam</surname><given-names>V. A.</given-names></name>; <name><surname>Taylor</surname><given-names>H. S.</given-names></name><article-title>Multidimensional harmonic inversion
by filter-diagonalization</article-title>. <source>J. Chem. Phys.</source><year>1998</year>, <volume>108</volume> (<issue>24</issue>), <fpage>9970</fpage>–<lpage>9977</lpage>. <pub-id pub-id-type="doi">10.1063/1.476495</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref43">
      <mixed-citation publication-type="undeclared" id="cit43"><person-group person-group-type="allauthors"><name><surname>Cobas</surname><given-names>C.</given-names></name>, <name><surname>Seoane</surname><given-names>F.</given-names></name>, <name><surname>Sykora</surname><given-names>S.</given-names></name></person-group><source>Global Spectral
Deconvolution
(GSD) of 1D-NMR spectra</source>, &lt; <pub-id pub-id-type="doi">10.3247/sl2nmr08.011&gt;</pub-id> (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="ref44">
      <mixed-citation publication-type="journal" id="cit44"><name><surname>Maciejewski</surname><given-names>M. W.</given-names></name>; <name><surname>Schuyler</surname><given-names>A. D.</given-names></name>; <name><surname>Gryk</surname><given-names>M. R.</given-names></name>; <name><surname>Moraru</surname><given-names>I. I.</given-names></name>; <name><surname>Romero</surname><given-names>P. R.</given-names></name>; <name><surname>Ulrich</surname><given-names>E. L.</given-names></name>; <name><surname>Eghbalnia</surname><given-names>H. R.</given-names></name>; <name><surname>Livny</surname><given-names>M.</given-names></name>; <name><surname>Delaglio</surname><given-names>F.</given-names></name>; <name><surname>Hoch</surname><given-names>J. C.</given-names></name><article-title>NMRbox:
A Resource for Biomolecular NMR Computation</article-title>. <source>Biophys. J.</source><year>2017</year>, <volume>112</volume> (<issue>8</issue>), <fpage>1529</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2017.03.011</pub-id>.<pub-id pub-id-type="pmid">28445744</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref45">
      <mixed-citation publication-type="journal" id="cit45"><name><surname>Delaglio</surname><given-names>F.</given-names></name>; <name><surname>Grzesiek</surname><given-names>S.</given-names></name>; <name><surname>Vuister</surname><given-names>G. W.</given-names></name>; <name><surname>Zhu</surname><given-names>G.</given-names></name>; <name><surname>Pfeifer</surname><given-names>J.</given-names></name>; <name><surname>Bax</surname><given-names>A.</given-names></name><article-title>Nmrpipe - a Multidimensional Spectral
Processing System Based on
Unix Pipes</article-title>. <source>J. Biomol Nmr</source><year>1995</year>, <volume>6</volume> (<issue>3</issue>), <fpage>277</fpage>–<lpage>293</lpage>. <pub-id pub-id-type="doi">10.1007/BF00197809</pub-id>.<pub-id pub-id-type="pmid">8520220</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref46">
      <mixed-citation publication-type="book" id="cit46"><person-group person-group-type="allauthors"><name><surname>Landau</surname><given-names>D. P.</given-names></name>; <name><surname>Binder</surname><given-names>K.</given-names></name></person-group><source>A Guide to Monte Carlo
Simulations in Statistical Physics</source>. <edition>4</edition> edn,
(<publisher-name>Cambridge University Press</publisher-name>, <year>2014</year>).</mixed-citation>
    </ref>
    <ref id="ref47">
      <mixed-citation publication-type="journal" id="cit47"><name><surname>Byrd</surname><given-names>R. H.</given-names></name>; <name><surname>Gilbert</surname><given-names>J. C.</given-names></name>; <name><surname>Nocedal</surname><given-names>J.</given-names></name><article-title>A trust region
method based on interior
point techniques for nonlinear programming</article-title>. <source>Math Program</source><year>2000</year>, <volume>89</volume> (<issue>1</issue>), <fpage>149</fpage>–<lpage>185</lpage>. <pub-id pub-id-type="doi">10.1007/PL00011391</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref48">
      <mixed-citation publication-type="journal" id="cit48"><name><surname>Salvatier</surname><given-names>J.</given-names></name>; <name><surname>Wiecki</surname><given-names>T. V.</given-names></name>; <name><surname>Fonnesbeck</surname><given-names>C.</given-names></name><article-title>Probabilistic programming in Python
using PyMC3</article-title>. <source>Peerj Comput. Sci.</source><year>2016</year>, <volume>2</volume>, <elocation-id>e55</elocation-id><pub-id pub-id-type="doi">10.7717/peerj-cs.55</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref49">
      <mixed-citation publication-type="book" id="cit49"><person-group person-group-type="allauthors"><name><surname>Liu</surname><given-names>J. S.</given-names></name></person-group><source>Monte Carlo strategies
in scientific computing</source>. (<publisher-name>Springer</publisher-name>, <year>2001</year>).</mixed-citation>
    </ref>
    <ref id="ref50">
      <mixed-citation publication-type="journal" id="cit50"><name><surname>Dona</surname><given-names>A. C.</given-names></name>; <name><surname>Jimenez</surname><given-names>B.</given-names></name>; <name><surname>Schafer</surname><given-names>H.</given-names></name>; <name><surname>Humpfer</surname><given-names>E.</given-names></name>; <name><surname>Spraul</surname><given-names>M.</given-names></name>; <name><surname>Lewis</surname><given-names>M. R.</given-names></name>; <name><surname>Pearce</surname><given-names>J. T. M.</given-names></name>; <name><surname>Holmes</surname><given-names>E.</given-names></name>; <name><surname>Lindon</surname><given-names>J. C.</given-names></name>; <name><surname>Nicholson</surname><given-names>J. K.</given-names></name><article-title>Precision
High-Throughput Proton NMR Spectroscopy of
Human Urine, Serum, and Plasma for Large-Scale Metabolic Phenotyping</article-title>. <source>Analytical chemistry</source><year>2014</year>, <volume>86</volume> (<issue>19</issue>), <fpage>9887</fpage>–<lpage>9894</lpage>. <pub-id pub-id-type="doi">10.1021/ac5025039</pub-id>.<pub-id pub-id-type="pmid">25180432</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref51">
      <mixed-citation publication-type="book" id="cit51"><person-group person-group-type="allauthors"><name><surname>Robson</surname><given-names>S.</given-names></name>, <name><surname>Arthanari</surname><given-names>H.</given-names></name>, <name><surname>Hyberts</surname><given-names>S. G.</given-names></name>, <name><surname>Wagner</surname><given-names>G.</given-names></name></person-group> in <source>Methods in enzymology</source> Vol. <volume>614</volume> (ed <person-group person-group-type="editor"><string-name><given-names>A. Joshua</given-names>, <surname>Wand</surname></string-name></person-group>) <fpage>263</fpage>–<lpage>291</lpage> (<publisher-name>Academic Press</publisher-name>, <year>2019</year>).</mixed-citation>
    </ref>
    <ref id="ref52">
      <mixed-citation publication-type="journal" id="cit52"><name><surname>Cloarec</surname><given-names>O.</given-names></name>; <name><surname>Dumas</surname><given-names>M. E.</given-names></name>; <name><surname>Craig</surname><given-names>A.</given-names></name>; <name><surname>Barton</surname><given-names>R. H.</given-names></name>; <name><surname>Trygg</surname><given-names>J.</given-names></name>; <name><surname>Hudson</surname><given-names>J.</given-names></name>; <name><surname>Blancher</surname><given-names>C.</given-names></name>; <name><surname>Gauguier</surname><given-names>D.</given-names></name>; <name><surname>Lindon</surname><given-names>J. C.</given-names></name>; <name><surname>Holmes</surname><given-names>E.</given-names></name>; et al. <article-title>Statistical
total correlation spectroscopy: an exploratory
approach for latent biomarker identification from metabolic 1H NMR
data sets</article-title>. <source>Analytical chemistry</source><year>2005</year>, <volume>77</volume> (<issue>5</issue>), <fpage>1282</fpage>–<lpage>1289</lpage>. <pub-id pub-id-type="doi">10.1021/ac048630x</pub-id>.<pub-id pub-id-type="pmid">15732908</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref53">
      <mixed-citation publication-type="journal" id="cit53"><name><surname>Wu</surname><given-names>Y.</given-names></name>; <name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name><article-title>Uncovering in vivo
biochemical patterns from time-series metabolic dynamics</article-title>. <source>PloS one</source><year>2022</year>, <volume>17</volume> (<issue>5</issue>), <elocation-id>e0268394</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0268394</pub-id>.<pub-id pub-id-type="pmid">35550643</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref54">
      <mixed-citation publication-type="journal" id="cit54"><name><surname>Dobin</surname><given-names>A.</given-names></name>; <name><surname>Davis</surname><given-names>C. A.</given-names></name>; <name><surname>Schlesinger</surname><given-names>F.</given-names></name>; <name><surname>Drenkow</surname><given-names>J.</given-names></name>; <name><surname>Zaleski</surname><given-names>C.</given-names></name>; <name><surname>Jha</surname><given-names>S.</given-names></name>; <name><surname>Batut</surname><given-names>P.</given-names></name>; <name><surname>Chaisson</surname><given-names>M.</given-names></name>; <name><surname>Gingeras</surname><given-names>T. R.</given-names></name><article-title>STAR: ultrafast
universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><year>2013</year>, <volume>29</volume> (<issue>1</issue>), <fpage>15</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>.<pub-id pub-id-type="pmid">23104886</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref55">
      <mixed-citation publication-type="journal" id="cit55"><name><surname>Muzny</surname><given-names>D. M.</given-names></name>; <name><surname>Bainbridge</surname><given-names>M. N.</given-names></name>; <name><surname>Chang</surname><given-names>K.</given-names></name>; <name><surname>Dinh</surname><given-names>H. H.</given-names></name>; <name><surname>Drummond</surname><given-names>J. A.</given-names></name>; <name><surname>Fowler</surname><given-names>G.</given-names></name>; <name><surname>Kovar</surname><given-names>C. L.</given-names></name>; <name><surname>Lewis</surname><given-names>L. R.</given-names></name>; <name><surname>Morgan</surname><given-names>M. B.</given-names></name>; <name><surname>Newsham</surname><given-names>I. F.</given-names></name>; et al. <article-title>Comprehensive molecular characterization of
human colon and rectal cancer</article-title>. <source>Nature</source><year>2012</year>, <volume>487</volume> (<issue>7407</issue>), <fpage>330</fpage>–<lpage>337</lpage>. <pub-id pub-id-type="doi">10.1038/nature11252</pub-id>.<pub-id pub-id-type="pmid">22810696</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref56">
      <mixed-citation publication-type="journal" id="cit56"><name><surname>Li</surname><given-names>B.</given-names></name>; <name><surname>Dewey</surname><given-names>C. N.</given-names></name><article-title>RSEM: accurate transcript
quantification from RNA-Seq
data with or without a reference genome</article-title>. <source>BMC
bioinformatics</source><year>2011</year>, <volume>12</volume>, <fpage>323</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>.<pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Anal Chem</journal-id>
    <journal-id journal-id-type="iso-abbrev">Anal Chem</journal-id>
    <journal-id journal-id-type="publisher-id">ac</journal-id>
    <journal-id journal-id-type="coden">ancham</journal-id>
    <journal-title-group>
      <journal-title>Analytical Chemistry</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0003-2700</issn>
    <issn pub-type="epub">1520-6882</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10896553</article-id>
    <article-id pub-id-type="pmid">38273718</article-id>
    <article-id pub-id-type="doi">10.1021/acs.analchem.3c03078</article-id>
    <article-categories>
      <subj-group>
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SAND: Automated
Time-Domain Modeling of NMR Spectra
Applied to Metabolite Quantification</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="ath1">
        <name>
          <surname>Wu</surname>
          <given-names>Yue</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <name>
          <surname>Sanati</surname>
          <given-names>Omid</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath3">
        <name>
          <surname>Uchimiya</surname>
          <given-names>Mario</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath4">
        <name>
          <surname>Krishnamurthy</surname>
          <given-names>Krish</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">∥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath5">
        <name>
          <surname>Wedell</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref rid="aff5" ref-type="aff">⊥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath6">
        <name>
          <surname>Hoch</surname>
          <given-names>Jeffrey C.</given-names>
        </name>
        <xref rid="aff6" ref-type="aff">#</xref>
      </contrib>
      <contrib contrib-type="author" id="ath7">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5686-2350</contrib-id>
        <name>
          <surname>Edison</surname>
          <given-names>Arthur S.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
        <xref rid="aff7" ref-type="aff">∇</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="ath8">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1264-2556</contrib-id>
        <name>
          <surname>Delaglio</surname>
          <given-names>Frank</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
        <xref rid="aff8" ref-type="aff">○</xref>
      </contrib>
      <aff id="aff1"><label>†</label>Institute
of Bioinformatics, <institution>University of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff2"><label>‡</label>School
of Electrical and Computer Engineering, <institution>University of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff3"><label>§</label>Complex
Carbohydrate Research Center, <institution>University
of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff4"><label>∥</label><institution>Chempacker
LLC</institution>, San Jose, California 95135, <country>United States</country></aff>
      <aff id="aff5"><label>⊥</label>National
Magnetic Resonance Facility, <institution>University
of Wisconsin-Madison</institution>, Madison, Wisconsin 53706, <country>United States</country></aff>
      <aff id="aff6"><label>#</label>Department
of Molecular Biology and Biophysics, <institution>University
of Connecticut</institution>, Farmington, Connecticut 06030-3305, <country>United States</country></aff>
      <aff id="aff7"><label>∇</label>Department
of Biochemistry and Molecular Biology, <institution>University
of Georgia</institution>, Athens, Georgia 30602, <country>United States</country></aff>
      <aff id="aff8"><label>○</label>Institute
for Bioscience and Biotechnology Research, <institution>National Institute of Standards and Technology and the University
of Maryland</institution>, Rockville, Maryland 20850, <country>United States</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Email: <email>frank.delaglio@nist.gov</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>01</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <day>06</day>
      <month>02</month>
      <year>2024</year>
    </pub-date>
    <volume>96</volume>
    <issue>5</issue>
    <fpage>1843</fpage>
    <lpage>1851</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>07</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>01</month>
        <year>2024</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>01</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 American Chemical Society</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>American Chemical Society</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>Permits non-commercial access and re-use, provided that author attribution and integrity are maintained; but does not permit creation of adaptations or other derivative works (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">https://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0005" id="ab-tgr1"/>
      </p>
      <p>Developments in untargeted nuclear magnetic resonance
(NMR) metabolomics
enable the profiling of thousands of biological samples. The exploitation
of this rich source of information requires a detailed quantification
of spectral features. However, the development of a consistent and
automatic workflow has been challenging because of extensive signal
overlap. To address this challenge, we introduce the software Spectral
Automated NMR Decomposition (SAND). SAND follows on from the previous
success of time-domain modeling and automatically quantifies entire
spectra without manual interaction. The SAND approach uses hybrid
optimization with Markov chain Monte Carlo methods, employing subsampling
in both time and frequency domains. In particular, SAND randomly divides
the time-domain data into training and validation sets to help avoid
overfitting. We demonstrate the accuracy of SAND, which provides a
correlation of ∼0.9 with ground truth on cases including highly
overlapped simulated data sets, a two-compound mixture, and a urine
sample spiked with different amounts of a four-compound mixture. We
further demonstrate an automated annotation using correlation networks
derived from SAND decomposed peaks, and on average, 74% of peaks for
each compound can be recovered in single clusters. SAND is available
in NMRbox, the cloud computing environment for NMR software hosted
by the Network for Advanced NMR (NAN). Since the SAND method uses
time-domain subsampling (i.e., random subset of time-domain points),
it has the potential to be extended to a higher dimensionality and
nonuniformly sampled data.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Division of Biological Infrastructure</institution>
            <institution-id institution-id-type="doi">10.13039/100000153</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1946970</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>ac3c03078</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>ac3c03078</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <p id="sec1">Metabolomics techniques have advanced in both capability and importance,
producing untargeted profiling on a diverse set of biological systems.<sup><xref ref-type="bibr" rid="ref1">1</xref>−<xref ref-type="bibr" rid="ref8">8</xref></sup> Nuclear magnetic resonance (NMR) spectroscopy has enabled nondestructive
and even in vivo metabolic measurements of samples.<sup><xref ref-type="bibr" rid="ref1">1</xref>,<xref ref-type="bibr" rid="ref9">9</xref></sup> Such
untargeted profiling provides a detailed description of the metabolic
landscape, metabolic dynamics,<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> gene–environment
interactions,<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> and possible biomarkers.<sup><xref ref-type="bibr" rid="ref4">4</xref></sup></p>
  <p>Metabolomics data sets are intricate and
rich in information. NMR
data are collected as time-domain signals (free induction decay; FID),
and FIDs are usually Fourier-transformed (FT) into frequency-domain
spectra.<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> While the information content
in the time domain and frequency domain is similar, the FT converts
the complex set of decaying sinusoidal signals in the time domain
into localized individual peaks in the frequency domain and enables
a clear visual analysis. However, in metabolomics studies, there are
often hundreds of spectra, and each spectrum contains hundreds to
thousands of peaks from tens to hundreds of compounds; therefore,
the need to identify and characterize individual peaks is a serious
analysis bottleneck. In addition, the spectral signals are often highly
overlapped, hindering peak quantification and obstructing efficient
annotation. These problems are exacerbated by baseline distortion
and by the presence of broad signals from components with large molecular
weights.<sup><xref ref-type="bibr" rid="ref1">1</xref></sup></p>
  <p>The challenge of spectral
overlap has been approached from both
experimental and computational directions. A variety of experimental
methods have been developed to partially address the overlap problem,
including “pure shift” broadband decoupling to simplify
spectra.<sup><xref ref-type="bibr" rid="ref13">13</xref>−<xref ref-type="bibr" rid="ref17">17</xref></sup> New computational approaches are needed and are the focus of this
study. Spectra are often quantified by the intensity or integral after
peak picking or binning, but the quantification is highly affected
by overlap.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> Reference-library-based quantification
can target routine spectra and compounds, but this is restricted to
available libraries. For instance, Bayesian automated metabolite analyzer
for NMR (BATMAN) relies on precise template libraries, but its targeted
metabolite quantification leaves unknown features unresolved.<sup><xref ref-type="bibr" rid="ref19">19</xref>−<xref ref-type="bibr" rid="ref22">22</xref></sup></p>
  <p>Bayesil has restrictions on sample types and NMR procedures
and
is limited to a defined list of compounds.<sup><xref ref-type="bibr" rid="ref23">23</xref></sup> Chenomx provides a commercial solution to library-based fitting,
but it needs time-consuming manual interactions<sup><xref ref-type="bibr" rid="ref20">20</xref></sup> and has operator-dependent divergences in quantification.<sup><xref ref-type="bibr" rid="ref24">24</xref></sup></p>
  <p>A more general approach is to model the
spectra in an untargeted
and direct way through optimization.<sup><xref ref-type="bibr" rid="ref25">25</xref>,<xref ref-type="bibr" rid="ref26">26</xref></sup> In particular,
time-domain signal modeling directly tackles the overlap problem and
is advantageous for nonuniformly sampled data and data with baseline
problems.<sup><xref ref-type="bibr" rid="ref27">27</xref>−<xref ref-type="bibr" rid="ref29">29</xref></sup> The utility of time-domain modeling is demonstrated
by CRAFT, which is the complete reduction to amplitude frequency table
method. CRAFT, which is based upon a Bayesian framework, has been
used to decompose 1D and 2D NMR spectra by time-domain modeling, and
while CRAFT workflows can involve interactive partitioning of spectral
regions, CRAFT performance is robust with respect to any user-defined
parameters, and so it does have the potential for complete automation.<sup><xref ref-type="bibr" rid="ref27">27</xref>−<xref ref-type="bibr" rid="ref31">31</xref></sup> Similar ideas have been tested by researchers including Rubtsov
et al., but extensive validation and consistent workflows are not
available.<sup><xref ref-type="bibr" rid="ref32">32</xref>−<xref ref-type="bibr" rid="ref35">35</xref></sup> Singular value decomposition (SVD) and linear prediction-based methods
provide alternative solutions, but the tuning parameter, namely, the
reduced order, is hard to select for real-world data sets.<sup><xref ref-type="bibr" rid="ref36">36</xref>−<xref ref-type="bibr" rid="ref42">42</xref></sup> Alternatively, global spectral deconvolution (GSD)<sup><xref ref-type="bibr" rid="ref43">43</xref></sup> provides a convenient commercial solution that automatically
fits frequency-domain data, but in crowded regions, it tends to overfit
by using many non-ideal and nonphysical peaks. Therefore, an automated
untargeted method to decompose NMR spectra is still needed.</p>
  <p>We designed the spectral automatic NMR decomposition (SAND) method
and tested it on both simulated and experimental data sets. SAND automatically
decomposes NMR data into signal tables and accurately quantifies overlapped
peaks, and the SAND results can be used to extract compound annotations
from untargeted metabolomics data sets. SAND is integrated with the
computational facilities of NMRbox<sup><xref ref-type="bibr" rid="ref44">44</xref></sup> through
the NMRPipe<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> platform and Network for
Advanced NMR (NAN), providing an end-to-end workflow from samples
to feature tables.</p>
  <sec id="sec2">
    <title>Materials and Methods</title>
    <sec id="sec2.1">
      <title>Modeling in the Time Domain</title>
      <p>Since an ideal NMR signal
is considered to have an exponential decay and because the analytical
Fourier transform of an ideal exponential signal is a Lorentzian,
NMR spectra are commonly modeled in the frequency domain using Lorentzian
functions. However, NMR spectra are usually generated by discrete
Fourier transform so that, in practice, the corresponding signals
are not perfect Lorentzians even for noise-free ideal time-domain
data. As the number of time-domain points becomes small, the line
shape observed in the Fourier spectrum becomes increasingly broad
and non-ideal, including the appearance of increasingly prominent
truncation artifacts. Furthermore, the use of apodization functions
other than exponentials changes the corresponding Fourier lineshapes,
and apodization in general also changes the distribution of thermal
noise in the spectrum. Digital oversampling, which potentially distorts
early time-domain points, can therefore also change the corresponding
Fourier spectrum. Together, all of these effects are hard to analytically
model in the frequency domain but easy to accommodate numerically
in the time domain.</p>
      <p>Modeling in the time domain can also help
overcome the effects of baseline distortion on signal quantification.
Baseline distortions that extend over large portions of a spectrum
correspond to distortions in a small number of early points in the
time-domain. Therefore, time-domain modeling provides a chance to
mitigate the effects of baseline distortion by down-weighting or skipping
the early first points in the time-domain data.</p>
    </sec>
    <sec id="sec2.2">
      <title>Overview of SAND Decomposition</title>
      <p>The SAND workflow is
illustrated in <xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>. The input NMR spectra for the workflow are collected and pre-processed
automatically. They are then adaptively separated by an automated
procedure into smaller frequency buckets (bins) and inversely Fourier-processed
to generate time domain data, giving an FID for each bin. This helps
speed the analysis by reducing the number of signals that must be
optimized simultaneously and also allows for parallel computation.
In each bin, the FID is modeled as a sum of decaying complex sinusoidal
signals (<xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref>), one for
each signal. Each signal <italic>X</italic><sub><italic>k</italic></sub> is represented by a sequence of complex numbers through time
and is defined by four parameters: amplitude (<italic>A</italic><sub><italic>k</italic></sub>), frequency (<italic>f</italic><sub><italic>k</italic></sub>), decay (λ<sub><italic>k</italic></sub>),
and phase (ϕ<sub><italic>k</italic></sub>):<disp-formula id="eq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m001" position="anchor"/><label>1</label></disp-formula></p>
      <fig id="fig1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Key aspects of the SAND
workflow. (A) In order to minimize the
number of signals that need to be optimized simultaneously and enable
parallel processing, the measured spectrum (blue) is divided into
buckets by an adaptive automated procedure and an overlapping series
of raised cosine masks are generated according to the bucket boundaries
(gold dashed lines); one such mask is shown in in green. A given isolated
bucket (purple) is generated from the product of the measured spectrum
and a mask. (B) A given isolated bucket is inverse Fourier-processed
into the time domain (gray), and the points are randomly divided into
a training set (black points) and a validation set (red points). Then,
a series of models with increasing numbers of signals is proposed
and optimized to fit the training set with each signal modeled as
a complex decaying sinusoid. For each optimized model, a series of
statistics including RMSD are calculated to measure the agreement
between the model and validation set (pink graph), and the optimal
number of signals is identified when additional signals no longer
improve the model (gray dashed line) or if other stop criteria are
reached. (C) The result of SAND optimization is a signal table with
estimated model parameters of frequency, decay, and amplitude. The
parameters can optionally be used to generate simulated time domain
data, which is Fourier-processed in the same way as the measured spectrum
to allow a visual evaluation.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0001" id="gr1" position="float"/>
      </fig>
      <p>Frequency and time domains retain similar information
content.
For each FID, the decomposition process involves an iteration of the
initial value estimation, hybrid optimization of peak parameters,
and stop-criteria checking. Each iteration adds one more peak until
the stop criteria (later section) are met. More details of the process
are covered in later sections. We also provide a user-friendly version
available on NMRbox with an interface where selected parameters mentioned
in the following sections can be provided by the user.</p>
    </sec>
    <sec id="sec2.3">
      <title>NMR Spectral Pre-processing</title>
      <p>The pre-processing was
implemented in NMRPipe and MATLAB and included zero filling (ZF),
FT, phasing, line broadening, referencing, scaling, and format conversion.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> Spectra requiring only zero-order phasing were
corrected automatically, and interactive phasing was used when a first-order
phase correction was needed. Sample scripts for spectra processing
can be found here <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/edisonomics/SAND">https://github.com/edisonomics/SAND</uri>.</p>
    </sec>
    <sec id="sec2.4">
      <title>Automatic Binning of Metabolomics NMR Spectra</title>
      <p>Metabolic
NMR spectra often contain hundreds to thousands of peaks. Binning
separates the spectrum into smaller frequency regions to simplify
the process of optimization and parallelization.<sup><xref ref-type="bibr" rid="ref30">30</xref>,<xref ref-type="bibr" rid="ref41">41</xref></sup> We generate bins in the frequency domain with an adaptive automated
procedure using a bucket (bin) size parameter that gives the initial
size of bins and a slackness parameter that determines how much the
size of a given bin can be adjusted by the adaptive procedure.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> Our examples use a slackness of 0.99 and a bucket
size of 0.002. The bins are automatically adjusted so that each bin
contains at least one local optima, meaning at least one tentative
peak. We combine bins in groups of three to help ensure that a peak
will be evaluated with its neighbors. The binning can be performed
individually for each spectrum or once for a collection of related
samples with expected similarity between samples. The subspectra from
each bin were then post-processed. First, a subspectrum is shifted
to move its minimum to zero to remove any baseline offset. A raised-cosine
band function is then applied to each bin with a roll-off shoulder
of 0.02 ppm. This window function removes drastic changes in the bin
boundary and reduces artifacts in the inverse Fourier transformation
(IFT). The band-selected bin is then processed by Hilbert transform
to generate imaginary data and then inverse Fourier-processed to generate
an FID for each bin.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup></p>
    </sec>
    <sec id="sec2.5">
      <title>Resampling of Time-Domain Data</title>
      <p>Before the decomposition
iterations, the FID can be optionally truncated to exclude the trailing
noise. In the examples here, the first ∼6,000 of 16,384 complex
points in the beginning were used. The selected points from the FID
were then randomly sampled into three sets: “training”
for parameter optimization (70%), “validation” for checking
the stop criteria (20%), and “testing” for the final
evaluation (10%). This separation was intended to infer the reasonable
number of peaks in the stop-criteria checking step rather than strict
cross-validation in forecasting since it is expected that the time-series
samples can be autocorrelated.</p>
    </sec>
    <sec id="sec2.6">
      <title>Initial Parameter Estimation</title>
      <p>In each iteration, a new
peak is added if the stop criteria are not met. The initial values
were estimated to provide informative guesses and reduce the computational
cost of optimization. The initial values for the newly added peak
were estimated from the residual signals by sweeping through a frequency
grid:<disp-formula id="eq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m002" position="anchor"/><label>2</label></disp-formula></p>
      <p>The measured FID <italic>Y<sub>j</sub></italic>(<italic>t</italic>) of bin <italic>j</italic> was compared with the sum of <italic>n –</italic> 1 simulated
signals (<italic>k</italic> ∈ {1 ... <italic>n</italic><italic>–</italic> 1}) to produce the current residual. The signal
with a maximum amplitude was retrieved from the residual as the initial
guess for <italic>A</italic> and <italic>f</italic>. For such a guess,
the frequency was swept with 1,000 values and the default value was
used for and λ as the initial guess. The frequency was found
by the maximum product of the two complex vectors.</p>
    </sec>
    <sec id="sec2.7">
      <title>Parameter Optimization</title>
      <p>A hybrid optimization was used
to estimate peak parameters by minimizing the objective function (<xref rid="eq3" ref-type="disp-formula">eq <xref rid="eq3" ref-type="disp-formula">3</xref></xref>), where θ is the
vector of parameters of all peaks. For computational efficiency, the
optimization includes upper and lower bounds for the allowed values
of the decay λ. We used Metropolis sampling for the global parameter
search<sup><xref ref-type="bibr" rid="ref10">10</xref>,<xref ref-type="bibr" rid="ref46">46</xref></sup> and the interior-point method for the local
parameter refinement.<sup><xref ref-type="bibr" rid="ref47">47</xref></sup> The interior-point
method is the default option in MATLAB for the constrained nonlinear
multivariable function optimization. Metropolis sampling is one of
the Markov chain Monte Carlo (MCMC) methods and constructs a Markov
chain to capture the unknown model and generate results that are consistent
with the observation. The stochastic process can explore a complex
parameter space with many local optima and arrive at the global optima.
Good performance of MCMC has been demonstrated in statistical physics<sup><xref ref-type="bibr" rid="ref46">46</xref></sup> and Bayesian inference.<sup><xref ref-type="bibr" rid="ref48">48</xref>,<xref ref-type="bibr" rid="ref49">49</xref></sup> It has also been applied to biological problems where there are
a large number of parameters, but the measurement is sparse and noisy.<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> The introduction of MCMC can be found here.<sup><xref ref-type="bibr" rid="ref10">10</xref>,<xref ref-type="bibr" rid="ref46">46</xref>,<xref ref-type="bibr" rid="ref49">49</xref></sup><disp-formula id="eq3"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m003" position="anchor"/><label>3</label></disp-formula></p>
      <p>The optimization process
contained an outer loop (iteration) of MCMC optimization with local
refinement in the inner loop (step). One iteration (MCMC sweep) contains
4<italic>N</italic> steps, which is the number of optimizable parameters
(four times the number of peaks). In each MCMC step, a parameter is
selected at random and randomly perturbed. The perturbation depends
on the predefined parameter range and relative step size, which is
bounded by 10% in each step. The proposed perturbation is accepted
or rejected based on the probability (<xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref>) where the synthetic temperature is set to 80 by default
(<xref rid="eq5" ref-type="disp-formula">eq <xref rid="eq5" ref-type="disp-formula">5</xref></xref>). For each FID,
the temperature is adjusted with the estimated standard deviation
based on the FID end with no signals (<xref rid="eq5" ref-type="disp-formula">eq <xref rid="eq5" ref-type="disp-formula">5</xref></xref>). At every 100 MCMC iterations, local optimization
is used to refine the result. There are 4<italic>N</italic> steps
in one iteration and 2,000 iterations (by default) in the optimization
of one binned FID. Multiple optimization runs (default 3) with different
random seeds are performed, and the one with the best objective function
value is selected.<disp-formula id="eq4"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m004" position="anchor"/><label>4</label></disp-formula><disp-formula id="eq5"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m005" position="anchor"/><label>5</label></disp-formula></p>
    </sec>
    <sec id="sec2.8">
      <title>Stop Criteria</title>
      <p>The optimization is stopped when any
of the model complexity criteria are met. The first criterion regards
the improvement from the new signal. The criterion is met if the new
model does not improve the objective function by more than a threshold
(default 0.001). The second criterion regards the number of peaks
in the optimized bin, and the maximum was by default 7. This mostly
aimed to save computational resources for difficult regions as the
computational complexity increased with the maximal number of signals
by approximately a power of three. The third criterion regards the
initial guess amplitude of the new peak. It is true if the new peak
is less than by default 10% of the minimum of all existing peaks in
the bin.</p>
    </sec>
    <sec id="sec2.9">
      <title>Pre-processing Experimental NMR Spectra</title>
      <p>The prednisone–ibuprofen
mixtures were prepared in DMSO-<italic>d</italic><sub>6</sub>, and
the NMR data were collected with a Varian Inova 500 spectrometer.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> The spectra were processed in NMRPipe, including
additional formatting, baseline corrections by polynomial subtraction,
exponential line broadening (1.5 Hz), a scaling maximum to 1,000,
and chemical shift recalibration.<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> The
spectra were analyzed with the same set of automated bins. The spike-in
data set was processed in NMRPipe, including manual phasing, a scaling
maximum to 1000, and exponential line broadening (0.3 Hz). Each spectrum
was then automatically binned individually. Pre-processing scripts
for experimental data sets are provided in GitHub.</p>
    </sec>
    <sec id="sec2.10">
      <title>Spike-In Data Set Collection</title>
      <p>A spike-in experiment
was conducted by adding a mixture of compounds to a urine sample.
540 μL of a human urine standard material (Golden West Diagnostics,
LLC) was mixed with 60 μL of phosphate buffer (1.5 mol L<sup>–1</sup> phosphate; 1.1 × 10<sup>–3</sup> mol
L<sup>–1</sup> DSS; pH 7.4) following a previous procedure,<sup><xref ref-type="bibr" rid="ref50">50</xref></sup> and 20 μL of a spike-in solution was sequentially
added to the sample (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>).
NMR spectra were acquired at 298 K using an Avance III 600 MHz spectrometer
equipped with a 5 mm TCI cryoprobe (Bruker). Data were collected using
a one-dimensional 1H detection experiment with water suppression (Bruker
nomenclature, noesypr1d) with the following acquisition parameters:
spectral width of 16.00 ppm, number of points of 32 K, number of scans
of 64, and relaxation delay of 4 s. The digitizer mode (DIGMOD) was
set to base-opt to collect spectra with no first-order phase distortion.
Raw data and parameter sets are available in the Metabolomics Workbench
(Study ST002718 doi: 10.21228/M8WT6H).</p>
    </sec>
    <sec id="sec2.11">
      <title>Correlation Network and Clustering</title>
      <p>To build the correlation
network, we matched peaks by the chemical shift distance between samples
and calculated the Spearman correlation. The edges were selected with
0.9 and 0.5 as the correlation threshold in the simulated data set
and in the prednisone–ibuprofen mixtures. For these two data
sets, the groups of peaks were clear and separated without clustering.</p>
    </sec>
    <sec id="sec2.12">
      <title>Benchmark Data Set Simulation</title>
      <p>The simulation was implemented
in the time domain with preset parameters (<xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref>). We made the simulation resemble the experimental
spectra. One urine spectrum was decomposed into a peak table. The
peak table was refined by selecting an approximately 1.50 ppm region,
removing distorted peak regions, cleaning peak clusters, randomly
sampling λ values, and adding the reference peak at 0.00 ppm.
The peak clusters with a dense overlap were cleaned by removing close
peaks by a threshold of 0.03 ppm. Approximately 100 peaks remained
after the filtering. λ values were uniformly sampled from 1
to 15, and the λ value of the reference peak was defined as
4. Concentrations were uniformly sampled, and the spectra were simulated
with noise. As in experimental data sets, the first point of the FID
was divided by two, and 76 zero points were added in the beginning.
In the simulation with broad peaks, three broad peaks with λ
values greater than or equal to 100 were added. In the simulation
with groups, 18 groups (compounds) were predefined, and within each
group, the peaks maintained a fixed relative ratio of the amplitude
like the peaks of one compound. In the simulation with zero-order
phase distortion, a 0.2 (in radian) phase distortion is added to all
peaks. The simulated NMR spectra then went through pre-processing
and binning steps.</p>
    </sec>
    <sec id="sec2.13">
      <title>Benchmark Evaluation</title>
      <p>SAND was evaluated on simulated
and experimental data sets. SAND results were compared with the peak
intensity, numerical integral, and CRAFT.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> In each bin before the combination, the minimum was shifted to zero,
the maximum intensity was determined, and then, the integral was calculated
by trapezoidal numerical integration. Extracted peaks in the simulated
data were then normalized to the reference peak at 0.00 ppm. Relative
intensities were compared for the ibuprofen–prednisone mixtures.</p>
      <p>The evaluation was based on the divergence between estimation and
ground truth, linearity, and correlation. The MSE (<xref rid="eq6" ref-type="disp-formula">eq <xref rid="eq6" ref-type="disp-formula">6</xref></xref>) was calculated for each matched
peak <italic>e</italic> (total number <italic>N</italic><sub><italic>e</italic></sub>) for one sample <italic>k</italic> and between estimation <italic>x</italic> and ground truth <italic>y</italic>. The relative MSE
(RMSE) had each deviation normalized by the mean (<xref rid="eq7" ref-type="disp-formula">eq <xref rid="eq7" ref-type="disp-formula">7</xref></xref>). The Pearson correlation was used
for correlation. The slope <italic>k</italic> was calculated by fitting
a linear regression model between the estimation and ground truth
with no intercept. Evaluations were calculated within each sample
from which the means and standard errors were calculated.</p>
      <p>
        <disp-formula id="eq6">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m006" position="anchor"/>
          <label>6</label>
        </disp-formula>
        <disp-formula id="eq7">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_m007" position="anchor"/>
          <label>7</label>
        </disp-formula>
      </p>
    </sec>
    <sec id="sec2.14">
      <title>NMRbox Integration</title>
      <p>A command line interface was built
for SAND for general users particularly on NMRbox. We provided an
interface for direct control of parameters mentioned in previous sections.
Different FIDs can be assigned and computed by separate machines,
and the computation of the different bins runs in parallel. Parallel
processing through the HTCondor structure is also provided through
a bash shell script. The script assigns each FID to separate core
groups, and for each FID, one submission file is created and then
submitted to the pool.</p>
    </sec>
    <sec sec-type="data-availability" id="sec2.15">
      <title>Code and Data Availability</title>
      <p>The SAND program has been
implemented in MATLAB, R, C-shell, and bash shell. Codes are freely
available through GitHub (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/edisonomics/SAND">https://github.com/edisonomics/SAND</uri>). It was tested on a local iMac Pro computer, sapelo2 at the Georgia
Advance Computing Resource Center (GACRC), and NMRbox servers.<sup><xref ref-type="bibr" rid="ref44">44</xref></sup></p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <sec id="sec3.1">
      <title>Overview of the SAND Computational Workflow</title>
      <p>Given NMR
data as input, SAND uses time-domain models to automatically create
a table of signal parameters describing the corresponding spectrum,
allowing the quantification of individual chemical components (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>). SAND is demonstrated
here with respect to metabolomics data, but it is general and can
be applied to other applications (e.g., macromolecular NMR). Even
when time-domain analysis is used, many intermediate manipulations
are more convenient to perform in the frequency domain before a detailed
analysis including intensity normalization or calibration of chemical
shifts according to a reference compound signal. For this reason,
the usual SAND workflow starts with processed spectra, which are internally
inverse Fourier-processed by SAND as needed. In the examples presented,
NMR data were first collected from biological samples and automatically
processed by NMRPipe or MATLAB (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>B).</p>
      <p>Direct modeling of the whole spectra is computationally
difficult because of the number of parameters required. To simplify
the problem, SAND performs frequency-region-based spectral subsampling
followed by inverse Fourier processing of the subsampled regions (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>C).<sup><xref ref-type="bibr" rid="ref18">18</xref>,<xref ref-type="bibr" rid="ref30">30</xref></sup> SAND then decomposes the time-domain data by fitting a decaying
sinusoid model for each signal and estimating the frequency (often
expressed as a chemical shift for simplicity), decay (λ), amplitude,
and phase (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>D).</p>
      <p>While SAND as presented here uses exponentially decaying
sinusoids
as the underlying signal model, other models could be used, and for
the examples presented here, which use phased spectra as input, the
phase parameter was kept fixed at zero. Since the SAND analysis involves
a parameter space with multiple local optima, Markov chain Monte Carlo
methods are used, and similar approaches were employed by the Bayesian
engine used by CRAFT.<sup><xref ref-type="bibr" rid="ref27">27</xref>,<xref ref-type="bibr" rid="ref30">30</xref></sup> In addition, SAND employs multiple
controls for model complexity, including time-domain subsampling.
Because SAND uses time-domain subsampling (i.e., it analyzes a random
subset of the time-domain points), it is intrinsically suited to nonuniformly
sampled (NUS) applications.<sup><xref ref-type="bibr" rid="ref51">51</xref></sup> In the end,
a mixture spectrum is reduced to a feature table and a list of individual
peaks, quantifying the signals of the metabolome (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>E,F).</p>
    </sec>
    <sec id="sec3.2">
      <title>Evaluation of SAND on Benchmark Data Sets</title>
      <p>Multiple
data sets were simulated to test SAND performance under different
conditions (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figures S1 and S2</ext-link>, and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>). The simulation presented here (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>A) covered a range of 1.50
ppm with highly overlapped peaks and randomly generated concentrations,
and a broad peak overlap was added (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S2</ext-link>). The overall SAND model (black line in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B) agrees well with the measured spectrum
(red line in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B), and SAND uncovered and quantified most of the underlying peaks
accurately (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref> B,C). The estimation (blue peaks in <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B) agrees well with the ground truth (green
peaks) even for highly overlapped regions. However, SAND will sometimes
not accurately determine the number of peaks for highly overlapped
regions, modeling a single peak as two smaller peaks (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>B, around 7.3 and 7.95 ppm).</p>
      <fig id="fig2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>SAND performance
on simulated benchmarks. SAND was evaluated with
simulated benchmark spectra. (A) Stack plot of 20 simulated spectra
with both narrow and broad peaks. Peaks are highly overlapped with
randomly generated intensities, and the spectra are distinguished
by different colors. An example of a broad peak overlap can be found
in <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S2</ext-link>. (B) Two example regions of
the decomposition with simulated raw spectra are black; sum of decomposed
peaks (red), simulated ground truth peaks (green), and individual
decomposed peaks (blue). Stack spectra are used for plotting with
each individual spectrum shifted differently vertically for clear
visualization. (C) Scatter plot of ground truths (horizontal axis)
and SAND estimations (vertical axis) for the chemical shift, amplitude,
and peak width (λ) in the simulated mixture (A). For the amplitude
plot, data for peaks with closely overlapping peaks are shown in gray,
and data for peaks that are relatively far from neighbor peaks are
shown in red (threshold of 0.01 ppm).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0002" id="gr2" position="float"/>
      </fig>
      <p>This is a common problem for both manual inspection
and previous
decomposition approaches. Globally, the estimation for peak parameters
(chemical shift, amplitude, and peak widths) was accurate with most
points distributed on the diagonal line and a high correlation (∼0.9)
with ground truth (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>C). The effects of high noise and a large peak overlap were
tested on a series of cases with a small narrow peak in the presence
of two broad peaks (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S1</ext-link>). All three
simulated peaks were successfully decomposed in all conditions, and
the small narrow peak was quantified accurately with around 20% relative
error in the worst case even though these most overlapped cases would
be difficult to identify by eye (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S1A</ext-link>).</p>
      <p>SAND was compared with quantification by the peak intensity,
numerical
integral, and CRAFT analysis on simulated (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) and experimental data sets (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S5</ext-link>) with known ground truth (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>). Intensity and integrals can be extracted
automatically in an untargeted analysis. We evaluate the methods based
on the estimation divergencies (mean squared error (MSE) and relative
MSE), slope, and correlation (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>).
Among automatic methods, SAND was consistently better in the more
complex simulated data sets (correlation of 0.88 and <italic>k</italic> of around 0.9), and all methods have near-perfect performances in
the simpler ibuprofen–prednisone mixture. CRAFT has slightly
better performance in two data sets, and this is expected because
the CRAFT result uses the entire time-domain data rather than a subset.
This reveals a small deficit in SAND, where the model parameters are
determined from a subset of the data.</p>
      <p>The ibuprofen–prednisone
experimental mixture data set contains
11 different relative concentrations, and each was repeated three
times.<sup><xref ref-type="bibr" rid="ref30">30</xref></sup> There is less overlap in the ibuprofen–prednisone
mixture than in our simulated data set, and relative concentrations
were accurately estimated by SAND and other methods (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S3 and Table S3</ext-link>).</p>
      <p>SAND analysis focuses on phased
spectra but also decomposes spectra
with zero-order phasing problems (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S6</ext-link>), and the performance of parameter estimation is similar (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Table S3</ext-link>).</p>
    </sec>
    <sec id="sec3.3">
      <title>Evaluation of SAND with Metabolomics Mixtures</title>
      <p>We then
tested SAND on experimental data sets with extensive overlap and complexity
(<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>). A mixture of standard compounds
containing <sc>l</sc>-valine, <sc>d</sc>(+)-glucose, 3-nitro-<sc>l</sc>-tyrosine, <italic>N</italic>-(1-carboxyethyl)-<sc>l</sc>-lysine,
and sodium dimethyl silapentane sulfonate (DSS)-<italic>d</italic><sub>6</sub> was spiked into a urine sample in different amounts
(0, 20, 40, 60, and 80 μL) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Tables S1 and S2</ext-link>), and the peaks were quantified (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). The spike-in changed the pH of the mixture,
and several peaks from both spike-in and urine samples also had chemical
shift changes.</p>
      <fig id="fig3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Decomposition of the spike-in data set. In a urine sample,
different
amounts of a four-compound mixture were spiked in to evaluate SAND
quantification. The orange spectrum is from the spiked-in mixture
alone. The mixture was spiked into the urine sample with different
volumes, and from low to high volumes, the spectra at the bottom are
visualized with darker colors, namely, gray to black. Above the orange
spike-in spectrum, selected regions from the 80 L spike-in urine sample
are shown with both SAND estimation (blue) and measured spectra (black).
On the top, selected examples of the spike-in volume versus signal
amplitude are shown. The axes are presented in the right-side figure
with an <italic>x</italic> axis for the spike-in volumes and <italic>y</italic> axis for the intensity quantification. All other figures
are with the same axes. Values from the spike-in compounds are expected
to vary linearly with the spike-in volume, and they have correlation
values of 0.98 and above (solid lines).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0003" id="gr3" position="float"/>
      </fig>
      <p>As shown in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>, all spectra were effectively decomposed by SAND.
The spike-in peak
amplitudes increased linearly with spike-in volumes (correlation close
to 1) with the slope defined by the relative peak intensity (solid
lines in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>).
The linearity holds for peaks of different relative intensities. For
peaks only in the original urine spectra (dashed lines in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>), the estimation
stayed relatively constant, though the overlap with spike-in compounds
influenced the quantification slightly. Glucose already existed in
the original urine sample, so the linear regression line has a nonzero <italic>Y</italic> intercept.</p>
    </sec>
    <sec id="sec3.4">
      <title>Automatic Annotation Inference</title>
      <p>In addition to compound
quantification, the decomposed features also inform the underlying
chemical associations and annotations. Different peaks of the same
compound should be perfectly correlated at multiple concentrations.
Statistical total correlation spectroscopy (STOCSY) used correlation
to find peaks associated with a targeted peak.<sup><xref ref-type="bibr" rid="ref52">52</xref></sup> A correlation network can also be built to find clusters
of peaks highly correlated with each other, which indicates a possible
compound annotation.<sup><xref ref-type="bibr" rid="ref53">53</xref></sup> Such an approach
can be automatic and untargeted and can characterize novel compounds
that are not in the database or known compounds without relying on
libraries. While peak overlap can introduce false positives, SAND
can improve the results by removing the spectral overlap.</p>
      <p>Annotation
was first tested on simulated mixtures (50 spectra) with 18 groups
of peaks, and in each group (“compound”), peaks were
simulated with fixed relative intensities, like different peaks in
a compound. The concentration of each compound is randomly sampled
from a maximum to 20%. SAND features were matched between samples
by the chemical shift, correlated, and then clustered (details in <xref rid="sec2" ref-type="other">Materials and Methods</xref>). Most peaks of the compounds
(red lines in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>) can be automatically decomposed, clustered, and recovered in one
cluster (blue lines in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>). For most compounds, more than 60% of the ground truth peaks
were recovered in one cluster (mean recovery ratio of 74%) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S4</ext-link>).</p>
      <fig id="fig4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Automatic annotation from SAND decomposition.
Each spectrum is
decomposed into a peak list, and matched peaks among 50 different
samples were correlated and clustered for annotation. One example
mixture spectrum is shown in black, the ground truth spectra in red,
and the estimated spectra of the matched clusters in blue.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_0004" id="gr4" position="float"/>
      </fig>
      <p>Automatic annotation was then tested in the ibuprofen–prednisone
mixtures. Two main clusters were uncovered, and each contains many
peaks of the corresponding compound (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S5</ext-link>). One caveat of this data set is that, although the samples are
made from ibuprofen and prednisone, they still contain some other
impurity peaks, such as DMSO and water peaks.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4</label>
    <title>Conclusions</title>
    <p>We built SAND to decompose
the NMR spectra into feature tables.
SAND reduces the dimensionality of metabolomics spectra from tens
of thousands of points to hundreds of peaks, extracts the most interesting
peak features, and relieves the curse of dimensionality in the downstream
statistical analysis. Such an automatic process also frees researchers
from the tedious work of manual peak picking or binning.</p>
    <p>One
goal of SAND is to enable reproducible automatic quantification
of large-scale NMR metabolomic studies as in other omics approaches.<sup><xref ref-type="bibr" rid="ref54">54</xref>−<xref ref-type="bibr" rid="ref56">56</xref></sup> Currently, SAND can be used via NMRPipe<sup><xref ref-type="bibr" rid="ref45">45</xref></sup> and the resources of NMRbox<sup><xref ref-type="bibr" rid="ref44">44</xref></sup> with analysis
initiated via a single command from a terminal window or shell script,
making it easy to integrate SAND with other workflows and analysis
tools on the NMRbox platform. An entire workflow can be run within
NMRbox, which provides high-capacity data storage and improves reproducibility.
SAND will be further built into the workflows for the Network for
Advanced NMR (NAN), which is an NSF-funded national network that facilitates
resource discovery, data collection, data storage and transfer, and
NMR data analysis. Metabolomics NMR spectra can be tagged and decomposed
automatically in this workflow, and clean peak tables are returned
to users. Initial pre-processing by the user using either autophasing
or manually adjusted phase values is preferred but not always needed
(<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S6</ext-link>).</p>
    <p>In our future plans
for SAND, we intend to replace the slow MATLAB
implementation with a faster, more readily parallelizable version
implemented in C/C++. The current version of SAND is tuned for high-resolution
metabolomics spectra; we also intend to accommodate other cases. Along
these lines, SAND can potentially be expanded to include nonexponential
signals. An example is given in <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">Figure S7</ext-link>, which shows a region of the prednisone spectrum with peaks identified
by SAND subject to a second round of optimization using an exponential
+ Gaussian model. Our ultimate goal is to explore the intriguing possibility
of adapting SAND to multidimensional applications. We note that this
has particular promise because SAND is a variety of nonuniform sampling
analyses, where quantification of time-domain data could potentially
avoid the need for complete spectral reconstruction.</p>
  </sec>
</body>
<back>
  <notes id="notes1" notes-type="si">
    <title>Supporting Information Available</title>
    <p>The Supporting Information
is
available free of charge at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/10.1021/acs.analchem.3c03078?goto=supporting-info">https://pubs.acs.org/doi/10.1021/acs.analchem.3c03078</ext-link>.<list id="silist" list-type="simple"><list-item><p>Simulation example for overlapping and moving peaks,
visualization of overlap between broad and narrow peaks, scatter plot
for the amplitude estimation in the ibuprofen–prednisone mixture
data set, performance of recovering clusters in the simulated data
set, automatic annotation in an experimental mixture, SAND performance
on simulated spectra with phase distortion, SAND peaks remodeled with
exponential + Gaussian model, list of compounds and concentrations
in the spike-in solution, design of the spike-in experiment, and performance
of different quantification methods (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_001.pdf">PDF</ext-link>)</p></list-item><list-item><p>Tutorial slides for using SAND via
NMRPipe (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.3c03078/suppl_file/ac3c03078_si_002.pdf">PDF</ext-link>)</p></list-item></list></p>
  </notes>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sifile1">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_si_001.pdf">
        <caption>
          <p>ac3c03078_si_001.pdf</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sifile2">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac3c03078_si_002.pdf">
        <caption>
          <p>ac3c03078_si_002.pdf</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <notes notes-type="" id="notes2">
    <title>Author Contributions</title>
    <p>A.S.E., F.D.,
and Y.W. conceived the project idea. Y.W. and F.D. designed the SAND
program. Y.W. and O.S. wrote the SAND program. Y.W. and O.S. tested
the SAND program with different data, benchmarks, and environments.
F.D., O.S., and Y.W. tested SAND on NMRbox and built the tutorial.
M.U. collected the spike-in experiment data. K.K. ran the benchmark
on CRAFT. All authors contributed to the manuscript writing and have
given approval to the final version of the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement" id="notes3">
    <p>The authors
declare no competing financial interest.</p>
  </notes>
  <notes notes-type="" id="notes4">
    <title>Notes</title>
    <p>Certain commercial equipment, instruments, and
materials are identified in this paper in order to specify the experimental
procedure. Such identification does not imply recommendation or endorsement
by the National Institute of Standards and Technology, nor does it
imply that the material or equipment identified is necessarily the
best available for the purpose.</p>
  </notes>
  <notes notes-type="" id="notes5">
    <title>Notes</title>
    <p>Not
Human Subjects Research: The National Institute
of Standards and Technology Research Protections Office reviewed the
protocol for this project and determined it is “not human subjects
research” as defined in 15 CFR 27, the Common Rule for the
Protection of Human Subjects.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Sicong Zhang for providing the buffer for
the spike-in experiment. We thank Mark W. Maciejewski and Chad Rienstra
for useful discussions. We appreciate computational support from GACRC,
especially Shan-Ho Tsai and Zhuofei Hou. This work was supported by
the NSF no. 1946970: Midscale RI-2 Consortium: Network for Advanced
NMR. This study made use of NMRbox: National Center for Biomolecular
NMR Data Processing and Analysis, a Biomedical Technology Research
Resource (BTRR), which is supported by NIH grant no. P41GM111135 (NIGMS).
We appreciated Gerard Weatherby for supporting the computing in NMRbox.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Wu</surname><given-names>Y.</given-names></name>; <name><surname>Tayyari</surname><given-names>F.</given-names></name>; <name><surname>Hattori</surname><given-names>A.</given-names></name>; <name><surname>Glushka</surname><given-names>J.</given-names></name>; <name><surname>Ito</surname><given-names>T.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name><article-title>Continuous in vivo Metabolism by
NMR</article-title>. <source>Front. Mol. Biosci.</source><year>2019</year>, <volume>6</volume>, <fpage>26</fpage><pub-id pub-id-type="doi">10.3389/fmolb.2019.00026</pub-id>.<pub-id pub-id-type="pmid">31114791</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="journal" id="cit2"><name><surname>Link</surname><given-names>H.</given-names></name>; <name><surname>Fuhrer</surname><given-names>T.</given-names></name>; <name><surname>Gerosa</surname><given-names>L.</given-names></name>; <name><surname>Zamboni</surname><given-names>N.</given-names></name>; <name><surname>Sauer</surname><given-names>U.</given-names></name><article-title>Real-time
metabolome profiling of the metabolic switch between starvation and
growth</article-title>. <source>Nat. Methods</source><year>2015</year>, <volume>12</volume> (<issue>11</issue>), <fpage>1091</fpage>–<lpage>1097</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3584</pub-id>.<pub-id pub-id-type="pmid">26366986</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>Colonna</surname><given-names>M.</given-names></name>; <name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Holderman</surname><given-names>N. R.</given-names></name>; <name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Shen</surname><given-names>X. N.</given-names></name>; <name><surname>Zhang</surname><given-names>S. C.</given-names></name><article-title>NMR: Unique
Strengths
That Enhance Modern Metabolomics Research</article-title>. <source>Analytical
chemistry</source><year>2021</year>, <volume>93</volume> (<issue>1</issue>), <fpage>478</fpage>–<lpage>499</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.0c04414</pub-id>.<pub-id pub-id-type="pmid">33180470</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Bifarin</surname><given-names>O. O.</given-names></name>; <name><surname>Gaul</surname><given-names>D. A.</given-names></name>; <name><surname>Sah</surname><given-names>S.</given-names></name>; <name><surname>Arnold</surname><given-names>R. S.</given-names></name>; <name><surname>Ogan</surname><given-names>K.</given-names></name>; <name><surname>Master</surname><given-names>V. A.</given-names></name>; <name><surname>Roberts</surname><given-names>D. L.</given-names></name>; <name><surname>Bergquist</surname><given-names>S. H.</given-names></name>; <name><surname>Petros</surname><given-names>J. A.</given-names></name>; <name><surname>Fernandez</surname><given-names>F. M.</given-names></name>; et al. <article-title>Machine Learning-Enabled
Renal Cell Carcinoma Status Prediction Using Multiplatform Urine-Based
Metabolomics</article-title>. <source>J. Proteome Res.</source><year>2021</year>, <volume>20</volume> (<issue>7</issue>), <fpage>3629</fpage>–<lpage>3641</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.1c00213</pub-id>.<pub-id pub-id-type="pmid">34161092</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="journal" id="cit5"><name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Shaver</surname><given-names>A. O.</given-names></name>; <name><surname>Garcia</surname><given-names>B. M.</given-names></name>; <name><surname>Morse</surname><given-names>A. M.</given-names></name>; <name><surname>Andersen</surname><given-names>E. C.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>McIntyre</surname><given-names>L. M.</given-names></name><article-title>Long-Term Metabolomics Reference
Material</article-title>. <source>Analytical chemistry</source><year>2021</year>, <volume>93</volume> (<issue>26</issue>), <fpage>9193</fpage>–<lpage>9199</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.1c01294</pub-id>.<pub-id pub-id-type="pmid">34156835</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Maughon</surname><given-names>T. S.</given-names></name>; <name><surname>Shen</surname><given-names>X. N.</given-names></name>; <name><surname>Huang</surname><given-names>D. N.</given-names></name>; <name><surname>Michael</surname><given-names>A. O. A.</given-names></name>; <name><surname>Shockey</surname><given-names>W. A.</given-names></name>; <name><surname>Andrews</surname><given-names>S. H.</given-names></name>; <name><surname>McRae</surname><given-names>J. M.</given-names></name>; <name><surname>Platt</surname><given-names>M. O.</given-names></name>; <name><surname>Fernandez</surname><given-names>F. M.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; et al. <article-title>Metabolomics and cytokine profiling of mesenchymal
stromal cells identify markers predictive of T-cell suppression</article-title>. <source>Cytotherapy</source><year>2022</year>, <volume>24</volume> (<issue>2</issue>), <fpage>137</fpage>–<lpage>148</lpage>. <pub-id pub-id-type="doi">10.1016/j.jcyt.2021.08.002</pub-id>.<pub-id pub-id-type="pmid">34696960</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Shaver</surname><given-names>A. O.</given-names></name>; <name><surname>Gouveia</surname><given-names>G. J.</given-names></name>; <name><surname>Kirby</surname><given-names>P. S.</given-names></name>; <name><surname>Andersen</surname><given-names>E. C.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name><article-title>Culture
and Assay of Large-Scale Mixed-Stage Caenorhabditis elegans Populations</article-title>. <source>Jove-J. Vis Exp</source><year>2021</year>, <volume>171</volume>, <elocation-id>e61453</elocation-id><pub-id pub-id-type="doi">10.3791/61453</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>Choe</surname><given-names>A.</given-names></name>; <name><surname>Chuman</surname><given-names>T.</given-names></name>; <name><surname>von Reuss</surname><given-names>S. H.</given-names></name>; <name><surname>Dossey</surname><given-names>A. T.</given-names></name>; <name><surname>Yim</surname><given-names>J. J.</given-names></name>; <name><surname>Ajredini</surname><given-names>R.</given-names></name>; <name><surname>Kolawa</surname><given-names>A. A.</given-names></name>; <name><surname>Kaplan</surname><given-names>F.</given-names></name>; <name><surname>Alborn</surname><given-names>H. T.</given-names></name>; <name><surname>Teal</surname><given-names>P. E. A.</given-names></name>; et al. <article-title>Sex-specific mating pheromones in the nematode
Panagrellus redivivus</article-title>. <source>Proc. Natl. Acad. Sci.
U.S.A.</source><year>2012</year>, <volume>109</volume> (<issue>51</issue>), <fpage>20949</fpage>–<lpage>20954</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1218302109</pub-id>.<pub-id pub-id-type="pmid">23213209</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><person-group person-group-type="allauthors"><name><surname>Bastawrous</surname><given-names>M.</given-names></name>, <name><surname>Jenne</surname><given-names>A.</given-names></name>, <name><surname>Tabatabaei Anaraki</surname><given-names>M.</given-names></name>; <name><surname>Simpson</surname><given-names>A. J.</given-names></name></person-group><article-title>In-Vivo NMR Spectroscopy: A Powerful and Complimentary Tool for Understanding
Environmental Toxicity</article-title>. <source>Metabolites</source><year>2018</year>, <volume>8</volume> ( (<issue>2</issue>), ). DOI: <fpage>35</fpage><pub-id pub-id-type="doi">10.3390/metabo8020035</pub-id>.<pub-id pub-id-type="pmid">29795000</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Battogtokh</surname><given-names>D.</given-names></name>; <name><surname>Asch</surname><given-names>D. K.</given-names></name>; <name><surname>Case</surname><given-names>M. E.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name>; <name><surname>Schuttler</surname><given-names>H. B.</given-names></name><article-title>An ensemble
method for identifying regulatory circuits with special reference
to the qa gene cluster of Neurospora crassa</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2002</year>, <volume>99</volume> (<issue>26</issue>), <fpage>16904</fpage>–<lpage>16909</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.262658899</pub-id>.<pub-id pub-id-type="pmid">12477937</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><name><surname>Fuhrer</surname><given-names>T.</given-names></name>; <name><surname>Zampieri</surname><given-names>M.</given-names></name>; <name><surname>Sevin</surname><given-names>D. C.</given-names></name>; <name><surname>Sauer</surname><given-names>U.</given-names></name>; <name><surname>Zamboni</surname><given-names>N.</given-names></name><article-title>Genomewide
landscape of gene-metabolome associations in Escherichia coli</article-title>. <source>Mol. Syst. Biol.</source><year>2017</year>, <volume>13</volume> (<issue>1</issue>), <fpage>907</fpage><pub-id pub-id-type="doi">10.15252/msb.20167150</pub-id>.<pub-id pub-id-type="pmid">28093455</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="journal" id="cit12"><name><surname>Ernst</surname><given-names>R. R.</given-names></name>; <name><surname>Anderson</surname><given-names>W. A.</given-names></name><article-title>Application of Fourier Transform Spectroscopy to Magnetic
Resonance</article-title>. <source>Rev. Sci. Instrum.</source><year>1966</year>, <volume>37</volume> (<issue>1</issue>), <fpage>93</fpage><pub-id pub-id-type="doi">10.1063/1.1719961</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Whiley</surname><given-names>L.</given-names></name>; <name><surname>Chekmeneva</surname><given-names>E.</given-names></name>; <name><surname>Berry</surname><given-names>D. J.</given-names></name>; <name><surname>Jimenez</surname><given-names>B.</given-names></name>; <name><surname>Yuen</surname><given-names>A. H. Y.</given-names></name>; <name><surname>Salam</surname><given-names>A.</given-names></name>; <name><surname>Hussain</surname><given-names>H.</given-names></name>; <name><surname>Witt</surname><given-names>M.</given-names></name>; <name><surname>Takats</surname><given-names>Z.</given-names></name>; <name><surname>Nicholson</surname><given-names>J.</given-names></name>; et al. <article-title>Systematic Isolation and Structure Elucidation
of Urinary Metabolites Optimized for the Analytical-Scale Molecular
Profiling Laboratory</article-title>. <source>Analytical chemistry</source><year>2019</year>, <volume>91</volume> (<issue>14</issue>), <fpage>8873</fpage>–<lpage>8882</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.9b00241</pub-id>.<pub-id pub-id-type="pmid">31188566</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="journal" id="cit14"><name><surname>Johnson</surname><given-names>C. S.</given-names></name><article-title>Diffusion
ordered nuclear magnetic resonance spectroscopy: principles and applications</article-title>. <source>Prog. Nucl. Magn. Reson. Spectrosc.</source><year>1999</year>, <volume>34</volume> (<issue>3–4</issue>), <fpage>203</fpage>–<lpage>256</lpage>. <pub-id pub-id-type="doi">10.1016/S0079-6565(99)00003-5</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <mixed-citation publication-type="journal" id="cit15"><name><surname>Aue</surname><given-names>W. P.</given-names></name>; <name><surname>Karhan</surname><given-names>J.</given-names></name>; <name><surname>Ernst</surname><given-names>R. R.</given-names></name><article-title>Homonuclear
Broad-Band Decoupling
and 2-Dimensional J-Resolved Nmr-Spectroscopy</article-title>. <source>J. Chem. Phys.</source><year>1976</year>, <volume>64</volume> (<issue>10</issue>), <fpage>4226</fpage>–<lpage>4227</lpage>. <pub-id pub-id-type="doi">10.1063/1.431994</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <mixed-citation publication-type="journal" id="cit16"><name><surname>Meiboom</surname><given-names>S.</given-names></name>; <name><surname>Gill</surname><given-names>D.</given-names></name><article-title>Modified Spin-Echo
Method for Measuring Nuclear Relaxation Times</article-title>. <source>Rev. Sci. Instrum.</source><year>1958</year>, <volume>29</volume> (<issue>8</issue>), <fpage>688</fpage>–<lpage>691</lpage>. <pub-id pub-id-type="doi">10.1063/1.1716296</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <mixed-citation publication-type="journal" id="cit17"><name><surname>Carr</surname><given-names>H. Y.</given-names></name>; <name><surname>Purcell</surname><given-names>E. M.</given-names></name><article-title>Effects of Diffusion on Free Precession in Nuclear
Magnetic Resonance Experiments</article-title>. <source>Phys. Rev.</source><year>1954</year>, <volume>94</volume> (<issue>3</issue>), <fpage>630</fpage>–<lpage>638</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRev.94.630</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <mixed-citation publication-type="journal" id="cit18"><name><surname>Sousa</surname><given-names>S. A. A.</given-names></name>; <name><surname>Magalhaes</surname><given-names>A.</given-names></name>; <name><surname>Ferreira</surname><given-names>M. M. C.</given-names></name><article-title>Optimized bucketing for NMR spectra:
Three case studies</article-title>. <source>Chemometr. Intell. Lab.</source><year>2013</year>, <volume>122</volume>, <fpage>93</fpage>–<lpage>102</lpage>. <pub-id pub-id-type="doi">10.1016/j.chemolab.2013.01.006</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <mixed-citation publication-type="journal" id="cit19"><name><surname>Hao</surname><given-names>J.</given-names></name>; <name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Ebbels</surname><given-names>T. M. D.</given-names></name><article-title>BATMAN-an R package
for the automated quantification of metabolites from nuclear magnetic
resonance spectra using a Bayesian model</article-title>. <source>Bioinformatics</source><year>2012</year>, <volume>28</volume> (<issue>15</issue>), <fpage>2088</fpage>–<lpage>2090</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts308</pub-id>.<pub-id pub-id-type="pmid">22635605</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref20">
      <mixed-citation publication-type="journal" id="cit20"><name><surname>Hao</surname><given-names>J.</given-names></name>; <name><surname>Liebeke</surname><given-names>M.</given-names></name>; <name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Bundy</surname><given-names>J. G.</given-names></name>; <name><surname>Ebbels</surname><given-names>T. M. D.</given-names></name><article-title>Bayesian
deconvolution and quantification of metabolites
in complex 1D NMR spectra using BATMAN</article-title>. <source>Nature
protocols</source><year>2014</year>, <volume>9</volume> (<issue>6</issue>), <fpage>1416</fpage>–<lpage>1427</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2014.090</pub-id>.<pub-id pub-id-type="pmid">24853927</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref21">
      <mixed-citation publication-type="journal" id="cit21"><name><surname>Astle</surname><given-names>W.</given-names></name>; <name><surname>De Iorio</surname><given-names>M.</given-names></name>; <name><surname>Richardson</surname><given-names>S.</given-names></name>; <name><surname>Stephens</surname><given-names>D.</given-names></name>; <name><surname>Ebbels</surname><given-names>T.</given-names></name><article-title>A Bayesian
Model of NMR Spectra for the Deconvolution and Quantification of Metabolites
in Complex Biological Mixtures</article-title>. <source>J. Am. Stat
Assoc</source><year>2012</year>, <volume>107</volume> (<issue>500</issue>), <fpage>1259</fpage>–<lpage>1271</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.2012.695661</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <mixed-citation publication-type="journal" id="cit22"><name><surname>Zheng</surname><given-names>C.</given-names></name>; <name><surname>Zhang</surname><given-names>S. C.</given-names></name>; <name><surname>Ragg</surname><given-names>S.</given-names></name>; <name><surname>Raftery</surname><given-names>D.</given-names></name>; <name><surname>Vitek</surname><given-names>O.</given-names></name><article-title>Identification
and quantification of metabolites in H-1 NMR spectra by Bayesian model
selection</article-title>. <source>Bioinformatics</source><year>2011</year>, <volume>27</volume> (<issue>12</issue>), <fpage>1637</fpage>–<lpage>1644</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr118</pub-id>.<pub-id pub-id-type="pmid">21398670</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref23">
      <mixed-citation publication-type="journal" id="cit23"><name><surname>Ravanbakhsh</surname><given-names>S.</given-names></name>; <name><surname>Liu</surname><given-names>P.</given-names></name>; <name><surname>Bjorndahl</surname><given-names>T. C.</given-names></name>; <name><surname>Mandal</surname><given-names>R.</given-names></name>; <name><surname>Grant</surname><given-names>J. R.</given-names></name>; <name><surname>Wilson</surname><given-names>M.</given-names></name>; <name><surname>Eisner</surname><given-names>R.</given-names></name>; <name><surname>Sinelnikov</surname><given-names>I.</given-names></name>; <name><surname>Hu</surname><given-names>X. Y.</given-names></name>; <name><surname>Luchinat</surname><given-names>C.</given-names></name>; et al. <article-title>Accurate,
Fully-Automated NMR Spectral Profiling for Metabolomics
(vol 10, e0124219, 2015)</article-title>. <source>PloS one</source><year>2015</year>, <volume>10</volume> (<issue>7</issue>), <elocation-id>e0132873</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0132873</pub-id>.<pub-id pub-id-type="pmid">26222058</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref24">
      <mixed-citation publication-type="journal" id="cit24"><name><surname>Tredwell</surname><given-names>G. D.</given-names></name>; <name><surname>Behrends</surname><given-names>V.</given-names></name>; <name><surname>Geier</surname><given-names>F. M.</given-names></name>; <name><surname>Liebeke</surname><given-names>M.</given-names></name>; <name><surname>Bundy</surname><given-names>J. G.</given-names></name><article-title>Between-Person
Comparison of Metabolite Fitting for NMR-Based Quantitative Metabolomics</article-title>. <source>Analytical chemistry</source><year>2011</year>, <volume>83</volume> (<issue>22</issue>), <fpage>8683</fpage>–<lpage>8687</lpage>. <pub-id pub-id-type="doi">10.1021/ac202123k</pub-id>.<pub-id pub-id-type="pmid">21988367</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref25">
      <mixed-citation publication-type="book" id="cit25"><person-group person-group-type="allauthors"><name><surname>de Beer</surname><given-names>R.</given-names></name>; <name><surname>van Ormondt</surname><given-names>D.</given-names></name></person-group> in <source>In-Vivo Magnetic Resonance
Spectroscopy I: Probeheads and Radiofrequency Pulses Spectrum Analysis</source> (ed <person-group person-group-type="editor"><string-name><given-names>M.</given-names>, <surname>Rudin</surname></string-name></person-group>) <fpage>201</fpage>–<lpage>248</lpage> (<publisher-name>Springer Berlin Heidelberg</publisher-name>, <year>1992</year>).</mixed-citation>
    </ref>
    <ref id="ref26">
      <mixed-citation publication-type="journal" id="cit26"><name><surname>Sekihara</surname><given-names>K.</given-names></name>; <name><surname>Ohyama</surname><given-names>N.</given-names></name><article-title>Parameter estimation
for in vivo magnetic resonance
spectroscopy (MRS) using simulated annealing</article-title>. <source>Magn Reson Med.</source><year>1990</year>, <volume>13</volume> (<issue>2</issue>), <fpage>332</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.1910130217</pub-id>.<pub-id pub-id-type="pmid">2314222</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref27">
      <mixed-citation publication-type="journal" id="cit27"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.1. Parameter-Estimation Using Quadrature Nmr Models</article-title>. <source>J. Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>533</fpage>–<lpage>551</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90287-J</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref28">
      <mixed-citation publication-type="journal" id="cit28"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.2. Signal-Detection and Model Selection</article-title>. <source>J.
Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>552</fpage>–<lpage>570</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90288-K</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <mixed-citation publication-type="journal" id="cit29"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>Bayesian-Analysis
0.3. Applications to Nmr Signal-Detection, Model Selection, and Parameter-Estimation</article-title>. <source>J. Magn. Reson.</source><year>1990</year>, <volume>88</volume> (<issue>3</issue>), <fpage>571</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(90)90289-L</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref30">
      <mixed-citation publication-type="journal" id="cit30"><name><surname>Krishnamurthy</surname><given-names>K.</given-names></name><article-title>CRAFT (complete
reduction to amplitude frequency table) - robust and time-efficient
Bayesian approach for quantitative mixture analysis by NMR</article-title>. <source>Magn. Reson. Chem.</source><year>2013</year>, <volume>51</volume> (<issue>12</issue>), <fpage>821</fpage>–<lpage>829</lpage>. <pub-id pub-id-type="doi">10.1002/mrc.4022</pub-id>.<pub-id pub-id-type="pmid">24154986</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref31">
      <mixed-citation publication-type="journal" id="cit31"><name><surname>Krishnamurthy</surname><given-names>K.</given-names></name><article-title>Complete Reduction
to Amplitude Frequency Table (CRAFT)-A perspective</article-title>. <source>Magn. Reson. Chem.</source><year>2021</year>, <volume>59</volume> (<issue>8</issue>), <fpage>757</fpage>–<lpage>791</lpage>. <pub-id pub-id-type="doi">10.1002/mrc.5135</pub-id>.<pub-id pub-id-type="pmid">33486830</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref32">
      <mixed-citation publication-type="journal" id="cit32"><name><surname>Rubtsov</surname><given-names>D. V.</given-names></name>; <name><surname>Waterman</surname><given-names>C.</given-names></name>; <name><surname>Currie</surname><given-names>R. A.</given-names></name>; <name><surname>Waterfield</surname><given-names>C.</given-names></name>; <name><surname>Salazar</surname><given-names>J. D.</given-names></name>; <name><surname>Wright</surname><given-names>J.</given-names></name>; <name><surname>Griffin</surname><given-names>J. L.</given-names></name><article-title>Application
of a
Bayesian Deconvolution Approach for High-Resolution 1H NMR Spectra
to Assessing the Metabolic Effects of Acute Phenobarbital Exposure
in Liver Tissue</article-title>. <source>Analytical chemistry</source><year>2010</year>, <volume>82</volume> (<issue>11</issue>), <fpage>4479</fpage>–<lpage>4485</lpage>. <pub-id pub-id-type="doi">10.1021/ac100344m</pub-id>.<pub-id pub-id-type="pmid">20446676</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref33">
      <mixed-citation publication-type="journal" id="cit33"><name><surname>Rubtsov</surname><given-names>D.
V.</given-names></name>; <name><surname>Griffin</surname><given-names>J. L.</given-names></name><article-title>Time-domain
Bayesian detection and estimation of noisy
damped sinusoidal signals applied to NMR spectroscopy</article-title>. <source>J. Magn. Reson.</source><year>2007</year>, <volume>188</volume> (<issue>2</issue>), <fpage>367</fpage>–<lpage>379</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2007.08.008</pub-id>.<pub-id pub-id-type="pmid">17827043</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref34">
      <mixed-citation publication-type="journal" id="cit34"><name><surname>Matviychuk</surname><given-names>Y.</given-names></name>; <name><surname>von Harbou</surname><given-names>E.</given-names></name>; <name><surname>Holland</surname><given-names>D. J.</given-names></name><article-title>An experimental validation of a Bayesian
model for quantification in NMR spectroscopy</article-title>. <source>J. Magn. Reson.</source><year>2017</year>, <volume>285</volume>, <fpage>86</fpage>–<lpage>100</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2017.10.009</pub-id>.<pub-id pub-id-type="pmid">29127944</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <mixed-citation publication-type="journal" id="cit35"><name><surname>Bretthorst</surname><given-names>G. L.</given-names></name><article-title>An Introduction
to Parameter-Estimation Using Bayesian Probability-Theory</article-title>. <source>Fund Theor</source><year>1990</year>, <volume>39</volume>, <fpage>53</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1007/978-94-009-0683-9_5</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref36">
      <mixed-citation publication-type="journal" id="cit36"><name><surname>Hoch</surname><given-names>J. C.</given-names></name><article-title>Modern
Spectrum Analysis in Nuclear Magnetic-Resonance - Alternatives to
the Fourier-Transform</article-title>. <source>Methods Enzymol.</source><year>1989</year>, <volume>176</volume>, <fpage>216</fpage>–<lpage>241</lpage>. <pub-id pub-id-type="doi">10.1016/0076-6879(89)76014-6</pub-id>.<pub-id pub-id-type="pmid">2811688</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <mixed-citation publication-type="journal" id="cit37"><name><surname>Barkhuijsen</surname><given-names>H.</given-names></name>; <name><surname>Debeer</surname><given-names>R.</given-names></name>; <name><surname>Bovee</surname><given-names>W. M. M. J.</given-names></name>; <name><surname>Vanormondt</surname><given-names>D.</given-names></name><article-title>Retrieval
of Frequencies, Amplitudes, Damping Factors, and Phases from Time-Domain
Signals Using a Linear Least-Squares Procedure</article-title>. <source>J. Magn. Reson.</source><year>1985</year>, <volume>61</volume> (<issue>3</issue>), <fpage>465</fpage>–<lpage>481</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(85)90187-8</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref38">
      <mixed-citation publication-type="journal" id="cit38"><name><surname>Barkhuijsen</surname><given-names>H.</given-names></name>; <name><surname>Debeer</surname><given-names>R.</given-names></name>; <name><surname>Vanormondt</surname><given-names>D.</given-names></name><article-title>Improved Algorithm
for Noniterative
Time-Domain Model-Fitting to Exponentially Damped Magnetic-Resonance
Signals</article-title>. <source>J. Magn. Reson.</source><year>1987</year>, <volume>73</volume> (<issue>3</issue>), <fpage>553</fpage>–<lpage>557</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(87)90023-0</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <mixed-citation publication-type="journal" id="cit39"><name><surname>Djermoune</surname><given-names>E. H.</given-names></name>; <name><surname>Tomczak</surname><given-names>M.</given-names></name>; <name><surname>Brie</surname><given-names>D.</given-names></name><article-title>NMR Data Analysis:
A Time-Domain
Parametric Approach Using Adaptive Subband Decomposition</article-title>. <source>Oil Gas Sci. Technol.</source><year>2014</year>, <volume>69</volume> (<issue>2</issue>), <fpage>229</fpage>–<lpage>244</lpage>. <pub-id pub-id-type="doi">10.2516/ogst/2012092</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref40">
      <mixed-citation publication-type="journal" id="cit40"><name><surname>Koehl</surname><given-names>P.</given-names></name><article-title>Linear prediction
spectral analysis of NMR data</article-title>. <source>Prog. Nucl. Magn.
Reson. Spectrosc.</source><year>1999</year>, <volume>34</volume> (<issue>3–4</issue>), <fpage>257</fpage>–<lpage>299</lpage>. <pub-id pub-id-type="doi">10.1016/S0079-6565(99)00002-3</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref41">
      <mixed-citation publication-type="journal" id="cit41"><name><surname>Tang</surname><given-names>J.</given-names></name>; <name><surname>Norris</surname><given-names>J.</given-names></name><article-title>LP-ZOOM, a linear prediction
method for local spectral
analysis of NMR signals</article-title>. <source>Journal of Magnetic
Resonance (1969)</source><year>1988</year>, <volume>79</volume> (<issue>1</issue>), <fpage>190</fpage>–<lpage>196</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(88)90338-1</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref42">
      <mixed-citation publication-type="journal" id="cit42"><name><surname>Mandelshtam</surname><given-names>V. A.</given-names></name>; <name><surname>Taylor</surname><given-names>H. S.</given-names></name><article-title>Multidimensional harmonic inversion
by filter-diagonalization</article-title>. <source>J. Chem. Phys.</source><year>1998</year>, <volume>108</volume> (<issue>24</issue>), <fpage>9970</fpage>–<lpage>9977</lpage>. <pub-id pub-id-type="doi">10.1063/1.476495</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref43">
      <mixed-citation publication-type="undeclared" id="cit43"><person-group person-group-type="allauthors"><name><surname>Cobas</surname><given-names>C.</given-names></name>, <name><surname>Seoane</surname><given-names>F.</given-names></name>, <name><surname>Sykora</surname><given-names>S.</given-names></name></person-group><source>Global Spectral
Deconvolution
(GSD) of 1D-NMR spectra</source>, &lt; <pub-id pub-id-type="doi">10.3247/sl2nmr08.011&gt;</pub-id> (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="ref44">
      <mixed-citation publication-type="journal" id="cit44"><name><surname>Maciejewski</surname><given-names>M. W.</given-names></name>; <name><surname>Schuyler</surname><given-names>A. D.</given-names></name>; <name><surname>Gryk</surname><given-names>M. R.</given-names></name>; <name><surname>Moraru</surname><given-names>I. I.</given-names></name>; <name><surname>Romero</surname><given-names>P. R.</given-names></name>; <name><surname>Ulrich</surname><given-names>E. L.</given-names></name>; <name><surname>Eghbalnia</surname><given-names>H. R.</given-names></name>; <name><surname>Livny</surname><given-names>M.</given-names></name>; <name><surname>Delaglio</surname><given-names>F.</given-names></name>; <name><surname>Hoch</surname><given-names>J. C.</given-names></name><article-title>NMRbox:
A Resource for Biomolecular NMR Computation</article-title>. <source>Biophys. J.</source><year>2017</year>, <volume>112</volume> (<issue>8</issue>), <fpage>1529</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2017.03.011</pub-id>.<pub-id pub-id-type="pmid">28445744</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref45">
      <mixed-citation publication-type="journal" id="cit45"><name><surname>Delaglio</surname><given-names>F.</given-names></name>; <name><surname>Grzesiek</surname><given-names>S.</given-names></name>; <name><surname>Vuister</surname><given-names>G. W.</given-names></name>; <name><surname>Zhu</surname><given-names>G.</given-names></name>; <name><surname>Pfeifer</surname><given-names>J.</given-names></name>; <name><surname>Bax</surname><given-names>A.</given-names></name><article-title>Nmrpipe - a Multidimensional Spectral
Processing System Based on
Unix Pipes</article-title>. <source>J. Biomol Nmr</source><year>1995</year>, <volume>6</volume> (<issue>3</issue>), <fpage>277</fpage>–<lpage>293</lpage>. <pub-id pub-id-type="doi">10.1007/BF00197809</pub-id>.<pub-id pub-id-type="pmid">8520220</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref46">
      <mixed-citation publication-type="book" id="cit46"><person-group person-group-type="allauthors"><name><surname>Landau</surname><given-names>D. P.</given-names></name>; <name><surname>Binder</surname><given-names>K.</given-names></name></person-group><source>A Guide to Monte Carlo
Simulations in Statistical Physics</source>. <edition>4</edition> edn,
(<publisher-name>Cambridge University Press</publisher-name>, <year>2014</year>).</mixed-citation>
    </ref>
    <ref id="ref47">
      <mixed-citation publication-type="journal" id="cit47"><name><surname>Byrd</surname><given-names>R. H.</given-names></name>; <name><surname>Gilbert</surname><given-names>J. C.</given-names></name>; <name><surname>Nocedal</surname><given-names>J.</given-names></name><article-title>A trust region
method based on interior
point techniques for nonlinear programming</article-title>. <source>Math Program</source><year>2000</year>, <volume>89</volume> (<issue>1</issue>), <fpage>149</fpage>–<lpage>185</lpage>. <pub-id pub-id-type="doi">10.1007/PL00011391</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref48">
      <mixed-citation publication-type="journal" id="cit48"><name><surname>Salvatier</surname><given-names>J.</given-names></name>; <name><surname>Wiecki</surname><given-names>T. V.</given-names></name>; <name><surname>Fonnesbeck</surname><given-names>C.</given-names></name><article-title>Probabilistic programming in Python
using PyMC3</article-title>. <source>Peerj Comput. Sci.</source><year>2016</year>, <volume>2</volume>, <elocation-id>e55</elocation-id><pub-id pub-id-type="doi">10.7717/peerj-cs.55</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref49">
      <mixed-citation publication-type="book" id="cit49"><person-group person-group-type="allauthors"><name><surname>Liu</surname><given-names>J. S.</given-names></name></person-group><source>Monte Carlo strategies
in scientific computing</source>. (<publisher-name>Springer</publisher-name>, <year>2001</year>).</mixed-citation>
    </ref>
    <ref id="ref50">
      <mixed-citation publication-type="journal" id="cit50"><name><surname>Dona</surname><given-names>A. C.</given-names></name>; <name><surname>Jimenez</surname><given-names>B.</given-names></name>; <name><surname>Schafer</surname><given-names>H.</given-names></name>; <name><surname>Humpfer</surname><given-names>E.</given-names></name>; <name><surname>Spraul</surname><given-names>M.</given-names></name>; <name><surname>Lewis</surname><given-names>M. R.</given-names></name>; <name><surname>Pearce</surname><given-names>J. T. M.</given-names></name>; <name><surname>Holmes</surname><given-names>E.</given-names></name>; <name><surname>Lindon</surname><given-names>J. C.</given-names></name>; <name><surname>Nicholson</surname><given-names>J. K.</given-names></name><article-title>Precision
High-Throughput Proton NMR Spectroscopy of
Human Urine, Serum, and Plasma for Large-Scale Metabolic Phenotyping</article-title>. <source>Analytical chemistry</source><year>2014</year>, <volume>86</volume> (<issue>19</issue>), <fpage>9887</fpage>–<lpage>9894</lpage>. <pub-id pub-id-type="doi">10.1021/ac5025039</pub-id>.<pub-id pub-id-type="pmid">25180432</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref51">
      <mixed-citation publication-type="book" id="cit51"><person-group person-group-type="allauthors"><name><surname>Robson</surname><given-names>S.</given-names></name>, <name><surname>Arthanari</surname><given-names>H.</given-names></name>, <name><surname>Hyberts</surname><given-names>S. G.</given-names></name>, <name><surname>Wagner</surname><given-names>G.</given-names></name></person-group> in <source>Methods in enzymology</source> Vol. <volume>614</volume> (ed <person-group person-group-type="editor"><string-name><given-names>A. Joshua</given-names>, <surname>Wand</surname></string-name></person-group>) <fpage>263</fpage>–<lpage>291</lpage> (<publisher-name>Academic Press</publisher-name>, <year>2019</year>).</mixed-citation>
    </ref>
    <ref id="ref52">
      <mixed-citation publication-type="journal" id="cit52"><name><surname>Cloarec</surname><given-names>O.</given-names></name>; <name><surname>Dumas</surname><given-names>M. E.</given-names></name>; <name><surname>Craig</surname><given-names>A.</given-names></name>; <name><surname>Barton</surname><given-names>R. H.</given-names></name>; <name><surname>Trygg</surname><given-names>J.</given-names></name>; <name><surname>Hudson</surname><given-names>J.</given-names></name>; <name><surname>Blancher</surname><given-names>C.</given-names></name>; <name><surname>Gauguier</surname><given-names>D.</given-names></name>; <name><surname>Lindon</surname><given-names>J. C.</given-names></name>; <name><surname>Holmes</surname><given-names>E.</given-names></name>; et al. <article-title>Statistical
total correlation spectroscopy: an exploratory
approach for latent biomarker identification from metabolic 1H NMR
data sets</article-title>. <source>Analytical chemistry</source><year>2005</year>, <volume>77</volume> (<issue>5</issue>), <fpage>1282</fpage>–<lpage>1289</lpage>. <pub-id pub-id-type="doi">10.1021/ac048630x</pub-id>.<pub-id pub-id-type="pmid">15732908</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref53">
      <mixed-citation publication-type="journal" id="cit53"><name><surname>Wu</surname><given-names>Y.</given-names></name>; <name><surname>Judge</surname><given-names>M. T.</given-names></name>; <name><surname>Edison</surname><given-names>A. S.</given-names></name>; <name><surname>Arnold</surname><given-names>J.</given-names></name><article-title>Uncovering in vivo
biochemical patterns from time-series metabolic dynamics</article-title>. <source>PloS one</source><year>2022</year>, <volume>17</volume> (<issue>5</issue>), <elocation-id>e0268394</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0268394</pub-id>.<pub-id pub-id-type="pmid">35550643</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref54">
      <mixed-citation publication-type="journal" id="cit54"><name><surname>Dobin</surname><given-names>A.</given-names></name>; <name><surname>Davis</surname><given-names>C. A.</given-names></name>; <name><surname>Schlesinger</surname><given-names>F.</given-names></name>; <name><surname>Drenkow</surname><given-names>J.</given-names></name>; <name><surname>Zaleski</surname><given-names>C.</given-names></name>; <name><surname>Jha</surname><given-names>S.</given-names></name>; <name><surname>Batut</surname><given-names>P.</given-names></name>; <name><surname>Chaisson</surname><given-names>M.</given-names></name>; <name><surname>Gingeras</surname><given-names>T. R.</given-names></name><article-title>STAR: ultrafast
universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><year>2013</year>, <volume>29</volume> (<issue>1</issue>), <fpage>15</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>.<pub-id pub-id-type="pmid">23104886</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref55">
      <mixed-citation publication-type="journal" id="cit55"><name><surname>Muzny</surname><given-names>D. M.</given-names></name>; <name><surname>Bainbridge</surname><given-names>M. N.</given-names></name>; <name><surname>Chang</surname><given-names>K.</given-names></name>; <name><surname>Dinh</surname><given-names>H. H.</given-names></name>; <name><surname>Drummond</surname><given-names>J. A.</given-names></name>; <name><surname>Fowler</surname><given-names>G.</given-names></name>; <name><surname>Kovar</surname><given-names>C. L.</given-names></name>; <name><surname>Lewis</surname><given-names>L. R.</given-names></name>; <name><surname>Morgan</surname><given-names>M. B.</given-names></name>; <name><surname>Newsham</surname><given-names>I. F.</given-names></name>; et al. <article-title>Comprehensive molecular characterization of
human colon and rectal cancer</article-title>. <source>Nature</source><year>2012</year>, <volume>487</volume> (<issue>7407</issue>), <fpage>330</fpage>–<lpage>337</lpage>. <pub-id pub-id-type="doi">10.1038/nature11252</pub-id>.<pub-id pub-id-type="pmid">22810696</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref56">
      <mixed-citation publication-type="journal" id="cit56"><name><surname>Li</surname><given-names>B.</given-names></name>; <name><surname>Dewey</surname><given-names>C. N.</given-names></name><article-title>RSEM: accurate transcript
quantification from RNA-Seq
data with or without a reference genome</article-title>. <source>BMC
bioinformatics</source><year>2011</year>, <volume>12</volume>, <fpage>323</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>.<pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
