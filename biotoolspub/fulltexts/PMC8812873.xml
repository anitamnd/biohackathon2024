<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1009821.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8812873</article-id>
    <article-id pub-id-type="pmid">35073331</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-00954</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Classical Mechanics</subject>
            <subj-group>
              <subject>Potential Energy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Thermodynamics</subject>
            <subj-group>
              <subject>Free Energy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Cell Differentiation</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Brain</subject>
            <subj-group>
              <subject>Cerebral Cortex</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Brain</subject>
            <subj-group>
              <subject>Cerebral Cortex</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Systems Science</subject>
          <subj-group>
            <subject>Nonlinear Dynamics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Systems Science</subject>
            <subj-group>
              <subject>Nonlinear Dynamics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Stem Cells</subject>
                <subj-group>
                  <subject>Cell Potency</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Signal Transduction</subject>
            <subj-group>
              <subject>Cell Signaling</subject>
              <subj-group>
                <subject>Developmental Signaling</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Dynamic inference of cell developmental complex energy landscape from time series single-cell transcriptomic data</article-title>
      <alt-title alt-title-type="running-head">GraphFP: Dynamic inference for time series single-cell transcriptomic data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Qi</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Shuo</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3511-0512</contrib-id>
        <name>
          <surname>Wan</surname>
          <given-names>Lin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>NCMIS, LSC, LSEC, Academy of Mathematics and Systems Science, Chinese Academy of Sciences, Beijing, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>School of Mathematical Sciences, University of Chinese Academy of Sciences, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of California Irvine, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>lwan@amss.ac.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>1</issue>
    <elocation-id>e1009821</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Jiang et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Jiang et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1009821.pdf"/>
    <abstract>
      <p>Time series single-cell RNA sequencing (scRNA-seq) data are emerging. However, dynamic inference of an evolving cell population from time series scRNA-seq data is challenging owing to the stochasticity and nonlinearity of the underlying biological processes. This calls for the development of mathematical models and methods capable of reconstructing cellular dynamic transition processes and uncovering the nonlinear cell-cell interactions. In this study, we present GraphFP, a nonlinear Fokker-Planck equation on graph based model and dynamic inference framework, with the aim of reconstructing the cell state-transition complex potential energy landscape from time series single-cell transcriptomic data. The free energy of our model explicitly takes into account of the cell-cell interactions in a nonlinear quadratic term. We then recast the model inference problem in the form of a dynamic optimal transport framework and solve it efficiently with the adjoint method of optimal control. We evaluated GraphFP on the time series scRNA-seq data set of embryonic murine cerebral cortex development. We illustrated that it 1) reconstructs cell state potential energy, which is a measure of cellular differentiation potency, 2) faithfully charts the probability flows between paired cell states over the dynamic processes of cell differentiation, and 3) accurately quantifies the stochastic dynamics of cell type frequencies on probability simplex in continuous time. We also illustrated that GraphFP is robust in terms of cluster labelling with different resolutions, as well as parameter choices. Meanwhile, GraphFP provides a model-based approach to delineate the cell-cell interactions that drive cell differentiation. GraphFP software is available at <ext-link xlink:href="https://github.com/QiJiang-QJ/GraphFP" ext-link-type="uri">https://github.com/QiJiang-QJ/GraphFP</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Dynamic inference of cell development processes from time series scRNA-seq data is a major challenge. Here, we present GraphFP, a coherent computational framework that simultaneously reconstructs the cell state-transition complex potential energy landscape and infers cell-cell interactions from time series single-cell transcriptomic data. Based on the mathematical framework of nonlinear Fokker-Planck equation on graph, GraphFP models the stochastic dynamics of the cell state/type frequencies on probability simplex in continuous time, where the free energy with a nonlinear quadratic interaction term is employed to characterize cell-cell interactions. We formulate the model inference problem in the form of a dynamic optimal transport framework and solve it efficiently with the celebrated adjoint method. GraphFP allows for 1) reconstructing cell state potential energy, which is a measure of cellular differentiation potency, 2) charting the probability flows between paired cell states over dynamic processes, 3) quantifying the stochastic dynamics of cell type frequencies on probability simplex in continuous time, and 4) delineating cell-cell interactions that drive cell differentiation. We show how GraphFP can be used to faithfully reveal and accurately quantify the cell development processes using the embryonic murine cerebral cortex development time series scRNA-seq dataset.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution> National Key Research and Development Program of China</institution>
        </funding-source>
        <award-id>2019YFA0709501</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3511-0512</contrib-id>
          <name>
            <surname>Wan</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>12071466</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3511-0512</contrib-id>
          <name>
            <surname>Wan</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>11871465</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Shuo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by the Fund to LW from the National Key Research and Development Program of China under Grant 2019YFA0709501. LW and SZ were also supported by the National Natural Science Foundation of China (No. 12071466 to LW and No.11871465 to SZ). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="1"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-02-03</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>GraphFP software is available at <ext-link xlink:href="https://github.com/QiJiang-QJ/GraphFP" ext-link-type="uri">https://github.com/QiJiang-QJ/GraphFP</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>GraphFP software is available at <ext-link xlink:href="https://github.com/QiJiang-QJ/GraphFP" ext-link-type="uri">https://github.com/QiJiang-QJ/GraphFP</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The dynamics of cell developmental processes (e.g., cell differentiation and tumorigenesis) are highly complex. Advances in single-cell RNA sequencing (scRNA-seq) technologies enable cell-resolved investigation of heterogeneous cell populations, offering a systematic approach to reveal underlying developmental dynamics, cell communication, and gene regulation [<xref rid="pcbi.1009821.ref001" ref-type="bibr">1</xref>]. The dynamic inferences of cell development from scRNA-seq transcriptomic profiles draw heavily on advances in computational and systems biology. Many efforts have been advanced to reconstruct cell developmental trajectories and pseudo-time from the single-cell snapshot profile sampled from an evolving cell population [<xref rid="pcbi.1009821.ref002" ref-type="bibr">2</xref>]. Methods have also been developed to quantify cell developmental landscape [<xref rid="pcbi.1009821.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1009821.ref006" ref-type="bibr">6</xref>]. However, state-of-the-art dynamic inference methods based on the static single-cell snapshot profile alone may lack identifiability of complex dynamic processes [<xref rid="pcbi.1009821.ref007" ref-type="bibr">7</xref>].</p>
    <p>Recently, time series scRNA-seq data profiled from cells sampled at multiple physical time stages have been accumulating, accounting for additional temporal dimension. The wider dynamic ranges enriched by the temporal dimension show great promise in overcoming the difficulties that arise during the inferences from static single-cell snapshot profiling. Computational methods that explicitly incorporate temporal information have been developed. TASIC determined the temporal trajectories based on the probabilistic graphical model to integrate expression and time information [<xref rid="pcbi.1009821.ref008" ref-type="bibr">8</xref>], while CSHMM developed a continuous state hidden Markov model to infer trajectory structure and assigned cells to paths [<xref rid="pcbi.1009821.ref009" ref-type="bibr">9</xref>]. TSEE incorporated temporal information into a nonlinear dimensionality reduction algorithm of elastic embedding to visualize dynamic gene expression patterns, offering enhanced temporal resolution [<xref rid="pcbi.1009821.ref010" ref-type="bibr">10</xref>]. ScPADGRN reconstructed the dynamic gene regulatory network with a preconditioned ADMM optimization method [<xref rid="pcbi.1009821.ref011" ref-type="bibr">11</xref>]. Tempora incorporated biological pathway information to accurately identify cell types and then incorporated the time information to infer evolving cell-type trajectories [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>].</p>
    <p>An emerging number of methods are being developed to reconstruct cell developmental energy landscape from time series single-cell data using the mathematical framework of optimal transport. Optimal transport has received considerable attention in recent years for various disciplines such as machine learning and statistical data analysis, as it has been proven to be a powerful tool in the analysis of complex data [<xref rid="pcbi.1009821.ref013" ref-type="bibr">13</xref>]. The core concept of optimal transport, Wasserstein distance between two probability distributions, quantifies an optimal cost of transporting one data distribution to the other. As a remarkably rich and fruitful concept, Wasserstein distance “enables a mechanism transforming the probability space into a Riemannian manifold (known as a Wasserstein manifold), so that geometric structures and partial differential equation (PDE) techniques can be established and analyzed” [<xref rid="pcbi.1009821.ref014" ref-type="bibr">14</xref>]. Amongst existing methods, Waddington-OT [<xref rid="pcbi.1009821.ref015" ref-type="bibr">15</xref>] reported landmark work that developed an unbalanced optimal transport framework to reconstruct the cell developmental landscape by inferring cell-cell probabilistic couplings based on the distributions between adjacent time points [<xref rid="pcbi.1009821.ref015" ref-type="bibr">15</xref>]; TrajectoryNet set up a dynamic optimal transport neural network framework to reconstruct the continuous normalizing flows of evolving cell populations on the continuous state space [<xref rid="pcbi.1009821.ref016" ref-type="bibr">16</xref>]; PRESCIENT modelled cell differentiation as a diffusion process over a potential energy landscape learned by the neural network framework [<xref rid="pcbi.1009821.ref017" ref-type="bibr">17</xref>]. However, the computation of optimal transport is still a bottleneck when processing large-scale data [<xref rid="pcbi.1009821.ref013" ref-type="bibr">13</xref>].</p>
    <p>In this study, we present GraphFP, a nonlinear Fokker-Planck equation on graph based model and dynamic inference framework, with the aim of reconstructing the cell state-transition complex potential energy landscape from time series single-cell transcriptomic data. The Fokker-Planck equation (FPE) is ubiquitously applied in the modelling of statistical physics and biological systems, including single-cell data analysis [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1009821.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1009821.ref018" ref-type="bibr">18</xref>]. GraphFP is built on the mathematical framework established by the FPE on finite graph originally introduced by Chow <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>] and Li [<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>] (see [<xref rid="pcbi.1009821.ref014" ref-type="bibr">14</xref>] for a recent survey). Building upon the fundamental form of optimal transport, GraphFP learns the complex geometry of data, as well as provides a novel way to quantify cell-cell interactions during cell development. It models the cell developmental process as stochastic dynamics of the cell state/type frequencies on probability simplex in continuous time. The discrete Wasserstein distance is introduced to transform the probability simplex into a Riemannian manifold, called discrete Wasserstein manifold. The FPE is proven to be the gradient flow of the free energy on the discrete Wasserstein manifold. The free energy of our model consists of a static linear potential energy term and a nonlinear quadratic interaction energy term that characterizes cell-cell interactions [<xref rid="pcbi.1009821.ref022" ref-type="bibr">22</xref>, <xref rid="pcbi.1009821.ref023" ref-type="bibr">23</xref>]. To estimate the parameters which represent the linear potential energy and cell-cell interaction strengths, we recast the model inference problem in the form of a dynamic optimal transport framework and solve it efficiently with the celebrated adjoint method of optimal control [<xref rid="pcbi.1009821.ref024" ref-type="bibr">24</xref>]. The adjoint method also played a central role in the development of the well-known neural network algorithm NeuralODE [<xref rid="pcbi.1009821.ref025" ref-type="bibr">25</xref>].</p>
    <p>We evaluated GraphFP on the time series scRNA-seq dataset of embryonic murine cerebral cortex development [<xref rid="pcbi.1009821.ref026" ref-type="bibr">26</xref>]. GraphFP reconstructed the cell state potential energy, which is a measure of cellular differentiation potency from both static and dynamic points of view. It faithfully charted the probability flows of cell state-transitions, consistent with the gold standard benchmarks. It also accurately quantified the stochastic dynamics of cell type frequencies on probability simplex in continuous time. GraphFP delineated cell-cell interactions that drive cell development in a model-based fashion. We tested the cell-cell interaction term of GraphFP by illustrating its ability to fit the nonlinear curves of experimental data and recover held-out time points. We illustrated that GraphFP is robust in terms of cluster labelling with different resolutions, as well as parameter choices. We compared GraphFP with state-of-the-art cell developmental energy landscape reconstruction methods in <bold>Discussion</bold>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>GraphFP is a coherent computational framework that simultaneously reconstructs the cell state-transition complex potential energy landscape and infers cell-cell interactions from time series single-cell transcriptomic data (<xref rid="pcbi.1009821.g001" ref-type="fig">Fig 1</xref>). It models cell state-transition dynamics with cell-cell interactions based on the mathematical framework introduced by Chow <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>] and Li [<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>].</p>
    <fig position="float" id="pcbi.1009821.g001">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Overview of GraphFP algorithm.</title>
        <p>GraphFP takes the input of time series single-cell transcriptomic data incorporated with experimental temporal information. It identifies cell states/types, estimates the cell type frequencies at each time point, estimates the linear potential energy <bold>Φ</bold> and the cell-cell interaction matrix <bold><italic toggle="yes">W</italic></bold> based on the adjoint method. GraphFP outputs the stochastic dynamics of cell type frequencies <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>) on probability simplex in continuous time, the cell state transition potential energy, and the probability flows of cell state-transitions underlying the evolving cell population.</p>
      </caption>
      <graphic xlink:href="pcbi.1009821.g001" position="float"/>
    </fig>
    <p>GraphFP allows for reconstructing cell state potential energy, charting the probability flows between paired cell states over dynamic process, quantifying the stochastic dynamics of cell type frequencies on probability simplex in continuous time, and delineating cell-cell interactions that drive cell differentiation [<xref rid="pcbi.1009821.ref022" ref-type="bibr">22</xref>]. The main steps for GraphFP are organized in the following subsections.</p>
    <sec id="sec003">
      <title>Identifying cell states/types</title>
      <p>Given the time series scRNA-seq data, the single-cell samples are collected at <italic toggle="yes">f</italic> time stages {<italic toggle="yes">t</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>2</sub>, …, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>}, and for each time stage <italic toggle="yes">t</italic><sub><italic toggle="yes">l</italic></sub>(1 ≤ <italic toggle="yes">l</italic> ≤ <italic toggle="yes">f</italic>), a number of <italic toggle="yes">m</italic><sub><italic toggle="yes">l</italic></sub> single cells are sequenced with the corresponding gene expression vectors <inline-formula id="pcbi.1009821.e001"><alternatives><graphic xlink:href="pcbi.1009821.e001.jpg" id="pcbi.1009821.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic toggle="yes">D</italic> is the number of genes for single cells. Thus, the single cell gene expression profile of a total number of <inline-formula id="pcbi.1009821.e002"><alternatives><graphic xlink:href="pcbi.1009821.e002.jpg" id="pcbi.1009821.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>f</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> cells is contained in the data matrix
<disp-formula id="pcbi.1009821.e003"><alternatives><graphic xlink:href="pcbi.1009821.e003.jpg" id="pcbi.1009821.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p>Suppose that the total number of <italic toggle="yes">M</italic> cells forms <italic toggle="yes">n</italic> cell states corresponding to <italic toggle="yes">n</italic> cell types. When the cells are already annotated or clustered, GraphFP directly utilizes the prior information of cell types. When cell type information is not available, GraphFP will apply state-of-the-art single-cell clustering and annotation methods (e.g., Louvain-Jaccard algorithm [<xref rid="pcbi.1009821.ref027" ref-type="bibr">27</xref>], the single-cell data analysis platform Seurat [<xref rid="pcbi.1009821.ref028" ref-type="bibr">28</xref>], and the single cell deep generative method scDEC [<xref rid="pcbi.1009821.ref029" ref-type="bibr">29</xref>]) to cluster cells into <italic toggle="yes">n</italic> clusters as the cell states/types.</p>
    </sec>
    <sec id="sec004">
      <title>Constructing the cell state-transition graph</title>
      <p>The cell state-transition graph <italic toggle="yes">G</italic> = (<italic toggle="yes">V</italic>, <italic toggle="yes">E</italic>) is an undirected graph, where each vertex <italic toggle="yes">i</italic> in <italic toggle="yes">V</italic> represents a cell state/type and each edge {<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>} in <italic toggle="yes">E</italic> represents that cell state <italic toggle="yes">i</italic> can directly transit to cell state <italic toggle="yes">j</italic> or vice versa. In this study, with no inherent reliance on any prior information, we construct the cell state-transition graph <italic toggle="yes">G</italic> as a complete graph supported on all cell types. However, we can also incorporate prior information of cell state-transition into graph <italic toggle="yes">G</italic> when available.</p>
    </sec>
    <sec id="sec005">
      <title>Modelling cell state-transition dynamics with the nonlinear FPE on graph equipped with discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein distance</title>
      <p>GraphFP models the stochastic dynamics of cell state/type frequencies in the evolving cell population with the nonlinear FPE on graph. The underlying assumption of this model is that cell state-transitions follow the minimum total kinetic energy path during cell differentiation, which can be measured by the discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein distance on graph. To estimate the parameters in the nonlinear FPE of GraphFP, we propose a gradient method to find the parameters that minimize the discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein distance.</p>
      <p>We use discrete probability distributions supported on the vertices of cell state-transition graph <italic toggle="yes">G</italic> to represent the state of the system at time <italic toggle="yes">t</italic>. Suppose the number of vertices of <italic toggle="yes">G</italic> is <italic toggle="yes">n</italic>, the set of system states is the probability simplex supported on all vertices of <italic toggle="yes">G</italic>:
<disp-formula id="pcbi.1009821.e004"><alternatives><graphic xlink:href="pcbi.1009821.e004.jpg" id="pcbi.1009821.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p>The cell-state frequencies or probabilities are estimated for each time point separately, resulting in <inline-formula id="pcbi.1009821.e005"><alternatives><graphic xlink:href="pcbi.1009821.e005.jpg" id="pcbi.1009821.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>f</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      <p>Here, we mainly follow the setups in Chow <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>]; Li [<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>], and define the discrete nonlinear free energy <inline-formula id="pcbi.1009821.e006"><alternatives><graphic xlink:href="pcbi.1009821.e006.jpg" id="pcbi.1009821.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> of the cell-state system as follows:
<disp-formula id="pcbi.1009821.e007"><alternatives><graphic xlink:href="pcbi.1009821.e007.jpg" id="pcbi.1009821.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi mathvariant="script">H</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1009821.e008"><alternatives><graphic xlink:href="pcbi.1009821.e008.jpg" id="pcbi.1009821.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mi mathvariant="script">V</mml:mi></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1009821.e009"><alternatives><graphic xlink:href="pcbi.1009821.e009.jpg" id="pcbi.1009821.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1009821.e010"><alternatives><graphic xlink:href="pcbi.1009821.e010.jpg" id="pcbi.1009821.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mi mathvariant="script">H</mml:mi></mml:math></alternatives></inline-formula> represent the static linear potential energy parametrized by vector <inline-formula id="pcbi.1009821.e011"><alternatives><graphic xlink:href="pcbi.1009821.e011.jpg" id="pcbi.1009821.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the quadratic interaction energy of paired cell states parametrized by matrix <bold><italic toggle="yes">W</italic></bold> = (<italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>)<sub>1≤<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic> ≤ <italic toggle="yes">n</italic></sub>, and Boltzmann entropy with a hyper-parameter <italic toggle="yes">β</italic> ≥ 0, respectively. In general, the interaction matrix <bold><italic toggle="yes">W</italic></bold> is asymmetry, with its element <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub> representing the interaction strength from cell state <italic toggle="yes">j</italic> (as a signalling sender) to cell state <italic toggle="yes">i</italic> (as a signalling receiver) (see <xref rid="pcbi.1009821.e031" ref-type="disp-formula">Eq (9)</xref> and section “<bold>Reconstruction of cell developmental energy landscape and modelling of cell-cell interactions</bold>” for further discussion). We hereinafter denote the parameters of the free energy as <bold><italic toggle="yes">θ</italic></bold> ≡ {<bold>Φ</bold>, <bold><italic toggle="yes">W</italic></bold>}.</p>
      <p>Based on the specific form of free energy <inline-formula id="pcbi.1009821.e012"><alternatives><graphic xlink:href="pcbi.1009821.e012.jpg" id="pcbi.1009821.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mi mathvariant="script">F</mml:mi></mml:math></alternatives></inline-formula>, the corresponding FPE on <italic toggle="yes">G</italic> is defined as follows: for any <italic toggle="yes">i</italic> ∈ <italic toggle="yes">V</italic>,
<disp-formula id="pcbi.1009821.e013"><alternatives><graphic xlink:href="pcbi.1009821.e013.jpg" id="pcbi.1009821.e013g" position="anchor"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <inline-formula id="pcbi.1009821.e014"><alternatives><graphic xlink:href="pcbi.1009821.e014.jpg" id="pcbi.1009821.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">N</italic>(<italic toggle="yes">i</italic>) = {<italic toggle="yes">j</italic> ∈ <italic toggle="yes">V</italic>|{<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>} ∈ <italic toggle="yes">E</italic>} is the adjacency set of vertex <italic toggle="yes">i</italic> ∈ <italic toggle="yes">V</italic>, and <italic toggle="yes">g</italic><sub><italic toggle="yes">ij</italic></sub>(<bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>)) is defined as
<disp-formula id="pcbi.1009821.e015"><alternatives><graphic xlink:href="pcbi.1009821.e015.jpg" id="pcbi.1009821.e015g" position="anchor"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Chow <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>] and Li [<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>] proved that, the dynamics of <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>) is evolving along the gradient of free energy (<xref rid="pcbi.1009821.e007" ref-type="disp-formula">Eq (1)</xref>) when <inline-formula id="pcbi.1009821.e016"><alternatives><graphic xlink:href="pcbi.1009821.e016.jpg" id="pcbi.1009821.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is equipped with the discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein distance on graph <italic toggle="yes">G</italic>: for any <inline-formula id="pcbi.1009821.e017"><alternatives><graphic xlink:href="pcbi.1009821.e017.jpg" id="pcbi.1009821.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>f</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
<disp-formula id="pcbi.1009821.e018"><alternatives><graphic xlink:href="pcbi.1009821.e018.jpg" id="pcbi.1009821.e018g" position="anchor"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">W</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>;</mml:mo><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>inf</mml:mtext><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the infimum is taken over <inline-formula id="pcbi.1009821.e019"><alternatives><graphic xlink:href="pcbi.1009821.e019.jpg" id="pcbi.1009821.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a piecewise <italic toggle="yes">C</italic><sup>1</sup> curve that satisfies the FPE of <xref rid="pcbi.1009821.e013" ref-type="disp-formula">Eq (2)</xref>, <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic><sub>1</sub>) = <bold><italic toggle="yes">p</italic></bold><sup>1</sup> and <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>) = <bold><italic toggle="yes">p</italic></bold><sup><italic toggle="yes">f</italic></sup>}. Intuitively, the discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein distance can be understood as the total work for transporting <bold><italic toggle="yes">p</italic></bold><sup>1</sup> to <bold><italic toggle="yes">p</italic></bold><sup><italic toggle="yes">f</italic></sup> on <inline-formula id="pcbi.1009821.e020"><alternatives><graphic xlink:href="pcbi.1009821.e020.jpg" id="pcbi.1009821.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is the summation of the kinetic energies of the flows (mass×squared velocity) on the edges of graph <italic toggle="yes">G</italic> during the time period [<italic toggle="yes">t</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>].</p>
    </sec>
    <sec id="sec006">
      <title>Parameter estimation and model optimization</title>
      <p>To estimate the parameters <bold><italic toggle="yes">θ</italic></bold> = {<bold>Φ</bold>, <bold><italic toggle="yes">W</italic></bold>} of the free energy using all time series scRNA-seq data collected at time points {<italic toggle="yes">t</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>2</sub>, ⋯, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>} (assume that <bold><italic toggle="yes">θ</italic></bold> is constant over the entire time period), we formulate the estimation problem as a minimization problem of the discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein distance:
<disp-formula id="pcbi.1009821.e021"><alternatives><graphic xlink:href="pcbi.1009821.e021.jpg" id="pcbi.1009821.e021g" position="anchor"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mtext>min</mml:mtext><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:munder></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
subject to the constraints
<disp-formula id="pcbi.1009821.e022"><alternatives><graphic xlink:href="pcbi.1009821.e022.jpg" id="pcbi.1009821.e022g" position="anchor"/><mml:math id="M22" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic toggle="yes">n</italic> is the size of vertex set <italic toggle="yes">V</italic>. However, the dynamic optimization problem with constrains of multiple fixed points at <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic><sub><italic toggle="yes">l</italic></sub>)s in <xref rid="pcbi.1009821.e022" ref-type="disp-formula">Eq (4)</xref> is extremely difficult, and maybe even unsolvable.</p>
      <p>In this study, to estimate parameters <bold><italic toggle="yes">θ</italic></bold>*, we follow TrajectoryNet [<xref rid="pcbi.1009821.ref016" ref-type="bibr">16</xref>] and relax the constraints of <bold><italic toggle="yes">p</italic></bold>s at time points {<italic toggle="yes">t</italic><sub>2</sub>, ⋯, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>} by moving them into the object function as follows
<disp-formula id="pcbi.1009821.e023"><alternatives><graphic xlink:href="pcbi.1009821.e023.jpg" id="pcbi.1009821.e023g" position="anchor"/><mml:math id="M23" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mtext>min</mml:mtext><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:munder><mml:mo>[</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>f</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:mi>l</mml:mi></mml:msub><mml:mtext>KL</mml:mtext><mml:mspace width="2pt"/><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>∥</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
subject to the constraints
<disp-formula id="pcbi.1009821.e024"><alternatives><graphic xlink:href="pcbi.1009821.e024.jpg" id="pcbi.1009821.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
<disp-formula id="pcbi.1009821.e025"><alternatives><graphic xlink:href="pcbi.1009821.e025.jpg" id="pcbi.1009821.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where λ<sub><italic toggle="yes">l</italic></sub> ≥ 0 is a constant regularization parameter, <italic toggle="yes">n</italic> is the size of vertex set <italic toggle="yes">V</italic>, and <inline-formula id="pcbi.1009821.e026"><alternatives><graphic xlink:href="pcbi.1009821.e026.jpg" id="pcbi.1009821.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>KL</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>)</mml:mo><mml:mo>≡</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle></mml:math></alternatives></inline-formula> is the Kullback-Leibler divergence between the probability distributions <bold><italic toggle="yes">p</italic></bold> and <bold><italic toggle="yes">q</italic></bold>.</p>
      <p>The optimization problem of <xref rid="pcbi.1009821.e023" ref-type="disp-formula">Eq (5)</xref> can be interpreted as an optimal control problem with fixed initial point and the parameters <bold><italic toggle="yes">θ</italic></bold> can be regarded as the control. We therefore propose a gradient method to estimate <bold><italic toggle="yes">θ</italic></bold>* based on the Pontryagin’s Maximum Principle (also known as the adjoint method) [<xref rid="pcbi.1009821.ref024" ref-type="bibr">24</xref>] to solve the optimal control problem of <xref rid="pcbi.1009821.e023" ref-type="disp-formula">Eq (5)</xref>. In our implementation, we treat the integral part and the KL divergence part in <xref rid="pcbi.1009821.e023" ref-type="disp-formula">Eq (5)</xref> separately, solve each of them using the adjoint method, and then combine them together through the tradeoff parameters <italic toggle="yes">λ</italic><sub><italic toggle="yes">l</italic></sub>s. See the details and the pseudocode of GraphFP algorithm in <xref rid="pcbi.1009821.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>In our implementation, we centralize both <bold>Φ</bold> and <bold><italic toggle="yes">W</italic></bold> such that
<disp-formula id="pcbi.1009821.e027"><alternatives><graphic xlink:href="pcbi.1009821.e027.jpg" id="pcbi.1009821.e027g" position="anchor"/><mml:math id="M27" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p>Therefore, in our study, <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub> with a high absolute value indicates strong interaction from cell state <italic toggle="yes">j</italic> to cell state <italic toggle="yes">i</italic> (see the following section for further discussion).</p>
    </sec>
    <sec id="sec007">
      <title>Reconstruction of cell developmental energy landscape and modelling of cell-cell interactions</title>
      <p>Following Chow <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>] and Li [<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>], we define the dynamic potential energy of cell type <italic toggle="yes">i</italic> as follows:
<disp-formula id="pcbi.1009821.e028"><alternatives><graphic xlink:href="pcbi.1009821.e028.jpg" id="pcbi.1009821.e028g" position="anchor"/><mml:math id="M28" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mspace width="4pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
which consists of three components: (1) a static linear potential energy Φ<sub><italic toggle="yes">i</italic></sub> that is time-independent and measures the cell differentiation potency of cell type <italic toggle="yes">i</italic>; (2) an interaction potential energy <inline-formula id="pcbi.1009821.e029"><alternatives><graphic xlink:href="pcbi.1009821.e029.jpg" id="pcbi.1009821.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that coordinates cell development through intercellular communication; and (3) an entropy energy <italic toggle="yes">β</italic> log <italic toggle="yes">p</italic><sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>) which is an analog of the potential energy induced by white noise in diffusion process [<xref rid="pcbi.1009821.ref014" ref-type="bibr">14</xref>].</p>
      <p>Overall, the Ψ<sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>) depicts a dynamic potential energy landscape of cell type <italic toggle="yes">i</italic> at time <italic toggle="yes">t</italic>: cell state <italic toggle="yes">i</italic> with a higher potential energy Ψ<sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>) tends to transit to more stable states with lower potential energies; while the Φ<sub><italic toggle="yes">i</italic></sub> quantifies the cell differentiation potency of cell type <italic toggle="yes">i</italic>, as well as a way to represent cell developmental time (see <bold>The linear potential energy Φ by GraphFP quantifies cell differentiation potency</bold> in <bold>Results</bold>).</p>
      <p>Cell development relies on the coordination of cellular activities based on temporal and local cell-cell communication through molecular signalling events [<xref rid="pcbi.1009821.ref022" ref-type="bibr">22</xref>]. As a key component, the interaction potential energy <inline-formula id="pcbi.1009821.e030"><alternatives><graphic xlink:href="pcbi.1009821.e030.jpg" id="pcbi.1009821.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref rid="pcbi.1009821.e028" ref-type="disp-formula">Eq (8)</xref> models and quantifies cell-cell interactions that drive cell development, where <italic toggle="yes">w</italic><sub><italic toggle="yes">ik</italic></sub> is the interaction strength from cell type <italic toggle="yes">k</italic> (as a signalling sender) to cell type <italic toggle="yes">i</italic> (as a signalling receiver): when <italic toggle="yes">w</italic><sub><italic toggle="yes">ik</italic></sub> &gt; 0, cell type <italic toggle="yes">k</italic> will send signals to upgrade the potential energy of cell type <italic toggle="yes">i</italic> to a higher level, thus inhibiting the decrease of potential energy of cell type <italic toggle="yes">i</italic>; when <italic toggle="yes">w</italic><sub><italic toggle="yes">ik</italic></sub> &lt; 0, cell type <italic toggle="yes">k</italic> will send signals to downgrade the potential energy of cell type <italic toggle="yes">i</italic> to a lower level, thus stimulating the decrease of potential energy of cell type <italic toggle="yes">i</italic>; when <italic toggle="yes">w</italic><sub><italic toggle="yes">ik</italic></sub> = 0 or <italic toggle="yes">w</italic><sub><italic toggle="yes">ik</italic></sub> ≈ 0, cell type <italic toggle="yes">k</italic> will send no or weak signals to cell type <italic toggle="yes">i</italic>, thus unable to alter the potential energy level of cell type <italic toggle="yes">i</italic>.
<disp-formula id="pcbi.1009821.e031"><alternatives><graphic xlink:href="pcbi.1009821.e031.jpg" id="pcbi.1009821.e031g" position="anchor"/><mml:math id="M31" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="4pt"/><mml:mtext>sends</mml:mtext><mml:mspace width="4pt"/><mml:mtext>signals</mml:mtext><mml:mspace width="4pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4pt"/><mml:mtext>upgrade</mml:mtext><mml:mspace width="4pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>potential</mml:mtext><mml:mspace width="4pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>/</mml:mo><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="4pt"/><mml:mtext>sends</mml:mtext><mml:mspace width="4pt"/><mml:mtext>no</mml:mtext><mml:mspace width="4pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4pt"/><mml:mtext>weak</mml:mtext><mml:mspace width="4pt"/><mml:mtext>signals</mml:mtext><mml:mspace width="4pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mtext>,</mml:mtext><mml:mspace width="4pt"/><mml:mtext>unable</mml:mtext><mml:mspace width="4pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4pt"/><mml:mtext>alter</mml:mtext><mml:mspace width="4pt"/><mml:mtext>its</mml:mtext><mml:mspace width="4pt"/><mml:mtext>potential</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="4pt"/><mml:mtext>sends</mml:mtext><mml:mspace width="4pt"/><mml:mtext>signals</mml:mtext><mml:mspace width="4pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4pt"/><mml:mtext>downgrade</mml:mtext><mml:mspace width="4pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>potential</mml:mtext><mml:mspace width="4pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
</p>
      <p>We say that cell types <italic toggle="yes">i</italic> and <italic toggle="yes">k</italic> have no mutual interactions when both <italic toggle="yes">w</italic><sub><italic toggle="yes">ik</italic></sub> and <italic toggle="yes">w</italic><sub><italic toggle="yes">ki</italic></sub> are zero or close to zero. Such modelling of the interaction matrix <bold><italic toggle="yes">W</italic></bold> is inspired and evidenced by our increasing understanding that both positive and negative feedback circuits composed of stimulatory and inhibitory factors are involved in the regulation of precise coordination of cell fate decisions through intercellular communication [<xref rid="pcbi.1009821.ref022" ref-type="bibr">22</xref>, <xref rid="pcbi.1009821.ref030" ref-type="bibr">30</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Dynamic inference of cell developmental process</title>
      <p>Once we estimate parameters <bold><italic toggle="yes">θ</italic></bold>* = {<bold>Φ</bold>*, <bold><italic toggle="yes">W</italic></bold>*}, we can quantify the stochastic dynamics of the cell type frequencies <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>) on probability simplex in continuous time <italic toggle="yes">t</italic>(&gt; <italic toggle="yes">t</italic><sub>1</sub>), according to <xref rid="pcbi.1009821.e013" ref-type="disp-formula">Eq (2)</xref> given the initial point of probability <bold><italic toggle="yes">p</italic></bold><sup>1</sup> on probability simplex.</p>
      <p>The potential energy difference between cell states <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> is
<disp-formula id="pcbi.1009821.e032"><alternatives><graphic xlink:href="pcbi.1009821.e032.jpg" id="pcbi.1009821.e032g" position="anchor"/><mml:math id="M32" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mo>Φ</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
</p>
      <p>We can draw the curves of the potential energy <inline-formula id="pcbi.1009821.e033"><alternatives><graphic xlink:href="pcbi.1009821.e033.jpg" id="pcbi.1009821.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mo mathvariant="bold">Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> of all cell states over time to illustrate the cell state-transition potential energy landscape from a dynamic point of view.</p>
      <p>Based on <xref rid="pcbi.1009821.e013" ref-type="disp-formula">Eq (2)</xref> which is the gradient flow of free energy [<xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>], we define the probability flow from vertex <italic toggle="yes">j</italic> into vertex <italic toggle="yes">i</italic> through edge {<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>} between time stages [<italic toggle="yes">t</italic><sub><italic toggle="yes">l</italic></sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">l</italic>+1</sub>] as
<disp-formula id="pcbi.1009821.e034"><alternatives><graphic xlink:href="pcbi.1009821.e034.jpg" id="pcbi.1009821.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Flow</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
which measures the total probability mass transporting from vertex <italic toggle="yes">j</italic> into vertex <italic toggle="yes">i</italic> through edge {<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>} between adjacent time stages [<italic toggle="yes">t</italic><sub><italic toggle="yes">l</italic></sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">l</italic>+ 1</sub>]: a positive value indicates a probability mass gain of vertex <italic toggle="yes">i</italic> resulted from the flow of cells transiting from state <italic toggle="yes">j</italic> into state <italic toggle="yes">i</italic>, while a negative value indicates a probability mass loss of vertex <italic toggle="yes">i</italic> resulted from the flow of cells transiting from state <italic toggle="yes">i</italic> into state <italic toggle="yes">j</italic>. If total probability mass is conservative (e.g., no cell proliferation is considered), we have
<disp-formula id="pcbi.1009821.e035"><alternatives><graphic xlink:href="pcbi.1009821.e035.jpg" id="pcbi.1009821.e035g" position="anchor"/><mml:math id="M35" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Flow</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mtext>Flow</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p>The intuition of the probability flow definition is that, when potential energy difference Δ<sub><italic toggle="yes">ji</italic></sub>(<italic toggle="yes">t</italic>) = <italic toggle="yes">F</italic><sub><italic toggle="yes">j</italic></sub>(<bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>)) − <italic toggle="yes">F</italic><sub><italic toggle="yes">i</italic></sub>(<bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>)) &gt; 0, cells tend to transit from a higher potential energy state <italic toggle="yes">j</italic> to a lower potential energy state <italic toggle="yes">i</italic>, resulting in a probability mass gain of vertex <italic toggle="yes">i</italic>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec009">
    <title>Results</title>
    <p>GraphFP models and infers cell differentiation as a cell state-transition process described by the nonlinear FPE on cell state-transition graph in continuous time (see <xref rid="pcbi.1009821.g001" ref-type="fig">Fig 1</xref> and <xref rid="sec002" ref-type="sec">Methods</xref> for details).</p>
    <p>In this study, we evaluated the performance of GraphFP using the time series scRNA-seq dataset of embryonic murine cerebral cortex development [<xref rid="pcbi.1009821.ref026" ref-type="bibr">26</xref>]. This dataset was analyzed by Tempora [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>]. We downloaded the processed data, including the cell type annotations provided by Tempora [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>]. The time series transcriptomic profile contains 6,316 cells collected at embryonic day 11.5 (E11.5), E13.5, E15.5 and E17.5. Overall, these cells represent neuronal development states from the early precursors (apical precursors (APs) and radial precursors (RPs)) to intermediate progenitors (IPs) and differentiated cortical neurons. <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2a</xref> illustrates the gold standard trajectory of the 4 major cell states curated by Tempora. Tempora identified 7 cell types by clustering and annotation methods: two AP/RP clusters denoted as “3-APs/RPs” and “5-APs/RPs”, two IP clusters denoted as “4-IPs” and “7-IPs”, two young neuron clusters denoted as “2-Young Neurons” and “6-Young Neurons”, and one neuron cluster denoted as “1-Neurons” (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2b</xref>).</p>
    <fig position="float" id="pcbi.1009821.g002">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>GraphFP accurately reconstructs the cell state-transition energy landscape of the murine cerebral cortex dataset.</title>
        <p><bold>(a)</bold> The gold standard trajectory of embryonic murine cerebral cortex development. (b) The t-SNE plot of cells from the murine cerebral cortex dataset, colored by their cell-type labels. <bold>(c)</bold> GraphFP estimated the linear potential energy <bold>Φ</bold>. <bold>(d)</bold> GraphFP estimated the cell-cell interaction matrix <bold><italic toggle="yes">W</italic></bold>. <bold>(e)</bold> Static linear potential energy landscape of cells on the t-SNE plot: cells are color-coded according to the linear potential energies Φs of their corresponding cell types. <bold>(f)</bold> The free energy (<xref rid="pcbi.1009821.e007" ref-type="disp-formula">Eq (1)</xref>) of the system decreased over time. <bold>(g)</bold> The reconstructed potential energy landscape <bold>Ψ</bold>(<italic toggle="yes">t</italic>) of cell types (colored curves) over time. <bold>(h)</bold> The potential energies of the cell state pairs with the top 3 highest positive values of cell-cell interaction strengths <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>s: “2-Young Neurons ← 1-Neurons” (left panel), “6-Young Neurons ← 3-APs/RPs” (middle panel), and “4-IPs ← 1-Neurons” (right panel). <bold>(i)</bold> The potential energies of the cell state pairs with the top 3 lowest negative values of cell-cell interaction strengths <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>s: “6-Young Neurons ← 1-Neurons” (left panel), “4-IPs ← 3-APs/RPs” (middle panel), and “2-Young Neurons ← 4-IPs” (right panel).</p>
      </caption>
      <graphic xlink:href="pcbi.1009821.g002" position="float"/>
    </fig>
    <sec id="sec010">
      <title>GraphFP reconstructs the cell state-transition energy landscape</title>
      <p>We applied GraphFP to the embryonic murine cerebral cortex development scRNA-seq dataset based on the cell state/type labels of 7 clusters provided by Tempora. We estimated the cell state frequencies of the 7 cell states for each of the 4 time points separately. GraphFP first estimated parameters <bold><italic toggle="yes">θ</italic></bold> = {<bold>Φ</bold>, <bold><italic toggle="yes">W</italic></bold>} of the free energy based on the adjoint method (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2c and 2d</xref>).</p>
      <p>In general, the static landscape of the estimated linear potential energies Φs shows a consistent understanding of the differentiation potencies of the 7 cell states. The early precursors states of “5-APs/RPs” and “3-APs/RPs” that mostly comprise cells at E11.5 have the highest two Φs of 0.059 and 0.054, respectively. The two IP clusters, “7-IPs” and “4-IPs”, and one young neuron cluster, “6-Young Neurons”, have the three intermediate-valued Φs of 0.052, -0.051, and 0.035, respectively. The differentiated cortical neuron clusters “1-Neurons” and “2-Young Neurons” have the lowest two Φs of -0.073 and -0.075, respectively (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2c and 2e</xref>).</p>
      <p>We modelled the cell state-transition energy landscape from a dynamical geometric point of view. The dynamic potential energy <bold>Ψ</bold>(<italic toggle="yes">t</italic>) consists of not only the static linear part of <bold>Φ</bold>, but also an interaction energy part as shown in <xref rid="pcbi.1009821.e028" ref-type="disp-formula">Eq (8)</xref>. It provides a global and holistic view of cell development process. For example, when only looking at the static landscape of <bold>Φ</bold>, we found that the linear potential energy of “1-Neurons” (Φ<sub>1</sub> = −0.073) is slightly higher than that of “2-Young Neurons” (Φ<sub>2</sub> = −0.075). This is in conflict with our understanding that “1-Neurons” should have the lowest potential since it is located at the terminal node of the cell lineage (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2a</xref>). However, when looking at the dynamic potential energy <bold>Ψ</bold>(<italic toggle="yes">t</italic>), we found that “1-Neurons” has a strong inhibitory interaction over “2-Young Neurons” (<italic toggle="yes">w</italic><sub>21</sub> = 0.26 versus <italic toggle="yes">w</italic><sub>12</sub> = 0.04) which can upgrade the potential energy of “2-Young Neurons” during the process. The resultant dynamic potential energy of “2-Young Neurons” (Ψ<sub>2</sub>(<italic toggle="yes">t</italic>)) surpasses that of “1-Neurons” (Ψ<sub>1</sub>(<italic toggle="yes">t</italic>)) with higher value after time point E13 (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2g</xref> and Left Panel of <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2h</xref>). The potential energy difference (Δ<sub>21</sub>) between “2-Young Neurons” and “1-Neurons” diverges with enlarging gaps as time evolves, especially in the latter time stages after time point E15.5 (Left Panel of <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2h</xref>). This is well consistent with our understanding that: (1) “2-Young Neurons” tends to transit to “1-Neurons” during cell development (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2a</xref>), and (2) the transition from “2-Young Neurons” to “1-Neurons” mainly occurs at the late neurogenesis between E15.5 and E17.5 [<xref rid="pcbi.1009821.ref026" ref-type="bibr">26</xref>].</p>
      <p>Further results on the linear potential energy, the cell-cell interactions and the dynamic potential energy will be provided in the following two sections.</p>
    </sec>
    <sec id="sec011">
      <title>The linear potential energy Φ by GraphFP quantifies cell differentiation potency</title>
      <p>Computational quantification of cell differentiation potency (also known as cell stemness) is a challenging issue [<xref rid="pcbi.1009821.ref018" ref-type="bibr">18</xref>]. The pioneer work by Shi <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>] established a rigorous mathematical theory on quantifying cell stemness from scRNA-seq data based on continuous birth-death process.</p>
      <p>Here, we demonstrated that the linear potential <bold>Φ</bold> estimated by GraphFP can be used to quantify the cell differentiation potency. In this study, each cell will be assigned the same linear potential value as that of its corresponding cell type/state. Shi <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>] also quantified the cell differentiation potency at the cluster level (e.g., cell state and cell type), which makes the results more accurate and robust. Quantifying the cell differentiation potency at single-cell level is still difficult, as the single-cell gene expression profiles are known to be error-prone due to various technique issues [<xref rid="pcbi.1009821.ref031" ref-type="bibr">31</xref>].</p>
      <p>Following the study in Shi <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>], we tested whether our linear potential energies for pluripotent stem cells (at early time point) are higher than those for differentiated cells (at latter time point). It is clearly shown that, cells from samples collected at earlier time stages tend to have higher potential <bold>Φ</bold> and vice versa (<xref rid="pcbi.1009821.g003" ref-type="fig">Fig 3a</xref>). When using the one-sided Wilcoxon ranksum statistic as applied by Shi <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>], we confirmed with highly statistically significant results that the linear potential values of cells sampled at the earliest time stage E11.5 are higher than those cells sampled at the subsequent time stages E13.5 (<italic toggle="yes">p</italic> &lt; 1.554<italic toggle="yes">e</italic> − 07), E15.5 (<italic toggle="yes">p</italic> &lt; 2.2<italic toggle="yes">e</italic> − 16), and E17.5 (<italic toggle="yes">p</italic> &lt; 2.2<italic toggle="yes">e</italic> − 16), respectively.</p>
      <fig position="float" id="pcbi.1009821.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The linear potential energy Φ quantifies cell differentiation potency.</title>
          <p><bold>(a)</bold> Boxplot of the linear potential energies of cells sampled different time stages of the embryonic murine cerebral cortex development. <bold>(b)</bold> Trend in the addictive inverse of linear potential (circular points connected by black lines with y axis on left-hand side) and temporal score (triangle points connected by red lines with y axis on right-hand side) across cell types. <bold>(c)</bold> The linear potential energy <bold>Φ</bold> estimated by GraphFP. <bold>(d)</bold> The stationary probability distribution <bold><italic toggle="yes">p</italic></bold><sub><bold><italic toggle="yes">ss</italic></bold></sub> of the cell types.</p>
        </caption>
        <graphic xlink:href="pcbi.1009821.g003" position="float"/>
      </fig>
      <p>Next, we checked the linear potential energies of the cell types with their pseudo-time during cell development process. Tempora [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>] provided each cell type with a temporal score by adjusting its cell composition from each time point such that a cell type containing more cells from an early time point will have a lower score and vice versa. We therefore used the temporal scores as the pseudo-time for the 7 cell types. It is clearly demonstrated that the addictive inverse values of linear potential energy are strongly correlated with the temporal scores (<xref rid="pcbi.1009821.g003" ref-type="fig">Fig 3b</xref>, Pearson correlation coefficient = 0.91), further confirming that the linear potential energy well quantifies cell stemness.</p>
      <p>It is worth noting that the linear potential energy <bold>Φ</bold> (<xref rid="pcbi.1009821.g003" ref-type="fig">Fig 3c</xref>) is different from the stationary distribution <bold><italic toggle="yes">p</italic></bold><sub><bold><italic toggle="yes">ss</italic></bold></sub> of cell types (<xref rid="pcbi.1009821.g003" ref-type="fig">Fig 3d</xref>). The stationary distribution <bold><italic toggle="yes">p</italic></bold><sub><bold><italic toggle="yes">ss</italic></bold></sub>, which is the cell type frequencies or cell densities calculated using the merged data across all time points, is often used to construct the stationary energy landscape <bold><italic toggle="yes">U</italic></bold><sub><bold><italic toggle="yes">ss</italic></bold></sub> ≡ −log <bold><italic toggle="yes">p</italic></bold><sub><bold>ss</bold></sub> in scRNA-seq data analysis [<xref rid="pcbi.1009821.ref006" ref-type="bibr">6</xref>]. However, as pointed out by Shi <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>], the stationary energy landscape <bold><italic toggle="yes">U</italic></bold><sub><bold><italic toggle="yes">ss</italic></bold></sub> is the equilibrium potential induced by diffusion without birth and death. In some extent, the linear potential energy <bold>Φ</bold> by GraphFP is an analogy of the cell potential <italic toggle="yes">V</italic>(<italic toggle="yes">x</italic>) proposed by Shi <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>], which was taken as their quantification of cell differentiation potency.</p>
    </sec>
    <sec id="sec012">
      <title>GraphFP delineates cell-cell interactions</title>
      <p>We quantified the cell-cell interactions and intercellular communication during embryonic murine cerebral cortex development using the cell-cell interaction matrix <bold><italic toggle="yes">W</italic></bold> estimated by GraphFP. The <bold><italic toggle="yes">W</italic></bold> measures the cell-cell interaction strength between each pair of two cell types/states, one as the signalling sender and the other as the signalling receiver (see <xref rid="pcbi.1009821.e031" ref-type="disp-formula">Eq (9)</xref> and section <bold>“Reconstruction of cell developmental energy landscape and modelling of cell-cell interactions”</bold> in <bold>Methods</bold> for its biological interpretations).</p>
      <p>The estimated <bold><italic toggle="yes">W</italic></bold> is a sparse matrix with most elements having values equal or close to zero (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2d</xref>), indicating a majority of the pairs having no or weak interactions. For example, the cell types “5-APs/RPs” and “7-IPs” have no mutual interactions with <italic toggle="yes">w</italic><sub>57</sub> = 0 and <italic toggle="yes">w</italic><sub>75</sub> = −0.02 (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2d</xref>). Furthermore, the estimated cell-cell interaction strengths in the first row of <bold><italic toggle="yes">W</italic></bold> that corresponds to “5-APs/RPs” are zero or close to zero with |<italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>| ≤ 0.04, making the contributions from its interaction term in <xref rid="pcbi.1009821.e028" ref-type="disp-formula">Eq (8)</xref> negligible. As such, the dynamic potential energy Ψ<sub>5</sub>(<italic toggle="yes">t</italic>) is dominated by its linear potential energy (Φ<sub>5</sub>) with a resultant flattening potential energy curve (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2g</xref>).</p>
      <p>We also observed a number of strong cell-cell interactions with large <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>s deviating from zero. Cell states other than “5-APs/RPs” and “7-IPs” have at least one <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub> with strong interaction strength (e.g., |<italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>| &gt; 0.1), resulting in the deviation of their potential energies Ψ(<italic toggle="yes">t</italic>)s from their linear potential energies Φs largely driven by their interaction energies with sharpened potential energy curves (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2g</xref>).</p>
      <p>We further examined cell state pairs with strong interactions.
The pairs of “2-Young Neurons ← 1-Neurons” (<italic toggle="yes">w</italic><sub>21</sub> = 0.26), “6-Young Neurons ← 3-APs/RPs” (<italic toggle="yes">w</italic><sub>63</sub> = 0.14) and “4-IPs ← 1-Neurons” (<italic toggle="yes">w</italic><sub>41</sub> = 0.12) have the top 3 highest positive values of <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>s (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2d</xref>), indicating that the sender cell types (“1-Neurons”, “3-APs/RPs” and “1-Neurons”) pass strong inhibitory signalling to their corresponding receiver cell types (“2-Young Neurons”, “6-Young Neurons” and “4-IPs”, respectively). Their potential energy differences (|Δ<sub><italic toggle="yes">ij</italic></sub>|s) diverge with enlarging gaps as time evolves (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2h</xref>), resulting in that cells tend to transit in one direction from the cell state with higher potential energy to the cell state with lower potential energy, only rarely transiting in the reverse direction.
In particular, “2-Young Neurons” tends to transit to “1-Neurons”, “3-APs/RPs” tends to transit to “6-Young Neurons”, “4-IPs” tends to transit to “1-Neurons”. These results are consistent with our understanding of the cell development process depicted in <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2a</xref>.</p>
      <p>On the other hand, the pairs of “6-Young Neurons ← 1-Neurons” (<italic toggle="yes">w</italic><sub>61</sub> = −0.21), “4-IPs ← 3-APs/RPs” (<italic toggle="yes">w</italic><sub>43</sub> = −0.15) and “2-Young Neurons ← 4-IPs” (<italic toggle="yes">w</italic><sub>24</sub> = −0.14) have the top 3 lowest negative values of <italic toggle="yes">w</italic><sub><italic toggle="yes">ij</italic></sub>s, indicating that the sender cell types (“1-Neurons”, “3-APs/RPs” and “4-IPs”) pass strong stimulatory signalling to their receiver cell types (“6-Young Neurons”, “4-IPs” and “2-Young Neurons”, respectively).
In particular, the potential energy differences (|Δ<sub><italic toggle="yes">ij</italic></sub>|s) of the pair “6-Young Neurons: 1-Neurons” and the pair “3-APs/RPs: 4-IPs” converge with shrinking gaps as time evolves (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2i</xref>), making the transitions between the paired cell states approaching to equilibrium in both directions. This result is consistent with our probability flow (<xref rid="pcbi.1009821.g004" ref-type="fig">Fig 4</xref>), where the net probability flows from “6-Young Neurons” to “1-Neurons” as well as from “3-APs/RPs” to “4-IPs” gradually decrease over time. The potential energy difference between “4-IPs” and “2-Young Neurons” starts from a small value close to zero at time point E11.5, then gradually increases to its largest gap at E14, and then gradually declines to zero again at E17.5. This result indicates that the transition from “4-IPs” to “2-Young Neurons” mainly occurs at the intermediate time region from E13.5 to E15.5, which is consistent with our understanding that the “4-IPs” cells are the intermediate progenitors of cell development (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2a</xref>).</p>
      <fig position="float" id="pcbi.1009821.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>GraphFP charts the probability flows of cell state-transitions.</title>
          <p>The circle point represents cell type (point size is proportional to the cell-type frequency at each time point); the line between cell types represents probability flow from source cell type to target cell type (line width is proportional to the value of probability flow).</p>
        </caption>
        <graphic xlink:href="pcbi.1009821.g004" position="float"/>
      </fig>
      <p>Based on our calculation using GraphFP, we also confirmed that free energy (<xref rid="pcbi.1009821.e007" ref-type="disp-formula">Eq (1)</xref>) of the system decreased over time (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2f</xref>), which is consistent with accepted mathematical theory [<xref rid="pcbi.1009821.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>]. However, according to our calculation, free energy of the system did not converge to its minimum free energy state at time point E17.5 when the experiment ended (see the vertical dashed red line in <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2f</xref>). We predicted from <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2f</xref> that the system would reach its minimum free energy state after time point E30.</p>
    </sec>
    <sec id="sec013">
      <title>GraphFP faithfully charts the probability flows of cell state-transitions during cell development</title>
      <p>We next examined the ability of GraphFP to quantify the dynamics of cell state-transitions during embryonic murine cortical development by calculating the probability flows (<xref rid="pcbi.1009821.e034" ref-type="disp-formula">Eq (10)</xref>) between each time intervals of the adjacent time stages (<xref rid="pcbi.1009821.g004" ref-type="fig">Fig 4</xref>). In the early stage from E11.5 to E13.5, cells mainly transit from the early precursors of “3-APs/RPs” and “5-APs/RPs” to the intermediate progenitor “4-IPs” and the two neuron clusters of “2-Young Neurons” and “1-Neurons”. In the middle stage from E13.5 to E15.5, the intermediate progenitor “4-IPs” joins in with “3-APs/RPs” and “5-APs/RPs” as the major source clusters that transit to two neuron clusters, “2-Young Neurons” and “1-Neurons”. Meanwhile, as a source cluster, “2-Young Neurons” starts to transit to “1-Neurons”, and in the latter stage from E15.5 to E17.5, “4-IPs” takes a leading role in transiting to the neuron cluster of “1-Neurons” and young neuron clusters, “2-Young Neurons” and “6-Young Neurons”. Meanwhile, “2-Young Neurons” continues as one of the major source clusters transiting to “1-Neurons” (<xref rid="pcbi.1009821.g004" ref-type="fig">Fig 4</xref>). Compared with the gold standard trajectory shown in <xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2a</xref> by Tempora [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>], we identified a new path whereby the IP cells of cluster “4-IPs” transit to neuron cells of cluster “1-Neurons”, as confirmed by Yuzwa <italic toggle="yes">et al.</italic> [<xref rid="pcbi.1009821.ref026" ref-type="bibr">26</xref>], who reported that cortical RPs divide asymmetrically from E11.5 to E17.5 to generate neurons directly or indirectly via transit-amplifying cells of IPs.</p>
    </sec>
    <sec id="sec014">
      <title>Cell-cell interactions drive the stochastic and nonlinear dynamics of cell development</title>
      <p>GraphFP explicitly models cell-cell interactions with a nonlinear quadratic interaction term in the free energy (<xref rid="pcbi.1009821.e007" ref-type="disp-formula">Eq (1)</xref>). To account for cell-cell interactions, we evaluated GraphFP on its ability to fit the experimental data (<xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5a</xref>) and recover held-out time points (<xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5b–5d</xref>) with cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> ≠ <bold>0</bold>; solid lines in <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5</xref>) and without cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> = <bold>0</bold>; dashed lines in <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5</xref>). To evaluate the performance on estimation accuracy, we applied Kullback-Leibler divergence (KLD) to measure the difference between the estimated probability distribution with/without interaction term and true probability distribution at each time points (<xref rid="pcbi.1009821.t001" ref-type="table">Table 1</xref>). A lower KLD value is indicative of better performance.</p>
      <fig position="float" id="pcbi.1009821.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>GraphFP accurately quantifies the stochastic dynamics of the cell type frequencies by modelling cell-cell interactions.</title>
          <p>GraphFP calculated the stochastic dynamics of the cell type frequencies <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>) with cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> ≠ <bold>0</bold>; solid lines) and without cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> = <bold>0</bold>; dashed lines). Triangle points are the estimated cell type frequencies at each time point where red represents the input data point to GraphFP, while blue represents the held-out data point to GraphFP. <bold>(a)</bold> Using all 4 time points as input. <bold>(b)</bold> Held-out E13.5. <bold>(c)</bold> Held-out E15.5. <bold>(d)</bold> Held-out E13.5 and E15.5.</p>
        </caption>
        <graphic xlink:href="pcbi.1009821.g005" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1009821.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Evaluation of GraphFP’s performance on quantifying the stochastic dynamics of cell-type frequencies with cell-cell interaction term (<italic toggle="yes">W</italic> ≠ 0) and without cell-cell interaction term (<italic toggle="yes">W</italic> = 0) on the murine cerebral cortex dataset.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1009821.t001" id="pcbi.1009821.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">KLD</th>
                <th align="center" colspan="2" rowspan="1">With all time points</th>
                <th align="center" colspan="2" rowspan="1">Held out E13.5</th>
                <th align="center" colspan="2" rowspan="1">Held out E15.5</th>
                <th align="center" colspan="2" rowspan="1">Held out E13.5 and E15.5</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">with</th>
                <th align="center" rowspan="1" colspan="1">without</th>
                <th align="center" rowspan="1" colspan="1">with</th>
                <th align="center" rowspan="1" colspan="1">without</th>
                <th align="center" rowspan="1" colspan="1">with</th>
                <th align="center" rowspan="1" colspan="1">without</th>
                <th align="center" rowspan="1" colspan="1">with</th>
                <th align="center" rowspan="1" colspan="1">without</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">E13.5</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0007</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0101</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0340</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0217</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>7.0020e-05</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0377</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.0675</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.0900</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">E15.5</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0133</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0168</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0009</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0119</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.0372</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0518</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.1036</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.1130</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">E17.5</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0056</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0861</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0036</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0785</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>5.0603e-05</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0240</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>1.9569e-06</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">2.0707e-06</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>The Kullback-Leibler divergence (KLD) distance was used to measure the difference between the estimated probability distribution by GraphFP and true probability distribution at each time points (E13.5, E15.5, E17.5).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>First, we applied GraphFP to the embryonic murine cerebral cortex development scRNA-seq dataset using all 4 time points. Based on the estimated parameters <bold><italic toggle="yes">θ</italic></bold>*, we calculated the stochastic dynamics of the cell type frequencies <bold><italic toggle="yes">p</italic></bold>(<italic toggle="yes">t</italic>) on probability simplex in continuous time <italic toggle="yes">t</italic>(&gt; <italic toggle="yes">t</italic><sub>1</sub>) according to <xref rid="pcbi.1009821.e013" ref-type="disp-formula">Eq (2)</xref> with given initial point of <inline-formula id="pcbi.1009821.e036"><alternatives><graphic xlink:href="pcbi.1009821.e036.jpg" id="pcbi.1009821.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Overall, GraphFP with cell-cell interaction term outperforms GraphFP without cell-cell interaction term on the fitting of the nonlinear curves for the 7 clusters (<xref rid="pcbi.1009821.t001" ref-type="table">Table 1</xref>), especially for “2-Young Neurons”, “4-IPs” and “6-Young Neurons” (<xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5a</xref>).</p>
      <p>Next, we applied GraphFP to the scRNA-seq datasets of (i) one held-out time point E13.5 (<xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5b</xref>) and (ii) one held-out time point E15.5 (<xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5c</xref>), separately.
GraphFP with cell-cell interaction term always outperforms GraphFP without cell-cell interaction term on both nonlinear curve fitting and held-out time point recovering except for one comparison on Held out E13.5 dataset at time stage E13.5. (<xref rid="pcbi.1009821.t001" ref-type="table">Table 1</xref>).</p>
      <p>Finally, we applied GraphFP to the scRNA-seq data set of two held-out time points, E13.5 and E15.5 (<xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5d</xref>). It is not surprising that both models drop their accuracies markedly on recovering the held-out time points.
In addition, the results by GraphFP with cell-cell interaction term still outperform those by GraphFP without cell-cell interaction term (<xref rid="pcbi.1009821.t001" ref-type="table">Table 1</xref> and <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5d</xref>).</p>
      <p>As shown in <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5</xref>, our results illustrate that the stochastic and nonlinear dynamics of cell development are not merely determined by the linear potential energies Φs, but also driven by nonlinear cell-cell interactions. Specifically, the evolving probability frequencies of cell types can be nonmonotonic (e.g., “2-Young Neurons”, “4-IPs”, “6-Young Neurons” in <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5</xref>).
Meanwhile, time series scRNA-seq data with cells profiled at more time points will provide more temporal information to recover the biologically complex dynamic processes.</p>
    </sec>
    <sec id="sec015">
      <title>GraphFP is robust to input data</title>
      <p>As also shown in <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5a–5c</xref>, our results illustrate that GraphFP robustly recovers the stochastic and nonlinear dynamics of cell development by using all datasets or datasets with one held-out time point.</p>
      <p>Since GraphFP works on cells with cluster labels or cell type annotations, we then examined whether GraphFP is sufficiently robust to account for the uncertainty presented in the clustering or annotation methods. In the above sections, we have illustrated the outputs of GraphFP based on the labelling of 7 clusters with a fine resolution provided by Tempora [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>]. Here, we further grouped the cells into 4 clusters with a coarse resolution as follows: “A-Neurons” constituted by cells from “1-Neurons”; “B-Young Neurons” constituted by cells from “2-Young Neurons” and “6-Young Neurons”; “C-APs/RPs” constituted by cells from “3-APs/RPs” and “5-APs/RPs”; and “D-IPs” constituted by cells from “4-IPs” and “7-IPs”. We compared the results of GraphFP based on the labelling of 7 cell types and the labelling of 4 cell types (<xref rid="pcbi.1009821.g006" ref-type="fig">Fig 6</xref>). To make the results comparable, we aggregated the results based on the labelling of 7 cell types by averaging the results from i) “3-APs/RPs” and “5-APs/RPs”, ii) “2-Young Neurons” and “6-Young Neurons” and iii) “4-IPs” and “7-IPs”, separately, resulting in the same dimensions as those based on the labelling of 4 cell types. It should be noted that the results based on 4 cell types and the aggregated results based on 7 cell types are consistent with similar patterns of linear energies <bold>Φ</bold>s (<xref rid="pcbi.1009821.g006" ref-type="fig">Fig 6a and 6d</xref>), interaction matrices <bold><italic toggle="yes">W</italic></bold>s (<xref rid="pcbi.1009821.g006" ref-type="fig">Fig 6b and 6e</xref>), and probability flows (<xref rid="pcbi.1009821.g006" ref-type="fig">Fig 6c and 6f</xref>). In addition, GraphFP is robust to the hyper-parameter choices in wide ranges.</p>
      <fig position="float" id="pcbi.1009821.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009821.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>GraphFP is robust to uncertainty presented in cell type labels.</title>
          <p>GraphFP was applied to the murine cerebral cortex dataset based on the labelling of 4 cell types with a coarse resolution (<bold>a-c</bold>) and the labelling of 7 cell types with a fine resolution (<bold>d-f</bold>), separately. The estimated <bold>Φ</bold> (<bold>a</bold>), <bold><italic toggle="yes">W</italic></bold> (<bold>b</bold>) and charted probability flow (<bold>c</bold>) by GraphFP based on the labelling of 4 clusters (“A-Neurons”, “B-Young Neuron”, “C-APs/RPs”, “D-IPs”). Aggregated results of the estimated <bold>Φ</bold> (<bold>d</bold>), <bold><italic toggle="yes">W</italic></bold> (<bold>e</bold>) and charted probability flow (<bold>f</bold>) by GraphFP based on the labelling of 7 clusters, averaging the results from i) “3-APs/RPs” and “5-APs/RPs”, ii) “2-Young Neurons” and “6-Young Neurons” and iii) “4-IPs” and “7-IPs”, separately, resulting in the same dimensions as those based on the labelling of 4 cell types.</p>
        </caption>
        <graphic xlink:href="pcbi.1009821.g006" position="float"/>
      </fig>
    </sec>
    <sec id="sec016">
      <title>The computational cost of GraphFP</title>
      <p>We examined the impact of the number of cell types (<italic toggle="yes">n</italic>) on the computational cost of GraphFP. When working on the murine cerebral cortex dataset with 7 cell types (n = 7) and 4 time stages, the runtime of GraphFP was around 3 minutes for each task on a personal laptop (MacBook Pro with CUP 2.4 GHz Intel Core i5 and Memory 8 GB 2133 MHz LPDDR3) (<xref rid="pcbi.1009821.s003" ref-type="supplementary-material">S1 Table</xref>). In our implementation, we set λ<sub><italic toggle="yes">l</italic></sub> = 1000(<italic toggle="yes">l</italic> ∈ 2, 3, 4), <italic toggle="yes">β</italic> = 0.001, the learning rate as <italic toggle="yes">α</italic> = 0.01/λ<sub><italic toggle="yes">l</italic></sub> and <italic toggle="yes">Integral_step</italic> as 0.1.</p>
      <p>We next examined GraphFP on another time series scRNA-seq dataset of the mouse spinal cord injury healing process provided by [<xref rid="pcbi.1009821.ref032" ref-type="bibr">32</xref>] (see the detailed results in <xref rid="pcbi.1009821.s002" ref-type="supplementary-material">S2 Text</xref>). The new dataset contains 13 clusters (cell types) and 4 time points. We applied GraphFP to this dataset on the same computer with the same hyper-parameter settings as those for the murine cerebral cortex dataset. GraphFP still achieved accurate and robust reconstruction of cell state-transition energy landscape on this dataset (<xref rid="pcbi.1009821.s002" ref-type="supplementary-material">S2 Text</xref>), and also achieved a reasonable performance on computational speed: the runtime for each task was around 9 minutes (<xref rid="pcbi.1009821.s004" ref-type="supplementary-material">S2 Table</xref>).</p>
      <p>Based on the above experiments, we found that the computational speed of GraphFP is sustainable for tasks with moderate number of cell types. Meanwhile, the computation of GraphFP might be problematic for large <italic toggle="yes">n</italic> (e.g., <italic toggle="yes">n</italic> &gt; 100) at current settings. As we applied the complete cell state-transition graph, the degree of freedom (e.g., the parameters of the cell-cell interaction matrix <bold><italic toggle="yes">W</italic></bold>) will grow in the order of <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic><sup>2</sup>), making the computation difficult. However, this problem is solvable. One way to solve this problem is to take advantage of the sparse structure of the cell-cell interaction matrix <bold><italic toggle="yes">W</italic></bold>. As we have already noted, the estimated <bold><italic toggle="yes">W</italic></bold>s of both the murine cerebral cortex dataset (<xref rid="pcbi.1009821.g002" ref-type="fig">Fig 2d</xref>) and the mouse spinal cord injury dataset (Fig A(b) in <xref rid="pcbi.1009821.s002" ref-type="supplementary-material">S2 Text</xref>) are sparse. Therefore, we can solve this problem by adding a L1 regularization term of the matrix <bold><italic toggle="yes">W</italic></bold> to the loss function to enforce <bold><italic toggle="yes">W</italic></bold> to be sparse. We plan to pursue this topic in our future work.</p>
      <p>On the other hand, in practice, for large number of cell types, we can trade off the estimation accuracy and the information of cell-cell interactions for runtime performance. GraphFP without the cell-cell interaction term will be efficient for large number of cell types since the degree of freedom (e.g., the parameters of linear potential energy <bold>Φ</bold>) will grow in the order of <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic>). For example, the runtimes of GraphFP without cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> = 0) for both the murine cerebral cortex dataset (<xref rid="pcbi.1009821.s003" ref-type="supplementary-material">S1 Table</xref>) and the mouse spinal cord injury dataset (<xref rid="pcbi.1009821.s004" ref-type="supplementary-material">S2 Table</xref>) are all less than 20 seconds.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Discussion</title>
    <p>Modelling of cell development has long been a key goal of systems biology.
The Waddington landscape is a classic metaphor for describing cell development. Mathematical framework of cell developmental energy landscape has been developed to study the dynamics of cell state-transitions from gene regulatory network (GRN) based perspective (e.g., [<xref rid="pcbi.1009821.ref033" ref-type="bibr">33</xref>–<xref rid="pcbi.1009821.ref036" ref-type="bibr">36</xref>]) and state manifold based perspective (e.g., [<xref rid="pcbi.1009821.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1009821.ref037" ref-type="bibr">37</xref>, <xref rid="pcbi.1009821.ref038" ref-type="bibr">38</xref>]) (see [<xref rid="pcbi.1009821.ref018" ref-type="bibr">18</xref>] for a recent review of the two approaches). Traditional GRN-based landscape can be hindered by the computational issue raised by high-dimensional GRNs. Recently, a model-based dimension reduction approach of the landscape (DRL) was proposed to construct a low-dimensional energy landscape of high-dimensional GRNs [<xref rid="pcbi.1009821.ref036" ref-type="bibr">36</xref>], which overcomes the limitations of traditional methods. Although great success has been achieved, the GRN-based landscape depends on prior biological knowledge of the underlying GRN. When the information of GRNs is unavailable or not complete, the state manifold based landscape will be constructed, especially for scRNA-seq data analysis. The state manifold based methods model the cell development with stochastic Markov process and/or drift-diffusion PDE, where cell states (e.g., cell types and cell clusters) represent the local attractors of the underlying dynamic systems [<xref rid="pcbi.1009821.ref018" ref-type="bibr">18</xref>].</p>
    <p>In this study, we propose GraphFP, a state manifold based computational framework, to reconstruct the complex potential energy landscape and infer the stochastic dynamics of cell state-transition during cell development. GraphFP models cell development based on the diffusion process in a discrete spectrum of states [<xref rid="pcbi.1009821.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>]. It can be viewed from the lens of dynamic optimal transport on networks as solving an optimal control problem to minimize the kinetic energy of flow between adjacent time points [<xref rid="pcbi.1009821.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1009821.ref039" ref-type="bibr">39</xref>]. The FPE of GraphFP can be characterized as a gradient flow of free energy when the probability simplex of discrete states is equipped with the discrete <italic toggle="yes">L</italic><sub>2</sub>-Wasserstein metric defined on the graphs [<xref rid="pcbi.1009821.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1009821.ref021" ref-type="bibr">21</xref>]. Beyond its clear theoretical importance, GraphFP has enabled critical insight into nonlinear dynamic cell state-transition, as well as cell-cell interactions during cell development. We demonstrated that the cell-cell interaction part of GraphFP plays a key role in capturing the stochastic dynamic of the cell-type frequencies on both the murine cerebral cortex dataset (<xref rid="pcbi.1009821.t001" ref-type="table">Table 1</xref> and <xref rid="pcbi.1009821.g005" ref-type="fig">Fig 5</xref>) and the mouse spinal cord injury dataset (<xref rid="pcbi.1009821.s002" ref-type="supplementary-material">S2 Text</xref>).</p>
    <p>GraphFP has the following strengths over existing methods. First, GraphFP models the dynamics of cell clusters (e.g., cell states and cell types) on a discrete state space. In contrast, methods, such as Waddington-OT [<xref rid="pcbi.1009821.ref015" ref-type="bibr">15</xref>], TrajectoryNet [<xref rid="pcbi.1009821.ref016" ref-type="bibr">16</xref>] and PRESCIENT [<xref rid="pcbi.1009821.ref017" ref-type="bibr">17</xref>], modelled the dynamics of individual cells with drift-diffusion equations on a continuous state space. With the dramatic increase in amount and size of scRNA-seq data, the cluster-based approaches, which work on a relatively small number of clusters that usually represent annotated cell types, warrant both scalability to large-scale scRNA-seq data and ease of biological interpretability [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>].</p>
    <p>Second, GraphFP is built on a nonlinear model that explicitly takes into account cell-cell interactions in free energy. The current computational methods for inferring cell-cell interactions from single-cell data are mainly based on machine learning or statistics, relying heavily on the domain knowledge as learning materials [<xref rid="pcbi.1009821.ref022" ref-type="bibr">22</xref>, <xref rid="pcbi.1009821.ref023" ref-type="bibr">23</xref>]. On the other hand, GraphFP provides an alternative and model-based approach to decipher cell-cell interactions that drive cell development. In contrast, the underlying models of both Waddington-OT [<xref rid="pcbi.1009821.ref015" ref-type="bibr">15</xref>] and PRESCIENT [<xref rid="pcbi.1009821.ref017" ref-type="bibr">17</xref>] are only able to characterize cell state-transition on the static potential energy landscape driven by random noises, failing to account for cell-cell interactions. Although able to reconstruct nonlinear development landscape, TrajectoryNet was based on the neural network framework without explicit system models, thus lacking biological interpretability.</p>
    <p>Nonetheless, some aspects still need to be improved. Firstly, the current GraphFP does not account for cell proliferation during cell development, which may result in that probability masses are not conservative over time. We can solve this problem by adopting the unbalanced optimal transport framework that has been used by Waddington-OT [<xref rid="pcbi.1009821.ref015" ref-type="bibr">15</xref>] and TrajectoryNet [<xref rid="pcbi.1009821.ref016" ref-type="bibr">16</xref>] to quantify cell proliferation. Secondly, as the existing time series scRNA-seq methods such as Waddington-OT [<xref rid="pcbi.1009821.ref015" ref-type="bibr">15</xref>] and Tempora [<xref rid="pcbi.1009821.ref012" ref-type="bibr">12</xref>], the current GraphFP works in an off-line fashion such that the cell clustering and annotation are performed on the entire data by merging cells from all time points together. This approach offers an unbiased, comprehensive and quantitative definition of discrete cell types. However, with the emerging large-scale scRNA-seq data, it may be computationally cumbersome to cluster the massive and continually arriving scRNA-seq datasets as a whole. Therefore, developing an on-line framework of GraphFP that can cluster and annotate the single-cell time series scRNA-seq data in different batches in a serial fashion should be an interesting topic. The newly developed single-cell data analysis tools such as the on-line integration method online iNMF [<xref rid="pcbi.1009821.ref040" ref-type="bibr">40</xref>] and the cell type annotation method scArches based on transfer learning [<xref rid="pcbi.1009821.ref041" ref-type="bibr">41</xref>] can be adopted.</p>
  </sec>
  <sec id="sec018" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009821.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Details for the parameter estimation of GraphFP.</title>
        <p>This document provides detailed description of the parameter estimation and pseudocode for the GrapFP algorithm.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009821.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009821.s002" position="float" content-type="local-data">
      <label>S2 Text</label>
      <caption>
        <title>Application of GraphFP to the mouse spinal cord injury dataset.</title>
        <p>Fig A. GraphFP reconstructs the cell state-transition energy landscape on the mouse spinal cord injury scRNA-seq dataset. Fig B. The linear potential energy <bold>Φ</bold> quantifies cell differentiation potency. Table A. Evaluation of GraphFP’s performance on quantifying the stochastic dynamics of cell type frequencies with cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> ≠ <bold>0</bold>) and without cell-cell interaction term (<bold><italic toggle="yes">W</italic></bold> = <bold>0</bold>) on the mouse spinal cord injury dataset.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009821.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009821.s003" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Runtimes of GraphFP on the murine cerebral cortex dataset.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1009821.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009821.s004" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Runtimes of GraphFP on the mouse spinal cord injury dataset.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1009821.s004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009821.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Tanay</surname><given-names>A</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name>. <article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>. <source>Nature</source>. <year>2017</year>;<volume>541</volume>(<issue>7637</issue>):<fpage>331</fpage>–<lpage>338</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature21350</pub-id><?supplied-pmid 28102262?><pub-id pub-id-type="pmid">28102262</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Saelens</surname><given-names>W</given-names></name>, <name><surname>Cannoodt</surname><given-names>R</given-names></name>, <name><surname>Todorov</surname><given-names>H</given-names></name>, <name><surname>Saeys</surname><given-names>Y</given-names></name>. <article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nature Biotechnology</source>. <year>2019</year>;<volume>37</volume>(<issue>5</issue>):<fpage>547</fpage>–<lpage>554</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id><?supplied-pmid 30936559?><pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Jin</surname><given-names>S</given-names></name>, <name><surname>MacLean</surname><given-names>AL</given-names></name>, <name><surname>Peng</surname><given-names>T</given-names></name>, <name><surname>Nie</surname><given-names>Q</given-names></name>. <article-title>scEpath: energy landscape-based inference of transition probabilities and cellular trajectories from single-cell transcriptomic data</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>12</issue>):<fpage>2077</fpage>–<lpage>2086</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty058</pub-id><?supplied-pmid 29415263?><pub-id pub-id-type="pmid">29415263</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Teschendorff</surname><given-names>AE</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>T</given-names></name>. <article-title>Quantifying Waddington’s epigenetic landscape: a comparison of single-cell potency measures</article-title>. <source>Briefings in Bioinformatics</source>. <year>2018</year>;<volume>21</volume>(<issue>1</issue>):<fpage>248</fpage>–<lpage>261</lpage>. <?supplied-pmid 30289442?><pub-id pub-id-type="pmid">30289442</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>, <name><surname>Aihara</surname><given-names>K</given-names></name>. <article-title>Quantifying pluripotency landscape of cell differentiation from scRNA-seq data by continuous birth-death process</article-title>. <source>PLOS Computational Biology</source>. <year>2019</year>;<volume>15</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007488</pub-id><?supplied-pmid 31721764?><pub-id pub-id-type="pmid">31721764</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>An</surname><given-names>S</given-names></name>, <name><surname>Bai</surname><given-names>X</given-names></name>, <name><surname>Gong</surname><given-names>F</given-names></name>, <name><surname>Ma</surname><given-names>L</given-names></name>, <name><surname>Wan</surname><given-names>L</given-names></name>. <article-title>DensityPath: an algorithm to visualize and reconstruct cell state-transition path on density landscape for single-cell RNA sequencing data</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>15</issue>):<fpage>2593</fpage>–<lpage>2601</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty1009</pub-id><?supplied-pmid 30535348?><pub-id pub-id-type="pmid">30535348</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Weinreb</surname><given-names>C</given-names></name>, <name><surname>Wolock</surname><given-names>S</given-names></name>, <name><surname>Tusi</surname><given-names>BK</given-names></name>, <name><surname>Socolovsky</surname><given-names>M</given-names></name>, <name><surname>Klein</surname><given-names>AM</given-names></name>. <article-title>Fundamental limits on dynamic inference from single-cell snapshots</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2018</year>;<volume>115</volume>(<issue>10</issue>):<fpage>E2467</fpage>–<lpage>E2476</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1714723115</pub-id><?supplied-pmid 29463712?><pub-id pub-id-type="pmid">29463712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Rashid</surname><given-names>S</given-names></name>, <name><surname>Kotton</surname><given-names>DN</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>TASIC: determining branching models from time series single cell data</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>16</issue>):<fpage>2504</fpage>–<lpage>2512</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx173</pub-id><?supplied-pmid 28379537?><pub-id pub-id-type="pmid">28379537</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>C</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>Continuous-state HMMs for modeling time-series single-cell RNA-Seq data</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>22</issue>):<fpage>4707</fpage>–<lpage>4715</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz296</pub-id><?supplied-pmid 31038684?><pub-id pub-id-type="pmid">31038684</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>An</surname><given-names>S</given-names></name>, <name><surname>Ma</surname><given-names>L</given-names></name>, <name><surname>Wan</surname><given-names>L</given-names></name>. <article-title>TSEE: an elastic embedding method to visualize the dynamic gene expression patterns of time series single-cell RNA sequencing data</article-title>. <source>BMC Genomics</source>. <year>2019</year>;<volume>20</volume>(<issue>2</issue>):<fpage>224</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-019-5477-8</pub-id><?supplied-pmid 30967106?><pub-id pub-id-type="pmid">30967106</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>X</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>X</given-names></name>. <article-title>scPADGRN: A preconditioned ADMM approach for reconstructing dynamic gene regulatory network using single-cell RNA sequencing data</article-title>. <source>PLOS Computational Biology</source>. <year>2020</year>;<volume>16</volume>(<issue>7</issue>):<fpage>e1007471</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007471</pub-id><?supplied-pmid 32716923?><pub-id pub-id-type="pmid">32716923</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Tran</surname><given-names>TN</given-names></name>, <name><surname>Bader</surname><given-names>GD</given-names></name>. <article-title>Tempora: Cell trajectory inference using time-series single-cell RNA sequencing data</article-title>. <source>PLOS Computational Biology</source>. <year>2020</year>;<volume>16</volume>(<issue>9</issue>):<fpage>e1008205</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008205</pub-id><?supplied-pmid 32903255?><pub-id pub-id-type="pmid">32903255</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Peyré</surname><given-names>G</given-names></name>, <name><surname>Cuturi</surname><given-names>M</given-names></name>. <article-title>Computational Optimal Transport: With Applications to Data Science</article-title>. <source>Foundations and Trends in Machine Learning</source>. <year>2019</year>;<volume>11</volume>(<issue>5-6</issue>):<fpage>355</fpage>–<lpage>607</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1561/2200000073</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>H</given-names></name>. <article-title>Optimal Transport on Networks</article-title>. <source>IEEE Control Systems Magazine</source>. <year>2021</year>;<volume>41</volume>(<issue>4</issue>):<fpage>70</fpage>–<lpage>81</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/MCS.2021.3076541</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Schiebinger</surname><given-names>G</given-names></name>, <name><surname>Shu</surname><given-names>J</given-names></name>, <name><surname>Tabaka</surname><given-names>M</given-names></name>, <name><surname>Cleary</surname><given-names>B</given-names></name>, <name><surname>Subramanian</surname><given-names>V</given-names></name>, <name><surname>Solomon</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Optimal-Transport Analysis of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>4</issue>):<fpage>928</fpage>–<lpage>943.e22</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.01.006</pub-id><?supplied-pmid 30712874?><pub-id pub-id-type="pmid">30712874</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref016">
      <label>16</label>
      <mixed-citation publication-type="other">Tong A, Huang J, Wolf G, Van Dijk D, Krishnaswamy S. TrajectoryNet: A Dynamic Optimal Transport Network for Modeling Cellular Dynamics. In: III HD, Singh A, editors. Proceedings of the 37th International Conference on Machine Learning. vol. 119 of Proceedings of Machine Learning Research. Virtual: PMLR; 2020. p. 9526–9536.</mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Yeo</surname><given-names>GHT</given-names></name>, <name><surname>Saksena</surname><given-names>SD</given-names></name>, <name><surname>Gifford</surname><given-names>DK</given-names></name>. <article-title>Generative modeling of single-cell time series with PRESCIENT enables prediction of cell trajectories with interventions</article-title>. <source>Nature Communications</source>. <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>3222</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-021-23518-w</pub-id><?supplied-pmid 34050150?><pub-id pub-id-type="pmid">34050150</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Teschendorff</surname><given-names>AE</given-names></name>, <name><surname>Feinberg</surname><given-names>AP</given-names></name>. <article-title>Statistical mechanics meets single-cell biology</article-title>. <source>Nature Reviews Genetics</source>. <year>2021</year>;<volume>22</volume>(<issue>7</issue>):<fpage>459</fpage>–<lpage>476</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41576-021-00341-z</pub-id><?supplied-pmid 33875884?><pub-id pub-id-type="pmid">33875884</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Chow</surname><given-names>SN</given-names></name>, <name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Zhou</surname><given-names>H</given-names></name>. <article-title>Fokker-Planck Equations for a Free Energy Functional or Markov Process on a Graph</article-title>. <source>Archive for Rational Mechanics and Analysis</source>. <year>2012</year>;<volume>203</volume>(<issue>3</issue>):<fpage>969</fpage>–<lpage>1008</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00205-011-0471-6</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Chow</surname><given-names>SN</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Zhou</surname><given-names>H</given-names></name>. <article-title>Entropy dissipation of Fokker-Planck equations on graphs</article-title>. <source>Discrete &amp; Continuous Dynamical Systems—A</source>. <year>2018</year>;<volume>38</volume>(<issue>10</issue>):<fpage>4929</fpage>–<lpage>4950</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3934/dcds.2018215</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref021">
      <label>21</label>
      <mixed-citation publication-type="other">Li W. A study of stochastic differential equations and Fokker-Planck equations with applications. Georgia Institute of Technology; 2016. Available from: <ext-link xlink:href="http://hdl.handle.net/1853/54999" ext-link-type="uri">http://hdl.handle.net/1853/54999</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Armingol</surname><given-names>E</given-names></name>, <name><surname>Officer</surname><given-names>A</given-names></name>, <name><surname>Harismendy</surname><given-names>O</given-names></name>, <name><surname>Lewis</surname><given-names>NE</given-names></name>. <article-title>Deciphering cell–cell interactions and communication from gene expression</article-title>. <source>Nature Reviews Genetics</source>. <year>2021</year>;<volume>22</volume>(<issue>2</issue>):<fpage>71</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41576-020-00292-x</pub-id><?supplied-pmid 33168968?><pub-id pub-id-type="pmid">33168968</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Jin</surname><given-names>S</given-names></name>, <name><surname>Guerrero-Juarez</surname><given-names>CF</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Chang</surname><given-names>I</given-names></name>, <name><surname>Ramos</surname><given-names>R</given-names></name>, <name><surname>Kuan</surname><given-names>CH</given-names></name>, <etal>et al</etal>. <article-title>Inference and analysis of cell-cell communication using CellChat</article-title>. <source>Nature Communications</source>. <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1088</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-021-21246-9</pub-id><?supplied-pmid 33597522?><pub-id pub-id-type="pmid">33597522</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref024">
      <label>24</label>
      <mixed-citation publication-type="book"><name><surname>Bryson</surname><given-names>AE</given-names></name>, <name><surname>Ho</surname><given-names>Y</given-names></name>. <source>Applied Optimal Control: Optimization, Estimation and Control</source>. <publisher-name>CRC Press</publisher-name>; <year>1975</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref025">
      <label>25</label>
      <mixed-citation publication-type="book"><name><surname>Chen</surname><given-names>RTQ</given-names></name>, <name><surname>Rubanova</surname><given-names>Y</given-names></name>, <name><surname>Bettencourt</surname><given-names>J</given-names></name>, <name><surname>Duvenaud</surname><given-names>DK</given-names></name>. <part-title>Neural Ordinary Differential Equations</part-title>. In: <name><surname>Bengio</surname><given-names>S</given-names></name>, <name><surname>Wallach</surname><given-names>H</given-names></name>, <name><surname>Larochelle</surname><given-names>H</given-names></name>, <name><surname>Grauman</surname><given-names>K</given-names></name>, <name><surname>Cesa-Bianchi</surname><given-names>N</given-names></name>, <name><surname>Garnett</surname><given-names>R</given-names></name>, editors. <source>Advances in Neural Information Processing Systems</source>. <volume>vol. 31</volume>. <publisher-name>Curran Associates, Inc.</publisher-name>; <year>2018</year>. p. <fpage>6571</fpage>–<lpage>6583</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Yuzwa</surname><given-names>SA</given-names></name>, <name><surname>Borrett</surname><given-names>MJ</given-names></name>, <name><surname>Innes</surname><given-names>BT</given-names></name>, <name><surname>Voronova</surname><given-names>A</given-names></name>, <name><surname>Ketela</surname><given-names>T</given-names></name>, <name><surname>Kaplan</surname><given-names>DR</given-names></name>, <etal>et al</etal>. <article-title>Developmental Emergence of Adult Neural Stem Cells as Revealed by Single-Cell Transcriptional Profiling</article-title>. <source>Cell Reports</source>. <year>2017</year>;<volume>21</volume>(<issue>13</issue>):<fpage>3970</fpage>–<lpage>3986</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2017.12.017</pub-id><?supplied-pmid 29281841?><pub-id pub-id-type="pmid">29281841</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Blondel</surname><given-names>VD</given-names></name>, <name><surname>Guillaume</surname><given-names>JL</given-names></name>, <name><surname>Lambiotte</surname><given-names>R</given-names></name>, <name><surname>Lefebvre</surname><given-names>E</given-names></name>. <article-title>Fast unfolding of communities in large networks</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>. <year>2008</year>;<volume>2008</volume>(<issue>10</issue>):<fpage>P10008</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Stuart</surname><given-names>T</given-names></name>, <name><surname>Butler</surname><given-names>A</given-names></name>, <name><surname>Hoffman</surname><given-names>P</given-names></name>, <name><surname>Hafemeister</surname><given-names>C</given-names></name>, <name><surname>Papalexi</surname><given-names>E</given-names></name>, <name><surname>Mauck</surname><given-names>WM</given-names><suffix>III</suffix></name>, <etal>et al</etal>. <article-title>Comprehensive Integration of Single-Cell Data</article-title>. <source>Cell</source>. <year>2019</year>;<volume>177</volume>(<issue>7</issue>):<fpage>1888</fpage>–<lpage>1902.e21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><?supplied-pmid 31178118?><pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Q</given-names></name>, <name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Jiang</surname><given-names>R</given-names></name>, <name><surname>Wong</surname><given-names>WH</given-names></name>. <article-title>Simultaneous deep generative modelling and clustering of single-cell genomic data</article-title>. <source>Nature Machine Intelligence</source>. <year>2021</year>;<volume>3</volume>(<issue>6</issue>):<fpage>536</fpage>–<lpage>544</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s42256-021-00333-y</pub-id><?supplied-pmid 34179690?><pub-id pub-id-type="pmid">34179690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Kirouac</surname><given-names>DC</given-names></name>, <name><surname>Ito</surname><given-names>C</given-names></name>, <name><surname>Csaszar</surname><given-names>E</given-names></name>, <name><surname>Roch</surname><given-names>A</given-names></name>, <name><surname>Yu</surname><given-names>M</given-names></name>, <name><surname>Sykes</surname><given-names>EA</given-names></name>, <etal>et al</etal>. <article-title>Dynamic interaction networks in a hierarchically organized tissue</article-title>. <source>Molecular Systems Biology</source>. <year>2010</year>;<volume>6</volume>(<issue>1</issue>):<fpage>417</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/msb.2010.71</pub-id><?supplied-pmid 20924352?><pub-id pub-id-type="pmid">20924352</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Kharchenko</surname><given-names>PV</given-names></name>. <article-title>The triumphs and limitations of computational methods for scRNA-seq</article-title>. <source>Nature Methods</source>. <year>2021</year>;<volume>18</volume>(<issue>7</issue>):<fpage>723</fpage>–<lpage>732</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-021-01223-2</pub-id><?supplied-pmid 34155396?><pub-id pub-id-type="pmid">34155396</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Milich</surname><given-names>LM</given-names></name>, <name><surname>Choi</surname><given-names>JS</given-names></name>, <name><surname>Ryan</surname><given-names>C</given-names></name>, <name><surname>Cerqueira</surname><given-names>SR</given-names></name>, <name><surname>Benavides</surname><given-names>S</given-names></name>, <name><surname>Yahn</surname><given-names>SL</given-names></name>, <etal>et al</etal>. <article-title>Single-cell analysis of the cellular heterogeneity and interactions in the injured mouse spinal cord</article-title>. <source>Journal of Experimental Medicine</source>. <year>2021</year>;<volume>218</volume>(<issue>8</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1084/jem.20210040</pub-id><?supplied-pmid 34132743?><pub-id pub-id-type="pmid">34132743</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>, <name><surname>Wang</surname><given-names>E</given-names></name>. <article-title>Quantifying the Waddington landscape and biological paths for development and differentiation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>20</issue>):<fpage>8257</fpage>–<lpage>8262</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1017017108</pub-id><?supplied-pmid 21536909?><pub-id pub-id-type="pmid">21536909</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>. <article-title>Quantifying Cell Fate Decisions for Differentiation and Reprogramming of a Human Stem Cell Network: Landscape and Biological Paths</article-title>. <source>PLOS Computational Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e1003165</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003165</pub-id><?supplied-pmid 23935477?><pub-id pub-id-type="pmid">23935477</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Lang</surname><given-names>J</given-names></name>, <name><surname>Nie</surname><given-names>Q</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>. <article-title>Landscape and kinetic path quantify critical transitions in epithelial-mesenchymal transition</article-title>. <source>Biophysical Journal</source>. <year>2021</year>;<volume>120</volume>(<issue>20</issue>):<fpage>4484</fpage>–<lpage>4500</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.bpj.2021.08.043</pub-id><?supplied-pmid 34480928?><pub-id pub-id-type="pmid">34480928</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>. <article-title>A Dimension Reduction Approach for Energy Landscape: Identifying Intermediate States in Metabolism-EMT Network</article-title>. <source>Advanced Science</source>. <year>2021</year>;<volume>8</volume>(<issue>10</issue>):<fpage>2003133</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/advs.202003133</pub-id><?supplied-pmid 34026435?><pub-id pub-id-type="pmid">34026435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>P</given-names></name>, <name><surname>Li</surname><given-names>T</given-names></name>. <article-title>Construction of the landscape for multi-stable systems: Potential landscape, quasi-potential, A-type integral and beyond</article-title>. <source>The Journal of Chemical Physics</source>. <year>2016</year>;<volume>144</volume>(<issue>9</issue>):<fpage>094109</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1063/1.4943096</pub-id><?supplied-pmid 26957159?><pub-id pub-id-type="pmid">26957159</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>T</given-names></name>, <name><surname>Nie</surname><given-names>Q</given-names></name>. <article-title>Dissecting transition cells from single-cell transcriptome data through multiscale stochastic dynamics</article-title>. <source>Nature Communications</source>. <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>5609</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-021-25548-w</pub-id><?supplied-pmid 34556644?><pub-id pub-id-type="pmid">34556644</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Jordan</surname><given-names>R</given-names></name>, <name><surname>Kinderlehrer</surname><given-names>D</given-names></name>, <name><surname>Otto</surname><given-names>F</given-names></name>. <article-title>The Variational Formulation of the Fokker–Planck Equation</article-title>. <source>SIAM Journal on Mathematical Analysis</source>. <year>1998</year>;<volume>29</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/S0036141096303359</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Gao</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Kriebel</surname><given-names>AR</given-names></name>, <name><surname>Preissl</surname><given-names>S</given-names></name>, <name><surname>Luo</surname><given-names>C</given-names></name>, <name><surname>Castanon</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Iterative single-cell multi-omic integration using online learning</article-title>. <source>Nature Biotechnology</source>. <year>2021</year>;<volume>39</volume>(<issue>8</issue>):<fpage>1000</fpage>–<lpage>1007</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-021-00867-x</pub-id><?supplied-pmid 33875866?><pub-id pub-id-type="pmid">33875866</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009821.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Lotfollahi</surname><given-names>M</given-names></name>, <name><surname>Naghipourfar</surname><given-names>M</given-names></name>, <name><surname>Luecken</surname><given-names>MD</given-names></name>, <name><surname>Khajavi</surname><given-names>M</given-names></name>, <name><surname>Büttner</surname><given-names>M</given-names></name>, <name><surname>Wagenstetter</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Mapping single-cell data to reference atlases by transfer learning</article-title>. <source>Nature Biotechnology</source>. <year>2021</year>. <?supplied-pmid 34462589?><pub-id pub-id-type="pmid">34462589</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009821.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Lauffenburger, Nie</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Lauffenburger, Nie</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009821" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Sep 2021</named-content>
    </p>
    <p>Dear Dr. Wan,</p>
    <p>Thank you very much for submitting your manuscript "Dynamic inference of cell developmental complex energy landscape from time series single-cell transcriptomic data" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Qing Nie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Douglas Lauffenburger</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: In this work, the authors propose an approach to infer cell state transition dynamics and uncover cell-cell interactions from time series single-cell RNA-seq data, by constructing the energy landscape of the system. Based on a nonlinear Fokker-Planck equation on Graph based model, they solve the model inference problem in a dynamic optimal transport framework. They further illustrate the validity of their approach by applying it to a time series scRNA-seq data set of embryonic murine cerebral cortex development.</p>
    <p>Overall, this is an interesting work, aiming to address a critical problem in dynamic model inference and data-driven approach in biology. However, I have some concerns that need to be addressed.</p>
    <p>1, The authors assume that the cell-cell interaction matrix W is symmetric, what does this assumption mean in biology? And why is this a reasonable assumption? For example, should cells with different differentiation potency have symmetric interactions?</p>
    <p>2, Fig.2 (a)(b)(c), the use of color for different cell types is very confusing. Please try to make them consistent.</p>
    <p>3, It’s interesting to get cell-cell interaction matrix W as in Fig.2. However, the biological indication needs to be further discussed. For example, from Fig. 2 (g and h) it is found that cell type 3 (Aps/RPs) has positive interaction with cell type 6 (Young Neurons), and negative interaction with cell type 4 (IPs) or 2 (Young Neurons). What could be the biological meaning here based on the linage commitment route in Fig. 2(a)? Why do the two Young Neurons populations (cell type 6 and 2) have opposite types of interactions with cell type 3 (Aps/RPs)?</p>
    <p>4, The energy landscape here is defined for each cell type, could it be expanded to single cell? i.e., each cell has a potential energy?</p>
    <p>5, Current work focus on the cell-cell interactions, and molecular expression data is used only for estimating probability of cell types at different time point. As we know, the molecular interactions are important to cell fate transition determinations, and corresponding landscape construction approaches have been proposed (Kang, Advanced Science, 8, 2003133 (2021)). The authors may want to discuss the relationship between the two types of approaches.</p>
    <p>Reviewer #2: The authors consider the dynamic inference of an evolving cell population from the time series scRNA-seq data. The main idea of their approach is to apply the optimal transport theory on graph with a free energy consists of the potential, mean field interaction, and the entropy terms. The parameters describing the potential and interaction terms are estimated by fitting the model to the available data. The computation applied to embryonic murine cerebral cortex development gives reasonable results. The literature review is also fair. Overall, I think the paper is interesting and present simple yet useful tool to analyze the time series scRNA-seq data.</p>
    <p>Some major and minor points are as below.</p>
    <p>Major:</p>
    <p>1. The computational cost and robustness. The authors state that the method will be applied to the cell states/types in a complete graph. If it is only for cell types, which have a small number, the DOF is small and the computation cost should be light. If it is for the whole cell states, the DOF might be huge and the computation is difficult to be done. BTW, in different time points, how will the authors choose the common cell states if they do not do grouping at first? How will the different grouping affect the result?</p>
    <p>2. Quantification of the cell stemness. This is an important issue in scRNA-seq data analysis. Will the proposed method give a quantification on this problem? I would like to see some tests and comments on this point.</p>
    <p>3. The authors choose the optimal transport (OT) approach and and Wasserstein distance to the scRNA-seq data analysis, which is a hot topic in this area and machine learning community. Yes, it is fancy to take OT. But it is also possible to utilize other simpler model and optimization approach to accomplish similar task. I wonder whether the authors have some reason to take OT instead of other methods. Some comments and discussion on this point should be added.</p>
    <p>Minor:</p>
    <p>1. Some typo or gramatical errors.</p>
    <p>Line 73: double periods in the text.</p>
    <p>Line 121: as follows</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009821.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009821" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">5 Nov 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009821.s005" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ResponseLetter-GraphFP.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009821.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009821.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Lauffenburger, Nie</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Lauffenburger, Nie</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009821" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Dec 2021</named-content>
    </p>
    <p>Dear Dr. Wan,</p>
    <p>Thank you very much for submitting your manuscript "Dynamic inference of cell developmental complex energy landscape from time series single-cell transcriptomic data" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Qing Nie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Douglas Lauffenburger</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my concerns thoroughly. I have only a few minor comments.</p>
    <p>1, Line 483, is ref. 37 the right reference here? It seems that ref. 37 is not talking about data-driven landscape.</p>
    <p>2, The final word of the paper (Line 533), “adopt” should be adopted?</p>
    <p>3, Fig. 3 (c and d), the y axis seems to be labeled incorrectly.</p>
    <p>Reviewer #2: The authors responded to my concerns perfectly. Now I recommend it for publication.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009821.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009821" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">14 Dec 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009821.s006" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ResponseLetter-GraphFP-R2.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009821.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009821.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Lauffenburger, Nie</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Lauffenburger, Nie</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009821" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Jan 2022</named-content>
    </p>
    <p>Dear Dr. Wan,</p>
    <p>We are pleased to inform you that your manuscript 'Dynamic inference of cell developmental complex energy landscape from time series single-cell transcriptomic data' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Qing Nie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Douglas Lauffenburger</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Feilim Mac Gabhann</p>
    <p>Editor-in-Chief</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009821.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009821.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Lauffenburger, Nie</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Lauffenburger, Nie</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009821" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Jan 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-21-00954R2 </p>
    <p>Dynamic inference of cell developmental complex energy landscape from time series single-cell transcriptomic data</p>
    <p>Dear Dr Wan,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Agnes Pap</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
