<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8051094</article-id>
    <article-id pub-id-type="publisher-id">4108</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04108-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ChIP-BIT2: a software tool to detect weak binding events using a Bayesian integration approach</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Xi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Xu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Neuwald</surname>
          <given-names>Andrew F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hilakivi-Clarke</surname>
          <given-names>Leena</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clarke</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7256-1374</contrib-id>
        <name>
          <surname>Xuan</surname>
          <given-names>Jianhua</given-names>
        </name>
        <address>
          <email>xuan@vt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.438526.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0694 4940</institution-id><institution>Bradley Department of Electrical and Computer Engineering, </institution><institution>Virginia Polytechnic Institute and State University, </institution></institution-wrap>900 North Glebe Road, Arlington, VA 22203 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430264.7</institution-id><institution>Center for Computational Biology, Flatiron Institute, </institution><institution>Simons Foundation, </institution></institution-wrap>162 Fifth Avenue, New York, NY 10010 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.411024.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2175 4264</institution-id><institution>Institute for Genome Sciences and Department Biochemistry and Molecular Biology, </institution><institution>University of Maryland School of Medicine, </institution></institution-wrap>Baltimore, MD 21201 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.17635.36</institution-id><institution-id institution-id-type="ISNI">0000000419368657</institution-id><institution>Hormel Institute, </institution><institution>University of Minnesota, </institution></institution-wrap>801 16th Ave NE, Austin, MN 55912 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>193</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">ChIP-seq combines chromatin immunoprecipitation assays with sequencing and identifies genome-wide binding sites for DNA binding proteins. While many binding sites have strong ChIP-seq ‘peak’ observations and are well captured, there are still regions bound by proteins weakly, with a relatively low ChIP-seq signal enrichment. These weak binding sites, especially those at promoters and enhancers, are functionally important because they also regulate nearby gene expression. Yet, it remains a challenge to accurately identify weak binding sites in ChIP-seq data due to the ambiguity in differentiating these weak binding sites from the amplified background DNAs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">ChIP-BIT2 (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/chipbitc/">http://sourceforge.net/projects/chipbitc/</ext-link>) is a software package for ChIP-seq peak detection. ChIP-BIT2 employs a mixture model integrating protein and control ChIP-seq data and predicts strong or weak protein binding sites at promoters, enhancers, or other genomic locations. For binding sites at gene promoters, ChIP-BIT2 simultaneously predicts their target genes. ChIP-BIT2 has been validated on benchmark regions and tested using large-scale ENCODE ChIP-seq data, demonstrating its high accuracy and wide applicability.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">ChIP-BIT2 is an efficient ChIP-seq peak caller. It provides a better lens to examine weak binding sites and can refine or extend the existing binding site collection, providing additional regulatory regions for decoding the mechanism of gene expression regulation.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04108-5.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>149653</award-id>
        <award-id>164384</award-id>
        <award-id>149147</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hilakivi-Clarke</surname>
            <given-names>Leena</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>Robert</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>Jianhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>125878</award-id>
        <principal-award-recipient>
          <name>
            <surname>Neuwald</surname>
            <given-names>Andrew F.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par15">ChIP-seq technique combines chromatin immunoprecipitation (ChIP) assays with massively parallel sequencing (Seq) and delivers genome-wide profiling of DNA sites bound by a specific protein [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. DNA-associated proteins mainly include transcription factors (TFs) and histone modification proteins (HMs) and they have diverse functional roles in the epigenome. Master TFs [<xref ref-type="bibr" rid="CR3">3</xref>] bind at specific DNA locations and most have strong ChIP-seq signal enrichment [<xref ref-type="bibr" rid="CR4">4</xref>]. Partner TFs and most HMs bind at more diverse loci and some of them have weak ChIP-seq signal enrichment at long DNA segments [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. All generate mechanistically important regulatory actions on nearby gene transcription. Yet, accurately identifying the weak binding sites is challenging because their relatively low signals in the ChIP-seq experiment can be easily obscured by the noise signals produced by the amplified background DNAs.</p>
    <p id="Par16">The ChIP-BIT algorithm (Bayesian inference of target genes using ChIP-seq data) was developed by Chen et al. and was originally applied to detecting the narrow TF binding sites (TFBSs) near to the gene transcription starting sites (TSSs) and predicting target genes [<xref ref-type="bibr" rid="CR8">8</xref>]. Using a multi-component mixture distribution to jointly model ChIP-seq read intensities in the sample (protein) and the input ChIP-seq experiments, ChIP-BIT can better capture weak peaks and predict their target genes. Recent research on distal regulatory regions like enhancers has demonstrated the functional importance of protein binding sites at these regions on distal gene regulation [<xref ref-type="bibr" rid="CR9">9</xref>]. Proteins like EP300, H3K27ac, and H3K4me1 bind to enhancers more frequently than at promoters [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. For ChIP-seq data of such proteins, the peak detection capability of ChIP-BIT is very limited. Moreover, many HMs are having very wide peaks crossing thousands of base pairs [<xref ref-type="bibr" rid="CR13">13</xref>]. Compared to the narrow and sharp ChIP-seq peaks, ChIP-seq signals of wide peaks are not central to the peak summits but spreading along wide genome segments. These wide peaks are also out of the peak width scope that ChIP-BIT can detect. To enable weak peak detection for all these proteins, it is important and necessary to extend the ChIP-BIT algorithm and make it generally applicable to most ChIP-seq data.</p>
    <p id="Par17">Here we present ChIP-BIT2, an extended software package featuring the ChIP-BIT algorithm and being able to detect weak peaks across the whole genome for diverse DNA-associated proteins. ChIP-BIT2 is a C/C++ implementation and runs 40% faster than the original ChIP-BIT. We benchmarked ChIP-BIT2 on selected ChIP-seq data with experts labeled peak/nonpeak regions [<xref ref-type="bibr" rid="CR14">14</xref>] and demonstrated that ChIP-BIT2 had a lower error rate than existing peak callers like MACS2. We have also applied ChIP-BIT2 to multiple ChIP-seq datasets downloaded from the ENCODE data portal [<xref ref-type="bibr" rid="CR15">15</xref>] and detected binding sites of 50 proteins in the breast cancer MCF-7 cells. Results revealed that these DNA-binding proteins indeed had a different tendency to bind at promoters, enhancers, or other genomic locations, demonstrating the necessity to properly model ChIP-seq signals within a specific category of regions to better capture peaks, especially weak ones. We finally compared ChIP-BIT2 results with peaks previously identified by the ENCODE pipeline, for the same set of proteins including both TFs and HMs. At active regulatory regions in MCF-7 cells, ChIP-BIT2 recalled 92% of ENCODE peaks and in the meanwhile, it reported additional 11,813 peaks, providing more candidates for studying gene regulation in breast cancer cells [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>ChIP-BIT algorithm</title>
      <p id="Par18">The challenge in weak peak detection of ChIP-seq data lies in the ambiguity in differentiating weak signals of protein binding sites from noise signals produced by the background regions. In ChIP-seq data, signals from the amplified background DNAs can be as strong as true binding signals. ChIP-BIT2 shrinks the distance in read intensity distributions between strong and weak peaks using one global distribution and amplifies the difference between weak peaks and background regions using multiple local distributions. In this way, it brings more power for detecting protein binding sites with different strengths of ChIP-seq read enrichment (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).<fig id="Fig1"><label>Fig. 1</label><caption><p>ChIP-seq peak detection using a Gaussian mixture model. ChIP-BIT2 <bold>a</bold> converted read counts to read intensity and then <bold>b</bold> used a mixture of Gaussian distributions to differentiate (strong and weak) binding events from background signals</p></caption><graphic xlink:href="12859_2021_4108_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par19">To enable flexible detection for narrow or wide peaks, a sliding window is used for peak screening. The window size is adjustable to meet different resolution needs. For example, most TFs have narrow and sharp ChIP-seq peaks. A narrow window size like 50 base pairs (bps) can help identify high-resolution peak boundaries. For HMs, their peaks can be as wide as several thousand bps. A wide window size like 500 bps can effectively smooth signal fluctuation in the wide genomic region of a whole peak.</p>
      <p id="Par20">Given a ChIP-seq profile for a specific protein, assuming there were <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M2"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq1.gif"/></alternatives></inline-formula> candidate genomic regions overlapping with at least two ChIP-seq reads at each, we partitioned the <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M4"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq2.gif"/></alternatives></inline-formula>th region into fixed-length windows and calculated read intensity <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{n,w}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq3.gif"/></alternatives></inline-formula> for the window <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M8"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq4.gif"/></alternatives></inline-formula>. In the meanwhile, we calculated another read intensity <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{n,w}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq5.gif"/></alternatives></inline-formula> using data from the matched input ChIP-seq profile. The relative distance of the window <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M12"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq6.gif"/></alternatives></inline-formula> to the nearest gene TSS or enhancer center was denoted by <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{n,w}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq7.gif"/></alternatives></inline-formula>. ChIP-BIT2 estimated a probability for protein binding occurrence in the window <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M16"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq8.gif"/></alternatives></inline-formula> of the region <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M18"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq9.gif"/></alternatives></inline-formula> as [<xref ref-type="bibr" rid="CR8">8</xref>]:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {b_{n,w} {|}s_{n,w} , d_{n,w} } \right) \propto P\left( {s_{n,w} {|}b_{n,w} } \right)P\left( {d_{n,w} {|}b_{n,w} } \right)P\left( {b_{n,w} } \right).$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4108_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par21">Depending on the binding or non-binding status in the variable <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq10.gif"/></alternatives></inline-formula> (with a uniform prior on binding ‘<inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w} =$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq11.gif"/></alternatives></inline-formula> 1’ or non-binding ‘<inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w} =$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq12.gif"/></alternatives></inline-formula> 0’), we modeled <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{n,w}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq13.gif"/></alternatives></inline-formula> a two-component Gaussian mixture distribution as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}c} {P\left( {s_{n,w} {|}b_{n,w} = 1} \right) = N\left( {\mu_{1} ,\sigma_{1}^{2} } \right), } \\ {P\left( {s_{n,w} {|}b_{n,w} = 0} \right) = N\left( {r_{n,w} ,\sigma_{0}^{2} } \right).} \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2021_4108_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par22">If <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w} = 1$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq14.gif"/></alternatives></inline-formula>, we assumed the region bound by the protein and modeled read intensities at protein-bound regions using a global Gaussian distribution with mean <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{1}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq15.gif"/></alternatives></inline-formula> and variance <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma_{1}^{2}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq16.gif"/></alternatives></inline-formula>, where model parameters <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma_{1}^{2}$$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq18.gif"/></alternatives></inline-formula> were unknown and needed to be estimated. If <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w} = 0$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq19.gif"/></alternatives></inline-formula>, we assumed it a background region and modeled the read intensity using a local Gaussian distribution with mean <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{n,w}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq20.gif"/></alternatives></inline-formula> and variance <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma_{0}^{2}$$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq21.gif"/></alternatives></inline-formula> (the variance of background signals was estimated using the input ChIP-seq data).</p>
      <p id="Par23">The second likelihood function <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {d_{n,w} {|}b_{n,w} } \right)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq22.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ1" ref-type="">1</xref>) modeled the regulatory effects of the selected region on nearby genes. ChIP-seq data visualization around gene promoter regions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A) and evidence from previous studies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] both suggest that: for protein binding sites, the ChIP-seq read intensity follows an exponential distribution towards the gene TSS; for background regions, the distribution is relatively uniform around the TSS. Therefore, we modeled <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{n,w}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq23.gif"/></alternatives></inline-formula> a mixture distribution with two components as follows:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}c} {P\left( {d_{n,w} {|}b_{n,w} = 1} \right) = Exp\left( \lambda \right), } \\ {P\left( {d_{n,w} {|}b_{n,w} = 0} \right) = U\left( { - \frac{{d_{P} }}{2},\frac{{d_{P} }}{2}} \right).} \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>λ</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2021_4108_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M54"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq24.gif"/></alternatives></inline-formula> represented the exponential distribution parameter, which was unknown and needed to be estimated. <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{P}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq25.gif"/></alternatives></inline-formula> represented the length of a promoter region.</p>
      <p id="Par24">For enhancers, ChIP-seq data visualization (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1B) shows that the distribution of ChIP-seq read intensity is uniform and does not correlate with the distance to the enhancer center or the nearest TSS. Therefore, specifically for peak calling at distal enhancers, we assumed uniform distributions on <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{n,w}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq26.gif"/></alternatives></inline-formula> as:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}c} {P\left( {d_{n,w} {|}b_{n,w} = 1} \right) = U\left( { - \frac{{d_{E} }}{2},\frac{{d_{E} }}{2}} \right),} \\ {P\left( {d_{n,w} {|}b_{n,w} = 0} \right) = U\left( { - \frac{{d_{E} }}{2},\frac{{d_{E} }}{2}} \right).} \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2021_4108_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{E}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq27.gif"/></alternatives></inline-formula> represented the length of an enhancer region.</p>
      <p id="Par25">ChIP-BIT2 used the Expectation–Maximization algorithm to iteratively estimate distribution parameters and the probability of binding occurrence in each window (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Briefly, in the E-step, ChIP-BIT2 estimated the model parameters based on the inferred binding status variables (<inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq28.gif"/></alternatives></inline-formula>) of all regions; in the M-step, ChIP-BIT2 updated the posterior probability <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {b_{n,w} {|}s_{n,w} , d_{n,w} } \right)$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq29.gif"/></alternatives></inline-formula> for each window using the estimated model parameters, and then updated the binding status in the variable <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{n,w}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4108_Article_IEq30.gif"/></alternatives></inline-formula> accordingly. We iterated the E and M steps until the changes of parameter values were less than 5%. ChIP-BIT2 combined consecutive windows with probabilities higher than a cut-off threshold and output them together as one single peak. Depending on the protein feature and the window resolution, a sharp peak can take one or two windows and a wide peak can take more than ten windows.</p>
    </sec>
    <sec id="Sec4">
      <title>ChIP-BIT2 pipeline</title>
      <p id="Par26">ChIP-BIT2 was implemented using C/C++. The pipeline of ChIP-BIT2 was shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). Given a pair of sample and input ChIP-seq profiles in SAM format, ChIP-BIT2 firstly extracted the genomic coordinates of individual reads from sample and input ChIP-seq profiles, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). And then it detected peaks at promoters, enhancers (if annotation files were provided), or across the whole genome.<fig id="Fig2"><label>Fig. 2</label><caption><p>ChIP-BIT2 pipeline. ChIP-BIT2 respectively extracted read location information from sample and input ChIIP-seq SAM format profiles. Depending on the running mode, it can detect peaks from the whole genome or from annotated regulatory regions like promoters or enhancers. To enable  peak detection of different sizes, ChIP-BIT2 partitioned genomic segments into smaller windows and calculated read intensity in each window for distribution parameter learning and binding occurrence probability estimation. Windows with the posterior probability over 0.9 were output in BED format as final peaks</p></caption><graphic xlink:href="12859_2021_4108_Fig2_HTML" id="MO2"/></fig></p>
      <sec id="Sec5">
        <title>Promoter mode</title>
        <p id="Par27">Promoters refer to the proximal regulatory regions centered around gene TSS. A TSS annotation file is required to enable the ‘-promoter’ running mode of ChIP-BIT2. Users can set the preferred promoter size using the ‘-s’ option. Under this mode, ChIP-BIT2 jointly modeled read intensities in the sample and input ChIP-seq profiles using the Gaussian mixture model [Eq. (<xref rid="Equ2" ref-type="">2</xref>)]. In the meanwhile, it modeled the relative distance of each window to the nearest TSS using the Exponential-Uniform mixture model [Eq. (<xref rid="Equ3" ref-type="">3</xref>)]. A demo of using ChIP-BIT2 for detecting peaks at promoters was provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4.</p>
      </sec>
      <sec id="Sec6">
        <title>Enhancer mode</title>
        <p id="Par28">Enhancers referred to distal regulatory regions interacting with promoters/TSSs in the 3D genome [<xref ref-type="bibr" rid="CR18">18</xref>]. The linear distance of an enhancer to its target promoter/gene can be up to 1 Mbps. Some proteins like EP300, H3K27ac, and H3K4me1 specifically bind to enhancers frequently and have higher ChIP-seq signal enrichment at enhancers than at promoters or other genomic locations [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. To effectively detect ChIP-seq peaks for such proteins, an enhancer annotation file is required to enable the ‘-enhancer’ running mode of ChIP-BIT2. Under this mode, ChIP-BIT2 modeled read intensities in the sample and input ChIP-seq profiles jointly using Eq. (<xref rid="Equ2" ref-type="">2</xref>). Different from the promoter mode, ChIP-BIT2 modeled the relative distance of each window to the enhancer center using a Uniform distribution [Eq. (<xref rid="Equ4" ref-type="">4</xref>)]. A demo of using ChIP-BIT2 for peak detection at enhancers was provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5.</p>
      </sec>
      <sec id="Sec7">
        <title>Whole genome mode</title>
        <p id="Par29">Promoters and enhancers are two categories of well-understood regulatory regions. There exist many other types of genomic regions also bound by DNA proteins. For example, cohesion proteins CTCF and RAD21 usually bind at the boundaries of topological associated domains and play a key role in the 3D chromatin structure [<xref ref-type="bibr" rid="CR19">19</xref>]. Transcription initiation protein POLA2 binds to all active regulatory regions in the whole genome. For such proteins, it is important to call their ChIP-seq peaks from the whole genome, using the ‘-WG’ mode of ChIP-BIT2. As no annotated regulatory regions were needed, ChIP-BIT2 modeled read intensities from sample and input ChIP-seq profiles and predicted peaks at genome-wide locations.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Histone modification benchmark analysis</title>
      <p id="Par30">The ChIP-BIT algorithm has been benchmarked on narrow TFBSs and demonstrated to perform better than conventional peak callers [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. To evaluate the accuracy of ChIP-BIT2 on detecting narrow or wide histone modifications, for selected HMs we benchmarked ChIP-BIT2 on experts-labeled peak/nonpeak regions. We used an HM benchmark dataset [<xref ref-type="bibr" rid="CR14">14</xref>] including 10,253 H3K4me3 regions (narrow pattern) and 2573 H3K36me3 regions (broad pattern), the protein binding statuses of which were respectively and independently labeled by three experts by visualizing ChIP-seq data across multiple immune cell samples (T-cell, B-cell, and monocyte). For some peaks with low-resolution peak boundaries, peak-start and -end regions were respectively labeled.</p>
      <p id="Par31">Here we compared the detection accuracy of ChIP-BIT2 to that of MACS2 (2020.4 version) [<xref ref-type="bibr" rid="CR21">21</xref>] and CNN-Peaks [<xref ref-type="bibr" rid="CR22">22</xref>]. MACS2 was widely used in ChIP-seq peak detection. It featured regions with high read counts as peaks so most of its detected peaks were strong. CNN-Peaks was a supervised machine-learning approach, not making distribution assumptions on read depth but learning proper cut-off thresholds at labeled regions from the sample ChIP-seq data. As CNN-Peaks used different thresholds to determine the peak/nonpeak status for regions with different ChIP-seq read depths, it could capture weak binding events.</p>
      <p id="Par32">We downloaded H3K4me3 and H3K36me3 ChIP-seq data and their matched input in K562 and GM12878 cells, from ENCODE data portal (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>) [<xref ref-type="bibr" rid="CR15">15</xref>]. K562 and GM12878 cell lines are both blood-specific, providing a matching context to the benchmark data. In total, four ChIP-seq datasets and three peak calling tools were included in this comparison. Peak detection errors were assessed using PeakError [<xref ref-type="bibr" rid="CR14">14</xref>]. To account for both false positives and false negatives, we calculated the F1 score, the harmonic mean of precision and recall (2 * precision * recall/(precision + recall)).</p>
      <p id="Par33">To fairly compare the peak detection accuracy between supervised (CNN-Peaks) and unsupervised approaches (ChIP-BIT2 and MACS2), we performed 4-fold cross-validation: using three folds to optimize model parameters of each method and using the hold out one fold to assess detection accuracy. Under this setting, the difference between the three selected methods was small but ChIP-BIT2 had the highest F-1 score (Table <xref rid="Tab1" ref-type="table">1</xref>). In reality, in a ChIP-seq profile, the peak regions were largely unknown before peak detection analysis. The model parameters of a peak caller cannot be specifically optimized using signals from true peak/nonpeak regions. This largely limited the application of supervised approaches. Using pre-trained models to predict peaks in a new ChIP-seq profile may not return good results either,  because ChIP-seq experiments were highly context-specific.<table-wrap id="Tab1"><label>Table 1</label><caption><p>F1-score and run-time of competing peak callers on H3K4me3 and H3K36me3 benchmark region detection using ENCODE ChIP-seq datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cell line</th><th align="left" colspan="2">K562</th><th align="left" colspan="2">GM12878</th></tr><tr><th align="left">Histone protein</th><th align="left">H3K4me3</th><th align="left">H3K36me3</th><th align="left">H3K4me3</th><th align="left">H3K36me3</th></tr></thead><tbody><tr><td align="left" colspan="5">F1-score (Supervised)</td></tr><tr><td align="left"> ChIP-BIT2</td><td align="left">0.93</td><td align="left">0.90</td><td align="left">0.95</td><td align="left">0.90</td></tr><tr><td align="left"> MACS2</td><td align="left">0.89</td><td align="left">0.78</td><td align="left">0.93</td><td align="left">0.83</td></tr><tr><td align="left"> CNN-peaks</td><td align="left">0.91</td><td align="left">0.85</td><td align="left">0.90</td><td align="left">0.88</td></tr><tr><td align="left" colspan="5">F1- score (unsupervised)</td></tr><tr><td align="left"> ChIP-BIT2</td><td align="left">0.88</td><td align="left">0.82</td><td align="left">0.91</td><td align="left">0.82</td></tr><tr><td align="left"> MACS2</td><td align="left">0.82</td><td align="left">0.77</td><td align="left">0.84</td><td align="left">0.79</td></tr><tr><td align="left" colspan="5">Run-time (unsupervised)</td></tr><tr><td align="left"> ChIP-BIT2</td><td align="left">14m1s</td><td align="left">9m21s</td><td align="left">15m7s</td><td align="left">9m9s</td></tr><tr><td align="left"> MACS2</td><td align="left">3m42s</td><td align="left">2m39s</td><td align="left">5m35s</td><td align="left">2m32s</td></tr></tbody></table></table-wrap></p>
      <p id="Par34">Both ChIP-BIT2 and MACS2 were unsupervised approaches. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, under unsupervised settings, ChIP-BIT2 had a higher accuracy than MACS2. ChIP-BIT2 ran reasonably fast (&lt; 15 mins) on DELL T7600 workstation with 3.1 GHz CPU (32 cores) and 128 GB RAM. As ChIP-BIT2 detected additional weak binding events by screening many more candidate regions, its run-time was slightly longer than MACS2.</p>
    </sec>
    <sec id="Sec10">
      <title>Run-time of ChIP-BIT2</title>
      <p id="Par35">To evaluate the running time of ChIP-BIT2 in different scenarios, we downloaded ChIP-seq data of 39 TFs in breast cancer MCF-7 cells and their matched input data from ENCODE and the GEO databases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). We also downloaded TSS and enhancer annotation files for MCF-7 cells from the SCREEN webserver (<ext-link ext-link-type="uri" xlink:href="https://screen.encodeproject.org/">https://screen.encodeproject.org/</ext-link>) [<xref ref-type="bibr" rid="CR23">23</xref>]. In total, we obtained 25,802 promoters (possibly overlapping for closely located genes) and 34,599 enhancers. ChIP-BIT2 and ChIP-BIT were respectively applied to individual ChIP-seq datasets, under CentOS Linux 7.3 system, on a DELL T7600 workstation with 3.1 GHz CPU (32 cores) and 128 GB RAM. ChIP-BIT2 achieved a speed improvement of ~ 40% over ChIP-BIT (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Moreover, although the number of enhancers was 30% more than the number of promoters, ChIP-BIT2 had a similar running time between ‘promoter’ and ‘enhancer’ modes.<fig id="Fig3"><label>Fig. 3</label><caption><p>Running time comparison between ChIP-BIT2 and ChIP-BIT</p></caption><graphic xlink:href="12859_2021_4108_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>DNA proteins exhibiting different binding tendency to promoters or enhancers</title>
      <p id="Par36">We applied ChIP-BIT2 to another 11 HMs with available MCF-7 ChIP-seq data in the ENCODE data portal (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The number of peaks for each of the above TFs and these HMs was shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. For TFs like MYC and ER-alpha that were reported to be highly active in MCF-7 cells [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>], ChIP-BIT2 detected a high number of peaks. Further, for each protein, we calculated the proportion of its ChIP-seq peaks in annotated promoters, enhancers, or the other regions (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b) and also calculated the ratio between promoter-overlapping peaks and enhancer-overlapping peaks (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c).<fig id="Fig4"><label>Fig. 4</label><caption><p>Peak detection summary of ChIP-BIT2 for 50 DNA proteins. <bold>a</bold> Using breast cancer MCF-7 cells ChIP-seq data of 39 TFs and 11 HMs from ENCODE data portal, ChIP-BIT2 detected peaks from the whole genome. <bold>b</bold> We calculated the proportion of peaks detected from promoters, enhancers or at other regions (peaks from whole genome minus peaks in promoters or enhancers), respectively, and <bold>c</bold> calculated the log2 ratio of the numbers of peaks between enhancers and promoters</p></caption><graphic xlink:href="12859_2021_4108_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par37">For enhancer marker proteins like EP300 and H3K27ac, their ChIP-BIT2 detected peaks were significantly more enriched at enhancers than at promoters (fold change 1.4; <italic>p</italic> value &lt; 0.01, fisher exact test). NOTCH3 has been previously demonstrated to bind to promoters of breast cancer genes [<xref ref-type="bibr" rid="CR8">8</xref>]. Indeed, we detected twofold more NOTCH3 binding events at promoters than at enhancers (fold change 2; <italic>p</italic> value &lt; 0.001, fisher exact test). Transcription initiation protein POL2A usually bind to transcriptional regulatory regions. As expected, we observed similar proportions of POL2A ChIP-seq peaks between promoters and enhancers. There were also proteins with binding sites mostly located outside the annotated promoters or enhancers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, grey color). For example, CTCF functions as an insulator and bind at the topological associating domains boundary area [<xref ref-type="bibr" rid="CR27">27</xref>]. In our analysis, only a small proportion (25%) of CTCF peaks overlapped with existing promoters or enhancers. Therefore, to efficiently call ChIP-seq peaks, we recommended running ChIP-BIT2 in a proper mode if prior knowledge of the binding preference of the protein was available.</p>
    </sec>
    <sec id="Sec12">
      <title>Large-scale application to breast cancer MCF-7 cell line data</title>
      <p id="Par38">To demonstrate that ChIP-BIT2 detected additional peaks that were functionally important but missed by conventional peak callers, for the same set of proteins, we compared ChIP-BIT2 results to peaks detected by the ENCODE pipeline (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1; 26 TFs and 11 HMs). We focused our comparison to regulatory regions associated with ‘actively’ expressed genes in MCF-7 cells because peaks in these regions were more likely to be functional (having regulatory effects). To identify active promoters or enhancers in MCF-7 cells, we downloaded two RNA-seq datasets from the GEO database (accession numbers: GSE62789 and GSE51403). 489 genes were significantly (adjusted <italic>p</italic> value &lt; 0.05) and actively (log2FC &gt; 1) expressed in both datasets. Regions (± 10 kbps) around TSSs of these 489 genes were selected as ‘active’ promoters. 1050 enhancers looping with the above promoters through ENCODE MCF-7 cell line ChIA-PET 3D chromatin interactions were selected as ‘active’ enhancers. Venn diagram of ChIP-BIT2 peaks and ENCODE peaks overlapping with these selected active regulatory regions were shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Overall, ChIP-BIT2 recalled 92% of ENCODE peaks and identified additional 11,813 (52%) new peaks.<fig id="Fig5"><label>Fig. 5</label><caption><p>Venn diagram of binding events detected by ChIP-BIT2 and ENCODE at MCF-7 active promoters or enhancers. <bold>a</bold> TFBSs at 489 promoters; <bold>b</bold> HMs at 489 promoters; <bold>c</bold> TFBSs at 1050 enhancers; <bold>d</bold> HMs at 1050 enhancers</p></caption><graphic xlink:href="12859_2021_4108_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par39">Specifically, for in total of 26 TFs, ChIP-BIT2 recovered ~ 93% (6179/6610) ENCODE peaks in promoters and predicted 6816 new peaks. For specific proteins, for example, few peaks were identified for TDRD3 in the ENCODE database. After evaluating TDRD3 read intensities using ChIP-BIT2, we found that its read enrichment at many regions in the sample ChIP-seq profile was much higher than that in the input data. Therefore, ChIP-BIT2 finally detected TDRD3 peaks in 438 promoter regions, covering nearly 90% of the selected active promoters. For MBD3, ENCODE peaks were on 35% of promoters while ChIP-BIT2 detected more peaks on 55% of promoters. For all 11 histone proteins, ChIP-BIT2 captures nearly all ENCODE peaks (99%, 3215/3254), demonstrating its strong capability of detecting wide histone modifications. An additional set of 693 histone modifications were captured, ~ 20% in ChIP-BIT2 results. A similar comparison was done for peaks at MCF-7 active enhancers. For TFs, ChIP-BIT2 identifies 10,225 peaks, overlapping with 92% ENCODE peaks and providing 3844 new peaks. For HMs, the similarity between the two peak calling approaches was also high, with an overlap rate of 86%. In summary, for both TFs and HMs, ChIP-BIT2 detected a majority of peaks identified by the ENCODE pipeline and also predicted new peaks at functionally important regulatory regions.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Discussion</title>
    <p id="Par40">ChIP-BIT2 can detect strong and weak peaks from annotated regulatory regions or the whole genome, using a Bayesian model to integrate sample and input ChIP-seq profiles. To better capture ChIP-seq peaks at regulatory regions, ChIP-BIT2 takes into account protein binding locations when it estimates the probability of each peak because a weak peak locating closer to the gene TSS could have a higher regulatory effect on that gene than peaks located farther. We demonstrated the accuracy and wide applicability of ChIP-BIT2 using benchmark data and public data in the ENCODE and GEO databases.</p>
    <p id="Par41">Currently, ChIP-BIT2 detects peaks from the given ChIP-seq data one at a time. We are working on its parallel mode to enable peak calling from multiple ChIP-seq profiles together, facilitating the robust peak calling using multiple replicates of one protein or association analysis between multiple proteins. Currently, ATAC-seq data are widely used to capture open chromatin regions in a particular tissue or cell type [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Different from ChIP-seq data, ATAC-seq used paired-end reads. Yet, some existing peak callers simply treat the paired ends of one long read as two separate single-end reads and then detect peaks in the same way as from a ChIP-seq profile. This simplification may break some ultra-wide open chromatin regions into several disconnected narrow peaks, causing errors in the genome-wide chromatin accessibility analysis. We plan to extend the preprocessing function of ChIP-BIT2 and enable modeling read intensity in ATAC fragments of different lengths. With such an extension, ChIP-BIT2 will be able to detect ATAC-seq peaks.</p>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par42">We have developed a C++ software package, ChIP-BIT2, for DNA–protein binding site detection from the ChIP-seq data. ChIP-BIT2 can capture the subtlety in differentiating weak binding sites from background regions by jointly modeling read intensities from sample and input ChIP-seq profiles. ChIP-BIT2 exhibits an accurate performance on detecting both narrow and wide ChIP-seq peaks and it has a broad applicability in TF or HM ChIP-seq data analysis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4108_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. ChIP-BIT2 demo instructions, Figures S1–S5 and Table S1.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ATAC-seq</term>
        <def>
          <p id="Par4">Assay for Transposase-Accessible Chromatin using sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ChIP-BIT2</term>
        <def>
          <p id="Par5">Bayesian inference of target genes using ChIP-seq data V2</p>
        </def>
      </def-item>
      <def-item>
        <term>ChIP-seq</term>
        <def>
          <p id="Par6">Chromatin Immunoprecipitation Sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ChIA-PET</term>
        <def>
          <p id="Par7">Chromatin Interaction Analysis by Paired-End Tag Sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ENCODE</term>
        <def>
          <p id="Par8">Encyclopedia of DNA elements</p>
        </def>
      </def-item>
      <def-item>
        <term>F1</term>
        <def>
          <p id="Par9">Harmonic mean of precision and recall</p>
        </def>
      </def-item>
      <def-item>
        <term>HM</term>
        <def>
          <p id="Par10">Histone modification</p>
        </def>
      </def-item>
      <def-item>
        <term>MACS2</term>
        <def>
          <p id="Par11">Model-based analysis of ChIP-seq V2</p>
        </def>
      </def-item>
      <def-item>
        <term>TF</term>
        <def>
          <p id="Par12">Transcription factor</p>
        </def>
      </def-item>
      <def-item>
        <term>TFBS</term>
        <def>
          <p id="Par13">Transcription factor binding site</p>
        </def>
      </def-item>
      <def-item>
        <term>TSS</term>
        <def>
          <p id="Par14">Transcription starting site</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>J.X. and X.C. designed the framework of the proposed method. X.C. implemented the method and developed the software package with X.S. and J.X. X.C. performed data analysis. L.H.C. and R.C. provided their biological interpretations on the breast cancer results. X.C. and J.X. wrote the manuscript. A.F.N. reviewed the statistical formulations and edited the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by National Institutes of Health (NIH) grants CA149653 (to JX), CA164384 (to LHC) and CA149147 (RC), and by NIH-NIGMS Grant R01GM125878 to AFN.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are available in the ENCODE data portal (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>, Table s1) and ncbi geo database (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/gds">https://www.ncbi.nlm.nih.gov/gds</ext-link>): gSE26831, GSE41561, GSE38901, GSE44737, GSE28008, GSE22612, and GSE62789. ChIP-BIT2 package is implemented using C/C++ under Linux environment and is publicly accessible at <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/chipbitc/">http://sourceforge.net/projects/chipbitc/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par43">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par45">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landt</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Marinov</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kheradpour</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pauli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Cayting</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>1813</fpage>
        <lpage>1831</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.136184.111</pub-id>
        <pub-id pub-id-type="pmid">22955991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq: advantages and challenges of a maturing technology</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2641</pub-id>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Kyba</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>What is a master regulator?</article-title>
        <source>J Stem Cell Res Ther</source>
        <year>2013</year>
        <volume>3</volume>
        <fpage>114</fpage>
        <?supplied-pmid 23885309?>
        <pub-id pub-id-type="pmid">23885309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mercado</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schutzius</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kolter</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Estoppey</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bergling</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roma</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gubser Keller</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nigsch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Salathe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Terranova</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IRF2 is a master regulator of human keratinocyte stem cell fate</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>4676</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-12559-x</pub-id>
        <pub-id pub-id-type="pmid">31611556</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramos</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Barolo</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Low-affinity transcription factor binding sites shape morphogen responses and enhancer evolution</article-title>
        <source>Philos Trans R Soc Lond B Biol Sci</source>
        <year>2013</year>
        <volume>368</volume>
        <issue>1632</issue>
        <fpage>20130018</fpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2013.0018</pub-id>
        <pub-id pub-id-type="pmid">24218631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blow</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>McCulley</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Akiyama</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Plajzer-Frick</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Shoukry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIP-Seq identification of weakly conserved heart enhancers</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <issue>9</issue>
        <fpage>806</fpage>
        <lpage>810</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.650</pub-id>
        <pub-id pub-id-type="pmid">20729851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neuwald</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Hilakivi-Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>BICORN: an R package for integrative inference of de novo cis-regulatory modules</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>7960</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-63043-2</pub-id>
        <pub-id pub-id-type="pmid">32409786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Shajahan-Haq</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shih Ie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Magnani</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>ChIP-BIT: Bayesian inference of target genes using a novel joint probabilistic model of ChIP-seq profiles</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>7</issue>
        <fpage>e65</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1491</pub-id>
        <pub-id pub-id-type="pmid">26704972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Chen X, Zhou J, Zhang R, Wong AK, Park CY, Theesfeld CL, Troyanskaya OG. Tissue-specific enhancer functional networks for associating distal regulatory regions to disease. Cell Syst. 2021;12:1–10.
</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creyghton</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Welstead</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kooistra</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Steine</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lodato</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Frampton</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Sharp</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Histone H3K27ac separates active from poised enhancers and predicts developmental state</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>50</issue>
        <fpage>21931</fpage>
        <lpage>21936</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1016071107</pub-id>
        <pub-id pub-id-type="pmid">21106759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heintzman</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>LO</given-names>
          </name>
          <name>
            <surname>Van Calcar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct and predictive chromatin signatures of transcriptional promoters and enhancers in the human genome</article-title>
        <source>Nat Genet</source>
        <year>2007</year>
        <volume>39</volume>
        <issue>3</issue>
        <fpage>311</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1966</pub-id>
        <pub-id pub-id-type="pmid">17277777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Visel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blow</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Akiyama</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Plajzer-Frick</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Shoukry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIP-seq accurately predicts tissue-specific activity of enhancers</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <issue>7231</issue>
        <fpage>854</fpage>
        <lpage>858</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07730</pub-id>
        <pub-id pub-id-type="pmid">19212405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ngo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Whitaker</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Epigenomic analysis reveals DNA motifs regulating histone modifications in human and mouse</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>9</issue>
        <fpage>3668</fpage>
        <lpage>3677</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1813565116</pub-id>
        <pub-id pub-id-type="pmid">30755522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Goerner-Potvin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Pastinen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Optimizing ChIP-seq peak detectors using visual labels and supervised machine learning</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>4</issue>
        <fpage>491</fpage>
        <lpage>499</lpage>
        <?supplied-pmid 27797775?>
        <pub-id pub-id-type="pmid">27797775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hitz</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gabdank</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hilton</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baymuradov</surname>
            <given-names>UK</given-names>
          </name>
          <name>
            <surname>Narayanan</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Encyclopedia of DNA elements (ENCODE): data portal update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D794</fpage>
        <lpage>D801</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1081</pub-id>
        <pub-id pub-id-type="pmid">29126249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Hilakivi-Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>CRNET: an efficient sampling approach to infer functional regulatory networks by integrating large-scale ChIP-seq and time-course RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>10</issue>
        <fpage>1733</fpage>
        <lpage>1740</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx827</pub-id>
        <pub-id pub-id-type="pmid">29280996</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ouyang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>ChIP-Seq of transcription factors predicts absolute and differential gene expression in embryonic stem cells</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>51</issue>
        <fpage>21521</fpage>
        <lpage>21526</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0904863106</pub-id>
        <pub-id pub-id-type="pmid">19995984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shlyueva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stampfel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional enhancers: from properties to genome-wide predictions</article-title>
        <source>Nat Rev Genet</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>272</fpage>
        <lpage>286</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3682</pub-id>
        <pub-id pub-id-type="pmid">24614317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanborn</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Jewett</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Chinnappan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cutkosky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin extrusion explains key features of loop and domain formation in wild-type and engineered genomes</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>47</issue>
        <fpage>E6456</fpage>
        <lpage>6465</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1518552112</pub-id>
        <pub-id pub-id-type="pmid">26499245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rye</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Saetrom</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Drablos</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A manually curated ChIP-seq benchmark demonstrates room for improvement in current peak-finder programs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>4</issue>
        <fpage>e25</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1187</pub-id>
        <pub-id pub-id-type="pmid">21113027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Use model-based Analysis of ChIP-Seq (MACS) to analyze short reads generated by sequencing protein-DNA interactions in embryonic stem cells</article-title>
        <source>Methods Mol Biol</source>
        <year>2014</year>
        <volume>1150</volume>
        <fpage>81</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-0512-6_4</pub-id>
        <pub-id pub-id-type="pmid">24743991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Strattan</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hur</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Bento</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>CNN-peaks: ChIP-Seq peak detection pipeline using convolutional neural networks that imitate human visual inspection</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>7933</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-64655-4</pub-id>
        <pub-id pub-id-type="pmid">32404971</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Purcaro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Adrian</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kawli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>583</volume>
        <issue>7818</issue>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2493-4</pub-id>
        <pub-id pub-id-type="pmid">32728249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morettin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paris</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bouzid</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Baldwin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Falls</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Cote</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Tudor domain containing protein 3 promotes tumorigenesis and invasive capacity of breast cancer cells</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>5153</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-04955-4</pub-id>
        <pub-id pub-id-type="pmid">28698590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Olopade</surname>
            <given-names>OI</given-names>
          </name>
        </person-group>
        <article-title>MYC and breast cancer</article-title>
        <source>Genes Cancer</source>
        <year>2010</year>
        <volume>1</volume>
        <issue>6</issue>
        <fpage>629</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1177/1947601910378691</pub-id>
        <pub-id pub-id-type="pmid">21779462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duffy</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Estrogen receptors: role in breast cancer</article-title>
        <source>Crit Rev Clin Lab Sci</source>
        <year>2006</year>
        <volume>43</volume>
        <issue>4</issue>
        <fpage>325</fpage>
        <lpage>347</lpage>
        <pub-id pub-id-type="doi">10.1080/10408360600739218</pub-id>
        <pub-id pub-id-type="pmid">16769596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bartkuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schierenberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wiehe</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The chromatin insulator CTCF and the emergence of metazoan diversity</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>43</issue>
        <fpage>17507</fpage>
        <lpage>17512</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1111941109</pub-id>
        <pub-id pub-id-type="pmid">23045651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>ATAC-seq: a method for assaying chromatin accessibility genome-wide</article-title>
        <source>Curr Protoc Mol Biol</source>
        <year>2015</year>
        <volume>109</volume>
        <fpage>21</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1002/0471142727.mb2129s109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suryo Rahmanto</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>ZC</given-names>
          </name>
          <name>
            <surname>Miyamoto</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Asaka</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inactivation of Arid1a in the endometrium is associated with endometrioid tumorigenesis through transcriptional reprogramming</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>2717</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16416-0</pub-id>
        <pub-id pub-id-type="pmid">32483112</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
