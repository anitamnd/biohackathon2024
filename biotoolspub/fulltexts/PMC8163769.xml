<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8163769</article-id>
    <article-id pub-id-type="publisher-id">23518</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-021-23518-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generative modeling of single-cell time series with PRESCIENT enables prediction of cell trajectories with interventions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8920-8208</contrib-id>
        <name>
          <surname>Yeo</surname>
          <given-names>Grace Hui Ting</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7009-7520</contrib-id>
        <name>
          <surname>Saksena</surname>
          <given-names>Sachit D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1709-4034</contrib-id>
        <name>
          <surname>Gifford</surname>
          <given-names>David K.</given-names>
        </name>
        <address>
          <email>gifford@mit.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.116068.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2341 2786</institution-id><institution>Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.116068.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2341 2786</institution-id><institution>Computational and Systems Biology Program, Massachusetts Institute of Technology, </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.116068.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2341 2786</institution-id><institution>Department of Electrical Engineering and Computer Science, </institution><institution>Massachusetts Institute of Technology, </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.116068.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2341 2786</institution-id><institution>Department of Biological Engineering, </institution><institution>Massachusetts Institute of Technology, </institution></institution-wrap>Cambridge, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>3222</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Existing computational methods that use single-cell RNA-sequencing (scRNA-seq) for cell fate prediction do not model how cells evolve stochastically and in physical time, nor can they predict how differentiation trajectories are altered by proposed interventions. We introduce PRESCIENT (Potential eneRgy undErlying Single Cell gradIENTs), a generative modeling framework that learns an underlying differentiation landscape from time-series scRNA-seq data. We validate PRESCIENT on an experimental lineage tracing dataset, where we show that PRESCIENT is able to predict the fate biases of progenitor cells in hematopoiesis when accounting for cell proliferation, improving upon the best-performing existing method. We demonstrate how PRESCIENT can simulate trajectories for perturbed cells, recovering the expected effects of known modulators of cell fate in hematopoiesis and pancreatic β cell differentiation. PRESCIENT is able to accommodate complex perturbations of multiple genes, at different time points and from different starting cell populations, and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gifford-lab/prescient">https://github.com/gifford-lab/prescient</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Single-cell RNA-Seq allows us to observe snapshots of how biological systems change over time at cellular resolution. Here, the authors develop a generative framework that uses time-resolved single-cell data to model how cells change in physical time, including in response to perturbations.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational models</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Differentiation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>5 R01 NS109217</award-id>
        <award-id>5 R01 HG008363</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gifford</surname>
            <given-names>David K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Modeling developmental landscapes is essential to improving our understanding of how cells are driven to transient and terminal states in vivo and to enable precise manipulation of cell fates in vitro<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Single-cell RNA-sequencing (scRNA-seq) has enabled the study of developmental landscapes by the observation of gene expression in single cells sampled at multiple stages of differentiation. However, these studies provide snapshots of a given differentiation process and do not directly observe lineage relationships between cells at different time points in development. Recently, experimental lineage tracing methods that couple various barcoding strategies with scRNA-seq have been described that identify lineage relationships<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref></sup>. These methods provide ground truth for computational models of differentiation.</p>
    <p id="Par4">Existing computational approaches for modeling differentiation typically summarize observations of cell states and couplings emergent of the underlying process and have limited to no capacity for modeling differentiation as a continuous process (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The predominant approach is pseudo-temporal inference, which orders cells along an arbitrary one-dimensional measurement representing ‘differentiation time’, and hence cannot model differentiation dynamics with respect to real, physical time<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>. Other methods have also emerged for the specific task of cell fate prediction. For example, Waddington-OT predicts long-range cell–cell probabilistic couplings by reframing the task of inferring cell relationships between population snapshots as an unbalanced optimal transport problem<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Another method, Fate-ID iteratively builds ensembled cell-type classifiers from labeled terminal cell states<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. However, these methods only summarize observations of cell states and couplings emergent of the underlying differentiation process. Recently, a small number of methods have described approaches to modeling differentiation as a process, but they have been limited either in how the model is solved, or in modeling capacity. For example, Population Balance Analysis (PBA) solves a reaction-diffusion partial differential equation describing differentiation but is forced to use a nonparametric solution due to computational constraints<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Similarly, pseudodynamics models a diffusion process but only in a one-dimensional cell state<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>.<fig id="Fig1"><label>Fig. 1</label><caption><title>A generative model of cellular differentiation.</title><p><bold>a</bold> Existing single-cell models of development can be described as operating in pseudo-time or real time (<italic>x</italic>-axis), and by the extent to which they model the underlying differentiation process (<italic>y</italic>-axis). PRESCIENT is highlighted in red. <bold>b</bold> Observations of population-level time-series data are used in a generative framework that models the underlying dynamic process in physical time. Evolution of a cell’s state is governed by a drift term and a noise term. The drift, depicted by solid arrows, is defined as the negative gradient of the potential function, depicted by the color gradient in the background. Dashed lines correspond to noise. The model is fit using observations of population-level time-series data, depicted as solid circles. Simulations of cell states are depicted as dashed circles. <bold>c</bold> Cartoon depicting model fitting process. The neural network parameterizing the underlying drift function μ takes as input the PCA projections of gene expression data at observed time points (again depicted as solid lines). The stochastic process is then simulated via first-order time discretization to produce a population at the next time step, and so on. This proceeds until the next observed time point, at which the loss between the simulated and predicted population is minimized. The model was validated using two tasks. <bold>d</bold> Held-out recovery, where the model was asked to predict the marginal distribution of a held-out time point, and <bold>e</bold>–<bold>f</bold>, fate prediction, where the model was asked to predict the fate distribution outcome of a given progenitor cell. Fate prediction can be applied to cells observed in the dataset (<bold>e</bold>) or cell states in which some perturbation has been applied in silico (<bold>f</bold>). As shown, the perturbation results in a significant shift of fate distribution outcomes.</p></caption><graphic xlink:href="41467_2021_23518_Fig1_HTML" id="d32e378"/></fig></p>
    <p id="Par5">We introduce PRESCIENT (Potential eneRgy undErlying Single Cell gradIENTs), a generative modeling framework fit using longitudinal scRNA-seq datasets to model complex potential landscapes. PRESCIENT extends previous work by Hashimoto et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> that showed that a global potential function of a time-series is recoverable via a diffusion-based model fit to well-mixed, cross-sectional observations. PRESCIENT builds upon this by enabling the model to operate on large numbers of cells over many timepoints with high-dimensional features, and by incorporating cellular growth estimates. We validate PRESCIENT on a newly published lineage tracing dataset by evaluating PRESCIENT’s ability to generate held-out timepoints and to predict cell fate bias, i.e. the probability a cell enters a particular fate given its initial state. We show that when accounting for cell proliferation, PRESCIENT outperforms existing methods on predicting cell fate bias. Unlike existing methods, PRESCIENT learns a stochastic, parametric, queryable form of the differentiation landscape via a generative neural network, which enables simulations of high-dimensional trajectories with arbitrary initializations in physical time. This enables simulation of trajectories for cells unobserved during training, including cells with computationally perturbed gene expression profiles, which none of the existing summarization methods or modeling methods are able to do (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). This is also in contrast to other generative methods like scGen, which was proposed for predicting shifts in gene expression space in response to perturbations via autoencoder latent space arithmetic<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. While scGen is a promising approach for generating cell profiles under different perturbations for initializations of PRESCIENT models (Discussion), it is not time resolved, does not generate distributions of cells, and does not explicitly model cellular differentiation. We demonstrate how PRESCIENT can be used to model perturbations of multiple genes, at different time points, and from different starting states. We are able to recover expected changes in final cell fate distributions when interrogating our models using perturbations of known regulators of cell fate in hematopoiesis and pancreatic β cell differentiation. PRESCIENT enables large unbiased in silico perturbation experiments to aid the design of in vitro genetic perturbational screens.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Learning a generative model of cellular differentiation from high-dimensional scRNA-seq data</title>
      <p id="Par6">PRESCIENT models cellular differentiation as a diffusion process over a gene expression landscape parameterized by a potential function that we wish to identify given only time-series population snapshots of single-cell RNA expression. In this diffusion process, evolution of a cell’s state at a given time is governed by a drift term, corresponding to the force acting on that cell given its current state, and a noise term, corresponding to stochasticity. In particular, the drift term is defined to be the negative gradient of the potential function, such that the potential induces a force that naturally drives cells toward regions of low potential (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>; Methods). This stochastic process can then be simulated via first-order time discretization to sample trajectories for a given cell. The potential function is fit by minimizing a regularized Wasserstein loss between empirical and predicted populations at the observed time points (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>; Methods). Previous work has shown the recoverability of diffusion dynamics from cross-sectional observations via this objective function<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
      <p id="Par7">To enable the modeling framework to operate on large scRNA-seq datasets, we fit models on PCA projections of the scaled gene expression data, which has been successfully used in down-stream scRNA-seq analysis methods such as clustering and cross-dataset integration<sup><xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref></sup>. The potential function is given by a neural network, which operates as a black-box function approximator, hence enabling complex parameterizations of the landscape (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>).</p>
      <p id="Par8">Finally, we take into account cell proliferation by weighting each cell in the source population according to its expected number of descendants in the objective. To assess the importance of incorporating cell proliferation, we study models assuming a priori knowledge of cell proliferation, which can be directly estimated from the data by computing the number of descendants for each starting cell given lineage tracing data, as well as models where cell proliferation is estimated from gene expression<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    </sec>
    <sec id="Sec4">
      <title>Fate outcomes generated by PRESCIENT align with experimental lineage tracing when taking into account cell proliferation</title>
      <p id="Par9">We validate our model on a recently published lineage tracing dataset by Weinreb et al. which used DNA barcodes to track clonal trajectories during mouse hematopoiesis<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. We evaluate our model on two tasks: recovery of a held-out time point, and cell fate prediction (Fig. <xref rid="Fig1" ref-type="fig">1d, e</xref>).</p>
      <p id="Par10">We first evaluated whether models were able to recover the marginal cell population at a held-out time point, day 4, when trained only on days 2 and 6, using cells that have lineage tracing data available. We evaluated the Wasserstein distance between the simulated and the empirically observed cell populations for days 4 (testing distance) and 6 (training distance) on the epoch with the lowest training distance. Simulated populations generated by our model outperform baselines, including the distance of the simulated population at day 4 to the actual populations at day 2 and 6, as well as a linearly interpolated population as predicted by WOT<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Fate outcomes generated by PRESCIENT align with experimental lineage tracing when taking into account cell proliferation.</title><p><bold>a</bold> Testing performance of models trained with and without proliferation on the task of recovering the held-out time point, day 4. Performance is reported as Wasserstein distance of simulated population with respect to actual populations at the given time points for models trained without and with proliferation over <italic>n</italic> = 5 seeds. Dashed line indicates distance of linearly interpolated population with respect to the actual population on day 4. <bold>b</bold> Correlation of actual and estimated proliferation rates on day 2 cells with lineage tracing data (<italic>n</italic> = 4638). <bold>c</bold> Examples of <italic>n</italic> = 50 trajectories with starting cells assigned different clonal fate biases. The color-scale indicates time corresponding to 100 time steps of dt = 0.1 starting from <italic>t</italic> = 2. Clonal fate bias is computed with respect to monocyte/neutrophil populations at the final time point. <bold>d</bold> Visualizations of underlying potential and drift functions learned by models with and without cell proliferation. Drift is visualized for a random sample of cells. Dotted circle indicates qualitative differences in potential landscape. <bold>e</bold> Summary of training/test splits of lineage tracing dataset. Training sets either include only cells with lineage tracing data, all cells, or cells without lineage tracing data. <bold>f</bold>–<bold>h</bold>, Performance of other methods (far left, Smoothed fate probabilities given by held-out clonal data, PBA: population balance analysis<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, WOT: Waddington-OT<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, FateID<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> evaluated using predictions provided by Weinreb et al.) in comparison to PRESCIENT (left-right) on predicting clonal fate bias for the same test set (<italic>n</italic> = 335) given different training sets. Training sets either consisted of only cells for which lineage tracing data was available (left), all cells (middle), or cells without lineage tracing data (right). Performance metrics evaluated include <bold>f</bold> Pearson r, <bold>g</bold> AUROC, and <bold>h</bold> fraction of test set in which at least 1 simulated cell at the final time point is either classified as a neutrophil or a monocyte over <italic>n</italic> = 5 seeds. In <bold>b</bold>, <bold>f</bold>–<bold>g</bold>, boxplots indicate median (middle line), first and third quartiles (box), and the upper whisker extends from the edges to the largest value no further than 1.5 × IQR (interquartile range) from the quartiles and the lower whisker extends from the edge to the smallest value at most 1.5 × IQR of the edge, while data beyond the end of the whiskers are outlying points that are plotted individually as diamonds. In <bold>h</bold>, bar plots show the average fraction of cells with error bars representing the 95% CI.</p></caption><graphic xlink:href="41467_2021_23518_Fig2_HTML" id="d32e536"/></fig></p>
      <p id="Par11">We next evaluated on cell fate prediction, which we define to be the task of predicting the clonal fate bias of a given barcoded clone as described by Weinreb et al. This is defined as the number of neutrophils divided by the total number of neutrophils and monocytes for that clone (Methods). To predict, we simulate 2000 trajectories initialized with only the starting cell of each clone until the final time point. For each of these trajectories, we classify the cell at the final time point as neutrophil, monocyte or other using an approximate nearest neighbor (ANN) classifier that had been trained using cell-type labels provided by Weinreb et al. (Methods). We then evaluate the clonal fate bias on the test set, by ensembling predictions over the last 5 evaluated epochs (Figs. <xref rid="Fig2" ref-type="fig">2c, d</xref>, S<xref rid="MOESM1" ref-type="media">2a</xref>). We measure performance as the Pearson correlation with respect to the actual clonal fate bias given by the lineage tracing data, as well as AUROC of classifying a given cell as having a clonal fate bias of &gt;0.5, since the metric is strongly bimodal (Fig. S<xref rid="MOESM1" ref-type="media">2b</xref>).</p>
      <p id="Par12">We first fit a PRESCIENT model on the subset of data for which lineage tracing data is available (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). Figure <xref rid="Fig2" ref-type="fig">2d</xref> depicts the learned potential and drift functions for models trained with and without cell proliferation. Qualitatively, we observe that incorporating cell proliferation changes the potential landscape near the earliest time point. When the model does not take into account cell proliferation, its performance is similar to existing fate prediction methods like Waddington-OT with provided empirically derived cell proliferation (<italic>r</italic> = 0.150, AUROC = 0.599) and FateID (<italic>r</italic> = 0.225, AUROC = 0.602), achieving <italic>r</italic> = 0.196 ± 0.020, AUROC = 0.601 ± 0.006 over 5 seeds. Incorporating empirically derived cell proliferation rates into the PRESCIENT modeling framework greatly improves performance with mean <italic>r</italic> = 0.347 ± 0.029, AUROC = 0.692 ± 0.012, more closely approaching the upper-bound performance estimated using held-out clonal data of <italic>r</italic> = 0.487, AUROC = 0.771 (Figs. <xref rid="Fig2" ref-type="fig">2f, g</xref>; S<xref rid="MOESM1" ref-type="media">2</xref>).</p>
      <p id="Par13">Accounting for cell proliferation improves the performance of the fate prediction task. However, these models were fit with empirically derived cell proliferation rates calculated from the lineage tracing data, which is usually unavailable (Figs. <xref rid="Fig2" ref-type="fig">2e</xref>, S<xref rid="MOESM1" ref-type="media">2c</xref>). We next looked at whether cell proliferation rates derived from gene expression could achieve similar performance. To this end, we modified an approach described by Schiebinger et al.<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> to use KEGG annotations of cell cycle and apoptosis genes which were also highly variable in the dataset to estimate the number of descendants a cell is expected to have. These estimates correlated weakly but significantly (<italic>r</italic> = 0.207, <italic>p</italic> « 1e−45) with the empirical rates calculated from the lineage tracing data (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). We compared models fit to the same set of cells using either our gene-expression-derived or empirical proliferation estimates. We found that models incorporating gene-expression-derived estimates achieved <italic>r</italic> = 0.399 ± 0.025 and AUROC = 0.725 ± 0.008, a slight improvement over empirical proliferation rate based models (Fig. <xref rid="Fig2" ref-type="fig">2f, g</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Generative models can simulate trajectories for cells not observed during training</title>
      <p id="Par14">We next hypothesized that PRESCIENT should be able to predict the fate of cells not observed during training. We expect that the model has learned a good approximation of the underlying potential function from the training data and hence should be able to generalize to unseen data points. To test our hypothesis, we used our proliferation estimates to fit models to all cells with and without lineage tracing data.</p>
      <p id="Par15">We found that model performance was similar when the cells in the test set were included in the training dataset (<italic>r</italic> = 0.391 ± 0.035, AUROC = 0.723 ± 0.013), and when they were not (<italic>r</italic> = 0.407 ± 0.019, AUROC = 0.727 ± 0.014) (Fig. <xref rid="Fig2" ref-type="fig">2f, g</xref>). Furthermore, although performance as measured by correlation and AUROC is similar to when models were fit only on cells with lineage tracing data, the fraction of test set cells for which the model predicted at least one cell entering a neutrophil or monocyte fate increased slightly from 0.74 ± 0.01 to 0.80 ± 0.03 (all cells) and 0.83 ± 0.02 (only cells without lineage tracing data) (Fig. <xref rid="Fig2" ref-type="fig">2h</xref>), suggesting that the models did benefit from observing more data.</p>
    </sec>
    <sec id="Sec6">
      <title>PRESCIENT enables in silico simulations of perturbed cell profiles</title>
      <p id="Par16">The ability to simulate trajectories for unobserved cells allows the model to make predictions of the fate distribution outcome of cells with perturbed gene expression profiles. We demonstrate this ability on two model systems drawn from published studies with time-series scRNA-seq measurements of differentiation. For these experiments, we first simulate trajectories for an unperturbed initialization (Fig. S<xref rid="MOESM1" ref-type="media">2d, e</xref>). We then introduce perturbations to the same initial cell population by introducing different levels of overexpression or knock-down of genes that have been reported in the literature to modulate cell fate outcome (Methods). These perturbations can involve multiple genes, or be introduced at different time points, or in different starting populations. The resulting gene expression profile is then transformed into PCA space to initialize simulations of perturbed cell trajectories.</p>
    </sec>
    <sec id="Sec7">
      <title>PRESCIENT predicts expected changes in cell fate when perturbing transcription factors involved in the regulation of hematopoiesis</title>
      <p id="Par17">We hypothesized that a PRESCIENT model trained on the Weinreb et. al. dataset should be able to recapitulate the effects on cell fate when perturbing transcription factors (TFs) known to be involved in regulation of neutrophil or monocyte differentiation. (Figs. <xref rid="Fig3" ref-type="fig">3a, b</xref>, S<xref rid="MOESM1" ref-type="media">3a, b</xref>). In particular, we focus on a set of TFs previously identified to be potentially antagonistically correlated with either monocyte and neutrophil fate in progenitor cells by MetaCell analyses and CRISPR-seq experiments of a haematopoietic stem cell dataset<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, many of which are supported by existing literature<sup><xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref></sup>.<fig id="Fig3"><label>Fig. 3</label><caption><title>In silico perturbations of hematopoiesis results in expected shifts in fate distribution.</title><p><bold>a</bold> The distribution of cells at the final time-point generated by the model initialized with unperturbed cells (left) and cells with perturbations of <italic>Lmo4, Cebpe, Mxd1</italic>, and <italic>Dach1</italic> upregulated (<italic>z</italic> = 10) during neutrophil differentiation (right). <bold>b</bold> Proportions of generated cell types from day 2 to 6 initialized with unperturbed cells (left) and cells with perturbations of transcription factors upregulated during neutrophil differentiation (right). <bold>c</bold> Fraction of neutrophil and monocyte cells at final time point with single-gene perturbations. Transcription factors involved in monocyte development are indicated in green, while transcription factors involved in neutrophil development are indicated in orange. Control genes (in gray) indicate experiments when perturbing genes from a random set of non-TFs as in (<bold>h</bold>) <bold>d</bold>, <bold>e</bold>, Individual genetic perturbations made to transcription factors involved in neutrophil and monocyte differentiation have an increased effect at higher dosages. <bold>f</bold>–<bold>g</bold> Ensemble perturbations of transcription factors involved in neutrophil (orange) and monocyte (green) differentiation have a stronger effect. <bold>h</bold> Ensemble random perturbations of non-transcription factors without proliferative signatures (gray). In <bold>c</bold>–<bold>h</bold>, boxplots are of randomly initialized unperturbed vs. perturbed simulations (<italic>n</italic> = 10) with 200 cells for each initialization, and red asterisks indicate Welch’s independent two-sided <italic>t</italic>-test at <italic>p</italic> &lt; 0.05. Boxplots indicate median (middle line), first and third quartiles (box), and the upper whisker extends from the edges to the largest value no further than 1.5 × IQR (interquartile range) from the quartiles and the lower whisker extends from the edge to the smallest value at most 1.5 × IQR of the edge, while data beyond the end of the whiskers are outlying points that are plotted individually as diamonds.</p></caption><graphic xlink:href="41467_2021_23518_Fig3_HTML" id="d32e717"/></fig></p>
      <p id="Par18">We first introduced perturbations to <italic>Lmo4, Cebpe, Mxd1</italic>, and <italic>Dach1</italic>, TFs previously identified to be involved in granulopoiesis, the production of mature neutrophils. As expected, we observed that down-regulation of these TFs led to a relative decrease in the fraction of neutrophils while up-regulation of these TFs led to a relative increase in the fraction of neutrophils with respect to the unperturbed population. We next perturbed TFs involved in monocyte development, including <italic>Irf8</italic>, <italic>Irf5</italic>, <italic>Klf4</italic>, and <italic>Nr4a1</italic>, and observed similar results (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>).</p>
      <p id="Par19">We next tested if different magnitudes of the perturbation had different effects (Methods). We found that increasing the magnitude of the perturbation resulted in larger changes in the relative cell fractions (Fig. <xref rid="Fig3" ref-type="fig">3d, e</xref>). Furthermore, while individual perturbations resulted in a mixture of significant and non-significant changes in the final neutrophil populations, ensemble perturbations consistently resulted in significant changes (<italic>p</italic> &lt; 0.05; Fig. <xref rid="Fig3" ref-type="fig">3f, g</xref>). We also tested multiple sets of randomly selected non-TFs to ensure the changes in final cell fate were not simply a result of perturbations causing random model changes. These randomly selected non-TFs do not result in an observed shift in neutrophil and monocyte fates in the final time point (Fig. <xref rid="Fig3" ref-type="fig">3h</xref>), suggesting that our model is robust to random effects.</p>
    </sec>
    <sec id="Sec8">
      <title>PRESCIENT predicts expected outcomes of transcription factor perturbations in endocrine induction introduced at different timepoints and developmental stages</title>
      <p id="Par20">We next applied PRESCIENT to a 7 time-point scRNA-seq time course of another well-characterized differentiation system, the production of pancreatic islet cell types in vitro<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. This dataset did not include lineage tracing measurements.</p>
      <p id="Par21">We first hypothesized that PRESCIENT should be able to recapitulate the effects on cell fate when perturbing TFs known to be involved in the regulation of endocrine induction and specification in the starting population (Fig. <xref rid="Fig4" ref-type="fig">4a, b</xref>). Previous work has shown that <italic>NEUROG3</italic> and <italic>NKX6</italic> activation is associated with the endocrine lineage, while <italic>PTF1A</italic> and <italic>HES1</italic> is associated with the exocrine lineage<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. When introducing ensembled in silico perturbations of <italic>NEUROG3</italic> and <italic>NKX6</italic>.<italic>1</italic> at day 0, we observe an increase in endocrine cell types that scales with the magnitude of perturbations (<italic>p</italic> &lt; 0.05) with a reciprocal decrease in exocrine cell types. <italic>PTF1A</italic> and <italic>HES1</italic> overexpression results in the opposite effect (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). We also observed corresponding decreases in endocrine and exocrine cell proportions with knock-downs of <italic>NEUROG3/NKX6.1</italic> and <italic>PTF1A/HES1</italic>, respectively (Fig. S<xref rid="MOESM1" ref-type="media">4a, b</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>PRESCIENT predicts expected temporal dynamics of in silico perturbations of the endocrine/exocrine axis.</title><p><bold>a</bold> Simplified model of in vitro endocrine induction. Progenitor cells first bifurcate along the endocrine-exocrine axis, and then are specified into more specific pancreatic cell fates. <bold>b</bold> Schematic of steps for different perturbational experiments. First, cells are sampled from either a specific timepoint in the scRNA-seq timecourse or by a specific subtype label. Next, either individual genes or ensembles of genes are perturbed by setting target genes to a higher or lower z-score in scaled gene expression space. This profile is then reduced to principal components. These perturbed cells are then used to initialize a simulation of an already trained PRESCIENT stochastic process, which is simulated forward to the final timepoint. Finally, a pre-trained ANN classifier is used to evaluate the cell-type distribution at the final time-step of the simulation. This distribution is then compared to an unperturbed simulation via a two-sided paired <italic>t</italic>-test. <bold>c</bold> Final fractions of endocrine and exocrine cells as a result of ensembled perturbations of endocrine- and exocrine- associated TFs (top, bottom) on day 0 and day 4 (left, right) with increasing magnitude. Boxplots (as described previously) are of randomly initialized unperturbed vs. perturbed simulations (<italic>n</italic> = 10) with 200 cells for each initialization, and red asterisks indicate Welch’s independent two-sided <italic>t</italic>-test at <italic>p</italic> &lt; 0.05. <bold>d</bold> In silico perturbations are introduced at different time points to the corresponding unperturbed population. The different outcomes of the cell type of interest are then calculated as the difference in fraction at the final time point starting from the perturbed and unperturbed populations. Bar plots show average differences over <italic>n</italic> = 10 randomly sampled cell populations of 200 cells each from each timepoint with error bars representing the 95% CI.</p></caption><graphic xlink:href="41467_2021_23518_Fig4_HTML" id="d32e858"/></fig></p>
      <p id="Par22">We next simulated the effects of TFs involved in the specification of cell types post-endocrine induction, where <italic>ARX</italic> and <italic>PAX4</italic> have previously been shown to have an antagonistic effect on the specification of endocrine precursors to α and β-cell fate, respectively<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref></sup>. Overexpression of <italic>ARX</italic> in progenitor cells at day 0 resulted in significant increases in the final proportion of α cells at the expense of β cells (Fig. S<xref rid="MOESM1" ref-type="media">4c</xref>). The same overexpression of <italic>PAX4</italic> resulted in a significant increase in the final proportion of β cells (<italic>p</italic> &lt; 0.05) at the expense of α cells (Fig. S<xref rid="MOESM1" ref-type="media">4c</xref>).</p>
      <p id="Par23">To demonstrate the scale at which in silico experiments can be conducted, we next did a larger screen of 200+ TFs (Fig. <xref rid="Fig5" ref-type="fig">5a–c</xref>). At FDR &lt; 0.01 and log<sub>2</sub>(FC) &gt; 0.5, we found that this unbiased screen identified 10 (α-specification increase) and 18 (β-specification increase) TFs that significantly increased final cell fate distribution (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). This includes several known fate-specific factors, such as <italic>ARX</italic> and <italic>IRX2</italic> for α-cells<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup> and <italic>NKX2.2</italic>, <italic>NKX6.1</italic>, <italic>PAX4</italic>, <italic>PDX1</italic>, and <italic>MAFA</italic> for β-cells<sup><xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR37">37</xref></sup>. We also identified factors common to both cell lineages, including <italic>MAFB</italic>, <italic>PAX6</italic>, and <italic>ISL1</italic>. <italic>PAX6</italic> has previously been reported to be associated with both α and β-cell fate, but Pax6 mutant mice show a more significant decrease in α-cells, which we also observed<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. In addition, we identified 19 TFs for specification of the less well-studied enterochromaffin (SC-EC) (FDR &lt; 0.01 and log<sub>2</sub>(FC) &gt; 0.5) identified by Veres et al., hence showing how PRESCIENT can be used to generate hypotheses for genetic screens (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). Mean expression of TFs on day 0 was not correlated with predicted log<sub>2</sub>(FC) of cell fraction, showing that we could predict the effects of TFs even if their relative expression was low on day 0 (Fig. S<xref rid="MOESM1" ref-type="media">4d</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><title>PRESCIENT predicts the outcome of transcription factor perturbations in a large perturbational screen as well as the different effects of perturbations in early progenitors vs. cells further along endocrine induction.</title><p><bold>a</bold> Perturbational screen (<italic>z</italic> = 5) of all the TFs in the highly variable gene set of in vitro β-cell differentiation. The <italic>x</italic>-axis is the log<sub>2</sub> fold-change (FC) of the final cell-type fraction of the target cell fraction between perturbed and unperturbed simulations. The <italic>y</italic>-axis is the -log<sub>10</sub>
<italic>p</italic> values of two-sided paired <italic>t</italic>-tests between target cell fate outcomes between unperturbed and perturbed simulations over <italic>n</italic> = 10 randomly sampled starting populations at the final time step consisting of 200 cells each. Points are colored if they are a hit (FDR &lt; 0.01 and log2(FC) &gt; 0.5) and β-cell fractions are shown in purple, α-cells in red, and EC-cells in blue. <bold>b</bold> Difference in final β-cell populations when introducing perturbations (<italic>z</italic> = 5) in different cell populations for different TFs. <bold>c</bold> Difference in final α-cell perturbations when introducing perturbations (<italic>z</italic> = 5) in different cell populations for different TFs. In <bold>b</bold>, <bold>c</bold>, different starting populations correspond to cell stages as labeled by Veres et al.: SOX2+ progenitors (progsox2), NKX61+ progenitors (prognkx61), and cells with early/middle/late NEUROG3 signatures (neurog3early, neurog3mid, neurog3late, respectively). Bar plots show average paired differences over <italic>n</italic> = 10 randomly sampled cell populations of 200 cells from each early subpopulation with error bars representing the 95% CI. Figure <xref rid="MOESM1" ref-type="media">S4e, f</xref> show boxplots of this data.</p></caption><graphic xlink:href="41467_2021_23518_Fig5_HTML" id="d32e1035"/></fig></p>
      <p id="Par24">We next asked if PRESCIENT could recapitulate the known timing of TFs during endocrine induction by introducing perturbations to the same endocrine/exocrine axis TFs described above at multiple timepoints (Methods). Endocrine/exocrine induction is known to occur early in the time-course, and the results corroborate this as early perturbations to <italic>NKX6.1</italic> and <italic>NEUROG3</italic> (<italic>z</italic> = 10) result in an increase in endocrine cells, but this effect diminishes with perturbations induced at later time points (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>).</p>
      <p id="Par25">PRESCIENT also enables perturbations of cells sampled from different starting cell populations along a given differentiation trajectory. To demonstrate this, we introduced perturbations of selected TFs from the above screen to cells sampled from different stages of the endocrine induction pathway as labeled by Veres et al. (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, <italic>NKX2.2</italic>, <italic>NKX6.1</italic>, <italic>PAX4</italic>, and <italic>ARX</italic> are found early in endocrine specification and are often the first signal of the production of specific terminal endocrine cell fates<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. We found that perturbations of these TFs in pancreatic progenitors result in a significant increase in final β-cell proportion (<italic>p</italic> &lt; 0.05) and this effect is minimal in cells further along the endocrine induction pathway (Figs. <xref rid="Fig5" ref-type="fig">5b</xref>, S<xref rid="MOESM1" ref-type="media">4e, f</xref>). In contrast, <italic>PDX1</italic> has been shown to continue to promote β-cell neogenesis late into the endocrine induction pathway<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. We show that perturbations to <italic>PDX1</italic> increase the fraction of β-cells in both progenitor cells and cells with late <italic>NEUROG3</italic> expression (<italic>neurog3late</italic>), recapitulating the multiple contexts in which perturbations to <italic>PDX1</italic> can modulate endocrine fate. Similarly, <italic>MAFA</italic> and <italic>MAFB</italic> are known to continue to modulate fate late into endocrine induction<sup><xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>, and we show that perturbations to both <italic>MAFA</italic> and <italic>MAFB</italic> result in increases in β-cell proportion when introduced to both early pancreatic progenitors and cells in late endocrine induction. While <italic>ISL1</italic> has been previously reported to stimulate islet cell production, the timing of <italic>ISL1</italic> activation is less well characterized. Our model suggests that <italic>ISL1</italic> has a role in β-cell specification in both early pancreatic progenitor phase and late in the endocrine induction pathway.</p>
      <p id="Par26">Finally, we observed that modulation of α-cell fate largely occurs via perturbations induced in the pancreatic progenitor phase of the stage 5 differentiation protocol, with diminished effects of all endocrine-specification TFs in cells with early/mid/late <italic>NEUROG3</italic> expression (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). This could suggest that α-cell determination occurs early in the differentiation protocol. We again observe similar outcomes with in silico knockdown experiments (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>b, e) as well as no effect of perturbations to randomly sampled non-TF genes that are not involved in apoptotic/proliferative signatures (Fig. S<xref rid="MOESM1" ref-type="media">5</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par27">PRESCIENT is a generative modeling framework for learning potential landscapes from population-level time series scRNA-seq data. PRESCIENT marks a departure from the predominant methods for analyzing scRNA-seq studies of cellular differentiation. Computational methods for lineage inference have been dominated by pseudo-time approaches that do not attempt to model the stochastic or dynamic nature of cell fate determination. More recent fate prediction methods either summarize observations of the emergent process or suffer from modeling limitations (see Introduction)<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>. However, we have demonstrated an important predictive advantage to fully generative models that seek to describe the underlying differentiation landscape. After the model has learned the landscape, it can generate trajectories for unseen data points.</p>
    <p id="Par28">We can hence interrogate PRESCIENT to propose hypotheses for possible perturbations. We show that inducing perturbations in well-studied regulatory genes of hematopoiesis and β-cell differentiation result in expected changes in fate outcome. We also show that we can model the differentiation outcomes of complex perturbations consisting of multiple genes, or at different time points or in different starting populations. This enables large, combinatorial in silico experiments that can help limit the number of in vitro experiments needed to achieve a desired cell fate. PRESCIENT can be used to identify targets for genetic- and small molecule-based screens and aid the design and fine-tuning of new directed differentiation and reprogramming protocols<sup><xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR44">44</xref></sup>. We show an example of this type of unbiased, large-scale screen for in vitro β-cell differentiation in which we perturbed 200+ TFs and identified target genes that could cause significant shifts in β-cell, α-cell, and EC-cell fates. While this work was limited to TFs to show the utility of the method, non-TF targets, such as signaling pathway effectors, can also be tested using PRESCIENT. However, the model is subject to constraints and assumptions, for example requiring that the final time point of the dataset be at steady-state. The model also improves when incorporating growth rates, and would likely benefit from better estimates of proliferation. There also remain challenges to confidently suggest gene sets for experimental perturbation. One problem is that information is lost about individual genes when transforming data into PCA space, and lowly-expressed genes important to cell fate decisions may be dropped altogether in the scRNA-seq data. This can be addressed by methods that have proposed ways to directly generate gene expression counts from latent cell states<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, or by approaches that model perturbation profiles in the original gene expression space<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup>. These profiles can then be used to initialize PRESCIENT simulations or even extend PRESCIENT to include end-to-end encoding. Another problem is that the association of certain genes with specific cell fates does not necessarily imply causality.</p>
    <p id="Par29">Future extensions of PRESCIENT would accommodate other data or modeling approaches. For example, PRESCIENT’s objective can be modified to maximize the likelihood of observing individual trajectories given lineage tracing data. Further, first-principle approaches to modeling dynamics such as RNA velocity are complementary approaches that are non-generative but can be used to constrain PRESCIENT models, e.g. RNA velocity has been proposed for constraining flows across timepoints to local velocities within time points<sup><xref ref-type="bibr" rid="CR47">47</xref>–<xref ref-type="bibr" rid="CR49">49</xref></sup>. We expect that integrating additional sources of information or increasing sampling density of timepoints should improve the quality of the underlying landscape inferred.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Identifying the latent dynamics of cellular differentiation</title>
      <p id="Par30">Following Hashimoto et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> we model cellular differentiation as a diffusion process <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{X}}(t)$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq1.gif"/></alternatives></inline-formula> given by the stochastic differential equation<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{dX}}\left(t\right)={{\mu }}\left({\rm{X}}\left(t\right)\right){\rm{dt}}+\sqrt{2{\sigma }^{2}}{\rm{dW}}\left(t\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">dX</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">dt</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:mi mathvariant="normal">dW</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{X}}\left(t\right)$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">X</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq2.gif"/></alternatives></inline-formula> represents the k-dimensional state of a cell at time <italic>t</italic>, <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mu }}({\rm{X}}(t))$$\end{document}</tex-math><mml:math id="M8"><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq3.gif"/></alternatives></inline-formula> is a drift term representing the force acting on a cell given its state, and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{W}}(t)$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="normal">W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq4.gif"/></alternatives></inline-formula> corresponds to unit Brownian motion. In particular, the drift function is defined to be the negative of the gradient of a potential function, <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mu }}({\bf{x}})=-\nabla \Psi ({\bf{x}})$$\end{document}</tex-math><mml:math id="M12"><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq5.gif"/></alternatives></inline-formula>, such that intuitively, the potential function <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Psi ({\boldsymbol{x}})$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq6.gif"/></alternatives></inline-formula> can be thought of as inducing a gradient field driving cells from regions of high potential to low potential. Within the conceptual framework of Waddington’s epigenetic landscape, this potential function corresponds to the height of the landscape. This process can be simulated via first-order time discretization<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{X}}\left(t+\Delta {\rm{t}}\right)={\rm{X}}\left(t\right)+ \mu \left({\rm{X}}\left(t\right)\right)\Delta {\rm{t}}+\sqrt{2{\sigma }^{2}\Delta {\rm{t}}}{\rm{Z}}\left(t\right)$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="normal">X</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">X</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msqrt><mml:mi mathvariant="normal">Z</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{Z}}(t)$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="normal">Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq7.gif"/></alternatives></inline-formula> are i.i.d. standard Gaussians. This converges to the diffusion process as <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {\rm{t}}\to 0$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq8.gif"/></alternatives></inline-formula>.</p>
      <p id="Par31">We define the marginal distribution at time <italic>t</italic> to be <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\rho }}({\bf{x}},t)={\rm{P}}({\rm{X}}(t)={\bf{x}}).$$\end{document}</tex-math><mml:math id="M22"><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq9.gif"/></alternatives></inline-formula> The inference task identifies the potential function <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Psi ({\bf{x}})$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq10.gif"/></alternatives></inline-formula>, and hence the underlying drift function <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu ({\bf{x}})$$\end{document}</tex-math><mml:math id="M26"><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq11.gif"/></alternatives></inline-formula>, given only samples from the marginal distribution <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{\rm{x}}(t)_{\rm{i}}\sim \rho\left({\bf{x}},t\right)\left.\right){\rm{i}}\in \left\{1...{m}_{t}\right\},{\rm{t}}\in \left\{1..n\right\}\}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")"><mml:mrow/></mml:mfenced><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq12.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{t}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq13.gif"/></alternatives></inline-formula>is the number of cells sampled at time <italic>t</italic> and <italic>n</italic> is the number of time points where data was observed. In practice, this data corresponds to gene expression profiles of cells sampled over the course of a time-series experiment.</p>
      <p id="Par32">Inference proceeds by finding the potential function <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varPsi$$\end{document}</tex-math><mml:math id="M32"><mml:mi>Ψ</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq14.gif"/></alternatives></inline-formula> in a family of functions K that minimizes the objective<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{{\rm{min }}}\limits_{\Psi \in {\rm{K}}}\left[\mathop{\sum}\limits _{i=1}^{n}{{\rm{W}}}_{2}({{\hat{\rho }}}\left({t}_{i},{\bf{x}}\right),{{{\rho }}}_{\Psi }({t}_{i},{\bf{x}}))^{2}\right]+\tau \mathop{\sum }\limits_{j=1}^{{m}_{n}}\frac{\Psi ({{\bf{x}}}_{{\bf{j}}})}{{\sigma }^{2}}$$\end{document}</tex-math><mml:math id="M34"><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{i=1}^{n}{{\rm{W}}}_{2}(\hat{{{\rho }}}({t}_{i},{\bf{x}}),{{{\rho }}}_{\Psi }({t}_{i},{\bf{x}}))^{2}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq15.gif"/></alternatives></inline-formula> is the Wasserstein distance between the empirically observed distribution <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\rho }}({t}_{i},{\bf{x}})$$\end{document}</tex-math><mml:math id="M38"><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq16.gif"/></alternatives></inline-formula>and the predicted distribution for a candidate potential function <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\rho }}}_{\Psi }({t}_{i},{\bf{x}})$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq17.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M42"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq18.gif"/></alternatives></inline-formula> is a parameter controlling the strength of the entropic regularizer. To motivate this loss metric, it is helpful to compare to a case in which we can actually observe ground-truth trajectories of a diffusion process <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{X}}(t)$$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="normal">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq19.gif"/></alternatives></inline-formula>, in which case prediction error can be directly measured as the Euclidean distance between observed points along the trajectory and samples from predicted distribution of <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{X}}(t)$$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="normal">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq20.gif"/></alternatives></inline-formula> under the model. Wassertein distance is the direct analog of Euclidean distance when instead considering cross-sectional observations of indistinguishable particles along trajectories of a given diffusion process<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. In our case, each time point in longitudinal scRNA-seq is a cross-section of cell populations along multiple differentiation trajectories.</p>
    </sec>
    <sec id="Sec12">
      <title>Incorporating cell proliferation</title>
      <p id="Par33">Using notation from Feydy et al.<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> computing the Wasserstein distance involves solving the optimization problem<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\rm{min}}\limits_{&lt; {\boldsymbol{\pi }},{\bf{C}} &gt; }\mathop{\sum}\limits_{{\rm{i}},{\rm{j}}}{\pi }_{i,j} C_{i,j}{\rm{s}}.{\rm{t}}.\forall i,j, \pi_{i,j}\ge 0,\mathop{\sum}\limits_{i=1}^{N} \pi_{i,j} = \alpha_{i},\mathop{\sum}\limits_{j}^{M} \pi_{i,j} = \beta_{j}$$\end{document}</tex-math><mml:math id="M48"><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{i,j}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq21.gif"/></alternatives></inline-formula>is an optimal transport plan mapping points from the source measure to the target measure, <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i,j}={||}{{\bf{x}}}_{{\bf{i}}}-{{\bf{y}}}_{{\bf{j}}}|{|}^{2}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∣</mml:mo><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msup><mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq22.gif"/></alternatives></inline-formula>is the squared euclidean distance between point <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{x}}}_{{\bf{i}}}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq23.gif"/></alternatives></inline-formula> and point <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{y}}}_{{\bf{j}}}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq24.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{{i}}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{{j}}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq26.gif"/></alternatives></inline-formula> are positive weights associated with the samples <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{x}}}_{{\bf{i}}}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{y}}}_{{\bf{j}}}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq28.gif"/></alternatives></inline-formula>. Previous models minimizing the Wasserstein loss as described by Hashimoto et al. as well as Schiebinger et al. set the weights <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{i}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq30.gif"/></alternatives></inline-formula> to be constant, hence assuming uniform sampling over the source and target densities. We incorporate cell proliferation into the modeling framework simply by setting <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{i}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq31.gif"/></alternatives></inline-formula>to the number of descendants the cell <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{x}}}_{{\bf{i}}}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq32.gif"/></alternatives></inline-formula> is expected to have, where in this case <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{x}}}_{{\bf{i}}}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq33.gif"/></alternatives></inline-formula> corresponds to samples from the predicted population. The intuition behind this is that a cell that has a larger number of descendants should be mapped to a larger number of cells at the later time point. Weights associated with the empirical population <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq34.gif"/></alternatives></inline-formula> remain constant. Note that in contrast, Schiebinger et al. incorporate cell proliferation by instead using the cell proliferation rates to weaken the marginal constraints, hence reframing the problem as unbalanced optimal transport.</p>
      <p id="Par34">Where lineage tracing data is available, we define the number of descendants a cell is expected to have at time <italic>t</italic> to be the number of cells sharing a particular clonal lineage barcode at <italic>t</italic> divided by the number of cells sharing that clonal lineage barcode at the current time. A pseudocount of 1 is added to allow for dropout.</p>
      <p id="Par35">In the absence of lineage tracing data, we estimate the number of descendants using a modified approach from Schiebinger et al. Let <italic>n</italic> be the number of descendants, <italic>b</italic> be the birth rate, <italic>d</italic> be the death rate, and <italic>g</italic> be growth. Then using a birth-death process, for a given clone,<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n={\rm{exp }}\,\left({\rm{dt}}* \left(b-d\right)\right)$$\end{document}</tex-math><mml:math id="M78"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">dt</mml:mi><mml:mo>*</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=b-d=\frac{{\rm{log }}n}{{\rm{dt}}}$$\end{document}</tex-math><mml:math id="M80"><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">dt</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">To estimate the birth and death scores (<inline-formula id="IEq35"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}^{b}$$\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq35.gif"/></alternatives></inline-formula>,<inline-formula id="IEq36"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}^{d}$$\end{document}</tex-math><mml:math id="M84"><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq36.gif"/></alternatives></inline-formula>), we first calculate the mean of the <italic>z</italic>-scores of genes annotated to birth (KEGG_CELL_CYCLE) and death (KEGG_APOPTOSIS). We use these alternative annotations as many of the genes in the original gene sets proposed by Schiebinger et al. were not present in the set of variable genes in the Weinreb et al. datasets. Then, following Weinreb et al., we smooth these scores over the cells using an iterative procedure:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta {s}_{i}+\frac{1}{{N}_{{K}_{{nn}}}}\mathop{\sum}\limits _{k\in {K}_{{nn}}}\left(1-\beta \right){s}_{k}$$\end{document}</tex-math><mml:math id="M86"><mml:mi>β</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq37"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq37.gif"/></alternatives></inline-formula> is the score for a given cell <italic>i</italic> at the current iteration, <inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{k}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq38.gif"/></alternatives></inline-formula> are the scores for the <italic>k</italic> <italic>=</italic> 20 neighbors of the cell <italic>i</italic> computed on euclidean distance in PCA space, and <inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma =0.1$$\end{document}</tex-math><mml:math id="M92"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq39.gif"/></alternatives></inline-formula>. This smoothing procedure is performed over 5 iterations.</p>
      <p id="Par37">Then, the birth and death scores are fit to logistic functions to obtain the birth and death rates,<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b={L}_{0}+\frac{L}{\left(1+{\rm{exp }}\,(-{k}_{b}{s}_{b})\right.}$$\end{document}</tex-math><mml:math id="M94"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d={L}_{0}+\frac{L}{\left(1+{\rm{exp }}\,(-{k}_{d}{s}_{d})\right.}$$\end{document}</tex-math><mml:math id="M96"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_23518_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">To simplify the fitting procedure, we reasoned that we might expect <inline-formula id="IEq40"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${-s}_{{\min }}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq40.gif"/></alternatives></inline-formula>to be close to 1 to flatten outliers. Hence, we set <italic>k</italic> to be <inline-formula id="IEq41"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.001={\rm{exp }}(-k{s}_{{\min }})$$\end{document}</tex-math><mml:math id="M100"><mml:mn>0.001</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq41.gif"/></alternatives></inline-formula>. Then we set <inline-formula id="IEq42"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{0}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M104"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq43.gif"/></alternatives></inline-formula>based on the expected minimum and maximum growth rates. For the Weinreb et al. dataset, we set <inline-formula id="IEq44"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{0}=0.3$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{L}}=1.2$$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="normal">L</mml:mi><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq45.gif"/></alternatives></inline-formula>, and found the minimum and maximum number of descendants to be similar to that observed in the clonal lineage tracing data at days 4 and 6. We used the same procedure for estimating growth rates on the Veres et al. dataset.</p>
    </sec>
    <sec id="Sec13">
      <title>Model implementation and optimization</title>
      <p id="Par39">We use deep learning methods to learn the parameters of the potential function <inline-formula id="IEq46"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Psi ({\bf{x}})$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq46.gif"/></alternatives></inline-formula>. Automatic differentiation can be used to evaluate the drift function <inline-formula id="IEq47"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mu }}({\bf{x}})=-\Delta \Psi ({\bf{x}})$$\end{document}</tex-math><mml:math id="M112"><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq47.gif"/></alternatives></inline-formula> without having to derive the analytical form. Then, by retaining the computation graph, losses can be calculated with respect to the drift function while gradients are accumulated with respect to the potential function. This allows for more flexible parameterizations of the drift function. For all models, we set <italic>dt</italic> and σ to be 0.1, and τ to be 1e−6.</p>
      <p id="Par40">Optimization of <inline-formula id="IEq48"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Psi ({\bf{x}})$$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23518_Article_IEq48.gif"/></alternatives></inline-formula> was performed using the Adam optimizer with a batch size of 1/10th the size of the training set. Fully connected 2-layer, 400-unit models using softplus as the activation function was used as the architecture for all models. This architecture was chosen using performance on the held-out recovery task on the Weinreb et al. dataset (<xref rid="MOESM1" ref-type="media">Supplementary Note</xref>, Figs. S<xref rid="MOESM1" ref-type="media">1</xref>, S<xref rid="MOESM1" ref-type="media">3</xref>). Models were pre-trained as previously described by Hashimoto et al. by first optimizing only the entropic regularizer via contrastive divergence using stochastic gradient descent with a learning rate of 1e−9. Then, training proceeds at the learning rate described below, with a scheduler that multiplied the learning rate by 0.9 every 100 iterations, and using gradient clipping with a max norm of 0.1. The Wasserstein error is approximated using a multi-scale Sinkhorn algorithm as implemented by the GeomLoss library (v0.2.3), with a scaling of 0.7 and a blur of 0.1. The GeomLoss library allows for efficient, stable computation of gradients that bypasses naive backpropagation<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>.</p>
      <p id="Par41">All models were trained using a single NVIDIA Titan RTX GPU (24GB RAM). All forward simulations, including perturbation simulations, were run on either a single NVIDIA Titan RTX GPU (24GB RAM) or a single GeForce GTX 1080 Ti (11GB RAM). Runtime estimates for training and simulations are provided (Fig. <xref rid="MOESM1" ref-type="media">S1f, g</xref>). Training runtimes were computed using two different individual GPUs on dataset sizes ranging from 1000 to 130,000 cells and the range of training times are ~13 min–1 h. Training with GPU acceleration is necessary for training times to be tractable, and is a one-time cost. For those without access to GPUs, we recommend utilizing Amazon Web Services or Google Cloud GPU resources for training, which should be very low-cost for training a PRESCIENT model. Simulation runtimes were computed by measuring the time to run forward simulations of random initializations of <italic>n</italic> = 400 for a fixed number of steps with 1, 10, 100, 1000, and 10,000 random initializations serially. Simulations can tractably be generated using CPUs or GPUs.</p>
      <p id="Par42">All nearest-neighbors calculations (for eg. for cell-type classification) were calculated using the approximate nearest-neighbors library annoy (<ext-link ext-link-type="uri" xlink:href="https://github.com/spotify/annoy">https://github.com/spotify/annoy</ext-link>).</p>
    </sec>
    <sec id="Sec14">
      <title>Visualization of potential landscapes</title>
      <p id="Par43">The potential landscape learned by the model was visualized by evaluating the potential on a uniform grid in UMAP space. The drift function is visualized as unit arrows, where the point of origin is given by the same grid and the vector is given by the drift evaluated at the point of origin.</p>
    </sec>
    <sec id="Sec15">
      <title>Preprocessing of existing scRNA-seq datasets</title>
      <p id="Par44">Preprocessed data for the Weinreb et al. experiments was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/AllonKleinLab/paper-data/blob/master/Lineage_tracing_on_transcriptional_landscapes_links_state_to_fate_during_differentiation/README.md">https://github.com/AllonKleinLab/paper-data/blob/master/Lineage_tracing_on_transcriptional_landscapes_links_state_to_fate_during_differentiation/README.md</ext-link> (commit: d8f0969)<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. The set of highly variable genes was determined as by Weinreb et al. by first filtering for highly variable genes, and then excluding genes correlated with cell cycle (SPRING, commit: a37bbd0). Normalized gene expression for variable genes was scaled and projected to 50 dimensions via PCA, which was then used as input to the modeling framework. For experiments evaluating the model on the held-out time point, preprocessing was fit to only the training set consisting of days 2 and 6, and then used to transform all data including day 4. For all other experiments, preprocessing was fit to all data across time points. All visualizations using umap were fit with 30 neighbors.</p>
      <p id="Par45">Data for the Veres et al. experiments was downloaded from GEO (GSE114412)<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Raw counts were first pre-processed using the standard Seurat pipeline (v3.1.5)<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> to obtain normalized counts. For feature selection, genes were first filtered for those observed in at least 10 cells. Then, the ‘FindVariableFeatures‘ function was used to identify the top 2500 most variable genes. Scaled gene expression was then computed as for the Weinreb et al. dataset. For projection into PCA space (30 PCs), the variable gene set was filtered again to remove genes correlated with TOP2A (<italic>r</italic> &gt; 0.15), as described by Veres et al. This was used as input to the modeling framework, and for visualization via UMAP. For estimation of proliferation rates, the full variable gene set was used (Fig. S<xref rid="MOESM1" ref-type="media">3a, b, e, f</xref>).</p>
    </sec>
    <sec id="Sec16">
      <title>Experiments on recovery of a held-out time point</title>
      <p id="Par46">For comparison to Waddington-OT (WOT)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, which uses held-out recovery (interpolation) as a benchmark, we fit models via pre-training on day 6 and then trained on days 2 and 6 for evaluation on day 4. Models were fit using only the subset of data for which lineage tracing data was available to enable comparison of models incorporating empirically derived cell proliferation rates. All models were trained for 2500 epochs.</p>
      <p id="Par47">To evaluate the models at a given time point, 10,000 cells were sampled at day 2 with replacement according to the expected cell proliferation rate. Then, the model was used to sample a single trajectory for each of the sampled cells until the time point under evaluation. The Wasserstein distance was then computed between the simulated cell population and the empirically observed cell population. Models were evaluated at day 4 (held-out, testing) and day 6 (training) every 100 training epochs. The testing distance is reported for the epoch with the lowest training error (Fig. S<xref rid="MOESM1" ref-type="media">1c</xref>).</p>
      <p id="Par48">To compute the linear interpolation baseline, we used Waddington-OT (WOT), which uses a similar optimal transport formulation but lacks an explicit parametric form<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. WOT enables recovery of a held-out time point via linear interpolation using transport maps built between sets of cells in early and late time points. To run WOT, we used python code available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/broadinstitute/wot">https://github.com/broadinstitute/wot</ext-link>). The input to WOT is a set of time-point labeled gene expression profiles and growth rates and the output is an optimal transport map. The optimal transport map was built with the full set of cells with lineage barcodes from day 2 (<italic>n</italic> = 4638 cells) to day 6 (<italic>n</italic> = 29,679 cells). The empirical proliferation rates derived from clonal expansion of this set of cells from day 2 to 6 were provided to WOT and three growth iterations were permitted. The parameters for building the optimal transport map were as follows: λ<sub>1</sub> = 1, λ<sub>2</sub> = 50, ε = 1, τ = 10,000. With the transport map built between day 2 and day 6, 10,000 cells at day 4 were interpolated using the interpolate_with_ot() function from WOT. This maps a point at the midpoint of each of the pairs in the optimal transport map. The testing distance of these interpolated points from the observed day 4 cells was computed as reported above.</p>
    </sec>
    <sec id="Sec17">
      <title>Predicting clonal fate bias</title>
      <p id="Par49">To predict clonal fate bias, models were first trained on data from all three time points. Models were fit on three sets of data; (a) the subset of cells for which lineage tracing data is available, (b) the subset of cells for which no lineage tracing data is available, and (c) all cells. Models were trained for 2500 epochs and evaluated every 500 epochs. Then, cells were simulated until the final time point via the first-order discretization as parameterized by the trained model.</p>
      <p id="Par50">We evaluated the clonal fate bias metric described by Weinreb et al. on the test set as defined in their paper. The ANN classifier that we used to classify cells as Neutrophil, Monocyte or other at the final time point was fit with 10 trees, 20 neighbors and using Euclidean distance in PCA space (50 pcs). The model was first fit on a random 80% split of the data. When evaluated on the held-out 20% test split, the model achieved a macro-average f1-score of 0.98. Splits were stratified by cell type. The model was then re-fit to the full dataset. After classification, the clonal fate bias was then computed as the number of neutrophils divided by the total number of monocytes and neutrophils. Since the model did not always predict any cell within the 2000 sampled trajectories to be a monocyte or neutrophil, we also added a pseudocount of 1. In those cases, clonal fate bias would hence be 0.5.</p>
      <p id="Par51">We observed variation in predictions made by models at each epoch (Fig. S<xref rid="MOESM1" ref-type="media">2a</xref>). Since no validation set is available to formulate a stopping criterion, we chose to ensemble predictions over the last 5 epochs evaluated (i.e., epoch 2100, 2200, 2300, 2400, 2500) by taking the mean across the estimated clonal fate bias across those epochs.</p>
      <p id="Par52">In most cases, performance metrics for WOT, PBA, and FateID were calculated using the predictions already pre-computed and made available by Weinreb et al.<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>.</p>
    </sec>
    <sec id="Sec18">
      <title>Introducing and evaluating in silico perturbations</title>
      <p id="Par53">Perturbation experiments were performed similarly to the clonal fate bias experiments, except using perturbed cells as input to the first-order discretization. Generally, perturbations were introduced in silico by setting the scaled normalized expression of target genes to <italic>z</italic>-score values less than 0 for knockdowns and greater than 0 for overexpression. The resulting perturbed gene expression profile was then transformed via PCA into lower-dimensional space for input to forward simulation of the trained model.</p>
      <p id="Par54">For the in vitro hematopoiesis dataset<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, the trained PRESCIENT model used for predicting the effect of in silico perturbations to this dataset was seed 1 and epoch 2500 of a model trained with a neural network architecture of 2 layers of 400 units. For all experiments, 200 undifferentiated cells (annotations from Weinreb et al.) were randomly sampled from day 2 weighted by KEGG-derived growth rate estimates, resulting in biased sampling for actively proliferative cells. These sampled cells were simulated forward 40 steps with a dt of 0.1 to the final time point (day 6). This process was repeated with random initializations of both unperturbed cells and perturbed cells. Cells at the final time point were then classified using the same ANN classifier used for the clonal fate bias experiments. Relevant TFs for the target cell fate were identified by searching the literature for studies that had experimentally verified sets of TFs involved in early cell fate decisions by progenitor populations and the highly variable feature set was filtered for these TFs. Perturbations were focused on monocytes and neutrophils due to the availability of experimentally correlated or confirmed perturbations for these two cell types and the focus of neutrophil/monocyte fate in the Weinreb et al. lineage tracing data. Neutrophil-associated transcription factors were <italic>Lmo4, Cebpe, Mxd1</italic>, and <italic>Dach1</italic>. Monocyte-associated transcription factors were <italic>Irf8</italic>, <italic>Irf5</italic>, <italic>Klf4</italic>, and <italic>Nr4a1</italic>. First, the effect of perturbations to individual genes were tested by perturbing each target gene with a <italic>z</italic>-score of −2.5 for knockdown and 5 for overexpression. To test if there was a significant shift in neutrophil/monocyte cell fractions at the final time point, Welch’s independent two-sided <italic>t</italic>-tests were performed between unperturbed simulations and perturbed simulations for each target TF. Next, the effect of perturbational magnitude was evaluated by introducing perturbations of −2.5, −1, −0.5, 2, 5, and 10 to each target gene individually. The same statistical test was performed in comparison to unperturbed simulations. Next, we tested the effect of ensembled perturbations to cell fate outcome by perturbing sets of TFs with <italic>z</italic>-scores of −2.5, −1, −0.5, 2, 5, and 10. As a control, the ensembled perturbation was repeated with following randomly selected non-TF control genes: <italic>Gch1, Pfn2, Dhrs2, Traf1, Lrrk2, Lgmn, Il13</italic>, and <italic>Sgk1</italic>. The same statistical test was performed in comparison to unperturbed simulations.</p>
      <p id="Par55">For the in vitro beta-cell differentiation dataset<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, we trained PRESCIENT models with a learning rate of 0.001 to prevent model divergence. All other parameters were as in the models trained for clonal fate bias prediction in the Weinreb et al. dataset. The trained PRESCIENT model used for predicting the effect of in silico perturbations to this dataset was seed 1 and epoch 1500 of a model trained with 2 layers of 400 units. The 400-unit model was chosen as it achieved a lower training distance, and epoch 1500 was chosen based on the training curves to prevent overfitting, since we observed that training performance had appeared to have plateaued by that epoch (Fig. S<xref rid="MOESM1" ref-type="media">3c, d</xref>). As with the Weinreb et al. dataset, an ANN classifier with 10 trees, 20 neighbors, and using Euclidean distance in PCA space (30 PCs) was trained to predict cell type on a training set of 80%. On a randomly held-out test set of 20%, the model achieved a macro-average f1 score of 0.939 when discriminating between sc-α, sc-β, sc-EC and other cells. The ANN classifier was then re-fit on the full dataset. For time point sampling experiments, 200 cells were sampled from each time point weighted by KEGG-derived growth rates, based on metadata from Veres et al. Cells were iteratively sampled from days 0–6 and simulated forward with a <italic>dt</italic> (step size parameter of 0.1) to the final time point (day 7) under both unperturbed and perturbed conditions. Perturbations (<italic>z</italic> = −2.5, −1, −0.5, 2, 5, 10) were introduced to sampled cells from each timepoint. To test if there was a significant shift in neutrophil/monocyte cell fractions at the final time point, Welch’s independent two-sided <italic>t</italic>-tests were performed between unperturbed simulations and perturbed simulations for each target TF. For cell-type subpopulation experiments, 200 cells were randomly sampled from the SOX2+ progenitor, NKX6.1+ progenitor, and NEUROG3 early/mid/late, weighted by KEGG-derived growth rates. For the screen of 200+ TFs, 200 cells were first simulated without perturbations and the same cells were simulated with perturbations (<italic>z</italic> = 5) of each TF. This was repeated with 10 random initializations. For each TF, to test for a significant change in final cell-type fractions, two-sided paired <italic>t</italic>-tests were conducted between the unperturbed and perturbed simulations. To show that TF expression at static timepoints is not necessarily indicative of fate bias, a control analysis was completed on the Veres et al. 2019 dataset by computing the log-fold change of each TF between cell types of interest at day 7 and plotted against the log-fold change in cell fraction predicted by PRESCIENT perturbational analysis (Fig. S<xref rid="MOESM1" ref-type="media">4d</xref>).</p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par56">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec20">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41467_2021_23518_MOESM1_ESM.pdf">
          <caption>
            <p>Supplementary Information</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41467_2021_23518_MOESM2_ESM.pdf">
          <caption>
            <p>Peer Review File</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="41467_2021_23518_MOESM3_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks Mahmoud Ibrahim and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Grace Hui Ting Yeo, Sachit D. Saksena.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-021-23518-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jennifer Hammelman and Ernest Fraenkel for helpful discussion and comments. We gratefully acknowledge funding from NIH grants 5 R01 NS109217, 5 R01 HG008754, and 5 R01 HG008363 (D.K.G.) and the National Science Scholarship (PhD) from the Agency for Science, Technology and Research Graduate Academy (G.Y.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Conceptualization, methodology, software, validation, formal analysis, investigation, data curation, writing, visualization: G.Y., S.S.; conceptualization, writing, formal analysis, supervision, funding acquisition: D.K.G.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Data for the Weinreb et al. experiments was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/AllonKleinLab/paper-data/blob/master/Lineage_tracing_on_transcriptional_landscapes_links_state_to_fate_during_differentiation/README.md">https://github.com/AllonKleinLab/paper-data/blob/master/Lineage_tracing_on_transcriptional_landscapes_links_state_to_fate_during_differentiation/README.md</ext-link> (commit: d8f0969)<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Data for the Veres et al. experiments was downloaded from GEO (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE114412">GSE114412</ext-link>)<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Trained models from this study are available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4687963#.YHeXOBNKiU9">https://zenodo.org/record/4687963#.YHeXOBNKiU9</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://www.github.com/gifford-lab/prescient-analysis">https://www.github.com/gifford-lab/prescient-analysis</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>An open-source implementation<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>, documentation, and tutorial vignettes of PRESCIENT is available at <ext-link ext-link-type="uri" xlink:href="https://cgs.csail.mit.edu/prescient/">https://cgs.csail.mit.edu/prescient/</ext-link>. Source code can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/gifford-lab/prescient">https://github.com/gifford-lab/prescient</ext-link>. Notebooks to reproduce figures and analyses are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gifford-lab/prescient-analysis">https://github.com/gifford-lab/prescient-analysis</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par57">D.K.G. is a founder of Think Therapeutics. All other authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferrell</surname>
            <given-names>JE</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>Bistability, bifurcations, and Waddington’s epigenetic landscape</article-title>
        <source>Curr. Biol.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>R458</fpage>
        <lpage>R466</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2012.03.045</pub-id>
        <?supplied-pmid 22677291?>
        <pub-id pub-id-type="pmid">22677291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Wagner, D. E. &amp; Klein, A. M. Lineage tracing meets single-cell omics: opportunities and challenges. <italic>Nat. Rev. Genet</italic>. (2020) 10.1038/s41576-020-0223-2.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Weinreb, C., Rodriguez-Fraticelli, A., Camargo, F. D. &amp; Klein, A. M. Lineage tracing on transcriptional landscapes links state to fate during differentiation. <italic>Science</italic> (2020) 10.1126/science.aaw3381.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biddy</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mapping of lineage and identity in direct reprogramming</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>564</volume>
        <fpage>219</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0744-4</pub-id>
        <?supplied-pmid 30518857?>
        <pub-id pub-id-type="pmid">30518857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <?supplied-pmid 30936559?>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</article-title>
        <source>Nat. Protoc.</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>562</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2012.016</pub-id>
        <?supplied-pmid 22383036?>
        <pub-id pub-id-type="pmid">22383036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>541</volume>
        <fpage>331</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1038/nature21350</pub-id>
        <?supplied-pmid 28102262?>
        <pub-id pub-id-type="pmid">28102262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schiebinger</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimal-transport analysis of single-cell gene expression identifies developmental trajectories in reprogramming</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>928</fpage>
        <lpage>943.e22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.01.006</pub-id>
        <?supplied-pmid 30712874?>
        <pub-id pub-id-type="pmid">30712874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Sagar</surname>
          </name>
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>FateID infers cell fate bias in multipotent progenitors from single-cell RNA-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>379</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4662</pub-id>
        <?supplied-pmid 29630061?>
        <pub-id pub-id-type="pmid">29630061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinreb</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tusi</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Socolovsky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Fundamental limits on dynamic inference from single-cell snapshots</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>E2467</fpage>
        <lpage>E2476</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1714723115</pub-id>
        <?supplied-pmid 29463712?>
        <pub-id pub-id-type="pmid">29463712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>DS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring population dynamics from single-cell RNA-sequencing time series data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>461</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0088-0</pub-id>
        <?supplied-pmid 30936567?>
        <pub-id pub-id-type="pmid">30936567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hashimoto</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Learning population-level diffusions with generative RNNs</article-title>
        <source>Proc. 33rd Int. Conf. Mach. Learn.</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>2417</fpage>
        <lpage>2426</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lotfollahi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>J. scGen predicts single-cell perturbation responses</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>715</fpage>
        <lpage>721</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0494-8</pub-id>
        <?supplied-pmid 31363220?>
        <pub-id pub-id-type="pmid">31363220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id>
        <?supplied-pmid 29608177?>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive Integration of Single-Cell Data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <?supplied-pmid 6687398?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <?supplied-pmid 31740819?>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giladi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell characterization of haematopoietic progenitors and their trajectories in homeostasis and perturbed haematopoiesis</article-title>
        <source>Nat. Cell Biol.</source>
        <year>2018</year>
        <volume>20</volume>
        <fpage>836</fpage>
        <lpage>846</lpage>
        <pub-id pub-id-type="doi">10.1038/s41556-018-0121-4</pub-id>
        <?supplied-pmid 29915358?>
        <pub-id pub-id-type="pmid">29915358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feinberg</surname>
            <given-names>MW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Kruppel-like factor KLF4 is a critical regulator of monocyte differentiation</article-title>
        <source>EMBO J.</source>
        <year>2007</year>
        <volume>26</volume>
        <fpage>4138</fpage>
        <lpage>4148</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.emboj.7601824</pub-id>
        <?supplied-pmid 17762869?>
        <pub-id pub-id-type="pmid">17762869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanna</surname>
            <given-names>RN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The transcription factor NR4A1 (Nur77) controls bone marrow differentiation and the survival of Ly6C- monocytes</article-title>
        <source>Nat. Immunol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>778</fpage>
        <lpage>785</lpage>
        <pub-id pub-id-type="doi">10.1038/ni.2063</pub-id>
        <?supplied-pmid 21725321?>
        <pub-id pub-id-type="pmid">21725321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yamanaka</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impaired granulopoiesis, myelodysplasia, and early lethality in CCAAT/enhancer binding protein epsilon-deficient mice</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>1997</year>
        <volume>94</volume>
        <fpage>13187</fpage>
        <lpage>13192</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.94.24.13187</pub-id>
        <?supplied-pmid 9371821?>
        <pub-id pub-id-type="pmid">9371821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Serwas</surname>
            <given-names>NK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CEBPE-mutant specific granule deficiency correlates with aberrant granule organization and substantial proteome alterations in neutrophils</article-title>
        <source>Front. Immunol.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>588</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2018.00588</pub-id>
        <?supplied-pmid 29651288?>
        <pub-id pub-id-type="pmid">29651288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Charting cellular identity during human in vitro β-cell differentiation</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <fpage>368</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1168-5</pub-id>
        <?supplied-pmid 31068696?>
        <pub-id pub-id-type="pmid">31068696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Meulen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huising</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <article-title>Role of transcription factors in the transdifferentiation of pancreatic islet cells</article-title>
        <source>J. Mol. Endocrinol.</source>
        <year>2015</year>
        <volume>54</volume>
        <fpage>R103</fpage>
        <lpage>R117</lpage>
        <pub-id pub-id-type="doi">10.1530/JME-14-0290</pub-id>
        <?supplied-pmid 25791577?>
        <pub-id pub-id-type="pmid">25791577</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dassaye</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Naidoo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cerf</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Transcription factor regulation of pancreatic organogenesis, differentiation and maturation</article-title>
        <source>Islets</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>13</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1080/19382014.2015.1075687</pub-id>
        <?supplied-pmid 26404721?>
        <pub-id pub-id-type="pmid">26404721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gradwohl</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dierich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>LeMeur</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guillemot</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>neurogenin3 is required for the development of the four endocrine cell lineages of the pancreas</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>1607</fpage>
        <lpage>1611</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.97.4.1607</pub-id>
        <?supplied-pmid 10677506?>
        <pub-id pub-id-type="pmid">10677506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johansson</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Temporal control of neurogenin3 activity in pancreas progenitors reveals competence windows for the generation of different endocrine cell types</article-title>
        <source>Dev. Cell</source>
        <year>2007</year>
        <volume>12</volume>
        <fpage>457</fpage>
        <lpage>465</lpage>
        <pub-id pub-id-type="doi">10.1016/j.devcel.2007.02.010</pub-id>
        <?supplied-pmid 17336910?>
        <pub-id pub-id-type="pmid">17336910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Control of endodermal endocrine development by Hes-1</article-title>
        <source>Nat. Genet.</source>
        <year>2000</year>
        <volume>24</volume>
        <fpage>36</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/71657</pub-id>
        <?supplied-pmid 10615124?>
        <pub-id pub-id-type="pmid">10615124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaefer</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Peifer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Wnt/Beta-catenin signaling regulation and a role for biomolecular condensates</article-title>
        <source>Dev. Cell</source>
        <year>2019</year>
        <volume>48</volume>
        <fpage>429</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1016/j.devcel.2019.01.025</pub-id>
        <?supplied-pmid 30782412?>
        <pub-id pub-id-type="pmid">30782412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collombat</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The simultaneous loss of Arx and Pax4 genes promotes a somatostatin-producing cell fate specification at the expense of the alpha- and beta-cell lineages in the mouse endocrine pancreas</article-title>
        <source>Development</source>
        <year>2005</year>
        <volume>132</volume>
        <fpage>2969</fpage>
        <lpage>2980</lpage>
        <pub-id pub-id-type="doi">10.1242/dev.01870</pub-id>
        <?supplied-pmid 15930104?>
        <pub-id pub-id-type="pmid">15930104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collombat</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Opposing actions of Arx and Pax4 in endocrine pancreas development</article-title>
        <source>Genes Dev.</source>
        <year>2003</year>
        <volume>17</volume>
        <fpage>2591</fpage>
        <lpage>2603</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.269003</pub-id>
        <?supplied-pmid 14561778?>
        <pub-id pub-id-type="pmid">14561778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Generation and phenotype identification of PAX4 gene knockout rabbit by CRISPR/Cas9 system</article-title>
        <source>G3</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>2833</fpage>
        <lpage>2840</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.118.300448</pub-id>
        <?supplied-pmid 29950431?>
        <pub-id pub-id-type="pmid">29950431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papizan</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nkx2.2 repressor complex regulates islet β-cell specification and prevents β-to-α-cell reprogramming</article-title>
        <source>Genes Dev.</source>
        <year>2011</year>
        <volume>25</volume>
        <fpage>2291</fpage>
        <lpage>2305</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.173039.111</pub-id>
        <?supplied-pmid 22056672?>
        <pub-id pub-id-type="pmid">22056672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaffer</surname>
            <given-names>AE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nkx6.1 controls a gene regulatory network required for establishing and maintaining pancreatic Beta cell identity</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003274</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1003274</pub-id>
        <?supplied-pmid 23382704?>
        <pub-id pub-id-type="pmid">23382704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaffer</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Freude</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Nkx6 transcription factors and Ptf1a function as antagonistic lineage determinants in multipotent pancreatic progenitors</article-title>
        <source>Dev. Cell</source>
        <year>2010</year>
        <volume>18</volume>
        <fpage>1022</fpage>
        <lpage>1029</lpage>
        <pub-id pub-id-type="doi">10.1016/j.devcel.2010.05.015</pub-id>
        <?supplied-pmid 20627083?>
        <pub-id pub-id-type="pmid">20627083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gannon</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pdx-1 function is specifically required in embryonic beta cells to generate appropriate numbers of endocrine cell types and maintain glucose homeostasis</article-title>
        <source>Dev. Biol.</source>
        <year>2008</year>
        <volume>314</volume>
        <fpage>406</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ydbio.2007.10.038</pub-id>
        <?supplied-pmid 18155690?>
        <pub-id pub-id-type="pmid">18155690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Artner</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MafA and MafB regulate genes critical to beta-cells in a unique temporal manner</article-title>
        <source>Diabetes</source>
        <year>2010</year>
        <volume>59</volume>
        <fpage>2530</fpage>
        <lpage>2539</lpage>
        <pub-id pub-id-type="doi">10.2337/db10-0190</pub-id>
        <?supplied-pmid 20627934?>
        <pub-id pub-id-type="pmid">20627934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>St-Onge</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sosa-Pineda</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chowdhury</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mansouri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gruss</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Pax6 is required for differentiation of glucagon-producing alpha-cells in mouse pancreas</article-title>
        <source>Nature</source>
        <year>1997</year>
        <volume>387</volume>
        <fpage>406</fpage>
        <lpage>409</lpage>
        <pub-id pub-id-type="doi">10.1038/387406a0</pub-id>
        <?supplied-pmid 9163426?>
        <pub-id pub-id-type="pmid">9163426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sander</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic analysis reveals that PAX6 is required for normal transcription of pancreatic hormone genes and islet development</article-title>
        <source>Genes Dev.</source>
        <year>1997</year>
        <volume>11</volume>
        <fpage>1662</fpage>
        <lpage>1673</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.11.13.1662</pub-id>
        <?supplied-pmid 9224716?>
        <pub-id pub-id-type="pmid">9224716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Y-P</given-names>
          </name>
          <name>
            <surname>Thorel</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boyer</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Herrera</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>CVE</given-names>
          </name>
        </person-group>
        <article-title>Context-specific α- to-β-cell reprogramming by forced Pdx1 expression</article-title>
        <source>Genes Dev.</source>
        <year>2011</year>
        <volume>25</volume>
        <fpage>1680</fpage>
        <lpage>1685</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.16875711</pub-id>
        <?supplied-pmid 21852533?>
        <pub-id pub-id-type="pmid">21852533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MafA and MafB activity in pancreatic β cells</article-title>
        <source>Trends Endocrinol. Metab.</source>
        <year>2011</year>
        <volume>22</volume>
        <fpage>364</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tem.2011.05.003</pub-id>
        <?supplied-pmid 21719305?>
        <pub-id pub-id-type="pmid">21719305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeo</surname>
            <given-names>GHT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multiplexed barcodelet single-cell RNA-seq approach elucidates combinatorial signaling pathways that drive ESC differentiation</article-title>
        <source>Cell Stem Cell</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>938</fpage>
        <lpage>950.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2020.04.020</pub-id>
        <?supplied-pmid 32459995?>
        <pub-id pub-id-type="pmid">32459995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR activation screens systematically identify factors that drive neuronal fate and reprogramming</article-title>
        <source>Cell Stem Cell</source>
        <year>2018</year>
        <volume>23</volume>
        <fpage>758</fpage>
        <lpage>771.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2018.09.003</pub-id>
        <?supplied-pmid 30318302?>
        <pub-id pub-id-type="pmid">30318302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Luginbühl, J. et al. Decoding neuronal diversification by multiplexed single-cell RNA-Seq. <italic>Stem Cell Reports</italic> (2021) 10.1016/j.stemcr.2021.02.006.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Shiffman, M. et al. Reconstructing probabilistic trees of cellular differentiation from single-cell RNA-seq data. <italic>arXiv [q-bio.QM]</italic> (2018).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellBox: interpretable machine learning for perturbation biology with application to the design of cancer combination therapy</article-title>
        <source>Cell Syst.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>128</fpage>
        <lpage>140.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2020.11.013</pub-id>
        <?supplied-pmid 33373583?>
        <pub-id pub-id-type="pmid">33373583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>560</volume>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id>
        <?supplied-pmid 30089906?>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Bergen, V., Lange, M., Peidli, S., Wolf, F. A. &amp; Theis, F. J. Generalizing RNA velocity to transient cell states through dynamical modeling. <italic>Nat. Biotechnol</italic>. (2020) 10.1038/s41587-020-0591-3.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Tong, A., Huang, J., Wolf, G., van Dijk, D. &amp; Krishnaswamy, S. TrajectoryNet: A Dynamic Optimal Transport Network for Modeling Cellular Dynamics. <italic>arXiv [stat.ML]</italic> (2020).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dirr</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peletier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Large deviations and gradient flows</article-title>
        <source>Philos. Trans. A Math. Phys. Eng. Sci.</source>
        <year>2013</year>
        <volume>371</volume>
        <fpage>20120341</fpage>
        <?supplied-pmid 24249769?>
        <pub-id pub-id-type="pmid">24249769</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Feydy, J. et al. Interpolating between Optimal Transport and MMD using Sinkhorn Divergences. in (eds. Chaudhuri, K. &amp; Sugiyama, M.) vol. 89 2681–2690 (PMLR, 2019).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <?supplied-pmid 29608179?>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Saksena, S. D. &amp; Yeo, G. <italic>gifford-lab/prescient: Software release of PRESCIENT</italic>. (2021). 10.5281/zenodo.4683408. 10/02/2020; 04/22/2021.</mixed-citation>
    </ref>
  </ref-list>
</back>
