<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">DNA Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">DNA Res</journal-id>
    <journal-id journal-id-type="publisher-id">dnares</journal-id>
    <journal-title-group>
      <journal-title>DNA Research: An International Journal for Rapid Publication of Reports on Genes and Genomes</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1340-2838</issn>
    <issn pub-type="epub">1756-1663</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10799318</article-id>
    <article-id pub-id-type="pmid">38134958</article-id>
    <article-id pub-id-type="doi">10.1093/dnares/dsad027</article-id>
    <article-id pub-id-type="publisher-id">dsad027</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00774</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MCPtaggR: R package for accurate genotype calling in reduced representation sequencing data by eliminating error-prone markers based on genome comparison</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0869-6626</contrib-id>
        <name>
          <surname>Furuta</surname>
          <given-names>Tomoyuki</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Kurashiki, Okayama</addr-line>, <country country="JP">Japan</country></aff>
        <xref rid="c1" ref-type="corresp"/>
        <!--f.tomoyuki@okayama-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Toshio</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Kurashiki, Okayama</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="c1">To whom correspondence should be addressed. Tel: +81-86-434-1208. Fax: +81-86-434-1208. Email: <email>f.tomoyuki@okayama-u.ac.jp</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-22">
      <day>22</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>31</volume>
    <issue>1</issue>
    <elocation-id>dsad027</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Kazusa DNA Research Institute.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dsad027.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Reduced representation sequencing (RRS) offers cost-effective, high-throughput genotyping platforms such as genotyping-by-sequencing (GBS). RRS reads are typically mapped onto a reference genome. However, mapping reads harbouring mismatches against the reference can potentially result in mismapping and biased mapping, leading to the detection of error-prone markers that provide incorrect genotype information. We established a genotype-calling pipeline named mappable collinear polymorphic tag genotyping (MCPtagg) to achieve accurate genotyping by eliminating error-prone markers. MCPtagg was designed for the RRS-based genotyping of a population derived from a biparental cross. The MCPtagg pipeline filters out error-prone markers prior to genotype calling based on marker collinearity information obtained by comparing the genome sequences of the parents of a population to be genotyped. A performance evaluation on real GBS data from a rice F<sub>2</sub> population confirmed its effectiveness. Furthermore, our performance test using a genome assembly that was obtained by genome sequence polishing on an available genome assembly suggests that our pipeline performs well with converted genomes, rather than necessitating <italic toggle="yes">de novo</italic> assembly. This demonstrates its flexibility and scalability. The R package, MCPtaggR, was developed to provide functions for the pipeline and is available at <ext-link xlink:href="https://github.com/tomoyukif/MCPtaggR" ext-link-type="uri">https://github.com/tomoyukif/MCPtaggR</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>genotyping</kwd>
      <kwd>genome comparison</kwd>
      <kwd>next-generation sequencing</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Society for the Promotion of Science</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001691</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JP20K15503</award-id>
        <award-id>JP23H02185</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1. Introduction</title>
    <p>Next-generation sequencing (NGS) has enabled us to simultaneously obtain high-resolution genotypic information from a large number of samples.<sup><xref rid="CIT0001" ref-type="bibr">1</xref></sup> NGS provides genotyping platforms with remarkably improved flexibility and throughput and is now routinely used in diverse fields of biology.<sup><xref rid="CIT0002" ref-type="bibr">2–4</xref></sup> Nevertheless, obtaining genome-wide genotype information via whole-genome resequencing (WGR) is an expensive option for researchers.<sup><xref rid="CIT0005" ref-type="bibr">5</xref></sup> Numerous reduced representation sequencing (RRS) methods have been introduced to meet the demand for cost-effective genotyping systems using dense markers.<sup><xref rid="CIT0006" ref-type="bibr">6</xref></sup> Since restriction site-associated DNA sequencing (RAD-seq) was first published in 2007,<sup><xref rid="CIT0007" ref-type="bibr">7</xref></sup> several derivative methods have been introduced, including ddRADseq<sup><xref rid="CIT0008" ref-type="bibr">8</xref></sup> and genotyping-by-sequencing (GBS).<sup><xref rid="CIT0009" ref-type="bibr">9</xref>,<xref rid="CIT0010" ref-type="bibr">10</xref></sup></p>
    <p>To identify genotypes at single-nucleotide polymorphism (SNP) markers, NGS reads are typically mapped onto one reference sequence. However, several studies have reported that mapping reads on one reference causes the detection of error-prone SNP markers owing to mismapping and biased mapping of NGS reads derived from non-reference genomes.<sup><xref rid="CIT0011" ref-type="bibr">11–13</xref></sup> In addition to genotyping a population derived from a distant cross, such as interspecific crosses conducted in plants,<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> these error-prone markers have also been observed in genetic studies of bacteria and humans.<sup><xref rid="CIT0011" ref-type="bibr">11–13</xref></sup> Read mismapping may have been caused by structural differences between the reference genome and genomes that were genotyped. Translocations of genome segments potentially result in reads that can be mapped to the same location in the reference genome but actually originate from another location in the genomes of genotyped samples.<sup><xref rid="CIT0015" ref-type="bibr">15</xref></sup> Biased mapping, also known as reference bias, occurs because of the methodological nature of read alignment.<sup><xref rid="CIT0016" ref-type="bibr">16</xref>,<xref rid="CIT0017" ref-type="bibr">17</xref></sup> Sequencing reads derived from a non-reference genome have mismatches with reference sequences. These mismatches cause sequencing reads to be simultaneously mapped to multiple locations with the same probability or even unmapped.<sup><xref rid="CIT0016" ref-type="bibr">16</xref></sup> Because read alignment is achieved by evaluating the sequence matches between a query sequence and a subject sequence, the reference allele reads can be preferentially mapped to the reference genome. In such situations, a genome graph representing a pan-genome sequence is a solution to avoid these errors.<sup><xref rid="CIT0018" ref-type="bibr">18</xref></sup> Variations, including SNPs, insertions and deletions (indels), and translocations, represented in the genome graph prevent mismapping and biased mapping. Although this approach effectively improves the genotyping accuracy, genome graph construction and read alignment remain computationally challenging. Other types of graph-based approaches have also been proposed.<sup><xref rid="CIT0019" ref-type="bibr">19–21</xref></sup> These graph-based approaches require a list of SNPs validated as reliable and call genotypes based on the SNP list. However, these lists of validated SNPs are typically not available for genetic mapping and plant breeding populations because scientists and breeders tend to use a unique combination of parents to create a population. Therefore, a simple and flexible SNP-genotyping pipeline is required to avoid mismapping and biased mapping.</p>
    <p>This study introduces the mappable collinear polymorphic tag genotyping (MCPtagg) pipeline and the R package MCPtaggR, which provides functions for MCPtagg. MCPtagg is a pipeline for processing RRS data to precisely detect SNPs and count reads on reliable tags (short genome segments) that were validated based on genome comparison information. The current version of the pipeline supports a population derived from a biparental cross. First, a simulation study illustrates how structural differences in genomes can lead to the emergence of error-prone markers in GBS data. We then assess the performance of MCPtaggR using real data, comparing it with the well-established pipeline TASSEL-GBS.<sup><xref rid="CIT0022" ref-type="bibr">22</xref></sup> Finally, the simplicity, efficiency, and flexibility of the MCPtagg pipeline and the MCPtaggR implementation are discussed.</p>
  </sec>
  <sec id="s2">
    <title>2. Materials and methods</title>
    <sec id="s3">
      <title>2.1. 
<italic toggle="yes">In silico</italic> genome digestion and digested-tag alignment</title>
      <p>To simulate the digestion of genomic DNA in GBS library preparation, <italic toggle="yes">in silico</italic> digestion was performed on the genome sequences of the cultivated rice <italic toggle="yes">Oryza sativa</italic> cv. Nipponbare (NB), and wild rice <italic toggle="yes">O. longistaminta</italic> (OL). The NB and OL genome sequences were downloaded from RAP-DB<sup><xref rid="CIT0023" ref-type="bibr">23</xref></sup> and <italic toggle="yes">Oryza longistaminata</italic> Information Resource,<sup><xref rid="CIT0024" ref-type="bibr">24</xref></sup> respectively. The obtained FASTA files of the genome sequences were loaded into the R environment using the Biostrings package, version 2.68.1.<sup><xref rid="CIT0025" ref-type="bibr">25</xref></sup> Since the real sequencing reads used in this study were obtained by GBS with KpnI and MspI (see Section 2.5), the recognition sequences of KpnI and MspI were searched in the given genome sequences using the DigestDNA function in the DECIPHER package, version 2.0.<sup><xref rid="CIT0026" ref-type="bibr">26</xref></sup> The <italic toggle="yes">in silico</italic> digested fragments were filtered to retain only those with a KpnI cut site at one end and an MspI cut site at the other end, which could potentially be sequenced in real GBS. To simulate the sequencing reads generated by NGS, fragment sequences were cropped to retain a maximum of 75 bp from both ends. The 75-bp cropped sequences, referred to as digested-tags, from the KpnI and MspI cut sites, were treated as Read1 and Read2 of typical paired-end sequencing output and stored in FASTQ files, respectively. Phred scores for the reads were set to ‘;’ indicating the quality score is 26 for all nucleotides, which was the default behaviour of the writeXStringSet function in the Biostrings package. Each set of digested-tags generated from the NB and OL genomes was aligned to the NB genome using BWA-MEM, version 0.7.17.<sup><xref rid="CIT0027" ref-type="bibr">27</xref></sup> The flags ‘-S -P’ were set to run BWA-MEM with skipping read pairing and mate rescue to allow the tags mapped to their best matching locations regardless of mate read mapping locations.</p>
    </sec>
    <sec id="s4">
      <title>2.2. Evaluation of digested-tag alignments</title>
      <p>The alignment results of the digested-tags were evaluated using the following steps. The output files generated by BWA-MEM, which store the alignments of the NB- and OL-digested-tags on the NB genome, were imported into the R environment using the Rsamtools package, version 2.16.0.<sup><xref rid="CIT0028" ref-type="bibr">28</xref></sup> First, unmapped reads were filtered from the imported alignment data. In general, genotype-calling pipelines filter multiple mapping reads mapped to multiple locations with the same mapping quality. Therefore, multiple mapping reads were filtered out based on the information stored in the XA tag of the SAM file, which shows the additional mapping locations of the reads. This filtering retained only reads uniquely mapped on single locations that were the origins of the digested-tags in the case of the NB-digested-tags. Subsequently, tag alignment locations were searched to identify genome locations where both NB- and OL-digested-tags were mapped (co-mapped sites). The co-mapped sites were classified into two types based on the number of mapped OL-digested-tags: single-tag sites and multi-tag sites, where only one and multiple tags were mapped, respectively (<xref rid="F1" ref-type="fig">Fig. 1A</xref>). Finally, the collinearity of the origins of tags between genomes was evaluated. Collinearity between genomes refers to the conservation of sequence order and orientation across different genomes. Genome regions that have collinearity are defined as collinear blocks. Collinear blocks between the NB and OL genomes (<xref rid="F1" ref-type="fig">Fig. 1B</xref>) were searched using the functions of MUMmer4<sup><xref rid="CIT0029" ref-type="bibr">29</xref></sup> as follows. Repeat sequences in the genomes were masked using RepeatMasker<sup><xref rid="CIT0030" ref-type="bibr">30</xref></sup> with the arguments ‘-excln -s -no_is -species rice’ and the RepBase RepeatMasker Edition library downloaded from <ext-link xlink:href="https://www.girinst.org" ext-link-type="uri">www.girinst.org</ext-link> prior to processing using MUMmer to reduce the unnecessary computation time to find sequence matches between repeat sequences. The masked genomes were processed using the nucmer function with the parameters ‘--maxmatch -g 1000’ followed by filtering on the outputs using the delta-filter function with the setting ‘-1’. Collinear block coordinates were summarized using the show-coords function with the setting ‘-CTlr’. Intervals between collinear blocks can also be assumed to conserve relative positions in the genomes. Therefore, these intervals were considered collinear (<xref rid="F1" ref-type="fig">Fig. 1B</xref>). If the origins of the NB and OL tags mapped to single-tag sites were located in the corresponding collinear blocks or intervals in the NB and OL genomes, respectively, the single-tag sites were recorded as collinear tag sites (<xref rid="F1" ref-type="fig">Fig. 1C</xref>). For each non-collinear tag site, the physical distance was measured between the start position of the block/interval in which the OL tag was mapped and the start position of the collinear block/interval in the NB genome, corresponding to the origin of the OL tag in the OL genome (<xref rid="F1" ref-type="fig">Fig. 1D</xref>). If the OL tags of the non-collinear tag sites originated from chromosomes that were different from the chromosomes where the OL tags were mapped in the NB genome, these sites were counted as interchromosomal alignment sites (<xref rid="F1" ref-type="fig">Fig. 1E</xref>).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Collinearity assessment of the digested-tags. (A) The locations, at which the NB- and OL-digested-tags were mapped, were classified into single-tag sites and multiple-tag sites. Single-tag sites are the genome locations where single NB and OL tags were mapped, whereas multi-tag sites have multiple OL tags. NB and OL tags are represented by green and blue lines in the schematic image. (B) The NB and OL genomes were segmented in collinear blocks and intervals. (C) A single-tag site was classified as a collinear-tag site if the OL tag that was mapped at the single-tag site originated from the collinear block/interval corresponding to the block/interval of the single-tag site. Magenta arrows point to the origins of the OL tags in the OL genome. (D) If a single-tag site was a non-collinear tag site, the physical distance was measured between the start position of the block/interval in which the OL tag was mapped and the start position of the collinear block/interval in the NB genome corresponding to the origin of the OL tag in the OL genome. The magenta double-headed arrow indicates the distance to be measured. (E) If an OL tag originated from a chromosome that does not correspond to the chromosome where the OL tag was mapped in the NB genome, the site was assigned as an interchromosomal alignment site.</p>
        </caption>
        <graphic xlink:href="dsad027_fig1" position="float"/>
      </fig>
    </sec>
    <sec id="s5">
      <title>2.3. Algorithm of MCPtagg</title>
      <p>MCPtagg was designed for the RRS-based genotyping of a population derived from a biparental cross. The pipeline requires the genome sequences of parents and NGS reads obtained using RRS from a population derived from a biparental cross. Before mapping reads, the pipeline prepares a list of MCP tags. First, a whole-genome sequence comparison detects collinear blocks, each of which is a pair of genomic regions sharing identical or similar sequences that can be found at one locus in each parental genome and are arranged in the same order in both parental genomes (<xref rid="F2" ref-type="fig">Fig. 2A</xref>). The SNPs in the collinear blocks are used as SNP markers for subsequent genotype calling. Thereafter, <italic toggle="yes">in silico</italic> digestion of the genomes simulates the restriction fragments generated during library preparation for the RRS (<xref rid="F2" ref-type="fig">Fig. 2B</xref>). To simulate the NGS reads obtained by sequencing the restriction fragments, the simulated sequences are clipped to ensure that they are less than or equal to the maximum read length. In this step, the algorithm identifies SNPs that are potentially undetectable in genotype calling because there were no restriction sites close enough to be sequenced (<xref rid="F2" ref-type="fig">Fig. 2B</xref>). All the simulated reads from both genomes are simultaneously mapped to the genomes (<xref rid="F2" ref-type="fig">Fig. 2C</xref>). Based on the mapping results, the filtering step retains only SNPs at which the simulated reads can be uniquely mapped onto each genome at the correct positions (<xref rid="F2" ref-type="fig">Fig. 2D</xref>). If a simulated read is mapped to multiple locations in both or either of the genomes, the read in real data can potentially cause mismapping if it is mapped to one reference genome. The algorithm then lists MCP tags that are the genomic sequences/regions where the simulated reads are uniquely and completely mappable, located in the collinear blocks, and harbour SNPs. Genotype calling is accomplished by mapping real NGS reads to MCP tags. Reads mapped to the corresponding SNP positions on the MCP tags in each genome without any mismatches and indels are counted to determine the genotypes at the SNP markers.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Schematic of the MCPtagg algorithm and the MCPtaggR workflow. (A) The MCPtagg pipeline requires the SNPs (indicated by magenta X symbols) and collinear blocks (indicated by yellow boxes) information that can be obtained by comparing two genomes using the genome sequence comparison tool MUMmer. (B) Subsequently, the pipeline conducts <italic toggle="yes">in silico</italic> digestion of the genomes to simulate sequencing reads generated in an NGS run. Restriction sites are indicated by blue and green arrows. The grey dashed rectangle indicates an example that a restriction site of a restriction enzyme is missing in genome B. (C) The simulated reads are mapped to both genomes simultaneously. (D) Based on the mapping results, the algorithm detects MCP tags (indicated by the magenta dashed rectangle). The grey dashed rectangle indicates a region where the simulated read failed to map uniquely and completely. (E) The schematic image represents the MCPtaggR workflow for genotype calling. The texts in rectangles display input and output files, whereas the bold texts indicate the function names. The arrows represent data flow through the pipeline.</p>
        </caption>
        <graphic xlink:href="dsad027_fig2" position="float"/>
      </fig>
    </sec>
    <sec id="s6">
      <title>2.4. Implementation of the MCPtagg pipeline in MCPtaggR</title>
      <p>The R package, MCPtaggR, provides functions for the MCPtagg pipeline (<xref rid="F2" ref-type="fig">Fig. 2E</xref>). Collinear block detection and read mapping require the external tools, MUMmer<sup><xref rid="CIT0029" ref-type="bibr">29</xref></sup> and Subread,<sup><xref rid="CIT0031" ref-type="bibr">31</xref></sup> respectively. The run_mummer() function is a wrapper function that internally executes MUMmer functions to identify collinear blocks and SNPs. FASTA files of the reference and alternative genomes set to run_mummer() are used to count the reference and alternative allele reads in the read-counting step. The mummer2SNPs() function converts and organizes the MUMmer outputs into a list of candidate MCP tags. The digestGenome() and alignTAG() functions perform <italic toggle="yes">in silico</italic> genome digestion and simulated read mapping. The outputs from both functions are used as inputs for the findMCPtag() function to list the MCP tags. The function mcptagg() performs read mapping to the MCP tags and outputs read counts and genotype calls in a variant call format (VCF) file<sup><xref rid="CIT0032" ref-type="bibr">32</xref></sup> and a genomic data structure (GDS) file.<sup><xref rid="CIT0033" ref-type="bibr">33</xref></sup> The output GDS file can be directly manipulated using the GBScleanR package, which provides functions for filtering, data visualization, and genotyping error correction.<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> The alignTAG() and mcptagg() functions internally execute the align() function in the Rsubread package for read mapping.<sup><xref rid="CIT0034" ref-type="bibr">34</xref></sup></p>
    </sec>
    <sec id="s7">
      <title>2.5. Genotype calling using TASSEL-GBS and MCPtaggR</title>
      <p>To assess the advantages of MCPtaggR for genotype calling, its performance was compared with that of the well-established genotype-calling pipeline TASSEL-GBS.<sup><xref rid="CIT0022" ref-type="bibr">22</xref></sup> Both tools were subjected to genotype calling using previously published GBS reads obtained from 813 F<sub>2</sub> samples derived from a cross between distant rice relatives NB and OL.<sup><xref rid="CIT0035" ref-type="bibr">35</xref></sup> Reference genome sequences for NB and OL were obtained as described above. The NB genome was used as a reference in the TASSEL-GBS pipeline, and the NB and OL genomes were used as a reference and an alternative to MCPtaggR, respectively. Read data for the F<sub>2</sub> samples were obtained from the sequence read archive (SRA) (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/sra</ext-link>) by querying project ID PRJDB5346. These reads were originally obtained in GBS with a KpnI–MspI RE pair using MiSeq with 75-bp paired-end sequencing. Because the reads deposited in the SRA were demultiplexed and had no barcode sequences required for processing using TASSEL-GBS, dummy barcode sequences were concatenated to all reads using the bardcode_faker function available at <ext-link xlink:href="https://github.com/labroo2/rtassel_supp" ext-link-type="uri">https://github.com/labroo2/rtassel_supp</ext-link>. The scripts used for genotype calling are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. The genotype call data obtained were subjected to SNP filtering using the following criteria:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) SNPs that were biallelic between parents and monomorphic in each parent were retained.</p>
        </list-item>
        <list-item>
          <p>(2) SNPs that were completely missing in the F<sub>2</sub> samples were removed.</p>
        </list-item>
        <list-item>
          <p>(3) The first SNP was retained when multiple SNPs were found within a 75-bp stretch.</p>
        </list-item>
      </list>
      <p>Because the genotype data generated by MCPtaggR were supposed to contain only SNPs that met criterion (1), filtering based only on criteria (2) and (3) was applied to the MCPtaggR output. RRS-based genotype data usually contain numerous errors, including heterozygote undercalling, which is a typical error that incorrectly identifies a homozygote at a heterozygous site. Therefore, the obtained genotype data were processed using GBScleanR to correct errors and estimate allele dosage.<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> The scripts used to execute the filtering and dosage estimation are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
    </sec>
    <sec id="s8">
      <title>2.6. Evaluation of genotype call data</title>
      <p>Genotype call data obtained using MCPtaggR and TASSEL-GBS were evaluated based on the estimated dosage generated by GBScleanR as raw genotype data containing a large number of missing values and erroneous calls, including heterozygote undercallings, which could prevent the systematic evaluation of software performance. The number of recombinations in which the genotype calls changed from one to another was counted in the estimated dosage data. The middle points of the physical positions of the markers, indicating recombination, were considered recombination breakpoints. The number of double crossovers was also evaluated by counting the number of genome segments in which the estimated dosage was heterozygous and flanked by homozygous segments of the same allele; for example, a heterozygous segment flanked by reference homozygous segments on both sides.</p>
      <p>It was expected that SNP markers supported by non-collinear tags would show more frequent mismapped reads than those supported by collinear tags. Therefore, the mismapping rate per marker was estimated by calculating the proportion of genotype calls that were heterozygous in the raw genotype data, but homozygous in the estimated dosage data. The SNP markers were classified into three groups: (1) those commonly found by MCPtaggR and TASSEL-GBS, (2) TASSEL-GBS only, and (3) MCPtaggR only. The statistical significance of the difference in mismapping rates between the three marker groups was tested using the Wilcoxon rank-sum test. The obtained <italic toggle="yes">P</italic>-values were adjusted using Bonferroni’s method.</p>
      <p>To further assess the properties of the SNP markers obtained, the origins of the reads used by TASSEL-GBS to call genotypes were assessed by mapping the tags listed by TASSEL-GBS. The tags of TASSEL-GBS, referred to as tassel tags, are unique sequences found in the input read data and stored in an SQLite database output by the pipeline. The SNP position information and corresponding tag sequences used for genotype calling at the SNPs were retrieved from the SQLite database using SQLite, version 3.41.2, which is available at <ext-link xlink:href="https://www.sqlite.org" ext-link-type="uri">https://www.sqlite.org</ext-link>. The tag sequences were then mapped to the NB and OL genomes using the aln function of BWA, as the TASSEL-GBS pipeline uses this function instead of BWA-MEM. Tag alignment results were analysed in a manner similar to that described in Section 2.2, except for the method used to determine tag origins in the OL genome. Because the true origins of the tags were unknown, NB and OL tassel tags were defined as tags that showed no mismatch or mismatch(es) with the NB genome sequence, respectively. The best matching locations of the OL tassel tags were assigned as the origins of the tags. If the origin of an OL tassel tag was located on a chromosome different from the chromosome on which the tag was mapped in the NB genome, this OL tag was recorded as an interchromosomal alignment. The collinearity of tag origins between the genomes was evaluated as described in Section 2.2. The SNP markers identified by TASSEL-GBS were grouped into four classes based on the properties of the tags supporting each SNP marker: (1) assigned as a multi-tag site (<xref rid="F1" ref-type="fig">Fig. 1A</xref>), (2) supported by collinear tags (<xref rid="F1" ref-type="fig">Fig. 1C</xref>), (3) assigned as a single-tag site but not supported by collinear tags (<xref rid="F1" ref-type="fig">Fig. 1D</xref>), and (4) assigned as an interchromosomal alignment site (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). The statistical significance of the difference in mismapping rates between the four marker classes was tested using the Wilcoxon rank-sum test. The obtained <italic toggle="yes">P</italic>-values were adjusted using Bonferroni’s method.</p>
    </sec>
    <sec id="s9">
      <title>2.7. Genotype calling using MCPtaggR and an OL-nized genome sequence</title>
      <p>Pilon software is a well-established high-performance genome sequence polisher that corrects genome sequences based on short-read alignment information.<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> Theoretically, using Pilon, one can convert one reference genome sequence to another by aligning the WGR reads derived from a related species. Therefore, instead of the publicly available OL genome assembly, the NB genome sequence was converted into an OL genome sequence (OL-nized) using Pilon. The WGR data of an OL plant using HiSeq 2500, deposited under project ID PRJDB6339,<sup><xref rid="CIT0024" ref-type="bibr">24</xref></sup> were obtained from SRA. The WGR reads obtained were aligned to the NB genome using BWA-MEM. The resultant BAM file was supplied as input to Pilon. In typical cases of genome polishing for <italic toggle="yes">de novo</italic> genome assembly, multiple rounds are performed by repeating the read alignment on a polished genome, followed by polishing using Pilon to improve sequence accuracy. Thus, OL-nized genome sequences were generated by performing one, two, three, and four rounds of polishing. Genotype calling using MCPtaggR followed by error correction and dosage estimation using GBScleanR was conducted as described in Section 2.5, using each OL-nized genome sequence as an alternative genome. The number of recombinations per chromosome was counted in the resultant estimated dosage data as described in Section 2.6.</p>
    </sec>
    <sec id="s10">
      <title>2.8. Data availability</title>
      <p>MCPtaggR is available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/MCPtaggR" ext-link-type="uri">https://github.com/tomoyukif/MCPtaggR</ext-link>). More details on package installation and usage can be found in the GitHub repository and the vignette available at <ext-link xlink:href="https://tomoyukif.github.io/MCPtaggR/" ext-link-type="uri">https://tomoyukif.github.io/MCPtaggR/</ext-link>. The test data used in this study were described in our previous publication.<sup><xref rid="CIT0035" ref-type="bibr">35</xref></sup> Because the data size of the full test data exceeds 12 GB, sample FASTQ files, which consist of 10 samples, are installed with MCPtaggR to test the functions.</p>
    </sec>
  </sec>
  <sec id="s11">
    <title>3. Results</title>
    <sec id="s12">
      <title>3.1. GBS-read alignment simulation and error-prone detection</title>
      <p><italic toggle="yes">In silico</italic> digestion at the KpnI and MspI recognition sites generated 155,474 and 125,932 digested-tags from the NB and OL genomes, respectively (<xref rid="T1" ref-type="table">Table 1</xref>). Tag mapping using BWA-MEM resulted in 20,210 and 31,040 unmapped NB- and OL-digested-tags due to short tag sequences, which were less than 30 bp and were ignored by the aligner, and Ns in the tag sequences, which were added to fill the gaps between contigs of the genome assemblies. Multiple alignments were found in 6,295 and 5,308 of the NB- and OL-digested-tags, respectively. Notably, BWA-MEM failed to align 15,919 NB-digested-tags back to their original locations, without any additional alignment information. Manual searches of the tag sequences in the NB genome revealed that these tags had identical sequences at multiple locations. Therefore, these tags were treated as multiple alignment tags. After filtering out the unmapped and multiple-mapped tags, 113,050 and 89,584 NB- and OL-digested-tags were retained, respectively. In the retained OL-digested-tags, 19,705 tags showed interchromosomal alignments and were filtered out. To further assess the properties of the mapped tags, overlaps of tag alignment locations were searched and found in 43,003 sites. Of the 43,003 co-mapped sites, 38,499, and 4504 sites had single and multiple OL-digested-tags, respectively (<xref rid="F1" ref-type="fig">Fig. 1A</xref> and <xref rid="T2" ref-type="table">Table 2</xref>). More than one mismatch pattern was found at 2,238 multiple-tag sites. These sites potentially lead to incorrect genotyping calls owing to different mismatch patterns, resulting in different contributions to read counts as reference and alternative alleles at SNPs. Filtering of single-tag sites with no mismatches and interchromosomal alignments removed 15,760 and 1582 sites, respectively (<xref rid="T2" ref-type="table">Table 2</xref>). As the number of retained single-tag sites was 21,157, approximately 7% of the single-tag sites had SNPs that could be potentially detectable in GBS, but would be derived from interchromosomal alignments, leading to incorrect genotyping calls (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). As the final step of the simulation study, the collinearity of the origins of the digested-tags in the NB and OL genomes was confirmed (<xref rid="F1" ref-type="fig">Fig. 1B-D</xref>). Neither the NB nor OL tag at 105 single-tag sites could be assigned to any collinear block/interval because, for these tag sites, one of the tags was assigned to a block/interval in a genome, whereas the other tag was assigned to an interval in which the corresponding interval was missing in the corresponding genome. Imperfect collinear block detection due to local genomic rearrangements may cause these misassignments. Among the remaining single-tag sites, 435 and 172 sites had OL-digested-tags that were derived from the collinear blocks/intervals located more than 100 kb and 1 Mb away from the blocks/intervals where NB-digested-tags were assigned, respectively (<xref rid="F1" ref-type="fig">Fig. 1D</xref>). These sites can also potentially result in incorrect genotype calls by mismapping reads derived from distant genomic locations. In this simulation, error-prone SNP markers that potentially provide incorrect genotype calls in GBS were found at 4,255 locations, which included multiple-tag sites with multiple missing patterns, single-tag sites with interchromosomal alignments, and single-tag sites with tags from non-collinear origins. In contrast, 16,797 sites were identified as reliable SNP markers (<xref rid="T2" ref-type="table">Table 2</xref>). However, this simulation also demonstrated that more than 20% of the SNP marker sites could be error-prone in GBS.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>Classification of digested-tags</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">NB-digested-tags</th>
              <th align="left" rowspan="1" colspan="1">OL-digested-tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total</td>
              <td align="left" rowspan="1" colspan="1">155,474</td>
              <td align="left" rowspan="1" colspan="1">125,932</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Unmapped</td>
              <td align="left" rowspan="1" colspan="1">20,210</td>
              <td align="left" rowspan="1" colspan="1">31,040</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Multiple alignments</td>
              <td align="left" rowspan="1" colspan="1">6,295</td>
              <td align="left" rowspan="1" colspan="1">5,308</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Silent multiple alignments<xref rid="T1Fn1" ref-type="table-fn"><sup>a</sup></xref></td>
              <td align="left" rowspan="1" colspan="1">15,919</td>
              <td align="left" rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">NA</td>
              <td align="left" rowspan="1" colspan="1">19,705</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Retained</td>
              <td align="left" rowspan="1" colspan="1">113,050</td>
              <td align="left" rowspan="1" colspan="1">69,879</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T1Fn1">
            <p><sup>a</sup>NB-digested-tags that failed to be aligned back to the original locations.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>Classification of co-mapped sites</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">No. of tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total sites</td>
              <td align="left" rowspan="1" colspan="1">43,003</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Multiple-tag sites</td>
              <td align="left" rowspan="1" colspan="1">4,504</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Multiple mismatching patterns</td>
              <td align="left" rowspan="1" colspan="1">2,238</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non- or one mismatching pattern</td>
              <td align="left" rowspan="1" colspan="1">2,266</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Single-tag sites</td>
              <td align="left" rowspan="1" colspan="1">38,499</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non-mismatching pattern</td>
              <td align="left" rowspan="1" colspan="1">15,760</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">1,582</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non-collinear sites</td>
              <td align="left" rowspan="1" colspan="1">4,360</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Collinear sites</td>
              <td align="left" rowspan="1" colspan="1">16,797</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s13">
      <title>3.2. Performance of MCPtaggR for accurate genotype calling</title>
      <p>To eliminate the detection of error-prone markers in RRS-based genotyping, including GBS, the MCPtagg pipeline was developed and implemented in the R package MCPtaggR, as described in Sections 2.3 and 2.4. MCPtaggR detected 19,714 and 19,695 MCP tags in the NB and OL genomes, respectively (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>). The GBS reads were mapped on 6418 and 6701 MCP tags in the NB and OL genomes, respectively. The differences in the number of MCP tags were caused by the differences in RE cut sites between the NB and OL genomes. We confirmed the classifications of the read-mapped OL MCP tags in the classes defined by mapping the digested-tags on the NB genome (<xref rid="T1" ref-type="table">Tables 1</xref> and <xref rid="T2" ref-type="table">2</xref>). Out of 6,701 read-mapped tags, 4,589 tags matched the digested-tags that were mapped on the collinear single-tag sites (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>). The rest of the read-mapped OL MCP tags were classified as tags that were potentially invalid for genotype calling if only the NB genome was used as a reference for read mapping. In other words, MCPtaggR successfully called genotypes using reads that might be potentially mapped on incorrect locations if the NB genome was solely used as a reference.</p>
      <p>The performance was evaluated by comparing the genotype calls generated by MCPtaggR and TASSEL-GBS. After filtering SNP markers as described in Section 2.5, 5,486 and 2,973 SNP markers were retained for the data generated by MCPtaggR and TASSEL-GBS, respectively. Because the raw genotype data output from the tools contained a large number of missing values and heterozygote undercallings, error correction and allele dosage estimation were performed using GBScleanR. The performance of the tools for genotype calling was indirectly evaluated based on the estimated allele dosage instead of raw genotype data. <xref rid="F3" ref-type="fig">Figure 3</xref> depicts a representative case in which MCPtaggR and TASSEL-GBS yielded genotypic calls that resulted in different dosage estimations. TASSEL-GBS detected alternative allele reads at a larger number of markers where the estimated dosage indicated reference homozygotes at the surrounding markers. As a result, GBScleanR estimated the dosage to change from 0 to 1 and then return to 0 within short intervals, indicating a double crossover (upper panels in <xref rid="F3" ref-type="fig">Fig. 3</xref>). Theoretically, double crossovers at short intervals are rarely observed in F<sub>2</sub> populations. These unexpected alternative allele reads were reduced, and double crossovers were eliminated from the MCPtaggR results (<xref rid="F3" ref-type="fig">Fig. 3</xref>, lower panels).</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of obtained read counts and estimate dosages. Estimated dosage (magenta lines) and allele read ratios per marker (green dots) on chromosomes 1 and 10 in a representative sample. The green dots at 0 and 2 on the <italic toggle="yes">y</italic>-axis represent the markers at which only the reference and alternative allele reads were mapped, respectively, whereas the dots between them represent markers that had both allele reads.</p>
        </caption>
        <graphic xlink:href="dsad027_fig3" position="float"/>
      </fig>
      <p>To statistically assess the differences in genotype calling using these tools, we first calculated the concordance rates of the raw genotype calls and estimated dosages between MCPtaggR and TASSEL-GBS. Only 507 SNPs were commonly detected by both tools, whereas 4,979 and 2,466 SNPs were uniquely detected by MCPtaggR and TASSEL-GBS, respectively (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref>). As the number and positions of obtained SNPs were different between the tools, we compared raw genotype calls and estimated dosages between the nearest SNPs detected by MCPtaggR and TASSEL-GBS. The raw genotype calls showed a concordance rate of 67.34%, whereas the estimated dosages exhibited a concordance rate of 98.76% (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref>). Thus, although the raw genotype calls were largely different between MCPtaggR and TASSEL-GBS, highly similar dosages were estimated by GBScleanR from both genotype data. Nevertheless, as shown in <xref rid="F3" ref-type="fig">Fig. 3</xref>, there were unexpected double crossovers at short intervals. To further assess the occurrence of unexpected crossovers due to error-prone markers, the average recombination frequency per chromosome was calculated (<xref rid="F4" ref-type="fig">Fig. 4A</xref> and <xref rid="sup4" ref-type="supplementary-material">Supplementary Table S3</xref>). The expected recombination frequencies in the chromosomes were estimated from their physical lengths, assuming an average recombination rate of 0.04 per Mb. Based on a previous study, the expected recombination frequency across the entire genome of a rice F<sub>2</sub> plant is approximately 15.2.<sup><xref rid="CIT0037" ref-type="bibr">37</xref></sup> As this value matched the sum of the expected recombination frequencies in the chromosomes (14.94), the estimation of recombination frequencies was reliable and acceptable. Although the data generated by both TASSEL-GBS and MCPtaggR showed more frequent recombination than expected, MCPtaggR yielded values that were closer to the expected frequencies compared with those of TASSEL-GBS (<xref rid="F4" ref-type="fig">Fig. 4A</xref>). The number of double crossovers within stretches of 0–1 and 1–2 Mb in the estimated dosage data was also counted (<xref rid="F4" ref-type="fig">Fig. 4B</xref> and <xref rid="sup5" ref-type="supplementary-material">Supplementary Table S4</xref>). A large reduction in unexpected double crossovers within short intervals was observed in the genotype data of MCPtaggR compared with that of TASSEL-GBS.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Genotyping quality assessment. (A) Expected and observed average numbers of recombinations per chromosome in the estimated dosage data. (B) Total number of double crossovers within stretches of 0–1 Mb and 1–2 Mb in the estimated dosage data.</p>
        </caption>
        <graphic xlink:href="dsad027_fig4" position="float"/>
      </fig>
      <p>Although GBScleanR is robust against error-prone markers because it incorporates marker-specific error rates into the hidden Markov model (HMM),<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> it can fail to estimate true genotypes, depending on the distribution and pattern of read counts of error-prone markers. As the estimated dosage of TASSEL-GBS data revealed an increase in recombination frequency and double crossovers, it could be expected that TASSEL-GBS would call genotypes with a larger number of error-prone markers than MCPtaggR. In general, read mismapping caused by the non-collinearity of the origins of the reads results in unexpected heterozygous calls at sites where the true genotypes are homozygotes. Therefore, the mismapping rate per marker was estimated by calculating the proportion of genotype calls that were heterozygous in the raw genotype data, but homozygous in the genotype estimated by GBScleanR. The TASSEL-only markers (2,201 markers) showed a significantly larger mismapping rate than the common markers and MCPtaggR-only markers (772 and 4,150 markers, respectively) (<xref rid="F5" ref-type="fig">Fig. 5A</xref>). In addition, a comparison between common markers and MCPtaggR-only markers indicated a significant reduction in the mismapping rate of MCPtaggR-only markers. Together with a reduction in the number of recombinations and double crossovers, these results demonstrate that MCPtaggR efficiently eliminates error-prone markers from genotype calling and provides more reliable genotype data in combination with GBScleanR.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Mismapping rate per marker. The mismapping rate per marker is shown in violin plots for each class of markers, classified based on the commonness between the tools (A) and the collinearity of mapped tags (B). ‘Common’, ‘TASSEL’, and ‘MCPtaggR’ in panel A indicate the markers commonly detected by both tools, only detected by TASSEL-GBS, and MCPtaggR, respectively. The mismapping rate of the ‘Common’ markers was calculated from the data obtained using TASSEL-GBS. ‘Collinear’, ‘Non-Collinear’, ‘MultiHit’, and ‘InterChr’ indicate the markers supported by collinear tags, non-collinear tags, multiple alignment tags, and interchromosomal alignment tags, respectively. The significance of the differences in mismapping rates between classes is indicated by <sup>N.S.</sup><italic toggle="yes">P</italic> &gt; 0.05, *<italic toggle="yes">P</italic> &lt; 0.05, and **<italic toggle="yes">P</italic> &lt; 0.01.</p>
        </caption>
        <graphic xlink:href="dsad027_fig5" position="float"/>
      </fig>
    </sec>
    <sec id="s14">
      <title>3.3. Confirming the cause of mismapped read</title>
      <p>To confirm that the mismapped reads originated from non-collinear locations in the NB and OL genomes, the original genomic locations of the tassel tag sequences, which were listed and used by TASSEL-GBS for genotype calling, were determined by aligning the tassel tags to the NB and OL genomes. TASSEL-GBS listed 65,063 unique tags from the read data of the rice F<sub>2</sub> samples, whereas 2,973 of the retained SNP markers were supported by only 6,809 tags (<xref rid="T3" ref-type="table">Table 3</xref>). Sequence mismatches were found in 3,868 of the 6,809 tags in the tag alignment to the NB genome. Although these mismatched tags may contain tag sequences generated by sequencing error, 3,868 tags were considered to originate from the OL genome. Of the 3,868 OL tags, 577 tags were mapped to the OL chromosomes that were different from the NB chromosomes, where the tags were mapped for genotype calling, indicating interchromosomal alignments (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). Multiple alignments were observed for 94 OL tags. These interchromosomal and multiple alignment tags contributed to genotype calling at the 390 and 77 retained SNP markers, potentially leading to incorrect genotyping. Among the remaining OL tags, 489 tags that were mapped to 402 SNP marker sites failed to show collinearity with the corresponding NB tags that were mapped to the same SNP locations in the NB genome (<xref rid="F1" ref-type="fig">Fig. 1B–D</xref>). Some of the non-collinear tags did not align with either the NB or OL genomes. The incompleteness of genome assemblies may have caused these missing alignments. Finally, 2,104 SNP markers were found to be reliable SNP markers that were supported by 2,708 OL tags, maintaining collinearity with the corresponding NB tags. This collinearity assessment revealed that 29.2% of the SNP markers provided by TASSEL-GBS were genotyped based on reads originating from invalid or unreliable sources.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3.</label>
        <caption>
          <p>Classification of tassel-tags</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">No. of tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total tags</td>
              <td align="left" rowspan="1" colspan="1">65,063</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Valid SNP supporting tags</td>
              <td align="left" rowspan="1" colspan="1">6,809</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> NB tags</td>
              <td align="left" rowspan="1" colspan="1">2,941</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> OL tags</td>
              <td align="left" rowspan="1" colspan="1">3,868</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">577</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Multiple alignments</td>
              <td align="left" rowspan="1" colspan="1">94</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Non-collinear tags</td>
              <td align="left" rowspan="1" colspan="1">489</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Collinear tags</td>
              <td align="left" rowspan="1" colspan="1">2,708</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The mismapping rates estimated from the proportion of mismatches in the raw genotype calls and estimated dosages revealed significant differences in the properties of the SNP markers classified based on collinearity (<xref rid="F5" ref-type="fig">Fig. 5B</xref>). The markers supported by collinear tassel-tags showed significantly smaller mismapping rates than those supported by non-collinear and interchromosomal alignment tags. The highest mismapping rate was observed for markers supported by interchromosomal alignment tags. The distribution of the mismapping rate per marker indicated that markers with interchromosomal alignments had the most deleterious impact on genotype calling (<xref rid="F5" ref-type="fig">Fig. 5B</xref>). Significantly larger proportions of the markers supported by non-collinear and multiple tags were identified as mismapping prone compared with the markers supported by collinear tags, although some of the markers had no mismapping reads. As shown in the previous section, MCPtaggR filtered out these error-prone markers before genotype calling (<xref rid="F5" ref-type="fig">Fig. 5A</xref>). These results suggested that SNP marker filtering based on sequence collinearity is a reasonable and effective method for accurate genotype calling.</p>
    </sec>
    <sec id="s15">
      <title>3.4. Genotype calling with an OL-nized genome sequence</title>
      <p>Considering situations that require RRS-based genotyping, the genome sequences of the parents of a given population are not always available. In contrast, the genome sequence polisher Pilon is a software to correct the sequence of a genome assembly to improve its quality based on the alignment results of WGR data.<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> Therefore, genotype calling using MCPtaggR was performed using the NB genome assembly and an OL genome sequence that was converted from the NB genome assembly, referred to as an OL-nized genome sequence. Pilon is usually applied repeatedly to improve the quality of a <italic toggle="yes">de novo</italic> assembled genome. Thus, OL-nized genome sequences were obtained by polishing one, two, three, and four times. We compared the SNP positions between the genotype data obtained using the OL genome assembly and the OL-nized genome sequences. Approximately 65% of SNPs (3543 out of 5486) detected using the OL genome assembly were also detected using the OL-nized genome sequence after one round of polishing (<xref rid="T4" ref-type="table">Table 4</xref>). The rate of common SNPs was increased by two rounds of polishing to nearly 70%. Further polishing (three and four rounds) showed negligibly small improvements in the rate of common SNPs. The genotype-calling performance was evaluated based on the number of recombinations per chromosome and double crossovers within short intervals. Only one round of polishing resulted in similar values in the number of recombinations per chromosome and double crossovers within short intervals compared with those observed in the genotype data using the OL genome assembly (<xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). Unexpectedly, an additional round of polishing (two rounds in total) increased the number of recombinations and double crossovers. In addition, more than two rounds of polishing showed negligible improvements. We also compared the concordance rates of raw genotype calls and estimated dosages. Since the number and positions of obtained SNPs were different between the genotype data obtained using different genomes (<xref rid="T4" ref-type="table">Table 4</xref>), we calculated concordance rates of the raw genotype calls and estimated dosages between the nearest SNPs detected using the OL genome assembly and the OL-nized genomes. One round of polishing resulted in poor concordance rates of genotype calls (42.53%) and estimated dosages (39.07%), whereas two rounds of polishing drastically improved concordance rates to 92.63 and 99.74% for genotype calls and estimated dosages, respectively (<xref rid="T4" ref-type="table">Table 4</xref>). Similar to the other measurements described above, two or more rounds of polishing showed almost identical values of the concordance rates. Together with the number of recombinations and crossovers, only one round of polishing was insufficient to OL-nized the NB genome assembly. The OL-nized genome sequence obtained by one-round polishing exhibited comparable frequencies of recombinations and double crossovers to those observed in the OL-nized genome that underwent multiple rounds of polishing (<xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). However, the genotype calls and estimated dosages were largely different from those obtained using the OL genome assembly (<xref rid="T4" ref-type="table">Table 4</xref>). We also found that three or more polishing rounds showed limited improvements in the quality of genotype calling (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). Two rounds of polishing using Pilon were sufficient to obtain genotype calls at a similar quality compared with genotype calling using the OL genome assembly (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). These results demonstrated that the MCPtagg pipeline potentially works sufficiently with an X-nized genome sequence obtained by polishing the genome of a related species, although the positions of markers and raw genotype calls are different from those obtained using a <italic toggle="yes">de novo</italic> assembled genome.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4.</label>
        <caption>
          <p>Concordance rates in genotype calls and estimated dosages</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Pilon<xref rid="T4Fn1" ref-type="table-fn"><sup>a</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Number of markers<xref rid="T4Fn2" ref-type="table-fn"><sup>b</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Concordance rate (%)<xref rid="T4Fn3" ref-type="table-fn"><sup>c</sup></xref></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">1,943, 2,170, 3,543</td>
              <td align="left" rowspan="1" colspan="1">42.53, 39.07</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">1,678, 2,180, 3,808</td>
              <td align="left" rowspan="1" colspan="1">92.63, 99.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">1,671, 2,170, 3,815</td>
              <td align="left" rowspan="1" colspan="1">92.72, 99.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">1,668, 2,168, 3,818</td>
              <td align="left" rowspan="1" colspan="1">92.70, 99.74</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T4Fn1">
            <p><sup>a</sup>The number of rounds Plilon was applied for polishing.</p>
          </fn>
          <fn id="T4Fn2">
            <p><sup>b</sup>The number of markers detected solely in the genotype calling using the assembled OL genome, the OL-nized genome, and markers detected in both are presented, separated by commas.</p>
          </fn>
          <fn id="T4Fn3">
            <p><sup>c</sup>Concordance rates in genotype calls and estimated dosages between those obtained using the OL genome assembly and the OL-nized genome sequence are presented, separated by commas.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec id="s16">
    <title>4. Discussion</title>
    <p>The main purpose of our study was to demonstrate the performance of the MCPtagg pipeline. However, we would also like to note the importance of error correction for RRS-based genotype data. In our study, the concordance rate of raw genotype calls was only 67.34% between MCPtaggR and TASSEL-GBS, as described in Section 3.2. However, a high concordance rate of estimated dosages (98.76%) was observed. Even though the raw genotype calls contained largely different genotype information with different error patterns, GBScleanR could estimate highly similar dosages. As GBScleanR was designed to incorporate marker-specific error patterns in the HMM for robust genotype correction against error-prone markers, error correction and dosage estimation could be achieved by picking up reliable genotype information while eliminating negative impact from error-prone markers.</p>
    <p>Our study presented the deleterious effects of error-prone markers and the causes of these errors. Although we observed the quite high concordance rate of the estimated dosages between MCPtaggR and TASSEL-GBS, TASSEL-GBS resulted in 20 and 1,650% higher number of recombinations and double crossovers within intervals of 0–1 Mb stretches compared with MCPtaggR (<xref rid="sup4" ref-type="supplementary-material">Supplementary Tables S3</xref> and <xref rid="sup5" ref-type="supplementary-material">S4</xref>). Considering the high concordance rate of the estimated dosages, the increase in the recombinations might be caused by the increase of unexpected double crossovers. Unfortunately, the assessment relying on the overall concordance rate was unable to effectively detect these specific local errors, mainly because such local errors usually have limited effects on the overall measurement. As the present study demonstrated, the MCPtagg pipeline effectively eliminates these local errors that are caused by error-prone markers. RRS-based genotyping in populations derived from crosses between very close relatives might result in a few error-prone markers because their genome sequences have conserved sequence similarity and collinearity. However, the more distant relatives that were crossed to produce populations, the more error-prone markers contaminated the genotype data. Geneticists and breeders use wild relatives of cultivated varieties in distant crosses, particularly in genetic studies and breeding programs. RRS-based genotyping is a popular and standard method used in genetic studies and breeding programs. However, contamination with error-prone markers increases the risk of misleading genotype data.<sup><xref rid="CIT0011" ref-type="bibr">11–14</xref></sup> Even though some error-prone markers can be filtered out based on marker statistics, such as allele frequency and heterozygosity, there is no gold standard for filtering criteria. In contrast, MCPtaggR provides an easy-to-use reliable genotype calling pipeline that basically never requires filtering based on user-specified arbitrary criteria. In addition, our study also showed efficiency in detecting SNP markers. We performed genotype calling using TASSEL-GBS and MCPtaggR for the same read dataset obtained from a rice F<sub>2</sub> population. Typically, RRS genotype data are subjected to intensive filtering based on the proportion of missing data, heterozygosity, and minor alleles per marker. Genotyping pipelines for bi- and multi-parental populations also filter out SNP markers for which one or more parental samples showed missing genotype calls due to missing read observations. Because sequence reads are acquired stochastically by a sequencer, RRS-based genotype data contain numerous markers that can be filtered out, particularly in low-read-coverage genotype data. Although the parental samples of the rice F<sub>2</sub> population were sequenced at three times higher read coverage, the filtering of the genotype data provided by TASSEL-GBS retained only 2,973 markers while 8,190 markers were obtained just after pruning markers based on their physical distances. In contrast, MCPtaggR provided 5,486 markers, although it filtered out markers by comparing parental genome sequences prior to genotype calling. Missing genotype calls in either NB or OL were found at 3,646 markers in the genotype data generated by MCPtaggR. In a typical filtering procedure, these markers are removed. However, the reliability of the markers was supported by a pre-survey of SNP markers in the MCPtagg pipeline. Thus, MCPtaggR successfully retained more markers than TASSEL-GBS. Although an increase in read coverage might change the result, MCPtaggR enables us to efficiently obtain as numerous markers as possible, even from low-coverage sequence data.</p>
    <p>One drawback of the MCPtagg pipeline is that it requires high-quality genome assemblies of both parents. However, even in cases where parental genome assemblies are not available, recent developments in bioinformatics tools have enabled us to instantly obtain genome assemblies without conducting costly <italic toggle="yes">de novo</italic> genome assembly. As demonstrated in this study, available genome assemblies can be converted into others using short-read sequences with the genome polishing tool Pilon<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> and methods introduced in previous studies.<sup><xref rid="CIT0038" ref-type="bibr">38</xref>,<xref rid="CIT0039" ref-type="bibr">39</xref></sup> One round of polishing resulted in poor concordance rates between the estimated dosages obtained using the OL genome assembly and the OL-nized genome sequence. This result indicates that only one round of polishing is insufficient to convert the NB genome assembly to an OL-nized genome sequence that can provide sufficiently accurate genotype information using MCPtaggR in combination with GBScleanR. Two rounds of polishing by Pilon were sufficient to achieve a genotyping quality similar to that of the OL genome (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). As a note, this result never implies that the OL-nized genome sequence is identical to the OL genome assembly, but it suggests that the two-round polishing renders an OL-nized genome sequence with sufficient information for genotyping using MCPtaggR. The number of rounds necessary to X-nize a genome assembly might differ depending on target genomes and there is no prior information to estimate the ideal number of rounds. Thus, multiple rounds of polishing are recommended. Nonetheless, our study suggests that the MCPtagg pipeline sufficiently works with converted genomes. Therefore, if a genome assembly is available for species of interest, WGR data from the parents are sufficient to prepare genome assemblies as input for the pipeline, instead of conducting de novo genome assembly. This fact indicates the flexibility and scalability of the pipeline. The read data used for polishing in this study contained 36,708,088 150-bp pair-end reads that corresponded to approximately 10× coverage of the rice genome. Even though the read coverage was not high but rather low, Pilon successfully optimized the NB genome to sufficient quality for genotype calling by MCPtaggR. Nevertheless, an X-nized genome may not reflect genome rearrangements such as translocations and inversions. This result implies that mismapped reads are more likely due to the presence of similar sequences resulting from mutations in the ancestral genome sequences that were originally located elsewhere, rather than originating from translocated and mutated genomic segments.</p>
    <p>Collectively, this study demonstrated the superiority of the MCPtagg pipeline over existing genotype pipelines. Although only TASSEL-GBS was tested with GBS-read data as an example, theoretically similar disadvantages would be found in other RRS-based genotyping methods unless the obtained reads were mapped onto a single reference genome. Another limitation of our study is that we tested the pipeline only using the rice F<sub>2</sub> population derived from a cross between NB and OL. However, this fact never diminishes the value of our study and the pipeline. This point was further discussed and justified in <xref rid="sup7" ref-type="supplementary-material">Supplementary Discussion</xref>. The current implementation of MCPtaggR treats any sequence as a cut site. It is not necessary to specify RE recognition sequences, but one can specify primer sequences used in genotyping based on amplicon sequences such as MIG-seq<sup><xref rid="CIT0040" ref-type="bibr">40</xref></sup> and GRAS-Di® (TOYOTA, Aichi, Japan). Genotype data generated by any RRS-based genotyping method can be processed using the MCPtagg pipeline by tweaking the parameters specifying the cut sites and digested-tag length filtering in the MCPtaggR package. In contrast, the current version of MCPtaggR has a limitation in its applicability, only supporting biparental populations derived from a cross between inbred lines or selfing species. Nonetheless, the pipeline can be expanded to handle outbred lines and outcrossing species if haplotype-phased genome assemblies are available.<sup><xref rid="CIT0041" ref-type="bibr">41</xref></sup> MCPtaggR can also genotype polyploid populations if those were derived from a biparental cross of inbred lines or selfing species. Although the resulting data only includes genotype calls for homozygotes of both alleles and heterozygotes without allele dosage information, polyploid allele dosage estimation tools might help to analyse such genotype call data.<sup><xref rid="CIT0042" ref-type="bibr">42</xref>,<xref rid="CIT0043" ref-type="bibr">43</xref></sup> In addition, the pipeline has the potential to be applied to multiparental populations by conducting comprehensive genome comparisons across all possible combinations of parents. Future updates on the MCPtaggR package will address these expansions of the pipeline. MCPtaggR would increase its applicability as the available genome sequences increase and has the potential to become a standard genotyping method, especially for genotyping populations derived from distant crosses, which may normally cause error-prone SNP detection.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Material_S1</label>
      <media xlink:href="dsad027_suppl_supplementary_material_s1.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S1</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s1.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S2</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s2.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S3</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s3.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S4</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s4.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S5</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s5.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Material_S2</label>
      <media xlink:href="dsad027_suppl_supplementary_material_s2.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="a1">
    <title>Acknowledgements</title>
    <p>We would like to thank Editage (<ext-link xlink:href="https://www.editage.jp" ext-link-type="uri">www.editage.jp</ext-link>) for the English language editing.</p>
  </ack>
  <sec id="s18">
    <title>Funding</title>
    <p>This work was supported by the Grants-in-Aid for Scientific Research (KAKENHI) from the Japan Society for the Promotion of Science [JP20K15503 and JP23H02185 to T.F.].</p>
  </sec>
  <sec id="s19">
    <title>Author contributions</title>
    <p>T.F. conceptualized the project, developed the software, conducted benchmarking, and wrote the manuscript. T.Y. supervised the project and reviewed the manuscript.</p>
  </sec>
  <ref-list id="r1">
    <title>References</title>
    <ref id="CIT0001">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname>, <given-names>J.A.</given-names></string-name> and <string-name><surname>Rife</surname>, <given-names>T.W.</given-names></string-name></person-group><year>2012</year>, <article-title>Genotyping-by-sequencing for plant breeding and genetics</article-title>, <source>Plant Genome</source>, <volume>5</volume>. <pub-id pub-id-type="doi">10.3835/plantgenome2012.05.0005</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0002">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davey</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Hohenlohe</surname>, <given-names>P.A.</given-names></string-name>, <string-name><surname>Etter</surname>, <given-names>P.D.</given-names></string-name>, <string-name><surname>Boone</surname>, <given-names>J.Q.</given-names></string-name>, <string-name><surname>Catchen</surname>, <given-names>J.M.</given-names></string-name>, and <string-name><surname>Blaxter</surname>, <given-names>M.L.</given-names></string-name></person-group><year>2011</year>, <article-title>Genome-wide genetic marker discovery and genotyping using next-generation sequencing</article-title>, <source>Nat. Rev. Genet.</source>, <volume>12</volume>, <fpage>499</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">21681211</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0003">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Torkamaneh</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Boyle</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Belzile</surname>, <given-names>F.</given-names></string-name></person-group><year>2018</year>, <article-title>Efficient genome-wide genotyping strategies and data integration in crop plants</article-title>, <source>Theor. Appl. Genet.</source>, <volume>131</volume>, <fpage>499</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">29352324</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0004">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Unamba</surname>, <given-names>C.I.</given-names></string-name>, <string-name><surname>Nag</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Sharma</surname>, <given-names>R.K.</given-names></string-name></person-group><year>2015</year>, <article-title>Next generation sequencing technologies: The doorway to the unexplored genomics of non-model plants</article-title>, <source>Front. Plant Sci.</source>, <volume>6</volume>, <fpage>1074</fpage>.<pub-id pub-id-type="pmid">26734016</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0005">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname>, <given-names>G.K.-S.</given-names></string-name>, <string-name><surname>Soltis</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Leebens-Mack</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group><year>2020</year>, <article-title>Sequencing and analyzing the transcriptomes of a thousand species across the tree of life for green plants</article-title>, <source>Annu. Rev. Plant Biol.</source>, <volume>71</volume>, <fpage>741</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">31851546</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0006">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheben</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Batley</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Edwards</surname>, <given-names>D.</given-names></string-name></person-group><year>2017</year>, <article-title>Genotyping-by-sequencing approaches to characterize crop genomes: choosing the right tool for the right application</article-title>, <source>Plant Biotechnol. J.</source>, <volume>15</volume>, <fpage>149</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">27696619</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0007">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname>, <given-names>M.R.</given-names></string-name>, <string-name><surname>Dunham</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Amores</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Cresko</surname>, <given-names>W.A.</given-names></string-name>, and <string-name><surname>Johnson</surname>, <given-names>E.A.</given-names></string-name></person-group><year>2007</year>, <article-title>Rapid and cost-effective polymorphism identification and genotyping using restriction site associated DNA (RAD) markers</article-title>, <source>Genome Res.</source>, <volume>17</volume>, <fpage>240</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">17189378</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0008">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterson</surname>, <given-names>B.K.</given-names></string-name>, <string-name><surname>Weber</surname>, <given-names>J.N.</given-names></string-name>, <string-name><surname>Kay</surname>, <given-names>E.H.</given-names></string-name>, <string-name><surname>Fisher</surname>, <given-names>H.S.</given-names></string-name>, and <string-name><surname>Hoekstra</surname>, <given-names>H.E.</given-names></string-name></person-group><year>2012</year>, <article-title>Double Digest RADseq: An inexpensive method for de novo SNP discovery and genotyping in model and non-model species</article-title>, <source>PLoS One</source>, <volume>7</volume>, <fpage>e37135</fpage>.<pub-id pub-id-type="pmid">22675423</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0009">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elshire</surname>, <given-names>R.J.</given-names></string-name>, <string-name><surname>Glaubitz</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>Q.</given-names></string-name>, <etal>et al.</etal></person-group><year>2011</year>, <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>, <source>PLoS One</source>, <volume>6</volume>, <fpage>e19379</fpage>.<pub-id pub-id-type="pmid">21573248</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0010">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname>, <given-names>J.A.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>P.J.</given-names></string-name>, <string-name><surname>Sorrells</surname>, <given-names>M.E.</given-names></string-name>, and <string-name><surname>Jannink</surname>, <given-names>J.</given-names></string-name></person-group><year>2012</year>, <article-title>Development of high-density genetic maps for barley and wheat using a novel two-enzyme genotyping-by-sequencing approach</article-title>, <source>PLoS One</source>, <volume>7</volume>, <fpage>e32253</fpage>.<pub-id pub-id-type="pmid">22389690</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0011">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Günther</surname>, <given-names>T.</given-names></string-name> and <string-name><surname>Nettelblad</surname>, <given-names>C.</given-names></string-name></person-group><year>2019</year>, <article-title>The presence and impact of reference bias on population genomic studies of prehistoric human populations</article-title>, <source>PLoS Genet.</source>, <volume>15</volume>, <fpage>e1008302</fpage>.<pub-id pub-id-type="pmid">31348818</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0012">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freeman</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>J.</given-names></string-name></person-group>; <collab>Genomics England Research Consortium</collab>. <year>2020</year>, <article-title>Genomic loci susceptible to systematic sequencing bias in clinical whole genomes</article-title>, <source>Genome Res.</source>, <volume>30</volume>, <fpage>415</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">32156711</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0013">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valiente-Mullor</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Beamud</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Ansari</surname>, <given-names>I.</given-names></string-name>, <etal>et al.</etal></person-group><year>2021</year>, <article-title>One is not enough: on the effects of reference genome for the mapping and subsequent analyses of short-reads</article-title>, <source>PLoS Comput. Biol.</source>, <volume>17</volume>, <fpage>e1008678</fpage>.<pub-id pub-id-type="pmid">33503026</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0014">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Yamamoto</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Ashikari</surname>, <given-names>M.</given-names></string-name></person-group><year>2023</year>, <article-title>GBScleanR: robust genotyping error correction using a hidden Markov model with error pattern recognition</article-title>, <source>Genetics</source>, <volume>224</volume>, <fpage>iyad055</fpage>.<pub-id pub-id-type="pmid">36988327</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0015">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wijnker</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>James</surname>, <given-names>G.V.</given-names></string-name>, <string-name><surname>Ding</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>, <article-title>The genomic landscape of meiotic crossovers and gene conversions in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>, <source>eLife</source>, <volume>2</volume>, <fpage>e01426</fpage>.<pub-id pub-id-type="pmid">24347547</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0016">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacob</surname>, <given-names>F.D.</given-names></string-name>, <string-name><surname>John</surname>, <given-names>C.M.</given-names></string-name>, <string-name><surname>Athma</surname>, <given-names>A.P.</given-names></string-name>, <etal>et al.</etal></person-group><year>2009</year>, <article-title>Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data</article-title>, <source>Bioinformatics</source>, <volume>25</volume>, <fpage>3207</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">19808877</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0017">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Panousis</surname>, <given-names>N.I.</given-names></string-name>, <string-name><surname>Gutierrez-Arcelus</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Dermitzakis</surname>, <given-names>E.T.</given-names></string-name>, and <string-name><surname>Lappalainen</surname>, <given-names>T.</given-names></string-name></person-group><year>2014</year>, <article-title>Allelic mapping bias in RNA-sequencing is not a major confounder in eQTL studies</article-title>, <source>Genome Biol.</source>, <volume>15</volume>, <fpage>467</fpage>.<pub-id pub-id-type="pmid">25239376</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0018">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebler</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Ebert</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Clarke</surname>, <given-names>W.E.</given-names></string-name>, <etal>et al.</etal></person-group><year>2022</year>, <article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>, <source>Nat. Genet.</source>, <volume>54</volume>, <fpage>518</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">35410384</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0019">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iqbal</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Caccamo</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Turner</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Flicek</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>McVean</surname>, <given-names>G.</given-names></string-name></person-group><year>2012</year>, <article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>, <source>Nat. Genet.</source>, <volume>44</volume>, <fpage>226</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">22231483</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0020">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shajii</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yorukoglu</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Y.W.</given-names></string-name>, and <string-name><surname>Berger</surname>, <given-names>B.</given-names></string-name></person-group><year>2016</year>, <article-title>Fast genotyping of known SNPs through approximate k -mer matching</article-title>, <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i538</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27587672</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0021">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sibbesen</surname>, <given-names>J.A.</given-names></string-name>, <string-name><surname>Maretty</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Krogh</surname>, <given-names>A.</given-names></string-name></person-group>; <collab>Danish Pan-Genome Consortium</collab>. <year>2018</year>, <article-title>Accurate genotyping across variant classes and lengths using variant graphs</article-title>, <source>Nat. Genet.</source>, <volume>50</volume>, <fpage>1054</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29915429</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0022">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaubitz</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Casstevens</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Lu</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal></person-group><year>2104</year>, <article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title>, <source>PLoS One</source>, <volume>9</volume>, <fpage>e90346</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0023">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sakai</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tanaka</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>, <article-title>Rice Annotation Project Database (RAP-DB): an integrative and interactive database for rice genomics</article-title>, <source>Plant Cell Physiol.</source>, <volume>54</volume>, <fpage>e6</fpage>–<lpage>e6</lpage>.<pub-id pub-id-type="pmid">23299411</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0024">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reuscher</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Bessho-Uehara</surname>, <given-names>K.</given-names></string-name>, <etal>et al.</etal></person-group><year>2018</year>, <article-title>Assembling the genome of the African wild rice <italic toggle="yes">Oryza longistaminata</italic> by exploiting synteny in closely related <italic toggle="yes">Oryza</italic> species</article-title>, <source>Commun. Biol.</source>, <volume>1</volume>, <fpage>162</fpage>.<pub-id pub-id-type="pmid">30320230</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0025">
      <label>25.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Gentleman</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>DebRoy</surname>, <given-names>S.</given-names></string-name></person-group>, <year>2022</year>, <article-title>Biostrings: efficient manipulation of biological strings</article-title>. <pub-id pub-id-type="doi">10.18129/B9.bioc.Biostrings.2022</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0026">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname>, <given-names>E.S.</given-names></string-name></person-group><year>2016</year>, <article-title>Using DECIPHER v20 to analyze big biological sequence data in R</article-title>, <source>R J.</source>, <volume>8</volume>, <fpage>352</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0027">
      <label>27.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>H.</given-names></string-name></person-group><year>2013</year>, <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <comment><italic toggle="yes">arXiv</italic>, 1303.3997v2, Date of publication 26 May 2013</comment>, <ext-link xlink:href="http://arxiv.org/pdf/1303.3997.pdf" ext-link-type="uri">http://arxiv.org/pdf/1303.3997.pdf</ext-link>, <comment>preprint: not peer reviewed</comment>.</mixed-citation>
    </ref>
    <ref id="CIT0028">
      <label>28.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Morgan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Obenchain</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>Hayden</surname>, <given-names>N.</given-names></string-name></person-group><year>2023</year>, <article-title>Rsamtools: Binary alignment (BAM), FASTA, variant call (BCF), and tabix file import</article-title>, <comment>Accessed 24 Apr 2023</comment>. <ext-link xlink:href="https://bioconductor.org/packages/Rsamtools" ext-link-type="uri">https://bioconductor.org/packages/Rsamtools</ext-link></mixed-citation>
    </ref>
    <ref id="CIT0029">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marçais</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Delcher</surname>, <given-names>A.L.</given-names></string-name>, <string-name><surname>Phillippy</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Coston</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>, and <string-name><surname>Zimin</surname>, <given-names>A.</given-names></string-name></person-group><year>2018</year>, <article-title>MUMmer4: a fast and versatile genome alignment system</article-title>, <source>PLoS Comput. Biol.</source>, <volume>14</volume>, <fpage>e1005944</fpage>.<pub-id pub-id-type="pmid">29373581</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0030">
      <label>30.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Smit</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hubley</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Green</surname>, <given-names>P.</given-names></string-name></person-group><comment>RepeatMasker Open-4.0. 2013-2015</comment>, <comment>Accessed 4 May 2023</comment>. <ext-link xlink:href="http://www.repeatmasker.org" ext-link-type="uri">http://www.repeatmasker.org</ext-link></mixed-citation>
    </ref>
    <ref id="CIT0031">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name></person-group><year>2013</year>, <article-title>The Subread aligner: fast, accurate and scalable read mapping by seed-and-vote</article-title>, <source>Nucleic Acids Res.</source>, <volume>41</volume>, <fpage>e108</fpage>–<lpage>e108</lpage>.<pub-id pub-id-type="pmid">23558742</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0032">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Auton</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Abecasis</surname>, <given-names>G.</given-names></string-name>, <etal>et al.</etal></person-group>; <collab>1000 Genomes Project Analysis Group</collab>. <year>2011</year>, <article-title>The variant call format and VCFtools</article-title>, <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0033">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Levine</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Gogarten</surname>, <given-names>S.M.</given-names></string-name>, <string-name><surname>Laurie</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Weir</surname>, <given-names>B.S.</given-names></string-name></person-group><year>2012</year>, <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>, <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3326</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0034">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name></person-group><year>2019</year>, <article-title>The R package Rsubread is easier, faster, cheaper and better for alignment and quantification of RNA sequencing reads</article-title>, <source>Nucleic Acids Res.</source>, <volume>47</volume>, <fpage>e47</fpage>–<lpage>e47</lpage>.<pub-id pub-id-type="pmid">30783653</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0035">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Ashikari</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Jena</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Doi</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Reuscher</surname>, <given-names>S.</given-names></string-name></person-group><year>2017</year>, <article-title>Adapting genotyping-by-sequencing for rice F2 populations</article-title>, <source>G3–Genes Genom Genet</source>, <volume>7</volume>, <fpage>881</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0036">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Walker</surname>, <given-names>B.J.</given-names></string-name>, <string-name><surname>Abeel</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Shea</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Priest</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Abouelliel</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal></person-group>, <year>2014</year>, <article-title>Pilon: an integrated tool for comprehensive microbial variant detection and genome assembly improvement</article-title>, <source>PLoS One</source>, <volume>9</volume>, <fpage>e112963</fpage>.<pub-id pub-id-type="pmid">25409509</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0037">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Presting</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Barbazuk</surname>, <given-names>W.</given-names></string-name>, <etal>et al.</etal></person-group><year>2002</year>, <article-title>An integrated physical and genetic map of the rice genome</article-title>, <source>Plant Cell</source>, <volume>14</volume>, <fpage>537</fpage>.<pub-id pub-id-type="pmid">11910002</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0038">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schneeberger</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ossowski</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Ott</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal></person-group><year>2011</year>, <article-title>Reference-guided assembly of four diverse Arabidopsis thaliana genomes</article-title>, <source>Proc. Natl. Acad. Sci. USA</source>, <volume>108</volume>, <fpage>10249</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">21646520</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0039">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lischer</surname>, <given-names>H.E.L.</given-names></string-name> and <string-name><surname>Shimizu</surname>, <given-names>K.K.</given-names></string-name></person-group><year>2017</year>, <article-title>Reference-guided de novo assembly approach improves genome reconstruction for related species</article-title>, <source>BMC Bioinf.</source>, <volume>18</volume>, <fpage>474</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0040">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suyama</surname>, <given-names>Y.</given-names></string-name> and <string-name><surname>Matsuki</surname>, <given-names>Y.</given-names></string-name></person-group><year>2015</year>, <article-title>MIG-seq: an effective PCR-based method for genome-wide single-nucleotide polymorphism genotyping using the next-generation sequencing platform</article-title>, <source>Sci. Rep.</source>, <volume>5</volume>, <fpage>16963</fpage>.<pub-id pub-id-type="pmid">26593239</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0041">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guk</surname>, <given-names>J.Y.</given-names></string-name>, <string-name><surname>Jang</surname>, <given-names>M.J.</given-names></string-name>, <string-name><surname>Choi</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>Y.M.</given-names></string-name>, and <string-name><surname>Kim</surname>, <given-names>S.</given-names></string-name></person-group><year>2022</year>, <article-title>De novo phasing resolves haplotype sequences in complex plant genomes</article-title>, <source>Plant Biotechnol. J.</source>, <volume>20</volume>, <fpage>1031</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">35332665</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0042">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerard</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Ferrão</surname>, <given-names>L.F.V.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>A.A.F.</given-names></string-name>, and <string-name><surname>Stephens</surname>, <given-names>M.</given-names></string-name></person-group><year>2018</year>, <article-title>Genotyping polyploids from messy sequencing data</article-title>, <source>Genetics</source>, <volume>210</volume>, <fpage>789</fpage>–<lpage>807</lpage>.<pub-id pub-id-type="pmid">30185430</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0043">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lipka</surname>, <given-names>A.E.</given-names></string-name>, and <string-name><surname>Sacks</surname>, <given-names>E.J.</given-names></string-name></person-group><year>2019</year>, <article-title>polyRAD: genotype calling with uncertainty from sequencing data in polyploids and diploids</article-title>, <source>G3–Genes Genom Genet</source>, <volume>9</volume>, <fpage>663</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">DNA Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">DNA Res</journal-id>
    <journal-id journal-id-type="publisher-id">dnares</journal-id>
    <journal-title-group>
      <journal-title>DNA Research: An International Journal for Rapid Publication of Reports on Genes and Genomes</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1340-2838</issn>
    <issn pub-type="epub">1756-1663</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10799318</article-id>
    <article-id pub-id-type="pmid">38134958</article-id>
    <article-id pub-id-type="doi">10.1093/dnares/dsad027</article-id>
    <article-id pub-id-type="publisher-id">dsad027</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00774</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MCPtaggR: R package for accurate genotype calling in reduced representation sequencing data by eliminating error-prone markers based on genome comparison</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0869-6626</contrib-id>
        <name>
          <surname>Furuta</surname>
          <given-names>Tomoyuki</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Kurashiki, Okayama</addr-line>, <country country="JP">Japan</country></aff>
        <xref rid="c1" ref-type="corresp"/>
        <!--f.tomoyuki@okayama-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Toshio</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Kurashiki, Okayama</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="c1">To whom correspondence should be addressed. Tel: +81-86-434-1208. Fax: +81-86-434-1208. Email: <email>f.tomoyuki@okayama-u.ac.jp</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-22">
      <day>22</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>31</volume>
    <issue>1</issue>
    <elocation-id>dsad027</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Kazusa DNA Research Institute.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dsad027.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Reduced representation sequencing (RRS) offers cost-effective, high-throughput genotyping platforms such as genotyping-by-sequencing (GBS). RRS reads are typically mapped onto a reference genome. However, mapping reads harbouring mismatches against the reference can potentially result in mismapping and biased mapping, leading to the detection of error-prone markers that provide incorrect genotype information. We established a genotype-calling pipeline named mappable collinear polymorphic tag genotyping (MCPtagg) to achieve accurate genotyping by eliminating error-prone markers. MCPtagg was designed for the RRS-based genotyping of a population derived from a biparental cross. The MCPtagg pipeline filters out error-prone markers prior to genotype calling based on marker collinearity information obtained by comparing the genome sequences of the parents of a population to be genotyped. A performance evaluation on real GBS data from a rice F<sub>2</sub> population confirmed its effectiveness. Furthermore, our performance test using a genome assembly that was obtained by genome sequence polishing on an available genome assembly suggests that our pipeline performs well with converted genomes, rather than necessitating <italic toggle="yes">de novo</italic> assembly. This demonstrates its flexibility and scalability. The R package, MCPtaggR, was developed to provide functions for the pipeline and is available at <ext-link xlink:href="https://github.com/tomoyukif/MCPtaggR" ext-link-type="uri">https://github.com/tomoyukif/MCPtaggR</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>genotyping</kwd>
      <kwd>genome comparison</kwd>
      <kwd>next-generation sequencing</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Society for the Promotion of Science</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001691</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JP20K15503</award-id>
        <award-id>JP23H02185</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1. Introduction</title>
    <p>Next-generation sequencing (NGS) has enabled us to simultaneously obtain high-resolution genotypic information from a large number of samples.<sup><xref rid="CIT0001" ref-type="bibr">1</xref></sup> NGS provides genotyping platforms with remarkably improved flexibility and throughput and is now routinely used in diverse fields of biology.<sup><xref rid="CIT0002" ref-type="bibr">2–4</xref></sup> Nevertheless, obtaining genome-wide genotype information via whole-genome resequencing (WGR) is an expensive option for researchers.<sup><xref rid="CIT0005" ref-type="bibr">5</xref></sup> Numerous reduced representation sequencing (RRS) methods have been introduced to meet the demand for cost-effective genotyping systems using dense markers.<sup><xref rid="CIT0006" ref-type="bibr">6</xref></sup> Since restriction site-associated DNA sequencing (RAD-seq) was first published in 2007,<sup><xref rid="CIT0007" ref-type="bibr">7</xref></sup> several derivative methods have been introduced, including ddRADseq<sup><xref rid="CIT0008" ref-type="bibr">8</xref></sup> and genotyping-by-sequencing (GBS).<sup><xref rid="CIT0009" ref-type="bibr">9</xref>,<xref rid="CIT0010" ref-type="bibr">10</xref></sup></p>
    <p>To identify genotypes at single-nucleotide polymorphism (SNP) markers, NGS reads are typically mapped onto one reference sequence. However, several studies have reported that mapping reads on one reference causes the detection of error-prone SNP markers owing to mismapping and biased mapping of NGS reads derived from non-reference genomes.<sup><xref rid="CIT0011" ref-type="bibr">11–13</xref></sup> In addition to genotyping a population derived from a distant cross, such as interspecific crosses conducted in plants,<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> these error-prone markers have also been observed in genetic studies of bacteria and humans.<sup><xref rid="CIT0011" ref-type="bibr">11–13</xref></sup> Read mismapping may have been caused by structural differences between the reference genome and genomes that were genotyped. Translocations of genome segments potentially result in reads that can be mapped to the same location in the reference genome but actually originate from another location in the genomes of genotyped samples.<sup><xref rid="CIT0015" ref-type="bibr">15</xref></sup> Biased mapping, also known as reference bias, occurs because of the methodological nature of read alignment.<sup><xref rid="CIT0016" ref-type="bibr">16</xref>,<xref rid="CIT0017" ref-type="bibr">17</xref></sup> Sequencing reads derived from a non-reference genome have mismatches with reference sequences. These mismatches cause sequencing reads to be simultaneously mapped to multiple locations with the same probability or even unmapped.<sup><xref rid="CIT0016" ref-type="bibr">16</xref></sup> Because read alignment is achieved by evaluating the sequence matches between a query sequence and a subject sequence, the reference allele reads can be preferentially mapped to the reference genome. In such situations, a genome graph representing a pan-genome sequence is a solution to avoid these errors.<sup><xref rid="CIT0018" ref-type="bibr">18</xref></sup> Variations, including SNPs, insertions and deletions (indels), and translocations, represented in the genome graph prevent mismapping and biased mapping. Although this approach effectively improves the genotyping accuracy, genome graph construction and read alignment remain computationally challenging. Other types of graph-based approaches have also been proposed.<sup><xref rid="CIT0019" ref-type="bibr">19–21</xref></sup> These graph-based approaches require a list of SNPs validated as reliable and call genotypes based on the SNP list. However, these lists of validated SNPs are typically not available for genetic mapping and plant breeding populations because scientists and breeders tend to use a unique combination of parents to create a population. Therefore, a simple and flexible SNP-genotyping pipeline is required to avoid mismapping and biased mapping.</p>
    <p>This study introduces the mappable collinear polymorphic tag genotyping (MCPtagg) pipeline and the R package MCPtaggR, which provides functions for MCPtagg. MCPtagg is a pipeline for processing RRS data to precisely detect SNPs and count reads on reliable tags (short genome segments) that were validated based on genome comparison information. The current version of the pipeline supports a population derived from a biparental cross. First, a simulation study illustrates how structural differences in genomes can lead to the emergence of error-prone markers in GBS data. We then assess the performance of MCPtaggR using real data, comparing it with the well-established pipeline TASSEL-GBS.<sup><xref rid="CIT0022" ref-type="bibr">22</xref></sup> Finally, the simplicity, efficiency, and flexibility of the MCPtagg pipeline and the MCPtaggR implementation are discussed.</p>
  </sec>
  <sec id="s2">
    <title>2. Materials and methods</title>
    <sec id="s3">
      <title>2.1. 
<italic toggle="yes">In silico</italic> genome digestion and digested-tag alignment</title>
      <p>To simulate the digestion of genomic DNA in GBS library preparation, <italic toggle="yes">in silico</italic> digestion was performed on the genome sequences of the cultivated rice <italic toggle="yes">Oryza sativa</italic> cv. Nipponbare (NB), and wild rice <italic toggle="yes">O. longistaminta</italic> (OL). The NB and OL genome sequences were downloaded from RAP-DB<sup><xref rid="CIT0023" ref-type="bibr">23</xref></sup> and <italic toggle="yes">Oryza longistaminata</italic> Information Resource,<sup><xref rid="CIT0024" ref-type="bibr">24</xref></sup> respectively. The obtained FASTA files of the genome sequences were loaded into the R environment using the Biostrings package, version 2.68.1.<sup><xref rid="CIT0025" ref-type="bibr">25</xref></sup> Since the real sequencing reads used in this study were obtained by GBS with KpnI and MspI (see Section 2.5), the recognition sequences of KpnI and MspI were searched in the given genome sequences using the DigestDNA function in the DECIPHER package, version 2.0.<sup><xref rid="CIT0026" ref-type="bibr">26</xref></sup> The <italic toggle="yes">in silico</italic> digested fragments were filtered to retain only those with a KpnI cut site at one end and an MspI cut site at the other end, which could potentially be sequenced in real GBS. To simulate the sequencing reads generated by NGS, fragment sequences were cropped to retain a maximum of 75 bp from both ends. The 75-bp cropped sequences, referred to as digested-tags, from the KpnI and MspI cut sites, were treated as Read1 and Read2 of typical paired-end sequencing output and stored in FASTQ files, respectively. Phred scores for the reads were set to ‘;’ indicating the quality score is 26 for all nucleotides, which was the default behaviour of the writeXStringSet function in the Biostrings package. Each set of digested-tags generated from the NB and OL genomes was aligned to the NB genome using BWA-MEM, version 0.7.17.<sup><xref rid="CIT0027" ref-type="bibr">27</xref></sup> The flags ‘-S -P’ were set to run BWA-MEM with skipping read pairing and mate rescue to allow the tags mapped to their best matching locations regardless of mate read mapping locations.</p>
    </sec>
    <sec id="s4">
      <title>2.2. Evaluation of digested-tag alignments</title>
      <p>The alignment results of the digested-tags were evaluated using the following steps. The output files generated by BWA-MEM, which store the alignments of the NB- and OL-digested-tags on the NB genome, were imported into the R environment using the Rsamtools package, version 2.16.0.<sup><xref rid="CIT0028" ref-type="bibr">28</xref></sup> First, unmapped reads were filtered from the imported alignment data. In general, genotype-calling pipelines filter multiple mapping reads mapped to multiple locations with the same mapping quality. Therefore, multiple mapping reads were filtered out based on the information stored in the XA tag of the SAM file, which shows the additional mapping locations of the reads. This filtering retained only reads uniquely mapped on single locations that were the origins of the digested-tags in the case of the NB-digested-tags. Subsequently, tag alignment locations were searched to identify genome locations where both NB- and OL-digested-tags were mapped (co-mapped sites). The co-mapped sites were classified into two types based on the number of mapped OL-digested-tags: single-tag sites and multi-tag sites, where only one and multiple tags were mapped, respectively (<xref rid="F1" ref-type="fig">Fig. 1A</xref>). Finally, the collinearity of the origins of tags between genomes was evaluated. Collinearity between genomes refers to the conservation of sequence order and orientation across different genomes. Genome regions that have collinearity are defined as collinear blocks. Collinear blocks between the NB and OL genomes (<xref rid="F1" ref-type="fig">Fig. 1B</xref>) were searched using the functions of MUMmer4<sup><xref rid="CIT0029" ref-type="bibr">29</xref></sup> as follows. Repeat sequences in the genomes were masked using RepeatMasker<sup><xref rid="CIT0030" ref-type="bibr">30</xref></sup> with the arguments ‘-excln -s -no_is -species rice’ and the RepBase RepeatMasker Edition library downloaded from <ext-link xlink:href="https://www.girinst.org" ext-link-type="uri">www.girinst.org</ext-link> prior to processing using MUMmer to reduce the unnecessary computation time to find sequence matches between repeat sequences. The masked genomes were processed using the nucmer function with the parameters ‘--maxmatch -g 1000’ followed by filtering on the outputs using the delta-filter function with the setting ‘-1’. Collinear block coordinates were summarized using the show-coords function with the setting ‘-CTlr’. Intervals between collinear blocks can also be assumed to conserve relative positions in the genomes. Therefore, these intervals were considered collinear (<xref rid="F1" ref-type="fig">Fig. 1B</xref>). If the origins of the NB and OL tags mapped to single-tag sites were located in the corresponding collinear blocks or intervals in the NB and OL genomes, respectively, the single-tag sites were recorded as collinear tag sites (<xref rid="F1" ref-type="fig">Fig. 1C</xref>). For each non-collinear tag site, the physical distance was measured between the start position of the block/interval in which the OL tag was mapped and the start position of the collinear block/interval in the NB genome, corresponding to the origin of the OL tag in the OL genome (<xref rid="F1" ref-type="fig">Fig. 1D</xref>). If the OL tags of the non-collinear tag sites originated from chromosomes that were different from the chromosomes where the OL tags were mapped in the NB genome, these sites were counted as interchromosomal alignment sites (<xref rid="F1" ref-type="fig">Fig. 1E</xref>).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Collinearity assessment of the digested-tags. (A) The locations, at which the NB- and OL-digested-tags were mapped, were classified into single-tag sites and multiple-tag sites. Single-tag sites are the genome locations where single NB and OL tags were mapped, whereas multi-tag sites have multiple OL tags. NB and OL tags are represented by green and blue lines in the schematic image. (B) The NB and OL genomes were segmented in collinear blocks and intervals. (C) A single-tag site was classified as a collinear-tag site if the OL tag that was mapped at the single-tag site originated from the collinear block/interval corresponding to the block/interval of the single-tag site. Magenta arrows point to the origins of the OL tags in the OL genome. (D) If a single-tag site was a non-collinear tag site, the physical distance was measured between the start position of the block/interval in which the OL tag was mapped and the start position of the collinear block/interval in the NB genome corresponding to the origin of the OL tag in the OL genome. The magenta double-headed arrow indicates the distance to be measured. (E) If an OL tag originated from a chromosome that does not correspond to the chromosome where the OL tag was mapped in the NB genome, the site was assigned as an interchromosomal alignment site.</p>
        </caption>
        <graphic xlink:href="dsad027_fig1" position="float"/>
      </fig>
    </sec>
    <sec id="s5">
      <title>2.3. Algorithm of MCPtagg</title>
      <p>MCPtagg was designed for the RRS-based genotyping of a population derived from a biparental cross. The pipeline requires the genome sequences of parents and NGS reads obtained using RRS from a population derived from a biparental cross. Before mapping reads, the pipeline prepares a list of MCP tags. First, a whole-genome sequence comparison detects collinear blocks, each of which is a pair of genomic regions sharing identical or similar sequences that can be found at one locus in each parental genome and are arranged in the same order in both parental genomes (<xref rid="F2" ref-type="fig">Fig. 2A</xref>). The SNPs in the collinear blocks are used as SNP markers for subsequent genotype calling. Thereafter, <italic toggle="yes">in silico</italic> digestion of the genomes simulates the restriction fragments generated during library preparation for the RRS (<xref rid="F2" ref-type="fig">Fig. 2B</xref>). To simulate the NGS reads obtained by sequencing the restriction fragments, the simulated sequences are clipped to ensure that they are less than or equal to the maximum read length. In this step, the algorithm identifies SNPs that are potentially undetectable in genotype calling because there were no restriction sites close enough to be sequenced (<xref rid="F2" ref-type="fig">Fig. 2B</xref>). All the simulated reads from both genomes are simultaneously mapped to the genomes (<xref rid="F2" ref-type="fig">Fig. 2C</xref>). Based on the mapping results, the filtering step retains only SNPs at which the simulated reads can be uniquely mapped onto each genome at the correct positions (<xref rid="F2" ref-type="fig">Fig. 2D</xref>). If a simulated read is mapped to multiple locations in both or either of the genomes, the read in real data can potentially cause mismapping if it is mapped to one reference genome. The algorithm then lists MCP tags that are the genomic sequences/regions where the simulated reads are uniquely and completely mappable, located in the collinear blocks, and harbour SNPs. Genotype calling is accomplished by mapping real NGS reads to MCP tags. Reads mapped to the corresponding SNP positions on the MCP tags in each genome without any mismatches and indels are counted to determine the genotypes at the SNP markers.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Schematic of the MCPtagg algorithm and the MCPtaggR workflow. (A) The MCPtagg pipeline requires the SNPs (indicated by magenta X symbols) and collinear blocks (indicated by yellow boxes) information that can be obtained by comparing two genomes using the genome sequence comparison tool MUMmer. (B) Subsequently, the pipeline conducts <italic toggle="yes">in silico</italic> digestion of the genomes to simulate sequencing reads generated in an NGS run. Restriction sites are indicated by blue and green arrows. The grey dashed rectangle indicates an example that a restriction site of a restriction enzyme is missing in genome B. (C) The simulated reads are mapped to both genomes simultaneously. (D) Based on the mapping results, the algorithm detects MCP tags (indicated by the magenta dashed rectangle). The grey dashed rectangle indicates a region where the simulated read failed to map uniquely and completely. (E) The schematic image represents the MCPtaggR workflow for genotype calling. The texts in rectangles display input and output files, whereas the bold texts indicate the function names. The arrows represent data flow through the pipeline.</p>
        </caption>
        <graphic xlink:href="dsad027_fig2" position="float"/>
      </fig>
    </sec>
    <sec id="s6">
      <title>2.4. Implementation of the MCPtagg pipeline in MCPtaggR</title>
      <p>The R package, MCPtaggR, provides functions for the MCPtagg pipeline (<xref rid="F2" ref-type="fig">Fig. 2E</xref>). Collinear block detection and read mapping require the external tools, MUMmer<sup><xref rid="CIT0029" ref-type="bibr">29</xref></sup> and Subread,<sup><xref rid="CIT0031" ref-type="bibr">31</xref></sup> respectively. The run_mummer() function is a wrapper function that internally executes MUMmer functions to identify collinear blocks and SNPs. FASTA files of the reference and alternative genomes set to run_mummer() are used to count the reference and alternative allele reads in the read-counting step. The mummer2SNPs() function converts and organizes the MUMmer outputs into a list of candidate MCP tags. The digestGenome() and alignTAG() functions perform <italic toggle="yes">in silico</italic> genome digestion and simulated read mapping. The outputs from both functions are used as inputs for the findMCPtag() function to list the MCP tags. The function mcptagg() performs read mapping to the MCP tags and outputs read counts and genotype calls in a variant call format (VCF) file<sup><xref rid="CIT0032" ref-type="bibr">32</xref></sup> and a genomic data structure (GDS) file.<sup><xref rid="CIT0033" ref-type="bibr">33</xref></sup> The output GDS file can be directly manipulated using the GBScleanR package, which provides functions for filtering, data visualization, and genotyping error correction.<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> The alignTAG() and mcptagg() functions internally execute the align() function in the Rsubread package for read mapping.<sup><xref rid="CIT0034" ref-type="bibr">34</xref></sup></p>
    </sec>
    <sec id="s7">
      <title>2.5. Genotype calling using TASSEL-GBS and MCPtaggR</title>
      <p>To assess the advantages of MCPtaggR for genotype calling, its performance was compared with that of the well-established genotype-calling pipeline TASSEL-GBS.<sup><xref rid="CIT0022" ref-type="bibr">22</xref></sup> Both tools were subjected to genotype calling using previously published GBS reads obtained from 813 F<sub>2</sub> samples derived from a cross between distant rice relatives NB and OL.<sup><xref rid="CIT0035" ref-type="bibr">35</xref></sup> Reference genome sequences for NB and OL were obtained as described above. The NB genome was used as a reference in the TASSEL-GBS pipeline, and the NB and OL genomes were used as a reference and an alternative to MCPtaggR, respectively. Read data for the F<sub>2</sub> samples were obtained from the sequence read archive (SRA) (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/sra</ext-link>) by querying project ID PRJDB5346. These reads were originally obtained in GBS with a KpnI–MspI RE pair using MiSeq with 75-bp paired-end sequencing. Because the reads deposited in the SRA were demultiplexed and had no barcode sequences required for processing using TASSEL-GBS, dummy barcode sequences were concatenated to all reads using the bardcode_faker function available at <ext-link xlink:href="https://github.com/labroo2/rtassel_supp" ext-link-type="uri">https://github.com/labroo2/rtassel_supp</ext-link>. The scripts used for genotype calling are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. The genotype call data obtained were subjected to SNP filtering using the following criteria:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) SNPs that were biallelic between parents and monomorphic in each parent were retained.</p>
        </list-item>
        <list-item>
          <p>(2) SNPs that were completely missing in the F<sub>2</sub> samples were removed.</p>
        </list-item>
        <list-item>
          <p>(3) The first SNP was retained when multiple SNPs were found within a 75-bp stretch.</p>
        </list-item>
      </list>
      <p>Because the genotype data generated by MCPtaggR were supposed to contain only SNPs that met criterion (1), filtering based only on criteria (2) and (3) was applied to the MCPtaggR output. RRS-based genotype data usually contain numerous errors, including heterozygote undercalling, which is a typical error that incorrectly identifies a homozygote at a heterozygous site. Therefore, the obtained genotype data were processed using GBScleanR to correct errors and estimate allele dosage.<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> The scripts used to execute the filtering and dosage estimation are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
    </sec>
    <sec id="s8">
      <title>2.6. Evaluation of genotype call data</title>
      <p>Genotype call data obtained using MCPtaggR and TASSEL-GBS were evaluated based on the estimated dosage generated by GBScleanR as raw genotype data containing a large number of missing values and erroneous calls, including heterozygote undercallings, which could prevent the systematic evaluation of software performance. The number of recombinations in which the genotype calls changed from one to another was counted in the estimated dosage data. The middle points of the physical positions of the markers, indicating recombination, were considered recombination breakpoints. The number of double crossovers was also evaluated by counting the number of genome segments in which the estimated dosage was heterozygous and flanked by homozygous segments of the same allele; for example, a heterozygous segment flanked by reference homozygous segments on both sides.</p>
      <p>It was expected that SNP markers supported by non-collinear tags would show more frequent mismapped reads than those supported by collinear tags. Therefore, the mismapping rate per marker was estimated by calculating the proportion of genotype calls that were heterozygous in the raw genotype data, but homozygous in the estimated dosage data. The SNP markers were classified into three groups: (1) those commonly found by MCPtaggR and TASSEL-GBS, (2) TASSEL-GBS only, and (3) MCPtaggR only. The statistical significance of the difference in mismapping rates between the three marker groups was tested using the Wilcoxon rank-sum test. The obtained <italic toggle="yes">P</italic>-values were adjusted using Bonferroni’s method.</p>
      <p>To further assess the properties of the SNP markers obtained, the origins of the reads used by TASSEL-GBS to call genotypes were assessed by mapping the tags listed by TASSEL-GBS. The tags of TASSEL-GBS, referred to as tassel tags, are unique sequences found in the input read data and stored in an SQLite database output by the pipeline. The SNP position information and corresponding tag sequences used for genotype calling at the SNPs were retrieved from the SQLite database using SQLite, version 3.41.2, which is available at <ext-link xlink:href="https://www.sqlite.org" ext-link-type="uri">https://www.sqlite.org</ext-link>. The tag sequences were then mapped to the NB and OL genomes using the aln function of BWA, as the TASSEL-GBS pipeline uses this function instead of BWA-MEM. Tag alignment results were analysed in a manner similar to that described in Section 2.2, except for the method used to determine tag origins in the OL genome. Because the true origins of the tags were unknown, NB and OL tassel tags were defined as tags that showed no mismatch or mismatch(es) with the NB genome sequence, respectively. The best matching locations of the OL tassel tags were assigned as the origins of the tags. If the origin of an OL tassel tag was located on a chromosome different from the chromosome on which the tag was mapped in the NB genome, this OL tag was recorded as an interchromosomal alignment. The collinearity of tag origins between the genomes was evaluated as described in Section 2.2. The SNP markers identified by TASSEL-GBS were grouped into four classes based on the properties of the tags supporting each SNP marker: (1) assigned as a multi-tag site (<xref rid="F1" ref-type="fig">Fig. 1A</xref>), (2) supported by collinear tags (<xref rid="F1" ref-type="fig">Fig. 1C</xref>), (3) assigned as a single-tag site but not supported by collinear tags (<xref rid="F1" ref-type="fig">Fig. 1D</xref>), and (4) assigned as an interchromosomal alignment site (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). The statistical significance of the difference in mismapping rates between the four marker classes was tested using the Wilcoxon rank-sum test. The obtained <italic toggle="yes">P</italic>-values were adjusted using Bonferroni’s method.</p>
    </sec>
    <sec id="s9">
      <title>2.7. Genotype calling using MCPtaggR and an OL-nized genome sequence</title>
      <p>Pilon software is a well-established high-performance genome sequence polisher that corrects genome sequences based on short-read alignment information.<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> Theoretically, using Pilon, one can convert one reference genome sequence to another by aligning the WGR reads derived from a related species. Therefore, instead of the publicly available OL genome assembly, the NB genome sequence was converted into an OL genome sequence (OL-nized) using Pilon. The WGR data of an OL plant using HiSeq 2500, deposited under project ID PRJDB6339,<sup><xref rid="CIT0024" ref-type="bibr">24</xref></sup> were obtained from SRA. The WGR reads obtained were aligned to the NB genome using BWA-MEM. The resultant BAM file was supplied as input to Pilon. In typical cases of genome polishing for <italic toggle="yes">de novo</italic> genome assembly, multiple rounds are performed by repeating the read alignment on a polished genome, followed by polishing using Pilon to improve sequence accuracy. Thus, OL-nized genome sequences were generated by performing one, two, three, and four rounds of polishing. Genotype calling using MCPtaggR followed by error correction and dosage estimation using GBScleanR was conducted as described in Section 2.5, using each OL-nized genome sequence as an alternative genome. The number of recombinations per chromosome was counted in the resultant estimated dosage data as described in Section 2.6.</p>
    </sec>
    <sec id="s10">
      <title>2.8. Data availability</title>
      <p>MCPtaggR is available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/MCPtaggR" ext-link-type="uri">https://github.com/tomoyukif/MCPtaggR</ext-link>). More details on package installation and usage can be found in the GitHub repository and the vignette available at <ext-link xlink:href="https://tomoyukif.github.io/MCPtaggR/" ext-link-type="uri">https://tomoyukif.github.io/MCPtaggR/</ext-link>. The test data used in this study were described in our previous publication.<sup><xref rid="CIT0035" ref-type="bibr">35</xref></sup> Because the data size of the full test data exceeds 12 GB, sample FASTQ files, which consist of 10 samples, are installed with MCPtaggR to test the functions.</p>
    </sec>
  </sec>
  <sec id="s11">
    <title>3. Results</title>
    <sec id="s12">
      <title>3.1. GBS-read alignment simulation and error-prone detection</title>
      <p><italic toggle="yes">In silico</italic> digestion at the KpnI and MspI recognition sites generated 155,474 and 125,932 digested-tags from the NB and OL genomes, respectively (<xref rid="T1" ref-type="table">Table 1</xref>). Tag mapping using BWA-MEM resulted in 20,210 and 31,040 unmapped NB- and OL-digested-tags due to short tag sequences, which were less than 30 bp and were ignored by the aligner, and Ns in the tag sequences, which were added to fill the gaps between contigs of the genome assemblies. Multiple alignments were found in 6,295 and 5,308 of the NB- and OL-digested-tags, respectively. Notably, BWA-MEM failed to align 15,919 NB-digested-tags back to their original locations, without any additional alignment information. Manual searches of the tag sequences in the NB genome revealed that these tags had identical sequences at multiple locations. Therefore, these tags were treated as multiple alignment tags. After filtering out the unmapped and multiple-mapped tags, 113,050 and 89,584 NB- and OL-digested-tags were retained, respectively. In the retained OL-digested-tags, 19,705 tags showed interchromosomal alignments and were filtered out. To further assess the properties of the mapped tags, overlaps of tag alignment locations were searched and found in 43,003 sites. Of the 43,003 co-mapped sites, 38,499, and 4504 sites had single and multiple OL-digested-tags, respectively (<xref rid="F1" ref-type="fig">Fig. 1A</xref> and <xref rid="T2" ref-type="table">Table 2</xref>). More than one mismatch pattern was found at 2,238 multiple-tag sites. These sites potentially lead to incorrect genotyping calls owing to different mismatch patterns, resulting in different contributions to read counts as reference and alternative alleles at SNPs. Filtering of single-tag sites with no mismatches and interchromosomal alignments removed 15,760 and 1582 sites, respectively (<xref rid="T2" ref-type="table">Table 2</xref>). As the number of retained single-tag sites was 21,157, approximately 7% of the single-tag sites had SNPs that could be potentially detectable in GBS, but would be derived from interchromosomal alignments, leading to incorrect genotyping calls (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). As the final step of the simulation study, the collinearity of the origins of the digested-tags in the NB and OL genomes was confirmed (<xref rid="F1" ref-type="fig">Fig. 1B-D</xref>). Neither the NB nor OL tag at 105 single-tag sites could be assigned to any collinear block/interval because, for these tag sites, one of the tags was assigned to a block/interval in a genome, whereas the other tag was assigned to an interval in which the corresponding interval was missing in the corresponding genome. Imperfect collinear block detection due to local genomic rearrangements may cause these misassignments. Among the remaining single-tag sites, 435 and 172 sites had OL-digested-tags that were derived from the collinear blocks/intervals located more than 100 kb and 1 Mb away from the blocks/intervals where NB-digested-tags were assigned, respectively (<xref rid="F1" ref-type="fig">Fig. 1D</xref>). These sites can also potentially result in incorrect genotype calls by mismapping reads derived from distant genomic locations. In this simulation, error-prone SNP markers that potentially provide incorrect genotype calls in GBS were found at 4,255 locations, which included multiple-tag sites with multiple missing patterns, single-tag sites with interchromosomal alignments, and single-tag sites with tags from non-collinear origins. In contrast, 16,797 sites were identified as reliable SNP markers (<xref rid="T2" ref-type="table">Table 2</xref>). However, this simulation also demonstrated that more than 20% of the SNP marker sites could be error-prone in GBS.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>Classification of digested-tags</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">NB-digested-tags</th>
              <th align="left" rowspan="1" colspan="1">OL-digested-tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total</td>
              <td align="left" rowspan="1" colspan="1">155,474</td>
              <td align="left" rowspan="1" colspan="1">125,932</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Unmapped</td>
              <td align="left" rowspan="1" colspan="1">20,210</td>
              <td align="left" rowspan="1" colspan="1">31,040</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Multiple alignments</td>
              <td align="left" rowspan="1" colspan="1">6,295</td>
              <td align="left" rowspan="1" colspan="1">5,308</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Silent multiple alignments<xref rid="T1Fn1" ref-type="table-fn"><sup>a</sup></xref></td>
              <td align="left" rowspan="1" colspan="1">15,919</td>
              <td align="left" rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">NA</td>
              <td align="left" rowspan="1" colspan="1">19,705</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Retained</td>
              <td align="left" rowspan="1" colspan="1">113,050</td>
              <td align="left" rowspan="1" colspan="1">69,879</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T1Fn1">
            <p><sup>a</sup>NB-digested-tags that failed to be aligned back to the original locations.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>Classification of co-mapped sites</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">No. of tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total sites</td>
              <td align="left" rowspan="1" colspan="1">43,003</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Multiple-tag sites</td>
              <td align="left" rowspan="1" colspan="1">4,504</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Multiple mismatching patterns</td>
              <td align="left" rowspan="1" colspan="1">2,238</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non- or one mismatching pattern</td>
              <td align="left" rowspan="1" colspan="1">2,266</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Single-tag sites</td>
              <td align="left" rowspan="1" colspan="1">38,499</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non-mismatching pattern</td>
              <td align="left" rowspan="1" colspan="1">15,760</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">1,582</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non-collinear sites</td>
              <td align="left" rowspan="1" colspan="1">4,360</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Collinear sites</td>
              <td align="left" rowspan="1" colspan="1">16,797</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s13">
      <title>3.2. Performance of MCPtaggR for accurate genotype calling</title>
      <p>To eliminate the detection of error-prone markers in RRS-based genotyping, including GBS, the MCPtagg pipeline was developed and implemented in the R package MCPtaggR, as described in Sections 2.3 and 2.4. MCPtaggR detected 19,714 and 19,695 MCP tags in the NB and OL genomes, respectively (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>). The GBS reads were mapped on 6418 and 6701 MCP tags in the NB and OL genomes, respectively. The differences in the number of MCP tags were caused by the differences in RE cut sites between the NB and OL genomes. We confirmed the classifications of the read-mapped OL MCP tags in the classes defined by mapping the digested-tags on the NB genome (<xref rid="T1" ref-type="table">Tables 1</xref> and <xref rid="T2" ref-type="table">2</xref>). Out of 6,701 read-mapped tags, 4,589 tags matched the digested-tags that were mapped on the collinear single-tag sites (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>). The rest of the read-mapped OL MCP tags were classified as tags that were potentially invalid for genotype calling if only the NB genome was used as a reference for read mapping. In other words, MCPtaggR successfully called genotypes using reads that might be potentially mapped on incorrect locations if the NB genome was solely used as a reference.</p>
      <p>The performance was evaluated by comparing the genotype calls generated by MCPtaggR and TASSEL-GBS. After filtering SNP markers as described in Section 2.5, 5,486 and 2,973 SNP markers were retained for the data generated by MCPtaggR and TASSEL-GBS, respectively. Because the raw genotype data output from the tools contained a large number of missing values and heterozygote undercallings, error correction and allele dosage estimation were performed using GBScleanR. The performance of the tools for genotype calling was indirectly evaluated based on the estimated allele dosage instead of raw genotype data. <xref rid="F3" ref-type="fig">Figure 3</xref> depicts a representative case in which MCPtaggR and TASSEL-GBS yielded genotypic calls that resulted in different dosage estimations. TASSEL-GBS detected alternative allele reads at a larger number of markers where the estimated dosage indicated reference homozygotes at the surrounding markers. As a result, GBScleanR estimated the dosage to change from 0 to 1 and then return to 0 within short intervals, indicating a double crossover (upper panels in <xref rid="F3" ref-type="fig">Fig. 3</xref>). Theoretically, double crossovers at short intervals are rarely observed in F<sub>2</sub> populations. These unexpected alternative allele reads were reduced, and double crossovers were eliminated from the MCPtaggR results (<xref rid="F3" ref-type="fig">Fig. 3</xref>, lower panels).</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of obtained read counts and estimate dosages. Estimated dosage (magenta lines) and allele read ratios per marker (green dots) on chromosomes 1 and 10 in a representative sample. The green dots at 0 and 2 on the <italic toggle="yes">y</italic>-axis represent the markers at which only the reference and alternative allele reads were mapped, respectively, whereas the dots between them represent markers that had both allele reads.</p>
        </caption>
        <graphic xlink:href="dsad027_fig3" position="float"/>
      </fig>
      <p>To statistically assess the differences in genotype calling using these tools, we first calculated the concordance rates of the raw genotype calls and estimated dosages between MCPtaggR and TASSEL-GBS. Only 507 SNPs were commonly detected by both tools, whereas 4,979 and 2,466 SNPs were uniquely detected by MCPtaggR and TASSEL-GBS, respectively (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref>). As the number and positions of obtained SNPs were different between the tools, we compared raw genotype calls and estimated dosages between the nearest SNPs detected by MCPtaggR and TASSEL-GBS. The raw genotype calls showed a concordance rate of 67.34%, whereas the estimated dosages exhibited a concordance rate of 98.76% (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref>). Thus, although the raw genotype calls were largely different between MCPtaggR and TASSEL-GBS, highly similar dosages were estimated by GBScleanR from both genotype data. Nevertheless, as shown in <xref rid="F3" ref-type="fig">Fig. 3</xref>, there were unexpected double crossovers at short intervals. To further assess the occurrence of unexpected crossovers due to error-prone markers, the average recombination frequency per chromosome was calculated (<xref rid="F4" ref-type="fig">Fig. 4A</xref> and <xref rid="sup4" ref-type="supplementary-material">Supplementary Table S3</xref>). The expected recombination frequencies in the chromosomes were estimated from their physical lengths, assuming an average recombination rate of 0.04 per Mb. Based on a previous study, the expected recombination frequency across the entire genome of a rice F<sub>2</sub> plant is approximately 15.2.<sup><xref rid="CIT0037" ref-type="bibr">37</xref></sup> As this value matched the sum of the expected recombination frequencies in the chromosomes (14.94), the estimation of recombination frequencies was reliable and acceptable. Although the data generated by both TASSEL-GBS and MCPtaggR showed more frequent recombination than expected, MCPtaggR yielded values that were closer to the expected frequencies compared with those of TASSEL-GBS (<xref rid="F4" ref-type="fig">Fig. 4A</xref>). The number of double crossovers within stretches of 0–1 and 1–2 Mb in the estimated dosage data was also counted (<xref rid="F4" ref-type="fig">Fig. 4B</xref> and <xref rid="sup5" ref-type="supplementary-material">Supplementary Table S4</xref>). A large reduction in unexpected double crossovers within short intervals was observed in the genotype data of MCPtaggR compared with that of TASSEL-GBS.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Genotyping quality assessment. (A) Expected and observed average numbers of recombinations per chromosome in the estimated dosage data. (B) Total number of double crossovers within stretches of 0–1 Mb and 1–2 Mb in the estimated dosage data.</p>
        </caption>
        <graphic xlink:href="dsad027_fig4" position="float"/>
      </fig>
      <p>Although GBScleanR is robust against error-prone markers because it incorporates marker-specific error rates into the hidden Markov model (HMM),<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> it can fail to estimate true genotypes, depending on the distribution and pattern of read counts of error-prone markers. As the estimated dosage of TASSEL-GBS data revealed an increase in recombination frequency and double crossovers, it could be expected that TASSEL-GBS would call genotypes with a larger number of error-prone markers than MCPtaggR. In general, read mismapping caused by the non-collinearity of the origins of the reads results in unexpected heterozygous calls at sites where the true genotypes are homozygotes. Therefore, the mismapping rate per marker was estimated by calculating the proportion of genotype calls that were heterozygous in the raw genotype data, but homozygous in the genotype estimated by GBScleanR. The TASSEL-only markers (2,201 markers) showed a significantly larger mismapping rate than the common markers and MCPtaggR-only markers (772 and 4,150 markers, respectively) (<xref rid="F5" ref-type="fig">Fig. 5A</xref>). In addition, a comparison between common markers and MCPtaggR-only markers indicated a significant reduction in the mismapping rate of MCPtaggR-only markers. Together with a reduction in the number of recombinations and double crossovers, these results demonstrate that MCPtaggR efficiently eliminates error-prone markers from genotype calling and provides more reliable genotype data in combination with GBScleanR.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Mismapping rate per marker. The mismapping rate per marker is shown in violin plots for each class of markers, classified based on the commonness between the tools (A) and the collinearity of mapped tags (B). ‘Common’, ‘TASSEL’, and ‘MCPtaggR’ in panel A indicate the markers commonly detected by both tools, only detected by TASSEL-GBS, and MCPtaggR, respectively. The mismapping rate of the ‘Common’ markers was calculated from the data obtained using TASSEL-GBS. ‘Collinear’, ‘Non-Collinear’, ‘MultiHit’, and ‘InterChr’ indicate the markers supported by collinear tags, non-collinear tags, multiple alignment tags, and interchromosomal alignment tags, respectively. The significance of the differences in mismapping rates between classes is indicated by <sup>N.S.</sup><italic toggle="yes">P</italic> &gt; 0.05, *<italic toggle="yes">P</italic> &lt; 0.05, and **<italic toggle="yes">P</italic> &lt; 0.01.</p>
        </caption>
        <graphic xlink:href="dsad027_fig5" position="float"/>
      </fig>
    </sec>
    <sec id="s14">
      <title>3.3. Confirming the cause of mismapped read</title>
      <p>To confirm that the mismapped reads originated from non-collinear locations in the NB and OL genomes, the original genomic locations of the tassel tag sequences, which were listed and used by TASSEL-GBS for genotype calling, were determined by aligning the tassel tags to the NB and OL genomes. TASSEL-GBS listed 65,063 unique tags from the read data of the rice F<sub>2</sub> samples, whereas 2,973 of the retained SNP markers were supported by only 6,809 tags (<xref rid="T3" ref-type="table">Table 3</xref>). Sequence mismatches were found in 3,868 of the 6,809 tags in the tag alignment to the NB genome. Although these mismatched tags may contain tag sequences generated by sequencing error, 3,868 tags were considered to originate from the OL genome. Of the 3,868 OL tags, 577 tags were mapped to the OL chromosomes that were different from the NB chromosomes, where the tags were mapped for genotype calling, indicating interchromosomal alignments (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). Multiple alignments were observed for 94 OL tags. These interchromosomal and multiple alignment tags contributed to genotype calling at the 390 and 77 retained SNP markers, potentially leading to incorrect genotyping. Among the remaining OL tags, 489 tags that were mapped to 402 SNP marker sites failed to show collinearity with the corresponding NB tags that were mapped to the same SNP locations in the NB genome (<xref rid="F1" ref-type="fig">Fig. 1B–D</xref>). Some of the non-collinear tags did not align with either the NB or OL genomes. The incompleteness of genome assemblies may have caused these missing alignments. Finally, 2,104 SNP markers were found to be reliable SNP markers that were supported by 2,708 OL tags, maintaining collinearity with the corresponding NB tags. This collinearity assessment revealed that 29.2% of the SNP markers provided by TASSEL-GBS were genotyped based on reads originating from invalid or unreliable sources.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3.</label>
        <caption>
          <p>Classification of tassel-tags</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">No. of tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total tags</td>
              <td align="left" rowspan="1" colspan="1">65,063</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Valid SNP supporting tags</td>
              <td align="left" rowspan="1" colspan="1">6,809</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> NB tags</td>
              <td align="left" rowspan="1" colspan="1">2,941</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> OL tags</td>
              <td align="left" rowspan="1" colspan="1">3,868</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">577</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Multiple alignments</td>
              <td align="left" rowspan="1" colspan="1">94</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Non-collinear tags</td>
              <td align="left" rowspan="1" colspan="1">489</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Collinear tags</td>
              <td align="left" rowspan="1" colspan="1">2,708</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The mismapping rates estimated from the proportion of mismatches in the raw genotype calls and estimated dosages revealed significant differences in the properties of the SNP markers classified based on collinearity (<xref rid="F5" ref-type="fig">Fig. 5B</xref>). The markers supported by collinear tassel-tags showed significantly smaller mismapping rates than those supported by non-collinear and interchromosomal alignment tags. The highest mismapping rate was observed for markers supported by interchromosomal alignment tags. The distribution of the mismapping rate per marker indicated that markers with interchromosomal alignments had the most deleterious impact on genotype calling (<xref rid="F5" ref-type="fig">Fig. 5B</xref>). Significantly larger proportions of the markers supported by non-collinear and multiple tags were identified as mismapping prone compared with the markers supported by collinear tags, although some of the markers had no mismapping reads. As shown in the previous section, MCPtaggR filtered out these error-prone markers before genotype calling (<xref rid="F5" ref-type="fig">Fig. 5A</xref>). These results suggested that SNP marker filtering based on sequence collinearity is a reasonable and effective method for accurate genotype calling.</p>
    </sec>
    <sec id="s15">
      <title>3.4. Genotype calling with an OL-nized genome sequence</title>
      <p>Considering situations that require RRS-based genotyping, the genome sequences of the parents of a given population are not always available. In contrast, the genome sequence polisher Pilon is a software to correct the sequence of a genome assembly to improve its quality based on the alignment results of WGR data.<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> Therefore, genotype calling using MCPtaggR was performed using the NB genome assembly and an OL genome sequence that was converted from the NB genome assembly, referred to as an OL-nized genome sequence. Pilon is usually applied repeatedly to improve the quality of a <italic toggle="yes">de novo</italic> assembled genome. Thus, OL-nized genome sequences were obtained by polishing one, two, three, and four times. We compared the SNP positions between the genotype data obtained using the OL genome assembly and the OL-nized genome sequences. Approximately 65% of SNPs (3543 out of 5486) detected using the OL genome assembly were also detected using the OL-nized genome sequence after one round of polishing (<xref rid="T4" ref-type="table">Table 4</xref>). The rate of common SNPs was increased by two rounds of polishing to nearly 70%. Further polishing (three and four rounds) showed negligibly small improvements in the rate of common SNPs. The genotype-calling performance was evaluated based on the number of recombinations per chromosome and double crossovers within short intervals. Only one round of polishing resulted in similar values in the number of recombinations per chromosome and double crossovers within short intervals compared with those observed in the genotype data using the OL genome assembly (<xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). Unexpectedly, an additional round of polishing (two rounds in total) increased the number of recombinations and double crossovers. In addition, more than two rounds of polishing showed negligible improvements. We also compared the concordance rates of raw genotype calls and estimated dosages. Since the number and positions of obtained SNPs were different between the genotype data obtained using different genomes (<xref rid="T4" ref-type="table">Table 4</xref>), we calculated concordance rates of the raw genotype calls and estimated dosages between the nearest SNPs detected using the OL genome assembly and the OL-nized genomes. One round of polishing resulted in poor concordance rates of genotype calls (42.53%) and estimated dosages (39.07%), whereas two rounds of polishing drastically improved concordance rates to 92.63 and 99.74% for genotype calls and estimated dosages, respectively (<xref rid="T4" ref-type="table">Table 4</xref>). Similar to the other measurements described above, two or more rounds of polishing showed almost identical values of the concordance rates. Together with the number of recombinations and crossovers, only one round of polishing was insufficient to OL-nized the NB genome assembly. The OL-nized genome sequence obtained by one-round polishing exhibited comparable frequencies of recombinations and double crossovers to those observed in the OL-nized genome that underwent multiple rounds of polishing (<xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). However, the genotype calls and estimated dosages were largely different from those obtained using the OL genome assembly (<xref rid="T4" ref-type="table">Table 4</xref>). We also found that three or more polishing rounds showed limited improvements in the quality of genotype calling (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). Two rounds of polishing using Pilon were sufficient to obtain genotype calls at a similar quality compared with genotype calling using the OL genome assembly (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). These results demonstrated that the MCPtagg pipeline potentially works sufficiently with an X-nized genome sequence obtained by polishing the genome of a related species, although the positions of markers and raw genotype calls are different from those obtained using a <italic toggle="yes">de novo</italic> assembled genome.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4.</label>
        <caption>
          <p>Concordance rates in genotype calls and estimated dosages</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Pilon<xref rid="T4Fn1" ref-type="table-fn"><sup>a</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Number of markers<xref rid="T4Fn2" ref-type="table-fn"><sup>b</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Concordance rate (%)<xref rid="T4Fn3" ref-type="table-fn"><sup>c</sup></xref></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">1,943, 2,170, 3,543</td>
              <td align="left" rowspan="1" colspan="1">42.53, 39.07</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">1,678, 2,180, 3,808</td>
              <td align="left" rowspan="1" colspan="1">92.63, 99.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">1,671, 2,170, 3,815</td>
              <td align="left" rowspan="1" colspan="1">92.72, 99.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">1,668, 2,168, 3,818</td>
              <td align="left" rowspan="1" colspan="1">92.70, 99.74</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T4Fn1">
            <p><sup>a</sup>The number of rounds Plilon was applied for polishing.</p>
          </fn>
          <fn id="T4Fn2">
            <p><sup>b</sup>The number of markers detected solely in the genotype calling using the assembled OL genome, the OL-nized genome, and markers detected in both are presented, separated by commas.</p>
          </fn>
          <fn id="T4Fn3">
            <p><sup>c</sup>Concordance rates in genotype calls and estimated dosages between those obtained using the OL genome assembly and the OL-nized genome sequence are presented, separated by commas.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec id="s16">
    <title>4. Discussion</title>
    <p>The main purpose of our study was to demonstrate the performance of the MCPtagg pipeline. However, we would also like to note the importance of error correction for RRS-based genotype data. In our study, the concordance rate of raw genotype calls was only 67.34% between MCPtaggR and TASSEL-GBS, as described in Section 3.2. However, a high concordance rate of estimated dosages (98.76%) was observed. Even though the raw genotype calls contained largely different genotype information with different error patterns, GBScleanR could estimate highly similar dosages. As GBScleanR was designed to incorporate marker-specific error patterns in the HMM for robust genotype correction against error-prone markers, error correction and dosage estimation could be achieved by picking up reliable genotype information while eliminating negative impact from error-prone markers.</p>
    <p>Our study presented the deleterious effects of error-prone markers and the causes of these errors. Although we observed the quite high concordance rate of the estimated dosages between MCPtaggR and TASSEL-GBS, TASSEL-GBS resulted in 20 and 1,650% higher number of recombinations and double crossovers within intervals of 0–1 Mb stretches compared with MCPtaggR (<xref rid="sup4" ref-type="supplementary-material">Supplementary Tables S3</xref> and <xref rid="sup5" ref-type="supplementary-material">S4</xref>). Considering the high concordance rate of the estimated dosages, the increase in the recombinations might be caused by the increase of unexpected double crossovers. Unfortunately, the assessment relying on the overall concordance rate was unable to effectively detect these specific local errors, mainly because such local errors usually have limited effects on the overall measurement. As the present study demonstrated, the MCPtagg pipeline effectively eliminates these local errors that are caused by error-prone markers. RRS-based genotyping in populations derived from crosses between very close relatives might result in a few error-prone markers because their genome sequences have conserved sequence similarity and collinearity. However, the more distant relatives that were crossed to produce populations, the more error-prone markers contaminated the genotype data. Geneticists and breeders use wild relatives of cultivated varieties in distant crosses, particularly in genetic studies and breeding programs. RRS-based genotyping is a popular and standard method used in genetic studies and breeding programs. However, contamination with error-prone markers increases the risk of misleading genotype data.<sup><xref rid="CIT0011" ref-type="bibr">11–14</xref></sup> Even though some error-prone markers can be filtered out based on marker statistics, such as allele frequency and heterozygosity, there is no gold standard for filtering criteria. In contrast, MCPtaggR provides an easy-to-use reliable genotype calling pipeline that basically never requires filtering based on user-specified arbitrary criteria. In addition, our study also showed efficiency in detecting SNP markers. We performed genotype calling using TASSEL-GBS and MCPtaggR for the same read dataset obtained from a rice F<sub>2</sub> population. Typically, RRS genotype data are subjected to intensive filtering based on the proportion of missing data, heterozygosity, and minor alleles per marker. Genotyping pipelines for bi- and multi-parental populations also filter out SNP markers for which one or more parental samples showed missing genotype calls due to missing read observations. Because sequence reads are acquired stochastically by a sequencer, RRS-based genotype data contain numerous markers that can be filtered out, particularly in low-read-coverage genotype data. Although the parental samples of the rice F<sub>2</sub> population were sequenced at three times higher read coverage, the filtering of the genotype data provided by TASSEL-GBS retained only 2,973 markers while 8,190 markers were obtained just after pruning markers based on their physical distances. In contrast, MCPtaggR provided 5,486 markers, although it filtered out markers by comparing parental genome sequences prior to genotype calling. Missing genotype calls in either NB or OL were found at 3,646 markers in the genotype data generated by MCPtaggR. In a typical filtering procedure, these markers are removed. However, the reliability of the markers was supported by a pre-survey of SNP markers in the MCPtagg pipeline. Thus, MCPtaggR successfully retained more markers than TASSEL-GBS. Although an increase in read coverage might change the result, MCPtaggR enables us to efficiently obtain as numerous markers as possible, even from low-coverage sequence data.</p>
    <p>One drawback of the MCPtagg pipeline is that it requires high-quality genome assemblies of both parents. However, even in cases where parental genome assemblies are not available, recent developments in bioinformatics tools have enabled us to instantly obtain genome assemblies without conducting costly <italic toggle="yes">de novo</italic> genome assembly. As demonstrated in this study, available genome assemblies can be converted into others using short-read sequences with the genome polishing tool Pilon<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> and methods introduced in previous studies.<sup><xref rid="CIT0038" ref-type="bibr">38</xref>,<xref rid="CIT0039" ref-type="bibr">39</xref></sup> One round of polishing resulted in poor concordance rates between the estimated dosages obtained using the OL genome assembly and the OL-nized genome sequence. This result indicates that only one round of polishing is insufficient to convert the NB genome assembly to an OL-nized genome sequence that can provide sufficiently accurate genotype information using MCPtaggR in combination with GBScleanR. Two rounds of polishing by Pilon were sufficient to achieve a genotyping quality similar to that of the OL genome (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). As a note, this result never implies that the OL-nized genome sequence is identical to the OL genome assembly, but it suggests that the two-round polishing renders an OL-nized genome sequence with sufficient information for genotyping using MCPtaggR. The number of rounds necessary to X-nize a genome assembly might differ depending on target genomes and there is no prior information to estimate the ideal number of rounds. Thus, multiple rounds of polishing are recommended. Nonetheless, our study suggests that the MCPtagg pipeline sufficiently works with converted genomes. Therefore, if a genome assembly is available for species of interest, WGR data from the parents are sufficient to prepare genome assemblies as input for the pipeline, instead of conducting de novo genome assembly. This fact indicates the flexibility and scalability of the pipeline. The read data used for polishing in this study contained 36,708,088 150-bp pair-end reads that corresponded to approximately 10× coverage of the rice genome. Even though the read coverage was not high but rather low, Pilon successfully optimized the NB genome to sufficient quality for genotype calling by MCPtaggR. Nevertheless, an X-nized genome may not reflect genome rearrangements such as translocations and inversions. This result implies that mismapped reads are more likely due to the presence of similar sequences resulting from mutations in the ancestral genome sequences that were originally located elsewhere, rather than originating from translocated and mutated genomic segments.</p>
    <p>Collectively, this study demonstrated the superiority of the MCPtagg pipeline over existing genotype pipelines. Although only TASSEL-GBS was tested with GBS-read data as an example, theoretically similar disadvantages would be found in other RRS-based genotyping methods unless the obtained reads were mapped onto a single reference genome. Another limitation of our study is that we tested the pipeline only using the rice F<sub>2</sub> population derived from a cross between NB and OL. However, this fact never diminishes the value of our study and the pipeline. This point was further discussed and justified in <xref rid="sup7" ref-type="supplementary-material">Supplementary Discussion</xref>. The current implementation of MCPtaggR treats any sequence as a cut site. It is not necessary to specify RE recognition sequences, but one can specify primer sequences used in genotyping based on amplicon sequences such as MIG-seq<sup><xref rid="CIT0040" ref-type="bibr">40</xref></sup> and GRAS-Di® (TOYOTA, Aichi, Japan). Genotype data generated by any RRS-based genotyping method can be processed using the MCPtagg pipeline by tweaking the parameters specifying the cut sites and digested-tag length filtering in the MCPtaggR package. In contrast, the current version of MCPtaggR has a limitation in its applicability, only supporting biparental populations derived from a cross between inbred lines or selfing species. Nonetheless, the pipeline can be expanded to handle outbred lines and outcrossing species if haplotype-phased genome assemblies are available.<sup><xref rid="CIT0041" ref-type="bibr">41</xref></sup> MCPtaggR can also genotype polyploid populations if those were derived from a biparental cross of inbred lines or selfing species. Although the resulting data only includes genotype calls for homozygotes of both alleles and heterozygotes without allele dosage information, polyploid allele dosage estimation tools might help to analyse such genotype call data.<sup><xref rid="CIT0042" ref-type="bibr">42</xref>,<xref rid="CIT0043" ref-type="bibr">43</xref></sup> In addition, the pipeline has the potential to be applied to multiparental populations by conducting comprehensive genome comparisons across all possible combinations of parents. Future updates on the MCPtaggR package will address these expansions of the pipeline. MCPtaggR would increase its applicability as the available genome sequences increase and has the potential to become a standard genotyping method, especially for genotyping populations derived from distant crosses, which may normally cause error-prone SNP detection.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Material_S1</label>
      <media xlink:href="dsad027_suppl_supplementary_material_s1.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S1</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s1.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S2</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s2.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S3</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s3.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S4</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s4.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S5</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s5.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Material_S2</label>
      <media xlink:href="dsad027_suppl_supplementary_material_s2.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="a1">
    <title>Acknowledgements</title>
    <p>We would like to thank Editage (<ext-link xlink:href="https://www.editage.jp" ext-link-type="uri">www.editage.jp</ext-link>) for the English language editing.</p>
  </ack>
  <sec id="s18">
    <title>Funding</title>
    <p>This work was supported by the Grants-in-Aid for Scientific Research (KAKENHI) from the Japan Society for the Promotion of Science [JP20K15503 and JP23H02185 to T.F.].</p>
  </sec>
  <sec id="s19">
    <title>Author contributions</title>
    <p>T.F. conceptualized the project, developed the software, conducted benchmarking, and wrote the manuscript. T.Y. supervised the project and reviewed the manuscript.</p>
  </sec>
  <ref-list id="r1">
    <title>References</title>
    <ref id="CIT0001">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname>, <given-names>J.A.</given-names></string-name> and <string-name><surname>Rife</surname>, <given-names>T.W.</given-names></string-name></person-group><year>2012</year>, <article-title>Genotyping-by-sequencing for plant breeding and genetics</article-title>, <source>Plant Genome</source>, <volume>5</volume>. <pub-id pub-id-type="doi">10.3835/plantgenome2012.05.0005</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0002">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davey</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Hohenlohe</surname>, <given-names>P.A.</given-names></string-name>, <string-name><surname>Etter</surname>, <given-names>P.D.</given-names></string-name>, <string-name><surname>Boone</surname>, <given-names>J.Q.</given-names></string-name>, <string-name><surname>Catchen</surname>, <given-names>J.M.</given-names></string-name>, and <string-name><surname>Blaxter</surname>, <given-names>M.L.</given-names></string-name></person-group><year>2011</year>, <article-title>Genome-wide genetic marker discovery and genotyping using next-generation sequencing</article-title>, <source>Nat. Rev. Genet.</source>, <volume>12</volume>, <fpage>499</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">21681211</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0003">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Torkamaneh</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Boyle</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Belzile</surname>, <given-names>F.</given-names></string-name></person-group><year>2018</year>, <article-title>Efficient genome-wide genotyping strategies and data integration in crop plants</article-title>, <source>Theor. Appl. Genet.</source>, <volume>131</volume>, <fpage>499</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">29352324</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0004">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Unamba</surname>, <given-names>C.I.</given-names></string-name>, <string-name><surname>Nag</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Sharma</surname>, <given-names>R.K.</given-names></string-name></person-group><year>2015</year>, <article-title>Next generation sequencing technologies: The doorway to the unexplored genomics of non-model plants</article-title>, <source>Front. Plant Sci.</source>, <volume>6</volume>, <fpage>1074</fpage>.<pub-id pub-id-type="pmid">26734016</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0005">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname>, <given-names>G.K.-S.</given-names></string-name>, <string-name><surname>Soltis</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Leebens-Mack</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group><year>2020</year>, <article-title>Sequencing and analyzing the transcriptomes of a thousand species across the tree of life for green plants</article-title>, <source>Annu. Rev. Plant Biol.</source>, <volume>71</volume>, <fpage>741</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">31851546</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0006">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheben</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Batley</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Edwards</surname>, <given-names>D.</given-names></string-name></person-group><year>2017</year>, <article-title>Genotyping-by-sequencing approaches to characterize crop genomes: choosing the right tool for the right application</article-title>, <source>Plant Biotechnol. J.</source>, <volume>15</volume>, <fpage>149</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">27696619</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0007">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname>, <given-names>M.R.</given-names></string-name>, <string-name><surname>Dunham</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Amores</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Cresko</surname>, <given-names>W.A.</given-names></string-name>, and <string-name><surname>Johnson</surname>, <given-names>E.A.</given-names></string-name></person-group><year>2007</year>, <article-title>Rapid and cost-effective polymorphism identification and genotyping using restriction site associated DNA (RAD) markers</article-title>, <source>Genome Res.</source>, <volume>17</volume>, <fpage>240</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">17189378</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0008">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterson</surname>, <given-names>B.K.</given-names></string-name>, <string-name><surname>Weber</surname>, <given-names>J.N.</given-names></string-name>, <string-name><surname>Kay</surname>, <given-names>E.H.</given-names></string-name>, <string-name><surname>Fisher</surname>, <given-names>H.S.</given-names></string-name>, and <string-name><surname>Hoekstra</surname>, <given-names>H.E.</given-names></string-name></person-group><year>2012</year>, <article-title>Double Digest RADseq: An inexpensive method for de novo SNP discovery and genotyping in model and non-model species</article-title>, <source>PLoS One</source>, <volume>7</volume>, <fpage>e37135</fpage>.<pub-id pub-id-type="pmid">22675423</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0009">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elshire</surname>, <given-names>R.J.</given-names></string-name>, <string-name><surname>Glaubitz</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>Q.</given-names></string-name>, <etal>et al.</etal></person-group><year>2011</year>, <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>, <source>PLoS One</source>, <volume>6</volume>, <fpage>e19379</fpage>.<pub-id pub-id-type="pmid">21573248</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0010">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname>, <given-names>J.A.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>P.J.</given-names></string-name>, <string-name><surname>Sorrells</surname>, <given-names>M.E.</given-names></string-name>, and <string-name><surname>Jannink</surname>, <given-names>J.</given-names></string-name></person-group><year>2012</year>, <article-title>Development of high-density genetic maps for barley and wheat using a novel two-enzyme genotyping-by-sequencing approach</article-title>, <source>PLoS One</source>, <volume>7</volume>, <fpage>e32253</fpage>.<pub-id pub-id-type="pmid">22389690</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0011">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Günther</surname>, <given-names>T.</given-names></string-name> and <string-name><surname>Nettelblad</surname>, <given-names>C.</given-names></string-name></person-group><year>2019</year>, <article-title>The presence and impact of reference bias on population genomic studies of prehistoric human populations</article-title>, <source>PLoS Genet.</source>, <volume>15</volume>, <fpage>e1008302</fpage>.<pub-id pub-id-type="pmid">31348818</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0012">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freeman</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>J.</given-names></string-name></person-group>; <collab>Genomics England Research Consortium</collab>. <year>2020</year>, <article-title>Genomic loci susceptible to systematic sequencing bias in clinical whole genomes</article-title>, <source>Genome Res.</source>, <volume>30</volume>, <fpage>415</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">32156711</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0013">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valiente-Mullor</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Beamud</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Ansari</surname>, <given-names>I.</given-names></string-name>, <etal>et al.</etal></person-group><year>2021</year>, <article-title>One is not enough: on the effects of reference genome for the mapping and subsequent analyses of short-reads</article-title>, <source>PLoS Comput. Biol.</source>, <volume>17</volume>, <fpage>e1008678</fpage>.<pub-id pub-id-type="pmid">33503026</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0014">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Yamamoto</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Ashikari</surname>, <given-names>M.</given-names></string-name></person-group><year>2023</year>, <article-title>GBScleanR: robust genotyping error correction using a hidden Markov model with error pattern recognition</article-title>, <source>Genetics</source>, <volume>224</volume>, <fpage>iyad055</fpage>.<pub-id pub-id-type="pmid">36988327</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0015">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wijnker</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>James</surname>, <given-names>G.V.</given-names></string-name>, <string-name><surname>Ding</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>, <article-title>The genomic landscape of meiotic crossovers and gene conversions in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>, <source>eLife</source>, <volume>2</volume>, <fpage>e01426</fpage>.<pub-id pub-id-type="pmid">24347547</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0016">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacob</surname>, <given-names>F.D.</given-names></string-name>, <string-name><surname>John</surname>, <given-names>C.M.</given-names></string-name>, <string-name><surname>Athma</surname>, <given-names>A.P.</given-names></string-name>, <etal>et al.</etal></person-group><year>2009</year>, <article-title>Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data</article-title>, <source>Bioinformatics</source>, <volume>25</volume>, <fpage>3207</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">19808877</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0017">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Panousis</surname>, <given-names>N.I.</given-names></string-name>, <string-name><surname>Gutierrez-Arcelus</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Dermitzakis</surname>, <given-names>E.T.</given-names></string-name>, and <string-name><surname>Lappalainen</surname>, <given-names>T.</given-names></string-name></person-group><year>2014</year>, <article-title>Allelic mapping bias in RNA-sequencing is not a major confounder in eQTL studies</article-title>, <source>Genome Biol.</source>, <volume>15</volume>, <fpage>467</fpage>.<pub-id pub-id-type="pmid">25239376</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0018">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebler</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Ebert</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Clarke</surname>, <given-names>W.E.</given-names></string-name>, <etal>et al.</etal></person-group><year>2022</year>, <article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>, <source>Nat. Genet.</source>, <volume>54</volume>, <fpage>518</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">35410384</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0019">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iqbal</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Caccamo</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Turner</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Flicek</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>McVean</surname>, <given-names>G.</given-names></string-name></person-group><year>2012</year>, <article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>, <source>Nat. Genet.</source>, <volume>44</volume>, <fpage>226</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">22231483</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0020">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shajii</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yorukoglu</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Y.W.</given-names></string-name>, and <string-name><surname>Berger</surname>, <given-names>B.</given-names></string-name></person-group><year>2016</year>, <article-title>Fast genotyping of known SNPs through approximate k -mer matching</article-title>, <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i538</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27587672</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0021">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sibbesen</surname>, <given-names>J.A.</given-names></string-name>, <string-name><surname>Maretty</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Krogh</surname>, <given-names>A.</given-names></string-name></person-group>; <collab>Danish Pan-Genome Consortium</collab>. <year>2018</year>, <article-title>Accurate genotyping across variant classes and lengths using variant graphs</article-title>, <source>Nat. Genet.</source>, <volume>50</volume>, <fpage>1054</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29915429</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0022">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaubitz</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Casstevens</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Lu</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal></person-group><year>2104</year>, <article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title>, <source>PLoS One</source>, <volume>9</volume>, <fpage>e90346</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0023">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sakai</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tanaka</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>, <article-title>Rice Annotation Project Database (RAP-DB): an integrative and interactive database for rice genomics</article-title>, <source>Plant Cell Physiol.</source>, <volume>54</volume>, <fpage>e6</fpage>–<lpage>e6</lpage>.<pub-id pub-id-type="pmid">23299411</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0024">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reuscher</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Bessho-Uehara</surname>, <given-names>K.</given-names></string-name>, <etal>et al.</etal></person-group><year>2018</year>, <article-title>Assembling the genome of the African wild rice <italic toggle="yes">Oryza longistaminata</italic> by exploiting synteny in closely related <italic toggle="yes">Oryza</italic> species</article-title>, <source>Commun. Biol.</source>, <volume>1</volume>, <fpage>162</fpage>.<pub-id pub-id-type="pmid">30320230</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0025">
      <label>25.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Gentleman</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>DebRoy</surname>, <given-names>S.</given-names></string-name></person-group>, <year>2022</year>, <article-title>Biostrings: efficient manipulation of biological strings</article-title>. <pub-id pub-id-type="doi">10.18129/B9.bioc.Biostrings.2022</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0026">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname>, <given-names>E.S.</given-names></string-name></person-group><year>2016</year>, <article-title>Using DECIPHER v20 to analyze big biological sequence data in R</article-title>, <source>R J.</source>, <volume>8</volume>, <fpage>352</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0027">
      <label>27.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>H.</given-names></string-name></person-group><year>2013</year>, <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <comment><italic toggle="yes">arXiv</italic>, 1303.3997v2, Date of publication 26 May 2013</comment>, <ext-link xlink:href="http://arxiv.org/pdf/1303.3997.pdf" ext-link-type="uri">http://arxiv.org/pdf/1303.3997.pdf</ext-link>, <comment>preprint: not peer reviewed</comment>.</mixed-citation>
    </ref>
    <ref id="CIT0028">
      <label>28.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Morgan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Obenchain</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>Hayden</surname>, <given-names>N.</given-names></string-name></person-group><year>2023</year>, <article-title>Rsamtools: Binary alignment (BAM), FASTA, variant call (BCF), and tabix file import</article-title>, <comment>Accessed 24 Apr 2023</comment>. <ext-link xlink:href="https://bioconductor.org/packages/Rsamtools" ext-link-type="uri">https://bioconductor.org/packages/Rsamtools</ext-link></mixed-citation>
    </ref>
    <ref id="CIT0029">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marçais</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Delcher</surname>, <given-names>A.L.</given-names></string-name>, <string-name><surname>Phillippy</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Coston</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>, and <string-name><surname>Zimin</surname>, <given-names>A.</given-names></string-name></person-group><year>2018</year>, <article-title>MUMmer4: a fast and versatile genome alignment system</article-title>, <source>PLoS Comput. Biol.</source>, <volume>14</volume>, <fpage>e1005944</fpage>.<pub-id pub-id-type="pmid">29373581</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0030">
      <label>30.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Smit</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hubley</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Green</surname>, <given-names>P.</given-names></string-name></person-group><comment>RepeatMasker Open-4.0. 2013-2015</comment>, <comment>Accessed 4 May 2023</comment>. <ext-link xlink:href="http://www.repeatmasker.org" ext-link-type="uri">http://www.repeatmasker.org</ext-link></mixed-citation>
    </ref>
    <ref id="CIT0031">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name></person-group><year>2013</year>, <article-title>The Subread aligner: fast, accurate and scalable read mapping by seed-and-vote</article-title>, <source>Nucleic Acids Res.</source>, <volume>41</volume>, <fpage>e108</fpage>–<lpage>e108</lpage>.<pub-id pub-id-type="pmid">23558742</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0032">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Auton</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Abecasis</surname>, <given-names>G.</given-names></string-name>, <etal>et al.</etal></person-group>; <collab>1000 Genomes Project Analysis Group</collab>. <year>2011</year>, <article-title>The variant call format and VCFtools</article-title>, <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0033">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Levine</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Gogarten</surname>, <given-names>S.M.</given-names></string-name>, <string-name><surname>Laurie</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Weir</surname>, <given-names>B.S.</given-names></string-name></person-group><year>2012</year>, <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>, <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3326</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0034">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name></person-group><year>2019</year>, <article-title>The R package Rsubread is easier, faster, cheaper and better for alignment and quantification of RNA sequencing reads</article-title>, <source>Nucleic Acids Res.</source>, <volume>47</volume>, <fpage>e47</fpage>–<lpage>e47</lpage>.<pub-id pub-id-type="pmid">30783653</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0035">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Ashikari</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Jena</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Doi</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Reuscher</surname>, <given-names>S.</given-names></string-name></person-group><year>2017</year>, <article-title>Adapting genotyping-by-sequencing for rice F2 populations</article-title>, <source>G3–Genes Genom Genet</source>, <volume>7</volume>, <fpage>881</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0036">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Walker</surname>, <given-names>B.J.</given-names></string-name>, <string-name><surname>Abeel</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Shea</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Priest</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Abouelliel</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal></person-group>, <year>2014</year>, <article-title>Pilon: an integrated tool for comprehensive microbial variant detection and genome assembly improvement</article-title>, <source>PLoS One</source>, <volume>9</volume>, <fpage>e112963</fpage>.<pub-id pub-id-type="pmid">25409509</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0037">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Presting</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Barbazuk</surname>, <given-names>W.</given-names></string-name>, <etal>et al.</etal></person-group><year>2002</year>, <article-title>An integrated physical and genetic map of the rice genome</article-title>, <source>Plant Cell</source>, <volume>14</volume>, <fpage>537</fpage>.<pub-id pub-id-type="pmid">11910002</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0038">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schneeberger</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ossowski</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Ott</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal></person-group><year>2011</year>, <article-title>Reference-guided assembly of four diverse Arabidopsis thaliana genomes</article-title>, <source>Proc. Natl. Acad. Sci. USA</source>, <volume>108</volume>, <fpage>10249</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">21646520</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0039">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lischer</surname>, <given-names>H.E.L.</given-names></string-name> and <string-name><surname>Shimizu</surname>, <given-names>K.K.</given-names></string-name></person-group><year>2017</year>, <article-title>Reference-guided de novo assembly approach improves genome reconstruction for related species</article-title>, <source>BMC Bioinf.</source>, <volume>18</volume>, <fpage>474</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0040">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suyama</surname>, <given-names>Y.</given-names></string-name> and <string-name><surname>Matsuki</surname>, <given-names>Y.</given-names></string-name></person-group><year>2015</year>, <article-title>MIG-seq: an effective PCR-based method for genome-wide single-nucleotide polymorphism genotyping using the next-generation sequencing platform</article-title>, <source>Sci. Rep.</source>, <volume>5</volume>, <fpage>16963</fpage>.<pub-id pub-id-type="pmid">26593239</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0041">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guk</surname>, <given-names>J.Y.</given-names></string-name>, <string-name><surname>Jang</surname>, <given-names>M.J.</given-names></string-name>, <string-name><surname>Choi</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>Y.M.</given-names></string-name>, and <string-name><surname>Kim</surname>, <given-names>S.</given-names></string-name></person-group><year>2022</year>, <article-title>De novo phasing resolves haplotype sequences in complex plant genomes</article-title>, <source>Plant Biotechnol. J.</source>, <volume>20</volume>, <fpage>1031</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">35332665</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0042">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerard</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Ferrão</surname>, <given-names>L.F.V.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>A.A.F.</given-names></string-name>, and <string-name><surname>Stephens</surname>, <given-names>M.</given-names></string-name></person-group><year>2018</year>, <article-title>Genotyping polyploids from messy sequencing data</article-title>, <source>Genetics</source>, <volume>210</volume>, <fpage>789</fpage>–<lpage>807</lpage>.<pub-id pub-id-type="pmid">30185430</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0043">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lipka</surname>, <given-names>A.E.</given-names></string-name>, and <string-name><surname>Sacks</surname>, <given-names>E.J.</given-names></string-name></person-group><year>2019</year>, <article-title>polyRAD: genotype calling with uncertainty from sequencing data in polyploids and diploids</article-title>, <source>G3–Genes Genom Genet</source>, <volume>9</volume>, <fpage>663</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">DNA Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">DNA Res</journal-id>
    <journal-id journal-id-type="publisher-id">dnares</journal-id>
    <journal-title-group>
      <journal-title>DNA Research: An International Journal for Rapid Publication of Reports on Genes and Genomes</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1340-2838</issn>
    <issn pub-type="epub">1756-1663</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10799318</article-id>
    <article-id pub-id-type="pmid">38134958</article-id>
    <article-id pub-id-type="doi">10.1093/dnares/dsad027</article-id>
    <article-id pub-id-type="publisher-id">dsad027</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00774</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MCPtaggR: R package for accurate genotype calling in reduced representation sequencing data by eliminating error-prone markers based on genome comparison</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0869-6626</contrib-id>
        <name>
          <surname>Furuta</surname>
          <given-names>Tomoyuki</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Kurashiki, Okayama</addr-line>, <country country="JP">Japan</country></aff>
        <xref rid="c1" ref-type="corresp"/>
        <!--f.tomoyuki@okayama-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Toshio</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Kurashiki, Okayama</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="c1">To whom correspondence should be addressed. Tel: +81-86-434-1208. Fax: +81-86-434-1208. Email: <email>f.tomoyuki@okayama-u.ac.jp</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-22">
      <day>22</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>31</volume>
    <issue>1</issue>
    <elocation-id>dsad027</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Kazusa DNA Research Institute.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dsad027.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Reduced representation sequencing (RRS) offers cost-effective, high-throughput genotyping platforms such as genotyping-by-sequencing (GBS). RRS reads are typically mapped onto a reference genome. However, mapping reads harbouring mismatches against the reference can potentially result in mismapping and biased mapping, leading to the detection of error-prone markers that provide incorrect genotype information. We established a genotype-calling pipeline named mappable collinear polymorphic tag genotyping (MCPtagg) to achieve accurate genotyping by eliminating error-prone markers. MCPtagg was designed for the RRS-based genotyping of a population derived from a biparental cross. The MCPtagg pipeline filters out error-prone markers prior to genotype calling based on marker collinearity information obtained by comparing the genome sequences of the parents of a population to be genotyped. A performance evaluation on real GBS data from a rice F<sub>2</sub> population confirmed its effectiveness. Furthermore, our performance test using a genome assembly that was obtained by genome sequence polishing on an available genome assembly suggests that our pipeline performs well with converted genomes, rather than necessitating <italic toggle="yes">de novo</italic> assembly. This demonstrates its flexibility and scalability. The R package, MCPtaggR, was developed to provide functions for the pipeline and is available at <ext-link xlink:href="https://github.com/tomoyukif/MCPtaggR" ext-link-type="uri">https://github.com/tomoyukif/MCPtaggR</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>genotyping</kwd>
      <kwd>genome comparison</kwd>
      <kwd>next-generation sequencing</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Society for the Promotion of Science</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001691</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JP20K15503</award-id>
        <award-id>JP23H02185</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1. Introduction</title>
    <p>Next-generation sequencing (NGS) has enabled us to simultaneously obtain high-resolution genotypic information from a large number of samples.<sup><xref rid="CIT0001" ref-type="bibr">1</xref></sup> NGS provides genotyping platforms with remarkably improved flexibility and throughput and is now routinely used in diverse fields of biology.<sup><xref rid="CIT0002" ref-type="bibr">2–4</xref></sup> Nevertheless, obtaining genome-wide genotype information via whole-genome resequencing (WGR) is an expensive option for researchers.<sup><xref rid="CIT0005" ref-type="bibr">5</xref></sup> Numerous reduced representation sequencing (RRS) methods have been introduced to meet the demand for cost-effective genotyping systems using dense markers.<sup><xref rid="CIT0006" ref-type="bibr">6</xref></sup> Since restriction site-associated DNA sequencing (RAD-seq) was first published in 2007,<sup><xref rid="CIT0007" ref-type="bibr">7</xref></sup> several derivative methods have been introduced, including ddRADseq<sup><xref rid="CIT0008" ref-type="bibr">8</xref></sup> and genotyping-by-sequencing (GBS).<sup><xref rid="CIT0009" ref-type="bibr">9</xref>,<xref rid="CIT0010" ref-type="bibr">10</xref></sup></p>
    <p>To identify genotypes at single-nucleotide polymorphism (SNP) markers, NGS reads are typically mapped onto one reference sequence. However, several studies have reported that mapping reads on one reference causes the detection of error-prone SNP markers owing to mismapping and biased mapping of NGS reads derived from non-reference genomes.<sup><xref rid="CIT0011" ref-type="bibr">11–13</xref></sup> In addition to genotyping a population derived from a distant cross, such as interspecific crosses conducted in plants,<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> these error-prone markers have also been observed in genetic studies of bacteria and humans.<sup><xref rid="CIT0011" ref-type="bibr">11–13</xref></sup> Read mismapping may have been caused by structural differences between the reference genome and genomes that were genotyped. Translocations of genome segments potentially result in reads that can be mapped to the same location in the reference genome but actually originate from another location in the genomes of genotyped samples.<sup><xref rid="CIT0015" ref-type="bibr">15</xref></sup> Biased mapping, also known as reference bias, occurs because of the methodological nature of read alignment.<sup><xref rid="CIT0016" ref-type="bibr">16</xref>,<xref rid="CIT0017" ref-type="bibr">17</xref></sup> Sequencing reads derived from a non-reference genome have mismatches with reference sequences. These mismatches cause sequencing reads to be simultaneously mapped to multiple locations with the same probability or even unmapped.<sup><xref rid="CIT0016" ref-type="bibr">16</xref></sup> Because read alignment is achieved by evaluating the sequence matches between a query sequence and a subject sequence, the reference allele reads can be preferentially mapped to the reference genome. In such situations, a genome graph representing a pan-genome sequence is a solution to avoid these errors.<sup><xref rid="CIT0018" ref-type="bibr">18</xref></sup> Variations, including SNPs, insertions and deletions (indels), and translocations, represented in the genome graph prevent mismapping and biased mapping. Although this approach effectively improves the genotyping accuracy, genome graph construction and read alignment remain computationally challenging. Other types of graph-based approaches have also been proposed.<sup><xref rid="CIT0019" ref-type="bibr">19–21</xref></sup> These graph-based approaches require a list of SNPs validated as reliable and call genotypes based on the SNP list. However, these lists of validated SNPs are typically not available for genetic mapping and plant breeding populations because scientists and breeders tend to use a unique combination of parents to create a population. Therefore, a simple and flexible SNP-genotyping pipeline is required to avoid mismapping and biased mapping.</p>
    <p>This study introduces the mappable collinear polymorphic tag genotyping (MCPtagg) pipeline and the R package MCPtaggR, which provides functions for MCPtagg. MCPtagg is a pipeline for processing RRS data to precisely detect SNPs and count reads on reliable tags (short genome segments) that were validated based on genome comparison information. The current version of the pipeline supports a population derived from a biparental cross. First, a simulation study illustrates how structural differences in genomes can lead to the emergence of error-prone markers in GBS data. We then assess the performance of MCPtaggR using real data, comparing it with the well-established pipeline TASSEL-GBS.<sup><xref rid="CIT0022" ref-type="bibr">22</xref></sup> Finally, the simplicity, efficiency, and flexibility of the MCPtagg pipeline and the MCPtaggR implementation are discussed.</p>
  </sec>
  <sec id="s2">
    <title>2. Materials and methods</title>
    <sec id="s3">
      <title>2.1. 
<italic toggle="yes">In silico</italic> genome digestion and digested-tag alignment</title>
      <p>To simulate the digestion of genomic DNA in GBS library preparation, <italic toggle="yes">in silico</italic> digestion was performed on the genome sequences of the cultivated rice <italic toggle="yes">Oryza sativa</italic> cv. Nipponbare (NB), and wild rice <italic toggle="yes">O. longistaminta</italic> (OL). The NB and OL genome sequences were downloaded from RAP-DB<sup><xref rid="CIT0023" ref-type="bibr">23</xref></sup> and <italic toggle="yes">Oryza longistaminata</italic> Information Resource,<sup><xref rid="CIT0024" ref-type="bibr">24</xref></sup> respectively. The obtained FASTA files of the genome sequences were loaded into the R environment using the Biostrings package, version 2.68.1.<sup><xref rid="CIT0025" ref-type="bibr">25</xref></sup> Since the real sequencing reads used in this study were obtained by GBS with KpnI and MspI (see Section 2.5), the recognition sequences of KpnI and MspI were searched in the given genome sequences using the DigestDNA function in the DECIPHER package, version 2.0.<sup><xref rid="CIT0026" ref-type="bibr">26</xref></sup> The <italic toggle="yes">in silico</italic> digested fragments were filtered to retain only those with a KpnI cut site at one end and an MspI cut site at the other end, which could potentially be sequenced in real GBS. To simulate the sequencing reads generated by NGS, fragment sequences were cropped to retain a maximum of 75 bp from both ends. The 75-bp cropped sequences, referred to as digested-tags, from the KpnI and MspI cut sites, were treated as Read1 and Read2 of typical paired-end sequencing output and stored in FASTQ files, respectively. Phred scores for the reads were set to ‘;’ indicating the quality score is 26 for all nucleotides, which was the default behaviour of the writeXStringSet function in the Biostrings package. Each set of digested-tags generated from the NB and OL genomes was aligned to the NB genome using BWA-MEM, version 0.7.17.<sup><xref rid="CIT0027" ref-type="bibr">27</xref></sup> The flags ‘-S -P’ were set to run BWA-MEM with skipping read pairing and mate rescue to allow the tags mapped to their best matching locations regardless of mate read mapping locations.</p>
    </sec>
    <sec id="s4">
      <title>2.2. Evaluation of digested-tag alignments</title>
      <p>The alignment results of the digested-tags were evaluated using the following steps. The output files generated by BWA-MEM, which store the alignments of the NB- and OL-digested-tags on the NB genome, were imported into the R environment using the Rsamtools package, version 2.16.0.<sup><xref rid="CIT0028" ref-type="bibr">28</xref></sup> First, unmapped reads were filtered from the imported alignment data. In general, genotype-calling pipelines filter multiple mapping reads mapped to multiple locations with the same mapping quality. Therefore, multiple mapping reads were filtered out based on the information stored in the XA tag of the SAM file, which shows the additional mapping locations of the reads. This filtering retained only reads uniquely mapped on single locations that were the origins of the digested-tags in the case of the NB-digested-tags. Subsequently, tag alignment locations were searched to identify genome locations where both NB- and OL-digested-tags were mapped (co-mapped sites). The co-mapped sites were classified into two types based on the number of mapped OL-digested-tags: single-tag sites and multi-tag sites, where only one and multiple tags were mapped, respectively (<xref rid="F1" ref-type="fig">Fig. 1A</xref>). Finally, the collinearity of the origins of tags between genomes was evaluated. Collinearity between genomes refers to the conservation of sequence order and orientation across different genomes. Genome regions that have collinearity are defined as collinear blocks. Collinear blocks between the NB and OL genomes (<xref rid="F1" ref-type="fig">Fig. 1B</xref>) were searched using the functions of MUMmer4<sup><xref rid="CIT0029" ref-type="bibr">29</xref></sup> as follows. Repeat sequences in the genomes were masked using RepeatMasker<sup><xref rid="CIT0030" ref-type="bibr">30</xref></sup> with the arguments ‘-excln -s -no_is -species rice’ and the RepBase RepeatMasker Edition library downloaded from <ext-link xlink:href="https://www.girinst.org" ext-link-type="uri">www.girinst.org</ext-link> prior to processing using MUMmer to reduce the unnecessary computation time to find sequence matches between repeat sequences. The masked genomes were processed using the nucmer function with the parameters ‘--maxmatch -g 1000’ followed by filtering on the outputs using the delta-filter function with the setting ‘-1’. Collinear block coordinates were summarized using the show-coords function with the setting ‘-CTlr’. Intervals between collinear blocks can also be assumed to conserve relative positions in the genomes. Therefore, these intervals were considered collinear (<xref rid="F1" ref-type="fig">Fig. 1B</xref>). If the origins of the NB and OL tags mapped to single-tag sites were located in the corresponding collinear blocks or intervals in the NB and OL genomes, respectively, the single-tag sites were recorded as collinear tag sites (<xref rid="F1" ref-type="fig">Fig. 1C</xref>). For each non-collinear tag site, the physical distance was measured between the start position of the block/interval in which the OL tag was mapped and the start position of the collinear block/interval in the NB genome, corresponding to the origin of the OL tag in the OL genome (<xref rid="F1" ref-type="fig">Fig. 1D</xref>). If the OL tags of the non-collinear tag sites originated from chromosomes that were different from the chromosomes where the OL tags were mapped in the NB genome, these sites were counted as interchromosomal alignment sites (<xref rid="F1" ref-type="fig">Fig. 1E</xref>).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Collinearity assessment of the digested-tags. (A) The locations, at which the NB- and OL-digested-tags were mapped, were classified into single-tag sites and multiple-tag sites. Single-tag sites are the genome locations where single NB and OL tags were mapped, whereas multi-tag sites have multiple OL tags. NB and OL tags are represented by green and blue lines in the schematic image. (B) The NB and OL genomes were segmented in collinear blocks and intervals. (C) A single-tag site was classified as a collinear-tag site if the OL tag that was mapped at the single-tag site originated from the collinear block/interval corresponding to the block/interval of the single-tag site. Magenta arrows point to the origins of the OL tags in the OL genome. (D) If a single-tag site was a non-collinear tag site, the physical distance was measured between the start position of the block/interval in which the OL tag was mapped and the start position of the collinear block/interval in the NB genome corresponding to the origin of the OL tag in the OL genome. The magenta double-headed arrow indicates the distance to be measured. (E) If an OL tag originated from a chromosome that does not correspond to the chromosome where the OL tag was mapped in the NB genome, the site was assigned as an interchromosomal alignment site.</p>
        </caption>
        <graphic xlink:href="dsad027_fig1" position="float"/>
      </fig>
    </sec>
    <sec id="s5">
      <title>2.3. Algorithm of MCPtagg</title>
      <p>MCPtagg was designed for the RRS-based genotyping of a population derived from a biparental cross. The pipeline requires the genome sequences of parents and NGS reads obtained using RRS from a population derived from a biparental cross. Before mapping reads, the pipeline prepares a list of MCP tags. First, a whole-genome sequence comparison detects collinear blocks, each of which is a pair of genomic regions sharing identical or similar sequences that can be found at one locus in each parental genome and are arranged in the same order in both parental genomes (<xref rid="F2" ref-type="fig">Fig. 2A</xref>). The SNPs in the collinear blocks are used as SNP markers for subsequent genotype calling. Thereafter, <italic toggle="yes">in silico</italic> digestion of the genomes simulates the restriction fragments generated during library preparation for the RRS (<xref rid="F2" ref-type="fig">Fig. 2B</xref>). To simulate the NGS reads obtained by sequencing the restriction fragments, the simulated sequences are clipped to ensure that they are less than or equal to the maximum read length. In this step, the algorithm identifies SNPs that are potentially undetectable in genotype calling because there were no restriction sites close enough to be sequenced (<xref rid="F2" ref-type="fig">Fig. 2B</xref>). All the simulated reads from both genomes are simultaneously mapped to the genomes (<xref rid="F2" ref-type="fig">Fig. 2C</xref>). Based on the mapping results, the filtering step retains only SNPs at which the simulated reads can be uniquely mapped onto each genome at the correct positions (<xref rid="F2" ref-type="fig">Fig. 2D</xref>). If a simulated read is mapped to multiple locations in both or either of the genomes, the read in real data can potentially cause mismapping if it is mapped to one reference genome. The algorithm then lists MCP tags that are the genomic sequences/regions where the simulated reads are uniquely and completely mappable, located in the collinear blocks, and harbour SNPs. Genotype calling is accomplished by mapping real NGS reads to MCP tags. Reads mapped to the corresponding SNP positions on the MCP tags in each genome without any mismatches and indels are counted to determine the genotypes at the SNP markers.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Schematic of the MCPtagg algorithm and the MCPtaggR workflow. (A) The MCPtagg pipeline requires the SNPs (indicated by magenta X symbols) and collinear blocks (indicated by yellow boxes) information that can be obtained by comparing two genomes using the genome sequence comparison tool MUMmer. (B) Subsequently, the pipeline conducts <italic toggle="yes">in silico</italic> digestion of the genomes to simulate sequencing reads generated in an NGS run. Restriction sites are indicated by blue and green arrows. The grey dashed rectangle indicates an example that a restriction site of a restriction enzyme is missing in genome B. (C) The simulated reads are mapped to both genomes simultaneously. (D) Based on the mapping results, the algorithm detects MCP tags (indicated by the magenta dashed rectangle). The grey dashed rectangle indicates a region where the simulated read failed to map uniquely and completely. (E) The schematic image represents the MCPtaggR workflow for genotype calling. The texts in rectangles display input and output files, whereas the bold texts indicate the function names. The arrows represent data flow through the pipeline.</p>
        </caption>
        <graphic xlink:href="dsad027_fig2" position="float"/>
      </fig>
    </sec>
    <sec id="s6">
      <title>2.4. Implementation of the MCPtagg pipeline in MCPtaggR</title>
      <p>The R package, MCPtaggR, provides functions for the MCPtagg pipeline (<xref rid="F2" ref-type="fig">Fig. 2E</xref>). Collinear block detection and read mapping require the external tools, MUMmer<sup><xref rid="CIT0029" ref-type="bibr">29</xref></sup> and Subread,<sup><xref rid="CIT0031" ref-type="bibr">31</xref></sup> respectively. The run_mummer() function is a wrapper function that internally executes MUMmer functions to identify collinear blocks and SNPs. FASTA files of the reference and alternative genomes set to run_mummer() are used to count the reference and alternative allele reads in the read-counting step. The mummer2SNPs() function converts and organizes the MUMmer outputs into a list of candidate MCP tags. The digestGenome() and alignTAG() functions perform <italic toggle="yes">in silico</italic> genome digestion and simulated read mapping. The outputs from both functions are used as inputs for the findMCPtag() function to list the MCP tags. The function mcptagg() performs read mapping to the MCP tags and outputs read counts and genotype calls in a variant call format (VCF) file<sup><xref rid="CIT0032" ref-type="bibr">32</xref></sup> and a genomic data structure (GDS) file.<sup><xref rid="CIT0033" ref-type="bibr">33</xref></sup> The output GDS file can be directly manipulated using the GBScleanR package, which provides functions for filtering, data visualization, and genotyping error correction.<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> The alignTAG() and mcptagg() functions internally execute the align() function in the Rsubread package for read mapping.<sup><xref rid="CIT0034" ref-type="bibr">34</xref></sup></p>
    </sec>
    <sec id="s7">
      <title>2.5. Genotype calling using TASSEL-GBS and MCPtaggR</title>
      <p>To assess the advantages of MCPtaggR for genotype calling, its performance was compared with that of the well-established genotype-calling pipeline TASSEL-GBS.<sup><xref rid="CIT0022" ref-type="bibr">22</xref></sup> Both tools were subjected to genotype calling using previously published GBS reads obtained from 813 F<sub>2</sub> samples derived from a cross between distant rice relatives NB and OL.<sup><xref rid="CIT0035" ref-type="bibr">35</xref></sup> Reference genome sequences for NB and OL were obtained as described above. The NB genome was used as a reference in the TASSEL-GBS pipeline, and the NB and OL genomes were used as a reference and an alternative to MCPtaggR, respectively. Read data for the F<sub>2</sub> samples were obtained from the sequence read archive (SRA) (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/sra</ext-link>) by querying project ID PRJDB5346. These reads were originally obtained in GBS with a KpnI–MspI RE pair using MiSeq with 75-bp paired-end sequencing. Because the reads deposited in the SRA were demultiplexed and had no barcode sequences required for processing using TASSEL-GBS, dummy barcode sequences were concatenated to all reads using the bardcode_faker function available at <ext-link xlink:href="https://github.com/labroo2/rtassel_supp" ext-link-type="uri">https://github.com/labroo2/rtassel_supp</ext-link>. The scripts used for genotype calling are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. The genotype call data obtained were subjected to SNP filtering using the following criteria:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) SNPs that were biallelic between parents and monomorphic in each parent were retained.</p>
        </list-item>
        <list-item>
          <p>(2) SNPs that were completely missing in the F<sub>2</sub> samples were removed.</p>
        </list-item>
        <list-item>
          <p>(3) The first SNP was retained when multiple SNPs were found within a 75-bp stretch.</p>
        </list-item>
      </list>
      <p>Because the genotype data generated by MCPtaggR were supposed to contain only SNPs that met criterion (1), filtering based only on criteria (2) and (3) was applied to the MCPtaggR output. RRS-based genotype data usually contain numerous errors, including heterozygote undercalling, which is a typical error that incorrectly identifies a homozygote at a heterozygous site. Therefore, the obtained genotype data were processed using GBScleanR to correct errors and estimate allele dosage.<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> The scripts used to execute the filtering and dosage estimation are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
    </sec>
    <sec id="s8">
      <title>2.6. Evaluation of genotype call data</title>
      <p>Genotype call data obtained using MCPtaggR and TASSEL-GBS were evaluated based on the estimated dosage generated by GBScleanR as raw genotype data containing a large number of missing values and erroneous calls, including heterozygote undercallings, which could prevent the systematic evaluation of software performance. The number of recombinations in which the genotype calls changed from one to another was counted in the estimated dosage data. The middle points of the physical positions of the markers, indicating recombination, were considered recombination breakpoints. The number of double crossovers was also evaluated by counting the number of genome segments in which the estimated dosage was heterozygous and flanked by homozygous segments of the same allele; for example, a heterozygous segment flanked by reference homozygous segments on both sides.</p>
      <p>It was expected that SNP markers supported by non-collinear tags would show more frequent mismapped reads than those supported by collinear tags. Therefore, the mismapping rate per marker was estimated by calculating the proportion of genotype calls that were heterozygous in the raw genotype data, but homozygous in the estimated dosage data. The SNP markers were classified into three groups: (1) those commonly found by MCPtaggR and TASSEL-GBS, (2) TASSEL-GBS only, and (3) MCPtaggR only. The statistical significance of the difference in mismapping rates between the three marker groups was tested using the Wilcoxon rank-sum test. The obtained <italic toggle="yes">P</italic>-values were adjusted using Bonferroni’s method.</p>
      <p>To further assess the properties of the SNP markers obtained, the origins of the reads used by TASSEL-GBS to call genotypes were assessed by mapping the tags listed by TASSEL-GBS. The tags of TASSEL-GBS, referred to as tassel tags, are unique sequences found in the input read data and stored in an SQLite database output by the pipeline. The SNP position information and corresponding tag sequences used for genotype calling at the SNPs were retrieved from the SQLite database using SQLite, version 3.41.2, which is available at <ext-link xlink:href="https://www.sqlite.org" ext-link-type="uri">https://www.sqlite.org</ext-link>. The tag sequences were then mapped to the NB and OL genomes using the aln function of BWA, as the TASSEL-GBS pipeline uses this function instead of BWA-MEM. Tag alignment results were analysed in a manner similar to that described in Section 2.2, except for the method used to determine tag origins in the OL genome. Because the true origins of the tags were unknown, NB and OL tassel tags were defined as tags that showed no mismatch or mismatch(es) with the NB genome sequence, respectively. The best matching locations of the OL tassel tags were assigned as the origins of the tags. If the origin of an OL tassel tag was located on a chromosome different from the chromosome on which the tag was mapped in the NB genome, this OL tag was recorded as an interchromosomal alignment. The collinearity of tag origins between the genomes was evaluated as described in Section 2.2. The SNP markers identified by TASSEL-GBS were grouped into four classes based on the properties of the tags supporting each SNP marker: (1) assigned as a multi-tag site (<xref rid="F1" ref-type="fig">Fig. 1A</xref>), (2) supported by collinear tags (<xref rid="F1" ref-type="fig">Fig. 1C</xref>), (3) assigned as a single-tag site but not supported by collinear tags (<xref rid="F1" ref-type="fig">Fig. 1D</xref>), and (4) assigned as an interchromosomal alignment site (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). The statistical significance of the difference in mismapping rates between the four marker classes was tested using the Wilcoxon rank-sum test. The obtained <italic toggle="yes">P</italic>-values were adjusted using Bonferroni’s method.</p>
    </sec>
    <sec id="s9">
      <title>2.7. Genotype calling using MCPtaggR and an OL-nized genome sequence</title>
      <p>Pilon software is a well-established high-performance genome sequence polisher that corrects genome sequences based on short-read alignment information.<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> Theoretically, using Pilon, one can convert one reference genome sequence to another by aligning the WGR reads derived from a related species. Therefore, instead of the publicly available OL genome assembly, the NB genome sequence was converted into an OL genome sequence (OL-nized) using Pilon. The WGR data of an OL plant using HiSeq 2500, deposited under project ID PRJDB6339,<sup><xref rid="CIT0024" ref-type="bibr">24</xref></sup> were obtained from SRA. The WGR reads obtained were aligned to the NB genome using BWA-MEM. The resultant BAM file was supplied as input to Pilon. In typical cases of genome polishing for <italic toggle="yes">de novo</italic> genome assembly, multiple rounds are performed by repeating the read alignment on a polished genome, followed by polishing using Pilon to improve sequence accuracy. Thus, OL-nized genome sequences were generated by performing one, two, three, and four rounds of polishing. Genotype calling using MCPtaggR followed by error correction and dosage estimation using GBScleanR was conducted as described in Section 2.5, using each OL-nized genome sequence as an alternative genome. The number of recombinations per chromosome was counted in the resultant estimated dosage data as described in Section 2.6.</p>
    </sec>
    <sec id="s10">
      <title>2.8. Data availability</title>
      <p>MCPtaggR is available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/MCPtaggR" ext-link-type="uri">https://github.com/tomoyukif/MCPtaggR</ext-link>). More details on package installation and usage can be found in the GitHub repository and the vignette available at <ext-link xlink:href="https://tomoyukif.github.io/MCPtaggR/" ext-link-type="uri">https://tomoyukif.github.io/MCPtaggR/</ext-link>. The test data used in this study were described in our previous publication.<sup><xref rid="CIT0035" ref-type="bibr">35</xref></sup> Because the data size of the full test data exceeds 12 GB, sample FASTQ files, which consist of 10 samples, are installed with MCPtaggR to test the functions.</p>
    </sec>
  </sec>
  <sec id="s11">
    <title>3. Results</title>
    <sec id="s12">
      <title>3.1. GBS-read alignment simulation and error-prone detection</title>
      <p><italic toggle="yes">In silico</italic> digestion at the KpnI and MspI recognition sites generated 155,474 and 125,932 digested-tags from the NB and OL genomes, respectively (<xref rid="T1" ref-type="table">Table 1</xref>). Tag mapping using BWA-MEM resulted in 20,210 and 31,040 unmapped NB- and OL-digested-tags due to short tag sequences, which were less than 30 bp and were ignored by the aligner, and Ns in the tag sequences, which were added to fill the gaps between contigs of the genome assemblies. Multiple alignments were found in 6,295 and 5,308 of the NB- and OL-digested-tags, respectively. Notably, BWA-MEM failed to align 15,919 NB-digested-tags back to their original locations, without any additional alignment information. Manual searches of the tag sequences in the NB genome revealed that these tags had identical sequences at multiple locations. Therefore, these tags were treated as multiple alignment tags. After filtering out the unmapped and multiple-mapped tags, 113,050 and 89,584 NB- and OL-digested-tags were retained, respectively. In the retained OL-digested-tags, 19,705 tags showed interchromosomal alignments and were filtered out. To further assess the properties of the mapped tags, overlaps of tag alignment locations were searched and found in 43,003 sites. Of the 43,003 co-mapped sites, 38,499, and 4504 sites had single and multiple OL-digested-tags, respectively (<xref rid="F1" ref-type="fig">Fig. 1A</xref> and <xref rid="T2" ref-type="table">Table 2</xref>). More than one mismatch pattern was found at 2,238 multiple-tag sites. These sites potentially lead to incorrect genotyping calls owing to different mismatch patterns, resulting in different contributions to read counts as reference and alternative alleles at SNPs. Filtering of single-tag sites with no mismatches and interchromosomal alignments removed 15,760 and 1582 sites, respectively (<xref rid="T2" ref-type="table">Table 2</xref>). As the number of retained single-tag sites was 21,157, approximately 7% of the single-tag sites had SNPs that could be potentially detectable in GBS, but would be derived from interchromosomal alignments, leading to incorrect genotyping calls (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). As the final step of the simulation study, the collinearity of the origins of the digested-tags in the NB and OL genomes was confirmed (<xref rid="F1" ref-type="fig">Fig. 1B-D</xref>). Neither the NB nor OL tag at 105 single-tag sites could be assigned to any collinear block/interval because, for these tag sites, one of the tags was assigned to a block/interval in a genome, whereas the other tag was assigned to an interval in which the corresponding interval was missing in the corresponding genome. Imperfect collinear block detection due to local genomic rearrangements may cause these misassignments. Among the remaining single-tag sites, 435 and 172 sites had OL-digested-tags that were derived from the collinear blocks/intervals located more than 100 kb and 1 Mb away from the blocks/intervals where NB-digested-tags were assigned, respectively (<xref rid="F1" ref-type="fig">Fig. 1D</xref>). These sites can also potentially result in incorrect genotype calls by mismapping reads derived from distant genomic locations. In this simulation, error-prone SNP markers that potentially provide incorrect genotype calls in GBS were found at 4,255 locations, which included multiple-tag sites with multiple missing patterns, single-tag sites with interchromosomal alignments, and single-tag sites with tags from non-collinear origins. In contrast, 16,797 sites were identified as reliable SNP markers (<xref rid="T2" ref-type="table">Table 2</xref>). However, this simulation also demonstrated that more than 20% of the SNP marker sites could be error-prone in GBS.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>Classification of digested-tags</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">NB-digested-tags</th>
              <th align="left" rowspan="1" colspan="1">OL-digested-tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total</td>
              <td align="left" rowspan="1" colspan="1">155,474</td>
              <td align="left" rowspan="1" colspan="1">125,932</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Unmapped</td>
              <td align="left" rowspan="1" colspan="1">20,210</td>
              <td align="left" rowspan="1" colspan="1">31,040</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Multiple alignments</td>
              <td align="left" rowspan="1" colspan="1">6,295</td>
              <td align="left" rowspan="1" colspan="1">5,308</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Silent multiple alignments<xref rid="T1Fn1" ref-type="table-fn"><sup>a</sup></xref></td>
              <td align="left" rowspan="1" colspan="1">15,919</td>
              <td align="left" rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">NA</td>
              <td align="left" rowspan="1" colspan="1">19,705</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Retained</td>
              <td align="left" rowspan="1" colspan="1">113,050</td>
              <td align="left" rowspan="1" colspan="1">69,879</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T1Fn1">
            <p><sup>a</sup>NB-digested-tags that failed to be aligned back to the original locations.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>Classification of co-mapped sites</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">No. of tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total sites</td>
              <td align="left" rowspan="1" colspan="1">43,003</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Multiple-tag sites</td>
              <td align="left" rowspan="1" colspan="1">4,504</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Multiple mismatching patterns</td>
              <td align="left" rowspan="1" colspan="1">2,238</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non- or one mismatching pattern</td>
              <td align="left" rowspan="1" colspan="1">2,266</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Single-tag sites</td>
              <td align="left" rowspan="1" colspan="1">38,499</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non-mismatching pattern</td>
              <td align="left" rowspan="1" colspan="1">15,760</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">1,582</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Non-collinear sites</td>
              <td align="left" rowspan="1" colspan="1">4,360</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Collinear sites</td>
              <td align="left" rowspan="1" colspan="1">16,797</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s13">
      <title>3.2. Performance of MCPtaggR for accurate genotype calling</title>
      <p>To eliminate the detection of error-prone markers in RRS-based genotyping, including GBS, the MCPtagg pipeline was developed and implemented in the R package MCPtaggR, as described in Sections 2.3 and 2.4. MCPtaggR detected 19,714 and 19,695 MCP tags in the NB and OL genomes, respectively (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>). The GBS reads were mapped on 6418 and 6701 MCP tags in the NB and OL genomes, respectively. The differences in the number of MCP tags were caused by the differences in RE cut sites between the NB and OL genomes. We confirmed the classifications of the read-mapped OL MCP tags in the classes defined by mapping the digested-tags on the NB genome (<xref rid="T1" ref-type="table">Tables 1</xref> and <xref rid="T2" ref-type="table">2</xref>). Out of 6,701 read-mapped tags, 4,589 tags matched the digested-tags that were mapped on the collinear single-tag sites (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>). The rest of the read-mapped OL MCP tags were classified as tags that were potentially invalid for genotype calling if only the NB genome was used as a reference for read mapping. In other words, MCPtaggR successfully called genotypes using reads that might be potentially mapped on incorrect locations if the NB genome was solely used as a reference.</p>
      <p>The performance was evaluated by comparing the genotype calls generated by MCPtaggR and TASSEL-GBS. After filtering SNP markers as described in Section 2.5, 5,486 and 2,973 SNP markers were retained for the data generated by MCPtaggR and TASSEL-GBS, respectively. Because the raw genotype data output from the tools contained a large number of missing values and heterozygote undercallings, error correction and allele dosage estimation were performed using GBScleanR. The performance of the tools for genotype calling was indirectly evaluated based on the estimated allele dosage instead of raw genotype data. <xref rid="F3" ref-type="fig">Figure 3</xref> depicts a representative case in which MCPtaggR and TASSEL-GBS yielded genotypic calls that resulted in different dosage estimations. TASSEL-GBS detected alternative allele reads at a larger number of markers where the estimated dosage indicated reference homozygotes at the surrounding markers. As a result, GBScleanR estimated the dosage to change from 0 to 1 and then return to 0 within short intervals, indicating a double crossover (upper panels in <xref rid="F3" ref-type="fig">Fig. 3</xref>). Theoretically, double crossovers at short intervals are rarely observed in F<sub>2</sub> populations. These unexpected alternative allele reads were reduced, and double crossovers were eliminated from the MCPtaggR results (<xref rid="F3" ref-type="fig">Fig. 3</xref>, lower panels).</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of obtained read counts and estimate dosages. Estimated dosage (magenta lines) and allele read ratios per marker (green dots) on chromosomes 1 and 10 in a representative sample. The green dots at 0 and 2 on the <italic toggle="yes">y</italic>-axis represent the markers at which only the reference and alternative allele reads were mapped, respectively, whereas the dots between them represent markers that had both allele reads.</p>
        </caption>
        <graphic xlink:href="dsad027_fig3" position="float"/>
      </fig>
      <p>To statistically assess the differences in genotype calling using these tools, we first calculated the concordance rates of the raw genotype calls and estimated dosages between MCPtaggR and TASSEL-GBS. Only 507 SNPs were commonly detected by both tools, whereas 4,979 and 2,466 SNPs were uniquely detected by MCPtaggR and TASSEL-GBS, respectively (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref>). As the number and positions of obtained SNPs were different between the tools, we compared raw genotype calls and estimated dosages between the nearest SNPs detected by MCPtaggR and TASSEL-GBS. The raw genotype calls showed a concordance rate of 67.34%, whereas the estimated dosages exhibited a concordance rate of 98.76% (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref>). Thus, although the raw genotype calls were largely different between MCPtaggR and TASSEL-GBS, highly similar dosages were estimated by GBScleanR from both genotype data. Nevertheless, as shown in <xref rid="F3" ref-type="fig">Fig. 3</xref>, there were unexpected double crossovers at short intervals. To further assess the occurrence of unexpected crossovers due to error-prone markers, the average recombination frequency per chromosome was calculated (<xref rid="F4" ref-type="fig">Fig. 4A</xref> and <xref rid="sup4" ref-type="supplementary-material">Supplementary Table S3</xref>). The expected recombination frequencies in the chromosomes were estimated from their physical lengths, assuming an average recombination rate of 0.04 per Mb. Based on a previous study, the expected recombination frequency across the entire genome of a rice F<sub>2</sub> plant is approximately 15.2.<sup><xref rid="CIT0037" ref-type="bibr">37</xref></sup> As this value matched the sum of the expected recombination frequencies in the chromosomes (14.94), the estimation of recombination frequencies was reliable and acceptable. Although the data generated by both TASSEL-GBS and MCPtaggR showed more frequent recombination than expected, MCPtaggR yielded values that were closer to the expected frequencies compared with those of TASSEL-GBS (<xref rid="F4" ref-type="fig">Fig. 4A</xref>). The number of double crossovers within stretches of 0–1 and 1–2 Mb in the estimated dosage data was also counted (<xref rid="F4" ref-type="fig">Fig. 4B</xref> and <xref rid="sup5" ref-type="supplementary-material">Supplementary Table S4</xref>). A large reduction in unexpected double crossovers within short intervals was observed in the genotype data of MCPtaggR compared with that of TASSEL-GBS.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Genotyping quality assessment. (A) Expected and observed average numbers of recombinations per chromosome in the estimated dosage data. (B) Total number of double crossovers within stretches of 0–1 Mb and 1–2 Mb in the estimated dosage data.</p>
        </caption>
        <graphic xlink:href="dsad027_fig4" position="float"/>
      </fig>
      <p>Although GBScleanR is robust against error-prone markers because it incorporates marker-specific error rates into the hidden Markov model (HMM),<sup><xref rid="CIT0014" ref-type="bibr">14</xref></sup> it can fail to estimate true genotypes, depending on the distribution and pattern of read counts of error-prone markers. As the estimated dosage of TASSEL-GBS data revealed an increase in recombination frequency and double crossovers, it could be expected that TASSEL-GBS would call genotypes with a larger number of error-prone markers than MCPtaggR. In general, read mismapping caused by the non-collinearity of the origins of the reads results in unexpected heterozygous calls at sites where the true genotypes are homozygotes. Therefore, the mismapping rate per marker was estimated by calculating the proportion of genotype calls that were heterozygous in the raw genotype data, but homozygous in the genotype estimated by GBScleanR. The TASSEL-only markers (2,201 markers) showed a significantly larger mismapping rate than the common markers and MCPtaggR-only markers (772 and 4,150 markers, respectively) (<xref rid="F5" ref-type="fig">Fig. 5A</xref>). In addition, a comparison between common markers and MCPtaggR-only markers indicated a significant reduction in the mismapping rate of MCPtaggR-only markers. Together with a reduction in the number of recombinations and double crossovers, these results demonstrate that MCPtaggR efficiently eliminates error-prone markers from genotype calling and provides more reliable genotype data in combination with GBScleanR.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Mismapping rate per marker. The mismapping rate per marker is shown in violin plots for each class of markers, classified based on the commonness between the tools (A) and the collinearity of mapped tags (B). ‘Common’, ‘TASSEL’, and ‘MCPtaggR’ in panel A indicate the markers commonly detected by both tools, only detected by TASSEL-GBS, and MCPtaggR, respectively. The mismapping rate of the ‘Common’ markers was calculated from the data obtained using TASSEL-GBS. ‘Collinear’, ‘Non-Collinear’, ‘MultiHit’, and ‘InterChr’ indicate the markers supported by collinear tags, non-collinear tags, multiple alignment tags, and interchromosomal alignment tags, respectively. The significance of the differences in mismapping rates between classes is indicated by <sup>N.S.</sup><italic toggle="yes">P</italic> &gt; 0.05, *<italic toggle="yes">P</italic> &lt; 0.05, and **<italic toggle="yes">P</italic> &lt; 0.01.</p>
        </caption>
        <graphic xlink:href="dsad027_fig5" position="float"/>
      </fig>
    </sec>
    <sec id="s14">
      <title>3.3. Confirming the cause of mismapped read</title>
      <p>To confirm that the mismapped reads originated from non-collinear locations in the NB and OL genomes, the original genomic locations of the tassel tag sequences, which were listed and used by TASSEL-GBS for genotype calling, were determined by aligning the tassel tags to the NB and OL genomes. TASSEL-GBS listed 65,063 unique tags from the read data of the rice F<sub>2</sub> samples, whereas 2,973 of the retained SNP markers were supported by only 6,809 tags (<xref rid="T3" ref-type="table">Table 3</xref>). Sequence mismatches were found in 3,868 of the 6,809 tags in the tag alignment to the NB genome. Although these mismatched tags may contain tag sequences generated by sequencing error, 3,868 tags were considered to originate from the OL genome. Of the 3,868 OL tags, 577 tags were mapped to the OL chromosomes that were different from the NB chromosomes, where the tags were mapped for genotype calling, indicating interchromosomal alignments (<xref rid="F1" ref-type="fig">Fig. 1E</xref>). Multiple alignments were observed for 94 OL tags. These interchromosomal and multiple alignment tags contributed to genotype calling at the 390 and 77 retained SNP markers, potentially leading to incorrect genotyping. Among the remaining OL tags, 489 tags that were mapped to 402 SNP marker sites failed to show collinearity with the corresponding NB tags that were mapped to the same SNP locations in the NB genome (<xref rid="F1" ref-type="fig">Fig. 1B–D</xref>). Some of the non-collinear tags did not align with either the NB or OL genomes. The incompleteness of genome assemblies may have caused these missing alignments. Finally, 2,104 SNP markers were found to be reliable SNP markers that were supported by 2,708 OL tags, maintaining collinearity with the corresponding NB tags. This collinearity assessment revealed that 29.2% of the SNP markers provided by TASSEL-GBS were genotyped based on reads originating from invalid or unreliable sources.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3.</label>
        <caption>
          <p>Classification of tassel-tags</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Classification</th>
              <th align="left" rowspan="1" colspan="1">No. of tags</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total tags</td>
              <td align="left" rowspan="1" colspan="1">65,063</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Valid SNP supporting tags</td>
              <td align="left" rowspan="1" colspan="1">6,809</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> NB tags</td>
              <td align="left" rowspan="1" colspan="1">2,941</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> OL tags</td>
              <td align="left" rowspan="1" colspan="1">3,868</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Interchromosomal alignments</td>
              <td align="left" rowspan="1" colspan="1">577</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Multiple alignments</td>
              <td align="left" rowspan="1" colspan="1">94</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Non-collinear tags</td>
              <td align="left" rowspan="1" colspan="1">489</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">  Collinear tags</td>
              <td align="left" rowspan="1" colspan="1">2,708</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The mismapping rates estimated from the proportion of mismatches in the raw genotype calls and estimated dosages revealed significant differences in the properties of the SNP markers classified based on collinearity (<xref rid="F5" ref-type="fig">Fig. 5B</xref>). The markers supported by collinear tassel-tags showed significantly smaller mismapping rates than those supported by non-collinear and interchromosomal alignment tags. The highest mismapping rate was observed for markers supported by interchromosomal alignment tags. The distribution of the mismapping rate per marker indicated that markers with interchromosomal alignments had the most deleterious impact on genotype calling (<xref rid="F5" ref-type="fig">Fig. 5B</xref>). Significantly larger proportions of the markers supported by non-collinear and multiple tags were identified as mismapping prone compared with the markers supported by collinear tags, although some of the markers had no mismapping reads. As shown in the previous section, MCPtaggR filtered out these error-prone markers before genotype calling (<xref rid="F5" ref-type="fig">Fig. 5A</xref>). These results suggested that SNP marker filtering based on sequence collinearity is a reasonable and effective method for accurate genotype calling.</p>
    </sec>
    <sec id="s15">
      <title>3.4. Genotype calling with an OL-nized genome sequence</title>
      <p>Considering situations that require RRS-based genotyping, the genome sequences of the parents of a given population are not always available. In contrast, the genome sequence polisher Pilon is a software to correct the sequence of a genome assembly to improve its quality based on the alignment results of WGR data.<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> Therefore, genotype calling using MCPtaggR was performed using the NB genome assembly and an OL genome sequence that was converted from the NB genome assembly, referred to as an OL-nized genome sequence. Pilon is usually applied repeatedly to improve the quality of a <italic toggle="yes">de novo</italic> assembled genome. Thus, OL-nized genome sequences were obtained by polishing one, two, three, and four times. We compared the SNP positions between the genotype data obtained using the OL genome assembly and the OL-nized genome sequences. Approximately 65% of SNPs (3543 out of 5486) detected using the OL genome assembly were also detected using the OL-nized genome sequence after one round of polishing (<xref rid="T4" ref-type="table">Table 4</xref>). The rate of common SNPs was increased by two rounds of polishing to nearly 70%. Further polishing (three and four rounds) showed negligibly small improvements in the rate of common SNPs. The genotype-calling performance was evaluated based on the number of recombinations per chromosome and double crossovers within short intervals. Only one round of polishing resulted in similar values in the number of recombinations per chromosome and double crossovers within short intervals compared with those observed in the genotype data using the OL genome assembly (<xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). Unexpectedly, an additional round of polishing (two rounds in total) increased the number of recombinations and double crossovers. In addition, more than two rounds of polishing showed negligible improvements. We also compared the concordance rates of raw genotype calls and estimated dosages. Since the number and positions of obtained SNPs were different between the genotype data obtained using different genomes (<xref rid="T4" ref-type="table">Table 4</xref>), we calculated concordance rates of the raw genotype calls and estimated dosages between the nearest SNPs detected using the OL genome assembly and the OL-nized genomes. One round of polishing resulted in poor concordance rates of genotype calls (42.53%) and estimated dosages (39.07%), whereas two rounds of polishing drastically improved concordance rates to 92.63 and 99.74% for genotype calls and estimated dosages, respectively (<xref rid="T4" ref-type="table">Table 4</xref>). Similar to the other measurements described above, two or more rounds of polishing showed almost identical values of the concordance rates. Together with the number of recombinations and crossovers, only one round of polishing was insufficient to OL-nized the NB genome assembly. The OL-nized genome sequence obtained by one-round polishing exhibited comparable frequencies of recombinations and double crossovers to those observed in the OL-nized genome that underwent multiple rounds of polishing (<xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). However, the genotype calls and estimated dosages were largely different from those obtained using the OL genome assembly (<xref rid="T4" ref-type="table">Table 4</xref>). We also found that three or more polishing rounds showed limited improvements in the quality of genotype calling (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). Two rounds of polishing using Pilon were sufficient to obtain genotype calls at a similar quality compared with genotype calling using the OL genome assembly (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). These results demonstrated that the MCPtagg pipeline potentially works sufficiently with an X-nized genome sequence obtained by polishing the genome of a related species, although the positions of markers and raw genotype calls are different from those obtained using a <italic toggle="yes">de novo</italic> assembled genome.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4.</label>
        <caption>
          <p>Concordance rates in genotype calls and estimated dosages</p>
        </caption>
        <table frame="hsides" rules="groups" width="100%" border="1">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="left" span="1"/>
            <col align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Pilon<xref rid="T4Fn1" ref-type="table-fn"><sup>a</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Number of markers<xref rid="T4Fn2" ref-type="table-fn"><sup>b</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Concordance rate (%)<xref rid="T4Fn3" ref-type="table-fn"><sup>c</sup></xref></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">1,943, 2,170, 3,543</td>
              <td align="left" rowspan="1" colspan="1">42.53, 39.07</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">1,678, 2,180, 3,808</td>
              <td align="left" rowspan="1" colspan="1">92.63, 99.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">1,671, 2,170, 3,815</td>
              <td align="left" rowspan="1" colspan="1">92.72, 99.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">1,668, 2,168, 3,818</td>
              <td align="left" rowspan="1" colspan="1">92.70, 99.74</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T4Fn1">
            <p><sup>a</sup>The number of rounds Plilon was applied for polishing.</p>
          </fn>
          <fn id="T4Fn2">
            <p><sup>b</sup>The number of markers detected solely in the genotype calling using the assembled OL genome, the OL-nized genome, and markers detected in both are presented, separated by commas.</p>
          </fn>
          <fn id="T4Fn3">
            <p><sup>c</sup>Concordance rates in genotype calls and estimated dosages between those obtained using the OL genome assembly and the OL-nized genome sequence are presented, separated by commas.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec id="s16">
    <title>4. Discussion</title>
    <p>The main purpose of our study was to demonstrate the performance of the MCPtagg pipeline. However, we would also like to note the importance of error correction for RRS-based genotype data. In our study, the concordance rate of raw genotype calls was only 67.34% between MCPtaggR and TASSEL-GBS, as described in Section 3.2. However, a high concordance rate of estimated dosages (98.76%) was observed. Even though the raw genotype calls contained largely different genotype information with different error patterns, GBScleanR could estimate highly similar dosages. As GBScleanR was designed to incorporate marker-specific error patterns in the HMM for robust genotype correction against error-prone markers, error correction and dosage estimation could be achieved by picking up reliable genotype information while eliminating negative impact from error-prone markers.</p>
    <p>Our study presented the deleterious effects of error-prone markers and the causes of these errors. Although we observed the quite high concordance rate of the estimated dosages between MCPtaggR and TASSEL-GBS, TASSEL-GBS resulted in 20 and 1,650% higher number of recombinations and double crossovers within intervals of 0–1 Mb stretches compared with MCPtaggR (<xref rid="sup4" ref-type="supplementary-material">Supplementary Tables S3</xref> and <xref rid="sup5" ref-type="supplementary-material">S4</xref>). Considering the high concordance rate of the estimated dosages, the increase in the recombinations might be caused by the increase of unexpected double crossovers. Unfortunately, the assessment relying on the overall concordance rate was unable to effectively detect these specific local errors, mainly because such local errors usually have limited effects on the overall measurement. As the present study demonstrated, the MCPtagg pipeline effectively eliminates these local errors that are caused by error-prone markers. RRS-based genotyping in populations derived from crosses between very close relatives might result in a few error-prone markers because their genome sequences have conserved sequence similarity and collinearity. However, the more distant relatives that were crossed to produce populations, the more error-prone markers contaminated the genotype data. Geneticists and breeders use wild relatives of cultivated varieties in distant crosses, particularly in genetic studies and breeding programs. RRS-based genotyping is a popular and standard method used in genetic studies and breeding programs. However, contamination with error-prone markers increases the risk of misleading genotype data.<sup><xref rid="CIT0011" ref-type="bibr">11–14</xref></sup> Even though some error-prone markers can be filtered out based on marker statistics, such as allele frequency and heterozygosity, there is no gold standard for filtering criteria. In contrast, MCPtaggR provides an easy-to-use reliable genotype calling pipeline that basically never requires filtering based on user-specified arbitrary criteria. In addition, our study also showed efficiency in detecting SNP markers. We performed genotype calling using TASSEL-GBS and MCPtaggR for the same read dataset obtained from a rice F<sub>2</sub> population. Typically, RRS genotype data are subjected to intensive filtering based on the proportion of missing data, heterozygosity, and minor alleles per marker. Genotyping pipelines for bi- and multi-parental populations also filter out SNP markers for which one or more parental samples showed missing genotype calls due to missing read observations. Because sequence reads are acquired stochastically by a sequencer, RRS-based genotype data contain numerous markers that can be filtered out, particularly in low-read-coverage genotype data. Although the parental samples of the rice F<sub>2</sub> population were sequenced at three times higher read coverage, the filtering of the genotype data provided by TASSEL-GBS retained only 2,973 markers while 8,190 markers were obtained just after pruning markers based on their physical distances. In contrast, MCPtaggR provided 5,486 markers, although it filtered out markers by comparing parental genome sequences prior to genotype calling. Missing genotype calls in either NB or OL were found at 3,646 markers in the genotype data generated by MCPtaggR. In a typical filtering procedure, these markers are removed. However, the reliability of the markers was supported by a pre-survey of SNP markers in the MCPtagg pipeline. Thus, MCPtaggR successfully retained more markers than TASSEL-GBS. Although an increase in read coverage might change the result, MCPtaggR enables us to efficiently obtain as numerous markers as possible, even from low-coverage sequence data.</p>
    <p>One drawback of the MCPtagg pipeline is that it requires high-quality genome assemblies of both parents. However, even in cases where parental genome assemblies are not available, recent developments in bioinformatics tools have enabled us to instantly obtain genome assemblies without conducting costly <italic toggle="yes">de novo</italic> genome assembly. As demonstrated in this study, available genome assemblies can be converted into others using short-read sequences with the genome polishing tool Pilon<sup><xref rid="CIT0036" ref-type="bibr">36</xref></sup> and methods introduced in previous studies.<sup><xref rid="CIT0038" ref-type="bibr">38</xref>,<xref rid="CIT0039" ref-type="bibr">39</xref></sup> One round of polishing resulted in poor concordance rates between the estimated dosages obtained using the OL genome assembly and the OL-nized genome sequence. This result indicates that only one round of polishing is insufficient to convert the NB genome assembly to an OL-nized genome sequence that can provide sufficiently accurate genotype information using MCPtaggR in combination with GBScleanR. Two rounds of polishing by Pilon were sufficient to achieve a genotyping quality similar to that of the OL genome (<xref rid="T4" ref-type="table">Table 4</xref> and <xref rid="sup6" ref-type="supplementary-material">Supplementary Table S5</xref>). As a note, this result never implies that the OL-nized genome sequence is identical to the OL genome assembly, but it suggests that the two-round polishing renders an OL-nized genome sequence with sufficient information for genotyping using MCPtaggR. The number of rounds necessary to X-nize a genome assembly might differ depending on target genomes and there is no prior information to estimate the ideal number of rounds. Thus, multiple rounds of polishing are recommended. Nonetheless, our study suggests that the MCPtagg pipeline sufficiently works with converted genomes. Therefore, if a genome assembly is available for species of interest, WGR data from the parents are sufficient to prepare genome assemblies as input for the pipeline, instead of conducting de novo genome assembly. This fact indicates the flexibility and scalability of the pipeline. The read data used for polishing in this study contained 36,708,088 150-bp pair-end reads that corresponded to approximately 10× coverage of the rice genome. Even though the read coverage was not high but rather low, Pilon successfully optimized the NB genome to sufficient quality for genotype calling by MCPtaggR. Nevertheless, an X-nized genome may not reflect genome rearrangements such as translocations and inversions. This result implies that mismapped reads are more likely due to the presence of similar sequences resulting from mutations in the ancestral genome sequences that were originally located elsewhere, rather than originating from translocated and mutated genomic segments.</p>
    <p>Collectively, this study demonstrated the superiority of the MCPtagg pipeline over existing genotype pipelines. Although only TASSEL-GBS was tested with GBS-read data as an example, theoretically similar disadvantages would be found in other RRS-based genotyping methods unless the obtained reads were mapped onto a single reference genome. Another limitation of our study is that we tested the pipeline only using the rice F<sub>2</sub> population derived from a cross between NB and OL. However, this fact never diminishes the value of our study and the pipeline. This point was further discussed and justified in <xref rid="sup7" ref-type="supplementary-material">Supplementary Discussion</xref>. The current implementation of MCPtaggR treats any sequence as a cut site. It is not necessary to specify RE recognition sequences, but one can specify primer sequences used in genotyping based on amplicon sequences such as MIG-seq<sup><xref rid="CIT0040" ref-type="bibr">40</xref></sup> and GRAS-Di® (TOYOTA, Aichi, Japan). Genotype data generated by any RRS-based genotyping method can be processed using the MCPtagg pipeline by tweaking the parameters specifying the cut sites and digested-tag length filtering in the MCPtaggR package. In contrast, the current version of MCPtaggR has a limitation in its applicability, only supporting biparental populations derived from a cross between inbred lines or selfing species. Nonetheless, the pipeline can be expanded to handle outbred lines and outcrossing species if haplotype-phased genome assemblies are available.<sup><xref rid="CIT0041" ref-type="bibr">41</xref></sup> MCPtaggR can also genotype polyploid populations if those were derived from a biparental cross of inbred lines or selfing species. Although the resulting data only includes genotype calls for homozygotes of both alleles and heterozygotes without allele dosage information, polyploid allele dosage estimation tools might help to analyse such genotype call data.<sup><xref rid="CIT0042" ref-type="bibr">42</xref>,<xref rid="CIT0043" ref-type="bibr">43</xref></sup> In addition, the pipeline has the potential to be applied to multiparental populations by conducting comprehensive genome comparisons across all possible combinations of parents. Future updates on the MCPtaggR package will address these expansions of the pipeline. MCPtaggR would increase its applicability as the available genome sequences increase and has the potential to become a standard genotyping method, especially for genotyping populations derived from distant crosses, which may normally cause error-prone SNP detection.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Material_S1</label>
      <media xlink:href="dsad027_suppl_supplementary_material_s1.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S1</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s1.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S2</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s2.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S3</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s3.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S4</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s4.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Tables_S5</label>
      <media xlink:href="dsad027_suppl_supplementary_tables_s5.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>dsad027_suppl_Supplementary_Material_S2</label>
      <media xlink:href="dsad027_suppl_supplementary_material_s2.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="a1">
    <title>Acknowledgements</title>
    <p>We would like to thank Editage (<ext-link xlink:href="https://www.editage.jp" ext-link-type="uri">www.editage.jp</ext-link>) for the English language editing.</p>
  </ack>
  <sec id="s18">
    <title>Funding</title>
    <p>This work was supported by the Grants-in-Aid for Scientific Research (KAKENHI) from the Japan Society for the Promotion of Science [JP20K15503 and JP23H02185 to T.F.].</p>
  </sec>
  <sec id="s19">
    <title>Author contributions</title>
    <p>T.F. conceptualized the project, developed the software, conducted benchmarking, and wrote the manuscript. T.Y. supervised the project and reviewed the manuscript.</p>
  </sec>
  <ref-list id="r1">
    <title>References</title>
    <ref id="CIT0001">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname>, <given-names>J.A.</given-names></string-name> and <string-name><surname>Rife</surname>, <given-names>T.W.</given-names></string-name></person-group><year>2012</year>, <article-title>Genotyping-by-sequencing for plant breeding and genetics</article-title>, <source>Plant Genome</source>, <volume>5</volume>. <pub-id pub-id-type="doi">10.3835/plantgenome2012.05.0005</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0002">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davey</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Hohenlohe</surname>, <given-names>P.A.</given-names></string-name>, <string-name><surname>Etter</surname>, <given-names>P.D.</given-names></string-name>, <string-name><surname>Boone</surname>, <given-names>J.Q.</given-names></string-name>, <string-name><surname>Catchen</surname>, <given-names>J.M.</given-names></string-name>, and <string-name><surname>Blaxter</surname>, <given-names>M.L.</given-names></string-name></person-group><year>2011</year>, <article-title>Genome-wide genetic marker discovery and genotyping using next-generation sequencing</article-title>, <source>Nat. Rev. Genet.</source>, <volume>12</volume>, <fpage>499</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">21681211</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0003">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Torkamaneh</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Boyle</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Belzile</surname>, <given-names>F.</given-names></string-name></person-group><year>2018</year>, <article-title>Efficient genome-wide genotyping strategies and data integration in crop plants</article-title>, <source>Theor. Appl. Genet.</source>, <volume>131</volume>, <fpage>499</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">29352324</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0004">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Unamba</surname>, <given-names>C.I.</given-names></string-name>, <string-name><surname>Nag</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Sharma</surname>, <given-names>R.K.</given-names></string-name></person-group><year>2015</year>, <article-title>Next generation sequencing technologies: The doorway to the unexplored genomics of non-model plants</article-title>, <source>Front. Plant Sci.</source>, <volume>6</volume>, <fpage>1074</fpage>.<pub-id pub-id-type="pmid">26734016</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0005">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname>, <given-names>G.K.-S.</given-names></string-name>, <string-name><surname>Soltis</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Leebens-Mack</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group><year>2020</year>, <article-title>Sequencing and analyzing the transcriptomes of a thousand species across the tree of life for green plants</article-title>, <source>Annu. Rev. Plant Biol.</source>, <volume>71</volume>, <fpage>741</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">31851546</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0006">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheben</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Batley</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Edwards</surname>, <given-names>D.</given-names></string-name></person-group><year>2017</year>, <article-title>Genotyping-by-sequencing approaches to characterize crop genomes: choosing the right tool for the right application</article-title>, <source>Plant Biotechnol. J.</source>, <volume>15</volume>, <fpage>149</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">27696619</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0007">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname>, <given-names>M.R.</given-names></string-name>, <string-name><surname>Dunham</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Amores</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Cresko</surname>, <given-names>W.A.</given-names></string-name>, and <string-name><surname>Johnson</surname>, <given-names>E.A.</given-names></string-name></person-group><year>2007</year>, <article-title>Rapid and cost-effective polymorphism identification and genotyping using restriction site associated DNA (RAD) markers</article-title>, <source>Genome Res.</source>, <volume>17</volume>, <fpage>240</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">17189378</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0008">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterson</surname>, <given-names>B.K.</given-names></string-name>, <string-name><surname>Weber</surname>, <given-names>J.N.</given-names></string-name>, <string-name><surname>Kay</surname>, <given-names>E.H.</given-names></string-name>, <string-name><surname>Fisher</surname>, <given-names>H.S.</given-names></string-name>, and <string-name><surname>Hoekstra</surname>, <given-names>H.E.</given-names></string-name></person-group><year>2012</year>, <article-title>Double Digest RADseq: An inexpensive method for de novo SNP discovery and genotyping in model and non-model species</article-title>, <source>PLoS One</source>, <volume>7</volume>, <fpage>e37135</fpage>.<pub-id pub-id-type="pmid">22675423</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0009">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elshire</surname>, <given-names>R.J.</given-names></string-name>, <string-name><surname>Glaubitz</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>Q.</given-names></string-name>, <etal>et al.</etal></person-group><year>2011</year>, <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>, <source>PLoS One</source>, <volume>6</volume>, <fpage>e19379</fpage>.<pub-id pub-id-type="pmid">21573248</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0010">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname>, <given-names>J.A.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>P.J.</given-names></string-name>, <string-name><surname>Sorrells</surname>, <given-names>M.E.</given-names></string-name>, and <string-name><surname>Jannink</surname>, <given-names>J.</given-names></string-name></person-group><year>2012</year>, <article-title>Development of high-density genetic maps for barley and wheat using a novel two-enzyme genotyping-by-sequencing approach</article-title>, <source>PLoS One</source>, <volume>7</volume>, <fpage>e32253</fpage>.<pub-id pub-id-type="pmid">22389690</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0011">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Günther</surname>, <given-names>T.</given-names></string-name> and <string-name><surname>Nettelblad</surname>, <given-names>C.</given-names></string-name></person-group><year>2019</year>, <article-title>The presence and impact of reference bias on population genomic studies of prehistoric human populations</article-title>, <source>PLoS Genet.</source>, <volume>15</volume>, <fpage>e1008302</fpage>.<pub-id pub-id-type="pmid">31348818</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0012">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freeman</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>J.</given-names></string-name></person-group>; <collab>Genomics England Research Consortium</collab>. <year>2020</year>, <article-title>Genomic loci susceptible to systematic sequencing bias in clinical whole genomes</article-title>, <source>Genome Res.</source>, <volume>30</volume>, <fpage>415</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">32156711</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0013">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valiente-Mullor</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Beamud</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Ansari</surname>, <given-names>I.</given-names></string-name>, <etal>et al.</etal></person-group><year>2021</year>, <article-title>One is not enough: on the effects of reference genome for the mapping and subsequent analyses of short-reads</article-title>, <source>PLoS Comput. Biol.</source>, <volume>17</volume>, <fpage>e1008678</fpage>.<pub-id pub-id-type="pmid">33503026</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0014">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Yamamoto</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Ashikari</surname>, <given-names>M.</given-names></string-name></person-group><year>2023</year>, <article-title>GBScleanR: robust genotyping error correction using a hidden Markov model with error pattern recognition</article-title>, <source>Genetics</source>, <volume>224</volume>, <fpage>iyad055</fpage>.<pub-id pub-id-type="pmid">36988327</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0015">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wijnker</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>James</surname>, <given-names>G.V.</given-names></string-name>, <string-name><surname>Ding</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>, <article-title>The genomic landscape of meiotic crossovers and gene conversions in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>, <source>eLife</source>, <volume>2</volume>, <fpage>e01426</fpage>.<pub-id pub-id-type="pmid">24347547</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0016">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacob</surname>, <given-names>F.D.</given-names></string-name>, <string-name><surname>John</surname>, <given-names>C.M.</given-names></string-name>, <string-name><surname>Athma</surname>, <given-names>A.P.</given-names></string-name>, <etal>et al.</etal></person-group><year>2009</year>, <article-title>Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data</article-title>, <source>Bioinformatics</source>, <volume>25</volume>, <fpage>3207</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">19808877</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0017">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Panousis</surname>, <given-names>N.I.</given-names></string-name>, <string-name><surname>Gutierrez-Arcelus</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Dermitzakis</surname>, <given-names>E.T.</given-names></string-name>, and <string-name><surname>Lappalainen</surname>, <given-names>T.</given-names></string-name></person-group><year>2014</year>, <article-title>Allelic mapping bias in RNA-sequencing is not a major confounder in eQTL studies</article-title>, <source>Genome Biol.</source>, <volume>15</volume>, <fpage>467</fpage>.<pub-id pub-id-type="pmid">25239376</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0018">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebler</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Ebert</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Clarke</surname>, <given-names>W.E.</given-names></string-name>, <etal>et al.</etal></person-group><year>2022</year>, <article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>, <source>Nat. Genet.</source>, <volume>54</volume>, <fpage>518</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">35410384</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0019">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iqbal</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Caccamo</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Turner</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Flicek</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>McVean</surname>, <given-names>G.</given-names></string-name></person-group><year>2012</year>, <article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>, <source>Nat. Genet.</source>, <volume>44</volume>, <fpage>226</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">22231483</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0020">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shajii</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yorukoglu</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Y.W.</given-names></string-name>, and <string-name><surname>Berger</surname>, <given-names>B.</given-names></string-name></person-group><year>2016</year>, <article-title>Fast genotyping of known SNPs through approximate k -mer matching</article-title>, <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i538</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27587672</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0021">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sibbesen</surname>, <given-names>J.A.</given-names></string-name>, <string-name><surname>Maretty</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Krogh</surname>, <given-names>A.</given-names></string-name></person-group>; <collab>Danish Pan-Genome Consortium</collab>. <year>2018</year>, <article-title>Accurate genotyping across variant classes and lengths using variant graphs</article-title>, <source>Nat. Genet.</source>, <volume>50</volume>, <fpage>1054</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29915429</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0022">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaubitz</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Casstevens</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Lu</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal></person-group><year>2104</year>, <article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title>, <source>PLoS One</source>, <volume>9</volume>, <fpage>e90346</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0023">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sakai</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tanaka</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>, <article-title>Rice Annotation Project Database (RAP-DB): an integrative and interactive database for rice genomics</article-title>, <source>Plant Cell Physiol.</source>, <volume>54</volume>, <fpage>e6</fpage>–<lpage>e6</lpage>.<pub-id pub-id-type="pmid">23299411</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0024">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reuscher</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Bessho-Uehara</surname>, <given-names>K.</given-names></string-name>, <etal>et al.</etal></person-group><year>2018</year>, <article-title>Assembling the genome of the African wild rice <italic toggle="yes">Oryza longistaminata</italic> by exploiting synteny in closely related <italic toggle="yes">Oryza</italic> species</article-title>, <source>Commun. Biol.</source>, <volume>1</volume>, <fpage>162</fpage>.<pub-id pub-id-type="pmid">30320230</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0025">
      <label>25.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Gentleman</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>DebRoy</surname>, <given-names>S.</given-names></string-name></person-group>, <year>2022</year>, <article-title>Biostrings: efficient manipulation of biological strings</article-title>. <pub-id pub-id-type="doi">10.18129/B9.bioc.Biostrings.2022</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0026">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname>, <given-names>E.S.</given-names></string-name></person-group><year>2016</year>, <article-title>Using DECIPHER v20 to analyze big biological sequence data in R</article-title>, <source>R J.</source>, <volume>8</volume>, <fpage>352</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0027">
      <label>27.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>H.</given-names></string-name></person-group><year>2013</year>, <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <comment><italic toggle="yes">arXiv</italic>, 1303.3997v2, Date of publication 26 May 2013</comment>, <ext-link xlink:href="http://arxiv.org/pdf/1303.3997.pdf" ext-link-type="uri">http://arxiv.org/pdf/1303.3997.pdf</ext-link>, <comment>preprint: not peer reviewed</comment>.</mixed-citation>
    </ref>
    <ref id="CIT0028">
      <label>28.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Morgan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Obenchain</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>Hayden</surname>, <given-names>N.</given-names></string-name></person-group><year>2023</year>, <article-title>Rsamtools: Binary alignment (BAM), FASTA, variant call (BCF), and tabix file import</article-title>, <comment>Accessed 24 Apr 2023</comment>. <ext-link xlink:href="https://bioconductor.org/packages/Rsamtools" ext-link-type="uri">https://bioconductor.org/packages/Rsamtools</ext-link></mixed-citation>
    </ref>
    <ref id="CIT0029">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marçais</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Delcher</surname>, <given-names>A.L.</given-names></string-name>, <string-name><surname>Phillippy</surname>, <given-names>A.M.</given-names></string-name>, <string-name><surname>Coston</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Salzberg</surname>, <given-names>S.L.</given-names></string-name>, and <string-name><surname>Zimin</surname>, <given-names>A.</given-names></string-name></person-group><year>2018</year>, <article-title>MUMmer4: a fast and versatile genome alignment system</article-title>, <source>PLoS Comput. Biol.</source>, <volume>14</volume>, <fpage>e1005944</fpage>.<pub-id pub-id-type="pmid">29373581</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0030">
      <label>30.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Smit</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hubley</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Green</surname>, <given-names>P.</given-names></string-name></person-group><comment>RepeatMasker Open-4.0. 2013-2015</comment>, <comment>Accessed 4 May 2023</comment>. <ext-link xlink:href="http://www.repeatmasker.org" ext-link-type="uri">http://www.repeatmasker.org</ext-link></mixed-citation>
    </ref>
    <ref id="CIT0031">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name></person-group><year>2013</year>, <article-title>The Subread aligner: fast, accurate and scalable read mapping by seed-and-vote</article-title>, <source>Nucleic Acids Res.</source>, <volume>41</volume>, <fpage>e108</fpage>–<lpage>e108</lpage>.<pub-id pub-id-type="pmid">23558742</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0032">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Auton</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Abecasis</surname>, <given-names>G.</given-names></string-name>, <etal>et al.</etal></person-group>; <collab>1000 Genomes Project Analysis Group</collab>. <year>2011</year>, <article-title>The variant call format and VCFtools</article-title>, <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0033">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Levine</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Gogarten</surname>, <given-names>S.M.</given-names></string-name>, <string-name><surname>Laurie</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Weir</surname>, <given-names>B.S.</given-names></string-name></person-group><year>2012</year>, <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>, <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3326</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0034">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Shi</surname>, <given-names>W.</given-names></string-name></person-group><year>2019</year>, <article-title>The R package Rsubread is easier, faster, cheaper and better for alignment and quantification of RNA sequencing reads</article-title>, <source>Nucleic Acids Res.</source>, <volume>47</volume>, <fpage>e47</fpage>–<lpage>e47</lpage>.<pub-id pub-id-type="pmid">30783653</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0035">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Ashikari</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Jena</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Doi</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Reuscher</surname>, <given-names>S.</given-names></string-name></person-group><year>2017</year>, <article-title>Adapting genotyping-by-sequencing for rice F2 populations</article-title>, <source>G3–Genes Genom Genet</source>, <volume>7</volume>, <fpage>881</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0036">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Walker</surname>, <given-names>B.J.</given-names></string-name>, <string-name><surname>Abeel</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Shea</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Priest</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Abouelliel</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal></person-group>, <year>2014</year>, <article-title>Pilon: an integrated tool for comprehensive microbial variant detection and genome assembly improvement</article-title>, <source>PLoS One</source>, <volume>9</volume>, <fpage>e112963</fpage>.<pub-id pub-id-type="pmid">25409509</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0037">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Presting</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Barbazuk</surname>, <given-names>W.</given-names></string-name>, <etal>et al.</etal></person-group><year>2002</year>, <article-title>An integrated physical and genetic map of the rice genome</article-title>, <source>Plant Cell</source>, <volume>14</volume>, <fpage>537</fpage>.<pub-id pub-id-type="pmid">11910002</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0038">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schneeberger</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ossowski</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Ott</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal></person-group><year>2011</year>, <article-title>Reference-guided assembly of four diverse Arabidopsis thaliana genomes</article-title>, <source>Proc. Natl. Acad. Sci. USA</source>, <volume>108</volume>, <fpage>10249</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">21646520</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0039">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lischer</surname>, <given-names>H.E.L.</given-names></string-name> and <string-name><surname>Shimizu</surname>, <given-names>K.K.</given-names></string-name></person-group><year>2017</year>, <article-title>Reference-guided de novo assembly approach improves genome reconstruction for related species</article-title>, <source>BMC Bioinf.</source>, <volume>18</volume>, <fpage>474</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0040">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suyama</surname>, <given-names>Y.</given-names></string-name> and <string-name><surname>Matsuki</surname>, <given-names>Y.</given-names></string-name></person-group><year>2015</year>, <article-title>MIG-seq: an effective PCR-based method for genome-wide single-nucleotide polymorphism genotyping using the next-generation sequencing platform</article-title>, <source>Sci. Rep.</source>, <volume>5</volume>, <fpage>16963</fpage>.<pub-id pub-id-type="pmid">26593239</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0041">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guk</surname>, <given-names>J.Y.</given-names></string-name>, <string-name><surname>Jang</surname>, <given-names>M.J.</given-names></string-name>, <string-name><surname>Choi</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>Y.M.</given-names></string-name>, and <string-name><surname>Kim</surname>, <given-names>S.</given-names></string-name></person-group><year>2022</year>, <article-title>De novo phasing resolves haplotype sequences in complex plant genomes</article-title>, <source>Plant Biotechnol. J.</source>, <volume>20</volume>, <fpage>1031</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">35332665</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0042">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerard</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Ferrão</surname>, <given-names>L.F.V.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>A.A.F.</given-names></string-name>, and <string-name><surname>Stephens</surname>, <given-names>M.</given-names></string-name></person-group><year>2018</year>, <article-title>Genotyping polyploids from messy sequencing data</article-title>, <source>Genetics</source>, <volume>210</volume>, <fpage>789</fpage>–<lpage>807</lpage>.<pub-id pub-id-type="pmid">30185430</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0043">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lipka</surname>, <given-names>A.E.</given-names></string-name>, and <string-name><surname>Sacks</surname>, <given-names>E.J.</given-names></string-name></person-group><year>2019</year>, <article-title>polyRAD: genotype calling with uncertainty from sequencing data in polyploids and diploids</article-title>, <source>G3–Genes Genom Genet</source>, <volume>9</volume>, <fpage>663</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
