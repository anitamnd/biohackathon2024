<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7053140</article-id>
    <article-id pub-id-type="publisher-id">6542</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-6542-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Millefy: visualizing cell-to-cell heterogeneity in read coverage of single-cell RNA sequencing datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1606-2762</contrib-id>
        <name>
          <surname>Ozaki</surname>
          <given-names>Haruka</given-names>
        </name>
        <address>
          <email>haruka.ozaki@md.tsukuba.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hayashi</surname>
          <given-names>Tetsutaro</given-names>
        </name>
        <address>
          <email>tetsutaro.hayashi@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Umeda</surname>
          <given-names>Mana</given-names>
        </name>
        <address>
          <email>mana.umeda@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nikaido</surname>
          <given-names>Itoshi</given-names>
        </name>
        <address>
          <email>itoshi.nikaido@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2369 4728</institution-id><institution-id institution-id-type="GRID">grid.20515.33</institution-id><institution>Bioinformatics Laboratory, Faculty of Medicine, University of Tsukuba, </institution></institution-wrap>1-1-1 Tennodai, Tsukuba, Ibaraki, 305-8575 Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2369 4728</institution-id><institution-id institution-id-type="GRID">grid.20515.33</institution-id><institution>Center for Artificial Intelligence Research, University of Tsukuba, </institution></institution-wrap>1-1-1 Tennodai, Tsukuba, Ibaraki, 305-8577 Japan </aff>
      <aff id="Aff3"><label>3</label>Laboratory for Bioinformatics Research, RIKEN Center for Biosystems Dynamics Research, 2-1 Hirosawa, Wako, Saitama, 351-0198 Japan </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2369 4728</institution-id><institution-id institution-id-type="GRID">grid.20515.33</institution-id><institution>Bioinformatics Course, Master’s/Doctoral Program in Life Science Innovation, School of Integrative and Global Majors, University of Tsukuba, </institution></institution-wrap>1-1-1 Tennodai, Tsukuba, Ibaraki, 305-8575 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>177</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Read coverage of RNA sequencing data reflects gene expression and RNA processing events. Single-cell RNA sequencing (scRNA-seq) methods, particularly “full-length” ones, provide read coverage of many individual cells and have the potential to reveal cellular heterogeneity in RNA transcription and processing. However, visualization tools suited to highlighting cell-to-cell heterogeneity in read coverage are still lacking.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we have developed Millefy, a tool for visualizing read coverage of scRNA-seq data in genomic contexts. Millefy is designed to show read coverage of all individual cells at once in genomic contexts and to highlight cell-to-cell heterogeneity in read coverage. By visualizing read coverage of all cells as a heat map and dynamically reordering cells based on diffusion maps, Millefy facilitates discovery of “local” region-specific, cell-to-cell heterogeneity in read coverage. We applied Millefy to scRNA-seq data sets of mouse embryonic stem cells and triple-negative breast cancers and showed variability of transcribed regions including antisense RNAs, 3 <sup>′</sup> UTR lengths, and enhancer RNA transcription.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Millefy simplifies the examination of cellular heterogeneity in RNA transcription and processing events using scRNA-seq data. Millefy is available as an R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/yuifu/millefy">https://github.com/yuifu/millefy</ext-link>) and as a Docker image for use with Jupyter Notebook (<ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/yuifu/datascience-notebook-millefy">https://hub.docker.com/r/yuifu/datascience-notebook-millefy</ext-link>).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA sequencing</kwd>
      <kwd>Visualization</kwd>
      <kwd>Read coverage</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009619</institution-id>
            <institution>Japan Agency for Medical Research and Development</institution>
          </institution-wrap>
        </funding-source>
        <award-id>18bm0404024h0001</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003382</institution-id>
            <institution>Core Research for Evolutional Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJCR16G3</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006264</institution-id>
            <institution>RIKEN</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Special Postdoctoral Researchers Program</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Single-cell RNA sequencing (scRNA-seq) has been increasingly important in many areas, including developmental biology and cancer biology. In scRNA-seq data analyses, visualization is crucial for quality control (QC) as well as exploratory data analyses. For example, dimensionality reduction techniques such as principal component analysis (PCA) [<xref ref-type="bibr" rid="CR1">1</xref>] or t-distributed stochastic neighbor embedding [<xref ref-type="bibr" rid="CR2">2</xref>] are applied to a gene expression matrix to visualize individual cells as points in 2- or 3-dimensional space. Heat maps are also used to visualize gene expression matrices and highlight latent clusters of genes and cells. To date, many tools for visualizing gene expression matrices of scRNA-seq data have been proposed [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>In contrast to visualization of gene expression matrices, visualization of read coverage, which is the distribution of mapped reads along genomic coordinates, helps reveal diverse aspects of RNA sequencing data and thus RNA biology and functional genomics. For example, read coverage reflects transcribed gene structures (e.g., exon-intron structures and transcript isoforms) [<xref ref-type="bibr" rid="CR4">4</xref>], RNA processing events (e.g., normal and recursive splicing [<xref ref-type="bibr" rid="CR5">5</xref>]), and transcription of intergenic and unannotated regions (e.g., enhancer RNAs [eRNAs]) [<xref ref-type="bibr" rid="CR6">6</xref>]. Moreover, visual inspection of read coverage enables quality assessment of experimental methods (e.g., whether amplification is biased [<xref ref-type="bibr" rid="CR7">7</xref>]) and bioinformatic methods (e.g., the accuracy of expression level estimation).</p>
    <p>Given that scRNA-seq has revealed cellular heterogeneity in gene [<xref ref-type="bibr" rid="CR8">8</xref>] and splicing isoform expression [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], visualization of read coverage of scRNA-seq data is expected to reveal cellular heterogeneity in read coverage, which can be interpreted as biological (e.g., transcription and RNA processing) and technical (e.g., amplification biases) heterogeneity. Read coverage is informative, especially for so-called “full-length” scRNA-seq methods such as Smart-seq2 [<xref ref-type="bibr" rid="CR11">11</xref>] and RamDA-seq [<xref ref-type="bibr" rid="CR12">12</xref>], compared with “3 <sup>′</sup>-tag sequencing” scRNA-seq methods, which sequence only the 3 <sup>′</sup> ends of RNAs and cannot be used to extract rich information from read coverage [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Despite their potential importance, however, tools specifically for the visualization of read coverage of scRNA-seq data are still lacking.</p>
    <p>To explore cell-to-cell heterogeneity in read coverage, we propose several requirements of a tool for visualization of read coverage in scRNA-seq data (Table <xref rid="Tab1" ref-type="table">1</xref>). First, the tool must be able to display read coverage of all individual cells in a scRNA-seq dataset at once. This is because scRNA-seq data consist of many (10<sup>2</sup>– 10<sup>3</sup>) cells and frequently includes latent heterogeneity that is masked by the summation of expression across cells. Second, the tool must associate read coverage with genomic contexts, such as gene structures and epigenomic features, because read coverage data can be interpreted only when it is displayed simultaneously with their genomic contexts. Third, the tool must highlight the cell-to-cell heterogeneity of read coverage within focal regions. This is because there should be “local” region-specific cell-to-cell heterogeneity in read coverage at transcriptional (e.g., antisense RNAs and eRNAs) and post-transcriptional (e.g., alternative splicing) levels, and such heterogeneity is difficult to notice in advance by cell groupings defined according to global similarity among cells.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of Millefy to other visualization tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Millefy</th><th align="left">Genome browsers</th><th align="left">Heatmaps</th></tr></thead><tbody><tr><td align="justify">Visualize many cells at once</td><td align="center">✓</td><td align="center"/><td align="center">✓</td></tr><tr><td align="justify">Associate read coverage with genomic contexts</td><td align="center">✓</td><td align="center">✓</td><td align="center"/></tr><tr><td align="justify">Highlight cell-to-cell heterogeneity in read coverage</td><td align="center">✓</td><td align="center"/><td align="center">✓</td></tr></tbody></table></table-wrap></p>
    <p>Genome browsers and heat maps are two major tools for read coverage visualization. However, they are insufficient for fulfilling the above requirements.</p>
    <p>Genome browsers, such as IGV [<xref ref-type="bibr" rid="CR15">15</xref>] and JBrowse [<xref ref-type="bibr" rid="CR16">16</xref>], utilize “tracks” to display various types of biological data, including gene annotations, positions of regulatory elements, and read mapping of next-generation sequencing (NGS) data along genomic coordinates. By stacking tracks in genome browsers, read coverage can easily be compared with other features and be interpreted in genomic contexts like gene models and epigenomic signals, which helps to generate and validate biological hypotheses. However, existing genome browsers are not suited for the large numbers of samples (i.e., cells) in scRNA-seq experiments. Indeed, efforts to visualize read coverage of scRNA-seq data using genome browsers have been limited to displays of a few dozen cells without the need to scroll [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. Although IGV and JBrowse implement heat map representations of tracks to show many cells at once, they cannot dynamically reorder tracks to reveal local cell-to-cell heterogeneity in read coverage.</p>
    <p>Tools for heat maps combined with clustering algorithms have been used in the analysis of scRNA-seq data. Thus, heat maps can be used to visualize read coverage of all cells at once and reveal heterogeneity in read coverage. However, tools for generating heat maps are unsuited for visualizing read coverage of scRNA-seq data in genomic contexts, or they lack functionality to directly extract read coverage from standard NGS data formats.</p>
    <p>Here, we have developed Millefy, which combines genome-browser-like visualization, heat maps, and dynamic reordering of single-cell read coverage and thus facilitates the examination of local heterogeneity within scRNA-seq data. Millefy extracts and organizes various types of useful information from read coverage of scRNA-seq data.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>Millefy visualizes read coverage from each individual cell as a heat map in which rows represent cells and columns represent genomic bins within a focal region. The heat map is aligned with tracks for gene annotations, genomic features, and bulk NGS data, enabling comparisons of single-cell read coverage with genomic contexts. To highlight latent cell-to-cell heterogeneity in read coverage, the heat map rows (i.e., cells) are automatically and dynamically reordered by ’local’ pseudo-time, which is calculated using diffusion maps [<xref ref-type="bibr" rid="CR19">19</xref>], a nonlinear dimensionality reduction method. Specifically, diffusion maps are applied to matrices of single-cell read coverage, where rows are cells and columns are genomic bins, and the first diffusion component is used to dynamically reorder cells either in an“all cells” manner or in a “group-wise” manner when groupings of cells are provided by users. Alternatively, PCA can also be used to rearrange the order of cells.</p>
    <p>Effective visualization requires iterative adjustment of various aspects of plots by visual inspection. Millefy supports iterative adjustment of plots by the millefy_adjust() function, which reuses the read coverage matrices of the last plot, enabling faster adjustment than simply replotting. For example, after viewing plots, users can easily adjust the maximal value of the color scale, which is essential in cases with exceptionally high read coverages in the focal region.</p>
    <p>Millefy visualizations consist of five types of tracks (Fig. <xref rid="Fig1" ref-type="fig">1</xref>): (1) scRNA-seq tracks, which display scRNA-seq read coverage as a heat map with ordered cells, (2) mean scRNA-seq read coverage tracks, (3) bulk NGS data tracks, which display read coverage of other NGS data, (4) BED tracks, which display genomic intervals defined by BED files, and (5) gene annotation tracks. In scRNA-seq tracks and bulk NGS data tracks, read coverage is normalized by user-provided normalization factors to correct for differences in the number of mapped reads among samples. Using the above tracks, Millefy can simultaneously display read coverage of each cell and mean read coverage of cells in each user-defined cell group as well as align scRNA-seq data with genome annotation data and NGS data.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of Millefy. <bold>a</bold> Millefy imports scRNA-seq data and visualizes read coverage of individual cells as a heat map. The rows (i.e., cells) of the heat map are dynamically reordered by diffusion maps. This automatic reordering highlights cell-to-cell heterogeneity in read coverage, which is hidden by mean read coverage data. Millefy associates genomic contexts, including bulk NGS data, genomic features, and gene annotations, thus facilitating the interpretation of single-cell read coverage. The parallelograms represent different types of input data. Gray boxes represent displayed tracks in Millefy. White boxes represent computation of a read coverage matrix. <bold>b</bold> An example plot in Millefy</p></caption><graphic xlink:href="12864_2020_6542_Fig1_HTML" id="MO1"/></fig></p>
    <p>Millefy was implemented in R and can import scRNA-seq data without the need for format conversion. For scRNA-seq data, Millefy accepts BAM and BigWig formats, which are standard file formats for NGS data analysis. Millefy is dependent on the rtracklayer package [<xref ref-type="bibr" rid="CR20">20</xref>] and Rsamtools package [<xref ref-type="bibr" rid="CR21">21</xref>] for importing BAM and BigWig files, respectively. For gene annotation data and genomic features, Millefy accepts GTF and BED formats, respectively. The data.table package [<xref ref-type="bibr" rid="CR22">22</xref>] is used to import GTF and BED files. For performing diffusion maps on read coverage data, Millefy utilizes the destiny package [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
    <p>We provide Millefy as an R package and as a Docker image based on the Jupyter Notebook Data Science stack (<ext-link ext-link-type="uri" xlink:href="https://github.com/jupyter/docker-stacks">https://github.com/jupyter/docker-stacks</ext-link>) for use with Jupyter Notebook.</p>
  </sec>
  <sec id="Sec3" sec-type="results">
    <title>Results</title>
    <sec id="Sec4">
      <title>Millefy highlights cellular heterogeneity in gene expression and transcribed gene structures</title>
      <p>Researchers often merge read alignment files of single cells and visualize “synthetic bulk” data using standard genome browsers. However, in such cases, the merged (or averaged) read coverage cannot capture heterogeneity in read coverage. For example, a change in the merged read coverage cannot indicate whether the number of cells expressing a gene increased or the expression level of that gene increased across all cells. In contrast, Millefy visualizes read coverage of all individual cells in a scRNA-seq dataset as a heat map and thereby provides detailed information on cellular heterogeneity in read coverage.</p>
      <p>To demonstrate the usefulness of Millefy’s ability to visualize read coverage in scRNA-seq data, we used a time-course RamDA-seq dataset derived from mouse embryonic stem cells (mESCs) upon induction of cell differentiation to primitive endoderm cells (at 0, 12, 24, 48, and 72 h) [<xref ref-type="bibr" rid="CR12">12</xref>]. The dataset consists of 421 single cells.</p>
      <p>Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the read coverage at <italic>Sox17</italic>, a differentiation marker gene. Cells were reordered according to the first diffusion component values calculated by a diffusion map of read coverage data for the locus, either within user-defined cell groups (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) or across all cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). While the height of the mean read coverage increased along the differentiation time course, the reordered heat map highlights the heterogeneity of read coverage among cells from the same time points (e.g., the 12 h group) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Specifically, Millefy showed that the number of cells with <italic>Sox17</italic> expression increased, indicating asynchronous cell differentiation progression among cells.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Millefy visualization of read coverage at the <italic>Sox17</italic> locus. Millefy was applied to RamDA-seq data from mouse embryonic stem cells (mESCs) upon induction of cell differentiation to primitive endoderm cells. The top heat map shows single-cell read coverage. Color keys on the left side represent cells from different time points. The middle tracks show the averaged read coverage at different time points, the bulk RNA sequencing read coverage, and enhancer annotations. The bottom track shows the GENCODE reference gene annotation. Cells were reordered within <bold>a</bold> user-specified groups and <bold>b</bold> across all cells</p></caption><graphic xlink:href="12864_2020_6542_Fig2_HTML" id="MO2"/></fig></p>
      <p>Another example is <italic>Zmynd8</italic>, a transcriptional repressor. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows read coverage of 421 individual cells at the <italic>Zmynd8</italic> locus. The cells were dynamically reordered using diffusion maps based on the read coverage in the focal region. Expression of the <italic>Zmynd8</italic> short isoform is known to be associated with the expression of its antisense RNA <italic>Zmynd8as</italic> [<xref ref-type="bibr" rid="CR24">24</xref>]. While <italic>Zmynd8as</italic> is unannotated in the current gene annotation, the heat map by Millefy clearly showed differential regulation of the long isoform of <italic>Zmynd8</italic> and <italic>Zmynd8as</italic>, facilitating visual inspection of the two separated transcription units (Figure <xref rid="Fig3" ref-type="fig">3</xref>). We note that the averaged read coverage for each time point cannot distinguish whether the long and short isoforms of <italic>Zmynd8</italic> and <italic>Zmynd8as</italic> are correlated or uncorrelated. These results demonstrate that Millefy’s functionality for displaying read coverage as a reordered heat map reveals cell-to-cell heterogeneity at the focal locus.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Visualization of the <italic>Zmynd8</italic> locus by Millefy across all cells. Millefy was applied to RamDA-seq data from mouse embryonic stem cells (mESCs) upon induction of cell differentiation to primitive endoderm cells. All cells were reordered together without specified groupings. The green arrow has been added to indicate the position of <italic>Zmynd8as</italic></p></caption><graphic xlink:href="12864_2020_6542_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Millefy application on scRNA-seq data from triple-negative breast cancer patients</title>
      <p>We also applied Millefy to a scRNA-seq dataset from triple-negative invasive cancer (TNBC) patients: the Smart-seq2 data of single sorted cells from six tumors collected from six women with primary, non-metastatic triple-negative invasive ductal carcinomas [<xref ref-type="bibr" rid="CR25">25</xref>]. The dataset consists of B-cells (n=19), endothelial cells (n=14), epithelial cells (n=868), macrophages (n=64), stromal cells (n=94), and T-cells (n=53), according to the cell type annotation published by the authors. Epithelial cells were further classified into five clusters by the authors [<xref ref-type="bibr" rid="CR25">25</xref>]: Clusters 1 (n=22), 2 (n=398), 3 (n=231), 4 (n=170), and 5 (n=47).</p>
      <p>We checked whether 3 <sup>′</sup> UTR shortening is observed in the endothelial cell clusters. The Neuroblastoma RAS viral (v-Ras) oncogene homolog (NRAS) and the Jun proto-oncogene (c-JUN) are known to show alternative polyadenylation (APA)-dependent 3 <sup>′</sup> UTR shortening in TNBC cells [<xref ref-type="bibr" rid="CR26">26</xref>]. Millefy appears to show that there is cell-to-cell heterogeneity in the length of the 3 <sup>′</sup> UTRs of c-JUN and NRAS (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Specifically, for c-JUN, some cells showed short read coverage and others showed long read coverage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). In the last exon of NRAS, many cells showed long 3 <sup>′</sup> UTR read coverage but some cells showed a shortened 3 <sup>′</sup> UTR read coverage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Such heterogeneity cannot be determined by the aggregated (averaged) read coverage alone (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The triple-negative breast tumors with the 3 <sup>′</sup> UTR shortening of c-JUN and/or NRAS are reported to be smaller and less proliferative but more invasive than those without the 3 <sup>′</sup> UTR shortening [<xref ref-type="bibr" rid="CR26">26</xref>]. Therefore, such subpopulations may confer heterogeneous invasiveness even when the population size is small; thus, further investigation is warranted.
<fig id="Fig4"><label>Fig. 4</label><caption><p>3 <sup>′</sup> UTR shortening in <italic>c-JUN</italic> and <italic>NRAS</italic> in TNBC Smart-seq2 data. Millefy was applied to the Smart-seq2 data of epithelial cells from six women with primary, non-metastatic triple-negative invasive ductal carcinomas. Cells were reordered and visualized according to the cell cluster annotations</p></caption><graphic xlink:href="12864_2020_6542_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Millefy associates read coverage with genomic contexts to facilitate interpretation of read coverage</title>
      <p>Genomic contexts are crucial for interpretation of read coverage in bulk and single-cell RNA sequencing data. For example, read coverage overlapped with gene annotations can confirm known and reveal novel exon-intron structures. Moreover, read coverage overlapped with enhancer annotations can be interpreted as eRNA expression [<xref ref-type="bibr" rid="CR6">6</xref>]. Using Millefy, single-cell read coverage can be compared with genomic and epigenomic features like enhancer elements.</p>
      <p>To demonstrate the usefulness of the simultaneous visualization of single-cell read coverage and genomic contexts, we compared read coverage of the RamDA-seq data from mESCs (0 h) with mESC enhancer regions. We downloaded H3K4me1 and H3K4me3 ChIP-seq peak regions for mESCs from the ENCODE project [<xref ref-type="bibr" rid="CR27">27</xref>] and defined mESC enhancers as the H3K4me1 peaks that (1) did not overlap with the H3K4me3 peaks, (2) were at least 2 kbp away from the transcriptional start sites, and (3) were not included in the gene bodies of the GENCODE gene annotation (vM9) [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p>Figure <xref rid="Fig5" ref-type="fig">5</xref> displays read coverage at the <italic>Myc</italic> locus, with the positions of enhancers active in mESCs. The <italic>Myc</italic> gene models and read coverage reveal that <italic>Myc</italic> was transcribed in mESCs. In addition, Millefy showed that some of the intergenic regions with transcribed RNA overlapped with the <italic>Myc</italic> downstream enhancer regions (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). This is consistent with the previous report that RamDA-seq can detect eRNAs [<xref ref-type="bibr" rid="CR12">12</xref>]. This result exemplifies how Millefy can help to interpret read coverage of scRNA-seq data in genomic contexts.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Millefy visualization of read coverage and enhancer regions around the <italic>Myc</italic> locus. Millefy was applied to RamDA-seq data from mouse embryonic stem cells (mESCs). All cells were reordered together without specified groupings. RNA transcription was observed for the enhancers on the left</p></caption><graphic xlink:href="12864_2020_6542_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Millefy facilitates quality control in full-length scRNA-seq methods</title>
      <p>Millefy can also be used for QC in full-length scRNA-seq methods. For example, scRNA-seq read coverage of long transcripts indicates whether the method employed provided full-length transcript coverage. Full-length transcript coverage provides accurate information about isoform expression and gene structures and is a fundamental feature of full-length scRNA-seq methods [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
      <p>We applied Millefy to C1-RamDA-seq data (<italic>n</italic>=96) and C1-SMART-Seq V4 (<italic>n</italic>=95) data from a dilution of 10 pg of mESC RNA. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the read coverage at <italic>Mdn1</italic>, a gene with a long transcript (17,970 bp) consisting of 102 exons. C1-RamDA-seq detected all exons in most samples, while C1-SMART-seq V4 failed to detect a fraction of known exons. Interestingly, the patterns of missing exons in C1-SMART-seq V4 seemed to vary among the samples. The lower reproducibility in read coverage of C1-SMART-seq V4 relative to C1-RamDA-seq is likely owing to technical noise because the samples were prepared not from living cells but from a dilution of 10 pg of RNA. We note that mean read coverage cannot provide such detailed information on reproducibility in read coverage (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). This result exemplifies how Millefy can be used for quality control of scRNA-seq methods.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Example of quality control of scRNA-seq methods. Visualization of read coverage from C1-RamDA-seq (<italic>n</italic>=95) and C1-SMART-Seq V4 (<italic>n</italic>=96) data from a dilution of 10 pg of RNA at the <italic>Mdn1</italic> locus by Millefy. The samples were reordered within user-specified groups</p></caption><graphic xlink:href="12864_2020_6542_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Computational time</title>
      <p>We measured the computational time of Millefy for visualizing whole gene bodies using RamDA-seq data with 793 samples from mESCs [<xref ref-type="bibr" rid="CR12">12</xref>]. For 1000 randomly selected gene loci (of expressed genes with average TPM &gt;5), Millefy processed BigWig and BAM files in 39.3 and 138.9 s, respectively, on average.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p>In this paper, we proposed Millefy, a tool for visualizing cell-to-cell heterogeneity in read coverage in scRNA-seq data. Millefy combines genome-browser-like visualization, heat maps, and dynamic reordering of single-cell read coverage. Thereby, Millefy can display read coverage of all cells at once, associate read coverage with genomic contexts, and highlight the cell-to-cell heterogeneity of read coverage within focal regions (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
    <p>Using scRNA-seq data of mESCs and TNBC, we demonstrate the effectiveness of Millefy to reveal local heterogeneity in read coverage within scRNA-seq data. First, Millefy showed cellular heterogeneity in gene expression and transcribed gene structures through the cell differentiation time course of mESCs (Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>). Second, we found cellular heterogeneity in the 3 <sup>′</sup> UTR shortening of c-JUN and/or NRAS in TNBC data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), which was not mentioned in the original paper [<xref ref-type="bibr" rid="CR25">25</xref>]. Third, by associating read coverage with enhancer annotations, Millefy helped to interpret RNA transcription events in non-coding regions (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Collectively, these results indicate that Millefy enables the exploration of cellular heterogeneity of various biological events from read coverage of scRNA-seq data, which could be missed by conventional visualization tools.</p>
    <p>Quality control is essential for developing new experimental and computational tools. Using scRNA-seq data of diluted RNA with different full-length scRNA-seq methods (Fig. <xref rid="Fig6" ref-type="fig">6</xref>), we demonstrate that Millefy visualizes read coverage in scRNA-seq as a QC measure and complements existing scRNA-seq QC pipelines based primarily on gene expression matrices [<xref ref-type="bibr" rid="CR3">3</xref>]. In the development of bioinformatics methods using rule-based and machine learning approaches for profiling alternative splicing or novel RNAs by scRNA-seq, read coverage visualization tools like Millefy will become more important for evaluating and representing the predictions of algorithms. Indeed, Millefy was recently used for evaluating and visualizing the results of software developed to discover differentially expressed (DE) gene regions [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Millefy, which is integrated with Jupyter Notebook and provided as a Docker image, can easily be utilized in exploratory analyses of scRNA-seq data. In conclusion, Millefy will provide new opportunities to analyze scRNA-seq data from the point of view of cell-to-cell heterogeneity in read coverage, and help researchers assess cellular heterogeneity and RNA biology using scRNA-seq data.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> Millefy<bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/yuifu/millefy">https://github.com/yuifu/millefy</ext-link> (R package), <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/yuifu/datascience-notebook-millefy">https://hub.docker.com/r/yuifu/datascience-notebook-millefy</ext-link>(Docker image)<bold>Archived version:</bold> DOI:10.5281/zenodo.3591109<bold>Operating system(s):</bold> Platform independent<bold>Programming language:</bold> R<bold>Other requirements:</bold> R version 3.2.2 or higher<bold>License:</bold> MIT<bold>Any restrictions to use by non-academics:</bold> No</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>eRNAs</term>
        <def>
          <p>enhancer RNAs</p>
        </def>
      </def-item>
      <def-item>
        <term>mESCs</term>
        <def>
          <p>mouse embryonic stem cells</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p>quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p>single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TNBC</term>
        <def>
          <p>triple negative breast cancer</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the members of the Bioinformatics Research Unit, particularly Hirotaka Matsumoto and Mika Yoshimura, for discussion of data analyses and Manabu Ishii and Akihiro Matsushima for IT infrastructure management.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>HO designed and implemented the software, performed the data analyses, and wrote the manuscript. TH and MU performed the C1-RamDA-seq and C1-SMART-Seq V4 experiments. IN contributed to the design of the data analyses. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>HO was supported by the Special Postdoctoral Researchers Program from RIKEN. This work was supported by the Projects for Technological Development, Research Center Network for Realization of Regenerative Medicine by Japan (18bm0404024h0001), the Japan Agency for Medical Research and Development (AMED), and JST CREST grant number JPMJCR16G3, Japan to I.N. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are available in the Gene Expression Omnibus repository, GSE98664 and GSE118390.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hotelling</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Analysis of a complex of statistical variables into principal components</article-title>
        <source>J Educ Psychol</source>
        <year>1933</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>417</fpage>
        <pub-id pub-id-type="doi">10.1037/h0071325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maaten</surname>
            <given-names>Lvd</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Visualizing data using t-sne</article-title>
        <source>J Mach Learn Res</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>Nov</issue>
        <fpage>2579</fpage>
        <lpage>605</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Exploring the single-cell rna-seq analysis landscape with the scrna-tools database</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>1006245</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kingsmore</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <issue>7221</issue>
        <fpage>470</fpage>
        <pub-id pub-id-type="doi">10.1038/nature07509</pub-id>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sibley</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Emmett</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Blazquez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Faro</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haberman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Briese</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Trabzuni</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ryten</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weale</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recursive splicing in long vertebrate genes</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>521</volume>
        <issue>7552</issue>
        <fpage>371</fpage>
        <pub-id pub-id-type="doi">10.1038/nature14466</pub-id>
        <pub-id pub-id-type="pmid">25970246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nord</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Akiyama</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Shoukry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Afzal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Pennacchio</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Visel</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Tissue-specific rna expression marks distant-acting developmental enhancers</article-title>
        <source>PLoS Genet</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>1004610</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1004610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Archer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Shahrezaei</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hebenstreit</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Modeling enzyme processivity reveals that rna-seq libraries are biased in characteristic and correctable ways</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>467</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.10.012</pub-id>
        <pub-id pub-id-type="pmid">27840077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saliba</surname>
            <given-names>A. -E.</given-names>
          </name>
          <name>
            <surname>Westermann</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Gorski</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Single-cell rna-seq: advances and future challenges</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>14</issue>
        <fpage>8845</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku555</pub-id>
        <pub-id pub-id-type="pmid">25053837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinov</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>From single-cell to cell-pool transcriptomes: stochasticity in gene expression and rna splicing</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>496</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.161034.113</pub-id>
        <pub-id pub-id-type="pmid">24299736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Botvinnik</surname>
            <given-names>OB</given-names>
          </name>
          <name>
            <surname>Lovci</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Kakaradov</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Single-cell alternative splicing analysis with expedition reveals splicing dynamics during neuron differentiation</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <issue>1</issue>
        <fpage>148</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.06.003</pub-id>
        <pub-id pub-id-type="pmid">28673540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>ÅK</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Full-length rna-seq from single cells using smart-seq2</article-title>
        <source>Nat Protoc</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>171</fpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.006</pub-id>
        <pub-id pub-id-type="pmid">24385147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayashi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ozaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sasagawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Umeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Danno</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nikaido</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Single-cell full-length total rna sequencing uncovers dynamics of recursive splicing and enhancer rnas</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>619</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-02866-0</pub-id>
        <pub-id pub-id-type="pmid">29434199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baran-Gale</surname>
            <given-names>Jeanette</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>Tamir</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>Kristina</given-names>
          </name>
        </person-group>
        <article-title>Experimental design for single-cell RNA sequencing</article-title>
        <source>Briefings in Functional Genomics</source>
        <year>2017</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>233</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elx035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell rna sequencing to explore immune cell heterogeneity</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.76</pub-id>
        <pub-id pub-id-type="pmid">28787399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buels</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Diesh</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Munoz-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Helt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Goodstein</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Elsik</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Jbrowse: a dynamic web platform for genome visualization and analysis</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>66</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0924-1</pub-id>
        <pub-id pub-id-type="pmid">27072794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biase</surname>
            <given-names>Fernando H.</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Xiaoyi</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>Sheng</given-names>
          </name>
        </person-group>
        <article-title>Cell fate inclination within 2-cell and 4-cell mouse embryos revealed by single-cell RNA sequencing</article-title>
        <source>Genome Research</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>11</issue>
        <fpage>1787</fpage>
        <lpage>1796</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.177725.114</pub-id>
        <pub-id pub-id-type="pmid">25096407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ner-Gaon</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melchior</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Golan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ben-Haim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shay</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Jinglebells: a repository of immune-related single-cell rna–sequencing datasets</article-title>
        <source>J Immunol</source>
        <year>2017</year>
        <volume>198</volume>
        <issue>9</issue>
        <fpage>3375</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1700272</pub-id>
        <pub-id pub-id-type="pmid">28416714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coifman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Lafon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Maggioni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nadler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Warner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zucker</surname>
            <given-names>SW</given-names>
          </name>
        </person-group>
        <article-title>Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>21</issue>
        <fpage>7426</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0500334102</pub-id>
        <pub-id pub-id-type="pmid">15899970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>rtracklayer: an r package for interfacing with genome browsers</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1841</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp328</pub-id>
        <pub-id pub-id-type="pmid">19468054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Morgan M, Pages H, Obenchain V, Hayden N. Rsamtools: Binary alignment (bam), fasta, variant call (bcf), and tabix file import. R package version. 2016; 1(0).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Dowle M, Srinivasan A, Short T, Lianoglou S, Saporta R, Antonyan E. data.table: Extension of Data. frame. R package version 1.9. 6. 2015. <ext-link ext-link-type="uri" xlink:href="https://www.r-bloggers.com/citing-r-packages/">https://www.r-bloggers.com/citing-r-packages/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>destiny: diffusion maps for large-scale single-cell data in r</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>8</issue>
        <fpage>1241</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv715</pub-id>
        <pub-id pub-id-type="pmid">26668002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Onodera</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Underwood</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Katzman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Greenberg</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Salama</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Gene isoform specificity through enhancer-associated antisense transcription</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>8</issue>
        <fpage>43511</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0043511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karaayvaz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cristea</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Mylvaganam</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Specht</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Michor</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ellisen</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Unravelling subclonal heterogeneity and aggressive disease states in tnbc through single-cell rna-seq</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>3588</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06052-0</pub-id>
        <pub-id pub-id-type="pmid">30181541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miles</surname>
            <given-names>WO</given-names>
          </name>
          <name>
            <surname>Lembo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Volorio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brachtel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sgroi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Provero</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dyson</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Alternative polyadenylation in triple-negative breast tumors allows nras and c-jun to bypass pumilio posttranscriptional regulation</article-title>
        <source>Cancer Res</source>
        <year>2016</year>
        <volume>76</volume>
        <issue>24</issue>
        <fpage>7231</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-16-0844</pub-id>
        <pub-id pub-id-type="pmid">27758885</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>EP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated encyclopedia of dna elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jungreis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loveland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mudge</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sisu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gencode reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>766</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y-C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Daniels</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loring</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Laurent</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length mrna-seq from single-cell levels of rna and individual circulating tumor cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>8</issue>
        <fpage>777</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2282</pub-id>
        <pub-id pub-id-type="pmid">22820318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsumoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hayashi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ozaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tsuyuzaki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Umeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Iida</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Okano</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nikaido</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>A nmf-based approach to discover overlooked differentially expressed gene regions from single-cell rna-seq data</article-title>
        <source>NAR Genomics Bioinforma</source>
        <year>2020</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>020</fpage>
        <pub-id pub-id-type="doi">10.1093/nargab/lqz020</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
