<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9361618</article-id>
    <article-id pub-id-type="publisher-id">4860</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04860-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SMaSH: a scalable, general marker gene identification framework for single-cell RNA-sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Nelson</surname>
          <given-names>M. E.</given-names>
        </name>
        <address>
          <email>nelson@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Riva</surname>
          <given-names>S. G.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Cvejic</surname>
          <given-names>A.</given-names>
        </name>
        <address>
          <email>as889@cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.52788.30</institution-id><institution-id institution-id-type="ISNI">0000 0004 0427 7672</institution-id><institution>European Bioinformatics Institute, </institution><institution>Wellcome Genome Campus, </institution></institution-wrap>Cambridge, CB10 1SD UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution>Department of Haematology, </institution><institution>University of Cambridge, </institution></institution-wrap>Cambridge, CB2 0AW UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.14105.31</institution-id><institution-id institution-id-type="ISNI">0000000122478951</institution-id><institution>Wellcome - Medical Research Council Cambridge Stem Cell Institute, </institution></institution-wrap>Cambridge, CB2 0AW UK </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.52788.30</institution-id><institution-id institution-id-type="ISNI">0000 0004 0427 7672</institution-id><institution>Open Targets, </institution><institution>Wellcome Genome Campus, </institution></institution-wrap>Cambridge, CB10 1SA UK </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.52788.30</institution-id><institution-id institution-id-type="ISNI">0000 0004 0427 7672</institution-id><institution>Wellcome Sanger Institute, </institution><institution>Wellcome Genome Campus, </institution></institution-wrap>Cambridge, CB10 1RQ UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>328</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single-cell RNA-sequencing is revolutionising the study of cellular and tissue-wide heterogeneity in a large number of biological scenarios, from highly tissue-specific studies of disease to human-wide cell atlases. A central task in single-cell RNA-sequencing analysis design is the calculation of cell type-specific genes in order to study the differential impact of different replicates (e.g. tumour vs. non-tumour environment) on the regulation of those genes and their associated networks. The crucial task is the efficient and reliable calculation of such cell type-specific ‘marker’ genes. These optimise the ability of the experiment to isolate highly-specific cell phenotypes of interest to the analyser. However, while methods exist that can calculate marker genes from single-cell RNA-sequencing, no such method places emphasise on specific cell phenotypes for downstream study in e.g. differential gene expression or other experimental protocols (spatial transcriptomics protocols for example). Here we present SMaSH, a general computational framework for extracting key marker genes from single-cell RNA-sequencing data which reliably characterise highly-specific and niche populations of cells in numerous different biological data-sets.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">SMaSH extracts robust and biologically well-motivated marker genes, which characterise a given single-cell RNA-sequencing data-set better than existing computational approaches for general marker gene calculation. We demonstrate the utility of SMaSH through its substantial performance improvement over several existing methods in the field. Furthermore, we evaluate the SMaSH markers on spatial transcriptomics data, demonstrating they identify highly localised compartments of the mouse cortex.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">SMaSH is a new methodology for calculating robust markers genes from large single-cell RNA-sequencing data-sets, and has implications for e.g. effective gene identification for probe design in downstream analyses spatial transcriptomics experiments. SMaSH has been fully-integrated with the ScanPy framework and provides a valuable bioinformatics tool for cell type characterisation and validation in every-growing data-sets spanning over 50 different cell types across hundreds of thousands of cells.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04860-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA-sequencing</kwd>
      <kwd>Marker genes</kwd>
      <kwd>Feature selection</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Open Targets</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id>
            <institution>European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>677501</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Molecular Biology Laboratory (EMBL) (4843)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Single-cell RNA-sequencing (scRNA-seq) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] is advancing our understanding of gene expression at the single-cell level in a variety of biological contexts, and is particularly relevant for learning the genetic profile of known and new cell types in a variety of different biological contexts at unprecedented resolution. In scRNA-seq of human tissue, it is usual for each cell to be aligned against a reference genome comprising over 20,000 genes. Various downstream dimensionality reduction and manifold embedding techniques are employed to reduce the complexity of this space and identify biologically distinct clusters of single cells corresponding to known and new phenotypes. Reversing this problem, if known cell types can be identified, it is relevant to ask which genes contribute most significantly to that particular phenotype. This question of identifying a <italic>small</italic> and <italic>unique</italic> set cell type-specific marker genes for several different clusters of cells is relevant for several reasons. In one case, knowing the most important marker genes influences the parameter space of genes to compare in that cell type across a variety of different biological scenarios. An example would be the differential behaviour of marker gene for a cell type in the case of cancerious tissue versus healthy tissue. As a second, and more topical example, scRNA-seq provides no information on the location of different cell populations in tissue. Spatial transcriptomics (STx) addresses this issue by resolving the locations of the whole or part of the sequenced transcriptome, thus providing better context for studying the vast heterogeneity of different cellular states throughout different organs and tissues. Protocols such as seqFISH (sequential Fluorescence In Situ Hybridization) [<xref ref-type="bibr" rid="CR3">3</xref>], ISS (In Situ Sequencing) [<xref ref-type="bibr" rid="CR4">4</xref>], and MERFISH (Multiplexed Error-Robust FISH) [<xref ref-type="bibr" rid="CR5">5</xref>] all aim to achieve this single-cell (and even sub-cellular) spatial resolution but for a limited number (i.e. a few hundred from a candidate list of typically 20,000 expressed genes) of pre-selected genes. The great utility of spatial technologies therefore entirely relies on the analysers’ abilities in selecting an optimal shortlist of candidate genes for spatial study which address their specific biological questions. These two examples illustrate the great importance of calculating marker genes for specific cell types which can uniquely identify those cells against all others in the data-set, in a statistically robust and reliable manner. It is also important that the analyser can calculate marker genes relevant for many <italic>different</italic> biological questions but applied to the same formal scRNA-seq data. Does the analyser want to select a sample of genes which distinguish different T cell populations from myeloid cell populations in order to study the immune response surrounding cancer? Does the analyser instead care about the behaviour of cells of different potencies (stem cell vs. progenitor vs. differentiated cell) in a small foetal tissue sample? Does the analyser care about genes which are best at distinguishing annotated tumour tissue from surrounding background tissue, a healthy control sample, and so on? Whilst computational techniques which attempt to select highly representative genes from large single-cell RNA-sequencing data-sets do exist, we are aware of no such techniques which select representative genes in a general enough manner to deal with <italic>any</italic> question the analyser might pose. The success of future single-cell studies which attempt to understand the biology of new and niche populations of cell types hidden in highly complex scRNA-seq data depends on the ability to highly specific genes that can label distinct cell populations in tissue sections according to any generic problem the prospective user is interested in. Moreover this must be achieved in a computationally efficient manner which is experimentally reproducible within and without the analysis framework. To this end we propose SMaSH (Scalable Marker (gene) Signal Hunter, Fig. <xref rid="Fig1" ref-type="fig">1</xref>) for the identification of important genes, from already annotated scRNA-seq data. This finds application in numerous single-cell downstream analyses, such as the classification of new cell types, the differential expression of those marker genes, and even the design of gene-specific probes for the emerging technologies in spatial transcriptomics.<fig id="Fig1"><label>Fig. 1</label><caption><p>The SMaSH framework. <bold>A</bold> SMaSH works directly from the counts matrix, producing a dictionary relating the user-defined classes of interest (e.g. cell type annotations) to top marker genes for each class (default top 5). <bold>B</bold> SMaSH filters and ranks genes according to an ensemble learning model or a deep neural network</p></caption><graphic xlink:href="12859_2022_4860_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par5">The strength of SMaSH is that it has been designed to work with any scRNA-seq barcode annotation provided by the user, and is therefore completely generic and scalable to a whole variety of gene identification tasks. Existing techniques rely on many different metrics for measuring the relevant important of different genes. In the SMaSH protocol, we recast marker gene selection as a feature importance calculation from a central SMaSH model which uses supervised learning to classify cells in scRNA-seq data according to user-defined annotations for each cell. We demonstrate that optimal performance of SMaSH is obtained from two different modes: the <italic>ensemble learner</italic> mode, which uses Gini importance to rank gene significance per cell type; and the <italic>network</italic> mode which uses Shapley values to rank the genes.</p>
    <p id="Par6">The utility of SMaSH is evaluated against other approaches for marker genes selection from scRNA-seq data(e.g. see  [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]). These approaches identify marker genes based only on their expression profiles throughout the tissue of interest. This can lead to identification of marker genes with wide expressions across multiple cell types and which therefore have a limited power to distinguish individual cell types within the data. The motivation for SMaSH was to select relevant, highly specific genes for bespoke downstream applications like STx, using universal non-linear functions [<xref ref-type="bibr" rid="CR8">8</xref>], as would be obtained from algorithms with a high number of degrees of freedom (neural networks or ensemble learners). These algorithms can learn a feature space parameterised by cell type-specific genes using user-provided cell type annotations for each data point. The need for a non-linear approach stems from the inherent non-linearity in scRNA-seq gene expression profiles. This should be compared with some other gene selection methods which rely on linear algorithms, such as linear correlation functions, to select key genes. Such linear approaches risk missing valuable information in the task of selecting relevant features (genes) from a higher-dimensional feature space which is inherently non-linear. In these studies we also wanted to assess the performance of the non-linear gene selection approach with state-of-the-art linear approaches. We found that existing marker gene tools using the linear paradigm did not generalise well across different scRNA-seq data-sets when trying to determine cell type-specific genes, often generating marker genes which lead to high misclassification rates in the data to the ground-truth cell types. Often the genes were also highly non-specific to cell types even when the training set was partitioned into known cell types <italic>a priori</italic>. SMaSH was observed to determine marker genes which consistently well describe, classify, and distinguish the unique cell types across many data-sets, giving more support to the need for non-linear functions in gene selection in a variety of biological scenarios. This performance improvement is vital for reliable marker gene calculations, and will only become more relevant as the task of scRNA-seq turns to identifying new sub-populations of cells within known phenotypes across developmental biology, cancer, and more besides. We believe this sets the scene for establishing SMaSH as an out-of-the-box framework for bridging the gap between gene expression bioinformatics software in scRNA-seq. We also noted a lack of direct usability in some approaches with respect to popular computational pipelines, such as ScanPy [<xref ref-type="bibr" rid="CR9">9</xref>]. Once again, SMaSH was designed to work easily with such frameworks. SMaSH can be implemented in both computer processing unit (CPU) and graphics processing unit (GPU) ‘modes’. The latter mode is relevant for analysing the ever-growing data-sets under consideration in single-cell transcriptomics commonly spanning over <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{6}$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq1.gif"/></alternatives></inline-formula> cells. Putting this all together, we believe SMaSH offers a valuable contribution to the field of bioinformatics software, and goes someway towards standardising the analysis workflow for scRNA-seq and other downstream protocols (e.g. STx).</p>
    <p id="Par7">Full details of the SMaSH model and procedure are provided in the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section. In particular, note that SMaSH implements its gene ranking and importance scoring using two different machine learning modes: the <italic>ensemble</italic> mode and the <italic>network</italic> mode. We originally considered three different models in the benchmarking of the <italic>ensemble</italic> mode: the Random Forest (RF) [<xref ref-type="bibr" rid="CR10">10</xref>], the Balanced Random Forest (BRF) [<xref ref-type="bibr" rid="CR11">11</xref>], and XGBoost [<xref ref-type="bibr" rid="CR12">12</xref>]. The need for different models is a result of variations in performance across different biological data-sets and different data-modalities. However we observed consistently excellent performance from XGBoost in the majority of scenarios (see <italic>Results</italic>), and this therefore represents the default model for the <italic>ensemble</italic> mode. The <italic>network</italic> mode comprises a feedforward deep neural network (DNN) [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. The <italic>ensemble</italic> mode evaluates the importance score of each gene according to the <italic>Gini importance</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], whilst the <italic>network</italic> mode evaluates importance according to the <italic>Shapley value</italic> [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par8">To address the performance of SMaSH, we consider the following questions:<list list-type="bullet"><list-item><p id="Par9">Can SMaSH determine highly-expressed genes which uniquely identify broad cell type populations (e.g. 10 cell types) in a variety of different scRNA-seq data-sets?</p></list-item><list-item><p id="Par10">By extension, can SMaSH identify specific marker genes in more complex data-sets comprising many cell types (above 30) in addition to the broad cell sub-types of the previous point? Such data-sets are becoming increasingly common in scRNA-seq analyses.</p></list-item><list-item><p id="Par11">Is SMaSH’s approach competitive with existing linear approaches to gene identification?</p></list-item><list-item><p id="Par12">Does SMaSH select biologically meaningful marker genes? This is assessed in two approaches: (1) cross-checking SMaSH markers against known cell type markers in literature (See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2); (2) verifying with spatial transcriptomics that SMaSH markers can identify cell types highly-localised to specific tissue compartments (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4).</p></list-item></list>To evaluate the performance of SMaSH markers, we benchmarked it against two recent standalone computational algorithms, scGeneFit [<xref ref-type="bibr" rid="CR6">6</xref>] and RankCorr [<xref ref-type="bibr" rid="CR7">7</xref>], which calculate marker genes from scRNA-seq data using linear programming and gene-by-gene correlations respectively. Unlike SMaSH these algorithms determine relevant markers by considering the entire scRNA-seq counts matrix, but we were still able to run them on specific cell type annotations in order to make a fair comparison with SMaSH, and the same gene sets are used in all methods. The additional ensemble learners we considered (Random Forrest and Balanced Random Forrest) when designing the <italic>ensemble</italic> mode also act as additional models to benchmark our default <italic>ensemble</italic> model (XGBoost) against.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Single-cell RNA-sequencing data-sets in this study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data-set</th><th align="left">Technology</th><th align="left">Cells</th><th align="left">Genes</th><th align="left"><inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#$$\end{document}</tex-math><mml:math id="M4"><mml:mo>#</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq2.gif"/></alternatives></inline-formula> Cell types</th><th align="left">References</th></tr></thead><tbody><tr><td align="left">Human lung cancer (broad)</td><td align="left">10X scRNA-seq</td><td char="." align="char">54,574</td><td char="." align="char">18,612</td><td char="." align="char">7</td><td align="left">N.A.</td></tr><tr><td align="left">Human lung cancer (cell sub-types)</td><td align="left">10X scRNA-seq</td><td char="." align="char">54,574</td><td char="." align="char">18,612</td><td char="." align="char">34</td><td align="left">N.A.</td></tr><tr><td align="left">Mouse brain (broad)</td><td align="left">Single nucleus RNA-seq</td><td char="." align="char">40,532</td><td char="." align="char">31,053</td><td char="." align="char">9</td><td align="left">[<xref ref-type="bibr" rid="CR17">17</xref>]</td></tr><tr><td align="left">Mouse brain (cell sub-types)</td><td align="left">Single nucleus RNA-seq</td><td char="." align="char">40,532</td><td char="." align="char">31,053</td><td char="." align="char">31</td><td align="left">[<xref ref-type="bibr" rid="CR17">17</xref>]</td></tr><tr><td align="left">Zeisel</td><td align="left">10X scRNA-seq</td><td char="." align="char">3005</td><td char="." align="char">4000</td><td char="." align="char">7</td><td align="left">[<xref ref-type="bibr" rid="CR18">18</xref>]</td></tr><tr><td align="left">CITE-seq</td><td align="left">CITE-seq</td><td char="." align="char">8617</td><td char="." align="char">500</td><td char="." align="char">13</td><td align="left">[<xref ref-type="bibr" rid="CR19">19</xref>]</td></tr><tr><td align="left">Paul15</td><td align="left">MARS-seq</td><td char="." align="char">2730</td><td char="." align="char">3451</td><td char="." align="char">10</td><td align="left">[<xref ref-type="bibr" rid="CR20">20</xref>]</td></tr><tr><td align="left">Human foetal liver</td><td align="left">10X scRNA-seq</td><td char="." align="char">65,712</td><td char="." align="char">19,572</td><td char="." align="char">18</td><td align="left">[<xref ref-type="bibr" rid="CR21">21</xref>]</td></tr><tr><td align="left">Human foetal organs</td><td align="left">10X scRNA-seq</td><td char="." align="char">211,754</td><td char="." align="char">23,054</td><td char="." align="char">40</td><td align="left">[<xref ref-type="bibr" rid="CR21">21</xref>]</td></tr></tbody></table><table-wrap-foot><p>The different data-sets considered in the benchmarking of SMaSH</p></table-wrap-foot></table-wrap></p>
    <p id="Par13">We compared RankCorr, scGeneFit, and the two modes implemented within SMaSH across several publicly available data-sets: Zeisel [<xref ref-type="bibr" rid="CR18">18</xref>], a data-set based on CITE-seq technology [<xref ref-type="bibr" rid="CR19">19</xref>], a mouse brain single nucleus RNA-sequenced data-set [<xref ref-type="bibr" rid="CR17">17</xref>], a healthy foetal liver data-set [<xref ref-type="bibr" rid="CR21">21</xref>], Paul15 stem cell data [<xref ref-type="bibr" rid="CR20">20</xref>], and a large lung cancer data-set. We also considered an extension of the foetal liver data-set covering skin and kidney cells in addition to liver when later studying the performance of SMaSH on the problem of identifying organ-specific marker genes. All data-sets are summarised in Table <xref rid="Tab1" ref-type="table">1</xref>. To systematically study the effect of cell type granularity when benchmarking SMaSH, the mouse brain data-set was split into two different sets of annotations. These are ‘broad’ and a higher-granularity set where each broad cell type was further subdivided. For the healthy foetal organ data-set, which spans the kidney, liver, femur, and yolk sack, we considered both the complete scRNA-seq data spanning all of those organs and the 40 different published annotations, and also separately the liver-only cells where we applied our own set of cell annotations for that specific organ, corresponding to 18 different cell types. This was done to further study how the different marker gene frameworks responded to the same type of data but at different levels of complexity (18 distinct cell types vs. 40 in the full data-set). These different data-sets use a variety of scRNA-seq technologies and conditions and were selected to so that the methodologies described could be tested on a variety of results from different type of tissue (e.g. mouse brain vs. human lung) and different numbers of sequenced single cells (e.g. 10<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{4}$$\end{document}</tex-math><mml:math id="M6"><mml:msup><mml:mrow/><mml:mn>4</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq3.gif"/></alternatives></inline-formula> vs. 10<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{6}$$\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mrow/><mml:mn>6</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq4.gif"/></alternatives></inline-formula>) and therefore data-set complexity. The lung cancer data-set comprised lung cancer tissue, the 5 cm of tissue surrounding the tumour, and healthy lung tissue from donors. Annotations on this final data-set were performed using a combination of principal component analysis of the highly-variable genes for dimensionality reduction and manifold learning via UMAP [<xref ref-type="bibr" rid="CR22">22</xref>] for visualisation purposes. Confounding of the data resulting from possible batch effects was tested and removed by applying the Harmony algorithm [<xref ref-type="bibr" rid="CR23">23</xref>] on the dimensionally-reduced cell phenotype representation. For the lung data annotations there are also two levels of annotation complexity. First we defined seven ‘broad’ cell types corresponding to myeloid cells, B cells, T cells, dendritic cells, natural killer cells, mast cells, and epithelial cells. Each of these broad cell types, with the exception of epithelial cells, was then split into additional cell sub-types, resulting in 34 distinct classes in the final analysis. Cell sub-types are determined before running SMaSH, and are motivated by prior knowledge of certain genes in specific clusters and known literature surrounding relevant genes for specific cell sub-types. Additional details on the benchmarking are described in the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section.</p>
    <sec id="Sec3">
      <title>SMaSH determines highly-expressed genes which uniquely identify broad cell type populations in scRNA-seq</title>
      <p id="Par14">In this first set of studies, we focused on the ‘broad’ cell types covering the previously defined data-sets; cell type multiplicities vary between 7 and 18. scGeneFit, RankCorr, and SMaSH separately calculated the most important 30 marker genes (per annotation class, e.g. cell type) to classify cells according to their ground-truth annotations in each data-set and evaluated them according to our classifiers outlines in our “<xref rid="Sec8" ref-type="sec">Methods</xref>” section. The results are summarised in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, where we separately benchmarked the <italic>ensemble</italic> and <italic>network</italic> modes of SMaSH against existing approaches (A and B), and three different ensemble models in the <italic>ensemble</italic> mode of SMaSH against one-another (C).</p>
      <p id="Par15">We observe that the misclassification and general performance with SMaSH outperforms existing approaches across all data-sets. This is particularly true for larger data-sets like the lung and human foetal liver, where SMaSH offers substantially lower misclassifications across all cell types. Thus, SMaSH scales very generally to marker gene identification problems in both simple data-sets like Zeisel and in larger data-sets, which are fast becoming the norm in single-cell biology. Confusion matrices of the true-positive (classification) rates for RankCorr, scGeneFit and the <italic>network</italic> and <italic>ensemble</italic> SMaSH modes evaluated on the ground-truth 7 broad cell types in the lung data are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). For both smaller and larger data-sets (e.g. Zeisel vs. broad lung) the two SMaSH modes perform similarly. We found that the default <italic>ensemble</italic> mode XGBoost model performs particularly well across all cases, and is in the top two best performing models in 5/6 data-sets, and notably in the case of the mouse brain data achieves sub-percent misclassification rates where the best recently-developed approach of RankCorr achieves an 8.6 <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M10"><mml:mo>%</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq5.gif"/></alternatives></inline-formula> average misclassification (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). The benchmarking of this default ensemble model against the others confirms it as the strongest ensemble performer across the majority of the data-sets (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C).<fig id="Fig2"><label>Fig. 2</label><caption><p>Classifying broad cell types based on SMaSH-specific marker genes. <bold>A</bold> Confusion matrices for the top 30 marker genes per cell type in the lung broad cell classification data-set for scGeneFit, RankCorr, SMaSH using the <italic>network</italic> mode, and SMaSH using the <italic>ensemble</italic> mode (using XGBoost). <bold>B</bold> Cell misclassification and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{1}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq6.gif"/></alternatives></inline-formula> scores for the two SMaSH modes against scGeneFit and RankCorr. <bold>C</bold> Benchmarking different SMaSH ensemble learning models across biological scRNA-seq data and related modalities</p></caption><graphic xlink:href="12859_2022_4860_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par16">The SMaSH implementation provides the most important marker genes for each class, based on their rank in Gini importance or Shapley value. As a concrete example, in the case of the broad mouse brain data this would correspond to unique markers per each of the 9 cell types. These cell types biologically map to astrocytes (Astro), microglia (Micro), endothelial cells (Endo), excitatory neurons (Ext), inhibitory neurons (Inh), neuroblasts (Nb), oligodendrocyte (Oligo), oligodendrocyte precursors (OPC), and a generic group of low quality cells (LowQ). These top three markers, ordered for each cell type based on their Shapley value computed by the <italic>network</italic> mode, are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The companion Shapley score plot illustrates the values of high ranking genes across several different classes. In most cases, SMaSH is able to identify key genes which are uniquely (or nearly uniquely) expressed in one particular cell type of interest relative to all others. The colour scale, corresponding to the mean logarithm of gene expression, is normalised to between 0 and 1.0, where dark brown indicates very high levels of gene expression. Three dark brown populations can be uniquely generated for each cell type, indicating that highly and uniquely expressed genetic markers are present. Such markers would be useful for exclusively tagging particular cell types in the design of protocols for single-cell spatial resolution of mRNA. This gives SMaSH an advantage over existing approach which, although also able to select marker genes, the SMaSH markers are more unique to specific cell types.<fig id="Fig3"><label>Fig. 3</label><caption><p>Marker genes for the broad mouse brain cell types. <bold>A</bold> The mean |Shapley value| for the top 30 ranked marker genes across all broad cell types of the mouse brain, before additional filtering and sorting, using SMaSH’s <italic>network</italic> mode. Different colours indicate the different class contributions which that particular gene explains. <bold>B</bold> the final three markers for each class/broad cell type are shown, with the colour profile corresponding to the mean logarithm of the gene expression and a pattern uniquely matching specific markers to specific cell types</p></caption><graphic xlink:href="12859_2022_4860_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>SMaSH identifies specific marker genes in more complex data-sets comprising many cell types and sub-types in lung cancer patients and mouse brain cells</title>
      <p id="Par17">One challenge in scRNA-seq gene identification is determining genes with the greatest statistical power for distinguishing increasingly complex and granular cell-type identifications. In the lung data-set each of the broad cell types can be further subclassified into several biologically distinct cell types. We repeated the misclassification calculation for 6 of the 7 broad lung cell types which can be further sub-divided, separately determining the top 30 markers for each of these 6 classification problems from the broad cell into its sub-types. We also evaluated this as a single classification problem, directly calculating the top 30 markers for classifying the entire lung data-set cells directly into their 34 lung cell sub-types. We evaluated SMaSH against existing approaches for identifying relevant markers, finding substantial reduction in misclassification rate compared to current methods. This was observed in both the ‘two-step’ approach of first classifying into the broad cell types, and then sub-classifying them, and the ‘one-step’ approach of directly classifying cells into the distinct 34 sub-types. We found that the misclassifcation rates for the ‘one-step’ problem were generally higher than the ‘two-step’ across all models. This is not unexpected given the added complexity of performing a 34-class problem directly and indicates that better marker gene extraction can be obtained by splitting the cell classification problem into two or more sub-problems. Moreover, we found that the largest gains in the ‘two-step’ problem are provided by either a more non-linear model, the deep neural network of our <italic>network</italic> mode, or XGBoost as our default model in the <italic>ensemble</italic> mode. These comparisons are summarised in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, where we also considered the same ‘one-step’ and ‘two-steps’ marker gene identification approach in the mouse brain data-set. Substantial performance improvements are observed with SMaSH.<fig id="Fig4"><label>Fig. 4</label><caption><p>Marker gene misclassification rates and <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{1}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq7.gif"/></alternatives></inline-formula> scores in cell types in the lung and mouse brain. Performance for each human lung cancer cell sub-type and framework, including the two modes in SMaSH. HLC: Human lung cancer; MB: Mouse brain</p></caption><graphic xlink:href="12859_2022_4860_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par18">We also observe that SMaSH is still able to identify important marker genes which distinguish individual cell sub-types even when they belong to the same broad classification, as demonstrated for e.g. the sub-types of the mouse brain Inhibitory neuron broad types in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. For this Figure, the markers are calculated using the <italic>network</italic> mode of SMaSH (C), which identifies more unique markers compared with the benchmarked approaches.<fig id="Fig5"><label>Fig. 5</label><caption><p>Marker genes for the mouse brain cell sub-types from the Inhibitory neuron broad types, and human foetal organ of origin classification. The mean logarithm of gene expression for mouse brain cell Inhibitory neuron cell sub-type markers. <bold>A</bold> the markers for scGeneFit; <bold>B</bold> the markers for RankCorr; <bold>C</bold> markers from SMaSH’s <italic>network</italic> mode. Particularly in the case of SMaSH unique patterns can still be identified in this highly granular cell-type identification problem, whereas approaches such as scGeneFit are not able to identify many markers which uniquely resolve the sub-types present. <bold>D</bold> SMaSH is able to select statistically significant markers for a highly imbalanced problem of distinguishing organs of origin in foetal scRNA-seq</p></caption><graphic xlink:href="12859_2022_4860_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>SMaSH generalises to non-cell-type-specific marker gene problems</title>
      <p id="Par19">In this section we demonstrate how SMaSH can be readily applied to very general marker gene identification problems in scRNA-seq. Thus far SMaSH has been implemented in problems for selecting marker genes to distinguish different cell types, which has obvious utility in spatial transcriptomics. However, this same procedure can be repeated in very general annotations and we illustrate this by taking a stratified sample of a publicly available foetal organ data-set [<xref ref-type="bibr" rid="CR21">21</xref>] and calculating marker genes which best distinguish three different organs of origin. These are kidney, liver, and skin, using those organs now as the relevant annotations for each cell. Inspite of the naturally imbalanced nature of such data, SMaSH is still able to identify statistically significant markers for specific organs. The markers identified uniquely (or nearly uniquely) describe the particular organ of interest versus the other two in the classification problem (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D). The misclassification rates are <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{1}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq8.gif"/></alternatives></inline-formula> scores are summarised across all four models considered in SMaSH (three different ensemble learners in the <italic>ensemble</italic> mode) in Table <xref rid="Tab2" ref-type="table">2</xref>, and the top two performing models are found to be the defaults for the SMaSH <italic>network</italic> and <italic>ensemble</italic> modes. The markers extracted from the top-scoring models were also confirmed to be highly relevant to the particular organ of interest following a cross-check of their function in relevant biological literature (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2). Once again, SMaSH outperformed the benchmarked linear methods.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Marker gene misclassification rates in organs of origin in early foetal development</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data-set</th><th align="left">scGeneFit</th><th align="left">RankCorr</th><th align="left">SMaSH (DNN)</th><th align="left">SMaSH (RF)</th><th align="left">SMaSH (BRF)</th><th align="left">SMaSH (XGBoost)</th></tr></thead><tbody><tr><td align="left">HFO skin versus kidney versus liver</td><td align="left">(13.9, 0.85)</td><td align="left">(5.2, 0.95)</td><td align="left">(1.1, 0.99)</td><td align="left">(1.4, 0.99)</td><td align="left">(1.8, 0.98)</td><td align="left">(1.2, 0.99)</td></tr></tbody></table><table-wrap-foot><p>Performance in early foetal organ data, including the four different models implemented in SMaSH. All metrics are summarised as (<italic>M</italic>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{1}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq9.gif"/></alternatives></inline-formula>) tuples. The top 2 performing models are indicated in bold for each data-set</p><p><italic>HFO</italic> Human foetal organs</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Discussion</title>
    <p id="Par20">The SMaSH framework is a new methodology for determining marker genes from large scRNA-seq data-sets, for both general and more specific user-defined cell annotations (e.g a few broad cell types vs. many cell sub-types). SMaSH has been designed as a specific software package for users involved in complementary scRNA-seq and STx biological analyses, using the data from the former to determine optimal genes for better performing analyses in the latter. Knowledge of annotations is essential to the running of the algorithm.</p>
    <p id="Par21">We find that SMaSH produces unique markers which better classify data-sets of a variety of sizes and complexities. SMaSH yields markers which, when used to reconstruct the original annotations in each data-set, possess consistently lower misclassification rates. This uniqueness applies to data-sets of varying granularity, as demonstrated by running SMaSH on separate human lung and mouse brain data-set in two modes. These are ‘broad’ cell classification of 7 different types for lung and 9 for mouse brain, and cell sub-types from each broad cluster leading to 34 distinct classifications of the lung cells and 31 distinct classifications for the mouse brain cells. Markers are ranked based on explainability parameters which capture the information gain which each gene adds to the supervised model. In particular, we observe that ranking marker genes based on Shapley values is effective for revealing the most explainable features in the neural network model, and note that this measure has yet to be explored in detail in applications of machine learning to problems in computational biology and transcriptomics. In addition to benchmarking SMaSH across several different single-cell sequencing data-sets, we also explicitly evaluated the performance of the mouse brain markers on corresponding mouse brain 10X Visium (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We find that SMaSH is able to predict marker genes which capture the tissue behaviour of highly proliferating cells (such as astrocytes, present in both grey and white matter), and which also identify cell types which are known to be highly-localised to tissue compartments of the brain, such as identifying a highly localised compartment rich in endothelial cells close to the lateral ventricle around the hippocampus, and the precise reconstruction of a central tissue region rich in oligodendrocytes. Put together, we have therefore demonstrated that robust and interesting biological statements can be made using STx data in conjunction with the calculated SMaSH markers.</p>
    <p id="Par22">From the user perspective, we encourage broad investgation of the different models implemented in SMaSH. Based on the studies in this paper, we recommend using the feedforward neural network in the first instance, cross-checking the results with the XGBoost model, which for certain data-sets was observed to offer comparable or improved classification and marker gene identification.</p>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p id="Par23">We have developed and presented SMaSH, a novel method for calculating marker genes in scRNA-seq data. We used non-linear methods as captured by two user-specified <italic>network</italic> and <italic>ensemble</italic> modes.SMaSH is available as a fully-integrated algorithm with ScanPy, making use of the AnnData object structure, common to many ‘big data’ analysis pipelines in single-cell computational biology. SMaSH has relevance for testing and confirming the presence of specific cell types in sequencing data, based on speculative annotations derived by the analyser, and also can be rolled out to assist in the design of downstream analyses and experiments. A notable application of this latter purpose is spatial transcriptomics, e.g. in situ sequencing, where 100–200 marker genes may be required for designing padlock probes. We summarise the SMaSH framework in a publicly-accessible webpage (see pypi), including self-contained notebooks where interested users can see example implementations for several data-sets mentioned in this paper (see GitLab repository). We recommend SMaSH as a standard component to a downstream analysis pipeline of scRNA-seq data where key genes must be extracted. Particularly users should bear applications to spatial transcriptomics or related techniques in mind. We hope that SMaSH serves as a welcome software simplification to the community, providing a natural extension to existing scRNA-seq bioinformatics pipelines.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <p id="Par24">The SMaSH framework (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is divided into four stages, beginning from the user-defined input AnnData [<xref ref-type="bibr" rid="CR9">9</xref>] object which contains the raw scRNA-seq counts in a matrix of dimensionality determined by the number of barcoded cells and unique genes in the data-set. The user must also provide a vector of target outputs to map each barcoded cell onto, with values corresponding to classes of the problem in question, e.g. a vector of annotations of each barcoded cell into a particular biological type. We stress that the choice of annotations is user-specific and highly-dependent on the problem of interest: SMaSH will work with any set of biologically-motivated annotations for gene calculation, although in this paper we will mainly focus on cell type annotations known <italic>a priori</italic> by the user, as this question is most appropriate for the downstream application of spatial analysis. SMaSH then extracts markers by analysing the counts and targets in a supervised machine learning classification task, where the most important markers map to the most important features for classifying cells according to the user’s required target annotations, and selects the most important genes for describing each class based on feature ranking with information-theoretic metrics.</p>
    <sec id="Sec9">
      <title>SMaSH algorithm</title>
      <sec id="Sec10">
        <title>SMaSH filtering step 1: gene filter</title>
        <p id="Par25">The input cell-gene counts are first optionally batch-corrected using Harmony [<xref ref-type="bibr" rid="CR23">23</xref>], and general genes connected to mitochondrial activity [<xref ref-type="bibr" rid="CR24">24</xref>], ribosomal biogenesis [<xref ref-type="bibr" rid="CR25">25</xref>], cell-surface protein regulation of the immune system, and biological housekeeping are removed. Genes which are lowly and highly expressed are further filtered out, so that only those which are expressed in greater than 30% of the classes of interest and in less than 75% of cells with more than 50% of the classes of interest are retained by default. This final filter guards against additional batch-specific effects, such as a particular gene not being expressed uniformly across most various different independent biological samples comprising the data-set of interest. The 30% and 75% thresholds are based on empirical checks to ensure that genes which are expressed in the classes of interest are retained, and may be modified by the user.</p>
      </sec>
      <sec id="Sec11">
        <title>SMaSH filtering step 2: inverse PCA</title>
        <p id="Par26">The filtered matrix of cells and genes is then dimensionally-reduced using principal component analysis (PCA) [<xref ref-type="bibr" rid="CR26">26</xref>] applied to each gene as a unique feature and each cell as an observation. The PCA is then inverted and the top 20 genes in each principal component explaining up to 80% of the overall variance in the data are retained. This additional feature guards against genes which would add very little extra information about the variance of expression profiles in the data and speeds up subsequent training of the model.</p>
      </sec>
      <sec id="Sec12">
        <title>Main SMaSH model</title>
        <p id="Par27">The remaining genes are then ranked according to one of our machine learning classification modes: <italic>ensemble</italic> (RF, BRF, and XGBoost [<xref ref-type="bibr" rid="CR12">12</xref>] as the default) and <italic>network</italic>. Details of the cross-validation on training, validation, and test sets are described in <italic>Machine Learning Cross-validation</italic>. Further details and additional benchmarking are provided in the Additional file (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 and Table S3).</p>
      </sec>
      <sec id="Sec13">
        <title>SMaSH post-modelling: ranking and heterogeneity</title>
        <p id="Par28">The final marker genes are calculated by ranking and sorting the genes according to their total Gini importance or mean Shapley value, where the mean Shapley value is used in the <italic>network</italic> mode. A set of relevant markers is produced for each class provided by the user from the initial vector of targets, where the top 5 markers per class are produced by default. A final heterogeneity check is conducted in the case that multiple samples are considered in the analysis, to make sure that the marker genes selected are also distributed uniformly in at least 70% of the set of samples considered in the data. For this latter check the user must ensure that sample information is provided as an observation in the original AnnData object.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Benchmarking SMaSH</title>
      <p id="Par29">For each SMaSH model, linear model for benchmarking, and data-set, the top 30 markers are calculated for each annotation class then used as the only features in a <italic>k</italic>-nearest neighbours classifier for mapping each cell back to its original annotation. Support vector machine classifiers was used as an independent cross-check of the <italic>k</italic>-nearest neighbours performance, and these results are summarised in the Additional file. The misclassification rates, <italic>M</italic>, and associated confusion matrices for recovering the original ground-truth annotations were evaluated on each data-set and model. The average <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{1}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq10.gif"/></alternatives></inline-formula> score was also calculated as the average harmonic mean of the precision and recall for each cell type classification, which is a more indicative performance metric for multi-classification problems than the more widely-known true-positive and false-negative rates. Note that we separately evaluated all metrics for each separate class, as well as computing the average value across all classes. These performance metrics may be formally defined as:<disp-formula id="Equ1"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} M = \Bigg \langle 1 - \frac{C_{i}}{P_{i}} \Bigg \rangle _{i \in {\mathcal {C}}} \end{aligned}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">〈</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">〉</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4860_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ2"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F_{1} = \Bigg \langle \frac{2}{\frac{1}{\mathcal {R}} + \frac{1}{\mathcal {P}}} \Bigg \rangle _{i \in {\mathcal {C}}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">〈</mml:mo></mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="script">R</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="script">P</mml:mi></mml:mfrac></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">〉</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4860_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{i}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq12.gif"/></alternatives></inline-formula> denote the number of correct predictions and total predictions of class <italic>i</italic> from the <italic>k</italic>-nearest neighbours classifier respectively, <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {P}_{i}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq14.gif"/></alternatives></inline-formula> are the respective recall and precision of that classification, and the <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\langle \rangle _{i \in {\mathcal {C}}}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq15.gif"/></alternatives></inline-formula> denotes averaging over all classes <italic>i</italic> belonging to the set of annotations <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {C}$$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">C</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq16.gif"/></alternatives></inline-formula> provided by the user. Lower misclassification rates (tending to 0) and higher average <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq17.gif"/></alternatives></inline-formula> scores (tending to 1) indicate better performance of a given model.</p>
    </sec>
    <sec id="Sec15">
      <title>Machine learning cross-validation</title>
      <p id="Par30">SMaSH makes use of test, train, and validation sets. All machine learning studies described in this paper (the training and testing of the SMaSH models, and the <italic>k</italic>-nearest neighbours and support vector machine classification of the SMaSH markers) were validated in the following way: each data-set was divided in to a 80:20 train:test split. Training was only performed on the training data-set. The training data-set was cross-validated by constructing additional validation sets using the <italic>k</italic>-fold validation approach, where 5 folds were used (i.e. we independently evaluated performance metrics in a 80:20 training:validation split of the initial training data, permuted across the 5 batches with resampling). This <italic>k</italic>-fold cross-validation was done in a stratified manner, to ensure that fair representations of each class were selected in every training and validation set. The cross-validated loss functions and accuracies then allowed for overfitting to be checked against (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 for an example of this in the training of the SMaSH DNN on mouse brain data). Additional checks for overfitting were performed for different models: applying dropout to the neural network, regularisation with kernel functions to the support vector machine, and early stopping in the neural network training. The support vector machine classifier acted as an additional cross-check of the <italic>k</italic>-nearest neighbours classifier when studying the optimal SMaSH genes to the genes calculated by other methods, and the results are reported in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4860_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Material for SMaSH: A scalable, general marker gene identification framework for single-cell RNA-sequencing.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>M. E. Nelson and S. G. Riva contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors wish to acknowledge Elisa Panda, Brynelle Myers, and Jiarui Xu for many helpful discussions on the biological interpretation of marker genes and its relevance to spatial transcriptomics, and Moritz Gerstung for advice on the preparation of the final manuscript and reviews of earlier drafts. MEN acknowledges the support he receives from the Clare Hall, Cambridge Research Fellowship in the Sciences scheme.</p>
    <sec id="FPar4">
      <title>Additional information on lung cancer data-set</title>
      <p id="Par31">This data-set is based on lung tumour and non-tumourigenic tissues (background) collected from matched patients. Healthy tissues were also collected from deceased donors. The resulting cell suspensions were submitted for 3’ single cell RNA sequencing using Single Cell G Chip Kit, chemistry v3.1 (10X Genomics Pleasanton, CA, USA), following the manufacturer’s instructions. Libraries were sequenced on an Illumina NovaSeq S4, and mapped to the GRCh38 human reference genome using the Cell Ranger toolkit (version 3.0.0). Downstream scRNA-seq analysis was then performed following the protocols implemented in the ScanPy workflow, with the final annotations determined manually and visualised using the Uniform Manifold Approximation and Projection (UMAP) [<xref ref-type="bibr" rid="CR22">22</xref>] space built from a neighbourhood graph applied to the top 15 principal components of the underlying gene space, and clustered using the Leiden algorithm based on graphical neighbourhoods.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>MEN devised and led the study, wrote the manuscript, and assisted in code development and supervision of SGR. SGR developed the code framework, and conducted the tests and benchmarking of the models, and generation of figures. AC supervised SGR, and reviewed the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. The work was supported by European Research Council Project 677501—ZF_Blood (to AC) and a core support Grant from the Wellcome Trust and MRC to the Wellcome Trust—Medical Research Council Cambridge Stem Cell Institute. MEN, SGR, and AC are further supported through the Open Targets Project Grants OTAR2060/OTAR2070.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>We considered several publicly-available data-sets in this study: the Zeisel [<xref ref-type="bibr" rid="CR18">18</xref>] data covering a small population of mouse brain cells, a data-set based on CITE-seq technology [<xref ref-type="bibr" rid="CR19">19</xref>], a mouse brain single-nucleus RNA-sequenced data-set [<xref ref-type="bibr" rid="CR17">17</xref>], a healthy foetal liver data-set [<xref ref-type="bibr" rid="CR21">21</xref>], and Paul15 stem cell data [<xref ref-type="bibr" rid="CR20">20</xref>]. We also considered an extension of the foetal liver data-set covering skin and kidney cells which is again available at [<xref ref-type="bibr" rid="CR21">21</xref>]. These data-sets were modified from their originals to include the cell type annotations in a single AnnData object, for use directly with the tutorials to accompany the release of SMaSH. These modified data-sets are available on a self-contained MEGA cloud here. The 10X Visium mouse brain data was obtained from the complementary single-nucleus RNA-sequenced data, where the Space Ranger toolkit was used to store the final Visium spots and genes expression profile and perform the genome alignment, and all spatial images of the brain were publicly available from the same result [<xref ref-type="bibr" rid="CR17">17</xref>]. The final Visium data is available through relevant S3 buckets here. The runtime and memory allocation performance of SMaSH with these different data-sets was performed with the following CPU and RAM requirements—RAM: 32 GB 2133 MT/s DDR4; CPU: Intel(R) Xeon(R) CPU E7-8891 v3 at 2.80 GHz. The complete SMaSH implementation, including several full examples of how to use SMaSH and reproduce the results in the paper are available under the Cvejic group GitLab: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/cvejic-group/smash">https://gitlab.com/cvejic-group/smash</ext-link><ext-link ext-link-type="uri" xlink:href="https://gitlab.com/cvejic-group/smash">https://gitlab.com/cvejic-group/smash</ext-link>. SMaSH is available under PyPI as the smashpy package (pip install smashpy), named to distinguish it from similarly-named existing packages.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par32">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par33">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par34">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>
        <source>Genome Med</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>75</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-017-0467-4</pub-id>
        <pub-id pub-id-type="pmid">28821273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>96</fpage>
        <pub-id pub-id-type="doi">10.1038/s12276-018-0071-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lubeck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Coskun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhiyentayev</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell in situ RNA profiling by sequential hybridization</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>360</fpage>
        <lpage>361</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2892</pub-id>
        <pub-id pub-id-type="pmid">24681720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pacureanu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In situ sequencing for RNA analysis in preserved tissue and cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>857</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2563</pub-id>
        <pub-id pub-id-type="pmid">23852452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kok Hao</surname>
            <given-names>Chen</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatially resolved, highly multiplexed RNA profiling in single cells</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>384</volume>
        <fpage>6223</fpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dumitrascu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Villar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mixon</surname>
            <given-names>DG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimal marker gene selection for cell type discrimination in single cell analyses</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1186</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21453-4</pub-id>
        <pub-id pub-id-type="pmid">33608535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vargo</surname>
            <given-names>AHS</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>A rank-based marker selection method for high throughput scRNA-seq data</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>477</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03641-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multilayer feedforward networks are universal approximators</article-title>
        <source>Neural Netw</source>
        <year>1989</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>366</lpage>
        <pub-id pub-id-type="doi">10.1016/0893-6080(89)90020-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach Learn</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Chen C, Liaw A, Breiman L. Using Random Forest to Learn Imbalanced Data. University of California, Berkeley Technical Report; 2004, vol. 110, no. 1–12, p. 24.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Chen T, Guestrin C, XGBoost: a scalable tree boosting system. In: KDD ’16 proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining; 2016, pp. 785–794.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Georgevici</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Terblanche</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Neural networks and deep learning: a brief introduction</article-title>
        <source>Intensive Care Med</source>
        <year>2019</year>
        <volume>45</volume>
        <fpage>712</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1007/s00134-019-05537-w</pub-id>
        <pub-id pub-id-type="pmid">30725133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidhuber</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Deep learning in neural networks: an overview</article-title>
        <source>Neural Netw</source>
        <year>2015</year>
        <volume>61</volume>
        <fpage>85</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neunet.2014.09.003</pub-id>
        <pub-id pub-id-type="pmid">25462637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Classification and regression trees</source>
        <year>1984</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>CRC Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Shapley LS. Notes on the <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M40"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq20.gif"/></alternatives></inline-formula>-person game—II: the value of an <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M42"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4860_Article_IEq21.gif"/></alternatives></inline-formula>-person game. Santa Monica: RAND Corporation; 1951, RM-670.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Kleshchevnikov V, et al., Comprehensive mapping of tissue cell architecture via integrated single cell and spatial transcriptomics. bioRxiv preprint 2020.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>6226</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>865</fpage>
        <lpage>868</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id>
        <pub-id pub-id-type="pmid">28759029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popescu</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Botting</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Decoding human fetal liver haematopoiesis</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>574</volume>
        <fpage>365</fpage>
        <lpage>371</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1652-y</pub-id>
        <pub-id pub-id-type="pmid">31597962</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">McInnes L, Healy J, Melville J. UMAP: uniform manifold approximation and projection for dimension reduction. 2018. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1802:03426">arXiv:1802:03426</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with harmony</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iborra</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>PR</given-names>
          </name>
        </person-group>
        <article-title>The functional organization of mitochondrial genomes in human cells</article-title>
        <source>BMC Biol</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-2-9</pub-id>
        <pub-id pub-id-type="pmid">15157274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ferreira-Cerca</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hurt</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Eukaryotic ribosome biogenesis at a glance</article-title>
        <source>J Cell Sci</source>
        <year>2013</year>
        <volume>126</volume>
        <fpage>4815</fpage>
        <lpage>4821</lpage>
        <pub-id pub-id-type="doi">10.1242/jcs.111948</pub-id>
        <pub-id pub-id-type="pmid">24172536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jolliffe</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Cadima</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Principal component analysis: a review and recent developments</article-title>
        <source>Philos Trans R Soc A</source>
        <year>2016</year>
        <volume>374</volume>
        <fpage>20150202</fpage>
        <pub-id pub-id-type="doi">10.1098/rsta.2015.0202</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
