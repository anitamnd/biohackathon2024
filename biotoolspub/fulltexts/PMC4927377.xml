<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4927377</article-id>
    <article-id pub-id-type="pmid">27214047</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.3869</article-id>
    <article-id pub-id-type="manuscript">nihpa782534</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DADA2: High resolution sample inference from Illumina amplicon data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Callahan</surname>
          <given-names>Benjamin J</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McMurdie</surname>
          <given-names>Paul J</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rosen</surname>
          <given-names>Michael J</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Andrew W</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Johnson</surname>
          <given-names>Amy Jo A</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Holmes</surname>
          <given-names>Susan P</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Statistics, Stanford University, Stanford, CA, USA</aff>
    <aff id="A2"><label>2</label>Second Genome, South San Francisco, CA, USA</aff>
    <aff id="A3"><label>3</label>Department of Applied Physics, Stanford University, Stanford, CA, USA</aff>
    <author-notes>
      <corresp id="cor1"><label>*</label>Corresponding Author: <email>benjamin.j.callahan@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>1</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <volume>13</volume>
    <issue>7</issue>
    <fpage>581</fpage>
    <lpage>583</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.3869-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">We present DADA2, a software package that models and corrects Illumina-sequenced amplicon errors. DADA2 infers sample sequences exactly, without coarse-graining into OTUs, and resolves differences of as little as one nucleotide. In several mock communities DADA2 identified more real variants and output fewer spurious sequences than other methods. We applied DADA2 to vaginal samples from a cohort of pregnant women, revealing a diversity of previously undetected <italic>Lactobacillus crispatus</italic> variants.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P2">The importance of microbial communities to human and environmental health has motivated methods for their efficient characterization. The most common and cost-effective method is the amplification and sequencing of targeted genetic elements<sup><xref rid="R1" ref-type="bibr">1</xref></sup>. Amplicon sequencing of taxonomic marker genes such as the 16S rRNA gene in bacteria, the ITS region in fungi, and the 18S rRNA gene in eukaryotes, provides a census of a community. Functional diversity can be probed by targeting functional genes<sup><xref rid="R2" ref-type="bibr">2</xref></sup>.</p>
  <p id="P3">Disentangling biological variation from amplicon sequencing errors presents unique challenges, which prompted the development of amplicon-specific error-correction methods<sup><xref rid="R3" ref-type="bibr">3</xref>,<xref rid="R4" ref-type="bibr">4</xref>,<xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup>. Most of these methods were designed for 454 pyrosequencing, and are not applicable to Illumina sequencing.</p>
  <p id="P4">Errors in Illumina-sequenced amplicon data are currently addressed by quality filtering and the construction of Operational Taxonomic Units (OTUs): clusters of sequences that differ by less than a fixed dissimilarity threshold<sup><xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref>,<xref rid="R9" ref-type="bibr">9</xref></sup> (typically 3%). Lumping together similar sequences reduces the rate at which errors are misinterpreted as biological variation (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>), but OTUs under-utilize the quality of modern sequencing by precluding the possibility of resolving fine-scale variation<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R12" ref-type="bibr">12</xref></sup>. Fine-scale variation can be informative about ecological niches<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, temporal dynamics<sup><xref rid="R12" ref-type="bibr">12</xref></sup>, and population structure<sup><xref rid="R2" ref-type="bibr">2</xref></sup>. Fine-scale variation differentiates pathogenic from commensal strains in some cases<sup><xref rid="R13" ref-type="bibr">13</xref>,<xref rid="R14" ref-type="bibr">14</xref></sup>, and can contain clinically relevant information for more complex microbiome-associated diseases<sup><xref rid="R15" ref-type="bibr">15</xref></sup>.</p>
  <p id="P5">The Divisive Amplicon Denoising Algorithm (DADA) introduced a model-based approach for correcting amplicon errors without constructing OTUs<sup><xref rid="R5" ref-type="bibr">5</xref></sup>. DADA identified fine-scale variation in 454-sequenced amplicon data while outputting few false positives<sup><xref rid="R2" ref-type="bibr">2</xref>,<xref rid="R5" ref-type="bibr">5</xref></sup>.</p>
  <p id="P6">Here we present DADA2, an open-source R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/benjjneb/dada2">https://github.com/benjjneb/dada2</ext-link>) that extends and improves the DADA algorithm. DADA2 implements a new quality-aware model of Illumina amplicon errors. Sample composition is inferred by dividing amplicon reads into partitions consistent with the error model (Methods). DADA2 is reference-free, and applicable to any genetic locus. The DADA2 R package implements the full amplicon workflow: filtering, dereplication, chimera identification, and merging paired-end reads.</p>
  <p id="P7">We compared DADA2 to four algorithms (Methods): UPARSE, an OTU construction algorithm with the best published false-positive results<sup><xref rid="R9" ref-type="bibr">9</xref></sup>; MED, an algorithm with the best published fine-scale resolution in Illumina amplicon data<sup><xref rid="R11" ref-type="bibr">11</xref></sup>; and the popular mothur (average linkage) and QIIME (uclust) OTU methods<sup><xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref></sup>.</p>
  <p id="P8">We benchmarked these algorithms on three mock community datasets: Balanced, HMP and Extreme (Methods, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>), each sequenced at a depth of over 500,000 highly overlapping paired-end Illumina MiSeq 2×250 reads. The Balanced community contained 57 bacteria and archaea at nominally equal frequencies<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. The HMP community contained 21 bacteria at nominally equal frequencies<sup><xref rid="R17" ref-type="bibr">17</xref></sup>. The Extreme community contained 27 bacterial strains at frequencies spanning five orders of magnitude and differing over the sequenced region by as little as one nucleotide (Methods, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). Sequence quality varied: Balanced was higher (Mean Q = 35.9 forward/33.5 reverse), Extreme moderate (33.0/29.3), and HMP lower (32.3/28.7).</p>
  <p id="P9">We compared output sequences to the known reference sequences present in the reference strains making up these communities. Output sequences that exactly matched a reference sequence were classified as Reference, and those differing by one mismatch or gap were classified as One Off. Contaminants were identified in the yet unclassified sequences by BLASTing against nt (Methods). Sequences with an exact BLAST hit (100% identity, 100% coverage) were classified as Exact, and those with best hits containing one mismatch or gap as One Off. Everything else was classified as Other. We evaluated sensitivity by detection of the reference strains. Note that fine-scale variation was present in all mock communities, as some reference strains contained multiple distinguishable 16S rRNA sequence variants.</p>
  <p id="P10">We compared the sample sequences output by DADA2 to the output of UPARSE (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Almost all variants with Hamming separation greater than UPARSE's OTU radius (3%, dashed line) were identified by both algorithms (black). However, DADA2 identified fine-scale variation that UPARSE did not (blue), in both the merged reads (<xref ref-type="fig" rid="F1">Fig. 1</xref>) and the forward reads alone (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2–7</xref>). DADA2 accurately resolved sequence variants differing by a single nucleotide and present in as few as two reads.</p>
  <p id="P11">DADA2 identified more reference sequences and as many or more reference strains than UPARSE in every dataset, using merged or forward reads (<xref ref-type="table" rid="T1">Table 1</xref>). DADA2 identified every reference strain in the Balanced and HMP datasets; the Extreme reference strains it missed demonstrate its limits (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref>). DADA2 output fewer spurious sequences (Other and One Off) than UPARSE in every dataset (<xref ref-type="table" rid="T1">Table 1</xref>).</p>
  <p id="P12">Minimum Entropy Decomposition (MED) is a method to distinguish fine-scale diversity in amplicon data<sup><xref rid="R11" ref-type="bibr">11</xref></sup>. Like DADA2, MED divides amplicon reads into partitions within which variation is supposed to be artefactual. MED effectively uses a single-site minor-allele-frequency threshold to distinguish real variation, and prevents false positives with a minimum abundance threshold. Thus while MED identified fine-scale variation, it output more false positives and couldn’t detect rare variants (<xref ref-type="table" rid="T1">Table 1</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2–7</xref>).</p>
  <p id="P13">Mothur and QIIME output significantly more spurious sequences than the other methods, although this deficiency was reduced when merging reads (<xref ref-type="table" rid="T1">Table 1</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2–7</xref>). UPARSE was the most accurate OTU method tested by all measures save the number of reference strains identified in the merged Extreme dataset. The spurious output of mothur and QIIME included chimeric and non-chimeric errors (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 3</xref>).</p>
  <p id="P14">The residual error rates in the output of DADA2 were very low. For the Balanced dataset, DADA2's residual error rate of 2.46 × 10<sup>−8</sup> (forward) and 2.53 × 10<sup>−8</sup> (merged), compares favorably to the best error rates of 5.9 × 10<sup>−3</sup> and 5.0 × 10<sup>−4</sup> previously reported<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. For the HMP dataset, DADA2's residual error rate of 1.66 × 10<sup>−5</sup> (forward) and 2.74 × 10<sup>−6</sup> (merged) compares favorably to the previously reported error rates of 9.2 × 10<sup>−4</sup> and 4.6 × 10<sup>−4</sup> in [<xref rid="R18" ref-type="bibr">18</xref>], and 2 × 10<sup>−4</sup> (merged) in [<xref rid="R17" ref-type="bibr">17</xref>]. DADA2 discarded relatively few reads compared to the other methods (<xref ref-type="table" rid="T1">Table 1</xref>).</p>
  <p id="P15">DADA2’s core denoising algorithm was slower but comparable to UPARSE, and DADA2 easily processed Illumina samples on a laptop. For the filtered Balanced forward reads (33,516 unique sequences) UPARSE ran in 9s, QIIME/uclust in 17s, DADA2 in 21s, mothur in 2m26s and MED in 2m34s on a 2013 MacBook Pro (Methods).</p>
  <p id="P16">We further evaluated DADA2 on two longitudinal, Illumina-sequenced datasets: 142 vaginal samples from 42 pregnant women<sup><xref rid="R19" ref-type="bibr">19</xref></sup>, and 360 mouse fecal samples<sup><xref rid="R17" ref-type="bibr">17</xref></sup>.</p>
  <p id="P17">The vagina is the least diverse human body habitat<sup><xref rid="R1" ref-type="bibr">1</xref></sup>, often dominated by a single Lactobacillus OTU<sup><xref rid="R20" ref-type="bibr">20</xref></sup>. <italic>Lactobacillus crispatus</italic> is the most common species, and <italic>L. crispatus</italic> dominated communities have been associated with good health and stability<sup><xref rid="R20" ref-type="bibr">20</xref></sup>. DADA2 revealed that <italic>L. crispatus</italic> communities are more complex than generally recognized: six distinct <italic>L. crispatus</italic> sequence variants were present in multiple samples and substantial abundance (<xref ref-type="fig" rid="F2">Fig. 2a</xref>). This variation is imperceptible to OTU methods, as these variants differ by just 1–2 nucleotides over the sequenced region.</p>
  <p id="P18">The joint distribution of <italic>L. crispatus</italic> variants strongly suggests they represent multiple bacterial strains. The distribution of sequence variants was stable over time, but differed substantially between women, and distinct ecological relationships appear to exist between variants. L1 and L2 showed a pattern of mutual exclusion consistent with competition for a common niche (<xref ref-type="fig" rid="F2">Fig. 2b</xref>). L1 and L3 showed a pattern more consistent with an absence of direct competition (<xref ref-type="fig" rid="F2">Fig. 2c</xref>): The frequency of L1 was independent of the frequency of L3, which strongly tended towards 20%.</p>
  <p id="P19">The fecal community is more diverse than the vaginal community or mock communities, which could present different bioinformatic challenges. When applied to the mouse fecal dataset, DADA2 output 389 sequences and UPARSE 327 OTUs, of which 257 were shared. Output sequences were BLASTed against nt: 247/257 of the shared sequences, 123/132 of the DADA2-only sequences, and 26/70 of the UPARSE-only sequences were Exact matches. DADA2-only sequences were typically close to other sample sequences: the median Hamming distance of DADA2-only sequences to a more abundant output sequence was 2, for shared sequences it was 15. Sample richness was highly correlated between the methods (Pearson correlation = 0.99), but DADA2 identified more variants (mean ratio = 1.21). These results are consistent with the mock community benchmarking: DADA2 identified more biological variants, especially within UPARSE's OTU radius, while outputting fewer spurious sequences.</p>
  <p id="P20">These comparisons show that DADA2 is more accurate than other methods. DADA2 resolves fine-scale variation better than the current best method for that task, while outputting fewer incorrect sequences than the most robust OTU method. The precision of DADA2 improves downstream measures of diversity and dissimilarity, and potentially allows amplicon methods to probe strain-level variation.</p>
  <p id="P21">The output of DADA2 can be clustered into OTUs, but that often eliminates biological information present in the data. OTUs are not species, and their construction is not necessitated by amplicon errors. DADA2 enhances the study of microbial communities by allowing researchers to accurately reconstruct amplicon-sequenced communities at the highest resolution.</p>
  <sec sec-type="methods" id="S1">
    <title>Online Methods</title>
    <sec id="S2">
      <title>The Divisive Amplicon Denoising Algorithm</title>
      <p id="P22">The core denoising algorithm in the DADA2 R package is built on a model of the errors in Illumina-sequenced amplicon reads. This error model quantifies the rate <bold>λ<sub>ji</sub></bold> at which an amplicon read with sequence <bold>i</bold> is produced from sample sequence <bold>j</bold> as a function of sequence composition and quality. A Poisson model for the number of repeated observations of the sequence <bold>i</bold>, parameterized by the rate <bold>λ<sub>ji</sub></bold>, is then used to calculate the p-value of the null hypothesis that the number of amplicon reads (the abundance) of sequence <bold>i</bold> is consistent with the error model. These p-values are used as the division criteria for an iterative partitioning algorithm, which continues dividing sequencing reads until all partitions are consistent with being produced from their central sequence<sup><xref rid="R5" ref-type="bibr">5</xref></sup>. We now describe each of these steps in detail.</p>
      <sec id="S3">
        <title>Sequence comparison</title>
        <p id="P23">Pairwise sequence alignments are performed by a vectorized implementation of the Needleman-Wunsch algorithm with ends-free gapping. As alignment dominates the computational costs of the algorithm, two heuristics are enabled by default. The first heuristic is the use of a kmer-distance screen prior to alignment. If the kmer-distance between <bold>i</bold> and <bold>j</bold> exceeds a user-settable parameter (<monospace>KDIST_CUTOFF</monospace>), no alignment is performed<sup><xref rid="R21" ref-type="bibr">21</xref></sup>. The default value of this parameter was chosen to exclude only pairs of reads with &gt;10% nucleotide mismatch. The second heuristic is banded alignment, which forgoes calculation of potential alignments in which the net number of gaps of one sequence relative to the other exceeds a user-settable parameter (<monospace>BAND_SIZE</monospace>). The default value of this parameter was chosen to minimally impact the alignment of sequences with few indels, such as ribosomal RNA genes. Both heuristics can be disabled by the user, and the default values should be re-examined if the algorithm is applied to genetic regions with significantly different characteristics, such as the indel-rich ITS region.</p>
      </sec>
      <sec id="S4">
        <title>Error model</title>
        <p id="P24">DADA2 models errors as occurring independently within a read, and independently between reads. Under this model, the rate at which an amplicon read with sequence <bold>i</bold> is produced from sample sequence <bold>j</bold> is reduced to the product over the transition probabilities between the <bold>L</bold> aligned nucleotides:
<disp-formula id="FD1"><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>→</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
The transition probability between aligned nucleotides is allowed to depend on the original nucleotide, substituting nucleotide, and associated quality score, e.g. p(A→C, 35).</p>
        <p id="P25">After sequence alignment, the error rate <bold>λ<sub>ji</sub></bold> is calculated and stored. If sequences <bold>i</bold> and <bold>j</bold> were not aligned because they exceeded the kmer-distance cutoff <bold>λ<sub>ji</sub></bold> is set to 0.</p>
      </sec>
      <sec id="S5">
        <title>The abundance p-value</title>
        <p id="P26">The abundance p-value quantifies the notion that sequence <bold>i</bold> is too abundant for it to be explained by errors in amplicon sequencing. If sequencing errors are independent across reads, the number of amplicon reads with sequence <bold>i</bold> that will be produced from sample sequence <bold>j</bold> is Poisson distributed with expectation equal to an error rate <bold>λ<sub>ji</sub></bold> multiplied by the expected reads of sample sequence <bold>j</bold>. Let unique sequence <bold>i</bold> with abundance <bold>a<sub>i</sub></bold> be in partition <bold>j</bold> containing <bold>n<sub>j</sub></bold> reads. Then, conditional on <bold>i</bold> being read at least once, the abundance p-value is the probability of seeing that many or more identical reads (<bold>ρ<sub>pois</sub></bold> is the Poisson density function):
<disp-formula id="FD2"><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>→</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mtext mathvariant="italic">pois</mml:mtext></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:msub><mml:mi>ρ</mml:mi><mml:mtext mathvariant="italic">pois</mml:mtext></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
A low <bold>p<sub>A</sub></bold> indicates that there are more reads of sequence <bold>i</bold> than can be explained by errors introduced during the amplification and sequencing of <bold>n<sub>j</sub></bold> copies of sample sequence <bold>j</bold>.</p>
        <p id="P27">Note that the abundance p-value is calculated conditional on at least one sequence being observed. As a result, all singleton sequences have an abundance p-value of 1, and are never judged inconsistent with the error model. This means that singletons cannot form their own partitions, and DADA2 will not infer singleton sequences. The effect of this is similar in practice to the UPARSE developer's recommendation to remove singleton sequences prior to picking OTUs, and in both cases is driven by the difficulty in robustly differentiating singleton errors from real singleton sequences.</p>
      </sec>
      <sec id="S6">
        <title>The divisive partitioning algorithm</title>
        <p id="P28">First, amplicon reads with the same sequence are grouped into unique sequences with an associated abundance and consensus quality profile (or dereplicated). The divisive partition algorithm is initialized by placing all unique sequences into a single partition, and assigning the most abundant sequence as the center of that partition. All unique sequences are then compared to the center of their partition, error rates are calculated and stored, and the abundance p-value is calculated for each unique sequence. If the smallest p-value, after bonferroni correction, falls below the user-settable threshold <monospace>OMEGA_A</monospace>, a new partition is formed with the unique sequence with the smallest p-value as its center, and all unique sequences are compared to the center of that new partition.</p>
        <p id="P29">After a new partition is formed, every unique sequence is allowed to join the partition most likely to have produced it (i.e. that produces the highest expected number of that unique sequence). At that point the division procedure iterates, with each iteration consisting of identifying the unique sequence with the smallest p-value, forming a new partition with that sequence as its center, and reshuffling sequences to their most likely partition.</p>
        <p id="P30">Division continues until all abundance p-values are greater than <monospace>OMEGA_A</monospace>, i.e. all unique sequences are consistent with being produced by amplicon sequencing the center of their partition. The inferred composition of the sample is then the set of central sequences and the corresponding total abundances of those partitions (alternatively: each read is denoised by replacing it with the central sequence of its partition).</p>
        <p id="P31">A detailed description of the original version of this divisive algorithm is available in Rosen et al. 2012<sup><xref rid="R5" ref-type="bibr">5</xref></sup>. The DADA2 implementation has been slightly simplified for computational speed, in particular there is no longer any construction of “indel families”.</p>
      </sec>
      <sec id="S7">
        <title>Error model parameterization</title>
        <p id="P32">DADA2 depends on a parameterized error model (the 16 × 41 transition probabilities, e.g. p(A→C, 35) but if those parameters are not known a priori then DADA2 can estimate them from the data.</p>
        <p id="P33">Given an inferred partition of the amplicon sequences, DADA2 records the mismatches between every sequence and the center of its partition, and counts each type of mismatch (e.g. the number of A→C mismatches where Q=35). That table of observed mismatches represents the errors inferred by DADA2, and can be used to estimate the parameters of the error model. DADA2's default parameter estimation method is to perform a weighted loess fit to the regularized log of the observed mismatch rates as a function of their quality, separately for each transition type (e.g. A→C mismatches are fit separately from A→G mismatches). However, the error rate estimation function is a modular part of the algorithm, and the user is able to provide their own R function to estimate the parameters of the error model from the observed mismatches if they prefer a different method.</p>
      </sec>
      <sec id="S8">
        <title>Alternating estimation until consistency</title>
        <p id="P34">DADA2's <monospace>selfConsist</monospace> mode alternates sample inference (conditional on the parameters of the error model) with parameter estimation (conditional on the inferred sample composition) until convergence, at which point jointly consistent estimates of the error parameters and sample composition are reported. This improves the accuracy of DADA2: while Illumina quality scores are informative, they do not exactly match their textbook definition (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 8</xref>), and we have observed significant variation in this relationship between different runs. The <monospace>plotErrors</monospace> function in the DADA2 R package produced <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 8</xref>, and is a useful tool to visualize the observed and estimated error rates in various datasets.</p>
      </sec>
      <sec id="S9">
        <title>DADA2 pipeline</title>
        <p id="P35">The DADA2 R package implements a complete pipeline to turn paired-end fastq files from the sequencer into merged, denoised, chimera-free, inferred sample sequences. Parts of this pipeline can be substituted with outside methods, but there are some structural differences between the DADA2 pipeline and most others. One such difference is that the DADA2 pipeline performs merging of paired-end reads after denoising. This is because the core denoising algorithm uses the empirical relationship between the quality score and the error rates. When reads are merged, this relationship will differ between the forward-only, overlapping, and reverse-only portions of the merged read. That variation interferes with the denoising algorithm, and therefore greater accuracy can be achieved by denoising before merging, albeit at some computational cost.</p>
        <sec id="S10">
          <title>Filtering</title>
          <p id="P36"><monospace>fastqFilter()</monospace> implements filtering of fastq files that largely recapitulates the usearch <monospace>fastq_filter</monospace> command (<ext-link ext-link-type="uri" xlink:href="http://www.drive5.com/usearch/manual/cmd_fastq_filter.html">http://www.drive5.com/usearch/manual/cmd_fastq_filter.html</ext-link>). In short, this function trims sequences to a specified length, removes sequences shorter than that length, and filters based on the number of ambiguous bases, a minimum quality score, and the expected errors in a read<sup><xref rid="R18" ref-type="bibr">18</xref></sup>. <monospace>fastqPairedFilter()</monospace> implements the same trimming and filtering, but applies it to paired reads jointly, only outputting reads where both the forward and reverse reads pass the filter.</p>
        </sec>
        <sec id="S11">
          <title>Dereplication</title>
          <p id="P37"><monospace>derepFastq()</monospace> imports a fastq file and outputs a dereplicated list of unique sequences and their abundances. <monospace>derepFastq()</monospace> also outputs consensus positional quality scores for each unique sequence by taking the average (mean) of the positional qualities of the component reads. These consensus scores are used by the error model of the <monospace>dada()</monospace> function.</p>
        </sec>
        <sec id="S12">
          <title>Denoising</title>
          <p id="P38"><monospace>dada()</monospace> implements the core denoising algorithm described above.</p>
        </sec>
        <sec id="S13">
          <title>Chimeras</title>
          <p id="P39"><monospace>isBimeraDenovo()</monospace> identifies sequences that are exact bimeras (two-parent chimeras) of more abundant output sequences. Bimeras are identified by performing a Needleman-Wunsch global alignment of each sequence to all more abundant sequences, and then searching for combinations of a left-parent and a right-parent that cover the child sequence without any mismatches or internal indels. Child sequences that differ by a single mismatch or indel from the chimeric model are also flagged if the left-parent and right-parent are both at least 4-away from the child sequence.</p>
          <p id="P40"><monospace>isBimeraDenovo()</monospace> is intended to be used after denoising, and on exactly inferred sample sequences, rather than on noisy input reads or fuzzy OTUs. It was necessary to implement <monospace>isBimeraDenovo()</monospace> because most current stand-alone chimera identification programs are intentionally conservative about identifying chimeras that are relatively close to other more abundant sequences, because such sequences are expected to be later joined together in the same OTU (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 2</xref>). DADA2 does not create OTUs, and does differentiate closely related sequence variants, therefore we implemented this simple, but more sensitive, chimera detection method.</p>
        </sec>
        <sec id="S14">
          <title>Merging</title>
          <p id="P41"><monospace>mergePairs()</monospace> performs a global ends-free alignment between paired forward and reverse reads, and merges them together if they exactly overlap. <monospace>mergePairs()</monospace> requires that the input forward and reverse reads read in by <monospace>derepFastq()</monospace> were in the same order, a feature which is maintained by <monospace>fastqPairedFilter()</monospace>. Note that merging in the DADA2 pipeline happens after denoising, hence the strict requirement of exact overlap since it is expected that nearly all substitution errors have already been removed.</p>
        </sec>
      </sec>
    </sec>
    <sec id="S15">
      <title>Benchmarking</title>
      <sec id="S16">
        <title>Test datasets</title>
        <p id="P42">The Balanced community consists of 57 bacteria and archaea from a broad range of habitats. The 16S rRNA gene sequences of most of these strains were well separated (&gt;3%) over the region sequenced. However, the sequences of 5 strains were identical to other more abundant strains, while 5 strains had a total of 7 additional distinguishable sequence variants in their genomes that differed by 1 or 2 nucleotides. There were also two strains that were less than 3% different from more abundant strains. The Balanced dataset was downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/data/view/PRJEB6244">http://www.ebi.ac.uk/ena/data/view/PRJEB6244</ext-link>, and its construction was described in [<xref rid="R16" ref-type="bibr">16</xref>] where it is identified as dataset DS 35.</p>
        <p id="P43">The HMP community consists almost entirely of strains well separated (&gt;3%) over the region sequenced (<italic>S. epidermis</italic> and <italic>S. aureus</italic> are indistinguishable), most of which colonize the human body. The HMP dataset was downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.mothur.org/MiSeqDevelopmentData.html">http://www.mothur.org/MiSeqDevelopmentData.html</ext-link>, and its construction was described in [<xref rid="R17" ref-type="bibr">17</xref>] where it is identified as the MOCK1 sample in run 130403. This dataset was also analyzed in [<xref rid="R18" ref-type="bibr">18</xref>].</p>
        <p id="P44">The Extreme dataset was generated for this study. The organisms for the Extreme community include human gastrointestinal tract bacterial isolates (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). The Extreme dataset was intended to include more fine-scale variation than the other mock communities, the members of which were chosen in part for their well-separated 16S rRNA gene sequences. The Extreme strains are all distinguishable over the sequenced region of the 16S rRNA gene, but some pairs of strains differ by as little as 1 nucleotide. The Extreme dataset is available under SRA accession number SRX1478507.</p>
        <p id="P45">Extreme strains were grown overnight in liquid broth with the medium recommended from the source culture collection for each respective strain (<xref ref-type="table" rid="T1">Table 1</xref>). An aliquot of the bacterial culture was used to directly amplify the 16S rRNA gene. One microliter of the bacterial culture was used as template to amplify the V4 region of the 16S rRNA gene using fusion gene primers (515f/806r) that incorporate Illumina adapter sequences and indexing barcodes<sup><xref rid="R22" ref-type="bibr">22</xref></sup>. The PCR reaction was carried out in a 25 uL mixture containing 1× HotMaster Mix with 2.5 mM Mg2+ (5 PRIME, Gaithersburg, MD), 400 nM forward primer, 400 nM reverse primer, along with the bacterial culture template. The following cycling parameters were used: initial cell lysis and DNA denaturing at 95$^\circ$C for 10 minutes, followed by 30 cycles of 95°C for 30 seconds, 50°C for 30 seconds, and 72°C for 30 seconds, ending with a final annealing step at 72°C for 10 min. PCR amplicons were cleaned using Agencourt AMPure XP beads (Beckman Coulter, Pasadena, CA) following the manufacturer's instructions. Cleaned PCR amplicons were analyzed and quantified using an Agilent 2100 Bioanalyzer.</p>
        <p id="P46">Strains were grouped into two taxonomic groups, Firmicutes and Bacteroidetes. Within each taxonomic group, strains were designated for one of six 10-fold dilution groups (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). PCR amplicons for each strain were first normalized to the same concentration. From there, each amplicon was individually diluted to its respective dilution level and then all amplicons were pooled. The concentration of the pooled library was quantified using the Quant-iT PicoGreen dsDNA Assay kit (Life Technologies, Carlsbad, CA) and analyzed on an Agilent 2100 Bioanalyzer. The pooled library was diluted to 4 nM and then Illumina's protocol for preparing libraries for sequencing on the MiSeq was followed. The final concentration of the library was diluted to 6 pM with ~20% PhiX spiked in to account for the low base-diversity library. The final pooled library was sequenced on an Illumina MiSeq with a MiSeq Sequencing Reagent Kit v3 to obtain 250 bp paired end reads utilizing custom sequencing primers as described in [<xref rid="R22" ref-type="bibr">22</xref>].</p>
      </sec>
      <sec id="S17">
        <title>Workflow on test data</title>
        <p id="P47">A common filtering and trimming was performed before applying each method: The DADA2 <monospace>fastqPairedFilter</monospace> (paired reads) and <monospace>fastqFilter</monospace> (forward reads only) functions were used to remove sequences with Ns or more than two expected errors<sup><xref rid="R18" ref-type="bibr">18</xref></sup>, and to trim the first 20 nucleotides and the last 10 nucleotides (forward reads) or 10–50 nucleotides (reverse reads) depending on the quality profile of the data.</p>
        <p id="P48">The usearch command <monospace>fastq_mergepairs</monospace> with a minimum overlap of 20 bases and maximum differences of 1 was used to merge the filtered forward and reverse reads for further analysis by UPARSE, MED and QIIME. Mothur used its native read merging function <monospace>make.contigs</monospace>. DADA2 denoised the forward and reverse reads independently, and then merged them with its <monospace>mergePairs</monospace> function.</p>
        <p id="P49">Chimeras were removed from the denoised output of DADA2 and MED by <monospace>isBimeraDenovo</monospace> in the DADA2 R package, as this tool is intended for the exactly inferred sequences output by these methods. UPARSE has built-in chimera removal. The <monospace>uchime</monospace> method included in mothur and QIIME was used to remove chimeras for those pipelines<sup><xref rid="R23" ref-type="bibr">23</xref></sup>.</p>
        <p id="P50">A list of output sequences and associated abundances was obtained for each algorithm. For DADA2 these were the inferred sample sequences, for UPARSE, mothur and QIIME the representative OTU sequences, and for MED the representative sequences of its “nodes”.</p>
        <p id="P51">We also removed singleton OTUs from the outputs of mothur and QIIME. The DADA2, UPARSE and MED pipelines all decline to call singleton variants, so removing singletons from mothur and QIIME allows a cleaner comparison between methods. Additionally, nearly all of the singleton variants output by mothur and QIIME were spurious, so removing singletons improved their reported accuracy.</p>
        <p id="P52">Software versions: DADA2 version 0.99.8, usearch version 8.1.1831 (implements UPARSE), MED version 2.0, mothur version 1.36.1, QIIME version 1.9.1.</p>
      </sec>
      <sec id="S18">
        <title>Specificity</title>
        <p id="P53">Output sequences were first compared to the known 16S rRNA gene reference sequences of the members of each mock community. If an output sequence matched a reference sequences, it was classified as Reference, and if it had one mismatch or gap to a reference sequence it was classified as One Off. Output sequences that were at least Hamming distance 2 from any reference sequence were then BLASTed against the nr/nt database. If the best hit was an exact match covering the full output sequence, it was classified Exact. If there was a single mismatch or indel, it was classified One Off. Output sequences that remained unclassified to this point were classified Other.</p>
        <p id="P54">We included the BLAST against nr/nt step because even amplicon sequencing data from communities with a putatively known reference composition will contain contaminant sequences. Contaminants are real, albeit unwanted, biological variation, and should be identified when correcting amplicon errors. While the nr/nt database is imperfect, it is reasonable to expect that Exact matches are far more likely to be real variants than are Others. Output sequences classified as Other, and output sequences classified as One Off that differed by one substitution from a more abundant output sequence, were considered a proxy for false positives. Output sequences classified as Reference or Exact were considered true positives.</p>
      </sec>
      <sec id="S19">
        <title>Sensitivity</title>
        <p id="P55">We compiled the 16S rRNA gene sequences (reference sequences) for the intended members of each mock community (reference strains). The presence of each reference strain was confirmed by checking that at least one read matching one of its 16S rRNA gene sequences was present in the filtered dataset. If no such read existed, that strain was removed from the reference list.</p>
        <p id="P56">Output sequences were compared to the list of reference sequences. If any output sequence matched any 16S rRNA gene sequence present in a strain, that reference strain was considered to have been identified.</p>
      </sec>
      <sec id="S20">
        <title>Time Benchmarking</title>
        <p id="P57">When benchmarking computational time, we attempted to isolate the core sample inference algorithms for each pipeline as much as possible. Thus, for the time benchmarking we applied each algorithm to an identically prepared set of sequences: the filtered forward-only reads from the Balanced dataset including singletons. We did not include chimera identification in this benchmarking. The specific commands benchmarked are listed at the end of the Balanced workflow.</p>
        <p id="P58">Note that preprocessing steps, such as discarding singletons and reference-based chimera removal, can substantially reduce subsequent computation time for all of these methods.</p>
      </sec>
    </sec>
    <sec id="S21">
      <title>Analysis of Vaginal and Fecal Samples</title>
      <p id="P59">The 16S rRNA gene amplicon data from human vaginal samples in [<xref rid="R19" ref-type="bibr">19</xref>] (2.13M paired-end Illumina Miseq reads in 157 samples) and from mouse feces in [<xref rid="R17" ref-type="bibr">17</xref>] (3.65M paired-end Illumina Miseq reads in 362 samples) were analyzed with the DADA2 pipeline outlined above. First the demultiplexed fastq files were filtered and trimmed in the same manner as the test datasets. Each sample was dereplicated, a portion of the dataset was used to estimate the error parameters, and <monospace>dada()</monospace> was applied to the full pooled dataset using those inferred error parameters. <monospace>isBimeraDenovo()</monospace> was used to remove chimeras.</p>
      <p id="P60">For the human vaginal samples, output sequences that appeared in at least two samples and at least 0.3% of the total reads were taxonomically identified by BLAST. Further analysis focused on the six <italic>L. crispatus</italic> sequence variants identified by this procedure.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS782534-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d37e1004" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="FN1">
      <p id="P61">
        <bold>Accession Codes</bold>
      </p>
      <p id="P62">The Extreme dataset is available from the SRA under accession number SRX1478507 (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra/SRX1478507">http://www.ncbi.nlm.nih.gov/sra/SRX1478507</ext-link>).</p>
    </fn>
    <fn id="FN2" fn-type="con">
      <p id="P63">
        <bold>Author Contributions</bold>
      </p>
      <p id="P64">BJC and SPH designed the research; BJC, PJM and MJR implemented the algorithm; BJC performed the analysis; BJC, PJM, MJR and SPH wrote the paper; AWH and AAJ generated the Extreme dataset designed by BJC, PJM, and AWH.</p>
    </fn>
    <fn id="FN3">
      <p id="P65">
        <bold>Code availability</bold>
      </p>
      <p id="P66">The DADA2 R package is open source and available on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/benjjneb/dada2">https://github.com/benjjneb/dada2</ext-link>). Package binaries are available through Bioconductor as of its 3.3 release. R markdown files implementing the benchmarking on the Balanced, HMP and Extreme datasets, as well as the analyses of the human vaginal and mouse fecal samples are available from the Stanford Digital Repository: <ext-link ext-link-type="uri" xlink:href="https://purl.stanford.edu/mh194vj6733">https://purl.stanford.edu/mh194vj6733</ext-link>.</p>
    </fn>
    <fn id="FN4">
      <p id="P67">
        <bold>Competing Financial Interests</bold>
      </p>
      <p id="P68">The authors declare no competing financial interests.</p>
    </fn>
  </fn-group>
  <ack id="S22">
    <p id="P69">We thank M Schirmer and D MacIntyre for productive correspondence. This work was supported by the NSF (DMS-1162538 to SH), the NIH (R01AI112401 to SH) and the Samarth Foundation (Stanford Microbiome Seed Grant to BC and SH).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <collab>Human Microbiome Project Consortium</collab>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>207</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="pmid">22699609</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosen</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Davison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bhaya</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1019</fpage>
        <lpage>1023</lpage>
        <pub-id pub-id-type="pmid">26023139</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>668</fpage>
        <lpage>669</lpage>
        <pub-id pub-id-type="pmid">20805793</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lanzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>38</fpage>
        <pub-id pub-id-type="pmid">21276213</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosen</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>283</fpage>
        <pub-id pub-id-type="pmid">23113967</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bragg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Imelfort</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>425</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="pmid">22543370</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>996</fpage>
        <lpage>998</lpage>
        <pub-id pub-id-type="pmid">23955772</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eren</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Borisy</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>JLM</given-names>
          </name>
        </person-group>
        <source>Proc Natl Acad Sci USA</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>E2875</fpage>
        <lpage>E2884</lpage>
        <pub-id pub-id-type="pmid">24965363</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eren</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Lescault</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Reveillaud</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <source>ISME J</source>
        <year>2015</year>
        <volume>9</volume>
        <fpage>968</fpage>
        <lpage>979</lpage>
        <pub-id pub-id-type="pmid">25325381</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tikhonov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leach</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Wingreen</surname>
            <given-names>NS</given-names>
          </name>
        </person-group>
        <source>ISME J</source>
        <year>2015</year>
        <volume>9</volume>
        <fpage>68</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="pmid">25012900</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mitsuya</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gharizadeh</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ronaghi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shafer</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <source>Genome Research</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1195</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="pmid">17600086</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McElroy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zagordi</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bull</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>501</fpage>
        <pub-id pub-id-type="pmid">23879730</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guarner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Nat Rev Gastroenterol Hepatol</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>647</fpage>
        <lpage>649</lpage>
        <pub-id pub-id-type="pmid">25201043</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>e37</fpage>
        <pub-id pub-id-type="pmid">25586220</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozich</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Highlander</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <source>Appl Environ Microbiol</source>
        <year>2013</year>
        <volume>79</volume>
        <fpage>5112</fpage>
        <lpage>5120</lpage>
        <pub-id pub-id-type="pmid">23793624</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Flyvbjerg</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3476</fpage>
        <lpage>3482</lpage>
        <pub-id pub-id-type="pmid">26139637</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacIntyre</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Sci Rep</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>8988</fpage>
        <pub-id pub-id-type="pmid">25758319</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ravel</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Proc Natl Acad Sci USA</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>Supplement 1</issue>
        <fpage>4680</fpage>
        <lpage>4687</lpage>
        <pub-id pub-id-type="pmid">20534435</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <ref-list>
    <title>Methods-only References</title>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ESPRIT: estimating species richness using large collections of 16S rRNA pyrosequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e76</fpage>
        <pub-id pub-id-type="pmid">19417062</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <source>ISME J</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>1621</fpage>
        <pub-id pub-id-type="pmid">22402401</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2194</fpage>
        <lpage>2200</lpage>
        <pub-id pub-id-type="pmid">21700674</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Sequence variants inferred by DADA2 compared to the OTUs constructed by UPARSE</title>
      <p id="P70">The merged sequences output by DADA2 are plotted for three Illumina amplicon datasets: (a) Balanced, (b) HMP, and (c) Extreme. Frequency is plotted on the y-axis; Hamming distance to the closest more-abundant sequence on the x-axis. Shapes represent accuracy (Methods). When variants are well separated from other members of the community the sequence variants inferred by DADA2 largely coincide with the OTUs output by UPARSE (black). However, DADA2 resolves additional variation (blue), especially within the UPARSE's OTU radius (dashed line), while outputting fewer spurious sequences (One Off and Other).</p>
    </caption>
    <graphic xlink:href="nihms782534f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Lactobacillus crispatus sequence variants in the human vaginal community during pregnancy</title>
      <p id="P71">DADA2 identified six <italic>Lactobacillus crispatus</italic> 16S rRNA sequence variants present in multiple samples and a significant fraction of all reads (L1: 19.7%, L2: 11.1%, L3: 6.5%, L4: 3.1%, L5: 1.3%, L6: 0.4%). (a) The frequency of L1–L6 in each sample. Black bars at the bottom link samples from the same subject. The frequency of (b) L1 vs. L2, and (c) L1 vs. L3, by sample. The dashed line indicates a total frequency of 1.</p>
    </caption>
    <graphic xlink:href="nihms782534f2"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1</label>
    <caption>
      <p id="P72">The accuracy of DADA2, UPARSE, MED, mothur and QIIME on three mock community datasets</p>
    </caption>
    <table frame="below" rules="groups">
      <thead>
        <tr>
          <th align="center" colspan="3" rowspan="2" valign="middle"/>
          <th align="center" rowspan="2" valign="middle" colspan="1">Output<break/>Reads(%)</th>
          <th align="center" colspan="5" valign="middle" rowspan="1">Output Sequences</th>
          <th align="center" rowspan="2" valign="middle" colspan="1">Reference<break/>Strains</th>
        </tr>
        <tr>
          <th align="right" valign="middle" rowspan="1" colspan="1">Total</th>
          <th align="right" valign="middle" rowspan="1" colspan="1">Reference</th>
          <th align="right" valign="middle" rowspan="1" colspan="1">Exact</th>
          <th align="right" valign="middle" rowspan="1" colspan="1">One Off</th>
          <th align="right" valign="middle" rowspan="1" colspan="1">Other</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" rowspan="11" valign="middle" colspan="1">
            <bold>Balanced</bold>
          </td>
          <td align="center" rowspan="5" valign="middle" colspan="1">
            <bold>Forward</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">DADA2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">99.2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">93</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">59</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">33</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">57</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UPARSE</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">99.1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">81</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">48</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">29</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">53</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">MED</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.5</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">86</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">59</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">22</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">57</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Mothur</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">96.3</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">249</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">44</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">25</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">15</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">165</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">49</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">QIIME</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">99.2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">378</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">51</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">34</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">290</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">54</td>
        </tr>
        <tr>
          <td align="center" colspan="9" valign="bottom" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td align="center" rowspan="5" valign="middle" colspan="1">
            <bold>Merged</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">DADA2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">96.2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">87</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">57</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">29</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">55</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UPARSE</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">76</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">45</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">27</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">50</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">MED</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">91.1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">64</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">56</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">6</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">54</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Mothur</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">108</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">42</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">27</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">11</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">28</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">47</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">QIIME</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">170</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">45</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">28</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">4</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">93</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">50</td>
        </tr>
        <tr>
          <td align="center" colspan="10" valign="bottom" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td align="center" rowspan="19" valign="middle" colspan="1">
            <bold>HMP</bold>
          </td>
          <td align="center" rowspan="9" valign="middle" colspan="1">
            <bold>Forward</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">DADA2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">151</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">23</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">112</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UPARSE</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">96.7</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">161</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">123</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">10</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">MED</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">80.9</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">83</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">23</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">58</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Mothur</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.4</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">849</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">177</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">47</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">605</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">QIIME</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.4</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1375</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">177</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">60</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1118</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" colspan="9" valign="bottom" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td align="center" rowspan="9" valign="middle" colspan="1">
            <bold>Merged</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">DADA2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">92.3</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">67</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">23</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">40</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UPARSE</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">67.7</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">94</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">59</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">13</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">MED</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">64.8</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">32</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">23</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">6</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Mothur</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">62.1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">121</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">82</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">9</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">10</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">QIIME</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">67.6</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">290</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">71</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">191</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" colspan="10" valign="bottom" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td align="center" rowspan="19" valign="middle" colspan="1">
            <bold>Extreme</bold>
          </td>
          <td align="center" rowspan="9" valign="middle" colspan="1">
            <bold>Forward</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">DADA2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">99.5</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">68</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">26</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">35</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">4</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">23</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UPARSE</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">99.5</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">74</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">21</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">40</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">13</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">MED</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">86.4</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">95</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">16</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">79</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">13</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Mothur</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">*</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">*</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">*</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">*</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">*</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">*</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">*</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">QIIME</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">99.5</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">3237</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">44</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">73</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">3100</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">20</td>
        </tr>
        <tr>
          <td align="center" colspan="9" valign="bottom" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td align="center" rowspan="9" valign="middle" colspan="1">
            <bold>Merged</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">DADA2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.6</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">25</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">24</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">21</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UPARSE</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">69.9</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">23</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">18</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">4</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">18</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">MED</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">67.6</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">32</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">17</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">15</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">14</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Mothur</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.3</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">44</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">23</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">14</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">23</td>
        </tr>
        <tr>
          <td align="center" valign="bottom" rowspan="1" colspan="1">
            <hr/>
          </td>
          <td align="center" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="right" rowspan="1" colspan="1"/>
          <td align="center" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">QIIME</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">69.9</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">36</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">19</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="right" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">19</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="TFN1">
        <p id="P73">After a common filtering step, methods were applied to the forward reads, and the merged forward and reverse reads, of the Balanced, HMP and Extreme datasets (Methods). Output sequences were classified as Reference or Exact (true positives) and One Off or Other (false positives) by comparison to the known sequences of these mock communities (reference strains) and comparison to nt to identify contaminants (Methods). DADA2 detected the most reference strains and sequences, while outputting the fewest false positives. Mothur failed to complete on the Extreme forward reads.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
