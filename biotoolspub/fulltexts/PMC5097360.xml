<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5097360</article-id>
    <article-id pub-id-type="publisher-id">3164</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-016-3164-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Q-nexus: a comprehensive and efficient analysis pipeline designed for ChIP-nexus</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hansen</surname>
          <given-names>Peter</given-names>
        </name>
        <address>
          <email>peter.hansen@charite.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hecht</surname>
          <given-names>Jochen</given-names>
        </name>
        <address>
          <email>Jochen.Hecht@crg.eu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ibn-Salem</surname>
          <given-names>Jonas</given-names>
        </name>
        <address>
          <email>j.ibn-salem@uni-mainz.de</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Menkuec</surname>
          <given-names>Benjamin S.</given-names>
        </name>
        <address>
          <email>benjamin@menkuec.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roskosch</surname>
          <given-names>Sebastian</given-names>
        </name>
        <address>
          <email>serosko@zedat.fu-berlin.de</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Truss</surname>
          <given-names>Matthias</given-names>
        </name>
        <address>
          <email>matthias.truss@charite.de</email>
        </address>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter N.</given-names>
        </name>
        <address>
          <email>peter.robinson@jax.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Institute for Medical and Human Genetics, Charité-Universitätsmedizin Berlin, Augustenburger Platz 1, Berlin, 13353 Germany </aff>
      <aff id="Aff2"><label>2</label>Berlin Brandenburg Center for Regenerative Therapies (BCRT), Charité-Universitätsmedizin Berlin, Augustenburger Platz 1, Berlin, 13353 Germany </aff>
      <aff id="Aff3"><label>3</label>Centre for Genomic Regulation (CRG), The Barcelona Institute of Science and Technology, Dr. Aiguader 88, Barcelona, 08003 Spain </aff>
      <aff id="Aff4"><label>4</label>Universitat Pompeu Fabra (UPF), Barcelona, Spain </aff>
      <aff id="Aff5"><label>5</label>Faculty of Biology, Johannes Gutenberg University Mainz, Ackermannweg 4, Mainz, 55128 Germany </aff>
      <aff id="Aff6"><label>6</label>Institute of Molecular Biology, Ackermannweg 4, Mainz, 55128 Germany </aff>
      <aff id="Aff7"><label>7</label>Institute for Bioinformatics, Department of Mathematics and Computer Science, Freie Universität Berlin, Arnimallee 14, Berlin, 14195 Germany </aff>
      <aff id="Aff8"><label>8</label>Labor für Pädiatrische Molekularbiologie, Charité-Universitätsmedizin Berlin, Augustenburger Platz 1, Berlin, 13353 Germany </aff>
      <aff id="Aff9"><label>9</label>Max Planck Institute for Molecular Genetics, Inhestr. 63-73, Berlin, 14195 Germany </aff>
      <aff id="Aff10"><label>10</label>Current address: The Jackson Laboratory for Genomic Medicine, 10 Discovery Drive, Farmington, 06032 CT USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>873</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>10</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>ChIP-nexus, an extension of the ChIP-exo protocol, can be used to map the borders of protein-bound DNA sequences at nucleotide resolution, requires less input DNA and enables selective PCR duplicate removal using random barcodes. However, the use of random barcodes requires additional preprocessing of the mapping data, which complicates the computational analysis. To date, only a very limited number of software packages are available for the analysis of ChIP-exo data, which have not yet been systematically tested and compared on ChIP-nexus data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here, we present a comprehensive software package for ChIP-nexus data that exploits the random barcodes for selective removal of PCR duplicates and for quality control. Furthermore, we developed bespoke methods to estimate the width of the protected region resulting from protein-DNA binding and to infer binding positions from ChIP-nexus data. Finally, we applied our peak calling method as well as the two other methods MACE and MACS2 to the available ChIP-nexus data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The Q-nexus software is efficient and easy to use. Novel statistics about duplication rates in consideration of random barcodes are calculated. Our method for the estimation of the width of the protected region yields unbiased signatures that are highly reproducible for biological replicates and at the same time very specific for the respective factors analyzed. As judged by the irreproducible discovery rate (IDR), our peak calling algorithm shows a substantially better reproducibility. An implementation of Q-nexus is available at <ext-link ext-link-type="uri" xlink:href="http://charite.github.io/Q/">http://charite.github.io/Q/</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12864-016-3164-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Chromatin immunoprecipitation</kwd>
      <kwd>ChIP-nexus</kwd>
      <kwd>ChIP-exo</kwd>
      <kwd>Duplication rates</kwd>
      <kwd>Library complexity</kwd>
      <kwd>Algorithm</kwd>
      <kwd>Bioinformatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id>
            <institution>Bundesministerium für Bildung und Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>0313911</award-id>
        <principal-award-recipient>
          <name>
            <surname>Robinson</surname>
            <given-names>Peter N.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>ChIP-seq, which couples chromatin immunoprecipitation with high-throughput sequencing, has enabled researchers to investigate protein-DNA binding on a genome-wide scale [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. ChIP-seq works by cross-linking DNA-protein complexes with formaldehyde followed by fragmentation of the complexes into short stretches of 300–500 base pairs (bp). The fragments are then immunoprecipitated with an antibody specific for the protein of interest, such as a transcription factor (TF) or a modified histone, in order to enrich for DNA fragments bound by the protein prior to next-generation sequencing (NGS). Since the fragment is much longer than the specific protein-DNA binding site (which tend to be on the order of 6–20 bp in length), ChIP-seq “peaks”, representing areas of enrichment for the bound protein, do not directly allow the exact position of protein-DNA binding to be identified.</p>
    <p>For this reason, ChIP-exo, an extension of the basic ChIP-seq method, aims to remove DNA segments that surround the binding site of the protein of interest before NGS adapters are attached in order to characterize the exact binding site of proteins more exactly [<xref ref-type="bibr" rid="CR4">4</xref>]. The protocol for ChIP-exo is similar to the ChIP-seq protocol with the key difference that a 5’-3’ (<italic>λ</italic>) exonuclease is employed to trim the DNA sequences on each strand to within a few bp of the location at which the protein of interest has been cross-linked to the DNA. DNA sequences located 3’ to the cross-linking point remain intact and thus can be used to identify the genomic location of the binding event if they are sufficiently long and located in non-repetitive areas of the genome; on the other hand, non-cross-linked nonspecific DNA is largely eliminated by the exonuclease treatment, which may contribute towards reducing background noise [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>The ChIP-exo methodology allows protein-DNA binding interactions to be characterized to a level of detail that was not possible with ChIP-seq. The cross-linked DNA-protein complex protects the 5’ ends of bound DNA fragments from exonuclease digestion, with the cleavage occurring about 5–6 bp upstream of the cross-linking point [<xref ref-type="bibr" rid="CR5">5</xref>], allowing TF binding sites be mapped at high resolution [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. Additionally, the morphology of the ChIP-exo mapped read profiles allows one to discriminate between direct and indirect protein-DNA binding interactions. Profile-based analysis of ChIP-exo signals can uncover structural and functional clues about the interaction and cooperative nature of genomic TF binding [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p>Despite these advantages, the ChIP-exo methodology has a number of shortcomings, including the need for high amounts of input DNA in order to avoid overamplification artifacts resulting from low amounts of starting DNA [<xref ref-type="bibr" rid="CR11">11</xref>]. Recently, an adaptation of the ChIP-exo procedure was introduced with the goal of addressing these short-comings. ChIP-nexus (chromatin immunoprecipitation experiments with <bold>N</bold>ucleotide resolution through <bold>EX</bold>onuclease, <bold>U</bold>nique barcode and <bold>S</bold>ingle ligation) involves chromatin immunoprecipitation as with standard ChIP-seq, but then proceeds to ligate adapters that contain Illumina-specific sequences, a <italic>Bam</italic>HI site, and a random barcode arranged in such a way that self-circularization can occur following <italic>λ</italic>-exonuclease digestion, which places the random barcode directly adjacent to the “stop” nucleotide resulting from the cross-linked protein-DNA complex. In comparison to the ChIP-exo protocol, ChIP-nexus is more efficient, because for a given fragment only one ligation (instead of two) is needed. Following ligase-mediated circularization, an oligonucleotide with sequence complementary to segment with the <italic>Bam</italic>HI site is added, which enables relinearization of the circles by means of <italic>Bam</italic>HI digestion. Finally, PCR amplification is performed with primers that match the Illumina sequences of the adapter, followed by single-end Illumina sequencing. The random barcode allows multiple reads that correspond to independent molecules but map to the same position to be distinguished from PCR duplicates.</p>
    <p>There is currently no software designed specifically for ChIP-nexus, and the computational analysis in the original publication [<xref ref-type="bibr" rid="CR11">11</xref>] was performed using a number of scripts for preprocessing and MACS2 [<xref ref-type="bibr" rid="CR12">12</xref>] for peak calling, which was designed for ChIP-seq data and does not take into account the specifics of ChIP-exo and ChIP-nexus data. Although there are software packages specifically developed for ChIP-exo data [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], they do not provide solutions for the extensive preprocessing of the data before peak calling, which comprises quality trimming, adapter clipping and mapping. For ChIP-nexus an additional processing of the mapping has to be performed in order to benefit from the random barcodes. For ChIP-seq the average fragment length is an important parameter for peak calling and downstream analysis and a number of algorithms for estimation have been developed, e.g. the well known cross-correlation method [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. For ChIP-exo and ChIP-nexus the relevant quantity is the average width of the regions that are occupied by the protein of interest, which is different from the average fragment length. We will refer to such regions as protected regions, because they are protected from 5’-3’ (<italic>λ</italic>) exonuclease digestion. A number of methods have been developed to estimate the size of the protected region and to call peaks in ChIP-exo data [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p>In this work, we present a software package, Q-nexus, for the analysis of ChIP-nexus and ChIP-exo data. Our software implements an all-in-one approach for the preprocessing of ChIP-nexus reads, a novel method for the estimation of the protected-region width and peak calling that can be applied to ChIP-nexus as well as ChIP-exo data. We tested our software on the available ChIP-nexus data and show that our method for the estimation of protected region width provides unbiased signatures that are homogeneous for biological replicates and specific for individual transcription factors. Using the IDR framework [<xref ref-type="bibr" rid="CR15">15</xref>], we show that our method for ChIP-nexus peak calling outperforms competing methods with respect to the reproducibility of the results. The Q-nexus software as well as an associated tutorial is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/charite/Q">https://github.com/charite/Q</ext-link>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Preprocessing and mapping of ChIP-nexus reads</title>
      <p>In standard ChIP-seq, multiple reads that map to the same genomic position are usually considered to be duplicates resulting from PCR overamplification during library preparation, and are therefore removed before further analysis. In contrast, in the ChIP-exo and ChIP-nexus protocols, exonuclease digests multiple distinct DNA fragments up to the identical protein-DNA binding site, and therefore reads mapping to the same position are not necessarily PCR duplicated. While ChIP-exo analysis protocols simply do not remove any reads mapping to the same position, ChIP-nexus employs a randomized barcode in the adapter in order to allow PCR duplicated reads (with the same random barcode) to be distinguished from reads originating from distinct molecules (with different random barcodes). We will refer to reads mapping to the same position as identically mapped (IM) reads. Furthermore, we will refer to IM reads with identical barcodes as IMIB reads and to those with unique barcode as IMUB reads. ChIP-nexus assumes that identically mapped reads with identical barcode (IMIB) represent PCR duplicates and only IMUB are utilized for analysis.</p>
      <p>Existing tools are not able to process these barcodes in the way that is required by the ChIP-nexus protocol. In the original publication, a set of scripts was used to process barcodes and prepare the data for peak calling [<xref ref-type="bibr" rid="CR11">11</xref>]. We have therefore implemented a preprocessing routine (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) that processes raw FASTQ files by extracting the random barcodes from ChIP-nexus reads and writes them into the sequence ID line for downstream analysis. Due to exonuclease digestion a certain proportion of the inserts tend to be very short in size, i.e. shorter than the read length. Therefore, adapter clipping is performed. Following this, alignment of the preprocessed ChIP-nexus reads is carried out with an aligner such as bowtie [<xref ref-type="bibr" rid="CR16">16</xref>]. The ChIP-nexus protocol assumes that reads that are mapped to the same genomic position and have an identical barcode result from PCR duplication artifacts. For such reads only one read is retained. The Q-nexus software preprocesses a typical ChIP-nexus dataset in less than 17 minutes, where the runtime primarily depends on the number of raw reads to be processed. We compared the results of our preprocessing to those obtained in the original publication [<xref ref-type="bibr" rid="CR11">11</xref>] and found comparable numbers of IMUB reads (Table <xref rid="Tab1" ref-type="table">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the Q-nexus preprocessing workflow. During barcode preprocessing, barcode tags are removed. Subsequently, adapter sequences are clipped and reads that consist completely of adapter (<italic>orange-tagged</italic>) are removed. The clipped reads are mapped to the reference genome. The random barcode tags allow PCR duplicated reads and IMUB reads to be distinguished from one another. Only one of the two PCR duplicated reads mapping to the same genomic position (<italic>blue-tagged</italic>) is kept, while reads with different random barcodes are allowed to map to the same position</p></caption><graphic xlink:href="12864_2016_3164_Fig1_HTML" id="MO1"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Preprocessing: IMUB reads and runtime</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Factor</th><th align="left">Dataset</th><th align="left">Reads</th><th align="left">IMUB originally</th><th align="left">IMUB Q-nexus</th><th align="left">Runtime (m)</th></tr></thead><tbody><tr><td align="left">Dorsal</td><td align="left">SRR1175698</td><td align="left">18,983,666</td><td align="left">6,404,431</td><td align="left">6,234,888</td><td align="left">6</td></tr><tr><td align="left"/><td align="left">SRR1175699</td><td align="left">21,926,113</td><td align="left">6,219,935</td><td align="left">6,054,824</td><td align="left">6</td></tr><tr><td align="left">Max</td><td align="left">SRR1175700</td><td align="left">30,781,699</td><td align="left">11,100,441</td><td align="left">11,381,661</td><td align="left">10</td></tr><tr><td align="left"/><td align="left">SRR1509031</td><td align="left">33,125,449</td><td align="left">7,557,857</td><td align="left">7,517,583</td><td align="left">9</td></tr><tr><td align="left">Myc</td><td align="left">SRR1175701</td><td align="left">27,404,713</td><td align="left">3,714,258</td><td align="left">4,724,027</td><td align="left">6</td></tr><tr><td align="left"/><td align="left">SRR1509032</td><td align="left">31,044,447</td><td align="left">7,366,642</td><td align="left">7,480,050</td><td align="left">8</td></tr><tr><td align="left">Twist</td><td align="left">SRR1509029</td><td align="left">34,042,864</td><td align="left">14,146,225</td><td align="left">14,455,901</td><td align="left">12</td></tr><tr><td align="left"/><td align="left">SRR1509030</td><td align="left">92,712,131</td><td align="left">30,370,792</td><td align="left">30,565,366</td><td align="left">31</td></tr><tr><td align="left">TBP</td><td align="left">SRR1175702</td><td align="left">52,656,846</td><td align="left">12,924,627</td><td align="left">13,349,578</td><td align="left">19</td></tr><tr><td align="left"/><td align="left">SRR1175703</td><td align="left">206,910,978</td><td align="left">8,978,714</td><td align="left">9,164,510</td><td align="left">57</td></tr></tbody></table><table-wrap-foot><p>We compared the numbers of IMUB reads of the original analysis [<xref ref-type="bibr" rid="CR11">11</xref>] and Q-nexus preprocessing. By and large, comparable numbers of reads are mapped. The calculations were performed using four threads on a desktop computer with an Intel Core i7-3770 (3.4GHz). On average, the Q-nexus preprocessing can be performed in less than 17 minutes</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec4">
      <title>Sequence duplication levels and random barcodes</title>
      <p>The complexity of sequencing libraries and PCR overamplification are critical points in virtually all NGS applications [<xref ref-type="bibr" rid="CR17">17</xref>]. In many NGS applications, a diverse library in which any given sequence appears only once in the final data set is considered ideal, and high levels of duplication generally indicate PCR overamplification or other forms of bias. For this reason, software tools such as FastQC [<xref ref-type="bibr" rid="CR18">18</xref>] have been developed that generate plots showing the proportion of the overall library with a given degree of duplication, where the sequence duplication level refers to the proportion of reads in the given duplication level bin. ChIP-exo presents a unique challenge to this kind of analysis, because the exonuclease digestion step tends to reduce the overall diversity of starting positions in a library, since distinct starting molecules may be digested down to the same stop position. For this reason, the pile-ups of reads at stop nucleotides cannot be distinguished from PCR duplicated reads. ChIP-nexus was designed to allow PCR duplicates to be identified based on the random barcode [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
      <p>We developed a bespoke plot that determines the levels of duplication with respect to random barcodes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref>). Instead of considering only the levels of identical sequences or identically mapped reads, we also determine the distribution of the levels for IMIB and IMUB reads. We applied this procedure to all analyzed datasets (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">b</xref>, <xref rid="Fig2" ref-type="fig">c</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). Furthermore, we use the various level counts to calculate overall duplication levels for a given sample, defined as the ratio of mapped reads with 5’-end depth &gt; 1 to all mapped reads. For ChIP-nexus, we expect pile-ups of IMUB reads at stop nucleotides, whereas at background positions we expect IMUB reads to occur as singletons. Therefore, the mean per-position depth of IMUB reads can be used to assess the quality of enrichment. We calculated these values for all analyzed datasets (Table <xref rid="Tab2" ref-type="table">2</xref>).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Duplication levels using random barcodes. <bold>a</bold> Toy example of mapped ChIP-nexus reads and the corresponding counts for identically mapped reads (IM, <italic>red</italic>), identically mapped reads with identical random barcodes (IMIB, <italic>blue</italic>), and identically mapped reads with unique random barcodes (IMUB, <italic>black</italic>). The number of horizontal bars for a given level corresponds to the number of reads that have the same level of duplication. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 provides a detailed example of how IM, IMIB, and IMUB reads are defined and calculated. <bold>b</bold>, <bold>c</bold> Duplication level plots for a Dorsal dataset with an overall duplication level of 54 % and for a Max dataset with an overall duplication level of 95 %</p></caption><graphic xlink:href="12864_2016_3164_Fig2_HTML" id="MO2"/></fig>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Duplication levels</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Factor</th><th align="left">Dataset</th><th align="left">IM</th><th align="left">IMIB</th><th align="left">IMUB</th></tr></thead><tbody><tr><td align="left">Dorsal</td><td align="left">SRR1175698</td><td align="left">54 %</td><td align="left">50 %</td><td align="left">8 %</td></tr><tr><td align="left"/><td align="left">SRR1175699</td><td align="left">67 %</td><td align="left">64 %</td><td align="left">8 %</td></tr><tr><td align="left">Max</td><td align="left">SRR1175700</td><td align="left">73 %</td><td align="left">65 %</td><td align="left">23 %</td></tr><tr><td align="left"/><td align="left">SRR1509031</td><td align="left">95 %</td><td align="left">92 %</td><td align="left">33 %</td></tr><tr><td align="left">Myc</td><td align="left">SRR1175701</td><td align="left">85 %</td><td align="left">80 %</td><td align="left">25 %</td></tr><tr><td align="left"/><td align="left">SRR1509032</td><td align="left">96 %</td><td align="left">92 %</td><td align="left">46 %</td></tr><tr><td align="left">Twist</td><td align="left">SRR1509029</td><td align="left">62 %</td><td align="left">42 %</td><td align="left">35 %</td></tr><tr><td align="left"/><td align="left">SRR1509030</td><td align="left">82 %</td><td align="left">69 %</td><td align="left">45 %</td></tr><tr><td align="left">TBP</td><td align="left">SRR1175702</td><td align="left">90 %</td><td align="left">87 %</td><td align="left">20 %</td></tr><tr><td align="left"/><td align="left">SRR1175703</td><td align="left">100 %</td><td align="left">99 %</td><td align="left">30 %</td></tr></tbody></table><table-wrap-foot><p>The overall duplication levels for IM, IMIB and IMUB reads were calculated as the proportion of reads with 5’-end depth &gt;1 as a share of all reads (See <italic>Assessment of Q-nexus duplication levels</italic> in <xref rid="Sec11" ref-type="sec">Methods</xref>)</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec5">
      <title>Binding characteristics: qfrag length distribution with pseudo-control</title>
      <p>For ChIP-nexus and ChIP-exo the equivalent of the average fragment length is the width of the regions that are occupied by the protein of interest, which we call “protected-region width”. Such regions are about 6–20 bp, which is much shorter than typically observed average fragment lengths (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">a</xref>). Here, we present a new method for the estimation of the protected-region width in ChIP-nexus data that uses the distribution of qfrag [<xref ref-type="bibr" rid="CR19">19</xref>] lengths. A qfrag is defined to be the genomic interval between any pair of 5’ read mapping positions on the forward and reverse strand. We derive the empirical distribution of qfrag-lengths from data by counting the number of qfrags for given lengths. The qfrag-length with the highest number of observed qfrags can be interpreted as the protected-region width (see “<xref rid="Sec11" ref-type="sec">Methods</xref>”).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Binding characteristics: qfrag length distribution with pseudo-control. <bold>a</bold> The 5’-3’ (<italic>λ</italic>) exonuclease is employed to trim the DNA sequences of a fragment of length <italic>ℓ</italic> to within a few bp at which the protein of interest has been bound to the DNA. This yields shorter fragments of length <italic>ℓ</italic>
<sup>′</sup> and <italic>ℓ</italic>
<sup>″</sup>. The width of the protected region (<italic>ℓ</italic>
<sup>‴</sup>) is given by the distance between two 5’ ends on the forward and reverse strand. <bold>b</bold> Schematic representation of the pseudo-control and the corresponding transformation. For mapping artifacts predominantly to be found on chrU and chrUextra (<italic>left-hand</italic>) and for genuine ChIP-nexus peaks (<italic>right-hand</italic>). The pseudo-control is derived from the original mapping data by swapping the strand of each read and subsequently shifting the 5’ end by one read length towards 5’ direction. For artifacts, this has no effect on the qfrag-length distribution in the pseudo-control. <bold>c</bold> qfrag-length distribution for original data (<italic>black</italic>) and pseudo-control (<italic>gray</italic>). Both distributions are are dominated by the phantom peak at one read length. <bold>d</bold> We use the difference between the qfrag-length distributions as signature and the maximum at a length of 19 as estimate for <italic>ℓ</italic>
<sup>′′′</sup>
</p></caption><graphic xlink:href="12864_2016_3164_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>It is a well known problem that fragment length estimation by the cross-correlation method [<xref ref-type="bibr" rid="CR2">2</xref>] can demonstrate an artefactual, “phantom” peak that shows the maximum correlation at a length of one read length [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], that is thought to mainly arise from pile-ups of mapped reads that are arranged in a way that 5’ ends on the forward and reverse strand have a distance of one read length (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Such mapping artifacts are most likely caused by repetitive sequences and for the Drosophila experiments analyzed here (dm3) they occur predominantly on the chromosomes U and Uextra. Similar to the cross-correlation plot, we found that the qfrag length distribution can also be affected by phantom peaks; we therefore developed a method that attempts to remove the phantom peak from the qfrag length distribution in order to enable more accurate estimation of the protected-region width. Our method generates a “pseudo-control” for each ChIP-nexus dataset in which the the strands of each mapped read are swapped and subsequently the 5’ end of each read is shifted by one read length towards 5’ end (see <xref rid="Sec11" ref-type="sec">Methods</xref>). This transformation has no effect on artifacts responsible for the ’phantom peak’, but it abolishes signals from clusters of qfrags smaller than one read length (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">b</xref>). Therefore, our procedure subtracts the qfrag counts of the pseudo-control from the counts of the original data and uses the resulting difference as an unbiased signature to estimate the mean protected-region width (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">c</xref> and <xref rid="Fig3" ref-type="fig">d</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Evaluation: binding characteristics</title>
      <p>We applied the method of plotting the 5’ coverage around motif-centered binding sites [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], the cross-correlation method [<xref ref-type="bibr" rid="CR2">2</xref>], the internal routines of MACS2 [<xref ref-type="bibr" rid="CR12">12</xref>] and MACE [<xref ref-type="bibr" rid="CR13">13</xref>] and our Q-nexus method to the ten available ChIP-nexus datasets and compared the estimated distances (<xref rid="Sec11" ref-type="sec">Methods</xref> and Table <xref rid="Tab3" ref-type="table">3</xref>). The 5’ coverage around binding sites shows maxima on the forward and reverse strand that have distances between 10 and 18 bp (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref>, <xref rid="Fig4" ref-type="fig">b</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4) that appear to be reasonable from a biological point of view and are in line with former analysis of the same data [<xref ref-type="bibr" rid="CR11">11</xref>]. However, we found that the results were unstable and heavily depend on the motif used for selection and centering, as well as the allowed distance between motif and predicted binding site. Using standardized parameter settings the method fails to derive a distinctive distribution in four out of ten cases (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">c</xref>, <xref rid="Fig4" ref-type="fig">d</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). The cross-correlation method is obviously strongly biased by the phantom peak and (falsely) estimates in all ten cases the read length of 42 bp (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Also the optimal border pair size estimates between of MACE highly correlate with the read length, indicating a biased estimation. The predicted fragment lengths of MACS2 are indeed smaller than the read length but disagree with the distances that result from the 5’ coverage around binding sites. Our Q-nexus method derives estimates for the protected-region width that are largely consistent with distances derived from the 5’ coverage plots (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref>, <xref rid="Fig4" ref-type="fig">b</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Finally, the derived signatures (differences between original and pseudo-control) are very similar for biological replicates, but specific for individual factors (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">e</xref>–<xref rid="Fig4" ref-type="fig">h</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluation: Binding characteristics. <bold>a</bold>, <bold>b</bold> 5’ end coverage around motif centered predicted binding sites for two biological replicates of Dorsal. The two peaks on the forward and reverse strand have a distance of 18 bp, which is in line with a previous analysis [<xref ref-type="bibr" rid="CR11">11</xref>] of the same data. <bold>c</bold>, <bold>d</bold> Using standardized parameter settings for all samples, no characteristic distribution is derived for TBP. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 for further positive and negative examples. <bold>e</bold>, <bold>f</bold> Difference of qfrag-length distribution between original datasets and pseudo-controls for Dorsal replicates (for all mapped reads (<italic>blue</italic>) and filtered for reads that map to standard chromosomes (green)). The estimated protected-region width of <italic>ℓ</italic>
<sup>′′′</sup>=18 is consistent with the distance derived by the 5’ end coverage around motif centered binding sites. The signatures are independent of whether mapped reads were filtered or not. Furthermore, they are reproducible for biological replicates. <bold>g</bold>, <bold>h</bold> Additional examples for biological replicates of TBP. The signatures are reproducible for biological replicates, but different from the signatures derived for Dorsal. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6 for further examples</p></caption><graphic xlink:href="12864_2016_3164_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Evaluation of binding characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Factor</th><th align="left">Dataset</th><th align="left">5’ end coverage</th><th align="left">Cross-correlation</th><th align="left">MACS2</th><th align="left">MACE</th><th align="left">Q-nexus</th></tr></thead><tbody><tr><td align="left">Dorsal</td><td align="left">SRR1175698</td><td align="left">18</td><td align="left">42</td><td align="left">28</td><td align="left">47</td><td align="left">18</td></tr><tr><td align="left"/><td align="left">SRR1175699</td><td align="left">18</td><td align="left">42</td><td align="left">28</td><td align="left">62</td><td align="left">18</td></tr><tr><td align="left">Max</td><td align="left">SRR1175700</td><td align="left">10</td><td align="left">42</td><td align="left">19</td><td align="left">41</td><td align="left">10</td></tr><tr><td align="left"/><td align="left">SRR1509031</td><td align="left">10</td><td align="left">42</td><td align="left">32</td><td align="left">46</td><td align="left">12</td></tr><tr><td align="left">Myc</td><td align="left">SRR1175701</td><td align="left">NA</td><td align="left">42</td><td align="left">29</td><td align="left">42</td><td align="left">9</td></tr><tr><td align="left"/><td align="left">SRR1509032</td><td align="left">NA</td><td align="left">42</td><td align="left">32</td><td align="left">38</td><td align="left">12</td></tr><tr><td align="left">Twist</td><td align="left">SRR1509029</td><td align="left">11</td><td align="left">42</td><td align="left">24</td><td align="left">39</td><td align="left">12</td></tr><tr><td align="left"/><td align="left">SRR1509030</td><td align="left">11</td><td align="left">42</td><td align="left">21</td><td align="left">38</td><td align="left">12</td></tr><tr><td align="left">TBP</td><td align="left">SRR1175702</td><td align="left">NA</td><td align="left">42</td><td align="left">37</td><td align="left">41</td><td align="left">12</td></tr><tr><td align="left"/><td align="left">SRR1175703</td><td align="left">NA</td><td align="left">42</td><td align="left">39</td><td align="left">42</td><td align="left">12</td></tr></tbody></table><table-wrap-foot><p>Protected-region width estimates from 5’ coverage around motif centered binding sites, cross-correlation plot, MACS2, MACE (optimal border pair size), and the width of the protected region estimated by Q-nexus. The estimates derived by Q-nexus are consistent with those derived by the method of 5’ coverage around motif centered binding sites</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec7">
      <title>ChIP-nexus peak calling</title>
      <p>We implemented an algorithm for ChIP-nexus peak calling which builds on the previous preprocessing steps and accepts mapped reads in BAM format. Since PCR artifacts (IMIB) are already removed, IMUB reads are kept, assuming that such reads stem from different molecules because they have different random barcodes. Our algorithm (see <xref rid="Sec11" ref-type="sec">Methods</xref>) implements the method of qfrag-length distribution with pseudo-control in order to estimate the protected-region width <italic>ℓ</italic>
<sup>′′′</sup>, which is then used to combine pairs of 5’ ends on the forward and reverse strand by forming qfrags [<xref ref-type="bibr" rid="CR19">19</xref>] with a minimal allowed distance <italic>q</italic>
<sub><italic>min</italic></sub>=<italic>ℓ</italic>
<sup>′′′</sup>−5 and a maximal allowed distance of <italic>q</italic>
<sub><italic>max</italic></sub>=<italic>ℓ</italic>
<sup>′′′</sup>+5. The qfrag-depth at any one position is the total number of qfrags that cover the position. The qfrag coverage has a different depth distribution than the original coverage of reads or 5’ ends. Regions with neighboring clusters of 5’ ends on the forward and reverse strand are selectively emphasized by the qfrag method (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The qfrag coverage profile along the genome is searched for local maxima that we refer to as summits that are then tested for significance. For each summit position the number of 5’ ends that map to within a radius of <italic>q</italic>
<sub><italic>max</italic></sub> is determined. <italic>P</italic>-values are calculated using the Poisson distribution and corrected for multiple testing using the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="CR22">22</xref>]. The final candidate list is sorted by <italic>P</italic>-value and a cutoff can be specified by the user. Our algorithm does not require fine-tuning of parameters for typical runs.
<fig id="Fig5"><label>Fig. 5</label><caption><p>ChIP-nexus peak calling (<bold>a</bold>) Idealized example of a ChIP-nexus peak. The protein of interest (<italic>green</italic>) is bound via one cross-link to the DNA. The 5’ ends are trimmed by exonuclease (’<italic>Pac-Man</italic>’ symbols) up to the cross-link position. 5’ end positions of mapped reads, depicted by <italic>red</italic> and <italic>blue arrows</italic>, are transformed to a qfrags coverage profile (<italic>purple</italic>) along the genome. Local maxima within the qfrag coverage are taken as summits. For each summit position <italic>s</italic>
<sub><italic>i</italic></sub> the number of 5’ end positions within a range of <italic>q</italic>
<sub><italic>max</italic></sub> is determined and tested for statistical significance. <bold>b</bold> Comparison of 5’ end and qfrags coverage profiles for Dorsal and Twist. 5’ end (<italic>red</italic> and <italic>blue</italic>) and qfrags (purple) coverage profiles at the rho NEE enhancer for Dorsal and Twist (taken from IGV [<xref ref-type="bibr" rid="CR29">29</xref>]). This region is also shown in the original ChIP-nexus publication [<xref ref-type="bibr" rid="CR11">11</xref>]. Regions surrounded by clusters of 5’ends on the forward and reverse strand are selectively emphasized by the qfrag method. The qfrags coverage profiles demonstrate two clearly separated peaks for Dorsal and Twist</p></caption><graphic xlink:href="12864_2016_3164_Fig5_HTML" id="MO5"/></fig>
</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluation: reproducibility of peak calling</title>
      <p>To evaluate the reproducibility of our peak calling algorithm compared to that of MACS2 and MACE, we used a test framework based on the IDR procedure [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], which has been heavily used to measure the reproducibility of ChIP-seq experiments [<xref ref-type="bibr" rid="CR20">20</xref>] and should also be applicable to ChIP-nexus data. We performed the comparisons on pairs of biological replicates for five transcription factors (Table <xref rid="Tab1" ref-type="table">1</xref>). We derived peak sets for each dataset using the three peak calling algorithms (see <xref rid="Sec11" ref-type="sec">Methods</xref>). The peak sets were sorted by significance and the top 100,000 peaks were used for further analysis. The IDR procedure is essentially based on peak overlaps. Two predicted binding positions from two biological replicates were classified as overlapping, if they have a distance of at most 3 bp, which is reasonable given the high resolution provided by the ChIP-nexus protocol.</p>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">a</xref>–<xref rid="Fig6" ref-type="fig">e</xref> show the results of the IDR procedure that were obtained for Twist. The top 100,000 peaks derived by Q-nexus display substantial larger overlap compared to MACS2 and MACE (Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">a</xref>–<xref rid="Fig6" ref-type="fig">c</xref>). It should also be noted that the Pearson correlation coefficients for signal scores of overlapping peaks of MACE are very low in comparison to that of Q-nexus and MACS2. The change of correspondence curve [<xref ref-type="bibr" rid="CR15">15</xref>], which is used to visualize the transition from reproducible to irreproducible signals, shows that Q-nexus identifies the largest number of reproducible peaks before the transition occurs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">d</xref>). Furthermore, according to the IDR, Q-nexus identifies the largest number of reproducible peaks (Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">e</xref>). For all pairs of biological replicates tested similar results as for Twist were obtained (Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">f</xref>–<xref rid="Fig6" ref-type="fig">g</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S7–S16 and Tables S1 and S2).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Evaluation: Reproducibility of peak calling. <bold>a-c</bold> We applied the peak calling methods Q-nexus, MACS2, and MACE to a pair of biological replicates of Twist. The scatterplots show the scores of overlapping peaks of the top 100,000 peaks for different methods. The number of overlapping peaks and the Pearson correlation coefficient is given in the upper-left corner of each plot. Q-nexus yields the largest number of overlapping peaks and correlation coefficients of almost 1. <bold>d</bold> The change of correspondence curve shows that peaks derived by Q-nexus remain consistent for 10,000 more than those of MACS2. <bold>e</bold> Q-nexus displays a considerably smaller proportion of irreproducible signals (0.01 &lt; IDR) than MACS2. <bold>f</bold>, <bold>g</bold> We obtained similar results for the other ChIP-nexus datasets of the transcription factors Dorsal, Max, Myc and TBP. For more detailed results see Additional file<xref rid="MOESM1" ref-type="media">1</xref>: Figures S7 to S16</p></caption><graphic xlink:href="12864_2016_3164_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p>ChIP-nexus is an extension of the ChIP-exo protocol that was shown to outperform ChIP-exo with respect to resolution and specificity, and additionally requires less input material [<xref ref-type="bibr" rid="CR11">11</xref>]. However, to date no bespoke software for ChIP-nexus analysis has been published, and the original analysis of the ChIP-nexus data was performed using scripts and software such as MACS2 that was originally designed for ChIP-seq [<xref ref-type="bibr" rid="CR11">11</xref>]. In this work, we present an efficient and easy to use software pipeline for ChIP-nexus data that includes methods for preprocessing and mapping of ChIP-nexus reads, estimation of the protected region width, as well as peak calling. We evaluated our methods on ten publicly available datasets.</p>
    <p>One of the major advantages of the ChIP-nexus protocol is the use of random barcodes that allow monitoring of PCR overamplification. Our software recognizes random barcodes and selectively removes PCR duplicated reads while retaining independent reads whose 5’ ends map to same position. Additionally, the random barcode information is used to generate a plot for duplication levels and calculate various statistics that can be used for trouble shooting and optimization.</p>
    <p>For ChIP-seq, the size distribution of the fragments needs to be estimated for most peak calling algorithms [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. For ChIP-nexus, it is not the size of the original fragments that is important, but rather the segment of DNA that cannot be digested because of steric interference by the formaldehyde cross-linked protein (the “protected region”). We present a method for estimating the average width of the protected region that is based on the notion of qfrags [<xref ref-type="bibr" rid="CR19">19</xref>] and show that, on the ChIP-nexus data, it yields unbiased signatures that are not affected by the so-called phantom peak [<xref ref-type="bibr" rid="CR20">20</xref>], which is not the case for the cross-correlation method developed for ChIP-seq [<xref ref-type="bibr" rid="CR2">2</xref>]. The estimates of the protected region width are in line with distances that were derived in a previous study of same data [<xref ref-type="bibr" rid="CR11">11</xref>] using integrated 5’ end coverage plots around predicted and motif-centered sites. Notably, our method derives signatures that are highly reproducible for biological replicates and specific for different factors.</p>
    <p>We have previously developed a method using “qfrag-analysis” to identify candidate peaks in ChIP-seq analysis [<xref ref-type="bibr" rid="CR19">19</xref>]. Here, we adapted that algorithm for ChIP-nexus analysis. We adopted the peak detection step using the qfrag coverage depth profile along the genome, but for ChIP-nexus data we keep duplicated reads, assuming that they originate from different molecules, and form qfrags using the average protected region width instead of fragment length. Regions bound by the protein of interest are surrounded by pile-ups of 5’ ends reads mapped to the forward and reverse strand and therefore will be emphasized in the qfrag depth profile. This approach differs from previous published peak pairing methods for ChIP-exo [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], in which peaks are detected separately for the forward and reverse strand and subsequently combined into pairs. The saturation-based method we presented for the evaluation ChIP-seq analysis involved a statistical analysis of the number of positions within candidate ChIP-seq peaks to which one or more 5’ read ends mapped. This approach is less suitable for ChIP-exo and ChIP-nexus analysis, in which we expected multiple, independent reads to map to the same position because of the exonuclease digestion. We therefore applied a statistical test based on a standard Poisson model of the count distribution. With respect to the IDR analysis framework applied to biological replicates, our results showed substantially better reproducibility than the other two methods we tested.</p>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In this study, we present an integrated analysis pipeline implemented in C++ for the analysis of ChIP-nexus and ChIP-exo data. The pipeline begins with efficient methods for preprocessing ChIP-nexus reads to remove PCR duplicates by exploiting information in the random barcodes included in ChIP-nexus adapters to recognize PCR duplicates. This step is skipped for ChIP-exo analysis. We introduce an algorithm that creates pseudo-controls from the data with which true signal can be differentiated from pseudo-peaks, which allows us to accurately estimate the width of the protected region. Our method then performs an analysis of the qfrag distribution to center candidate peaks and then performs a statistical analysis of the read depth distribution to identify peaks. We demonstrate that our method displays a higher reproducibility than other approaches to ChIP-nexus analysis. An efficient and easy-to-use implementation of our method is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/charite/Q">https://github.com/charite/Q</ext-link>.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Preprocessing of raw FASTQ reads</title>
      <p>We implemented an efficient Q-nexus preprocessing application, flexcat (that is based on flexbar [<xref ref-type="bibr" rid="CR26">26</xref>]), using the SeqAn C++ programming library [<xref ref-type="bibr" rid="CR27">27</xref>]. flexcat removes the random and the fixed barcodes, inserts the randomized barcode into the ID field of the sequence (for instance, TL:ATGCC would be added to the description line of a sequence with the random barcode ATGCC), and clips adapter sequences. In ChIP-nexus reads, the random barcode is followed directly by a fixed four-nucleotide barcode. Reads that display no fixed barcode or more than one different nucleotide within the fixed barcode are discarded.</p>
    </sec>
    <sec id="Sec13">
      <title>Read mapping</title>
      <p>In principle, Q-nexus can be used with any read mapper, whereby only uniquely mappable reads should be used for downstream analysis. In the experiments described in this work, we used bowtie [<xref ref-type="bibr" rid="CR16">16</xref>] version 1.1.2 with the settings —chunkmbs 512, -k 1, -m 1, —best, —strata.</p>
    </sec>
    <sec id="Sec14">
      <title>Processing of aligned reads</title>
      <p>We implemented an efficient tool called nexcat that scans BAM files in order to identify sets of PCR duplicates. The random barcode from the FASTQ description line is carried over into the BAM file, and can thus be used to distinguish PCR duplicates from IMUB reads. PCR duplicates are identified as sets of reads with an identical random barcode whose 5’ terminus is located at the same genomic position and all but one of those reads are discarded. Since Q-nexus peak calling utilizes only the 5’ end of each read, it does not matter which read is retained.</p>
    </sec>
    <sec id="Sec15">
      <title>Assessment of Q-nexus duplication levels</title>
      <p>Our method has three different ways of defining “duplication”. <italic>Identically mapped</italic> (IM) reads, are simply reads whose 5’ end maps to the identical chromosomal location. The information in the random barcodes is not relevant for the determination of IM reads. <italic>Identically mapped with identical barcode</italic> (IMIB) reads are defined as IM reads that additionally have an identical random barcode. The ChIP-nexus analysis pipeline [<xref ref-type="bibr" rid="CR11">11</xref>] removes all IMIB reads except one at each position. We name the remaining reads <italic>identically mapped with unique barcode</italic> (IMUB) reads (in the original publication, these reads were named “usable reads”). The duplication plots shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">b</xref>–<xref rid="Fig2" ref-type="fig">c</xref> provide an overview of IM, IMIB, and IMUB reads according to the proportion of reads that have a given duplication level (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). We calculate an overall duplication level as the proportion of reads with a duplication level of two or more among all reads. Table <xref rid="Tab2" ref-type="table">2</xref> shows the overall duplication levels according to each of the three definitions of “duplication”.</p>
    </sec>
    <sec id="Sec16">
      <title>Binding characteristics: qfrag length distribution and pseudo control</title>
      <p>We refer to 5’ end positions of reads that map either to the forward or the reverse strand as hits. The outcome of ChIP-nexus experiment is modeled as a set of hits: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} T=\{\ h=(\text{pos},\text{strand})\ |\ \text{pos} \in \{1,\ldots,l\} \wedge \text{strand} \in \{f,r\}\},  $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mspace width="1em"/><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtext>pos</mml:mtext><mml:mo>,</mml:mo><mml:mtext>strand</mml:mtext><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:mtext>pos</mml:mtext><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>}</mml:mo><mml:mo>∧</mml:mo><mml:mtext>strand</mml:mtext><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>}</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2016_3164_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>l</italic> is the length of the chromosome. A qfrag is defined to be the genomic interval between an ordered pair of hits (<italic>h</italic>
<sub><italic>i</italic></sub>,<italic>h</italic>
<sub><italic>j</italic></sub>), such that <italic>h</italic>
<sub><italic>i</italic></sub> is on the forward strand, <italic>h</italic>
<sub><italic>j</italic></sub> is on the reverse strand. For the distribution of qfrag-lengths qfrags of fixed lengths are considered and for each length <italic>δ</italic>=2,…,<italic>Δ</italic> the number of qfrags is determined: 
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$Q_{t}(\delta)=|\{(h_{i},h_{j})\ |\ h_{i} \in T_{f}\ \land\ h_{j} \in T_{r}\ \land h_{j}-h_{i}=\delta\}|. $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>∧</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>∧</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12864_2016_3164_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> The pseudo-control is derived from the original data by inverting the strand information for each given hit, i.e 
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} h^{\prime}.strand:=\left\{ \begin{array}{ll} f,&amp; \text{if}\ h.strand=r\\ r, &amp; \text{otherwise} \end{array}\right. \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>.strand</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mi>h.strand</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>r</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2016_3164_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>and subsequently shifting the (strand inverted) hit by one read length <italic>rl</italic> towards 5’ end, i.e. 
<disp-formula id="Equd"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} h^{\prime}.pos:=\left\{ \begin{array}{ll} h.pos+rl-1,&amp; \text{if}\ h^{\prime}.strand=r\\ h.pos-rl+1, &amp; \text{otherwise} \end{array}\right. \end{array} $$ \end{document}</tex-math><mml:math id="M8"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>.pos</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mi>h.pos</mml:mi><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">rl</mml:mtext><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>.strand</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>h.pos</mml:mi><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">rl</mml:mtext><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2016_3164_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>The distribution of qfrag-length in the pseudo-control is defined as before: 
<disp-formula id="Eque"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$Q_{p}(\delta)=|\{(h^{\prime}_{i},h^{\prime}_{j})\ |\ h^{\prime}_{i} \in T^{\prime}_{f}\ \land\ h^{\prime}_{j} \in T^{\prime}_{r}\ \land h^{\prime}_{j}-h^{\prime}_{i}=\delta\}|. $$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mo>∧</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mo>∧</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12864_2016_3164_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> We use the difference between <italic>Q</italic>
<sub><italic>t</italic></sub>(<italic>δ</italic>) and <italic>Q</italic>
<sub><italic>p</italic></sub>(<italic>δ</italic>) as signature and the maximum value as estimate for the protected-region width <italic>ℓ</italic>
<sup>′′′</sup>, i.e. 
<disp-formula id="Equf"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\ell^{\prime\prime\prime}={\underset{\delta}{\text{arg max}}}\, Q_{t}(\delta)-Q_{p}(\delta). $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>′′′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>arg max</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12864_2016_3164_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>
</p>
    </sec>
    <sec id="Sec17">
      <title>Evaluation: Binding characteristics</title>
      <sec id="Sec18">
        <title>5’ end coverage around motif centered binding sites</title>
        <p>For each dataset summits were derived using Q [<xref ref-type="bibr" rid="CR19">19</xref>] with the following parameter settings: —fragment- length-average 15, —fragment-length- deviation 10, —keep-dup and sorted by significance. The top 2,000 peaks (summit position ± 40) were used for a de novo motif analysis with DREME [<xref ref-type="bibr" rid="CR28">28</xref>] using default settings. The top 30,000 peaks were filtered for those with an occurrence of the top motif in a distance of at most the length of the motif. Finally, the selected summits were centered to the center of the motif occurrence. Around the motif filtered and centered sites the integrated distribution of 5’ ends were determined using Q with the following parameter settings: —bed-hit-dist &lt;CENTERED_SITES_BED&gt;,—keep-dup, —pseudo-control.</p>
      </sec>
      <sec id="Sec19">
        <title>Cross-correlation analysis</title>
        <p>We performed cross-correlation analysis using the function get.binding.characteristics of the SPP package (version 1.11) with the following parameter settings: srange=c(2,110),bin=1.</p>
      </sec>
      <sec id="Sec20">
        <title>MACS2</title>
        <p>The predicted fragment lengths were derived in the course of peak calling with parameter settings as stated below.</p>
      </sec>
      <sec id="Sec21">
        <title>MACE</title>
        <p>The optimal border pair sizes of MACE were derived in the course of peak calling with parameter settings as stated below.</p>
      </sec>
      <sec id="Sec22">
        <title>qfrag-length distribution with pseudo-control</title>
        <p>We derived qfrag-length distributions using Q with the following parameter settings: —qfrag-length-distribution, —step-num 110, —keep-dup.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>ChIP-nexus peak calling</title>
      <p>We use <italic>q</italic>
<sub><italic>min</italic></sub>=<italic>ℓ</italic>
<sup>′′′</sup>−<italic>x</italic> and <italic>q</italic>
<sub><italic>max</italic></sub>=<italic>ℓ</italic>
<sup>′′′</sup>+<italic>x</italic> to form qfrags from all hits on the forward and reverse strand that satisfy <italic>q</italic>
<sub><italic>min</italic></sub>≤<italic>hj</italic>.<italic>pos</italic>−<italic>hi</italic>.<italic>pos</italic>≤<italic>q</italic>
<sub><italic>max</italic></sub>. We used a value of <italic>x</italic>=5 by default, which is a parameter for the deviation from estimated protected-region width.</p>
      <p>We calculate the depth of qfrags at any given position and search the qfrag coverage profile along the genome for free-standing local maxima which we refer to as summits that correspond to predicted binding positions, where free-standing means that there is no position with a higher qfrag depth within a radius of <italic>q</italic>
<sub><italic>min</italic></sub>. For each summit <italic>s</italic>
<sub><italic>i</italic></sub> the number of 5’ ends within the range <italic>s</italic>
<sub><italic>i</italic></sub>−<italic>q</italic>
<sub><italic>max</italic></sub>,…,<italic>s</italic>
<sub><italic>i</italic></sub>+<italic>q</italic>
<sub><italic>max</italic></sub>, denoted as <italic>k</italic>, is determined. Assuming a null model in which reads are evenly distributed across the genome, <italic>P</italic>-values are calculated using the Poisson distribution. 
<disp-formula id="Equg"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P(x \geq k)=1-\sum_{i=0}^{k-1}\text{Pois}(i,\lambda) $$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>≥</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mtext>Pois</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2016_3164_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> where 
<disp-formula id="Equh"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\lambda=2 \cdot q_{max} \cdot \frac{|T_{f}|+|T_{r}|}{l} $$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">max</mml:mtext></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12864_2016_3164_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> All regions covered by at least one qfrag are tested. P-values are corrected for multiple testing using the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    </sec>
    <sec id="Sec24">
      <title>Evaluation: reproducibility of peak calling</title>
      <p>IDR analyses were performed with parameter settings recommended for pairs of biological replicates. Peak lists were derived for Q-nexus, MACS2 and MACE as stated below.</p>
      <sec id="Sec25">
        <title>Peak calling parameters for Q-nexus</title>
        <p>We used version 1.3.0 of Q with the following parameter settings: —nexus-mode, —top-n 200,000. Q-nexus predicts single binding positions or summits. The summits were extended by 2 bp in upstream and downstream direction, sorted by signal score, i.e. the number of 5’ ends that map for a given summit <italic>s</italic>
<sub><italic>i</italic></sub> into the range <italic>s</italic>
<sub><italic>i</italic></sub>−<italic>q</italic>
<sub><italic>max</italic></sub>,…,<italic>s</italic>
<sub><italic>i</italic></sub>−<italic>q</italic>
<sub><italic>max</italic></sub>, and only the top 100,000 were kept.</p>
      </sec>
      <sec id="Sec26">
        <title>Peak calling parameters for MACS2</title>
        <p>We used version 2.1.0.20150731 of MACS2 in the callpeak mode with the following parameter settings —keep-dup all, —pvalue 5e-01, —call-
summits. Furthermore, we used —gsize dm for Drosophila and —gsize hs for Human to specify the size of the genome. MACS2 tends to combine multiple adjacent summits into broader broader peaks and only reports the highest summit position, but the option —call-summits causes MACS2 to report all summits. The summits were extended by 2 bp in upstream and downstream direction, sorted by P-value, and only the top 100,000 were kept.</p>
      </sec>
      <sec id="Sec27">
        <title>Peak calling parameters for MACE</title>
        <p>We used version 1.2 of MACE. The python script for preprocessing was used with the following parameter settings: —kmerSize 0, which turns off the nucleotide bias correction. We did this, because according to the implementation the length of each read has to be greater than three times the kmer-size. Discarding all (clipped) reads shorter than 19 leads to a significant loss of information. The python script for peak calling was used with the following parameter settings: —pvalue 0.99. The MACE algorithm does not report peaks, but border pairs, i.e. pairs of peaks on the forward and reverse strand with a distance that approximates to a optimal border pair size that is estimated from the data. We defined the centers between the border pairs as summits. The summits were extended by 2 bp in upstream and downstream direction, sorted by <italic>P</italic>-value, and only the top 100,000 were kept.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec28">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12864_2016_3164_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Supplementary figures and tables.</bold> The following additional data are available with the online version of this paper. Additional data file 1 contains an explanatory figure for duplication levels as well as figures and tables for additional analyses including duplication rate plots, examples for mapping artifacts, 5’ end coverage around motif centered binding sites, cross-correlation plots, qfrag-length distributions, scatterplots of signal scores of overlapping peaks and corresponding IDR plots, as well as two tables containing the total numbers of overlapping peaks and overlapping peaks with IDR ≤ 0.01 for all pairs of biological replicates. (PDF 3840 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>Bp</term>
        <def>
          <p>Base pairs</p>
        </def>
      </def-item>
      <def-item>
        <term>IM</term>
        <def>
          <p>Identically mapped</p>
        </def>
      </def-item>
      <def-item>
        <term>IMIB</term>
        <def>
          <p>Identically mapped with identical barcode</p>
        </def>
      </def-item>
      <def-item>
        <term>IMUB</term>
        <def>
          <p>Identically mapped with unique barcode</p>
        </def>
      </def-item>
      <def-item>
        <term>IDR</term>
        <def>
          <p>Irreproducible discovery rate</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Jeffrey Johnston of the Zeitlinger lab who tested the Q-nexus software.</p>
    <sec id="d30e2919">
      <title>Funding</title>
      <p>This project was supported by the Bundesministerium für Bildung und Forschung (BMBF; project no. 0313911 and 13GW0099) and the European Community’s Seventh Framework Programme (grant agreement no. 602300; SYBIL). Furthermore, we acknowledge support of the Spanish Ministry of Economy and Competitiveness, ‘Centro de Excelencia Severo Ochoa 2013-2017’.</p>
    </sec>
    <sec id="d30e2924">
      <title>Availability of data and materials</title>
      <p>All the genomic data used for analyses are freely available to be downloaded from the GEO repository (GSE55306). Additional tools used for analyses are freely available and details are given in the methods section.</p>
    </sec>
    <sec id="d30e2929">
      <title>Authors’ contributions</title>
      <p>PH conceived and developed the methods for the estimation of the protected-region width and ChIP-nexus peak calling, conducted the reproducibility analysis, and wrote the manuscript. BSM and SR conceived and developed the algorithms for the preprocessing of ChIP-nexus data. MT, JH and JIS assisted with the analysis in the paper and provided biological insights into the ChIP-nexus procedure. PNR helped develop the algorithm, supervised the analysis, and wrote the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d30e2934">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d30e2939">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d30e2944">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hirst</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bainbridge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bilenky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Euskirchen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bernier</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Varhol</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thiessen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing</article-title>
        <source>Nat Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>651</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth1068</pub-id>
        <?supplied-pmid 17558387?>
        <pub-id pub-id-type="pmid">17558387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Tolstorukov</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1351</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1508</pub-id>
        <?supplied-pmid 19029915?>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valouev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sundquist</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Anton</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of transcription factor binding sites based on ChIP-Seq data</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <issue>9</issue>
        <fpage>829</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1246</pub-id>
        <?supplied-pmid 19160518?>
        <pub-id pub-id-type="pmid">19160518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq and beyond: new and improved methodologies to detect and characterize protein-DNA interactions</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>840</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3306</pub-id>
        <?supplied-pmid 23090257?>
        <pub-id pub-id-type="pmid">23090257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhee</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>BF</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive genome-wide protein-DNA interactions detected at single-nucleotide resolution</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>147</volume>
        <issue>6</issue>
        <fpage>1408</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.11.013</pub-id>
        <?supplied-pmid 22153082?>
        <pub-id pub-id-type="pmid">22153082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhee</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>BF</given-names>
          </name>
        </person-group>
        <article-title>ChIP-exo method for identifying genomic location of DNA-binding proteins with near-single-nucleotide accuracy</article-title>
        <source>Curr Protoc Mol Biol</source>
        <year>2012</year>
        <volume>Chapter 21</volume>
        <fpage>21</fpage>
        <lpage>4</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Serandour</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Development of an Illumina-based ChIP-exonuclease method provides insight into FoxA1-DNA binding properties</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>12</issue>
        <fpage>147</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-12-r147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wales</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hashemi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blais</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Global MEF2 target gene analysis in cardiac and skeletal muscle reveals novel regulation of DUSP6 by p38MAPK-MEF2 signaling</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>18</issue>
        <fpage>11349</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku813</pub-id>
        <?supplied-pmid 25217591?>
        <pub-id pub-id-type="pmid">25217591</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Shukla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Menendez-Benito</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Norman-Axelsson</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Audergon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tanny</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Allshire</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Ekwall</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A nucleosome turnover map reveals that the stability of histone H4 Lys20 methylation depends on histone recycling in transcribed chromatin</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>872</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.188870.114</pub-id>
        <?supplied-pmid 25778913?>
        <pub-id pub-id-type="pmid">25778913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Starick</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Ibn-Salem</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jurk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thomas-Chollier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meijsing</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>ChIP-exo signal associated with DNA-binding motifs provides insight into the genomic binding of the glucocorticoid receptor and cooperating transcription factors</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>825</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.185157.114</pub-id>
        <?supplied-pmid 25720775?>
        <pub-id pub-id-type="pmid">25720775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zeitlinger</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>ChIP-nexus enables improved detection of in vivo transcription factor binding footprints</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>4</issue>
        <fpage>395</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3121</pub-id>
        <?supplied-pmid 25751057?>
        <pub-id pub-id-type="pmid">25751057</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Identifying ChIP-seq enrichment using MACS</article-title>
        <source>Nat Protoc</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>1728</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2012.101</pub-id>
        <?supplied-pmid 22936215?>
        <pub-id pub-id-type="pmid">22936215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Uusküla-Reimand</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Medina-Rivera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kocher</surname>
            <given-names>J-PA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>MACE: model based analysis of ChIP-exo</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>20</issue>
        <fpage>156</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Madrigal</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>CexoR: an R/bioconductor package to uncover high-resolution protein-DNA interactions in ChIP-exo replicates</article-title>
        <source>EMBnet.journal.</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>e837</fpage>
        <pub-id pub-id-type="doi">10.14806/ej.21.0.837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Measuring reproducibility of high-throughput experiments</article-title>
        <source>Ann Appl Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>1752</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Daley T, Smith AD, Angeles L, Biology C. Predicting the molecular complexity of sequencing libraries. 2013; 10(4):325–7. doi:10.1038/nmeth.2375.Predicting.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Andrews SR. FastQC: a quality control tool for high throughput sequence data. 2010. <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc">http://www.bioinformatics.babraham.ac.uk/projects/fastqc</ext-link>. Accessed 1 Aug 2016.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hecht</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Krannich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Truss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>PN</given-names>
          </name>
        </person-group>
        <article-title>Saturation analysis of ChIP-seq data for reproducible identification of binding peaks</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>9</issue>
        <fpage>1391</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.189894.115</pub-id>
        <?supplied-pmid 26163319?>
        <pub-id pub-id-type="pmid">26163319</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marinov</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kheradpour</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pauli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cayting</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Desalvo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fisher-Aylor</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Euskirchen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hartemink</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Karmakar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kharchenko</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pazin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Slattery</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tolstorukov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Farnham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lieb</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>1813</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.136184.111</pub-id>
        <?supplied-pmid 22955991?>
        <pub-id pub-id-type="pmid">22955991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carroll</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Salama</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>de Santiago</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Impact of artifact removal on ChIP quality metrics in ChIP-seq and ChIP-exo data</article-title>
        <source>Front Genet</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>April</issue>
        <fpage>75</fpage>
        <?supplied-pmid 24782889?>
        <pub-id pub-id-type="pmid">24782889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title>
        <source>J R Stat Soc Series B (Methodological)</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Li Q, Brown B, Huang H, Bickel P. IDR analysis 101 Measuring consistency between replicates in high-throughput experiments. 2010.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq: advantages and challenges of a maturing technology</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>669</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2641</pub-id>
        <?supplied-pmid 19736561?>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>The analysis of ChIP-Seq data</article-title>
        <source>Methods Enzymol</source>
        <year>2011</year>
        <volume>497</volume>
        <fpage>51</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/B978-0-12-385075-1.00003-2</pub-id>
        <?supplied-pmid 21601082?>
        <pub-id pub-id-type="pmid">21601082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dodt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Roehr</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dieterich</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Flexbar-flexible barcode and adapter processing for next-generation sequencing platforms</article-title>
        <source>Biology (Basel)</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>895</fpage>
        <lpage>905</lpage>
        <pub-id pub-id-type="pmid">24832523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Döring</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weese</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>SeqAn an efficient, generic C++ library for sequence analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-11</pub-id>
        <?supplied-pmid 18184432?>
        <pub-id pub-id-type="pmid">18184432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>DREME: motif discovery in transcription factor ChIP-seq data</article-title>
        <source>Bioinformatics (Oxford)</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>12</issue>
        <fpage>1653</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr261</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
