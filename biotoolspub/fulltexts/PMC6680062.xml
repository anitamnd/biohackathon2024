<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Virus Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Virus Evol</journal-id>
    <journal-id journal-id-type="publisher-id">vevolu</journal-id>
    <journal-title-group>
      <journal-title>Virus Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-1577</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6680062</article-id>
    <article-id pub-id-type="pmid">31392032</article-id>
    <article-id pub-id-type="doi">10.1093/ve/vez028</article-id>
    <article-id pub-id-type="publisher-id">vez028</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DISSEQT—DIStribution-based modeling of SEQuence space Time dynamics<xref ref-type="author-notes" rid="vez028-FM1"><sup>†</sup></xref></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Henningsson</surname>
          <given-names>R</given-names>
        </name>
        <xref ref-type="aff" rid="vez028-aff1">1</xref>
        <xref ref-type="aff" rid="vez028-aff2">2</xref>
        <xref ref-type="aff" rid="vez028-aff3">3</xref>
        <xref ref-type="aff" rid="vez028-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moratorio</surname>
          <given-names>G</given-names>
        </name>
        <xref ref-type="aff" rid="vez028-aff2">2</xref>
        <xref ref-type="aff" rid="vez028-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bordería</surname>
          <given-names>A V</given-names>
        </name>
        <xref ref-type="aff" rid="vez028-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vignuzzi</surname>
          <given-names>M</given-names>
        </name>
        <xref ref-type="aff" rid="vez028-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fontes</surname>
          <given-names>M</given-names>
        </name>
        <xref ref-type="aff" rid="vez028-aff3">3</xref>
        <xref ref-type="aff" rid="vez028-aff6">6</xref>
        <xref ref-type="aff" rid="vez028-aff7">7</xref>
        <xref ref-type="aff" rid="vez028-aff8">8</xref>
        <xref ref-type="corresp" rid="vez028-cor1"/>
        <!--<email>fontes.magnus@gene.com</email>-->
      </contrib>
    </contrib-group>
    <aff id="vez028-aff1"><label>1</label>The Centre for Mathematical Sciences, Lund University, Sweden</aff>
    <aff id="vez028-aff2"><label>2</label>Viral Populations and Pathogenesis Unit, Institut Pasteur, Paris, France</aff>
    <aff id="vez028-aff3"><label>3</label>The International Group for Data Analysis, Institut Pasteur, Paris, France</aff>
    <aff id="vez028-aff4"><label>4</label>Division of Clinical Genetics, Lund University, Sweden</aff>
    <aff id="vez028-aff5"><label>5</label>Laboratorio de Virología Molecular, Universidad de la República, Montevideo, Uruguay</aff>
    <aff id="vez028-aff6"><label>6</label>Department of Cancer Immunology, Genentech, South San Francisco, CA, USA</aff>
    <aff id="vez028-aff7"><label>7</label>The Center for Genomic Medicine, Rigshospitalet, Copenhagen, Denmark</aff>
    <aff id="vez028-aff8"><label>8</label>Persimune, The Centre of Excellence for Personalized Medicine, Copenhagen, Denmark</aff>
    <author-notes>
      <corresp id="vez028-cor1">Corresponding author: E-mail: <email>fontes.magnus@gene.com</email></corresp>
      <fn id="vez028-FM1">
        <p>Special Issue Santa Fe Institute Workshop on Integrating Critical Phenomena and Multi-Scale Selection in Virus Evolution, supported by the NSF Rules of Life Program grant DEB-1830688.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-08-05">
      <day>05</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>5</volume>
    <issue>2</issue>
    <elocation-id>vez028</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vez028.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Rapidly evolving microbes are a challenge to model because of the volatile, complex, and dynamic nature of their populations. We developed the DISSEQT pipeline (DIStribution-based SEQuence space Time dynamics) for analyzing, visualizing, and predicting the evolution of heterogeneous biological populations in multidimensional genetic space, suited for population-based modeling of deep sequencing and high-throughput data. The pipeline is openly available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/rasmushenningsson/DISSEQT.jl">https://github.com/rasmushenningsson/DISSEQT.jl</ext-link>, accessed 23 June 2019) and Synapse (<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#&amp;excl;Synapse:syn11425758">https://www.synapse.org/#!Synapse: syn11425758</ext-link>, accessed 23 June 2019), covering the entire workflow from read alignment to visualization of results. Our pipeline is centered around robust dimension and model reduction algorithms for analysis of genotypic data with additional capabilities for including phenotypic features to explore dynamic genotype–phenotype maps. We illustrate its utility and capacity with examples from evolving RNA virus populations, which present one of the highest degrees of genetic heterogeneity within a given population found in nature. Using our pipeline, we empirically reconstruct the evolutionary trajectories of evolving populations in sequence space and genotype–phenotype fitness landscapes. We show that while sequence space is vastly multidimensional, the relevant genetic space of evolving microbial populations is of intrinsically low dimension. In addition, evolutionary trajectories of these populations can be faithfully monitored to identify the key minority genotypes contributing most to evolution. Finally, we show that empirical fitness landscapes, when reconstructed to include minority variants, can predict phenotype from genotype with high accuracy.</p>
    </abstract>
    <kwd-group>
      <kwd>multidimensional scaling</kwd>
      <kwd>quasispecies</kwd>
      <kwd>NGS</kwd>
      <kwd>applied mathematics</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Defense Advanced Research Projects Agency</named-content>
          <named-content content-type="funder-identifier">10.13039/100000185</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">DARPA</named-content>
          <named-content content-type="funder-identifier">10.13039/100000185</named-content>
        </funding-source>
        <award-id>HR00111720023</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1. Introduction</title>
    <p>Microbial infections, by viruses and bacteria, initially colonize their host as small, quite homogeneous populations, but short generation times and relatively high mutation rates quickly lead to large populations of high genetic diversity. It is well accepted that this diversity facilitates adaptation to the host through selection of variants from this pool of mutants, in response to environmental change (<xref rid="vez028-B11" ref-type="bibr">Domingo, Sheldon, and Perales 2012</xref>). With the advent of DNA sequencing, viruses and bacteria were the first organisms to be fully sequenced phage MS2 in 1975 (<xref rid="vez028-B12" ref-type="bibr">Fiers et al. 1976</xref>); <italic>H</italic>aemophilus <italic>influenzae</italic> (<xref rid="vez028-B13" ref-type="bibr">Fleischmann et al. 1995</xref>); and <italic>M</italic>ycoplasma <italic>genitalium</italic> (<xref rid="vez028-B16" ref-type="bibr">Fraser et al. 1995</xref>) and the study of microbial evolution by phylogenetics has benefited from the hundreds to tens of thousands of consensus sequence genomes available for many microorganisms. More recently, High-throughput sequencing (HTS) technologies have added new depth to sequence data, capable of quantifying minority variants within the population that differ from the consensus sequence. For example, HTS studies of RNA viruses indicate that both experimental and clinical samples present hundreds to tens of thousands of low-frequency variants, constituting single nucleotide polymorphisms at nearly every nucleotide site along the genome (<xref rid="vez028-B1" ref-type="bibr">Acevedo, Brodsky, and Andino 2014</xref>; <xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>). Even before HTS, phenotypic differences between populations with the same consensus sequence have been observed and attributed to suspected differences in variant composition (<xref rid="vez028-B43" ref-type="bibr">Vignuzzi et al. 2006</xref>). However, characterization of these mutant ‘swarms’ has generally been limited to mean measures of overall diversity (e.g. Shannon entropy, mean variance, etc.). In a few cases, examples of mixed populations of single nucleotide variations were shown to contribute significantly to virus pathogenesis (<xref rid="vez028-B43" ref-type="bibr">Vignuzzi et al. 2006</xref>), fitness, and phenotype (<xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>; <xref rid="vez028-B47" ref-type="bibr">Xue et al. 2016</xref>), but focused on only a few variants. Since a mixed population can constitute an evolutionary stable strategy (ESS) (<xref rid="vez028-B38" ref-type="bibr">Smith and Price 1973</xref>; <xref rid="vez028-B35" ref-type="bibr">Reiter et al. 2015</xref>), the population might aim for an equilibrium where multiple variants coexist.</p>
    <p>The rapidly expanding field of single-cell sequencing illustrates how the role of heterogeneity in general can be studied in more and more detail. The data is however complex and noisy, which presents new challenges in the development of algorithms and techniques for analysis, representation, and visualization (<xref rid="vez028-B3" ref-type="bibr">Bacher and Kendziorski 2016</xref>; <xref rid="vez028-B17" ref-type="bibr">Gawad, Koh, and Quake 2016</xref>; <xref rid="vez028-B41" ref-type="bibr">Svensson et al. 2016</xref>; <xref rid="vez028-B33" ref-type="bibr">Perkel 2017</xref>; <xref rid="vez028-B36" ref-type="bibr">Russell, Trapnell, and Bloom 2017</xref>). Although phylogenetic tools are well suited for understanding the evolutionary history of lineages and the relationships between lineages/individuals based on whole-genome consensus sequence data, they cannot take into account the variant composition hidden by the consensus. <xref rid="vez028-B22" ref-type="bibr">Higgins (1992</xref>) circumvents these issues by applying multidimensional scaling (MDS) for exploratory analysis, keeping distances between samples more in line with the measured quantities. PhyloMap (<xref rid="vez028-B50" ref-type="bibr">Zhang et al. 2011</xref>) superimposes phylogenetic trees on the MDS representation, trying to get the best from both worlds. Relying on consensus sequences only, these models are, however, not well suited for comparison of populations that might be identical at the consensus level but with key differences in the minority variant composition. Other tools are thus needed to adequately represent and visualize a microbial population in sequence space, focusing on where something is, rather than how it got there. Theoretical fitness landscape models, including Wright's (<xref rid="vez028-B46" ref-type="bibr">Wright 1932</xref>) and the NK landscapes (<xref rid="vez028-B23" ref-type="bibr">Kauffman and Weinberger 1989</xref>) of Kauffman using two parameters to model the landscape ruggedness paved the way for more recent advances where landscape models are (partially) based on empirical data. One approach is to study the impact of mutations at a few loci only (<xref rid="vez028-B44" ref-type="bibr">Whitlock and Bourguet 2000</xref>; <xref rid="vez028-B9" ref-type="bibr">Collins et al. 2004</xref>), thus artificially enforcing a low dimension of sequence space. To expand the fitness landscape analysis to a higher dimensional setting, <xref rid="vez028-B24" ref-type="bibr">Kouyos et al. (2012</xref>) utilized predictive models for <italic>in vitro</italic> fitness based on the amino acid sequence. For RNA viruses, the mathematical framework provided by the quasispecies theory has been used to describe the population dynamics of these pathogens (<xref rid="vez028-B6" ref-type="bibr">Biebricher and Eigen 2006</xref>). <xref rid="vez028-B37" ref-type="bibr">Seifert et al. (2015</xref>) assumed that viral populations reached mutation-selection equilibrium and applied the quasispecies equation to infer fitness values for the haplotypes in a swarm. However, it is generally accepted that mutation-selection balance is not reached throughout most stages of infection and under most experimental conditions.</p>
    <p>Nevertheless, it is tempting to think a proper analysis of an evolving population may foretell whether and where the population will move in genotypic space (<xref rid="vez028-B39" ref-type="bibr">Stapleford et al. 2014</xref>). We believe that to attempt such an analysis, in an accurate and unbiased manner, we need to consider the mutant swarm (a population of closely related viral particles) in its entirety, rather than just the consensus sequence (the most frequent residue at each position) or other oversimplifications of the complex population structure. Minority variants (variant present in the swarm, but not in the consensus sequence) should be included in the analysis and not subjected to an arbitrary cutoff frequency. Viruses, the fastest mutators with small genomes, make ideal model organisms for studying short time-scale population dynamics and will thus be used to showcase the methods developed in this work.</p>
    <p>Here, we present DISSEQT (DIStribution-based SEQuence space Time dynamics)—a pipeline for analyzing evolution of microbial populations. At the core is the ability to accurately represent the genetic heterogeneity of a mutant swarm, by modeling the population as a distribution over sequence space, thus making it possible to describe similarities and differences between populations down to the minority level, and to couple sequence space composition to phenotypic effects. We demonstrate the DISSEQT pipeline with examples from RNA virus evolution. First, we show how the DISSEQT sequence space model can uncover biologically relevant features. Second, we followed the evolutionary trajectories of longitudinal samples of experimentally evolved viral populations. Finally, by developing a fitness landscape model based on empirical fitness measurements, we demonstrate how phenotypic effects can be predicted from the population composition. Specifically, we show that the sequence space in which viral populations evolve are of relatively low dimension, and that biologically relevant signals can be readily captured and used to identify the key variants contributing most to phenotype. We confirm that minority variants contribute significantly to phenotype and must be taken into account for accuracy of genotype–phenotype prediction.</p>
  </sec>
  <sec>
    <title>2. Results</title>
    <sec>
      <title>2.1 Overview of the DISSEQT pipeline</title>
      <p>The DISSEQT pipeline (<xref ref-type="fig" rid="vez028-F1">Fig. 1</xref>, top panel) is designed for reproducibility and openness, from the ground up, using modern software solutions. The source code is openly available in GitHub and all software dependencies are open source. The software can either be installed locally or run directly from Docker images with all required software preinstalled. Running from Docker images simplifies setup and improves reproducibility since differences between local runtime environments are eliminated.
</p>
      <fig id="vez028-F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Top: The DISSEQT pipeline. The yellow boxes represent algorithms and data management. The blue boxes represent plots and other output. The analysis history of all results and plots can be traced back all the way to the raw input data. Steps that are only used in some analyses are displayed in gray text. <italic>Sequence Space Representation</italic>: Per sample raw sequencing data is passed through automatic quality control and aligned to a reference genome. Codon frequencies are inferred using quality scores in the aligned data and the limit of detection is estimated for each codon at each site. These are combined to form the sequence space representation. Consensus change reports and read coverage plots aid manual quality inspection. <italic>Noise Reduction</italic>: Median filtering along the time axis is used for time series data. Talus plots are used for dimension estimation and SMSSVD reduces the dimension robustly. <italic>Visualization and Prediction</italic>: Variable selection can be used for finding a small subset of explanatory variables. Nonlinear dimension reduction captures important features for low dimensional visualization of sequence space. Evolutionary trajectories are described in both sample and variable space. Fitness landscape models are used for visualization and prediction. Bottom left: <italic>Talus plot</italic> for the SynSyn data set. After thirteen dimensions, the Talus plot shows small variations around a low mean. Bottom right: <italic>Projection Score Plot</italic> for the SynSyn data set. SMSSVD finds three signals of Dimensions 3, 5, and 5 with different optima for variance filtering. Each curve displays the projection score of a signal as a function of the variance filtering threshold.</p>
        </caption>
        <graphic xlink:href="vez028f1"/>
      </fig>
      <p>The overview described here is detailed in Section 4. The DISSEQT pipeline has three steps, serving different purposes. (1) Establishing a model for sequence space. (2) Reducing noise to make the model robust. (3) Visualization and phenotype prediction.</p>
      <p>First, the raw reads for each sample (mutant swarm) were aligned iteratively until the consensus sequence converged and both automatic and manual quality controls were performed. Maximum likelihood estimation was used to infer the codon frequencies for each position, using all reads overlapping that position, based on a multinomial model with noisy observations (due to sequencing errors). An initial sequence space representation was then constructed using the codon frequencies and a limit of detection estimated for each possible variant at each site, since sequencing error rates depend on the nucleotide context (<xref rid="vez028-B26" ref-type="bibr">Laehnemann, Borkhardt, and McHardy 2016</xref>) and the type of substitution (<xref rid="vez028-B15" ref-type="bibr">Fox et al. 2014</xref>). In this article, we focus on coding regions, which makes codons the natural basis for sequence space modeling, since they are closely connected to biological function and this choice does not impose any assumptions about the relative importance of synonymous versus nonsynonymous changes. All methods presented here are also applicable to non-coding regions, by basing the sequence space model on nucleotides rather than codons.</p>
      <p>Second, a dimension estimate of the data was obtained by generating a Talus plot (<xref ref-type="fig" rid="vez028-F1">Fig. 1</xref>, bottom left panel, and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>), after which noise reduction was performed by SubMatrix Selection Singular Value Decomposition (SMSSVD) (<xref rid="vez028-B21" ref-type="bibr">Henningsson and Fontes 2019</xref>). SMSSVD is ideal for situations where complex data containing a very large number of variables have signals spread out over different (possibly overlapping) subsets of variables, with the goal of recovering all signals that can be detected, rather than only the strongest one.</p>
      <p>Finally, the resulting sequence space representation was used for visualization and phenotype prediction. The evolutionary trajectories of viral populations were followed through time, using sparse methods to find low-frequency minority variants arising and driving the movement of the population in sequence space. Empirical fitness values were used to create fitness landscapes for prediction, using the population representations from Step 2, and for visualization, after an additional nonlinear dimension reduction step vital for getting a useful representation in 2d. The sequence space model created by the DISSEQT pipeline is also intended to be used as input to other software packages, e.g. for clustering and regression.</p>
    </sec>
    <sec>
      <title>2.2 Generation of synthetic synonymous viral lineages with altered localization in sequence space and different minority variant compositions</title>
      <p>Our goal was to develop and evaluate a pipeline that can capture the discrete signals within the mutant swarms in clinical or experimental samples—essentially, to monitor and analyze evolving populations before significant changes to consensus sequences occur. To do so, we generated samples of mutant swarms, bearing differences in minority variants. We used four genetically trackable virus populations that derived from the same infectious clone wild type Coxsackie virus B3. Within the capsid-coding region of wild type virus, 117 Serine and Leucine codons are represented by all six codons for each amino acid. We generated three additional synthetic synonymous (SynSyn) virus lineages (<xref ref-type="fig" rid="vez028-F2">Fig. 2</xref>), some of which were previously published (<xref rid="vez028-B31" ref-type="bibr">Moratorio et al. 2017</xref>), in which these 117 codons were changed to belong exclusively to only one of three codon categories. These lineages were designed to retain the initial functional neutrality (i.e. same protein sequence), while occupying different starting points and potentially different trajectories in sequence space. Indeed, the differences in fitness values and phenotypes are small in comparison to the differences we observe within the lineages in the experiments described below (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). However, the lineages should behave differently as mutations accumulate at these codons, by accessing different mutational neighborhoods with differing impacts of virus fitness.
</p>
      <fig id="vez028-F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Right: Clusters of Leu/Ser codons according to different viral lineages. Color coding corresponds to synonymous codons used to genetic engineered each viral lineage ‘Blue Lineage’ (blue), ‘Green Lineage’ (green), or ‘Red Lineage’ (red). Left: Schematic of the Coxsackie virus genome indicating RNA structures required for replication (5′UTR, IRES, CRE, and 3′UTR) and the single open reading frame encoding capsid structural proteins (P1 region) and non-structural proteins (P2, P3 regions). The P1 region, in expanded view, shows 117 Ser/Leu codons for the wildtype (WT), blue, green, and red viral lineages.</p>
        </caption>
        <graphic xlink:href="vez028f2"/>
      </fig>
      <p>Next, to introduce changes in minority variant composition without significantly altering consensus sequences of the mutant swarms, we evolved these virus populations in different conditions. Wild type and SynSyn viruses were serially passaged five times in triplicate in normal conditions, as well as in five different mutagenic conditions that are known to increase this virus's mutation rate (<xref rid="vez028-B4" ref-type="bibr">Beaucourt et al. 2011</xref>) three base analogs (ribavirin, 5-fluorouracil, and 5-azacytidine), amiloride, and Mn<sup>2+</sup>. Low to moderate concentrations were used to accelerate evolution, while higher concentrations were employed to exacerbate fitness effects. We thus obtained 411 mutant swarms (301 passing strict quality controls) from these varied growth conditions, which were deep sequenced to obtain their entire variant compositions. Importantly, passaged samples in each lineage did not have significant consensus changes (in total across the samples, 144 substitutions at 4 different receptor binding sites and 35 substitutions at 12 other sites).</p>
    </sec>
    <sec>
      <title>2.3 DISSEQT reveals that the sequence space occupied by evolving viral populations is of intrinsically low dimensionality</title>
      <p>Theoretical sequence space is incredibly large, even for a small genome of length <inline-formula id="IE1"><mml:math id="IM1"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10,000</mml:mn></mml:math></inline-formula>, the number of possible sequences is <inline-formula id="IE2"><mml:math id="IM2"><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>4</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>6020</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, so large that the number of atoms in the universe is miniscule in comparison. The number of sequences reachable within just <inline-formula id="IE3"><mml:math id="IM3"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula> mutations, <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>1.6</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>38</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is still vast, and it is unknown how much of sequence space is occupied by an evolving viral population. We generated Talus and Projection Score (<xref rid="vez028-B14" ref-type="bibr">Fontes and Soneson 2011</xref>) plots from the sequence data, which provide a visualization of how the contents of a data set spread out across different dimensions. These plots provide a qualitative estimate of the number of dimensions needed to capture all biologically relevant signals that stand out above the background noise. As shown in <xref ref-type="fig" rid="vez028-F1">Fig. 1</xref>, bottom left panel, the Talus plot settles after thirteen dimensions, with small variations around a low mean, giving a dimension estimate of thirteen. In the Projection Score plot (<xref ref-type="fig" rid="vez028-F1">Fig. 1</xref>, bottom right panel), SMSSVD has detected three signals, of dimensions 3, 5, and 5, where the variance filtering threshold for automatic noise reduction has been optimized for each signal.</p>
      <p>Next, we examined which biological signals were captured in each dimension and whether incorporating minority variants in the analysis allows for improved monitoring of evolving populations, compared to consensus sequence analysis. To do this, sequence space representations of the mutant swarms were generated after noise reduction, where the final SMSSVD step decomposed the samples by principal components. Since almost no consensus changes occurred during the experiment, the principal components found patterns essentially related to differences in minority variants between mutant swarms. As shown in <xref ref-type="fig" rid="vez028-F3">Fig. 3</xref>, the strongest signal, described by the first three principal components, clearly separates the samples in sequence space according to lineage (see Rows 1–3, above the diagonal, in <xref ref-type="fig" rid="vez028-F3">Fig. 3</xref>). Importantly, further analysis of lower dimensions identified all biological treatments that were imposed on the viral populations. A complete separation in sequence space was observed for mutagenic treatment by 5-fluorouracil, ribavirin, and 5-azacytidine (see Rows 4, 5, and 7 below the diagonal, in <xref ref-type="fig" rid="vez028-F3">Fig. 3</xref>), known to introduce specific nucleotide substitution biases. Even for treatment with Mn<sup>2+</sup> and amiloride, which increase natural mutation rates without introducing nucleotide bias, a biological signal could be identified in most of the mutant swarms separating from other samples in Rows 9 and 11 (<xref ref-type="fig" rid="vez028-F3">Fig. 3</xref>). Furthermore, these signals are detected despite the background noise and error introduced by the sample preparation and sequencing technology, which lies in even lower components. Finally, if the same analysis is performed using only each sample's consensus sequence, no patterns related to the mutagens is found (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). These results reveal an important feature of evolving mutant swarms: despite the fact that deep sequencing data is extremely high-dimensional, we showed here that evolving populations of RNA viruses, which present the highest mutation frequencies, are moving in an intrinsically low dimensional domain within sequence space. Indeed, all five of the biological pressures placed on these viral populations could be captured within the first thirteen components. 
</p>
      <fig id="vez028-F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Pairwise scatter plots showing the first thirteen principal components in the analysis of the SynSyn data set plotted against each other. Plots above and below the diagonal are mirror images of each other. Each dot represents one viral population. Above the diagonal, samples are colored by lineage (black: 1, blue: 2, green: 3, red: 4) and below the diagonal, samples are colored by mutagen (red: 5-fluorouracil, light green: amiloride, blue: 5-azacytidine, yellow: Mn2+, cyan: ribavirin, Magenta: mock). All axes are rescaled to fill the plot area.</p>
        </caption>
        <graphic xlink:href="vez028f3"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 DISSEQT can monitor evolutionary trajectories and identify the minority variants involved in adaptation</title>
      <p>Recently, we studied the adaptation of Coxsackie virus to a new cell line. Long term passages of experimentally evolved populations (120 generations per virus) were analyzed by deep sequencing. Lacking suitable computational tools, the original study focused on identifying variants in the structural protein-coding region of a wild type lineage that showed signs of positive selection in the final passages of adaptation (mutations appearing at &gt;2% in more than one replicate, and only in the structural proteins known to be involved in adaptation to cell culture) (<xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>). In that study, we identified one consensus sequence change that occurred in all lineages during the first ten passages, followed by a cluster of minority variants that reached above 5 per cent in the last passage in each series. The data set however, contained whole-genome sequencing for three lineages of this virus: wild type, a higher replication fidelity lineage, and a lower fidelity lineage. Using DISSEQT, we could obtain a more complete picture by monitoring the evolutionary trajectories of three biological replicates per lineage (<xref ref-type="fig" rid="vez028-F4">Fig. 4</xref>), without biasing toward nonsynonymous mutations in the structural protein region. The top panel gives an overview based on nonlinear dimension reduction, showing how the evolutionary trajectories of the replicates relate to each other. For each pair of replicates, the time of bifurcation was computed and this was extended to sample clusters using average linking hierarchical clustering. Before the time of bifurcation, the replicates are close in sequence space and follow the same evolutionary trajectory. The splits in the panel show when the bifurcations occur. All replicates shared the same starting point. Around Passage 4, the low fidelity replicates (yellow–orange) split from the others and shortly thereafter (around Passage 5) the wildtype replicates (magenta–purple) split from the higher fidelity replicates (green–cyan). These observations reflect what was expected, but could not be detected using classical approaches that monitored only a few positively selected alleles: that low fidelity, mutator strains generated more minority variants more rapidly compared to wildtype, and to high fidelity strains. The replicates within each lineage then followed similar trajectories until further bifurcating between Passages 7 and 19. As with the previous examples where lineages clustered together, these results also support the notion that although sequence space is theoretically huge, similar lineages will tend to travel along the same evolutionary trajectories during the initial periods of evolution.
</p>
      <fig id="vez028-F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Top: Overview of the evolutionary trajectories of the nine replicates in the adaptability data set (<xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>), shown after nonlinear dimension reduction. Wild type (WT) replicates are shown in magenta–purple colors, replicates from the high fidelity lineage in green–cyan colors and replicates from the low fidelity lineage in yellow–orange colors. The starting point in sequence space is very close for all replicates. The splits indicate when the evolutionary trajectories bifurcate, i.e. when the replicates start to deviate from each other. Left column: Principal components for replicates as a function of arc length. Right column: Variable contributions as a function of arc length. Both columns: The dotted black line shows the total contribution to <inline-formula id="IE5"><mml:math id="IM5"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at <inline-formula id="IE6"><mml:math id="IM6"><mml:mi>s</mml:mi></mml:math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="vez028f4"/>
      </fig>
      <p>While the above analysis gave information on rate and direction of evolution, it did not identify what minority variant component of each population contributed to adaptation (<xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>) and the observed evolutionary signals. Thus, we broke the analysis down by component over time after variable selection, where principal components determined by SMSSVD followed by SPC (sparse principal components) (<xref rid="vez028-B20" ref-type="bibr">Witten, Tibshirani, and Hastie 2009</xref>) maps the trajectories of each replicate (<xref ref-type="fig" rid="vez028-F4">Fig. 4</xref>, left panel), and identifies which variants contributed most to the signal in each component (right panel). The strongest signal in the first principal component captured time dynamics shared between all replicates regardless of lineage, which consisted of the amino acid residues in the structural proteins responsible for adaptation to receptor usage (<xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>). The remaining components, however, identified several other mutations at sites that were missed by using the commonly used cutoff of 1–2 per cent minority variant frequency reflecting the expected sequencing error rate, and that could explain subtler phenotypic differences between lineages and between replicates. For wildtype, for example, two additional amino acid changes in the VP1 and VP4 structural proteins contributed most to these lineages' departure from others (principal component 2). Finally, the lower components (4 and onward) revealed variants that explain each replicate's divergence from others, including many variants in non-structural proteins such as the 2C (helicase) and 3C (protease) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). Together, the results show that while low-frequency variants were identified at nearly every nucleotide site, the common biologically relevant signals arising during longer term evolution can be captured in relatively low dimension.</p>
    </sec>
    <sec>
      <title>2.5 Visualization of evolution along an empirical fitness landscape</title>
      <p>In RNA virus evolution, adaptation to new environments can often be attributed to single or few new mutations that become fixed in the population. Experimental evolution in the lab and convergent evolution in the field suggest that short term evolution may be of relatively low dimension, as supported by our findings. If so, then these initial movements in sequence space may be inherently predictable, provided a robust genotype–phenotype map could be generated. This connection between sequence space and fitness is most naturally illustrated as a fitness landscape, where fitness is shown as a function of location in sequence space. However, reconstructing such landscapes from empirical data has been challenging. To evaluate the ability of DISSEQT to correctly generate and visualize fitness landscapes, we first empirically measured the relative fitness of the wild type and SynSyn mutant swarms described above in a direct competition assay against a neutral, genetically marked competitor (<xref rid="vez028-B8" ref-type="bibr">Carrasco et al. 2007</xref>; <xref rid="vez028-B31" ref-type="bibr">Moratorio et al. 2017</xref>) (data available in Synapse). The visualization (<xref ref-type="fig" rid="vez028-F5">Fig. 5</xref>, top panel) builds upon a 2d representation of sequence space, but using only the first two components from the SMSSVD representation is not sufficient since it ignores all other relevant signals in the data. Nonlinear dimension reduction by Isomap was used to distort sequence space such that the notion of closeness between mutant swarms is respected, taking all signals into account. Fitness was then added as the third dimension, interpolated by the Gaussian Kernel Smoother predictor (performance measured in <xref ref-type="fig" rid="vez028-F6">Fig. 6</xref>, top panel). The figure shows the dynamics of the mutant swarms corresponding to each viral lineage evolving over time. The wild type lineage (black) occupied the centermost area of the landscape, surrounded by the other lineages. In general, wild type populations occupied high fitness regions of the landscape, with some variability. This observation confirmed that wild type virus is well adapted to the growth conditions used in these experiments, and should tolerate perturbations in the system, such as increases in mutational load. The green SynSyn lineage displayed the most dramatic fitness differences, reaching both very high and very low areas, whereas the blue SynSyn lineage showed a stable, plateau-like behavior without any significant drops in fitness. Finally, the red SynSyn lineage was stuck in an area of the fitness landscape without any fitness peaks. Indeed, the red lineage was shown to be attenuated <italic>in vivo</italic>, and unable to reach pathogenic outcomes available to wild type virus; while the blue lineage was shown to be more mutationally robust (<xref rid="vez028-B31" ref-type="bibr">Moratorio et al. 2017</xref>). <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref> shows the same fitness landscape, but with samples colored by mutagen. Importantly, the data show that 2d reconstruction of sequence space by nonlinear dimension reduction can adequately reconstruct a fitness landscape that captures the expected biological behavior of similar, yet different viral lineages.
</p>
      <fig id="vez028-F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Top: Fitness landscape visualization of the SynSyn data set. Bottom: The same fitness landscape, constructed from consensus data only. Samples are colored by lineage (black: 1, blue: 2, green: 3, red: 4).</p>
        </caption>
        <graphic xlink:href="vez028f5"/>
      </fig>
      <fig id="vez028-F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Comparison between different fitness predictors. Gaussian Kernel Smoother Predictors: Isomap 2d (blue), SMSSVD 13d (yellow), Consensus Isomap 2d (pink), and Consensus 13d (green). Nearest Neighbor Predictors: SMSSVD 13d (purple) and Consensus (red). Group Predictors: Lineage/Mutagen (gray), Lineage/Dose (light green), Lineage/Mutagen/Dose (turquoise).</p>
        </caption>
        <graphic xlink:href="vez028f6"/>
      </fig>
    </sec>
    <sec>
      <title>2.6 Prediction of phenotype from genotype requires the input of minority variants</title>
      <p>A prime goal in developing faithful representations of sequence space is the potential to assign phenotypes to known genotypes, and ultimately predict the phenotypes of new genotypes. For rapidly evolving populations, the presence of minority variants has been shown to contribute to phenotype, but this is not normally taken into account in genotype–phenotype mapping. Indeed, when the fitness landscape described above was reconstructed using only consensus sequence data, the landscape is considerably collapsed (<xref ref-type="fig" rid="vez028-F5">Fig. 5</xref>, bottom panel).</p>
      <p>We thus evaluated the relevance of our sequence space reconstructions (after noise reduction) in their ability predict virus fitness, a quantitative parameter often used to describe phenotype. The performance of different fitness models was compared (<xref ref-type="fig" rid="vez028-F6">Fig. 6</xref>). Predicting fitness is inherently difficult. Thus, to get a baseline for the optimal performance that could be achieved, we used group-based predictors that rely on sample conditions, rather than deep sequencing data. The fine-grained group predictor using Lineage, Mutagen, and Dosage accurately described the sample conditions (<xref ref-type="fig" rid="vez028-F6">Fig. 6</xref>, turquoise bar). In other words, when these three groupings are known for a sample, the prediction is over 69 per cent accurate. When only lineage and dose were considered, prediction was 36 per cent accurate, and if only lineage and mutagen were known, accuracy dropped to 11 per cent. For the landscape predictors based on the 2d Isomap, accuracy was 44 per cent. SMSSVD, on the other hand, which uses 13d reach predictability of 62 and 61 per cent from landscape or nearest neighbor predictors. The data revealed that while 2d Isomap performs well for visualization, prediction is best achieved when more components are incorporated. Importantly, when either Isomap or principal component analysis is performed solely on consensus sequences, prediction fails (2 and 14%, respectively). Furthermore, the performance of the SMSSVD predictors compared well to the predictor based on experimental conditions (Lineage, Mutagen, and Dose), the closest we have to a gold standard. In summary, the predictors based on our proposed sequence space representation vastly outperformed the consensus-based predictor. The data thus confirms that consensus sequencing of a viral population is not enough to accurately predict its phenotype.</p>
    </sec>
  </sec>
  <sec>
    <title>3. Discussion</title>
    <p>HTS is replacing more classic sequencing methods in microbiology, especially in studying RNA viruses, where every nucleotide can be easily covered with extreme depth. This has increased and renewed interest in better characterizing RNA virus populations to take into account their variability, particularly when trying to identify differences between clinical or experimental samples that have no significant differences in consensus sequence, yet present different phenotypes. Recent works show that indeed, most sites along a genome generate mutants at very low frequency. Following passage of poliovirus in cell culture, <xref rid="vez028-B1" ref-type="bibr">Acevedo, Brodsky, and Andino (2014)</xref> identified an average of 16,500 variants, the equivalent of ∼74 per cent of all possible variant alleles in each passaged sample. Similarly, the previous analysis of the Coxsackie virus B3 wildtype populations described in more detail here, identified variant alleles in 65–80 per cent of the sequenced regions (<xref rid="vez028-B7" ref-type="bibr">Bordería et al. 2015</xref>).</p>
    <p>Despite the increasing accessibility of sequencing technology, we still lack the computational tools to use this data to its full potential. For instance, while an exhaustive list of variants can be generated per sample, to differentiate between similar, yet different, populations most studies have had to settle with using very basic mean measures such as Shannon entropy or mean variance. At best, these were followed up by a more targeted (and biased) focus on the few alleles suspected or known to be involved in the biological question being addressed.</p>
    <p>A pre-existing obstacle to developing these tools was the uncertainty as to the size and dimensionality of sequence space actually occupied by evolving microbial populations. Mathematical sequence space is vast, even for the small genomes of RNA viruses. Theoretically, the high mutation rates of RNA viruses could reach a large amount of this space, questioning whether the evolution of these microbes could be inherently predictable. However, it is clear that biological constraints prohibit this from occurring, as most mutations will affect form or function and will not accumulate under strong purifying selection. <italic>In vivo</italic> and <italic>in vitro</italic> experimental evolution studies performed in independent replicates reveal that under a constant environment, the same set of mutations tends to emerge. This suggests that the sequence space available to a virus is indeed more limited, determined by its current genome sequence, raising the possibility that evolutionary trajectories may therefore be predicted at least in the very short term (the next one or few mutational steps). Fitness landscapes help understand what neighboring populations might represent distributions of genotypes of equal or increasing fitness and which regions define populations of lower fitness. Knowledge of fitness in the vicinity of a current population may help determine the most likely paths that will be taken during the evolution of the population. While this goal may seem lofty for large genomes, the small and highly constrained genomes of RNA viruses may be more amenable to such an exercise.</p>
    <p>We have shown how the DISSEQT pipeline, using distribution-based modeling of complex, evolving viral populations, can uncover many different genotypic and phenotypic patterns without needing a priori hypotheses of which genetic alleles are to be studied. Importantly, the robust dimension reduction methods performed here have successfully separated biologically relevant signals from sequencing-related error and other noise, identifying key characteristics of the mutant swarm that drive evolution. This accentuates that global properties, like the ‘shape’ of the mutant swarm, are significant when trying to predict viral evolution. Sequencing error has long been an issue with characterizing microbial diversity and identifying true single nucleotide variants. Despite the presence of sequencing error, DISSEQT succeeded in finding structure in sequence space, made clear by the co-localization of populations subjected to similar environmental conditions and by accurate fitness predictions and fitness landscapes constructed on top of the sequence space representation.</p>
    <p>Applied here, DISSEQT analysis has provided two key pieces of information regarding evolving RNA virus populations. First, that the biologically ‘relevant’ sequence space occupied by such populations is of intrinsically low dimension. In both data sets presented here, the SynSyn viruses that were manipulated to present discrete biological signals and the High-, Low- and Wildtype fidelity viruses evolving naturally to generate discrete differences in variant composition, the genetic signatures of biological interest were segregated and identified within an intrinsic space of very low dimension (10–20). Second and most importantly, we show that reliable prediction of phenotype from genotype requires the input of minority variants, underscoring the importance of studying RNA viruses, and perhaps other microbial organisms, as a population rather than as a single reference sequence.</p>
    <p>At the core of our model is the representation of a population as a measure over a suitable genetic space. Using traditional bulk experimental techniques, averaging is performed already in the sampling and measuring steps of the management and analysis protocol; often resulting in relatively robust and normally (or log-normally) distributed data, well adapted for well-established statistical and machine learning analysis and visualization techniques.</p>
    <p>Existing quasispecies reconstruction methods are fundamentally different from DISSEQT in that they will produce a small set of haplotypes and ignore the complete codon distribution at each locus. Haplotype reconstruction based on short sequence reads is a mathematically ill-conditioned problem in the sense that a small change in input data can give a completely different result and it is not feasible to reconstruct haplotypes that exist at low frequencies. The DISSEQT pipeline is designed to be able to handle situations where the signal-to-noise ratio is modest and is able to use information on low-frequency variants to get a more complete representation of the mutant swarms.</p>
    <p>We have shown that by directly modeling and representing the distribution at each genetic locus of all measurable minority variants, followed by model reduction, we get low dimensional and robust models that capture the interaction between minority variants and, by coupling it with phenotypic measurements, make it possible to follow and predict trajectories in genotype–phenotype space. It opens up for extending the sequence space models presented in this work to situations where heterogeneity of populations can be hypothesized to be an important aspect that can be measured in a direct manner. In particular, data coming from single-cell sequencing have more variability, more artifacts, and often complex distributions (<xref rid="vez028-B3" ref-type="bibr">Bacher and Kendziorski 2016</xref>) and distribution-based modeling can be envisioned to be viable and provide a natural and biologically accurate representation of the data.</p>
    <p>Cancer growth, fundamentally different in origin from viruses and bacteria, may still be usefully described in terms of similar evolutionary processes (<xref rid="vez028-B40" ref-type="bibr">Stratton, Campbell, and Futreal 2009</xref>). Larger genomes and frequent structural variation, such as chromosomal aberrations (<xref rid="vez028-B19" ref-type="bibr">Hanahan and Weinberg 2011</xref>) and fused genes (<xref rid="vez028-B28" ref-type="bibr">Lilljebjörn et al. 2016</xref>) does, however, make the situation more complex and further work is needed to adapt the sequence space modeling for these circumstances. The challenges lie in incorporating structural variants into to the underlying space in a way that preserves biological similarity and is feasible to infer from the data. A possible starting point for cancer data is to restrict the analysis to a chosen set of interesting genes that do not exhibit any structural variation, thus simplifying the collection of deep sequencing data and providing an easy fit to the sequence space models we propose.</p>
  </sec>
  <sec>
    <title>4. Methods</title>
    <sec>
      <title>4.1 Experimental setup</title>
      <p>The experimental setup is described in detail in <xref rid="vez028-B31" ref-type="bibr">Moratorio et al. (2017)</xref> for the SynSyn data set and in <xref rid="vez028-B7" ref-type="bibr">Bordería et al. (2015</xref>) for the time series data on adaptation of Coxsackie virus to a new cell line.</p>
    </sec>
    <sec>
      <title>4.2 Reproducible and traceable analysis</title>
      <p>Traceability in the DISSEQT pipeline is provided by integration with the collaborative science platform Synapse. Every result produced by DISSEQT can be traced back all the way to the original data files using the Synapse <italic>provenance graph</italic>, which describes the actions taken for every analysis step and connects input to output data. Sharing settings in Synapse makes it possible to open up the entire analysis to the public, but keeping sensitive data and unfinished analyses private if necessary. The analysis steps are self-contained in the sense that all data required to produce the output is downloaded from Synapse as needed. Hence, every analysis step can be reproduced locally by anyone executing the same actions. By changing parameters or making other changes, the impact of performing the analysis in a different manner can be investigated by others. Rerunning the entire analysis is also possible in this way. Furthermore, the analysis can be adapted to new data sets, such that the results can reproduced from new biological data.</p>
    </sec>
    <sec>
      <title>4.3 Iterative alignment</title>
      <p>For each mutant swarm, the sequenced reads were aligned to the reference genome of the lineage (WT or one of the SynSyn’s) using BWA-MEM (<xref rid="vez028-B27" ref-type="bibr">Li 2013</xref>). The choice of alignment tool is not critical, but the same one should be used for all samples (mutant swarms) to get a consistent analysis. After alignment, the consensus sequence of the aligned sample is computed. If the consensus differs from the reference genome, the alignment starts over, now using the consensus as the new reference genome. This process is repeated until the consensus does not change. Iterative alignment combats an inherent problem that occurs when aligning to a reference genome—there will be a bias since reads that match the reference genome are easier to align, while reads that differ might be mapped incorrectly or cut off such that the variant is not included in the alignment. For changes at the consensus level, iterative alignment thus ensures that more reads are mapped correctly, allowing for a better frequency estimate. Even more important is that the ability to detect minority variants in the vicinity of consensus level changes is greatly improved, as the number of differences between reads containing the minority variant and the consensus will tend to be lower.</p>
    </sec>
    <sec>
      <title>4.4 Quality control</title>
      <p>Generating deep sequencing data is a complex procedure with many steps performed, both for the experiment itself and to prepare the data for sequencing. The DISSEQT pipeline provides several ways to evaluate the data to make sure that it is of high quality. Before alignment, adapters and poor quality bases are trimmed from the ends of reads using fastq-mcf (<xref rid="vez028-B2" ref-type="bibr">Aronesty 2011</xref>). At the end of the iterative alignment procedure, consensus sequences are automatically generated for all samples. It is expected that the consensus sequence will be more similar to the reference of the sample lineage, than to the reference of any other lineage used in the same sequencing run. If this is not the case, the sample is flagged as being mislabeled. Indels are also reported. Graphs showing the read coverage as a function of genome position are created. All samples from the same lineage and sequencing run are put in one graph, making it possible to identify problems with low read coverage for certain samples or genomic regions at a glance. Samples with a low mean read coverage can be removed automatically from downstream analysis. What threshold to use depends on the experimental setup, but we recommend keeping only samples with a mean read coverage above 1,000 for deep sequencing data. There are also tools in DISSEQT to remove samples that are suspected of being contaminated by other samples, identified by having a mixture of reads that are likely to originate from different reference genomes. The purpose of quality control is to validate that we are indeed studying what we set out to study. If a sample is showing unexpected patterns, in particular during quality control, we recommend that the aligned reads, the consensus sequence and any other measurements are inspected manually ensure that conclusions are not drawn from faulty data.</p>
    </sec>
    <sec>
      <title>4.5 Haplotypes</title>
      <p>Recovering the haplotype mix from a collection of short reads is a difficult, often ill-conditioned, and computationally intensive problem, but several software tools (<xref rid="vez028-B49" ref-type="bibr">Zagordi et al. 2011</xref>; <xref rid="vez028-B34" ref-type="bibr">Prosperi and Salemi 2012</xref>) are available (also see <xref rid="vez028-B5" ref-type="bibr">Beerenwinkel et al. 2012</xref>; <xref rid="vez028-B30" ref-type="bibr">McElroy, Thomas, and Luciani 2014</xref>) for overviews. The dominant haplotypes and their frequencies do not, however, completely characterize the viral population, another important aspect is how dispersed the individual viruses are around these central haplotypes. V-Phaser (<xref rid="vez028-B29" ref-type="bibr">Macalalad et al. 2012</xref>), V-Phaser 2 (<xref rid="vez028-B48" ref-type="bibr">Yang et al. 2013</xref>), and ShoRAH (<xref rid="vez028-B49" ref-type="bibr">Zagordi et al. 2011</xref>) find phased variants, pushing down the detection limit by assuming that real variants (at nearby loci) tend to co-vary, while errors do not. Unfortunately, V-Phaser and ShoRAH do not scale well for large data sets and V-Phaser 2 requires paired-end reads. For the reasons above, we chose the simpler and more robust path of making maximum likelihood (ML) estimates of the variant frequencies at each position, based on base quality data.</p>
    </sec>
    <sec>
      <title>4.6 Sequence space representation</title>
      <p>The genomic composition of microbial populations can be represented by a positive measure over a suitable space. Let <inline-formula id="IE7"><mml:math id="IM7"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> be an alphabet set, e.g. the set of nucleotides <inline-formula id="IE8"><mml:math id="IM8"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo>≔</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>, the set of codons <inline-formula id="IE9"><mml:math id="IM9"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi></mml:math></inline-formula> or the set of amino acids <inline-formula id="IE10"><mml:math id="IM10"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script" class="calligraphy">A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:math></inline-formula>. For the rest of this article, the set of codons will be used as the alphabet set, since the codons are closely connected to biological function and this choice does not impose any assumptions about the relative importance of synonymous versus nonsynonymous changes. The set of codons is the natural choice for coding regions, to analyze non-coding regions, the set of nucleotides could be used instead. Now define <italic>sequence space</italic> <inline-formula id="IE11"><mml:math id="IM11"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> as the set of sequences of length <inline-formula id="IE12"><mml:math id="IM12"><mml:mi>n</mml:mi></mml:math></inline-formula> over the alphabet <inline-formula id="IE13"><mml:math id="IM13"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. Assuming that individual genomes in the population only differ by a finite number of point mutations (i.e. substitutions), the composition of the population is characterized by a positive measure over sequence space. The space of positive measures over sequence space will be denoted by <inline-formula id="IE14"><mml:math id="IM14"><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
      <p>Inference of the population composition can be intractable from sequencing data due to short reads and/or high error rates. Let <inline-formula id="IE15"><mml:math id="IM15"><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> and define an equivalence relation such that <inline-formula id="IE16"><mml:math id="IM16"><mml:mi>P</mml:mi><mml:mo>∼</mml:mo><mml:mi>Q</mml:mi></mml:math></inline-formula> iff
<disp-formula id="E1"><mml:math id="M1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>for some constant <inline-formula id="IE17"><mml:math id="IM17"><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, where
<disp-formula id="E2"><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>≔</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>}</mml:mo></mml:math></disp-formula>are the basic cylinder sets of <inline-formula id="IE18"><mml:math id="IM18"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Hence, <inline-formula id="IE19"><mml:math id="IM19"><mml:mi>P</mml:mi></mml:math></inline-formula> relates to <inline-formula id="IE20"><mml:math id="IM20"><mml:mi>Q</mml:mi></mml:math></inline-formula> if they have the same allele frequencies at all positions. Inference for the equivalence class <inline-formula id="IE21"><mml:math id="IM21"><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> from sequence data is possible even when <inline-formula id="IE22"><mml:math id="IM22"><mml:mi>P</mml:mi></mml:math></inline-formula> cannot be inferred since allele frequencies at different positions can be estimated separately. The drawback is that minority variant linkage is lost, since we do not attempt single viron haplotype reconstruction. Each equivalence class <inline-formula id="IE23"><mml:math id="IM23"><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> is naturally represented by the frequency matrix <inline-formula id="IE24"><mml:math id="IM24"><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> with <inline-formula id="IE25"><mml:math id="IM25"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>. Finally, the frequencies are transformed by <inline-formula id="IE26"><mml:math id="IM26"><mml:mi>p</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE27"><mml:math id="IM27"><mml:mi>α</mml:mi></mml:math></inline-formula> denotes the limit of detection, to give minority variants higher impact in the model. The log transformation emphasizes relative differences in frequencies between variants instead of absolute differences in frequencies between variants.</p>
    </sec>
    <sec>
      <title>4.7 Sequence space inference</title>
      <p>Maximum likelihood estimation was used to infer the codon frequencies at any given position, using all reads overlapping that position, based on a multinomial model with noisy observations. At a given locus, let <inline-formula id="IE28"><mml:math id="IM28"><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> be the frequencies in the population for the sixty-four different codons, with <inline-formula id="IE29"><mml:math id="IM29"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for all <inline-formula id="IE30"><mml:math id="IM30"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Consider a read and the fragment the read is sequenced from. Now let <inline-formula id="IE32"><mml:math id="IM32"><mml:mi>x</mml:mi></mml:math></inline-formula> be the observed codon in the read and <inline-formula id="IE33"><mml:math id="IM33"><mml:mi>z</mml:mi></mml:math></inline-formula> the unknown codon in the original fragment, then
<disp-formula id="E3"><mml:math id="M3"><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>We model <inline-formula id="IE34"><mml:math id="IM34"><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> using the quality scores of the bases in the codon. If <inline-formula id="IE35"><mml:math id="IM35"><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are the probabilities of a read error at bases 1, 2, and 3 in the codon and <inline-formula id="IE36"><mml:math id="IM36"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the base at position <inline-formula id="IE37"><mml:math id="IM37"><mml:mi>k</mml:mi></mml:math></inline-formula> in a codon <inline-formula id="IE38"><mml:math id="IM38"><mml:mi>y</mml:mi></mml:math></inline-formula>, then
<disp-formula id="E4"><mml:math id="M4"><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE39"><mml:math id="IM39"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the Kronecker delta, the errors are thus assumed to be independent between bases in the codon and read errors are assumed to be equally likely to result in any of the other three bases. Assuming independent reads, the probability of the observations is
<disp-formula id="E5"><mml:math id="M5"><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>with observed codons <inline-formula id="IE40"><mml:math id="IM40"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> from reads <inline-formula id="IE41"><mml:math id="IM41"><mml:mn>1</mml:mn></mml:math></inline-formula> to <inline-formula id="IE42"><mml:math id="IM42"><mml:mi>N</mml:mi></mml:math></inline-formula>. The log-likelihood is thus
<disp-formula id="E6"><mml:math id="M6"><mml:mi>l</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>which is maximized numerically.</p>
      <p>We noted that in our high read coverage data, bases with low-quality Phred scores tended to be biased toward certain nucleotide errors. Thus, we chose to not trust bases with a Phred score below 30. This was done by setting the <inline-formula id="IE43"><mml:math id="IM43"><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of such nucleotides to <inline-formula id="IE44"><mml:math id="IM44"><mml:mn>0.75</mml:mn></mml:math></inline-formula>, giving them no influence. Reads were excluded from the analysis if they caused the ML optimization problem to be underdetermined (e.g. when observing two reads with codons AAA and xAT respectively, where x means that the nucleotide is unknown, xAT is dropped since only the sum of the frequencies for AAT, CAT, GAT, and TAT can be determined).</p>
    </sec>
    <sec>
      <title>4.8 Limit of detection</title>
      <p>True minority variants can be hard to separate from sequencing errors. And in both cases, we expect the frequencies to be different depending on the nucleotide neighborhood and other factors (<xref rid="vez028-B10" ref-type="bibr">DePristo et al. 2011</xref>). A key difference is however that there are two sets of observations of the sequencing errors since the reads originating from the forward and reverse strands have different nucleotide neighborhoods for any given codon site. Indeed, for each sample, the codon frequencies from the two strands are expected to be approximately equal for true minority variants, something which is much less likely for sequencing errors. The differences in sequencing error behavior depending on the context thus lead us to estimate the limit of detection <inline-formula id="IE45"><mml:math id="IM45"><mml:mi>α</mml:mi></mml:math></inline-formula> separately for each locus and codon. For a given locus, the samples are grouped by run and consensus codon, to get similar sequencing errors across the samples in each group. Fix a codon and let <inline-formula id="IE46"><mml:math id="IM46"><mml:mi mathvariant="bold-italic">f</mml:mi></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47"><mml:mi mathvariant="bold-italic">r</mml:mi></mml:math></inline-formula> be two vectors where <inline-formula id="IE48"><mml:math id="IM48"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE49"><mml:math id="IM49"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the inferred codon frequencies using reads from only the forward and reverse strands respectively, for sample <inline-formula id="IE50"><mml:math id="IM50"><mml:mi>i</mml:mi></mml:math></inline-formula> in the group. To limit the impact of sequencing errors on the downstream analysis, the transformed frequencies should be approximately equal, i.e. give a low value of the norm
<disp-formula id="E7"><mml:math id="M7"><mml:mi>ψ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RMS</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula id="IE51"><mml:math id="IM51"><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> acts elementwise and <inline-formula id="IE52"><mml:math id="IM52"><mml:mn mathvariant="double-struck">1</mml:mn></mml:math></inline-formula> is a vector of all ones. Now define the limit of detection
<disp-formula id="E8"><mml:math id="M8"><mml:mi>α</mml:mi><mml:mo>≔</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">inf</mml:mi></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>ψ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1.5</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The infimum exists since <inline-formula id="IE53"><mml:math id="IM53"><mml:mi>ψ</mml:mi></mml:math></inline-formula> is continuous and <inline-formula id="IE54"><mml:math id="IM54"><mml:mi>ψ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> as <inline-formula id="IE55"><mml:math id="IM55"><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:math></inline-formula>. The threshold <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1.5</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is chosen such that if we have a single sample with <inline-formula id="IE57"><mml:math id="IM57"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula id="IE58"><mml:math id="IM58"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, then <inline-formula id="IE59"><mml:math id="IM59"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>x</mml:mi></mml:math></inline-formula>. Furthermore, <inline-formula id="IE60"><mml:math id="IM60"><mml:mi>ψ</mml:mi></mml:math></inline-formula> is a strictly decreasing function and <inline-formula id="IE61"><mml:math id="IM61"><mml:mi>α</mml:mi></mml:math></inline-formula> can thus be found by the bisection method or other root-finding methods. Finally we choose a conservative estimate of the limit of detection <inline-formula id="IE62"><mml:math id="IM62"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, for codon <inline-formula id="IE63"><mml:math id="IM63"><mml:mi>c</mml:mi></mml:math></inline-formula> at locus <inline-formula id="IE64"><mml:math id="IM64"><mml:mi>x</mml:mi></mml:math></inline-formula>, by taking the highest limit of detection estimated from the different sample groups <inline-formula id="IE65"><mml:math id="IM65"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:math></inline-formula>,
<disp-formula id="E9"><mml:math id="M9"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>≔</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>with upper indices denoting the sample group and where <inline-formula id="IE66"><mml:math id="IM66"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is a commonly accepted lower limit of detection for sequencing data (<xref rid="vez028-B18" ref-type="bibr">Goodwin, McPherson, and McCombie 2016</xref>).</p>
    </sec>
    <sec>
      <title>4.9 Dimension estimation using Talus plots</title>
      <p>The Talus Plot provides a visualization of how the contents of a data set spread out across different dimensions and is designed to make it as easy as possible to make a qualitative estimate of the number of dimensions needed to capture all signals that stand out above the background noise. In <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, we show how predictable aspects of the background noise can be used to discern signals from noise. In brief, when the Talus Plot has ‘settled’, with small variations around a low mean, then the noise can be expected to be dominant.</p>
    </sec>
    <sec>
      <title>4.10 SMSSVD</title>
      <p>SMSSVD (<xref rid="vez028-B21" ref-type="bibr">Henningsson and Fontes 2019</xref>) is a parameter-free dimension reduction technique designed for the reconstruction of multiple overlaid low-rank signals from a data matrix, corrupted by noise. It is ideal for exploratory analysis of complex data, where different signals are spread out over different (possibly overlapping) subsets of variables, by limiting the influence of noise in variables that are not contributing to the signal. One of the major benefits of SMSSVD is its ability to detect signals with a low signal-to-noise ratio. SMSSVD shares many relevant properties with SVD, in particular orthogonality between components and the ability to extract variable loadings. The DISSEQT pipeline uses SMSSVD for noise reduction of the sequence space representation, since the number of variables is very large and we are trying to recover all signals that can be detected, not only the strongest one. Before applying SMSSVD, the data matrix is centered.</p>
    </sec>
    <sec>
      <title>4.11 Fitness landscapes</title>
      <p>Fitness landscapes, an important kind of genotype–phenotype map, are used to illustrate the connection between sequence composition and fitness of organisms. Here we show how a fitness landscape can be generated entirely from empirical data. Given a <inline-formula id="IE67"><mml:math id="IM67"><mml:mi>d</mml:mi></mml:math></inline-formula>-dimensional representation of sequence space, i.e. a set of sample points <inline-formula id="IE68"><mml:math id="IM68"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula id="IE69"><mml:math id="IM69"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula> with corresponding fitness values <inline-formula id="IE70"><mml:math id="IM70"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math></inline-formula>, we want to reconstruct a surface <inline-formula id="IE71"><mml:math id="IM71"><mml:mi>f</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math></inline-formula> such that
<disp-formula id="E10"><mml:math id="M10"><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>In practice however, we cannot expect a perfect fit of the surface. Differences in fitness between sample points that are close in the low dimensional representation will be difficult to capture. Furthermore, measurement noise will impact the reproducibility of the surface. To get a robust fitness landscape, we use a Gaussian Kernel Smoother (<xref rid="vez028-B20" ref-type="bibr">Hastie, Tibshirani, and Friedman 2009</xref>) and select the kernel width <inline-formula id="IE72"><mml:math id="IM72"><mml:mi>σ</mml:mi></mml:math></inline-formula> by cross-validation (repeated random subsampling). That is, we numerically find
<disp-formula id="E11"><mml:math id="M11"><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmin</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">train</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">test</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">test</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where the data is randomly divided into a train and a test data set for each iteration <inline-formula id="IE73"><mml:math id="IM73"><mml:mi>i</mml:mi></mml:math></inline-formula> and
<disp-formula id="E12"><mml:math id="M12"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">train</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mfenced><mml:mo>≔</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">train</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mtext>with</mml:mtext><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">train</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>4.12 Fitness evaluation</title>
      <p>The Gaussian Kernel Smoother (fitness landscape) predictors are evaluated in comparison to other fitness predictors. Nearest Neighbor predictors uses the fitness of the closest sample in sequence space as the prediction and can be used for different sequence space models. In case of ties, the prediction is taken as the average over the tied samples. Group-based predictors use a predetermined grouping of the samples, predicting fitness as the average fitness among samples in the same group, and do not use sequence data at all.</p>
      <p>Model accuracy for a predictor <inline-formula id="IE74"><mml:math id="IM74"><mml:mi>f</mml:mi></mml:math></inline-formula> is measured by fraction of variance explained,
<disp-formula id="E13"><mml:math id="M13"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE75"><mml:math id="IM75"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math></inline-formula> is the representation of sample <inline-formula id="IE76"><mml:math id="IM76"><mml:mi>i</mml:mi></mml:math></inline-formula> used by the predictor, <inline-formula id="IE77"><mml:math id="IM77"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math></inline-formula> is the fitness of sample <inline-formula id="IE78"><mml:math id="IM78"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> the mean fitness over all samples and the second term in the expression is the variance of the residuals divided by the total variance. The models are evaluated by leave-one-out cross-validation. The kernel widths for the Gaussian Kernel Smoother predictors are estimated separately for each problem instance to avoid influence from the left-out sample.</p>
    </sec>
    <sec>
      <title>4.13 Variable selection</title>
      <p>We use SPC (<xref rid="vez028-B45" ref-type="bibr">Witten, Tibshirani, and Hastie 2009</xref>) for variable selection, after noise reduction by SMSSVD. SPC adds a variable-side <inline-formula id="IE80"><mml:math id="IM80"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (lasso) constraint to a formulation of SVD as an optimization problem, forcing sparsity by ensuring that many variables are 0 at the optima. The optimization problem is then solved for one component at a time, using an iterative algorithm. However, since the optimization problem is not necessarily convex, the algorithm might converge to local optima. To reduce the impact of this problem, and to ensure that the singular values are declining, we suggest an extension of the algorithm. It can be shown that if a component has a larger singular value than a previous one, then this solution is guaranteed to be a better starting guess for the optimization problem for the previous component. By rolling back and restarting the optimization at the previous component, we get closer to the globally optimal solution and make sure that the singular values are declining.</p>
    </sec>
    <sec>
      <title>4.14 Nonlinear dimension reduction</title>
      <p>By dimension reduction, we aim to identify the parts of sequence space that are explored by the samples. Linear dimension reduction techniques, like SMSSVD, are useful because they make very few assumptions about the structure of the data. Although there is no reason to believe that the underlying manifold is linear, the complexity that is necessary for biological systems is indeed often caused by nonlinearities, linear methods can still capture nonlinear patterns if the dimension is sufficiently high (<xref rid="vez028-B32" ref-type="bibr">Nash 1956</xref>). However, to get an informative visualization in just two or three dimensions, nonlinear dimension reduction is needed for complex data sets.</p>
      <p>We apply Isomap (<xref rid="vez028-B42" ref-type="bibr">Tenenbaum, De Silva, and Langford 2000</xref>) to the data set after the noise reduction by SMSSVD (and the optional variable selection). Nonmetric MDS using Kruskal's stress criterion (<xref rid="vez028-B25" ref-type="bibr">Kruskal 1964</xref>) was used rather than classical MDS in the final step of the Isomap algorithm. This distorts the underlying space by expanding local structure that would otherwise be too small to notice, giving some importance to weaker signals in the data.</p>
    </sec>
    <sec>
      <title>4.15 Time series</title>
      <p>The evolution of a population over time is described by a curve <inline-formula id="IE81"><mml:math id="IM81"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> in sequence space. In practice, we can only measure the values of a curve <inline-formula id="IE82"><mml:math id="IM82"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> at discrete time points, and the measurements are subjected to noise. As the first step of noise reduction, a 3-point median filter over time is applied to the sequence space representation, to robustly reduce the impact of noise spikes. Following the noise reduction, the curve <inline-formula id="IE83"><mml:math id="IM83"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is reconstructed in the <inline-formula id="IE84"><mml:math id="IM84"><mml:mi>d</mml:mi></mml:math></inline-formula>-dimensional representation of sequence space, as a piecewise linear curve connecting the data points. Then, each curve is reparameterized by arc length <inline-formula id="IE85"><mml:math id="IM85"><mml:mi>s</mml:mi></mml:math></inline-formula>, starting at <inline-formula id="IE86"><mml:math id="IM86"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for <inline-formula id="IE87"><mml:math id="IM87"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, since differences in mutation rates can cause the population to move at different speeds through sequence space.</p>
      <p>The sequence space representation in terms of variables (variants) is time-invariant, but it is nevertheless important to see how different parts of sequence space are explored as the replicates move. Let <inline-formula id="IE88"><mml:math id="IM88"><mml:mi>σ</mml:mi></mml:math></inline-formula> be the first singular value, with corresponding left and right singular vectors <inline-formula id="IE89"><mml:math id="IM89"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> and <inline-formula id="IE90"><mml:math id="IM90"><mml:mi mathvariant="bold-italic">v</mml:mi></mml:math></inline-formula>, after dimension reduction of a matrix <inline-formula id="IE91"><mml:math id="IM91"><mml:mi>X</mml:mi></mml:math></inline-formula> by SMSSVD, SVD or SPC, then <inline-formula id="IE92"><mml:math id="IM92"><mml:mi>σ</mml:mi></mml:math></inline-formula> can be decomposed as a sum over variables and samples,
<disp-formula id="E14"><mml:math id="M14"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>X</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE93"><mml:math id="IM93"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≔</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> quantifies the importance of variable <inline-formula id="IE94"><mml:math id="IM94"><mml:mi>i</mml:mi></mml:math></inline-formula> and sample <inline-formula id="IE95"><mml:math id="IM95"><mml:mi>j</mml:mi></mml:math></inline-formula> for this component. By linear interpolation, this can be extended to <inline-formula id="IE96"><mml:math id="IM96"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, for intermediate values of the curve parameter <inline-formula id="IE97"><mml:math id="IM97"><mml:mi>s</mml:mi></mml:math></inline-formula> for replicate <inline-formula id="IE98"><mml:math id="IM98"><mml:mi>r</mml:mi></mml:math></inline-formula>. The contribution of variable <inline-formula id="IE99"><mml:math id="IM99"><mml:mi>j</mml:mi></mml:math></inline-formula> at <inline-formula id="IE100"><mml:math id="IM100"><mml:mi>s</mml:mi></mml:math></inline-formula> is measured by <inline-formula id="IE101"><mml:math id="IM101"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>≔</mml:mo><mml:mi> </mml:mi><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE102"><mml:math id="IM102"><mml:mi>σ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>≔</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> describes the importance of the first principal component at <inline-formula id="IE103"><mml:math id="IM103"><mml:mi>s</mml:mi></mml:math></inline-formula>. Plotting <inline-formula id="IE104"><mml:math id="IM104"><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE105"><mml:math id="IM105"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> along with the replicates, thus aid understanding of the dynamics. The definitions naturally extend to multiple components.</p>
    </sec>
    <sec>
      <title>4.16 Bifurcations</title>
      <p>We define the time of bifurcation <inline-formula id="IE106"><mml:math id="IM106"><mml:mi mathvariant="italic">β</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, between two curves <inline-formula id="IE107"><mml:math id="IM107"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE108"><mml:math id="IM108"><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> as the similarity measure
<disp-formula id="E15"><mml:math id="M15"><mml:mi>β</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">inf</mml:mi></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi mathvariant="italic">Bm</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>that is, the first point in time at which the distance between <inline-formula id="IE109"><mml:math id="IM109"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE110"><mml:math id="IM110"><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is above a threshold. Here, <inline-formula id="IE111"><mml:math id="IM111"><mml:mi>B</mml:mi></mml:math></inline-formula> is a chosen threshold and <inline-formula id="IE112"><mml:math id="IM112"><mml:mi>m</mml:mi></mml:math></inline-formula> a normalization constant chosen to make the expression scale-invariant. If <inline-formula id="IE113"><mml:math id="IM113"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is defined for <inline-formula id="IE114"><mml:math id="IM114"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE115"><mml:math id="IM115"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≔</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, then the mean distance over time between curves <inline-formula id="IE116"><mml:math id="IM116"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE117"><mml:math id="IM117"><mml:mi>j</mml:mi></mml:math></inline-formula> is
<disp-formula id="E16"><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mfenced open="‖" close="‖" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:math></disp-formula>and we let <inline-formula id="IE118"><mml:math id="IM118"><mml:mi>m</mml:mi><mml:mo>≔</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the mean over all pairs of the <inline-formula id="IE119"><mml:math id="IM119"><mml:mi>N</mml:mi></mml:math></inline-formula> curves. Average linking hierarchical clustering, based on the time of bifurcation similarity scores, naturally extends the concept to clusters of samples, giving recursive cluster splits and a cluster similarity score equal to the time of bifurcation at each split. For piecewise linear curves, <inline-formula id="IE120"><mml:math id="IM120"><mml:mi>m</mml:mi></mml:math></inline-formula> and <inline-formula id="IE121"><mml:math id="IM121"><mml:mi>β</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> can be computed analytically.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>vez028_Supplementary_Data</label>
      <media xlink:href="vez028_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>This work is sponsored by the Defense Advanced Research Projects Agency INTERCEPT program managed by Dr Jim Gimlett, and administered though DARPA contract (HR00111720023): the content of the information does not necessarily reflect the position or the policy of the Government and no official endorsement should be inferred.</p>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>Data is available through GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/rasmushenningsson/DISSEQT.jl">https://github.com/rasmushenningsson/DISSEQT.jl</ext-link>, accessed 23 June 2019) and Synapse (<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn11425758">https://www.synapse.org/#!Synapse: syn11425758</ext-link>, accessed 23 June 2019). Synapse DOI: 10.7303/syn11639899 and GitHub DOI: 10.5281/zenodo.3344557.</p>
      <p><bold>Conflict of interest:</bold> None declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vez028-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Acevedo</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Brodsky</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Andino</surname><given-names>R.</given-names></name></person-group> (<year>2014</year>) ‘<article-title>Mutational and Fitness Landscapes of an RNA Virus Revealed through Population Sequencing</article-title>’, <source>Nature</source>, <volume>505</volume>: <fpage>686–90</fpage>.<pub-id pub-id-type="pmid">24284629</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Aronesty</surname><given-names>E.</given-names></name></person-group> (<year>2011</year>) ‘ea-utils: Command-Line Tools for Processing Biological Sequencing Data’ &lt;<ext-link ext-link-type="uri" xlink:href="https://github.com/ExpressionAnalysis/ea-utils">https://github.com/ExpressionAnalysis/ea-utils</ext-link>&gt; accessed 23 June 2019.</mixed-citation>
    </ref>
    <ref id="vez028-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bacher</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) ‘<article-title>Design and Computational Analysis of Single-Cell RNA-Sequencing Experiments</article-title>’, <source>Genome Biology</source>, <volume>17</volume>: <fpage>63</fpage>.<pub-id pub-id-type="pmid">27052890</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beaucourt</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) ‘<article-title>Isolation of Fidelity Variants of RNA Viruses and Characterization of Virus Mutation Frequency</article-title>’, <source>Journal of Visualized Experiments</source>, 16. DOI: 10.3791/2953.</mixed-citation>
    </ref>
    <ref id="vez028-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) ‘<article-title>Challenges and Opportunities in Estimating Viral Genetic Diversity from Next-Generation Sequencing Data</article-title>’, <source>Frontiers in Microbiology</source>, <volume>3: 329</volume>. </mixed-citation>
    </ref>
    <ref id="vez028-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Biebricher</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Eigen</surname><given-names>M.</given-names></name></person-group> (<year>2006</year>) <chapter-title>‘What Is a Quasispecies?’</chapter-title>, <source>Current Topics in Microbiology and Immunology</source>, <volume>299</volume>: <fpage>1</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">16568894</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bordería</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>Group Selection and Contribution of Minority Variants during Virus Adaptation Determines Virus Fitness and Phenotype</article-title>’, <source>PLoS Pathogens</source>, <volume>11</volume>: <fpage>e1004838</fpage>. <pub-id pub-id-type="pmid">25941809</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carrasco</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) ‘<article-title>A Real-Time RT-PCR Assay for Quantifying the Fitness of Tobacco Etch Virus in Competition Experiments</article-title>’, <source>Journal of Virological Methods</source>, <volume>139</volume>: <fpage>181</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">17092574</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Collins</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) ‘<article-title>Competitive Fitness of Nevirapine-Resistant Human Immunodeficiency Virus Type 1 Mutants</article-title>’, <source>Journal of Virology</source>, <volume>78</volume>: <fpage>603</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">14694092</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DePristo</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) ‘<article-title>A Framework for Variation Discovery and Genotyping Using Next-Generation DNA Sequencing Data</article-title>’, <source>Nature Genetics</source>, <volume>43</volume>: <fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Domingo</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Sheldon</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Perales</surname><given-names>C.</given-names></name></person-group> (<year>2012</year>) ‘<article-title>Viral Quasispecies Evolution</article-title>’, <source>Microbiology and Molecular Biology Reviews</source>, <volume>76</volume>: <fpage>159</fpage>–<lpage>216</lpage>.<pub-id pub-id-type="pmid">22688811</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fiers</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>1976</year>) ‘<article-title>Complete Nucleotide Sequence of Bacteriophage MS2 RNA: Primary and Secondary Structure of the Replicase Gene</article-title>’, <source>Nature</source>, <volume>260</volume>: <fpage>500</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">1264203</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fleischmann</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>1995</year>) ‘<article-title>Whole-Genome Random Sequencing and Assembly of <italic>Haemophilus influenzae</italic> Rd</article-title>.’, <source>Science</source>, <volume>269</volume>: <fpage>496</fpage>–<lpage>512</lpage>.<pub-id pub-id-type="pmid">7542800</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fontes</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Soneson</surname><given-names>C.</given-names></name></person-group> (<year>2011</year>) ‘<article-title>The Projection Score—An Evaluation Criterion for Variable Subset Selection in PCA Visualization</article-title>’, <source>BMC Bioinformatics</source>, <volume>12</volume>: <fpage>307</fpage>.<pub-id pub-id-type="pmid">21798031</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fox</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) ‘<article-title>Accuracy of Next Generation Sequencing Platforms</article-title>’, <source>Next Generation, Sequencing &amp; Applications</source>, <volume>1</volume>. DOI: 10.4172/jngsa.1000106.</mixed-citation>
    </ref>
    <ref id="vez028-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fraser</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>1995</year>) ‘<article-title>The Minimal Gene Complement of <italic>Mycoplasma genitalium</italic></article-title>’, <source>Science</source>, <volume>270</volume>: <fpage>397</fpage>–<lpage>403</lpage>. <pub-id pub-id-type="pmid">7569993</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gawad</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Koh</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Quake</surname><given-names>S.</given-names></name></person-group> (<year>2016</year>) ‘<article-title>Single-Cell Genome Sequencing: Current State of the Science</article-title>’, <source>Nature Reviews Genetics</source>, <volume>17</volume>: <fpage>175–88</fpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goodwin</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>McPherson</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>McCombie</surname><given-names>W.</given-names></name></person-group> (<year>2016</year>) ‘<article-title>Coming of Age: Ten Years of Next-Generation Sequencing Technologies</article-title>’, <source>Nature Reviews Genetics</source>, <volume>17</volume>: <fpage>333</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hanahan</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Weinberg</surname><given-names>R.</given-names></name></person-group> (<year>2011</year>) ‘<article-title>Hallmarks of Cancer: The Next Generation</article-title>’, <source>Cell</source>, <volume>144</volume>: <fpage>646</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">21376230</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hastie</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Friedman</surname><given-names>J.</given-names></name></person-group> (<year>2009</year>) <source>The Elements of Statistical Learning</source>, <volume>2nd ed</volume>n. <publisher-name>Springer</publisher-name>. </mixed-citation>
    </ref>
    <ref id="vez028-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Henningsson</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Fontes</surname><given-names>M.</given-names></name></person-group> (<year>2019</year>) ‘<article-title>SMSSVD: SubMatrix Selection Singular Value Decomposition</article-title>’, <source>Bioinformatics</source>, <volume>35</volume>: <fpage>478</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">30010791</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Higgins</surname><given-names>D.</given-names></name></person-group> (<year>1992</year>) ‘<article-title>Sequence Ordinations: A Multivariate Analysis Approach to Analysing Large Sequence Data Sets</article-title>’, <source>Computer Applications in the Biosciences</source>, <volume>8</volume>: <fpage>15</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">1568121</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kauffman</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Weinberger</surname><given-names>E.</given-names></name></person-group> (<year>1989</year>) ‘<article-title>The NK Model of Rugged Fitness Landscapes and Its Application to Maturation of the Immune Response</article-title>’, <source>Journal of Theoretical Biology</source>, <volume>141</volume>: <fpage>211</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">2632988</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Kouyos</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) ‘Exploring the Complexity of the HIV-1 Fitness Landscape’. <source>PLOS Genetics</source>, 8: e1002551.</mixed-citation>
    </ref>
    <ref id="vez028-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kruskal</surname><given-names>J.</given-names></name></person-group> (<year>1964</year>) ‘<article-title>Multidimensional Scaling by Optimizing Goodness of Fit to a Nonmetric Hypothesis</article-title>’, <source>Psychometrika</source>, <volume>29</volume>: <fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Laehnemann</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Borkhardt</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>McHardy</surname><given-names>A.</given-names></name></person-group> (<year>2016</year>) ‘<article-title>Denoising DNA Deep Sequencing Data—High-Throughput Sequencing Errors and Their Correction</article-title>’, <source>Briefings in Bioinformatics</source>, <volume>17</volume>: <fpage>154</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">26026159</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) ‘Aligning Sequence Reads, Clone Sequences and Assembly Contigs with BWA-MEM’, <italic>arXiv 1303.3997</italic>. </mixed-citation>
    </ref>
    <ref id="vez028-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lilljebjörn</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) ‘<article-title>Identification of ETV6-RUNX1-Like and DUX4-Rearranged Subtypes in Paediatric B-Cell Precursor Acute Lymphoblastic Leukaemia</article-title>’, <source>Nature Communications</source>, <volume>7: 11790</volume>. </mixed-citation>
    </ref>
    <ref id="vez028-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Macalalad</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) ‘<article-title>Highly Sensitive and Specific Detection of Rare Variants in Mixed Viral Populations from Massively Parallel Sequence Data</article-title>’, <source>PLoS Computational Biology</source>, <volume>8</volume>: <fpage>e1002417</fpage>.<pub-id pub-id-type="pmid">22438797</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McElroy</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Luciani</surname><given-names>F.</given-names></name></person-group> (<year>2014</year>) ‘<article-title>Deep Sequencing of Evolving Pathogen Populations: Applications, Errors, and Bioinformatic Solutions</article-title>’, <source>Microbial Informatics and Experimentation</source>, <volume>4</volume>: <fpage>1</fpage>.<pub-id pub-id-type="pmid">24428920</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moratorio</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) ‘<article-title>Attenuation of RNA Viruses by Redirecting Their Evolution in Sequence Space</article-title>’, <source>Nature Microbiology</source>, <volume>2</volume>: <fpage>17088</fpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nash</surname><given-names>J.</given-names></name></person-group> (<year>1956</year>) ‘<article-title>The Imbedding Problem for Riemannian Manifolds</article-title>’, <source>Annals of Mathematics</source>, <volume>63</volume>: <fpage>20</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Perkel</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>) ‘<article-title>Single-Cell Sequencing Made Simple</article-title>’, <source>Nature</source>, <volume>547</volume>: <fpage>125–26</fpage>.<pub-id pub-id-type="pmid">28682345</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Prosperi</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Salemi</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>) ‘<article-title>QuRe: Software for Viral Quasispecies Reconstruction from Next-Generation Sequencing Data</article-title>’, <source>Bioinformatics</source>, <volume>28</volume>: <fpage>132</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">22088846</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reiter</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>Biological Auctions with Multiple Rewards</article-title>’, <source>Proceedings: Biological Sciences</source>, <volume>282</volume>: <fpage>20151041</fpage>.<pub-id pub-id-type="pmid">26180069</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Russell</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Bloom</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>) ‘Extreme Heterogeneity of Influenza Virus Infection in Single Cells’, <italic>bioRxiv</italic>, 193995.</mixed-citation>
    </ref>
    <ref id="vez028-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Seifert</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) ‘<article-title>A Framework for Inferring Fitness Landscapes of Patient-Derived Viruses Using Quasispecies Theory</article-title>’, <source>Genetics</source>, <volume>199</volume>: <fpage>191</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">25406469</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Price</surname><given-names>G.</given-names></name></person-group> (<year>1973</year>) ‘<article-title>The Logic of Animal Conflict</article-title>’, <source>Nature</source>, <volume>246</volume>: <fpage>15</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stapleford</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) ‘<article-title>Emergence and Transmission of Arbovirus Evolutionary Intermediates with Epidemic Potential</article-title>’, <source>Cell Host &amp; Microbe</source>, <volume>15</volume>: <fpage>706</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">24922573</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stratton</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Campbell</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Futreal</surname><given-names>P.</given-names></name></person-group> (<year>2009</year>) ‘<article-title>The Cancer Genome</article-title>’, <source>Nature</source>, <volume>458</volume>: <fpage>719–24</fpage>.<pub-id pub-id-type="pmid">19360079</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) ‘Power Analysis of Single Cell RNA-Sequencing Experiments’, <italic>bioRxiv</italic>, 73692.</mixed-citation>
    </ref>
    <ref id="vez028-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tenenbaum</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>De Silva</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Langford</surname><given-names>J.</given-names></name></person-group> (<year>2000</year>) ‘<article-title>A Global Geometric Framework for Nonlinear Dimensionality Reduction</article-title>’, <source>Science</source>, <volume>290</volume>: <fpage>2319</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">11125149</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vignuzzi</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) ‘<article-title>Quasispecies Diversity Determines Pathogenesis through Cooperative Interactions in a Viral Population</article-title>’, <source>Nature</source>, <volume>439</volume>: <fpage>344</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">16327776</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Whitlock</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Bourguet</surname><given-names>D.</given-names></name></person-group> (<year>2000</year>) ‘<article-title>Factors Affecting the Genetic Load in <italic>Drosophila</italic>: Synergistic Epistasis and Correlations among Fitness Components</article-title>’, <source>Evolution</source>, <volume>54</volume>: <fpage>1654</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">11108592</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Witten</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T.</given-names></name></person-group> (<year>2009</year>) ‘<article-title>A Penalized Matrix Decomposition, with Applications to Sparse Principal Components and Canonical Correlation Analysis</article-title>’, <source>Biostatistics</source>, <volume>10</volume>: <fpage>512</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="vez028-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wright</surname><given-names>S.</given-names></name></person-group> (<year>1932</year>) ‘<article-title>The Roles of Mutation, Inbreeding, Crossbreeding, and Selection in Evolution</article-title>’, <source>Proceedings of the 6th International Congress on Genetics</source>, <volume>1</volume>: <fpage>356</fpage>–<lpage>66</lpage>. </mixed-citation>
    </ref>
    <ref id="vez028-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xue</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) ‘<article-title>Cooperation between Distinct Viral Variants Promotes Growth of H3N2 Influenza in Cell Culture</article-title>’, <source>eLife</source>, <volume>5</volume>: <fpage>e13974</fpage>.<pub-id pub-id-type="pmid">26978794</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) ‘<article-title>V-Phaser 2: Variant Inference for Viral Populations</article-title>’, <source>BMC Genomics</source>, <volume>14</volume>: <fpage>674</fpage>.<pub-id pub-id-type="pmid">24088188</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zagordi</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) ‘<article-title>ShoRAH: Estimating the Genetic Diversity of a Mixed Sample from Next-Generation Sequencing Data</article-title>’, <source>BMC Bioinformatics</source>, <volume>12</volume>: <fpage>119</fpage>.<pub-id pub-id-type="pmid">21521499</pub-id></mixed-citation>
    </ref>
    <ref id="vez028-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) ‘<article-title>PhyloMap: An Algorithm for Visualizing Relationships of Large Sequence Data Sets and Its Application to the Influenza A Virus Genome</article-title>’, <source>BMC bioinformatics</source>, <volume>12</volume>: <fpage>248</fpage>.<pub-id pub-id-type="pmid">21689434</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
