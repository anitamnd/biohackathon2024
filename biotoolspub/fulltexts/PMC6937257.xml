<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6937257</article-id>
    <article-id pub-id-type="publisher-id">56911</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-019-56911-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Using transfer learning from prior reference knowledge to improve the clustering of single-cell RNA-Seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mieth</surname>
          <given-names>Bettina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Hockley</surname>
          <given-names>James R. F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Görnitz</surname>
          <given-names>Nico</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vidovic</surname>
          <given-names>Marina M.-C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Müller</surname>
          <given-names>Klaus-Robert</given-names>
        </name>
        <address>
          <email>klaus-robert.mueller@tu-berlin.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gutteridge</surname>
          <given-names>Alex</given-names>
        </name>
        <address>
          <email>alex.x.gutteridge@gsk.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ziemek</surname>
          <given-names>Daniel</given-names>
        </name>
        <address>
          <email>daniel.ziemek@pfizer.com</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2292 8254</institution-id><institution-id institution-id-type="GRID">grid.6734.6</institution-id><institution>Machine Learning Group, Technische Universität Berlin, </institution></institution-wrap>Berlin, 10587 Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution>Department of Pharmacology, University of Cambridge, </institution></institution-wrap>Cambridge, CB2 1PD United Kingdom </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2162 0389</institution-id><institution-id institution-id-type="GRID">grid.418236.a</institution-id><institution>GlaxoSmithKline, </institution></institution-wrap>Stevenage, SG1 2NY United Kingdom </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0840 2678</institution-id><institution-id institution-id-type="GRID">grid.222754.4</institution-id><institution>Department of Brain and Cognitive Engineering, Korea University, </institution></institution-wrap>Seoul, 02841 Republic of Korea </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0491 9823</institution-id><institution-id institution-id-type="GRID">grid.419528.3</institution-id><institution>Max Planck Institute for Informatics, </institution></institution-wrap>Saarbrücken, 66123 Germany </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4904 8590</institution-id><institution-id institution-id-type="GRID">grid.476393.c</institution-id><institution>Pfizer, Worldwide Research and Development, </institution></institution-wrap>Berlin, 10785 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>20353</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">In many research areas scientists are interested in clustering objects within small datasets while making use of prior knowledge from large reference datasets. We propose a method to apply the machine learning concept of transfer learning to unsupervised clustering problems and show its effectiveness in the field of single-cell RNA sequencing (scRNA-Seq). The goal of scRNA-Seq experiments is often the definition and cataloguing of cell types from the transcriptional output of individual cells. To improve the clustering of small disease- or tissue-specific datasets, for which the identification of rare cell types is often problematic, we propose a transfer learning method to utilize large and well-annotated reference datasets, such as those produced by the Human Cell Atlas. Our approach modifies the dataset of interest while incorporating key information from the larger reference dataset via Non-negative Matrix Factorization (NMF). The modified dataset is subsequently provided to a clustering algorithm. We empirically evaluate the benefits of our approach on simulated scRNA-Seq data as well as on publicly available datasets. Finally, we present results for the analysis of a recently published small dataset and find improved clustering when transferring knowledge from a large reference dataset. Implementations of the method are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nicococo/scRNA">https://github.com/nicococo/scRNA</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Functional clustering</kwd>
      <kwd>Machine learning</kwd>
      <kwd>RNA sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100006764</institution-id>
            <institution>Technische Universität Berlin (TU Berlin)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>- German Federal Ministry for Education and Research through the Berlin Big Data Centre (01IS14013A), the Berlin Center for Machine Learning (01IS18037I) and the TraMeExCo project (01IS18056A). Partial funding by DFG is acknowledged (EXC 2046/1, project-ID: 390685689) - Institute for Information &amp; Communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) (No.2017-0-01779)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100004330</institution-id>
            <institution>GlaxoSmithKline (GlaxoSmithKline plc.)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100004319</institution-id>
            <institution>Pfizer (Pfizer Inc.)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Sorting objects into groups with limited, or no, <italic>a priori</italic> knowledge, is a common problem in many different areas of scientific research<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. In biological and medical sciences, datasets are often constrained by the scarcity, feasibility and expense of collecting samples. As such, it is not straightforward to apply state-of-the-art methodologies, like deep learning, which require large and well annotated datasets to many problems. To address this, the concept of using transfer learning to integrate <italic>a priori</italic> knowledge from large reference datasets into smaller datasets has been proposed as one way to generate additional insights from these data<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. One of the scientific fields where these problems are of interest is single-cell RNA sequencing (scRNA-Seq). Figure <xref rid="Fig1" ref-type="fig">1</xref> shows a graphical representation of the scRNA-Seq procedure and the application of transfer learning to its specific problem setting.<fig id="Fig1"><label>Figure 1</label><caption><p>Single-cell RNA sequencing (scRNA-Seq) and transfer learning. (<bold>A</bold>) Recent scientific and biotechnological developments have enabled scRNA-Seq, the accurate measurement of the transcriptional output of individual cells. Once a tissue sample (e.g. brain tissue) is extracted from an organism, single cells (e.g. neurons) are isolated and sequenced. For each gene the number of times a corresponding transcript is found in each individual cell is counted. These gene expression profiles of single cells are then used to identify tissue-specific cell types or states through an unsupervised clustering algorithm (e.g. SC3) which can eventually be visualized (through e.g. t-SNE or PCA plots). (<bold>B</bold>) When clustering smaller disease or tissue specific scRNA-Seq datasets it is often desirable to utilize large labeled reference datasets. The current work proposes to apply the machine learning concept of transfer learning to modify the unlabeled target dataset via Non-negative Matrix Factorization (NMF) in a way that reflects specific properties of a large labeled source dataset and improves the results of downstream clustering algorithms (in our case SC3). Please note, that even though this graph represents a complete overlap in cell types, both source and target datasets might include cell types that are not part of the other set. Graphs were created using Servier Medical Art (brain, neuron and syringe) according to a Creative Commons Attribution 3.0 Unported License guidelines 3.0 (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/3.0/">https://creativecommons.org/licenses/by/3.0/</ext-link>). Colour changes were made to the original neuron cartoons.</p></caption><graphic xlink:href="41598_2019_56911_Fig1_HTML" id="d29e364"/></fig></p>
    <p id="Par3">In recent years, a series of advances in molecular biology<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>, microfluidics<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> and data analysis<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> have led to our ability to accurately measure the transcriptional output of large numbers of individual cells through scRNA-Seq (Fig. <xref rid="Fig1" ref-type="fig">1A</xref>). The application of this technology has already led to insights into cellular development<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>, dynamics<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> and heterogeneity<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup> and the pathogenesis of human disease<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. The advent of major global initiatives focusing on scRNA-Seq such as the Human Cell Atlas<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> means that the importance and impact of this technology is likely to grow as will the associated data analysis challenges.</p>
    <p id="Par4">Most scRNA-Seq experiments are concerned with the identification and cataloging of cell types or states within a tissue or biofluid<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1A</xref>). Historically this has been done through measurement, often qualitatively, of small numbers of ‘marker’ genes whose expression has been observed to correlate with cellular function. scRNA-Seq complements these approaches by being high-throughput, quantitative and cost effective in generating high dimensional data suitable for cell type classification. Neuronal cell types, for instance, have been deeply studied by scRNA-Seq<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> leading to new, unbiased, data driven classifications of neurons and other cell types within the mammalian peripheral and central nervous systems<sup><xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup>. Unique disease-associated cell states such as microglial subtypes associated with Alzheimer’s Disease<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> have also been identified by scRNA-Seq.</p>
    <p id="Par5">Whilst analysis of scRNA-Seq data has many challenges including normalization<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, noise<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, dealing with zero inflation and missing values<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>, dimensionality reduction<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup> and visualization<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>, one of the key analytical techniques to address questions of cell type identification is that of unsupervised clustering. Clustering of cells into discrete groupings according to their transcriptional state is the fundamental analysis required in many scRNA-Seq experiments.</p>
    <p id="Par6">A range of approaches have been taken to address the problem of clustering scRNA-Seq data including hierarchical and iterative clustering<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR35">35</xref></sup>, PCA based approaches<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>, ensemble clustering<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup> and graph based approaches<sup><xref ref-type="bibr" rid="CR38">38</xref>–<xref ref-type="bibr" rid="CR42">42</xref></sup>. As the number of cells in scRNA-Seq datasets increases, the development of other machine learning based<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>, and specifically deep learning-based<sup><xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR48">48</xref></sup>, clustering approaches has expanded.</p>
    <p id="Par7">Challenges remain in the field, especially when the number of cells profiled in a given experiment is relatively small and as such rare cell subtypes are poorly represented<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Our hypothesis is that large reference scRNA-Seq datasets are a hitherto untapped resource for clustering of other datasets that may be smaller in size, but examine a specific tissue or disease context. Here we propose that the concept of transfer learning (the machine learning concept of applying knowledge gained from one context to another distinct but related context) can be effectively implemented to improve clustering of scRNA-Seq data when a suitable reference dataset is available (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>).</p>
    <p id="Par8">Transfer learning is an umbrella term for problems such as multitask learning, domain adaptation, and covariate shift<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Specifically, it refers to a setting where the solution of one or multiple source tasks is applied to a related target task. Thrun<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> contributed to the emergence of the field by asking if “Learning The n-th Thing [is] Any Easier Than Learning The First?” which was motivated by findings in human psychology. One of the key insights was that humans build upon related concepts when learning new tasks, which Thrun coined <italic>lifelong learning</italic>. Another influential line which popped up around the same time, introduced the term multitask learning<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. Instead of learning a sequence of related tasks, multiple related tasks are learned in a parallel fashion using a shared representation.</p>
    <p id="Par9">In the analysis of scRNA-Seq data this translates to a situation where we are interested in simultaneously clustering a number of different datasets stemming from different studies, laboratories or points in time. These kinds of datasets most likely contain batch effects which need to be corrected for when combining the datasets for meta-analyses. In scRNA-Seq analysis, clustering and batch effect removal are typically addressed through separate steps, <italic>i.e</italic>. only after removing batch effects and combining multiple datasets into one is clustering analysis performed. These kinds of batch effect correction approaches can be graph-based<sup><xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR55">55</xref></sup>, dimensionality-reduction based and variance-driven<sup><xref ref-type="bibr" rid="CR56">56</xref>–<xref ref-type="bibr" rid="CR58">58</xref></sup> or incorporate deep-learning procedures<sup><xref ref-type="bibr" rid="CR59">59</xref>,<xref ref-type="bibr" rid="CR60">60</xref></sup>. Different approaches to grouping cells of multiple datasets by cell type rather than dataset-specific conditions put emphasis on performing batch effect removal jointly with the clustering analysis<sup><xref ref-type="bibr" rid="CR61">61</xref>–<xref ref-type="bibr" rid="CR63">63</xref></sup>. More general approaches compare subtypes of cells across different samples<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> and identify clusters with high similarity across datasets<sup><xref ref-type="bibr" rid="CR65">65</xref>,<xref ref-type="bibr" rid="CR66">66</xref></sup>.</p>
    <p id="Par10">All of the aforementioned methods presume that the multiple datasets under investigation are related in some way and are subsequently clustered simultaneously. In this work we focus on a more specific problem setting, where the user is interested mostly in the clustering of a target dataset, making use of the knowledge from a well-known and well understood source dataset. A number of tools are available for annotating cells of a target dataset to a predefined reference set of cell types<sup><xref ref-type="bibr" rid="CR67">67</xref>–<xref ref-type="bibr" rid="CR70">70</xref></sup>, but they are limited to target datasets that only include cells of the same types in source data and hence, cannot identify new cell types.</p>
    <p id="Par11">To enable knowledge transfer without having to combine the two datasets and at the same time guarantee a target clustering to be independent of the cell types of the source data, this work focuses on the specific concept of transfer learning to use information from one scRNA-Seq dataset to annotate another without limiting the cell types that may be found in either. The aim is to adjust the target dataset with information from the source data and feed this new target dataset into a downstream clustering algorithm.</p>
    <p id="Par12">In this specific setting one method that is the most closely related to our work is SAVER-X<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>. SAVER-X trains a deep autoencoder on a target set with an initialization of the weights obtained from training on source dataset coupled to a Bayesian model to leverage existing data in the denoising of a new scRNA-Seq dataset. SAVER-X is a deep-learning based approach and is thus limited to datasets of very large sample size. Our work focuses on improving the clustering of small datasets and does not require large sample sizes. Unlike deep learning based approaches, our method is convex and always returns the globally optimal solution independent of the initialization. Additionally, instead of focusing on denoising target datasets like SAVER-X we are trying to insert additional knowledge (<italic>i.e</italic>. to induce certain specific properties of the source dataset that the researcher wants to put special emphasis on) into the target dataset. This is achieved by making use of specific source datasets and in particular by including cell type annotations from the source into the analysis. Large reference datasets are often very well studied and come with high quality annotation of the cell types present within them. Our algorithm is not attempting to re-cluster this already well-clustered data but it is making use of those pre-existing source labels (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>).</p>
    <p id="Par13">Another relevant work focusing on transformations of scRNA-Seq data for improved cell type clustering<sup><xref ref-type="bibr" rid="CR72">72</xref></sup> is also deep-learning based and consists of three subsequent steps. Firstly, a supervised neural network is trained to predict the cell types of a given source dataset. Secondly, the target dataset of cell types not used in the training is plugged into the network and the values of the hidden layer are used as a new representation of the target dataset. Lastly, the newly constructed target dataset is clustered with unsupervised k-means clustering enabling cell types in source and target data to not be identical. Please note, that the focus of the present work lies on transferring knowledge between source and target datasets that have a significant overlap in their cell types. The method proposed by Lin <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR72">72</xref></sup> is explicitly restricted to non-overlapping settings.</p>
    <p id="Par14">To summarize, the current approach is not directly comparable to the methods presented here, because it tackles a very specific problem that - to the best of our knowledge - no other method has addressed.</p>
    <p id="Par15">Implementations of the method are available as a Python framework at <ext-link ext-link-type="uri" xlink:href="https://github.com/nicococo/scRNA">https://github.com/nicococo/scRNA</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par16">We propose a method to apply transfer learning to scRNA-Seq data that enables us to transfer knowledge from a relatively well-annotated and large source dataset to a smaller unannotated target dataset. A graphical representation of the method can be found in Fig. <xref rid="Fig1" ref-type="fig">1B</xref>. The method is based on a transfer learning step, that modifies the target dataset to incorporate knowledge gained from the well-annotated source dataset. The newly constructed target dataset can then be analyzed with a clustering algorithm to obtain an improved clustering compared to applying that same method to the target without any transfer learning procedure or a simple concatenation of source and target.</p>
    <p id="Par17">The following sections describe the method in more detail and specify the experimental setup of performance assessments on generated synthetic data, controlled real data and a real-world application of two independent datasets.</p>
    <sec id="Sec3">
      <title>Transfer learning for scRNA-seq clustering</title>
      <p id="Par18">There exists a well-known source dataset <italic>X</italic><sub><italic>src</italic></sub> with scRNA-Seq data from <italic>n</italic><sub><italic>src</italic></sub> cells and <italic>g</italic> genes for which we have in-depth knowledge about the clustering structure (i.e. ground truth labels <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{src}\in {\Re }^{{n}_{src}}$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq1.gif"/></alternatives></inline-formula>) and a target dataset <italic>X</italic><sub><italic>trg</italic></sub> of <italic>n</italic><sub><italic>trg</italic></sub> cells and <italic>g</italic> genes which we want to enhance given the information in <italic>X</italic><sub><italic>src</italic></sub> and <italic>y</italic><sup><italic>src</italic></sup> before clustering into <italic>k</italic> groups of cells.</p>
      <p id="Par19">The basic underlying idea of the proposed method is to factorize the source dataset into a gene independent part (of size <italic>k</italic> × <italic>n</italic><sub><italic>src</italic></sub>) and a data size independent part (of size g × <italic>k</italic>) and to use the latter – which is often called a <italic>dictionary</italic> since it does not depend on the number of cells <italic>n</italic><sub><italic>src</italic></sub> and can thus be used to <italic>translate</italic> between datasets – to modify the target dataset accordingly.</p>
      <p id="Par20">More specifically, the novel approach, based on non-negative matrix factorization (NMF), can be derived in the following steps:<list list-type="order"><list-item><p id="Par21">We use NMF<sup><xref ref-type="bibr" rid="CR73">73</xref>,<xref ref-type="bibr" rid="CR74">74</xref></sup> of our source data <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{src}\in {\Re }^{g\times {n}_{src}}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq2.gif"/></alternatives></inline-formula> to learn a dictionary <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{src}\in {\Re }^{g\times k}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq3.gif"/></alternatives></inline-formula> and a data matrix <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{src}\in {\Re }^{k\times {n}_{src}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq4.gif"/></alternatives></inline-formula> while regularizing the denseness of the results with an elastic net<sup><xref ref-type="bibr" rid="CR75">75</xref></sup>:<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{H}_{src},{W}_{src} &amp; = &amp; argmi{n}_{W,H}(\frac{1}{2}{||{X}_{src}-HW||}_{Fro}^{2}+\alpha \lambda ({||vec(H)||}_{1}+{||vec(W)||}_{1})\\  &amp;  &amp; +\,\frac{\alpha }{2}(1-\lambda )({||H||}_{Fro}^{2}+{||W||}_{Fro}^{2}))\end{array}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mspace width=".25em"/><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2019_56911_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>λ</italic> is the elastic net mixing parameter controlling the combination of L1 and L2 regularization and <italic>α</italic> is the corresponding penalty multiplier.</p><p id="Par22">As an initial starting point <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{src}^{\ast }$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>⁎</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq5.gif"/></alternatives></inline-formula> for <italic>W</italic><sub><italic>src</italic></sub> we provide a one-hot-encoding of the given cluster labels <italic>y</italic><sup><italic>src</italic></sup>, where a non-zero entry in the <italic>j</italic>-th row of column <italic>i</italic> in <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{src}^{\ast }$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>⁎</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq6.gif"/></alternatives></inline-formula> indicates that cell <italic>i</italic> is a member of cluster <italic>j</italic>.</p></list-item><list-item><p id="Par23">Given the learned dictionary <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{src}\in {\Re }^{g\times k}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq7.gif"/></alternatives></inline-formula> from step (1) and assuming the genes in source and target data correspond, we now transfer knowledge from the source to the target dataset through the dictionary by learning a target data matrix <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{trg}\in {\Re }^{k\times {n}_{trg}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq8.gif"/></alternatives></inline-formula>:<disp-formula id="Equb"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{trg}=argmi{n}_{W}(\frac{1}{2}{||{X}_{trg}-{H}_{src}W||}_{Fro}^{2})$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2019_56911_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par24">To enable domain adaptation for different levels of cell type overlap between the two datasets we now construct a new target dataset <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{trg}^{new}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq9.gif"/></alternatives></inline-formula> based on a convex combination of a reconstructed target dataset <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{src}{W}_{trg}^{\text{'}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq10.gif"/></alternatives></inline-formula> and its original version <italic>X</italic><sub><italic>trg</italic></sub>:<disp-formula id="Equc"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{trg}^{new}=\theta {H}_{src}{W}_{trg}^{\text{'}}+(1-\theta ){X}_{trg}\,{\rm{with}}\,0\le \theta \le 1$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mi mathvariant="normal">with</mml:mi><mml:mspace width=".25em"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math><graphic xlink:href="41598_2019_56911_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><italic>θ</italic> is a mixture parameter indicating how strongly knowledge from the source dataset should be transferred into the newly constructed target dataset. High values of <italic>θ</italic> indicate a strong influence of the source dataset on the modified dataset and low values cause the new dataset to be more similar to its original version.</p><p id="Par25">The target clustering matrix <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{trg}^{\text{'}}\in {\{0,1\}}^{k\times {n}_{trg}}$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq11.gif"/></alternatives></inline-formula> is a simplified version of <italic>W</italic><sub><italic>trg</italic></sub> with ones at the positions of all column-wise maxima and zeros elsewhere, <italic>i.e</italic>.<disp-formula id="Equd"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${({W}_{trg}^{\text{'}})}_{li}={1}_{[(argma{x}_{l\in \{1,\ldots ,k\}}{({W}_{trg})}_{li})=l]}\forall i,l$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:msub><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:math><graphic xlink:href="41598_2019_56911_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par26">Using <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{trg}^{\text{'}}$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq12.gif"/></alternatives></inline-formula> instead of <italic>W</italic><sub><italic>trg</italic></sub> represents reducing the information in this matrix to potential cluster memberships of the target cells which is appropriate considering the task at hand. To this end, a number of different approaches were implemented (e.g. leaving <italic>W</italic><sub><italic>trg</italic></sub> as it is or optimizing it in an additional training step), but it was found that taking the simplified version as described above performed best and most consistently for all scenarios under investigation.</p></list-item><list-item><p id="Par27">The newly derived dataset <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{trg}^{new}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq13.gif"/></alternatives></inline-formula> can be used as input for a clustering method. We are using single-cell consensus clustering (SC3)<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> as an exemplary clustering method that is commonly used to solve scRNA-Seq clustering problems. See Supplementary Section <xref rid="MOESM1" ref-type="media">1.1</xref>. for a detailed description of SC3.</p></list-item></list></p>
      <p id="Par28">Please note that the proposed method does not inherently depend on the number of samples in each dataset and can technically (even though not studied in this work) be used to transfer knowledge from datasets of any size, not just from a source that is larger than the target.</p>
    </sec>
    <sec id="Sec4">
      <title>Selecting <italic>θ</italic> and other free parameters</title>
      <p id="Par29">The mixture parameter <italic>θ</italic> dictates how much the newly constructed target dataset should be changed by the information in the source dataset. <italic>θ</italic> is automatically chosen via an unsupervised assessment of the clustering quality through Kernel Target Alignment (KTA) scores<sup><xref ref-type="bibr" rid="CR76">76</xref></sup> which measure the similarity of kernels. The whole transfer learning and clustering procedure (steps 1–4) is applied with a number of values for <italic>θ</italic> within a pre-specified range and the KTA score between the linear kernel of the mixed dataset <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{trg}^{new}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq14.gif"/></alternatives></inline-formula>over the cells and the linear kernel of the cell type labels predicted by subsequent SC3 clustering is calculated. The parameter value yielding the optimal KTA score is chosen for the final result and can give an indication on the transferability between source and target data. An investigation of the mixture parameter of the transfer learning approach and its automatic selection process based on KTA scores is given in Supplementary Section <xref rid="MOESM1" ref-type="media">2.4.</xref> where the correlation of the unsupervised KTA scores and their supervised counterpart, the Adjusted Rand Indices (ARIs) are examined. Other free parameters, <italic>e.g</italic>. the elastic net parameters <italic>λ</italic> and <italic>α</italic>, were chosen based on results from the simulated data. See Supplementary Sections <xref rid="MOESM1" ref-type="media">2.2</xref>.,<xref rid="MOESM1" ref-type="media">3.2.</xref> and <xref rid="MOESM1" ref-type="media">4.2</xref>. for details.</p>
    </sec>
    <sec id="Sec5">
      <title>Pre-processing</title>
      <p id="Par30">Three steps for pre-processing scRNA-Seq data were applied:<list list-type="bullet"><list-item><p id="Par31"><bold>Cell filter:</bold> Remove all cells containing fewer than <italic>x</italic><sub><italic>genes</italic></sub> genes with <italic>expression</italic> &gt; <italic>x</italic><sub><italic>expression</italic></sub>.</p></list-item><list-item><p id="Par32"><bold>Gene filter:</bold> Remove ubiquitous genes that are expressed in almost all cells (i.e. with <italic>expression</italic> &gt; <italic>x</italic><sub><italic>expression</italic></sub> in at least <italic>x</italic><sub><italic>cells</italic></sub>% of cells) and rare genes that are not expressed in almost all cells (i.e. with <italic>expression</italic> &lt; <italic>x</italic><sub><italic>expression</italic></sub> in at least <italic>x</italic><sub><italic>cells</italic></sub>% of cells).</p></list-item><list-item><p id="Par33"><bold>Log-transformation:</bold> Log-transform the expression matrix after adding a pseudo-count of 1.</p></list-item></list></p>
      <p id="Par34">All free pre-processing parameters should be selected by the user based on an inspection of the data, i.e. expression histograms of both source and target dataset. The specific parameter values chosen for the datasets in this work can be found in Supplementary Sections <xref rid="MOESM1" ref-type="media">2.1</xref>.,<xref rid="MOESM1" ref-type="media">3.1</xref>. and <xref rid="MOESM1" ref-type="media">4.1</xref>. The corresponding expression histograms can be seen in Supplementary Figs. <xref rid="MOESM1" ref-type="media">S5</xref>–<xref rid="MOESM1" ref-type="media">S7</xref>. Pre-processing was performed once for all datasets (source and target separately) before the different clustering methods (i.e. transfer learning or baseline methods) were performed.</p>
    </sec>
    <sec id="Sec6">
      <title>NMF clustering in the absence of source labels</title>
      <p id="Par35">If no reliable cluster labels are available for the source dataset <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{src}\in {\Re }^{g\times {n}_{src}}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq15.gif"/></alternatives></inline-formula>, one can choose to generate those labels via NMF clustering<sup><xref ref-type="bibr" rid="CR73">73</xref>,<xref ref-type="bibr" rid="CR74">74</xref></sup> and proceed as if they were the real labels <italic>y</italic><sup><italic>src</italic></sup>. This basically consists of learning a dictionary <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{src}\in {\Re }^{g\times k}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq16.gif"/></alternatives></inline-formula> and a data matrix <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{src}\in {\Re }^{k\times {n}_{src}}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq17.gif"/></alternatives></inline-formula> as described above in step 1 and selecting the cluster memberships based on the column wise maxima of <italic>W</italic><sub><italic>src</italic></sub>, i.e. <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{i}^{src}=argma{x}_{l\in \{1,\ldots ,k\}}{({W}_{src})}_{li}$$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq18.gif"/></alternatives></inline-formula>.</p>
      <p id="Par36">Instead of learning the source labels through NMF clustering one could also avoid providing an initial starting point <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{src}^{\ast }$$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>⁎</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2019_56911_Article_IEq19.gif"/></alternatives></inline-formula> for <italic>W</italic><sub><italic>src</italic></sub> when learning the dictionary <italic>H</italic><sub><italic>src</italic></sub> and the data matrix <italic>W</italic><sub><italic>src</italic></sub>.</p>
    </sec>
    <sec id="Sec7">
      <title>Baseline methods and performance metrics</title>
      <p id="Par37">For assessing the quality of our unsupervised domain adaptation solution, we are interested in investigating the change of clustering accuracy of the target dataset. As baseline methods we implement the original SC3 clustering method on the target dataset alone (TargetCluster) and on the concatenated dataset of source and target (ConcatenateCluster). For a detailed description and a visualization of the baseline methods please see Supplementary Section <xref rid="MOESM1" ref-type="media">1.2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>.</p>
      <p id="Par38">As a supervised performance metric we used the Adjusted Rand Index (ARI)<sup><xref ref-type="bibr" rid="CR77">77</xref></sup> comparing the transfer learning results (TransferCluster) and the baseline labels with the known clustering labels (known perfectly in the case of the simulated data and retrieved from the original publication in the case of the real data). ARI scores are computed only on the target data, even in the case of ConcatenateCluster, where labels are computed for both source and target cells.</p>
    </sec>
    <sec id="Sec8">
      <title>Simulation of source and target single-cell datasets</title>
      <p id="Par39">To test the applicability of our method we first use it on simulated count level scRNA-Seq data from a defined hierarchical set of clusters that represent the different cell types present in a tissue or biofluid.</p>
      <p id="Par40">Figure <xref rid="Fig2" ref-type="fig">2A</xref> shows a graphical representation of the hierarchical clustering structure used to generate the simulated data. Each generated dataset consisted of eight clusters of cells (1–8) deriving from five top level clusters (V - Z) that share a common background distribution of gene expression levels and some proportion of genes differentially expressed between them.<fig id="Fig2"><label>Figure 2</label><caption><p>scRNA-Seq simulation data description and results. (<bold>A</bold>) Count level single-cell RNA-Seq data is simulated according to a pre-defined hierarchical clustering structure with eight cell clusters (1-8) that are derived from five top level clusters (V - Z). Generated datasets are individually split up by randomly assigning the top node clusters V - Z to source or target. Three different settings are considered: 1. both source and target data contain cells from all top node clusters V - Z (Complete overlap), 2. three randomly selected top node clusters V - Z are chosen as common to both source and target, the other two are assigned to either one of source and target (Incomplete overlap) or 3. cells from two of the top node clusters form the target dataset and cells from the other three form the source (No overlap). (<bold>B)</bold> Clustering performances of the baseline methods, TargetCluster (clustering on the target dataset alone) and ConcatenateCluster (concatenating and clustering source and target data simultaneously), and the transfer learning approach (TransferCluster) when the clustering structures of source and target data are identical (Complete overlap). (<bold>C)</bold> Clustering performances of the baseline methods, TargetCluster and ConcatenateCluster and the transfer learning approach (TransferCluster) for an incomplete overlap between the cell clusters in source and target data (Incomplete overlap). (<bold>D)</bold> Clustering performances of the baseline methods, TargetCluster and ConcatenateCluster and the transfer learning approach (TransferCluster) for a setting with two exclusive target and three exclusive source top nodes and no cell types that appear in both sets (No overlap). Please note, that due to the sampling procedures described above, the number of top level nodes in the target datasets decreases from 5 in (<bold>B)</bold> to 4 in (<bold>C)</bold> and 2 in (<bold>D</bold>) and hence the performance of TargetCluster improves from (<bold>B–D</bold>). 95% confidence intervals are shown.</p></caption><graphic xlink:href="41598_2019_56911_Fig2_HTML" id="d29e2324"/></fig></p>
      <p id="Par41">An outline of the data generation procedure is given here; the full code is provided in <ext-link ext-link-type="uri" xlink:href="https://github.com/nicococo/scRNA/blob/master/scRNA/simulation.py">https://github.com/nicococo/scRNA/blob/master/scRNA/simulation.py</ext-link>. First we generate the number of cells in each sub-cluster using a Dirichlet distribution with a concentration parameter of 10. Then we define a common background distribution of gene expression levels sampled from a gamma distribution with shape 2 and rate 0.1. For each cluster in turn we randomly select 10–40 % of genes to be differentially expressed relative to the background. The difference in expression, expressed as a log2 fold change, for each such gene is sampled from a normal distribution with mean 1 and standard deviation 0.5. For clusters that are not themselves top level clusters (clusters 4–8) this process continues recursively with further expression differences generated for each sub-cluster using the parent cluster as the new background until the final clusters are reached. Finally, we generate count level data by applying a small amount of random normally distributed noise to the expression levels of each cell and then sampling the per gene counts from a negative binomial distribution with dispersion 0.1. The resulting datasets contain cells with a median count of 215 500 reads per cell. Please see Supplementary Section <xref rid="MOESM1" ref-type="media">2.3</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3</xref> for details.</p>
      <p id="Par42">Once count level data is generated for the entire dataset we split it into target and source datasets with different sets of cells according to the cluster structure and the relationship between the target and source. Here, we consider three such relationships that reflect three possible experimental scenarios:<list list-type="bullet"><list-item><p id="Par43">Cells in the target and source are randomly sampled from the same underlying tissue or biofluid and hence contain cells from all top node clusters V–Z.</p></list-item><list-item><p id="Par44">Certain clusters are specified to be only present in the source and some to be only present in the target, the remaining clusters are present in both target and source. Three randomly selected top node clusters V - Z are chosen as common to both source and target, the other two are assigned to either one of source and target.</p></list-item><list-item><p id="Par45">The cells in the target and source are drawn from completely non-overlapping clusters. In this scenario transfer learning is not expected to be successful. Cells from two of the top node clusters form the target dataset and cells from the other three form the source.</p></list-item></list></p>
      <p id="Par46">The genes measured in source and target are always the same and the top nodes are randomly assigned to either source or target for each repetition of the data generation process. 100 sets of simulated data were generated for each of the three settings simulating the expression levels of 10 000 genes in 1800 cells. 1000 cells were assigned to the source dataset and the set of 800 target cells was downsampled (i.e. 10, 50, 100, 200, 400, 600, 800 target cells) to investigate the performance of the transfer learning approach and its corresponding baseline methods when applied to datasets of varying sizes.</p>
    </sec>
    <sec id="Sec9">
      <title>Subsampling source and target data from a single dataset</title>
      <p id="Par47">Following the analysis of simulated data, we subsequently examined a real scRNA-Seq dataset. By subsampling both source and target dataset from the same single original dataset, we create an environment where the potential benefit of transfer learning can be determined on real-world gene expression data. For this we utilized gene expression data provided as Reads Per Kilobase of transcript per Million mapped reads (RPKM) derived from over 1600 cells of the primary visual cortex of the adult mouse brain<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. After the application of the pre-processing steps (see Supplementary Section <xref rid="MOESM1" ref-type="media">3.1</xref>. for details) the dataset contained expression levels of 9547 genes in 1658 cells.</p>
      <p id="Par48">We deemed this dataset to be of sufficient complexity in terms of taxonomic diversity (it contains 23 GABAergic neuronal, 19 glutamatergic neuronal and 7 non-neuronal cell types) and in terms of total cell count, to enable cluster-restricted subsampling and thus the application of transfer learning approaches.</p>
      <p id="Par49">We ran 100 repetitions splitting the data into a source dataset of 1000 cells and a target dataset of 650 cells each time, which is subsampled even further (to 25, 50, 100, 200, 400, 650 target cells) to assess performance for different sample sizes. To investigate the influence of complete and incomplete overlap between the clusters of source and target datasets, transcriptomic cell types assigned to either dataset were controlled. Complete overlap meant randomly assigning cells into source and target. Incomplete overlap is achieved by assigning the two largest clusters of the dataset (<italic>Glutamatergic L4</italic> cells and <italic>GABAergic Pvalb</italic> cells) to be either an exclusive source or an exclusive target cluster, respectively. All other clusters are shared amongst both source and target in this setting.</p>
      <p id="Par50">The transfer learning approach and its baselines are now investigated under two different conditions. Firstly, we assume that no ground truth labels are available and generate labels for 18 cell clusters via NMF clustering<sup><xref ref-type="bibr" rid="CR73">73</xref>,<xref ref-type="bibr" rid="CR74">74</xref></sup> on the whole dataset. We interpret this clustering, based as it is on the totality of the data, as a ground truth clustering and apply our method and the baseline algorithms to a subset of the dataset, to see how each method performs relative to this definition of ground truth when not all of the data is available. Secondly, we use the data driven clustering labels provided in the original paper and take those as the ground truth labels. Specifically, we use a cut-off in the provided clustering hierarchy that results in 18 clusters. Given those alternative ground truth labels, we once again run TargetCluster, ConcatenateCluster and TransferCluster. See Supplementary Section <xref rid="MOESM1" ref-type="media">3.3</xref>. for a more detailed description of the two different sets of ground truth labels.</p>
    </sec>
    <sec id="Sec10">
      <title>Independent source and target dataset</title>
      <p id="Par51">As a real-world application of the transfer learning approach we analyze two entirely independent, but biologically related, datasets. To improve the clustering results of a relatively small target dataset from Hockley <italic>et al</italic>. 2018<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, we transfer knowledge from a larger source dataset from Usoskin <italic>et al</italic>. 2014<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> both derived from the rodent somatosensory system. The somatosensory system is responsible for detecting mechanical, thermal and chemical stimuli to which an organism can choose to elicit a behavioural response. Primary sensory neurons innervate the vast majority of internal hollow organs, joints, muscles and the skin evoking conscious sensation in the event of these stimuli. This is most clearly exemplified by pain in the case of potentially harmful or noxious stimuli, such as burning or cutting of the skin. In Usoskin <italic>et al</italic>, transcriptomic analysis of 622 primary sensory cell bodies, which reside within the dorsal root ganglia (DRG), reveals significant diversity in cell type (11 types) and sensitivity to a diverse range of stimuli modalities (e.g. thermosensitive, itch sensitive, nociceptive) to which an organism is exposed. However, previous retrograde tracing experiments show that only 5–10 % of DRG neurons project to internal (visceral) targets, such as the gastrointestinal tract, and as such are likely only represented by ~ 30–60 cells in the Usoskin <italic>et al</italic>. dataset. Such small cell numbers limit subtype assignment of cells in this organ. In order to overcome this limitation, scRNA-Seq has been performed on retrograde labeled DRG neurons known to selectively innervate the gastrointestinal tract (colonic DRG neurons), providing transcriptomic analysis of 314 cells from this specific organ that cluster into 7 distinct subtypes<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. However, it is unclear whether <italic>de novo</italic> clustering of colonic DRG neurons identifies established clusters previously identified in larger datasets such as Usoskin <italic>et al</italic>. (hereafter designated ‘Usoskin’) or whether novel cell types exist within this dataset (hereafter designated ‘Hockley’).</p>
      <p id="Par52">After the application of cell and gene filter to the Hockley dataset provided as Transcripts Per Million (TPM), the number of genes decreased from 45513 to 9651; none of the 314 cells were filtered out. Pre-processing of the Usoskin dataset provided as Counts Per Million (CPM) left 9280 of the 20191 genes and 501 of the 622 cells. Please see Supplementary Section <xref rid="MOESM1" ref-type="media">4.1</xref>. for an investigation of the specific expression levels in these datasets and the parameter values that were consequently chosen for pre-processing. Since the methods require both source and target to have identical feature space, only the subset of genes that appear in both source and target data were used, leaving us with 4402 genes in both sets. In initial experiments, the original source and target data were used, however in later experiments, a batch effect removal approach was applied to control for the integration of single-cell transcriptomic data across different conditions and technologies. Here, we applied Seurat batch effect removal<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> to combine the Hockley and the Usoskin data, and separated the result back into the original datasets which were then provided to TargetCluster, ConcatenateCluster and TransferCluster.</p>
      <p id="Par53">As an additional pre-processing step we investigated the effect of imputation on the clustering results. MAGIC<sup><xref ref-type="bibr" rid="CR78">78</xref></sup>, a widely used method for imputing missing values to overcome zero-inflation in scRNA-Seq data, was applied to both datasets and the pre-processed datasets were then provided to the three methods under investigation.</p>
      <p id="Par54">Using either the original datasets or the pre-processed, batch effect removed or imputed datasets, the results of TargetCluster, ConcatenateCluster and TransferCluster were assessed in terms of performance via a comparison to the clustering of the original paper<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, the evaluation of t-SNE plots and differentially expressed genes to determine putative cellular function to neuronal subtypes. Since SC3 is a non-convex method it yields different results for each run. In order to provide quantification of the robustness of the three methods, we applied each 1000 times and counted the number of times three key clusters of interest were successfully identified. These clusters were selected based on their biological relevance as described in the original paper, further details of which can be found in the results section.</p>
      <p id="Par55">Once again, experiments were run under two conditions. Firstly, we assumed that reliable source data labels are not available and we generated cell labels for the Usoskin dataset via NMF clustering. Secondly, we use labels from Usoskin <italic>et al</italic>. (generated via an iterative PCA approach). Usoskin <italic>et al</italic>. provide labels at three different levels of the hierarchy producing 4, 8 or 11 clusters. We investigate results based on all of those, calling them level 1, 2 and 3 labels, respectively. We also investigate a scenario where we generate the labels via NMF clustering instead of using the labels presented in Usoskin <italic>et al</italic>. Here, however, we only present results based on using level 3 labels from the original publication. Please see Supplementary Section <xref rid="MOESM1" ref-type="media">4.3</xref> and <xref rid="MOESM1" ref-type="media">4.4</xref> for a detailed description of the different sets of ground truth labels and the corresponding clustering results.</p>
      <p id="Par56">In order to assess whether rare cell types were present in the Hockley dataset, the number of clusters to group the cells of the target dataset in was chosen to be 7.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <sec id="Sec12">
      <title>Validation using simulated source and target data</title>
      <p id="Par57">To assess the performance of the proposed method in comparison to the two baseline methods in a controlled environment, we conducted a number of simulation experiments with generated data, where the “ground truth” of the clustering structure is controlled and known. This allowed us to compute supervised performance metrics for each method and make objective statements about which method performs best.</p>
      <p id="Par58">Figure <xref rid="Fig2" ref-type="fig">2B–D</xref> show the ARI curves of all three methods on these simulated scRNA-Seq datasets for the three different settings of overlap between source and target described above.</p>
      <p id="Par59">For complete overlap in the clustering structures of the two datasets, <italic>i.e</italic>. identically sampled data, our method, TransferCluster, outperforms the baseline methods for all sample sizes of the target dataset (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>). It exceeds not only the clustering on the target dataset alone (TargetCluster) but also performs better than concatenating and clustering source and target data simultaneously (ConcatenateCluster). The latter can improve the clustering of the target dataset, but fails to achieve the same levels of performance as TransferCluster. The main reason for this is that instead of predicting the labels of the source dataset - like ConcatenateCluster - TransferCluster uses the true source labels and incorporates that knowledge into the clustering of the target dataset. This effect is very strong here since the true source labels are completely known for the generated datasets.</p>
      <p id="Par60">The ARI curves on simulated data with both overlapping and non-overlapping clusters in source and target data, show that in this case transferring knowledge can still help the analysis of the target dataset and that TransferCluster outperforms both baseline methods, however not by the same amount as when a complete overlap is present (Fig. <xref rid="Fig2" ref-type="fig">2C</xref>). Concatenating the two datasets (ConcatenateCluster) can lead to an increased performance for larger target sample sizes where clustering the target data alone (TargetCluster) is more successful. Only incorporating the source knowledge via our transfer learning procedure (TransferCluster) can consistently improve the clustering results for all sample sizes.</p>
      <p id="Par61">Specifically, one should note, that the performance, as measured by ARI, of ConcatenateCluster decreases when there is a non-perfect overlap (in comparison to a complete overlap) and is greatly impaired when there are no overlapping clusters in source and target data. Combining two sets into one is not to be preferred in those cases.</p>
      <p id="Par62">The ARI curves on disparate, non-overlapping clusters show that, as expected, transferring information from a source dataset that is unconnected to the target dataset cannot improve clustering significantly (i.e. confidence intervals of TargetCluster and TransferCluster overlap) and using SC3 on the target dataset alone (TargetCluster) is to be preferred (Fig. <xref rid="Fig2" ref-type="fig">2D</xref>). For two exclusive target and three exclusive source top nodes and no cell types that appear in both sets (No overlap), concatenating source and target into one dataset (ConcatenateCluster) has a negative effect on the clustering of the target cells and should be avoided. Importantly and in contrast to the ConcatenateCluster, the use of TransferCluster does not significantly reduce clustering performance compared to <italic>de novo</italic> clustering of the target data alone and can keep the levels of performance as high as not taking the source data into account at all, as the method can choose a low mixture parameter when there is no overlap. This can be seen in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4</xref> where the mixture parameter selection process of TransferCluster via KTA scores is investigated.</p>
      <p id="Par63">To conclude, the transfer learning approach outperforms both baseline methods and works as expected for simulated scRNA-Seq data. For a detailed description and analysis of the data simulation experiments, see Supplementary Section <xref rid="MOESM1" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Validation using subsampled source and target data from a single dataset</title>
      <p id="Par64">Now we present the results of subsampling both source and target from the same real scRNA-Seq dataset<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> and comparing the performance of our method to that of the baseline methods. In order to validate our approach for a scenario where no reliable ground truth labels exist, we first generated synthetic labels of 18 clusters via NMF clustering<sup><xref ref-type="bibr" rid="CR73">73</xref>,<xref ref-type="bibr" rid="CR74">74</xref></sup> on the whole dataset, which we then considered to be the ground truth for this experiment. Figure <xref rid="Fig3" ref-type="fig">3A,B</xref> show the corresponding ARI curves for complete and incomplete overlap between source and target dataset. For both scenarios, transferring knowledge into the target dataset improves its clustering in subsequent SC3 clustering and outperforms both baseline methods. When source and target datasets share the complete clustering structure (panel A), concatenating the two datasets (ConcatenateCluster) improves the clustering results of the target data (TargetCluster), but transferring knowledge via the proposed method (TransferCluster) is seen to improve it even more. While for a complete overlap, ConcatenateCluster can improve target clustering by a large margin, when the target dataset is relatively small in comparison to source (for example, 1/10th of source), the method fails to find additional gains over <italic>de novo</italic> clustering of target when the clustering structure in source and target are similar but not identical (Incomplete overlap, panel B). In this setting, which is the more realistic one in most cases, ConcatenateCluster does not perform well and only the knowledge transfer via the proposed method can improve the target clustering results. Hence, it should be the preferred option to incorporate source information into a target clustering.<fig id="Fig3"><label>Figure 3</label><caption><p>Results of source and target data from mouse visual cortex cells<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. (<bold>A</bold>) Clustering performances of all three methods using NMF clustering labels of 18 clusters generated on the whole dataset as ground truth labels. Source and target datasets share the complete clustering structure, i.e. all cell types appear in both source and target data (Complete overlap). (<bold>B</bold>) Clustering performances of all three methods using NMF clustering labels of 18 clusters generated on the whole dataset as ground truth labels. The overlap is not complete, i.e. the two biggest clusters of the dataset are assigned to be either exclusive source or target clusters (Incomplete overlap). (<bold>C</bold>) Clustering performances of all three methods using the data driven clustering results from the original paper<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> as ground truth labels. Source and target datasets share the complete clustering structure, i.e. all cell types appear in both source and target data (Complete overlap). (<bold>D</bold>) Clustering performances of all three methods using the data driven clustering results from the original paper<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> as ground truth labels. The overlap is not complete, i.e. the two biggest clusters of the dataset are assigned to be either exclusive source or target clusters (Incomplete overlap). 95% confidence intervals are shown.</p></caption><graphic xlink:href="41598_2019_56911_Fig3_HTML" id="d29e2561"/></fig></p>
      <p id="Par65">Secondly, instead of generating labels of the complete dataset via NMF clustering, we use the data driven clustering labels provided in the original paper<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> as ground truth labels and apply the same subsampling procedure as above. Figure <xref rid="Fig3" ref-type="fig">3C,D</xref> show the corresponding results for complete and incomplete overlap. Again, for both settings the transfer learning approach improves TargetCluster clustering on target data alone. Knowledge is successfully transferred from the source to the target dataset no matter how big the overlap in the clustering structure of the two sets is.</p>
      <p id="Par66">The comparison to the second baseline method of concatenating both sets into one, shows for complete overlap of the clusters in both datasets that transfer learning helps but cannot outperform ConcatenateCluster. However, in the more realistic setting of an incomplete overlap in the clustering structures, concatenating the two datasets has a negative effect on the target clustering, especially for large sample sizes. ConcatenateCluster collapses and it performs even worse than not using the source data at all (TargetCluster) for some larger target sample sizes. Transfer learning is able to avoid this effect and succeeds in incorporating valuable information from the source data into the target data improving its clustering results consistently for all target sample sizes. Transfer learning is clearly to be preferred in this setting.</p>
    </sec>
    <sec id="Sec14">
      <title>Biological results of independent source and target datasets</title>
      <p id="Par67">Leaving the controlled environment where source and target data are sampled from the same distribution, we lastly investigate a real-world application where source and target are completely independent, but biologically related, datasets, collected at different times and places. The proposed transfer learning method was able to identify relatedness but also differences in the two datasets by automatically choosing a mixture parameter θ of 0.7 in the KTA score procedure. Please see Supplementary Section <xref rid="MOESM1" ref-type="media">4.2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S8</xref> where the mixture parameter selection process of TransferCluster via KTA scores is investigated.</p>
      <p id="Par68">To assess the performance of our method, we are unable to compute ARI scores in this setting. In contrast to the simulations described above, the true underlying clustering architecture of the cells under study is largely unknown. Hence, we assessed clustering performance based on differential gene expression and biological relevance to known somatosensory pathways. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we show t-SNE plots for the Hockley data overlaid with cluster memberships corresponding to the results of methods following the use of the Usoskin data as source. As predicted using TargetCluster (<italic>i.e</italic>. the method utilizing SC3 clustering of the Hockley data alone) we identified a similar cluster structure to that observed by the authors in their original study<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Specifically, we identify 6 well-defined clusters (and a 7th poorly defined cluster) that could be separated based on gene expression and also an important anatomical difference related to the spinal region from which the neuron was collected (<italic>i.e</italic>. in Fig. <xref rid="Fig4" ref-type="fig">4A</xref>, clusters 2 and 4 are both predominantly populated by lumbosacral sensory neurons as indicated by the use of circles, whilst the neurons within the other clusters are mainly thoracolumbar in origin as shown by triangles). In contrast to the original study, TargetCluster did however fail to robustly segregate two biologically distinct groups of cells, which, using the authors original nomenclature are named mNP and mNFa, respectively. In our hands, they correspond to cluster 1 in Fig. <xref rid="Fig4" ref-type="fig">4A</xref>. The first mNP cluster comprises 15 neurons and expresses Mas-related G-protein coupled receptor D (<italic>Mrgprd</italic>; Fig. <xref rid="Fig4" ref-type="fig">4B</xref>) and Lysophosphatidic acid receptor 3 (<italic>Lpar3</italic>); genes previously associated with non-peptidergic nociceptive pruriceptors<sup><xref ref-type="bibr" rid="CR79">79</xref></sup>. The second mNFa group of 16 neurons expresses P2Y purinergic receptor 1 (<italic>P2ry1</italic>; Fig. <xref rid="Fig4" ref-type="fig">4C</xref>) and BAI1-associated protein 2-like 1 (<italic>Baiap2l1</italic>) and is indicative of mechanosensitive nociceptors<sup><xref ref-type="bibr" rid="CR80">80</xref></sup>. Whilst SC3 was used by the authors to cluster in their original study, this is not deterministic and produces different results when solving the same clustering problem multiple times. Indeed, when we counted the number of times the mNP and mNFa clusters were separated when repeating the procedure, TargetCluster was only correct 224 times out of 1000. The use of ConcatenateCluster on both the Hockley and Usoskin datasets improved the robustness of clustering these two groups as separate clusters (506/1000, e.g. in Fig. <xref rid="Fig4" ref-type="fig">4D</xref>, clusters 1 and 7), however this came at the expense of clustering accuracy within the remaining neurons. For example, in Fig. <xref rid="Fig4" ref-type="fig">4D</xref>, ConcatenateCluster identifies a more simplistic cluster structure with 4 clusters and no longer distinguishes separations between spinal segmental regions (e.g. thoracolumbar and lumbosacral) from which neuronal subtypes have been collected. As such, the concatenation of target and source, in this instance at least, may miss biologically relevant clusters. Specifically, what the original authors suggest as a putative novel peptidergic subtype (pPEP) unique to the lumbosacral DRG with high expression of neurotrimin (<italic>Ntm</italic>; Fig. <xref rid="Fig4" ref-type="fig">4E</xref>), tyrosine hydroxylase (<italic>Th</italic>) and calcitonin polypeptide alpha (<italic>Calca</italic>), and a second group of lumbosacral neurons, the pNF subtype, which are thought to represent a low-threshold mechanoreceptor group within the colorectum with selective expression of secreted phosphoprotein 1 (<italic>Spp1</italic>; Fig. <xref rid="Fig4" ref-type="fig">4F</xref>) and the mechanotransducer <italic>Piezo2</italic>, would have been missed using ConcatenateCluster.<fig id="Fig4"><label>Figure 4</label><caption><p>Clustering example biological data using the transfer learning approach. t-SNE plots of mouse colonic sensory neurons: colour refers to clusters derived from the three approaches (<bold>A</bold>) TargetCluster, using only data from Hockley <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> to assign clusters. (<bold>D</bold>) ConcatenateCluster, using a concatenation of data from Hockley <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and Usoskin <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (mouse sensory neurons) to assign clusters. (<bold>G</bold>) TransferCluster, using the novel transfer learning approach with Usoskin <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> as Source and Hockley <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> as Target) and shape refers to spinal segment from which the neuron was isolated (triangle, TL (thoracolumbar); circle, LS (lumbosacral)). In <bold>G</bold>, clusters 1 and 7 (black dashed boxes), cluster 2 (blue dashed box) and cluster 4 (green dashed box) represent biologically distinct groups of cells with differing sensory functions. This is exemplified by the cluster-specific expression of specific genes by cluster 7 (<bold>B</bold>), Mrgprd), 1 (<bold>C</bold>, P2ry1), 2 (<bold>E</bold>, Ntm) and 4 (<bold>F</bold>, Spp1). Colour scheme represents expression level [log(TPM)].</p></caption><graphic xlink:href="41598_2019_56911_Fig4_HTML" id="d29e2732"/></fig></p>
      <p id="Par69">When knowledge from the larger Usoskin dataset was instead transferred using TransferCluster, not only was the clustering accuracy of the overall data retained (identifying 7 well-defined clusters) but the probability of separating the clusters mNP and mNFa was partially increased (for TransferCluster with level 3 labels, 352/1000; Fig. <xref rid="Fig4" ref-type="fig">4G</xref>). Unlike ConcatenateCluster, TransferCluster correctly identifies not only mNP and mNFa clusters (as highlighted by the black dashed boxes around clusters 1 and 7 in Fig. <xref rid="Fig4" ref-type="fig">4G</xref>) but also spinal region dependent clusters pPEP (green dashed box, cluster 4, Fig. <xref rid="Fig4" ref-type="fig">4G</xref>) and pNF (blue dashed box, cluster 2, Fig. <xref rid="Fig4" ref-type="fig">4G</xref>). In order to quantify these effects, we measured how frequently TransferCluster separated cluster 2 (e.g. pNF) from cluster 6 (1000/1000) compared to ConcatenateCluster (481/1000), and likewise, how frequently cluster 4 was separated from cluster 3 (887/1000) compared to ConcatenateCluster (4/1000). This clustering robustness analysis is summarized in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Robustness analysis on Hockley dataset.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>TargetCluster</th><th>ConcatenateCluster</th><th>TransferCluster</th></tr></thead><tbody><tr><td>mNP/mNFa</td><td>224|230|479</td><td>506|998|902</td><td>352|605|919</td></tr><tr><td>pPEP</td><td>984|1000|921</td><td>4|33|431</td><td>887|1000|944</td></tr><tr><td>pNF</td><td>999|1000|801</td><td>481|962|579</td><td>1000|1000|831</td></tr></tbody></table><table-wrap-foot><p>For each method we present the number of times a specific cell type was identified correctly out of 1000 replications. In each field of the table the first number corresponds to applying the method to the original datasets with no additional pre-processing, the second number is the result of applying Seurat batch effect removal<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> before the analysis and the third number represents results on datasets that have been imputed with MAGIC<sup><xref ref-type="bibr" rid="CR78">78</xref></sup>.</p></table-wrap-foot></table-wrap></p>
      <p id="Par70">In additional experiments, we applied an established batch effect removal pre-processing step<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> to combine the Usoskin and Hockley datasets, which were then separated and our three clustering methods applied as described above. Batch effect removal improves the performances of both ConcatenateCluster and TransferCluster, however transfer learning still outperforms simultaneous clustering on the combined dataset. For example, ConcatenateCluster fails to reliably identify pPEP cells (33/1000), whilst TransferCluster following batch effect pre-processing finds all three cell types of interest in the majority of cases (mNP/mNFa split: 605, pPEP: 1000 and pNF: 1000, Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par71">Table <xref rid="Tab1" ref-type="table">1</xref> also shows the results of applying a widely used imputation method<sup><xref ref-type="bibr" rid="CR78">78</xref></sup> to the original datasets before applying the three clustering methods. It can be seen that imputation improves the performances of all methods on (almost) all clusters, but transfer learning still outperforms clustering on the target dataset alone and simultaneous clustering on the combined dataset in some areas. Specifically, for the identification of mNP and mNFa clusters transfer learning improves the results and yields almost twice as many correct results than TargetCluster (919/1000 vs. 479/1000). TransferCluster is still the only method that identifies all three clusters in the majority of cases (919/1000, 944/1000 and 831/1000 for the three clusters of interest). In comparison, TargetCluster does not perform as well when looking at the mNP/mNFa clusters (479/1000) and ConcatenateCluster does not do as well considering the pPEP and the pNF clusters (431/1000 and 579/1000). Please note that imputation trough MAGIC<sup><xref ref-type="bibr" rid="CR78">78</xref></sup> greatly increased the overlap in genes between the two datasets after gene filtering from 4402 to 20125 common genes. The larger common feature space provides an explanation for the positive effect of MAGIC on the performance of clustering after concatenation or transfer learning. However, ConcatenateCluster - which also profits from the increased number of common genes - does not perform as well as TransferCluster (looking at the pPEP/pNF clusters). Hence, knowledge transfer is necessary and improves clustering regardless of whether MAGIC is used or not.</p>
      <p id="Par72">In conclusion, we show that TransferCluster is able to improve the reliability of clustering small datasets through the transfer of knowledge from a larger, biologically relevant, yet independent, dataset and that this method is improved by and amenable to existing pre-processing approaches. See Supplementary Section <xref rid="MOESM1" ref-type="media">4.4.2</xref>. for a detailed description of the stability analysis using source labels that were generated via NMF clustering and using level 1, 2 and 3 labels of the original publication.</p>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par73">To address challenges in the field of clustering scRNA-Seq datasets a number of methods have been presented in the literature to make use of datasets from different studies, laboratories or points in time. These approaches can be classified into two groups:<list list-type="order"><list-item><p id="Par74">Multitask learning approaches that solve clustering problems of multiple datasets simultaneously while correcting for batch effects<sup><xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR63">63</xref></sup> and</p></list-item><list-item><p id="Par75">Transfer learning approaches that use large reference datasets to improve the clustering of target datasets that are often smaller in sample size<sup><xref ref-type="bibr" rid="CR67">67</xref>–<xref ref-type="bibr" rid="CR72">72</xref></sup>.</p></list-item></list></p>
    <p id="Par76">The main point of interest of this work lies in transferring knowledge without having to combine datasets and thus our focus should be on methods that fall into the second category. Rather than limiting a clustering method to a reference set of cell types<sup><xref ref-type="bibr" rid="CR67">67</xref>–<xref ref-type="bibr" rid="CR70">70</xref></sup>, we aim to enable the annotation of new target clusters. This leaves us with only one method, called SAVER-X<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>, that is most closely related to the present research in aiming to adjust a target dataset with information from a source dataset. By training a deep autoencoder on the target dataset and initializing it with weights obtained from training on the source dataset SAVER-X achieves denoising of the target dataset. Denoising, however, is not the only goal of our method which can additionally be used to induce certain specific properties of the source dataset into the target dataset by making use of pre-existing source labels. In contrast to our method SAVER-X also depends on large sample sizes and is not convex.</p>
    <p id="Par77">Another relevant deep-learning based approach<sup><xref ref-type="bibr" rid="CR72">72</xref></sup> focuses on improving the clustering of a target dataset with the help of a source dataset that does not share any cell types with the target dataset. The method is not comparable to our transfer learning approach, because we concentrate on problems where source and target data share a significant number of cell types.</p>
    <p id="Par78">For the aforementioned reasons and to our knowledge, this work presents a novel approach to a unique problem setting, that has so far not been addressed in previous literature.</p>
    <p id="Par79">Our approach can be extended to explore a number of different research directions since it is relatively easy to apply, modify and adjust. Other downstream analysis methods instead of the SC3 clustering methods or even instead of clustering in general could be used. As mentioned before it is also possible to use the proposed method to transfer knowledge from small to large datasets. Additionally, the transfer learning approach can be applied to other areas of scientific research in biological and medical fields.</p>
    <p id="Par80">Potential future research directions making adjustments to the method itself might include the incorporation of different source and target feature spaces. If <italic>X</italic><sub><italic>src</italic></sub> and <italic>X</italic><sub><italic>trg</italic></sub> only share a small set of transcripts, a loss of (probably) vital information is inevitable since only the set of genes present in both datasets can be used. Most of the multitask learning methods listed above only use the intersection of genes of all datasets when combining the datasets. Future work should thus focus on making adjustments to the method that allow the inclusion of different sets of source and target genes. One important technical point here is that scRNA-Seq experiments often make a trade-off between high cell numbers and high gene numbers. While technologies like 10X<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> enable high cell numbers but low gene coverage, other tools like SMARTSeq2<sup><xref ref-type="bibr" rid="CR81">81</xref></sup> use low cell numbers, but generate high gene coverage. Ideally one would like to use a 10X dataset (or similar) to aid the clustering of a SMARTSeq2 dataset (or similar), but somehow retain the detailed gene information. In this kind of setting where the target dataset has substantially more genes than the source dataset, a simple modification of our method is straightforward: While the transfer learning procedure can be applied without changes to the genes in both source and target, all other genes in the target dataset can be left constant. A more sophisticated way to modify the method accordingly would be to make use of a learned covariance matrix over the target genes to adjust those genes that are in the target but not in the source. The same procedure can be applied in a setting where there are source genes that are not part of the target dataset.</p>
    <p id="Par81">To summarize, we propose a novel and powerful method for transferring knowledge from a well-annotated source dataset to a target dataset of smaller sample size for which new cluster annotations are desired. Source clustering labels can be incorporated as part of this knowledge when available, but are not required. The knowledge transfer procedure is based on the application of an NMF step on the source dataset before transferring the learned knowledge to the target dataset by reconstruction of a new target dataset. Finally, this modified target dataset can potentially be provided to any clustering algorithm. We have shown here that it can be successfully applied to SC3 clustering and improves the results of SC3 consistently for a range of different settings. Specifically, transferring knowledge from a large well-annotated source dataset to a smaller target dataset was not only more successful than applying SC3 to the original target set alone but also to a simple concatenation of the source and target. This was found to be true in both simulated and real-world environments where source and target were either sampled from identical distributions of cells or only shared a subset of cell clusters. In real-world applications the method will thus be especially helpful when the overlap between source and target data is not perfect and concatenation of the two datasets is not a good option. The method was shown to perform well regardless of whether reliable clustering labels of the source data are available or not. The performance of the proposed method can be further improved by applying appropriate pre-processing batch effect removal or imputation before clustering.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2019_56911_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary  Information</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Bettina Mieth, James R. F. Hockley and Nico Görnitz.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-019-56911-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the German Federal Ministry for Education and Research through the Berlin Big Data Centre (01IS14013A), the Berlin Center for Machine Learning (01IS18037I) and the TraMeExCo project (01IS18056A). Partial funding by DFG is acknowledged (EXC 2046/1, project-ID: 390685689). This work was also supported by the Institute for Information &amp; Communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) (No.2017-0-01779). We thank Dominik Kühne for technical support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>K.-R.M., A.G. and D.Z. designed and directed research; B.M., J.R.F.H., N.G. and M.M.C.V. performed research and analyzed data; and B.M., J.R.F.H., N.G., K.-R.M., A.G. and D.Z. wrote the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The datasets analyzed during the current study are available in the following GEO repositories:</p>
    <p>• Tasic <italic>et al</italic>. (2016)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585</ext-link>.</p>
    <p>• Usoskin <italic>et al</italic>. (2014)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE59739">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE59739</ext-link></p>
    <p>• Hockley <italic>et al</italic>. (2018)<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE102962">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE102962</ext-link></p>
    <p>The code for simulating scRNA-Seq datasets is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/nicococo/scRNA">https://github.com/nicococo/scRNA</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par82">J.R.F.H. and A.G. are employees and shareholders of GSK Ltd. D.Z. is a full-time employee of Pfizer and may hold stocks and options in Pfizer Inc. All other authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis and display of genome-wide expression patterns</article-title>
        <source>Proc. Natl. Acad. Sci.</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>25</issue>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id>
        <?supplied-pmid 9843981?>
        <pub-id pub-id-type="pmid">9843981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inamura</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two subclasses of lung squamous cell carcinoma with different gene expression profiles and prognosis identified by hierarchical clustering and non-negative matrix factorization</article-title>
        <source>Oncogene</source>
        <year>2005</year>
        <volume>24</volume>
        <fpage>7105</fpage>
        <lpage>7113</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1208858</pub-id>
        <?supplied-pmid 16007138?>
        <pub-id pub-id-type="pmid">16007138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <source>A Survey on Transfer Learning. IEEE T. Knowl. Data. En.</source>
        <year>2010</year>
        <volume>22</volume>
        <fpage>1345</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="doi">10.1109/TKDE.2009.191</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Torrey, L., &amp; Shavlik, J. Transfer Learning in Handbook of Research on Machine Learning Applications and Trends: Algorithms, Methods, and Techniques (ed. E. Olivas, J. Guerrero, M. Martinez-Sober, J. Magdalena-Benedito, &amp; A. Serrano López) 242–264 (Hershey, 2010).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chi</surname>
            <given-names>KR</given-names>
          </name>
        </person-group>
        <article-title>Singled out for sequencing</article-title>
        <source>Nat. Methods.</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>13</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2768</pub-id>
        <?supplied-pmid 24524130?>
        <pub-id pub-id-type="pmid">24524130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawy</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single-cell sequencing</article-title>
        <source>Nat. Methods.</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2771</pub-id>
        <?supplied-pmid 24524131?>
        <pub-id pub-id-type="pmid">24524131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat. Methods.</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>377</fpage>
        <lpage>382</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <?supplied-pmid 19349980?>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-016-0009-6</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>
        <source>Cell.</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rostom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kar</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Computational approaches for interpreting scRNA-seq data</article-title>
        <source>FEBS Lett.</source>
        <year>2017</year>
        <volume>38</volume>
        <fpage>42</fpage>
        <lpage>49</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B-cell development</article-title>
        <source>Cell.</source>
        <year>2014</year>
        <volume>157</volume>
        <fpage>714</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.04.005</pub-id>
        <?supplied-pmid 24766814?>
        <pub-id pub-id-type="pmid">24766814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Inferring the kinetics of stochastic gene expression from single-cell RNA-sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R7</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-1-r7</pub-id>
        <?supplied-pmid 23360624?>
        <pub-id pub-id-type="pmid">23360624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature.</source>
        <year>2015</year>
        <volume>525</volume>
        <fpage>251</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14966</pub-id>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>155</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id>
        <?supplied-pmid 25599176?>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Unique Microglia Type Associated with Restricting Development of Alzheimer’s Disease</article-title>
        <source>Cell.</source>
        <year>2017</year>
        <volume>169</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.018</pub-id>
        <pub-id pub-id-type="pmid">28340335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Regev, A. <italic>et al</italic>. The Human Cell Atlas. <italic>eLife</italic>. <bold>6</bold> (2017).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Defining cell types and states with single-cell genomics</article-title>
        <source>Genome Res.</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1491</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.190595.115</pub-id>
        <?supplied-pmid 26430159?>
        <pub-id pub-id-type="pmid">26430159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Co-Expression in Single-Cell Analysis: Saving Grace or Original Sin?</article-title>
        <source>Trends Genet.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>823</fpage>
        <lpage>831</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2018.07.007</pub-id>
        <?supplied-pmid 30146183?>
        <pub-id pub-id-type="pmid">30146183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poulin</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hjerling-Leffler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trimarchi</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Awatramani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Disentangling neural cell diversity using single-cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>1131</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4366</pub-id>
        <?supplied-pmid 27571192?>
        <pub-id pub-id-type="pmid">27571192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Usoskin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased classification of sensory neuron types by large-scale single-cell RNA sequencing</article-title>
        <source>Nat. Neurosci.</source>
        <year>2014</year>
        <volume>18</volume>
        <fpage>145</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.3881</pub-id>
        <?supplied-pmid 25420068?>
        <pub-id pub-id-type="pmid">25420068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Hockley, J. R. F. <italic>et al</italic>. Single-cell RNAseq reveals seven classes of colonic sensory neuron. <italic>Gut</italic>. 2017–315631 (2018).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular Architecture of the Mouse Nervous System</article-title>
        <source>Cell.</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>999</fpage>
        <lpage>1014</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.021</pub-id>
        <?supplied-pmid 30096314?>
        <pub-id pub-id-type="pmid">30096314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Häring</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neuronal atlas of the dorsal horn defines its architecture and links sensory input to transcriptional cell types</article-title>
        <source>Nat. Neurosci.</source>
        <year>2018</year>
        <volume>21</volume>
        <fpage>869</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-018-0141-1</pub-id>
        <?supplied-pmid 29686262?>
        <pub-id pub-id-type="pmid">29686262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7285</fpage>
        <lpage>7290</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1507125112</pub-id>
        <?supplied-pmid 26060301?>
        <pub-id pub-id-type="pmid">26060301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>335</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4216</pub-id>
        <?supplied-pmid 26727548?>
        <pub-id pub-id-type="pmid">26727548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCnorm: robust normalization of single-cell RNA-seq data</article-title>
        <source>Nat. Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>584</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4263</pub-id>
        <?supplied-pmid 28418000?>
        <pub-id pub-id-type="pmid">28418000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>
        <source>Nat. Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>565</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id>
        <?supplied-pmid 28504683?>
        <pub-id pub-id-type="pmid">28504683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat. Methods.</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>
        <source>Genome biology</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id>
        <?supplied-pmid 26527291?>
        <pub-id pub-id-type="pmid">26527291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Lun A.T., Bach K. &amp; Marioni J.C. Pooling across cells to normalize single-cell RNA sequencing data with many zero counts. <italic>Genome Biol</italic>. 17–75 (2016).</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>
        <source>Nat. Methods.</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>845</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3971</pub-id>
        <?supplied-pmid 27571553?>
        <pub-id pub-id-type="pmid">27571553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maaten</surname>
            <given-names>LVD</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Visualizing Data using t-SNE</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>2579</fpage>
        <lpage>2605</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Riggs</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>SAIC: an iterative clustering approach for analysis of single cell RNA-seq data</article-title>
        <source>BMC Genomics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>689</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4019-5</pub-id>
        <?supplied-pmid 28984204?>
        <pub-id pub-id-type="pmid">28984204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Whitsett</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SINCERA: A Pipeline for Single-Cell RNA-Seq Profiling Analysis</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004575</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id>
        <?supplied-pmid 26600239?>
        <pub-id pub-id-type="pmid">26600239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Žurauskien</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>C. pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>140</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0984-y</pub-id>
        <pub-id pub-id-type="pmid">27005807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aibar</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>
        <source>Nat. Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1083</fpage>
        <lpage>1086</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id>
        <?supplied-pmid 28991892?>
        <pub-id pub-id-type="pmid">28991892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1974</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id>
        <?supplied-pmid 25805722?>
        <pub-id pub-id-type="pmid">25805722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differentiation dynamics of mammary epithelial cells revealed by single-cell RNA sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2128</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02001-5</pub-id>
        <?supplied-pmid 29225342?>
        <pub-id pub-id-type="pmid">29225342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>J-L</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J. Stat. Mech.</source>
        <year>2008</year>
        <volume>10</volume>
        <fpage>1088</fpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosvall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bergstrom</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Maps of random walks on complex networks reveal community structure</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>1118</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0706851105</pub-id>
        <?supplied-pmid 18216267?>
        <pub-id pub-id-type="pmid">18216267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dulken</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Leeman</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Boutet</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brunet</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell Transcriptomic Analysis Defines Heterogeneity and Transcriptional Dynamics in the Adult Neural Stem Cell Lineage</article-title>
        <source>Cell.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>777</fpage>
        <lpage>790</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cells make big data: New challenges and opportunities in transcriptomics</article-title>
        <source>Curr. Opin. Syst. Biol.</source>
        <year>2017</year>
        <volume>4</volume>
        <fpage>85</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coisb.2017.07.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Condon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Interpretable dimensionality reduction of single cell transcriptome data with deep generative models</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2002</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04368-5</pub-id>
        <?supplied-pmid 29784946?>
        <pub-id pub-id-type="pmid">29784946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>VASC: dimension reduction and visualization of single cell RNA sequencing data by deep variational autoencoder</article-title>
        <source>Genom. Proteom. Bioinform.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>320</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gpb.2018.08.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eraslan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Mircea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Single cell RNA-seq denoising using a deep count autoencoder</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>390</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07931-2</pub-id>
        <?supplied-pmid 30674886?>
        <pub-id pub-id-type="pmid">30674886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Grønbech, C. H. <italic>et al</italic>. scVAE: variational auto-encoders for single-cell gene expression data. <italic>bioRxiv</italic>10.1101/318295 (2019).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Thrun, S. Is Learning The n-th thing any easier than learning the first? <italic>Adv. Neur. In</italic>., 7 (1996).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caruana</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Multitask Learning</article-title>
        <source>Mach. Learn.</source>
        <year>1997</year>
        <volume>28</volume>
        <fpage>41</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1007379606734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id>
        <?supplied-pmid 29608177?>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Hie, B.L., Bryson, B. &amp; Berger, B. Panoramic stitching of heterogeneous single-cell transcriptomic data. <italic>bioRxiv</italic>, 10.1101/371179 (2018).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Park, J.-E., Polanski, K., Meyer, K. &amp; Teichmann, S.A. Fast Batch Alignment of Single Cell Transcriptomes Unifies Multiple Mouse Cell Atlases into an Integrated Landscape. <italic>bioRxiv</italic>. 10.1101/397042 (2018).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Barkas, N. <italic>et al</italic>. Wiring together large single-cell RNA-seq sample collections. <italic>bioRxiv</italic>. 10.1101/460246 (2018).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Burkhardt, D. B. <italic>et al</italic>. Enhancing experimental signals in single-cell RNA-sequencing data using graph signal processing. <italic>bioRxiv</italic>. 10.1101/532846 (2019).</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <?supplied-pmid 6700744?>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multitask clustering approach for single-cell RNA-seq analysis in Recessive Dystrophic Epidermolysis Bullosa</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1006053</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006053</pub-id>
        <?supplied-pmid 29630593?>
        <pub-id pub-id-type="pmid">29630593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Forrow, A. <italic>et al</italic>. Statistical Optimal Transport via Factored Couplings. <italic>arXiv</italic>. doi:1806.07348 (2018).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Johansen, N. &amp; Quon, G. scAlign: a tool for alignment, integration and rare cell identification from scRNA-seq data. <italic>bioRxiv</italic>. doi:10.1101/504944 (2019).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat. Methods.</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <?supplied-pmid 30504886?>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Korsunsky, I. <italic>et al</italic>. Fast, sensitive, and accurate integration of single cell data with Harmony. <italic>bioRxiv</italic>. doi:10.1101/461954 (2018).</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Li, X. <italic>et al</italic>. Deep learning enables accurate clustering and batch effect removal in single-cell RNA-seq analysis. <italic>bioRxiv</italic>. doi:10.1101/530378 (2019).</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Johnson, T. <italic>et al</italic>. LAmbDA: Label Ambiguous Domain Adaptation Dataset Integration Reduces Batch Effects and Improves Subtype Detection. <italic>bioRxiv</italic>. doi:10.1101/522474 (2019).</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>Xin</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Deqing</given-names>
          </name>
          <name>
            <surname>Gogol</surname>
            <given-names>Madelaine</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Hua</given-names>
          </name>
        </person-group>
        <article-title>ClusterMap: compare multiple single cell RNA-Seq datasets across different experimental conditions</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>17</issue>
        <fpage>3038</fpage>
        <lpage>3045</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz024</pub-id>
        <?supplied-pmid 30649203?>
        <pub-id pub-id-type="pmid">30649203</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ballouz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Characterizing the replicability of cell types defined by single cell RNA-sequencing data using MetaNeighbor</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>884</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03282-0</pub-id>
        <?supplied-pmid 29491377?>
        <pub-id pub-id-type="pmid">29491377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Mereu, E. <italic>et al</italic>. matchSCore: Matching Single-Cell Phenotypes Across Tools and Experiments. <italic>bioRxiv</italic>. 10.1101/314831 (2018).</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Aran, D. <italic>et al</italic>. Reference-based annotation of single-cell transcriptomes identifies a profibrotic macrophage niche after tissue injury. <italic>bioRxiv</italic>. 10.1101/284604 (2018).</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>CellAtlasSearch: a scalable search engine for single cells</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>W141</fpage>
        <lpage>W147</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky421</pub-id>
        <?supplied-pmid 29788498?>
        <pub-id pub-id-type="pmid">29788498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat. Methods.</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id>
        <?supplied-pmid 29608555?>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lior</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tal</surname>
            <given-names>Shay</given-names>
          </name>
        </person-group>
        <article-title>Classification of single cells by transfer learning: Harnessing the power of publicly available single cell RNA sequencing experiments to annotate new experiments</article-title>
        <source>PLoS One.</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>e0208349</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0208349</pub-id>
        <?supplied-pmid 30481223?>
        <pub-id pub-id-type="pmid">30481223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <mixed-citation publication-type="other">Wang, J. <italic>et al</italic>. Transfer learning in single-cell transcriptomics improves data denoising and pattern discovery. <italic>bioRxiv</italic>. 10.1101/457879 (2018).</mixed-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Using neural networks for reducing the dimensions of single-cell RNA-Seq data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>e156</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx681</pub-id>
        <?supplied-pmid 28973464?>
        <pub-id pub-id-type="pmid">28973464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Seung</surname>
            <given-names>HS</given-names>
          </name>
        </person-group>
        <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>
        <source>Nature.</source>
        <year>1999</year>
        <volume>401</volume>
        <fpage>788</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/44565</pub-id>
        <?supplied-pmid 10548103?>
        <pub-id pub-id-type="pmid">10548103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Seung</surname>
            <given-names>HS</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for non-negative matrix factorization</article-title>
        <source>Adv. Neural Inf. Process. Syst.</source>
        <year>2001</year>
        <volume>1</volume>
        <fpage>556</fpage>
        <lpage>562</lpage>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Regularization and variable selection via the elastic net</article-title>
        <source>J. R. Stat. Soc. Ser. B.</source>
        <year>2005</year>
        <volume>67</volume>
        <fpage>301</fpage>
        <lpage>320</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Cristianini, N., Shawe-Taylor, J., Elisseeff, A. &amp; Kandola, J. On Kernel Target Alignment. <italic>Adv. Neur. In</italic>., 367–373 (2002).</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J. Classif.</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Dijk</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovering Gene Interactions from Single-Cell Data Using Data Diffusion</article-title>
        <source>Cell.</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>716</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.061</pub-id>
        <?supplied-pmid 29961576?>
        <pub-id pub-id-type="pmid">29961576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zylka</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Topographically distinct epidermal nociceptive circuits revealed by axonal tracers targeted to Mrgprd</article-title>
        <source>Neuron</source>
        <year>2005</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>17</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2004.12.015</pub-id>
        <?supplied-pmid 15629699?>
        <pub-id pub-id-type="pmid">15629699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatosensory neuron types identified by high-coverage single-cell RNA-sequencing and functional heterogeneity</article-title>
        <source>Cell Res.</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1038/cr.2015.149</pub-id>
        <?supplied-pmid 26691752?>
        <pub-id pub-id-type="pmid">26691752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length RNA-seq from single cells using Smart-seq2</article-title>
        <source>Nat. Protoc.</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>171</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.006</pub-id>
        <?supplied-pmid 24385147?>
        <pub-id pub-id-type="pmid">24385147</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
