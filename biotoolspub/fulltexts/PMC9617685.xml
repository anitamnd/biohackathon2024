<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">JAMIA Open</journal-id>
    <journal-id journal-id-type="iso-abbrev">JAMIA Open</journal-id>
    <journal-id journal-id-type="publisher-id">jamiaoa</journal-id>
    <journal-title-group>
      <journal-title>JAMIA Open</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2574-2531</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9617685</article-id>
    <article-id pub-id-type="doi">10.1093/jamiaopen/ooac090</article-id>
    <article-id pub-id-type="publisher-id">ooac090</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research and Applications</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01530</subject>
        <subject>AcademicSubjects/MED00010</subject>
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Automated selection of changepoints using empirical <italic toggle="yes">P</italic>-values and trimming</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Quinn</surname>
          <given-names>Matthew</given-names>
        </name>
        <aff><institution>Department of Biostatistics, Harvard T.H. Chan School of Public Health</institution>, Boston, Massachusetts, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chung</surname>
          <given-names>Arlene</given-names>
        </name>
        <aff><institution>Department of Biostatistics &amp; Bioinformatics, Duke School of Medicine</institution>, Durham, North Carolina, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4394-5779</contrib-id>
        <name>
          <surname>Glass</surname>
          <given-names>Kimberly</given-names>
        </name>
        <aff><institution>Department of Biostatistics, Harvard T.H. Chan School of Public Health</institution>, Boston, Massachusetts, <country country="US">USA</country></aff>
        <aff><institution>Channing Division of Network Medicine, Brigham and Women’s Hospital</institution>, Boston, Massachusetts, <country country="US">USA</country></aff>
        <aff><institution>Department of Medicine, Harvard Medical School</institution>, Boston, Massachusetts, <country country="US">USA</country></aff>
        <xref rid="ooac090-cor1" ref-type="corresp"/>
        <!--kimberly.glass@channing.harvard.edu-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="ooac090-cor1">Corresponding Author: Kimberly Glass, Channing Division of Network Medicine, Brigham and Women’s Hospital, 181 Longwood Ave., Boston, MA, USA; <email>kimberly.glass@channing.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-29">
      <day>29</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>5</volume>
    <issue>4</issue>
    <elocation-id>ooac090</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of the American Medical Informatics Association.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="ooac090.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Objectives</title>
        <p>One challenge that arises when analyzing mobile health (mHealth) data is that updates to the proprietary algorithms that process these data can change apparent patterns. Since the timings of these updates are not publicized, an analytic approach is necessary to determine whether changes in mHealth data are due to lifestyle behaviors or algorithmic updates. Existing methods for identifying changepoints do not consider multiple types of changepoints, may require prespecifying the number of changepoints, and often involve nonintuitive parameters. We propose a novel approach, Automated Selection of Changepoints using Empirical <italic toggle="yes">P</italic>-values and Trimming (ASCEPT), to select an optimal set of changepoints in mHealth data.</p>
      </sec>
      <sec id="s2">
        <title>Materials and Methods</title>
        <p>ASCEPT involves 2 stages: (1) identification of a statistically significant set of changepoints from sequential iterations of a changepoint detection algorithm; and (2) trimming changepoints within linear and seasonal trends. ASCEPT is available at <ext-link xlink:href="https://github.com/matthewquinn1/changepointSelect" ext-link-type="uri">https://github.com/matthewquinn1/changepointSelect</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Results</title>
        <p>We demonstrate ASCEPT’s utility using real-world mHealth data collected through the Precision VISSTA study. We also demonstrate that ASCEPT outperforms a comparable method, circular binary segmentation, and illustrate the impact when adjusting for changepoints in downstream analysis.</p>
      </sec>
      <sec id="s4">
        <title>Discussion</title>
        <p>ASCEPT offers a practical approach for identifying changepoints in mHealth data that result from algorithmic updates. ASCEPT’s only required parameters are a significance level and goodness-of-fit threshold, offering a more intuitive option compared to other approaches.</p>
      </sec>
      <sec id="s5">
        <title>Conclusion</title>
        <p>ASCEPT provides an intuitive and useful way to identify which changepoints in mHealth data are likely the result of updates to the underlying algorithms that process the data.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>mobile health</kwd>
      <kwd>changepoints</kwd>
      <kwd>time series</kwd>
      <kwd>Monte Carlo method</kwd>
      <kwd>regression</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01EB025024</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>INTRODUCTION</title>
    <p>Recently, mobile health (mHealth) has taken on growing importance in medicine and public health, among other fields.<xref rid="ooac090-B1" ref-type="bibr"><sup>1–3</sup></xref> mHealth devices, such as Fitbit smartwatches, often produce time series data by recording variables, like heart rate (HR) and number of steps, at regular intervals (eg, hourly or daily). Studying these data can bring important insights into how health changes over time. For instance, an individual might walk less after an injury. This type of event corresponds with a “changepoint,” a time at which the distribution of data changes, and typically reflects a change in the mean of the data, or a “mean-shift.” When attributable to lifestyle or behavior, these shifts often follow trends. For instance, an individual’s steps may follow a linear trend, increasing at a fixed rate as they train for a marathon. Alternatively, their steps may follow a seasonal trend, increasing and decreasing periodically as they walk more during the summer than the winter each year. However, in addition to lifestyle or behavioral changes, wearable devices also have both planned software or hardware updates as well as unexpected technical issues that can impact data collection and reporting. These can introduce relatively sudden “technological changepoints” to the data, which can be difficult to distinguish from behaviorally driven changes, obscuring patterns of interest. Therefore, it is necessary to identify and correct for these technological changepoints before proceeding with downstream analysis.</p>
    <p>Unfortunately, mHealth device manufacturers often do not publicize the timing of planned updates and identified technological issues. Although an investigator could potentially monitor a manufacturer's release notes to determine when updates are pushed or manually inspect the mHealth data to find potential technological changepoints, these approaches are neither scalable nor practical and are especially challenging when studies utilize multiple types of devices. Even a single manufacturer may not push updates to all devices simultaneously, or they may require users to first update an associated smartphone app. Thus, manufacturer updates sometimes do not even coincide with a single timepoint across users.</p>
    <p>There are many existing approaches that detect changepoints in time series by solving an optimization problem,<xref rid="ooac090-B4" ref-type="bibr"><sup>4</sup></xref> including Pruned Exact Linear Time (PELT).<xref rid="ooac090-B5" ref-type="bibr"><sup>5</sup></xref> Using PELT generally entails specifying an optimization penalty when detecting multiple changepoints, which is difficult to do in practice. Changepoints for a Range of PenaltieS (CROPS)<xref rid="ooac090-B6" ref-type="bibr"><sup>6</sup></xref> allows one to efficiently run PELT under various penalties but does not select a final or optimal set of changepoints. Thus, instead of proposing another method for changepoint “detection,” we developed Automated Selection of Changepoints using Empirical <italic toggle="yes">P</italic>-values and Trimming (ASCEPT) to identify changepoints in mHealth data through changepoint “selection,” using relatively familiar statistical concepts instead of optimization parameters. ASCEPT analyzes multiple runs of PELT, considering iteratively larger sets of changepoints until the selected set no longer offers a statistically significant improvement over the prior set. Next, ASCEPT removes changepoints that are likely to be associated with lifestyle or behavioral changes rather than technological issues, ultimately yielding a single optimal set of changepoints. It is worth noting that ASCEPT shares similarities with circular binary segmentation (CBS),<xref rid="ooac090-B7" ref-type="bibr"><sup>7</sup></xref> which, unlike many other changepoint detection algorithms, uses a statistical test to identify significant changepoints and then performs “pruning” to identify a subset of those changepoints. However, CBS was designed for genomics data and does not consider features common to mHealth data, such as seasonal patterns.</p>
    <p>In addition to PELT and CBS, many other changepoint detection algorithms are available. For instance, there are changepoint algorithms that detect changes in linear, polynomial, and seasonal trends, rather than general mean-shifts,<xref rid="ooac090-B8" ref-type="bibr"><sup>8–10</sup></xref> while other algorithms handle abrupt changes in the presence of trends, changes in variance, or changes in the presence of autocorrelated noise.<xref rid="ooac090-B11" ref-type="bibr"><sup>11–14</sup></xref> While these algorithms address challenges similar to those found in mHealth data, ASCEPT addresses 2 problems that these algorithms do not. First, mHealth researchers typically have greater familiarity with statistical concepts than optimization concepts. ASCEPT replaces the choice of an optimization penalty, which is necessary for most changepoint detection algorithms, with a statistical metric. Second, mHealth time series can simultaneously contain sudden mean-shifts, linear trends, and seasonal trends, but existing algorithms tend to address only 1 or 2 of these characteristics at a time. Therefore, we designed ASCEPT to address all 3. ASCEPT also considers other details, such as how mHealth data may have as few as one observation between changepoints, which can prove difficult for many other algorithms. For a more detailed review of changepoint detection, please refer to the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <p>In this study, we evaluate ASCEPT on both simulated data and Fitbit data collected by the Precision VISSTA study<xref rid="ooac090-B15" ref-type="bibr"><sup>15</sup></xref> to determine whether the method appropriately identifies changepoints. Since ASCEPT and CBS<xref rid="ooac090-B7" ref-type="bibr"><sup>7</sup></xref> share underlying principles for identifying changepoints but differ in their mechanics, we compare the performance of ASCEPT to that of CBS and examine whether ASCEPT provides better changepoint selection under comparable settings. Lastly, we perform a correction procedure to determine whether differences between the procedures have an impact when adjusting the mHealth data for the identified changepoints.</p>
  </sec>
  <sec>
    <title>MATERIALS AND METHODS</title>
    <sec>
      <title>Data</title>
      <sec>
        <title>Precision VISSTA data</title>
        <p>We evaluated the performance of ASCEPT on mHealth data from the Precision VISSTA study.<xref rid="ooac090-B15" ref-type="bibr"><sup>15</sup></xref> This data set included adults in the United States who had inflammatory bowel diseases and were part of the parent Internet cohort study. Users participated in a survey and could donate their personal wearable device data towards research, meaning that the study followed a bring-your-own-device model. Thus, the data set contained multiple manufacturers and device types. Due to their prevalence in the cohort, we chose to focus on individuals who used a HR Fitbit device introduced in 2016–2019 (ie, the Alta HR, Blaze, Charge 2, Charge 3, Inspire HR, Ionic, Versa, or Versa 2), multiple Fitbit devices over time, or an unknown Fitbit device (eg, a Fitbit app). This subset of the data included 203 351 observations on 298 individuals recorded between May 15, 2015 and October 27, 2019.</p>
        <p>These data included 6 activity variables (steps, distance, floors, elevation, calories, and time active) and 6 sleep variables (total sleep, deep sleep, light sleep, rapid eye movement (REM) sleep, time awake at night, and times woken). The median number of users contributing data on a given day ranged from 50 for REM, to 93–95 for the other sleep variables, to 131 for the activity variables. We excluded floors and elevation as their values largely stayed within narrow ranges near zero over the study period. We also excluded REM sleep due to a lack of any data between May 20, 2016 and March 26, 2017. For more information on the Precision VISSTA data, including preprocessing steps, see the <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
        <p>To help identify population-level changepoints, we focused on the daily median value of each variable across users. As an example, <xref rid="ooac090-F1" ref-type="fig">Figure 1A</xref> shows the daily median amount of deep sleep across time, as well as the number of individuals contributing to these values. We observe that the median amount of deep sleep experienced an abrupt shift around July 2017. While it is possible that a single individual could have suddenly experienced large changes in deep sleep due to various life events, like an injury or the birth of a child, it is unlikely that the median deep sleep across many users truly decreased by 5–6 hours after July 19, 2017, only for it to later rebound multiple times. Instead, these shifts were more likely attributable to changes in how Fitbit’s algorithms calculated deep sleep. Thus, it is critical to identify and control for these technological changepoints in order to correctly describe human behavioral changes relevant to health and disease.</p>
        <fig position="float" id="ooac090-F1">
          <label>Figure 1.</label>
          <caption>
            <p>The ASCEPT workflow. (A) The daily median deep sleep from the Precision VISSTA study as well as the number of individuals contributing to these values. (B) ASCEPT broken down by stage and applied to simulated data. The first row shows the original simulated time series. The second row shows significant changepoints being iteratively identified. The third row shows changepoints within linear and seasonal trends being iteratively trimmed. The fourth row shows the simulated time series with the final set of identified changepoints. (C) The same results as (B) but for the deep sleep data.</p>
          </caption>
          <graphic xlink:href="ooac090f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>Simulated data</title>
        <p>Shifts and patterns that appeared in the real data were often not defined well enough to serve as gold standards. For example, there appeared to be seasonality in the deep sleep data prior to July 19, 2017, but it was inconsistent (<xref rid="ooac090-F1" ref-type="fig">Figure 1A</xref>). Likewise, it was challenging to determine whether some points between May 15, 2015 and May 15, 2016 constituted behaviorally driven or technological changepoints because only 7–54 unique users contributed data during this time. On the order of tens of samples are generally necessary for a good approximation of a median value. Therefore, large behaviorally driven fluctuations were more likely during this earlier period compared to later, when up to 160 unique users contributed sleep observations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>).</p>
        <p>Due to these limitations, we first evaluated ASCEPT using a simulated time series containing 800 observations (<xref rid="ooac090-F1" ref-type="fig">Figure 1B</xref>). This data set had sudden mean-shift changepoints at indices 49, 60, 600, 699, and 700, an increasing linear trend between indices 201 and 400 inclusive, and a seasonal pattern between indices 401 and 600 inclusive.</p>
      </sec>
    </sec>
    <sec>
      <title>ASCEPT stage 1: Changepoint selection using empirical <italic toggle="yes">P</italic>-values</title>
      <p>The first stage of ASCEPT incrementally accumulates mean-shift changepoints detected by PELT<xref rid="ooac090-B5" ref-type="bibr"><sup>5</sup></xref> until the newly proposed changepoints do not offer a statistically significant improvement in goodness of fit.</p>
      <p>We use CROPS<xref rid="ooac090-B6" ref-type="bibr"><sup>6</sup></xref> to efficiently run PELT for a range of different optimization penalties. From this, we obtain various sets of changepoints, from those found under high penalties to those found under low penalties. We let a changepoint at position <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> indicate that the time series' distribution changes between <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Let <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>th set of changepoints, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>K</mml:mi></mml:math></inline-formula>, and let <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∅</mml:mo></mml:math></inline-formula>, such that the procedure starts with no identified changepoints. This corresponds with a large optimization penalty in PELT. Assume that we have already found <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to be statistically significant. We then want to check the statistical significance of the next proposed set of changepoints, <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, which corresponds with a lower optimization penalty in PELT, given those changepoints in <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will usually, but not necessarily, be a subset of <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. <xref rid="ooac090-F2" ref-type="fig">Figure 2A, B</xref> depicts a scenario in which we have detected changepoints <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>305</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>600</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula> and are evaluating <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>49</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>60</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>305</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>600</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula> as providing a significant improvement.</p>
      <fig position="float" id="ooac090-F2">
        <label>Figure 2.</label>
        <caption>
          <p>The process for assessing the significance of new changepoints in ASCEPT. (A) The simulated data with initial changepoints <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>305</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>600</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>. The log-likelihood, assuming independent and identically distributed observations within-segment, is −3727.3. (B) The simulated data set with the next set of changepoints <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>49</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>60</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>305</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>600</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>. The log-likelihood is −3512.3, thus the observed change in the log-likelihood is 215.0. (C) A Monte Carlo sample with the initial changepoints at {305, 600} shown. The observations in each segment are randomly drawn from a normal with a mean and standard deviation equal to that for the corresponding segment in (A). The log-likelihood is −3746.6. (D) The same Monte Carlo sample from (C) but now with the next set of changepoints at {49, 60, 305, 600} shown. The log-likelihood is −3745.0. The change in the log-likelihood for this Monte Carlo sample under the null is therefore 1.6. The process in (C) and (D) is repeated a large number of times to generate an empirical null distribution for the change in the log-likelihood. In all plots, the segments between the identified changepoints are numbered.</p>
        </caption>
        <graphic xlink:href="ooac090f2" position="float"/>
      </fig>
      <p>To assess whether <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> offers a significant improvement in goodness of fit, we must both choose a goodness-of-fit measure and assess its null distribution. For goodness of fit, we use the log-likelihood of normally distributed data. More specifically, between any 2 changepoints, or between a changepoint and the start or end of the series, the observations form a “segment.” We assume that all observations are independent and normally distributed, but that those within the same segment are also identically distributed. This assumption largely follows the implementation of PELT in R's “changepoint” package.<xref rid="ooac090-B16" ref-type="bibr"><sup>16</sup></xref></p>
      <p>We next assess the null hypothesis that <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents all of the true mean-shift changepoints in the time series using a process that may be viewed as either a Monte Carlo procedure or a parametric bootstrap. We purposefully do this in a manner that does not rely on asymptotic results, since mHealth time series can contain very small segments (see <xref rid="ooac090-F1" ref-type="fig">Figure 1A</xref>). We first generate a time series under the null by randomly drawing from normal distributions with the same means and standard deviations as the corresponding segments created by <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the observed data. For example, <xref rid="ooac090-F2" ref-type="fig">Figure 2A</xref> shows the simulated data split into 3 segments by 2 changepoints at indices 305 and 600. <xref rid="ooac090-F2" ref-type="fig">Figure 2C</xref> illustrates a corresponding random sampling from the normal distributions whose means and standard deviations match those estimated for each of these 3 segments. We record the log-likelihood for this null time series using the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> changepoints. We then impose the changepoints in <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> onto this null time series and calculate the corresponding log-likelihood, as depicted in <xref rid="ooac090-F2" ref-type="fig">Figure 2D</xref>. Finally, we record the change in the log-likelihood under the null, comparing <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> with <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      <p>We repeat this process <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> times in order to calculate an empirical <italic toggle="yes">P</italic>-value for the observed change in the log-likelihood. If the observed change is statistically significant at the chosen level, <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, then we reject the null that <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents all the true mean-shift changepoints for the time series, and instead select <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> as the current set of significant changepoints. <xref rid="ooac090-F1" ref-type="fig">Figure 1B</xref> shows how the procedure continues, comparing <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> to <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and so forth, until we obtain a statistically insignificant result. This hypothesis testing process is a “fixed-sequence” procedure and controls the family-wise error rate (ie, the probability of making at least one Type 1 Error across tests) at the chosen significance level,<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:math></inline-formula>.<xref rid="ooac090-B17" ref-type="bibr"><sup>17</sup></xref></p>
    </sec>
    <sec>
      <title>ASCEPT stage 2: Trimming changepoints within linear or seasonal trends</title>
      <p>Stage 1 identifies changepoints that include both technological changepoints, such as those associated with manufacturer updates, and changepoints from behaviorally driven patterns. In order to distinguish the former from the latter we note that, while software updates likely induce sudden mean-shifts in population-level mHealth data, behaviorally driven changes are more likely to induce linear or seasonal trends (see, eg, <xref rid="ooac090-F1" ref-type="fig">Figure 1A</xref>). For instance, individuals may walk more at the end of an exercise program compared to at the start (linear trend) or walk more during summer than winter (seasonal trend). These trends technically contain a mean-shift at each point, but it is unnecessary to retain these changepoints since, in practice, investigators are generally interested in identifying the start and end of these trends, and then analyzing or adjusting them in their entirety. Therefore, ASCEPT aims to exclude changepoints within trends; for convenience, we refer to these as “nuisance changepoints.” In contrast, ASCEPT retains “relevant changepoints” that correspond with a sudden mean-shift, or that are at the start or end of a linear or seasonal trend (<xref rid="ooac090-F1" ref-type="fig">Figure 1C</xref>). We refer to ASCEPT’s process of removing nuisance changepoints as “trimming.” Although it is the same principle as “pruning” used by methods such as CBS,<xref rid="ooac090-B7" ref-type="bibr"><sup>7</sup></xref> we avoid the term “prune” because PELT also uses “prune” to describe part of its optimization process.<xref rid="ooac090-B5" ref-type="bibr"><sup>5</sup></xref></p>
      <p>We illustrate ASCEPT’s trimming process in <xref rid="ooac090-F3" ref-type="fig">Figure 3</xref>. <xref rid="ooac090-F3" ref-type="fig">Figure 3A</xref> shows a set of changepoints identified by stage 1. For every changepoint, we perform 2 types of model fits. We first fit piecewise linear and harmonic regressions on each of the 2 segments located to either side of the changepoint. We then fit linear and harmonic regressions across the 2 segments, ignoring the changepoint. To fit the linear models, which should capture linear trends, we regress the values in a segment against their indices. For harmonic regressions, which should capture seasonal trends, we first estimate a segment's period using the frequency associated with the peak of the periodogram and then fit the harmonic regression using a linear model based on this estimate. For each of the piecewise and cross-segment fits, we calculate the root mean square error (RMSE). For relevant changepoints, the piecewise fits should greatly outperform the cross-segment fits. However, for nuisance changepoints that are part of an ongoing linear or seasonal trend, the best cross-segment and piecewise fits should perform similarly.</p>
      <fig position="float" id="ooac090-F3">
        <label>Figure 3.</label>
        <caption>
          <p>The trimming process in ASCEPT. (A) The simulated data with an initial set of changepoints. For illustrative purposes, only a subset of the changepoints found after running the first stage of ASCEPT is shown. (B) Assessing the changepoint between segments 2 and 3, a relevant changepoint. The cross-segment fits are more than 3 times worse than the best piecewise fit. (C) Assessing the changepoint between segments 4 and 5, a nuisance changepoint due to a linear trend. The cross-segment linear fit is only about 3% worse than the best piecewise fit. (D) Assessing the changepoint between segments 8 and 9, a nuisance changepoint due to seasonality. The cross-segment harmonic fit is only about 9% worse than the best piecewise fit.</p>
        </caption>
        <graphic xlink:href="ooac090f3" position="float"/>
      </fig>
      <p>To illustrate this, <xref rid="ooac090-F3" ref-type="fig">Figure 3B</xref> shows a sudden mean-shift at index 60. Here, the best piecewise fit outperforms the best cross-segment fit by nearly a factor of 3, suggesting that this is a relevant changepoint. In contrast, <xref rid="ooac090-F3" ref-type="fig">Figure 3C</xref> shows a nuisance changepoint that is within a linear trend. In this case, a linear regression across both segments performs only marginally worse than the best piecewise fit to the segments. Similarly, <xref rid="ooac090-F3" ref-type="fig">Figure 3D</xref> shows a changepoint within a seasonal pattern. In that example, the cross-segment harmonic regression performs only marginally worse than the best piecewise fit.</p>
      <p>ASCEPT preforms this process of fitting piecewise and cross-segment models for every changepoint identified in stage 1. For each changepoint, we record the ratio of the RMSE for the best cross-segment fit to the RMSE for the best piecewise fit. The changepoint that corresponds to the smallest ratio is then removed if it falls below a chosen “trimming threshold.” This process repeats for the remaining changepoints until no ratio falls below the threshold, as depicted in <xref rid="ooac090-F1" ref-type="fig">Figure 1B</xref>.</p>
    </sec>
    <sec>
      <title>Segment correction</title>
      <p>ASCEPT’s main purpose is to select changepoints, rather than to correct for them. However, it is important to illustrate the impact of the selection process when adjusting data downstream. Therefore, we performed a basic correction procedure. We used changepoints identified by ASCEPT and CBS to fit constant, linear, and harmonic regressions to the corresponding segments. We declared a linear or harmonic regression to be the best fit to a segment if the ratio of the constant fit's RMSE to the best corresponding linear or harmonic regression's RMSE was greater than a given “fitting threshold.” In these cases, we detrended or deseasonalized those segments. We then shifted and scaled all segments to match the location and scale of a chosen reference segment. The location was defined as the mean of the reference segment before any correction was performed and the scale was defined as the residual standard error for the best-fitting model on that segment.</p>
    </sec>
    <sec>
      <title>Parameters</title>
      <p>For all main text analyses, we ran stage 1 of ASCEPT using a significance level of <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mn>01</mml:mn></mml:math></inline-formula> and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn></mml:math></inline-formula> Monte Carlo simulations. We ran stage 2 using a trimming threshold of 1.2, such that changepoints whose best cross-segment fit had an RMSE within 20% of the best piecewise fit were subject to removal. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> shows results from a sensitivity analysis in which we ran ASCEPT on the simulated data using various trimming threshold values.</p>
      <p>We ran CBS, as implemented in R’s “DNAcopy” package,<xref rid="ooac090-B18" ref-type="bibr"><sup>18</sup></xref> using a significance level of <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mn>01</mml:mn></mml:math></inline-formula> and 10 000 permutations. We set CBS’s pruning threshold to .5; this yielded comparable results to ASCEPT’s 1.2 trimming threshold in terms of the number of changepoints identified per time series.</p>
      <p>For segment correction, we used a fitting threshold of 1.75. We shifted and scaled with respect to the seasonal segment, as captured by either ASCEPT or CBS, as the reference.</p>
    </sec>
    <sec>
      <title>R package</title>
      <p>ASCEPT is implemented in “changepointSelect,” an R package hosted on GitHub at <ext-link xlink:href="https://github.com/matthewquinn1/changepointSelect" ext-link-type="uri">https://github.com/matthewquinn1/changepointSelect</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <sec>
      <title>ASCEPT on the simulated data</title>
      <p>When we first applied ASCEPT to simulated data, we found that stage 1 detected 7 relevant changepoints at indices 49, 60, 225, 400, 600, 699, and 700, as well as many nuisance changepoints that were subsequently trimmed in stage 2 (<xref rid="ooac090-F4" ref-type="fig">Figure 4A</xref>). Comparing with known features of the simulated data (see Materials and Methods section), we observe that of these 7 detected relevant changepoints, 5 directly correspond to mean-shifts in the simulated data (at indices 49, 60, 600, 699, and 700), while the other 2 segment off the linear trend (which extended from indices 201 to 400 in the simulated data) and the seasonal trend (which extended from indices 401 to 600 in the simulated data). Thus, ASCEPT does an excellent job of identifying known changepoints in the simulated data, capturing 6 perfectly (at indices 49, 60, 400, 600, 699, and 700) and closely approximating the seventh (identified at index 225 instead of 200).</p>
      <fig position="float" id="ooac090-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Overall results from applying ASCEPT to (A) the simulated data, as well as mHealth data from the Precisions VISSTA study measuring (B) median deep sleep, (C) median light sleep, and (D) median total sleep.</p>
        </caption>
        <graphic xlink:href="ooac090f4" position="float"/>
      </fig>
      <p>To provide an indication of ASCEPT’s runtime on the simulated data, we note that stage 1 took 14.05 seconds in serial on an 11th Gen Intel Core i7-1165G7 processor with a 2.80GHz clock speed. This decreased to 10.50 seconds when using 4 cores. Stage 2 took 0.85 seconds in serial.</p>
    </sec>
    <sec>
      <title>ASCEPT on the Precision VISSTA mHealth data</title>
      <p>Next, we applied ASCEPT to mHealth data from the Precision VISSTA study. <xref rid="ooac090-F4" ref-type="fig">Figure 4B, C</xref> shows the results for deep and light sleep. We observed similar results for these variables, which was expected because both contribute to total sleep. For deep sleep, ASCEPT identified changepoints on July 19, 2017, September 1, 2017, September 6, 2017, February 14, 2018, and February 15, 2018. For light sleep, ASCEPT identified changepoints on July 19, 2017, August 9, 2017, August 31, 2017, September 6, 2017, February 14, 2018, and February 15, 2018. Based on this analysis, we hypothesize that Fitbit changed how it calculated sleep stage information immediately after these dates, impacting the relationship between deep and light sleep.</p>
      <p>We further assessed these changepoints by cross-referencing with online information and found that some of the identified changepoints corresponded to known firmware updates and glitches. Alta HR received firmware update 26.62.6 between August 1, 2017 and August 10, 2017,<xref rid="ooac090-B19" ref-type="bibr"><sup>19</sup></xref> corresponding to the August 9, 2017 changepoint for light sleep. Likewise, Fitbit modified its calculation of sleep by introducing “Sleep Stages,” starting on March 6, 2017.<xref rid="ooac090-B20" ref-type="bibr"><sup>20</sup></xref> Users reported glitches with Sleep Stages from within a week of the release through July 24, 2017 for Alta HR, Blaze, and Charge 2 devices,<xref rid="ooac090-B21" ref-type="bibr"><sup>21</sup></xref> encompassing the changepoint on July 19, 2017. Users again reported glitches for Blaze devices between September 3, 2017 and September 7, 2017,<xref rid="ooac090-B22" ref-type="bibr"><sup>22</sup></xref> corresponding to the September 6, 2017 changepoint.</p>
      <p>Cross-referencing with online information primarily allows us to investigate changepoints associated with major software/app updates announced by Fitbit, such as the introduction of the REM sleep variable in March 2017, or those that significantly impacted user experience. However, there are several changepoints that ASCEPT identified for which we did not find corresponding online information. In these cases, it is possible that Fitbit implemented minor algorithmic updates that the company felt did not warrant a public announcement and that did not cause any obvious “glitches” to individual users. We believe identifying these changepoints highlights a strength of ASCEPT. Namely, the timing and significance of mHealth algorithmic and/or device updates are not always documented and thus may be unknown to the public. At the same time, identifying and appropriately accounting for these changepoints may be important for downstream analysis.</p>
      <p>Next, we used the daily median total sleep as a negative control (<xref rid="ooac090-F4" ref-type="fig">Figure 4D</xref>). While there were some large fluctuations in median total sleep during 2015, this variance was likely because relatively few individuals (as few as 7; see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>) contributed data on any given day. Accordingly, ASCEPT did not identify any changepoints in this time series after trimming. We do not suspect that Fitbit changed the calculation of total sleep during the study.</p>
    </sec>
    <sec>
      <title>Comparison between ASCEPT and CBS</title>
      <p>ASCEPT shares some principles with CBS<xref rid="ooac090-B7" ref-type="bibr"><sup>7</sup></xref> (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). Therefore, we compared the changepoints identified by CBS to those identified by ASCEPT. For the simulated data (<xref rid="ooac090-F5" ref-type="fig">Figure 5A</xref>), we found that CBS failed to capture the single-point segment at index 700, while ASCEPT successfully did. ASCEPT also successfully segmented off the linear and seasonal trends while CBS split the linear trend into 4 segments.</p>
      <fig position="float" id="ooac090-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Comparison of ASCEPT with CBS when applied to (A) the simulated data, as well as mHealth data from the Precisions VISSTA study measuring (B) median deep sleep and (C) median times woken during the night.</p>
        </caption>
        <graphic xlink:href="ooac090f5" position="float"/>
      </fig>
      <p>We also compared ASCEPT and CBS on mHealth data from the Precision VISSTA study. For most variables, the 2 procedures yielded similar changepoints, although there were some important differences. For example, CBS failed to detect changepoints for the single-day shift in a deep sleep on February 15, 2018, while ASCEPT did (<xref rid="ooac090-F5" ref-type="fig">Figure 5B</xref>). The 2 procedures also greatly differed when applied to the times woken variable (<xref rid="ooac090-F5" ref-type="fig">Figure 5C</xref>). In particular, CBS failed to capture multiple changepoints from late 2017 to early 2018 and did not trim 2 nuisance changepoints that appeared to be within linear or seasonal trends. In contrast, ASCEPT successfully captured the major relevant changepoints and trimmed nuisance changepoints. We provide comparisons of ASCEPT and CBS for the remaining mHealth variables in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3 and S4</xref>. Visual inspection of these results demonstrates that ASCEPT generally outperformed CBS on real-world data. In some cases, ASCEPT identified several apparent changepoints that were missed by CBS (eg, for the light sleep and time awake variables), while in other cases CBS identified changepoints that did not seem well supported (eg, for the total sleep, time awake, and 4 analyzed activity variables).</p>
      <p>While ASCEPT's primary purpose is to select changepoints, we also performed a simple correction to demonstrate the importance of accurately identifying changepoints. In particular, we found the best fit model for each segment (<xref rid="ooac090-F6" ref-type="fig">Figure 6A, B</xref>) and then adjusted the data to match the location and scale of the segment containing the seasonal pattern, which was accurately identified by ASCEPT as indices 401–600 inclusive and identified by CBS as indices 356–600 inclusive. If the changepoints were accurately identified, then we expected the transformed time series to look like normally distributed noise without any mean-shifts. We found this to be true for the ASCEPT segment-corrected time series (<xref rid="ooac090-F6" ref-type="fig">Figure 6C</xref>). In contrast, the CBS segment-corrected time series (<xref rid="ooac090-F6" ref-type="fig">Figure 6D</xref>) still contained trends, seasonality, and other mean-shifts due to the less accurate identification of changepoints. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S5 and S6</xref> show results when using fitting thresholds other than 1.75.</p>
      <fig position="float" id="ooac090-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Illustration of applying a simple correction process to simulated data after identifying changepoints using either ASCEPT or CBS. (A) The best model fits using ASCEPT changepoints. (B) The best model fits using CBS changepoints. (C) The corrected series using ASCEPT changepoints. (D) The corrected series using CBS changepoints.</p>
        </caption>
        <graphic xlink:href="ooac090f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>DISCUSSION AND CONCLUSIONS</title>
    <p>We have presented an approach, ASCEPT, for identifying changepoints in mHealth data. ASCEPT builds upon the current state-of-the-art method, PELT, by incorporating the principles of statistical significance and trimming. ASCEPT adopts progressively larger sets of changepoints until the newly proposed set does not provide a statistically significant improvement in goodness of fit. ASCEPT then trims changepoints within linear and seasonal trends. In mHealth data, these trends are often attributable to human behavior or health, rather than technological issues. As a result, an investigator handling data downstream should be interested in studying these trends as a whole, rather than arbitrarily splitting them up and correcting them in the same manner as for technological changepoints. The final result from ASCEPT is a set of estimated changepoints that can be used to adjust mHealth data prior to additional downstream analyses, for example, estimating statistical associations between mHealth variables and other independently collected data, such as medical information (eg, disease diagnoses and treatment), phenotypic variables (eg, weight and blood pressure), or omics measurements.</p>
    <p>ASCEPT offers many advantages over comparable methods. For example, using PELT to detect multiple changepoints requires specifying an optimization penalty while ASCEPT allows an investigator to specify a significance level, a more intuitive statistical parameter. Additionally, ASCEPT is specifically designed for mHealth data, which is not true of comparable methods like CBS. For instance, CBS uses a permutation test to obtain <italic toggle="yes">P</italic>-values for changepoints,<xref rid="ooac090-B7" ref-type="bibr"><sup>7</sup></xref> but this approach has difficulty capturing segments containing only one observation, a feature we observed in the mHealth data from the Precision VISSTA study (<xref rid="ooac090-F1" ref-type="fig">Figure 1A</xref>). In contrast, ASCEPT's Monte Carlo procedure can capture single-point segments (<xref rid="ooac090-F4" ref-type="fig">Figure 4B</xref>). Additionally, CBS trims changepoints using a sum of squared within-segment deviations measure,<xref rid="ooac090-B7" ref-type="bibr"><sup>7</sup></xref> while ASCEPT directly models the linear and seasonal trends in mHealth data, thereby helping to differentiate between common behaviorally driven patterns and other patterns that may be a result of technological changes, such as software or hardware updates to a wearable device.</p>
    <p>Importantly, ASCEPT allows an investigator to identify potential technological changepoints automatically. For example, while Fitbit lists previous firmware versions online, it does not readily provide release dates or specific notes regarding each one.<xref rid="ooac090-B23" ref-type="bibr"><sup>23</sup></xref> Instead, a researcher needs to manually read through online community forums for details.<xref rid="ooac090-B24" ref-type="bibr"><sup>24</sup></xref> In our investigation of these online notes, we found that update rollouts and glitches often occurred over days or weeks, making it difficult to precisely determine when the data reflect these changes. Furthermore, some changes may not even be publicized, rendering a manual search useless. In contrast, ASCEPT provides an effective way to precisely identify when technologically driven changes occurred.</p>
    <p>We note, however, that ASCEPT has some potential limitations. First, since it involves a Monte Carlo method, ASCEPT does not guarantee the same results over repeated runs; however, using a large number of simulations mitigates this issue. This first stage of ASCEPT also approximates <italic toggle="yes">P</italic>-values in a manner that may yield false positives because we do not rerun PELT on each simulated series when obtaining <italic toggle="yes">P</italic>-values. However, in most cases, these false positives should be removed by ASCEPT’s trimming procedure. Some time series may also be difficult for ASCEPT to analyze. For example, ASCEPT may have difficulty precisely demarcating segments within a time series that includes multiple linear trends with varying slopes. However, we found that ASCEPT generally performed well even for several challenging scenarios in the simulated and real mHealth data. ASCEPT is also computationally intensive, but we parallelized its implementation for improved performance. In addition, ASCEPT assumes that the observations are normally distributed, which may not always be true. However, normality is appropriate to use in many scenarios, such as when using the sample mean or median of a variable,<xref rid="ooac090-B25" ref-type="bibr"><sup>25</sup></xref> as we did in our application of ASCEPT to mHealth data from the Precision VISSTA study. Lastly, ASCEPT requires the selection of 2 thresholds: a significance level and a trimming threshold. While these parameters are intuitive, we recommend that investigators use a sensitivity analysis to select a trimming threshold that is appropriate for their data. In our analyses, we found that the changepoints identified by ASCEPT were robust across a wide range of trimming threshold values.</p>
    <p>While there are limitations, ASCEPT also has many strengths. For instance, while we developed ASCEPT for mHealth data and tested it on data from the Precision VISSTA study, the approach is generalizable. For example, a researcher could apply ASCEPT to select mean-shift changepoints in any univariate time series for which linear trends and seasonality induce nuisance changepoints. Additionally, instead of only applying ASCEPT to population-level data to identify technological changepoints, an investigator could apply ASCEPT to an individual’s time series data to identify behavioral shifts that are not associated with broader seasonal or linear patterns. One could also modify ASCEPT to identify and remove nuisance changepoints within other trends, such as quadratic trends, which may be more common in other types of data.<xref rid="ooac090-B26" ref-type="bibr"><sup>26</sup></xref> ASCEPT could also be adjusted to handle changepoints associated with changes in variance, rather than only mean-shift changepoints, and its normality assumption could be adjusted to allow for other distributional assumptions. For example, one may want to consider a Poisson distribution for count-related mHealth variables (eg, steps) or consider lognormal, chi-squared, and gamma distributions for positive and skewed variables (eg, time active). Accounting for these in ASCEPT would entail changing the distribution used when calculating the likelihood of segments. However, since PELT assumes normality, one would also need to adjust PELT’s code. While the current presentation of ASCEPT uses PELT, a researcher could, in theory, also apply the same processes to other changepoint detection algorithms.</p>
    <p>We designed ASCEPT as a formal process to select relevant changepoints among those proposed by PELT by using statistical tests and modeling trends that are commonly associated with nuisance changepoints. Identifying these types of changepoints is a critical step for effectively analyzing mHealth data, which often contains changepoints both from sudden changes in the propriety algorithms used to record measurements and from changes in human behavior. ASCEPT automates this process and only requires selecting 2 intuitive parameters. This affords a distinct advantage over using other methods or performing a manual identification of technological changepoints, which supports ASCEPT’s broad applicability to mHealth data analysis.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>National Institute of Biomedical Imaging and Bioengineering and the Office of the Director of the National Institutes of Health under award number R01EB025024 (to AC, KG, and MQ); and the National Heart, Lung, and Blood Institute under award number T32HL007427-39.</p>
  </sec>
  <sec>
    <title>AUTHOR CONTRIBUTIONS</title>
    <p>AC and KG conceptualized the project. MQ and KG developed the method. MQ wrote the software and performed the formal analysis and investigation. KG and AC curated the data and resources for the project. MQ wrote the original draft. All authors reviewed and edited the manuscript. KG supervised the project. AC and KG acquired the funding.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY MATERIAL</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref> is available at <italic toggle="yes">JAMIA Open</italic> online.</p>
  </sec>
  <sec>
    <title>CONFLICT OF INTEREST STATEMENT</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>ooac090_Supplementary_Data</label>
      <media xlink:href="ooac090_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>ASCEPT’s code and the simulated data are available online at <ext-link xlink:href="https://github.com/matthewquinn1/changepointSelect" ext-link-type="uri">https://github.com/matthewquinn1/changepointSelect</ext-link>. Those interested in the availability of the Precision VISSTA data should contact AC.</p>
  </sec>
  <ref-list id="ref1">
    <title>REFERENCES</title>
    <ref id="ooac090-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Nilsen</surname><given-names>WJ</given-names></string-name>, <string-name><surname>Abernethy</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><article-title>Mobile health technology evaluation: the mHealth evidence workshop</article-title>. <source>Am J Prev Med</source><year>2013</year>; <volume>45</volume> (<issue>2</issue>): <fpage>228</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">23867031</pub-id></mixed-citation>
    </ref>
    <ref id="ooac090-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silva</surname><given-names>BMC</given-names></string-name>, <string-name><surname>Rodrigues</surname><given-names>JJPC</given-names></string-name>, <string-name><surname>de la Torre Díez</surname><given-names>I</given-names></string-name></person-group>, <etal>et al</etal><article-title>Mobile-health: a review of current state in 2015</article-title>. <source>J Biomed Inform</source><year>2015</year>; <volume>56</volume>: <fpage>265</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">26071682</pub-id></mixed-citation>
    </ref>
    <ref id="ooac090-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelli</surname><given-names>HM</given-names></string-name>, <string-name><surname>Witbrodt</surname><given-names>B</given-names></string-name>, <string-name><surname>Shah</surname><given-names>A.</given-names></string-name></person-group><article-title>The future of mobile health applications and devices in cardiovascular health</article-title>. <source>Eur Med J Innov</source><year>2017</year>; 1 (1): <fpage>92</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Truong</surname><given-names>C</given-names></string-name>, <string-name><surname>Oudre</surname><given-names>L</given-names></string-name>, <string-name><surname>Vayatis</surname><given-names>N.</given-names></string-name></person-group><article-title>Selective review of offline change point detection methods</article-title>. <source>Signal Process</source><year>2020</year>; <volume>167</volume>: <fpage>107299</fpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Killick</surname><given-names>R</given-names></string-name>, <string-name><surname>Fearnhead</surname><given-names>P</given-names></string-name>, <string-name><surname>Eckley</surname><given-names>I.</given-names></string-name></person-group><article-title>Optimal detection of changepoints with a linear computational cost</article-title>. <source>J Am Stat Assoc</source><year>2012</year>; <volume>107</volume> (<issue>500</issue>): <fpage>1590</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haynes</surname><given-names>K</given-names></string-name>, <string-name><surname>Eckley</surname><given-names>IA</given-names></string-name>, <string-name><surname>Fearnhead</surname><given-names>P.</given-names></string-name></person-group><article-title>Computationally efficient changepoint detection for a range of penalties</article-title>. <source>J Comput Graph Stat</source><year>2017</year>; <volume>26</volume> (<issue>1</issue>): <fpage>134</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olshen</surname><given-names>A</given-names></string-name>, <string-name><surname>Venkatraman</surname><given-names>ES</given-names></string-name>, <string-name><surname>Lucito</surname><given-names>R</given-names></string-name></person-group>, <etal>et al</etal><article-title>Circular binary segmentation for the analysis of array‐based DNA copy number data</article-title>. <source>Biostatistics</source><year>2004</year>; <volume>5</volume> (<issue>4</issue>): <fpage>557</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">15475419</pub-id></mixed-citation>
    </ref>
    <ref id="ooac090-B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fearnhead</surname><given-names>P</given-names></string-name>, <string-name><surname>Maidstone</surname><given-names>R</given-names></string-name>, <string-name><surname>Letchford</surname><given-names>A.</given-names></string-name></person-group><article-title>Detecting changes in slope with an L0 penalty</article-title>. <source>J Comput Graph Stat</source><year>2019</year>; <volume>28</volume> (<issue>2</issue>): <fpage>265</fpage>–<lpage>75</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robbins</surname><given-names>MW</given-names></string-name>, <string-name><surname>Gallagher</surname><given-names>CM</given-names></string-name>, <string-name><surname>Lund</surname><given-names>RB.</given-names></string-name></person-group><article-title>A general regression changepoint test for time series data</article-title>. <source>J Am Stat Assoc</source><year>2016</year>; <volume>111</volume> (<issue>514</issue>): <fpage>670</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baranowski</surname><given-names>R</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fryzlewicz</surname><given-names>P.</given-names></string-name></person-group><article-title>Narrowest-over-threshold detection of multiple change points and change-point-like features</article-title>. <source>J R Stat Soc B</source><year>2019</year>; <volume>81</volume> (<issue>3</issue>): <fpage>649</fpage>–<lpage>72</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fisch</surname><given-names>ATM</given-names></string-name>, <string-name><surname>Eckley</surname><given-names>IA</given-names></string-name>, <string-name><surname>Fearnhead</surname><given-names>P.</given-names></string-name></person-group><article-title>A linear time method for the detection of collective and point anomalies</article-title>. <source>Stat Anal</source><year>2022</year>; <volume>15</volume> (<issue>4</issue>): <fpage>494</fpage>–<lpage>508</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Juodakis</surname><given-names>J</given-names></string-name>, <string-name><surname>Marsland</surname><given-names>S.</given-names></string-name></person-group><article-title>Epidemic changepoint detection in the presence of nuisance changes</article-title>. <source>Stat Pap</source><year>2022</year>; 63. doi:<pub-id pub-id-type="doi">10.1007/s00362-022-01307-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="ooac090-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Shang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Du</surname><given-names>P</given-names></string-name></person-group>, <etal>et al</etal><article-title>Variance change point detection under a smoothly-changing mean trend with application to liver procurement</article-title>. <source>J Am Stat Assoc</source><year>2019</year>; <volume>114</volume> (<issue>526</issue>): <fpage>773</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romano</surname><given-names>G</given-names></string-name>, <string-name><surname>Rigaill</surname><given-names>G</given-names></string-name>, <string-name><surname>Runge</surname><given-names>V</given-names></string-name></person-group>, <etal>et al</etal><article-title>Detecting abrupt changes in the presence of local fluctuations and autocorrelated noise</article-title>. <source>J Am Stat Assoc</source><year>2021</year>; 116: <fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">35757777</pub-id></mixed-citation>
    </ref>
    <ref id="ooac090-B15">
      <label>15</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chung</surname><given-names>A</given-names></string-name>, <string-name><surname>Gotz</surname><given-names>D</given-names></string-name>, <string-name><surname>Kappelman</surname><given-names>M</given-names></string-name></person-group>, <etal>et al</etal> Precision VISSTA: enabling precision medicine through the development of quantitative and visualization methods. <ext-link xlink:href="http://precisionvissta.web.unc.edu/" ext-link-type="uri">http://precisionvissta.web.unc.edu/</ext-link>. Accessed March 14, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Killick</surname><given-names>R</given-names></string-name>, <string-name><surname>Eckley</surname><given-names>IA.</given-names></string-name></person-group><article-title>changepoint: an R package for changepoint analysis</article-title>. <source>J Stat Softw</source><year>2014</year>; <volume>58</volume>: <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lynch</surname><given-names>G</given-names></string-name>, <string-name><surname>Guo</surname><given-names>W</given-names></string-name>, <string-name><surname>Sarkar</surname><given-names>SK</given-names></string-name></person-group>, <etal>et al</etal><article-title>The control of the false discovery rate in fixed sequence multiple testing</article-title>. <source>Electron J Stat</source><year>2017</year>; <volume>11</volume>: <fpage>4649</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B18">
      <label>18</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Seshan</surname><given-names>VE</given-names></string-name>, <string-name><surname>Olshen</surname><given-names>A.</given-names></string-name></person-group><italic toggle="yes">DNAcopy: DNA Copy Number Data Analysis</italic>. R package version 1.60.0; <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="ooac090-B19">
      <label>19</label>
      <mixed-citation publication-type="other"><collab>Alta HR Firmware Release - 26.62.6</collab>. <year>2017</year>. <ext-link xlink:href="https://community.fitbit.com/t5/Alta-HR/Alta-HR-Firmware-Release-26-62-6/td-p/2119538" ext-link-type="uri">https://community.fitbit.com/t5/Alta-HR/Alta-HR-Firmware-Release-26-62-6/td-p/2119538</ext-link>. Accessed June 6, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B20">
      <label>20</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kosecki</surname><given-names>D.</given-names></string-name></person-group> New Fitbit features deliver data previously only available through a sleep lab. <year>2017</year>. <ext-link xlink:href="https://blog.fitbit.com/sleep-stages-and-sleep-insights-announcement/" ext-link-type="uri">https://blog.fitbit.com/sleep-stages-and-sleep-insights-announcement/</ext-link>. Accessed June 11, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B21">
      <label>21</label>
      <mixed-citation publication-type="other"><collab>Charge 2 Sleep Stages</collab>. <year>2017</year>. <ext-link xlink:href="https://community.fitbit.com/t5/Charge-2/Charge-2-Sleep-Stages/td-p/1907433" ext-link-type="uri">https://community.fitbit.com/t5/Charge-2/Charge-2-Sleep-Stages/td-p/1907433</ext-link>. Accessed June 11, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B22">
      <label>22</label>
      <mixed-citation publication-type="other">Received Classic Sleep rather than Sleep Stages. <year>2017</year>. <ext-link xlink:href="https://community.fitbit.com/t5/Blaze/RESOLVED-9-3-Received-Classic-Sleep-rather-than-Sleep-Stages/td-p/2174227" ext-link-type="uri">https://community.fitbit.com/t5/Blaze/RESOLVED-9-3-Received-Classic-Sleep-rather-than-Sleep-Stages/td-p/2174227</ext-link>. Accessed June 11, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B23">
      <label>23</label>
      <mixed-citation publication-type="other">What’s changed in the latest Fitbit device update? <ext-link xlink:href="https://help.fitbit.com/articles/en_US/Help_article/1372" ext-link-type="uri">https://help.fitbit.com/articles/en_US/Help_article/1372</ext-link>. Accessed June 6, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B24">
      <label>24</label>
      <mixed-citation publication-type="other"><collab>Community</collab>. <ext-link xlink:href="https://community.fitbit.com/" ext-link-type="uri">https://community.fitbit.com/</ext-link>. Accessed June 11, 2020.</mixed-citation>
    </ref>
    <ref id="ooac090-B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rider</surname><given-names>PR.</given-names></string-name></person-group><article-title>Variance of the median of small samples from several special populations</article-title>. <source>J Am Stat Assoc</source><year>1960</year>; <volume>55</volume> (<issue>289</issue>): <fpage>148</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="ooac090-B26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harvey</surname><given-names>DI</given-names></string-name>, <string-name><surname>Leybourne</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>AMR.</given-names></string-name></person-group><article-title>Testing for unit roots and the impact of quadratic trends, with an application to relative primary commodity prices</article-title>. <source>Econ Rev</source><year>2011</year>; <volume>30 (5)</volume>: <fpage>514</fpage>–<lpage>47</lpage>. doi:<pub-id pub-id-type="doi">10.1080/07474938.2011.553561</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
