<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10538487</article-id>
    <article-id pub-id-type="pmid">37414576</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.277675.123</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Leveraging protein language models for accurate multiple sequence alignments</article-title>
      <alt-title alt-title-type="left-running">McWhite et al.</alt-title>
      <alt-title alt-title-type="right-running">Leveraging protein language for alignment</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7346-3047</contrib-id>
        <name>
          <surname>McWhite</surname>
          <given-names>Claire D.</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6332-3750</contrib-id>
        <name>
          <surname>Armour-Garb</surname>
          <given-names>Isabel</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8271-6026</contrib-id>
        <name>
          <surname>Singh</surname>
          <given-names>Mona</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey 08544, USA;</aff>
    <aff id="af2"><label>2</label>Department of Computer Science, Princeton University, Princeton, New Jersey 08544, USA</aff>
    <author-notes>
      <corresp>Corresponding authors: <email>cmcwhite@princeton.edu</email>, <email>mona@cs.princeton.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <volume>33</volume>
    <issue>7</issue>
    <fpage>1145</fpage>
    <lpage>1153</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml" ext-link-type="uri">© 2023 McWhite et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This article, published in <italic>Genome Research</italic>, is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1145.pdf"/>
    <abstract>
      <p>Multiple sequence alignment (MSA) is a critical step in the study of protein sequence and function. Typically, MSA algorithms progressively align pairs of sequences and combine these alignments with the aid of a guide tree. These alignment algorithms use scoring systems based on substitution matrices to measure amino acid similarities. Although successful, standard methods struggle on sets of proteins with low sequence identity: the so-called twilight zone of protein alignment. For these difficult cases, another source of information is needed. Protein language models are a powerful new approach that leverages massive sequence data sets to produce high-dimensional contextual embeddings for each amino acid in a sequence. These embeddings have been shown to reflect physicochemical and higher-order structural and functional attributes of amino acids within proteins. Here, we present a novel approach to MSA, based on clustering and ordering amino acid contextual embeddings. Our method for aligning semantically consistent groups of proteins circumvents the need for many standard components of MSA algorithms, avoiding initial guide tree construction, intermediate pairwise alignments, gap penalties, and substitution matrices. The added information from contextual embeddings leads to higher accuracy alignments for structurally similar proteins with low amino-acid similarity. We anticipate that protein language models will become a fundamental component of the next generation of algorithms for generating MSAs.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health </institution>
            <institution-id institution-id-type="doi">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM076275</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignments (MSAs) underlie much of sequence analysis in computational biology. Protein MSAs are the main input to algorithms for reconstructing gene and species trees (<xref rid="GR277675MCWC14" ref-type="bibr">Felsenstein 2004</xref>); for identifying conserved (<xref rid="GR277675MCWC4" ref-type="bibr">Capra and Singh 2007</xref>), co-evolving (<xref rid="GR277675MCWC28" ref-type="bibr">Marks et al. 2011</xref>), specificity-determining (<xref rid="GR277675MCWC5" ref-type="bibr">Capra and Singh 2008</xref>), and positively selected sites (<xref rid="GR277675MCWC31" ref-type="bibr">Miyata and Yasunaga 1980</xref>); for building protein motif and domain representations (<xref rid="GR277675MCWC48" ref-type="bibr">Sonnhammer et al. 1998</xref>); and for predicting de novo protein structural features (<xref rid="GR277675MCWC44" ref-type="bibr">Rost and Sander 1994</xref>) and full protein structure prediction (<xref rid="GR277675MCWC21" ref-type="bibr">Jumper et al. 2021</xref>). Highly accurate MSAs are necessary, as misaligned amino acids can lead to incorrect inferences for this wide range of downstream tasks. However, when the average sequence identity among the sequences to be aligned is low, most MSA methods struggle to obtain high-quality alignments (<xref rid="GR277675MCWC38" ref-type="bibr">Nute et al. 2019</xref>); sequence identity below 20%–35% has been termed the “twilight zone” of alignment (<xref rid="GR277675MCWC43" ref-type="bibr">Rost 1999</xref>).</p>
  <p>Over the past 40 years, numerous algorithms for obtaining MSAs have been developed and refined, including CLUSTAL (<xref rid="GR277675MCWC46" ref-type="bibr">Sievers et al. 2011</xref>), MAFFT (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), Muscle (<xref rid="GR277675MCWC12" ref-type="bibr">Edgar 2004</xref>), T-Coffee (<xref rid="GR277675MCWC37" ref-type="bibr">Notredame et al. 2000</xref>), ProbCons (<xref rid="GR277675MCWC10" ref-type="bibr">Do et al. 2005</xref>), Saté (<xref rid="GR277675MCWC26" ref-type="bibr">Liu et al. 2012</xref>), and PASTA (<xref rid="GR277675MCWC30" ref-type="bibr">Mirarab et al. 2015</xref>), among others. The predominant approach to align multiple sequences is to first align pairs of sequences and then progressively combine these subalignments into larger alignments in an order determined by a guide tree (<xref rid="GR277675MCWC15" ref-type="bibr">Feng and Doolittle 1987</xref>). Pairwise alignment algorithms (<xref rid="GR277675MCWC34" ref-type="bibr">Needleman and Wunsch 1970</xref>; <xref rid="GR277675MCWC47" ref-type="bibr">Smith and Waterman 1981</xref>) uncover a highest scoring alignment between two sequences when given a similarity measure between all pairs of amino acids and a gap penalty function. Similarities between each pair of the 20 amino acids are typically based upon substitution matrices that encapsulate the frequency with which amino acid pairs are observed in equivalent positions across large data sets of alignments of homologous sequences (<xref rid="GR277675MCWC8" ref-type="bibr">Dayhoff et al. 1978</xref>; <xref rid="GR277675MCWC1" ref-type="bibr">Altschul 1991</xref>; <xref rid="GR277675MCWC18" ref-type="bibr">Henikoff and Henikoff 1992</xref>). Although in theory optimal pairwise alignment algorithms can be adapted to multiple sequences, the runtime would be exponential in the number of sequences, and further, it is not clear how to score multiple amino acids in a single aligned column. Instead, guide tree–based MSA approaches are heuristics that optimally combine pairs of alignments in which the similarity of a pair of columns in two different alignments is computed based on substitution matrix scores of the amino acids within the columns. Alternatively, consistency-based progressive MSA approaches use similarity scores that consider how frequently pairs of amino acids in two different sequences are aligned to the same amino acid position in other sequences when considering optimal pairwise alignments (<xref rid="GR277675MCWC36" ref-type="bibr">Notredame et al. 1998</xref>, <xref rid="GR277675MCWC37" ref-type="bibr">2000</xref>).</p>
  <p>Here, we consider a new approach to determining the similarities between amino acids across proteins, based on protein language models (<xref rid="GR277675MCWC41" ref-type="bibr">Rao et al. 2019</xref>; <xref rid="GR277675MCWC3" ref-type="bibr">Bepler and Berger 2021</xref>; <xref rid="GR277675MCWC42" ref-type="bibr">Rives et al. 2021</xref>; <xref rid="GR277675MCWC6" ref-type="bibr">Chowdhury et al. 2022</xref>; <xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). Protein language models are “self-supervised” deep learning language models that have been pretrained on large compendia of protein sequences, generally trained to predict “masked” amino acids within input protein sequences based on the rest of the sequence. Once trained, these models embed each amino acid within a protein sequence as a high-dimensional vector, and importantly, these vectors capture the sequence “context” of each amino acid. Machine learning models using these embeddings have been successfully trained to predict many protein structural and functional features, including conservation (<xref rid="GR277675MCWC29" ref-type="bibr">Marquet et al. 2022</xref>), ligand binding (<xref rid="GR277675MCWC25" ref-type="bibr">Littmann et al. 2021</xref>), homology (<xref rid="GR277675MCWC42" ref-type="bibr">Rives et al. 2021</xref>; <xref rid="GR277675MCWC17" ref-type="bibr">Heinzinger et al. 2022</xref>), and subcellular localization (<xref rid="GR277675MCWC49" ref-type="bibr">Stärk et al. 2021</xref>). Because amino acids at equivalent positions in two different protein sequences play the same structural and functional role, we reasoned that clustering amino acid context vectors across sequences could be the basis of a new approach for aligning sequences. Although recently neural network machinery has been leveraged to perform dynamic program-based alignments (<xref rid="GR277675MCWC33" ref-type="bibr">Morton et al. 2020</xref>; <xref rid="GR277675MCWC39" ref-type="bibr">Petti et al. 2023</xref>), our approach is, to the best of our knowledge, the first that uses protein sequence embeddings to identify analogous positions across protein sequences in order to determine MSAs. Our MSA approach is based on clustering the amino acid contextual vectors produced by protein language models and then using graph-theoretic approaches to determine a consistent ordering of MSA columns. Our method, <underline>v</underline>ector-<underline>c</underline>lustering <underline>M</underline>ultiple <underline>S</underline>equence <underline>A</underline>lignment (vcMSA), is a true multiple sequence aligner that aligns multiple sequences at once instead of progressively integrating pairwise alignments. Our core methodology diverges from standard MSA methods in that it avoids substitution matrices and gap penalties, and in most cases, does not use guide tree construction. In proof-of-concept testing, we aim to establish the power of leveraging protein language models for building MSAs, particularly for low identity sequence families that current methods have the most difficulty on.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <sec id="s1a">
      <title>Overview</title>
      <p>A brief overview of our algorithm is as follows. First, for all protein sequences, we obtain per-position and sequence-level embeddings via a protein language model (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>A). Second, we cluster protein sequences via the sequence-level embeddings to uncover sets of sequence-similar proteins (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>B). Third, within each cluster of sequences, we measure the similarities of amino acid vectors and, for each amino acid, find the one that is most similar to it in each of the other sequences (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>C) and filter to amino acid pairings that are reciprocal best hits (RBHs) of each other. Fourth, we build an RBH network and cluster the network to find “guidepost” amino acid positions in different sequences that are clearly aligned to each other (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>D). Fifth, we order the clusters into columns of the MSA by constructing a directed acyclic graph (DAG) based on sequential positions within each protein sequence and performing a topological sort (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>E). Sixth, we use guidepost clusters to limit the scope of searches for the remaining unplaced amino acids (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). Seventh, we continue creating guideposts and assigning amino acids to columns until all amino acids are placed in the alignment (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>G). Finally, we combine subalignments from the sequence clusters into the final MSA (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>H). Further details about each of these steps are provided below.</p>
      <fig position="float" id="GR277675MCWF1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of vcMSA algorithm. (<italic>A</italic>) Proteins are embedded using a protein language model to produce vector representations of each amino acid, and the mean of these amino acid embeddings is taken to produce a sequence-level representation. (<italic>B</italic>) We cluster sequence representations and detect outlier sequences. (<italic>C</italic>) For each sequence cluster, we determine bidirectional/reciprocal best hits (RBHs) of cosine similarity between pairs of amino acids in different sequences. (<italic>D</italic>) From a network built from RBHs, we determine confident clusters of amino acids, corresponding to columns in the MSA. (<italic>E</italic>) To determine column order, we trace the path of each sequence through clusters and combine all paths into one network, taking edge weights from the number of sequences that traverse between the pairs of clusters. We trim any clusters that cause cycles and use a topological sort of the resulting directed acyclic graph to find column order. (<italic>F</italic>) Clusters/columns limit scope of search for unplaced amino acids. (<italic>G</italic>) We iterate limited searches until all amino acids are placed. Gaps in the alignment occur when a cluster does not contain an amino acid from a sequence. (<italic>H</italic>) We combine alignments from each sequence cluster and outliers in the final output MSA.</p>
        </caption>
        <graphic xlink:href="1145f01" position="float"/>
      </fig>
    </sec>
    <sec id="s1b">
      <title>Embedding generation</title>
      <p>For each protein sequence, we use the encoder portion of the ProtT5-XL-UniRef50 language model to generate sequence embeddings (<xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). T5 models undergo self-supervised training on a large corpus of text, in this case over 11 million protein sequences in the UniRef50 data set (<xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). For each amino acid in a sequence, the ProtT5-XL-UniRef50 model produces one embedding vector of length 1024 for each of its 24 encoder layers. We choose to use embeddings from the final 16 layers, giving us a final vector representation of each amino acid with dimension 16,384. For each sequence, we average all of the vector embeddings for each of its amino acids to obtain a sequence-level embedding. We additionally add padding to sequences, where we first add 10 X's to the start and end of each sequence before embedding (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1A</xref>).</p>
    </sec>
    <sec id="s1c">
      <title>Sequence clustering</title>
      <p>We find that vcMSA performs best on semantically consistent sets of sequences and that performance is degraded when outlier sequences are included. Therefore, we first cluster input sequences based on sequence-level embeddings to obtain groups of similar sequences and detect outliers (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). We then apply the remaining steps of vcMSA to each cluster of sequences individually. Left out sequences and alignments for clusters are merged into a full alignment as described below.</p>
    </sec>
    <sec id="s1d">
      <title>Amino acid similarity across sequences</title>
      <p>The contextual similarity between a pair of amino acids is defined as the cosine similarity between their embedding vectors. To reduce sequence-specific effects and increase the overall similarity between different sequences, we first apply “batch correction” to amino acid embeddings in the same sequence cluster, considering each sequence as analogous to a batch (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1C</xref>; <xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). For each amino acid in each sequence, we next find the most similar amino acid in each of the other sequences by considering cosine similarities between their embeddings. We use Facebook's fast AI similarity search (faiss) library to perform nearest neighbor searches for all amino acids (<xref rid="GR277675MCWC20" ref-type="bibr">Johnson et al. 2021</xref>). For each pair of sequences, the set of pairwise similarities between amino acids between different sequences is filtered to only RBHs, for which the best match to a query amino acid in the target sequence must also have its highest score in the query sequence be the query amino acid (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>C). For each pair of sequences, we construct a bipartite graph composed of nodes for each amino acid in the two sequences, with an edge for each RBH identified between amino acids in the two sequences. We will keep a largest set of these RBHs that are “consistent” with each other in a pairwise alignment using a maximum noncrossing matching (MNCM) formulation (<xref rid="GR277675MCWC27" ref-type="bibr">Malucelli et al. 1993</xref>). In particular, if the <italic>i</italic>th and <italic>j</italic>th amino acids in the first sequence (we assume without loss of generality that <italic>i</italic> &lt; <italic>j)</italic> have as their RBHs the <italic>k</italic>th and <italic>l</italic>th amino acids, respectively, in the second sequence, then this pair of RBHs is consistent only if <italic>k</italic> &lt; <italic>l</italic>; that is, if <italic>k</italic> &lt; <italic>l</italic>, it is possible for a pairwise alignment between these two sequences to simultaneously align the <italic>i</italic>th and <italic>j</italic>th amino acids in the first sequence with the <italic>k</italic>th and <italic>l</italic>th amino acids in the second sequence. If two pairs of RBHs are not consistent with each other, we say that the edges that correspond to them “intersect,” as they would if the nodes were arranged in two columns (one for each sequence) in the order in which they appear in the sequences. We define a noncrossing matching to be a selection of edges such that no two edges intersect, and an MNCM to be the largest possible set of such edges. In the case that there are multiple MNCMs, we select the MNCM that has the highest average cosine similarity score between all RBHs in the matching. We remove from consideration any RBHs that are not part of this MNCM; in this manner, we obtain a filtered set of RBHs across all pairs of sequences. MNCM performs well in preserving RBHs corresponding to correctly aligned amino acid pairs, while removing false-positive matches (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 2</xref>).</p>
    </sec>
    <sec id="s1e">
      <title>Amino acid clustering</title>
      <p>We build a network in which there is a node for each amino acid in each sequence, and there is an edge between two nodes if the corresponding amino acids are RBHs included in the filtered set of RBHs. We use this network of RBHs in order to cluster sets of amino acids that align to each other with high confidence (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>D; <xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Amino acids within a cluster will comprise a column in the MSA. We term these aligned positions guideposts and will use these guidepost columns to limit the scope of future searches for amino acids that align to each other (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). Our guidepost columns are similar to user-defined or automatically inferred “anchor points” that have been used in the past to constrain traditional MSA approaches (<xref rid="GR277675MCWC32" ref-type="bibr">Morgenstern et al. 2006</xref>; <xref rid="GR277675MCWC40" ref-type="bibr">Pitschi et al. 2010</xref>).</p>
    </sec>
    <sec id="s1f">
      <title>Column order determination</title>
      <p>Each cluster corresponds to a column of the MSA; however, these columns must be placed in the correct order in the alignment that is being built. To do this, we will first build a graph based on the correct ordering of amino acids in each protein sequence and then prune this graph to be a DAG and perform a topological sort of this graph (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>E). In particular, we will introduce a node for each cluster. Next, for clusters <italic>A</italic> and <italic>B</italic>, if there exists amino acids <italic>u</italic> ∈ <italic>A</italic> and <italic>v</italic> ∈ <italic>B</italic> where <italic>u</italic> and <italic>v</italic> are in the same sequence, <italic>u</italic> is before <italic>v</italic> in the sequence, and <italic>v</italic> is the first clustered amino acid after <italic>u</italic> in the sequence, then we will add a directed edge from <italic>u</italic> to <italic>v</italic>. This edge will be weighted by the number of sequences in which such <italic>u</italic> and <italic>v</italic> exist. Out-of-order amino acids, in which an amino acid is placed in a cluster that occurs too late or too early in the MSA, will cause cycles in this directed graph. To remove these out-of-order amino acids, we detect feedback arc sets (<xref rid="GR277675MCWC11" ref-type="bibr">Eades et al. 1993</xref>; <xref rid="GR277675MCWC7" ref-type="bibr">Csardi and Nepusz 2006</xref>), finding edges to remove to obtain an acyclic graph and prioritizing edges with low weight for removal. Because feedback arc set detection is NP-complete, we use the linear time heuristic approach of <xref rid="GR277675MCWC11" ref-type="bibr">Eades et al. (1993)</xref>. Feedback arc set detection has been previously used in MSA to enforce order consistency for multiple local areas of alignment (<xref rid="GR277675MCWC40" ref-type="bibr">Pitschi et al. 2010</xref>).</p>
      <p>For each node-pair of each feedback arc, we discard the node/cluster ID with lowest total edge weight and finally confirm that the trimmed network is a DAG. We then perform a topological sort of the graph to obtain an ordered path that visits every node (cluster ID). This sequence of cluster IDs is the order of columns in the MSA.</p>
    </sec>
    <sec id="s1g">
      <title>Limited scope searches</title>
      <p>At this stage, we have a subset of guidepost columns in the alignment, as well as sets of amino acids that have not been assigned to any column (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). If an unassigned amino acid occurs after an amino acid that has been assigned to column <italic>p</italic> and before an amino acid that has been assigned to column <italic>q</italic>, we only need to consider amino acids from other sequences that also fall between <italic>p</italic> and <italic>q</italic> as candidate matches.</p>
      <p>We repeatedly alternate two phases of adding amino acids into the alignment until there are no remaining unplaced amino acids with cosine similarity &gt; 0.1 to any potential match amino acid in the scope. Our two phases are (1) create new columns by amino acid clustering, as described above, among all amino acids also falling between the appropriate guideposts and (2) add amino acids into existing columns by best match score (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Existing columns can only be modified during the second phase with the addition of new members. In early iterations following clustering stages, we remove clusters in which any member of the cluster is “stranded,” meaning that neither of its previous or next amino acids is found in the previous and next aligned column/cluster. This quality-control step prevents early errors in which an amino acid is placed in the wrong cluster. For the final stage, amino acids with no matches to any clusters or other amino acids in the scope are placed in their own cluster of size one.</p>
    </sec>
    <sec id="s1h">
      <title>Gaps</title>
      <p>Our method does not require parameters related to setting gaps. Once all amino acids are assigned to columns, we lay out the final alignment (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>G). A column that has one amino acid from every sequence has no gaps. If a column does not contain an amino acid from a particular sequence, a gap is left for that sequence in that column. Our algorithm therefore does not need to use gap opening or gap extension parameters, which are required by other methods.</p>
    </sec>
    <sec id="s1i">
      <title>Merging excess partitions over neighboring columns</title>
      <p>We observe cases in which two adjacent columns contain amino acids from a mutually exclusive set of sequences. We detect and merge these paired columns using a low threshold cosine similarity score of 0.1 between amino acids in adjacent clusters, on the basis that independent insertions of one amino acid at the site are biologically unlikely.</p>
    </sec>
    <sec id="s1j">
      <title>Benchmarking</title>
      <p>We use the QuanTest2 (<xref rid="GR277675MCWC45" ref-type="bibr">Sievers and Higgins 2020</xref>) reference alignment data set, which consists of 151 protein sets, each composed of 1000 proteins. The QuanTest2 alignment set is a subset of the HOMSTRAD (<xref rid="GR277675MCWC50" ref-type="bibr">Stebbings and Mizuguchi 2004</xref>) database of curated structure alignments. We use HOMSTRAD alignments that are not included in the QuanTest2 set to evaluate correspondence between RBH pairs of amino acids and aligned positions. We modified the nextflow pipeline nf-benchmark (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>) to wrap our scripts and manage comparison to other methods and evaluation on the QuanTest2 set of alignments.</p>
      <p>We compare our method to Clustal Omega (<xref rid="GR277675MCWC46" ref-type="bibr">Sievers et al. 2011</xref>), MAFFT-FFTNS1, MAFFT-GINSI, MAFFT-LINSI (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), MUSCLE (<xref rid="GR277675MCWC12" ref-type="bibr">Edgar 2004</xref>), ProbCons (<xref rid="GR277675MCWC10" ref-type="bibr">Do et al. 2005</xref>), T-Coffee (<xref rid="GR277675MCWC37" ref-type="bibr">Notredame et al. 2000</xref>), UPP (<xref rid="GR277675MCWC35" ref-type="bibr">Nguyen et al. 2015</xref>), and FAMSA (<xref rid="GR277675MCWC9" ref-type="bibr">Deorowicz et al. 2016</xref>) and build initial guide trees for all methods except UPP with MAFFT-PartTree (<xref rid="GR277675MCWC24" ref-type="bibr">Katoh and Toh 2007</xref>).</p>
      <p>We use the same default parameters for other algorithms as in the supplemental information of <xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. (2019)</xref>. As with previous work, alignment performance is evaluated using gold-standard reference alignments of the first three proteins in each FASTA file (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>). For the proof-of-concept testing described here, we created smaller sets of proteins to align consisting of 20 sequences, for which we select the first three sequences from each FASTA file, as well as 17 randomly selected protein sequences. We additionally remove four protein sets with a more than fourfold difference in length between the three reference sequences and the 17 random sequences, leaving a benchmarking data set of 147 protein sets. We calculate sequence identity for each gold-standard alignment by recording the mean proportion of times each aligned position in the pairs of sequences matches exactly. For sequence identity bins, identities &lt;0.2 fall in bin 0.1, &lt;0.3 fall in bin 0.2, and so on. For runtime measurements, we also create larger sets of proteins consisting of 50, 100, and 200 sequences, where we select the first three sequences and then 47, 97, and 197 sequences, respectively. For evaluating against structured portions of the alignment, we filter down gold-standard alignments to the subset of amino acids with DSSP structure codes H, G, I, E, and B (<xref rid="GR277675MCWC22" ref-type="bibr">Kabsch and Sander 1983</xref>).</p>
      <sec id="s1j1">
        <title>Evaluation score</title>
        <p>We use the total column score calculated with the aln_compare plugin from T-Coffee to score sequence alignments against the gold-standard alignments. This score is the percentage of columns in the output alignment that fully match columns in the reference gold-standard alignment.</p>
      </sec>
    </sec>
    <sec id="s1k">
      <title>Speed</title>
      <p>On an NVIDIA A100 GPU, initial protein embedding of 20 sequences and indexing of embeddings with faiss take, on average, 22.6 sec, and 100 sequence takes, on average, 31.3 sec, including loading the model. On a CPU configuration, protein embedding is substantially slower, taking 2–5 min to embed 20 sequences, depending on the length of the sequences and CPU memory. The time to produce an alignment depends on the number of sequences in the alignment and on the number of iterations required to place all amino acids (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 3A</xref>). After embedding, an alignment of 20 sequences when run on an NVIDIA A100 GPU (for similarity searches on the faiss index) and a 2.6-GHz AMD EPYC Rome CPU (remaining steps) with 64 GB of memory takes a median of 1.2 min, for 50 sequences a median of 6.1 min, for 100 sequences a median of 22.6 min, and for 200 sequences a median of 82.9 min.</p>
      <p>For comparison, on these data sets, T-Coffee is about five to 10 times faster when run on a 2.6-GHz AMD EPYC Rome CPU with 64 GB of memory. Not including time to build trees, as this varies highly by the tree building method, in our benchmarking, T-Coffee takes a median of 0.2 min for 20 sequences, a median of 1.47 min for 50 sequences, a median of 5.8 min for 100 sequences, and a median of 26.1 min for 200 sequences (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 3B</xref>). As our implementation of the vcMSA is a proof of concept, we expect the speed of producing alignments to fall substantially with program optimization.</p>
    </sec>
    <sec id="s1l">
      <title>Merging subalignments and excluded sequences</title>
      <p>Thirteen of 147 of our QuanTest2 20 protein sets contain more than one cluster of sequences, and 59/147 contain at least one outlier sequence. For these 63 protein sets, we must combine vsMSA produced subalignments and excluded sequences into a complete alignment containing all sequences (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>H). For this step, we use MAFFT-LINSI merge (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), which uses our sets of prealigned sequences as internal nodes of a guide tree constructed by UPGMA, using the command <monospace>mafft ‐‐clustalout ‐‐merge key_table ‐‐auto sub.alns</monospace>
<monospace>&gt;</monospace>
<monospace>merged.aln</monospace>. For the remaining 84 protein sets, no merging of alignments is necessary. Although in a typical use case, outlier sequences would be removed, we include them for compatibility with benchmark protein families.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>RBHs between amino acid representations are a solid foundation for MSA</title>
      <p>To show that RBHs between amino acid embeddings in two different sequences accurately reflect aligned amino acids, we measured the proportion of aligned positions in 562 pairs of sequences from the HOMSTRAD gold-standard structural alignment database (<xref rid="GR277675MCWC50" ref-type="bibr">Stebbings and Mizuguchi 2004</xref>) that are RBHs when comparing amino acid embeddings. For 93% of gold-standard protein alignments, at least 50% of aligned columns are additionally RBHs between amino acid embeddings even after filtering RBHs based on uncovering a MNCM (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>A). The correspondence between RBHs and aligned columns is roughly dependent on sequence identity of the alignment (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>B). Thus, protein language models are highly effective in identifying analogous positions across protein sequences. These RBHs are the main input to the vcMSA algorithm.</p>
      <fig position="float" id="GR277675MCWF2">
        <label>Figure 2.</label>
        <caption>
          <p>RBHs and clustered amino acid representations reflect aligned columns. (<italic>A</italic>) For 562 pairs of aligned proteins from the HOMSTRAD database, the MNCMs of RBHs between vector representations frequently correspond to correctly aligned positions. For each gold-standard alignment, we compute the fraction of aligned gold-standard positions that are additionally RBHs after MNCM filtering for that protein pair and display these results as a histogram. (<italic>B</italic>) The proportion of columns in the gold-standard pairwise alignments that are in the MNCM of RBHs is related to sequence identity of the reference alignment. (<italic>C</italic>) Principal components 2 and 3 for amino acid vector representations of 20 cold-shock proteins from the csp protein family. Amino acid representations (<italic>below</italic>) are colored by their corresponding column in the multiple sequence alignment (<italic>above</italic>). (<italic>D</italic>) Identical amino acids in different columns are distinguishable from each other. All glycines in the amino acid PCA plot and the multiple sequence alignment are colored red.</p>
        </caption>
        <graphic xlink:href="1145f02" position="float"/>
      </fig>
    </sec>
    <sec id="s2b">
      <title>Clusters of amino acid representations correspond to columns in the MSA</title>
      <p>When amino acid representations in a PCA are colored by their corresponding column in the MSA, it can be seen that amino acids in the same aligned column cluster together (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>C). We show this correspondence with 20 sequences from the csp protein family using their HOMSTRAD alignment. One initial concern about using amino acid representations for MSA was that the representations of the same amino acid (e.g., glycine) would be too similar wherever that amino acid occurs in the sequence. Instead we find that representations of the same amino acids are distinguishable across the alignment (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>D).</p>
    </sec>
    <sec id="s2c">
      <title>vcMSA produces more accurate alignments than other algorithms, particularly at low sequence identity</title>
      <p>We benchmarked vcMSA on 147 protein alignments consisting of 20 sequences each from the QuanTest2 data set and compared our results to seven alignment algorithms (<xref rid="GR277675MCWF3" ref-type="fig">Fig. 3</xref>A). As the metric to evaluate alignment accuracy, we chose total column score, which measures the number of columns that match the gold-standard alignment, owing to its high dynamic range relative to other metrics. vcMSA generally matches or exceeds the alignment accuracy of other algorithms and performs especially well on the lowest sequence similarity proteins in the benchmark. For example, vcMSA is able to align the Asp_Glu_race_D family with a total column score of 63.9, whereas the maximum score of other alignment methods is 0.9.</p>
      <fig position="float" id="GR277675MCWF3">
        <label>Figure 3.</label>
        <caption>
          <p>vcMSA alignments are frequently more accurate than previous methods, particularly for alignments with low levels of sequence identity. We benchmarked our implementation of vcMSA on sets of 20 sequences from each of 147 gold-standard multiple sequence alignments from the QuanTest2 data set. (<italic>A</italic>) We compare our method to eight state-of-the-art algorithms for sequence alignment. Each point corresponds to one protein MSA and is colored by its sequence identity. Each panel is a tilted scatterplot of relative performance of each other algorithm tested against vcMSA by total column score of produced alignments. Points to the <italic>right</italic> of the vertical dashed line are alignments where vcMSA outperformed the other method. The number of alignments to the <italic>left</italic> or <italic>right</italic> of the line is in gold. vcMSA performs better on more test sets than all other tested algorithms. The point lying on the <italic>right</italic> axis line is the Asp_Glu_race_D alignment, which all other algorithms perform poorly on (TC score ∼0). (<italic>B</italic>) We compare the median total column score of vcMSA alignments to MAFFT-GINSI and Clustal Omega alignments, grouping alignments by sequence identity bins. We observe increased scores for vcMSA at low sequence identities. (<italic>C</italic>) We show median total column scores for structured portions and full gold-standard reference alignments for all algorithms, separated by sequence identity bin.</p>
        </caption>
        <graphic xlink:href="1145f03" position="float"/>
      </fig>
      <p>For low sequence identity alignments, we frequently exceed the alignment accuracy of existing algorithms. In our benchmarking, compared with other methods, we perform notably better on low sequence identity alignments. <xref rid="GR277675MCWF3" ref-type="fig">Figure 3</xref>B illustrates the performance of vcMSA against the two algorithms that score highest and lowest on sequences with identity &lt; 0.2, MAFFT-GINSI and Clustal Omega, respectively. As sequence identity increases, vcMSA generally matches the accuracy of other algorithms. When we compute the total column score for structured portions of the gold-standard alignment compared with the full gold-standard alignment, it is apparent that vcMSA performs better on structured components (<xref rid="GR277675MCWF3" ref-type="fig">Fig. 3</xref>C). Further, vcMSA is specifically strong at structured regions of the lowest identity protein sets. This is likely because of the language model capturing structural properties of these low identity structured regions, even though their sequence identity is beyond the typical twilight zone limit.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>Discussion</title>
    <p>Although sequence aligners were some of the earliest bioinformatic algorithms, and although sequence alignment forms the basis of many computational biology analyses, MSA is not a solved problem. Current sequence alignment algorithms particularly struggle with alignments in the so-called twilight zone of sequence identity, in which structure and function is conserved, but amino acid sequence is not.</p>
    <p>Here, we present vcMSA, a novel algorithm for MSA that diverges substantially from other approaches, and show that it is an improvement on the state of the art for some of the most challenging to align protein families. The ability to create accurate MSAs opens up these low sequence identity families to all the downstream bioinformatics applications that take alignments as input. Notably, the core vcMSA algorithm avoids standard features of the most widely used alignment algorithms, including gap penalties, substitution matrices, and guide trees. Although substitution matrices and gap penalties are standard components of alignment approaches, they are used to formalize optimization criteria and do not reflect fundamental properties of alignments. Instead, aligned amino acids within an MSA are meant to be those that have evolved from a shared ancestral amino acid. Protein language models may be especially suited to identify these analogous amino acids, as they capture structural and functional properties of amino acids via sequence context, much as natural language transformer models capture the semantics of words in a sentence based on other words (<xref rid="GR277675MCWC51" ref-type="bibr">Vaswani et al. 2017</xref>). We find that vcMSA performs particularly well at aligning structured portions of sequences; it is possible that the less well-structured portions of sequences do not have specific functionally analogous positions in other sequences.</p>
    <p>Protein alignment based on protein language representation appears to be most suited to global alignment for sets of protein sequences with similar structure and function, where the underlying meaning of the sequence is as consistent as possible. We have observed that alignment of a small subsequence of a protein (e.g., one domain) to a longer protein is often highly inaccurate, as the contextual embeddings for the small portion are sufficiently different from those computed for the longer protein. To produce the highest quality alignment, outlier sequences can be automatically detected based on sequence embeddings and removed from the alignment process. In these cases, we first use sequence representations to divide sequences into high similarity groups and detect outlier sequences. We then perform vcMSA on each cluster of sequences individually, producing high-quality subalignments. Although we currently use MAFFT-LINSI to combine subalignments produced by vcMSA, we are exploring methods to combine subalignments using purely language models. However, divergence in protein meaning between sequence groups complicates this process.</p>
    <p>Additionally, for alignments in which start positions are not aligned, we find it helpful to add sequence padding to either end of the sequence before embedding, which reduces an observed first character effect, in which the first characters of each sequence tend to have the most similar embeddings, regardless of the sequence context of that first character (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1A</xref>). In these cases, padding can substantially improve correctly aligned columns beyond the first column (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1B</xref>). However, adding padding either substantially degrades or does not change alignment accuracy for protein sets in which the start positions align.</p>
    <p>For certain protein groups, we observe a sequence-specific offset in amino acid embeddings (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1C</xref>), even for sequences with relatively high sequence and structure similarity. On the other hand, we observe that fairly divergent protein sequences can result in embeddings without noticeable sequence-level effects. To reduce sequence specific effects, we consider the amino acids from each sequence as analogous to a batch and remove sequence-specific variation using batch-correction-style techniques (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Reducing sequence-specific effects with batch correction overall improves alignment quality (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1D</xref>). Specifically, between pairs of sequences, batch correction improves the quality of RBHs, particularly for pairs of sequences with cosine similarity less than 0.95 (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1E</xref>). Accordingly, by default, we use batch correction to remove sequence-specific offsets. In some cases, even with correction for sequence-specific offsets, alignment quality is poor. For example, batch correction improves the total column score of neuraminidases from 0.5 to 36.9. However, aligning neuraminidases from <italic>Influenza</italic> A and B separately and then combining subalignments allows a total column score of 64.7. Functional divergence in response to selective pressure in these two neuraminidases likely decreases the similarity of amino acid embeddings. Further research is needed to understand how to recognize and reduce sequence-specific effects when comparing amino acid embeddings across sequences.</p>
    <p>Overall, we find that alignment quality and speed of construction is related to the quality of the RBHs between amino acid embeddings. To improve this network, we use MNCM to remove false-positive RBHs (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 2</xref>). However, it is likely that the RBH network could be improved in multiple ways, including through fine-tuning embeddings, use of other protein language models, and choice of embedding layers. On the other hand, because finding and filtering RBHs is largely effective for removing low similarity spurious matches, our approach is robust to changes in the similarity cutoffs for identifying amino acids to align. We find that alignments improve when merging neighboring columns in the alignment that contain amino acids from mutually exclusive sequences and whose amino acids have a minimal cosine similarity to each other.</p>
    <p>As our implementation is a prototype, we have not substantially optimized our scripts for speed and memory usage, with much room for improvement in these areas. To identify similar amino acid positions at-scale between larger numbers of sequences, we can use tools developed for ultrafast nearest neighbor searches of millions and billions of vectors (<xref rid="GR277675MCWC20" ref-type="bibr">Johnson et al. 2021</xref>). Additionally, our algorithm's runtime is greatly dependent on the number of iterations required to place all amino acids, which is related to the number of clustering errors (when an amino acid is sorted into a cluster that conflicts with the order of amino acids in the sequence). Currently, we use the very basic approach of finding connected components and choosing them to be clusters; we believe that slightly more sophisticated approaches (e.g., those requiring a higher edge density within clusters) would reduce errors in clustering and decrease runtimes.</p>
    <p>Our prototype implementation of the vcMSA algorithm outperforms existing alignment algorithms at aligning a benchmark of sets of proteins. It is particularly successful at aligning groups of low similarity sequences, filling a gap in the capabilities of other algorithms. Another advantage of using amino acid embeddings is that we can additionally score the confidence of each column in the alignment by measuring the average cosine similarity of amino acid embeddings from the same column. This confidence score will allow filtering of alignments to only confidently aligned positions in downstream tasks such as phylogenetic tree building.</p>
    <p>Here, we show both the utility of protein language embeddings in MSA and a new MSA algorithm fully orthogonal to existing approaches. We expect accuracy to only improve with optimal choice of amino acid representations and the development of larger language models that will more richly capture the identity of each amino acid. Overall, we anticipate that protein language models will play an important role in the next generation of methods for determining MSAs.</p>
    <sec id="s3a">
      <title>Software availability</title>
      <p>Our modified version of the nf-benchmark (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>) is available at GitHub (<uri xlink:href="https://github.com/clairemcwhite/nf-benchmark-vcmsa">https://github.com/clairemcwhite/nf-benchmark-vcmsa</uri>). A demonstration colab notebook is available at GitHub (<uri xlink:href="https://github.com/clairemcwhite/vcmsa">https://github.com/clairemcwhite/vcmsa</uri>). Source code is distributed as a Python package vcmsa under an MIT free software license. We recommend obtaining vcmsa and associated files from the GitHub repository (<uri xlink:href="https://github.com/clairemcwhite/vcmsa">https://github.com/clairemcwhite/vcmsa</uri>); however, it is also made available here as <xref rid="SD1" ref-type="supplementary-material">Supplemental Code</xref>. A demonstration Google colab notebook is additionally available at <uri xlink:href="https://colab.research.google.com/drive/1h8WcsMzi8pYr-O3jW03knt7ePcv22o-F">https://colab.research.google.com/drive/1h8WcsMzi8pYr-O3jW03knt7ePcv22o-F</uri>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material id="SD1" position="float" content-type="local-data">
      <label>Supplement 1</label>
      <media xlink:href="Supplemental_code.zip" id="d64e723" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD2" position="float" content-type="local-data">
      <label>Supplement 2</label>
      <media xlink:href="Supplemental_Materials.pdf" id="d64e726" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>C.D.M. acknowledges support from the Lewis-Sigler Institute for Integrative Genomics. M.S. acknowledges support from National Institutes of Health (NIH) R01-GM076275. We thank Joshua Akey for helpful discussions and also thank the Princeton University High Performance Computing Center for providing high-performance computing resources that have contributed to the research results reported in this paper.</p>
    <p><italic>Author contributions:</italic> Conceptualization and algorithmic design were by C.D.M. and M.S. Software implementation and result and figure generation were by C.D.M., with contributions from I.A.-G. C.D.M. and M.S. wrote the manuscript, with contributions from I.A.-G.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link xlink:href="https://www.genome.org/cgi/doi/10.1101/gr.277675.123" ext-link-type="uri">https://www.genome.org/cgi/doi/10.1101/gr.277675.123</ext-link>.</p>
    </fn>
    <fn>
      <p>Freely available online through the <italic>Genome Research</italic> Open Access option.</p>
    </fn>
  </fn-group>
  <sec id="s5">
    <title>Competing interest statement</title>
    <p>The authors declare no competing interests.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="GR277675MCWC1">
      <mixed-citation publication-type="journal"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>. <year>1991</year>. <article-title>Amino acid substitution matrices from an information theoretic perspective</article-title>. <source>J Mol Biol</source><volume>219</volume>: <fpage>555</fpage>–<lpage>565</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(91)90193-A</pub-id><pub-id pub-id-type="pmid">2051488</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC3">
      <mixed-citation publication-type="journal"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><volume>12</volume>: <fpage>654</fpage>–<lpage>669.e3</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2021.05.017</pub-id><pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC4">
      <mixed-citation publication-type="journal"><string-name><surname>Capra</surname><given-names>JA</given-names></string-name>, <string-name><surname>Singh</surname><given-names>M</given-names></string-name>. <year>2007</year>. <article-title>Predicting functionally important residues from sequence conservation</article-title>. <source>Bioinformatics</source><volume>23</volume>: <fpage>1875</fpage>–<lpage>1882</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm270</pub-id><pub-id pub-id-type="pmid">17519246</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC5">
      <mixed-citation publication-type="journal"><string-name><surname>Capra</surname><given-names>JA</given-names></string-name>, <string-name><surname>Singh</surname><given-names>M</given-names></string-name>. <year>2008</year>. <article-title>Characterization and prediction of residues determining protein functional specificity</article-title>. <source>Bioinformatics</source><volume>24</volume>: <fpage>1473</fpage>–<lpage>1480</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn214</pub-id><pub-id pub-id-type="pmid">18450811</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC6">
      <mixed-citation publication-type="journal"><string-name><surname>Chowdhury</surname><given-names>R</given-names></string-name>, <string-name><surname>Bouatta</surname><given-names>N</given-names></string-name>, <string-name><surname>Biswas</surname><given-names>S</given-names></string-name>, <string-name><surname>Floristean</surname><given-names>C</given-names></string-name>, <string-name><surname>Kharkar</surname><given-names>A</given-names></string-name>, <string-name><surname>Roy</surname><given-names>K</given-names></string-name>, <string-name><surname>Rochereau</surname><given-names>C</given-names></string-name>, <string-name><surname>Ahdritz</surname><given-names>G</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Church</surname><given-names>GM</given-names></string-name>, <etal/><year>2022</year>. <article-title>Single-sequence protein structure prediction using a language model and deep learning</article-title>. <source>Nat Biotechnol</source><volume>40</volume>: <fpage>1617</fpage>–<lpage>1623</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01432-w</pub-id><pub-id pub-id-type="pmid">36192636</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC7">
      <mixed-citation publication-type="journal"><string-name><surname>Csardi</surname><given-names>G</given-names></string-name>, <string-name><surname>Nepusz</surname><given-names>T</given-names></string-name>. <year>2006</year>. <article-title>The igraph software package for complex network research</article-title>. <source>Int J Complex Syst</source><volume>1695</volume>: <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC8">
      <mixed-citation publication-type="journal"><string-name><surname>Dayhoff</surname><given-names>MO</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>RM</given-names></string-name>, <string-name><surname>Orcutt</surname><given-names>BC</given-names></string-name>. <year>1978</year>. <article-title>A model of evolutionary change in proteins</article-title>. <source>Atlas Protein Seq Struct</source><volume>5</volume>: <fpage>345</fpage>–<lpage>352</lpage>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC9">
      <mixed-citation publication-type="journal"><string-name><surname>Deorowicz</surname><given-names>S</given-names></string-name>, <string-name><surname>Debudaj-Grabysz</surname><given-names>A</given-names></string-name>, <string-name><surname>Gudyś</surname><given-names>A</given-names></string-name>. <year>2016</year>. <article-title>FAMSA: fast and accurate multiple sequence alignment of huge protein families</article-title>. <source>Sci Rep</source><volume>6</volume>: <fpage>33964</fpage>. <pub-id pub-id-type="doi">10.1038/srep33964</pub-id><pub-id pub-id-type="pmid">27670777</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC10">
      <mixed-citation publication-type="journal"><string-name><surname>Do</surname><given-names>CB</given-names></string-name>, <string-name><surname>Mahabhashyam</surname><given-names>MSP</given-names></string-name>, <string-name><surname>Brudno</surname><given-names>M</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>. <year>2005</year>. <article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>. <source>Genome Res</source><volume>15</volume>: <fpage>330</fpage>–<lpage>340</lpage>. <pub-id pub-id-type="doi">10.1101/gr.2821705</pub-id><pub-id pub-id-type="pmid">15687296</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC11">
      <mixed-citation publication-type="journal"><string-name><surname>Eades</surname><given-names>P</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>WF</given-names></string-name>. <year>1993</year>. <article-title>A fast and effective heuristic for the feedback arc set problem</article-title>. <source>Inf Process Lett</source><volume>47</volume>: <fpage>319</fpage>–<lpage>323</lpage>. <pub-id pub-id-type="doi">10.1016/0020-0190(93)90079-O</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC12">
      <mixed-citation publication-type="journal"><string-name><surname>Edgar</surname><given-names>RC</given-names></string-name>. <year>2004</year>. <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source><volume>5</volume>: <fpage>113</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id><pub-id pub-id-type="pmid">15318951</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC13">
      <mixed-citation publication-type="journal"><string-name><surname>Elnaggar</surname><given-names>A</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Rehawi</surname><given-names>G</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L</given-names></string-name>, <string-name><surname>Gibbs</surname><given-names>T</given-names></string-name>, <string-name><surname>Feher</surname><given-names>T</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>C</given-names></string-name>, <string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <etal/><year>2022</year>. <article-title>ProtTrans: toward understanding the language of life through self-supervised learning</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><volume>44</volume>: <fpage>7112</fpage>–<lpage>7127</lpage>. <pub-id pub-id-type="doi">10.1109/TPAMI.2021.3095381</pub-id><pub-id pub-id-type="pmid">34232869</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC14">
      <mixed-citation publication-type="book"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name>. <year>2004</year>. <source>Inferring phylogenies</source>, <edition>2nd ed.</edition><publisher-name>Sinauer Associates</publisher-name>, <publisher-loc>Sunderland, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC15">
      <mixed-citation publication-type="journal"><string-name><surname>Feng</surname><given-names>D-F</given-names></string-name>, <string-name><surname>Doolittle</surname><given-names>RF</given-names></string-name>. <year>1987</year>. <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>. <source>J Mol Evol</source><volume>25</volume>: <fpage>351</fpage>–<lpage>360</lpage>. <pub-id pub-id-type="doi">10.1007/BF02603120</pub-id><pub-id pub-id-type="pmid">3118049</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC16">
      <mixed-citation publication-type="journal"><string-name><surname>Garriga</surname><given-names>E</given-names></string-name>, <string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Magis</surname><given-names>C</given-names></string-name>, <string-name><surname>Erb</surname><given-names>I</given-names></string-name>, <string-name><surname>Mansouri</surname><given-names>L</given-names></string-name>, <string-name><surname>Baltzis</surname><given-names>A</given-names></string-name>, <string-name><surname>Laayouni</surname><given-names>H</given-names></string-name>, <string-name><surname>Kondrashov</surname><given-names>F</given-names></string-name>, <string-name><surname>Floden</surname><given-names>E</given-names></string-name>, <string-name><surname>Notredame</surname><given-names>C</given-names></string-name>. <year>2019</year>. <article-title>Large multiple sequence alignments with a root-to-leaf regressive method</article-title>. <source>Nat Biotechnol</source><volume>37</volume>: <fpage>1466</fpage>–<lpage>1470</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0333-6</pub-id><pub-id pub-id-type="pmid">31792410</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC17">
      <mixed-citation publication-type="journal"><string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Littmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Sillitoe</surname><given-names>I</given-names></string-name>, <string-name><surname>Bordin</surname><given-names>N</given-names></string-name>, <string-name><surname>Orengo</surname><given-names>C</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2022</year>. <article-title>Contrastive learning on protein embeddings enlightens midnight zone</article-title>. <source>NAR Genom Bioinform</source><volume>4</volume>: <fpage>lqac043</fpage>. <pub-id pub-id-type="doi">10.1093/nargab/lqac043</pub-id><pub-id pub-id-type="pmid">35702380</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC18">
      <mixed-citation publication-type="journal"><string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>JG</given-names></string-name>. <year>1992</year>. <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci</source><volume>89</volume>: <fpage>10915</fpage>–<lpage>10919</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id><pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC20">
      <mixed-citation publication-type="journal"><string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Douze</surname><given-names>M</given-names></string-name>, <string-name><surname>Jégou</surname><given-names>H</given-names></string-name>. <year>2021</year>. <article-title>Billion-scale similarity search with GPUs</article-title>. <source>IEEE Trans Big Data</source><volume>7</volume>: <fpage>535</fpage>–<lpage>547</lpage>. <pub-id pub-id-type="doi">10.1109/TBDATA.2019.2921572</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC21">
      <mixed-citation publication-type="journal"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name>, <string-name><surname>Green</surname><given-names>T</given-names></string-name>, <string-name><surname>Figurnov</surname><given-names>M</given-names></string-name>, <string-name><surname>Ronneberger</surname><given-names>O</given-names></string-name>, <string-name><surname>Tunyasuvunakool</surname><given-names>K</given-names></string-name>, <string-name><surname>Bates</surname><given-names>R</given-names></string-name>, <string-name><surname>Žídek</surname><given-names>A</given-names></string-name>, <string-name><surname>Potapenko</surname><given-names>A</given-names></string-name>, <etal/><year>2021</year>. <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><volume>596</volume>: <fpage>583</fpage>–<lpage>589</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC22">
      <mixed-citation publication-type="journal"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>1983</year>. <article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>. <source>Biopolymers</source><volume>22</volume>: <fpage>2577</fpage>–<lpage>2637</lpage>. <pub-id pub-id-type="doi">10.1002/bip.360221211</pub-id><pub-id pub-id-type="pmid">6667333</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC23">
      <mixed-citation publication-type="journal"><string-name><surname>Katoh</surname><given-names>K</given-names></string-name>, <string-name><surname>Standley</surname><given-names>DM</given-names></string-name>. <year>2013</year>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source><volume>30</volume>: <fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC24">
      <mixed-citation publication-type="journal"><string-name><surname>Katoh</surname><given-names>K</given-names></string-name>, <string-name><surname>Toh</surname><given-names>H</given-names></string-name>. <year>2007</year>. <article-title>PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences</article-title>. <source>Bioinformatics</source><volume>23</volume>: <fpage>372</fpage>–<lpage>374</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl592</pub-id><pub-id pub-id-type="pmid">17118958</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC25">
      <mixed-citation publication-type="journal"><string-name><surname>Littmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Weissenow</surname><given-names>K</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Protein embeddings and deep learning predict binding residues for various ligand classes</article-title>. <source>Sci Rep</source><volume>11</volume>: <fpage>23916</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-021-03431-4</pub-id><pub-id pub-id-type="pmid">34903827</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC26">
      <mixed-citation publication-type="journal"><string-name><surname>Liu</surname><given-names>K</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Holder</surname><given-names>MT</given-names></string-name>, <string-name><surname>Nelesen</surname><given-names>SM</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>AP</given-names></string-name>, <string-name><surname>Linder</surname><given-names>CR</given-names></string-name>. <year>2012</year>. <article-title>SATé-II: very fast and accurate simultaneous estimation of multiple sequence alignments and phylogenetic trees</article-title>. <source>Syst Biol</source><volume>61</volume>: <fpage>90</fpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syr095</pub-id><pub-id pub-id-type="pmid">22139466</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC27">
      <mixed-citation publication-type="journal"><string-name><surname>Malucelli</surname><given-names>F</given-names></string-name>, <string-name><surname>Ottmann</surname><given-names>T</given-names></string-name>, <string-name><surname>Pretolani</surname><given-names>D</given-names></string-name>. <year>1993</year>. <article-title>Efficient labelling algorithms for the maximum noncrossing matching problem</article-title>. <source>Discrete Appl Math</source><volume>47</volume>: <fpage>175</fpage>–<lpage>179</lpage>. <pub-id pub-id-type="doi">10.1016/0166-218X(93)90090-B</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC28">
      <mixed-citation publication-type="journal"><string-name><surname>Marks</surname><given-names>DS</given-names></string-name>, <string-name><surname>Colwell</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Sheridan</surname><given-names>R</given-names></string-name>, <string-name><surname>Hopf</surname><given-names>TA</given-names></string-name>, <string-name><surname>Pagnani</surname><given-names>A</given-names></string-name>, <string-name><surname>Zecchina</surname><given-names>R</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>2011</year>. <article-title>Protein 3D structure computed from evolutionary sequence variation</article-title>. <source>PLoS One</source><volume>6</volume>: <fpage>e28766</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0028766</pub-id><pub-id pub-id-type="pmid">22163331</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC29">
      <mixed-citation publication-type="journal"><string-name><surname>Marquet</surname><given-names>C</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Olenyi</surname><given-names>T</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Erckert</surname><given-names>K</given-names></string-name>, <string-name><surname>Bernhofer</surname><given-names>M</given-names></string-name>, <string-name><surname>Nechaev</surname><given-names>D</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2022</year>. <article-title>Embeddings from protein language models predict conservation and variant effects</article-title>. <source>Hum Genet</source><volume>141</volume>: <fpage>1629</fpage>–<lpage>1647</lpage>. <pub-id pub-id-type="doi">10.1007/s00439-021-02411-y</pub-id><pub-id pub-id-type="pmid">34967936</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC30">
      <mixed-citation publication-type="journal"><string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>N</given-names></string-name>, <string-name><surname>Guo</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L-S</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2015</year>. <article-title>PASTA: ultra-large multiple sequence alignment for nucleotide and amino-acid sequences</article-title>. <source>J Comput Biol</source><volume>22</volume>: <fpage>377</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2014.0156</pub-id><pub-id pub-id-type="pmid">25549288</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC31">
      <mixed-citation publication-type="journal"><string-name><surname>Miyata</surname><given-names>T</given-names></string-name>, <string-name><surname>Yasunaga</surname><given-names>T</given-names></string-name>. <year>1980</year>. <article-title>Molecular evolution of mRNA: a method for estimating evolutionary rates of synonymous and amino acid substitutions from homologous nucleotide sequences and its application</article-title>. <source>J Mol Evol</source><volume>16</volume>: <fpage>23</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1007/BF01732067</pub-id><pub-id pub-id-type="pmid">6449605</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC32">
      <mixed-citation publication-type="journal"><string-name><surname>Morgenstern</surname><given-names>B</given-names></string-name>, <string-name><surname>Prohaska</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Pöhler</surname><given-names>D</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF</given-names></string-name>. <year>2006</year>. <article-title>Multiple sequence alignment with user-defined anchor points</article-title>. <source>Algorithms Mol Biol</source><volume>1</volume>: <fpage>6</fpage>. <pub-id pub-id-type="doi">10.1186/1748-7188-1-6</pub-id><pub-id pub-id-type="pmid">16722533</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC33">
      <mixed-citation publication-type="other"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Strauss</surname><given-names>CEM</given-names></string-name>, <string-name><surname>Blackwell</surname><given-names>R</given-names></string-name>, <string-name><surname>Berenberg</surname><given-names>D</given-names></string-name>, <string-name><surname>Gligorijevic</surname><given-names>V</given-names></string-name>, <string-name><surname>Bonneau</surname><given-names>R</given-names></string-name>. <year>2020</year>. <article-title>Protein structural alignments from sequence</article-title>. <source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.03.365932</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC34">
      <mixed-citation publication-type="journal"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD</given-names></string-name>. <year>1970</year>. <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source><volume>48</volume>: <fpage>443</fpage>–<lpage>453</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id><pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC35">
      <mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname><given-names>ND</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>K</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2015</year>. <article-title>Ultra-large alignments using phylogeny-aware profiles</article-title>. <source>Genome Biol</source><volume>16</volume>: <fpage>124</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0688-z</pub-id><pub-id pub-id-type="pmid">26076734</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC36">
      <mixed-citation publication-type="journal"><string-name><surname>Notredame</surname><given-names>C</given-names></string-name>, <string-name><surname>Holm</surname><given-names>L</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>. <year>1998</year>. <article-title>COFFEE: an objective function for multiple sequence alignments</article-title>. <source>Bioinformatics</source><volume>14</volume>: <fpage>407</fpage>–<lpage>422</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/14.5.407</pub-id><pub-id pub-id-type="pmid">9682054</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC37">
      <mixed-citation publication-type="journal"><string-name><surname>Notredame</surname><given-names>C</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>, <string-name><surname>Heringa</surname><given-names>J</given-names></string-name>. <year>2000</year>. <article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source><volume>302</volume>: <fpage>205</fpage>–<lpage>217</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC38">
      <mixed-citation publication-type="journal"><string-name><surname>Nute</surname><given-names>M</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>E</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2019</year>. <article-title>Evaluating statistical multiple sequence alignment in comparison to other alignment methods on protein data sets</article-title>. <source>Syst Biol</source><volume>68</volume>: <fpage>396</fpage>–<lpage>411</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syy068</pub-id><pub-id pub-id-type="pmid">30329135</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC39">
      <mixed-citation publication-type="journal"><string-name><surname>Petti</surname><given-names>S</given-names></string-name>, <string-name><surname>Bhattacharya</surname><given-names>N</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name>, <string-name><surname>Dauparas</surname><given-names>J</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>N</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Rush</surname><given-names>AM</given-names></string-name>, <string-name><surname>Koo</surname><given-names>PK</given-names></string-name>, <string-name><surname>Ovchinnikov</surname><given-names>S</given-names></string-name>. <year>2023</year>. <article-title>End-to-end learning of multiple sequence alignments with differentiable Smith–Waterman</article-title>. <source>Bioinformatics</source><volume>39</volume>: <fpage>btac724</fpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btac724</pub-id><pub-id pub-id-type="pmid">36355460</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC40">
      <mixed-citation publication-type="journal"><string-name><surname>Pitschi</surname><given-names>F</given-names></string-name>, <string-name><surname>Devauchelle</surname><given-names>C</given-names></string-name>, <string-name><surname>Corel</surname><given-names>E</given-names></string-name>. <year>2010</year>. <article-title>Automatic detection of anchor points for multiple sequence alignment</article-title>. <source>BMC Bioinformatics</source><volume>11</volume>: <fpage>445</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-445</pub-id><pub-id pub-id-type="pmid">20813050</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC41">
      <mixed-citation publication-type="journal"><string-name><surname>Rao</surname><given-names>R</given-names></string-name>, <string-name><surname>Bhattacharya</surname><given-names>N</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>N</given-names></string-name>, <string-name><surname>Duan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Canny</surname><given-names>J</given-names></string-name>, <string-name><surname>Abbeel</surname><given-names>P</given-names></string-name>, <string-name><surname>Song</surname><given-names>YS</given-names></string-name>. <year>2019</year>. <article-title>Evaluating protein transfer learning with TAPE</article-title>. <source>Adv Neural Inf Process Syst</source><volume>32</volume>: <fpage>9689</fpage>–<lpage>9701</lpage>.<pub-id pub-id-type="pmid">33390682</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC42">
      <mixed-citation publication-type="journal"><string-name><surname>Rives</surname><given-names>A</given-names></string-name>, <string-name><surname>Meier</surname><given-names>J</given-names></string-name>, <string-name><surname>Sercu</surname><given-names>T</given-names></string-name>, <string-name><surname>Goyal</surname><given-names>S</given-names></string-name>, <string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>D</given-names></string-name>, <string-name><surname>Ott</surname><given-names>M</given-names></string-name>, <string-name><surname>Zitnick</surname><given-names>CL</given-names></string-name>, <string-name><surname>Ma</surname><given-names>J</given-names></string-name>, <etal/><year>2021</year>. <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>. <source>Proc Natl Acad Sci</source><volume>118</volume>: <fpage>e2016239118</fpage>. <pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id><pub-id pub-id-type="pmid">33876751</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC43">
      <mixed-citation publication-type="journal"><string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>1999</year>. <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Eng</source><volume>12</volume>: <fpage>85</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1093/protein/12.2.85</pub-id><pub-id pub-id-type="pmid">10195279</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC44">
      <mixed-citation publication-type="journal"><string-name><surname>Rost</surname><given-names>B</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>1994</year>. <article-title>Combining evolutionary information and neural networks to predict protein secondary structure</article-title>. <source>Proteins</source><volume>19</volume>: <fpage>55</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1002/prot.340190108</pub-id><pub-id pub-id-type="pmid">8066087</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC45">
      <mixed-citation publication-type="journal"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>. <year>2020</year>. <article-title>QuanTest2: benchmarking multiple sequence alignments using secondary structure prediction</article-title>. <source>Bioinformatics</source><volume>36</volume>: <fpage>90</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz552</pub-id><pub-id pub-id-type="pmid">31292629</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC46">
      <mixed-citation publication-type="journal"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Wilm</surname><given-names>A</given-names></string-name>, <string-name><surname>Dineen</surname><given-names>D</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Karplus</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>McWilliam</surname><given-names>H</given-names></string-name>, <string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name>, <etal/><year>2011</year>. <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using clustal omega</article-title>. <source>Mol Syst Biol</source><volume>7</volume>: <fpage>539</fpage>. <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id><pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC47">
      <mixed-citation publication-type="journal"><string-name><surname>Smith</surname><given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname><given-names>MS</given-names></string-name>. <year>1981</year>. <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source><volume>147</volume>: <fpage>195</fpage>–<lpage>197</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id><pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC48">
      <mixed-citation publication-type="journal"><string-name><surname>Sonnhammer</surname><given-names>ELL</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E</given-names></string-name>, <string-name><surname>Bateman</surname><given-names>A</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>1998</year>. <article-title>Pfam: multiple sequence alignments and HMM-profiles of protein domains</article-title>. <source>Nucleic Acids Res</source><volume>26</volume>: <fpage>320</fpage>–<lpage>322</lpage>. <pub-id pub-id-type="doi">10.1093/nar/26.1.320</pub-id><pub-id pub-id-type="pmid">9399864</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC49">
      <mixed-citation publication-type="journal"><string-name><surname>Stärk</surname><given-names>H</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Light attention predicts protein location from the language of life</article-title>. <source>Bioinforma Adv</source><volume>1</volume>: <fpage>vbab035</fpage>. <pub-id pub-id-type="doi">10.1093/bioadv/vbab035</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC50">
      <mixed-citation publication-type="journal"><string-name><surname>Stebbings</surname><given-names>LA</given-names></string-name>, <string-name><surname>Mizuguchi</surname><given-names>K</given-names></string-name>. <year>2004</year>. <article-title>HOMSTRAD: recent developments of the Homologous Protein Structure Alignment Database</article-title>. <source>Nucleic Acids Res</source><volume>32</volume>: <fpage>D203</fpage>–<lpage>D207</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh027</pub-id><pub-id pub-id-type="pmid">14681395</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC51">
      <mixed-citation publication-type="book"><string-name><surname>Vaswani</surname><given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N</given-names></string-name>, <string-name><surname>Uszkoreit</surname><given-names>J</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L</given-names></string-name>, <string-name><surname>Gomez</surname><given-names>AN</given-names></string-name>, <string-name><surname>Kaiser</surname><given-names>Ł</given-names></string-name>, <string-name><surname>Polosukhin</surname><given-names>I</given-names></string-name>. <year>2017</year>. <article-title>Attention is all you need</article-title>. <source>Advances in neural information processing systems. In Proceedings of the 31st international conference on neural information processing systems (NIPS'17)</source>, pp. <fpage>6000</fpage>–<lpage>6010</lpage>. <publisher-name>Curran Associates Inc.</publisher-name>, <publisher-loc>Red Hook, NY</publisher-loc>. <pub-id pub-id-type="doi">10.5555/3295222.3295349</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10538487</article-id>
    <article-id pub-id-type="pmid">37414576</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.277675.123</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Leveraging protein language models for accurate multiple sequence alignments</article-title>
      <alt-title alt-title-type="left-running">McWhite et al.</alt-title>
      <alt-title alt-title-type="right-running">Leveraging protein language for alignment</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7346-3047</contrib-id>
        <name>
          <surname>McWhite</surname>
          <given-names>Claire D.</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6332-3750</contrib-id>
        <name>
          <surname>Armour-Garb</surname>
          <given-names>Isabel</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8271-6026</contrib-id>
        <name>
          <surname>Singh</surname>
          <given-names>Mona</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey 08544, USA;</aff>
    <aff id="af2"><label>2</label>Department of Computer Science, Princeton University, Princeton, New Jersey 08544, USA</aff>
    <author-notes>
      <corresp>Corresponding authors: <email>cmcwhite@princeton.edu</email>, <email>mona@cs.princeton.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <volume>33</volume>
    <issue>7</issue>
    <fpage>1145</fpage>
    <lpage>1153</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml" ext-link-type="uri">© 2023 McWhite et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This article, published in <italic>Genome Research</italic>, is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1145.pdf"/>
    <abstract>
      <p>Multiple sequence alignment (MSA) is a critical step in the study of protein sequence and function. Typically, MSA algorithms progressively align pairs of sequences and combine these alignments with the aid of a guide tree. These alignment algorithms use scoring systems based on substitution matrices to measure amino acid similarities. Although successful, standard methods struggle on sets of proteins with low sequence identity: the so-called twilight zone of protein alignment. For these difficult cases, another source of information is needed. Protein language models are a powerful new approach that leverages massive sequence data sets to produce high-dimensional contextual embeddings for each amino acid in a sequence. These embeddings have been shown to reflect physicochemical and higher-order structural and functional attributes of amino acids within proteins. Here, we present a novel approach to MSA, based on clustering and ordering amino acid contextual embeddings. Our method for aligning semantically consistent groups of proteins circumvents the need for many standard components of MSA algorithms, avoiding initial guide tree construction, intermediate pairwise alignments, gap penalties, and substitution matrices. The added information from contextual embeddings leads to higher accuracy alignments for structurally similar proteins with low amino-acid similarity. We anticipate that protein language models will become a fundamental component of the next generation of algorithms for generating MSAs.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health </institution>
            <institution-id institution-id-type="doi">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM076275</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignments (MSAs) underlie much of sequence analysis in computational biology. Protein MSAs are the main input to algorithms for reconstructing gene and species trees (<xref rid="GR277675MCWC14" ref-type="bibr">Felsenstein 2004</xref>); for identifying conserved (<xref rid="GR277675MCWC4" ref-type="bibr">Capra and Singh 2007</xref>), co-evolving (<xref rid="GR277675MCWC28" ref-type="bibr">Marks et al. 2011</xref>), specificity-determining (<xref rid="GR277675MCWC5" ref-type="bibr">Capra and Singh 2008</xref>), and positively selected sites (<xref rid="GR277675MCWC31" ref-type="bibr">Miyata and Yasunaga 1980</xref>); for building protein motif and domain representations (<xref rid="GR277675MCWC48" ref-type="bibr">Sonnhammer et al. 1998</xref>); and for predicting de novo protein structural features (<xref rid="GR277675MCWC44" ref-type="bibr">Rost and Sander 1994</xref>) and full protein structure prediction (<xref rid="GR277675MCWC21" ref-type="bibr">Jumper et al. 2021</xref>). Highly accurate MSAs are necessary, as misaligned amino acids can lead to incorrect inferences for this wide range of downstream tasks. However, when the average sequence identity among the sequences to be aligned is low, most MSA methods struggle to obtain high-quality alignments (<xref rid="GR277675MCWC38" ref-type="bibr">Nute et al. 2019</xref>); sequence identity below 20%–35% has been termed the “twilight zone” of alignment (<xref rid="GR277675MCWC43" ref-type="bibr">Rost 1999</xref>).</p>
  <p>Over the past 40 years, numerous algorithms for obtaining MSAs have been developed and refined, including CLUSTAL (<xref rid="GR277675MCWC46" ref-type="bibr">Sievers et al. 2011</xref>), MAFFT (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), Muscle (<xref rid="GR277675MCWC12" ref-type="bibr">Edgar 2004</xref>), T-Coffee (<xref rid="GR277675MCWC37" ref-type="bibr">Notredame et al. 2000</xref>), ProbCons (<xref rid="GR277675MCWC10" ref-type="bibr">Do et al. 2005</xref>), Saté (<xref rid="GR277675MCWC26" ref-type="bibr">Liu et al. 2012</xref>), and PASTA (<xref rid="GR277675MCWC30" ref-type="bibr">Mirarab et al. 2015</xref>), among others. The predominant approach to align multiple sequences is to first align pairs of sequences and then progressively combine these subalignments into larger alignments in an order determined by a guide tree (<xref rid="GR277675MCWC15" ref-type="bibr">Feng and Doolittle 1987</xref>). Pairwise alignment algorithms (<xref rid="GR277675MCWC34" ref-type="bibr">Needleman and Wunsch 1970</xref>; <xref rid="GR277675MCWC47" ref-type="bibr">Smith and Waterman 1981</xref>) uncover a highest scoring alignment between two sequences when given a similarity measure between all pairs of amino acids and a gap penalty function. Similarities between each pair of the 20 amino acids are typically based upon substitution matrices that encapsulate the frequency with which amino acid pairs are observed in equivalent positions across large data sets of alignments of homologous sequences (<xref rid="GR277675MCWC8" ref-type="bibr">Dayhoff et al. 1978</xref>; <xref rid="GR277675MCWC1" ref-type="bibr">Altschul 1991</xref>; <xref rid="GR277675MCWC18" ref-type="bibr">Henikoff and Henikoff 1992</xref>). Although in theory optimal pairwise alignment algorithms can be adapted to multiple sequences, the runtime would be exponential in the number of sequences, and further, it is not clear how to score multiple amino acids in a single aligned column. Instead, guide tree–based MSA approaches are heuristics that optimally combine pairs of alignments in which the similarity of a pair of columns in two different alignments is computed based on substitution matrix scores of the amino acids within the columns. Alternatively, consistency-based progressive MSA approaches use similarity scores that consider how frequently pairs of amino acids in two different sequences are aligned to the same amino acid position in other sequences when considering optimal pairwise alignments (<xref rid="GR277675MCWC36" ref-type="bibr">Notredame et al. 1998</xref>, <xref rid="GR277675MCWC37" ref-type="bibr">2000</xref>).</p>
  <p>Here, we consider a new approach to determining the similarities between amino acids across proteins, based on protein language models (<xref rid="GR277675MCWC41" ref-type="bibr">Rao et al. 2019</xref>; <xref rid="GR277675MCWC3" ref-type="bibr">Bepler and Berger 2021</xref>; <xref rid="GR277675MCWC42" ref-type="bibr">Rives et al. 2021</xref>; <xref rid="GR277675MCWC6" ref-type="bibr">Chowdhury et al. 2022</xref>; <xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). Protein language models are “self-supervised” deep learning language models that have been pretrained on large compendia of protein sequences, generally trained to predict “masked” amino acids within input protein sequences based on the rest of the sequence. Once trained, these models embed each amino acid within a protein sequence as a high-dimensional vector, and importantly, these vectors capture the sequence “context” of each amino acid. Machine learning models using these embeddings have been successfully trained to predict many protein structural and functional features, including conservation (<xref rid="GR277675MCWC29" ref-type="bibr">Marquet et al. 2022</xref>), ligand binding (<xref rid="GR277675MCWC25" ref-type="bibr">Littmann et al. 2021</xref>), homology (<xref rid="GR277675MCWC42" ref-type="bibr">Rives et al. 2021</xref>; <xref rid="GR277675MCWC17" ref-type="bibr">Heinzinger et al. 2022</xref>), and subcellular localization (<xref rid="GR277675MCWC49" ref-type="bibr">Stärk et al. 2021</xref>). Because amino acids at equivalent positions in two different protein sequences play the same structural and functional role, we reasoned that clustering amino acid context vectors across sequences could be the basis of a new approach for aligning sequences. Although recently neural network machinery has been leveraged to perform dynamic program-based alignments (<xref rid="GR277675MCWC33" ref-type="bibr">Morton et al. 2020</xref>; <xref rid="GR277675MCWC39" ref-type="bibr">Petti et al. 2023</xref>), our approach is, to the best of our knowledge, the first that uses protein sequence embeddings to identify analogous positions across protein sequences in order to determine MSAs. Our MSA approach is based on clustering the amino acid contextual vectors produced by protein language models and then using graph-theoretic approaches to determine a consistent ordering of MSA columns. Our method, <underline>v</underline>ector-<underline>c</underline>lustering <underline>M</underline>ultiple <underline>S</underline>equence <underline>A</underline>lignment (vcMSA), is a true multiple sequence aligner that aligns multiple sequences at once instead of progressively integrating pairwise alignments. Our core methodology diverges from standard MSA methods in that it avoids substitution matrices and gap penalties, and in most cases, does not use guide tree construction. In proof-of-concept testing, we aim to establish the power of leveraging protein language models for building MSAs, particularly for low identity sequence families that current methods have the most difficulty on.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <sec id="s1a">
      <title>Overview</title>
      <p>A brief overview of our algorithm is as follows. First, for all protein sequences, we obtain per-position and sequence-level embeddings via a protein language model (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>A). Second, we cluster protein sequences via the sequence-level embeddings to uncover sets of sequence-similar proteins (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>B). Third, within each cluster of sequences, we measure the similarities of amino acid vectors and, for each amino acid, find the one that is most similar to it in each of the other sequences (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>C) and filter to amino acid pairings that are reciprocal best hits (RBHs) of each other. Fourth, we build an RBH network and cluster the network to find “guidepost” amino acid positions in different sequences that are clearly aligned to each other (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>D). Fifth, we order the clusters into columns of the MSA by constructing a directed acyclic graph (DAG) based on sequential positions within each protein sequence and performing a topological sort (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>E). Sixth, we use guidepost clusters to limit the scope of searches for the remaining unplaced amino acids (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). Seventh, we continue creating guideposts and assigning amino acids to columns until all amino acids are placed in the alignment (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>G). Finally, we combine subalignments from the sequence clusters into the final MSA (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>H). Further details about each of these steps are provided below.</p>
      <fig position="float" id="GR277675MCWF1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of vcMSA algorithm. (<italic>A</italic>) Proteins are embedded using a protein language model to produce vector representations of each amino acid, and the mean of these amino acid embeddings is taken to produce a sequence-level representation. (<italic>B</italic>) We cluster sequence representations and detect outlier sequences. (<italic>C</italic>) For each sequence cluster, we determine bidirectional/reciprocal best hits (RBHs) of cosine similarity between pairs of amino acids in different sequences. (<italic>D</italic>) From a network built from RBHs, we determine confident clusters of amino acids, corresponding to columns in the MSA. (<italic>E</italic>) To determine column order, we trace the path of each sequence through clusters and combine all paths into one network, taking edge weights from the number of sequences that traverse between the pairs of clusters. We trim any clusters that cause cycles and use a topological sort of the resulting directed acyclic graph to find column order. (<italic>F</italic>) Clusters/columns limit scope of search for unplaced amino acids. (<italic>G</italic>) We iterate limited searches until all amino acids are placed. Gaps in the alignment occur when a cluster does not contain an amino acid from a sequence. (<italic>H</italic>) We combine alignments from each sequence cluster and outliers in the final output MSA.</p>
        </caption>
        <graphic xlink:href="1145f01" position="float"/>
      </fig>
    </sec>
    <sec id="s1b">
      <title>Embedding generation</title>
      <p>For each protein sequence, we use the encoder portion of the ProtT5-XL-UniRef50 language model to generate sequence embeddings (<xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). T5 models undergo self-supervised training on a large corpus of text, in this case over 11 million protein sequences in the UniRef50 data set (<xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). For each amino acid in a sequence, the ProtT5-XL-UniRef50 model produces one embedding vector of length 1024 for each of its 24 encoder layers. We choose to use embeddings from the final 16 layers, giving us a final vector representation of each amino acid with dimension 16,384. For each sequence, we average all of the vector embeddings for each of its amino acids to obtain a sequence-level embedding. We additionally add padding to sequences, where we first add 10 X's to the start and end of each sequence before embedding (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1A</xref>).</p>
    </sec>
    <sec id="s1c">
      <title>Sequence clustering</title>
      <p>We find that vcMSA performs best on semantically consistent sets of sequences and that performance is degraded when outlier sequences are included. Therefore, we first cluster input sequences based on sequence-level embeddings to obtain groups of similar sequences and detect outliers (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). We then apply the remaining steps of vcMSA to each cluster of sequences individually. Left out sequences and alignments for clusters are merged into a full alignment as described below.</p>
    </sec>
    <sec id="s1d">
      <title>Amino acid similarity across sequences</title>
      <p>The contextual similarity between a pair of amino acids is defined as the cosine similarity between their embedding vectors. To reduce sequence-specific effects and increase the overall similarity between different sequences, we first apply “batch correction” to amino acid embeddings in the same sequence cluster, considering each sequence as analogous to a batch (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1C</xref>; <xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). For each amino acid in each sequence, we next find the most similar amino acid in each of the other sequences by considering cosine similarities between their embeddings. We use Facebook's fast AI similarity search (faiss) library to perform nearest neighbor searches for all amino acids (<xref rid="GR277675MCWC20" ref-type="bibr">Johnson et al. 2021</xref>). For each pair of sequences, the set of pairwise similarities between amino acids between different sequences is filtered to only RBHs, for which the best match to a query amino acid in the target sequence must also have its highest score in the query sequence be the query amino acid (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>C). For each pair of sequences, we construct a bipartite graph composed of nodes for each amino acid in the two sequences, with an edge for each RBH identified between amino acids in the two sequences. We will keep a largest set of these RBHs that are “consistent” with each other in a pairwise alignment using a maximum noncrossing matching (MNCM) formulation (<xref rid="GR277675MCWC27" ref-type="bibr">Malucelli et al. 1993</xref>). In particular, if the <italic>i</italic>th and <italic>j</italic>th amino acids in the first sequence (we assume without loss of generality that <italic>i</italic> &lt; <italic>j)</italic> have as their RBHs the <italic>k</italic>th and <italic>l</italic>th amino acids, respectively, in the second sequence, then this pair of RBHs is consistent only if <italic>k</italic> &lt; <italic>l</italic>; that is, if <italic>k</italic> &lt; <italic>l</italic>, it is possible for a pairwise alignment between these two sequences to simultaneously align the <italic>i</italic>th and <italic>j</italic>th amino acids in the first sequence with the <italic>k</italic>th and <italic>l</italic>th amino acids in the second sequence. If two pairs of RBHs are not consistent with each other, we say that the edges that correspond to them “intersect,” as they would if the nodes were arranged in two columns (one for each sequence) in the order in which they appear in the sequences. We define a noncrossing matching to be a selection of edges such that no two edges intersect, and an MNCM to be the largest possible set of such edges. In the case that there are multiple MNCMs, we select the MNCM that has the highest average cosine similarity score between all RBHs in the matching. We remove from consideration any RBHs that are not part of this MNCM; in this manner, we obtain a filtered set of RBHs across all pairs of sequences. MNCM performs well in preserving RBHs corresponding to correctly aligned amino acid pairs, while removing false-positive matches (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 2</xref>).</p>
    </sec>
    <sec id="s1e">
      <title>Amino acid clustering</title>
      <p>We build a network in which there is a node for each amino acid in each sequence, and there is an edge between two nodes if the corresponding amino acids are RBHs included in the filtered set of RBHs. We use this network of RBHs in order to cluster sets of amino acids that align to each other with high confidence (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>D; <xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Amino acids within a cluster will comprise a column in the MSA. We term these aligned positions guideposts and will use these guidepost columns to limit the scope of future searches for amino acids that align to each other (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). Our guidepost columns are similar to user-defined or automatically inferred “anchor points” that have been used in the past to constrain traditional MSA approaches (<xref rid="GR277675MCWC32" ref-type="bibr">Morgenstern et al. 2006</xref>; <xref rid="GR277675MCWC40" ref-type="bibr">Pitschi et al. 2010</xref>).</p>
    </sec>
    <sec id="s1f">
      <title>Column order determination</title>
      <p>Each cluster corresponds to a column of the MSA; however, these columns must be placed in the correct order in the alignment that is being built. To do this, we will first build a graph based on the correct ordering of amino acids in each protein sequence and then prune this graph to be a DAG and perform a topological sort of this graph (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>E). In particular, we will introduce a node for each cluster. Next, for clusters <italic>A</italic> and <italic>B</italic>, if there exists amino acids <italic>u</italic> ∈ <italic>A</italic> and <italic>v</italic> ∈ <italic>B</italic> where <italic>u</italic> and <italic>v</italic> are in the same sequence, <italic>u</italic> is before <italic>v</italic> in the sequence, and <italic>v</italic> is the first clustered amino acid after <italic>u</italic> in the sequence, then we will add a directed edge from <italic>u</italic> to <italic>v</italic>. This edge will be weighted by the number of sequences in which such <italic>u</italic> and <italic>v</italic> exist. Out-of-order amino acids, in which an amino acid is placed in a cluster that occurs too late or too early in the MSA, will cause cycles in this directed graph. To remove these out-of-order amino acids, we detect feedback arc sets (<xref rid="GR277675MCWC11" ref-type="bibr">Eades et al. 1993</xref>; <xref rid="GR277675MCWC7" ref-type="bibr">Csardi and Nepusz 2006</xref>), finding edges to remove to obtain an acyclic graph and prioritizing edges with low weight for removal. Because feedback arc set detection is NP-complete, we use the linear time heuristic approach of <xref rid="GR277675MCWC11" ref-type="bibr">Eades et al. (1993)</xref>. Feedback arc set detection has been previously used in MSA to enforce order consistency for multiple local areas of alignment (<xref rid="GR277675MCWC40" ref-type="bibr">Pitschi et al. 2010</xref>).</p>
      <p>For each node-pair of each feedback arc, we discard the node/cluster ID with lowest total edge weight and finally confirm that the trimmed network is a DAG. We then perform a topological sort of the graph to obtain an ordered path that visits every node (cluster ID). This sequence of cluster IDs is the order of columns in the MSA.</p>
    </sec>
    <sec id="s1g">
      <title>Limited scope searches</title>
      <p>At this stage, we have a subset of guidepost columns in the alignment, as well as sets of amino acids that have not been assigned to any column (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). If an unassigned amino acid occurs after an amino acid that has been assigned to column <italic>p</italic> and before an amino acid that has been assigned to column <italic>q</italic>, we only need to consider amino acids from other sequences that also fall between <italic>p</italic> and <italic>q</italic> as candidate matches.</p>
      <p>We repeatedly alternate two phases of adding amino acids into the alignment until there are no remaining unplaced amino acids with cosine similarity &gt; 0.1 to any potential match amino acid in the scope. Our two phases are (1) create new columns by amino acid clustering, as described above, among all amino acids also falling between the appropriate guideposts and (2) add amino acids into existing columns by best match score (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Existing columns can only be modified during the second phase with the addition of new members. In early iterations following clustering stages, we remove clusters in which any member of the cluster is “stranded,” meaning that neither of its previous or next amino acids is found in the previous and next aligned column/cluster. This quality-control step prevents early errors in which an amino acid is placed in the wrong cluster. For the final stage, amino acids with no matches to any clusters or other amino acids in the scope are placed in their own cluster of size one.</p>
    </sec>
    <sec id="s1h">
      <title>Gaps</title>
      <p>Our method does not require parameters related to setting gaps. Once all amino acids are assigned to columns, we lay out the final alignment (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>G). A column that has one amino acid from every sequence has no gaps. If a column does not contain an amino acid from a particular sequence, a gap is left for that sequence in that column. Our algorithm therefore does not need to use gap opening or gap extension parameters, which are required by other methods.</p>
    </sec>
    <sec id="s1i">
      <title>Merging excess partitions over neighboring columns</title>
      <p>We observe cases in which two adjacent columns contain amino acids from a mutually exclusive set of sequences. We detect and merge these paired columns using a low threshold cosine similarity score of 0.1 between amino acids in adjacent clusters, on the basis that independent insertions of one amino acid at the site are biologically unlikely.</p>
    </sec>
    <sec id="s1j">
      <title>Benchmarking</title>
      <p>We use the QuanTest2 (<xref rid="GR277675MCWC45" ref-type="bibr">Sievers and Higgins 2020</xref>) reference alignment data set, which consists of 151 protein sets, each composed of 1000 proteins. The QuanTest2 alignment set is a subset of the HOMSTRAD (<xref rid="GR277675MCWC50" ref-type="bibr">Stebbings and Mizuguchi 2004</xref>) database of curated structure alignments. We use HOMSTRAD alignments that are not included in the QuanTest2 set to evaluate correspondence between RBH pairs of amino acids and aligned positions. We modified the nextflow pipeline nf-benchmark (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>) to wrap our scripts and manage comparison to other methods and evaluation on the QuanTest2 set of alignments.</p>
      <p>We compare our method to Clustal Omega (<xref rid="GR277675MCWC46" ref-type="bibr">Sievers et al. 2011</xref>), MAFFT-FFTNS1, MAFFT-GINSI, MAFFT-LINSI (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), MUSCLE (<xref rid="GR277675MCWC12" ref-type="bibr">Edgar 2004</xref>), ProbCons (<xref rid="GR277675MCWC10" ref-type="bibr">Do et al. 2005</xref>), T-Coffee (<xref rid="GR277675MCWC37" ref-type="bibr">Notredame et al. 2000</xref>), UPP (<xref rid="GR277675MCWC35" ref-type="bibr">Nguyen et al. 2015</xref>), and FAMSA (<xref rid="GR277675MCWC9" ref-type="bibr">Deorowicz et al. 2016</xref>) and build initial guide trees for all methods except UPP with MAFFT-PartTree (<xref rid="GR277675MCWC24" ref-type="bibr">Katoh and Toh 2007</xref>).</p>
      <p>We use the same default parameters for other algorithms as in the supplemental information of <xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. (2019)</xref>. As with previous work, alignment performance is evaluated using gold-standard reference alignments of the first three proteins in each FASTA file (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>). For the proof-of-concept testing described here, we created smaller sets of proteins to align consisting of 20 sequences, for which we select the first three sequences from each FASTA file, as well as 17 randomly selected protein sequences. We additionally remove four protein sets with a more than fourfold difference in length between the three reference sequences and the 17 random sequences, leaving a benchmarking data set of 147 protein sets. We calculate sequence identity for each gold-standard alignment by recording the mean proportion of times each aligned position in the pairs of sequences matches exactly. For sequence identity bins, identities &lt;0.2 fall in bin 0.1, &lt;0.3 fall in bin 0.2, and so on. For runtime measurements, we also create larger sets of proteins consisting of 50, 100, and 200 sequences, where we select the first three sequences and then 47, 97, and 197 sequences, respectively. For evaluating against structured portions of the alignment, we filter down gold-standard alignments to the subset of amino acids with DSSP structure codes H, G, I, E, and B (<xref rid="GR277675MCWC22" ref-type="bibr">Kabsch and Sander 1983</xref>).</p>
      <sec id="s1j1">
        <title>Evaluation score</title>
        <p>We use the total column score calculated with the aln_compare plugin from T-Coffee to score sequence alignments against the gold-standard alignments. This score is the percentage of columns in the output alignment that fully match columns in the reference gold-standard alignment.</p>
      </sec>
    </sec>
    <sec id="s1k">
      <title>Speed</title>
      <p>On an NVIDIA A100 GPU, initial protein embedding of 20 sequences and indexing of embeddings with faiss take, on average, 22.6 sec, and 100 sequence takes, on average, 31.3 sec, including loading the model. On a CPU configuration, protein embedding is substantially slower, taking 2–5 min to embed 20 sequences, depending on the length of the sequences and CPU memory. The time to produce an alignment depends on the number of sequences in the alignment and on the number of iterations required to place all amino acids (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 3A</xref>). After embedding, an alignment of 20 sequences when run on an NVIDIA A100 GPU (for similarity searches on the faiss index) and a 2.6-GHz AMD EPYC Rome CPU (remaining steps) with 64 GB of memory takes a median of 1.2 min, for 50 sequences a median of 6.1 min, for 100 sequences a median of 22.6 min, and for 200 sequences a median of 82.9 min.</p>
      <p>For comparison, on these data sets, T-Coffee is about five to 10 times faster when run on a 2.6-GHz AMD EPYC Rome CPU with 64 GB of memory. Not including time to build trees, as this varies highly by the tree building method, in our benchmarking, T-Coffee takes a median of 0.2 min for 20 sequences, a median of 1.47 min for 50 sequences, a median of 5.8 min for 100 sequences, and a median of 26.1 min for 200 sequences (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 3B</xref>). As our implementation of the vcMSA is a proof of concept, we expect the speed of producing alignments to fall substantially with program optimization.</p>
    </sec>
    <sec id="s1l">
      <title>Merging subalignments and excluded sequences</title>
      <p>Thirteen of 147 of our QuanTest2 20 protein sets contain more than one cluster of sequences, and 59/147 contain at least one outlier sequence. For these 63 protein sets, we must combine vsMSA produced subalignments and excluded sequences into a complete alignment containing all sequences (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>H). For this step, we use MAFFT-LINSI merge (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), which uses our sets of prealigned sequences as internal nodes of a guide tree constructed by UPGMA, using the command <monospace>mafft ‐‐clustalout ‐‐merge key_table ‐‐auto sub.alns</monospace>
<monospace>&gt;</monospace>
<monospace>merged.aln</monospace>. For the remaining 84 protein sets, no merging of alignments is necessary. Although in a typical use case, outlier sequences would be removed, we include them for compatibility with benchmark protein families.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>RBHs between amino acid representations are a solid foundation for MSA</title>
      <p>To show that RBHs between amino acid embeddings in two different sequences accurately reflect aligned amino acids, we measured the proportion of aligned positions in 562 pairs of sequences from the HOMSTRAD gold-standard structural alignment database (<xref rid="GR277675MCWC50" ref-type="bibr">Stebbings and Mizuguchi 2004</xref>) that are RBHs when comparing amino acid embeddings. For 93% of gold-standard protein alignments, at least 50% of aligned columns are additionally RBHs between amino acid embeddings even after filtering RBHs based on uncovering a MNCM (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>A). The correspondence between RBHs and aligned columns is roughly dependent on sequence identity of the alignment (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>B). Thus, protein language models are highly effective in identifying analogous positions across protein sequences. These RBHs are the main input to the vcMSA algorithm.</p>
      <fig position="float" id="GR277675MCWF2">
        <label>Figure 2.</label>
        <caption>
          <p>RBHs and clustered amino acid representations reflect aligned columns. (<italic>A</italic>) For 562 pairs of aligned proteins from the HOMSTRAD database, the MNCMs of RBHs between vector representations frequently correspond to correctly aligned positions. For each gold-standard alignment, we compute the fraction of aligned gold-standard positions that are additionally RBHs after MNCM filtering for that protein pair and display these results as a histogram. (<italic>B</italic>) The proportion of columns in the gold-standard pairwise alignments that are in the MNCM of RBHs is related to sequence identity of the reference alignment. (<italic>C</italic>) Principal components 2 and 3 for amino acid vector representations of 20 cold-shock proteins from the csp protein family. Amino acid representations (<italic>below</italic>) are colored by their corresponding column in the multiple sequence alignment (<italic>above</italic>). (<italic>D</italic>) Identical amino acids in different columns are distinguishable from each other. All glycines in the amino acid PCA plot and the multiple sequence alignment are colored red.</p>
        </caption>
        <graphic xlink:href="1145f02" position="float"/>
      </fig>
    </sec>
    <sec id="s2b">
      <title>Clusters of amino acid representations correspond to columns in the MSA</title>
      <p>When amino acid representations in a PCA are colored by their corresponding column in the MSA, it can be seen that amino acids in the same aligned column cluster together (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>C). We show this correspondence with 20 sequences from the csp protein family using their HOMSTRAD alignment. One initial concern about using amino acid representations for MSA was that the representations of the same amino acid (e.g., glycine) would be too similar wherever that amino acid occurs in the sequence. Instead we find that representations of the same amino acids are distinguishable across the alignment (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>D).</p>
    </sec>
    <sec id="s2c">
      <title>vcMSA produces more accurate alignments than other algorithms, particularly at low sequence identity</title>
      <p>We benchmarked vcMSA on 147 protein alignments consisting of 20 sequences each from the QuanTest2 data set and compared our results to seven alignment algorithms (<xref rid="GR277675MCWF3" ref-type="fig">Fig. 3</xref>A). As the metric to evaluate alignment accuracy, we chose total column score, which measures the number of columns that match the gold-standard alignment, owing to its high dynamic range relative to other metrics. vcMSA generally matches or exceeds the alignment accuracy of other algorithms and performs especially well on the lowest sequence similarity proteins in the benchmark. For example, vcMSA is able to align the Asp_Glu_race_D family with a total column score of 63.9, whereas the maximum score of other alignment methods is 0.9.</p>
      <fig position="float" id="GR277675MCWF3">
        <label>Figure 3.</label>
        <caption>
          <p>vcMSA alignments are frequently more accurate than previous methods, particularly for alignments with low levels of sequence identity. We benchmarked our implementation of vcMSA on sets of 20 sequences from each of 147 gold-standard multiple sequence alignments from the QuanTest2 data set. (<italic>A</italic>) We compare our method to eight state-of-the-art algorithms for sequence alignment. Each point corresponds to one protein MSA and is colored by its sequence identity. Each panel is a tilted scatterplot of relative performance of each other algorithm tested against vcMSA by total column score of produced alignments. Points to the <italic>right</italic> of the vertical dashed line are alignments where vcMSA outperformed the other method. The number of alignments to the <italic>left</italic> or <italic>right</italic> of the line is in gold. vcMSA performs better on more test sets than all other tested algorithms. The point lying on the <italic>right</italic> axis line is the Asp_Glu_race_D alignment, which all other algorithms perform poorly on (TC score ∼0). (<italic>B</italic>) We compare the median total column score of vcMSA alignments to MAFFT-GINSI and Clustal Omega alignments, grouping alignments by sequence identity bins. We observe increased scores for vcMSA at low sequence identities. (<italic>C</italic>) We show median total column scores for structured portions and full gold-standard reference alignments for all algorithms, separated by sequence identity bin.</p>
        </caption>
        <graphic xlink:href="1145f03" position="float"/>
      </fig>
      <p>For low sequence identity alignments, we frequently exceed the alignment accuracy of existing algorithms. In our benchmarking, compared with other methods, we perform notably better on low sequence identity alignments. <xref rid="GR277675MCWF3" ref-type="fig">Figure 3</xref>B illustrates the performance of vcMSA against the two algorithms that score highest and lowest on sequences with identity &lt; 0.2, MAFFT-GINSI and Clustal Omega, respectively. As sequence identity increases, vcMSA generally matches the accuracy of other algorithms. When we compute the total column score for structured portions of the gold-standard alignment compared with the full gold-standard alignment, it is apparent that vcMSA performs better on structured components (<xref rid="GR277675MCWF3" ref-type="fig">Fig. 3</xref>C). Further, vcMSA is specifically strong at structured regions of the lowest identity protein sets. This is likely because of the language model capturing structural properties of these low identity structured regions, even though their sequence identity is beyond the typical twilight zone limit.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>Discussion</title>
    <p>Although sequence aligners were some of the earliest bioinformatic algorithms, and although sequence alignment forms the basis of many computational biology analyses, MSA is not a solved problem. Current sequence alignment algorithms particularly struggle with alignments in the so-called twilight zone of sequence identity, in which structure and function is conserved, but amino acid sequence is not.</p>
    <p>Here, we present vcMSA, a novel algorithm for MSA that diverges substantially from other approaches, and show that it is an improvement on the state of the art for some of the most challenging to align protein families. The ability to create accurate MSAs opens up these low sequence identity families to all the downstream bioinformatics applications that take alignments as input. Notably, the core vcMSA algorithm avoids standard features of the most widely used alignment algorithms, including gap penalties, substitution matrices, and guide trees. Although substitution matrices and gap penalties are standard components of alignment approaches, they are used to formalize optimization criteria and do not reflect fundamental properties of alignments. Instead, aligned amino acids within an MSA are meant to be those that have evolved from a shared ancestral amino acid. Protein language models may be especially suited to identify these analogous amino acids, as they capture structural and functional properties of amino acids via sequence context, much as natural language transformer models capture the semantics of words in a sentence based on other words (<xref rid="GR277675MCWC51" ref-type="bibr">Vaswani et al. 2017</xref>). We find that vcMSA performs particularly well at aligning structured portions of sequences; it is possible that the less well-structured portions of sequences do not have specific functionally analogous positions in other sequences.</p>
    <p>Protein alignment based on protein language representation appears to be most suited to global alignment for sets of protein sequences with similar structure and function, where the underlying meaning of the sequence is as consistent as possible. We have observed that alignment of a small subsequence of a protein (e.g., one domain) to a longer protein is often highly inaccurate, as the contextual embeddings for the small portion are sufficiently different from those computed for the longer protein. To produce the highest quality alignment, outlier sequences can be automatically detected based on sequence embeddings and removed from the alignment process. In these cases, we first use sequence representations to divide sequences into high similarity groups and detect outlier sequences. We then perform vcMSA on each cluster of sequences individually, producing high-quality subalignments. Although we currently use MAFFT-LINSI to combine subalignments produced by vcMSA, we are exploring methods to combine subalignments using purely language models. However, divergence in protein meaning between sequence groups complicates this process.</p>
    <p>Additionally, for alignments in which start positions are not aligned, we find it helpful to add sequence padding to either end of the sequence before embedding, which reduces an observed first character effect, in which the first characters of each sequence tend to have the most similar embeddings, regardless of the sequence context of that first character (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1A</xref>). In these cases, padding can substantially improve correctly aligned columns beyond the first column (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1B</xref>). However, adding padding either substantially degrades or does not change alignment accuracy for protein sets in which the start positions align.</p>
    <p>For certain protein groups, we observe a sequence-specific offset in amino acid embeddings (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1C</xref>), even for sequences with relatively high sequence and structure similarity. On the other hand, we observe that fairly divergent protein sequences can result in embeddings without noticeable sequence-level effects. To reduce sequence specific effects, we consider the amino acids from each sequence as analogous to a batch and remove sequence-specific variation using batch-correction-style techniques (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Reducing sequence-specific effects with batch correction overall improves alignment quality (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1D</xref>). Specifically, between pairs of sequences, batch correction improves the quality of RBHs, particularly for pairs of sequences with cosine similarity less than 0.95 (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1E</xref>). Accordingly, by default, we use batch correction to remove sequence-specific offsets. In some cases, even with correction for sequence-specific offsets, alignment quality is poor. For example, batch correction improves the total column score of neuraminidases from 0.5 to 36.9. However, aligning neuraminidases from <italic>Influenza</italic> A and B separately and then combining subalignments allows a total column score of 64.7. Functional divergence in response to selective pressure in these two neuraminidases likely decreases the similarity of amino acid embeddings. Further research is needed to understand how to recognize and reduce sequence-specific effects when comparing amino acid embeddings across sequences.</p>
    <p>Overall, we find that alignment quality and speed of construction is related to the quality of the RBHs between amino acid embeddings. To improve this network, we use MNCM to remove false-positive RBHs (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 2</xref>). However, it is likely that the RBH network could be improved in multiple ways, including through fine-tuning embeddings, use of other protein language models, and choice of embedding layers. On the other hand, because finding and filtering RBHs is largely effective for removing low similarity spurious matches, our approach is robust to changes in the similarity cutoffs for identifying amino acids to align. We find that alignments improve when merging neighboring columns in the alignment that contain amino acids from mutually exclusive sequences and whose amino acids have a minimal cosine similarity to each other.</p>
    <p>As our implementation is a prototype, we have not substantially optimized our scripts for speed and memory usage, with much room for improvement in these areas. To identify similar amino acid positions at-scale between larger numbers of sequences, we can use tools developed for ultrafast nearest neighbor searches of millions and billions of vectors (<xref rid="GR277675MCWC20" ref-type="bibr">Johnson et al. 2021</xref>). Additionally, our algorithm's runtime is greatly dependent on the number of iterations required to place all amino acids, which is related to the number of clustering errors (when an amino acid is sorted into a cluster that conflicts with the order of amino acids in the sequence). Currently, we use the very basic approach of finding connected components and choosing them to be clusters; we believe that slightly more sophisticated approaches (e.g., those requiring a higher edge density within clusters) would reduce errors in clustering and decrease runtimes.</p>
    <p>Our prototype implementation of the vcMSA algorithm outperforms existing alignment algorithms at aligning a benchmark of sets of proteins. It is particularly successful at aligning groups of low similarity sequences, filling a gap in the capabilities of other algorithms. Another advantage of using amino acid embeddings is that we can additionally score the confidence of each column in the alignment by measuring the average cosine similarity of amino acid embeddings from the same column. This confidence score will allow filtering of alignments to only confidently aligned positions in downstream tasks such as phylogenetic tree building.</p>
    <p>Here, we show both the utility of protein language embeddings in MSA and a new MSA algorithm fully orthogonal to existing approaches. We expect accuracy to only improve with optimal choice of amino acid representations and the development of larger language models that will more richly capture the identity of each amino acid. Overall, we anticipate that protein language models will play an important role in the next generation of methods for determining MSAs.</p>
    <sec id="s3a">
      <title>Software availability</title>
      <p>Our modified version of the nf-benchmark (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>) is available at GitHub (<uri xlink:href="https://github.com/clairemcwhite/nf-benchmark-vcmsa">https://github.com/clairemcwhite/nf-benchmark-vcmsa</uri>). A demonstration colab notebook is available at GitHub (<uri xlink:href="https://github.com/clairemcwhite/vcmsa">https://github.com/clairemcwhite/vcmsa</uri>). Source code is distributed as a Python package vcmsa under an MIT free software license. We recommend obtaining vcmsa and associated files from the GitHub repository (<uri xlink:href="https://github.com/clairemcwhite/vcmsa">https://github.com/clairemcwhite/vcmsa</uri>); however, it is also made available here as <xref rid="SD1" ref-type="supplementary-material">Supplemental Code</xref>. A demonstration Google colab notebook is additionally available at <uri xlink:href="https://colab.research.google.com/drive/1h8WcsMzi8pYr-O3jW03knt7ePcv22o-F">https://colab.research.google.com/drive/1h8WcsMzi8pYr-O3jW03knt7ePcv22o-F</uri>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material id="SD1" position="float" content-type="local-data">
      <label>Supplement 1</label>
      <media xlink:href="Supplemental_code.zip" id="d64e723" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD2" position="float" content-type="local-data">
      <label>Supplement 2</label>
      <media xlink:href="Supplemental_Materials.pdf" id="d64e726" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>C.D.M. acknowledges support from the Lewis-Sigler Institute for Integrative Genomics. M.S. acknowledges support from National Institutes of Health (NIH) R01-GM076275. We thank Joshua Akey for helpful discussions and also thank the Princeton University High Performance Computing Center for providing high-performance computing resources that have contributed to the research results reported in this paper.</p>
    <p><italic>Author contributions:</italic> Conceptualization and algorithmic design were by C.D.M. and M.S. Software implementation and result and figure generation were by C.D.M., with contributions from I.A.-G. C.D.M. and M.S. wrote the manuscript, with contributions from I.A.-G.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link xlink:href="https://www.genome.org/cgi/doi/10.1101/gr.277675.123" ext-link-type="uri">https://www.genome.org/cgi/doi/10.1101/gr.277675.123</ext-link>.</p>
    </fn>
    <fn>
      <p>Freely available online through the <italic>Genome Research</italic> Open Access option.</p>
    </fn>
  </fn-group>
  <sec id="s5">
    <title>Competing interest statement</title>
    <p>The authors declare no competing interests.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="GR277675MCWC1">
      <mixed-citation publication-type="journal"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>. <year>1991</year>. <article-title>Amino acid substitution matrices from an information theoretic perspective</article-title>. <source>J Mol Biol</source><volume>219</volume>: <fpage>555</fpage>–<lpage>565</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(91)90193-A</pub-id><pub-id pub-id-type="pmid">2051488</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC3">
      <mixed-citation publication-type="journal"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><volume>12</volume>: <fpage>654</fpage>–<lpage>669.e3</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2021.05.017</pub-id><pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC4">
      <mixed-citation publication-type="journal"><string-name><surname>Capra</surname><given-names>JA</given-names></string-name>, <string-name><surname>Singh</surname><given-names>M</given-names></string-name>. <year>2007</year>. <article-title>Predicting functionally important residues from sequence conservation</article-title>. <source>Bioinformatics</source><volume>23</volume>: <fpage>1875</fpage>–<lpage>1882</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm270</pub-id><pub-id pub-id-type="pmid">17519246</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC5">
      <mixed-citation publication-type="journal"><string-name><surname>Capra</surname><given-names>JA</given-names></string-name>, <string-name><surname>Singh</surname><given-names>M</given-names></string-name>. <year>2008</year>. <article-title>Characterization and prediction of residues determining protein functional specificity</article-title>. <source>Bioinformatics</source><volume>24</volume>: <fpage>1473</fpage>–<lpage>1480</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn214</pub-id><pub-id pub-id-type="pmid">18450811</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC6">
      <mixed-citation publication-type="journal"><string-name><surname>Chowdhury</surname><given-names>R</given-names></string-name>, <string-name><surname>Bouatta</surname><given-names>N</given-names></string-name>, <string-name><surname>Biswas</surname><given-names>S</given-names></string-name>, <string-name><surname>Floristean</surname><given-names>C</given-names></string-name>, <string-name><surname>Kharkar</surname><given-names>A</given-names></string-name>, <string-name><surname>Roy</surname><given-names>K</given-names></string-name>, <string-name><surname>Rochereau</surname><given-names>C</given-names></string-name>, <string-name><surname>Ahdritz</surname><given-names>G</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Church</surname><given-names>GM</given-names></string-name>, <etal/><year>2022</year>. <article-title>Single-sequence protein structure prediction using a language model and deep learning</article-title>. <source>Nat Biotechnol</source><volume>40</volume>: <fpage>1617</fpage>–<lpage>1623</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01432-w</pub-id><pub-id pub-id-type="pmid">36192636</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC7">
      <mixed-citation publication-type="journal"><string-name><surname>Csardi</surname><given-names>G</given-names></string-name>, <string-name><surname>Nepusz</surname><given-names>T</given-names></string-name>. <year>2006</year>. <article-title>The igraph software package for complex network research</article-title>. <source>Int J Complex Syst</source><volume>1695</volume>: <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC8">
      <mixed-citation publication-type="journal"><string-name><surname>Dayhoff</surname><given-names>MO</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>RM</given-names></string-name>, <string-name><surname>Orcutt</surname><given-names>BC</given-names></string-name>. <year>1978</year>. <article-title>A model of evolutionary change in proteins</article-title>. <source>Atlas Protein Seq Struct</source><volume>5</volume>: <fpage>345</fpage>–<lpage>352</lpage>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC9">
      <mixed-citation publication-type="journal"><string-name><surname>Deorowicz</surname><given-names>S</given-names></string-name>, <string-name><surname>Debudaj-Grabysz</surname><given-names>A</given-names></string-name>, <string-name><surname>Gudyś</surname><given-names>A</given-names></string-name>. <year>2016</year>. <article-title>FAMSA: fast and accurate multiple sequence alignment of huge protein families</article-title>. <source>Sci Rep</source><volume>6</volume>: <fpage>33964</fpage>. <pub-id pub-id-type="doi">10.1038/srep33964</pub-id><pub-id pub-id-type="pmid">27670777</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC10">
      <mixed-citation publication-type="journal"><string-name><surname>Do</surname><given-names>CB</given-names></string-name>, <string-name><surname>Mahabhashyam</surname><given-names>MSP</given-names></string-name>, <string-name><surname>Brudno</surname><given-names>M</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>. <year>2005</year>. <article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>. <source>Genome Res</source><volume>15</volume>: <fpage>330</fpage>–<lpage>340</lpage>. <pub-id pub-id-type="doi">10.1101/gr.2821705</pub-id><pub-id pub-id-type="pmid">15687296</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC11">
      <mixed-citation publication-type="journal"><string-name><surname>Eades</surname><given-names>P</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>WF</given-names></string-name>. <year>1993</year>. <article-title>A fast and effective heuristic for the feedback arc set problem</article-title>. <source>Inf Process Lett</source><volume>47</volume>: <fpage>319</fpage>–<lpage>323</lpage>. <pub-id pub-id-type="doi">10.1016/0020-0190(93)90079-O</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC12">
      <mixed-citation publication-type="journal"><string-name><surname>Edgar</surname><given-names>RC</given-names></string-name>. <year>2004</year>. <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source><volume>5</volume>: <fpage>113</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id><pub-id pub-id-type="pmid">15318951</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC13">
      <mixed-citation publication-type="journal"><string-name><surname>Elnaggar</surname><given-names>A</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Rehawi</surname><given-names>G</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L</given-names></string-name>, <string-name><surname>Gibbs</surname><given-names>T</given-names></string-name>, <string-name><surname>Feher</surname><given-names>T</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>C</given-names></string-name>, <string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <etal/><year>2022</year>. <article-title>ProtTrans: toward understanding the language of life through self-supervised learning</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><volume>44</volume>: <fpage>7112</fpage>–<lpage>7127</lpage>. <pub-id pub-id-type="doi">10.1109/TPAMI.2021.3095381</pub-id><pub-id pub-id-type="pmid">34232869</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC14">
      <mixed-citation publication-type="book"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name>. <year>2004</year>. <source>Inferring phylogenies</source>, <edition>2nd ed.</edition><publisher-name>Sinauer Associates</publisher-name>, <publisher-loc>Sunderland, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC15">
      <mixed-citation publication-type="journal"><string-name><surname>Feng</surname><given-names>D-F</given-names></string-name>, <string-name><surname>Doolittle</surname><given-names>RF</given-names></string-name>. <year>1987</year>. <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>. <source>J Mol Evol</source><volume>25</volume>: <fpage>351</fpage>–<lpage>360</lpage>. <pub-id pub-id-type="doi">10.1007/BF02603120</pub-id><pub-id pub-id-type="pmid">3118049</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC16">
      <mixed-citation publication-type="journal"><string-name><surname>Garriga</surname><given-names>E</given-names></string-name>, <string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Magis</surname><given-names>C</given-names></string-name>, <string-name><surname>Erb</surname><given-names>I</given-names></string-name>, <string-name><surname>Mansouri</surname><given-names>L</given-names></string-name>, <string-name><surname>Baltzis</surname><given-names>A</given-names></string-name>, <string-name><surname>Laayouni</surname><given-names>H</given-names></string-name>, <string-name><surname>Kondrashov</surname><given-names>F</given-names></string-name>, <string-name><surname>Floden</surname><given-names>E</given-names></string-name>, <string-name><surname>Notredame</surname><given-names>C</given-names></string-name>. <year>2019</year>. <article-title>Large multiple sequence alignments with a root-to-leaf regressive method</article-title>. <source>Nat Biotechnol</source><volume>37</volume>: <fpage>1466</fpage>–<lpage>1470</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0333-6</pub-id><pub-id pub-id-type="pmid">31792410</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC17">
      <mixed-citation publication-type="journal"><string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Littmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Sillitoe</surname><given-names>I</given-names></string-name>, <string-name><surname>Bordin</surname><given-names>N</given-names></string-name>, <string-name><surname>Orengo</surname><given-names>C</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2022</year>. <article-title>Contrastive learning on protein embeddings enlightens midnight zone</article-title>. <source>NAR Genom Bioinform</source><volume>4</volume>: <fpage>lqac043</fpage>. <pub-id pub-id-type="doi">10.1093/nargab/lqac043</pub-id><pub-id pub-id-type="pmid">35702380</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC18">
      <mixed-citation publication-type="journal"><string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>JG</given-names></string-name>. <year>1992</year>. <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci</source><volume>89</volume>: <fpage>10915</fpage>–<lpage>10919</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id><pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC20">
      <mixed-citation publication-type="journal"><string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Douze</surname><given-names>M</given-names></string-name>, <string-name><surname>Jégou</surname><given-names>H</given-names></string-name>. <year>2021</year>. <article-title>Billion-scale similarity search with GPUs</article-title>. <source>IEEE Trans Big Data</source><volume>7</volume>: <fpage>535</fpage>–<lpage>547</lpage>. <pub-id pub-id-type="doi">10.1109/TBDATA.2019.2921572</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC21">
      <mixed-citation publication-type="journal"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name>, <string-name><surname>Green</surname><given-names>T</given-names></string-name>, <string-name><surname>Figurnov</surname><given-names>M</given-names></string-name>, <string-name><surname>Ronneberger</surname><given-names>O</given-names></string-name>, <string-name><surname>Tunyasuvunakool</surname><given-names>K</given-names></string-name>, <string-name><surname>Bates</surname><given-names>R</given-names></string-name>, <string-name><surname>Žídek</surname><given-names>A</given-names></string-name>, <string-name><surname>Potapenko</surname><given-names>A</given-names></string-name>, <etal/><year>2021</year>. <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><volume>596</volume>: <fpage>583</fpage>–<lpage>589</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC22">
      <mixed-citation publication-type="journal"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>1983</year>. <article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>. <source>Biopolymers</source><volume>22</volume>: <fpage>2577</fpage>–<lpage>2637</lpage>. <pub-id pub-id-type="doi">10.1002/bip.360221211</pub-id><pub-id pub-id-type="pmid">6667333</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC23">
      <mixed-citation publication-type="journal"><string-name><surname>Katoh</surname><given-names>K</given-names></string-name>, <string-name><surname>Standley</surname><given-names>DM</given-names></string-name>. <year>2013</year>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source><volume>30</volume>: <fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC24">
      <mixed-citation publication-type="journal"><string-name><surname>Katoh</surname><given-names>K</given-names></string-name>, <string-name><surname>Toh</surname><given-names>H</given-names></string-name>. <year>2007</year>. <article-title>PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences</article-title>. <source>Bioinformatics</source><volume>23</volume>: <fpage>372</fpage>–<lpage>374</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl592</pub-id><pub-id pub-id-type="pmid">17118958</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC25">
      <mixed-citation publication-type="journal"><string-name><surname>Littmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Weissenow</surname><given-names>K</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Protein embeddings and deep learning predict binding residues for various ligand classes</article-title>. <source>Sci Rep</source><volume>11</volume>: <fpage>23916</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-021-03431-4</pub-id><pub-id pub-id-type="pmid">34903827</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC26">
      <mixed-citation publication-type="journal"><string-name><surname>Liu</surname><given-names>K</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Holder</surname><given-names>MT</given-names></string-name>, <string-name><surname>Nelesen</surname><given-names>SM</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>AP</given-names></string-name>, <string-name><surname>Linder</surname><given-names>CR</given-names></string-name>. <year>2012</year>. <article-title>SATé-II: very fast and accurate simultaneous estimation of multiple sequence alignments and phylogenetic trees</article-title>. <source>Syst Biol</source><volume>61</volume>: <fpage>90</fpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syr095</pub-id><pub-id pub-id-type="pmid">22139466</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC27">
      <mixed-citation publication-type="journal"><string-name><surname>Malucelli</surname><given-names>F</given-names></string-name>, <string-name><surname>Ottmann</surname><given-names>T</given-names></string-name>, <string-name><surname>Pretolani</surname><given-names>D</given-names></string-name>. <year>1993</year>. <article-title>Efficient labelling algorithms for the maximum noncrossing matching problem</article-title>. <source>Discrete Appl Math</source><volume>47</volume>: <fpage>175</fpage>–<lpage>179</lpage>. <pub-id pub-id-type="doi">10.1016/0166-218X(93)90090-B</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC28">
      <mixed-citation publication-type="journal"><string-name><surname>Marks</surname><given-names>DS</given-names></string-name>, <string-name><surname>Colwell</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Sheridan</surname><given-names>R</given-names></string-name>, <string-name><surname>Hopf</surname><given-names>TA</given-names></string-name>, <string-name><surname>Pagnani</surname><given-names>A</given-names></string-name>, <string-name><surname>Zecchina</surname><given-names>R</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>2011</year>. <article-title>Protein 3D structure computed from evolutionary sequence variation</article-title>. <source>PLoS One</source><volume>6</volume>: <fpage>e28766</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0028766</pub-id><pub-id pub-id-type="pmid">22163331</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC29">
      <mixed-citation publication-type="journal"><string-name><surname>Marquet</surname><given-names>C</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Olenyi</surname><given-names>T</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Erckert</surname><given-names>K</given-names></string-name>, <string-name><surname>Bernhofer</surname><given-names>M</given-names></string-name>, <string-name><surname>Nechaev</surname><given-names>D</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2022</year>. <article-title>Embeddings from protein language models predict conservation and variant effects</article-title>. <source>Hum Genet</source><volume>141</volume>: <fpage>1629</fpage>–<lpage>1647</lpage>. <pub-id pub-id-type="doi">10.1007/s00439-021-02411-y</pub-id><pub-id pub-id-type="pmid">34967936</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC30">
      <mixed-citation publication-type="journal"><string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>N</given-names></string-name>, <string-name><surname>Guo</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L-S</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2015</year>. <article-title>PASTA: ultra-large multiple sequence alignment for nucleotide and amino-acid sequences</article-title>. <source>J Comput Biol</source><volume>22</volume>: <fpage>377</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2014.0156</pub-id><pub-id pub-id-type="pmid">25549288</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC31">
      <mixed-citation publication-type="journal"><string-name><surname>Miyata</surname><given-names>T</given-names></string-name>, <string-name><surname>Yasunaga</surname><given-names>T</given-names></string-name>. <year>1980</year>. <article-title>Molecular evolution of mRNA: a method for estimating evolutionary rates of synonymous and amino acid substitutions from homologous nucleotide sequences and its application</article-title>. <source>J Mol Evol</source><volume>16</volume>: <fpage>23</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1007/BF01732067</pub-id><pub-id pub-id-type="pmid">6449605</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC32">
      <mixed-citation publication-type="journal"><string-name><surname>Morgenstern</surname><given-names>B</given-names></string-name>, <string-name><surname>Prohaska</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Pöhler</surname><given-names>D</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF</given-names></string-name>. <year>2006</year>. <article-title>Multiple sequence alignment with user-defined anchor points</article-title>. <source>Algorithms Mol Biol</source><volume>1</volume>: <fpage>6</fpage>. <pub-id pub-id-type="doi">10.1186/1748-7188-1-6</pub-id><pub-id pub-id-type="pmid">16722533</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC33">
      <mixed-citation publication-type="other"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Strauss</surname><given-names>CEM</given-names></string-name>, <string-name><surname>Blackwell</surname><given-names>R</given-names></string-name>, <string-name><surname>Berenberg</surname><given-names>D</given-names></string-name>, <string-name><surname>Gligorijevic</surname><given-names>V</given-names></string-name>, <string-name><surname>Bonneau</surname><given-names>R</given-names></string-name>. <year>2020</year>. <article-title>Protein structural alignments from sequence</article-title>. <source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.03.365932</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC34">
      <mixed-citation publication-type="journal"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD</given-names></string-name>. <year>1970</year>. <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source><volume>48</volume>: <fpage>443</fpage>–<lpage>453</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id><pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC35">
      <mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname><given-names>ND</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>K</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2015</year>. <article-title>Ultra-large alignments using phylogeny-aware profiles</article-title>. <source>Genome Biol</source><volume>16</volume>: <fpage>124</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0688-z</pub-id><pub-id pub-id-type="pmid">26076734</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC36">
      <mixed-citation publication-type="journal"><string-name><surname>Notredame</surname><given-names>C</given-names></string-name>, <string-name><surname>Holm</surname><given-names>L</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>. <year>1998</year>. <article-title>COFFEE: an objective function for multiple sequence alignments</article-title>. <source>Bioinformatics</source><volume>14</volume>: <fpage>407</fpage>–<lpage>422</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/14.5.407</pub-id><pub-id pub-id-type="pmid">9682054</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC37">
      <mixed-citation publication-type="journal"><string-name><surname>Notredame</surname><given-names>C</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>, <string-name><surname>Heringa</surname><given-names>J</given-names></string-name>. <year>2000</year>. <article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source><volume>302</volume>: <fpage>205</fpage>–<lpage>217</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC38">
      <mixed-citation publication-type="journal"><string-name><surname>Nute</surname><given-names>M</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>E</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2019</year>. <article-title>Evaluating statistical multiple sequence alignment in comparison to other alignment methods on protein data sets</article-title>. <source>Syst Biol</source><volume>68</volume>: <fpage>396</fpage>–<lpage>411</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syy068</pub-id><pub-id pub-id-type="pmid">30329135</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC39">
      <mixed-citation publication-type="journal"><string-name><surname>Petti</surname><given-names>S</given-names></string-name>, <string-name><surname>Bhattacharya</surname><given-names>N</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name>, <string-name><surname>Dauparas</surname><given-names>J</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>N</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Rush</surname><given-names>AM</given-names></string-name>, <string-name><surname>Koo</surname><given-names>PK</given-names></string-name>, <string-name><surname>Ovchinnikov</surname><given-names>S</given-names></string-name>. <year>2023</year>. <article-title>End-to-end learning of multiple sequence alignments with differentiable Smith–Waterman</article-title>. <source>Bioinformatics</source><volume>39</volume>: <fpage>btac724</fpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btac724</pub-id><pub-id pub-id-type="pmid">36355460</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC40">
      <mixed-citation publication-type="journal"><string-name><surname>Pitschi</surname><given-names>F</given-names></string-name>, <string-name><surname>Devauchelle</surname><given-names>C</given-names></string-name>, <string-name><surname>Corel</surname><given-names>E</given-names></string-name>. <year>2010</year>. <article-title>Automatic detection of anchor points for multiple sequence alignment</article-title>. <source>BMC Bioinformatics</source><volume>11</volume>: <fpage>445</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-445</pub-id><pub-id pub-id-type="pmid">20813050</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC41">
      <mixed-citation publication-type="journal"><string-name><surname>Rao</surname><given-names>R</given-names></string-name>, <string-name><surname>Bhattacharya</surname><given-names>N</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>N</given-names></string-name>, <string-name><surname>Duan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Canny</surname><given-names>J</given-names></string-name>, <string-name><surname>Abbeel</surname><given-names>P</given-names></string-name>, <string-name><surname>Song</surname><given-names>YS</given-names></string-name>. <year>2019</year>. <article-title>Evaluating protein transfer learning with TAPE</article-title>. <source>Adv Neural Inf Process Syst</source><volume>32</volume>: <fpage>9689</fpage>–<lpage>9701</lpage>.<pub-id pub-id-type="pmid">33390682</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC42">
      <mixed-citation publication-type="journal"><string-name><surname>Rives</surname><given-names>A</given-names></string-name>, <string-name><surname>Meier</surname><given-names>J</given-names></string-name>, <string-name><surname>Sercu</surname><given-names>T</given-names></string-name>, <string-name><surname>Goyal</surname><given-names>S</given-names></string-name>, <string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>D</given-names></string-name>, <string-name><surname>Ott</surname><given-names>M</given-names></string-name>, <string-name><surname>Zitnick</surname><given-names>CL</given-names></string-name>, <string-name><surname>Ma</surname><given-names>J</given-names></string-name>, <etal/><year>2021</year>. <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>. <source>Proc Natl Acad Sci</source><volume>118</volume>: <fpage>e2016239118</fpage>. <pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id><pub-id pub-id-type="pmid">33876751</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC43">
      <mixed-citation publication-type="journal"><string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>1999</year>. <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Eng</source><volume>12</volume>: <fpage>85</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1093/protein/12.2.85</pub-id><pub-id pub-id-type="pmid">10195279</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC44">
      <mixed-citation publication-type="journal"><string-name><surname>Rost</surname><given-names>B</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>1994</year>. <article-title>Combining evolutionary information and neural networks to predict protein secondary structure</article-title>. <source>Proteins</source><volume>19</volume>: <fpage>55</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1002/prot.340190108</pub-id><pub-id pub-id-type="pmid">8066087</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC45">
      <mixed-citation publication-type="journal"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>. <year>2020</year>. <article-title>QuanTest2: benchmarking multiple sequence alignments using secondary structure prediction</article-title>. <source>Bioinformatics</source><volume>36</volume>: <fpage>90</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz552</pub-id><pub-id pub-id-type="pmid">31292629</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC46">
      <mixed-citation publication-type="journal"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Wilm</surname><given-names>A</given-names></string-name>, <string-name><surname>Dineen</surname><given-names>D</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Karplus</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>McWilliam</surname><given-names>H</given-names></string-name>, <string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name>, <etal/><year>2011</year>. <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using clustal omega</article-title>. <source>Mol Syst Biol</source><volume>7</volume>: <fpage>539</fpage>. <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id><pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC47">
      <mixed-citation publication-type="journal"><string-name><surname>Smith</surname><given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname><given-names>MS</given-names></string-name>. <year>1981</year>. <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source><volume>147</volume>: <fpage>195</fpage>–<lpage>197</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id><pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC48">
      <mixed-citation publication-type="journal"><string-name><surname>Sonnhammer</surname><given-names>ELL</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E</given-names></string-name>, <string-name><surname>Bateman</surname><given-names>A</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>1998</year>. <article-title>Pfam: multiple sequence alignments and HMM-profiles of protein domains</article-title>. <source>Nucleic Acids Res</source><volume>26</volume>: <fpage>320</fpage>–<lpage>322</lpage>. <pub-id pub-id-type="doi">10.1093/nar/26.1.320</pub-id><pub-id pub-id-type="pmid">9399864</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC49">
      <mixed-citation publication-type="journal"><string-name><surname>Stärk</surname><given-names>H</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Light attention predicts protein location from the language of life</article-title>. <source>Bioinforma Adv</source><volume>1</volume>: <fpage>vbab035</fpage>. <pub-id pub-id-type="doi">10.1093/bioadv/vbab035</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC50">
      <mixed-citation publication-type="journal"><string-name><surname>Stebbings</surname><given-names>LA</given-names></string-name>, <string-name><surname>Mizuguchi</surname><given-names>K</given-names></string-name>. <year>2004</year>. <article-title>HOMSTRAD: recent developments of the Homologous Protein Structure Alignment Database</article-title>. <source>Nucleic Acids Res</source><volume>32</volume>: <fpage>D203</fpage>–<lpage>D207</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh027</pub-id><pub-id pub-id-type="pmid">14681395</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC51">
      <mixed-citation publication-type="book"><string-name><surname>Vaswani</surname><given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N</given-names></string-name>, <string-name><surname>Uszkoreit</surname><given-names>J</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L</given-names></string-name>, <string-name><surname>Gomez</surname><given-names>AN</given-names></string-name>, <string-name><surname>Kaiser</surname><given-names>Ł</given-names></string-name>, <string-name><surname>Polosukhin</surname><given-names>I</given-names></string-name>. <year>2017</year>. <article-title>Attention is all you need</article-title>. <source>Advances in neural information processing systems. In Proceedings of the 31st international conference on neural information processing systems (NIPS'17)</source>, pp. <fpage>6000</fpage>–<lpage>6010</lpage>. <publisher-name>Curran Associates Inc.</publisher-name>, <publisher-loc>Red Hook, NY</publisher-loc>. <pub-id pub-id-type="doi">10.5555/3295222.3295349</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10538487</article-id>
    <article-id pub-id-type="pmid">37414576</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.277675.123</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Leveraging protein language models for accurate multiple sequence alignments</article-title>
      <alt-title alt-title-type="left-running">McWhite et al.</alt-title>
      <alt-title alt-title-type="right-running">Leveraging protein language for alignment</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7346-3047</contrib-id>
        <name>
          <surname>McWhite</surname>
          <given-names>Claire D.</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6332-3750</contrib-id>
        <name>
          <surname>Armour-Garb</surname>
          <given-names>Isabel</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8271-6026</contrib-id>
        <name>
          <surname>Singh</surname>
          <given-names>Mona</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey 08544, USA;</aff>
    <aff id="af2"><label>2</label>Department of Computer Science, Princeton University, Princeton, New Jersey 08544, USA</aff>
    <author-notes>
      <corresp>Corresponding authors: <email>cmcwhite@princeton.edu</email>, <email>mona@cs.princeton.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <volume>33</volume>
    <issue>7</issue>
    <fpage>1145</fpage>
    <lpage>1153</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml" ext-link-type="uri">© 2023 McWhite et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This article, published in <italic>Genome Research</italic>, is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1145.pdf"/>
    <abstract>
      <p>Multiple sequence alignment (MSA) is a critical step in the study of protein sequence and function. Typically, MSA algorithms progressively align pairs of sequences and combine these alignments with the aid of a guide tree. These alignment algorithms use scoring systems based on substitution matrices to measure amino acid similarities. Although successful, standard methods struggle on sets of proteins with low sequence identity: the so-called twilight zone of protein alignment. For these difficult cases, another source of information is needed. Protein language models are a powerful new approach that leverages massive sequence data sets to produce high-dimensional contextual embeddings for each amino acid in a sequence. These embeddings have been shown to reflect physicochemical and higher-order structural and functional attributes of amino acids within proteins. Here, we present a novel approach to MSA, based on clustering and ordering amino acid contextual embeddings. Our method for aligning semantically consistent groups of proteins circumvents the need for many standard components of MSA algorithms, avoiding initial guide tree construction, intermediate pairwise alignments, gap penalties, and substitution matrices. The added information from contextual embeddings leads to higher accuracy alignments for structurally similar proteins with low amino-acid similarity. We anticipate that protein language models will become a fundamental component of the next generation of algorithms for generating MSAs.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health </institution>
            <institution-id institution-id-type="doi">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM076275</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignments (MSAs) underlie much of sequence analysis in computational biology. Protein MSAs are the main input to algorithms for reconstructing gene and species trees (<xref rid="GR277675MCWC14" ref-type="bibr">Felsenstein 2004</xref>); for identifying conserved (<xref rid="GR277675MCWC4" ref-type="bibr">Capra and Singh 2007</xref>), co-evolving (<xref rid="GR277675MCWC28" ref-type="bibr">Marks et al. 2011</xref>), specificity-determining (<xref rid="GR277675MCWC5" ref-type="bibr">Capra and Singh 2008</xref>), and positively selected sites (<xref rid="GR277675MCWC31" ref-type="bibr">Miyata and Yasunaga 1980</xref>); for building protein motif and domain representations (<xref rid="GR277675MCWC48" ref-type="bibr">Sonnhammer et al. 1998</xref>); and for predicting de novo protein structural features (<xref rid="GR277675MCWC44" ref-type="bibr">Rost and Sander 1994</xref>) and full protein structure prediction (<xref rid="GR277675MCWC21" ref-type="bibr">Jumper et al. 2021</xref>). Highly accurate MSAs are necessary, as misaligned amino acids can lead to incorrect inferences for this wide range of downstream tasks. However, when the average sequence identity among the sequences to be aligned is low, most MSA methods struggle to obtain high-quality alignments (<xref rid="GR277675MCWC38" ref-type="bibr">Nute et al. 2019</xref>); sequence identity below 20%–35% has been termed the “twilight zone” of alignment (<xref rid="GR277675MCWC43" ref-type="bibr">Rost 1999</xref>).</p>
  <p>Over the past 40 years, numerous algorithms for obtaining MSAs have been developed and refined, including CLUSTAL (<xref rid="GR277675MCWC46" ref-type="bibr">Sievers et al. 2011</xref>), MAFFT (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), Muscle (<xref rid="GR277675MCWC12" ref-type="bibr">Edgar 2004</xref>), T-Coffee (<xref rid="GR277675MCWC37" ref-type="bibr">Notredame et al. 2000</xref>), ProbCons (<xref rid="GR277675MCWC10" ref-type="bibr">Do et al. 2005</xref>), Saté (<xref rid="GR277675MCWC26" ref-type="bibr">Liu et al. 2012</xref>), and PASTA (<xref rid="GR277675MCWC30" ref-type="bibr">Mirarab et al. 2015</xref>), among others. The predominant approach to align multiple sequences is to first align pairs of sequences and then progressively combine these subalignments into larger alignments in an order determined by a guide tree (<xref rid="GR277675MCWC15" ref-type="bibr">Feng and Doolittle 1987</xref>). Pairwise alignment algorithms (<xref rid="GR277675MCWC34" ref-type="bibr">Needleman and Wunsch 1970</xref>; <xref rid="GR277675MCWC47" ref-type="bibr">Smith and Waterman 1981</xref>) uncover a highest scoring alignment between two sequences when given a similarity measure between all pairs of amino acids and a gap penalty function. Similarities between each pair of the 20 amino acids are typically based upon substitution matrices that encapsulate the frequency with which amino acid pairs are observed in equivalent positions across large data sets of alignments of homologous sequences (<xref rid="GR277675MCWC8" ref-type="bibr">Dayhoff et al. 1978</xref>; <xref rid="GR277675MCWC1" ref-type="bibr">Altschul 1991</xref>; <xref rid="GR277675MCWC18" ref-type="bibr">Henikoff and Henikoff 1992</xref>). Although in theory optimal pairwise alignment algorithms can be adapted to multiple sequences, the runtime would be exponential in the number of sequences, and further, it is not clear how to score multiple amino acids in a single aligned column. Instead, guide tree–based MSA approaches are heuristics that optimally combine pairs of alignments in which the similarity of a pair of columns in two different alignments is computed based on substitution matrix scores of the amino acids within the columns. Alternatively, consistency-based progressive MSA approaches use similarity scores that consider how frequently pairs of amino acids in two different sequences are aligned to the same amino acid position in other sequences when considering optimal pairwise alignments (<xref rid="GR277675MCWC36" ref-type="bibr">Notredame et al. 1998</xref>, <xref rid="GR277675MCWC37" ref-type="bibr">2000</xref>).</p>
  <p>Here, we consider a new approach to determining the similarities between amino acids across proteins, based on protein language models (<xref rid="GR277675MCWC41" ref-type="bibr">Rao et al. 2019</xref>; <xref rid="GR277675MCWC3" ref-type="bibr">Bepler and Berger 2021</xref>; <xref rid="GR277675MCWC42" ref-type="bibr">Rives et al. 2021</xref>; <xref rid="GR277675MCWC6" ref-type="bibr">Chowdhury et al. 2022</xref>; <xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). Protein language models are “self-supervised” deep learning language models that have been pretrained on large compendia of protein sequences, generally trained to predict “masked” amino acids within input protein sequences based on the rest of the sequence. Once trained, these models embed each amino acid within a protein sequence as a high-dimensional vector, and importantly, these vectors capture the sequence “context” of each amino acid. Machine learning models using these embeddings have been successfully trained to predict many protein structural and functional features, including conservation (<xref rid="GR277675MCWC29" ref-type="bibr">Marquet et al. 2022</xref>), ligand binding (<xref rid="GR277675MCWC25" ref-type="bibr">Littmann et al. 2021</xref>), homology (<xref rid="GR277675MCWC42" ref-type="bibr">Rives et al. 2021</xref>; <xref rid="GR277675MCWC17" ref-type="bibr">Heinzinger et al. 2022</xref>), and subcellular localization (<xref rid="GR277675MCWC49" ref-type="bibr">Stärk et al. 2021</xref>). Because amino acids at equivalent positions in two different protein sequences play the same structural and functional role, we reasoned that clustering amino acid context vectors across sequences could be the basis of a new approach for aligning sequences. Although recently neural network machinery has been leveraged to perform dynamic program-based alignments (<xref rid="GR277675MCWC33" ref-type="bibr">Morton et al. 2020</xref>; <xref rid="GR277675MCWC39" ref-type="bibr">Petti et al. 2023</xref>), our approach is, to the best of our knowledge, the first that uses protein sequence embeddings to identify analogous positions across protein sequences in order to determine MSAs. Our MSA approach is based on clustering the amino acid contextual vectors produced by protein language models and then using graph-theoretic approaches to determine a consistent ordering of MSA columns. Our method, <underline>v</underline>ector-<underline>c</underline>lustering <underline>M</underline>ultiple <underline>S</underline>equence <underline>A</underline>lignment (vcMSA), is a true multiple sequence aligner that aligns multiple sequences at once instead of progressively integrating pairwise alignments. Our core methodology diverges from standard MSA methods in that it avoids substitution matrices and gap penalties, and in most cases, does not use guide tree construction. In proof-of-concept testing, we aim to establish the power of leveraging protein language models for building MSAs, particularly for low identity sequence families that current methods have the most difficulty on.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <sec id="s1a">
      <title>Overview</title>
      <p>A brief overview of our algorithm is as follows. First, for all protein sequences, we obtain per-position and sequence-level embeddings via a protein language model (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>A). Second, we cluster protein sequences via the sequence-level embeddings to uncover sets of sequence-similar proteins (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>B). Third, within each cluster of sequences, we measure the similarities of amino acid vectors and, for each amino acid, find the one that is most similar to it in each of the other sequences (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>C) and filter to amino acid pairings that are reciprocal best hits (RBHs) of each other. Fourth, we build an RBH network and cluster the network to find “guidepost” amino acid positions in different sequences that are clearly aligned to each other (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>D). Fifth, we order the clusters into columns of the MSA by constructing a directed acyclic graph (DAG) based on sequential positions within each protein sequence and performing a topological sort (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>E). Sixth, we use guidepost clusters to limit the scope of searches for the remaining unplaced amino acids (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). Seventh, we continue creating guideposts and assigning amino acids to columns until all amino acids are placed in the alignment (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>G). Finally, we combine subalignments from the sequence clusters into the final MSA (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>H). Further details about each of these steps are provided below.</p>
      <fig position="float" id="GR277675MCWF1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of vcMSA algorithm. (<italic>A</italic>) Proteins are embedded using a protein language model to produce vector representations of each amino acid, and the mean of these amino acid embeddings is taken to produce a sequence-level representation. (<italic>B</italic>) We cluster sequence representations and detect outlier sequences. (<italic>C</italic>) For each sequence cluster, we determine bidirectional/reciprocal best hits (RBHs) of cosine similarity between pairs of amino acids in different sequences. (<italic>D</italic>) From a network built from RBHs, we determine confident clusters of amino acids, corresponding to columns in the MSA. (<italic>E</italic>) To determine column order, we trace the path of each sequence through clusters and combine all paths into one network, taking edge weights from the number of sequences that traverse between the pairs of clusters. We trim any clusters that cause cycles and use a topological sort of the resulting directed acyclic graph to find column order. (<italic>F</italic>) Clusters/columns limit scope of search for unplaced amino acids. (<italic>G</italic>) We iterate limited searches until all amino acids are placed. Gaps in the alignment occur when a cluster does not contain an amino acid from a sequence. (<italic>H</italic>) We combine alignments from each sequence cluster and outliers in the final output MSA.</p>
        </caption>
        <graphic xlink:href="1145f01" position="float"/>
      </fig>
    </sec>
    <sec id="s1b">
      <title>Embedding generation</title>
      <p>For each protein sequence, we use the encoder portion of the ProtT5-XL-UniRef50 language model to generate sequence embeddings (<xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). T5 models undergo self-supervised training on a large corpus of text, in this case over 11 million protein sequences in the UniRef50 data set (<xref rid="GR277675MCWC13" ref-type="bibr">Elnaggar et al. 2022</xref>). For each amino acid in a sequence, the ProtT5-XL-UniRef50 model produces one embedding vector of length 1024 for each of its 24 encoder layers. We choose to use embeddings from the final 16 layers, giving us a final vector representation of each amino acid with dimension 16,384. For each sequence, we average all of the vector embeddings for each of its amino acids to obtain a sequence-level embedding. We additionally add padding to sequences, where we first add 10 X's to the start and end of each sequence before embedding (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1A</xref>).</p>
    </sec>
    <sec id="s1c">
      <title>Sequence clustering</title>
      <p>We find that vcMSA performs best on semantically consistent sets of sequences and that performance is degraded when outlier sequences are included. Therefore, we first cluster input sequences based on sequence-level embeddings to obtain groups of similar sequences and detect outliers (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). We then apply the remaining steps of vcMSA to each cluster of sequences individually. Left out sequences and alignments for clusters are merged into a full alignment as described below.</p>
    </sec>
    <sec id="s1d">
      <title>Amino acid similarity across sequences</title>
      <p>The contextual similarity between a pair of amino acids is defined as the cosine similarity between their embedding vectors. To reduce sequence-specific effects and increase the overall similarity between different sequences, we first apply “batch correction” to amino acid embeddings in the same sequence cluster, considering each sequence as analogous to a batch (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1C</xref>; <xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). For each amino acid in each sequence, we next find the most similar amino acid in each of the other sequences by considering cosine similarities between their embeddings. We use Facebook's fast AI similarity search (faiss) library to perform nearest neighbor searches for all amino acids (<xref rid="GR277675MCWC20" ref-type="bibr">Johnson et al. 2021</xref>). For each pair of sequences, the set of pairwise similarities between amino acids between different sequences is filtered to only RBHs, for which the best match to a query amino acid in the target sequence must also have its highest score in the query sequence be the query amino acid (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>C). For each pair of sequences, we construct a bipartite graph composed of nodes for each amino acid in the two sequences, with an edge for each RBH identified between amino acids in the two sequences. We will keep a largest set of these RBHs that are “consistent” with each other in a pairwise alignment using a maximum noncrossing matching (MNCM) formulation (<xref rid="GR277675MCWC27" ref-type="bibr">Malucelli et al. 1993</xref>). In particular, if the <italic>i</italic>th and <italic>j</italic>th amino acids in the first sequence (we assume without loss of generality that <italic>i</italic> &lt; <italic>j)</italic> have as their RBHs the <italic>k</italic>th and <italic>l</italic>th amino acids, respectively, in the second sequence, then this pair of RBHs is consistent only if <italic>k</italic> &lt; <italic>l</italic>; that is, if <italic>k</italic> &lt; <italic>l</italic>, it is possible for a pairwise alignment between these two sequences to simultaneously align the <italic>i</italic>th and <italic>j</italic>th amino acids in the first sequence with the <italic>k</italic>th and <italic>l</italic>th amino acids in the second sequence. If two pairs of RBHs are not consistent with each other, we say that the edges that correspond to them “intersect,” as they would if the nodes were arranged in two columns (one for each sequence) in the order in which they appear in the sequences. We define a noncrossing matching to be a selection of edges such that no two edges intersect, and an MNCM to be the largest possible set of such edges. In the case that there are multiple MNCMs, we select the MNCM that has the highest average cosine similarity score between all RBHs in the matching. We remove from consideration any RBHs that are not part of this MNCM; in this manner, we obtain a filtered set of RBHs across all pairs of sequences. MNCM performs well in preserving RBHs corresponding to correctly aligned amino acid pairs, while removing false-positive matches (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 2</xref>).</p>
    </sec>
    <sec id="s1e">
      <title>Amino acid clustering</title>
      <p>We build a network in which there is a node for each amino acid in each sequence, and there is an edge between two nodes if the corresponding amino acids are RBHs included in the filtered set of RBHs. We use this network of RBHs in order to cluster sets of amino acids that align to each other with high confidence (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>D; <xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Amino acids within a cluster will comprise a column in the MSA. We term these aligned positions guideposts and will use these guidepost columns to limit the scope of future searches for amino acids that align to each other (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). Our guidepost columns are similar to user-defined or automatically inferred “anchor points” that have been used in the past to constrain traditional MSA approaches (<xref rid="GR277675MCWC32" ref-type="bibr">Morgenstern et al. 2006</xref>; <xref rid="GR277675MCWC40" ref-type="bibr">Pitschi et al. 2010</xref>).</p>
    </sec>
    <sec id="s1f">
      <title>Column order determination</title>
      <p>Each cluster corresponds to a column of the MSA; however, these columns must be placed in the correct order in the alignment that is being built. To do this, we will first build a graph based on the correct ordering of amino acids in each protein sequence and then prune this graph to be a DAG and perform a topological sort of this graph (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>E). In particular, we will introduce a node for each cluster. Next, for clusters <italic>A</italic> and <italic>B</italic>, if there exists amino acids <italic>u</italic> ∈ <italic>A</italic> and <italic>v</italic> ∈ <italic>B</italic> where <italic>u</italic> and <italic>v</italic> are in the same sequence, <italic>u</italic> is before <italic>v</italic> in the sequence, and <italic>v</italic> is the first clustered amino acid after <italic>u</italic> in the sequence, then we will add a directed edge from <italic>u</italic> to <italic>v</italic>. This edge will be weighted by the number of sequences in which such <italic>u</italic> and <italic>v</italic> exist. Out-of-order amino acids, in which an amino acid is placed in a cluster that occurs too late or too early in the MSA, will cause cycles in this directed graph. To remove these out-of-order amino acids, we detect feedback arc sets (<xref rid="GR277675MCWC11" ref-type="bibr">Eades et al. 1993</xref>; <xref rid="GR277675MCWC7" ref-type="bibr">Csardi and Nepusz 2006</xref>), finding edges to remove to obtain an acyclic graph and prioritizing edges with low weight for removal. Because feedback arc set detection is NP-complete, we use the linear time heuristic approach of <xref rid="GR277675MCWC11" ref-type="bibr">Eades et al. (1993)</xref>. Feedback arc set detection has been previously used in MSA to enforce order consistency for multiple local areas of alignment (<xref rid="GR277675MCWC40" ref-type="bibr">Pitschi et al. 2010</xref>).</p>
      <p>For each node-pair of each feedback arc, we discard the node/cluster ID with lowest total edge weight and finally confirm that the trimmed network is a DAG. We then perform a topological sort of the graph to obtain an ordered path that visits every node (cluster ID). This sequence of cluster IDs is the order of columns in the MSA.</p>
    </sec>
    <sec id="s1g">
      <title>Limited scope searches</title>
      <p>At this stage, we have a subset of guidepost columns in the alignment, as well as sets of amino acids that have not been assigned to any column (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>F). If an unassigned amino acid occurs after an amino acid that has been assigned to column <italic>p</italic> and before an amino acid that has been assigned to column <italic>q</italic>, we only need to consider amino acids from other sequences that also fall between <italic>p</italic> and <italic>q</italic> as candidate matches.</p>
      <p>We repeatedly alternate two phases of adding amino acids into the alignment until there are no remaining unplaced amino acids with cosine similarity &gt; 0.1 to any potential match amino acid in the scope. Our two phases are (1) create new columns by amino acid clustering, as described above, among all amino acids also falling between the appropriate guideposts and (2) add amino acids into existing columns by best match score (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Existing columns can only be modified during the second phase with the addition of new members. In early iterations following clustering stages, we remove clusters in which any member of the cluster is “stranded,” meaning that neither of its previous or next amino acids is found in the previous and next aligned column/cluster. This quality-control step prevents early errors in which an amino acid is placed in the wrong cluster. For the final stage, amino acids with no matches to any clusters or other amino acids in the scope are placed in their own cluster of size one.</p>
    </sec>
    <sec id="s1h">
      <title>Gaps</title>
      <p>Our method does not require parameters related to setting gaps. Once all amino acids are assigned to columns, we lay out the final alignment (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>G). A column that has one amino acid from every sequence has no gaps. If a column does not contain an amino acid from a particular sequence, a gap is left for that sequence in that column. Our algorithm therefore does not need to use gap opening or gap extension parameters, which are required by other methods.</p>
    </sec>
    <sec id="s1i">
      <title>Merging excess partitions over neighboring columns</title>
      <p>We observe cases in which two adjacent columns contain amino acids from a mutually exclusive set of sequences. We detect and merge these paired columns using a low threshold cosine similarity score of 0.1 between amino acids in adjacent clusters, on the basis that independent insertions of one amino acid at the site are biologically unlikely.</p>
    </sec>
    <sec id="s1j">
      <title>Benchmarking</title>
      <p>We use the QuanTest2 (<xref rid="GR277675MCWC45" ref-type="bibr">Sievers and Higgins 2020</xref>) reference alignment data set, which consists of 151 protein sets, each composed of 1000 proteins. The QuanTest2 alignment set is a subset of the HOMSTRAD (<xref rid="GR277675MCWC50" ref-type="bibr">Stebbings and Mizuguchi 2004</xref>) database of curated structure alignments. We use HOMSTRAD alignments that are not included in the QuanTest2 set to evaluate correspondence between RBH pairs of amino acids and aligned positions. We modified the nextflow pipeline nf-benchmark (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>) to wrap our scripts and manage comparison to other methods and evaluation on the QuanTest2 set of alignments.</p>
      <p>We compare our method to Clustal Omega (<xref rid="GR277675MCWC46" ref-type="bibr">Sievers et al. 2011</xref>), MAFFT-FFTNS1, MAFFT-GINSI, MAFFT-LINSI (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), MUSCLE (<xref rid="GR277675MCWC12" ref-type="bibr">Edgar 2004</xref>), ProbCons (<xref rid="GR277675MCWC10" ref-type="bibr">Do et al. 2005</xref>), T-Coffee (<xref rid="GR277675MCWC37" ref-type="bibr">Notredame et al. 2000</xref>), UPP (<xref rid="GR277675MCWC35" ref-type="bibr">Nguyen et al. 2015</xref>), and FAMSA (<xref rid="GR277675MCWC9" ref-type="bibr">Deorowicz et al. 2016</xref>) and build initial guide trees for all methods except UPP with MAFFT-PartTree (<xref rid="GR277675MCWC24" ref-type="bibr">Katoh and Toh 2007</xref>).</p>
      <p>We use the same default parameters for other algorithms as in the supplemental information of <xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. (2019)</xref>. As with previous work, alignment performance is evaluated using gold-standard reference alignments of the first three proteins in each FASTA file (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>). For the proof-of-concept testing described here, we created smaller sets of proteins to align consisting of 20 sequences, for which we select the first three sequences from each FASTA file, as well as 17 randomly selected protein sequences. We additionally remove four protein sets with a more than fourfold difference in length between the three reference sequences and the 17 random sequences, leaving a benchmarking data set of 147 protein sets. We calculate sequence identity for each gold-standard alignment by recording the mean proportion of times each aligned position in the pairs of sequences matches exactly. For sequence identity bins, identities &lt;0.2 fall in bin 0.1, &lt;0.3 fall in bin 0.2, and so on. For runtime measurements, we also create larger sets of proteins consisting of 50, 100, and 200 sequences, where we select the first three sequences and then 47, 97, and 197 sequences, respectively. For evaluating against structured portions of the alignment, we filter down gold-standard alignments to the subset of amino acids with DSSP structure codes H, G, I, E, and B (<xref rid="GR277675MCWC22" ref-type="bibr">Kabsch and Sander 1983</xref>).</p>
      <sec id="s1j1">
        <title>Evaluation score</title>
        <p>We use the total column score calculated with the aln_compare plugin from T-Coffee to score sequence alignments against the gold-standard alignments. This score is the percentage of columns in the output alignment that fully match columns in the reference gold-standard alignment.</p>
      </sec>
    </sec>
    <sec id="s1k">
      <title>Speed</title>
      <p>On an NVIDIA A100 GPU, initial protein embedding of 20 sequences and indexing of embeddings with faiss take, on average, 22.6 sec, and 100 sequence takes, on average, 31.3 sec, including loading the model. On a CPU configuration, protein embedding is substantially slower, taking 2–5 min to embed 20 sequences, depending on the length of the sequences and CPU memory. The time to produce an alignment depends on the number of sequences in the alignment and on the number of iterations required to place all amino acids (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 3A</xref>). After embedding, an alignment of 20 sequences when run on an NVIDIA A100 GPU (for similarity searches on the faiss index) and a 2.6-GHz AMD EPYC Rome CPU (remaining steps) with 64 GB of memory takes a median of 1.2 min, for 50 sequences a median of 6.1 min, for 100 sequences a median of 22.6 min, and for 200 sequences a median of 82.9 min.</p>
      <p>For comparison, on these data sets, T-Coffee is about five to 10 times faster when run on a 2.6-GHz AMD EPYC Rome CPU with 64 GB of memory. Not including time to build trees, as this varies highly by the tree building method, in our benchmarking, T-Coffee takes a median of 0.2 min for 20 sequences, a median of 1.47 min for 50 sequences, a median of 5.8 min for 100 sequences, and a median of 26.1 min for 200 sequences (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 3B</xref>). As our implementation of the vcMSA is a proof of concept, we expect the speed of producing alignments to fall substantially with program optimization.</p>
    </sec>
    <sec id="s1l">
      <title>Merging subalignments and excluded sequences</title>
      <p>Thirteen of 147 of our QuanTest2 20 protein sets contain more than one cluster of sequences, and 59/147 contain at least one outlier sequence. For these 63 protein sets, we must combine vsMSA produced subalignments and excluded sequences into a complete alignment containing all sequences (<xref rid="GR277675MCWF1" ref-type="fig">Fig. 1</xref>H). For this step, we use MAFFT-LINSI merge (<xref rid="GR277675MCWC23" ref-type="bibr">Katoh and Standley 2013</xref>), which uses our sets of prealigned sequences as internal nodes of a guide tree constructed by UPGMA, using the command <monospace>mafft ‐‐clustalout ‐‐merge key_table ‐‐auto sub.alns</monospace>
<monospace>&gt;</monospace>
<monospace>merged.aln</monospace>. For the remaining 84 protein sets, no merging of alignments is necessary. Although in a typical use case, outlier sequences would be removed, we include them for compatibility with benchmark protein families.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>RBHs between amino acid representations are a solid foundation for MSA</title>
      <p>To show that RBHs between amino acid embeddings in two different sequences accurately reflect aligned amino acids, we measured the proportion of aligned positions in 562 pairs of sequences from the HOMSTRAD gold-standard structural alignment database (<xref rid="GR277675MCWC50" ref-type="bibr">Stebbings and Mizuguchi 2004</xref>) that are RBHs when comparing amino acid embeddings. For 93% of gold-standard protein alignments, at least 50% of aligned columns are additionally RBHs between amino acid embeddings even after filtering RBHs based on uncovering a MNCM (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>A). The correspondence between RBHs and aligned columns is roughly dependent on sequence identity of the alignment (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>B). Thus, protein language models are highly effective in identifying analogous positions across protein sequences. These RBHs are the main input to the vcMSA algorithm.</p>
      <fig position="float" id="GR277675MCWF2">
        <label>Figure 2.</label>
        <caption>
          <p>RBHs and clustered amino acid representations reflect aligned columns. (<italic>A</italic>) For 562 pairs of aligned proteins from the HOMSTRAD database, the MNCMs of RBHs between vector representations frequently correspond to correctly aligned positions. For each gold-standard alignment, we compute the fraction of aligned gold-standard positions that are additionally RBHs after MNCM filtering for that protein pair and display these results as a histogram. (<italic>B</italic>) The proportion of columns in the gold-standard pairwise alignments that are in the MNCM of RBHs is related to sequence identity of the reference alignment. (<italic>C</italic>) Principal components 2 and 3 for amino acid vector representations of 20 cold-shock proteins from the csp protein family. Amino acid representations (<italic>below</italic>) are colored by their corresponding column in the multiple sequence alignment (<italic>above</italic>). (<italic>D</italic>) Identical amino acids in different columns are distinguishable from each other. All glycines in the amino acid PCA plot and the multiple sequence alignment are colored red.</p>
        </caption>
        <graphic xlink:href="1145f02" position="float"/>
      </fig>
    </sec>
    <sec id="s2b">
      <title>Clusters of amino acid representations correspond to columns in the MSA</title>
      <p>When amino acid representations in a PCA are colored by their corresponding column in the MSA, it can be seen that amino acids in the same aligned column cluster together (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>C). We show this correspondence with 20 sequences from the csp protein family using their HOMSTRAD alignment. One initial concern about using amino acid representations for MSA was that the representations of the same amino acid (e.g., glycine) would be too similar wherever that amino acid occurs in the sequence. Instead we find that representations of the same amino acids are distinguishable across the alignment (<xref rid="GR277675MCWF2" ref-type="fig">Fig. 2</xref>D).</p>
    </sec>
    <sec id="s2c">
      <title>vcMSA produces more accurate alignments than other algorithms, particularly at low sequence identity</title>
      <p>We benchmarked vcMSA on 147 protein alignments consisting of 20 sequences each from the QuanTest2 data set and compared our results to seven alignment algorithms (<xref rid="GR277675MCWF3" ref-type="fig">Fig. 3</xref>A). As the metric to evaluate alignment accuracy, we chose total column score, which measures the number of columns that match the gold-standard alignment, owing to its high dynamic range relative to other metrics. vcMSA generally matches or exceeds the alignment accuracy of other algorithms and performs especially well on the lowest sequence similarity proteins in the benchmark. For example, vcMSA is able to align the Asp_Glu_race_D family with a total column score of 63.9, whereas the maximum score of other alignment methods is 0.9.</p>
      <fig position="float" id="GR277675MCWF3">
        <label>Figure 3.</label>
        <caption>
          <p>vcMSA alignments are frequently more accurate than previous methods, particularly for alignments with low levels of sequence identity. We benchmarked our implementation of vcMSA on sets of 20 sequences from each of 147 gold-standard multiple sequence alignments from the QuanTest2 data set. (<italic>A</italic>) We compare our method to eight state-of-the-art algorithms for sequence alignment. Each point corresponds to one protein MSA and is colored by its sequence identity. Each panel is a tilted scatterplot of relative performance of each other algorithm tested against vcMSA by total column score of produced alignments. Points to the <italic>right</italic> of the vertical dashed line are alignments where vcMSA outperformed the other method. The number of alignments to the <italic>left</italic> or <italic>right</italic> of the line is in gold. vcMSA performs better on more test sets than all other tested algorithms. The point lying on the <italic>right</italic> axis line is the Asp_Glu_race_D alignment, which all other algorithms perform poorly on (TC score ∼0). (<italic>B</italic>) We compare the median total column score of vcMSA alignments to MAFFT-GINSI and Clustal Omega alignments, grouping alignments by sequence identity bins. We observe increased scores for vcMSA at low sequence identities. (<italic>C</italic>) We show median total column scores for structured portions and full gold-standard reference alignments for all algorithms, separated by sequence identity bin.</p>
        </caption>
        <graphic xlink:href="1145f03" position="float"/>
      </fig>
      <p>For low sequence identity alignments, we frequently exceed the alignment accuracy of existing algorithms. In our benchmarking, compared with other methods, we perform notably better on low sequence identity alignments. <xref rid="GR277675MCWF3" ref-type="fig">Figure 3</xref>B illustrates the performance of vcMSA against the two algorithms that score highest and lowest on sequences with identity &lt; 0.2, MAFFT-GINSI and Clustal Omega, respectively. As sequence identity increases, vcMSA generally matches the accuracy of other algorithms. When we compute the total column score for structured portions of the gold-standard alignment compared with the full gold-standard alignment, it is apparent that vcMSA performs better on structured components (<xref rid="GR277675MCWF3" ref-type="fig">Fig. 3</xref>C). Further, vcMSA is specifically strong at structured regions of the lowest identity protein sets. This is likely because of the language model capturing structural properties of these low identity structured regions, even though their sequence identity is beyond the typical twilight zone limit.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>Discussion</title>
    <p>Although sequence aligners were some of the earliest bioinformatic algorithms, and although sequence alignment forms the basis of many computational biology analyses, MSA is not a solved problem. Current sequence alignment algorithms particularly struggle with alignments in the so-called twilight zone of sequence identity, in which structure and function is conserved, but amino acid sequence is not.</p>
    <p>Here, we present vcMSA, a novel algorithm for MSA that diverges substantially from other approaches, and show that it is an improvement on the state of the art for some of the most challenging to align protein families. The ability to create accurate MSAs opens up these low sequence identity families to all the downstream bioinformatics applications that take alignments as input. Notably, the core vcMSA algorithm avoids standard features of the most widely used alignment algorithms, including gap penalties, substitution matrices, and guide trees. Although substitution matrices and gap penalties are standard components of alignment approaches, they are used to formalize optimization criteria and do not reflect fundamental properties of alignments. Instead, aligned amino acids within an MSA are meant to be those that have evolved from a shared ancestral amino acid. Protein language models may be especially suited to identify these analogous amino acids, as they capture structural and functional properties of amino acids via sequence context, much as natural language transformer models capture the semantics of words in a sentence based on other words (<xref rid="GR277675MCWC51" ref-type="bibr">Vaswani et al. 2017</xref>). We find that vcMSA performs particularly well at aligning structured portions of sequences; it is possible that the less well-structured portions of sequences do not have specific functionally analogous positions in other sequences.</p>
    <p>Protein alignment based on protein language representation appears to be most suited to global alignment for sets of protein sequences with similar structure and function, where the underlying meaning of the sequence is as consistent as possible. We have observed that alignment of a small subsequence of a protein (e.g., one domain) to a longer protein is often highly inaccurate, as the contextual embeddings for the small portion are sufficiently different from those computed for the longer protein. To produce the highest quality alignment, outlier sequences can be automatically detected based on sequence embeddings and removed from the alignment process. In these cases, we first use sequence representations to divide sequences into high similarity groups and detect outlier sequences. We then perform vcMSA on each cluster of sequences individually, producing high-quality subalignments. Although we currently use MAFFT-LINSI to combine subalignments produced by vcMSA, we are exploring methods to combine subalignments using purely language models. However, divergence in protein meaning between sequence groups complicates this process.</p>
    <p>Additionally, for alignments in which start positions are not aligned, we find it helpful to add sequence padding to either end of the sequence before embedding, which reduces an observed first character effect, in which the first characters of each sequence tend to have the most similar embeddings, regardless of the sequence context of that first character (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1A</xref>). In these cases, padding can substantially improve correctly aligned columns beyond the first column (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1B</xref>). However, adding padding either substantially degrades or does not change alignment accuracy for protein sets in which the start positions align.</p>
    <p>For certain protein groups, we observe a sequence-specific offset in amino acid embeddings (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1C</xref>), even for sequences with relatively high sequence and structure similarity. On the other hand, we observe that fairly divergent protein sequences can result in embeddings without noticeable sequence-level effects. To reduce sequence specific effects, we consider the amino acids from each sequence as analogous to a batch and remove sequence-specific variation using batch-correction-style techniques (<xref rid="SD2" ref-type="supplementary-material">Supplemental Methods</xref>). Reducing sequence-specific effects with batch correction overall improves alignment quality (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1D</xref>). Specifically, between pairs of sequences, batch correction improves the quality of RBHs, particularly for pairs of sequences with cosine similarity less than 0.95 (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 1E</xref>). Accordingly, by default, we use batch correction to remove sequence-specific offsets. In some cases, even with correction for sequence-specific offsets, alignment quality is poor. For example, batch correction improves the total column score of neuraminidases from 0.5 to 36.9. However, aligning neuraminidases from <italic>Influenza</italic> A and B separately and then combining subalignments allows a total column score of 64.7. Functional divergence in response to selective pressure in these two neuraminidases likely decreases the similarity of amino acid embeddings. Further research is needed to understand how to recognize and reduce sequence-specific effects when comparing amino acid embeddings across sequences.</p>
    <p>Overall, we find that alignment quality and speed of construction is related to the quality of the RBHs between amino acid embeddings. To improve this network, we use MNCM to remove false-positive RBHs (<xref rid="SD2" ref-type="supplementary-material">Supplemental Fig. 2</xref>). However, it is likely that the RBH network could be improved in multiple ways, including through fine-tuning embeddings, use of other protein language models, and choice of embedding layers. On the other hand, because finding and filtering RBHs is largely effective for removing low similarity spurious matches, our approach is robust to changes in the similarity cutoffs for identifying amino acids to align. We find that alignments improve when merging neighboring columns in the alignment that contain amino acids from mutually exclusive sequences and whose amino acids have a minimal cosine similarity to each other.</p>
    <p>As our implementation is a prototype, we have not substantially optimized our scripts for speed and memory usage, with much room for improvement in these areas. To identify similar amino acid positions at-scale between larger numbers of sequences, we can use tools developed for ultrafast nearest neighbor searches of millions and billions of vectors (<xref rid="GR277675MCWC20" ref-type="bibr">Johnson et al. 2021</xref>). Additionally, our algorithm's runtime is greatly dependent on the number of iterations required to place all amino acids, which is related to the number of clustering errors (when an amino acid is sorted into a cluster that conflicts with the order of amino acids in the sequence). Currently, we use the very basic approach of finding connected components and choosing them to be clusters; we believe that slightly more sophisticated approaches (e.g., those requiring a higher edge density within clusters) would reduce errors in clustering and decrease runtimes.</p>
    <p>Our prototype implementation of the vcMSA algorithm outperforms existing alignment algorithms at aligning a benchmark of sets of proteins. It is particularly successful at aligning groups of low similarity sequences, filling a gap in the capabilities of other algorithms. Another advantage of using amino acid embeddings is that we can additionally score the confidence of each column in the alignment by measuring the average cosine similarity of amino acid embeddings from the same column. This confidence score will allow filtering of alignments to only confidently aligned positions in downstream tasks such as phylogenetic tree building.</p>
    <p>Here, we show both the utility of protein language embeddings in MSA and a new MSA algorithm fully orthogonal to existing approaches. We expect accuracy to only improve with optimal choice of amino acid representations and the development of larger language models that will more richly capture the identity of each amino acid. Overall, we anticipate that protein language models will play an important role in the next generation of methods for determining MSAs.</p>
    <sec id="s3a">
      <title>Software availability</title>
      <p>Our modified version of the nf-benchmark (<xref rid="GR277675MCWC16" ref-type="bibr">Garriga et al. 2019</xref>) is available at GitHub (<uri xlink:href="https://github.com/clairemcwhite/nf-benchmark-vcmsa">https://github.com/clairemcwhite/nf-benchmark-vcmsa</uri>). A demonstration colab notebook is available at GitHub (<uri xlink:href="https://github.com/clairemcwhite/vcmsa">https://github.com/clairemcwhite/vcmsa</uri>). Source code is distributed as a Python package vcmsa under an MIT free software license. We recommend obtaining vcmsa and associated files from the GitHub repository (<uri xlink:href="https://github.com/clairemcwhite/vcmsa">https://github.com/clairemcwhite/vcmsa</uri>); however, it is also made available here as <xref rid="SD1" ref-type="supplementary-material">Supplemental Code</xref>. A demonstration Google colab notebook is additionally available at <uri xlink:href="https://colab.research.google.com/drive/1h8WcsMzi8pYr-O3jW03knt7ePcv22o-F">https://colab.research.google.com/drive/1h8WcsMzi8pYr-O3jW03knt7ePcv22o-F</uri>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material id="SD1" position="float" content-type="local-data">
      <label>Supplement 1</label>
      <media xlink:href="Supplemental_code.zip" id="d64e723" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD2" position="float" content-type="local-data">
      <label>Supplement 2</label>
      <media xlink:href="Supplemental_Materials.pdf" id="d64e726" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>C.D.M. acknowledges support from the Lewis-Sigler Institute for Integrative Genomics. M.S. acknowledges support from National Institutes of Health (NIH) R01-GM076275. We thank Joshua Akey for helpful discussions and also thank the Princeton University High Performance Computing Center for providing high-performance computing resources that have contributed to the research results reported in this paper.</p>
    <p><italic>Author contributions:</italic> Conceptualization and algorithmic design were by C.D.M. and M.S. Software implementation and result and figure generation were by C.D.M., with contributions from I.A.-G. C.D.M. and M.S. wrote the manuscript, with contributions from I.A.-G.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link xlink:href="https://www.genome.org/cgi/doi/10.1101/gr.277675.123" ext-link-type="uri">https://www.genome.org/cgi/doi/10.1101/gr.277675.123</ext-link>.</p>
    </fn>
    <fn>
      <p>Freely available online through the <italic>Genome Research</italic> Open Access option.</p>
    </fn>
  </fn-group>
  <sec id="s5">
    <title>Competing interest statement</title>
    <p>The authors declare no competing interests.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="GR277675MCWC1">
      <mixed-citation publication-type="journal"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>. <year>1991</year>. <article-title>Amino acid substitution matrices from an information theoretic perspective</article-title>. <source>J Mol Biol</source><volume>219</volume>: <fpage>555</fpage>–<lpage>565</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(91)90193-A</pub-id><pub-id pub-id-type="pmid">2051488</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC3">
      <mixed-citation publication-type="journal"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><volume>12</volume>: <fpage>654</fpage>–<lpage>669.e3</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2021.05.017</pub-id><pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC4">
      <mixed-citation publication-type="journal"><string-name><surname>Capra</surname><given-names>JA</given-names></string-name>, <string-name><surname>Singh</surname><given-names>M</given-names></string-name>. <year>2007</year>. <article-title>Predicting functionally important residues from sequence conservation</article-title>. <source>Bioinformatics</source><volume>23</volume>: <fpage>1875</fpage>–<lpage>1882</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm270</pub-id><pub-id pub-id-type="pmid">17519246</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC5">
      <mixed-citation publication-type="journal"><string-name><surname>Capra</surname><given-names>JA</given-names></string-name>, <string-name><surname>Singh</surname><given-names>M</given-names></string-name>. <year>2008</year>. <article-title>Characterization and prediction of residues determining protein functional specificity</article-title>. <source>Bioinformatics</source><volume>24</volume>: <fpage>1473</fpage>–<lpage>1480</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn214</pub-id><pub-id pub-id-type="pmid">18450811</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC6">
      <mixed-citation publication-type="journal"><string-name><surname>Chowdhury</surname><given-names>R</given-names></string-name>, <string-name><surname>Bouatta</surname><given-names>N</given-names></string-name>, <string-name><surname>Biswas</surname><given-names>S</given-names></string-name>, <string-name><surname>Floristean</surname><given-names>C</given-names></string-name>, <string-name><surname>Kharkar</surname><given-names>A</given-names></string-name>, <string-name><surname>Roy</surname><given-names>K</given-names></string-name>, <string-name><surname>Rochereau</surname><given-names>C</given-names></string-name>, <string-name><surname>Ahdritz</surname><given-names>G</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Church</surname><given-names>GM</given-names></string-name>, <etal/><year>2022</year>. <article-title>Single-sequence protein structure prediction using a language model and deep learning</article-title>. <source>Nat Biotechnol</source><volume>40</volume>: <fpage>1617</fpage>–<lpage>1623</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01432-w</pub-id><pub-id pub-id-type="pmid">36192636</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC7">
      <mixed-citation publication-type="journal"><string-name><surname>Csardi</surname><given-names>G</given-names></string-name>, <string-name><surname>Nepusz</surname><given-names>T</given-names></string-name>. <year>2006</year>. <article-title>The igraph software package for complex network research</article-title>. <source>Int J Complex Syst</source><volume>1695</volume>: <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC8">
      <mixed-citation publication-type="journal"><string-name><surname>Dayhoff</surname><given-names>MO</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>RM</given-names></string-name>, <string-name><surname>Orcutt</surname><given-names>BC</given-names></string-name>. <year>1978</year>. <article-title>A model of evolutionary change in proteins</article-title>. <source>Atlas Protein Seq Struct</source><volume>5</volume>: <fpage>345</fpage>–<lpage>352</lpage>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC9">
      <mixed-citation publication-type="journal"><string-name><surname>Deorowicz</surname><given-names>S</given-names></string-name>, <string-name><surname>Debudaj-Grabysz</surname><given-names>A</given-names></string-name>, <string-name><surname>Gudyś</surname><given-names>A</given-names></string-name>. <year>2016</year>. <article-title>FAMSA: fast and accurate multiple sequence alignment of huge protein families</article-title>. <source>Sci Rep</source><volume>6</volume>: <fpage>33964</fpage>. <pub-id pub-id-type="doi">10.1038/srep33964</pub-id><pub-id pub-id-type="pmid">27670777</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC10">
      <mixed-citation publication-type="journal"><string-name><surname>Do</surname><given-names>CB</given-names></string-name>, <string-name><surname>Mahabhashyam</surname><given-names>MSP</given-names></string-name>, <string-name><surname>Brudno</surname><given-names>M</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>. <year>2005</year>. <article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>. <source>Genome Res</source><volume>15</volume>: <fpage>330</fpage>–<lpage>340</lpage>. <pub-id pub-id-type="doi">10.1101/gr.2821705</pub-id><pub-id pub-id-type="pmid">15687296</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC11">
      <mixed-citation publication-type="journal"><string-name><surname>Eades</surname><given-names>P</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>WF</given-names></string-name>. <year>1993</year>. <article-title>A fast and effective heuristic for the feedback arc set problem</article-title>. <source>Inf Process Lett</source><volume>47</volume>: <fpage>319</fpage>–<lpage>323</lpage>. <pub-id pub-id-type="doi">10.1016/0020-0190(93)90079-O</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC12">
      <mixed-citation publication-type="journal"><string-name><surname>Edgar</surname><given-names>RC</given-names></string-name>. <year>2004</year>. <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source><volume>5</volume>: <fpage>113</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id><pub-id pub-id-type="pmid">15318951</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC13">
      <mixed-citation publication-type="journal"><string-name><surname>Elnaggar</surname><given-names>A</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Rehawi</surname><given-names>G</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L</given-names></string-name>, <string-name><surname>Gibbs</surname><given-names>T</given-names></string-name>, <string-name><surname>Feher</surname><given-names>T</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>C</given-names></string-name>, <string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <etal/><year>2022</year>. <article-title>ProtTrans: toward understanding the language of life through self-supervised learning</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><volume>44</volume>: <fpage>7112</fpage>–<lpage>7127</lpage>. <pub-id pub-id-type="doi">10.1109/TPAMI.2021.3095381</pub-id><pub-id pub-id-type="pmid">34232869</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC14">
      <mixed-citation publication-type="book"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name>. <year>2004</year>. <source>Inferring phylogenies</source>, <edition>2nd ed.</edition><publisher-name>Sinauer Associates</publisher-name>, <publisher-loc>Sunderland, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="GR277675MCWC15">
      <mixed-citation publication-type="journal"><string-name><surname>Feng</surname><given-names>D-F</given-names></string-name>, <string-name><surname>Doolittle</surname><given-names>RF</given-names></string-name>. <year>1987</year>. <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>. <source>J Mol Evol</source><volume>25</volume>: <fpage>351</fpage>–<lpage>360</lpage>. <pub-id pub-id-type="doi">10.1007/BF02603120</pub-id><pub-id pub-id-type="pmid">3118049</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC16">
      <mixed-citation publication-type="journal"><string-name><surname>Garriga</surname><given-names>E</given-names></string-name>, <string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Magis</surname><given-names>C</given-names></string-name>, <string-name><surname>Erb</surname><given-names>I</given-names></string-name>, <string-name><surname>Mansouri</surname><given-names>L</given-names></string-name>, <string-name><surname>Baltzis</surname><given-names>A</given-names></string-name>, <string-name><surname>Laayouni</surname><given-names>H</given-names></string-name>, <string-name><surname>Kondrashov</surname><given-names>F</given-names></string-name>, <string-name><surname>Floden</surname><given-names>E</given-names></string-name>, <string-name><surname>Notredame</surname><given-names>C</given-names></string-name>. <year>2019</year>. <article-title>Large multiple sequence alignments with a root-to-leaf regressive method</article-title>. <source>Nat Biotechnol</source><volume>37</volume>: <fpage>1466</fpage>–<lpage>1470</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0333-6</pub-id><pub-id pub-id-type="pmid">31792410</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC17">
      <mixed-citation publication-type="journal"><string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Littmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Sillitoe</surname><given-names>I</given-names></string-name>, <string-name><surname>Bordin</surname><given-names>N</given-names></string-name>, <string-name><surname>Orengo</surname><given-names>C</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2022</year>. <article-title>Contrastive learning on protein embeddings enlightens midnight zone</article-title>. <source>NAR Genom Bioinform</source><volume>4</volume>: <fpage>lqac043</fpage>. <pub-id pub-id-type="doi">10.1093/nargab/lqac043</pub-id><pub-id pub-id-type="pmid">35702380</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC18">
      <mixed-citation publication-type="journal"><string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>JG</given-names></string-name>. <year>1992</year>. <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci</source><volume>89</volume>: <fpage>10915</fpage>–<lpage>10919</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id><pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC20">
      <mixed-citation publication-type="journal"><string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Douze</surname><given-names>M</given-names></string-name>, <string-name><surname>Jégou</surname><given-names>H</given-names></string-name>. <year>2021</year>. <article-title>Billion-scale similarity search with GPUs</article-title>. <source>IEEE Trans Big Data</source><volume>7</volume>: <fpage>535</fpage>–<lpage>547</lpage>. <pub-id pub-id-type="doi">10.1109/TBDATA.2019.2921572</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC21">
      <mixed-citation publication-type="journal"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name>, <string-name><surname>Green</surname><given-names>T</given-names></string-name>, <string-name><surname>Figurnov</surname><given-names>M</given-names></string-name>, <string-name><surname>Ronneberger</surname><given-names>O</given-names></string-name>, <string-name><surname>Tunyasuvunakool</surname><given-names>K</given-names></string-name>, <string-name><surname>Bates</surname><given-names>R</given-names></string-name>, <string-name><surname>Žídek</surname><given-names>A</given-names></string-name>, <string-name><surname>Potapenko</surname><given-names>A</given-names></string-name>, <etal/><year>2021</year>. <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><volume>596</volume>: <fpage>583</fpage>–<lpage>589</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC22">
      <mixed-citation publication-type="journal"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>1983</year>. <article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>. <source>Biopolymers</source><volume>22</volume>: <fpage>2577</fpage>–<lpage>2637</lpage>. <pub-id pub-id-type="doi">10.1002/bip.360221211</pub-id><pub-id pub-id-type="pmid">6667333</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC23">
      <mixed-citation publication-type="journal"><string-name><surname>Katoh</surname><given-names>K</given-names></string-name>, <string-name><surname>Standley</surname><given-names>DM</given-names></string-name>. <year>2013</year>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source><volume>30</volume>: <fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC24">
      <mixed-citation publication-type="journal"><string-name><surname>Katoh</surname><given-names>K</given-names></string-name>, <string-name><surname>Toh</surname><given-names>H</given-names></string-name>. <year>2007</year>. <article-title>PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences</article-title>. <source>Bioinformatics</source><volume>23</volume>: <fpage>372</fpage>–<lpage>374</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl592</pub-id><pub-id pub-id-type="pmid">17118958</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC25">
      <mixed-citation publication-type="journal"><string-name><surname>Littmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Weissenow</surname><given-names>K</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Protein embeddings and deep learning predict binding residues for various ligand classes</article-title>. <source>Sci Rep</source><volume>11</volume>: <fpage>23916</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-021-03431-4</pub-id><pub-id pub-id-type="pmid">34903827</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC26">
      <mixed-citation publication-type="journal"><string-name><surname>Liu</surname><given-names>K</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Holder</surname><given-names>MT</given-names></string-name>, <string-name><surname>Nelesen</surname><given-names>SM</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>AP</given-names></string-name>, <string-name><surname>Linder</surname><given-names>CR</given-names></string-name>. <year>2012</year>. <article-title>SATé-II: very fast and accurate simultaneous estimation of multiple sequence alignments and phylogenetic trees</article-title>. <source>Syst Biol</source><volume>61</volume>: <fpage>90</fpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syr095</pub-id><pub-id pub-id-type="pmid">22139466</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC27">
      <mixed-citation publication-type="journal"><string-name><surname>Malucelli</surname><given-names>F</given-names></string-name>, <string-name><surname>Ottmann</surname><given-names>T</given-names></string-name>, <string-name><surname>Pretolani</surname><given-names>D</given-names></string-name>. <year>1993</year>. <article-title>Efficient labelling algorithms for the maximum noncrossing matching problem</article-title>. <source>Discrete Appl Math</source><volume>47</volume>: <fpage>175</fpage>–<lpage>179</lpage>. <pub-id pub-id-type="doi">10.1016/0166-218X(93)90090-B</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC28">
      <mixed-citation publication-type="journal"><string-name><surname>Marks</surname><given-names>DS</given-names></string-name>, <string-name><surname>Colwell</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Sheridan</surname><given-names>R</given-names></string-name>, <string-name><surname>Hopf</surname><given-names>TA</given-names></string-name>, <string-name><surname>Pagnani</surname><given-names>A</given-names></string-name>, <string-name><surname>Zecchina</surname><given-names>R</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>2011</year>. <article-title>Protein 3D structure computed from evolutionary sequence variation</article-title>. <source>PLoS One</source><volume>6</volume>: <fpage>e28766</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0028766</pub-id><pub-id pub-id-type="pmid">22163331</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC29">
      <mixed-citation publication-type="journal"><string-name><surname>Marquet</surname><given-names>C</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Olenyi</surname><given-names>T</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Erckert</surname><given-names>K</given-names></string-name>, <string-name><surname>Bernhofer</surname><given-names>M</given-names></string-name>, <string-name><surname>Nechaev</surname><given-names>D</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2022</year>. <article-title>Embeddings from protein language models predict conservation and variant effects</article-title>. <source>Hum Genet</source><volume>141</volume>: <fpage>1629</fpage>–<lpage>1647</lpage>. <pub-id pub-id-type="doi">10.1007/s00439-021-02411-y</pub-id><pub-id pub-id-type="pmid">34967936</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC30">
      <mixed-citation publication-type="journal"><string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>N</given-names></string-name>, <string-name><surname>Guo</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L-S</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2015</year>. <article-title>PASTA: ultra-large multiple sequence alignment for nucleotide and amino-acid sequences</article-title>. <source>J Comput Biol</source><volume>22</volume>: <fpage>377</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2014.0156</pub-id><pub-id pub-id-type="pmid">25549288</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC31">
      <mixed-citation publication-type="journal"><string-name><surname>Miyata</surname><given-names>T</given-names></string-name>, <string-name><surname>Yasunaga</surname><given-names>T</given-names></string-name>. <year>1980</year>. <article-title>Molecular evolution of mRNA: a method for estimating evolutionary rates of synonymous and amino acid substitutions from homologous nucleotide sequences and its application</article-title>. <source>J Mol Evol</source><volume>16</volume>: <fpage>23</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1007/BF01732067</pub-id><pub-id pub-id-type="pmid">6449605</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC32">
      <mixed-citation publication-type="journal"><string-name><surname>Morgenstern</surname><given-names>B</given-names></string-name>, <string-name><surname>Prohaska</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Pöhler</surname><given-names>D</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF</given-names></string-name>. <year>2006</year>. <article-title>Multiple sequence alignment with user-defined anchor points</article-title>. <source>Algorithms Mol Biol</source><volume>1</volume>: <fpage>6</fpage>. <pub-id pub-id-type="doi">10.1186/1748-7188-1-6</pub-id><pub-id pub-id-type="pmid">16722533</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC33">
      <mixed-citation publication-type="other"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Strauss</surname><given-names>CEM</given-names></string-name>, <string-name><surname>Blackwell</surname><given-names>R</given-names></string-name>, <string-name><surname>Berenberg</surname><given-names>D</given-names></string-name>, <string-name><surname>Gligorijevic</surname><given-names>V</given-names></string-name>, <string-name><surname>Bonneau</surname><given-names>R</given-names></string-name>. <year>2020</year>. <article-title>Protein structural alignments from sequence</article-title>. <source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.03.365932</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC34">
      <mixed-citation publication-type="journal"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD</given-names></string-name>. <year>1970</year>. <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source><volume>48</volume>: <fpage>443</fpage>–<lpage>453</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id><pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC35">
      <mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname><given-names>ND</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>K</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2015</year>. <article-title>Ultra-large alignments using phylogeny-aware profiles</article-title>. <source>Genome Biol</source><volume>16</volume>: <fpage>124</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0688-z</pub-id><pub-id pub-id-type="pmid">26076734</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC36">
      <mixed-citation publication-type="journal"><string-name><surname>Notredame</surname><given-names>C</given-names></string-name>, <string-name><surname>Holm</surname><given-names>L</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>. <year>1998</year>. <article-title>COFFEE: an objective function for multiple sequence alignments</article-title>. <source>Bioinformatics</source><volume>14</volume>: <fpage>407</fpage>–<lpage>422</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/14.5.407</pub-id><pub-id pub-id-type="pmid">9682054</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC37">
      <mixed-citation publication-type="journal"><string-name><surname>Notredame</surname><given-names>C</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>, <string-name><surname>Heringa</surname><given-names>J</given-names></string-name>. <year>2000</year>. <article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source><volume>302</volume>: <fpage>205</fpage>–<lpage>217</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC38">
      <mixed-citation publication-type="journal"><string-name><surname>Nute</surname><given-names>M</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>E</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T</given-names></string-name>. <year>2019</year>. <article-title>Evaluating statistical multiple sequence alignment in comparison to other alignment methods on protein data sets</article-title>. <source>Syst Biol</source><volume>68</volume>: <fpage>396</fpage>–<lpage>411</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syy068</pub-id><pub-id pub-id-type="pmid">30329135</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC39">
      <mixed-citation publication-type="journal"><string-name><surname>Petti</surname><given-names>S</given-names></string-name>, <string-name><surname>Bhattacharya</surname><given-names>N</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name>, <string-name><surname>Dauparas</surname><given-names>J</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>N</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Rush</surname><given-names>AM</given-names></string-name>, <string-name><surname>Koo</surname><given-names>PK</given-names></string-name>, <string-name><surname>Ovchinnikov</surname><given-names>S</given-names></string-name>. <year>2023</year>. <article-title>End-to-end learning of multiple sequence alignments with differentiable Smith–Waterman</article-title>. <source>Bioinformatics</source><volume>39</volume>: <fpage>btac724</fpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btac724</pub-id><pub-id pub-id-type="pmid">36355460</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC40">
      <mixed-citation publication-type="journal"><string-name><surname>Pitschi</surname><given-names>F</given-names></string-name>, <string-name><surname>Devauchelle</surname><given-names>C</given-names></string-name>, <string-name><surname>Corel</surname><given-names>E</given-names></string-name>. <year>2010</year>. <article-title>Automatic detection of anchor points for multiple sequence alignment</article-title>. <source>BMC Bioinformatics</source><volume>11</volume>: <fpage>445</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-445</pub-id><pub-id pub-id-type="pmid">20813050</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC41">
      <mixed-citation publication-type="journal"><string-name><surname>Rao</surname><given-names>R</given-names></string-name>, <string-name><surname>Bhattacharya</surname><given-names>N</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>N</given-names></string-name>, <string-name><surname>Duan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Canny</surname><given-names>J</given-names></string-name>, <string-name><surname>Abbeel</surname><given-names>P</given-names></string-name>, <string-name><surname>Song</surname><given-names>YS</given-names></string-name>. <year>2019</year>. <article-title>Evaluating protein transfer learning with TAPE</article-title>. <source>Adv Neural Inf Process Syst</source><volume>32</volume>: <fpage>9689</fpage>–<lpage>9701</lpage>.<pub-id pub-id-type="pmid">33390682</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC42">
      <mixed-citation publication-type="journal"><string-name><surname>Rives</surname><given-names>A</given-names></string-name>, <string-name><surname>Meier</surname><given-names>J</given-names></string-name>, <string-name><surname>Sercu</surname><given-names>T</given-names></string-name>, <string-name><surname>Goyal</surname><given-names>S</given-names></string-name>, <string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>D</given-names></string-name>, <string-name><surname>Ott</surname><given-names>M</given-names></string-name>, <string-name><surname>Zitnick</surname><given-names>CL</given-names></string-name>, <string-name><surname>Ma</surname><given-names>J</given-names></string-name>, <etal/><year>2021</year>. <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>. <source>Proc Natl Acad Sci</source><volume>118</volume>: <fpage>e2016239118</fpage>. <pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id><pub-id pub-id-type="pmid">33876751</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC43">
      <mixed-citation publication-type="journal"><string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>1999</year>. <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Eng</source><volume>12</volume>: <fpage>85</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1093/protein/12.2.85</pub-id><pub-id pub-id-type="pmid">10195279</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC44">
      <mixed-citation publication-type="journal"><string-name><surname>Rost</surname><given-names>B</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C</given-names></string-name>. <year>1994</year>. <article-title>Combining evolutionary information and neural networks to predict protein secondary structure</article-title>. <source>Proteins</source><volume>19</volume>: <fpage>55</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1002/prot.340190108</pub-id><pub-id pub-id-type="pmid">8066087</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC45">
      <mixed-citation publication-type="journal"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG</given-names></string-name>. <year>2020</year>. <article-title>QuanTest2: benchmarking multiple sequence alignments using secondary structure prediction</article-title>. <source>Bioinformatics</source><volume>36</volume>: <fpage>90</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz552</pub-id><pub-id pub-id-type="pmid">31292629</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC46">
      <mixed-citation publication-type="journal"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Wilm</surname><given-names>A</given-names></string-name>, <string-name><surname>Dineen</surname><given-names>D</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Karplus</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>McWilliam</surname><given-names>H</given-names></string-name>, <string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name>, <etal/><year>2011</year>. <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using clustal omega</article-title>. <source>Mol Syst Biol</source><volume>7</volume>: <fpage>539</fpage>. <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id><pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC47">
      <mixed-citation publication-type="journal"><string-name><surname>Smith</surname><given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname><given-names>MS</given-names></string-name>. <year>1981</year>. <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source><volume>147</volume>: <fpage>195</fpage>–<lpage>197</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id><pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC48">
      <mixed-citation publication-type="journal"><string-name><surname>Sonnhammer</surname><given-names>ELL</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E</given-names></string-name>, <string-name><surname>Bateman</surname><given-names>A</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>1998</year>. <article-title>Pfam: multiple sequence alignments and HMM-profiles of protein domains</article-title>. <source>Nucleic Acids Res</source><volume>26</volume>: <fpage>320</fpage>–<lpage>322</lpage>. <pub-id pub-id-type="doi">10.1093/nar/26.1.320</pub-id><pub-id pub-id-type="pmid">9399864</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC49">
      <mixed-citation publication-type="journal"><string-name><surname>Stärk</surname><given-names>H</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name>. <year>2021</year>. <article-title>Light attention predicts protein location from the language of life</article-title>. <source>Bioinforma Adv</source><volume>1</volume>: <fpage>vbab035</fpage>. <pub-id pub-id-type="doi">10.1093/bioadv/vbab035</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC50">
      <mixed-citation publication-type="journal"><string-name><surname>Stebbings</surname><given-names>LA</given-names></string-name>, <string-name><surname>Mizuguchi</surname><given-names>K</given-names></string-name>. <year>2004</year>. <article-title>HOMSTRAD: recent developments of the Homologous Protein Structure Alignment Database</article-title>. <source>Nucleic Acids Res</source><volume>32</volume>: <fpage>D203</fpage>–<lpage>D207</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh027</pub-id><pub-id pub-id-type="pmid">14681395</pub-id></mixed-citation>
    </ref>
    <ref id="GR277675MCWC51">
      <mixed-citation publication-type="book"><string-name><surname>Vaswani</surname><given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N</given-names></string-name>, <string-name><surname>Uszkoreit</surname><given-names>J</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L</given-names></string-name>, <string-name><surname>Gomez</surname><given-names>AN</given-names></string-name>, <string-name><surname>Kaiser</surname><given-names>Ł</given-names></string-name>, <string-name><surname>Polosukhin</surname><given-names>I</given-names></string-name>. <year>2017</year>. <article-title>Attention is all you need</article-title>. <source>Advances in neural information processing systems. In Proceedings of the 31st international conference on neural information processing systems (NIPS'17)</source>, pp. <fpage>6000</fpage>–<lpage>6010</lpage>. <publisher-name>Curran Associates Inc.</publisher-name>, <publisher-loc>Red Hook, NY</publisher-loc>. <pub-id pub-id-type="doi">10.5555/3295222.3295349</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
