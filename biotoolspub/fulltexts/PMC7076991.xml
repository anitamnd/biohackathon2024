<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7076991</article-id>
    <article-id pub-id-type="publisher-id">3443</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-3443-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MethylNet: an automated and modular deep learning approach for DNA methylation analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8050-1291</contrib-id>
        <name>
          <surname>Levy</surname>
          <given-names>Joshua J.</given-names>
        </name>
        <address>
          <email>joshua.j.levy.gr@dartmouth.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Titus</surname>
          <given-names>Alexander J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Petersen</surname>
          <given-names>Curtis L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Youdinghuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salas</surname>
          <given-names>Lucas A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Christensen</surname>
          <given-names>Brock C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 2404</institution-id><institution-id institution-id-type="GRID">grid.254880.3</institution-id><institution>Program in Quantitative Biomedical Sciences, </institution><institution>Geisel School of Medicine at Dartmouth, </institution></institution-wrap>Hanover, NH 03755 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 2404</institution-id><institution-id institution-id-type="GRID">grid.254880.3</institution-id><institution>Department of Epidemiology, </institution><institution>Geisel School of Medicine at Dartmouth, </institution></institution-wrap>Hanover, NH 03755 USA </aff>
      <aff id="Aff3"><label>3</label>Department of Defense, Office of the Under Secretary of Defense for Research &amp; Engineering, Washington, DC, USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.414049.c</institution-id><institution>The Dartmouth Institute for Health Policy and Clinical Practice, </institution></institution-wrap>Lebanon, NH 03766 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 2404</institution-id><institution-id institution-id-type="GRID">grid.254880.3</institution-id><institution>Department of Molecular and Systems Biology, </institution><institution>Geisel School of Medicine at Dartmouth, </institution></institution-wrap>Hanover, NH 03755 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>108</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">DNA methylation (DNAm) is an epigenetic regulator of gene expression programs that can be altered by environmental exposures, aging, and in pathogenesis. Traditional analyses that associate DNAm alterations with phenotypes suffer from multiple hypothesis testing and multi-collinearity due to the high-dimensional, continuous, interacting and non-linear nature of the data. Deep learning analyses have shown much promise to study disease heterogeneity. DNAm deep learning approaches have not yet been formalized into user-friendly frameworks for execution, training, and interpreting models. Here, we describe MethylNet, a DNAm deep learning method that can construct embeddings, make predictions, generate new data, and uncover unknown heterogeneity with minimal user supervision.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The results of our experiments indicate that MethylNet can study cellular differences, grasp higher order information of cancer sub-types, estimate age and capture factors associated with smoking in concordance with known differences.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The ability of MethylNet to capture nonlinear interactions presents an opportunity for further study of unknown disease, cellular heterogeneity and aging processes.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deep learning</kwd>
      <kwd>DNA methylation</kwd>
      <kwd>High performance computing</kwd>
      <kwd>Workflow automation</kwd>
      <kwd>Unsupervised</kwd>
      <kwd>Supervised</kwd>
      <kwd>Transfer learning</kwd>
      <kwd>Embedding</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>5R01CA216265-03</award-id>
        <principal-award-recipient>
          <name>
            <surname>Christensen</surname>
            <given-names>Brock C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par19">Deep learning has emerged as a widely applicable modeling technique for a broad range of applications through the use of artificial neural networks (ANN) [<xref ref-type="bibr" rid="CR1">1</xref>]. Recently, the accessibility of large datasets, graphics processing units (GPUs) and unsupervised generative techniques have made these approaches more accurate, tractable, and relevant for the analysis of molecular data [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par20">DNA methylation (DNAm) is the addition of a methyl group to a nucleotide, typically cytosine, that does not alter the DNA sequence and occurs most frequently to cytosine-guanine dinucleotides (CpG). Methylated regions of DNA (hypermethylated), are associated with condensed chromatin, and when present near gene promoters, repression of transcription. Unmethylated regions of DNA (hypomethylated), are associated with open chromatin states and permissive to gene transcription. DNAm patterns are associated with cell-type-specific gene expression programs, and alterations to DNAm have been associated with aging and environmental exposures [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Further, it is well-established that DNAm alterations contribute to development and progression of cancer. The hypermethylation of tumor suppressing genes and the hypomethylation of oncogenes can lead to pathogenesis and poor prognosis. Affordable array-based genome-scale approaches to measure DNAm have potentiated Epigenome Wide Association Studies (EWAS) for testing associations of DNAm with phenotypes, exposures, and states of human health and disease. Because DNAm patterns are cell-type specific, EWAS often account for potential confounding from variation in biospecimen cell composition using reference-based, or reference-free approaches to infer cell type proportions [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par21">Measuring genome-wide DNAm in large numbers of specimens typically uses microarray-based technologies such as the Illumina HumanMethylation450 (450 K) and HumanMethylationEPIC (850 K) [<xref ref-type="bibr" rid="CR14">14</xref>] arrays, which yield an approximation to the proportion of DNA copies that are methylated at each specific cytosine locus, and are reported as beta values. Preprocessing pipelines such as <italic>PyMethylProcess</italic> have simplified derivation and storage of methylation beta values in accessible data formats [<xref ref-type="bibr" rid="CR15">15</xref>]. The scope of features from DNAm arrays is 20–50-fold higher than that of RNA-sequencing data sets that return normalized read counts for each gene. Though DNAm data can have a similar scope of features as genotyping array data sets, DNAm beta values are continuous (0–1), not categorical. Together, these facets of DNAm data sets pose challenges to analyses such as handling multi-collinearity and correcting for multiple hypothesis testing. To address these challenges, many downstream EWAS analyses have focused on reducing the dimensions into a rich feature set to associate with outcomes. By limiting the number of features through dimensionality reduction and feature selection, analyses become more computationally tractable and the burden of correcting for multiple comparisons is reduced.</p>
    <p id="Par22">An important advancement to methylation-based deep learning analyses was the application of Variational Auto-encoders (VAE). Initial deep learning approaches for DNAm data focused on estimating methylation status and imputation, performing classification and regression tasks, and performing embeddings of CpG methylation states to extract biologically meaningful lower-dimensional features [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. VAEs embed the methylation profiles in a way that represents the original data with high fidelity while revealing nuances [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. Thereafter, researchers attempted to develop similar frameworks for extracting features for downstream prediction tasks and identify meaningful relationships revealed by VAE latent representations [<xref ref-type="bibr" rid="CR25">25</xref>]. However, VAE models are sensitive to the selection of hyperparameters [<xref ref-type="bibr" rid="CR26">26</xref>] and have not been optimized for synthetic data generation, latent space exploration, and prediction tasks. Many auto-encoder approaches represent the data using an encoder, and then utilize a non-neural network model (e.g. support vector machine) to finalize the predictions. Presently, to the best of our knowledge there is no end-to-end training approach that both extracts biologically meaningful features through latent encoding and performs predictions using the derived features. Further, existing frameworks do not output predictions for multi-target regression tasks, such as cell-type deconvolution and subject age prediction.</p>
    <p id="Par23">Here, we leverage deep learning latent space regression and classification tasks through the development of a modular framework that is highly accessible to epigenetic researchers (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). <italic>MethylNet</italic> is a modular user-friendly deep learning framework for EWAS tasks with automation that leverages preprocessing pipelines. To discover important CpGs for each prediction we use the SHAP (SHapley Additive ExPlanation) approach [<xref ref-type="bibr" rid="CR27">27</xref>]. We highlight <italic>MethylNet</italic> as an easy-to-use command line interface that utilizes automation to scale, optimize, and simplify deep learning methylation tasks. <italic>MethylNet</italic>’s capabilities are showcased here with unsupervised generative and clustering tasks, cell-type deconvolution, pan-cancer subtype classification, age regression, and smoking status classification. These analyses will pave the path for more robust deep learning prediction models for methylation data. Coupled with <italic>PyMethylProcess</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], we expect the <italic>MethylNet</italic> framework to enable rapid production-scale research and development in the deep learning epigenetic space.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Step-by-step description of the modular framework: <bold>a</bold> Train feature extraction network using variational auto-encoders; <bold>b</bold> Fine-tune encoder for prediction tasks; <bold>c</bold> Perform hyperparameter scans for (<bold>a</bold>) and (<bold>b</bold>); <bold>d</bold> Identify contributing CpGs; <bold>e</bold> Interpret the CpGs</p></caption><graphic xlink:href="12859_2020_3443_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par24">We show that <italic>MethylNet</italic> serves as an effective encoder for DNAm data by capturing latent features that have high fidelity to the original dataset. This method can utilize encodings to make accurate predictions in common DNAm analysis tasks, and the CpGs important for making predictions are concordant with prior observations. Finally, we demonstrate that <italic>MethylNet</italic> can also identify CpGs consistent with a large EWAS meta-analysis.</p>
    <sec id="Sec3">
      <title>Datasets acquired</title>
      <p id="Par25">We selected six public DNAm data sets and use cases to illustrate a range of tasks and demonstrate ability to capture features that meaningfully encode aging, cell lineage, disease states, and exposures. The first dataset (Johansson data) was used to study both age and cell type classification and is one of the largest readily available DNAm datasets from healthy subjects with a wide age range (blood DNAm from individuals aged 15 to 95, GSE87571 [<xref ref-type="bibr" rid="CR28">28</xref>]; Supplementary Figure <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). The second dataset (The Cancer Genome Atlas, TCGA) was used to study cancer subtypes and includes 8376 samples representing 32 different cancer subtypes (Supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM1" ref-type="media">2</xref>). The third dataset (Liu dataset) was used to compare blood DNAm in current smokers to never smokers among the controls from a rheumatoid arthritis study (GSE42861, subset <italic>n</italic> = 188 [<xref ref-type="bibr" rid="CR29">29</xref>]). These three datasets were preprocessed using <italic>PyMethylProcess</italic> to yield 300 k, 200 k, and 300 k CpG features respectively and then split into 70% training, 20% testing, and 10% validation. Three additional datasets (GSE40279, GSE84207, and GSE75067) were utilized for preliminary evaluations of external validation and breast tumor subtyping.</p>
    </sec>
    <sec id="Sec4">
      <title>Motivation for DNAm encoding</title>
      <p id="Par26">First, we established <italic>MethylNet</italic> as a method for DNAm encoding by demonstrating the ability to recapitulate the original DNAm signal while providing superior clustering performance over state-of-the-art clustering methods such as Recursively Partitioned Mixture Modeling (RPMM) [<xref ref-type="bibr" rid="CR30">30</xref>] (see Supplementary <xref rid="MOESM1" ref-type="media">Material</xref>, “Evaluation of Unsupervised Encoder Performance”; Supplementary Figures <xref rid="MOESM1" ref-type="media">2</xref>, <xref rid="MOESM1" ref-type="media">3</xref> and <xref rid="MOESM1" ref-type="media">4</xref>). Given MethylNet’s performance in the unsupervised domain and its ability to meaningfully encode DNAm features, we next used this framework to validate performance in typical DNAm prediction tasks of age estimation, cellular proportion estimation, and disease classification.</p>
    </sec>
    <sec id="Sec5">
      <title>Age results</title>
      <p id="Par27">DNAm-based age estimators such as the Horvath and Hannum clocks used elastic net penalized regression to identify sets of CpGs (353 and 71 respectively) strongly associated with age [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Hannum et al. leveraged DNA methylation data from whole blood measured with the 450 K Illumina platform in 656 subjects aged 19–101. Horvath leveraged genome-scale methylation data from 51 tissue and cell types in 82 independent data sets and over 8000 samples. The resulting models provide for very accurate age estimation but the number of and manner with which features can be associated with age are limited. Moreover, recently there is interest in understanding what drives observed remaining residual between chronological age and methylation age. The difference between age and methylation age has been termed biological age or age acceleration and has itself been associated with disease risk and all-causes mortality [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref>]. Demonstrating consistent performance between MethylNet and established approaches motivates future use of our method to study complex states and interactions underlying aging processes.</p>
      <p id="Par28">Again, utilizing the Johansson data, we trained MethylNet on the chronological age of the individuals to predict chronological age. <italic>MethylNet</italic>-predicted age showed excellent concordance with the actual subject age (R<sup>2</sup> = 0.96, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) in the hold-out test set (<italic>n</italic> = 144), and only had 3.0 years mean absolute error (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) (training and validation performance in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). These results are comparably accurate to those estimated by the Hannum and Horvath clocks. The contribution of each CpG to age groups binned by 10-year increments from ages 14 to 94 were measured by Shapley values. The CpGs with the one thousand largest Shapley values for each age group were overlapped with the CpGs of the Hannum clock (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). These CpG contributions were compared between age groups using correlation distance, as illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d. The connectivity between different age groups’ CpG attributions in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d using hierarchical clustering demonstrates the sharing of important CpGs by similarly aged groups. Further description of the derivation of the Shapley score estimates can be found in the <xref rid="MOESM1" ref-type="media">supplementary materials</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Age Results on Test Set (<italic>n</italic> = 144): <bold>a</bold> Age predictions derived using the Horvath, Hannum, and MethylNet estimators are compared to the true age of the individual, the predicted ages are plotted on the x-axis, the actual ages on the y-axis, and a line was fit to the data for each estimator; <bold>b</bold> Comparison of MethylNet Age estimates on Test Set (<italic>n</italic> = 144) to Horvath and Hannum Age Estimators. 95% confidence intervals for each score were calculated using a one thousand sample non-parametric bootstrap; <bold>c</bold> Bar chart depicting the overlap of CpGs important to MethylNet and Hannum age estimators where one thousand CpGs with the highest SHAP scores per 10-year age group are divided by the total number of Hannum CpGs that passed QC; <bold>d</bold> Hierarchical clustering using the correlation distance between SHAP CpG scores for age groups across all CpGs. The linkage is found between similar age groups</p></caption><graphic xlink:href="12859_2020_3443_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par29">We aimed to compare the highly contributing CpGs to age predictions using <italic>MethylNet</italic> and to those calibrated in the Hannum epigenetic clock [<xref ref-type="bibr" rid="CR31">31</xref>]. The CpGs used by the Hannum model were most likely associated with those aged 60–80, the most prevalent ages in the cohort. Since the number of Hannum CpGs rediscovered by <italic>MethylNet</italic> appears to peak around this range, this supports evidence that <italic>MethylNet</italic> is able to recover the defining CpGs of the Hannum cohort.</p>
    </sec>
    <sec id="Sec6">
      <title>Cell type Deconvolution results</title>
      <p id="Par30">Reference-based cell type estimation approaches with DNAm data use a library of cell-specific leukocyte differentially methylated regions (L-DMR), to infer cellular proportions. These cell type libraries, similar to age estimation, contain a few hundred CpG features for prediction (e.g. the 350 CpG IDOL library [<xref ref-type="bibr" rid="CR12">12</xref>]), and current deconvolution is very accurate and fast. Although current methods like estimateCellCounts2 accurately capture cellular proportions in blood, the future of cell type deconvolution includes efforts to estimate remaining sources of cell type heterogeneity, including cellular states that currently lack L-DMR. We sought to investigate the ability of MethylNet to capture current capabilities of cellular deconvolution so that it may be applied to future unsupervised domains when the requisite amount of data is available.</p>
      <p id="Par31">As such, <italic>MethylNet</italic> was tasked with estimating the cell-type proportions for six immune cell-types using the same dataset as supplied for the age analysis. Unsupervised derivation of six latent clusters using VAE embeddings demonstrated separation of cellular proportions without training on a reference set of cellular proportions for DNAm profiles (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>); this served as motivation for a supervised analysis. As compared to the other EpiDISH estimator methods that utilize the IDOL library, the prediction framework demonstrates exemplary performance on this task in R<sup>2</sup> and mean absolute error across all cell-types save for monocytes, as demonstrated in Table <xref rid="Tab1" ref-type="table">1</xref> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a-b; training and validation performance in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>; concordance to EpiDISH estimators in Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>). Using Shapley attribution, contributions for each of the CpGs for driving the predictions of the cell-types was derived. Figure <xref rid="Fig3" ref-type="fig">3</xref>c shows the connectivity of their hierarchical clustering of these CpG attributions<bold>.</bold>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of MethylNet Cell Type Deconvolution Results to IDOL Library EpiDISH Methods. 95% confidence intervals calculated using 1 k-sample non-parametric bootstrap</p></caption><graphic position="anchor" xlink:href="12859_2020_3443_Tab1_HTML" id="MO3"/><table-wrap-foot><p><italic>n</italic> = 144, RPC: Robust Partial Correlations</p></table-wrap-foot></table-wrap>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Results on test set (<italic>n</italic> = 144) for cell-type deconvolution: <bold>a</bold> For each cell type, the predicted cellular proportion using MethylNet (x-axis) was plotted against the predicted cellular proportion using estimateCellCounts2, which has been found to be a highly accurate measure of cellular proportions and thus serving as the ground truth for comparison, a regression line was fit to the data for each cell type: B-cell, CD4T, CD8T, Monocytes (Mono), NK cells, and Neutrophils (Neu); <bold>b</bold> Grouped box plot demonstrating the concordance between the distributions of the MethylNet-estimated proportions of each cell-type and the distributions derived using estimateCellCounts2; <bold>c</bold> Hierarchical clustering using the correlation distance between two cell types’ SHAP CpG scores across all CpGs. The linkage is found between cell types of similar lineage</p></caption><graphic xlink:href="12859_2020_3443_Fig3_HTML" id="MO4"/></fig></p>
      <p id="Par32">The hierarchical clustering between the SHAP scores of each of the cell-types is consistent with the known cell lineage, reinforcing that cell lines that have co-evolved similarly share similar driving CpGs that are indicative of their cell-type. Some of the cell-types obtained improved concordance metrics (e.g. R<sup>2</sup>) compared to other cell types but had similar absolute errors (i.e. MAE). This is likely due to the fact that the total range of proportions of monocytes, for instance, from the collected data was small such that these errors could make it difficult to correlate the predicted and true cell type proportions. Alternatively, issues with the purity of the reference monocytes could complicate reference-library calibration. A similar overlap test was conducted between the <italic>MethylNet</italic> SHAP CpGs and IDOL-derived L-DMR CpGs (Supplementary Figure <xref rid="MOESM1" ref-type="media">5</xref>). Little overlap was found between the two sets, as only the B-cells were able to capture more than 10% of the IDOL CpGs. This does not indicate that <italic>MethylNet</italic> could not identify CpGs that are cell-type specific. Rather, this finding serves to indicate that models with different optimization objectives and number of features available differentially attribute CpGs.</p>
      <p id="Par33">To this point, we still do not know at what point do CpGs, across individuals or larger groupings reach statistical significance and thus warrant additional inspection. Some preliminary analysis can be found in the Supplementary Figures <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>. For the Hannum and IDOL analysis, we set this at an arbitrary cutoff value of the top 1000 CpGs per age/cell-type group, but the distribution of these Shapley scores and their fidelity to model predictions is an active area of research [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Pan-cancer prediction results</title>
      <p id="Par34">Finally, motivating uses of MethylNet as a mechanism to uncover sources of disease heterogeneity and the capability of the workflow to capture features that are tissue-specific, MethylNet was employed to make predictions of 32 cancer subtypes (<italic>n</italic> = 1676) (one removed due to low sample size) across the pan-cancer TCGA cohort. This analysis yielded 0.97 accuracy, 0.97 precision, 0.97 recall and 0.97 F1-score, averaged across the different subtypes (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a) (training and validation performance in Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). These results outperform a support vector machine (SVM)-based classification approach, in which <italic>MethylNet</italic> demonstrated a 0.15-unit (18%) increase in F1-score. A breakdown of classification accuracies for each subtype is in the supplemental results (Supplementary Tables <xref rid="MOESM1" ref-type="media">8</xref> and <xref rid="MOESM1" ref-type="media">9</xref>). We also report on how predictive accuracy scales with dataset size in the supplementary materials (Supplementary Figures <xref rid="MOESM1" ref-type="media">8</xref>–<xref rid="MOESM1" ref-type="media">9</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Results on test set for pan-cancer sub-type predictions: <bold>a</bold> Comparison of MethylNet derived pan-cancer classification of test set (<italic>n</italic> = 1676) to UMAP+SVM method. 95% confidence intervals for each score were calculated using a 1000 sample non-parametric bootstrap; <bold>b</bold> Hierarchical clustering of average embedding cosine distance between all pairs of cancer subtypes. Cancer subtypes from both axes are colored by cancer superclasses, derived using the hierarchical clustering method. The clustering of similar MethylNet embeddings is concordant with known biology of tissue/cancer type difference. Skin and connective tissue cancers, and bile and liver cancers in Cluster 1. All kidney cancers in Cluster 2. Bladder, uterine and cervix cancers in Cluster 3. Pairing of colon and rectal cancers, both adrenal cancers in Cluster 4. A tie between lung adenocarcinoma and mesothelioma in Cluster 5, both of which may develop in similar locations. Pairings between stomach and esophagus cancer, and pancreas and prostate cancers in Cluster 6. Brain cancers in Cluster 7. Thymoma, Diffuse Large B-Cell lymphomas in Cluster 8. While the lung cancers were not paired together, they experienced a high degree of embedded similarity. The connectivity between the lung squamous cell cancer and its neighboring types prevented the two cancers from being grouped together</p></caption><graphic xlink:href="12859_2020_3443_Fig4_HTML" id="MO5"/></fig></p>
      <p id="Par35">The latent profiles derived for pan-cancer subtypes given the model training on this predictive task showed clustering with high concordance to known cancer type differences. Thresholding a hierarchical clustering of the average cosine distance between cancer subtypes from the <italic>MethylNet</italic> derived embeddings (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>) indicates clustering of the test methylation profiles by eight unsupervised biologically corresponding superclasses. The subtypes that define these larger groupings are concordant with expectations from tissue differences in cancer biology. Taken together, <italic>MethylNet</italic> not only makes highly accurate and robust classification predictions, but also extracts latent features with high fidelity to the biology of tissue or cancer type difference.</p>
      <p id="Par36">The similarity between some of the subtypes may explain why and how certain subtypes did not perform as well compared to others (Supplementary Tables <xref rid="MOESM1" ref-type="media">8</xref> and <xref rid="MOESM1" ref-type="media">10</xref>). For instance, we see that 4 KIRC and KIRP cases were conflated with each other. In addition, two cervix cases were predicted to be uterine. There were elevated rates of misclassification between the colon and rectal cancer pairings and esophageal, head and neck, and stomach cancer pairings. Finally, seven predicted glioblastoma cases were actually low-grade glioma (Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>). Thus, subtypes tended to be misclassified only within each superclass. The exception to this trend was the misclassification of lung squamous cell carcinomas, four of which were predicted to be its adenocarcinoma counterpart, which is consistent with the shared embedding profile, and likely reflects similar biology of cellular lineage.</p>
      <p id="Par37">For the cancer subtype analysis, we sought to identify concordance between the latent profiles of methylation across cancer types. Because each tumor type has a different baseline DNAm profile for its normal tissues-of-origin, and these differences are expected to contribute to the prediction, we decided not to attempt derivation of the salient CpGs for each subtype’s prediction.</p>
    </sec>
    <sec id="Sec8">
      <title>EWAS application, preliminary subtyping and external validation</title>
      <p id="Par38">Given the success of <italic>MethylNet</italic> to capture nonlinear interacting features that cluster, recapitulate and assist with predictions, we sought to evaluate <italic>MethylNet</italic> on the Liu data for the prediction of smoking status (current vs. never smoker) and compare the results to a prior robust EWAS meta-analysis [<xref ref-type="bibr" rid="CR37">37</xref>]. <italic>MethylNet</italic> achieved 73% accuracy in predicting smoking status despite relatively small training (<italic>n</italic> = 139), validation (<italic>n</italic> = 19) and held-out test sets (<italic>n</italic> = 30) (Supplementary Figure 10). There was a significant correlation between the rank of CpGs most important in differentiating smoking status found through MethylNet (average SHAP ranking for each CpG) and the rank of the CpGs significantly associated with smoking using a significantly larger dataset by Joehanes et al. (<italic>r</italic> = 0.69; <italic>p</italic>-value = 0 for statistical test of non-correlation) (Supplementary Figure 10). The preservation of these ranks indicates that <italic>MethylNet</italic> can form associations with outcomes that are concordant to known EWAS analyses, even though it places more emphasis on interacting features versus the traditional EWAS.</p>
      <p id="Par39">We have also conducted a preliminary subtyping classification of the PAM50 subtypes of breast cancer and preliminary validation of <italic>MethylNet</italic> age prediction on an external cohort, the results of which are included in the supplementary materials (Supplementary Table 11; Supplementary Figure 11). Data was acquired from GEO accessions GSE40279, GSE84207, and GSE75067 [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par40">Here, we introduce <italic>MethylNet</italic>, a modular deep learning framework that is easy to train, apply, and share. <italic>MethylNet</italic> employs an object-oriented application programming interface (API) and has built-in functionality to easily switch between analyses with respect to embedding, generation, classification, and regression tasks. We demonstrate <italic>MethylNet’s</italic> ability to capture features that recapitulated the original DNAm data and generated accurate predictions that conform with expected biology. <italic>MethylNet</italic> extends previous approaches by fine-tuning the feature extractor and adding additional layers for prediction tasks. It also employs a robust hyperparameter search method that optimizes the parameters of the model for generalization to unseen data. The pipeline is flexible to the demands of the user. For instance, if a user only wanted to train a custom machine learning model on the latent features, the data can be extracted before the end-to-end training step. By demonstrating the ability to meaningfully encode DNAm features, predictive performance on four tasks; age prediction, cell-type deconvolution, pan-cancer subtype prediction, and concordance to the results of a known EWAS meta-analysis; we present further support of the applicability of VAEs for feature extraction, and more evidence that deep learning presents an opportunity for learning meaningful biology and making accurate predictions from feature-rich molecular data.</p>
    <sec id="Sec10">
      <title>Strengths, limitations, and future directions</title>
      <p id="Par41">Interpretation of our high dimensional models still has challenges, partially due to the drawbacks of assigning feature attributions to high dimensional multi-collinear data. While traditional linear models can still be highly predictive, multi-collinearity has the effect of adjusting the coefficients of the predictors such that the results are not as interpretable. Shapley feature attributions are a promising method used to explain predictions estimating complex models with simpler linear ones as we able to demonstrate agreement between age groups and cell lineages and concordance between ranked SHAP scores and ranked <italic>p</italic>-values of CpGs associated with smoking status of a large EWAS meta-analysis.</p>
      <p id="Par42">Our age and cell-type analyses were conducted to demonstrate the capabilities of the deep learning tool and models were trained on a relatively small study of blood samples, only a subset of those included in the Horvath framework.</p>
      <p id="Par43">Further work can capture features indicative of age acceleration, a popularized prognostic indicator tied to the residual between the predicted and actual age. Since initial publications in 2013, investigators have started using the difference between chronologic and predicted DNAm age to investigate questions related to so called biological age or age acceleration [<xref ref-type="bibr" rid="CR40">40</xref>]. This area of epigenetics is moving towards understanding the relation of the age residual with disease risk, and potential to modify it through intervention (e.g. diet and exercise). More advanced treatment of the data underlying prediction of age will allow opportunities for mechanistically informed intervention studies that aim to reduce age acceleration and improve public health [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
      <p id="Par44"><italic>MethylNet</italic> methodology presents alternative framework to uncover functional gene regulation that accounts for biological age acceleration and goes beyond the limited set of features used to predict methylation age in Horvath, Hannum, and other DNA methylation clocks. As the biology of these clocks are still being discovered [<xref ref-type="bibr" rid="CR41">41</xref>] and due to the non-linear relationship with both chronological age [<xref ref-type="bibr" rid="CR42">42</xref>] and other biomarkers of cell epigenetic cell maturation [<xref ref-type="bibr" rid="CR43">43</xref>], further examination of age acceleration and biology should be done through neural networks.</p>
      <p id="Par45">Our analyses also only presented predictions across one type of tissue without yet accounting for differences in methylation between cell types. <italic>MethylNet</italic> was shown to capture some of the remaining sources of cellular heterogeneity, which can include differential methylation of cell subtypes and states that are known to exist, but for which we do not currently have L-DMRs. <italic>MethylNet</italic> represents an opportunity to improve reference-based and reference-free deconvolution approaches. More robust and consistent estimators that address current limitations of DNAm-based deconvolution approaches will be the focus of future applications of the <italic>MethylNet</italic> method.</p>
      <p id="Par46">Prior works that have explored pan-cancer prediction in the deep learning space have limited their analyses to a small set of CpGs that do not capture a holistic understanding of interaction and regulation in the cancer context [<xref ref-type="bibr" rid="CR44">44</xref>]. Our results demonstrate that models with a larger number of CpGs are needed to accurately capture differences in tissue/cancer subtypes. Since <italic>MethylNet</italic> captures and confounds the biology between similar conditions, it presents an opportunity to explore similar therapeutic targets and treatments across disease types of similar tissue, within and outside cancer studies. Given the ability of <italic>MethylNet</italic> to capture the differences in the profiles between the cancer subtypes, there is great opportunity to better understand heterogeneity of other diseases.</p>
      <p id="Par47">Our analyses refrain from uncovering relationship between the discovered CpGs and functional effects because of the difficulties associated with localizing the effect of a small set of CpGs of interest. Once the salient attributions are found, CpG analyses experience common pitfalls when trying to match CpGs to their nearest gene via the found promoter region. Such analyses may ascribe the CpG’s effect in the context of what gene they appear to be regulating. However, genes are also regulated at a distance in the 3D topological space by interacting with enhancer regions [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Thus, enrichment methods based on individual gene to CpGs relationships implemented in missMethyl [<xref ref-type="bibr" rid="CR47">47</xref>] may not be suitable for interpreting loci identified by <italic>MethylNet.</italic> Ideally, downstream approaches to add biological interpretation would take into account chromosome/genome interaction (e.g. through use of Hi-C data) and genome topological structure/organization. For instance, enrichment from chromatin state and histone modifications present in the target loci as used by ChromHMM and LOLA [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>] might be more warranted. Some model result interpretation issues may be partially circumvented by integrating gene expression data into the model or more structurally by building a deep learning mechanism to predict gene expression from DNA methylation using other layers of information from the genomic context [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par48">An important take-away is that as interpretation methods for these high dimensional data are pioneered, VAE-based deep learning models will likely find CpGs that interact in ways we would not traditionally think about. While the other models were trained on a much smaller set of CpGs, <italic>MethylNet</italic> is able to make its predictions on 200-300 K CpGs, capturing complex interactions between a much larger set of CpGs. Crucial next steps should address these interpretability and confounding concerns through feature selection, covariate adjustment and more biologically interpretable informatics methods for CpG interpretation.</p>
      <p id="Par49">Finally, to scale up <italic>MethylNet’s</italic> deep learning workflows to production grade as well as incorporate information from Whole Genome and Reduced Representation Bisulfite Sequencing, future renditions may utilize common workflow language (CWL) [<xref ref-type="bibr" rid="CR51">51</xref>]. In addition, new Bayesian search methods may be employed to better automate the selection of model hyperparameters and automate the construction of the ideal neural network architecture [<xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR53">53</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p id="Par50">We demonstrate a modular, reproducible, and easy-to-use object-oriented deep learning framework for methylation data: <italic>MethylNet</italic>. We illustrate that <italic>MethylNet</italic> captures meaningful features that can be used for future unsupervised analyses and achieves high predictive accuracy across age estimation, cell-type deconvolution, cancer subtype, and smoking status prediction tasks. <italic>MethylNet’s</italic> accuracy at these tasks was superior, or at least equivalent to, other methods and interpretations of the model’s outputs demonstrated agreement with prior literature. We hope that <italic>MethylNet</italic> will be used by the greater biomedical community to rapidly generate and evaluate testable biological hypotheses involving DNA methylation data through a scalable, automated, intuitive, and user-friendly deep learning framework.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <p id="Par51">Our approach uses a few simple commands, all of which can be executed for any prediction task. First, deep learning prediction models are pre-trained using variational auto-encoders, and the layers of the encoder are used to extract biologically meaningful features. These neural network layers are used to embed the data and extract features for clustering in the unsupervised setting, generating new data with high fidelity to the original source, and for prediction model pretraining. Second, prediction layers are included downstream of the encoder which fine-tune the model’s prediction and feature extraction layers end-to-end for the tasks of multi-output regression and classification. Training prediction layers optimize the neural network for prediction tasks. Third, autonomous hyperparameter scans are performed to optimize the model parameters for the first and second tasks while generating rich visualizations of the data. Lastly, the contribution of the CpGs to each prediction on varying degrees of granularity are determined through Shapley Feature Attribution methods.</p>
    <p id="Par52"><italic>MethylNet</italic> is implemented as a UNIX/Linux command-line tool that allows users to make deep-learning predictions on methylation data with use cases such as embedding, generation, classification and regression. With the specification of a single command-line option, <italic>MethylNet</italic> can be toggled between regression and classification tasks to address a wide breadth of problems. The modular, accessible characteristic of the MethylNet framework enables a simple procedure to train and produce results across multiple domains. In addition to predictive tasks, <italic>MethylNet</italic> can encode data into lower-dimension space from which to perform unsupervised clustering when researchers do not have labeled DNAm data. Further, MethylNet can generate realistic synthetic data with high fidelity relative to the original samples.</p>
    <sec id="Sec13">
      <title>Description of framework</title>
      <p id="Par53">Here, we present a description of a modular and highly accessible framework for deep learning tasks pertaining to unsupervised embedding, supervised classification and multi-output regression of DNA methylation (DNAm) data. The <italic>MethylNet</italic> pipeline is comprised of subcommands specifically pertaining to embedding, prediction, and interpretation. We have included the minimal set of commands to run the workflow in the supplementary materials under the section “Example Code to Run Pipeline”.</p>
      <p id="Par54">First, after preprocessing using <italic>PyMethylProcess</italic>. The dataset is split into training, validation, and testing sets using <italic>train_test_val_split</italic> of the preprocessing pipeline utilities.</p>
    </sec>
    <sec id="Sec14">
      <title>Training the feature extractor to embed data</title>
      <p id="Par55">An embedding routine is used to pretrain the final prediction model by using Variational Autoencoders to find unsupervised latent representations of the data. Pre-training is an important part of transfer-learning applications. The knowledge extracted from learning unsupervised representation of the data is used towards learning predictive tasks with a lower data requirement. Data fed into these VAEs pass through an encoder network that serves to compress the data and then this compressed representation is fed into a decoder network that attempts to reconstruct the original dataset while attempting to generate synthetic samples. The model attempts to balance the ability to generate synthetic samples with the ability of the data to be accurately reconstructed. The weight given to generation versus reconstruction can be set as a hyperparameter [<xref ref-type="bibr" rid="CR54">54</xref>]. Generating synthetic training examples are important for adding noise while training a network for prediction tasks, a component which serves as a form of regularization to make the algorithm more generalizable to real-world data. While synthetic data can be generated using <italic>MethylNet</italic> via the <italic>generate_embed</italic> command, this generative process is meaningfully utilized during training, when the algorithm samples from the latent distribution of the embedded data to regularize. Nevertheless, the ability to reconstruct the original dataset is important because it governs how latent representations of the data are capturing features that properly describe the underlying signal.</p>
      <p id="Par56">In order to perform embeddings on the input <italic>MethylationArray</italic> training and validation objects, <italic>perform_embedding</italic> command is executed via the command line interface. Hyperparameters of the autoencoder model can be scanned via the <italic>launch_hyperparameter_scan</italic> command. This randomly searches a grid of hyper-parameters and randomly generates neural network topologies (number of layers, number of nodes per layer). The complexity (network width and depth), of which can be weighted by the user. The framework stores the results of each training run into logs to find the model with the lowest validation loss (Binary Cross Entropy reconstruction loss plus KL-Loss of the validation set) (hyperparameters with lowest validation loss can be found in Supplementary Table 12). Alternatively, results from the embedding routine can be input into any machine learning algorithm of choice. Embedding results are visualized through interactive 3-D plots by running <italic>transform_plot</italic> from <italic>PyMethylProcess</italic>.</p>
    </sec>
    <sec id="Sec15">
      <title>Training for prediction via transfer learning</title>
      <p id="Par57"><italic>MethylNet</italic> can be used to perform classification, regression, and multi-output regression tasks via the prediction subroutine, which applies a transfer learning technique via the Python class <italic>MLPFinetuneVAE</italic> to fine-tune encoding layers of VAE model while simultaneously training a few appended hidden layers for prediction. A description of transfer learning has been included in the supplementary materials (see “Further Description of Transfer Learning Application”). We have also included an implementation of the multi-layer perceptron that can be trained within our framework which does not utilize transfer learning from the encoder. The <italic>make_prediction</italic> subcommand is run for these prediction tasks, and hyper parameters such as model complexity and learning rate and schedulers are scanned via the <italic>launch_hyperparameter_scan</italic> subcommand (hyperparameters with lowest validation loss can be found in Supplementary Table 13). The final model is chosen if it has the lowest validation loss (Mean Squared Error for Regression, Cross-Entropy for Prediction), and the output model is a snapshot at the epoch that demonstrated the lowest validation loss. The test set is also evaluated immediately after the model is trained using the training set. The results from <italic>MethylNet</italic> can be immediately benchmarked and compared for performance to other machine learning algorithms, which can be evaluated using the <italic>general_machine_learning</italic> subcommand from <italic>PyMethylProcess</italic>. Furthermore, ROC Curves and classification resorts can be output using <italic>plot_roc_curve</italic> and <italic>classification_report</italic> and regression reports are generated via <italic>regression_report.</italic> A confusion matrix of misclassifications can be generated from <italic>PyMethylProcess</italic>’s <italic>plot_heatmap</italic>. Finally, the training curves for both the embedding and prediction steps can be visualized using the <italic>plot_training_curve</italic> subcommand (example prediction embedding plots found in Supplementary Figure 12; analysis training curves can be found in Supplementary Figure 13).</p>
    </sec>
    <sec id="Sec16">
      <title>Interpretation of results</title>
      <p id="Par58">Predictions from <italic>MethylNet</italic> can be interrogated in two ways. The first approach uses SHAPley feature attribution to assign a contribution score to each CpG based on how much it contributed to the prediction. The second approach compares learned clusters of embeddings of methylation samples (and corresponding subtypes), for biological plausibility.</p>
      <p id="Par59">The SHAPley value interpretations, available using <italic>methylnet-interpret</italic> approximate the more complex neural network model using a linear model for each individual prediction, the coefficients of which are Shapley values. Shapley values represent the contributions of each CpG to the individual predictions. They are produced after the prediction model and test <italic>MethylationArray</italic> are input to the <italic>produce_shapley_data</italic> command, which dumps a <italic>ShapleyData</italic> object into memory. The Shapley coefficients can be averaged by condition to yield summary measures of the importance of each CpG to the coarser category, and the coefficients can be clustered to demonstrate the similarity between methylation subtypes and coarser conditions, which can be compared to known biology.</p>
    </sec>
    <sec id="Sec17">
      <title>Description of experiment</title>
      <p id="Par60">We evaluated our <italic>MethylNet</italic> framework (hyperparameter scan, embedding, fine-tuning predictions, interpretation) using 34 datasets from <italic>n</italic> = 9500 samples for four different prediction tasks: classification (TCGA pan-cancer subtype and smoking prediction), regression (age prediction), and multi-output regression (cell-type deconvolution).</p>
      <p id="Par61"><italic>PyMethylProcess</italic> was used to preprocess the data, and yielded <italic>MethylationArray</italic> objects that contain a matrix of beta values for each individual and the corresponding phenotype information [<xref ref-type="bibr" rid="CR15">15</xref>]. The <italic>MethylationArray</italic> data for each of these three experiments were split into 70% training, 20% testing, and 10% validation sets. The training set was used to update the parameters of the model. The validation set was used to terminate training early and choose hyperparameters that would be most generalizable to a test set. The test set was used for final model evaluation and interpretation. More information on model training can be found in the supplementals. For each score, 95% confidence intervals were computed using a one thousand sample non-parametric bootstrap.</p>
      <p id="Par62">First, <italic>MethylNet</italic>’s generative analysis was conducted on 8 arrays representing 8 groupings of features of the Johansson data, found by running a KMeans clustering algorithm on a UMAP clustering of CpG Methylation profiles. Each group was trained using a 50-job VAE hyperparameter scans to yield the ideal embedding. A <italic>generate_embed</italic> command was used to first embed methylation profiles and then decode them to their predicted values. All of the beta values of the CpGs of the individuals of the test set were compared to those found by generating the data from the latent embeddings.</p>
      <p id="Par63"><italic>MethylNet</italic> was then configured for regression tasks and applied to derive sample age estimates in the Johansson data, using the reported chronological age as the ground truth. These results were compared to those derived from the Hannum and Horvath clocks using <italic>cgageR</italic> [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. The Shapley framework was employed to quantify the importance of the CpGs in making predictions for age across 8 different age groups split by 10-year increments. The CpG importance was compared between the groups through hierarchical clustering to find similarities between the age groups. The one thousand most important CpGs from each group were extracted and overlapped with CpGs defined by the Hannum model to depict the concordance of important CpGs between <italic>MethylNet</italic> and the Hannum model.</p>
      <p id="Par64">For a second task, <italic>MethylNet</italic> was configured for multi-target regression to estimate cell-type proportions. First, <italic>estimateCellCounts2</italic>, using the 450 K legacy IDOL optimized library [<xref ref-type="bibr" rid="CR12">12</xref>], was used to deconvolve the cell-type proportions from each sample to develop our best proxy to ground truth outcomes for training the model. The <italic>MethylNet</italic> model was trained on the <italic>estimateCellCounts2</italic> estimates of cell-type proportions for six different immune cell-types. <italic>MethylNet</italic> was then compared to results derived from applying the 350 IDOL derived CpGs legacy library from FlowSorted.Blood.EPIC [<xref ref-type="bibr" rid="CR56">56</xref>] using two different deconvolution methods Robust Partial Correlations (RPC) and Cibersort implemented in <italic>EpiDISH</italic> [<xref ref-type="bibr" rid="CR57">57</xref>]. The importance of each CpG to each cell-type was then quantified through SHAP. These Shapley coefficients were compared using hierarchical clustering. A similar clustering profile would indicate these cell-types share similar driving CpGs, and recovery of the cell-lineage dendrogram would demonstrate concordance with known biology. The one thousand most important CpGs from each cell-type were extracted and overlapped with the IDOL CpGs to inspect if the two models picked up similar cell-type-specific CpGs. Additional details regarding SHAP can be found in the supplementary material.</p>
      <p id="Par65">In the next task, <italic>MethylNet</italic> was used to classify samples to cancer types. The data for the classification task are from 8891 TCGA-acquired samples, representing 32 different cancer types (Supplementary Figure <xref rid="MOESM1" ref-type="media">1</xref> and supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM1" ref-type="media">2</xref>), and preprocessed using <italic>PyMethylProcess</italic> to yield a 200 k CpG beta matrix. The features with the highest mean absolute deviation across samples were selected to both limit the computational complexity, memory of model training and capture the highest variation in the data. The highly variable sites are assumed to be more biologically meaningful than the lower variable sites. The <italic>MethylNet</italic> analysis pipeline was conducted on the pan-cancer dataset. The results from <italic>MethylNet</italic> were compared to a popular omics classification approach, a uniform manifold approximation and projection (UMAP) embedding of the samples, followed by support vector machine (SVM) classification. UMAP is an effective way to reduce the dimensionality of the data as well as preserve meaningful local and global structure in the data [<xref ref-type="bibr" rid="CR58">58</xref>, <xref ref-type="bibr" rid="CR59">59</xref>]. Both were performed using <italic>PyMethylProcess’s general_machine_learning</italic> subcommand, which executed a hyperparameter grid search of the SVM model. Finally, the embeddings of the different cancer subtypes were compared by calculating of the average cosine distance between clusters in the test samples. These distances were clustered using hierarchical clustering to form larger superclasses of cancer that demonstrate a shared embedding profile.</p>
      <p id="Par66">A sensitivity analysis was conducted to understand how <italic>MethylNet</italic> scales with number of training samples and features. The TCGA cohort dataset was utilized and split into <italic>MethylationArray</italic>s of increasing number of features, scaled almost logarithmically for low number of features and then number of features were scaled linearly. This generated sixteen separate datasets. These datasets were trained in parallel with 100-job hyperparameter scans to yield final predictions. The sensitivity analysis on training set size split up the training set into 10% increments from 10 to 100%, and each of the 10 sets were trained using 150-job hyperparameter scans. The number of training epochs was reduced to 50 for each analysis to limit the computational compute time.</p>
      <p id="Par67">Finally, a 100-job hyperparameter scan was conducted to predict smoking status on the Liu data. Gradient-based SHAPley estimates were acquired using SHAP. The CpG SHAP score for the test set samples were subset by the CpGs significantly associated with smoking identified by Joehanes et al. 2016. The average rank of the highest absolute SHAPly score for each CpGs across individuals were compared to the rank of CpGs most significantly associated with smoking reported by Joehanes et al. 2016. Correlation of these rank orders was determined through Pearson’s correlation coefficient and a non-correlation statistical test was employed to find a <italic>p</italic>-value for the relationship.</p>
    </sec>
    <sec id="Sec18">
      <title>Code availability statement</title>
      <p id="Par68"><italic>MethylNet</italic> was built using Python 3.6 and utilizes the PyTorch framework to run its deep learning models on GPUs using CUDA, although CPUs are also supported. The workflow is available as an easily installable command line tool and API via PyPI as <italic>methylnet</italic> and on Docker [<xref ref-type="bibr" rid="CR60">60</xref>] as <italic>joshualevy44/methylnet</italic>. The Docker image contains a test pipeline that requires one line to run through the hyperparameter training and evaluation of all framework components and can run on your local personal computer in addition to high performance computing. Help documentation, example scripts, and the analysis pipeline are available in the <italic>MethylNet</italic> GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/Christensen-Lab-Dartmouth/MethylNet">https://github.com/Christensen-Lab-Dartmouth/MethylNet</ext-link>). Code Ocean is an online platform for the sharing of reproducible research, computational tools, and test pipelines amongst members of the scientific community. After providing the necessary workflow specification, researchers are able to access and execute the uploader’s code to test its capabilities or run their own analyses. Tests of our pipeline’s functionality can be conducted on Code Ocean at: 10.24433/CO.6373790.v1 .</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3443_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Supplementary Table 1</bold>. Male to Female Ratio Across Both Datasets. <bold>Supplementary Figure 1.</bold> Distribution of Age Across Datasets. <bold>Supplementary Table 2.</bold> Number of Samples for Each Cancer Subtype in Training, Validation, and Test Sets. <bold>Supplementary Figure 2.</bold> a) Visual flow diagram of method used to find CpG groupings and recapitulation of DNAm profiles. First, the 300 k CpGs are projected into a 6-dimensional embedding using UMAP. Each point in the low dimensional space represents a CpG and proximity between points denotes a shared methylation profile across all of the training samples (<italic>n</italic> = 503). Then, KMeans clustering was used to find 25 clusters of CpGs with similar profiles. The number of clusters of CpG features were reduced to 8 by filtering out clusters if their variance was above 1 in the 6D space. After that, the CpG features found in each cluster were used to select CpGs to form independent MethylationArrays across the training, validation and test sets. Finally, one autoencoder was trained per each array and the test samples were recapitulated and compared to the original input data; b) Descriptive statistics for final groupings of CpGs and recapitulation scores for each resultant set of CpGs versus the original methylation profiles input into each model. <bold>Supplementary Figure 3.</bold> Generated/recapitulated beta values versus original beta values for each CpG per individual of the held-out test set (<italic>n</italic> = 144); b)-f) corresponds to each of eight chosen clusters in order of low to high cluster variance as previously described; a) is an aggregation of the generated/recapitulated versus true beta values of all of the CpG clusters. <bold>Supplementary Figure 4.</bold> Hierarchically clustered cosine distance matrix between test samples’ VAE-embedded methylation profiles of the held-out test set for the TCGA cohort, colored by: a) Labels assigned to the hierarchical clustering labels for the samples; b) Original TCGA cancer labels; c) RPMM-derived clustering labels on 20 k CpGs. Agreement scores between the RPMM and hierarchal clustering results and the original cancer subtypes were calculated using the v-measure, which takes into account the homogeneity and completeness of the labeling. Note that the clustering colors are not the same because the number of clusters is different from the number of cancer labels. <bold>Supplementary Table 3.</bold> MethylNet Results on Training (<italic>n</italic> = 503) and Validation (<italic>n</italic> = 72) Sets for Sample Age Prediction. <bold>Supplementary Table 4.</bold> MethylNet Results on Training (<italic>n</italic> = 503) and Validation (<italic>n</italic> = 72) Sets for Cell Type Deconvolution. <bold>Supplementary Table 5.</bold> MethylNet Results on Training (<italic>n</italic> = 5860) and Validation (<italic>n</italic> = 840) Sets for Pan-Cancer Classification. <bold>Supplementary Table 6.</bold> Tukey’s Studentized Range Tests for identifying which of six hierarchical clusters from unsupervised VAE embeddings differ in cellular proportions; VAE embeddings derived from blood test dataset. <bold>Supplementary Table 7.</bold> Correlation of MethylNet Cellular Proportions to Other Estimation Methods’ Proportions. <bold>Supplementary Figure 5.</bold> Proportion of IDOL CpGs that are Overlapped by the Top 1 k CpGs for Each Cell-Type. <bold>Supplementary Figure 6.</bold> Bar Charts of CpGs with the 10 Largest Shapley Scores for Each Cell-Type, linked by red, blue or green lines if shared across subtype for: a-d) Lymphocytes; e-f) Myeloids. Not sharing top 10 CpGs does not indicate that two cell-types do not share similar CpG profiles. <bold>Supplementary Figure 7.</bold> Bar Charts of CpGs with the 10 Largest Shapley Scores for Age Groups: a) 14–24 and b) 84–94. These CpGs are linked if shared across the age groups, but this does not indicate that they are not shared outside of this top 10 list of CpGs. The top 10 CpGs that are associated with lower age are similar to the older age group; c) Distribution of Shapley Scores for these two age groups. CpG contributions tend to be negative for the younger age groups and positive for the older age groups. <bold>Supplementary Table 8.</bold> Confusion Matrix Pan-cancer Classification (Colored Superclass). <bold>Supplementary Table 9.</bold> Breakdown Pancancer Classification Results (Colored by Superclass). <bold>Supplementary Table 10.</bold> Average Cosine Distance Between Embeddings of Cancer Subtypes <bold>Supplementary Figure 8.</bold> Micro F1-Scores of the held-out test samples (<italic>n</italic> = 1676) of the TCGA cohort as they relate to: a) the fraction of training samples included for the training process, b) the number of CpGs. Test performance scales linearly with the number of training samples and logarithmically with the number of CpGs. Confidence intervals were calculated using a 1 k nonparametric bootstrap of the test results for each dataset size point in the line plot, and the resulting bootstrapped f1-scores were used to compute the confidence interval for each point in the line plots; c) performance of MethylNet, pretrained using a VAE, is compared to performance using an MLP with the same architecture; F1-Score confidence intervals were derived using a 1 k nonparametric bootstrap; validation loss for each model is compared at the first training epoch and their ultimate convergence point. <bold>Supplementary Figure 9.</bold> V-Measure scores of the held-out test samples (<italic>n</italic> = 1676) of the TCGA cohort as they relate to: a) the fraction of training samples included for the training process, b) the number of CpGs. V-measure scores were derived by applying and comparing hierarchical clustering on the VAE embeddings to known cancer subtype assignments and using a knee point detection algorithm to identify the ideal number of clusters for each tested dataset. In this figure, scores were smoothed using an exponential moving average smoothing technique to illustrate general trends. <bold>Supplementary Figure 10.</bold> Smoking EWAS study via MethylNet: a) final embeddings derived when finetuning the MethylNet VAE demonstrates cluster separation of the “never” versus “current” smokers; b) confusion matrix for the true and predicted “never” versus “current” smokers; c) plotted average ranks found using SHAP for the CpGs that intersected with CpGs identified by Liu et al. versus the ranks of those corresponding <italic>p</italic>-values of the EWAS meta-analysis. <bold>Supplementary Table 11.</bold> Preliminary Results for PAM50 Breast Tumor Classification (<italic>n</italic> = 1018); 95% confidence intervals of scores estimated via 1000-sample non-parametric bootstrap. <bold>Supplementary Figure 11.</bold> Internal and External Validation Cohorts: a) Boxenplot demonstrating distribution of ages for internal and external cohorts; notice how age for external validation cohort is greater than that of the internal validation cohort; b) plotted <italic>MethylNet</italic> predicted age versus actual age. <bold>Supplementary Table 12.</bold> Select Hyperparameters for Embedding Tasks. <bold>Supplementary Table 13.</bold> Select Hyperparameters for Prediction Tasks. <bold>Supplementary Figure 12.</bold> Fine-tuned embeddings (few parts highlighted) for: a) Age Prediction, b) Cell-Type Deconvolution (colored by Neutrophil Cell Type Proportions), and c) Pan-Cancer Classification (Labeled kidney cancers, lung cancers, brain cancers). <bold>Supplementary Figure 13.</bold> Model Training Curves for a) Age Predictions, b) Cell-Type Predictions, c) Pan-Cancer Predictions. Please note that the learning rates for the prediction curve of a) oscillates quickly every 10 training epochs as compared to a larger timescale.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>450 K</term>
        <def>
          <p id="Par4">HumanMethylation450</p>
        </def>
      </def-item>
      <def-item>
        <term>850 K</term>
        <def>
          <p id="Par5">HumanMethylationEPIC</p>
        </def>
      </def-item>
      <def-item>
        <term>ANN</term>
        <def>
          <p id="Par6">Artificial Neural Networks</p>
        </def>
      </def-item>
      <def-item>
        <term>CpG</term>
        <def>
          <p id="Par7">Cytosine-Guanine Dinucleotides</p>
        </def>
      </def-item>
      <def-item>
        <term>CWL</term>
        <def>
          <p id="Par8">Common Workflow Language</p>
        </def>
      </def-item>
      <def-item>
        <term>DNAm</term>
        <def>
          <p id="Par9">DNA Methylation</p>
        </def>
      </def-item>
      <def-item>
        <term>EWAS</term>
        <def>
          <p id="Par10">Epigenome-Wide Association Studies</p>
        </def>
      </def-item>
      <def-item>
        <term>GPUs</term>
        <def>
          <p id="Par11">Graphics Processing Units</p>
        </def>
      </def-item>
      <def-item>
        <term>L-DMR</term>
        <def>
          <p id="Par12">Leukocyte Differentially Methylated Regions</p>
        </def>
      </def-item>
      <def-item>
        <term>RPMM</term>
        <def>
          <p id="Par13">Recursively Partitioned Mixture Models</p>
        </def>
      </def-item>
      <def-item>
        <term>SHAP</term>
        <def>
          <p id="Par14">Shapley Additive Feature Explanations</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par15">Support Vector Machine</p>
        </def>
      </def-item>
      <def-item>
        <term>TCGA</term>
        <def>
          <p id="Par16">The Cancer Genome Atlas</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par17">Uniform Manifold Approximation and Projection</p>
        </def>
      </def-item>
      <def-item>
        <term>VAE</term>
        <def>
          <p id="Par18">Variational Auto-encoders</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-3443-8.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>The conception and design of the study were contributed by JJL and BCC. Implementation, programming, data acquisition, and analyses were by JJL. JJL and BCC wrote the manuscript and all authors contributed to writing and editing of the manuscript. CLP performed the EpiDISH comparisons. AJT, YC, CLP contributed towards refining the analytic plan and direction. AJT, YC, CLP, and JJL tested the pipeline. LAS provided technical support to streamline and debug important aspects of the pipeline. The author(s) read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by NIH grants R01CA216265, R01DE022772, and P20GM104416 to BCC, a Dartmouth College Neukom Institute for Computational Science CompX award to BCC, and training fellowship support for AJT from T32LM012204. CLP and JJL are supported through the Burroughs Wellcome Fund Big Data in the Life Sciences training grant at Dartmouth. The funding bodies above did not have any role in the study design, data collection, analysis and interpretation, or writing of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Data used in this study was acquired from GEO accessions GSE87571, GSE42861, GSE40279, GSE84207, GSE75067, and from The Cancer Genome Atlas (TCGA). Test data is available in our GitHub repository and the data can be tested using Code Ocean at: 10.24433/CO.6373790.v1 .</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par69">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par70">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par71">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning</article-title>
        <source>Nature.</source>
        <year>2015</year>
        <volume>521</volume>
        <fpage>436</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14539</pub-id>
        <?supplied-pmid 26017442?>
        <pub-id pub-id-type="pmid">26017442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Clustering single-cell RNA-seq data with a model-based deep learning approach</article-title>
        <source>Nat Mach Intell</source>
        <year>2019</year>
        <volume>1</volume>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1038/s42256-019-0037-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <?supplied-pmid 30504886?>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Way</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Greene</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Extracting a biologically relevant latent space from cancer transcriptomes with variational autoencoders</article-title>
        <source>Pac Symp Biocomput Pac Symp Biocomput</source>
        <year>2018</year>
        <volume>23</volume>
        <fpage>80</fpage>
        <lpage>91</lpage>
        <?supplied-pmid 29218871?>
        <pub-id pub-id-type="pmid">29218871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Titus AJ, Wilkins OM, Bobak CA, Christensen BC. Unsupervised deep learning with variational autoencoders applied to breast tumor genome-wide DNA methylation data with biologic feature extraction. bioRxiv. 2018. 10.1101/433763.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Travers</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Himmelstein Daniel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beaulieu-Jones Brett</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kalinin Alexandr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Do Brian</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Way Gregory</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Opportunities and obstacles for deep learning in biology and medicine</article-title>
        <source>J R Soc Interface</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>20170387</fpage>
        <pub-id pub-id-type="doi">10.1098/rsif.2017.0387</pub-id>
        <pub-id pub-id-type="pmid">29618526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Krizhevsky A, Sutskever I, Hinton GE. ImageNet classification with deep convolutional neural networks. In: Pereira F, Burges CJC, Bottou L, Weinberger KQ, editors. Advances in neural information processing systems 25: Curran Associates, Inc.; 2012. p. 1097–105. <ext-link ext-link-type="uri" xlink:href="http://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">http://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf</ext-link>. Accessed 10 Jun 2019.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wrensch</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Wiemels</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aging and environmental exposures alter tissue-specific DNA methylation dependent upon CpG island context</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000602</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000602</pub-id>
        <?supplied-pmid 19680444?>
        <pub-id pub-id-type="pmid">19680444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bell</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Baccarelli</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation aging clocks: challenges and recommendations</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>249</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1824-y</pub-id>
        <?supplied-pmid 31767039?>
        <pub-id pub-id-type="pmid">31767039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Titus</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Gallimore</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Salas</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <article-title>Cell-type deconvolution from DNA methylation: a review of recent applications</article-title>
        <source>Hum Mol Genet</source>
        <year>2017</year>
        <volume>26</volume>
        <fpage>R216</fpage>
        <lpage>R224</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddx275</pub-id>
        <?supplied-pmid 28977446?>
        <pub-id pub-id-type="pmid">28977446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Accomando</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Koestler</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>HH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation arrays as surrogate measures of cell mixture distribution</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>86</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-86</pub-id>
        <?supplied-pmid 22568884?>
        <pub-id pub-id-type="pmid">22568884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Salas LA, Koestler DC, Butler RA, Hansen HM, Wiencke JK, Kelsey KT, et al. An optimized library for reference-based deconvolution of whole-blood biospecimens assayed using the Illumina HumanMethylationEPIC BeadArray. Genome Biol. 2018;19. 10.1186/s13059-018-1448-7.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Kile</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Christiani</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ince</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Reference-free deconvolution of DNA methylation data and mediation by cell composition effects</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>259</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1140-4</pub-id>
        <?supplied-pmid 27358049?>
        <pub-id pub-id-type="pmid">27358049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arribas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Esteller</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Validation of a DNA methylation microarray for 850,000 CpG sites of the human genome enriched in enhancer sequences</article-title>
        <source>Epigenomics.</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>389</fpage>
        <lpage>399</lpage>
        <pub-id pub-id-type="doi">10.2217/epi.15.114</pub-id>
        <?supplied-pmid 26673039?>
        <pub-id pub-id-type="pmid">26673039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levy</surname>
            <given-names>Joshua J</given-names>
          </name>
          <name>
            <surname>Titus</surname>
            <given-names>Alexander J</given-names>
          </name>
          <name>
            <surname>Salas</surname>
            <given-names>Lucas A</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>Brock C</given-names>
          </name>
        </person-group>
        <article-title>PyMethylProcess—convenient high-throughput preprocessing workflow for DNA methylation data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>24</issue>
        <fpage>5379</fpage>
        <lpage>5381</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz594</pub-id>
        <?supplied-pmid 31368477?>
        <pub-id pub-id-type="pmid">31368477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angermueller</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>DeepCpG: accurate prediction of single-cell DNA methylation states using deep learning</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>67</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1189-z</pub-id>
        <?supplied-pmid 28395661?>
        <pub-id pub-id-type="pmid">28395661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ni</surname>
            <given-names>Peng</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Neng</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Zhi</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>De-Peng</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Fan</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Yu</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Chuan-Le</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Jianxin</given-names>
          </name>
        </person-group>
        <article-title>DeepSignal: detecting DNA methylation state from Nanopore sequencing reads using deep-learning</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>22</issue>
        <fpage>4586</fpage>
        <lpage>4595</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz276</pub-id>
        <?supplied-pmid 30994904?>
        <pub-id pub-id-type="pmid">30994904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Qiu YL, Zheng H, Gevaert O. A deep learning framework for imputing missing values in genomic data. bioRxiv. 2018. 10.1101/406066.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mo</surname>
            <given-names>Y-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting DNA methylation state of CpG dinucleotide using genome topological features and deep networks</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>19598</fpage>
        <pub-id pub-id-type="doi">10.1038/srep19598</pub-id>
        <?supplied-pmid 26797014?>
        <pub-id pub-id-type="pmid">26797014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>DK</given-names>
          </name>
        </person-group>
        <article-title>Predicting the impact of non-coding variants on DNA methylation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>e99</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx177</pub-id>
        <?supplied-pmid 28334830?>
        <pub-id pub-id-type="pmid">28334830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korfiatis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kline</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Lachance</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Parney</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Buckner</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Erickson</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Residual deep convolutional neural network predicts MGMT methylation status</article-title>
        <source>J Digit Imaging</source>
        <year>2017</year>
        <volume>30</volume>
        <fpage>622</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="doi">10.1007/s10278-017-0009-z</pub-id>
        <?supplied-pmid 28785873?>
        <pub-id pub-id-type="pmid">28785873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <source>Deep Neural Network for Analysis of DNA Methylation Data. ArXiv180801359 Q-Bio Stat</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Islam MM, Tian Y, Cheng Y, Wang Y, Hu P. A deep neural network based regression model for triglyceride concentrations prediction using epigenome-wide DNA methylation profiles. BMC Proc. 2018;12(Suppl 9). 10.1186/s12919-018-0121-1.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Titus</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bobak</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <source>A New Dimension of Breast Cancer Epigenetics - Applications of Variational Autoencoders with DNA Methylation</source>
        <year>2018</year>
        <fpage>140</fpage>
        <lpage>145</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Exploring DNA Methylation Data of Lung Cancer Samples with Variational Autoencoders</article-title>
        <source>2018 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</source>
        <year>2018</year>
        <fpage>1286</fpage>
        <lpage>1289</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Greene</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Parameter tuning is a key part of dimensionality reduction via deep variational autoencoders for single cell RNA transcriptomics</article-title>
        <source>Biocomputing 2019. WORLD SCIENTIFIC</source>
        <year>2018</year>
        <fpage>362</fpage>
        <lpage>373</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lundberg</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S-I</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Guyon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Luxburg</surname>
            <given-names>UV</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wallach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fergus</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vishwanathan</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Unified Approach to Interpreting Model Predictions</article-title>
        <source>Advances in Neural Information Processing Systems 30. Curran Associates, Inc.</source>
        <year>2017</year>
        <fpage>4765</fpage>
        <lpage>4774</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johansson</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Enroth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gyllensten</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Continuous aging of the human DNA Methylome throughout the human Lifespan</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e67378</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0067378</pub-id>
        <?supplied-pmid 23826282?>
        <pub-id pub-id-type="pmid">23826282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Padyukov</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fallin</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hesselberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Runarsson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenome-wide association data implicate DNA methylation as an intermediary of genetic risk in rheumatoid arthritis</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>142</fpage>
        <lpage>147</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2487</pub-id>
        <?supplied-pmid 23334450?>
        <pub-id pub-id-type="pmid">23334450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>R-F</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Karagas</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Wrensch</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based clustering of DNA methylation array data: a recursive-partitioning algorithm for high-dimensional data arising as a mixture of beta distributions</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>365</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-365</pub-id>
        <?supplied-pmid 18782434?>
        <pub-id pub-id-type="pmid">18782434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hannum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Guinney</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sadda</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide methylation profiles reveal quantitative views of human aging rates</article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <fpage>359</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2012.10.016</pub-id>
        <?supplied-pmid 23177740?>
        <pub-id pub-id-type="pmid">23177740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation age of human tissues and cell types</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R115</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-10-r115</pub-id>
        <?supplied-pmid 24138928?>
        <pub-id pub-id-type="pmid">24138928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Zuyun</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>Pei-Lun</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>Steve</given-names>
          </name>
          <name>
            <surname>Crimmins</surname>
            <given-names>Eileen</given-names>
          </name>
          <name>
            <surname>Ferrucci</surname>
            <given-names>Luigi</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>Morgan</given-names>
          </name>
        </person-group>
        <article-title>A new aging measure captures morbidity and mortality risk across diverse subpopulations from NHANES IV: A cohort study</article-title>
        <source>PLOS Medicine</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>e1002718</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1002718</pub-id>
        <?supplied-pmid 30596641?>
        <pub-id pub-id-type="pmid">30596641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soriano-Tárraga</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Giralt-Steinhauer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mola-Caminal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ois</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rodríguez-Campello</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cuadrado-Godia</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological age is a predictor of mortality in ischemic stroke</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>4148</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-22579-0</pub-id>
        <?supplied-pmid 29515201?>
        <pub-id pub-id-type="pmid">29515201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kresovich</surname>
            <given-names>Jacob K</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Zongli</given-names>
          </name>
          <name>
            <surname>O’Brien</surname>
            <given-names>Katie M</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>Clarice R</given-names>
          </name>
          <name>
            <surname>Sandler</surname>
            <given-names>Dale P</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>Jack A</given-names>
          </name>
        </person-group>
        <article-title>Methylation-Based Biological Age and Breast Cancer Risk</article-title>
        <source>JNCI: Journal of the National Cancer Institute</source>
        <year>2019</year>
        <volume>111</volume>
        <issue>10</issue>
        <fpage>1051</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1093/jnci/djz020</pub-id>
        <?supplied-pmid 30794318?>
        <pub-id pub-id-type="pmid">30794318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Joseph A. Shapley regressions: A framework for statistical inference on machine learning models. ArXiv190304209 Cs Econ Stat. 2019; <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1903.04209">http://arxiv.org/abs/1903.04209</ext-link>. Accessed 10 Jun 2019.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joehanes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Just</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Pilling</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Mandaviya</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenetic signatures of cigarette smoking</article-title>
        <source>Circ Cardiovasc Genet</source>
        <year>2016</year>
        <volume>9</volume>
        <fpage>436</fpage>
        <lpage>447</lpage>
        <pub-id pub-id-type="doi">10.1161/CIRCGENETICS.116.001506</pub-id>
        <?supplied-pmid 27651444?>
        <pub-id pub-id-type="pmid">27651444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleischer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tekpli</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mathelier</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nebdal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dhakal</surname>
            <given-names>HP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation at enhancers identifies distinct breast cancer lineages</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1379</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00510-x</pub-id>
        <?supplied-pmid 29123100?>
        <pub-id pub-id-type="pmid">29123100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holm</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Staaf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lauss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lindgren</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bendahl</surname>
            <given-names>P-O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated genomics analysis of epigenetic subtypes in human breast tumors links DNA methylation patterns to chromatin states in normal mammary cells</article-title>
        <source>Breast Cancer Res BCR</source>
        <year>2016</year>
        <volume>18</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1186/s13058-016-0685-5</pub-id>
        <?supplied-pmid 26923702?>
        <pub-id pub-id-type="pmid">26923702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sandler</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Blood DNA Methylation and breast Cancer: a prospective case-cohort analysis in the sister study</article-title>
        <source>JNCI J Natl Cancer Inst</source>
        <year>2020</year>
        <volume>112</volume>
        <issue>1</issue>
        <fpage>87</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1093/jnci/djz065</pub-id>
        <?supplied-pmid 30989176?>
        <pub-id pub-id-type="pmid">30989176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin-Herranz</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Aref-Eshghi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bonder</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Stubbs</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Choufani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weksberg</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Screening for genes that accelerate the epigenetic aging clock in humans reveals a role for the H3K36 methyltransferase NSD1</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>146</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1753-9</pub-id>
        <?supplied-pmid 31409373?>
        <pub-id pub-id-type="pmid">31409373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Snir S, Pellegrini M. Human Epigenetic Aging is Logarithmic with Time across the Entire LifeSpan. preprint. Genomics. 2018. 10.1101/401992.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salas</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Wiencke</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Koestler</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
        </person-group>
        <article-title>Tracing human stem cell lineage during development using DNA methylation</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1285</fpage>
        <lpage>1295</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.233213.117</pub-id>
        <?supplied-pmid 30072366?>
        <pub-id pub-id-type="pmid">30072366</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation markers for Pan-Cancer prediction by deep learning</article-title>
        <source>Genes</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>778</fpage>
        <pub-id pub-id-type="doi">10.3390/genes10100778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nothjunge</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nührenberg</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Doppler</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Preissl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schwaderer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation signatures follow preformed chromatin compartments in cardiac myocytes</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1667</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01724-9</pub-id>
        <?supplied-pmid 29162810?>
        <pub-id pub-id-type="pmid">29162810</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geeleher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hartnett</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Golden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raja Ali</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Seoighe</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Gene-set analysis is severely biased when applied to genome-wide methylation data</article-title>
        <source>Bioinformatics.</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1851</fpage>
        <lpage>1857</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt311</pub-id>
        <?supplied-pmid 23732277?>
        <pub-id pub-id-type="pmid">23732277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Maksimovic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>missMethyl: an R package for analyzing data from Illumina’s HumanMethylation450 platform</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>286</fpage>
        <lpage>288</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheffield</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>LOLA: enrichment analysis for genomic region sets and regulatory elements in R and bioconductor</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>587</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv612</pub-id>
        <?supplied-pmid 26508757?>
        <pub-id pub-id-type="pmid">26508757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Chromatin-state discovery and genome annotation with ChromHMM</article-title>
        <source>Nat Protoc</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>2478</fpage>
        <lpage>2492</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.124</pub-id>
        <?supplied-pmid 29120462?>
        <pub-id pub-id-type="pmid">29120462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Peng J, Ochoa I, Milenkovic O. E2M: A Deep Learning Framework for Associating Combinatorial Methylation Patterns with Gene Expression. bioRxiv. 2019. 10.1101/527044.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Amstutz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Crusoe</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Tijanić</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chilton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heuer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Common Workflow Language, v1.0</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Tim Head, MechCoder, Gilles Louppe, Iaroslav Shcherbatyi, fcharras, Zé Vinícius, et al. scikit-optimize/scikit-optimize: v0.5.2. Zenodo; 2018. doi:10.5281/zenodo.1207017.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Kandasamy K, Neiswanger W, Schneider J, Poczos B, Xing EP. Neural architecture search with Bayesian optimisation and optimal transport. In: Bengio S, Wallach H, Larochelle H, Grauman K, Cesa-Bianchi N, Garnett R, editors. Advances in neural information processing systems 31: Curran Associates, Inc.; 2018. p. 2016–25. <ext-link ext-link-type="uri" xlink:href="http://papers.nips.cc/paper/7472-neural-architecture-search-with-bayesian-optimisation-and-optimal-transport.pdf">http://papers.nips.cc/paper/7472-neural-architecture-search-with-bayesian-optimisation-and-optimal-transport.pdf</ext-link>. Accessed 11 Jun 2019.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Higgins</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Matthey</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burgess</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Glorot</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Botvinick</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>beta-VAE: Learning Basic Visual Concepts with a Constrained Variational Framework</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">metamaden/cgageR: version 0.1.0 from GitHub. <ext-link ext-link-type="uri" xlink:href="https://rdrr.io/github/metamaden/cgageR/">https://rdrr.io/github/metamaden/cgageR/</ext-link>. Accessed 10 Jun 2019.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">FlowSorted.Blood.EPIC. Bioconductor. <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/FlowSorted.Blood.EPIC/">http://bioconductor.org/packages/FlowSorted.Blood.EPIC/</ext-link>. Accessed 20 Jun 2019.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Teschendorff AE, Breeze CE, Zheng SC, Beck S. A comparison of reference-based algorithms for correcting cell-type heterogeneity in Epigenome-wide association studies. BMC Bioinformatics. 2017;18. 10.1186/s12859-017-1511-5.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dutertre</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>IWH</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>LG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>38</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Melville</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction. ArXiv180203426 Cs Stat</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boettiger</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>An introduction to Docker for reproducible research</article-title>
        <source>SIGOPS Oper Syst Rev</source>
        <year>2015</year>
        <volume>49</volume>
        <fpage>71</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1145/2723872.2723882</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
