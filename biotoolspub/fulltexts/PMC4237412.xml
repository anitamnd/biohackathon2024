<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4237412</article-id>
    <article-id pub-id-type="pmid">25409465</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-26469</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0113349</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Scans</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>detectIR: A Novel Program for Detecting Perfect and Imperfect Inverted Repeats Using Complex Numbers and Vector Calculation</article-title>
      <alt-title alt-title-type="running-head">Perfect and Imperfect Inverted Repeat Detection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Congting</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Guoli</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Chun</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Automation, Xiamen University, Xiamen, Fujian 361005, China</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Department of Biology, Miami University, Oxford, Ohio 45056, United States of America</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Innovation Center for Cell Biology, Xiamen University, Xiamen, Fujian 361005, China</addr-line>
    </aff>
    <aff id="aff4">
      <label>4</label>
      <addr-line>State Key Laboratory for Biology of Plant Diseases and Insect Pests, Institute of Plant Protection, Chinese Academy of Agricultural Sciences, Beijing 100193, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tosatto</surname>
          <given-names>Silvio C. E.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universita’ di Padova, Italy</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>liangc@miamioh.edu</email> (CL); <email>glji@xmu.edu.cn</email> (GJ)</corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CL GJ CY. Performed the experiments: CY. Analyzed the data: CY LL. Contributed reagents/materials/analysis tools: CY. Contributed to the writing of the manuscript: CY LL GJ CL.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>11</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>11</issue>
    <elocation-id>e113349</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>10</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Ye et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Ye et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Inverted repeats are present in abundance in both prokaryotic and eukaryotic genomes and can form DNA secondary structures – hairpins and cruciforms that are involved in many important biological processes. Bioinformatics tools for efficient and accurate detection of inverted repeats are desirable, because existing tools are often less accurate and time consuming, sometimes incapable of dealing with genome-scale input data. Here, we present a MATLAB-based program called <italic>detectIR</italic> for the perfect and imperfect inverted repeat detection that utilizes complex numbers and vector calculation and allows genome-scale data inputs. A novel algorithm is adopted in <italic>detectIR</italic> to convert the conventional sequence string comparison in inverted repeat detection into vector calculation of complex numbers, allowing non-complementary pairs (mismatches) in the pairing stem and a non-palindromic spacer (loop or gaps) in the middle of inverted repeats. Compared with existing popular tools, our program performs with significantly higher accuracy and efficiency. Using genome sequence data from HIV-1, <italic>Arabidopsis thaliana</italic>, <italic>Homo sapiens</italic> and <italic>Zea mays</italic> for comparison, <italic>detectIR</italic> can find lots of inverted repeats missed by existing tools whose outputs often contain many invalid cases. <italic>detectIR</italic> is open source and its source code is freely available at: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/detectir">https://sourceforge.net/projects/detectir</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported partially by National Institutes of Health National Institute of General Medical Sciences grant (1R15GM94732-1 A1 to CL), the National Natural Science Foundation of China (61174161, 61375077 and 61201358), the Natural Science Foundation of Fujian Province of China (2012J01154), the specialized Research Fund for the Doctoral Program of Higher Education of China (20130121130004 and 20120121120038), and the Fundamental Research Funds for the Central Universities in China (2013121025, 201412G009 and CBX2014007). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>An inverted repeat is a nucleotide sequence fragment that can form self-complementary pairing between its two halves. The perfect inverted repeats are also known as palindrome where one of these two halves is exactly the reverse complement of the other; in contrast, imperfect inverted repeats contain nucleotide pairs that are not reversely complementary (<italic>i.e.</italic>, mismatched), often with a non-palindromic spacer (loop or gaps) in the middle <xref rid="pone.0113349-Lilley1" ref-type="bibr">[1]</xref>
<xref rid="pone.0113349-Smith1" ref-type="bibr">[2]</xref>
<xref rid="pone.0113349-Strawbridge1" ref-type="bibr">[3]</xref>. Abundant inverted repeats are present in both prokaryotic and eukaryotic genomes with nonrandom distributions, and they are involved in many biological processes including DNA replication <xref rid="pone.0113349-Pearson1" ref-type="bibr">[4]</xref>, DNA transition <xref rid="pone.0113349-Chasovskikh1" ref-type="bibr">[5]</xref> and DNA methylation <xref rid="pone.0113349-Allers1" ref-type="bibr">[6]</xref>. In yeast, long inverted repeats were demonstrated to be mitotic recombination hotspots, and quasipalindromes (imperfect inverted repeats) underwent deletion more frequently <xref rid="pone.0113349-Gordenin1" ref-type="bibr">[7]</xref>. In mouse embryonic stem cells, inverted repeats get involved in the generation of unstable chromosomal rearrangements <xref rid="pone.0113349-Hu1" ref-type="bibr">[8]</xref>. Inverted repeats of &gt; = 6 complementary nucleotides, either perfect or imperfect, can form secondary structures – cruciforms in double stranded DNA <xref rid="pone.0113349-Brzda1" ref-type="bibr">[9]</xref>. Some DNA-binding proteins have their two binding sites arranged as in an inverted repeat <xref rid="pone.0113349-Strawbridge1" ref-type="bibr">[3]</xref>
<xref rid="pone.0113349-Pearson1" ref-type="bibr">[4]</xref>
<xref rid="pone.0113349-Bhattacharya1" ref-type="bibr">[10]</xref>. Using atomic force microscopy images, the DNA-binding protein PARP-1 was shown to bind the cruciform structure generated by a 106-<italic>nt</italic> inverted repeat within an <italic>E. coli</italic> plasmid <xref rid="pone.0113349-Chasovskikh1" ref-type="bibr">[5]</xref>. PARP-1 was found to participate in chromatin structure coordination and gene expression regulation <xref rid="pone.0113349-Tulin1" ref-type="bibr">[11]</xref>, and it did show a binding preference to cruciform structures than loops or linear DNAs <xref rid="pone.0113349-Brzda1" ref-type="bibr">[9]</xref>. In humans, a 14-<italic>nt</italic> imperfect inverted repeat sequence located in distal promoter region of human HFE gene can form a cruciform structure that binds PARP-1 protein to repress HFE transcription, and increased ion level can trigger PARP-1 breakdown to release such transcriptional repression <xref rid="pone.0113349-Pelham1" ref-type="bibr">[12]</xref>. Interestingly, using 2D electrophoretic analysis of DNA replication intermediates, single-stranded hairpins formed by imperfect inverted repeats with a central non-palindromic spacer, rather than double-stranded cruciforms, proved to be responsible for replication stalling that induces genome instability <xref rid="pone.0113349-Voineagu1" ref-type="bibr">[13]</xref>. On the other hand, as a part of gene expression production, hairpin is a common and important secondary structural element in RNA transcripts, and its single-stranded template DNA must have a relevant inverted repeat <xref rid="pone.0113349-Strawbridge1" ref-type="bibr">[3]</xref>, suggesting that inverted repeats in transcribed DNAs might play a potential regulatory role in resultant RNA transcripts. For instance, in yeast and mammalian pre-mRNAs, inverted repeats located in introns were shown to affect alternative splicing <xref rid="pone.0113349-MartinezContreras1" ref-type="bibr">[14]</xref>
<xref rid="pone.0113349-Nasim1" ref-type="bibr">[15]</xref>
<xref rid="pone.0113349-Howe1" ref-type="bibr">[16]</xref>. Moreover, inverted repeats have been utilized for gene silencing in fungi and plants for many years <xref rid="pone.0113349-Nakade1" ref-type="bibr">[17]</xref>
<xref rid="pone.0113349-Hily1" ref-type="bibr">[18]</xref>
<xref rid="pone.0113349-Wesley1" ref-type="bibr">[19]</xref>. They also delineate transposon element boundaries. For instance, miniature inverted repeat transposable elements (MITEs) are characterized by their terminal inverted repeats <xref rid="pone.0113349-Yang1" ref-type="bibr">[20]</xref>. Genes away from MITEs show higher expression than those that contain or are close to MITEs <xref rid="pone.0113349-Lu1" ref-type="bibr">[21]</xref>. Clearly, the role of inverted repeats in gene expression regulation is worthy of further wet-lab experimental investigation and validation. The identification and characterization of inverted repeats at genome-wide scale will offer an important glimpse and survey that will facilitate our understanding of inverted repeats and their biological functions.</p>
    <p>Lu et al. examined the distribution of perfect inverted repeats (palindromes) in human genome <xref rid="pone.0113349-Lu2" ref-type="bibr">[22]</xref>. They found that palindromes show higher abundance in introns than exons while upstream regions (<italic>i.e.</italic>, 2,000 bp upstream from translational start site) also contain rich palindromes that can serve as binding sites for transcription factors. Interestingly, they also scanned the human genome for imperfect inverted repeats (<italic>i.e.</italic>, near-perfect palindromes of &lt; = 4 mismatches between two halves, with a short spacer in the middle) and found a similar distribution pattern as perfect inverted repeats <xref rid="pone.0113349-Lu2" ref-type="bibr">[22]</xref>. In yeast <italic>Saccharomyces cerevisiae</italic> genome, both palindromes and imperfect inverted repeats (<italic>i.e.</italic>, the pairing stem length &gt;6 <italic>nt</italic> and the spacer length less than 77 <italic>nt</italic>) were significantly richer than randomized genome <xref rid="pone.0113349-Strawbridge1" ref-type="bibr">[3]</xref>. In particular, imperfect inverted repeats with short spacers, which have a greater susceptibility to cruciform extrusion than long spacers, were significantly enriched in intergenic regions near 3′ gene ends than near 5′ gene ends <xref rid="pone.0113349-Strawbridge1" ref-type="bibr">[3]</xref>. Using yeast relatives <italic>S. paradoxus</italic>, <italic>S. mikatae</italic> and <italic>S. bayanus</italic>, Humphey-Dixon and coworkers studied the conservation of both perfect and imperfect inverted repeats in yeast <italic>S. cerevisiae</italic> genome, and they found that both conserved inverted repeats in promoters and inverted repeats in the promoters of highly expressed genes are most frequently located near the transcriptional start sites, indicating their potential function in transcriptional regulation <xref rid="pone.0113349-HumphreyDixon1" ref-type="bibr">[23]</xref>. As more and more genome sequences are available for different species, it is important for us to conduct genome-wide comparative study to determine the distributions, properties, and conservation of inverted repeats among different species, either distantly or closely related, in order to deepen our understanding of inverted repeats and their biological importance.</p>
    <p>To better understand the roles of inverted repeats in genome organization and evolution, developing efficient programs to conduct genome-wide detection of inverted repeats is particularly important. Recently, a MATLAB-based tool <italic>findIR</italic>
<xref rid="pone.0113349-Sreeskandarajan1" ref-type="bibr">[24]</xref> was created for detecting perfect inverted repeats. In comparison with the existing similar tools that adopt conventional string comparison algorithms, <italic>findIR</italic> deployed a novel algorithm that uses prime number scoring system and turns sequence search into the calculation, search and comparison of numbers. Consequently, <italic>findIR</italic> proved to have obviously higher accuracy in detecting perfect inverted repeats than several popular tools, and it was capable of processing genome-scale inputs. Unfortunately, it is difficult to use prime numbers to represent imperfect inverted repeats that contain non-complementary pairs in the pairing stem (<italic>i.e.</italic>, two halves) and a central non-palindromic spacer. The search and validation strategy of <italic>findIR</italic> is not designed for detecting imperfect inverted repeats. Moreover, <italic>findIR</italic> is limited to detect perfect inverted repeats of length shorter than 1,000 <italic>nt</italic> and the robust vector calculation power of MATLAB has not been utilized at all by <italic>findIR</italic> to enhance the program efficiency.</p>
    <p>Here, we developed a novel program <italic>detectIR</italic> that also turns sequence search into numerical calculation and manipulation using complex numbers, which can represent both perfect and imperfect IRs accurately and efficiently. In comparison with <italic>findIR</italic>, the novelty of <italic>detectIR</italic> lies in a novel mapping schema that utilizes complex numbers, a distinctive and effective strategy of search and validation to evaluate candidates of both perfect and imperfect inverted repeats, and the utilization of MATLAB built-in vector calculation power that enables simultaneous detection of inverted repeats of same length to improve the program efficiency significantly.</p>
  </sec>
  <sec id="s2">
    <title>Design and Implementation</title>
    <p>Most existing bioinformatics tools in inverted repeat detection rely on string comparison that is often computational resource demanding and less accurate. Using a novel algorithm that employs prime number scoring system and numerical calculation and search to detect perfect inverted repeats (or palindromes), <italic>findIR</italic> was demonstrated to have much higher accuracy than BioPHP (<ext-link ext-link-type="uri" xlink:href="http://www.biophp.org/minitools/find_palindromes">http://www.biophp.org/minitools/find_palindromes</ext-link>), MATLAB built-in <italic>palindromes</italic> function and EMBOSS <italic>palindrome</italic> tool <xref rid="pone.0113349-Rice1" ref-type="bibr">[25]</xref> in detecting perfect inverted repeats. However, both EMBOSS <italic>palindrome</italic> tool and MATLAB built-in <italic>palindromes</italic> function can detect imperfect inverted repeats that contain a central non-palindromic spacer (loop) and/or non-complementary pairs in the pairing stem. In the core algorithm of <italic>findIR</italic>, nucleotide bases are first mapped to a prime number scoring system in which scores of reversely complementary bases can cancel each other out, and a cumulative score is computed for each base along the whole target sequence. Then, <italic>findIR</italic> searches all the pairs of positions whose cumulative scores are the same to construct candidates of perfect inverted repeats. <italic>findIR</italic> finally validates the candidate based on the principle that if a subsequence is a valid perfect inverted repeat, the number of nested perfect inverted repeats within the subsequence, all of which share the same center, should be equal to the half-length of the subsequence. This search and validation strategy makes <italic>findIR</italic> impossible to detect imperfect inverted repeats. Moreover, the prime number scoring system has its innate difficulty to represent imperfect inverted repeats that often contains a central non-palindromic spacer and/or non-complementary pairs in the pairing stem. In addition, <italic>findIR</italic> is limited to detect perfect inverted repeats of length shorter than 1,000 <italic>nt</italic>, presenting a size constraint for large genomes where longer inverted repeats may exist. Here, we developed a novel program called <italic>detectIR</italic> that maps the nucleotide sequence to a complex number vector so that both perfect and imperfect inverted repeats can be searched (see examples in <xref ref-type="fig" rid="pone-0113349-g001">Figure 1</xref>). Compared with <italic>findIR</italic>, <italic>detectIR</italic> adopted a totally different algorithm in perfect inverted repeat detection, which had been modified and extended to search for imperfect inverted repeats. In particular, for both perfect and imperfect inverted repeat detection, we have taken advantage of MATLAB built-in vector calculation to search and validate inverted repeats candidates of the same size simultaneously. Our program proves to be much faster and more accurate in detecting both perfect and imperfect inverted repeats than the previously mentioned tools. Moreover, our program can accept a large genome input like chromosome 1 of <italic>Homo sapiens</italic> and <italic>Zea mays</italic> that can often result in an execution crash in other tools.</p>
    <fig id="pone-0113349-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0113349.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Examples of imperfect inverted repeats detected in the chromosome 1 <italic>of Arabidopsis thaliana</italic> by <italic>detectIR</italic>.</title>
        <p>Circles highlight the nucleotide bases and numbers represent the start and end genomic coordinates of the imperfect inverted repeats. (A) An imperfect inverted repeat containing only mismatches (un-pairing pair). (B) An imperfect inverted repeat containing both mismatches and a spacer (gaps). (C) An imperfect inverted repeat containing only a spacer (gaps) in the middle. (D) The <italic>detectIR</italic> output for the aforementioned 3 imperfect inverted repeats in the combined format of dot-bracket notation and FASTA. The dots represent the spacer or mismatch nucleotides while brackets indicate the pairing relations. The FASTA description line (<italic>e.g.</italic>, &gt;4483|20|2|0) has the following explanation: &gt;GenomicStartPosition|InvertedRepeatLength|MismatchNumber|GapNumber.</p>
      </caption>
      <graphic xlink:href="pone.0113349.g001"/>
    </fig>
    <p>Within the prime number scoring system (also called cumulative scoring system) implemented in <italic>findIR</italic>
<xref rid="pone.0113349-Sreeskandarajan1" ref-type="bibr">[24]</xref>, a subsequence between two bases whose cumulative scores are identical will be recognized as a perfect inverted repeat candidate. This conclusion is based on the assumption that only the scores between reversely complementary bases can completely eliminate each other in the system. If two bases have identical score, the numbers of reversely complementary bases should be equal in the corresponding subsequence <xref rid="pone.0113349-Sreeskandarajan1" ref-type="bibr">[24]</xref>. Unfortunately, this assumption is not correct for some cases, because scores also can be partly eliminated between non-complementary bases. For instance, when using the prime number mapping schema: A → 3, T → −3, G → 7, C → −7, the scores of seven nucleotides A can be eliminated out by that of three nucleotides C (same to T and G). Therefore, if two bases have an identical accumulative score, the numbers of complementary bases in the corresponding subsequence between them are not always equal. In <italic>findIR</italic>, such a case would be still recognized as a perfect inverted repeat candidate. Although these cases could be filtered out later by the downstream process, it clearly increases the computational workload. On the other hand, these cases can be avoided by using large prime numbers (<italic>e.g.</italic>, 10007, 10009), which was exactly adopted by the <italic>findIR</italic>
<xref rid="pone.0113349-Sreeskandarajan1" ref-type="bibr">[24]</xref>.</p>
    <p>Different from prime numbers, complex numbers can effectively represent both perfect and imperfect inverted repeats that contain non-complementary pairs in the stem and a central non-palindromic spacer. The complex numbers have been utilized in detecting symmetric palindromes (<italic>e.g.</italic>, ACGGCA, the palindromes without reverse complementary) by Gupta et al. <xref rid="pone.0113349-Gupta1" ref-type="bibr">[26]</xref>, using the following mapping schema:<disp-formula id="pone.0113349.e001"><graphic xlink:href="pone.0113349.e001.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
    <p>Firstly, they divided an input nucleotide sequence into subsequences with the length of a desired palindrome, and then utilized this mapping method to convert each subsequence into numerical series and rearranged the subsequence. Secondly, they use periodicity transformation to calculate a periodic sequence that is closest to the rearranged subsequence. Lastly, through calculating a coefficient between the rearranged subsequence and the periodic sequence to determine and verify each subsequence to be a valid symmetric palindrome <xref rid="pone.0113349-Gupta1" ref-type="bibr">[26]</xref>. Therefore, their method was not designed for both perfect and imperfect inverted repeat detection that requires nucleotide reverse complementary. In contrast, our usage of complex numbers is different from their approach by deploying a novel mapping schema:<disp-formula id="pone.0113349.e002"><graphic xlink:href="pone.0113349.e002.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
    <p>Using this mapping method, only the scores between reversely complementary bases can really cancel each other out within the numeric scoring system. This method makes sure that the numbers of reversely complementary nucleotides A and T (also C and G) are equal within the sequence candidates of perfect inverted repeat. Furthermore, we can precisely define the upper bound of the score of the imperfect inverted repeats using this complex number mapping schema - the sum of the absolute values of the real part and the imaginary part of <italic>C</italic> is less than or equal to <italic>m</italic>, <inline-formula><inline-graphic xlink:href="pone.0113349.e003.jpg"/></inline-formula> (<italic>C</italic> denotes the score of the subsequence, <italic>m</italic> represents the maximal number of mismatches allowed – the sum of all nucleotides within the central non-palindromic spacer and the non-complementary pairs in the pairing stem).</p>
    <sec id="s2a">
      <title>Algorithm for perfect inverted repeat detection</title>
      <p>The algorithm for perfect inverted repeat detection is based on the principle that a perfect inverted repeat of length <italic>h</italic> (<italic>h</italic>&gt;4) must contain a nested perfect inverted repeat of length <italic>h</italic>-2, which shares the same center. So if we have obtained all the perfect inverted repeats of length <italic>h</italic>-2, extension of one base at both ends will derive inverted repeat candidates with length <italic>h</italic>. Among all these inverted repeat candidates, we then filter out those whose terminal bases are not reversely complementary.</p>
      <p>The details of our algorithm are shown in <xref ref-type="fig" rid="pone-0113349-g002">Figures 2</xref> and <xref ref-type="fig" rid="pone-0113349-g003">3</xref>. Here, <italic>l</italic> is the minimal length, <italic>L</italic> is the maximal length of perfect inverted repeats to be detected, and <italic>N</italic> is the length of the input sequence <italic>S</italic> (<italic>l</italic> ≤ <italic>L</italic> ≤ <italic>N</italic>, <italic>l</italic> and <italic>L</italic> should be even number).</p>
      <fig id="pone-0113349-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0113349.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Major steps of the core algorithm for perfect inverted repeat detection.</title>
          <p>(A) Map a nucleotide sequence to a complex number vector and calculate its cumulative score value. (B) Calculate the scores of all the subsequences of length <italic>l</italic> (here <italic>l</italic> = 4, <italic>N</italic> is the length of input sequence). (C) Select out perfect inverted repeat candidates and determine valid perfect inverted repeats. (D) Extend one base at both ends of subsequences to obtain longer perfect inverted repeats.</p>
        </caption>
        <graphic xlink:href="pone.0113349.g002"/>
      </fig>
      <fig id="pone-0113349-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0113349.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>The flowchart of the core algorithm for perfect inverted repeat detection.</title>
          <p>Arrows in the same color represent the borders of inverted repeats.</p>
        </caption>
        <graphic xlink:href="pone.0113349.g003"/>
      </fig>
      <sec id="s2a1">
        <title>(1). Mapping sequence to vector</title>
        <p>The input sequence <italic>S</italic> is mapped to a complex number vector <italic>M</italic>. For example, if input sequence <italic>S</italic> is ‘ATCGAACGAATTCGTTAACC’, <italic>M</italic> = [1,-1, j, -j,1, 1, j, -j, 1, 1, -1, -1, j, -j, -1, -1, 1, 1, j, j]. Then the cumulative value <italic>V</italic> of <italic>M</italic> is calculated (<xref ref-type="fig" rid="pone-0113349-g002">Figure 2A</xref>).</p>
      </sec>
      <sec id="s2a2">
        <title>(2). Calculation of subsequence score</title>
        <p>The scores of all the subsequences of length <italic>l</italic> are calculated, a subsequence score is defined as the sum of the subsequence’s corresponding vector. The scores of all the subsequences of length <italic>l</italic> can be obtained by the following formula,<disp-formula id="pone.0113349.e004"><graphic xlink:href="pone.0113349.e004.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>The <italic>i</italic>-th element <italic>C</italic>(<italic>i</italic>) represent the score of the subsequence <italic>S</italic>(<italic>i</italic>:<italic>i</italic>+<italic>l</italic>-1) = <italic>s<sub>i</sub>s<sub>i+</sub></italic>
<sub>1</sub>
<italic>…s<sub>i+l-</sub></italic>
<sub>2</sub>
<italic>s<sub>i+l-</sub></italic>
<sub>1</sub> (<xref ref-type="fig" rid="pone-0113349-g002">Figure 2B</xref>).</p>
      </sec>
      <sec id="s2a3">
        <title>(3). Identification of candidates</title>
        <p>A subsequence whose score is equal to 0 will be recognized as a candidate of perfect inverted repeat. In this step we will identify all the candidates of length <italic>l</italic> by finding the zero elements of <italic>C</italic>,<disp-formula id="pone.0113349.e005"><graphic xlink:href="pone.0113349.e005.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p><italic>P</italic> represents the indices of the zero elements in vector <italic>C</italic>.</p>
      </sec>
      <sec id="s2a4">
        <title>(4). Validation of candidates</title>
        <p>For each perfect inverted repeat candidate, perfect pairing needs to be found between the front half and rear half of bases. We will keep valid perfect inverted repeat candidates, while filter out invalid cases (<xref ref-type="fig" rid="pone-0113349-g002">Figure 2C</xref>).</p>
      </sec>
      <sec id="s2a5">
        <title>(5). Extension of inverted repeats</title>
        <p>Base on the aforementioned principle, extend one base at both ends of inverted repeats identified in the previous step, and select out cases whose new terminal bases are reversely complementary (<xref ref-type="fig" rid="pone-0113349-g002">Figure 2D</xref>). For instance, if subsequence <italic>S</italic>(<italic>i</italic>:<italic>i</italic>+<italic>h</italic>-3) is a perfect inverted repeat of length <italic>h</italic>-2 identified in previous step, the extended subsequence <italic>S</italic>(<italic>i</italic>-1:<italic>i</italic>+<italic>h</italic>-2) will be a potential inverted repeat of length <italic>h</italic>. If its terminal bases are either G/C or A/T,<disp-formula id="pone.0113349.e006"><graphic xlink:href="pone.0113349.e006.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>Then, <italic>S</italic>(<italic>i</italic>-1:<italic>i</italic>+<italic>h</italic>-2) is a perfect inverted repeat of length <italic>h</italic>.</p>
      </sec>
      <sec id="s2a6">
        <title>(6). Repetition</title>
        <p>Repeat the step 5 until <italic>h</italic> = <italic>L</italic>, then all the perfect inverted repeats of length ranged between <italic>l</italic> and <italic>L</italic> have been identified.</p>
      </sec>
    </sec>
    <sec id="s2b">
      <title>Algorithm for imperfect inverted repeat detection</title>
      <p>Different from the aforementioned algorithm for perfect inverted repeat detection, to find imperfect inverted repeats of length <italic>h</italic>, allowing maximal mismatch number <italic>m</italic>, which is defined as the sum of all nucleotides within the central non-palindromic spacer and the non-complementary pairs in the pairing stem, we will firstly find all subsequences of length <italic>h</italic>-2 with mismatch number ≤ <italic>m</italic>, with the assumption that the nested subsequence of an imperfect inverted repeat with mismatch number ≤ <italic>m</italic> must be a sequence with mismatch number ≤ <italic>m</italic> which share the same center. The major difference between the nested subsequence and the imperfect inverted repeat is that the terminal bases of imperfect inverted repeat must be reversely complementary (‘<underline>A</underline>AAAATTTC<underline>T</underline>’), while the former does not require meeting this condition (‘<underline>A</underline>AAATTT<underline>C</underline>’).</p>
      <p><xref ref-type="fig" rid="pone-0113349-g004">Figure 4</xref> shows the core algorithm for imperfect inverted repeat detection. <italic>l</italic> is the minimal length and <italic>L</italic> is the maximal length of imperfect inverted repeats to be detected, and <italic>N</italic> is the length of the input sequence (<italic>l</italic> ≤ <italic>L</italic> ≤ <italic>N</italic>), <italic>m</italic> is the maximal number of mismatches allowing in each imperfect inverted repeat. The first two steps 1 and 2 are same to the detection of perfect inverted repeats.</p>
      <fig id="pone-0113349-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0113349.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Major steps of the core algorithm for imperfect inverted repeat detection.</title>
          <p>(A) Select out imperfect inverted repeat candidates (here, we just show part of candidates), report valid imperfect inverted repeats and pick up valid subsequences for the downstream process described in the next step (here <italic>l</italic> = 4, <italic>m</italic> = 2). (B) Extend one base at both ends of subsequences to obtain longer imperfect inverted repeats. The subsequences locating at both ends of a sequence (<italic>i.e.</italic>, ‘ATCGAA’) should not be selected for the next round extension.</p>
        </caption>
        <graphic xlink:href="pone.0113349.g004"/>
      </fig>
      <sec id="s2b1">
        <title>(1). Mapping sequence to vector</title>
      </sec>
      <sec id="s2b2">
        <title>(2). Calculation of subsequence score</title>
      </sec>
      <sec id="s2b3">
        <title>(3). Identification of candidates</title>
        <p>If the sum of the absolute values of the real part and the imaginary part of a subsequence’s score is less than or equal to <italic>m</italic>, the subsequence is recognized as an imperfect inverted repeat candidate of length <italic>l</italic>.<disp-formula id="pone.0113349.e007"><graphic xlink:href="pone.0113349.e007.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      </sec>
      <sec id="s2b4">
        <title>(4). Validation of candidates</title>
        <p>In this step, the mismatch numbers of all the imperfect inverted repeat candidates of <italic>length l</italic> are calculated. Subsequences that satisfy the following three conditions: (1) the mismatch number is less than or equal to <italic>m</italic>; (2) the first and last base of the subsequence are reversely complementary; (3) mismatch number is not zero, will be reported as the detected imperfect inverted repeats. While, all the subsequences meeting (1) with/without (2) and (3) will be picked up for the process in the next step (see <xref ref-type="fig" rid="pone-0113349-g004">Figure 4A</xref>).</p>
      </sec>
      <sec id="s2b5">
        <title>(5). Extension of subsequences</title>
        <p>We will extend one nucleotide at both ends of subsequences generated in the previous step. If the two extended bases are reversely complementary, the corresponding mismatch number of the subsequence keep unchanged, otherwise the mismatch number increases by 2. Then subsequences meeting all three conditions described in step 4 are valid imperfect inverted repeats. Subsequences meeting (1) with/without (2) and (3) will be picked up for the next round extension (see <xref ref-type="fig" rid="pone-0113349-g004">Figure 4B</xref>).</p>
        <p>For example, when subsequence <italic>S</italic>(<italic>i</italic>:<italic>i</italic>+<italic>h</italic>-3) of length <italic>h</italic>-2 has a mismatch number <italic>α</italic> less than or equal to <italic>m</italic>, the subsequence <italic>S</italic>(<italic>i</italic>-1:<italic>i</italic>+<italic>h</italic>-2) is a potential imperfect inverted repeats of length <italic>h</italic>. If,<disp-formula id="pone.0113349.e008"><graphic xlink:href="pone.0113349.e008.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>Subsequence <italic>S</italic>(<italic>i</italic>-1:<italic>i</italic>+<italic>h</italic>-2) is an imperfect inverted repeat that meets all given conditions.</p>
      </sec>
      <sec id="s2b6">
        <title>(6). Repetition</title>
        <p>Repeat the step 5 until <italic>h</italic>
<bold><italic> = </italic></bold>
<italic>L</italic> (or <italic>h</italic>
<bold><italic> = </italic></bold>
<italic>L</italic>-1), then all imperfect inverted repeats of odd-length (or even-length) ranged between <italic>l</italic> and <italic>L</italic> with a mismatch number ≤ <italic>m</italic> have been identified.</p>
      </sec>
      <sec id="s2b7">
        <title>(7). Detection of even/odd length inverted repeats</title>
        <p>Repeat steps 2–6, starting with calculating the score of subsequences of length <italic>l</italic>+1. Finally, all imperfect inverted repeats of even-length (or odd-length) ranged between <italic>l</italic> and <italic>L</italic> will been identified.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <p>The aforementioned algorithms have been implemented into <italic>detectIR</italic>, which was composed of two MATLAB functions <italic>detectPerfectIR</italic> and <italic>detectImperfectIR</italic> respectively. To evaluate the performance of these two functions, they were compared with four inverted repeat detection tools BioPHP (A PHP program obtained from <ext-link ext-link-type="uri" xlink:href="http://www.biophp.org/minitools/find_palindromes">http://www.biophp.org/minitools/find_palindromes</ext-link>), EMBOSS <italic>palindrome</italic> tool (Stable version 6.3.1), MATLAB built-in <italic>palindromes</italic> function (Matlab R2013b) and MATLAB-based <italic>findIR</italic>. HIV-1 genome and chromosome 1 from <italic>Arabidopsis thaliana</italic>, <italic>Homo sapiens</italic> and <italic>Zea mays</italic> were used as the test data. The detailed step-by-step guide for testing and comparison is available on our sourceforge project website (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/detectir">https://sourceforge.net/projects/detectir</ext-link>). Our source codes and relevant documents are also available as in <xref ref-type="supplementary-material" rid="pone.0113349.s004">File S1</xref>. The result comparison of perfect inverted repeat detection and imperfect inverted repeat detection is presented below separately. For smaller genomes like <italic>Arabidopsis thaliana</italic> and HIV-1, a standard workstation with 8G RAM should be enough for testing, while large genomes like <italic>Homo sapiens</italic> and <italic>Zea mays</italic> will require at least 32G RAM. For the test results described below, all the tests were performed using Ubuntu 12.04 (precise) 64-bit platform with Intel Xeon (2.00 GHz) processer and 125.9 GB RAM.</p>
    <sec id="s3a">
      <title>Perfect inverted repeat detection</title>
      <p>Here, we used each program to search perfect inverted repeats with length between 10 and 1000 <italic>nt</italic>. The detection results are summarized in <xref rid="pone-0113349-t001" ref-type="table">Table 1</xref>. The length distributions of the perfect inverted repeats detected by <italic>detectIR</italic> are shown in <xref ref-type="supplementary-material" rid="pone.0113349.s001">Figure S1</xref>. It is clear that the numbers of perfect inverted repeats decrease with the increase of inverted repeat length, shorter inverted repeats are much more abundant in genomes (see <xref ref-type="supplementary-material" rid="pone.0113349.s001">Figure S1</xref>).</p>
      <table-wrap id="pone-0113349-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0113349.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The comparison of <italic>detectPerfectIR</italic> with BioPHP, EMBOSS, MATLAB and <italic>findIR</italic> for perfect inverted repeat detection.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0113349-t001-1" xlink:href="pone.0113349.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="2" align="left" rowspan="1">HIV-1</td>
                <td colspan="2" align="left" rowspan="1">Arabidopsis thaliana</td>
                <td colspan="2" align="left" rowspan="1">Homo sapiens</td>
                <td colspan="2" align="left" rowspan="1">Zea mays</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">BioPHP</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">5.56 m</td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">EMBOSS(<italic>palindrome</italic>)</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">&lt;1 s</td>
                <td align="left" rowspan="1" colspan="1">61,705</td>
                <td align="left" rowspan="1" colspan="1">34.53 m</td>
                <td align="left" rowspan="1" colspan="1">347,688</td>
                <td align="left" rowspan="1" colspan="1">38.74 h</td>
                <td align="left" rowspan="1" colspan="1">448,928</td>
                <td align="left" rowspan="1" colspan="1">4.28 h</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MATLAB(<italic>palindromes</italic>)</td>
                <td align="left" rowspan="1" colspan="1">13</td>
                <td align="left" rowspan="1" colspan="1">0.06 s</td>
                <td align="left" rowspan="1" colspan="1">266,187</td>
                <td align="left" rowspan="1" colspan="1">3.27 m</td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt101">*</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>findIR</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">0.23 s</td>
                <td align="left" rowspan="1" colspan="1">142,249</td>
                <td align="left" rowspan="1" colspan="1">8.80 m</td>
                <td align="left" rowspan="1" colspan="1">746,925</td>
                <td align="left" rowspan="1" colspan="1">1.16 h</td>
                <td align="left" rowspan="1" colspan="1">1,147,428</td>
                <td align="left" rowspan="1" colspan="1">1.51 h</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>detectPerfectIR</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">0.05 s</td>
                <td align="left" rowspan="1" colspan="1">142,249</td>
                <td align="left" rowspan="1" colspan="1">11.85 s</td>
                <td align="left" rowspan="1" colspan="1">746,925</td>
                <td align="left" rowspan="1" colspan="1">1.72 m</td>
                <td align="left" rowspan="1" colspan="1">1,147,428</td>
                <td align="left" rowspan="1" colspan="1">2.00 m</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>*Program crashed in execution or output nothing after 10-day execution.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To determine the accuracy of <italic>detectPerfectIR</italic>, the outputs from different programs using the same input data were compared against <italic>detectPerfectIR</italic> respectively. The differences discovered between them can be classified into two categories (1) entries only present in the output of <italic>detectPerfectIR</italic>, (2) entries only present in the output of BioPHP, EMBOSS (<italic>palindrome</italic>), MATLAB (<italic>palindromes</italic>) or <italic>findIR</italic>. As shown in <xref rid="pone-0113349-t001" ref-type="table">Table 1</xref>, consequently, the outputs of <italic>detectPerfectIR</italic> and <italic>findIR</italic> are identical, while <italic>detectPerfectIR</italic> performs much more efficiently.</p>
      <sec id="s3a1">
        <title>Entries only present in the output of detectPerfectIR and findIR</title>
        <p>The entries only detected by <italic>detectPerfectIR</italic> and <italic>findIR</italic> were found to be valid perfect inverted repeats by human validation. In other words, these cases are missed by the other compared tools. For HIV-1 genome, both EMBOSS and MATLAB missed 2 perfect inverted repeats (see <xref ref-type="supplementary-material" rid="pone.0113349.s005">File S2</xref> and <xref ref-type="supplementary-material" rid="pone.0113349.s006">S3</xref>). For chromosome 1 of <italic>Arabidopsis thaliana</italic>, EMBOSS missed 80,548 perfect inverted repeats (see <xref ref-type="supplementary-material" rid="pone.0113349.s007">File S4</xref>) and MATLAB missed 86,759 perfect inverted repeats (see <xref ref-type="supplementary-material" rid="pone.0113349.s008">File S5</xref>). For chromosome 1 of <italic>Homo sapiens</italic>, EMBOSS missed 399,237 perfect inverted repeats (see <xref ref-type="supplementary-material" rid="pone.0113349.s009">File S6</xref>). For chromosome 1 of <italic>Zea mays</italic>, EMBOSS missed 703,018 perfect inverted repeats (see <xref ref-type="supplementary-material" rid="pone.0113349.s010">File S7</xref>).</p>
      </sec>
      <sec id="s3a2">
        <title>Entries only present in the output of the other compared tools</title>
        <p>The entries only found by the other tools prove to be invalid perfect inverted repeats by human validation, which mean the outputs of these tools contain false positives. For the HIV-1 genome, the output of MATLAB contains 8 cases with a gap in the center, like ‘CAAAA<underline>A</underline>TTTTG’ (see <xref ref-type="supplementary-material" rid="pone.0113349.s006">File S3</xref>). For chromosome 1 of <italic>Arabidopsis thaliana</italic>, the output of EMBOSS contains 4 invalid cases like ‘A-N(60)-T’ etc (see <xref ref-type="supplementary-material" rid="pone.0113349.s007">File S4</xref>). And the output of MATLAB contains 210,697 invalid cases, 46915 of them are subsequences like ‘ATTTTT<underline>T</underline>AAAAAT’ with a gap in the center and 163,782 of them are subsequences like ‘NNNNNNNNNN’ or ‘A-N(27)-T’ (see <xref ref-type="supplementary-material" rid="pone.0113349.s008">File S5</xref>). For chromosome 1 of <italic>Zea mays</italic>, the output of EMBOSS contains 4,518 invalid cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s010">File S7</xref>).</p>
      </sec>
    </sec>
    <sec id="s3b">
      <title>Imperfect inverted repeat detection</title>
      <p>In imperfect inverted repeat detection, some tools define continuous mismatches in the center of inverted repeat as gaps; mismatches in other locations are still considered as mismatches, while our algorithm does not differentiate these two types of mismatch. For example, EMBOSS <italic>palindrome</italic> tool will recognize sequence ‘AA<underline>C</underline>AA<underline>CT</underline>TT<underline>C</underline>TT’ as an inverted repeat with 1 mismatch and 2 gaps, our tool will recognize it as an inverted repeat with 4 mismatches. MATLAB <italic>palindromes</italic> function can only deal with imperfect inverted repeats containing gaps. So, here we let our function <italic>detectImperfectIR</italic> and MATLAB <italic>palindromes</italic> function detect imperfect inverted repeats of length between 20 and 1000 <italic>nt</italic>, mismatch number (or gap number) ≤6, and let EMBOSS palindrome tool search imperfect inverted repeats of length between 20 and 1000 <italic>nt</italic>, gap number ≤2, and mismatch number ≤2 (Using the definition of EMBOSS). BioPHP and <italic>findIR</italic> are not used here, because they are designed to detect only the perfect inverted repeats. Summaries of the detection results are shown in <xref rid="pone-0113349-t002" ref-type="table">Table 2</xref>. The length distributions of the imperfect inverted repeats detected by <italic>detectIR</italic> are shown in <xref ref-type="supplementary-material" rid="pone.0113349.s002">Figure S2</xref>. Obviously, the length distribution of imperfect inverted repeats is similar to that of perfect inverted repeats. The number of imperfect inverted repeats of even length is more than those of odd length, and the underlying reason may be that the odd-length inverted repeats must contain a spacer in the middle, which means that the mismatches in the stem should be less. To test this assumption, we run detectIR with an odd maximum mismatch number (<italic>m</italic> = 7). As shown in <xref ref-type="supplementary-material" rid="pone.0113349.s003">Figure S3</xref>, the numbers of odd-length imperfect inverted repeats are approximate to the numbers of even-length imperfect inverted repeats.</p>
      <table-wrap id="pone-0113349-t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0113349.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The comparison of <italic>detectImperfectIR</italic> with EMBOSS and MATLAB for imperfect inverted repeat detection.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0113349-t002-2" xlink:href="pone.0113349.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="2" align="left" rowspan="1">HIV-1</td>
                <td colspan="2" align="left" rowspan="1">Arabidopsis thaliana</td>
                <td colspan="2" align="left" rowspan="1">Homo sapiens</td>
                <td colspan="2" align="left" rowspan="1">Zea mays</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
                <td align="left" rowspan="1" colspan="1">IR count</td>
                <td align="left" rowspan="1" colspan="1">runtime</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">EMBOSS(<italic>palindrome</italic>)</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">&lt;1 s</td>
                <td align="left" rowspan="1" colspan="1">65,596</td>
                <td align="left" rowspan="1" colspan="1">43.48 m</td>
                <td align="left" rowspan="1" colspan="1">429,662</td>
                <td align="left" rowspan="1" colspan="1">39.96 h</td>
                <td align="left" rowspan="1" colspan="1">619,889</td>
                <td align="left" rowspan="1" colspan="1">5.91 h</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MATLAB(<italic>palindromes</italic>)</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">0.07 s</td>
                <td align="left" rowspan="1" colspan="1">173,659</td>
                <td align="left" rowspan="1" colspan="1">11.00 m</td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt102">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt102">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt102">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="table-fn" rid="nt102">*</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>detectImperfectIR</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">37</td>
                <td align="left" rowspan="1" colspan="1">0.09 s</td>
                <td align="left" rowspan="1" colspan="1">311,369</td>
                <td align="left" rowspan="1" colspan="1">1.48 m</td>
                <td align="left" rowspan="1" colspan="1">2,166,638</td>
                <td align="left" rowspan="1" colspan="1">11.83 m</td>
                <td align="left" rowspan="1" colspan="1">2,878,686</td>
                <td align="left" rowspan="1" colspan="1">16.63 m</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>*Program crashed in execution or output nothing after 10-day execution.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>In order to make an unbiased comparison, we will filter out entries with a mismatch number larger than 2 or a gap number larger than 2 (Using the definition of EMBOSS) in the output of <italic>detectImperfectIR</italic> before comparing it with the output of EMBOSS.</p>
      <sec id="s3b1">
        <title>Entries only present in the output of detectImperfectIR</title>
        <p>All these entries are validated by human to be imperfect inverted repeats that meet the defined criteria. For HIV-1, EMBOSS missed 9 cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s011">File S8</xref>), and MATLAB missed 36 cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s012">File S9</xref>). For instance, both EMBOSS and MATLAB missed case ‘ATCA<underline>G</underline>ATGCT<underline>AA</underline>AGCAT<underline>A</underline>TGAT’. For chromosome 1 of <italic>Arabidopsis thaliana</italic>, EMBOSS missed 78,293 cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s013">File S10</xref>) and MATLAB missed 304,394 cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s014">File S11</xref>). Both EMBOSS and MATLAB missed cases like ‘CTT<underline>T</underline>AG<underline>C</underline>AT<underline>TT</underline>AT<underline>T</underline>CT<underline>G</underline>AAG’ and ‘ATAATTT<underline>A</underline>A<underline>AA</underline>T<underline>A</underline>AAATTAT’. For chromosome 1 of <italic>Homo sapiens</italic>, EMBOSS missed 618,357 cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s015">File S12</xref>). For chromosome 1 of <italic>Zea mays</italic>, EMBOSS missed 825,455 cases (see <xref ref-type="supplementary-material" rid="pone.0113349.s016">File S13</xref>).</p>
      </sec>
      <sec id="s3b2">
        <title>Entries only present in the output of the other compared tools</title>
        <p>The entries only present in the output of the other compared tools prove to be false positives again. For chromosome 1 of <italic>Arabidopsis thaliana</italic>, the output of EMBOSS contains 1,765 perfect inverted repeats and 23 entries like ‘A-N(27)-TT’ (see <xref ref-type="supplementary-material" rid="pone.0113349.s013">File S10</xref>). The output of MATLAB contains 3,091 perfect inverted repeats and 163,593 entries like ‘N(20)’ or ‘A-N(27)-T’ (see <xref ref-type="supplementary-material" rid="pone.0113349.s014">File S11</xref>). For chromosome 1 of <italic>Homo sapiens</italic>, the output of EMBOSS contains 6,771 perfect inverted repeats (see <xref ref-type="supplementary-material" rid="pone.0113349.s015">File S12</xref>). For chromosome 1 of <italic>Zea mays</italic>, the output of EMBOSS contains 17,926 perfect inverted repeats and 27,761 entries like ‘A-N(100)-T’ (see <xref ref-type="supplementary-material" rid="pone.0113349.s016">File S13</xref>).</p>
      </sec>
    </sec>
    <sec id="s3c">
      <title>Random nucleotide sequence test</title>
      <p>To evaluate the efficiency of <italic>detectIR</italic>, we generated several random nucleotide sequences of varied lengths, use function <italic>detectPerfectIR</italic> to detect perfect inverted repeats of length between 4 and 1000, and use function <italic>detectImperfectIR</italic> to detect imperfect inverted repeats of length between 10 and 1000 with mismatches less than or equal to 6. The average runtimes are shown below in <xref ref-type="fig" rid="pone-0113349-g005">Figure 5</xref>.</p>
      <fig id="pone-0113349-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0113349.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Average runtimes of <italic>detectPerfectIR</italic> and <italic>detectImperfectIR</italic> using random nucleotide sequence inputs of varied lengths.</title>
          <p>(A) The average runtimes of <italic>detectPerfectIR</italic> using random nucleotide sequence inputs of varied lengths. (B) The average runtimes of <italic>detectImperfectIR</italic> using random nucleotide sequence inputs of varied lengths.</p>
        </caption>
        <graphic xlink:href="pone.0113349.g005"/>
      </fig>
      <p>As shown in <xref ref-type="fig" rid="pone-0113349-g005">Figure 5</xref>, average runtime of the <italic>detectIR</italic> increases with the increase of the sequence length. The execution time of <italic>detectImperfectIR</italic> is ∼6 fold of that of <italic>detectPerfectIR</italic> with same input data, because the perfect inverted repeats has more strict requirements than imperfect inverted repeats which reduce the search space. So it is clear that <italic>detectIR</italic> shows good scalability dealing with large genome sequence inputs.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Availability and Future Directions</title>
    <p><italic>detectIR</italic> is platform independent and can be used in Windows or Linux as long as MATLAB can be run. The source codes, test and comparison scripts, and documents are freely available at: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/detectir">https://sourceforge.net/projects/detectir</ext-link>.</p>
    <p>Clearly, inverted repeats are not randomly distributed in both prokaryotic and eukaryotic genomes. Without a doubt, more wet-lab experiments for important genes are needed to clearly understand their biological functions. However, <italic>in silico</italic> genome-wide scan of inverted repeats can effectively help us to determine their overall distributions and characteristics and discover the groups of inverted repeats that are more likely to have important biological functions. As shown in <xref ref-type="supplementary-material" rid="pone.0113349.s017">Information S1</xref>, we used <italic>detectIR</italic> to conduct comparative study of perfect and imperfect inverted repeats in <italic>Arabidopsis</italic> genome. We found that both perfect and imperfect inverted repeats are not randomly distributed along the genome, and imperfect inverted repeats are much more abundant than perfect inverted repeats. In particular, imperfect inverted repeats are significantly enriched in near intergenic regions than far intergenic regions, while both perfect and imperfect inverted repeats are significantly more abundant in introns than exons. Our results are in line with the findings in human and yeast genomes <xref rid="pone.0113349-Strawbridge1" ref-type="bibr">[3]</xref>
<xref rid="pone.0113349-Lu2" ref-type="bibr">[22]</xref>
<xref rid="pone.0113349-HumphreyDixon1" ref-type="bibr">[23]</xref>. Obviously, the inverted repeats in introns and promoter regions are worthy of closer examination in the future.</p>
    <p>In conclusion, we developed an accurate and efficient program <italic>detectIR</italic> for detecting both perfect and imperfect inverted repeats in a given nucleotide sequence. <italic>detectIR</italic> is capable of processing large genome sequences, given enough memory in computation. Compared to BioPHP, EMBOSS <italic>palindrome</italic> tool, MATLAB built-in <italic>palindromes</italic> function and MATLAB-based <italic>findIR</italic>, the test results show that our program can more efficiently detect inverted repeats without sacrificing accuracy. Future directions will focus on improving the program to detect imperfect inverted repeats with indels within the paring stem, and reducing the memory consumption of program.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0113349.s001">
      <label>Figure S1</label>
      <caption>
        <p>
          <bold>Length distributions of perfect inverted repeats in different species detected by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold>.</bold>
        </p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0113349.s001.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s002">
      <label>Figure S2</label>
      <caption>
        <p>
          <bold>Length distributions of imperfect inverted repeats in different species detected by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> with the maximum mismatch number of 6 (</bold>
          <bold>
            <italic>m</italic>
          </bold>
          <bold> = 6).</bold>
        </p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0113349.s002.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s003">
      <label>Figure S3</label>
      <caption>
        <p>
          <bold>Length distributions of imperfect inverted repeats in different species detected by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> with the maximum mismatch number of 7 (</bold>
          <bold>
            <italic>m</italic>
          </bold>
          <bold> = 7).</bold>
        </p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0113349.s003.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s004">
      <label>File S1</label>
      <caption>
        <p>
          <bold>Source codes, test and comparison scripts, and user documents of </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold>.</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s004.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s005">
      <label>File S2</label>
      <caption>
        <p>
          <bold>The output files of the perfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and HIV-1 genome as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s005.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s006">
      <label>File S3</label>
      <caption>
        <p>
          <bold>The output files of the perfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and MATLAB </bold>
          <bold>
            <italic>palindromes</italic>
          </bold>
          <bold> function (Using the parameters described in the manuscript and HIV-1 genome as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s006.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s007">
      <label>File S4</label>
      <caption>
        <p>
          <bold>The output files of the perfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Arabidopsis thaliana</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s007.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s008">
      <label>File S5</label>
      <caption>
        <p>
          <bold>The output files of the perfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and MATLAB </bold>
          <bold>
            <italic>palindromes</italic>
          </bold>
          <bold> function (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Arabidopsis thaliana</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s008.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s009">
      <label>File S6</label>
      <caption>
        <p>
          <bold>The output files of the perfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Homo sapiens</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s009.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s010">
      <label>File S7</label>
      <caption>
        <p>
          <bold>The output files of the perfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Zea mays</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s010.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s011">
      <label>File S8</label>
      <caption>
        <p>
          <bold>The output files of the imperfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and HIV-1 genome as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s011.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s012">
      <label>File S9</label>
      <caption>
        <p>
          <bold>The output files of the imperfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and MATLAB </bold>
          <bold>
            <italic>palindromes</italic>
          </bold>
          <bold> function (Using the parameters described in the manuscript and HIV-1 genome as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s012.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s013">
      <label>File S10</label>
      <caption>
        <p>
          <bold>The output files of the imperfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Arabidopsis thaliana</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s013.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s014">
      <label>File S11</label>
      <caption>
        <p>
          <bold>The output files of the imperfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and MATLAB </bold>
          <bold>
            <italic>palindromes</italic>
          </bold>
          <bold> function (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Arabidopsis thaliana</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s014.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s015">
      <label>File S12</label>
      <caption>
        <p>
          <bold>The output files of the imperfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Homo sapiens</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s015.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s016">
      <label>File S13</label>
      <caption>
        <p>
          <bold>The output files of the imperfect inverted repeats detected differentially by </bold>
          <bold>
            <italic>detectIR</italic>
          </bold>
          <bold> and EMBOSS </bold>
          <bold>
            <italic>palindrome</italic>
          </bold>
          <bold> tool (Using the parameters described in the manuscript and chromosome 1 of </bold>
          <bold>
            <italic>Zea mays</italic>
          </bold>
          <bold> as input data).</bold>
        </p>
        <p>(TGZ)</p>
      </caption>
      <media xlink:href="pone.0113349.s016.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0113349.s017">
      <label>Information S1</label>
      <caption>
        <p>
          <bold>The genome-wide distribution of perfect and imperfect inverted repeats in </bold>
          <bold>
            <italic>Arabidopsis thaliana</italic>
          </bold>
          <bold>.</bold>
        </p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0113349.s017.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Sutharzan Sreeskandarajan for helpful comments on the manuscript. We also want to thank the anonymous reviewers for their valuable comments and suggestions to improve the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0113349-Lilley1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Lilley</surname><given-names>DM</given-names></name> (<year>1980</year>) <article-title>The inverted repeat as a recognizable structural feature in supercoiled DNA molecules</article-title>. <source>Proc Natl Acad Sci</source>
<volume>77</volume>: <fpage>6468</fpage>–<lpage>6472</lpage>.<pub-id pub-id-type="pmid">6256738</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Smith1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>GR</given-names></name> (<year>2008</year>) <article-title>Meeting DNA palindromes head-to-head</article-title>. <source>Genes Dev</source>
<volume>22</volume>: <fpage>2612</fpage>–<lpage>2620</lpage>
<pub-id pub-id-type="doi">10.1101/gad.1724708</pub-id>
<pub-id pub-id-type="pmid">18832065</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Strawbridge1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Strawbridge</surname><given-names>EM</given-names></name>, <name><surname>Benson</surname><given-names>G</given-names></name>, <name><surname>Gelfand</surname><given-names>Y</given-names></name>, <name><surname>Benham</surname><given-names>CJ</given-names></name> (<year>2010</year>) <article-title>The distribution of inverted repeat sequences in the Saccharomyces cerevisiae genome</article-title>. <source>Curr Genet</source>
<volume>56</volume>: <fpage>321</fpage>–<lpage>340</lpage>
<pub-id pub-id-type="doi">10.1007/s00294-010-0302-6</pub-id>
<pub-id pub-id-type="pmid">20446088</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Pearson1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Pearson</surname><given-names>CE</given-names></name>, <name><surname>Zorbas</surname><given-names>H</given-names></name>, <name><surname>Price</surname><given-names>GB</given-names></name>, <name><surname>Zannis-Hadjopoulos</surname><given-names>M</given-names></name> (<year>1996</year>) <article-title>Inverted Repeats, Stem-Loops, and Cruciforms: Significance for Initiation of DNA Replication</article-title>. <source>J Cell Biochem</source>
<volume>63</volume>: <fpage>1</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">8891900</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Chasovskikh1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chasovskikh</surname><given-names>S</given-names></name>, <name><surname>Dimtchev</surname><given-names>A</given-names></name>, <name><surname>Smulson</surname><given-names>M</given-names></name>, <name><surname>Dritschilo</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>DNA transitions induced by binding of PARP-1 to cruciform structures in supercoiled plasmids</article-title>. <source>Cytometry A</source>
<volume>68A</volume>: <fpage>21</fpage>–<lpage>27</lpage>
<pub-id pub-id-type="doi">10.1002/cyto.a.20187</pub-id>
</mixed-citation>
    </ref>
    <ref id="pone.0113349-Allers1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Allers</surname><given-names>T</given-names></name>, <name><surname>Leach</surname><given-names>DR</given-names></name> (<year>1995</year>) <article-title>DNA Palindromes Adopt a Methylation-resistant Conformation that is Consistent with DNA Cruciform or Hairpin Formation in Vivo</article-title>. <source>J Mol Biol</source>
<volume>252</volume>: <fpage>70</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">7666435</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Gordenin1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Gordenin</surname><given-names>DA</given-names></name>, <name><surname>Lobachev</surname><given-names>KS</given-names></name>, <name><surname>Degtyareva</surname><given-names>NP</given-names></name>, <name><surname>Malkova</surname><given-names>AL</given-names></name>, <name><surname>Perkins</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>1993</year>) <article-title>Inverted DNA repeats: a source of eukaryotic genomic instability</article-title>. <source>Mol Cell Biol</source>
<volume>13</volume>: <fpage>5315</fpage>–<lpage>5322</lpage>.<pub-id pub-id-type="pmid">8395002</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Hu1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>L</given-names></name>, <name><surname>Kim</surname><given-names>TM</given-names></name>, <name><surname>Son</surname><given-names>MY</given-names></name>, <name><surname>Kim</surname><given-names>S-A</given-names></name>, <name><surname>Holland</surname><given-names>CL</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Two replication fork maintenance pathways fuse inverted repeats to rearrange chromosomes</article-title>. <source>Nature</source>
<volume>501</volume>: <fpage>569</fpage>–<lpage>572</lpage>
<pub-id pub-id-type="doi">10.1038/nature12500</pub-id>
<pub-id pub-id-type="pmid">24013173</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Brzda1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Brázda</surname><given-names>V</given-names></name>, <name><surname>Laister</surname><given-names>RC</given-names></name>, <name><surname>Jagelská</surname><given-names>EB</given-names></name>, <name><surname>Arrowsmith</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>Cruciform structures are a common DNA feature important for regulating biological processes</article-title>. <source>BMC Mol Biol</source>
<volume>12</volume>: <fpage>33</fpage>.<pub-id pub-id-type="pmid">21816114</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Bhattacharya1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Bhattacharya</surname><given-names>M</given-names></name>, <name><surname>Das</surname><given-names>AK</given-names></name> (<year>2011</year>) <article-title>Inverted repeats in the promoter as an autoregulatory sequence for TcrX in Mycobacterium tuberculosis</article-title>. <source>Biochem Biophys Res Commun</source>
<volume>415</volume>: <fpage>17</fpage>–<lpage>23</lpage>
<pub-id pub-id-type="doi">10.1016/j.bbrc.2011.09.143</pub-id>
<pub-id pub-id-type="pmid">22001925</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Tulin1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Tulin</surname><given-names>A</given-names></name>, <name><surname>Chinenov</surname><given-names>Y</given-names></name>, <name><surname>Spradling</surname><given-names>A</given-names></name> (<year>2003</year>) <article-title>Regulation of Chromatin Structure and Gene Activity by Poly(ADP-Ribose) Polymerases</article-title>. <source>Curr Top Dev Biol Volume</source>
<volume>56</volume>: <fpage>55</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0113349-Pelham1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Pelham</surname><given-names>C</given-names></name>, <name><surname>Jimenez</surname><given-names>T</given-names></name>, <name><surname>Rodova</surname><given-names>M</given-names></name>, <name><surname>Rudolph</surname><given-names>A</given-names></name>, <name><surname>Chipps</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Regulation of HFE expression by poly(ADP-ribose) polymerase-1 (PARP1) through an inverted repeat DNA sequence in the distal promoter</article-title>. <source>Biochim Biophys Acta BBA - Gene Regul Mech</source>
<volume>1829</volume>: <fpage>1257</fpage>–<lpage>1265</lpage>
<pub-id pub-id-type="doi">10.1016/j.bbagrm.2013.10.002</pub-id>
</mixed-citation>
    </ref>
    <ref id="pone.0113349-Voineagu1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Voineagu</surname><given-names>I</given-names></name>, <name><surname>Narayanan</surname><given-names>V</given-names></name>, <name><surname>Lobachev</surname><given-names>KS</given-names></name>, <name><surname>Mirkin</surname><given-names>SM</given-names></name> (<year>2008</year>) <article-title>Replication stalling at unstable inverted repeats: interplay between DNA hairpins and fork stabilizing proteins</article-title>. <source>Proc Natl Acad Sci</source>
<volume>105</volume>: <fpage>9936</fpage>–<lpage>9941</lpage>.<pub-id pub-id-type="pmid">18632578</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-MartinezContreras1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Martinez-Contreras</surname><given-names>R</given-names></name>, <name><surname>Fisette</surname><given-names>J-F</given-names></name>, <name><surname>Nasim</surname><given-names>FH</given-names></name>, <name><surname>Madden</surname><given-names>R</given-names></name>, <name><surname>Cordeau</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2006</year>) <article-title>Intronic Binding Sites for hnRNP A/B and hnRNP F/H Proteins Stimulate Pre-mRNA Splicing</article-title>. <source>PLoS Biol</source>
<volume>4</volume>: <fpage>e21</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pbio.0040021</pub-id>
<pub-id pub-id-type="pmid">16396608</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Nasim1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Nasim</surname><given-names>F-UH</given-names></name>, <name><surname>Hutchison</surname><given-names>S</given-names></name>, <name><surname>Cordeau</surname><given-names>M</given-names></name>, <name><surname>Chabot</surname><given-names>B</given-names></name> (<year>2002</year>) <article-title>High-affinity hnRNP A1 binding sites and duplex-forming inverted repeats have similar effects on 5′splice site selection in support of a common looping out and repression mechanism</article-title>. <source>Rna</source>
<volume>8</volume>: <fpage>1078</fpage>–<lpage>1089</lpage>.<pub-id pub-id-type="pmid">12212851</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Howe1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Howe</surname><given-names>KJ</given-names></name>, <name><surname>Ares</surname><given-names>M</given-names></name> (<year>1997</year>) <article-title>Intron self-complementarity enforces exon inclusion in a yeast pre-mRNA</article-title>. <source>Proc Natl Acad Sci</source>
<volume>94</volume>: <fpage>12467</fpage>–<lpage>12472</lpage>.<pub-id pub-id-type="pmid">9356473</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Nakade1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Nakade</surname><given-names>K</given-names></name>, <name><surname>Watanabe</surname><given-names>H</given-names></name>, <name><surname>Sakamoto</surname><given-names>Y</given-names></name>, <name><surname>Sato</surname><given-names>T</given-names></name> (<year>2011</year>) <article-title>Gene silencing of the Lentinula edodes lcc1 gene by expression of a homologous inverted repeat sequence</article-title>. <source>Microbiol Res</source>
<volume>166</volume>: <fpage>484</fpage>–<lpage>493</lpage>
<pub-id pub-id-type="doi">10.1016/j.micres.2010.09.004</pub-id>
<pub-id pub-id-type="pmid">21030228</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Hily1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Hily</surname><given-names>J-M</given-names></name>, <name><surname>Ravelonandro</surname><given-names>M</given-names></name>, <name><surname>Damsteegt</surname><given-names>V</given-names></name>, <name><surname>Bassett</surname><given-names>C</given-names></name>, <name><surname>Petri</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Plum pox virus coat protein gene Intron-hairpin-RNA (ihpRNA) constructs provide resistance to plum pox virus in Nicotiana benthamiana and Prunus domestica</article-title>. <source>J Am Soc Hortic Sci</source>
<volume>132</volume>: <fpage>850</fpage>–<lpage>858</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0113349-Wesley1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Wesley</surname><given-names>SV</given-names></name>, <name><surname>Helliwell</surname><given-names>CA</given-names></name>, <name><surname>Smith</surname><given-names>NA</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Rouse</surname><given-names>DT</given-names></name>, <etal>et al</etal> (<year>2001</year>) <article-title>Construct design for efficient, effective and high-throughput gene silencing in plants</article-title>. <source>Plant J</source>
<volume>27</volume>: <fpage>581</fpage>–<lpage>590</lpage>.<pub-id pub-id-type="pmid">11576441</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Yang1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>G</given-names></name> (<year>2013</year>) <article-title>MITE Digger, an efficient and accurate algorithm for genome wide discovery of miniature inverted repeat transposable elements</article-title>. <source>BMC Bioinformatics</source>
<volume>14</volume>: <fpage>186</fpage>.<pub-id pub-id-type="pmid">23758809</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Lu1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Hu</surname><given-names>Q</given-names></name>, <name><surname>Su</surname><given-names>W</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Miniature Inverted-Repeat Transposable Elements (MITEs) Have Been Accumulated through Amplification Bursts and Play Important Roles in Gene Expression and Species Diversity in Oryza sativa</article-title>. <source>Mol Biol Evol</source>
<volume>29</volume>: <fpage>1005</fpage>–<lpage>1017</lpage>
<pub-id pub-id-type="doi">10.1093/molbev/msr282</pub-id>
<pub-id pub-id-type="pmid">22096216</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Lu2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>L</given-names></name>, <name><surname>Jia</surname><given-names>H</given-names></name>, <name><surname>Dröge</surname><given-names>P</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>The human genome-wide distribution of DNA palindromes</article-title>. <source>Funct Integr Genomics</source>
<volume>7</volume>: <fpage>221</fpage>–<lpage>227</lpage>
<pub-id pub-id-type="doi">10.1007/s10142-007-0047-6</pub-id>
<pub-id pub-id-type="pmid">17340149</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-HumphreyDixon1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Humphrey-Dixon</surname><given-names>EL</given-names></name>, <name><surname>Sharp</surname><given-names>R</given-names></name>, <name><surname>Schuckers</surname><given-names>M</given-names></name>, <name><surname>Lock</surname><given-names>R</given-names></name>, <name><surname>Gulick</surname><given-names>P</given-names></name> (<year>2011</year>) <article-title>Comparative genome analysis suggests characteristics of yeast inverted repeats that are important for transcriptional activity</article-title>. <source>Genome</source>
<volume>54</volume>: <fpage>934</fpage>–<lpage>942</lpage>
<pub-id pub-id-type="doi">10.1139/g11-058</pub-id>
<pub-id pub-id-type="pmid">22029652</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Sreeskandarajan1">
      <label>24</label>
      <mixed-citation publication-type="other">Sreeskandarajan S, Flowers MM, Karro JE, Liang C (2013) A MATLAB-based tool for accurate detection of perfect overlapping and nested inverted repeats in DNA sequences. Bioinformatics. doi:10.1093/bioinformatics/btt651.</mixed-citation>
    </ref>
    <ref id="pone.0113349-Rice1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Rice</surname><given-names>P</given-names></name>, <name><surname>Longden</surname><given-names>I</given-names></name>, <name><surname>Bleasby</surname><given-names>A</given-names></name> (<year>2000</year>) <article-title>EMBOSS: the European molecular biology open software suite</article-title>. <source>Trends Genet</source>
<volume>16</volume>: <fpage>276</fpage>–<lpage>277</lpage>.<pub-id pub-id-type="pmid">10827456</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0113349-Gupta1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Gupta</surname><given-names>R</given-names></name>, <name><surname>Mittal</surname><given-names>A</given-names></name>, <name><surname>Gupta</surname><given-names>S</given-names></name> (<year>2006</year>) <article-title>An efficient algorithm to detect palindromes in DNA sequences using periodicity transform</article-title>. <source>Signal Process</source>
<volume>86</volume>: <fpage>2067</fpage>–<lpage>2073</lpage>
<pub-id pub-id-type="doi">10.1016/j.sigpro.2005.10.008</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
