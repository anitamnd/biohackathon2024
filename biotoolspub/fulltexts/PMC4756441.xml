<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4756441</article-id>
    <article-id pub-id-type="publisher-id">270</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-016-0270-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>SpoTyping</italic>: fast and accurate <italic>in silico</italic> Mycobacterium spoligotyping from sequence reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xia</surname>
          <given-names>Eryu</given-names>
        </name>
        <address>
          <phone>+65-6516 1480</phone>
          <email>xiaeryu@u.nus.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teo</surname>
          <given-names>Yik-Ying</given-names>
        </name>
        <address>
          <email>statyy@nus.edu.sg</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
        <xref ref-type="aff" rid="Aff4"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ong</surname>
          <given-names>Rick Twee-Hee</given-names>
        </name>
        <address>
          <phone>+65-6601 2507</phone>
          <email>twee_hee_ong@nuhs.edu.sg</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>NUS Graduate School for Integrative Sciences and Engineering, National University of Singapore, Singapore, Singapore </aff>
      <aff id="Aff2"><label/>Centre for Infectious Disease Epidemiology and Research, Saw Swee Hock School of Public Health, National University of Singapore, Singapore, Singapore </aff>
      <aff id="Aff3"><label/>Department of Statistics and Applied Probability, National University of Singapore, Singapore, Singapore </aff>
      <aff id="Aff4"><label/>Life Sciences Institute, National University of Singapore, Singapore, Singapore </aff>
      <aff id="Aff5"><label/>Genome Institute of Singapore, Singapore, Singapore </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>19</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Xia et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p><italic>SpoTyping</italic> is a fast and accurate program for <italic>in silico</italic> spoligotyping of <italic>Mycobacterium tuberculosis</italic> isolates from next-generation sequencing reads. This novel method achieves high accuracy for reads of both uniform and varying lengths, and is about 20 to 40 times faster than <italic>SpolPred. SpoTyping</italic> also integrates the function of producing a report summarizing associated epidemiological data from a global database of all isolates having the same spoligotype. <italic>SpoTyping</italic> is freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/xiaeryu/SpoTyping-v2.0">https://github.com/xiaeryu/SpoTyping-v2.0</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13073-016-0270-7) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>Tuberculosis (TB), caused mainly by <italic>Mycobacterium tuberculosis</italic> (<italic>Mtb</italic>), is a top infectious disease killer around the world and remains an acute international health problem, resulting in an estimated 9.6 million new cases and 1.5 million deaths globally in 2014 [<xref ref-type="bibr" rid="CR1">1</xref>]. The global emergence and spread of drug-resistant TB have compounded the difficulty of treating and eradicating this disease.</p>
    <p>Spoligotyping (spacer oligonucleotide typing) is a widely used genotyping method for <italic>Mtb</italic>, which exploits the genetic diversity in the clustered regularly interspersed short palindromic repeats (CRISPR) locus, which is also known as the direct repeat (DR) locus in <italic>Mtb</italic> genome [<xref ref-type="bibr" rid="CR2">2</xref>]. Each DR region consists of several copies of the 36 bp DR sequence, which are interspersed with 34 bp to 41 bp non-repetitive spacers [<xref ref-type="bibr" rid="CR3">3</xref>]. A set of 43 unique spacer sequences is used to classify <italic>Mtb</italic> strains based on their presence or absence. The patterns of presence and absence in each of the 43 spacer sequences can be summarized with a 43-digit binary code with 1 denoting the presence and 0 denoting the absence for each spacer, which can also be translated into a 15-digit numerical code [<xref ref-type="bibr" rid="CR4">4</xref>] termed as the spoligotype. Spoligotypes can be used to compare <italic>Mtb</italic> isolates collected between different laboratories and countries. Spoligotyping is traditionally conducted using the PCR-based reverse line hybridization blotting technique [<xref ref-type="bibr" rid="CR2">2</xref>]. Various new methods have recently been proposed for spoligotyping, the most of which are microarrays, such as the PixSysn QUAD 4500 Microarrayer [<xref ref-type="bibr" rid="CR5">5</xref>], DNA microarray [<xref ref-type="bibr" rid="CR6">6</xref>], hydrogel microarray (biochip) [<xref ref-type="bibr" rid="CR7">7</xref>], <italic>Spoligorifytyping</italic> [<xref ref-type="bibr" rid="CR8">8</xref>], and its follow-up TB-SPRINT [<xref ref-type="bibr" rid="CR9">9</xref>]. Other spoligotyping methods include those based on a matrix-assisted laser desorption/ionization time-of-flight mass-spectrometry (MALDI-ToF MS) platform [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Spoligotyping has also been applied to strain typing in other bacteria species such as <italic>Legionella pneumophila</italic> [<xref ref-type="bibr" rid="CR12">12</xref>], <italic>Campylobacter jejuni</italic> [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], and <italic>Salmonella</italic> [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p>Technological advancements in next-generation sequencing provide single nucleotide resolution for <italic>Mtb</italic> phylogenetic studies by allowing the construction of a single nucleotide polymorphism (SNP)-based phylogenetic tree. However, genotyping of bacteria is still needed for fast strain identification and correlation to previous isolates. For previous isolates, particularly the historical isolates, genotypes including spoligotypes may have been determined but whole genome sequences are not available and some isolates are not able to be sequenced. Under such circumstances, <italic>in silico</italic> genotyping from the whole genome sequences is necessary for correlating current isolates with previously genotyped ones. Several molecular genotyping techniques exist for <italic>Mtb</italic>, of which the most widely used are: (1) spoligotyping; (2) mycobacterial interspersed repetitive units - variable numbers of tandem repeat (MIRU-VNTR); and (3) IS<italic>6110</italic>-based restriction fragment length polymorphism (IS<italic>6110</italic>-RFLP) [<xref ref-type="bibr" rid="CR16">16</xref>]. The inference of MIRU-VNTR from next-generation sequencing reads involves resolving the tandem repeats, which is extremely challenging for the current short sequence reads generated by the most widely used sequencing platforms. IS<italic>6110</italic>-RFLP commonly has its result based on the DNA fragment blots on electrophoresis gel image and thus focuses on the determination of the fragment lengths, which is also extremely challenging to infer since short read sequencing cannot be used alone to construct finished genomes. Spoligotyping, therefore, provides a unique opportunity to obtain the same result from whole genome sequences as the molecular genotyping result achieved in laboratories, which can correlate the isolates investigated using different approaches. <italic>In silico</italic> spoligotyping is also important for investigations using public data, where sequencing reads or complete genomic sequences are available but the spoligotypes of the isolates are not reported.</p>
    <p><italic>SpolPred</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] is a tool that accurately predicts the spoligotype of <italic>Mtb</italic> isolates from sequence reads of uniform length obtained from platforms such as Illumina GAII and HiSeq. However, for reads produced by platforms marketed for clinical diagnostics such as Illumina MiSeq and Ion sequencers, where the throughput is moderate and length of the reads are non-uniform, the accuracy of <italic>SpolPred</italic> is significantly reduced. <italic>SpoTyping</italic> improves the performance of <italic>SpolPred</italic> in three ways: (1) <italic>SpolPred</italic> reads in a fixed number of bases from each sequencing read as specified by the user. As a result, for sequencing experiments with non-uniform read length, the accuracy of prediction is highly dependent on the choices of the read length by the users. <italic>SpoTyping</italic>, by reading in the full length of the reads, makes use of all the available sequence data. (2) <italic>SpolPred</italic> requires the user to specify a direction for the reads, which can be either direct or reverse. However, since each FASTQ file consists of both direct and reverse reads, <italic>SpolPred</italic> only utilizes a fraction of the input sequence reads which can lead to incorrect predictions for sequencing experiments with low throughput. <italic>SpoTyping</italic> explicitly considers the reads in both directions, thereby using all the information presented in the sequence reads. (3) <italic>SpolPred</italic> relies on an inefficient sequence search algorithm, whereas <italic>SpoTyping</italic> integrates the BLAST algorithm in the search which reduces the time of the search considerably. In addition to the improvements listed above, <italic>SpoTyping</italic> also comes with novel functions not previously found in <italic>SpolPred</italic> or other software: (1) For TB disease outbreak investigation, it is necessary to quickly identify isolates with matching spoligotypes. <italic>SpoTyping</italic> thus automatically queries SITVIT [<xref ref-type="bibr" rid="CR18">18</xref>], a global <italic>Mtb</italic> molecular markers database to retrieve associated epidemiological data for isolates with matched spoligotypes in an Excel spreadsheet, which can be presented as a graphical report showing the distribution summaries of the meta-data corresponding to the clades, years, and countries of isolation for these isolates. (2) <italic>SpoTyping</italic> works on different input files such as next-generations sequencing reads in FASTQ format, and complete genomic sequences or assembled contigs in FASTA format. (3) <italic>SpoTyping</italic> can be run on most operating systems such as Windows, Linux, and Mac OS, either as a non-interactive script which can be integrated into individual analysis pipelines or as an interactive application with a graphical user interface. Thus, we believe <italic>SpoTyping</italic> would be a useful tool for public health surveillance and genotyping from next-generation sequencing data in microbiological clinical diagnostic of <italic>Mtb</italic> strains.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p><italic>SpoTyping</italic> is implemented with Python and accepts two kinds of input files: single-end or pair-end sequence reads in FASTQ format, and complete genomic sequences or assembled contigs in FASTA format. A schematic representation of the <italic>SpoTyping</italic> workflow is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. When the input files are sequence reads, <italic>SpoTyping</italic> first concatenates all sequence reads in the input FASTQ file(s) into a single contiguous sequence in FASTA format which would be constructed into a BLAST [<xref ref-type="bibr" rid="CR19">19</xref>] nucleotide database. The current program default (enabling the swift mode) is to read in no more than 250 Mbp of the sequence reads, which corresponds to a read depth of approximately 55X of the <italic>Mtb</italic> genome and would be sufficient in most situations. Disabling the swift mode would require <italic>SpoTyping</italic> to utilize all sequence reads with increased execution time. The set of 43 spacer sequences, each of 25 bp in length, would be queried against the constructed database using the standard nucleotide BLAST program. The BLAST output is then parsed to determine the number of hits for each spacer sequence in the input file(s). A maximum of one mismatch out of 25 bp of the spacer sequence is allowed for a BLAST match to be considered as a hit. For sequence reads, if a spacer sequence is absent in the <italic>Mtb</italic> isolate, then no or very few hits would be identified, while if the number of hits exceeds a threshold (hit threshold has a default of five error-free hits and six 1-error-tolerant hits), it indicates the presence of the spacer sequence where the number of hits correlates with the sequence read depth of the locus. For genomic sequences or assembled contigs, the presence of one hit for a spacer sequence indicates the presence of the spacer. The binary string of 43 digits, each digit representing one of the 43 spacer sequences with 0 indicating absence and 1 indicating presence, can therefore be written into an octal code that defines the spoligotype of the <italic>Mtb</italic> isolate. The predicted spoligotype is then automatically queried in the SITVIT database to retrieve all reported isolates having identical spoligotypes, where associated data corresponding to the MIRU12, VNTR, SIT, MIT, VIT, clades, countries of origin, countries of isolation, and year of report for these isolates would be downloaded in an Excel spreadsheet. <italic>SpoTyping</italic> also includes an R script that can present summary statistics of the associated meta-data as a pdf report.<fig id="Fig1"><label>Fig. 1</label><caption><p>A schematic representation of the <italic>SpoTyping</italic> workflow. If the specified input contains sequencing reads, <italic>SpoTyping</italic> first concatenates the sequencing reads to form an artificial sequence. The artificial sequence, or genetic sequences when the input contains complete genomic sequence or assembled contigs, would be built into the BLAST database. After querying the 43 spacer sequences in the database, the results are parsed to count the number of hits for each spacer sequence. A hit threshold is set to define a spacer as ‘present’ in the genome, resulting in a 43-digit binary code with 1 as present and 0 as absent, which is further translated into the octal code of the spoligotype. The SITVIT database is then queried to identify matching isolates having the same spoligotype, where the associated data of the matched isolates are downloaded and summarized as pie charts</p></caption><graphic xlink:href="13073_2016_270_Fig1_HTML" id="MO1"/></fig></p>
    <p>The accuracy of <italic>SpoTyping</italic> was assessed in comparison with <italic>SpolPred</italic> on three datasets: (1) 161 isolates sequenced on Illumina HiSeq (SRA: SRA065095); (2) 30 isolates sequenced on Illumina MiSeq (ENA: PRJNA218508); and (3) 16 isolates sequenced on Ion Torrent (ENA: PRJEB6576). The first assessment was conducted on a dataset of 161 <italic>Mtb</italic> isolates sequenced on Illumina HiSeq with experimentally determined spoligotypes reported [<xref ref-type="bibr" rid="CR20">20</xref>]. Both <italic>SpoTyping</italic> and <italic>SpolPred</italic> were run with default parameters. The predicted octal codes were each queried in the SITVIT database to identify the matching spoligotype for comparison with the reported spoligotype. Discordant results were examined by searching the spacer sequences on the contigs assembled using the <italic>de novo</italic> assembly software <italic>Velvet</italic> [<xref ref-type="bibr" rid="CR21">21</xref>]. The next assessment was conducted on a dataset of 30 <italic>Mtb</italic> isolates sequenced on Illumina MiSeq without reported spoligotypes. The reference spoligotype for each isolate was determined by manual inspection of the BLAST output file to determine the number of hits for each spacer sequence in the sequence reads. Given that the sequence read depths are above 20X for all isolates, no hit for a spacer sequence is a strong indication of its absence while a number of above five hits is a strong indication of the presence of the spacer sequence. While a judgement cannot be safely made based on a hit number of 1 to 5, isolates with at least one such case were removed from the study, leaving only isolates with confident reference spoligotypes. <italic>SpoTyping</italic> was run with default parameters while <italic>SpolPred</italic> calls for a specified read length, where a range of read lengths were used based on the read length percentiles from 0.04 to 1 at a step of 0.04, resulting in a total of 25 predictions for each isolate. The accuracy of <italic>SpoTyping</italic> was also assessed in comparison with <italic>SpolPred</italic> on a dataset of 16 <italic>Mtb</italic> isolates sequenced on Ion Torrent. The reference spoligotypes were determined similarly as those for Illumina MiSeq data. The running parameters were also similar as those for Illumina MiSeq data.</p>
    <p>The time performance of <italic>SpoTyping</italic> was compared with <italic>SpolPred</italic> based on the first dataset. The programs were run on a 64-bit Fedora Linux server workstation having a 2.0 GHz quad processor and 32 GB RAM. Both <italic>SpoTyping</italic> and <italic>SpolPred</italic> were run twice for each isolate either with or without the swift mode. Default parameters were used for <italic>SpoTyping</italic> swift mode, while for non-swift mode, 10 error-free hits or 12 1-error-tolerant hits (options of -m 10 -r 12) was taken as the hit threshold due to the high sequencing coverage to eliminate false positives. For <italic>SpolPred</italic>, the pair-end sequence reads were first concatenated (concatenation time not counted toward the running time). The read lengths were set to be the actual read lengths. The hit threshold was similarly set to be 10 (option of -m 10) in the non-swift mode.</p>
    <p>The performance of <italic>SpoTyping</italic> was assessed for various sequence read depths to determine its applicable range, where we determined the accuracies of the <italic>SpoTyping</italic> prediction for: (1) an H37Ra <italic>Mtb</italic> isolate which had a sequencing throughput of 3,000 Mbp (approximately 670X); and (2) a Beijing-genotype <italic>Mtb</italic> isolate with a sequencing throughput of 2,700 Mbp (approximately 600X) by performing 50 iterations each for six down-sampling ratios of 50 %, 20 %, 10 %, 5 %, 2 %, and 1 % of the initial number of reads for each isolate. In each down-sampling experiment, a certain percent of the sequence reads were randomly selected from the original FASTQ file to form a new file with a lower read depth, where the percentage is called the down-sampling ratio. For all of the down-sampling experiments, default settings were used except for the categories of 2 % and 1 % where the hit threshold was set to two error-free hits and three 1-error-tolerant hits (options of -m 2 -r 3). The false positives caused by the concatenation of sequence reads were also assessed in the down-sampling experiment.</p>
    <p>The selection of the hit thresholds was also based on the down-sampling experiments. In each down-sampling experiment, the number of both error-free hits and 1-error-tolerant hits for each spacer identified by <italic>SpoTyping</italic> were divided by the estimated read depth (number of sequence bases/ 4,500,000) of the experiment, representing the number of hits as a percentage of the estimated read depth. For each spacer in each experiment, the percentage is used as the feature to classify a spacer as present or absent, while the spacer’s actual class of presence or absence is used to assess whether the classification is correct. A set of percentages was used as the thresholds to calculate the respective true positive rates and false positive rates, which were plotted as a receiver operating characteristic (ROC) curve. The thresholds were selected to maximize the true positive rate while minimizing the false positive rate.</p>
    <p>The Beijing-genotype isolate can be accessed through the European Nucleotide Archive (ENA) code ERP006354. The H37Ra isolate is a laboratory strain that was sequenced as part of a validation sequencing run, and the FASTQ files will be provided upon request.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title><italic>In silico</italic> spoligotyping of 161 <italic>Mtb</italic> isolates sequenced on Illumina HiSeq</title>
      <p>For all the 161 <italic>Mtb</italic> isolates, <italic>SpoTyping</italic> and <italic>SpolPred</italic> predicted the same spoligotypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), of which 20 isolates either without a match in the SITVIT database or reported as ‘New’ were excluded from subsequent comparisons. Of the remaining 141 isolates, predictions of <italic>SpoTyping</italic> and the laboratory determined spoligotypes for 127 isolates (90.07 %) were identical. For the 14 discordant isolates, the spacer sequences were searched in the assembled contigs to determine the spoligotypes, which are all concordant with the predictions from <italic>SpoTyping</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
    </sec>
    <sec id="Sec5">
      <title><italic>In silico</italic> spoligotyping of 30 <italic>Mtb</italic> isolates sequenced on Illumina MiSeq</title>
      <p>The accuracy of <italic>SpoTyping</italic> was then assessed in comparison with <italic>SpolPred</italic> on 30 <italic>Mtb</italic> isolates sequenced on Illumina MiSeq, among which 21 passed filtering for having reference spoligotypes confidently determined. <italic>SpoTyping</italic> correctly inferred the spoligotypes for all 21 isolates. Since <italic>SpolPred</italic> requires for a read length to be specified as input, a range of read lengths were assessed based on the percentiles from 0.04 to 1 at a step of 0.04, resulting in a total of 25 predictions for each isolate whose read length specifications are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. At each percentile, the predictions for the 21 isolates were analyzed to calculate the prediction accuracy, which is summarized in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4. <italic>SpolPred</italic> performs the best using the read lengths at the 0.36, 0.40, or 0.44 percentiles, with accuracies around 50 %. The prediction accuracy of <italic>SpolPred</italic> is significantly lower than that obtained by <italic>SpoTyping</italic> and is also highly dependent on the choice of read length used as input which in itself is difficult to determine.<fig id="Fig2"><label>Fig. 2</label><caption><p>Prediction accuracy of <italic>Mtb</italic> isolates sequenced on Illumina MiSeq and Ion Torrent. <italic>SpolPred</italic> requires a read length to be specified which results in inconsistent predictions for different specifications. The accuracy assessment was conducted between <italic>SpoTyping</italic> (<bold>a</bold>) and <italic>SpolPred</italic> (<bold>b</bold>) on 21 MiSeq-sequenced isolates and 11 Ion-sequenced isolates, with <italic>SpoTyping</italic> predictions using default parameters and <italic>SpolPred</italic> predictions using different read length percentiles as the input read lengths. While <italic>SpoTyping</italic> have perfect accuracies for both datasets, <italic>SpolPred</italic> gives varying accuracies depending on the read length, which are always lower than 50 %</p></caption><graphic xlink:href="13073_2016_270_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title><italic>In silico</italic> spoligotyping of 16 <italic>Mtb</italic> isolates sequenced on Ion Torrent</title>
      <p>The accuracy for spoligotype inference was also determined on 16 <italic>Mtb</italic> isolates sequenced on Ion Torrent with spoligotypes reported to be all Beijing genotype [<xref ref-type="bibr" rid="CR22">22</xref>]. Of the 16 isolates, 11 have confidently determined spoligotypes, which are all of the spoligotype ‘000000000003771’ as are consistent with the reported Beijing genotype. <italic>SpoTyping</italic> makes correct prediction for all the 11 isolates. The performance of <italic>SpolPred</italic> is summarized in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5 and Table S6. <italic>SpolPred</italic> performs best using the read length at the 0.08 and 0.12 percentile, with accuracies of only around 10 %.</p>
    </sec>
    <sec id="Sec7">
      <title>Comparison of time performance for <italic>SpoTyping</italic> and <italic>SpolPred</italic> on 161 <italic>Mtb</italic> isolates</title>
      <p>For the 161 <italic>Mtb</italic> isolates tested, <italic>SpoTyping</italic> is about 20 to 40 times faster than <italic>SpolPred</italic>, with <italic>SpoTyping</italic> taking an average of 28.8 s (standard deviation is 5.3 s) in its swift mode, and an average of 56.4 s (standard deviation is 8.0 s) to process all reads, while <italic>SpolPred</italic> took an average of 17 min 19.3 s (standard deviation is 1 min 35.3 s) by using the -s option, or an average of 18 min 20.0 s (standard deviation is 50.2 s) to process all reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).</p>
    </sec>
    <sec id="Sec8">
      <title>Down-sampling experiments</title>
      <p>Based on the down-sampling experiments which first explore the applicable throughput for accurate spoligotype inference, <italic>SpoTyping</italic> is able to efficiently and accurately predict the spoligotype for isolates having sequencing throughput over 54 Mbp (read depth of approximately 12X) with accuracies above 98 % (Fig. <xref rid="Fig3" ref-type="fig">3</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7 for H37Ra and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8 for Beijing). However, for isolates that are sequenced at very low coverage (below 10X), using the lower threshold is still not sufficient to make accurate predictions as some of the spacer sequences would not be adequately sequenced and represented in the input FASTQ file(s).<fig id="Fig3"><label>Fig. 3</label><caption><p>Assessing the accuracy of <italic>SpoTyping</italic> across various sequence read depths for H37Ra and Beijing-genotype isolates. With blue points denoting the Beijing genotype, pink points denoting H37Ra, the prediction accuracies were assessed with the sequencing throughput measured by the number of bases for all the down-sampling experiments. <italic>SpoTyping</italic> is suitable for sequencing runs with throughput over 54 Mbp (estimated depth of approximately 12X), where the accuracy is almost 100 %</p></caption><graphic xlink:href="13073_2016_270_Fig3_HTML" id="MO3"/></fig></p>
      <p>Since <italic>SpoTyping</italic> concatenates sequence reads into an artificial sequence to create the BLAST database, an immediate concern is the false positives created due to chimera sequences. In all of 600 down-sampling experiments performed for both H37Ra and Beijing genotype <italic>Mtb</italic> isolates, the maximum number of false positive hit is 1 for both error-free hits and 1-error-tolerant hits. Of the experiments, 98.3 % (590/600) show no false positive error-free hits while 95.7 % (574/600) show no false positive 1-error-tolerant hits. The likelihood of false positives created due to chimera sequences is thus low which can be further reduced by setting more stringent hit thresholds.</p>
    </sec>
    <sec id="Sec9">
      <title>Threshold selection</title>
      <p>We evaluated the choice of the hit thresholds to determine the presence or absence of a spacer sequence used in <italic>SpoTyping</italic>. The evaluation was conducted in the down-sampling experiments, based on the groups with down-sampling ratios from 2 % to 50 % (read depths between approximately 12X and approximately 300X) where accurate inferences for the spacer sequences are possible to be made. A total of 21,586 spacer sequence instances ((5 down-sampling ratios * 50 rounds for each down-sampling ratio * 43 spacer for each round + 43 spacers without down-sampling) = 10,793 spacers for each of the two strains) with their respective number of hits identified by <italic>SpoTyping</italic> were included in the analysis, of which 10,040 are absent cases and 11,546 are present cases. The number of hits was divided by the estimated read depth to represent the number of hits as a percentage of the read depth in order to adjust for the difference in sequencing throughput. A set of percentages was used as the thresholds to calculate the respective true positive rates and false positive rates, which were plotted as an ROC curve (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The ROC curves for both the error-free hits (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>) and 1-error-tolerant hits (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>) show very high true positive rates and very low false positive rates, with the areas under the ROC being 0.9999997 and 0.9999998, respectively. False positive rates are always nearly 0, while the true positive rates are above 99 % by setting the thresholds to be 1.80 % to 14.86 % of the read depth for error-free hits and 1.80 % to 14.88 % of the read depth for 1-error-tolerant hits. Thus the default thresholds of five error-free hits and six 1-error-tolerant hits are applicable to sequencing experiments with estimated read depths between approximately 30X and approximately 280X. The thresholds can be adjusted accordingly given sequencing throughputs beyond this range.<fig id="Fig4"><label>Fig. 4</label><caption><p>ROC curves for the selection of hit thresholds. The ROC curves were plotted for both error-free hits (<bold>a</bold>) and 1-error-tolerant hits (<bold>b</bold>) to select the hit thresholds. Diagonal lines, also known as lines of no discrimination, were plotted as references of random guess. The threshold evaluation was based on a percentage calculated as the number of hits divided by the estimated read depth. A set of percentages was used as the thresholds to calculate the respective true positive rates and false positive rates, which were plotted as the ROC curves. Both ROC curves show constantly high true positive rates and low false positive rates, with the areas under the ROC being 0.9999997 and 0.9999998, respectively</p></caption><graphic xlink:href="13073_2016_270_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p>The increasing global burden of TB, especially drug-resistant strains, has put a significant spotlight on pathogen whole genome sequencing as a rapid diagnostic tool, which is of great relevance to both public health surveillance and clinical treatment. The application of next-generation sequencing in clinical microbiology requires fast and easy-to-use software that is able to accurately produce easily comprehensible results. As shown, <italic>SpoTyping</italic> is able to accurately determine the spoligotype of the <italic>Mtb</italic> isolate rapidly. Contrary to <italic>SpolPred</italic> which is sensitive to the user-specified read length and gives inconsistent predictions at different read lengths, <italic>SpoTyping</italic> gives accurate predictions based on sequence reads produced from different technologies regardless of the length uniformity of the sequence reads and is 20 to 40 times faster than <italic>SpolPred</italic>. The additional functions of database query, information visualization and report generation provided by <italic>SpoTyping</italic> where the predicted spoligotype is automatically queried in the SITVIT database to retrieve all associated epidemiological data corresponding to the MIRU12, VNTR, SIT, MIT, VIT, clades, countries of origin, countries of isolation, and year of report and presented as a report would be a useful tool for public health surveillance of <italic>Mtb</italic> strains causing tuberculosis.</p>
    <p>While there are several molecular typing techniques for <italic>Mtb</italic>, the most widely used are spoligotyping, MIRU-VNTR, and IS6110-RFLP. Spoligotyping, though being a relatively simple, cost-effective, and high-throughput method, suffers from the limitations of: (1) having relatively low discriminatory power [<xref ref-type="bibr" rid="CR23">23</xref>] due to its use of only a single genetic locus; and (2) having limited use in phylogenetic study. Among the genotyping methods for <italic>Mtb</italic>, a combination of spoligotyping and MIRU-VNTR was reported to be the best strategy [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. However, significant technical challenges currently exist for the accurate <italic>in silico</italic> typing from next-generation sequencing reads of MIRU-VNTR which involves resolving tandem repeats and IS6110-RFLP whose result is based on DNA fragment blots on electrophoresis gel image and thus involves the determination of the fragment lengths. Spoligotyping, as a result, provides a unique chance to obtain the same result from whole genome sequences as the molecular typing result achieved in laboratories, which can correlate the isolates investigated with different approaches. Though spoligotyping has less discrimination power than SNP phylogeny inferred from whole genome sequences, it is unique in correlating the genomic data produced in research labs and the molecular typing data from clinical laboratories. Thus <italic>in silico</italic> spoligotyping is not only a genotyping method for <italic>Mtb</italic> isolate differentiation, but also a bridge between isolates with whole genome sequences available and isolates typed and investigated with traditional laboratory protocols, especially those historical isolates that are not sequenced. Inexorably, clinical surveillance and management of TB, particularly for disease diagnosis and treatment, will progress towards the use of direct <italic>Mtb</italic> sequencing. Thus the ease of use and interpretability of the results will be of considerable importance to users within a clinical setting, which is well achieved with <italic>SpoTyping</italic>.</p>
    <p>A recently published letter reported CASTB, an analysis server for the <italic>Mycobacterium tuberculosis</italic> complex, which provides next-generation sequencing data analysis tools for virtual typing (spoligotyping included), virtual drug resistance analysis, and phylogenetic analysis [<xref ref-type="bibr" rid="CR26">26</xref>]. While the webserver provides a comprehensive overview at the sequencing data, the performance of each tool is not well evaluated in the publication. More accurate and well assessed tools are thus needed for further analysis. <italic>SpoTyping</italic> is well assessed to provide high accuracy for <italic>in silico</italic> spoligotyping and thus demonstrates the reliability of the results. <italic>SpoTyping</italic> also benefits from its open source nature that it can be easily integrated into in-house analysis pipelines for in-depth analysis of the sequencing data. When talking about execution time, services provided by web servers may be very slow due to the inherent issues such as the process of data uploading and the availability of the computational resources. <italic>SpoTyping</italic>, on the other hand, can be set up locally and provides the spoligotyping result within a minute.</p>
    <p>For the 14 discordant spoligotypes between the laboratory tests and the <italic>in silico</italic> predictions made by <italic>SpoTyping</italic> in the 161 <italic>Mtb</italic> isolates sequenced on Illumina HiSeq, the SNP-based phylogenetic tree of these 161 Mtb isolates in the original article [<xref ref-type="bibr" rid="CR20">20</xref>] was examined to compare the lineage with the spoligotyping results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9). Out of the 14 discordant results, three showed better concordance of the <italic>in silico</italic> prediction with the lineage on the tree. As an example, an isolate (Accession: SRR671868, Strain: 143) located at Lineage 4.2 on the SNP-based phylogenetic tree is reported to be a Beijing genotype based on the laboratory test in the publication, while predicted to be a T2 genotype by <italic>SpoTyping</italic>. However, the Beijing genotype is usually found at East Asia Lineage 2, while Lineage 4 usually harbors the Euro-American genotypes. One of the discrepancies may be caused by the different naming of spoligotypes in different databases (Beijing and Beijing-like). Definite conclusion cannot be made for the remaining 10 isolates for which the reported spoligotype and <italic>in silico</italic> predicted spoligotype are different while the lineages for both spoligotypes are similar (T2 and H3, for example). For such isolates, the difference could be due to the discrepancy between laboratory tests and the genomic features.</p>
  </sec>
  <sec id="Sec11" sec-type="conclusion">
    <title>Conclusions</title>
    <p><italic>SpoTyping</italic> is an accurate, fast, and easy-to-use program for <italic>in silico</italic> spoligotyping of <italic>Mtb</italic> isolates from next-generation sequencing reads, complete genomic sequences, and assembled contigs. In addition, <italic>SpoTyping</italic> automatically queries the global <italic>Mtb</italic> molecular markers database SITVIT to retrieve associated data for matching isolates with the inferred spoligotypes, which can be summarized graphically to generate a report. <italic>SpoTyping</italic> would be a useful tool for public health surveillance and genotyping of <italic>Mtb</italic> strains.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p><bold>Project name:</bold> SpoTyping</p>
        </list-item>
        <list-item>
          <p>
            <bold>Project home page:</bold>
            <ext-link ext-link-type="uri" xlink:href="https://github.com/xiaeryu/SpoTyping-v2.0">https://github.com/xiaeryu/SpoTyping-v2.0</ext-link>
          </p>
        </list-item>
        <list-item>
          <p><bold>Operating systems:</bold> Linux, Mac OS, Windows</p>
        </list-item>
        <list-item>
          <p><bold>Programming language:</bold> Python (version 2.7)</p>
        </list-item>
        <list-item>
          <p><bold>Other requirements:</bold> BLAST</p>
        </list-item>
        <list-item>
          <p><bold>License:</bold> GNU General Public License</p>
        </list-item>
        <list-item>
          <p><bold>Any restrictions to use by non-academics:</bold> None</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec13">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13073_2016_270_MOESM1_ESM.xlsx" id="MOESM1">
            <label>Additional file 1: Table S1.</label>
            <caption>
              <p>Spoligotype prediction and time performance of 161 <italic>Mtb</italic> isolates with <italic>SpoTyping</italic> in comparison with <italic>SpolPred</italic>. <bold>Table S2.</bold> Spoligotypes of 14 <italic>Mtb</italic> isolates determined from contigs obtained by <italic>de novo</italic> assembly, <italic>Velvet</italic>. <bold>Table S3.</bold> Actual length at different percentiles used as the read length for <italic>SpolPred</italic> spoligotype prediction of isolates sequenced on Illumina MiSeq. <bold>Table S4.</bold> Spoligotype prediction for <italic>Mtb</italic> isolates sequenced by Illumina MiSeq with <italic>SpoTyping</italic> in comparison with <italic>SpolPred</italic>. <bold>Table S5.</bold> Actual length at different percentiles used as the read length for <italic>SpolPred</italic> spoligotype prediction of isolates sequenced on Ion Torrent. <bold>Table S6.</bold> Spoligotype prediction for <italic>Mtb</italic> isolates sequenced by Ion Torrent with <italic>SpoTyping</italic> in comparison with <italic>SpolPred</italic>. <bold>Table S7.</bold> Statistics of time and accuracy of running <italic>SpoTyping</italic> on 50 iterations each for various down-sampling ratios of an H37Ra <italic>Mtb</italic> isolate. <bold>Table S8.</bold> Statistics of time and accuracy of running <italic>SpoTyping</italic> on 50 iterations each for various down-sampling ratios of a Beijing <italic>Mtb</italic> isolate. <bold>Table S9.</bold> Lineages of 14 discordant <italic>Mtb</italic> isolates by <italic>SpoTyping</italic>, experimentally reported and phylogenetic tree. (XLSX 55 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CRISPR</term>
        <def>
          <p>clustered regularly interspaced short palindromic repeats</p>
        </def>
      </def-item>
      <def-item>
        <term>DR</term>
        <def>
          <p>direct repeat</p>
        </def>
      </def-item>
      <def-item>
        <term>MIRU-VNTR</term>
        <def>
          <p>mycobacterial interspersed repetitive units - variable numbers of tandem repeat</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>Mtb</italic>
        </term>
        <def>
          <p>
            <italic>Mycobacterium tuberculosis</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>RFLP</term>
        <def>
          <p>restriction fragment length polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p>receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>TB</term>
        <def>
          <p>tuberculosis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>EX, YYT, and RTHO conceived the project. EX designed and implemented the project with help from YYT and RTHO. EX and RTHO wrote the manuscript. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Li-Hwei Sng and Justine Peh from Central Tuberculosis Laboratory, Department of Pathology, Singapore General Hospital for the culture and DNA extraction of the H37Ra and Beijing genotype <italic>Mtb</italic> isolates, and Christopher Wong, Min Gong, and Hui-Maan Seah from Genome Institute of Singapore for the whole genome sequencing of both H37Ra and Beijing genotype <italic>Mtb</italic> isolates.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>EX is supported by a scholarship from NUS Graduate School for Integrative Sciences and Engineering.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>World Health Organization</collab>
        </person-group>
        <source>Tuberculosis Fact Sheet 104</source>
        <year>2015</year>
        <publisher-loc>Geneva</publisher-loc>
        <publisher-name>WHO</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Zanden</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Hoentjen</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Heilmann</surname>
            <given-names>FG</given-names>
          </name>
          <name>
            <surname>Weltevreden</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Schouls</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>van Embden</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous detection and strain differentiation of Mycobacterium tuberculosis complex in paraffin wax embedded tissues and in stained microscopic preparations</article-title>
        <source>Mol Pathol.</source>
        <year>1998</year>
        <volume>51</volume>
        <fpage>209</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="doi">10.1136/mp.51.4.209</pub-id>
        <?supplied-pmid 9893747?>
        <pub-id pub-id-type="pmid">9893747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hermans</surname>
            <given-names>PWM</given-names>
          </name>
          <name>
            <surname>Van Soolingen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bik</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>De Haas</surname>
            <given-names>PEW</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Van Embden</surname>
            <given-names>JDA</given-names>
          </name>
        </person-group>
        <article-title>Insertion element IS987 from Mycobacterium bovis BCG is located in a hot-spot integration region for insertion elements in Mycobacterium tuberculosis complex strains</article-title>
        <source>Infect Immun.</source>
        <year>1991</year>
        <volume>59</volume>
        <fpage>2695</fpage>
        <lpage>2705</lpage>
        <?supplied-pmid 1649798?>
        <pub-id pub-id-type="pmid">1649798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dale</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Brittain</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cataldi</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Cousins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Driscoll</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spacer oligonucleotide typing of bacteria of the Mycobacterium tuberculosis complex: Recommendations for standardised nomenclature</article-title>
        <source>Int J Tuberc Lung Dis</source>
        <year>2001</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>216</fpage>
        <lpage>219</lpage>
        <?supplied-pmid 11326819?>
        <pub-id pub-id-type="pmid">11326819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>YK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A DNA chip-based spoligotyping method for the strain identification of Mycobacterium tuberculosis isolates</article-title>
        <source>J Microbiol Methods.</source>
        <year>2007</year>
        <volume>68</volume>
        <fpage>430</fpage>
        <lpage>433</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2006.09.005</pub-id>
        <?supplied-pmid 17046089?>
        <pub-id pub-id-type="pmid">17046089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruettger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nieter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Skrypnyk</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engelmann</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ziegler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moser</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid spoligotyping of Mycobacterium tuberculosis complex bacteria by use of a microarray system with automatic data processing and assignment</article-title>
        <source>J Clin Microbiol.</source>
        <year>2012</year>
        <volume>50</volume>
        <fpage>2492</fpage>
        <lpage>2495</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00442-12</pub-id>
        <?supplied-pmid 22553239?>
        <pub-id pub-id-type="pmid">22553239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bespyatykh</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Zimenkov</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Shitikov</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Kulagina</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Lapa</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Gryadunov</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spoligotyping of Mycobacterium tuberculosis complex isolates using hydrogel oligonucleotide microarrays</article-title>
        <source>Infect Genet Evol.</source>
        <year>2014</year>
        <volume>26</volume>
        <fpage>41</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1016/j.meegid.2014.04.024</pub-id>
        <?supplied-pmid 24815729?>
        <pub-id pub-id-type="pmid">24815729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomgnimbou</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Abadia</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Refrégier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Panaiotov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bachiyska</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>“Spoligoriftyping”, a dual-priming-oligonucleotide-based direct-hybridization assay for tuberculosis control with a multianalyte microbead-based hybridization system</article-title>
        <source>J Clin Microbiol.</source>
        <year>2012</year>
        <volume>50</volume>
        <fpage>3172</fpage>
        <lpage>3179</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00976-12</pub-id>
        <?supplied-pmid 22814456?>
        <pub-id pub-id-type="pmid">22814456</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomgnimbou</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Hernández-Neuta</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Panaiotov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bachiyska</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Palomino</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tuberculosis-spoligo-rifampin-isoniazid typing: an all-in-one assay technique for surveillance and control of multidrug-resistant tuberculosis on Luminex devices</article-title>
        <source>J Clin Microbiol.</source>
        <year>2013</year>
        <volume>51</volume>
        <fpage>3527</fpage>
        <lpage>3534</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.01523-13</pub-id>
        <?supplied-pmid 23966495?>
        <pub-id pub-id-type="pmid">23966495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Honisch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mosko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gharbia</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Niemann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Replacing reverse line blot hybridization spoligotyping of the Mycobacterium tuberculosis complex</article-title>
        <source>J Clin Microbiol.</source>
        <year>2010</year>
        <volume>48</volume>
        <fpage>1520</fpage>
        <lpage>1526</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02299-09</pub-id>
        <?supplied-pmid 20200291?>
        <pub-id pub-id-type="pmid">20200291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shitikov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ilina</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chernousova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Borovskaya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rukin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Afanas’ev</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mass spectrometry based methods for the discrimination and typing of mycobacteria</article-title>
        <source>Infect Genet Evol.</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>838</fpage>
        <lpage>845</lpage>
        <pub-id pub-id-type="doi">10.1016/j.meegid.2011.12.013</pub-id>
        <?supplied-pmid 22230718?>
        <pub-id pub-id-type="pmid">22230718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ginevra</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jacotin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Diancourt</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Guigon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Arquilliere</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meugnier</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Legionella pneumophila sequence type 1/Paris pulsotype subtyping by spoligotyping</article-title>
        <source>J Clin Microbiol.</source>
        <year>2012</year>
        <volume>50</volume>
        <fpage>696</fpage>
        <lpage>701</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.06180-11</pub-id>
        <?supplied-pmid 22205819?>
        <pub-id pub-id-type="pmid">22205819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huygens</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Giffard</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>High-resolution DNA melt curve analysis of the clustered, regularly interspaced short-palindromic-repeat locus of Campylobacter jejuni</article-title>
        <source>Appl Environ Microbiol.</source>
        <year>2007</year>
        <volume>73</volume>
        <fpage>3431</fpage>
        <lpage>3436</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.02702-06</pub-id>
        <?supplied-pmid 17400785?>
        <pub-id pub-id-type="pmid">17400785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schouls</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Reulen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wagenaar</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Willems</surname>
            <given-names>RJL</given-names>
          </name>
          <name>
            <surname>Dingle</surname>
            <given-names>KE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative genotyping of Campylobacter jejuni by amplified fragment length polymorphism, multilocus sequence typing, and short repeat sequencing: strain diversity, host range, and recombination</article-title>
        <source>J Clin Microbiol.</source>
        <year>2003</year>
        <volume>41</volume>
        <fpage>15</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.41.1.15-26.2003</pub-id>
        <?supplied-pmid 12517820?>
        <pub-id pub-id-type="pmid">12517820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fabre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guigon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Le Hello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Guibert</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Accou-Demartin</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR typing and subtyping for improved laboratory surveillance of Salmonella infections</article-title>
        <source>PLoS One.</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e36995</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0036995</pub-id>
        <?supplied-pmid 22623967?>
        <pub-id pub-id-type="pmid">22623967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barnes</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Cave</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Molecular epidemiology of tuberculosis</article-title>
        <source>N Engl J Med.</source>
        <year>2003</year>
        <volume>349</volume>
        <fpage>1149</fpage>
        <lpage>1156</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra021964</pub-id>
        <?supplied-pmid 13679530?>
        <pub-id pub-id-type="pmid">13679530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mallard</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Preston</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McNerney</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SpolPred: rapid and accurate prediction of Mycobacterium tuberculosis spoligotypes from short genomic sequences</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>22</issue>
        <fpage>2991</fpage>
        <lpage>2993</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts544</pub-id>
        <?supplied-pmid 23014632?>
        <pub-id pub-id-type="pmid">23014632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Demay</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liens</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Burguière</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Couvin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Millet</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SITVITWEB - A publicly available international multimarker database for studying Mycobacterium tuberculosis genetic diversity and molecular epidemiology</article-title>
        <source>Infect Genet Evol.</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>755</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1016/j.meegid.2012.02.004</pub-id>
        <?supplied-pmid 22365971?>
        <pub-id pub-id-type="pmid">22365971</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fleming</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome sequencing of 161 Mycobacterium tuberculosis isolates from China identifies genes and intergenic regions associated with drug resistance</article-title>
        <source>Nat Genet.</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>1255</fpage>
        <lpage>1260</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2735</pub-id>
        <?supplied-pmid 23995137?>
        <pub-id pub-id-type="pmid">23995137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: Algorithms for de novo short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.074492.107</pub-id>
        <?supplied-pmid 18349386?>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witney</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coleman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Delgado</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dhillon</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clinical application of whole genome sequencing to inform treatment for multi-drug resistant tuberculosis cases</article-title>
        <source>J Clin Microbiol</source>
        <year>2015</year>
        <volume>53</volume>
        <issue>5</issue>
        <fpage>1473</fpage>
        <lpage>1483</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02993-14</pub-id>
        <?supplied-pmid 25673793?>
        <pub-id pub-id-type="pmid">25673793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roetzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schuback</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gasau</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ubben</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Di Nauta</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of Mycobacterium tuberculosis typing methods in a 4-year study in Schleswig-Holstein, Northern Germany</article-title>
        <source>J Clin Microbiol.</source>
        <year>2011</year>
        <volume>49</volume>
        <fpage>4173</fpage>
        <lpage>4178</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.05293-11</pub-id>
        <?supplied-pmid 21998434?>
        <pub-id pub-id-type="pmid">21998434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oelemann</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vatin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Rüsch-Gerdes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Locht</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of an optimized mycobacterial interspersed repetitive-unit- variable-number tandem-repeat typing system combined with spoligotyping for population-based molecular epidemiology studies of tuberculosis</article-title>
        <source>J Clin Microbiol.</source>
        <year>2007</year>
        <volume>45</volume>
        <fpage>691</fpage>
        <lpage>697</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.01393-06</pub-id>
        <?supplied-pmid 17192416?>
        <pub-id pub-id-type="pmid">17192416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allix-Béguec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fauville-Dufaux</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Supply</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Three-year population-based evaluation of standardized mycobacterial interspersed repetitive-unit-variable-number tandem-repeat typing of Mycobacterium tuberculosis</article-title>
        <source>J Clin Microbiol.</source>
        <year>2008</year>
        <volume>46</volume>
        <fpage>1398</fpage>
        <lpage>1406</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02089-07</pub-id>
        <?supplied-pmid 18234864?>
        <pub-id pub-id-type="pmid">18234864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iwai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kato-miyazawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kirikae</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Miyoshi-akiyama</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>CASTB (the comprehensive analysis server for the Mycobacterium tuberculosis complex): A publicly accessible web server for epidemiological analyses, drug-resistance prediction and phylogenetic comparison of clinical isolates</article-title>
        <source>Tuberculosis</source>
        <year>2015</year>
        <volume>95</volume>
        <issue>6</issue>
        <fpage>843</fpage>
        <lpage>844</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2015.09.002</pub-id>
        <?supplied-pmid 26542225?>
        <pub-id pub-id-type="pmid">26542225</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
