<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5187446</article-id>
    <article-id pub-id-type="pii">ncomms13642</article-id>
    <article-id pub-id-type="doi">10.1038/ncomms13642</article-id>
    <article-id pub-id-type="pmid">27995928</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Production of individualized V gene databases reveals high levels of immunoglobulin genetic diversity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Corcoran</surname>
          <given-names>Martin M.</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Phad</surname>
          <given-names>Ganesh E.</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bernat</surname>
          <given-names>Néstor Vázquez</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stahl-Hennig</surname>
          <given-names>Christiane</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sumida</surname>
          <given-names>Noriyuki</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6121-4553</contrib-id>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Persson</surname>
          <given-names>Mats A.A.</given-names>
        </name>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Martin</surname>
          <given-names>Marcel</given-names>
        </name>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a4">4</xref>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0680-200X</contrib-id>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hedestam</surname>
          <given-names>Gunilla B. Karlsson</given-names>
        </name>
        <xref ref-type="corresp" rid="c3">c</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Department of Microbiology, Tumor and Cell Biology, Karolinska Institutet</institution>, Stockholm SE-17177, <country>Sweden</country></aff>
      <aff id="a2"><label>2</label><institution>Deutsches Primatenzentrum GmbH (DPZ), Leibniz-Institute for Primate Research</institution>, Göttingen D-37077, <country>Germany</country></aff>
      <aff id="a3"><label>3</label><institution>Department of Clinical Neuroscience, Stockholm University</institution>, Box 1031, Solna SE-17121, <country>Sweden</country></aff>
      <aff id="a4"><label>4</label><institution>Science for Life Laboratory, Department of Biochemistry and Biophysics, Stockholm University</institution>, Box 1031, Solna SE-17121, <country>Sweden</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>Martin.Corcoran@ki.se</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email>Marcel.Martin@scilifelab.se</email>
      </corresp>
      <corresp id="c3">
        <label>c</label>
        <email>Gunilla.Karlsson.Hedestam@ki.se</email>
      </corresp>
      <fn id="n1">
        <label>*</label>
        <p>These authors contributed equally to this work</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>13642</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>04</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>10</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2016, The Author(s)</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>The Author(s)</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>Comprehensive knowledge of immunoglobulin genetics is required to advance our understanding of B cell biology. Validated immunoglobulin variable (V) gene databases are close to completion only for human and mouse. We present a novel computational approach, IgDiscover, that identifies germline V genes from expressed repertoires to a specificity of 100%. IgDiscover uses a cluster identification process to produce candidate sequences that, once filtered, results in individualized germline V gene databases. IgDiscover was tested in multiple species, validated by genomic cloning and cross library comparisons and produces comprehensive gene databases even where limited genomic sequence is available. IgDiscover analysis of the allelic content of the Indian and Chinese-origin rhesus macaques reveals high levels of immunoglobulin gene diversity in this species. Further, we describe a novel human IGHV3-21 allele and confirm significant gene differences between Balb/c and C57BL6 mouse strains, demonstrating the power of IgDiscover as a germline V gene discovery tool.</p>
    </abstract>
    <abstract abstract-type="web-summary">
      <p><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="i1" xlink:href="ncomms13642-i1.jpg"/>Current databases of V genes for antibody repertoire have limitations. Here Corcoran <italic>et al</italic>. develop a computational approach named IgDiscover that can identify germline V gene sequences from expressed antibody repertoires to high specificity and completeness.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>The adaptive immune response is dependent on the selection of mature B cells expressing antigen-specific antibodies from a diverse repertoire of naive B cells<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref>. In recent years, the advent of next-generation sequencing (NGS) technologies have provided new opportunities to examine expressed antibody repertoires in both human and model species, forging new insights into how B cells respond to, and are shaped by, external stimuli<xref ref-type="bibr" rid="b3">3</xref>. These analyses involve the comparison of expressed antibody sequences with reference databases of variable (V) germline segments to determine gene usage, expression frequency and degree of somatic hypermutation (SHM), among other genetic features. This requirement for accurate and complete immunoglobulin (Ig) gene reference databases<xref ref-type="bibr" rid="b4">4</xref>, however, severely curtails the widespread use of antibody repertoire analysis. Although partial V gene databases exist for many species, relatively complete germline Ig reference databases are currently available only for human and mouse<xref ref-type="bibr" rid="b5">5</xref> and even these may not be as comprehensive or correct as previously assumed. Importantly, knowledge of germline sequences in a given species is particularly necessary for applied approaches, for example, providing the ability to design amplification primers for high-throughput cloning of paired heavy and light chains to isolate antibodies of potential therapeutic value.</p>
  <p>Recent studies demonstrate that computational and screening approaches can identify novel, rare human and mouse V alleles<xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref>. However, a reliable procedure to construct a germline V gene database <italic>de novo</italic> remains elusive, in particular for species that lack relatively complete reference genomes. Here we describe a novel computational approach to define germline V sequences within NGS data to a level that enables individualized database construction. IgM antibody libraries contain a mixture of naive germline V sequences in addition to those subjected to SHM, with both groups exhibiting additional low-rate sequence variation introduced by PCR or sequencing errors. We demonstrate here that germline V gene sequences can be defined from this mixture by identifying clusters within groups of sequences assigned to a rough ‘initial' database. Consensus sequences, produced from these clusters, represent candidate germline sequences as shown using a computational screening procedure that retains germline sequences but removes false positives. We have automated these steps in one single application named IgDiscover. We validate this approach by (i) successfully re-discovering human VH alleles starting from an artificially reduced database, (ii) identifying the same sequences expressed in several individual animals and (iii) by direct cloning of newly identified sequences from non-rearranged genomic DNA. We further demonstrate that the approach can produce complete germline V gene databases for each individual tested. Finally, we show that germline V gene repertoires differ considerably between individual animals used for immunization studies, highlighting both the need to create accurate databases specific to each individual studied and demonstrating the utility of IgDiscover as a means to achieve this goal.</p>
  <sec disp-level="1">
    <title>Results</title>
    <sec disp-level="2">
      <title>V gene database assembly</title>
      <p>The availability of a complete database of V gene segments for a given species is the exception rather than the norm. Ig loci are repetitive and difficult to assemble. In only a few cases, such as humans and commonly used mouse strains, the loci are sequenced without gaps and the number of V genes is known<xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b9">9</xref>. Without a high-quality reference genome, gaps in the sequence typically result in an incomplete list of known V segments (<xref ref-type="fig" rid="f1">Fig. 1a</xref>).</p>
      <p>In addition, rare alleles exist in some individuals that are not present in the reference database. The total number of V alleles present within any given species is dependent on the genetic diversity of the population<xref ref-type="bibr" rid="b10">10</xref>. Currently, the number of sequences denoted as functional VH alleles present within the IMGT database, the most comprehensive resource of curated Ig sequences<xref ref-type="bibr" rid="b11">11</xref>, are 254 and 238 for human and mouse, respectively (August 2016) (<xref ref-type="fig" rid="f1">Fig. 1b</xref>). Even within these species, however, comprehensive analyses of diverse populations are lacking and the total number of V heavy and light germline alleles is likely to be higher<xref ref-type="bibr" rid="b12">12</xref>. To facilitate the identification of germline alleles, we sequenced libraries of IgM heavy chain V, diversity and junction (J) transcripts in multiple species and developed a versatile V gene discovery software, IgDiscover. Germline sequences identified by IgDiscover can be either genes or allelic variants. The program is designed to identify differences between expressed germline sequences rather than identifying whether an individual sequence is a gene or allele and we use these terms interchangeably.</p>
    </sec>
    <sec disp-level="2">
      <title>Discovery method overview</title>
      <p>The method consists of four critical steps: initial assignment to a starting database; clustering to identify candidate germline sequences; and application of a filter to retain only true germline sequences that are output as a new database that replaces the starting database. Finally, the previous three steps are repeated using the replaced database as the new assignment database. IgM libraries are utilized in order to minimize SHM levels and 5′ rapid amplification of cDNA ends (5′RACE) amplification used to amplify sequences from species with limited genomic information available. For other species, either 5′RACE or multiplex PCR can be used for library amplification. IgDiscover requires a starting database of either VH or V-kappa (VK) or V-Lambda (VL) genes that are used for primary assignment. The program updates the database incrementally over the course of multiple iterations to produce a final database of expressed germline V genes that are specific to the individual (<xref ref-type="supplementary-material" rid="S1">Supplementary Fig. 1</xref>). These steps are described in detail below.</p>
    </sec>
    <sec disp-level="2">
      <title>Identification of novel VH allele candidates</title>
      <p>At the beginning of each iteration, the V, diversity and J genes in the input sequences are localized and classified using IgBLAST<xref ref-type="bibr" rid="b13">13</xref>. A key observation is that any novel germline allele is assigned to the most similar database sequence. IgDiscover therefore inspects database alleles one by one in order to find clusters of novel sequences. When no novel sequences are present, that is, the database germline allele is identical to the expressed allele, the percentage differences appear Poisson-distributed (left histograms in <xref ref-type="fig" rid="f2">Fig. 2a</xref>). Novel germline genes appear in three different ways. First, for a single novel allele, if the closest database sequence is not expressed in that individual, the distribution of percentage differences is shifted to the right, and there are few or no exact matches (<xref ref-type="fig" rid="f2">Fig. 2a</xref>, right histogram). To cover this case, IgDiscover computes the candidate novel allele as a consensus of all sequences represented in the plot. The second case is that both the database allele and the novel germline allele are expressed and assigned to the same database gene. This results in a combined, bimodal distribution such as in <xref ref-type="fig" rid="f2">Fig. 2b</xref> (right histogram), where the left cluster corresponds to the known database germline allele and the right cluster to the candidate novel allele.</p>
      <p>In the third case, several novel germline alleles are assigned to the same database allele, but their peaks overlap in the histogram and can therefore not be resolved (<xref ref-type="fig" rid="f2">Fig. 2c,d</xref>). IgDiscover handles this case by also clustering sequences according to their similarity to each other. The sequences assigned to the database allele are clustered hierarchically using the UPGMA algorithm<xref ref-type="bibr" rid="b14">14</xref>. In the graphical representation of the result, <xref ref-type="fig" rid="f2">Fig. 2f</xref>, subclusters of similar sequences appear as light squares along the diagonal. They are detected by IgDiscover through a heuristic (see Methods), and consensus sequences computed from each subcluster are used as additional candidate novel VH alleles. We refer to this approach as linkage cluster analysis.</p>
    </sec>
    <sec disp-level="2">
      <title>Identifying ‘missing' germline V genes from a human database</title>
      <p>As a novel germline sequence will be recognized as different to the set of reference germline sequences in a given screening database, we surmised that it would be possible to model the expression of a novel allele by removing the sequence of known germline alleles from the screening database. This is illustrated by the re-identification, by IgDiscover, of single (<xref ref-type="fig" rid="f2">Fig. 2a,b</xref>) or multiple (<xref ref-type="fig" rid="f2">Fig. 2e,f</xref>) database-deleted alleles in a human IgM library we constructed using 5′RACE. Although a minority of alleles could be retrieved using the windowed clustering approach, the discovery of the most sequences required combining windowed and linkage cluster analysis. A single iteration of IgDiscover resulted in the re-identification of six of the seven expressed alleles that had been removed from the reference database (<xref ref-type="fig" rid="f2">Fig. 2f</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Germline filter</title>
      <p>Initial candidate germline V sequences may include false positives, in particular mutation hotspot artefacts and mutations arising from PCR bias. We employ a germline filter (<xref ref-type="fig" rid="f3">Fig. 3</xref>) after the last iteration to remove them.</p>
      <p>A pregermline filter is used in earlier iterations. It is less strict, which aids in splitting up highly complex initial assignments, for example, in the case of VH families that contain many family members, that is, the VH3 or VH4 families in primates or the VH1 family in mice. It also accelerates the identification of germline alleles from small clusters. The germline filters test features present only in germline genes, in particular whether the candidate sequence occurs in association with multiple HCDR3 sequences, thus demonstrating independent rearrangements (see Methods). The use of the germline filter therefore results in a final database of high specificity. In order to test this, we analysed a human IgM library with IgDiscover. In this case, the proportion of validated germline sequences reached 97% after germline filtering (<xref ref-type="fig" rid="f3">Fig. 3c</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>IgDiscover processes data in an iterative manner</title>
      <p>Following library production, sequencing, preprocessing and initial assignment to a starting database of V sequences (<xref ref-type="fig" rid="f4">Fig. 4a,b</xref>), IgDiscover identifies clusters using the windowed and linkage cluster techniques (<xref ref-type="fig" rid="f4">Fig. 4c</xref>)</p>
      <p>Consensus sequences that contain no ambiguous bases are screened using the pregermline filter and the set of candidate germline sequences that pass are used as a new V germline database. The process is repeated using this new V database as the next assignment database.</p>
      <p>The initial database is replaced by a new database of candidate germline V alleles identified from the cluster analysis and filtering process. These new database sequences, as they are based on common sequences expressed within the library, function to create a new set of assignments in the next iteration, that, in turn, lead to an accelerated identification of additional germline candidates. The precise sequence of the starting database is not critical; a database where each sequence has 10 random mutations introduced results in a similar output to a non-mutated database (<xref ref-type="fig" rid="f5">Fig. 5b</xref>). Initial assignment to the database sequences by IgBLAST requires some degree of sequence similarity. The starting database therefore must consist of V gene sequences; however, the species from which the database is constructed can be different to the library being analysed. Both human and mouse databases can function efficiently as starting databases for analysis of the rhesus library (<xref ref-type="fig" rid="f5">Fig. 5c,d</xref>).</p>
      <p>Because linkage cluster analysis is randomized (see Methods), it is important that repeated analyses of a single IgM library identify the same set of germline sequences. Analysis of Chinese-origin rhesus F132 on separate occasions consistently produced 70 germline sequences. IgDiscover is designed to identify a database of expressed germline sequences independent of the composition of the starting reference database content. This is reflected in the results of a series of tests comparing the final outputs of IgDiscover analysis of Chinese-origin rhesus F132. A final VH database of the same 60–70 alleles was produced when IgDiscover was run using a wide variety of starting databases using 3 iterations. These included: a validated set of 106 Indian-origin rhesus VH sequences; the same set of sequences that have each been randomly mutated by 10 nucleotides; starting databases consisting of only human VH sequences or only mouse VH sequences; and finally a starting database of just a single rhesus VH gene, exemplified here by using VH7.21 (<xref ref-type="fig" rid="f5">Fig. 5a–e</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Validation of identified germline sequences</title>
      <p>We applied IgDiscover to an IgM library from an Indian rhesus macaque no. 2635, using a ‘minimal' starting database, consisting of a single gene from each of the seven primate VH families. IgDiscover identified 53 germline alleles (<xref ref-type="fig" rid="f6">Fig. 6a</xref>).</p>
      <p>Two initial validation techniques were used to ensure that the sequences identified by IgDiscover were true germline alleles. The first method involved the identification of rhesus macaque genomic sequences or previously validated germline alleles, that shared 100% identity to the 53 germline sequences. In all, 35/53 (66%) were 100% identical to sequences present in the Indian rhesus reference genome (Mmul_8.01 reference assembly) and/or other previously published rhesus V alleles.</p>
      <p>The second technique utilized the approach described by previous groups and involved identifying the presence of the same sequence in more than one individual<xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b15">15</xref>. Of the 35 sequences that shared identity with germline sequences, 28 were present in at least one of the three additional monkeys analysed (rhesus nos 2514, 2636 and 5200), indicating that this approach could confirm germline alleles. Of the 18 novel alleles, 13 were present in one or more of the additional animals (<xref ref-type="fig" rid="f6">Fig. 6a</xref>). Examination of the frequency of the 35 previously published germline VH alleles and the 18 novel alleles in the expressed IgM repertoire of this animal revealed that many of the novel alleles were utilized to a similarly high frequency as the known alleles (<xref ref-type="fig" rid="f6">Fig. 6b</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Genomic cloning of unrearranged germline VH sequences</title>
      <p>In contrast to the relatively well-validated genomic information available for Indian-origin rhesus VH sequences, no validated VH database from Chinese-origin rhesus macaques has been published to date. We therefore sought to perform genomic validation on a representative set of sequences identified in Chinese-origin rhesus macaques by IgDiscover. We designed amplification primers encompassing previously validated Indian-origin rhesus V gene segments. Indian- and Chinese-origin rhesus macaques are highly similar at the genomic sequence level<xref ref-type="bibr" rid="b16">16</xref>. Genomic primers encompassing VH segments, based on Indian-origin rhesus genomic sequence, may therefore be expected to amplify the same VH segments from Chinese-origin rhesus genomic DNA. Over the course of evolutionary time, VH gene families both expand and contract owing to genomic duplication and deletional events<xref ref-type="bibr" rid="b10">10</xref>. Genomic PCR primers targeting known VH alleles may therefore additionally co-amplify related VH sequences that have arisen owing to gene duplication or the presence of copy number variants<xref ref-type="bibr" rid="b9">9</xref>.</p>
      <p>Following PCR amplification, we cloned 42 germline sequences that were identical to the corresponding sequences identified by the IgDiscover program from Chinese-origin rhesus no. F124 genomic DNA. Of these, 34 were novel alleles, including 3 novel VH2 family alleles (<xref ref-type="fig" rid="f7">Fig. 7a,b</xref>), and 8 were identical to previously published VH germline sequences from the Indian-origin database. Some primer sets that encompassed known VH genes amplified more than two germline sequences from rhesus no. F124. Primers (<xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>) encompassing VH.34, VH4.28, VH4.26 and VH3.15 amplified three germline sequences while VH4.11 amplified four (<xref ref-type="table" rid="t1">Table 1</xref>), indicating prior VH gene duplication and expansion.</p>
    </sec>
    <sec disp-level="2">
      <title>IgDiscover production of individualized databases</title>
      <p><italic>Human</italic>. Individualized germline databases of three human IgM libraries, H1, H2 and H3, were produced using IgDiscover. The numbers of alleles detected for each library were 58, 66 and 60, respectively (<xref ref-type="supplementary-material" rid="S1">Supplementary Data</xref>). All known functional VH genes were detected by IgDiscover with the exception of just two genes: IGHV3-NL1*01, a sequence isolated from an individual from the Papua New Guinea Highlands, and the sequence IGHV3-72*01. This latter sequence is possibly non-functional as there is a lack of antibody sequences with unmutated full-length IGHV3-72*01V segment in the NCBI nr database, and previous studies of multiple individuals has failed to detect expression<xref ref-type="bibr" rid="b17">17</xref>.</p>
      <p>Of the three human repertoires, most sequences (56/58 for H1, 64/66 for H2 and 56/60 for H3) were identical to known germline sequences from the current IMGT database (<xref ref-type="supplementary-material" rid="S1">Supplementary Fig. 2</xref>). Two novel sequences were found in all three personalized repertoires, one of which, termed IGHV3-21_DEL, a novel variant of the gene IGHV3-21, was validated by genomic cloning (<xref ref-type="fig" rid="f7">Fig. 7c</xref>).</p>
      <p><italic>Mouse.</italic> Three mouse IgM libraries were sequenced, two M1 and M2 from Balb/c strain mice and one M3, from C57BL6. In addition, an archived C57BL6 IgM library, produced by Ion Torrent sequencing and deposited to the public NCBI sequence read archive (SRA SRX1794884), was retrieved and analysed by IgDiscover. A total of 214 unique germline sequences were identified (<xref ref-type="supplementary-material" rid="S1">Supplementary Data</xref>, <xref ref-type="supplementary-material" rid="S1">Supplementary Fig. 3</xref>). The results indicate that the Balb/c mice were strikingly similar, sharing a total of 87 identical alleles between the two mice (M1=122 sequences, M2=105 sequences). In contrast, the two C57BL6 mice libraries contained 44 identical sequences (database size of 71 and 57 sequences for the M3 library and the Ion Torrent C57BL6 library, respectively) but shared just 10 identical sequences with the Balb/c mice.</p>
      <p><italic>Rhesus.</italic> IgDiscover analysis was performed on IgM libraries from five rhesus macaques of Chinese origin. The analysis utilized either a seven sequence ‘minimal' starting database that contains a single allelic sequence for each of the seven VH families (<xref ref-type="fig" rid="f8">Fig. 8a</xref>) or the public rhesus macaque VH database (<xref ref-type="fig" rid="f8">Fig. 8b</xref>). IgDiscover analysis of five Chinese-origin macaques produced a combined database of 240 unique germline VH sequences (<xref ref-type="fig" rid="f8">Fig. 8b</xref>), of which 30 were identical to VH alleles present in the Indian-origin rhesus database. The average number of VH alleles detected per monkey was 67. Although many of the alleles were present in more than one animal, all individuals analysed contained multiple alleles that were not shared by any of the other four animals (<xref ref-type="fig" rid="f8">Fig. 8c</xref>), demonstrating the high genetic diversity of this locus and the importance to properly determine the V gene germline composition in individual subjects before subsequent antibody sequence analysis.</p>
    </sec>
    <sec disp-level="2">
      <title>Light chain V gene discovery</title>
      <p>The principles of germline V gene discovery that are used to identify VH germline sequences, namely, initial assignment, cluster identification and application of the germline filter, were also applied to the discovery of germline VK and VL light chain sequences in three Chinese-origin rhesus macaques. The results (<xref ref-type="fig" rid="f8">Fig. 8d,e</xref>) reveal a high degree of diversity, with only a minority of VK alleles (30/127), and VL alleles (18/135), present in more than one of the three individual monkeys. As light chain sequences obtained by RACE PCR will consist of a mixture of both naive sequences and those that have undergone SHM in the germinal centres, we tested the ability of IgDiscover to identify germline sequences from a library consisting of a mixture of an IgM and an IgG library from a single rhesus individual. The results, in <xref ref-type="fig" rid="f5">Fig. 5g</xref>, show that when IgDiscover is applied to the mixed library, it identifies the majority of germline sequences (68/69) that are present in the IgM library, indicating that the IgDiscover clustering and filtering procedure enables identification of germline sequences even when the library to be analysed contains only a small proportion of germline sequences.</p>
    </sec>
    <sec disp-level="2">
      <title>5′ untranslated region (UTR) discovery for primer design</title>
      <p>As the IgDiscover protocol utilizes 5′RACE to achieve an unbiased amplification of V genes, it enables the identification of antibody messenger RNA upstream of the V gene segment. The IgDiscover program contains a script to extract this information in table form for each novel sequence identified (<xref ref-type="table" rid="t2">Table 2</xref>).</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Discussion</title>
    <p>The ability of IgDiscover to create individualized V gene databases <italic>de novo</italic> facilitates a new level of analysis in B cell research. It provides, primarily, a definitive reference for each subject analysed, a critical step for the identification of specific germline alleles utilized by individual antibodies and for determining their levels of SHM. Immunological diversity at the level of Ig alleles is now recognized as a factor of some importance<xref ref-type="bibr" rid="b12">12</xref>. Studies involving different ethnic groups have revealed novel human VH alleles<xref ref-type="bibr" rid="b15">15</xref><xref ref-type="bibr" rid="b18">18</xref> and comprehensive screening procedures may uncover many additional examples. Additionally, the availability of comprehensive Ig databases for laboratory animals commonly used in immunological research would enable antibody analysis to be extended to these species. However, while a technique to automate the identification of novel alleles has been developed<xref ref-type="bibr" rid="b6">6</xref>, it currently requires a relatively complete starting database and so is limited to species in which such a resource is available. In addition, it is sensitive to the issue of gene duplication and allelic copy number diversity, a factor that our genomic validation results indicate to be relevant (<xref ref-type="table" rid="t1">Table 1</xref>). IgDiscover was developed to overcome these limitations.</p>
    <p>Critically, IgDiscover analysis simplifies both inter- and intra-species comparison as shown here where we demonstrate a high degree of allelic diversity within Indian- and Chinese-origin macaques, two groups of non-human primates frequently used as models for human biology. The level of macaque Ig allelic diversity revealed is striking; however, it is consistent with a recent study by Collins <italic>et al</italic>.<xref ref-type="bibr" rid="b7">7</xref> comparing laboratory mouse strains Balb/c and C57BL/6 which showed that just five alleles were common to both strains.</p>
    <p>To ensure the accuracy of the individualized databases, considerable efforts have been applied to the validation of the novel alleles discovered during the development of this tool. Germline alleles uncovered by IgDiscover have been confirmed through identification in multiple individuals or the presence in the reference genomic assembly (<xref ref-type="fig" rid="f6">Fig. 6a,b</xref>) and finally through genomic cloning of unrearranged sequences (<xref ref-type="fig" rid="f7">Fig. 7a,b</xref>). The level of inter-individual diversity among both VH and VK/VL alleles identified suggests that previous estimations of VH repertoire usage and SHM levels utilizing earlier databases constructed from single animal reference genomes are likely to include errors. Tackling this issue in future studies could involve the use of more comprehensive germline databases than is currently available. Such resources could be constructed from the V gene sequences of large number of individuals in order to ensure that close to all alleles are included. This is especially important for species where the diversity is very high, as observed here for rhesus macaques. We can contribute to this endeavour with the 279 allele database of Chinese-origin VH sequences discovered in the current study (<xref ref-type="fig" rid="f8">Fig. 8b,c</xref>), in addition to increasing the rhesus VK and VL databases by 102 and 21 allelic sequences, respectively. Alternatively, a preferred approach would be to construct individualized databases for each subject (animal or human) analysed. Given the increased accessibility of NGS today, this is readily achievable using IgDiscover and requires the sequencing of a single IgM library and not more than a few hours of computing time for VH analysis and a similar timescale for VK and VL analysis.</p>
    <p>Importantly, IgDiscover requires minimal prior sequence information for efficient V gene discovery. The starting database sequences are not required to be identical to any germline present in the test case. We demonstrate here that by using starting databases consisting of Indian-origin rhesus germline alleles, deliberately mutated rhesus alleles or even databases of human or mouse alleles, IgDiscover constructs databases consisting of the exact same 75–79 alleles of rhesus germline VH sequences (<xref ref-type="fig" rid="f5">Fig. 5b–d</xref>). In an extreme test case, even a single VH sequence was shown to function efficiently as a starting ‘database' to identify the same set of germline alleles (<xref ref-type="fig" rid="f5">Fig. 5a</xref>). The program is therefore applicable to the construction of VH databases for species where little genomic sequence is currently available. Studies of B cell biology in non-human or mouse contexts are, to date, less common, in part owing to a lack of familiarity with the genetics of other model organisms<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b20">20</xref>. Extending antibody repertoire analysis to multiple new species, however, will expand the possibilities for immunological research of relevance for studies of human pathogens, such as those currently performed in voles (hantavirus)<xref ref-type="bibr" rid="b21">21</xref>, ferrets (influenza virus)<xref ref-type="bibr" rid="b22">22</xref> or different non-human primate species (Ebolavirus and many other infections)<xref ref-type="bibr" rid="b23">23</xref>. The use of IgDiscover in diverse species may also uncover species-specific evidence of past exposure to pathogens, aiding the elucidation of disease susceptibility and resistance.</p>
    <p>The ability to analyse antibody repertoires in additional species also introduces the possibility of isolating monoclonal antibodies of particular specificities produced in such animals. IgDiscover includes a capability to identity the 5′UTR and leader sequence upstream for each V allele identified (<xref ref-type="table" rid="t2">Table 2</xref>), therefore providing the means to design amplification primers for high-throughput antibody cloning techniques<xref ref-type="bibr" rid="b24">24</xref>. Furthermore, the upstream sequence information produced by IgDiscover has the potential to aid in the accurate assignment of antibodies, in particular those that have undergone significant levels of mutation in their V segments.</p>
    <p>The functionality of the IgBLAST module, used within IgDiscover for gene assignment, is not restricted to heavy and light chain V gene analysis, as T-cell receptor V genes can also be processed by IgBLAST<xref ref-type="bibr" rid="b13">13</xref>. In all cases, the approach taken in the current study: assignment to a starting database, cluster identification, and application of a germline filter, will be applicable, with only minor adjustments necessary of IgDiscover for it to become functional as a pan Ig and T-cell receptor germline discovery tool. Antibody repertoire analysis is increasingly seen as a vital research tool that facilitates precise examination of B cell biology for a broad range of questions<xref ref-type="bibr" rid="b25">25</xref>. Increasing numbers of computational tools are being developed to facilitate accurate and rapid analysis of NGS data<xref ref-type="bibr" rid="b26">26</xref><xref ref-type="bibr" rid="b27">27</xref>. With the ability to now produce individualized germline databases <italic>de novo</italic>, IgDiscover both augments current techniques and, importantly, finally enables the extension of antibody repertoire analysis to multiple additional species.</p>
  </sec>
  <sec disp-level="1">
    <title>Methods</title>
    <sec disp-level="2">
      <title>Animals and ethics statement</title>
      <p>Previously described rhesus macaques (<italic>Macaca mulatta</italic>) of Chinese origin<xref ref-type="bibr" rid="b28">28</xref> were sampled in the present study. The animals were housed at the AAALAC accredited Astrid Fagraeus Laboratory at Karolinska Institutet. Housing and care procedures were in compliance with the guidelines of the Swedish Board of Agriculture. The facility has been assigned an Animal Welfare Assurance number by the Office of Laboratory Animal Welfare at the National Institute of Health. The Local Ethical Committee on Animal Experiments (Stockholms Norra Djurförsöksetiska Nämnd) (ethical permit number N85/09 and N32/12) approved all procedures. Before inclusion in the study, all animals were tested and confirmed negative for simian immunodeficiency virus, simian T-cell lymphotropic virus, herpes simian B virus and simian retrovirus type D. Further samples were obtained from rhesus macaques (<italic>M. mulatta</italic>) of Indian origin kept at the Deutsches Primatenzentrum GmbH (DPZ), Leibniz-Institute for Primate Research in Goettingen under standard conditions complying with §§7–9 of the German Animal Welfare Act, which strictly adheres to the European Union guidelines (EU directive 2010/63/ EU) on the use of non-human primates for biomedical research. Experienced veterinarians and animal caretakers observed the monkeys constantly. Blood collection from the animals was approved by an external ethics committee of the Lower Saxony State Office for Consumer Protection and Food Safety with the project licence 33.9-42502-05-10A04 and performed under anesthesia with 10 mg ketamine per kg body weight. Animals were tested negative for antibodies against those mentioned above except for herpes B virus, which had not been analysed for. The human samples were donated following informed consent by healthy human blood donors and obtained from the Karolinska University Hospital blood bank and the mouse samples were obtained from C57BL/6J mouse and two Balb/c mice purchased from the Jackson laboratory and maintained in the animal research facility at the Department of Microbiology, Tumor and Cell Biology, Karolinska Institutet in accordance with the local Ethical Committee on Animal Experiments (Stockholms Norra djurförsöksetiska nämnd) approval.</p>
    </sec>
    <sec disp-level="2">
      <title>Cell isolation and RNA and genomic DNA extraction</title>
      <p>Peripheral blood lymphocytes from non-immunized animals and from the human sample (2–5 × 10<sup>6</sup> cells) were isolated by density-gradient centrifugation with Ficoll-Hypaque (GE Healthcare). Total RNA and genomic DNA were isolated using the RNeasy Kit (Qiagen) and QIAamp Mini DNA Kit (Qiagen), respectively.</p>
    </sec>
    <sec disp-level="2">
      <title>5′ rapid amplification of cDNA ends</title>
      <p>Total RNA (400 ng) was used in a 5′RACE cDNA synthesis reaction. The first-strand cDNA synthesis was performed at 42 °C for 60 min using an oligo dT primer and Superscript II reverse transcriptase (Thermofisher), followed by a template switching step using a 5′ template switch oligonucleotide RACE primer SM_RACE1 at 42 °C for another 60 min. In all, 10% of the resulting cDNA was amplified using the Kapa HiFi Hotstart ReadyMix system (Kapa Biosystems) with the primers F_Universal and IgM_RevRhesus, IgM_RevMouse or IgM_RevHuman, respectively. All primer sequences are provided in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>. The resultant bands of approximately 550 bp were gel purified using the Qiagen Gel Purification Kit, for subsequent NGS library production.</p>
    </sec>
    <sec disp-level="2">
      <title>NGS library production and sequencing</title>
      <p>A total of 200 ng of each gel-purified RACE-amplified IgM, IgK, IgL or IgG product was used in the production of an NGS ready library. Indexed adapters from the Trueseq Nano Kit (Illumina) were ligated to the RACE product, according to the manufacturer's instructions, and the resulting library was validated and quantified. The various individually indexed libraries were sequenced on the Illumina MiSeq using the Illumina Version 3, (2 × 300 bp) Sequencing Kit. A total of 15% PhiX174 DNA was included as a control and as a means of generating diversity within the MiSeq flow cell. IgM libraries from five Chinese- and four Indian-origin rhesus macaques, in addition to one human and one mouse, were used in this current analysis. In addition, three Chinese-origin rhesus macaque libraries were used to produce VK and VL libraries for light chain germline analysis. The merged library size for each as IgM Library/Merged sequences is as follows: Human IgM/173595, Rhesus F124 Chinese IgM/492935, Rhesus F130 Chinese IgM/510229, Rhesus F132 Chinese IgM/631232, Rhesus F133 Chinese IgM/379765, Rhesus F134 Chinese IgM/338373, Rhesus 2635 Indian IgM/611431, Rhesus 2636 Indian IgM/505578, Rhesus 2514 Indian IgM/679119, Rhesus 5200 Indian IgM/367104, Human H1/1142690, Human H2/1088767, and Human H3/1003720.</p>
    </sec>
    <sec disp-level="2">
      <title>Technical requirements</title>
      <p>Ig sequences obtained through NGS are subject to the technical limitations of the current methodologies, namely, sequence length and average sequence error rate. In our case, the Illumina MiSeq platform was chosen as it can produce sequence reads of 2 × 300 bases and is known to have one of the lowest error rates, approximately 1.2% (refs <xref ref-type="bibr" rid="b29">29</xref>, <xref ref-type="bibr" rid="b30">30</xref>), of current NGS sequencing technologies. Because IgDiscover works on the basis of identifying consensus sequences based on clusters assigned to an initial database, the process requires approximately 400,000 initial paired sequences in order to identify a full expressed germline repertoire from an individual. Libraries with lower numbers of sequences will result in specific VH germline detection; however, there may be insufficient numbers of individual sequences for all the VH alleles to pass the germline filter. In addition, as exact sequence identity is used as an integral part of the process, the process functions more effectively in sequence runs with lower sequencing error rates. IgDiscover works efficiently with IgM libraries. IgG libraries contain lower proportions of germline sequences and are not processed efficiently by the program.</p>
    </sec>
    <sec disp-level="2">
      <title>Targeted genomic sequencing</title>
      <p>Germline rhesus VH sequences from the database published in Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref> were screened against the Indian and Chinese rhesus genomic reference sequences (MGSC Merged1.0/rheM ac2 and BGI CR_1.0/rheMac3, respectively) and to an additional reference sequence (Mmul-8.0.1 reference assembly, Annotation Release 102) from an extended reference genomic sequence produced by Zimin <italic>et al</italic>.<xref ref-type="bibr" rid="b32">32</xref> from the same Indian-origin rhesus used to produce the MGSC Merged1.0 reference. This resulted in the identification of genomic segments that showed &gt;99% identity to the database germline sequences and allowed us to design PCR primers, shown in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>, to amplify genomic DNA that encompassed these VH genes. PCR amplification was performed using each set of primers. Primer sequences were arranged so that the primers were targeted to genomic sequence external to the VH exons in question in order to avoid amplification of rearranged DNA.</p>
    </sec>
    <sec disp-level="2">
      <title>Preprocessing</title>
      <p>IgDiscover first merges paired-end reads with PEAR<xref ref-type="bibr" rid="b33">33</xref> and optionally removes primer sequences with cutadapt<xref ref-type="bibr" rid="b34">34</xref>. Sequences of at least 300 bp are converted from FASTQ to FASTA and passed to VSEARCH's derep-fullength command to remove duplicates. The resulting sequences are used as input for all discovery iterations.</p>
    </sec>
    <sec disp-level="2">
      <title>Gene and CDR3 assignment</title>
      <p>IgBLAST is run on the preprocessed sequences at the beginning of each iteration with default algorithm parameters, except that a custom database is supplied. IgBLAST output is parsed and stored as a tab-separated value file for easier processing<xref ref-type="bibr" rid="b35">35</xref>. Following an idea by D'Angelo <italic>et al</italic>.<xref ref-type="bibr" rid="b36">36</xref>, CDR3 sequences of heavy and light chains are detected using a regular expression at the amino acid level.</p>
    </sec>
    <sec disp-level="2">
      <title>Quality filtering</title>
      <p>After gene assignment, only sequences passing a quality filter are kept: Both V and J genes must be assigned, no stop codon must occur and the <italic>E</italic>-value of the hit must be at most 10<sup>−3</sup>. In addition, we require that the detected VH gene region in the query sequence must cover at least 90% of the reference VH sequence, and the JH gene must be covered by at least 60% in the same way, which reduces the number of spurious hits.</p>
    </sec>
    <sec disp-level="2">
      <title>Linkage cluster analysis</title>
      <p>To reduce computation time, not all sequences assigned to a database reference allele are clustered with the UPGMA algorithm (average linkage) but only a random subsample of 1,000 sequences. If the starting database is very small, subsampling may lead to genes that are expressed at low levels not being detected as they represent a too small fraction of the subsample. With larger starting databases, concordance is typically very high. As distance function, we use Levenshtein distance (insertion, deletion and substitution operations count as one difference each). Hierarchical clustering results in a tree structure (shown as a dendrogram in the clusterplots, such as <xref ref-type="fig" rid="f3">Fig. 3f</xref>). To detect appropriate subclusters, a heuristic is used that finds those inner nodes of the tree having two subtrees that both have a size of at least five. If the ration between the smallest distance in one subtree (<italic>A</italic>) to the largest distance in the other subtree is &lt;0.8, subtree <italic>A</italic> is detected as a subcluster. This ensures that a subcluster is sufficiently dissimilar from its neighbouring sequences.</p>
    </sec>
    <sec disp-level="2">
      <title>Germline filter</title>
      <p>Candidate sequences are filtered according to the following criteria. The consensus sequences must contain neither ambiguous (‘N') bases nor stop codons and must have been computed from a cluster of at least 100 sequences. To test for independent rearrangements, all exact occurrences of the sequence in the full data set are inspected and must be associated with at least ten different CDR3 sequences and with at least three unique J genes. If two candidate sequences differ by up to two bases from each other, the one associated with the lowest number of unique HCDR3 is removed. When comparing sequences, small length differences at the 5′ and 3′ ends are not counted as errors, but the longer sequence is preferentially kept. Filtering criteria for the pregermline filter are identical except that it does not apply a minimum cluster size and only at least two unique HCDR3 sequences and at least two unique J genes are required. If a consensus sequence is encountered that is identical to one in the initial database, this is considered to be sufficient evidence and the filtering criteria are not applied. This ‘whitelisting' makes it possible to retain sequences occurring at low expression levels that would otherwise not pass filters.</p>
    </sec>
    <sec disp-level="2">
      <title>Upstream sequence detection</title>
      <p>For primer design, it is useful to know the sequence upstream of each VH allele. This consists of the 5′UTR and part of the leader sequence. IgDiscover can detect the upstream sequence. For each allele, it takes all the processed sequences assigned to that allele that also have a low error rate in the VH allele match. A consensus is then computed from all sequences that are at least as long as the tenth longest one and this is then output as the upstream sequence.</p>
    </sec>
    <sec disp-level="2">
      <title>Implementation</title>
      <p>IgDiscover consists of a set of command-line scripts written in Python and a workflow implemented in Snakemake<xref ref-type="bibr" rid="b37">37</xref> that automatically runs the scripts and other tools in the correct order and with the necessary parameters. SciPy (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link>) is used for its hierarchical clustering functionality, seaborn<xref ref-type="bibr" rid="b38">38</xref> and matplotlib<xref ref-type="bibr" rid="b39">39</xref> for plotting and pandas and numpy for working with tabular data. Cython<xref ref-type="bibr" rid="b40">40</xref> was used to speed up some algorithms.</p>
      <p>VSEARCH<xref ref-type="bibr" rid="b41">41</xref> was used as a quality filter. Consensus sequences are found by computing a multiple alignment with MUSCLE<xref ref-type="bibr" rid="b42">42</xref> and reporting the base at each position that occurs with a 60% majority. IgDiscover makes intermediate results available as text files and automatically creates plots such as those shown in <xref ref-type="fig" rid="f2">Figs 2</xref> and <xref ref-type="fig" rid="f4">4</xref>. Additional scripts are included that allow comparing and combining VH allele databases.</p>
    </sec>
    <sec disp-level="2">
      <title>Runtime</title>
      <p>IgDiscover running time depends, among other factors, on the number of reads that can be merged, the number of available CPU cores and the number of requested iterations. We measured runtime on a human data set with 1.4 million reads of good quality on an Intel Xeon E5-2660 with 16 cores. As the human database is already nearly complete, a single iteration is sufficient. In this best-case scenario, IgDiscover needs 95 min to discover a fully personalized V gene database. Preprocessing and the discovery process itself (including cluster analysis and consensus building) account for &lt;10% of this time, whereas the remaining &gt;90% are spent on running IgBLAST for obtaining gene assignments. In practice, IgDiscover runs three iterations by default to cover those cases where the input database is more distant to the analysed sample. It also executes IgBLAST one additional time so that a gene usage profile based on the final personalized database can be computed. Runtime in this case, assuming again a 16-core CPU, is ca. 5 h.</p>
    </sec>
    <sec disp-level="2">
      <title>Software availability</title>
      <p>IgDiscover is available as Open Source software under the MIT license from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://bitbucket.org/igdiscover/igdiscover">http://bitbucket.org/igdiscover/igdiscover</ext-link></p>
    </sec>
    <sec disp-level="2">
      <title>Data availability</title>
      <p>Sequencing data supporting the findings of this study have been deposited in the European Nucleotide Archive under accession PRJEB15295. Sequences identified in this study are available from Genbank database under the following accession numbers: KU592872 - KU592940 (Rhesus F124 Chinese IgM); KU592941 - KU593026 (Rhesus F130 Chinese IgM); KU593027 - KU593106 (Rhesus F132 Chinese IgM); KU593107 - KU593164 (Rhesus F133 Chinese IgM); KU593165 - KU593218 (Rhesus F134 Chinese IgM); KU593219 - KU593271, Rhesus 2635 Indian IgM; KX055207 - KX055255 (Rhesus F124 Chinese IgK); KX055256 - KX055311(Rhesus F130 Chinese IgK); KX055312 - KX055349 (Rhesus F132 Chinese IgK); KY199293 - KY199335 (Rhesus F124 Chinese IgL); KY199336 - KY199377 (Rhesus F130 Chinese IgL); KY199378 - KY199422 (Rhesus F132 Chinese IgL); KY198750 - KY198943 (Human VH sequences from H1, H2 and H3 libraries); KY198944 - KY199292 (Mouse VH sequences from M1, M2 and M3 libraries); KU593272 - KU593313 (Rhesus Genomic validation); KY110713 -KY110714 (Human Genomic validation).</p>
      <p>The authors declare that all other data supporting the findings of this study are available within the article and its <xref ref-type="supplementary-material" rid="S1">Supplementary Information</xref> files or from the corresponding authors upon request.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Additional information</title>
    <p><bold>How to cite this article:</bold> Corcoran, M. M. <italic>et al</italic>. Production of individualized V gene databases reveals high levels of immunoglobulin genetic diversity. <italic>Nat. Commun.</italic>
<bold>7</bold>, 13642 doi: 10.1038/ncomms13642 (2016).</p>
    <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d32e18" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Figures 1-3 and Supplementary Tables 1-2</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-s1.pdf"/>
    </supplementary-material>
    <supplementary-material id="d32e24" content-type="local-data">
      <caption>
        <title>Supplementary Data 1</title>
        <p>Human and Mouse individualized germlines</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-s2.xlsx"/>
    </supplementary-material>
    <supplementary-material id="d32e30" content-type="local-data">
      <caption>
        <title>Peer Review File</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-s3.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was funded by an NIH P01 grant AI104722 (HIVRAD) and a grant from the International AIDS Vaccine Initiative (IAVI) to G.K.H. G.E.P. is funded through a Karolinska Institutet KID grant, and M.M. is supported by a grant from the Knut and Alice Wallenberg Foundation to the Wallenberg Advanced Bioinformatics Infrastructure. We thank Rolf Ohlsson and Anita Göndör at the Department of Microbiology, Tumor and Cell Biology, Karolinska Institutet for generously allowing us to use their Illumina MiSeq instrument. We thank Paola Martinez for kind assistance with sample preparation and Pär Engström and Christopher Sundling for providing helpful comments on the manuscript.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Bashford-Rogers</surname><given-names>R. J.</given-names></name><etal/>. <article-title>Network properties derived from deep sequencing of human B cell receptor repertoires delineate B cell populations</article-title>. <source>Genome Res.</source><volume>23</volume>, <fpage>1874</fpage>–<lpage>1884</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23742949</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Greiff</surname><given-names>V.</given-names></name>, <name><surname>Miho</surname><given-names>E.</given-names></name>, <name><surname>Menzel</surname><given-names>U.</given-names></name> &amp; <name><surname>Reddy</surname><given-names>S. T.</given-names></name>
<article-title>Bioinformatic and statistical analysis of adaptive immune repertoires</article-title>. <source>Trends Immunol.</source>
<volume>36</volume>, <fpage>738</fpage>–<lpage>749</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26508293</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>W. H.</given-names></name><article-title>Sequencing the functional antibody repertoire--diagnostic and therapeutic discovery</article-title>. <source>Nat. Rev. Rheumatol.</source><volume>11</volume>, <fpage>171</fpage>–<lpage>182</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25536486</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Giudicelli</surname><given-names>V.</given-names></name>, <name><surname>Chaume</surname><given-names>D.</given-names></name> &amp; <name><surname>Lefranc</surname><given-names>M. P.</given-names></name>
<article-title>IMGT/GENE-DB: a comprehensive database for human and mouse immunoglobulin and T cell receptor genes</article-title>. <source>Nucleic Acids Res.</source>
<volume>33</volume>, <fpage>D256</fpage>–<lpage>D261</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15608191</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Aouinti</surname><given-names>S.</given-names></name>, <name><surname>Malouche</surname><given-names>D.</given-names></name>, <name><surname>Giudicelli</surname><given-names>V.</given-names></name>, <name><surname>Kossida</surname><given-names>S.</given-names></name> &amp; <name><surname>Lefranc</surname><given-names>M. P.</given-names></name>
<article-title>IMGT/HighV-QUEST statistical significance of IMGT clonotype (AA) diversity per gene for standardized comparisons of next generation sequencing immunoprofiles of immunoglobulins and T cell receptors</article-title>. <source>PLoS ONE</source>
<volume>10</volume>, <fpage>e0142353</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26540440</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Gadala-Maria</surname><given-names>D.</given-names></name>, <name><surname>Yaari</surname><given-names>G.</given-names></name>, <name><surname>Uduman</surname><given-names>M.</given-names></name> &amp; <name><surname>Kleinstein</surname><given-names>S. H.</given-names></name>
<article-title>Automated analysis of high-throughput B cell sequencing data reveals a high frequency of novel immunoglobulin V gene segment alleles</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>112</volume>, <fpage>E862</fpage>–<lpage>E870</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25675496</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Collins</surname><given-names>A. M.</given-names></name>, <name><surname>Wang</surname><given-names>Y.</given-names></name>, <name><surname>Roskin</surname><given-names>K. M.</given-names></name>, <name><surname>Marquis</surname><given-names>C. P.</given-names></name> &amp; <name><surname>Jackson</surname><given-names>K. J.</given-names></name>
<article-title>The mouse antibody heavy chain repertoire is germline-focused and highly variable between inbred strains</article-title>. <source>Philos. Trans. R. Soc. Lond. Ser. B Biol. Sci.</source>
<volume>370</volume>, http://dx.doi.org/10.1098/rstb.2014.0236 (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Watson</surname><given-names>C. T.</given-names></name> &amp; <name><surname>Breden</surname><given-names>F.</given-names></name>
<article-title>The immunoglobulin heavy chain locus: genetic variation, missing data, and implications for human disease</article-title>. <source>Genes Immun.</source>
<volume>13</volume>, <fpage>363</fpage>–<lpage>373</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22551722</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Watson</surname><given-names>C. T.</given-names></name><etal/>. <article-title>Complete haplotype sequence of the human immunoglobulin heavy-chain variable, diversity, and joining genes and characterization of allelic and copy-number variation</article-title>. <source>Am. J. Hum. Genet.</source><volume>92</volume>, <fpage>530</fpage>–<lpage>546</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23541343</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Das</surname><given-names>S.</given-names></name>, <name><surname>Nozawa</surname><given-names>M.</given-names></name>, <name><surname>Klein</surname><given-names>J.</given-names></name> &amp; <name><surname>Nei</surname><given-names>M.</given-names></name>
<article-title>Evolutionary dynamics of the immunoglobulin heavy chain variable region genes in vertebrates</article-title>. <source>Immunogenetics</source>
<volume>60</volume>, <fpage>47</fpage>–<lpage>55</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18196235</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Lefranc</surname><given-names>M. P.</given-names></name><etal/>. <article-title>IMGT(R), the international ImMunoGeneTics information system(R) 25 years on</article-title>. <source>Nucleic Acids Res.</source><volume>43</volume>, <fpage>D413</fpage>–<lpage>D422</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25378316</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Galson</surname><given-names>J. D.</given-names></name><etal/>. <article-title>In-depth assessment of within-individual and inter-individual variation in the B cell receptor repertoire</article-title>. <source>Front. Immunol.</source><volume>6</volume>, <fpage>531</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26528292</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>J.</given-names></name>, <name><surname>Ma</surname><given-names>N.</given-names></name>, <name><surname>Madden</surname><given-names>T. L.</given-names></name> &amp; <name><surname>Ostell</surname><given-names>J. M.</given-names></name>
<article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>. <source>Nucleic Acids Res.</source>
<volume>41</volume>, <fpage>W34</fpage>–<lpage>W40</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23671333</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Sokal</surname><given-names>R. a. M.</given-names></name><article-title>CD A statistical method for evaluating systematic relationships</article-title>. <source>Sci. Bull.</source><volume>38</volume>, <fpage>29</fpage> (<year>1958</year>).</mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Scheepers</surname><given-names>C.</given-names></name><etal/>. <article-title>Ability to develop broadly neutralizing HIV-1 antibodies is not restricted by the germline Ig gene repertoire</article-title>. <source>J. Immunol.</source><volume>194</volume>, <fpage>4371</fpage>–<lpage>4378</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25825450</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Yan</surname><given-names>G.</given-names></name><etal/>. <article-title>Genome sequencing and comparison of two nonhuman primate animal models, the cynomolgus and Chinese rhesus macaques</article-title>. <source>Nat. Biotechnol.</source><volume>29</volume>, <fpage>1019</fpage>–<lpage>1023</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">22002653</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Rubelt</surname><given-names>F.</given-names></name><etal/>. <article-title>Individual heritable differences result in unique cell lymphocyte receptor repertoires of naive and antigen-experienced cells</article-title>. <source>Nat. Commun.</source><volume>7</volume>, <fpage>11112</fpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27005435</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y.</given-names></name><etal/>. <article-title>Genomic screening by 454 pyrosequencing identifies a new human IGHV gene and sixteen other new IGHV allelic variants</article-title>. <source>Immunogenetics</source><volume>63</volume>, <fpage>259</fpage>–<lpage>265</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21249354</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Helmuth</surname><given-names>E. F.</given-names></name>, <name><surname>Letvin</surname><given-names>N. L.</given-names></name> &amp; <name><surname>Margolin</surname><given-names>D. H.</given-names></name>
<article-title>Germline repertoire of the immunoglobulin V(H)3 family in rhesus monkeys</article-title>. <source>Immunogenetics</source>
<volume>51</volume>, <fpage>519</fpage>–<lpage>527</lpage> (<year>2000</year>).<pub-id pub-id-type="pmid">10912503</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Bratsch</surname><given-names>S.</given-names></name>, <name><surname>Wertz</surname><given-names>N.</given-names></name>, <name><surname>Chaloner</surname><given-names>K.</given-names></name>, <name><surname>Kunz</surname><given-names>T. H.</given-names></name> &amp; <name><surname>Butler</surname><given-names>J. E.</given-names></name>
<article-title>The little brown bat, <italic>M. lucifugus</italic>, displays a highly diverse V H, D H and J H repertoire but little evidence of somatic hypermutation</article-title>. <source>Dev. Comp. Immunol.</source>
<volume>35</volume>, <fpage>421</fpage>–<lpage>430</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">20547175</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Dargeviciute</surname><given-names>A.</given-names></name><etal/>. <article-title>Yeast-expressed <italic>Puumala hantavirus</italic> nucleocapsid protein induces protection in a bank vole model</article-title>. <source>Vaccine</source><volume>20</volume>, <fpage>3523</fpage>–<lpage>3531</lpage> (<year>2002</year>).<pub-id pub-id-type="pmid">12297397</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>de Jonge</surname><given-names>J.</given-names></name><etal/>. <article-title>H7N9 live attenuated influenza vaccine is highly immunogenic, prevents virus replication and protects against severe bronchopneumonia in ferrets</article-title>. <source>Mol. Ther.</source><volume>24</volume>, <fpage>991</fpage>–<lpage>1002</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">26796670</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Geisbert</surname><given-names>T. W.</given-names></name>, <name><surname>Strong</surname><given-names>J. E.</given-names></name> &amp; <name><surname>Feldmann</surname><given-names>H.</given-names></name>
<article-title>Considerations in the use of nonhuman primate models of ebola virus and marburg virus infection</article-title>. <source>J. Infect. Dis.</source>
<volume>212</volume>, (Suppl 2): <fpage>S91</fpage>–<lpage>S97</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26063223</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>DeKosky</surname><given-names>B. J.</given-names></name><etal/>. <article-title>In-depth determination and analysis of the human paired heavy- and light-chain antibody repertoire</article-title>. <source>Nat. Med.</source><volume>21</volume>, <fpage>86</fpage>–<lpage>91</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25501908</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Georgiou</surname><given-names>G.</given-names></name><etal/>. <article-title>The promise and challenge of high-throughput sequencing of the antibody repertoire</article-title>. <source>Nat. Biotechnol.</source><volume>32</volume>, <fpage>158</fpage>–<lpage>168</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24441474</pub-id></mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>B.</given-names></name>, <name><surname>Meng</surname><given-names>W.</given-names></name>, <name><surname>Luning Prak</surname><given-names>E. T.</given-names></name> &amp; <name><surname>Hershberg</surname><given-names>U.</given-names></name>
<article-title>Discrimination of germline V genes at different sequencing lengths and mutational burdens: a new tool for identifying and evaluating the reliability of V gene assignment</article-title>. <source>J. Immunol. Methods</source>
<volume>427</volume>, <fpage>105</fpage>–<lpage>116</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26529062</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Menzel</surname><given-names>U.</given-names></name><etal/>. <article-title>Comprehensive evaluation and optimization of amplicon library preparation methods for high-throughput antibody sequencing</article-title>. <source>PLoS ONE</source><volume>9</volume>, <fpage>e96727</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24809667</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Phad</surname><given-names>G. E.</given-names></name><etal/>. <article-title>Diverse antibody genetic and recognition properties revealed following HIV-1 envelope glycoprotein immunization</article-title>. <source>J. Immunol.</source><volume>194</volume>, <fpage>5903</fpage>–<lpage>5914</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25964491</pub-id></mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Quail</surname><given-names>M. A.</given-names></name><etal/>. <article-title>A tale of three next generation sequencing platforms: comparison of Ion Torrent, Pacific Biosciences and Illumina MiSeq sequencers</article-title>. <source>BMC Genomics</source><volume>13</volume>, <fpage>341</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22827831</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>May</surname><given-names>A.</given-names></name><etal/>. <article-title>NGS-eval: NGS Error analysis and novel sequence VAriant detection tooL</article-title>. <source>Nucleic Acids Res.</source><volume>43</volume>, <fpage>W301</fpage>–<lpage>W305</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25878034</pub-id></mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>Sundling</surname><given-names>C.</given-names></name><etal/>. <article-title>High-resolution definition of vaccine-elicited B cell responses against the HIV primary receptor binding site</article-title>. <source>Sci. Transl. Med.</source><volume>4</volume>, <fpage>142ra196</fpage> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Zimin</surname><given-names>A. V.</given-names></name><etal/>. <article-title>A new rhesus macaque assembly and annotation for next-generation sequencing analyses</article-title>. <source>Biol. Direct</source><volume>9</volume>, <fpage>20</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25319552</pub-id></mixed-citation>
    </ref>
    <ref id="b33">
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>J.</given-names></name>, <name><surname>Kobert</surname><given-names>K.</given-names></name>, <name><surname>Flouri</surname><given-names>T.</given-names></name> &amp; <name><surname>Stamatakis</surname><given-names>A.</given-names></name>
<article-title>PEAR: a fast and accurate Illumina Paired-End reAd mergeR</article-title>. <source>Bioinformatics</source>
<volume>30</volume>, <fpage>614</fpage>–<lpage>620</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24142950</pub-id></mixed-citation>
    </ref>
    <ref id="b34">
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>M.</given-names></name><article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>. <source>EBMnet J.</source><volume>17</volume>, <fpage>3</fpage> (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="b35">
      <mixed-citation publication-type="journal"><name><surname>Shugay</surname><given-names>M.</given-names></name><etal/>. <article-title>VDJtools: unifying post-analysis of T cell receptor repertoires</article-title>. <source>PLoS Comput. Biol.</source><volume>11</volume>, doi:10.1371/journal.pcbi.1004503 (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b36">
      <mixed-citation publication-type="journal"><name><surname>D'Angelo</surname><given-names>S.</given-names></name><etal/>. <article-title>The antibody mining toolbox: an open source tool for the rapid analysis of antibody repertoires</article-title>. <source>mAbs</source><volume>6</volume>, <fpage>160</fpage>–<lpage>172</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24423623</pub-id></mixed-citation>
    </ref>
    <ref id="b37">
      <mixed-citation publication-type="journal"><name><surname>Koster</surname><given-names>J.</given-names></name> &amp; <name><surname>Rahmann</surname><given-names>S.</given-names></name>
<article-title>Snakemake--a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>
<volume>28</volume>, <fpage>2520</fpage>–<lpage>2522</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="b38">
      <mixed-citation publication-type="other"><name><surname>Waskom</surname><given-names>M.</given-names></name><etal/>. <article-title>seaborn: v0.5.0 Zenodo</article-title>. (https://doi.org/10.5281/zenodo.12710) (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b39">
      <mixed-citation publication-type="journal"><name><surname>Hunter</surname><given-names>J. D.</given-names></name><article-title>Matplotlib: a 2D graphics environment</article-title>. <source>Comput. Sci. Eng.</source><volume>9</volume>, <fpage>90</fpage>–<lpage>95</lpage> (<year>2007</year>).</mixed-citation>
    </ref>
    <ref id="b40">
      <mixed-citation publication-type="journal"><name><surname>Behnel</surname><given-names>S.</given-names></name><etal/>. <article-title>Cython: the best of both worlds</article-title>. <source>Comput. Sci. Eng.</source><volume>13</volume>, <fpage>31</fpage>–<lpage>39</lpage> (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="b41">
      <mixed-citation publication-type="journal"><name><surname>Rognes</surname><given-names>T.</given-names></name>, <name><surname>Nichols</surname><given-names>F. T.</given-names></name>, <name><surname>Quince</surname><given-names>B.</given-names></name> &amp; <name><surname>Mahé</surname><given-names>C.</given-names></name>
<article-title>F. VSEARCH: a versatile open source tool for metagenomics</article-title>. <source>PeerJ</source>
<volume>4</volume>, <fpage>e2409v1</fpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27635358</pub-id></mixed-citation>
    </ref>
    <ref id="b42">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res.</source><volume>32</volume>, <fpage>1792</fpage>–<lpage>1797</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="b43">
      <mixed-citation publication-type="journal"><name><surname>Francica</surname><given-names>J. R.</given-names></name><etal/>. <article-title>Analysis of immunoglobulin transcripts and hypermutation following SHIV(AD8) infection and protein-plus-adjuvant immunization</article-title>. <source>Nat. Commun.</source><volume>6</volume>, <fpage>6565</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25858157</pub-id></mixed-citation>
    </ref>
    <ref id="b44">
      <mixed-citation publication-type="journal"><name><surname>Bible</surname><given-names>J. M.</given-names></name>, <name><surname>Howard</surname><given-names>W.</given-names></name>, <name><surname>Robbins</surname><given-names>H.</given-names></name> &amp; <name><surname>Dunn-Walters</surname><given-names>D. K.</given-names></name>
<article-title>IGHV1, IGHV5 and IGHV7 subgroup genes in the rhesus macaque</article-title>. <source>Immunogenetics</source>
<volume>54</volume>, <fpage>867</fpage>–<lpage>873</lpage> (<year>2003</year>).<pub-id pub-id-type="pmid">12671738</pub-id></mixed-citation>
    </ref>
    <ref id="b45">
      <mixed-citation publication-type="journal"><name><surname>Andris</surname><given-names>J. S.</given-names></name><etal/>. <article-title>Variable region gene segment utilization in rhesus monkey hybridomas producing human red blood cell-specific antibodies: predominance of the VH4 family but not VH4-21 (V4-34)</article-title>. <source>Mol. Immunol.</source><volume>34</volume>, <fpage>237</fpage>–<lpage>253</lpage> (<year>1997</year>).<pub-id pub-id-type="pmid">9224966</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn>
      <p><bold>Author contributions</bold> M.M.C. and G.E.P. conceived the study, prepared the libraries, developed the algorithms, analysed the data and wrote the paper. M.M. conceived the study, developed the algorithms and wrote the code for the program, analysed the data and wrote the paper. N.S. assisted with the sequencing experiments. C.S.-H. provided some of the experimental animals used in the study. N.V.B. performed the genomic cloning. M.A.A.P. conceived the study. and G.B.K.H. conceived the study, analysed the data and wrote the paper.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>IgH genomic locus.</title>
      <p>(<bold>a</bold>) Issues affecting VH database construction based on genomic reference assemblies. The top locus map contains a fully sequenced and assembled IgH region such as found in the human and mouse reference assemblies. The centre map illustrates genome assemblies with insufficient coverage resulting in the absence of some VH genes in the reference genome. The lower map illustrates the presence of rare genes/alleles that are yet to be identified in genetically diverse species. (<bold>b</bold>) Number of VH genes and alleles in human and mouse that are denoted as functional according to the IMGT database and the available set of published rhesus VH genes (August 2016) compiled from published sources<xref ref-type="bibr" rid="b31">31</xref><xref ref-type="bibr" rid="b43">43</xref><xref ref-type="bibr" rid="b44">44</xref>. *Rhesus sequences may be either genes or alleles.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Identification of human VH alleles when the human reference database is rendered incomplete.</title>
      <p>Phylogenetic tree of relationship between (<bold>a</bold>) IGHV1-24*01 and IGHV1-f*01 or (<bold>b</bold>) the IGHV1-2 alleles and IGHV1-46*01, where the red arrow shows the deleted allele and the blue arrow shows the closest allele to which the sequences are now assigned. Frequency plot of sequences assigned to (<bold>a</bold>) IGHV1-24*01 (centre panel) or (<bold>b</bold>) IGHV1-2*02 (centre panel) when the reference database is complete. The right panels shows the new assignment when IGHV1-24*01 (<bold>a</bold>) or IGHV1-2 alleles (<bold>b</bold>) are deleted from the reference database. The pink text below the right panels indicate the identification of one consensus sequence from the 1–20% range, identical to IGHV1-24*01 (<bold>a</bold>) or two consensus sequences from 1–6% and 6–20%, showing 100% identity to IGHV1-46*01 and IGHV1-2*02, respectively (<bold>b</bold>). (<bold>c</bold>) Bar chart showing the assignment of IGHV1 human IgM sequences using the complete starting database (blue bars) or an incomplete database from which all IGHV1 alleles apart from IGHV1-3*01 have been removed (green bars). (<bold>d</bold>) Frequency plots of the seven IGHV1 alleles expressed in the human IgM library (blue histograms) and the resultant frequency plot after all IGHV1 alleles apart from IGHV1-3*01 have been removed (green histogram). (<bold>e</bold>) Frequency plot of sequences assigned to IGHV1-3*01 showing Windowed cluster analysis. The assigned sequences are binned in 2% intervals and from each a consensus sequence is built. The pink text beneath the panel reveals the identification of consensus sequences, from the 8–10% and the 10–12% windows, showing 100% identity to IGHV1-18*01 and IGHV1-2*02, respectively. (<bold>f</bold>) Matrix diagram showing Linkage cluster analysis of sequences assigned to IGHV1-3*01 following deletion of the other IGHV1 alleles from the VH screening database. Clusters of closely related sequences are visualized as lighter coloured squares within a darker blue background. The coloured bars on the left of the figure show the numbers of clusters identified in this analysis. The red text beneath the panel reveals that consensus sequences from the linkage clusters were identical to six of the seven IGHV1 sequences.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Germline filter.</title>
      <p>(<bold>a</bold>) Schematic of types of sequences present following clustering and consensus building. True germline sequences are found in antibody sequences that share an identical V region and are present in multiple unique rearrangements as shown by a high number of unique CDR3 segments. Non-germline sequences include those that have undergone SHM at activation-induced cytosine deaminase (AID) hotspots and, finally, those that are overrepresented owing to PCR bias issues. The application of the germline filter leaves only germline sequences remaining in the final output. (<bold>b</bold>) Illustration of clustal analysis of a section of candidate germline VH alleles from the H1 human IgM library before germline filtering. Each sequence was compared with the full IMGT human VH database and those identical to germline genes are indicated with a red arrow. The relative frequency of V usage, based on unique CDR3 content, is indicated by the number following the ‘R' of each sequence cluster (R1 being the highest frequency). (<bold>c</bold>) Results of the application of the pregermline and germline filters following a single iteration analysis of the H1 human IgM library. Candidate VH sequences (<italic>n</italic>=1152), were produced via consensus building using clusters identified by Windowed and Linkage cluster analysis (see Methods). To illustrate the effect of the germline filter sequences were screened against the current (August 2016) IMGT human VH database to identify the proportion showing 100% identity to validated IMGT germline sequences. This analysis was repeated with the resulting outputs of the pregermline and finally the germline filter.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>The IgDiscover iterative gene discovery process.</title>
      <p>(<bold>a</bold>) Following isolation of lymphocyte messenger RNA, an IgM library is constructed using either 5′RACE or multiplex PCR and sequenced using the Illumina MiSeq system. (<bold>b</bold>) Paired sequences are merged, and adapters are optionally removed. IgBLAST then assigns VH segments based on the starting database, and low-quality assignments are filtered (see Methods). (<bold>c</bold>) Windowed cluster analysis, (upper left panel), showing sequences assigned to a reference gene and binned in 2% windows to allow discrete consensus building. Linkage cluster analysis (upper right panel) of a subset of 300 sequences. Rows and columns of the matrix correspond to sequences. The colour at an intersection of a row and a column gives the number of differences between the corresponding sequences. The dendrograms (to the left and above, both identical) show the hierarchy found according to hierarchical clustering. Sequences are rearranged to conform to the clustering, putting similar sequences adjacent to each other. Clusters of similar sequences are visible as bright squares along the main diagonal. Colouring on the left indicates clusters detected by IgDiscover (one colour per cluster). Following consensus building, candidate germline sequences are processed using the pregermline filter, resulting in a new VH database. The assignment, clustering, consensus-building and pregermline filter steps are repeated for a set number of iterations using each new VH database for initial assignment. Examples of windowed cluster histograms (left two lower panels) and linkage cluster plots (right two lower panels) using databases containing newly identified candidate germline V genes. In the final iteration, the candidate V genes are processed using the germline filter to reveal the final database.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f4"/>
  </fig>
  <fig id="f5">
    <label>Figure 5</label>
    <caption>
      <title>Starting database effect on final output and iteration requirement.</title>
      <p>Venn diagrams comparing the number and identity of alleles output by IgDiscover when the following series of starting databases or conditions are utilized: (<bold>a</bold>) Public RM VH database constructed from previously published rhesus germline V sequences<xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b43">43</xref><xref ref-type="bibr" rid="b44">44</xref><xref ref-type="bibr" rid="b45">45</xref> versus ‘Single gene RM VH' database, a VH database containing a single sequence, (VH7.21). (<bold>b</bold>) Public RM VH database versus ‘Mutated Public RM VH database', a database created by randomly mutating 10 bases in every sequence within the Public RM VH database. (<bold>c</bold>) Public RM VH database versus the Human database, VH database created using 351 sequences from the IMGT collection of human VH sequences, none of which are identical to rhesus macaque VH sequences. (<bold>d</bold>) Public RM VH database versus the Mouse database, VH database created using 407 sequences from the IMGT collection of mouse VH sequences, none of which are identical to rhesus macaque VH sequences. (<bold>e</bold>) Public RM VH database versus duplicated analysis of Public RM VH database. (<bold>f</bold>) Public RM VH database using standard J gene settings versus the Public RM VH database when J gene identity is not part of the filtering criteria. (<bold>g</bold>) Comparison of germline VH alleles identified from F124 IgM library compared with germline VH alleles identified from a combined IgG–IgM library data set. (<bold>h</bold>) Illustration of the number of iterations to produce a final database from mouse (M1M, M2M, M3M), human (H1M) and rhesus (F132). Each dot indicates the size of the individualized database if the process had been stopped at that iteration and the germline filter applied.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f5"/>
  </fig>
  <fig id="f6">
    <label>Figure 6</label>
    <caption>
      <title>Analysis of novel VH sequences identified by IgDiscover in an Indian-origin rhesus macaque.</title>
      <p>(<bold>a</bold>) Phylogenetic tree of VH alleles (<italic>n</italic>=53) from rhesus macaque no. 2635, analysed using a minimal seven gene starting database (VH1.53, VH2.12, VH3.45, VH4.11, VH5.7, VH6.1 and VH7.21). The resulting germline sequences show 100% identity to rhesus genomic reference sequence or to previously published germline alleles (blue arrows, <italic>n</italic>=35), 100% identity to germline alleles present in additional Indian rhesus animals (orange arrows, <italic>n</italic>=13) or present only in rhesus macaque no. 2635 (green arrows, <italic>n</italic>=5). (<bold>b</bold>) Frequency of the usage of novel alleles. Panels showing the results of V sequence assignment of rhesus macaque no. 2635 using the database created by IgDiscover. The blue columns represent the number of sequences assigned to the database allele, while the red columns represent the numbers of unique CDR3s associated with that allele. The upper chart represents alleles that have 100% identity to rhesus genomic reference sequence or previously published germline alleles. The lower chart includes only those alleles that have not been published previously and are defined as novel rhesus germline alleles.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f6"/>
  </fig>
  <fig id="f7">
    <label>Figure 7</label>
    <caption>
      <title>Genomic validation of novel rhesus and human alleles.</title>
      <p>(<bold>a</bold>) Windowed cluster plots (upper left histograms) and Linkage cluster plots (lower left panels) of rhesus macaque F124 VH sequences assigned to starting database sequences VH2.12 and VH2.62, respectively. The upper left histograms and lower left linkage cluster plots show that starting database gene VH2.12 is not expressed in the F124 library. In contrast, VH2.62 is expressed, as indicated by the presence of 426 exact matches that use 16 unique CDR3s. Three novel VH2 family alleles found by IgDiscover, VH2.12_S0085, VH2.12_S3618 and VH2.62_S8940, are shown in the upper right histograms and lower right linkage cluster plots. (<bold>b</bold>) Position of primers used to amplify novel VH2 family alleles. The primers were designed to encompass the genomic sequence of previously validated VH2 family genes, VH2.12 and VH2.62 (primer sequences in Supplementary <xref ref-type="table" rid="t1">Table 1</xref>) resulting in identification of VH2.12_S0085, VH2.12_S3618 and VH2.62_S8940 in the genomic DNA. The right lower panel shows a phylogenetic tree indicating the relationship between the previously published VH2 family sequences and the four VH2 family alleles expressed in rhesus macaque F124. The three novel alleles and one previously known allele identified are indicated with pink arrows and black arrow, respectively. (<bold>c</bold>) Left panels illustrate the initial assignment of sequences from the H1 human library to VH3-21*01. The centre four panels demonstrate IgDiscover identification of two distinct sequences within the initial assigned group that are used in multiple independent V, diversity and J rearrangements. The right panels show the position of genomic primers used for genomic validation and the resulting identification of an unrearranged genomic sequence corresponding to a novel IGHV3-21 allele that differs from IGHV3-21*01 by exactly three nucleotides.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f7"/>
  </fig>
  <fig id="f8">
    <label>Figure 8</label>
    <caption>
      <title>Definition of individualized V gene germline repertoires in the Chinese-origin macaques by IgDiscover.</title>
      <p>(<bold>a</bold>) The left phylogenetic tree shows the relationship between the seven VH sequences that constitute the minimum VH database. The right phylogenetic tree illustrates IgDiscover identifying a repertoire of 70 VH alleles in rhesus F132 using a seven sequence minimal VH set as the starting database. The seven individual VH families are colour coded: VH1, pink; VH2, green; VH3, red; VH4, blue; VH5, purple; VH6, orange; and VH7, brown. (<bold>b</bold>) Total number of alleles and the number of novel VH alleles in each of the five Chinese-origin rhesus macaques analysed in addition to the V kappa and V lambda sequences from three of this group. (<bold>c</bold>) Venn diagram showing the comparison of VH allelic diversity within the group of five rhesus macaques. (<bold>d</bold>) Venn diagram showing the comparison of VK allelic diversity within the group of three rhesus macaques. (<bold>e</bold>) Venn diagram showing the comparison of VL allelic diversity within the group of three rhesus macaques.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-f8"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>Genomic validation of IgDiscover identified germline sequences.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="left"/>
        <col align="left"/>
        <col align="left"/>
        <col align="left"/>
        <col align="left"/>
        <col align="left"/>
        <col align="left"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">
            <bold>Genomic clone</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>Accession no.</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>VH allele</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>Accession no.</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>Allele status</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>Previous designation</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>PCR primer encompassing</bold>
          </th>
          <th align="left" valign="top" charoff="50">
            <bold>Database source</bold>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">14626254</td>
          <td align="left" valign="top" charoff="50">KU593272</td>
          <td align="left" valign="top" charoff="50">VH6_B*</td>
          <td align="left" valign="top" charoff="50">KU593026</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50">VH6.1</td>
          <td align="left" valign="top" charoff="50">VH6.1</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14626253</td>
          <td align="left" valign="top" charoff="50">KU593299</td>
          <td align="left" valign="top" charoff="50">VH6_A</td>
          <td align="left" valign="top" charoff="50">KU593104</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH6.1</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15485012</td>
          <td align="left" valign="top" charoff="50">KU593293</td>
          <td align="left" valign="top" charoff="50">VH4_1Q</td>
          <td align="left" valign="top" charoff="50">KU592908</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.57</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484988</td>
          <td align="left" valign="top" charoff="50">KU593292</td>
          <td align="left" valign="top" charoff="50">VH4_2T</td>
          <td align="left" valign="top" charoff="50">KU592919</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.57</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268538</td>
          <td align="left" valign="top" charoff="50">KU593305</td>
          <td align="left" valign="top" charoff="50">VH4_5K</td>
          <td align="left" valign="top" charoff="50">KU592932</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50">VH4.37</td>
          <td align="left" valign="top" charoff="50">VH4.37</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484883</td>
          <td align="left" valign="top" charoff="50">KU593297</td>
          <td align="left" valign="top" charoff="50">VH4_2O</td>
          <td align="left" valign="top" charoff="50">KU593314</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.34</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484976</td>
          <td align="left" valign="top" charoff="50">KU593295</td>
          <td align="left" valign="top" charoff="50">VH4_3A</td>
          <td align="left" valign="top" charoff="50">KU592922</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.34</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15485000</td>
          <td align="left" valign="top" charoff="50">KU593296</td>
          <td align="left" valign="top" charoff="50">VH4_5I</td>
          <td align="left" valign="top" charoff="50">KU593154</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.34</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484928</td>
          <td align="left" valign="top" charoff="50">KU593312</td>
          <td align="left" valign="top" charoff="50">VH4_2Q</td>
          <td align="left" valign="top" charoff="50">KU592917</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.28</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484880</td>
          <td align="left" valign="top" charoff="50">KU593310</td>
          <td align="left" valign="top" charoff="50">VH4_3C</td>
          <td align="left" valign="top" charoff="50">KU593020</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.28</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484904</td>
          <td align="left" valign="top" charoff="50">KU593311</td>
          <td align="left" valign="top" charoff="50">VH4_4K</td>
          <td align="left" valign="top" charoff="50">KU593088</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.28</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268571</td>
          <td align="left" valign="top" charoff="50">KU593306</td>
          <td align="left" valign="top" charoff="50">VH4_2L</td>
          <td align="left" valign="top" charoff="50">KU592916</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.26</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268574</td>
          <td align="left" valign="top" charoff="50">KU593307</td>
          <td align="left" valign="top" charoff="50">VH4_4I</td>
          <td align="left" valign="top" charoff="50">KU592929</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.26</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268577</td>
          <td align="left" valign="top" charoff="50">KU593308</td>
          <td align="left" valign="top" charoff="50">VH4_4Y</td>
          <td align="left" valign="top" charoff="50">KU593150</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.26</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268535</td>
          <td align="left" valign="top" charoff="50">KU593290</td>
          <td align="left" valign="top" charoff="50">VH4_1P</td>
          <td align="left" valign="top" charoff="50">KU592907</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.22</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268541</td>
          <td align="left" valign="top" charoff="50">KU593291</td>
          <td align="left" valign="top" charoff="50">VH4_2C</td>
          <td align="left" valign="top" charoff="50">KU592911</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.22</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15692045</td>
          <td align="left" valign="top" charoff="50">KU593313</td>
          <td align="left" valign="top" charoff="50">VH4_3G</td>
          <td align="left" valign="top" charoff="50">KU592926</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50">VH4.11</td>
          <td align="left" valign="top" charoff="50">VH4.11</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14831513</td>
          <td align="left" valign="top" charoff="50">KU593284</td>
          <td align="left" valign="top" charoff="50">VH4_1C</td>
          <td align="left" valign="top" charoff="50">KU592903</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.11</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768083</td>
          <td align="left" valign="top" charoff="50">KU593282</td>
          <td align="left" valign="top" charoff="50">VH4_2F</td>
          <td align="left" valign="top" charoff="50">KU592913</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.11</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768075</td>
          <td align="left" valign="top" charoff="50">KU593281</td>
          <td align="left" valign="top" charoff="50">VH4_2U</td>
          <td align="left" valign="top" charoff="50">KU592920</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH4.11</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484898</td>
          <td align="left" valign="top" charoff="50">KU593294</td>
          <td align="left" valign="top" charoff="50">VH3_2N</td>
          <td align="left" valign="top" charoff="50">KU592890</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.63</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768082</td>
          <td align="left" valign="top" charoff="50">KU593277</td>
          <td align="left" valign="top" charoff="50">VH3_2F</td>
          <td align="left" valign="top" charoff="50">KU592889</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.6</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768090</td>
          <td align="left" valign="top" charoff="50">KU593303</td>
          <td align="left" valign="top" charoff="50">VH3_3J</td>
          <td align="left" valign="top" charoff="50">KU592893</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.6</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14980506</td>
          <td align="left" valign="top" charoff="50">KU593285</td>
          <td align="left" valign="top" charoff="50">VH3_1C</td>
          <td align="left" valign="top" charoff="50">KU592882</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50">VH3.58</td>
          <td align="left" valign="top" charoff="50">VH3.58</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768105</td>
          <td align="left" valign="top" charoff="50">KU593276</td>
          <td align="left" valign="top" charoff="50">VH3_3U</td>
          <td align="left" valign="top" charoff="50">KU592894</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50">VH3.58</td>
          <td align="left" valign="top" charoff="50">VH3.5</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768097</td>
          <td align="left" valign="top" charoff="50">KU593275</td>
          <td align="left" valign="top" charoff="50">VH3_3O</td>
          <td align="left" valign="top" charoff="50">KU592979</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.5</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">16974832</td>
          <td align="left" valign="top" charoff="50">KU593300</td>
          <td align="left" valign="top" charoff="50">VH3_2R</td>
          <td align="left" valign="top" charoff="50">KU593121</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.44</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768109</td>
          <td align="left" valign="top" charoff="50">KU593279</td>
          <td align="left" valign="top" charoff="50">VH3_1W</td>
          <td align="left" valign="top" charoff="50">KU592885</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50">VH3.24</td>
          <td align="left" valign="top" charoff="50">VH3.24</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268547</td>
          <td align="left" valign="top" charoff="50">KU593289</td>
          <td align="left" valign="top" charoff="50">VH3_3Z</td>
          <td align="left" valign="top" charoff="50">KU592896</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.24</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768117</td>
          <td align="left" valign="top" charoff="50">KU593280</td>
          <td align="left" valign="top" charoff="50">VH3_3B</td>
          <td align="left" valign="top" charoff="50">KU592977</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.17</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14831517</td>
          <td align="left" valign="top" charoff="50">KU593283</td>
          <td align="left" valign="top" charoff="50">VH3_1G</td>
          <td align="left" valign="top" charoff="50">KU592904</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.15</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768100</td>
          <td align="left" valign="top" charoff="50">KU593278</td>
          <td align="left" valign="top" charoff="50">VH3_2X</td>
          <td align="left" valign="top" charoff="50">KU592892</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.15</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768116</td>
          <td align="left" valign="top" charoff="50">KU593304</td>
          <td align="left" valign="top" charoff="50">VH3_4E</td>
          <td align="left" valign="top" charoff="50">KU593315</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.15</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14980509</td>
          <td align="left" valign="top" charoff="50">KU593286</td>
          <td align="left" valign="top" charoff="50">VH3_4L</td>
          <td align="left" valign="top" charoff="50">KU593067</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.13</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268532</td>
          <td align="left" valign="top" charoff="50">KU593288</td>
          <td align="left" valign="top" charoff="50">VH3_1V</td>
          <td align="left" valign="top" charoff="50">KU592884</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH3.10</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768099</td>
          <td align="left" valign="top" charoff="50">KU593302</td>
          <td align="left" valign="top" charoff="50">VH2_1A</td>
          <td align="left" valign="top" charoff="50">KU592878</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH2.25</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15268559</td>
          <td align="left" valign="top" charoff="50">KU593287</td>
          <td align="left" valign="top" charoff="50">VH2_1M</td>
          <td align="left" valign="top" charoff="50">KU592879</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH2.12</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768115</td>
          <td align="left" valign="top" charoff="50">KU593274</td>
          <td align="left" valign="top" charoff="50">VH2_1S</td>
          <td align="left" valign="top" charoff="50">KU593176</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH2.12</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484937</td>
          <td align="left" valign="top" charoff="50">KU593309</td>
          <td align="left" valign="top" charoff="50">VH1_1S*</td>
          <td align="left" valign="top" charoff="50">KU592996</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH1.53</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">15484916</td>
          <td align="left" valign="top" charoff="50">KU593298</td>
          <td align="left" valign="top" charoff="50">VH1_2B</td>
          <td align="left" valign="top" charoff="50">KU592875</td>
          <td align="left" valign="top" charoff="50">Known</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH1.23</td>
          <td align="left" valign="top" charoff="50">Sundling <italic>et al</italic>.<xref ref-type="bibr" rid="b31">31</xref></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768093</td>
          <td align="left" valign="top" charoff="50">KU593301</td>
          <td align="left" valign="top" charoff="50">VH1_1L</td>
          <td align="left" valign="top" charoff="50">KU592947</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH1.16</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">14768085</td>
          <td align="left" valign="top" charoff="50">KU593273</td>
          <td align="left" valign="top" charoff="50">VH1_1V</td>
          <td align="left" valign="top" charoff="50">KU593032</td>
          <td align="left" valign="top" charoff="50">Novel</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">VH1.16</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>IgDiscover output of 5′UTR and Leader sequence from VH1 family alleles.</title>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms13642-t2"/>
    <table-wrap-foot>
      <fn id="t3-fn1">
        <p>*Reaction conditions:<bold>1</bold>/LiHMDS/<bold>2</bold>/[Pd(<italic>η</italic><sup>3</sup>-C<sub>3</sub>H<sub>5</sub>)Cl]<sub>2</sub>/S-IPr·HCl=200/200/100/2.5/5; 0.1 M of ketone <bold>1</bold>; T=30<sup>o</sup>C; B/L and <italic>dr</italic> was determined by <sup>1</sup>H NMR, <italic>dr</italic> is the ratio of (±)-(<italic>syn,anti</italic>)-<bold>3</bold>/other diastereoisomers; Isolated yield. †T=50 <sup>o</sup>C. ‡Solvent=THF. §OBoc of <bold>2</bold> was replaced with OP(OEt)<sub>2</sub>. ||The yield was determined by <sup>1</sup>H NMR.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
