<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4147915</article-id>
    <article-id pub-id-type="pmid">25161245</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu462</article-id>
    <article-id pub-id-type="publisher-id">btu462</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Eccb 2014 Proceedings Papers Committee</subject>
        <subj-group subj-group-type="heading">
          <subject>Original Papers</subject>
          <subj-group subj-group-type="heading">
            <subject>Evolution and Population Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mirarab</surname>
          <given-names>S.</given-names>
        </name>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reaz</surname>
          <given-names>R.</given-names>
        </name>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bayzid</surname>
          <given-names>Md. S.</given-names>
        </name>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zimmermann</surname>
          <given-names>T.</given-names>
        </name>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Swenson</surname>
          <given-names>M. S.</given-names>
        </name>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Warnow</surname>
          <given-names>T.</given-names>
        </name>
        <xref ref-type="aff" rid="btu462-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu462-COR1">*</xref>
      </contrib>
      <aff id="btu462-AFF1"><sup>1</sup>Department of Computer Science, The University of Texas at Austin, Austin, TX 78712, USA, <sup>2</sup>Departement d'informatique, Ecole Normale Superieure, 45 Rue d'Ulm, F-75230 Paris Cedex 05, France and <sup>3</sup>Department of Electrical Engineering, The University of Southern California, Los Angeles, CA 90089, USA </aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu462-COR1">*To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>17</issue>
    <fpage>i541</fpage>
    <lpage>i548</lpage>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Species trees provide insight into basic biology, including the mechanisms of evolution and how it modifies biomolecular function and structure, biodiversity and co-evolution between genes and species. Yet, gene trees often differ from species trees, creating challenges to species tree estimation. One of the most frequent causes for conflicting topologies between gene trees and species trees is incomplete lineage sorting (ILS), which is modelled by the multi-species coalescent. While many methods have been developed to estimate species trees from multiple genes, some which have statistical guarantees under the multi-species coalescent model, existing methods are too computationally intensive for use with genome-scale analyses or have been shown to have poor accuracy under some realistic conditions.</p>
      <p><bold>Results:</bold> We present ASTRAL, a fast method for estimating species trees from multiple genes. ASTRAL is statistically consistent, can run on datasets with thousands of genes and has outstanding accuracy—improving on MP-EST and the population tree from BUCKy, two statistically consistent leading coalescent-based methods. ASTRAL is often more accurate than concatenation using maximum likelihood, except when ILS levels are low or there are too few gene trees.</p>
      <p><bold>Availability and implementation:</bold> ASTRAL is available in open source form at <ext-link ext-link-type="uri" xlink:href="https://github.com/smirarab/ASTRAL/">https://github.com/smirarab/ASTRAL/</ext-link>. Datasets studied in this article are available at <ext-link ext-link-type="uri" xlink:href="http://www.cs.utexas.edu/users/phylo/datasets/astral">http://www.cs.utexas.edu/users/phylo/datasets/astral</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>warnow@illinois.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Species tree estimation is difficult in the presence of gene tree conflict, which can result from incomplete lineage sorting [ILS, modelled by the multi-species coalescent (<xref rid="btu462-B15" ref-type="bibr">Kingman, 1982</xref>)] as well as other causes. ILS is equivalent to ‘deep coalescence’, which occurs with high probability whenever the time between speciation events is short relative to the population size (<xref rid="btu462-B21" ref-type="bibr">Maddison, 1997</xref>). When ILS is present, gene trees can differ from each other and from the species tree, presenting substantial challenges to phylogeny estimation methods (<xref rid="btu462-B8" ref-type="bibr">Degnan and Rosenberg, 2009</xref>; <xref rid="btu462-B9" ref-type="bibr">Edwards, 2009</xref>). For example, the standard approach, concatenation (which concatenates the multiple sequence alignments for different genes together into one super-alignment, and then estimates a tree on the super-alignment) can return incorrect trees with high confidence (<xref rid="btu462-B17" ref-type="bibr">Kubatko and Degnan, 2007</xref>). Furthermore, under some conditions, even the most probable gene tree topology may not be identical to the species tree topology (<xref rid="btu462-B6" ref-type="bibr">Degnan, 2013</xref>; <xref rid="btu462-B7" ref-type="bibr">Degnan and Rosenberg, 2006</xref>, <xref rid="btu462-B8" ref-type="bibr">2009</xref>), a condition called ‘the anomaly zone’.</p>
    <p>However, there are no anomalous rooted three-taxon species trees (<xref rid="btu462-B8" ref-type="bibr">Degnan and Rosenberg, 2009</xref>) and no anomalous unrooted four-taxon species trees (<xref rid="btu462-B1" ref-type="bibr">Allman <italic>et al.</italic>, 2011</xref>; <xref rid="btu462-B6" ref-type="bibr">Degnan, 2013</xref>), a key fact that underlies the design of some summary methods and their proofs of statistical consistency. While several methods are established to be statistically consistent under the multi-species coalescent model, MP-EST (<xref rid="btu462-B20" ref-type="bibr">Liu <italic>et al.</italic>, 2010</xref>) and the population tree returned by BUCKy (<xref rid="btu462-B18" ref-type="bibr">Larget <italic>et al.</italic>, 2010</xref>) are among the leading methods. BUCKy-pop is more computationally intensive but can work with unrooted gene trees, while MP-EST requires rooted gene trees but easily scales to hundreds of gene trees and so has been used in many phylogenomic studies (<xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic>, 2012</xref>; <xref rid="btu462-B34" ref-type="bibr">Zhao <italic>et al.</italic>, 2013</xref>; <xref rid="btu462-B35" ref-type="bibr">Zhong <italic>et al.</italic>, 2013</xref>). Other statistically consistent species-tree estimation methods include BEST (<xref rid="btu462-B19" ref-type="bibr">Liu, 2008</xref>) and *BEAST (<xref rid="btu462-B11" ref-type="bibr">Heled and Drummond, 2010</xref>), which co-estimate gene trees and species trees from input sequence alignments; however, these methods are extremely computationally intensive on datasets with ≥100 genes (<xref rid="btu462-B2" ref-type="bibr">Bayzid and Warnow, 2013</xref>; <xref rid="btu462-B26" ref-type="bibr">Smith <italic>et al.</italic>, 2014</xref>), so that only summary methods are feasible for use on genome-scale datasets.</p>
    <p>However, even the best coalescent-based summary methods have not been reliably more accurate than concatenation (<xref rid="btu462-B2" ref-type="bibr">Bayzid and Warnow, 2013</xref>; <xref rid="btu462-B4" ref-type="bibr">DeGiorgio and Degnan, 2010</xref>), and performance on biological datasets has in some cases resulted in species trees that were less well resolved and biologically feasible than concatenation (<xref rid="btu462-B14" ref-type="bibr">Kimball <italic>et al.</italic>, 2013</xref>; <xref rid="btu462-B22" ref-type="bibr">McCormack <italic>et al.</italic>, 2013</xref>). Hence, the choice between coalescent-based estimation and concatenation is highly controversial (<xref rid="btu462-B28" ref-type="bibr">Springer and Gatesy, 2014</xref>).</p>
    <p>We present ASTRAL (Accurate Species TRee ALgorithm), a new coalescent-based species tree method. ASTRAL provides a statistically consistent estimation of the true species tree from unrooted gene trees, under the multi-species coalescent model. Furthermore, ASTRAL runs in polynomial time and can analyse genome-scale datasets in minutes.</p>
    <p>We evaluate ASTRAL in comparison with two statistically consistent methods (MP-EST and BUCKy-pop), two simple summary methods [MRP (<xref rid="btu462-B24" ref-type="bibr">Ronquist, 1996</xref>) and the greedy consensus] and concatenation under maximum likelihood (CA-ML) using RAxML (<xref rid="btu462-B29" ref-type="bibr">Stamatakis, 2006</xref>), on a collection of biological and simulated datasets. We explore genome-scale analyses, analysing datasets with hundreds to thousands of genes, which are too large for BUCKy-pop and *BEAST to analyse. ASTRAL is more accurate than the other summary methods under all the simulated model conditions we explore. As expected, the relative accuracy of ASTRAL and concatenation depends on the amount of ILS, with ASTRAL having an advantage when ILS levels are at least moderate, and concatenation having an advantage when ILS levels are low. Thus, ASTRAL enables highly accurate large-scale phylogenomic estimation, even in the presence of high levels of gene tree conflict because of ILS.</p>
  </sec>
  <sec id="SEC2">
    <title>2 APPROACH</title>
    <p>The input to ASTRAL is a set of unrooted gene trees; ASTRAL finds the species tree that agrees with the largest number of quartet trees induced by the set of gene trees.</p>
    <p>This optimization problem is NP-hard (<xref rid="btu462-B13" ref-type="bibr">Jiang <italic>et al.</italic>, 2001</xref>), and so ASTRAL has two versions: an exact version that is guaranteed to return the globally optimal tree, and a heuristic version that can be used on large datasets. For the heuristic version, ASTRAL constrains the search space to reduce the running time, by including a set <inline-formula><mml:math id="I1"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> of bipartitions (splits of the leaf set into two disjoint sets) as part of the input, and requiring that the output species tree <italic>T</italic> draw its bipartitions from <inline-formula><mml:math id="I2"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula>. Thus, for every edge <italic>e</italic> in <italic>T</italic>, the deletion of <italic>e</italic> splits the leaf set into two parts, and that bipartition must be in <inline-formula><mml:math id="I3"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula>. Finding a tree that has the optimum score but draws its bipartitions from the set <inline-formula><mml:math id="I4"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> can be solved in polynomial time (Theorem 1). Thus, ASTRAL can be used to find optimal trees for small enough numbers of species, or heuristically for larger numbers of species. We formalize this approach as the Maximum Quartet Support Species Tree (MQSST) problem:
<list list-type="bullet"><list-item><p>Input: set <inline-formula><mml:math id="I5"><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:math></inline-formula> of unrooted gene trees, each leaf-labelled by species set <italic>S</italic>, and set <inline-formula><mml:math id="I6"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> of bipartitions on <italic>S</italic>.</p></list-item><list-item><p>Output: tree <italic>T</italic> on species set <italic>S</italic> that draws its bipartitions from <inline-formula><mml:math id="I7"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> such that <inline-formula><inline-graphic xlink:href="btu462i1.jpg"/></inline-formula> is maximized, where <italic>Q</italic>(<italic>T</italic>) is the set of quartet trees induced by <italic>T</italic> and <inline-formula><mml:math id="I9"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script" class="calligraphy">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the number of the trees in <inline-formula><mml:math id="I10"><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:math></inline-formula> that induce quartet topology <italic>q</italic>.</p></list-item></list>
</p>
    <p>The default mode sets <inline-formula><mml:math id="I11"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> to be all bipartitions from the input set of unrooted gene trees; however, <inline-formula><mml:math id="I12"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> can be any set of bipartitions.</p>
    <p>We note that MQSST takes into account the relative frequency of all three alternative quartet topologies and weights them accordingly. Thus, if the dominant (i.e. most frequent) quartet topology is much more frequent than the alternatives, trees that do not induce the dominant topology are penalized, but if the three alternative quartet topologies all have frequencies close to 1/3, that quartet will contribute little to the optimization problem. This approach is in contrast to some other quartet-based methods such as BUCKy-pop that first try to find the dominant quartet topologies and then summarize them. Estimation of the dominant quartet tree is susceptible to error (because of insufficient gene sampling and estimation error), and the MQSST accounts for this.</p>
    <p>ASTRAL uses a dynamic programming (DP) approach to solve the MQSST optimization problem, so that it does not need to explicitly enumerate the set of all possible quartet trees. For a given unrooted binary tree <italic>T</italic> and four leaves <inline-formula><mml:math id="I13"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> in the tree, the induced subtree of <italic>T</italic> connecting the four leaves will have exactly two nodes <italic>u</italic> and <italic>v</italic> that have degree &gt;2. Thus, a quartet tree on <inline-formula><mml:math id="I14"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> induced by an unrooted binary tree is associated to the pair of nodes {<italic>u</italic>, <italic>v</italic>} defined in this way. Furthermore, given any node <italic>x</italic> of the tree, it is easy to count the number of quartets that are associated to pairs {<italic>x</italic>, <italic>y</italic>} (for some other node <italic>y</italic>), as we now show. Deleting <italic>x</italic> from the tree <italic>T</italic> separates it into three parts, <italic>A</italic>, <italic>B</italic> and <italic>C</italic>; this is called a ‘tripartition’ and is denoted <inline-formula><mml:math id="I15"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We pick one of these sets (say <italic>A</italic>), and pick two leaves from it, and then pick one leaf from each of the remaining sets. Therefore, if <italic>a</italic>, <italic>b</italic> and <italic>c</italic> give the sizes of <italic>A</italic>, <italic>B</italic> and <italic>C</italic>, respectively, then the number of quartets mapped to <italic>u</italic> is <inline-formula><mml:math id="I16"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>c</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. Therefore, we can associate the quartet tree on <inline-formula><mml:math id="I17"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> induced by <italic>T</italic> with two tripartitions—one associated with the internal node <italic>u</italic> and the other associated with the internal node <italic>v</italic>, where the quartet tree is associated with the pair {<italic>u</italic>, <italic>v</italic>}.</p>
    <p>Our algorithm uses a DP approach that is similar to the DP algorithm first introduced in <xref rid="btu462-B10" ref-type="bibr">Hallett and Lagergren (2000)</xref> for constructing species trees from sets of gene trees, minimizing the total number of duplications and losses, and subsequently used to construct species trees minimizing deep coalescence (<xref rid="btu462-B33" ref-type="bibr">Yu <italic>et al.</italic>, 2011</xref>). Instead of explicitly calculating quartet trees, we use the set <inline-formula><mml:math id="I18"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> to generate a set of tripartitions, and then for each tripartition, we calculate the number of quartet trees induced by the input set of gene trees that would be associated to that tripartition and therefore would be satisfied by any species tree that includes that tripartition. Thus, the species tree can be constructed by calculating a score for individual tripartitions based on a recursive formula that defines the DP.</p>
    <p>Recall that <inline-formula><mml:math id="I19"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> is a set of bipartitions that can be used in the output tree <italic>T</italic>; we define <inline-formula><mml:math id="I20"><mml:mrow><mml:msup><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to be the set of subsets of <italic>S</italic> that appear as parts of these bipartitions (i.e. <inline-formula><mml:math id="I21"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> if and only if the bipartition <inline-formula><mml:math id="I22"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:mrow></mml:math></inline-formula>). Then, the recursion in the DP finds a way of dividing each set <inline-formula><mml:math id="I23"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> into <inline-formula><mml:math id="I24"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I25"><mml:mrow><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (each of which must be in <inline-formula><mml:math id="I26"><mml:mrow><mml:msup><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) such that the number of quartets satisfied by an optimal rooted tree on <inline-formula><mml:math id="I27"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I28"><mml:mrow><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, in addition to those satisfied by the tripartition <inline-formula><mml:math id="I29"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, is maximized. Thus, the recursion is given by
<disp-formula><mml:math id="UM1"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo>⊂</mml:mo><mml:mi>A</mml:mi><mml:mo>;</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="I30"><mml:mrow><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> counts the number of gene tree quartets associated to tripartition <inline-formula><mml:math id="I31"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (which we call the weight of the tripartition). The function <italic>C</italic>(<italic>X</italic>) denotes the total contribution to the support of the best rooted tree <italic>T<sub>X</sub></italic> on taxon set <italic>X</italic>, where each quartet tree in the set of input gene trees contributes 0 if it conflicts with <italic>T<sub>X</sub></italic> or only intersects it with one leaf, and otherwise contributes 1 or 2, depending on the number of nodes in <italic>T<sub>X</sub></italic> it maps to. We set the boundary condition to be <inline-formula><mml:math id="I32"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>{</mml:mo><mml:mi>x</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. At the end of the algorithm, <italic>C</italic>(<italic>S</italic>) gives the final score, and backtracking gives the final tree. Because each quartet is associated to exactly two nodes, our described DP counts each quartet tree induced by gene trees exactly twice, and hence, the final score needs to be divided by two to get the quartet score.</p>
    <p>The weight of a tripartition is calculated by counting the number of quartet trees mapped to each node of each gene tree that is also mapped to that tripartition. For calculating this, we just need to find the intersection of clusters of the tripartition and all the tripartitions from all gene trees (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link>). For the special case of <italic>A</italic> = <italic>S</italic>, we set <inline-formula><mml:math id="I33"><mml:mrow><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.
<statement><title>T<sc>heorem</sc> 1</title><p><italic>ASTRAL finds an optimal solution to MQSST, and runs in </italic><inline-formula><mml:math id="I34"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic>time, where n is the number of species, x is the number of bipartitions in </italic><inline-formula><mml:math id="I35"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula><italic>and k is the number of gene trees. If </italic><inline-formula><mml:math id="I36"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula><italic>is the set of bipartitions from the input gene trees</italic><italic>, then </italic><inline-formula><mml:math id="I37"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic>, and so ASTRAL runs in </italic><inline-formula><mml:math id="I38"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:msup><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic>time.</italic></p></statement>
</p>
    <p>Because of space constraints, we provide the proof in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link>.
<statement><title>T<sc>heorem</sc> 2</title><p><italic>ASTRAL is a statistically consistent estimator of the species tree topology under the multi-species coalescent model, even when run in default mode</italic><italic>–so that </italic><inline-formula><mml:math id="I39"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula><italic>is the set of bipartitions from the input gene trees.</italic></p></statement>
<statement><title>Proof Sketch</title><p>Let <italic>T</italic>* be the species tree. Given a candidate species tree <italic>T</italic>, let <inline-formula><mml:math id="I41"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the number of trees in <inline-formula><mml:math id="I42"><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:math></inline-formula> that induce a topology identical to <italic>T</italic> for a quartet <italic>q</italic> of taxa. Unrooted quartet trees do not have anomaly zones (<xref rid="btu462-B6" ref-type="bibr">Degnan, 2013</xref>); therefore, given a large enough number of gene trees, each quartet topology induced by the species tree will have higher probability than either of the two alternative topologies, and hence appear with greater frequency in <inline-formula><mml:math id="I43"><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:math></inline-formula> with high probability. Therefore, for every quartet <italic>q</italic> and every possible tree <italic>T</italic>, <inline-formula><inline-graphic xlink:href="btu462i100.jpg"/></inline-formula> with high probability. By extension, if <inline-formula><mml:math id="I45"><mml:mi mathvariant="script" class="calligraphy">Q</mml:mi></mml:math></inline-formula> is the set of all quartets of taxa, the score <inline-formula><inline-graphic xlink:href="btu462i101.jpg"/></inline-formula> attains its (unique) maximum value when <inline-formula><mml:math id="I47"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> with high probability. <inline-formula><mml:math id="I48"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the score optimized in MQSST; hence, when ASTRAL is run exactly it solves MQSST and so is statistically consistent. The constrained default version of ASTRAL is also statistically consistent because when a large enough number of gene trees is given, then with high probability at least one of the gene trees will be topologically identical to the species tree, <inline-formula><mml:math id="I49"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, and so the set <inline-formula><mml:math id="I50"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> will contain all the bipartitions from <inline-formula><mml:math id="I51"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. When this occurs, ASTRAL run in its default mode will return <inline-formula><mml:math id="I52"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. (Note also that <inline-formula><mml:math id="I53"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> may contain all the bipartitions from <inline-formula><mml:math id="I54"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> even without having <inline-formula><mml:math id="I55"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> among its gene trees.)</p></statement>
</p>
    <p>Note that the MQSST optimization problem could be expressed as finding a <italic>median tree</italic>, where instead of finding a species tree that maximizes the total number of quartet trees that it satisfies, we would seek a species tree that has a minimum total distance to the input gene trees, where the distance is the number of quartet trees that it <italic>violates</italic>. Then, Theorem 2 asserts that the median tree (under this definition) is a statistically consistent estimator of the species tree, under the multi-species coalescent model.</p>
  </sec>
  <sec id="SEC3">
    <title>3 EXPERIMENTS</title>
    <sec>
      <title/>
      <sec sec-type="intro">
        <title>Overview</title>
        <p>We explore performance on a collection of biological and simulated datasets. We compare the estimated species trees to the model species tree (for the simulated datasets) or to the scientific literature (for the biological datasets), to evaluate accuracy. Tree error is measured using the Robinson–Foulds (RF) (<xref rid="btu462-B23" ref-type="bibr">Robinson and Foulds, 1981</xref>) rate; because all trees estimated here are completely bifurcating, this is the same as the missing branch rate (proportion of internal edges in the model tree missing in the estimated tree).</p>
      </sec>
      <sec id="SEC100-taxon">
        <title>100-taxon simulated datasets</title>
        <p>We briefly describe the process used to generate these data, and direct the reader to the original publication (<xref rid="btu462-B32" ref-type="bibr">Yang and Warnow, 2011</xref>) for details. The 100-taxon model species tree was created by a birth–death process, and 25 genes evolved within the species tree under the multi-species coalescent, producing ultrametric gene trees. Nucleotide sequences with 1000 sites were evolved down each gene tree under a process with GTRGAMMA substitutions as well as insertions and deletions, using ROSE (<xref rid="btu462-B30" ref-type="bibr">Stoye <italic>et al.</italic>, 1998</xref>). True alignments were used to generate estimated gene trees using RAxML.</p>
      </sec>
      <sec id="SEC37-taxon">
        <title>37-taxon ‘mammalian’ simulated datasets</title>
        <p>We simulated this collection of datasets based on a 37-taxon mammalian dataset with 447 genes studied in <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>. First, we used MP-EST to estimate a species tree on the biological dataset from <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>, and then used it as a model species tree, with branch lengths in coalescent units. We evolved gene trees down the model tree under the multi-species coalescent model using Dendropy (<xref rid="btu462-B31" ref-type="bibr">Sukumaran and Holder, 2010</xref>), and then rescaled the gene trees to deviate from the molecular clock and produce branch length patterns observed in the biological dataset. We then evolved sequences with 500 and 1000 sites down each gene tree under the GTR model of site evolution, using GTR parameters estimated on the biological dataset. This produces the ‘default’ model condition that has the amount of ILS estimated for this dataset by MP-EST. We varied this protocol by scaling the model species tree branch lengths up (2× and 5×) or down (0.2× and 0.5×) to modify the amount of ILS (so that longer branch lengths reduces ILS, and shorter branch lengths increases ILS). The default model tree conditions (including the number of genes, sequence length distribution and amount of ILS) were set to produce a dataset called the ‘mixed condition’ that most resembled the biological dataset.</p>
        <p>The average bootstrap support (BS) in the biological data was 71%, and so we generated sequence lengths that produced estimated gene trees with BS values bracketing that value—500 bp alignments produced estimated gene trees with 63% average BS and 1000 bp alignments produced estimated gene trees with 79% BS. The ‘mixed dataset’ of 400 genes was produced using 200 genes with 63% BS and 200 genes with 79% BS, and had average BS of 71%—like the biological data.</p>
        <p>For each model condition (specified by the ILS level, the number of genes and the sequence length), we created 20 replicates, except for the 1600- and 3200-gene model conditions where we created 10 and 5 replicates, respectively. We then used RAxML to produce estimated gene trees on the simulated sequence alignments, and we generated 200 ML bootstrap replicates for the mixed dataset.</p>
      </sec>
      <sec>
        <title>Biological datasets</title>
        <p>We analysed three biological datasets: the mammalian dataset from <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>, containing 37 species and 447 genes, the plant dataset from <xref rid="btu462-B35" ref-type="bibr">Zhong <italic>et al.</italic> (2013)</xref>, containing 32 species and 184 genes, and also the amniota dataset from <xref rid="btu462-B3" ref-type="bibr">Chiari <italic>et al.</italic> (2012)</xref>, containing 16 species and 248 genes.</p>
      </sec>
      <sec sec-type="methods">
        <title>Methods</title>
        <p>We compare ASTRAL with MP-EST, BUCKy-pop (the population tree from BUCKy), MRP (a supertree method), the Greedy Consensus and concatenated analysis using maximum likelihood (CA-ML), as computed by RAxML. For 100-taxon datasets and the mixed mammalian datasets, we ran summary methods using three different procedures: using maximum likelihood gene trees as input (bestML), using all bootstrap replicates of all genes as input (All BS) and using the site-only multi-locus bootstrapping (MLBS) procedure (<xref rid="btu462-B25" ref-type="bibr">Seo, 2008</xref>). For MLBS, we used the greedy consensus of 200 replicate species trees, each computed on an input consisting of one bootstrap replicate tree per gene. BUCKy-pop uses a distribution of gene trees as input, which we approximate using bootstrap gene trees; thus, BUCKy-pop can only be run with a procedure analogous to All BS. In subsequent analyses, where we study the impact of various model parameters, we only study the bestML approach. For the biological datasets, we used the multi-locus bootstrapping procedure (<xref rid="btu462-B25" ref-type="bibr">Seo, 2008</xref>) to obtain BS values.</p>
        <p>For the simulated datasets, we set X to be the set of bipartitions from the input set of trees. On the amniota dataset, as the number of taxa is small, we ran the exact version of ASTRAL. The mammalian biological dataset has a large number of genes that contain all the species, so we used the default setting for ASTRAL. However, the plant dataset has fewer genes and substantial missing data, and so we extended <inline-formula><mml:math id="I56"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> to include bipartitions from species trees estimated using MP-EST, CA-ML and MRP, as well as trees published by <xref rid="btu462-B3" ref-type="bibr">Chiari <italic>et al.</italic> (2012)</xref> (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link>) This <italic>ad hoc</italic> approach can improve ASTRAL’s ability to find near-optimal solutions, when the exact version is not feasible.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 RESULTS</title>
    <sec>
      <title/>
      <sec sec-type="results">
        <title>Results on mammalian simulated datasets</title>
        <p>The first experiment (<xref ref-type="fig" rid="btu462-F1">Fig. 1</xref>) shows results on the mixed mammalian dataset, which most closely resembles the biological dataset studied in <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>. We compare ASTRAL, MP-EST, Greedy, MRP, BUCKy-pop and CA-ML and three types of inputs to summary methods. For MRP, MP-EST and ASTRAL, using bestML input trees produced more accurate species trees than using bootstrap replicates, either as one input (All BS) or using MLBS. The purpose of using bootstrap replicates is to take gene tree uncertainty (resulting from insufficient sequence length, for example) into account, but these results indicate that for this model condition, these two simple approaches do not improve species tree estimation. However, it is possible that other model conditions [perhaps smaller numbers of genes, as studied in <xref rid="btu462-B16" ref-type="bibr">Knowles <italic>et al.</italic> (2012)</xref>] or other ways of addressing gene tree uncertainty might show some advantage over the BestML approach. Therefore, we use bestML input trees in the remaining experiments.
<fig id="btu462-F1" position="float"><label>Fig. 1.</label><caption><p>Species tree estimation error on the default mammalian datasets with 37 genes and 400 genes (half with 500 bp and half with 1000 bp and with 71% mean BS). We show the missing branch rates for estimated species trees computed using summary methods (MRP, MP-EST, greedy, BUCKy-pop and ASTRAL) as well as concatenation using RAxML. Results are shown for running summary methods on maximum likelihood gene trees (bestML) and on the set of all bootstrap replicates from all genes (All BS), as well as the greedy consensus of running summary methods on individual bootstrap replicates from all genes (MLBS). CA-ML is run on the true alignment. Average and standard error shown based on 20 replicates</p></caption><graphic xlink:href="btu462f1p"/></fig></p>
        <p>For the mixed model condition and using bestML trees, ASTRAL is the most accurate of these methods, MP-EST the next most accurate, followed by the other summary methods, and finally by CA-ML. ASTRAL with any of the three sets of inputs is also more accurate than BUCKy-pop; however, differences between ASTRAL on All BS and BUCKy-pop are relatively small.</p>
        <p>The next experiment explored variants of the basic mammalian simulation, exploring the impact of changes to the ILS level (by scaling the species tree branch lengths), number of genes and gene sequence length, on the absolute and relative performance of various methods using bestML input. ASTRAL was generally more accurate than all the other summary methods (<xref ref-type="fig" rid="btu462-F2">Fig. 2</xref>). However, for a few cases, ASTRAL and one or more summary methods had similar accuracy; for example, on 800 true gene trees from default ILS levels, all summary methods (except for Greedy) produced the true species tree. Furthermore, ASTRAL was more accurate than CA-ML, except when the amount of ILS is low. The relative performance between ASTRAL and CA-ML depended on the amount of ILS, so that CA-ML was more accurate than ASTRAL under low levels of ILS, and otherwise ASTRAL was more accurate than CA-ML.
<fig id="btu462-F2" position="float"><label>Fig. 2.</label><caption><p>Species tree estimation error on the simulated mammalian datasets. We show the missing branch rates for estimated species trees computed using summary methods (MRP, MP-EST, greedy and ASTRAL) as well as CA-ML. Summary methods are run on RAxML bestML gene trees. We also show performance of summary methods on the true gene trees. Subfigure (<bold>A</bold>) shows results under default levels of ILS, varying the number of genes and gene tree resolution; (<bold>B</bold>) shows results under increased ILS levels, varying the number of genes, and on both true gene trees and estimated gene trees and (<bold>C</bold>) shows results on 200 genes, varying the amount of ILS from very low (5× species tree branch lengths) to very high (0.2× species tree branch lengths)</p></caption><graphic xlink:href="btu462f2p"/></fig></p>
        <p>Some observed trends were expected: all summary methods gave improved accuracy as the sequence length in each gene increased from 500 to 1000 bp; using true gene trees gave the best results (<xref ref-type="fig" rid="btu462-F2">Fig. 2</xref>a); species tree error rates generally reduced as the number of genes increased (<xref ref-type="fig" rid="btu462-F2">Fig. 2</xref>b); and species tree error rates increased as ILS levels increased (<xref ref-type="fig" rid="btu462-F2">Fig. 2</xref>c).</p>
        <p>However, some other observed trends were surprising. For example, unlike the other methods, Greedy did not continue to improve with increased numbers of gene trees, but could be more accurate than many other summary methods (including MP-EST but not ASTRAL) when the number of gene trees and gene sequence lengths were both small (<xref ref-type="fig" rid="btu462-F2">Fig. 2</xref>a). In addition, we observed that MRP, a simple supertree method that is not known to be statistically consistent, was in some cases more accurate than MP-EST. For example, while MP-EST was always at least as accurate as MRP on true gene trees or on estimated gene trees with high ILS, there were cases (<xref ref-type="fig" rid="btu462-F2">Fig. 2</xref>a and c) where MRP was more accurate than MP-EST (although the differences are small).</p>
      </sec>
      <sec sec-type="results">
        <title>Analyses with large numbers of species</title>
        <p>We evaluated the feasibility of using ASTRAL on datasets with large numbers of taxa using the 100-taxon simulated datasets, with 25 genes and 10 replicates. Because there is no single outgroup, the estimated trees are not rooted, and so we could not use MP-EST. ASTRAL had no difficulty analysing these data (completing in &lt;1 s). ASTRAL had average missing branch rate of 6.1%, better than MRP and Greedy (6.4%), but not as good as CA-ML (5.7%); differences are not statistically significant (<italic>P</italic> &gt; 0.1; paired Wilcoxon test).</p>
      </sec>
    </sec>
    <sec sec-type="results">
      <title>Results on biological datasets</title>
      <p><xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref> analysed a dataset with 447 genes across 37 mammalian species using MP-EST. Two of the questions of greatest interest were the placement of bats (Chiroptera) and tree shrew (Scandentia), where their MP-EST analysis differed from the concatenated analyses they performed.</p>
      <p>In our analysis of this dataset, we noted the distance of estimated gene trees to other gene trees; this produced a distribution with two clear outliers (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link>). We also identified 21 genes with mislabelled sequences [easily confused taxon names, subsequently confirmed by the authors of <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>]. We removed all 23 outliers from the dataset, and reanalysed the reduced dataset.</p>
      <p>We used a multi-locus bootstrapping procedure with 100 replicates, with both site and gene resampling, to be consistent with <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>. We re-estimated the gene trees using RAxML on the gene sequence alignments produced by <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>. We recomputed the MP-EST tree, obtaining a tree topologically identical to the MP-EST tree reported in <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref>, but with lower bootstrap for the placement of Scandentia (62% in our analysis). CA-ML analyses of the full and reduced datasets were topologically identical and had similar branch support. Thus, the CA-ML and MP-EST trees on the reduced dataset still differed in the placement of both Scandentia and Chiroptera.</p>
      <p>We compare ASTRAL to MP-EST in <xref ref-type="fig" rid="btu462-F3">Figure 3</xref>. Both ASTRAL and MP-EST trees placed Chiroptera as the sister to all other Laurasiatheria except Eulipotyphyla, whereas CA-ML placed Chiroptera as the sister to Cetartiodactyla. The ASTRAL tree placed Scandentia as sister to Glires with 74% support and thus agrees with the CA-ML tree but differs from the MP-EST tree.
<fig id="btu462-F3" position="float"><label>Fig. 3.</label><caption><p>Analysis of the Song <italic>et al.</italic> mammals dataset using ASTRAL and MP-EST. We show the result of applying ASTRAL and MP-EST to 424 gene trees on 37-taxon mammalian species. MP-EST is based on rooted gene trees; ASTRAL is based on unrooted gene trees, and then rooted at the branch leading to the outgroup. Branch support values in black are for both methods, those in red are for ASTRAL and values in blue are for MP-EST. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link> for trees with full resolution</p></caption><graphic xlink:href="btu462f3p"/></fig></p>
      <sec>
        <title>Plant dataset</title>
        <p>We analysed a plant dataset from <xref rid="btu462-B35" ref-type="bibr">Zhong <italic>et al.</italic> (2013)</xref> of 32 species and 184 genes using ASTRAL, adding bipartitions to <inline-formula><mml:math id="I57"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link>). The question of greatest interest is the sister group to land plants. Previous analyses have inferred many different possible sister clades, including the following four major hypotheses: Zygnematales, Coleochaetales, Zygnematales + Coleochaetales and Charales. <xref rid="btu462-B35" ref-type="bibr">Zhong <italic>et al.</italic> (2013)</xref> used MP-EST to analyse their data and inferred Zygnematales as the sister with 64% BS. A reanalysis of the same data using STAR was performed by <xref rid="btu462-B28" ref-type="bibr">Springer and Gatesy (2014)</xref>, who obtained Zygnematales + Coleochaetales with 44% BS.</p>
        <p>We analysed this dataset using ASTRAL and obtained a tree that generally has high BS on the branches (i.e. with the exception of four branches, all branches have support at least 86%, and most have 100% support). However, one edge had low support (only 18%). After collapsing the single branch with low support, we obtained a tree (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link>) in which the Charales + land plants hypothesis is rejected with moderately high support (86%); however, it is not determined whether Zygnematales, Coleochaetales or Zygnematales + Coleochaetales are the sister group to land plants (the branch that distinguishes between these three hypotheses is the one with 18% support). Thus, ASTRAL’s analysis of this dataset can be seen as suggesting that this dataset is insufficient to completely resolve the sister relationship to land plants. However, the most interesting question is whether Charales are sister to land plants, and the ASTRAL tree rejects that hypothesis with 86% support.</p>
      </sec>
      <sec>
        <title>Amniota dataset</title>
        <p><xref rid="btu462-B3" ref-type="bibr">Chiari <italic>et al.</italic> (2012)</xref> assembled a dataset of Amniota to resolve the position of turtles relative to birds and crocodiles. Most recent studies favour an Archosaurus hypotheses that unites birds and crocodiles as sister groups (<xref rid="btu462-B12" ref-type="bibr">Hugall <italic>et al.</italic>, 2007</xref>). The MP-EST analyses by <xref rid="btu462-B3" ref-type="bibr">Chiari <italic>et al.</italic> (2012)</xref> resolved this relationship differently when AA and DNA gene trees were used; thus, AA had 99% support for the Archosaurus clade, but DNA rejected Archosaurus with 90% support. We analysed the same dataset using the exact version of ASTRAL and found that both AA and DNA recover Archosaurus; however, while ASTRAL on AA gene trees recovered Archosaurus with 100% support, ASTRAL on DNA gene trees had only 55% support for Archosaurus.</p>
      </sec>
      <sec>
        <title>Running time</title>
        <p>Comparisons between coalescent-based methods reveal substantial differences in running time. For example, on the mammalian dataset from <xref rid="btu462-B27" ref-type="bibr">Song <italic>et al.</italic> (2012)</xref> with 37 taxa and 421 genes, MP-EST (run with 10 random starting points) used 83 min per bootstrap replicate, while ASTRAL used 7 s. Analyses of the simulated mammalian datasets allow us to explore the limits of BUCKy-pop, as well as obtain other comparisons. We examine running times under moderate ILS, gene sequences of length 500 bp, and with 400 and 800 genes and with bestML input trees (except for BUCKy-pop).</p>
        <p>BUCKy-pop strictly runs in serial, using a Bayesian Markov Chain Monte Carlo (MCMC) technique, which can take a long time and substantial memory to reach convergence. On the 37-taxon mammalian simulated datasets, BUCKy-pop ran to completion for datasets with up to 400 genes (where it took ∼5 h), but failed to complete (due to memory issues) on the 800-gene dataset.</p>
        <p>MP-EST completed relatively quickly—∼100 min—for both the 400-gene and 800-gene datasets. We ran MP-EST with 10 random starting points, so this time could be reduced by using just one starting point, but with a potential decrease in accuracy.</p>
        <p>ASTRAL completed in 3.3 s on the 400-gene dataset and in 5.3 s on the 800-gene dataset. Thus, ASTRAL is dramatically faster than the other methods and able to run on these phylogenomic datasets in reasonable time frames. However, BUCKy is used with 200 bootstrapped gene trees for each gene and outputs support values. Running ASTRAL and MP-EST using MLBS to obtain support values would increase their running times if run in serial, but ASTRAL would still be much faster than BUCKy (e.g. 11 min on the 400-gene dataset rather than 5 h). In addition, parallelizing MLBS is trivial because each bootstrap replicate is independent. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu462/-/DC1">Supplementary Materials</ext-link> for more information about running times under different model conditions.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 DISCUSSION AND CONCLUSIONS</title>
    <p>This study introduced ASTRAL, a method for estimating species trees from unrooted gene trees. We proved that ASTRAL is statistically consistent under the multi-species coalescent model. In our study, ASTRAL was more accurate than MP-EST and BUCKy-pop, two leading coalescent-based methods, and improved or matched the accuracy of CA-ML under many conditions, except when the amount of ILS was low, where concatenation was more accurate. Results on the biological datasets show that statistically consistent coalescent-based methods can differ in terms of support for established clades, and produce different resolutions of biologically interesting relationships.</p>
    <p>The differences in performance are the result of different algorithmic techniques, which can result in greater or lesser robustness to missing data (<xref rid="btu462-B28" ref-type="bibr">Springer and Gatesy, 2014</xref>) and gene tree estimation error (<xref rid="btu462-B2" ref-type="bibr">Bayzid and Warnow, 2013</xref>). Hence, the choice of coalescent-based method matters. This study also showed that concatenation can be more accurate than coalescent-based estimation, provided that the amount of ILS is low enough. However, the best coalescent-based methods can be more accurate than concatenation under biologically realistic conditions.</p>
    <p>This study suggests the possibility that some of the observed discrepancies between previous coalescent-based analyses and concatenation in previous studies (<xref rid="btu462-B28" ref-type="bibr">Springer and Gatesy, 2014</xref>) might be the result of the choice of coalescent-based method, and that improved coalescent-based analyses might not only help to identify alternate relationships but might also confirm prior hypotheses produced using concatenation.</p>
    <p>The algorithmic design of ASTRAL can be improved. When run in default mode, ASTRAL’s accuracy is limited by the bipartitions in the input gene trees. Including estimated species trees in <inline-formula><mml:math id="I58"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> enlarges the search space and allows ASTRAL to produce highly accurate species trees, but other less <italic>ad hoc</italic> approaches for expanding <inline-formula><mml:math id="I59"><mml:mi mathvariant="script" class="calligraphy">X</mml:mi></mml:math></inline-formula> should also be developed. The running time we have given is polynomial and fast enough to run on genome-scale datasets, but improved algorithmic designs with better asymptotic performance could also be developed.</p>
    <p>Using bootstrap replicate gene trees instead of best ML gene trees did not improve species tree estimation accuracy on the simulated mixed mammalian dataset—and in fact made species tree estimations less accurate for MRP, MP-EST and ASTRAL. This suggests the possibility that the topological error in bootstrap gene trees is large enough to offset any improvement in species tree estimation obtained by taking gene tree uncertainty into account. However, it is possible that an improvement might be obtained under other conditions, or that using a sample of gene trees estimated by a Bayesian MCMC analysis might be better-suited to coalescent-based species tree estimation methods than maximum likelihood bootstrap trees, as suggested by <xref rid="btu462-B5" ref-type="bibr">DeGiorgio and Degnan (2014)</xref> [although see <xref rid="btu462-B32" ref-type="bibr">Yang and Warnow (2011)</xref>]. <xref rid="btu462-B16" ref-type="bibr">Knowles <italic>et al.</italic> (2012)</xref> found varying impact in species tree topology estimation through taking gene tree estimation error into account, but only examined small numbers of species and genes; thus, to some extent, the results we obtained might be because of the large number of genes and perhaps species in our studies.</p>
    <p>In summary, advances in algorithmic strategies for coalescent-based estimation can enable highly accurate species tree estimation in the presence of massive ILS. ASTRAL provides one such advance, but new and more accurate coalescent-based methods are needed to enable these analyses, especially for genome-scale datasets where missing data and extremely low phylogenetic signal in individual genes may be a substantial problem.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_17_i541__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu462_F_218_Supplementary_File.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>The authors thank the anonymous reviewers for their suggestions for improvements to the manuscript.</p>
    <p><italic>Funding</italic>: This work was supported by a generous allocation on <funding-source>Texas Advanced Computing Center (TACC)</funding-source>. This research was supported by the <funding-source>National Science Foundation</funding-source> [<award-id>0733029</award-id> and <award-id>1062335</award-id> (to T.W.), <award-id>10735191</award-id> (through iPLANT), and <award-id>1216898</award-id> (to M.S.S.)]; by the <funding-source>University of Alberta, Musea Ventures</funding-source> and Prof. G. K.-S. Wong; and by a <funding-source>Howard Hughes Medical Institute (HHMI)</funding-source> graduate student fellowship (to S.M.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu462-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allman</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying the rooted species tree from the distribution of unrooted gene trees under the coalescent</article-title>
        <source>J. Math. Biol.</source>
        <year>2011</year>
        <volume>62</volume>
        <fpage>833</fpage>
        <lpage>862</lpage>
        <pub-id pub-id-type="pmid">20652704</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Naive binning improves phylogenomic analyses</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2277</fpage>
        <lpage>2284</lpage>
        <pub-id pub-id-type="pmid">23842808</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiari</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenomic analyses support the position of turtles as the sister group of birds and crocodiles (archosauria)</article-title>
        <source>BMC Biol.</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>65</fpage>
        <pub-id pub-id-type="pmid">22839781</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeGiorgio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Fast and consistent estimation of species trees using supermatrix rooted triples</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>552</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="pmid">19833741</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeGiorgio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Robustness to divergence time underestimation when inferring species trees from estimated gene trees</article-title>
        <source>Syst. Biol.</source>
        <year>2014</year>
        <volume>63</volume>
        <fpage>66</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="pmid">23988674</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Anomalous unrooted gene trees</article-title>
        <source>Syst. Biol.</source>
        <year>2013</year>
        <volume>62</volume>
        <fpage>574</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="pmid">23576318</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Discordance of species trees with their most likely gene trees</article-title>
        <source>PLoS Genet.</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>e68</fpage>
        <pub-id pub-id-type="pmid">16733550</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Gene tree discordance, phylogenetic inference and the multispecies coalescent</article-title>
        <source>Trends Ecol. Evol.</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>332</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">19307040</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>Is a new and general theory of molecular systematics emerging?</article-title>
        <source>Evolution</source>
        <year>2009</year>
        <volume>63</volume>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="pmid">19146594</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B10">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hallett</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>New algorithms for the duplication-loss model</article-title>
        <source>Proceedings of the 4th Conference of Computational Molecular Biology (RECOMB’00)</source>
        <year>2000</year>
        <publisher-name>ACM</publisher-name>
        <fpage>138</fpage>
        <lpage>146</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of species trees from multilocus data</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>570</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">19906793</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hugall</surname>
            <given-names>AF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Calibration choice, rate smoothing, and the pattern of tetrapod diversification according to the long nuclear gene rag-1</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>543</fpage>
        <lpage>563</lpage>
        <pub-id pub-id-type="pmid">17654361</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A polynomial-time approximation scheme for inferring evolutionary trees from quartet topologies and its applications</article-title>
        <source>SIAM J. Comput.</source>
        <year>2001</year>
        <volume>30</volume>
        <fpage>1924</fpage>
        <lpage>1961</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimball</surname>
            <given-names>RT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying localized biases in large datasets: a case study using the avian tree of life</article-title>
        <source>Mol. Phylogenet. Evol.</source>
        <year>2013</year>
        <volume>69</volume>
        <fpage>1021</fpage>
        <lpage>1032</lpage>
        <pub-id pub-id-type="pmid">23791948</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kingman</surname>
            <given-names>JFC</given-names>
          </name>
        </person-group>
        <article-title>The coalescent</article-title>
        <source>Stoch. Process. Appl.</source>
        <year>1982</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>248</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knowles</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full modeling versus summarizing gene-tree uncertainty: method choice and species-tree accuracy</article-title>
        <source>Mol. Phylogenet. Evol.</source>
        <year>2012</year>
        <volume>65</volume>
        <fpage>501</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="pmid">22835380</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kubatko</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Inconsistency of phylogenetic estimates from concatenated data under coalescence</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>17</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="pmid">17366134</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BUCKy: gene tree/species tree reconciliation with the Bayesian concordance analysis</article-title>
        <source>Bioinfomatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2910</fpage>
        <lpage>2911</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>BEST: Bayesian estimation of species trees under the coalescent model</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2542</fpage>
        <lpage>2543</lpage>
        <pub-id pub-id-type="pmid">18799483</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>
        <source>BMC Evol. Biol.</source>
        <year>2010</year>
        <volume>10</volume>
        <fpage>302</fpage>
        <pub-id pub-id-type="pmid">20937096</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Gene trees in species trees</article-title>
        <source>Syst. Biol.</source>
        <year>1997</year>
        <volume>46</volume>
        <fpage>523</fpage>
        <lpage>536</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCormack</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A phylogeny of birds based on over 1,500 loci collected by target enrichment and high-throughput sequencing</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e54848</fpage>
        <pub-id pub-id-type="pmid">23382987</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math. Biosci.</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Matrix representation of trees, redundancy, and weighting</article-title>
        <source>Syst. Biol.</source>
        <year>1996</year>
        <volume>45</volume>
        <fpage>247</fpage>
        <lpage>253</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seo</surname>
            <given-names>TK</given-names>
          </name>
        </person-group>
        <article-title>Calculating bootstrap probabilities of phylogeny using multilocus sequence data</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>960</fpage>
        <lpage>971</lpage>
        <pub-id pub-id-type="pmid">18281270</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>BT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Target capture and massively parallel sequencing of ultraconserved elements for comparative studies at shallow evolutionary time scales</article-title>
        <source>Syst. Biol.</source>
        <year>2014</year>
        <volume>63</volume>
        <fpage>83</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="pmid">24021724</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving conflict in eutherian mammal phylogeny using phylogenomics and the multispecies coalescent model</article-title>
        <source>Proc. Natl Acad.Sci. USA</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>14942</fpage>
        <lpage>14947</lpage>
        <pub-id pub-id-type="pmid">22930817</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Springer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Gatesy</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Land plant origins and coalescence confusion</article-title>
        <source>Trends Plant Sci.</source>
        <year>2014</year>
        <volume>19</volume>
        <fpage>267</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="pmid">24641875</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML-NI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2688</fpage>
        <lpage>2690</lpage>
        <pub-id pub-id-type="pmid">16928733</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rose: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="pmid">9545448</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sukumaran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>Dendropy: a Python library for phylogenetic computing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1569</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="pmid">20421198</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate methods for phylogenomic analyses</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Suppl. 9</issue>
        <fpage>S4</fpage>
        <pub-id pub-id-type="pmid">22152123</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B33">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Algorithms for MDC-based multi-locus phylogeny inference</article-title>
        <source>Proceedings of the 15th Conference of Computational Molecular Biology (RECOMB’11)</source>
        <year>2011</year>
        <publisher-name>Springer</publisher-name>
        <fpage>531</fpage>
        <lpage>545</lpage>
      </element-citation>
    </ref>
    <ref id="btu462-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenomic analyses of nuclear genes reveal the evolutionary relationships within the bep clade and the evidence of positive selection in poaceae</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e64642</fpage>
        <pub-id pub-id-type="pmid">23734211</pub-id>
      </element-citation>
    </ref>
    <ref id="btu462-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Origin of land plants using the multispecies coalescent model</article-title>
        <source>Trends Plant Sci.</source>
        <year>2013</year>
        <volume>18</volume>
        <fpage>492</fpage>
        <lpage>495</lpage>
        <pub-id pub-id-type="pmid">23707196</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
