<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4426842</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv017</article-id>
    <article-id pub-id-type="publisher-id">btv017</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Repulsive parallel MCMC algorithm for discovering diverse motifs from large sequence sets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ikebata</surname>
          <given-names>Hisaki</given-names>
        </name>
        <xref ref-type="aff" rid="btv017-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yoshida</surname>
          <given-names>Ryo</given-names>
        </name>
        <xref ref-type="aff" rid="btv017-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv017-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btv017-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btv017-AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="btv017-AFF1">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="btv017-COR1">*</xref>
      </contrib>
      <aff id="btv017-AFF1"><sup>1</sup>Department of Statistical Science, The Graduate University for Advanced Studies (Sokendai), 10-3 Midori-cho, Tachikawa, Tokyo 190-8562, Japan, <sup>2</sup>Department of Statistical Modeling, The Institute of Statistical Mathematics, Research Organization of Information and Systems, 10-3 Midori-cho, Tachikawa, Tokyo 190-8562, Japan, <sup>3</sup>JST-CREST, 10-3 Midori-cho, Tachikawa, Tokyo 190-8562, Japan, <sup>4</sup>JST-ERATO Sato Live Bio-Forecasting Project, 2-2-2 Hikaridai Seika-cho, Soraku-gun, Khoto-fu 619-0288, Japan and <sup>5</sup>The Thomas N. Sato BioMEC-X Laboratories, Advanced Telecommunications Research Institute International, 2-2-2 Hikaridai Seika-cho, Soraku-gun, Khoto-fu 619-0288, Japan</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv017-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>10</issue>
    <fpage>1561</fpage>
    <lpage>1568</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>9</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>12</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>1</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The motif discovery problem consists of finding recurring patterns of short strings in a set of nucleotide sequences. This classical problem is receiving renewed attention as most early motif discovery methods lack the ability to handle large data of recent genome-wide ChIP studies. New ChIP-tailored methods focus on reducing computation time and pay little regard to the accuracy of motif detection. Unlike such methods, our method focuses on increasing the detection accuracy while maintaining the computation efficiency at an acceptable level. The major advantage of our method is that it can mine <italic>diverse multiple</italic> motifs undetectable by current methods.</p>
      <p><bold>Results:</bold> The repulsive parallel Markov chain Monte Carlo (RPMCMC) algorithm that we propose is a parallel version of the widely used Gibbs motif sampler. RPMCMC is run on parallel interacting motif samplers. A repulsive force is generated when different motifs produced by different samplers near each other. Thus, different samplers explore different motifs. In this way, we can detect much more diverse motifs than conventional methods can. Through application to 228 transcription factor ChIP-seq datasets of the ENCODE project, we show that the RPMCMC algorithm can find many reliable cofactor interacting motifs that existing methods are unable to discover.</p>
      <p><bold>Availability and implementation:</bold> A <monospace>C++</monospace> implementation of RPMCMC and discovered cofactor motifs for the 228 ENCODE ChIP-seq datasets are available from <ext-link ext-link-type="uri" xlink:href="http://daweb.ism.ac.jp/yoshidalab/motif">http://daweb.ism.ac.jp/yoshidalab/motif</ext-link>.</p>
      <p><bold>Contact:</bold><email>ikebata.hisaki@ism.ac.jp</email>, <email>yoshidar@ism.ac.jp</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv017/-/DC1">Supplementary data</ext-link> are available from <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The motif discovery problem has been receiving renewed attention since recent experimental technologies, such as ChIP-seq, posed new challenges. The problem is to identify recurring patterns of conserved short strings that appear in a large fraction of nucleotide sequences. A genome-wide ChIP study produces thousands or more DNA fragments consisting of several hundred base pairs, which cover the binding sites of a transcription factor (TF). By discovering motifs in the given sequences, which are associated with known TF-binding motifs in a database, e.g. JASPAR (<xref rid="btv017-B19" ref-type="bibr">Sandelin <italic>et</italic>
<italic>al</italic>., 2004</xref>), TRANSFAC (<xref rid="btv017-B26" ref-type="bibr">Wingender <italic>et</italic>
<italic>al</italic>., 1995</xref>), we can predict not only the regions bound by the primary TF but also the cofactors that modulate the TF activity (<xref rid="btv017-B1" ref-type="bibr">Bailey, 2011</xref>; <xref rid="btv017-B7" ref-type="bibr">Goi <italic>et</italic>
<italic>al</italic>., 2013</xref>; <xref rid="btv017-B22" ref-type="bibr">Smith <italic>et</italic>
<italic>al</italic>., 2005</xref>).</p>
    <p>Early methods of <italic>de novo</italic> motif discovery can be classified into either a model-based [MEME (<xref rid="btv017-B2" ref-type="bibr">Bailey and Elkan, 1994</xref>), AlignACE (<xref rid="btv017-B11" ref-type="bibr">Hughes <italic>et</italic>
<italic>al</italic>., 2000</xref>), ANN-Spec (<xref rid="btv017-B27" ref-type="bibr">Workman and Stormo, 2000</xref>)] or a word-count approach [Weeder (<xref rid="btv017-B15" ref-type="bibr">Pavesi <italic>et</italic>
<italic>al</italic>., 2001</xref>)]. These methods were designed on the assumption that the input sequences of ∼10<sup>3</sup> base pairs would range in size from 10<sup>2</sup> to 10<sup>3</sup>. Hence, they do not scale to the size of ChIP-seq data and their fundamental methodologies have undergone reconstruction. However, most ChIP-tailored algorithms emphasize computational efficiency, and they sacrifice accuracy of motif detection because they use heuristics to speed up their computation time.</p>
    <p>The model-based methods employ either the EM algorithm (<xref rid="btv017-B2" ref-type="bibr">Bailey and Elkan, 1994</xref>) or Gibbs sampling (<xref rid="btv017-B13" ref-type="bibr">Lawrence <italic>et</italic>
<italic>al</italic>., 1993</xref>). The main computational load arises in the process of calculating the posterior probabilities over all fixed-length subsequences at every iteration. STEME (<xref rid="btv017-B18" ref-type="bibr">Reid and Wernisch, 2011</xref>), a ChIP-tailored version of MEME, uses a branch-and-bound technique, so that negligible oligomers with significantly low probabilities are effectively removed. The word-count methods, regardless of old or new, rely on essentially the same strategy. All possible oligomers are counted with exact or the fuzzy matching for input sequences. Then, overrepresented oligomers are determined against background sequences. Similar motifs are merged to generate output motifs. To reduce the computational load in the counting operation, DREME (<xref rid="btv017-B1" ref-type="bibr">Bailey, 2011</xref>) and CisFinder (<xref rid="btv017-B20" ref-type="bibr">Sharov and Ko, 2009</xref>) adopt similar strategies. Starting from <inline-formula><mml:math id="MM1"><mml:mrow><mml:mo>≃</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> oligomers with no wildcards, each oligomer is either left or removed recursively by adding a wildcard and by assessing its significance. Such methods run the risk of missing important motifs in earlier steps of the recursion. Hegma (Ichinose <italic>et</italic>
<italic>al</italic>., 2012) is the fastest of current algorithms. A highly specific strategy based on Gray codes (<xref rid="btv017-B9" ref-type="bibr">Gray, 1947</xref>) is employed to avoid fuzzy matching so as to speed up the merging of similar motifs. However, this novel idea results in a degradation of the detection accuracy as will be shown later.</p>
    <p>The aim of this study is to derive a new algorithm that achieves high detection accuracy while maintaining the computational efficiency at an acceptable level. In particular, the proposed method is designed to detect <italic>many diverse</italic> motifs that previous methods are unable to discover. The proposed repulsive parallel MCMC (RPMCMC) algorithm is a parallel version of the widely used Gibbs motif sampler. One critical drawback of the standard Gibbs sampling, as with the EM algorithm, arises from the following fact: the posterior distribution is highly multimodal because many diverse motifs are present in given sequences. Once the generated Markov chain is absorbed to a locally high probability region, it is difficult to escape from that region within a finite time. This problem has received little attention in previous studies. MEME adopts a serial implementation of the EM algorithm that repeats the search with different initial conditions (<xref rid="btv017-B2" ref-type="bibr">Bailey and Elkan, 1994</xref>). To reduce the possibility of becoming trapped in the same local optima, low prior probabilities are assigned to already-discovered motif sites in consecutive serial runs. However, such iterative methods take too long to be used for large ChIP data.</p>
    <p>RPMCMC is run on parallel interacting Gibbs samplers. A repulsive force comes into play when the trajectories of different chains near each other. Therefore, different chains are facilitated to explore different regions. Compared with the original method using a single chain, this all-at-once interacting parallel run can detect much more diverse motifs. In addition, the proposed method has other unique characteristics, for instance automated control of variable-length motifs, and the fast-clustering algorithm for many generated motifs in the summarization step. We implemented the RPMCMC algorithm with <monospace>C++</monospace>, which is available from the <ext-link ext-link-type="uri" xlink:href="http://daweb.ism.ac.jp/yoshidalab/motif">Supplementary Website</ext-link>. The method was comprehensively tested on synthetic promoter sequences and 228 TF ChIP-seq datasets of the ENCODE project. In the synthetic promoter analysis, RPMCMC found around 1.5 times as many embedded motifs as existing methods did. For the ChIP-seq datasets, the RPMCMC algorithm reported 444 reliable cofactors in total, 219 of which were not discovered by either of the recently published ChIP-tailored algorithms: DREME and Hegma. On the <ext-link ext-link-type="uri" xlink:href="http://daweb.ism.ac.jp/yoshidalab/motif">Supplementary Website</ext-link>, we provide all the discovered cofactor motifs which were associated with annotated motifs in JASPAR.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Model</title>
      <p>We use the ZOOPS model (<xref rid="btv017-B2" ref-type="bibr">Bailey and Elkan, 1994</xref>) that allows zero or one motif occurrence per sequence. Assume that we are given a set of <italic>n</italic> sequences, <inline-formula><mml:math id="MM2"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where sequence <inline-formula><mml:math id="MM3"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is of length <italic>L<sub>i</sub></italic> (<inline-formula><mml:math id="MM4"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>). The reverse complement of the given sequence set is denoted by <inline-formula><mml:math id="MM5"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Our model uses the set of <italic>n</italic> concatenated sequences, <inline-formula><mml:math id="MM6"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM8"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>). The motif presence indicator <italic>z<sub>i</sub></italic> takes the value 1 or 0 according to the presence or absence of a motif in sequence <italic>s<sub>i</sub></italic>. In a sequence <italic>s<sub>i</sub></italic> with <italic>z<sub>i</sub></italic> = 1, a <italic>K</italic>-mer motif is positioned at the start site <inline-formula><mml:math id="MM9"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>}. The <italic>k</italic>th element of the motif follows the position-specific multinomial distribution with <inline-formula><mml:math id="MM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which represents the nucleotide preference of the <italic>k</italic>th element to A, C, G, T. Thus, we have <inline-formula><mml:math id="MM11"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, a position probability matrix (PPM). We treat the motif length <italic>K</italic> as an unknown parameter. The background sequences are assumed to follow independent multinomial trials with the background probability denoted by <inline-formula><mml:math id="MM12"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <p>Given an input <italic>S</italic>, the objective is to estimate the PPM Θ with the unknown motif length <italic>K</italic> and the background probability θ<sub>0</sub> where the latent variables comprise <inline-formula><mml:math id="MM13"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM14"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The likelihood is then
<disp-formula id="btv017-M1"><label>(1)</label><mml:math id="MM15"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>Θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext>  </mml:mtext><mml:mo>×</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula><mml:math id="MM16"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the types of bases at the <italic>j</italic>th position in <italic>s<sub>i</sub></italic>, and <inline-formula><mml:math id="MM17"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the indicator function. The first component of the right-hand side in the first line is the probability of all letters in the <italic>n</italic> input sequences, which is calculated under the background multinomial distribution. The second component is the likelihood ratio that assesses overrepresentation of the <italic>K</italic>-mer segmented sequences against the background.</p>
      <p>As the priors on the multinomial parameters, we use the Dirichlet distributions
<disp-formula><mml:math id="MM18"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Θ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>where <inline-formula><mml:math id="MM20"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM21"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="MM22"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are the concentration parameters fixed at set values. The prior on Θ is conditioned by the motif length <italic>K</italic>. The equal probabilities are assigned to any <italic>K</italic> with a range between the predetermined minimum and maximum motif lengths, <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM24"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p>To complete the joint posterior of all the unknown parameters, we prescribe the priors on <italic>U</italic> and <italic>Z</italic> as follows:
<disp-formula><mml:math id="MM25"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> for </mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mtext> for </mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
The start site <italic>u<sub>i</sub></italic> of a motif occurs with equal probability in all the possible positions in sequence <italic>s<sub>i</sub></italic>. The motif presence indicator <italic>z<sub>i</sub></italic> follows the binomial distribution with the success probability γ<italic><sup>K</sup></italic> for each <italic>i</italic> (<inline-formula><mml:math id="MM26"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>γ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
      <p>Note that although a specific type of modeling is presented here, our current program allows for a certain amount of flexibility in the model specification. For instance a user can choose a higher-order Markov background model up to third order (<xref rid="btv017-B5" ref-type="bibr">da Fonseca <italic>et</italic>
<italic>al</italic>., 2008</xref>) and a position specific prior for the motif start sites (<xref rid="btv017-B3" ref-type="bibr">Bailey <italic>et</italic>
<italic>al</italic>., 2010</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Multiple motifs and local trap</title>
      <p>Let <italic>x</italic> denote all the unknowns, <inline-formula><mml:math id="MM27"><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>Θ</mml:mi></mml:mrow></mml:math></inline-formula> and θ<sub>0</sub>. To obtain an estimate approximately with the posterior <inline-formula><mml:math id="MM28"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we can employ a Gibbs sampling method. However, the Gibbs motif sampler has a serious drawback in that inherent presence of a great many different motifs causes a complex energy landscape of the posterior distribution. In particular, once the trajectory of a Markov chain comes into a locally high-probability region which corresponds to one of the existing motifs, it is difficult to effect a transfer into another region within a finite runtime. The EM algorithm might exhibit the same defects.</p>
      <p>As an illustration, we show a result of the simple Gibbs motif sampling. The dataset consists of 10<sup>3</sup>-bp-long synthetic promoter sequences of 300 human genes. The Gibbs sampling was repeated 20 times under different initial conditions. As shown in <xref ref-type="fig" rid="btv017-F1">Figure 1</xref>, <italic>all</italic> the chains were trapped at similar AT-rich motifs for a long duration. Exceedingly high probabilities might be concentrated on the AT-rich segments and all the chains were absorbed to those domains of the posterior distribution. This is a typical scenario. <xref ref-type="fig" rid="btv017-F1">Figure 1</xref> also shows the result of RPMCMC, which was run with 20 interacting parallel Gibbs samplers as described below. By performing just an all-at-once parallel run, RPMCMC could capture much more diverse motifs than the independent Gibbs sampling could.
<fig id="btv017-F1" position="float"><label>Fig. 1.</label><caption><p>A drawback of the independent Gibbs motif sampler, which is highlighted on 300 promoter sequences. The top and bottom panels display the processes of produced PPMs (sequence-logos) for RPMCMC with 20 replicas and independent Gibbs sampling under 20 different initial conditions. Five of the 20 sampling paths are shown for each method</p></caption><graphic xlink:href="btv017f1p"/></fig></p>
    </sec>
    <sec>
      <title>2.3 RPMCMC algorithm</title>
      <p>The RPMCMC algorithm is derived by creating an augmented system <inline-formula><mml:math id="MM29"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which consists of <italic>M</italic> exact copies <inline-formula><mml:math id="MM30"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM31"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>) of the posterior distribution and the repulsive force function <inline-formula><mml:math id="MM32"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula id="btv017-M2"><label>(2)</label><mml:math id="MM33"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>π</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>ψ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo> ≥ </mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula>
Each <italic>x<sub>i</sub></italic> is called a <italic>replica</italic>. The repulsive force function ψ imposes a stronger penalty on closer replicas. The parameter β controls the force severity, i.e. a greater β produces a stronger repulsion and vice versa. Drawing samples of <inline-formula><mml:math id="MM34"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> simultaneously from <xref ref-type="disp-formula" rid="btv017-M2">Equation (2)</xref>, the <italic>M</italic> sample paths tend to move toward different regions. Furthermore, a replica trapped in a locally high probability state can be pushed to other regions by the repulsive force derived from approaching replicas (<xref ref-type="fig" rid="btv017-F2">Fig. 2</xref>). It is important to see that the use of a non-zero force severity brings bias to the samples from π<italic><sub>A</sub></italic> with respect to the posterior distribution. With β = 0, which removes the repulsion from π<italic><sub>A</sub></italic>, an unbiased sample set can be obtained.
<fig id="btv017-F2" position="float"><label>Fig. 2.</label><caption><p>A schematic view of the RPMCMC algorithm</p></caption><graphic xlink:href="btv017f2p"/></fig></p>
      <p>The repulsive force function is defined as a function of PPMs, <inline-formula><mml:math id="MM35"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM36"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be an increasing function of the dissimilarity between Θ<italic><sub>i</sub></italic> and Θ<italic><sub>j</sub></italic>. With this, the repulsion is modeled by
<disp-formula id="btv017-M3"><label>(3)</label><mml:math id="MM37"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi>exp</mml:mi></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Replica <italic>i</italic> interacts with its nearest neighbor <inline-formula><mml:math id="MM38"><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, such that <inline-formula><mml:math id="MM39"><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The dissimilarity <italic>D</italic> is measured by
<disp-formula id="btv017-M4"><label>(4)</label><mml:math id="MM40"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">A</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mtext> </mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula><mml:math id="MM41"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM42"><mml:mrow><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. In general, <italic>K<sub>i</sub></italic> and <italic>K<sub>j</sub></italic>, the column sizes of Θ<italic><sub>i</sub></italic> and Θ<italic><sub>j</sub></italic>, are different. The distance of the PPMs is assessed after associating a smaller-sized PPM with the same-sized submatrix of the other, <inline-formula><mml:math id="MM43"><mml:mrow><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM44"><mml:mrow><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and by choosing the smallest Frobenius norm in all possible alignments <inline-formula><mml:math id="MM45"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">A</mml:mi></mml:mrow></mml:math></inline-formula>. The second term is a gap penalty for the difference of motif lengths where <italic>c</italic> &gt; 0.</p>
      <p>To obtain an estimate from the augmented posterior, Gibbs sampling is combined with several techniques such as the reversible-jump MCMC method (<xref rid="btv017-B8" ref-type="bibr">Green, 1995</xref>) and the slice sampler (<xref rid="btv017-B14" ref-type="bibr">Neal, 2003</xref>). The full details of the RPMCMC procedure are described in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv017/-/DC1">Supplementary Method S1</ext-link>. The proposed method generates Markov chains of the <italic>M</italic> replicas in parallel. Then, different chains move toward different regions of the state space due to the repulsion. We can discover a much wider variety of motifs with an all-at-once interacting parallel simulation than with the independent method. Conventional Gibbs sampling with <italic>M</italic> different initial seeds (as shown in the previous subsection) can be derived by setting the zero force severity, β = 0, to RPMCMC.</p>
      <p>Suppose that we are given a sample set of size <italic>N</italic> × <italic>M</italic> from <xref ref-type="disp-formula" rid="btv017-M2">Equation (2)</xref> with nonzero β, denoted by <inline-formula><mml:math id="MM46"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> where each <inline-formula><mml:math id="MM47"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the <italic>j</italic>th sample of the <italic>i</italic>th replica. Obviously, the repulsive force leads to biased samples with respect to the target <inline-formula><mml:math id="MM48"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="btv017-M2">Equation (2)</xref> at the zero force severity. To correct this bias, the importance sampling is used, which assigns a weight to each sample as
<disp-formula id="btv017-M5"><label>(5)</label><mml:math id="MM49"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The ratio between the target (zero force) and the biased distribution (<inline-formula><mml:math id="MM50"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) becomes the inverse of the repulsive force function. Note that the <italic>M</italic> replicas <inline-formula><mml:math id="MM51"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM52"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>) in the <italic>j</italic>th ensemble share the same weight.</p>
      <p>As shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv017/-/DC1">Supplementary Method S1</ext-link>, our current implementation does not parallelize the process of updating the <italic>M</italic> Markov chains. We use multi-core processors only for counting the nucleotide frequencies when renewing the motif start sites.</p>
    </sec>
    <sec>
      <title>2.4 Post-processing: clustering and ranking</title>
      <p>RPMCMC produces many redundant outputs with slight variations. We reduce the redundancy by grouping the outputs into <italic>g</italic> clusters, <inline-formula><mml:math id="MM53"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, based on the dissimilarity of the sampled PPMs. The procedure is as follows (see <xref ref-type="fig" rid="btv017-F3">Fig. 3</xref> for a schematic illustration):
<list list-type="roman-lower"><list-item><p>Samples of size <inline-formula><mml:math id="MM54"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> are arranged as <inline-formula><mml:math id="MM55"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> by sorting realized values of the likelihood [<xref ref-type="disp-formula" rid="btv017-M1">Equation (1)</xref>] in decreasing order.</p></list-item><list-item><p>Set <inline-formula><mml:math id="MM56"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, a threshold for the within-cluster variability.</p></list-item><list-item><p>Set <italic>k</italic> = 1 and repeat (a)-(d) until no samples are left:
<list list-type="alpha-lower"><list-item><p>Initiate the <italic>k</italic>th cluster <inline-formula><mml:math id="MM57"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> by a singleton of the sample that is ranked first in η. Let <inline-formula><mml:math id="MM58"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> be the cluster representative.</p></list-item><list-item><p>Collect all samples satisfying the condition <inline-formula><mml:math id="MM59"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo> ≤ </mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="MM60"><mml:mrow><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes the PPM of <inline-formula><mml:math id="MM61"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. These samples are integrated into cluster <italic>C<sub>k</sub></italic>; <inline-formula><mml:math id="MM62"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo> ≤ </mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Discard the collected samples in <italic>C<sub>k</sub></italic> from the ordered sequence; <inline-formula><mml:math id="MM63"><mml:mrow><mml:mi>η</mml:mi><mml:mo>←</mml:mo><mml:mi>η</mml:mi><mml:mo>∖</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Let <italic>p</italic> be the length of η and rearrange η according to the likelihood values.</p></list-item><list-item><p>If η is empty, terminate the computation. Otherwise, let <inline-formula><mml:math id="MM64"><mml:mrow><mml:mi>k</mml:mi><mml:mo>←</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and go back to step (a).</p></list-item></list></p></list-item></list>
<fig id="btv017-F3" position="float"><label>Fig. 3.</label><caption><p>A schematic illustration of the post-processing process</p></caption><graphic xlink:href="btv017f3p"/></fig></p>
      <p>The method operates with a single input parameter λ that controls the number <italic>g</italic> of clusters. Samples within <inline-formula><mml:math id="MM65"><mml:mrow><mml:mi>D</mml:mi><mml:mo> ≤ </mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> are assigned to the cluster representative μ<italic><sub>k</sub></italic>, which is the one to achieve the highest likelihood within the <italic>k</italic>th cluster members.</p>
      <p>Denote the <inline-formula><mml:math id="MM66"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> samples and their importance weights by <inline-formula><mml:math id="MM67"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. With the <italic>g</italic> reduced samples <inline-formula><mml:math id="MM68"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, we define an approximated posterior distribution by
<disp-formula><mml:math id="MM69"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:munderover><mml:mi>I</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
This is a mixture of the <italic>g</italic> probability mass functions <inline-formula><mml:math id="MM70"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at μ<italic><sub>k</sub></italic>. Mixing rate <inline-formula><mml:math id="MM71"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the sum of the importance weights associated with the corresponding cluster <italic>C<sub>k</sub></italic>. PPMs and the motif start sites in <inline-formula><mml:math id="MM72"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> are of primary interest for motif discovery. We generate a ranked list of the reduced discovered motifs, which are ordered according to the weights <inline-formula><mml:math id="MM73"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.5 Performance evaluation</title>
      <p>We report the performance of several motif discovery algorithms on two types of data: (i) promoter sequences into which strings generated from PPMs in the JASPAR CORE database are planted and (ii) 228 TF ChIP-seq datasets of the ENCODE project. We evaluate the performance for each type of data as follows:
<list list-type="simple"><list-item><p>(i)  Given the nucleotide positions of known and predicted motifs, recall [sensitivity (SN)] and precision [positive predicted value (PPV)] are evaluated at a nucleotide level. These criteria have commonly been used, for instance in <xref rid="btv017-B24" ref-type="bibr">Tompa <italic>et</italic>
<italic>al</italic>. (2005)</xref> (we use the abbreviations SN and PPV according to convention). For given <italic>J</italic> known motifs, we define slightly modified SN and PPV for the evaluation of multiple output motifs.</p><p>Let <italic>p<sub>j</sub></italic> be the output that achieves the most overlapping predicted sites with the <italic>j</italic>th known motif among the <italic>g</italic> outputs (if there are two or more outputs having the same number of overlapped nucleotides, the one with the higher rank given by a motif finder is chosen). Then, the recall and the precision are computed as
<disp-formula><graphic xlink:href="btv017um1.jpg" position="float"/></disp-formula>
A low SN statistic indicates the lack of ability to discover planted multiple motifs and a low PPV statistic can be a signal for less identification accuracy, for instance the occurrence of over- or under-estimates of the planted motif regions.</p></list-item><list-item><p>(ii)  From contiguous segments around the transcription factor binding sites (TFBSs) of the primary TF in each dataset, we obtain a list of cofactor interacting motifs and their annotations that are implicated in the regulatory module of the primary TF. To identify the cooperative cofactors of the primary TF, each predicted motif (PPM) is matched to JASPAR CORE motifs by using the TOMTOM program (<xref rid="btv017-B10" ref-type="bibr">Gupta <italic>et</italic>
<italic>al</italic>., 2007</xref>). For a given predicted PPM, TOMTOM outputs the matching scores to all annotated TFBSs (the name of TFs) in JASPAR with the statistical significances (<italic>E</italic>-values). For each algorithm, a diversity of the discovered motifs is evaluated with the number of known motifs in JASPAR CORE that are matched significantly to the produced PPMs with the acceptable level of significance at <italic>E</italic>-value less than 0.05.</p><p>In addition, we use the log-likelihood ratio (LLR) to evaluate <italic>K</italic>-mer binding sites of a predicted motif:
<disp-formula><mml:math id="MM76"><mml:mrow><mml:mtext>LLR</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mstyle></mml:mrow></mml:mstyle><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM77"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM78"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>) is the relative frequency of nucleotides at each position in a predicted site, <inline-formula><mml:math id="MM79"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the relative frequency of nucleotides of the background. The output consists of <inline-formula><mml:math id="MM80"><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> motif subsequences. A higher LLR indicates a better likeliness of the <italic>K</italic>-mer instances to be a motif in terms of a combined characterization on the degree of overrepresentation relative to the background and the total information content.</p></list-item></list></p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 Synthetic promoter sequence</title>
      <p>The performance of RPMCMC was tested on synthetic datasets against two ChIP-tailored algorithms, DREME and Hegma, and a classical algorithm, Weeder. The datasets were derived from non-redundant sets of randomly selected <inline-formula><mml:math id="MM81"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>300</mml:mn><mml:mo>,</mml:mo><mml:mn>600</mml:mn><mml:mo>,</mml:mo><mml:mn>1200</mml:mn><mml:mo>,</mml:mo><mml:mn>2500</mml:mn><mml:mo>,</mml:mo><mml:mn>5000</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> promoter sequences obtained from UCSC.hg19 with two different kinds; one composed of fixed-length sequences of 1000 bp and the other of variable-length sequences varied between 200 and 2000 bp. Oligomers generated by randomly chosen 10 JASPAR CORE PPM collections were planted into randomly selected start sites, so that each sequence has eight motifs on average. For each data size <italic>n</italic>, we prepared 20 different sequence sets. With this ground truth, we measured the change in recall and precision. All parameters of RPMCMC and the specified Weeder options are listed in <xref ref-type="table" rid="btv017-T1">Table 1</xref>. For DREME and Hegma, we employed the default parameters. The parameters of RPMCMC were empirically chosen.
<table-wrap id="btv017-T1" position="float"><label>Table 1.</label><caption><p>Default parameters of RPMCMC and Weeder options that were used in all experiments</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="center" colspan="2" rowspan="1">RPMCMC<hr/></th></tr><tr><th rowspan="1" colspan="1">Parameter</th><th rowspan="1" colspan="1">Value</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Prior on <italic>z<sub>i</sub></italic></td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM82"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.755</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td rowspan="1" colspan="1">Max/min motif width</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM83"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td rowspan="1" colspan="1">Dirichlet priors</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM84"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td rowspan="1" colspan="1">No. of replicas</td><td rowspan="1" colspan="1"><italic>M</italic> = 50</td></tr><tr><td rowspan="1" colspan="1">No. of MCMC iterations</td><td rowspan="1" colspan="1"><italic>N</italic> = 520</td></tr><tr><td rowspan="1" colspan="1">Burn-in period (fixed)</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM85"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≤</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td rowspan="1" colspan="1">Repulsive force severity</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM86"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula></td></tr><tr><td rowspan="1" colspan="1">Motif clustering</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM87"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td rowspan="1" colspan="1">Gap penalty</td><td rowspan="1" colspan="1"><italic>c</italic> = 0.3</td></tr><tr><td colspan="2" rowspan="1"/></tr><tr><td colspan="2" rowspan="1"><hr/>Weeder</td></tr><tr><td rowspan="1" colspan="1">Option</td><td rowspan="1" colspan="1">Value</td></tr><tr><td colspan="2" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Species code</td><td rowspan="1" colspan="1">HS</td></tr><tr><td rowspan="1" colspan="1">Analysis type</td><td rowspan="1" colspan="1">Medium</td></tr></tbody></table><table-wrap-foot><fn id="btv017-TF1"><p>Hegma and DREME were executed using the default settings.</p></fn></table-wrap-foot></table-wrap></p>
      <p><xref ref-type="fig" rid="btv017-F4">Figure 4</xref>(a) summarizes the SN and PPV values as a function of <italic>n</italic> for RPMCMC, Hegma and Weeder. DREME was removed from this figure because there was no way of calculating SN and PPV due to the lack of outputs on motif sites in the distributed program. The numbers of outputs from RPMCMC, Hegma and Weeder were 85.7, 214.76 and 13.3 on average, respectively. It can be seen that RPMCMC outperformed the other methods. For the fixed-length datasets, RPMCMC delivered SN values around 1.7 times higher than those of the other two methods. The PPVs of RPMCMC were around 1.5 times higher than those of Hegma. As shown in <xref ref-type="fig" rid="btv017-F4">Figure 4</xref>(b), the results on the variable-length datasets were similar to those on the fixed-length datasets except that the performance of Hegma was significantly degraded.
<fig id="btv017-F4" position="float"><label>Fig. 4.</label><caption><p>Performance comparison among RPMCMC, Hegma and Weeder on synthetic datasets: (<bold>a</bold>) fixed-length sequence sets and (<bold>b</bold>) variable-length sequence sets. Motifs were generated according to the JASPAR CORE PPM collection and were inserted randomly into a set of promoter sequences. SN (left) and PPV (right) values of each method are plotted against the varying sequence sizes, <inline-formula><mml:math id="MM88"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>300</mml:mn><mml:mo>,</mml:mo><mml:mn>600</mml:mn><mml:mo>,</mml:mo><mml:mn>1200</mml:mn><mml:mo>,</mml:mo><mml:mn>2500</mml:mn><mml:mo>,</mml:mo><mml:mn>5000</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p></caption><graphic xlink:href="btv017f4p"/></fig></p>
      <p>We analyzed the cause of the observed low SN and PPV statistics for Hegma and Weeder, as illustrated with the results on the fixed-length datasets. It was found that Hegma has a strong tendency to divide planted regions of a motif into a few different predicted motifs. Such incorrectly fragmented outputs acted to increase PPV slightly but resulted in the observed low SN. A distinctive characteristic of Weeder is the fairly low PPV, whereas several comparative studies reported Weeder to be one of the best performing algorithms among early motif finders (<xref rid="btv017-B24" ref-type="bibr">Tompa <italic>et</italic>
<italic>al</italic>., 2005</xref>). A region predicted by Weeder tends to include not only a planted motif region but also many background regions. RPMCMC could achieve much higher SN and PPV than the others could.</p>
      <p><xref ref-type="fig" rid="btv017-F5">Figure 5</xref>(a) gives the computation time for each method. RPMCMC was implemented in <monospace>C++</monospace>. We used the <monospace>C</monospace> programs for DREME, Hegma and Weeder, which are available on the authors’ websites. All the tests were conducted on Intel<sup>®</sup> Xeon Phi<sup>™</sup>coprocessors with 61-core CPUs and 48 GB of main memory. In terms of computation efficiency, Hegma outperformed the others and RPMCMC was comparable to DREME. In particular, the computation times of RPMCMC and DREME were about a 10000th those of Hegma. RPMCMC would sustain an acceptable level of computation time, and furthermore, it might be possible to render the algorithm more efficient. The bottleneck in RPMCMC is in the process of calculating the posterior probabilities of the motif start sites <italic>u<sub>i</sub></italic> (see details in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv017/-/DC1">Supplementary Method S1</ext-link>): with a given PPM, <inline-formula><mml:math id="MM89"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mstyle displaystyle="false"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mn>2</mml:mn></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> times calculations were necessary to perform in every iteration over all possible <italic>K</italic>-mer consecutive subsequences in <italic>S</italic>. This process can fully be parallelized into independent processing elements. Alternatively, we could use a branch-and-bound technique as in STEME that effectively prunes subsequences with negligibly low probabilities.
<fig id="btv017-F5" position="float"><label>Fig. 5.</label><caption><p>Computational efficiency of RPMCMC, Hegma, DREME and Weeder. (<bold>a</bold>) The synthetic promoter sequence and (<bold>b</bold>) the ChIP-seq datasets, shown as a function of the number of nucleotides. The vertical axis indicates CPU times. The right figure is an enlarged display of the left figure to make clear the computation time of Hegma</p></caption><graphic xlink:href="btv017f5p"/></fig></p>
      <p>We remark on the difficulty in detecting the burn-in time for RPMCMC. An initial portion of the Markov chain samples should be discarded because the chain approaches its stationary distribution (<xref rid="btv017-B4" ref-type="bibr">Cowles and Carlin, 1996</xref>) following a sufficient burn-in period. <xref ref-type="fig" rid="btv017-F6">Figure 6</xref> shows the process of evolving the likelihood during a RPMCMC run. The series of the likelihood values remained instable, which indicates a fairly slow mixing of the Markov chain because the target distribution was inherently multimodal and the parallel interacting chains switched their target local modes successively. In general, it is difficult to deal with a diagnostic of burn-in periods that looks for multimodality of the posterior distribution. At the current moment, we do not have a specific idea other than an obvious approach of giving as long as possible for a trial move.
<fig id="btv017-F6" position="float"><label>Fig. 6.</label><caption><p>Series of the likelihood values in RPMCMC for a synthetic dataset with 300 sequences. Default burn-in is set at 20 steps (vertical line in upper plot)</p></caption><graphic xlink:href="btv017f6p"/></fig></p>
    </sec>
    <sec>
      <title>3.2 ENCODE ChIP-seq datasets</title>
      <p>Using RPMCMC with the default parameters given in <xref ref-type="table" rid="btv017-T1">Table 1</xref>, we predicted the cofactor motifs of the primary TF for each of the 228 datasets of ChIP-seq experiments in the ENCODE project (<xref rid="btv017-B23" ref-type="bibr">The ENCODE Project Consortium, 2012</xref>). FASTA files were produced by clipping the sequences of UCSC.hg19 at the locations recorded in SYDH TFBS narrowPeak files (available from NCBI’s Gene Expression Omnibus using the accession number GSE31477). We removed datasets that had only a few sequences after removing fragments with lengths less than 200 or more than 500 from the obtained FASTA files. Also, we removed datasets which have more than one percent of sequences including blacklist regions reported on <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/anshulkundaje/projects/blacklists">https://sites.google.com/site/anshulkundaje/projects/blacklists</ext-link>. In this way, we obtained the 228 datasets from the total of 359 datasets. The numbers of the input sequences ranged from 205 to 49 211. RPMCMC produced 51–149 output motifs for each dataset. A discovered motif, for instance <inline-formula><mml:math id="MM90"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> in μ<italic><sub>k</sub></italic>, was regarded as being significantly enriched if it appeared in 5% or more of the input sequences, i.e. <inline-formula><mml:math id="MM91"><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. At the acceptable level of significance on the TOMTOM’s <italic>E</italic>-values <inline-formula><mml:math id="MM92"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, approximately 15 significantly enriched outputs on average could have correspondence to one of the experimentally validated TFBSs in JASPAR CORE. In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv017/-/DC1">Supplementary Data S1</ext-link>, we provide the lists of <italic>de novo</italic> cofactor motifs for all TF-ChIP datasets with the results of JASPAR annotations.</p>
      <p>In the experiments, Hegma produced a far greater number of outputs (1081 outputs on average over all datasets) than RPMCMC (110 outputs) and DREME (49 outputs). The outputs of Hegma possibly included many redundant motifs. Removing motifs with <inline-formula><mml:math id="MM93"><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> from the total outputs, the average numbers of outputs of Hegma, RPMCMC and DREME dropped to 24, 110 and 33, respectively.</p>
      <p>The computation times of each algorithm for 10 selected datasets including the smallest and the largest dataset are shown in <xref ref-type="fig" rid="btv017-F5">Figure 5</xref>(b). Compared with the experiment with the synthetic datasets, the computation times of RPMCMC were a little inferior to those of DREME for the ChIP-seq datasets. RPMCMC would still sustain an acceptable level of computation time. As discussed in the previous subsection, the current implementation of the RPMCMC algorithm is yet to be optimized for speed.</p>
      <p>As shown in <xref ref-type="fig" rid="btv017-F7">Figure 7</xref>(a), the numbers of known motifs significantly matched to the outputs of RPMCMC (<italic>E</italic>-values <inline-formula><mml:math id="MM95"><mml:mo>≤</mml:mo></mml:math></inline-formula>0.05) were larger than those of Hegma and DREME for 74% of the 228 datasets. Although RPMCMC produced the largest numbers of outputs among the three methods, the LLR values of the discovered motifs of RPMCMC were much higher than those of the others as in <xref ref-type="fig" rid="btv017-F7">Figure 7</xref>(b). This indicates that RPMCMC has a great potential to mine many reliable diverse motifs that are undetected by the existing methods.
<fig id="btv017-F7" position="float"><label>Fig. 7.</label><caption><p>Comparison of RPMCMC with Hegma and DREME on the 228 ENCODE datasets. (<bold>a</bold>) The number of motifs in JASPAR CORE that were matched to outputs of each algorithm for each of the 228 datasets (blue: RPMCMC; magenta: Hegma; green: DREME). The datasets are arranged by gathering together the subsets with which each method achieved the most matching to JASPAR. (<bold>b</bold>) The LLR values of the predicted sites are shown across arbitrary-chosen 10 datasets with different sizes (<inline-formula><mml:math id="MM94"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi>log</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>). Each number on the box indicates the number of sequences in each dataset</p></caption><graphic xlink:href="btv017f7p"/></fig></p>
      <p><xref ref-type="table" rid="btv017-T2">Table 2</xref> shows 15 cofactors that were predicted by RPMCMC on a ChIP dataset (wgEncodeSydhTfbsHepg2Nrf1IggrabPk) in which the binding sites of NRF1 were studied in HepG2. The binding sites of RPN4 and USF1 were detected only by RPMCMC. It was reported that both RPN4 and NRF1 are involved in the same proteasome activity (<xref rid="btv017-B17" ref-type="bibr">Radhakrishnan <italic>et</italic>
<italic>al</italic>., 2010</xref>; <xref rid="btv017-B25" ref-type="bibr">Xu <italic>et</italic>
<italic>al</italic>., 2011</xref>), and the interaction of USF1 and Nrf1 is involved in the transcriptional regulation of FMP1 gene (<xref rid="btv017-B16" ref-type="bibr">Prasad and Singh, 2008</xref>).
<table-wrap id="btv017-T2" position="float"><label>Table 2</label><caption><p>A list of 16 predicted motifs obtained by RPMCMC that are implicated in the transcriptional module of NRF1 in HepG2</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Predicted motif<hr/></th><th rowspan="1" colspan="1">E-value</th><th rowspan="1" colspan="1">Ranking</th><th colspan="2" align="center" rowspan="1">P/A<hr/></th><th rowspan="1" colspan="1"/></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Hegma</th><th rowspan="1" colspan="1">DREME</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">SP1</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM96"><mml:mrow><mml:mn>2.71</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">P</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">EGR1</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM97"><mml:mrow><mml:mn>1.09</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">P</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">SP2</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM98"><mml:mrow><mml:mn>1.10</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">P</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">KLF5</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM99"><mml:mrow><mml:mn>3.75</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">P</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">NRF1</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM100"><mml:mrow><mml:mn>3.80</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">P</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">FUS3</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM101"><mml:mrow><mml:mn>5.07</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">P</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">E2F4</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM102"><mml:mrow><mml:mn>4.52</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">45</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">P</td></tr><tr><td rowspan="1" colspan="1">REST</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM103"><mml:mrow><mml:mn>3.92</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">GABPA</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM104"><mml:mrow><mml:mn>1.57</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">51</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">DAF-12</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM105"><mml:mrow><mml:mn>1.41</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">56</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">MET31</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM106"><mml:mrow><mml:mn>1.56</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">62</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">RPN4</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM107"><mml:mrow><mml:mn>3.49</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">62</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">TYE7</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM108"><mml:mrow><mml:mn>1.43</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">70</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">PIF5</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM109"><mml:mrow><mml:mn>4.35</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">70</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">USF1</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM110"><mml:mrow><mml:mn>4.56</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">70</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr><tr><td rowspan="1" colspan="1">RDS1</td><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM111"><mml:mrow><mml:mn>3.37</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="char" char="." rowspan="1" colspan="1">71</td><td rowspan="1" colspan="1">A</td><td rowspan="1" colspan="1">A</td></tr></tbody></table><table-wrap-foot><fn id="btv017-TF2"><p>NRF1 is the ChIPed TF and the rest are the predicted cofactors. All motifs, which could be annotated at <italic>E</italic>-value <inline-formula><mml:math id="MM112"><mml:mo>≤</mml:mo></mml:math></inline-formula> 0.05 according to JASPAR, are shown with the <italic>E</italic>-values of TOMTOM (second column) and the ranking by RPMCMC (third column). The last two columns indicate the presence (P) or absence (A) of the motif in the outputs of Hegma and DREME, respectively.</p></fn></table-wrap-foot></table-wrap></p>
      <p><xref ref-type="fig" rid="btv017-F8">Figure 8</xref> summarizes the detection ability to discover diverse motifs based on a Venn diagram of all matching motifs produced from the analyses of the 228 datasets. The outputs of RPMCMC contained almost all of the outputs of DREME and Hegma, and, notably, 219 annotated cofactors were uniquely discovered by RPMCMC.
<fig id="btv017-F8" position="float"><label>Fig. 8.</label><caption><p>Venn diagram for total numbers of significantly annotated motifs over all the 228 datasets, reported by RPMCMC, Hegma and DREME</p></caption><graphic xlink:href="btv017f8p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 Concluding remarks</title>
    <p>In the motif discovery problem, the direct use of a Gibbs sampling method revealed an inability to find latent diverse motifs even in a fairly small number of input sequences. In the application for only 300 input sequences, all simulations with different initializations became trapped in the AT-rich motifs, which are of little significance in practice. This highlighted a critical drawback of the Gibbs sampling methods. The same is true for the EM algorithm. Because biological sequences generally contain rather diverse conserved patterns, which are sometimes biologically meaningless, the posterior distribution exhibits a very complex landscape as it includes many locally high probability regions. Our view is that solving this problem is the essence of improving the accuracy of motif discovery. Motivated by this, we presented a new motif discovery method called RPMCMC, which is a parallel variant of the widely used Gibbs motif samplers. The rather simple idea is to run the Gibbs motif samplers in parallel by making use of the repulsive force on different samplers. With all-at-once sampling, we could discover diverse motifs by which the parallel samplers divide their responsibility in the overall search region.</p>
    <p>As another contribution, we provided a list of predicted cofactor motifs that were overrepresented in the 228 ENCODE ChIP-seq datasets. RPMCMC can potentially mine promising annotated motifs which other word-count methods fail to find. To narrow down things to truly functional cofactor sets, it is necessary to conduct further validation experiments.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_10_1561__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv017_revised-supplementary.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgment</title>
    <p>We thank the ENCODE project consortium for making its data publicly available, specifically to the groups who provided the SYDH TFBS ChIP-seq datasets.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by a <funding-source>Grant-in-Aid for Scientific Research on Innovative Areas “Systems Cancer”</funding-source> (No. <award-id>4201</award-id>) of <funding-source>The Ministry of Education, Culture, Sports, Science, and Technology, Japan</funding-source>.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btv017-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>T.</given-names></name></person-group> (<year>2011</year>) <article-title>DREME: motif discovery in transcription factor ChIP-seq data</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1653</fpage>–<lpage>1659</lpage>.<pub-id pub-id-type="pmid">21543442</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B2">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>T.</given-names></name><name><surname>Elkan</surname><given-names>C.</given-names></name></person-group> (<year>1994</year>) <article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers</article-title>. In <conf-name>Proceedings of the Second International Conference on Intelligent Systems for Molecular Biology</conf-name>, pp. <fpage>28</fpage>–<lpage>36</lpage><comment>, AAAI Press, Menlo Park, California</comment>.</mixed-citation>
    </ref>
    <ref id="btv017-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>The value of position-specific priors in motif discovery using MEME</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>179</fpage>.<pub-id pub-id-type="pmid">20380693</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowles</surname><given-names>M.</given-names></name><name><surname>Carlin</surname><given-names>P.</given-names></name></person-group> (<year>1996</year>) <article-title>Markov chain Monte Carlo convergence diagnostics: a comparative review</article-title>. <source>J. Am. Stat. Assoc.</source>, <volume>91</volume>, <fpage>883</fpage>–<lpage>904</lpage>.</mixed-citation>
    </ref>
    <ref id="btv017-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>da Fonseca</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Efficient representation and P-value computation for high-order Markov motifs</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>i160</fpage>–<lpage>i166</lpage>.<pub-id pub-id-type="pmid">18689819</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goi</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Cell-type and transcription factor specific enrichment of transcriptional cofactor motifs in ENCODE ChIP-seq data</article-title>. <source>BMC Genomics</source>, <volume>14</volume>(<issue>Suppl. 5</issue>), <fpage>S2</fpage>.<pub-id pub-id-type="pmid">24564528</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>P.</given-names></name></person-group> (<year>1995</year>) <article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source>, <volume>82</volume>, <fpage>711</fpage>–<lpage>732</lpage>.</mixed-citation>
    </ref>
    <ref id="btv017-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>F.</given-names></name></person-group> (<year>1947</year>) <article-title>Pulse code communication</article-title>. <comment>U.S. Patent 2632058</comment>.</mixed-citation>
    </ref>
    <ref id="btv017-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2007</year>) <article-title>Quantifying similarity between motifs</article-title>. <source>Genome Biol.</source>, <volume>8</volume>, <fpage>R24</fpage>.<pub-id pub-id-type="pmid">17324271</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2000</year>) <article-title>Computational identification of cis-regulatory elements associated with groups of functionally related genes in <italic>Saccharomyces cerevisiae</italic></article-title>. <source>J. Mol. Biol.</source>, <volume>296</volume>, <fpage>1205</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">10698627</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ichonose</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Large-scale motif discovery using DNA Gray code and equiprobable oligomers</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>25</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">22057160</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>C.</given-names></name><etal/></person-group> (<year>1993</year>) <article-title>Detecting subtle sequence signals: a Gibbs sampling strategy for multiple alignment</article-title>. <source>Science</source>, <volume>262</volume>, <fpage>208</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">8211139</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neal</surname><given-names>R.</given-names></name></person-group> (<year>2003</year>) <article-title>Slice sampling</article-title>. <source>Ann. Stat.</source>, <volume>31</volume>, <fpage>705</fpage>–<lpage>767</lpage>.</mixed-citation>
    </ref>
    <ref id="btv017-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavesi</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2001</year>) <article-title>An algorithm for finding signals of unknown length in DNA sequences</article-title>. <source>Bioinformatics</source>, <volume>17</volume>, <fpage>S208</fpage>–<lpage>S214</lpage>.</mixed-citation>
    </ref>
    <ref id="btv017-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prasad</surname><given-names>S.</given-names></name><name><surname>Singh</surname><given-names>K.</given-names></name></person-group> (<year>2008</year>) <article-title>Interaction of USF1/USF2 and alpha-Pal/Nrf1 to Fmr-1 promoter increases in mouse brain during aging</article-title>. <source>Biochem. Biophys. Res. Commun.</source>, <volume>376</volume>, <fpage>347</fpage>–<lpage>351</lpage>.<pub-id pub-id-type="pmid">18782566</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radhakrishnan</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Transcription factor Nrf1 mediates the proteasome recovery pathway after proteasome inhibition in mammalian cells</article-title>. <source>Mol. Cell.</source>, <volume>38</volume>, <fpage>17</fpage>–<lpage>28</lpage>.<pub-id pub-id-type="pmid">20385086</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reid</surname><given-names>J.</given-names></name><name><surname>Wernisch</surname><given-names>L.</given-names></name></person-group> (<year>2011</year>) <article-title>STEME: efficient EM to find motifs in large data sets</article-title>. <source>Nucleic Acids Res.</source>, <volume>39</volume>, <fpage>e126</fpage>.<pub-id pub-id-type="pmid">21785132</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandelin</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>JASPAR: an open-access database for eukaryotic transcription factor binding profiles</article-title>. <source>Nucleic Acids Res.</source>, <volume>32</volume>(<issue>Database issue</issue>), <fpage>D91</fpage>–<lpage>D94</lpage>.<pub-id pub-id-type="pmid">14681366</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharov</surname><given-names>A.</given-names></name><name><surname>Ko</surname><given-names>M.</given-names></name></person-group> (<year>2009</year>) <article-title>Exhaustive search for over-represented DNA sequence motifs with CisFinder</article-title>. <source>DNA Res.</source>, <volume>16</volume>, <fpage>261</fpage>–<lpage>273</lpage>.<pub-id pub-id-type="pmid">19740934</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Mining ChIP-chip data for transcription factor and cofactor binding sites</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>403</fpage>–<lpage>412</lpage>.</mixed-citation>
    </ref>
    <ref id="btv017-B23">
      <mixed-citation publication-type="journal"><collab>The ENCODE Project Consortium</collab> (<year>2012</year>) <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>, <source>Nature</source>, <volume>489</volume><bold>,</bold>
<fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tompa</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Assessing computational tools for the discovery of transcription factor binding sites</article-title>. <source>Nat. Biotechnol.</source><italic>,</italic>
<volume>23</volume><bold>,</bold>
<fpage>137</fpage>–<lpage>144</lpage>.<pub-id pub-id-type="pmid">15637633</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>The CCAAT box-binding transcription factor NF-Y regulates basal expression of human proteasome genes</article-title>. <source>Biochim. Biophys. Acta.</source>, <volume>1823</volume><bold>,</bold>
<fpage>818</fpage>–<lpage>825</lpage>.<pub-id pub-id-type="pmid">22285817</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wingender</surname><given-names>E.</given-names></name><etal/></person-group> (<year>1995</year>) <article-title>TRANSFAC: a database on transcription factors and their DNA binding sites</article-title>. <source>Nucleic Acids Res.</source>, <volume>24</volume>, <fpage>238</fpage>–<lpage>241</lpage>.<pub-id pub-id-type="pmid">8594589</pub-id></mixed-citation>
    </ref>
    <ref id="btv017-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Workman</surname><given-names>C.</given-names></name><name><surname>Stormo</surname><given-names>G.</given-names></name></person-group> (<year>2000</year>) <article-title>ANN-Spec: a method for discovering transcription factor binding sites with improved specificity</article-title>. <source>Pac. Symp. Biocomput.</source>, <volume>5</volume>, <fpage>467</fpage>–<lpage>478</lpage>.<pub-id pub-id-type="pmid">10902194</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
