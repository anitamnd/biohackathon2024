<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1187873</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-179</article-id>
    <article-id pub-id-type="pmid">16026613</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-179</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Processing methods for differential analysis of LC/MS profile data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Katajamaa</surname>
          <given-names>Mikko</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mikko.katajamaa@btk.fi</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Orešič</surname>
          <given-names>Matej</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>matej.oresic@vtt.fi</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Turku Centre for Biotechnology, Tykistökatu 6, FIN-20521, Turku, Finland</aff>
    <aff id="I2"><label>2</label>VTT Biotechnology, Tietotie 2, P.O. Box 1500, FIN-02044 VTT, Espoo, Finland</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>7</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>179</fpage>
    <lpage>179</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/179"/>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2005</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2005 Katajamaa and Orešič; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2005</copyright-year>
      <copyright-holder>Katajamaa and Orešič; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Katajamaa
               Mikko
               
               mikko.katajamaa@btk.fi
            </dc:author><dc:title>
            Processing methods for differential analysis of LC/MS profile data
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 6(1): 179-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2005)6:1&#x0003c;179&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Liquid chromatography coupled to mass spectrometry (LC/MS) has been widely used in proteomics and metabolomics research. In this context, the technology has been increasingly used for differential profiling, i.e. broad screening of biomolecular components across multiple samples in order to elucidate the observed phenotypes and discover biomarkers. One of the major challenges in this domain remains development of better solutions for processing of LC/MS data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a software package <italic>MZmine </italic>that enables differential LC/MS analysis of metabolomics data. This software is a toolbox containing methods for all data processing stages preceding differential analysis: spectral filtering, peak detection, alignment and normalization. Specifically, we developed and implemented a new recursive peak search algorithm and a secondary peak picking method for improving already aligned results, as well as a normalization tool that uses multiple internal standards. Visualization tools enable comparative viewing of data across multiple samples. Peak lists can be exported into other data analysis programs. The toolbox has already been utilized in a wide range of applications. We demonstrate its utility on an example of metabolic profiling of <italic>Catharanthus roseus </italic>cell cultures.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The software is freely available under the GNU General Public License and it can be obtained from the project web page at: <ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Liquid chromatography coupled to mass spectrometry [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] (LC/MS) has been widely used in proteomics [<xref ref-type="bibr" rid="B3">3</xref>] and metabolomics [<xref ref-type="bibr" rid="B4">4</xref>] research. In this context, the technology has been increasingly utilized for differential profiling, i.e. broad screening of biomolecular components across multiple samples (corresponding to different conditions, interventions, or time points) in order to elucidate the observed phenotypes or discover biomarkers [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>Typical LC/MS experiments include several analytical stages, starting with sample pre-treatment which commonly includes sample cleanup and extraction methods. The sample can then be introduced to the LC column where the molecules separate based on their size (size exclusion chromatography), affinity to stationary phase (affinity chromatography), polarity (ion exchange chromatography), or hydrophobicity (reversed phase chromatography). The <italic>retention time </italic>measures the time between the sample injection and the appearance of the compound peak maximum after chromatographic separation. In analyses of complex mixtures, it is likely that many analytes elute at the same or similar time and individual compound peaks cannot be resolved by LC alone. Mass spectrometry (MS) can then be used to separate the co-elutants according to <italic>mass-to-charge ratio </italic>(m/z). The co-elutants enter the LC-MS interface where they are ionized and introduced into the mass spectrometer where m/z is measured. Several ionization methods exist, among the most commonly used are the soft ionization methods such as electrospray ionization (ESI) and atmospheric pressure – chemical ionization (APCI). The principles of mass detection can also vary, with the most common instruments being triple quadrupole, (quadrupole) ion trap, (quadrupole) time of flight mass spectrometers [<xref ref-type="bibr" rid="B2">2</xref>]. While discussion of the merits of each type of chromatography, ion source, and mass detector are beyond the scope of this paper, it is evident that many different types of applications can be developed with LC/MS. Due to such variety of possible applications and approaches it is also challenging to develop a generic solution for processing and analysis of LC/MS data. Additionally, the commercial software solutions provided by instrument vendors are limited to the instruments provided by the vendors. Although this may change in the future by adoption of mzData [<xref ref-type="bibr" rid="B7">7</xref>] data representation format, mzData does not represent the raw data and as such may have its limitations.</p>
    <p>One increasingly utilized type of LC/MS application is differential profiling, where the extraction, LC methods, and MS instrument setup are set to provide a broad coverage of compounds, with the main aim to enable relative quantitative comparisons for individual compounds across multiple samples. The applications of such approach can be found in domains of systems biology, functional genomics, and biomarker discovery. While such approaches cannot match targeted analytical measurements in ability to accurately quantitate individual analytes, it is the role of data processing methods to enable comparative studies of analytes, even if they may be unknown [<xref ref-type="bibr" rid="B5">5</xref>]. The data processing for differential profiling usually proceeds through several stages. <italic>Spectral filtering </italic>stage aims at reducing the complexity of spectra and removing the noise. <italic>Peak detection </italic>finds the peaks corresponding to the compounds or fragments thereof. <italic>Alignment</italic>, data processing step specific to profiling experiments, aims at matching the corresponding peaks across multiple sample runs. The role of <italic>normalization </italic>is then to reduce the systematic error by adjusting the intensities within each sample run.</p>
    <p>Few integrated solutions for differential analysis of LC/MS data have already been introduced for proteomics and metabolomics applications. MarkerLynx, the commercial package from Waters, Inc. is an add-on to MassLynx (Waters, Inc.) software. IMPRESS and WINLIN software packages (TNO Pharma, The Netherlands) perform the smoothing on each mass trace separately, followed by entropy based method to filter the traces [<xref ref-type="bibr" rid="B8">8</xref>]. The alignment is then performed using the partial linear fit method initially developed for aligning NMR spectra [<xref ref-type="bibr" rid="B9">9</xref>]. Proprietary MassView software [<xref ref-type="bibr" rid="B10">10</xref>] and a toolkit by Radulovic et al. [<xref ref-type="bibr" rid="B11">11</xref>] were developed upon the similar principles for proteomics applications, while approaching the peak detection in 2 dimensions (retention time and m/z). The Bioinformatics Toolbox in Matlab (Mathworks, Inc.) contains capabilities for preprocessing of mass spectra which can be utilized on MS data analysis applications of low memory and performance demand.</p>
    <p>One of the challenges in algorithm and application development in domain of LC/MS data processing is that a solution for a particular stage of processing is of limited use if it is not embedded into the full data processing pipeline. Therefore, an integrated LC/MS software environment enabling easy integration of new methods would benefit both the algorithm developers and the end users. In this paper we report development of tools for differential profiling of LC/MS data, aiming primarily at metabolomics applications, as well as a new platform independent open source software package <italic>MZmine </italic>built to integrate these tools. We demonstrate its utility on an example of metabolic profiling of <italic>Catharanthus roseus </italic>cell cultures.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p><italic>MZmine </italic>is a collection of methods for data processing stages used in differential profiling of LC/MS data. Scope of the software is limited to data processing, and therefore other tools should be used for statistical analyses following the initial data processing.</p>
    <sec>
      <title>Software design of the toolbox</title>
      <p>Main goals in the design of the software have been good usability and expandability with new data processing methods. To facilitate good usability, we have developed a graphical user interface shown in Figure <xref ref-type="fig" rid="F1">1</xref>. The GUI allows user to experiment with different combinations of the data processing methods and parameter values for each of the steps and visually check quality of intermediate results. Some experimenting and visual validation is often required to find the best methods and parameter values for a new set of data.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><italic>MZmine </italic>graphical user interface: (A) List of imported raw data files. (B) Total ion chromatogram (TIC) for selected file. (C) Mass spectrum for selected retention time for the same file. (D) Peak list for the same file, with listed m/z values, retention times, and intensities. (E) 2d map of the same file, with retention time on x-axis and m/z on y-axis. (F) Zoomed-in spectra for a different file. (G) Peak alignment matrix for all files listed. (H) Available alignment results, e.g. for different normalizations. The spectra shown in the GUI are from lipidomic profiling of mouse white adipose tissue using Quattro Micro (Waters, Inc.) triple quadrupole mass spectrometer.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-1"/>
      </fig>
      <p>The toolbox is implemented as a stand-alone Java application. While using Java language means only slight performance degradation compared to C++ [<xref ref-type="bibr" rid="B12">12</xref>], it affords platform independence. The class model for the software contains interfaces for each of the data processing stages, and new data processing methods can be added to the toolbox by implementing a suitable interface.</p>
    </sec>
    <sec>
      <title>Input data formats and conversion</title>
      <p>The toolbox accepts input in NetCDF format. In order to implement the support for NetCDF files in the toolbox, we used NetCDF Java Library (Version 2) by Unidata community [<xref ref-type="bibr" rid="B13">13</xref>]. Most of the mass spectrometer vendors provide converters for translating raw data files from their proprietary format to this common presentation. We have tested the toolbox with NetCDF metabolomics or protein tryptic digest data created from the following instruments: Quattro Micro (Waters), QTof Premier (Waters), QSTAR Pulsar (Applied Biosystems), LTQ-FTMS (Thermo Finnigan), and LCQ (Thermo Finnigan). In the future, toolbox will also include support for upcoming new mass spectrometry data formats such as mzData [<xref ref-type="bibr" rid="B7">7</xref>] and mzXML [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      <p>Since raw LC/MS data files can be large relative to the available main memory, the core classes for representing raw data do not load all spectra into memory at once, but retrieve necessary parts from disk when requested. This makes it possible to visualise and work with several large raw data files at the same time.</p>
    </sec>
    <sec>
      <title>Smoothing and peak detection</title>
      <p>Smoothing aims to remove noise in the measured spectra, which facilitates further peak detection. Smoothing is an optional stage in data processing and can also be left out if the data is not noisy or if the input data is already available as centroids. For smoothing the spectra, toolbox offers implementations of a moving average filter and Savitzky-Golay filter.</p>
      <p>After smoothing, peak detection is done to find the peaks in the measurement data. The toolbox contains two peak picking methods: local maximum method and recursive threshold method. Both of these methods work in similar steps, which are shown as a listing:</p>
      <p>calc eXtracted Ion Chromatograms (XICs) for m/z bins</p>
      <p><bold>for </bold>each spectrum</p>
      <p>   find peaks in spectrum</p>
      <p>   filter out spectral peaks with the lowest intensities</p>
      <p>   connect new spectral peaks with previous ones</p>
      <p>end</p>
      <p>filter out too long and too short 2D-peaks</p>
      <p>The extracted ion chromatogram (XIC) is a curve showing time vs. sum of intensities over a small m/z range. Only row in the listing where the two available peak detection methods differ is the step for finding one-dimensional <italic>spectral peaks</italic>, i.e. peaks found in mass spectra of each instrument scan. Local maximum method treats every local intensity maximum along the spectrum as a spectral peak, while recursive threshold method requires maximum to have a user-definable width that differentiates it from sharper noise peaks. Spectral peaks are filtered in both chromatographic and m/z directions to remove those with weakest intensities. To speed-up chromatographic filtering, a set of XICs is precalculated for m/z bins of user-definable width before looping through spectra. Chromatographic filtering is then done inside the loop by comparing spectral peak's intensity to intensities of a XIC curve that goes through the location of spectral peak.</p>
      <p>During the loop through the spectra, one dimensional spectral peaks of current spectrum are connected with spectral peaks of the spectrum from the previous scan to form two-dimensional strings of spectral peaks. Joining occurs only between the peaks in successive spectra that have similar m/z values according to pre-set threshold, and form together a good shaped peak in the chromatographic direction. Figure <xref ref-type="fig" rid="F2">2</xref> shows a simple example of the two-step process: first finding spectral peaks and then connecting them.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p>The two-step peak picking process used by the two available peak picking methods: (A) This plot is a zoom-in to a small part of a spectrum. In the first step, one-dimensional spectral peaks are detected in each spectrum alone. Green dots over the spectrum show the locations of detected spectral peaks. (B) This plot is a zoom-in to a small fragment of two-dimensional view of raw data. Black lines show two-dimensional peaks created by connecting successive spectral peaks. Peak height is calculated as the highest intensity among these data points, while the peak area corresponds to the sum of the intensities.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-2"/>
      </fig>
      <p>Choice of methods for smoothing and peak detection depends on the nature of input data. If data is already pre-processed and centroided, smoothing is not needed and the peak picking method based on searching for local maximums works the best. When working with spectral data acquired in continuous mode, recursive threshold peak picker gives better results.</p>
      <p>Peak picking gives two measures for the size of the peak: <italic>peak height </italic>is defined as the maximum intensity of all datapoints forming the peak and <italic>peak area </italic>is measured as sum over intensities of all datapoints. It is user-selectable which of these two quantities is used in the further processing stages. Following peak detection, each LC/MS run <italic>s</italic>(<italic>s </italic>= 1...<italic>S</italic>) is represented by a <italic>peak list</italic>:</p>
      <p><bold>P</bold><sub><italic>s </italic></sub>= {<italic>p</italic><sub><italic>isc</italic></sub>}; with <italic>i </italic>= 1...<italic>N</italic><sub><italic>s </italic></sub>and <italic>c </italic>= {<italic>mz</italic>, <italic>δmz</italic>, <italic>rt</italic>, <italic>δrt</italic>, <italic>height</italic>, <italic>area</italic>};,     (1)</p>
      <p>where <italic>N</italic><sub><italic>s </italic></sub>is a total number of peaks for run <italic>s </italic>and <italic>c </italic>is an index for parameters of each peak <italic>p</italic><sub><italic>is </italic></sub>: <italic>mz </italic>is the mean m/z value for data points within the peak, <italic>δmz </italic>is standard deviation of m/z values within the peak, <italic>rt </italic>is retention time at the maximum intensity datapoint, <italic>δrt </italic>is the lengths of the peak in time, <italic>height </italic>is height of the peak and <italic>area </italic>is area of the peak calculated as described above.</p>
    </sec>
    <sec>
      <title>Alignment</title>
      <p>Alignment methods search for corresponding peaks across different LC/MS runs. Peaks from the same compound match usually closely in m/z values, but there can be variation in retention times between the runs. The former depends on mass accuracy and resolution of the mass spectrometer while the latter largely depends on the analytical method used.</p>
      <p>The results of alignment are represented by a <italic>master peak list</italic>:</p>
      <p><italic>Q </italic>= {<italic>q</italic><sub><italic>jsc</italic></sub>}; with <italic>j </italic>= 1...<italic>N</italic><sub><italic>peaks</italic></sub>, <italic>s </italic>= 1...<italic>S </italic>and <italic>c </italic>= {<italic>mz</italic>, <italic>δmz</italic>, <italic>rt</italic>, <italic>δrt</italic>, <italic>height</italic>, <italic>area</italic>};,     (2)</p>
      <p>where <italic>N</italic><sub><italic>peaks </italic></sub>is the number of rows in the master peak list matrix. Element <italic>q</italic><sub><italic>js </italic></sub>is set to empty value when no peak from the peak list <italic>s </italic>has been aligned to row <italic>j </italic>of master peak list.</p>
      <p>The toolbox currently implements a simple alignment method utilizing the master peak list. This method takes one peak from a peak list at a time and aligns the peak to either the best matching existing row of the master peak list or appends a new row to the master peak list, if matching row is not found for the peak. The alignment process is described in the pseudocode:</p>
      <p><bold>for </bold><italic>s </italic>= <italic>1</italic>...<italic>S</italic></p>
      <p>   <bold>for </bold><italic>i </italic>= <italic>1</italic>...<italic>N</italic><sub><italic>s</italic></sub></p>
      <p>      alignToMaster(<italic>p</italic><sub><italic>is</italic></sub>)</p>
      <p>   <bold>end</bold></p>
      <p>end</p>
      <p><bold>function </bold>alignToMaster(<italic>p</italic><sub><italic>is</italic></sub>)</p>
      <p>   pick <italic>j </italic>such that</p>
      <p>      <italic>q</italic><sub><italic>js </italic></sub>does not contain <italic>p</italic>' <sub><italic>i</italic>' <italic>s </italic></sub>with <italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic>'<sub><italic>i</italic>'<italic>s</italic></sub><italic>) </italic>&lt;=<italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>) </italic><bold>and</bold></p>
      <p>      minimizes <italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>)</italic></p>
      <p>   <bold>if </bold>(<italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>)</italic>&gt;user-defined threshold) <bold>or </bold>(could not pick <italic>j)</italic></p>
      <p>      append <italic>p</italic><sub><italic>is </italic></sub>to a new, empty row of <italic>Q</italic></p>
      <p>   <bold>else</bold></p>
      <p>      <bold>if </bold><italic>q</italic><sub><italic>js </italic></sub>contains <italic>p'</italic><sub><italic>i</italic>'<italic>s</italic></sub></p>
      <p>         assign <italic>q</italic><sub><italic>js </italic></sub>:= <italic>p</italic><sub><italic>is</italic></sub></p>
      <p>         alignToMaster(<italic>p'</italic><sub><italic>i</italic>'<italic>s</italic></sub>)</p>
      <p>      <bold>else</bold></p>
      <p>         assign <italic>q</italic><sub><italic>js </italic></sub>:= <italic>p</italic><sub><italic>is</italic></sub></p>
      <p>      <bold>end</bold></p>
      <p>   <bold>end</bold></p>
      <p>end</p>
      <p>where the distance between a peak p<sub><italic>is </italic></sub>and a master peak list row Q<sub><italic>j </italic></sub>is calculated using function:</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i1.gif"/>
      </p>
      <p>where <italic>p</italic><sub><italic>i,s ,mz </italic></sub>and <italic>p</italic><sub><italic>i,s ,rt </italic></sub>are the m/z ratio and retention time of a peak in an individual peak list and <inline-graphic xlink:href="1471-2105-6-179-i2.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i3.gif"/> are the average m/z ratio and retention time of peaks from all peak lists except <italic>s </italic>assigned to the same row <italic>Q</italic><sub><italic>j </italic></sub>of the master peak list. <italic>k </italic>is an adjustable parameter that controls the balance between accuracy of m/z ratio and retention time values. Generally, <italic>k </italic>can be set to a larger number with increased mass accuracy and resolution of the mass detector.</p>
      <p>After aligning peak lists as described above, it is likely that master peak list contains empty gaps, because not every peak is detected and aligned in every sample. Such missing values often complicate further statistical analyses, and for this reason we developed a secondary peak picking method for filling these gaps. This method uses <inline-graphic xlink:href="1471-2105-6-179-i2.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i3.gif"/> values for estimating location where a missing peak should be found. Search is then conducted to find the highest local maximum over a range around the expected location in the raw measurement signal. The size of the search range is a user-definable parameter in the gap-filling method. Intensity of the local maximum is then used as estimated peak height.</p>
    </sec>
    <sec>
      <title>Normalization methods</title>
      <p>Normalization is needed to reduce the systematic error in data. The toolbox implements two different approaches: a set of linear normalization methods and a new approach that utilizes multiple internal standard compounds injected to the samples.</p>
      <p>Linear normalization methods divide all peak heights within a single peak list by the same number. Implementation of linear normalization method in the toolbox offers four different ways to calculate the normalization factor: average peak height, average squared peak height, maximum peak height and total raw signal.</p>
      <p>The toolbox also contains a new normalization method that utilizes information from multiple standard compounds, which are injected to each of the samples in known concentrations prior to LC/MS analysis. The standard compound peaks can be used to calculate a set of normalization factors, one for each standard compound. There are currently two different ways to use this information in normalization. One option is to search for a standard compound peak closest to the peak. The distance function is same as (3). A variation of this method is the method based on normalization using weighted contribution of each standard compound. In this method, the same distance metric as above (3) is used to calculate distance of a peak to each standard compound. Contribution of each standard to the final normalization factor is weighted using the inverse of distance between the peak and the standard.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i4.gif"/>
      </p>
      <p>where <italic>m </italic>is the number of injected standard compounds, <italic>nf</italic><sub><italic>l </italic></sub>is the normalization factor calculated using <italic>l</italic>th standard compound and <italic>dist</italic>(<italic>p</italic>, <italic>IS</italic><sub><italic>l</italic></sub>) is the distance between peak to be normalized and peak of the <italic>l</italic>th standard compound. Both methods reduce to the common single-standard calibration when <italic>m </italic>= 1, i.e. only a single internal standard is used.</p>
    </sec>
    <sec>
      <title>Visualization methods</title>
      <p>After processing, data is ready to be exported from the toolbox as a tab-delimited peak height and area matrix. This matrix can be then further processed with packages such as Matlab (MathWorks, Inc.) or R Statistical Language which already have a large collection of data analysis tools available for statistical analyses of multivariate data.</p>
      <p>The toolbox also contains two visualization methods for quickly previewing the processed results. Both of these methods plot the peaks to a two-dimensional plot where x-axis is the retention time and y-axis m/z ratio. Logratio plot is useful for displaying differences in peak heights between two groups of samples (Figure <xref ref-type="fig" rid="F3">3</xref>). Differences are measured using logratio value, which compares average peak heights in two selected groups:</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p>(A) Total ion chromatograms from two representative samples from <italic>Catharanthus roseus </italic>cell cultures. (B) Log-ratio plot view, comparing mean intensities of detected peaks between two selected groups of samples from <italic>Catharanthus roseus </italic>(10 elicited vs. 10 controls).</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-3"/>
      </fig>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i5.gif"/>
      </p>
      <p>where <inline-graphic xlink:href="1471-2105-6-179-i6.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i7.gif"/> are average heights of peak p<sub><italic>i</italic>, •, • </sub>in the first and second group of peak lists, respectively. In the logratio plot color coding is used for visualizing the logratio values: red shades for positive logratio values and green shades for negative logratio values.</p>
      <p>Another visualization method is a coefficient of variation plot, which displays variation of peak heights within one group of samples:</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i8.gif"/>
      </p>
      <p>where <inline-graphic xlink:href="1471-2105-6-179-i9.gif"/> is the average peak height and <italic>σ</italic>(<italic>p</italic><sub><italic>i </italic>,{<italic>s</italic>}, <italic>height</italic></sub>) is the standard deviation of peak heights in the selected group of samples {<italic>s</italic>}. The coefficient of variation plot is drawn similarly as the logratio plot, but color coding is used for displaying the coefficient of variation for peak heights within a selected group of samples.</p>
      <p>These visualization methods are particularly useful for quality control, because in the toolbox environment it is easy to go back to raw data and visually verify the findings.</p>
    </sec>
  </sec>
  <sec>
    <title>Example: Metabolic profiling of plant secondary compounds in <italic>Catharanthus roseus</italic></title>
    <p>Studies of plant metabolites are a demanding area since plants produce large number of metabolites of high chemical diversity, many of which are unknown [<xref ref-type="bibr" rid="B15">15</xref>]. Plant secondary metabolites are produced as responses to changes in the environmental conditions. The biosynthetic pathways of secondary metabolites are largely unknown, and discovery driven 'omics' approaches promise to enhance our knowledge in this domain [<xref ref-type="bibr" rid="B16">16</xref>]. In order to illustrate the utility of the <italic>MZmine </italic>toolbox, we demonstrate it on metabolic profiling of cell cultures of the medicinal plant <italic>Catharanthus roseus</italic>. This plant has been extensively studied due to the presence of terpenoid indole alkaloids (TIA), several of which are in high demand for pharmaceutical use [<xref ref-type="bibr" rid="B17">17</xref>]. We focused on fraction containing most important secondary metabolites leading to TIA [see <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>]. We profiled 20 samples, of which 10 were control strains and 10 were elicited strains. Elicitation induces the stress response and can therefore lead to production of secondary metabolites. The replicates are the same strain in parallel cultures corresponding to the same time point, so they can be considered as biological replicates. We also injected an internal standard compound vincamine (PubChem SID 390304).</p>
    <p>Using <italic>MZmine </italic>toolbox with moving average filter (m/z = 0.3 window setting), recursive threshold peak detection (default settings), alignment (100s tolerance in retention time, otherwise default settings), gap-filling (60s tolerance in retention time), and normalization by total raw signal, we detected 2175 peaks. Representative total ion chromatograms from one elicited and one control sample are shown in Figure <xref ref-type="fig" rid="F3">3A</xref>. The log-ratio view for top 20% most intense peaks is shown in Figure <xref ref-type="fig" rid="F3">3B</xref>.</p>
    <p>After exporting the processed data in tabular format, further analyses of the data matrix were performed in Matlab using PLS Toolbox (Eigenvector Research, Inc.) and with R Statistical Language. Principal components analysis [<xref ref-type="bibr" rid="B18">18</xref>] revealed clear differences between the elicited and control groups (Figure <xref ref-type="fig" rid="F4">4A</xref>). Using factor analysis (not shown), we found that the two of the main contributors to the clustering of the elicited group were ajmalicine (PubChem SID 153462) and tabersonine (PubChem SID 163306). The compounds were identified using our internal spectral library based on molecular weight and retention time. Their distribution within the elicited and control groups shows the compounds are significantly upregulated after elicitation (Figure <xref ref-type="fig" rid="F4">4B</xref>). Our findings are in line with recent report using the targeted approach [<xref ref-type="bibr" rid="B19">19</xref>].</p>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p>Data analysis of <italic>Catharanthus roseus </italic>metabolite profile data, using the 2175 detected peaks as variables. (A) Principal components analysis shows differences between the elicited and control strains. Subsequent factor analysis revealed the clustering of the elicited group is largely due to the tabersonine and ajmalicine. (B) Comparison of intensity distribution between elicited and control groups for internal standard (Vincamine), Ajmalicine, and Tabersonine.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-179-4"/>
    </fig>
  </sec>
  <sec>
    <title>Discussion</title>
    <sec>
      <title>System requirements and performance</title>
      <p><italic>MZmine </italic>is available under the GNU General Public License [see <xref ref-type="supplementary-material" rid="S2">Additional file 2</xref>]. The toolbox needs Java Runtime Environment 5.0 or later (Sun Microsystems, Inc.) installed on the computer. Minimum system requirements for running the software are 2.4 GHz processor and 1 GB of memory. Also a high-resolution display mode or a dual monitor configuration is necessary for taking full advantage of the graphical user interface. As a reference, the total time from loading 50 NetCDF files (unprocessed continuous MS data acquired in full scan mode on Quattro Micro instrument) of size 100 Mbytes each to the export as a data matrix of approximately 10000 peaks took 40 minutes on a Dell Precision 650 workstation (Intel Xeon 3.06 GHz processor with 2 GB RAM), which is significantly less than the time of actual data acquisition by the LC/MS system (40 hours). The major performance bottleneck is the gap filling stage. Since many of the stages of the data processing can easily be parallelized, significant performance improvement could be gained by distributed computing. Future implementations of the software will include this capacity.</p>
      <p>The software settings largely depend on the type of application, analytical method and instrument used for data collection. As part of the application development, it is advisable to experiment with different settings to optimize the performance.</p>
    </sec>
    <sec>
      <title>Methods and applications</title>
      <p>So far the <italic>MZmine </italic>has been primarily utilized in the domain of metabolomics, which included lipidomics and global metabolomics applications in biomedical domain, primary metabolite screening in microbes, and plant metabolomics. Specifically, the early prototype version of <italic>MZmine </italic>has been applied to lipidomic analyses in a recent study of PPARγ2 knock-out mouse model [<xref ref-type="bibr" rid="B20">20</xref>].</p>
      <p>The methods currently available in the toolbox have been found sufficient in these applications. However, we will further focus especially on peak picking methods in the future, since this stage is the most crucial part of the data processing. In order to study the metabolic profiles with as many compounds as possible, every real peak should be found from raw LC/MS data files. On the other hand, false-positive peak detections complicate the statistical analyses and may prevent some interesting results to be found. In addition to these two issues, every single peak should be detected as exactly as possible in both m/z and retention time direction. This is necessary for determining peak area and height correctly, for successful alignment between samples, and for identification.</p>
      <p>Currently it is difficult to perform comprehensive comparison of available methods for differential profiling of LC/MS data, since most of the methods are either proprietary or vendor-specific. However, repeatability studies on biological tissues have shown that the median CV is in the range of 18–23%, depending on normalization method (data not shown). This is consistent with published results [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. The results on mixtures of internal standards were better, with CV &lt;5%. The discrepancy in CV values is due to peak picking in complex biological mixtures, where many compounds are at the trace levels near the detection limit. This reaffirmed our belief that the stage of peak picking is the critical step in profiling of biological samples.</p>
      <p>While the term quantitative analysis has recently been used to describe the methods of differential profiling [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>], we believe true quantitative analysis would also require calculation of compound concentrations. None of the profiling toolboxes introduced so far have this ability. While ideally one would use isotope labelled standard and measure calibration curve for each compound, this is in practice impossible for complex biological mixtures where the compounds are of diverse chemical properties and many of them unknown. We believe our normalization method based on multiple internal standards is a step toward the ability to quantitate the compounds in the biological samples.</p>
    </sec>
    <sec>
      <title>Current and future developments</title>
      <p>We are currently developing a version enabling distributed computing and implementing a method for detection of natural isotope patterns. We are also going to extend the data import capability to mzXML and mzData formats and enable database connectivity.</p>
      <p>On the algorithm side, in addition to improved peak picking, we are implementing two normalization methods, one based on multiplicative error model [<xref ref-type="bibr" rid="B6">6</xref>], and an enhanced version of multiple-standard method which takes into account information from compound identification. The initial application of the latter method will be developed for the lipid screening. One of the future goals is to enable automated handling of multiple spectra coming from single sample (i.e. MS and MS/MS or ESI+/MS and ESI-/MS). The latter, combined with database connectivity, will open the possibilities of automated identification of metabolites, as well as enable development of proteomics profiling applications utilizing <italic>MZmine</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We developed a platform independent software package for processing of LC/MS profile data. The software has already been tested and applied on a wide range of instruments and applications in domain metabolomics. Given its modular structure, the <italic>MZmine </italic>promises to be a powerful tool and test bench for development of new LC/MS data processing algorithms.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>• <bold>Project name: </bold><italic>MZmine </italic>LC/MS Toolbox</p>
    <p>• <bold>Project home page: </bold><ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/></p>
    <p>• <bold>Operating system(s): </bold>Platform independent</p>
    <p>• <bold>Programming language: </bold>Java</p>
    <p>• <bold>Other requirements: </bold>Java Runtime Environment (JRE) 5.0 or higher</p>
    <p>• <bold>Licence: </bold>GNU General Public License</p>
  </sec>
  <sec>
    <title>List of abbreviations</title>
    <p>MS: Mass spectrometry</p>
    <p>XIC: Extracted ion chromatogram</p>
    <p>TIC: Total ion chromatogram</p>
    <p>LC/MS: Liquid chromatography – mass spectrometry</p>
    <p>ESI(+/-): (Positive/negative) Electrospray ionization</p>
    <p>APCI: Atmospheric pressure chemical ionization</p>
    <p>QTof: Quadrupole – time of flight mass spectrometer</p>
    <p>FTMS: Fourier transform mass spectrometer</p>
    <p>CV: Coefficient of variance</p>
    <p>m/z: Mass-to-charge ratio (m is molecular weight and z is charge of the ion)</p>
    <p>GUI: Graphical user interface</p>
    <p>API: Application programming interface</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MK developed the software for the LC/MS Toolbox, developed the new algorithms for peak detection and alignment, normalization, and drafted the manuscript. MO initiated and supervised the study, designed the software toolbox and the experiment described in the paper and drafted the manuscript. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>Experimental methods for profiling Catharanthus roseus cell cultures. The file includes description of analytical methods for profiling of <italic>Catharanthus roseus </italic>cell cultures, which were used to demonstrate the utility of <italic>MZmine</italic>.</p>
      </caption>
      <media xlink:href="1471-2105-6-179-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p>MZmine Toolbox source code (version 0.42). The file includes the source code and license information of the MZmine Toolbox.</p>
      </caption>
      <media xlink:href="1471-2105-6-179-S2.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>MK was funded by Academy of Finland SysBio Research Programme. MO's research was in part funded by Marie Curie International Reintegration Grant. We thank to Tuulikki-Seppänen Laakso for performing the LC/MS analyses used in this paper and to Heiko Rischer and Kirsi-Marja Oksman-Caldentey for providing the <italic>C. roseus </italic>material.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ardrey</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <source>Liquid chromatography - mass spectrometry: An introduction</source>
        <year>2003</year>
        <publisher-name>, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>de Hoffmann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stroobant</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Mass spectrometry: Principles and applications</source>
        <year>2001</year>
        <edition>2.</edition>
        <publisher-name>, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Proteomics: the first decade and beyond</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>33</volume>
        <fpage>311</fpage>
        <lpage>323</lpage>
        <pub-id pub-id-type="pmid">12610541</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1106</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodacre</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vaidyanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Harrigan</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics by numbers: acquiring and understanding global metabolite data</article-title>
        <source>Trends Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>245</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="pmid">15109811</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2004.03.007</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>van der Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>van der Heijden</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marple</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Harrigan GG and Goodacre R</surname>
          </name>
        </person-group>
        <article-title>The role of metabolomics in systems biology: A new vision for drug discovery and development</article-title>
        <source>Metabolic profiling: Its role in biomarker discovery and gene function analysis</source>
        <year>2003</year>
        <publisher-name>Boston, Mass., Kluwer Academic Publishers</publisher-name>
        <fpage>171</fpage>
        <lpage>198</lpage>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Havekes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Plasterer</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Phenotype characterization using integrated gene transcript, protein and metabolite profiling</article-title>
        <source>Appl Bioinformatics</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">15702951</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Organization</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>mzData</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://psidev.sourceforge.net/ms/#mzdata"/>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davidov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meys</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stochaj</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lavine</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Londo</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marple</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Plasterer</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Havekes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Methods for the differential integrative omic analysis of plasma from a transgenic disease animal model</article-title>
        <source>OMICS A Journal of Integrative Biology</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>267</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="pmid">15703476</pub-id>
        <pub-id pub-id-type="doi">10.1089/omi.2004.8.267</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Tas</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Venekamp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Partial linear fit : a new NMR spectroscopy preprocessing tool for pattern recognition applications</article-title>
        <source>J Chemometrics</source>
        <year>1996</year>
        <volume>10</volume>
        <fpage>425</fpage>
        <lpage>438</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-128X(199609)10:5/6&lt;425::AID-CEM442&gt;3.0.CO;2-S</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shaler</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Norton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anderle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Quantification of proteins and metabolites by mass spectrometry without isotopic labeling or spiked standards</article-title>
        <source>Anal Chem</source>
        <year>2003</year>
        <volume>75</volume>
        <fpage>4818 </fpage>
        <lpage>44826</lpage>
        <pub-id pub-id-type="pmid">14674459</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac026468x</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Radulovic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jelveh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Foss</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Emili</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Informatics platform for global proteomic profiling and biomarker discovery using liquid chromatography-tandem mass spectrometry</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>984</fpage>
        <lpage>997</lpage>
        <pub-id pub-id-type="pmid">15269249</pub-id>
        <pub-id pub-id-type="doi">10.1074/mcp.M400061-MCP200</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Performance of Java versus C++</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.idiom.com/~zilla/Computer/javaCbenchmark.html"/>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="other">
        <article-title>UniData NetCDF</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://my.unidata.ucar.edu/content/software/netcdf/index.html"/>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedrioli</surname>
            <given-names>PGA</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Hubley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vogelzang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Raught</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Angeletti</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Hermjakob</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Julian</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Kapp</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McComb</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Omenn</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Paton</surname>
            <given-names>NW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A common open representation of mass spectrometry data and its application to proteomics research</article-title>
        <source>Nat Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>1459</fpage>
        <lpage>1466</lpage>
        <pub-id pub-id-type="pmid">15529173</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt1031</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics - the link between genotyopes and phenotypes</article-title>
        <source>Plant Molecular Biology</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="pmid">11860207</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oksman-Caldentey</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Inze</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Plant cell factories in the post-genomic era: new ways to produce designer secondary metabolites</article-title>
        <source>Trends Plant Sci</source>
        <year>2004</year>
        <volume>9</volume>
        <fpage>433</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="pmid">15337493</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tplants.2004.07.006</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rischer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Oksman-Caldentey</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Saito K, Willmitzer L and Dixon D</surname>
          </name>
        </person-group>
        <article-title>Metabolomics of plant secondary compounds: profiling of Catharanthus cell cultures</article-title>
        <source>Plant metabolomics</source>
        <series>Biotechnology in Agriculture and Forrestry</series>
        <year>2005</year>
        <publisher-name>Heidelberg, Springer Verlag, in press</publisher-name>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jackson</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <source>User's guide to principal components</source>
        <year>1991</year>
        <publisher-name>New York, NY, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee-Parsons</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Ertürk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tengtrakool</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Enhancement of ajmalicine production in Catharanthus roseus cell cultures with methyl jasmonate is dependent on timing and dosage of elicitation</article-title>
        <source>Biotechnol Lett</source>
        <year>2004</year>
        <volume>26</volume>
        <fpage>1595</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">15604804</pub-id>
        <pub-id pub-id-type="doi">10.1023/B:BILE.0000045825.37395.94</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medina-Gomez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Virtue</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lelliott</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boiani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Christodoulides</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perrin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jimenez-Linan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blount</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thresher</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colledge</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Kettunen</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Seppanen-Laakso</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sethi</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>O'Rahilly</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brindle</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cinti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burcelin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vidal-Puig</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The link between nutritional status and insulin sensitivity is dependent on the adipocyte-specific Peroxisome Proliferator-Activated Receptor-{gamma}2 isoform</article-title>
        <source>Diabetes</source>
        <year>2005</year>
        <volume>54</volume>
        <fpage>1706</fpage>
        <lpage>1716</lpage>
        <pub-id pub-id-type="pmid">15919792</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1187873</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-179</article-id>
    <article-id pub-id-type="pmid">16026613</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-179</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Processing methods for differential analysis of LC/MS profile data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Katajamaa</surname>
          <given-names>Mikko</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mikko.katajamaa@btk.fi</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Orešič</surname>
          <given-names>Matej</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>matej.oresic@vtt.fi</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Turku Centre for Biotechnology, Tykistökatu 6, FIN-20521, Turku, Finland</aff>
    <aff id="I2"><label>2</label>VTT Biotechnology, Tietotie 2, P.O. Box 1500, FIN-02044 VTT, Espoo, Finland</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>7</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>179</fpage>
    <lpage>179</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/179"/>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2005</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2005 Katajamaa and Orešič; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2005</copyright-year>
      <copyright-holder>Katajamaa and Orešič; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Katajamaa
               Mikko
               
               mikko.katajamaa@btk.fi
            </dc:author><dc:title>
            Processing methods for differential analysis of LC/MS profile data
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 6(1): 179-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2005)6:1&#x0003c;179&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Liquid chromatography coupled to mass spectrometry (LC/MS) has been widely used in proteomics and metabolomics research. In this context, the technology has been increasingly used for differential profiling, i.e. broad screening of biomolecular components across multiple samples in order to elucidate the observed phenotypes and discover biomarkers. One of the major challenges in this domain remains development of better solutions for processing of LC/MS data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a software package <italic>MZmine </italic>that enables differential LC/MS analysis of metabolomics data. This software is a toolbox containing methods for all data processing stages preceding differential analysis: spectral filtering, peak detection, alignment and normalization. Specifically, we developed and implemented a new recursive peak search algorithm and a secondary peak picking method for improving already aligned results, as well as a normalization tool that uses multiple internal standards. Visualization tools enable comparative viewing of data across multiple samples. Peak lists can be exported into other data analysis programs. The toolbox has already been utilized in a wide range of applications. We demonstrate its utility on an example of metabolic profiling of <italic>Catharanthus roseus </italic>cell cultures.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The software is freely available under the GNU General Public License and it can be obtained from the project web page at: <ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Liquid chromatography coupled to mass spectrometry [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] (LC/MS) has been widely used in proteomics [<xref ref-type="bibr" rid="B3">3</xref>] and metabolomics [<xref ref-type="bibr" rid="B4">4</xref>] research. In this context, the technology has been increasingly utilized for differential profiling, i.e. broad screening of biomolecular components across multiple samples (corresponding to different conditions, interventions, or time points) in order to elucidate the observed phenotypes or discover biomarkers [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>Typical LC/MS experiments include several analytical stages, starting with sample pre-treatment which commonly includes sample cleanup and extraction methods. The sample can then be introduced to the LC column where the molecules separate based on their size (size exclusion chromatography), affinity to stationary phase (affinity chromatography), polarity (ion exchange chromatography), or hydrophobicity (reversed phase chromatography). The <italic>retention time </italic>measures the time between the sample injection and the appearance of the compound peak maximum after chromatographic separation. In analyses of complex mixtures, it is likely that many analytes elute at the same or similar time and individual compound peaks cannot be resolved by LC alone. Mass spectrometry (MS) can then be used to separate the co-elutants according to <italic>mass-to-charge ratio </italic>(m/z). The co-elutants enter the LC-MS interface where they are ionized and introduced into the mass spectrometer where m/z is measured. Several ionization methods exist, among the most commonly used are the soft ionization methods such as electrospray ionization (ESI) and atmospheric pressure – chemical ionization (APCI). The principles of mass detection can also vary, with the most common instruments being triple quadrupole, (quadrupole) ion trap, (quadrupole) time of flight mass spectrometers [<xref ref-type="bibr" rid="B2">2</xref>]. While discussion of the merits of each type of chromatography, ion source, and mass detector are beyond the scope of this paper, it is evident that many different types of applications can be developed with LC/MS. Due to such variety of possible applications and approaches it is also challenging to develop a generic solution for processing and analysis of LC/MS data. Additionally, the commercial software solutions provided by instrument vendors are limited to the instruments provided by the vendors. Although this may change in the future by adoption of mzData [<xref ref-type="bibr" rid="B7">7</xref>] data representation format, mzData does not represent the raw data and as such may have its limitations.</p>
    <p>One increasingly utilized type of LC/MS application is differential profiling, where the extraction, LC methods, and MS instrument setup are set to provide a broad coverage of compounds, with the main aim to enable relative quantitative comparisons for individual compounds across multiple samples. The applications of such approach can be found in domains of systems biology, functional genomics, and biomarker discovery. While such approaches cannot match targeted analytical measurements in ability to accurately quantitate individual analytes, it is the role of data processing methods to enable comparative studies of analytes, even if they may be unknown [<xref ref-type="bibr" rid="B5">5</xref>]. The data processing for differential profiling usually proceeds through several stages. <italic>Spectral filtering </italic>stage aims at reducing the complexity of spectra and removing the noise. <italic>Peak detection </italic>finds the peaks corresponding to the compounds or fragments thereof. <italic>Alignment</italic>, data processing step specific to profiling experiments, aims at matching the corresponding peaks across multiple sample runs. The role of <italic>normalization </italic>is then to reduce the systematic error by adjusting the intensities within each sample run.</p>
    <p>Few integrated solutions for differential analysis of LC/MS data have already been introduced for proteomics and metabolomics applications. MarkerLynx, the commercial package from Waters, Inc. is an add-on to MassLynx (Waters, Inc.) software. IMPRESS and WINLIN software packages (TNO Pharma, The Netherlands) perform the smoothing on each mass trace separately, followed by entropy based method to filter the traces [<xref ref-type="bibr" rid="B8">8</xref>]. The alignment is then performed using the partial linear fit method initially developed for aligning NMR spectra [<xref ref-type="bibr" rid="B9">9</xref>]. Proprietary MassView software [<xref ref-type="bibr" rid="B10">10</xref>] and a toolkit by Radulovic et al. [<xref ref-type="bibr" rid="B11">11</xref>] were developed upon the similar principles for proteomics applications, while approaching the peak detection in 2 dimensions (retention time and m/z). The Bioinformatics Toolbox in Matlab (Mathworks, Inc.) contains capabilities for preprocessing of mass spectra which can be utilized on MS data analysis applications of low memory and performance demand.</p>
    <p>One of the challenges in algorithm and application development in domain of LC/MS data processing is that a solution for a particular stage of processing is of limited use if it is not embedded into the full data processing pipeline. Therefore, an integrated LC/MS software environment enabling easy integration of new methods would benefit both the algorithm developers and the end users. In this paper we report development of tools for differential profiling of LC/MS data, aiming primarily at metabolomics applications, as well as a new platform independent open source software package <italic>MZmine </italic>built to integrate these tools. We demonstrate its utility on an example of metabolic profiling of <italic>Catharanthus roseus </italic>cell cultures.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p><italic>MZmine </italic>is a collection of methods for data processing stages used in differential profiling of LC/MS data. Scope of the software is limited to data processing, and therefore other tools should be used for statistical analyses following the initial data processing.</p>
    <sec>
      <title>Software design of the toolbox</title>
      <p>Main goals in the design of the software have been good usability and expandability with new data processing methods. To facilitate good usability, we have developed a graphical user interface shown in Figure <xref ref-type="fig" rid="F1">1</xref>. The GUI allows user to experiment with different combinations of the data processing methods and parameter values for each of the steps and visually check quality of intermediate results. Some experimenting and visual validation is often required to find the best methods and parameter values for a new set of data.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><italic>MZmine </italic>graphical user interface: (A) List of imported raw data files. (B) Total ion chromatogram (TIC) for selected file. (C) Mass spectrum for selected retention time for the same file. (D) Peak list for the same file, with listed m/z values, retention times, and intensities. (E) 2d map of the same file, with retention time on x-axis and m/z on y-axis. (F) Zoomed-in spectra for a different file. (G) Peak alignment matrix for all files listed. (H) Available alignment results, e.g. for different normalizations. The spectra shown in the GUI are from lipidomic profiling of mouse white adipose tissue using Quattro Micro (Waters, Inc.) triple quadrupole mass spectrometer.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-1"/>
      </fig>
      <p>The toolbox is implemented as a stand-alone Java application. While using Java language means only slight performance degradation compared to C++ [<xref ref-type="bibr" rid="B12">12</xref>], it affords platform independence. The class model for the software contains interfaces for each of the data processing stages, and new data processing methods can be added to the toolbox by implementing a suitable interface.</p>
    </sec>
    <sec>
      <title>Input data formats and conversion</title>
      <p>The toolbox accepts input in NetCDF format. In order to implement the support for NetCDF files in the toolbox, we used NetCDF Java Library (Version 2) by Unidata community [<xref ref-type="bibr" rid="B13">13</xref>]. Most of the mass spectrometer vendors provide converters for translating raw data files from their proprietary format to this common presentation. We have tested the toolbox with NetCDF metabolomics or protein tryptic digest data created from the following instruments: Quattro Micro (Waters), QTof Premier (Waters), QSTAR Pulsar (Applied Biosystems), LTQ-FTMS (Thermo Finnigan), and LCQ (Thermo Finnigan). In the future, toolbox will also include support for upcoming new mass spectrometry data formats such as mzData [<xref ref-type="bibr" rid="B7">7</xref>] and mzXML [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      <p>Since raw LC/MS data files can be large relative to the available main memory, the core classes for representing raw data do not load all spectra into memory at once, but retrieve necessary parts from disk when requested. This makes it possible to visualise and work with several large raw data files at the same time.</p>
    </sec>
    <sec>
      <title>Smoothing and peak detection</title>
      <p>Smoothing aims to remove noise in the measured spectra, which facilitates further peak detection. Smoothing is an optional stage in data processing and can also be left out if the data is not noisy or if the input data is already available as centroids. For smoothing the spectra, toolbox offers implementations of a moving average filter and Savitzky-Golay filter.</p>
      <p>After smoothing, peak detection is done to find the peaks in the measurement data. The toolbox contains two peak picking methods: local maximum method and recursive threshold method. Both of these methods work in similar steps, which are shown as a listing:</p>
      <p>calc eXtracted Ion Chromatograms (XICs) for m/z bins</p>
      <p><bold>for </bold>each spectrum</p>
      <p>   find peaks in spectrum</p>
      <p>   filter out spectral peaks with the lowest intensities</p>
      <p>   connect new spectral peaks with previous ones</p>
      <p>end</p>
      <p>filter out too long and too short 2D-peaks</p>
      <p>The extracted ion chromatogram (XIC) is a curve showing time vs. sum of intensities over a small m/z range. Only row in the listing where the two available peak detection methods differ is the step for finding one-dimensional <italic>spectral peaks</italic>, i.e. peaks found in mass spectra of each instrument scan. Local maximum method treats every local intensity maximum along the spectrum as a spectral peak, while recursive threshold method requires maximum to have a user-definable width that differentiates it from sharper noise peaks. Spectral peaks are filtered in both chromatographic and m/z directions to remove those with weakest intensities. To speed-up chromatographic filtering, a set of XICs is precalculated for m/z bins of user-definable width before looping through spectra. Chromatographic filtering is then done inside the loop by comparing spectral peak's intensity to intensities of a XIC curve that goes through the location of spectral peak.</p>
      <p>During the loop through the spectra, one dimensional spectral peaks of current spectrum are connected with spectral peaks of the spectrum from the previous scan to form two-dimensional strings of spectral peaks. Joining occurs only between the peaks in successive spectra that have similar m/z values according to pre-set threshold, and form together a good shaped peak in the chromatographic direction. Figure <xref ref-type="fig" rid="F2">2</xref> shows a simple example of the two-step process: first finding spectral peaks and then connecting them.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p>The two-step peak picking process used by the two available peak picking methods: (A) This plot is a zoom-in to a small part of a spectrum. In the first step, one-dimensional spectral peaks are detected in each spectrum alone. Green dots over the spectrum show the locations of detected spectral peaks. (B) This plot is a zoom-in to a small fragment of two-dimensional view of raw data. Black lines show two-dimensional peaks created by connecting successive spectral peaks. Peak height is calculated as the highest intensity among these data points, while the peak area corresponds to the sum of the intensities.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-2"/>
      </fig>
      <p>Choice of methods for smoothing and peak detection depends on the nature of input data. If data is already pre-processed and centroided, smoothing is not needed and the peak picking method based on searching for local maximums works the best. When working with spectral data acquired in continuous mode, recursive threshold peak picker gives better results.</p>
      <p>Peak picking gives two measures for the size of the peak: <italic>peak height </italic>is defined as the maximum intensity of all datapoints forming the peak and <italic>peak area </italic>is measured as sum over intensities of all datapoints. It is user-selectable which of these two quantities is used in the further processing stages. Following peak detection, each LC/MS run <italic>s</italic>(<italic>s </italic>= 1...<italic>S</italic>) is represented by a <italic>peak list</italic>:</p>
      <p><bold>P</bold><sub><italic>s </italic></sub>= {<italic>p</italic><sub><italic>isc</italic></sub>}; with <italic>i </italic>= 1...<italic>N</italic><sub><italic>s </italic></sub>and <italic>c </italic>= {<italic>mz</italic>, <italic>δmz</italic>, <italic>rt</italic>, <italic>δrt</italic>, <italic>height</italic>, <italic>area</italic>};,     (1)</p>
      <p>where <italic>N</italic><sub><italic>s </italic></sub>is a total number of peaks for run <italic>s </italic>and <italic>c </italic>is an index for parameters of each peak <italic>p</italic><sub><italic>is </italic></sub>: <italic>mz </italic>is the mean m/z value for data points within the peak, <italic>δmz </italic>is standard deviation of m/z values within the peak, <italic>rt </italic>is retention time at the maximum intensity datapoint, <italic>δrt </italic>is the lengths of the peak in time, <italic>height </italic>is height of the peak and <italic>area </italic>is area of the peak calculated as described above.</p>
    </sec>
    <sec>
      <title>Alignment</title>
      <p>Alignment methods search for corresponding peaks across different LC/MS runs. Peaks from the same compound match usually closely in m/z values, but there can be variation in retention times between the runs. The former depends on mass accuracy and resolution of the mass spectrometer while the latter largely depends on the analytical method used.</p>
      <p>The results of alignment are represented by a <italic>master peak list</italic>:</p>
      <p><italic>Q </italic>= {<italic>q</italic><sub><italic>jsc</italic></sub>}; with <italic>j </italic>= 1...<italic>N</italic><sub><italic>peaks</italic></sub>, <italic>s </italic>= 1...<italic>S </italic>and <italic>c </italic>= {<italic>mz</italic>, <italic>δmz</italic>, <italic>rt</italic>, <italic>δrt</italic>, <italic>height</italic>, <italic>area</italic>};,     (2)</p>
      <p>where <italic>N</italic><sub><italic>peaks </italic></sub>is the number of rows in the master peak list matrix. Element <italic>q</italic><sub><italic>js </italic></sub>is set to empty value when no peak from the peak list <italic>s </italic>has been aligned to row <italic>j </italic>of master peak list.</p>
      <p>The toolbox currently implements a simple alignment method utilizing the master peak list. This method takes one peak from a peak list at a time and aligns the peak to either the best matching existing row of the master peak list or appends a new row to the master peak list, if matching row is not found for the peak. The alignment process is described in the pseudocode:</p>
      <p><bold>for </bold><italic>s </italic>= <italic>1</italic>...<italic>S</italic></p>
      <p>   <bold>for </bold><italic>i </italic>= <italic>1</italic>...<italic>N</italic><sub><italic>s</italic></sub></p>
      <p>      alignToMaster(<italic>p</italic><sub><italic>is</italic></sub>)</p>
      <p>   <bold>end</bold></p>
      <p>end</p>
      <p><bold>function </bold>alignToMaster(<italic>p</italic><sub><italic>is</italic></sub>)</p>
      <p>   pick <italic>j </italic>such that</p>
      <p>      <italic>q</italic><sub><italic>js </italic></sub>does not contain <italic>p</italic>' <sub><italic>i</italic>' <italic>s </italic></sub>with <italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic>'<sub><italic>i</italic>'<italic>s</italic></sub><italic>) </italic>&lt;=<italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>) </italic><bold>and</bold></p>
      <p>      minimizes <italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>)</italic></p>
      <p>   <bold>if </bold>(<italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>)</italic>&gt;user-defined threshold) <bold>or </bold>(could not pick <italic>j)</italic></p>
      <p>      append <italic>p</italic><sub><italic>is </italic></sub>to a new, empty row of <italic>Q</italic></p>
      <p>   <bold>else</bold></p>
      <p>      <bold>if </bold><italic>q</italic><sub><italic>js </italic></sub>contains <italic>p'</italic><sub><italic>i</italic>'<italic>s</italic></sub></p>
      <p>         assign <italic>q</italic><sub><italic>js </italic></sub>:= <italic>p</italic><sub><italic>is</italic></sub></p>
      <p>         alignToMaster(<italic>p'</italic><sub><italic>i</italic>'<italic>s</italic></sub>)</p>
      <p>      <bold>else</bold></p>
      <p>         assign <italic>q</italic><sub><italic>js </italic></sub>:= <italic>p</italic><sub><italic>is</italic></sub></p>
      <p>      <bold>end</bold></p>
      <p>   <bold>end</bold></p>
      <p>end</p>
      <p>where the distance between a peak p<sub><italic>is </italic></sub>and a master peak list row Q<sub><italic>j </italic></sub>is calculated using function:</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i1.gif"/>
      </p>
      <p>where <italic>p</italic><sub><italic>i,s ,mz </italic></sub>and <italic>p</italic><sub><italic>i,s ,rt </italic></sub>are the m/z ratio and retention time of a peak in an individual peak list and <inline-graphic xlink:href="1471-2105-6-179-i2.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i3.gif"/> are the average m/z ratio and retention time of peaks from all peak lists except <italic>s </italic>assigned to the same row <italic>Q</italic><sub><italic>j </italic></sub>of the master peak list. <italic>k </italic>is an adjustable parameter that controls the balance between accuracy of m/z ratio and retention time values. Generally, <italic>k </italic>can be set to a larger number with increased mass accuracy and resolution of the mass detector.</p>
      <p>After aligning peak lists as described above, it is likely that master peak list contains empty gaps, because not every peak is detected and aligned in every sample. Such missing values often complicate further statistical analyses, and for this reason we developed a secondary peak picking method for filling these gaps. This method uses <inline-graphic xlink:href="1471-2105-6-179-i2.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i3.gif"/> values for estimating location where a missing peak should be found. Search is then conducted to find the highest local maximum over a range around the expected location in the raw measurement signal. The size of the search range is a user-definable parameter in the gap-filling method. Intensity of the local maximum is then used as estimated peak height.</p>
    </sec>
    <sec>
      <title>Normalization methods</title>
      <p>Normalization is needed to reduce the systematic error in data. The toolbox implements two different approaches: a set of linear normalization methods and a new approach that utilizes multiple internal standard compounds injected to the samples.</p>
      <p>Linear normalization methods divide all peak heights within a single peak list by the same number. Implementation of linear normalization method in the toolbox offers four different ways to calculate the normalization factor: average peak height, average squared peak height, maximum peak height and total raw signal.</p>
      <p>The toolbox also contains a new normalization method that utilizes information from multiple standard compounds, which are injected to each of the samples in known concentrations prior to LC/MS analysis. The standard compound peaks can be used to calculate a set of normalization factors, one for each standard compound. There are currently two different ways to use this information in normalization. One option is to search for a standard compound peak closest to the peak. The distance function is same as (3). A variation of this method is the method based on normalization using weighted contribution of each standard compound. In this method, the same distance metric as above (3) is used to calculate distance of a peak to each standard compound. Contribution of each standard to the final normalization factor is weighted using the inverse of distance between the peak and the standard.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i4.gif"/>
      </p>
      <p>where <italic>m </italic>is the number of injected standard compounds, <italic>nf</italic><sub><italic>l </italic></sub>is the normalization factor calculated using <italic>l</italic>th standard compound and <italic>dist</italic>(<italic>p</italic>, <italic>IS</italic><sub><italic>l</italic></sub>) is the distance between peak to be normalized and peak of the <italic>l</italic>th standard compound. Both methods reduce to the common single-standard calibration when <italic>m </italic>= 1, i.e. only a single internal standard is used.</p>
    </sec>
    <sec>
      <title>Visualization methods</title>
      <p>After processing, data is ready to be exported from the toolbox as a tab-delimited peak height and area matrix. This matrix can be then further processed with packages such as Matlab (MathWorks, Inc.) or R Statistical Language which already have a large collection of data analysis tools available for statistical analyses of multivariate data.</p>
      <p>The toolbox also contains two visualization methods for quickly previewing the processed results. Both of these methods plot the peaks to a two-dimensional plot where x-axis is the retention time and y-axis m/z ratio. Logratio plot is useful for displaying differences in peak heights between two groups of samples (Figure <xref ref-type="fig" rid="F3">3</xref>). Differences are measured using logratio value, which compares average peak heights in two selected groups:</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p>(A) Total ion chromatograms from two representative samples from <italic>Catharanthus roseus </italic>cell cultures. (B) Log-ratio plot view, comparing mean intensities of detected peaks between two selected groups of samples from <italic>Catharanthus roseus </italic>(10 elicited vs. 10 controls).</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-3"/>
      </fig>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i5.gif"/>
      </p>
      <p>where <inline-graphic xlink:href="1471-2105-6-179-i6.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i7.gif"/> are average heights of peak p<sub><italic>i</italic>, •, • </sub>in the first and second group of peak lists, respectively. In the logratio plot color coding is used for visualizing the logratio values: red shades for positive logratio values and green shades for negative logratio values.</p>
      <p>Another visualization method is a coefficient of variation plot, which displays variation of peak heights within one group of samples:</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i8.gif"/>
      </p>
      <p>where <inline-graphic xlink:href="1471-2105-6-179-i9.gif"/> is the average peak height and <italic>σ</italic>(<italic>p</italic><sub><italic>i </italic>,{<italic>s</italic>}, <italic>height</italic></sub>) is the standard deviation of peak heights in the selected group of samples {<italic>s</italic>}. The coefficient of variation plot is drawn similarly as the logratio plot, but color coding is used for displaying the coefficient of variation for peak heights within a selected group of samples.</p>
      <p>These visualization methods are particularly useful for quality control, because in the toolbox environment it is easy to go back to raw data and visually verify the findings.</p>
    </sec>
  </sec>
  <sec>
    <title>Example: Metabolic profiling of plant secondary compounds in <italic>Catharanthus roseus</italic></title>
    <p>Studies of plant metabolites are a demanding area since plants produce large number of metabolites of high chemical diversity, many of which are unknown [<xref ref-type="bibr" rid="B15">15</xref>]. Plant secondary metabolites are produced as responses to changes in the environmental conditions. The biosynthetic pathways of secondary metabolites are largely unknown, and discovery driven 'omics' approaches promise to enhance our knowledge in this domain [<xref ref-type="bibr" rid="B16">16</xref>]. In order to illustrate the utility of the <italic>MZmine </italic>toolbox, we demonstrate it on metabolic profiling of cell cultures of the medicinal plant <italic>Catharanthus roseus</italic>. This plant has been extensively studied due to the presence of terpenoid indole alkaloids (TIA), several of which are in high demand for pharmaceutical use [<xref ref-type="bibr" rid="B17">17</xref>]. We focused on fraction containing most important secondary metabolites leading to TIA [see <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>]. We profiled 20 samples, of which 10 were control strains and 10 were elicited strains. Elicitation induces the stress response and can therefore lead to production of secondary metabolites. The replicates are the same strain in parallel cultures corresponding to the same time point, so they can be considered as biological replicates. We also injected an internal standard compound vincamine (PubChem SID 390304).</p>
    <p>Using <italic>MZmine </italic>toolbox with moving average filter (m/z = 0.3 window setting), recursive threshold peak detection (default settings), alignment (100s tolerance in retention time, otherwise default settings), gap-filling (60s tolerance in retention time), and normalization by total raw signal, we detected 2175 peaks. Representative total ion chromatograms from one elicited and one control sample are shown in Figure <xref ref-type="fig" rid="F3">3A</xref>. The log-ratio view for top 20% most intense peaks is shown in Figure <xref ref-type="fig" rid="F3">3B</xref>.</p>
    <p>After exporting the processed data in tabular format, further analyses of the data matrix were performed in Matlab using PLS Toolbox (Eigenvector Research, Inc.) and with R Statistical Language. Principal components analysis [<xref ref-type="bibr" rid="B18">18</xref>] revealed clear differences between the elicited and control groups (Figure <xref ref-type="fig" rid="F4">4A</xref>). Using factor analysis (not shown), we found that the two of the main contributors to the clustering of the elicited group were ajmalicine (PubChem SID 153462) and tabersonine (PubChem SID 163306). The compounds were identified using our internal spectral library based on molecular weight and retention time. Their distribution within the elicited and control groups shows the compounds are significantly upregulated after elicitation (Figure <xref ref-type="fig" rid="F4">4B</xref>). Our findings are in line with recent report using the targeted approach [<xref ref-type="bibr" rid="B19">19</xref>].</p>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p>Data analysis of <italic>Catharanthus roseus </italic>metabolite profile data, using the 2175 detected peaks as variables. (A) Principal components analysis shows differences between the elicited and control strains. Subsequent factor analysis revealed the clustering of the elicited group is largely due to the tabersonine and ajmalicine. (B) Comparison of intensity distribution between elicited and control groups for internal standard (Vincamine), Ajmalicine, and Tabersonine.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-179-4"/>
    </fig>
  </sec>
  <sec>
    <title>Discussion</title>
    <sec>
      <title>System requirements and performance</title>
      <p><italic>MZmine </italic>is available under the GNU General Public License [see <xref ref-type="supplementary-material" rid="S2">Additional file 2</xref>]. The toolbox needs Java Runtime Environment 5.0 or later (Sun Microsystems, Inc.) installed on the computer. Minimum system requirements for running the software are 2.4 GHz processor and 1 GB of memory. Also a high-resolution display mode or a dual monitor configuration is necessary for taking full advantage of the graphical user interface. As a reference, the total time from loading 50 NetCDF files (unprocessed continuous MS data acquired in full scan mode on Quattro Micro instrument) of size 100 Mbytes each to the export as a data matrix of approximately 10000 peaks took 40 minutes on a Dell Precision 650 workstation (Intel Xeon 3.06 GHz processor with 2 GB RAM), which is significantly less than the time of actual data acquisition by the LC/MS system (40 hours). The major performance bottleneck is the gap filling stage. Since many of the stages of the data processing can easily be parallelized, significant performance improvement could be gained by distributed computing. Future implementations of the software will include this capacity.</p>
      <p>The software settings largely depend on the type of application, analytical method and instrument used for data collection. As part of the application development, it is advisable to experiment with different settings to optimize the performance.</p>
    </sec>
    <sec>
      <title>Methods and applications</title>
      <p>So far the <italic>MZmine </italic>has been primarily utilized in the domain of metabolomics, which included lipidomics and global metabolomics applications in biomedical domain, primary metabolite screening in microbes, and plant metabolomics. Specifically, the early prototype version of <italic>MZmine </italic>has been applied to lipidomic analyses in a recent study of PPARγ2 knock-out mouse model [<xref ref-type="bibr" rid="B20">20</xref>].</p>
      <p>The methods currently available in the toolbox have been found sufficient in these applications. However, we will further focus especially on peak picking methods in the future, since this stage is the most crucial part of the data processing. In order to study the metabolic profiles with as many compounds as possible, every real peak should be found from raw LC/MS data files. On the other hand, false-positive peak detections complicate the statistical analyses and may prevent some interesting results to be found. In addition to these two issues, every single peak should be detected as exactly as possible in both m/z and retention time direction. This is necessary for determining peak area and height correctly, for successful alignment between samples, and for identification.</p>
      <p>Currently it is difficult to perform comprehensive comparison of available methods for differential profiling of LC/MS data, since most of the methods are either proprietary or vendor-specific. However, repeatability studies on biological tissues have shown that the median CV is in the range of 18–23%, depending on normalization method (data not shown). This is consistent with published results [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. The results on mixtures of internal standards were better, with CV &lt;5%. The discrepancy in CV values is due to peak picking in complex biological mixtures, where many compounds are at the trace levels near the detection limit. This reaffirmed our belief that the stage of peak picking is the critical step in profiling of biological samples.</p>
      <p>While the term quantitative analysis has recently been used to describe the methods of differential profiling [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>], we believe true quantitative analysis would also require calculation of compound concentrations. None of the profiling toolboxes introduced so far have this ability. While ideally one would use isotope labelled standard and measure calibration curve for each compound, this is in practice impossible for complex biological mixtures where the compounds are of diverse chemical properties and many of them unknown. We believe our normalization method based on multiple internal standards is a step toward the ability to quantitate the compounds in the biological samples.</p>
    </sec>
    <sec>
      <title>Current and future developments</title>
      <p>We are currently developing a version enabling distributed computing and implementing a method for detection of natural isotope patterns. We are also going to extend the data import capability to mzXML and mzData formats and enable database connectivity.</p>
      <p>On the algorithm side, in addition to improved peak picking, we are implementing two normalization methods, one based on multiplicative error model [<xref ref-type="bibr" rid="B6">6</xref>], and an enhanced version of multiple-standard method which takes into account information from compound identification. The initial application of the latter method will be developed for the lipid screening. One of the future goals is to enable automated handling of multiple spectra coming from single sample (i.e. MS and MS/MS or ESI+/MS and ESI-/MS). The latter, combined with database connectivity, will open the possibilities of automated identification of metabolites, as well as enable development of proteomics profiling applications utilizing <italic>MZmine</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We developed a platform independent software package for processing of LC/MS profile data. The software has already been tested and applied on a wide range of instruments and applications in domain metabolomics. Given its modular structure, the <italic>MZmine </italic>promises to be a powerful tool and test bench for development of new LC/MS data processing algorithms.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>• <bold>Project name: </bold><italic>MZmine </italic>LC/MS Toolbox</p>
    <p>• <bold>Project home page: </bold><ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/></p>
    <p>• <bold>Operating system(s): </bold>Platform independent</p>
    <p>• <bold>Programming language: </bold>Java</p>
    <p>• <bold>Other requirements: </bold>Java Runtime Environment (JRE) 5.0 or higher</p>
    <p>• <bold>Licence: </bold>GNU General Public License</p>
  </sec>
  <sec>
    <title>List of abbreviations</title>
    <p>MS: Mass spectrometry</p>
    <p>XIC: Extracted ion chromatogram</p>
    <p>TIC: Total ion chromatogram</p>
    <p>LC/MS: Liquid chromatography – mass spectrometry</p>
    <p>ESI(+/-): (Positive/negative) Electrospray ionization</p>
    <p>APCI: Atmospheric pressure chemical ionization</p>
    <p>QTof: Quadrupole – time of flight mass spectrometer</p>
    <p>FTMS: Fourier transform mass spectrometer</p>
    <p>CV: Coefficient of variance</p>
    <p>m/z: Mass-to-charge ratio (m is molecular weight and z is charge of the ion)</p>
    <p>GUI: Graphical user interface</p>
    <p>API: Application programming interface</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MK developed the software for the LC/MS Toolbox, developed the new algorithms for peak detection and alignment, normalization, and drafted the manuscript. MO initiated and supervised the study, designed the software toolbox and the experiment described in the paper and drafted the manuscript. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>Experimental methods for profiling Catharanthus roseus cell cultures. The file includes description of analytical methods for profiling of <italic>Catharanthus roseus </italic>cell cultures, which were used to demonstrate the utility of <italic>MZmine</italic>.</p>
      </caption>
      <media xlink:href="1471-2105-6-179-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p>MZmine Toolbox source code (version 0.42). The file includes the source code and license information of the MZmine Toolbox.</p>
      </caption>
      <media xlink:href="1471-2105-6-179-S2.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>MK was funded by Academy of Finland SysBio Research Programme. MO's research was in part funded by Marie Curie International Reintegration Grant. We thank to Tuulikki-Seppänen Laakso for performing the LC/MS analyses used in this paper and to Heiko Rischer and Kirsi-Marja Oksman-Caldentey for providing the <italic>C. roseus </italic>material.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ardrey</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <source>Liquid chromatography - mass spectrometry: An introduction</source>
        <year>2003</year>
        <publisher-name>, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>de Hoffmann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stroobant</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Mass spectrometry: Principles and applications</source>
        <year>2001</year>
        <edition>2.</edition>
        <publisher-name>, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Proteomics: the first decade and beyond</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>33</volume>
        <fpage>311</fpage>
        <lpage>323</lpage>
        <pub-id pub-id-type="pmid">12610541</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1106</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodacre</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vaidyanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Harrigan</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics by numbers: acquiring and understanding global metabolite data</article-title>
        <source>Trends Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>245</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="pmid">15109811</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2004.03.007</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>van der Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>van der Heijden</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marple</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Harrigan GG and Goodacre R</surname>
          </name>
        </person-group>
        <article-title>The role of metabolomics in systems biology: A new vision for drug discovery and development</article-title>
        <source>Metabolic profiling: Its role in biomarker discovery and gene function analysis</source>
        <year>2003</year>
        <publisher-name>Boston, Mass., Kluwer Academic Publishers</publisher-name>
        <fpage>171</fpage>
        <lpage>198</lpage>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Havekes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Plasterer</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Phenotype characterization using integrated gene transcript, protein and metabolite profiling</article-title>
        <source>Appl Bioinformatics</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">15702951</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Organization</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>mzData</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://psidev.sourceforge.net/ms/#mzdata"/>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davidov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meys</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stochaj</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lavine</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Londo</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marple</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Plasterer</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Havekes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Methods for the differential integrative omic analysis of plasma from a transgenic disease animal model</article-title>
        <source>OMICS A Journal of Integrative Biology</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>267</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="pmid">15703476</pub-id>
        <pub-id pub-id-type="doi">10.1089/omi.2004.8.267</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Tas</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Venekamp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Partial linear fit : a new NMR spectroscopy preprocessing tool for pattern recognition applications</article-title>
        <source>J Chemometrics</source>
        <year>1996</year>
        <volume>10</volume>
        <fpage>425</fpage>
        <lpage>438</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-128X(199609)10:5/6&lt;425::AID-CEM442&gt;3.0.CO;2-S</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shaler</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Norton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anderle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Quantification of proteins and metabolites by mass spectrometry without isotopic labeling or spiked standards</article-title>
        <source>Anal Chem</source>
        <year>2003</year>
        <volume>75</volume>
        <fpage>4818 </fpage>
        <lpage>44826</lpage>
        <pub-id pub-id-type="pmid">14674459</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac026468x</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Radulovic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jelveh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Foss</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Emili</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Informatics platform for global proteomic profiling and biomarker discovery using liquid chromatography-tandem mass spectrometry</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>984</fpage>
        <lpage>997</lpage>
        <pub-id pub-id-type="pmid">15269249</pub-id>
        <pub-id pub-id-type="doi">10.1074/mcp.M400061-MCP200</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Performance of Java versus C++</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.idiom.com/~zilla/Computer/javaCbenchmark.html"/>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="other">
        <article-title>UniData NetCDF</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://my.unidata.ucar.edu/content/software/netcdf/index.html"/>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedrioli</surname>
            <given-names>PGA</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Hubley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vogelzang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Raught</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Angeletti</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Hermjakob</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Julian</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Kapp</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McComb</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Omenn</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Paton</surname>
            <given-names>NW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A common open representation of mass spectrometry data and its application to proteomics research</article-title>
        <source>Nat Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>1459</fpage>
        <lpage>1466</lpage>
        <pub-id pub-id-type="pmid">15529173</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt1031</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics - the link between genotyopes and phenotypes</article-title>
        <source>Plant Molecular Biology</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="pmid">11860207</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oksman-Caldentey</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Inze</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Plant cell factories in the post-genomic era: new ways to produce designer secondary metabolites</article-title>
        <source>Trends Plant Sci</source>
        <year>2004</year>
        <volume>9</volume>
        <fpage>433</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="pmid">15337493</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tplants.2004.07.006</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rischer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Oksman-Caldentey</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Saito K, Willmitzer L and Dixon D</surname>
          </name>
        </person-group>
        <article-title>Metabolomics of plant secondary compounds: profiling of Catharanthus cell cultures</article-title>
        <source>Plant metabolomics</source>
        <series>Biotechnology in Agriculture and Forrestry</series>
        <year>2005</year>
        <publisher-name>Heidelberg, Springer Verlag, in press</publisher-name>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jackson</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <source>User's guide to principal components</source>
        <year>1991</year>
        <publisher-name>New York, NY, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee-Parsons</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Ertürk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tengtrakool</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Enhancement of ajmalicine production in Catharanthus roseus cell cultures with methyl jasmonate is dependent on timing and dosage of elicitation</article-title>
        <source>Biotechnol Lett</source>
        <year>2004</year>
        <volume>26</volume>
        <fpage>1595</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">15604804</pub-id>
        <pub-id pub-id-type="doi">10.1023/B:BILE.0000045825.37395.94</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medina-Gomez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Virtue</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lelliott</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boiani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Christodoulides</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perrin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jimenez-Linan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blount</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thresher</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colledge</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Kettunen</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Seppanen-Laakso</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sethi</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>O'Rahilly</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brindle</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cinti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burcelin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vidal-Puig</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The link between nutritional status and insulin sensitivity is dependent on the adipocyte-specific Peroxisome Proliferator-Activated Receptor-{gamma}2 isoform</article-title>
        <source>Diabetes</source>
        <year>2005</year>
        <volume>54</volume>
        <fpage>1706</fpage>
        <lpage>1716</lpage>
        <pub-id pub-id-type="pmid">15919792</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1187873</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-179</article-id>
    <article-id pub-id-type="pmid">16026613</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-179</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Processing methods for differential analysis of LC/MS profile data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Katajamaa</surname>
          <given-names>Mikko</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mikko.katajamaa@btk.fi</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Orešič</surname>
          <given-names>Matej</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>matej.oresic@vtt.fi</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Turku Centre for Biotechnology, Tykistökatu 6, FIN-20521, Turku, Finland</aff>
    <aff id="I2"><label>2</label>VTT Biotechnology, Tietotie 2, P.O. Box 1500, FIN-02044 VTT, Espoo, Finland</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>7</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>179</fpage>
    <lpage>179</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/179"/>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2005</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2005 Katajamaa and Orešič; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2005</copyright-year>
      <copyright-holder>Katajamaa and Orešič; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Katajamaa
               Mikko
               
               mikko.katajamaa@btk.fi
            </dc:author><dc:title>
            Processing methods for differential analysis of LC/MS profile data
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 6(1): 179-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2005)6:1&#x0003c;179&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Liquid chromatography coupled to mass spectrometry (LC/MS) has been widely used in proteomics and metabolomics research. In this context, the technology has been increasingly used for differential profiling, i.e. broad screening of biomolecular components across multiple samples in order to elucidate the observed phenotypes and discover biomarkers. One of the major challenges in this domain remains development of better solutions for processing of LC/MS data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a software package <italic>MZmine </italic>that enables differential LC/MS analysis of metabolomics data. This software is a toolbox containing methods for all data processing stages preceding differential analysis: spectral filtering, peak detection, alignment and normalization. Specifically, we developed and implemented a new recursive peak search algorithm and a secondary peak picking method for improving already aligned results, as well as a normalization tool that uses multiple internal standards. Visualization tools enable comparative viewing of data across multiple samples. Peak lists can be exported into other data analysis programs. The toolbox has already been utilized in a wide range of applications. We demonstrate its utility on an example of metabolic profiling of <italic>Catharanthus roseus </italic>cell cultures.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The software is freely available under the GNU General Public License and it can be obtained from the project web page at: <ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Liquid chromatography coupled to mass spectrometry [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] (LC/MS) has been widely used in proteomics [<xref ref-type="bibr" rid="B3">3</xref>] and metabolomics [<xref ref-type="bibr" rid="B4">4</xref>] research. In this context, the technology has been increasingly utilized for differential profiling, i.e. broad screening of biomolecular components across multiple samples (corresponding to different conditions, interventions, or time points) in order to elucidate the observed phenotypes or discover biomarkers [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>Typical LC/MS experiments include several analytical stages, starting with sample pre-treatment which commonly includes sample cleanup and extraction methods. The sample can then be introduced to the LC column where the molecules separate based on their size (size exclusion chromatography), affinity to stationary phase (affinity chromatography), polarity (ion exchange chromatography), or hydrophobicity (reversed phase chromatography). The <italic>retention time </italic>measures the time between the sample injection and the appearance of the compound peak maximum after chromatographic separation. In analyses of complex mixtures, it is likely that many analytes elute at the same or similar time and individual compound peaks cannot be resolved by LC alone. Mass spectrometry (MS) can then be used to separate the co-elutants according to <italic>mass-to-charge ratio </italic>(m/z). The co-elutants enter the LC-MS interface where they are ionized and introduced into the mass spectrometer where m/z is measured. Several ionization methods exist, among the most commonly used are the soft ionization methods such as electrospray ionization (ESI) and atmospheric pressure – chemical ionization (APCI). The principles of mass detection can also vary, with the most common instruments being triple quadrupole, (quadrupole) ion trap, (quadrupole) time of flight mass spectrometers [<xref ref-type="bibr" rid="B2">2</xref>]. While discussion of the merits of each type of chromatography, ion source, and mass detector are beyond the scope of this paper, it is evident that many different types of applications can be developed with LC/MS. Due to such variety of possible applications and approaches it is also challenging to develop a generic solution for processing and analysis of LC/MS data. Additionally, the commercial software solutions provided by instrument vendors are limited to the instruments provided by the vendors. Although this may change in the future by adoption of mzData [<xref ref-type="bibr" rid="B7">7</xref>] data representation format, mzData does not represent the raw data and as such may have its limitations.</p>
    <p>One increasingly utilized type of LC/MS application is differential profiling, where the extraction, LC methods, and MS instrument setup are set to provide a broad coverage of compounds, with the main aim to enable relative quantitative comparisons for individual compounds across multiple samples. The applications of such approach can be found in domains of systems biology, functional genomics, and biomarker discovery. While such approaches cannot match targeted analytical measurements in ability to accurately quantitate individual analytes, it is the role of data processing methods to enable comparative studies of analytes, even if they may be unknown [<xref ref-type="bibr" rid="B5">5</xref>]. The data processing for differential profiling usually proceeds through several stages. <italic>Spectral filtering </italic>stage aims at reducing the complexity of spectra and removing the noise. <italic>Peak detection </italic>finds the peaks corresponding to the compounds or fragments thereof. <italic>Alignment</italic>, data processing step specific to profiling experiments, aims at matching the corresponding peaks across multiple sample runs. The role of <italic>normalization </italic>is then to reduce the systematic error by adjusting the intensities within each sample run.</p>
    <p>Few integrated solutions for differential analysis of LC/MS data have already been introduced for proteomics and metabolomics applications. MarkerLynx, the commercial package from Waters, Inc. is an add-on to MassLynx (Waters, Inc.) software. IMPRESS and WINLIN software packages (TNO Pharma, The Netherlands) perform the smoothing on each mass trace separately, followed by entropy based method to filter the traces [<xref ref-type="bibr" rid="B8">8</xref>]. The alignment is then performed using the partial linear fit method initially developed for aligning NMR spectra [<xref ref-type="bibr" rid="B9">9</xref>]. Proprietary MassView software [<xref ref-type="bibr" rid="B10">10</xref>] and a toolkit by Radulovic et al. [<xref ref-type="bibr" rid="B11">11</xref>] were developed upon the similar principles for proteomics applications, while approaching the peak detection in 2 dimensions (retention time and m/z). The Bioinformatics Toolbox in Matlab (Mathworks, Inc.) contains capabilities for preprocessing of mass spectra which can be utilized on MS data analysis applications of low memory and performance demand.</p>
    <p>One of the challenges in algorithm and application development in domain of LC/MS data processing is that a solution for a particular stage of processing is of limited use if it is not embedded into the full data processing pipeline. Therefore, an integrated LC/MS software environment enabling easy integration of new methods would benefit both the algorithm developers and the end users. In this paper we report development of tools for differential profiling of LC/MS data, aiming primarily at metabolomics applications, as well as a new platform independent open source software package <italic>MZmine </italic>built to integrate these tools. We demonstrate its utility on an example of metabolic profiling of <italic>Catharanthus roseus </italic>cell cultures.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p><italic>MZmine </italic>is a collection of methods for data processing stages used in differential profiling of LC/MS data. Scope of the software is limited to data processing, and therefore other tools should be used for statistical analyses following the initial data processing.</p>
    <sec>
      <title>Software design of the toolbox</title>
      <p>Main goals in the design of the software have been good usability and expandability with new data processing methods. To facilitate good usability, we have developed a graphical user interface shown in Figure <xref ref-type="fig" rid="F1">1</xref>. The GUI allows user to experiment with different combinations of the data processing methods and parameter values for each of the steps and visually check quality of intermediate results. Some experimenting and visual validation is often required to find the best methods and parameter values for a new set of data.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><italic>MZmine </italic>graphical user interface: (A) List of imported raw data files. (B) Total ion chromatogram (TIC) for selected file. (C) Mass spectrum for selected retention time for the same file. (D) Peak list for the same file, with listed m/z values, retention times, and intensities. (E) 2d map of the same file, with retention time on x-axis and m/z on y-axis. (F) Zoomed-in spectra for a different file. (G) Peak alignment matrix for all files listed. (H) Available alignment results, e.g. for different normalizations. The spectra shown in the GUI are from lipidomic profiling of mouse white adipose tissue using Quattro Micro (Waters, Inc.) triple quadrupole mass spectrometer.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-1"/>
      </fig>
      <p>The toolbox is implemented as a stand-alone Java application. While using Java language means only slight performance degradation compared to C++ [<xref ref-type="bibr" rid="B12">12</xref>], it affords platform independence. The class model for the software contains interfaces for each of the data processing stages, and new data processing methods can be added to the toolbox by implementing a suitable interface.</p>
    </sec>
    <sec>
      <title>Input data formats and conversion</title>
      <p>The toolbox accepts input in NetCDF format. In order to implement the support for NetCDF files in the toolbox, we used NetCDF Java Library (Version 2) by Unidata community [<xref ref-type="bibr" rid="B13">13</xref>]. Most of the mass spectrometer vendors provide converters for translating raw data files from their proprietary format to this common presentation. We have tested the toolbox with NetCDF metabolomics or protein tryptic digest data created from the following instruments: Quattro Micro (Waters), QTof Premier (Waters), QSTAR Pulsar (Applied Biosystems), LTQ-FTMS (Thermo Finnigan), and LCQ (Thermo Finnigan). In the future, toolbox will also include support for upcoming new mass spectrometry data formats such as mzData [<xref ref-type="bibr" rid="B7">7</xref>] and mzXML [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      <p>Since raw LC/MS data files can be large relative to the available main memory, the core classes for representing raw data do not load all spectra into memory at once, but retrieve necessary parts from disk when requested. This makes it possible to visualise and work with several large raw data files at the same time.</p>
    </sec>
    <sec>
      <title>Smoothing and peak detection</title>
      <p>Smoothing aims to remove noise in the measured spectra, which facilitates further peak detection. Smoothing is an optional stage in data processing and can also be left out if the data is not noisy or if the input data is already available as centroids. For smoothing the spectra, toolbox offers implementations of a moving average filter and Savitzky-Golay filter.</p>
      <p>After smoothing, peak detection is done to find the peaks in the measurement data. The toolbox contains two peak picking methods: local maximum method and recursive threshold method. Both of these methods work in similar steps, which are shown as a listing:</p>
      <p>calc eXtracted Ion Chromatograms (XICs) for m/z bins</p>
      <p><bold>for </bold>each spectrum</p>
      <p>   find peaks in spectrum</p>
      <p>   filter out spectral peaks with the lowest intensities</p>
      <p>   connect new spectral peaks with previous ones</p>
      <p>end</p>
      <p>filter out too long and too short 2D-peaks</p>
      <p>The extracted ion chromatogram (XIC) is a curve showing time vs. sum of intensities over a small m/z range. Only row in the listing where the two available peak detection methods differ is the step for finding one-dimensional <italic>spectral peaks</italic>, i.e. peaks found in mass spectra of each instrument scan. Local maximum method treats every local intensity maximum along the spectrum as a spectral peak, while recursive threshold method requires maximum to have a user-definable width that differentiates it from sharper noise peaks. Spectral peaks are filtered in both chromatographic and m/z directions to remove those with weakest intensities. To speed-up chromatographic filtering, a set of XICs is precalculated for m/z bins of user-definable width before looping through spectra. Chromatographic filtering is then done inside the loop by comparing spectral peak's intensity to intensities of a XIC curve that goes through the location of spectral peak.</p>
      <p>During the loop through the spectra, one dimensional spectral peaks of current spectrum are connected with spectral peaks of the spectrum from the previous scan to form two-dimensional strings of spectral peaks. Joining occurs only between the peaks in successive spectra that have similar m/z values according to pre-set threshold, and form together a good shaped peak in the chromatographic direction. Figure <xref ref-type="fig" rid="F2">2</xref> shows a simple example of the two-step process: first finding spectral peaks and then connecting them.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p>The two-step peak picking process used by the two available peak picking methods: (A) This plot is a zoom-in to a small part of a spectrum. In the first step, one-dimensional spectral peaks are detected in each spectrum alone. Green dots over the spectrum show the locations of detected spectral peaks. (B) This plot is a zoom-in to a small fragment of two-dimensional view of raw data. Black lines show two-dimensional peaks created by connecting successive spectral peaks. Peak height is calculated as the highest intensity among these data points, while the peak area corresponds to the sum of the intensities.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-2"/>
      </fig>
      <p>Choice of methods for smoothing and peak detection depends on the nature of input data. If data is already pre-processed and centroided, smoothing is not needed and the peak picking method based on searching for local maximums works the best. When working with spectral data acquired in continuous mode, recursive threshold peak picker gives better results.</p>
      <p>Peak picking gives two measures for the size of the peak: <italic>peak height </italic>is defined as the maximum intensity of all datapoints forming the peak and <italic>peak area </italic>is measured as sum over intensities of all datapoints. It is user-selectable which of these two quantities is used in the further processing stages. Following peak detection, each LC/MS run <italic>s</italic>(<italic>s </italic>= 1...<italic>S</italic>) is represented by a <italic>peak list</italic>:</p>
      <p><bold>P</bold><sub><italic>s </italic></sub>= {<italic>p</italic><sub><italic>isc</italic></sub>}; with <italic>i </italic>= 1...<italic>N</italic><sub><italic>s </italic></sub>and <italic>c </italic>= {<italic>mz</italic>, <italic>δmz</italic>, <italic>rt</italic>, <italic>δrt</italic>, <italic>height</italic>, <italic>area</italic>};,     (1)</p>
      <p>where <italic>N</italic><sub><italic>s </italic></sub>is a total number of peaks for run <italic>s </italic>and <italic>c </italic>is an index for parameters of each peak <italic>p</italic><sub><italic>is </italic></sub>: <italic>mz </italic>is the mean m/z value for data points within the peak, <italic>δmz </italic>is standard deviation of m/z values within the peak, <italic>rt </italic>is retention time at the maximum intensity datapoint, <italic>δrt </italic>is the lengths of the peak in time, <italic>height </italic>is height of the peak and <italic>area </italic>is area of the peak calculated as described above.</p>
    </sec>
    <sec>
      <title>Alignment</title>
      <p>Alignment methods search for corresponding peaks across different LC/MS runs. Peaks from the same compound match usually closely in m/z values, but there can be variation in retention times between the runs. The former depends on mass accuracy and resolution of the mass spectrometer while the latter largely depends on the analytical method used.</p>
      <p>The results of alignment are represented by a <italic>master peak list</italic>:</p>
      <p><italic>Q </italic>= {<italic>q</italic><sub><italic>jsc</italic></sub>}; with <italic>j </italic>= 1...<italic>N</italic><sub><italic>peaks</italic></sub>, <italic>s </italic>= 1...<italic>S </italic>and <italic>c </italic>= {<italic>mz</italic>, <italic>δmz</italic>, <italic>rt</italic>, <italic>δrt</italic>, <italic>height</italic>, <italic>area</italic>};,     (2)</p>
      <p>where <italic>N</italic><sub><italic>peaks </italic></sub>is the number of rows in the master peak list matrix. Element <italic>q</italic><sub><italic>js </italic></sub>is set to empty value when no peak from the peak list <italic>s </italic>has been aligned to row <italic>j </italic>of master peak list.</p>
      <p>The toolbox currently implements a simple alignment method utilizing the master peak list. This method takes one peak from a peak list at a time and aligns the peak to either the best matching existing row of the master peak list or appends a new row to the master peak list, if matching row is not found for the peak. The alignment process is described in the pseudocode:</p>
      <p><bold>for </bold><italic>s </italic>= <italic>1</italic>...<italic>S</italic></p>
      <p>   <bold>for </bold><italic>i </italic>= <italic>1</italic>...<italic>N</italic><sub><italic>s</italic></sub></p>
      <p>      alignToMaster(<italic>p</italic><sub><italic>is</italic></sub>)</p>
      <p>   <bold>end</bold></p>
      <p>end</p>
      <p><bold>function </bold>alignToMaster(<italic>p</italic><sub><italic>is</italic></sub>)</p>
      <p>   pick <italic>j </italic>such that</p>
      <p>      <italic>q</italic><sub><italic>js </italic></sub>does not contain <italic>p</italic>' <sub><italic>i</italic>' <italic>s </italic></sub>with <italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic>'<sub><italic>i</italic>'<italic>s</italic></sub><italic>) </italic>&lt;=<italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>) </italic><bold>and</bold></p>
      <p>      minimizes <italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>)</italic></p>
      <p>   <bold>if </bold>(<italic>dist(Q</italic><sub><italic>j</italic></sub>, <italic>p</italic><sub><italic>is</italic></sub><italic>)</italic>&gt;user-defined threshold) <bold>or </bold>(could not pick <italic>j)</italic></p>
      <p>      append <italic>p</italic><sub><italic>is </italic></sub>to a new, empty row of <italic>Q</italic></p>
      <p>   <bold>else</bold></p>
      <p>      <bold>if </bold><italic>q</italic><sub><italic>js </italic></sub>contains <italic>p'</italic><sub><italic>i</italic>'<italic>s</italic></sub></p>
      <p>         assign <italic>q</italic><sub><italic>js </italic></sub>:= <italic>p</italic><sub><italic>is</italic></sub></p>
      <p>         alignToMaster(<italic>p'</italic><sub><italic>i</italic>'<italic>s</italic></sub>)</p>
      <p>      <bold>else</bold></p>
      <p>         assign <italic>q</italic><sub><italic>js </italic></sub>:= <italic>p</italic><sub><italic>is</italic></sub></p>
      <p>      <bold>end</bold></p>
      <p>   <bold>end</bold></p>
      <p>end</p>
      <p>where the distance between a peak p<sub><italic>is </italic></sub>and a master peak list row Q<sub><italic>j </italic></sub>is calculated using function:</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i1.gif"/>
      </p>
      <p>where <italic>p</italic><sub><italic>i,s ,mz </italic></sub>and <italic>p</italic><sub><italic>i,s ,rt </italic></sub>are the m/z ratio and retention time of a peak in an individual peak list and <inline-graphic xlink:href="1471-2105-6-179-i2.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i3.gif"/> are the average m/z ratio and retention time of peaks from all peak lists except <italic>s </italic>assigned to the same row <italic>Q</italic><sub><italic>j </italic></sub>of the master peak list. <italic>k </italic>is an adjustable parameter that controls the balance between accuracy of m/z ratio and retention time values. Generally, <italic>k </italic>can be set to a larger number with increased mass accuracy and resolution of the mass detector.</p>
      <p>After aligning peak lists as described above, it is likely that master peak list contains empty gaps, because not every peak is detected and aligned in every sample. Such missing values often complicate further statistical analyses, and for this reason we developed a secondary peak picking method for filling these gaps. This method uses <inline-graphic xlink:href="1471-2105-6-179-i2.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i3.gif"/> values for estimating location where a missing peak should be found. Search is then conducted to find the highest local maximum over a range around the expected location in the raw measurement signal. The size of the search range is a user-definable parameter in the gap-filling method. Intensity of the local maximum is then used as estimated peak height.</p>
    </sec>
    <sec>
      <title>Normalization methods</title>
      <p>Normalization is needed to reduce the systematic error in data. The toolbox implements two different approaches: a set of linear normalization methods and a new approach that utilizes multiple internal standard compounds injected to the samples.</p>
      <p>Linear normalization methods divide all peak heights within a single peak list by the same number. Implementation of linear normalization method in the toolbox offers four different ways to calculate the normalization factor: average peak height, average squared peak height, maximum peak height and total raw signal.</p>
      <p>The toolbox also contains a new normalization method that utilizes information from multiple standard compounds, which are injected to each of the samples in known concentrations prior to LC/MS analysis. The standard compound peaks can be used to calculate a set of normalization factors, one for each standard compound. There are currently two different ways to use this information in normalization. One option is to search for a standard compound peak closest to the peak. The distance function is same as (3). A variation of this method is the method based on normalization using weighted contribution of each standard compound. In this method, the same distance metric as above (3) is used to calculate distance of a peak to each standard compound. Contribution of each standard to the final normalization factor is weighted using the inverse of distance between the peak and the standard.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i4.gif"/>
      </p>
      <p>where <italic>m </italic>is the number of injected standard compounds, <italic>nf</italic><sub><italic>l </italic></sub>is the normalization factor calculated using <italic>l</italic>th standard compound and <italic>dist</italic>(<italic>p</italic>, <italic>IS</italic><sub><italic>l</italic></sub>) is the distance between peak to be normalized and peak of the <italic>l</italic>th standard compound. Both methods reduce to the common single-standard calibration when <italic>m </italic>= 1, i.e. only a single internal standard is used.</p>
    </sec>
    <sec>
      <title>Visualization methods</title>
      <p>After processing, data is ready to be exported from the toolbox as a tab-delimited peak height and area matrix. This matrix can be then further processed with packages such as Matlab (MathWorks, Inc.) or R Statistical Language which already have a large collection of data analysis tools available for statistical analyses of multivariate data.</p>
      <p>The toolbox also contains two visualization methods for quickly previewing the processed results. Both of these methods plot the peaks to a two-dimensional plot where x-axis is the retention time and y-axis m/z ratio. Logratio plot is useful for displaying differences in peak heights between two groups of samples (Figure <xref ref-type="fig" rid="F3">3</xref>). Differences are measured using logratio value, which compares average peak heights in two selected groups:</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p>(A) Total ion chromatograms from two representative samples from <italic>Catharanthus roseus </italic>cell cultures. (B) Log-ratio plot view, comparing mean intensities of detected peaks between two selected groups of samples from <italic>Catharanthus roseus </italic>(10 elicited vs. 10 controls).</p>
        </caption>
        <graphic xlink:href="1471-2105-6-179-3"/>
      </fig>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i5.gif"/>
      </p>
      <p>where <inline-graphic xlink:href="1471-2105-6-179-i6.gif"/> and <inline-graphic xlink:href="1471-2105-6-179-i7.gif"/> are average heights of peak p<sub><italic>i</italic>, •, • </sub>in the first and second group of peak lists, respectively. In the logratio plot color coding is used for visualizing the logratio values: red shades for positive logratio values and green shades for negative logratio values.</p>
      <p>Another visualization method is a coefficient of variation plot, which displays variation of peak heights within one group of samples:</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-179-i8.gif"/>
      </p>
      <p>where <inline-graphic xlink:href="1471-2105-6-179-i9.gif"/> is the average peak height and <italic>σ</italic>(<italic>p</italic><sub><italic>i </italic>,{<italic>s</italic>}, <italic>height</italic></sub>) is the standard deviation of peak heights in the selected group of samples {<italic>s</italic>}. The coefficient of variation plot is drawn similarly as the logratio plot, but color coding is used for displaying the coefficient of variation for peak heights within a selected group of samples.</p>
      <p>These visualization methods are particularly useful for quality control, because in the toolbox environment it is easy to go back to raw data and visually verify the findings.</p>
    </sec>
  </sec>
  <sec>
    <title>Example: Metabolic profiling of plant secondary compounds in <italic>Catharanthus roseus</italic></title>
    <p>Studies of plant metabolites are a demanding area since plants produce large number of metabolites of high chemical diversity, many of which are unknown [<xref ref-type="bibr" rid="B15">15</xref>]. Plant secondary metabolites are produced as responses to changes in the environmental conditions. The biosynthetic pathways of secondary metabolites are largely unknown, and discovery driven 'omics' approaches promise to enhance our knowledge in this domain [<xref ref-type="bibr" rid="B16">16</xref>]. In order to illustrate the utility of the <italic>MZmine </italic>toolbox, we demonstrate it on metabolic profiling of cell cultures of the medicinal plant <italic>Catharanthus roseus</italic>. This plant has been extensively studied due to the presence of terpenoid indole alkaloids (TIA), several of which are in high demand for pharmaceutical use [<xref ref-type="bibr" rid="B17">17</xref>]. We focused on fraction containing most important secondary metabolites leading to TIA [see <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>]. We profiled 20 samples, of which 10 were control strains and 10 were elicited strains. Elicitation induces the stress response and can therefore lead to production of secondary metabolites. The replicates are the same strain in parallel cultures corresponding to the same time point, so they can be considered as biological replicates. We also injected an internal standard compound vincamine (PubChem SID 390304).</p>
    <p>Using <italic>MZmine </italic>toolbox with moving average filter (m/z = 0.3 window setting), recursive threshold peak detection (default settings), alignment (100s tolerance in retention time, otherwise default settings), gap-filling (60s tolerance in retention time), and normalization by total raw signal, we detected 2175 peaks. Representative total ion chromatograms from one elicited and one control sample are shown in Figure <xref ref-type="fig" rid="F3">3A</xref>. The log-ratio view for top 20% most intense peaks is shown in Figure <xref ref-type="fig" rid="F3">3B</xref>.</p>
    <p>After exporting the processed data in tabular format, further analyses of the data matrix were performed in Matlab using PLS Toolbox (Eigenvector Research, Inc.) and with R Statistical Language. Principal components analysis [<xref ref-type="bibr" rid="B18">18</xref>] revealed clear differences between the elicited and control groups (Figure <xref ref-type="fig" rid="F4">4A</xref>). Using factor analysis (not shown), we found that the two of the main contributors to the clustering of the elicited group were ajmalicine (PubChem SID 153462) and tabersonine (PubChem SID 163306). The compounds were identified using our internal spectral library based on molecular weight and retention time. Their distribution within the elicited and control groups shows the compounds are significantly upregulated after elicitation (Figure <xref ref-type="fig" rid="F4">4B</xref>). Our findings are in line with recent report using the targeted approach [<xref ref-type="bibr" rid="B19">19</xref>].</p>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p>Data analysis of <italic>Catharanthus roseus </italic>metabolite profile data, using the 2175 detected peaks as variables. (A) Principal components analysis shows differences between the elicited and control strains. Subsequent factor analysis revealed the clustering of the elicited group is largely due to the tabersonine and ajmalicine. (B) Comparison of intensity distribution between elicited and control groups for internal standard (Vincamine), Ajmalicine, and Tabersonine.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-179-4"/>
    </fig>
  </sec>
  <sec>
    <title>Discussion</title>
    <sec>
      <title>System requirements and performance</title>
      <p><italic>MZmine </italic>is available under the GNU General Public License [see <xref ref-type="supplementary-material" rid="S2">Additional file 2</xref>]. The toolbox needs Java Runtime Environment 5.0 or later (Sun Microsystems, Inc.) installed on the computer. Minimum system requirements for running the software are 2.4 GHz processor and 1 GB of memory. Also a high-resolution display mode or a dual monitor configuration is necessary for taking full advantage of the graphical user interface. As a reference, the total time from loading 50 NetCDF files (unprocessed continuous MS data acquired in full scan mode on Quattro Micro instrument) of size 100 Mbytes each to the export as a data matrix of approximately 10000 peaks took 40 minutes on a Dell Precision 650 workstation (Intel Xeon 3.06 GHz processor with 2 GB RAM), which is significantly less than the time of actual data acquisition by the LC/MS system (40 hours). The major performance bottleneck is the gap filling stage. Since many of the stages of the data processing can easily be parallelized, significant performance improvement could be gained by distributed computing. Future implementations of the software will include this capacity.</p>
      <p>The software settings largely depend on the type of application, analytical method and instrument used for data collection. As part of the application development, it is advisable to experiment with different settings to optimize the performance.</p>
    </sec>
    <sec>
      <title>Methods and applications</title>
      <p>So far the <italic>MZmine </italic>has been primarily utilized in the domain of metabolomics, which included lipidomics and global metabolomics applications in biomedical domain, primary metabolite screening in microbes, and plant metabolomics. Specifically, the early prototype version of <italic>MZmine </italic>has been applied to lipidomic analyses in a recent study of PPARγ2 knock-out mouse model [<xref ref-type="bibr" rid="B20">20</xref>].</p>
      <p>The methods currently available in the toolbox have been found sufficient in these applications. However, we will further focus especially on peak picking methods in the future, since this stage is the most crucial part of the data processing. In order to study the metabolic profiles with as many compounds as possible, every real peak should be found from raw LC/MS data files. On the other hand, false-positive peak detections complicate the statistical analyses and may prevent some interesting results to be found. In addition to these two issues, every single peak should be detected as exactly as possible in both m/z and retention time direction. This is necessary for determining peak area and height correctly, for successful alignment between samples, and for identification.</p>
      <p>Currently it is difficult to perform comprehensive comparison of available methods for differential profiling of LC/MS data, since most of the methods are either proprietary or vendor-specific. However, repeatability studies on biological tissues have shown that the median CV is in the range of 18–23%, depending on normalization method (data not shown). This is consistent with published results [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. The results on mixtures of internal standards were better, with CV &lt;5%. The discrepancy in CV values is due to peak picking in complex biological mixtures, where many compounds are at the trace levels near the detection limit. This reaffirmed our belief that the stage of peak picking is the critical step in profiling of biological samples.</p>
      <p>While the term quantitative analysis has recently been used to describe the methods of differential profiling [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>], we believe true quantitative analysis would also require calculation of compound concentrations. None of the profiling toolboxes introduced so far have this ability. While ideally one would use isotope labelled standard and measure calibration curve for each compound, this is in practice impossible for complex biological mixtures where the compounds are of diverse chemical properties and many of them unknown. We believe our normalization method based on multiple internal standards is a step toward the ability to quantitate the compounds in the biological samples.</p>
    </sec>
    <sec>
      <title>Current and future developments</title>
      <p>We are currently developing a version enabling distributed computing and implementing a method for detection of natural isotope patterns. We are also going to extend the data import capability to mzXML and mzData formats and enable database connectivity.</p>
      <p>On the algorithm side, in addition to improved peak picking, we are implementing two normalization methods, one based on multiplicative error model [<xref ref-type="bibr" rid="B6">6</xref>], and an enhanced version of multiple-standard method which takes into account information from compound identification. The initial application of the latter method will be developed for the lipid screening. One of the future goals is to enable automated handling of multiple spectra coming from single sample (i.e. MS and MS/MS or ESI+/MS and ESI-/MS). The latter, combined with database connectivity, will open the possibilities of automated identification of metabolites, as well as enable development of proteomics profiling applications utilizing <italic>MZmine</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We developed a platform independent software package for processing of LC/MS profile data. The software has already been tested and applied on a wide range of instruments and applications in domain metabolomics. Given its modular structure, the <italic>MZmine </italic>promises to be a powerful tool and test bench for development of new LC/MS data processing algorithms.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>• <bold>Project name: </bold><italic>MZmine </italic>LC/MS Toolbox</p>
    <p>• <bold>Project home page: </bold><ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/></p>
    <p>• <bold>Operating system(s): </bold>Platform independent</p>
    <p>• <bold>Programming language: </bold>Java</p>
    <p>• <bold>Other requirements: </bold>Java Runtime Environment (JRE) 5.0 or higher</p>
    <p>• <bold>Licence: </bold>GNU General Public License</p>
  </sec>
  <sec>
    <title>List of abbreviations</title>
    <p>MS: Mass spectrometry</p>
    <p>XIC: Extracted ion chromatogram</p>
    <p>TIC: Total ion chromatogram</p>
    <p>LC/MS: Liquid chromatography – mass spectrometry</p>
    <p>ESI(+/-): (Positive/negative) Electrospray ionization</p>
    <p>APCI: Atmospheric pressure chemical ionization</p>
    <p>QTof: Quadrupole – time of flight mass spectrometer</p>
    <p>FTMS: Fourier transform mass spectrometer</p>
    <p>CV: Coefficient of variance</p>
    <p>m/z: Mass-to-charge ratio (m is molecular weight and z is charge of the ion)</p>
    <p>GUI: Graphical user interface</p>
    <p>API: Application programming interface</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MK developed the software for the LC/MS Toolbox, developed the new algorithms for peak detection and alignment, normalization, and drafted the manuscript. MO initiated and supervised the study, designed the software toolbox and the experiment described in the paper and drafted the manuscript. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>Experimental methods for profiling Catharanthus roseus cell cultures. The file includes description of analytical methods for profiling of <italic>Catharanthus roseus </italic>cell cultures, which were used to demonstrate the utility of <italic>MZmine</italic>.</p>
      </caption>
      <media xlink:href="1471-2105-6-179-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p>MZmine Toolbox source code (version 0.42). The file includes the source code and license information of the MZmine Toolbox.</p>
      </caption>
      <media xlink:href="1471-2105-6-179-S2.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>MK was funded by Academy of Finland SysBio Research Programme. MO's research was in part funded by Marie Curie International Reintegration Grant. We thank to Tuulikki-Seppänen Laakso for performing the LC/MS analyses used in this paper and to Heiko Rischer and Kirsi-Marja Oksman-Caldentey for providing the <italic>C. roseus </italic>material.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ardrey</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <source>Liquid chromatography - mass spectrometry: An introduction</source>
        <year>2003</year>
        <publisher-name>, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>de Hoffmann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stroobant</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Mass spectrometry: Principles and applications</source>
        <year>2001</year>
        <edition>2.</edition>
        <publisher-name>, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Proteomics: the first decade and beyond</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>33</volume>
        <fpage>311</fpage>
        <lpage>323</lpage>
        <pub-id pub-id-type="pmid">12610541</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1106</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodacre</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vaidyanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Harrigan</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics by numbers: acquiring and understanding global metabolite data</article-title>
        <source>Trends Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>245</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="pmid">15109811</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2004.03.007</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>van der Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>van der Heijden</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marple</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Harrigan GG and Goodacre R</surname>
          </name>
        </person-group>
        <article-title>The role of metabolomics in systems biology: A new vision for drug discovery and development</article-title>
        <source>Metabolic profiling: Its role in biomarker discovery and gene function analysis</source>
        <year>2003</year>
        <publisher-name>Boston, Mass., Kluwer Academic Publishers</publisher-name>
        <fpage>171</fpage>
        <lpage>198</lpage>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Havekes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Plasterer</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Phenotype characterization using integrated gene transcript, protein and metabolite profiling</article-title>
        <source>Appl Bioinformatics</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">15702951</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Organization</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>mzData</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://psidev.sourceforge.net/ms/#mzdata"/>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davidov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meys</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stochaj</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lavine</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Londo</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Adourian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marple</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Plasterer</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Havekes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Naylor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Methods for the differential integrative omic analysis of plasma from a transgenic disease animal model</article-title>
        <source>OMICS A Journal of Integrative Biology</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>267</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="pmid">15703476</pub-id>
        <pub-id pub-id-type="doi">10.1089/omi.2004.8.267</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vogels</surname>
            <given-names>JTWE</given-names>
          </name>
          <name>
            <surname>Tas</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Venekamp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greef</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Partial linear fit : a new NMR spectroscopy preprocessing tool for pattern recognition applications</article-title>
        <source>J Chemometrics</source>
        <year>1996</year>
        <volume>10</volume>
        <fpage>425</fpage>
        <lpage>438</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-128X(199609)10:5/6&lt;425::AID-CEM442&gt;3.0.CO;2-S</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shaler</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Norton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anderle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Quantification of proteins and metabolites by mass spectrometry without isotopic labeling or spiked standards</article-title>
        <source>Anal Chem</source>
        <year>2003</year>
        <volume>75</volume>
        <fpage>4818 </fpage>
        <lpage>44826</lpage>
        <pub-id pub-id-type="pmid">14674459</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac026468x</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Radulovic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jelveh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Foss</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Emili</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Informatics platform for global proteomic profiling and biomarker discovery using liquid chromatography-tandem mass spectrometry</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>984</fpage>
        <lpage>997</lpage>
        <pub-id pub-id-type="pmid">15269249</pub-id>
        <pub-id pub-id-type="doi">10.1074/mcp.M400061-MCP200</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Performance of Java versus C++</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.idiom.com/~zilla/Computer/javaCbenchmark.html"/>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="other">
        <article-title>UniData NetCDF</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://my.unidata.ucar.edu/content/software/netcdf/index.html"/>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedrioli</surname>
            <given-names>PGA</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Hubley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vogelzang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Raught</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Angeletti</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Hermjakob</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Julian</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Kapp</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McComb</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Omenn</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Paton</surname>
            <given-names>NW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A common open representation of mass spectrometry data and its application to proteomics research</article-title>
        <source>Nat Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>1459</fpage>
        <lpage>1466</lpage>
        <pub-id pub-id-type="pmid">15529173</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt1031</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics - the link between genotyopes and phenotypes</article-title>
        <source>Plant Molecular Biology</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="pmid">11860207</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oksman-Caldentey</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Inze</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Plant cell factories in the post-genomic era: new ways to produce designer secondary metabolites</article-title>
        <source>Trends Plant Sci</source>
        <year>2004</year>
        <volume>9</volume>
        <fpage>433</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="pmid">15337493</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tplants.2004.07.006</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rischer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Oksman-Caldentey</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Saito K, Willmitzer L and Dixon D</surname>
          </name>
        </person-group>
        <article-title>Metabolomics of plant secondary compounds: profiling of Catharanthus cell cultures</article-title>
        <source>Plant metabolomics</source>
        <series>Biotechnology in Agriculture and Forrestry</series>
        <year>2005</year>
        <publisher-name>Heidelberg, Springer Verlag, in press</publisher-name>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jackson</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <source>User's guide to principal components</source>
        <year>1991</year>
        <publisher-name>New York, NY, John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee-Parsons</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Ertürk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tengtrakool</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Enhancement of ajmalicine production in Catharanthus roseus cell cultures with methyl jasmonate is dependent on timing and dosage of elicitation</article-title>
        <source>Biotechnol Lett</source>
        <year>2004</year>
        <volume>26</volume>
        <fpage>1595</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">15604804</pub-id>
        <pub-id pub-id-type="doi">10.1023/B:BILE.0000045825.37395.94</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medina-Gomez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Virtue</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lelliott</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boiani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Christodoulides</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perrin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jimenez-Linan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blount</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thresher</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colledge</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Kettunen</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Seppanen-Laakso</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sethi</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>O'Rahilly</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brindle</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cinti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burcelin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vidal-Puig</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The link between nutritional status and insulin sensitivity is dependent on the adipocyte-specific Peroxisome Proliferator-Activated Receptor-{gamma}2 isoform</article-title>
        <source>Diabetes</source>
        <year>2005</year>
        <volume>54</volume>
        <fpage>1706</fpage>
        <lpage>1716</lpage>
        <pub-id pub-id-type="pmid">15919792</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
