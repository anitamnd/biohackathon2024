<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7716509</article-id>
    <article-id pub-id-type="publisher-id">804</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-020-00804-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Pan-cancer identification of clinically relevant genomic subtypes using outcome-weighted integrative clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Arora</surname>
          <given-names>Arshi</given-names>
        </name>
        <address>
          <email>aroraa@mskcc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olshen</surname>
          <given-names>Adam B.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Seshan</surname>
          <given-names>Venkatraman E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9694-584X</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ronglai</given-names>
        </name>
        <address>
          <email>shenr@mskcc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.51462.34</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9952</institution-id><institution>Department of Epidemiology and Biostatistics, </institution><institution>Memorial Sloan Kettering Cancer Center, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Department of Epidemiology and Biostatistics, </institution><institution>University of California at San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Helen Diller Family Comprehensive Cancer Center, </institution><institution>University of California at San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>110</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Comprehensive molecular profiling has revealed somatic variations in cancer at genomic, epigenomic, transcriptomic, and proteomic levels. The accumulating data has shown clearly that molecular phenotypes of cancer are complex and influenced by a multitude of factors. Conventional unsupervised clustering applied to a large patient population is inevitably driven by the dominant variation from major factors such as cell-of-origin or histology. Translation of these data into clinical relevance requires more effective extraction of information directly associated with patient outcome.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">Drawing from ideas in supervised text classification, we developed <italic>survClust</italic>, an outcome-weighted clustering algorithm for integrative molecular stratification focusing on patient survival. <italic>survClust</italic> was performed on 18 cancer types across multiple data modalities including somatic mutation, DNA copy number, DNA methylation, and mRNA, miRNA, and protein expression from the Cancer Genome Atlas study to identify novel prognostic subtypes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">Our analysis identified the prognostic role of high tumor mutation burden with concurrently high CD8 T cell immune marker expression and the aggressive clinical behavior associated with <italic>CDKN2A</italic> deletion across cancer types. Visualization of somatic alterations, at a genome-wide scale (total mutation burden, mutational signature, fraction genome altered) and at the individual gene level, using <italic>circomap</italic> further revealed indolent versus aggressive subgroups in a pan-cancer setting.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">Our analysis has revealed prognostic molecular subtypes not previously identified by unsupervised clustering. The algorithm and tools we developed have direct utility toward patient stratification based on tumor genomics to inform clinical decision-making. The <italic>survClust</italic> software tool is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/arorarshi/survClust">https://github.com/arorarshi/survClust</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Integrative clustering</kwd>
      <kwd>Supervised learning</kwd>
      <kwd>Patient survival</kwd>
      <kwd>Prognostic molecular stratification</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30CA082103</award-id>
        <award-id>P30 CA008748 54</award-id>
        <award-id>P01 CA206980</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par5">Cancer is a complex disease with heterogeneous clinical outcomes. Understanding how patients respond to treatment and what drives disease progression and metastasis is critical for managing and curing the disease. Linking comprehensive molecular profiling data with patient outcome carries great promise in addressing such important clinical questions. This requires innovative statistical and computational methods designed for integrative analysis of multidimensional data sets to model intra-tumor and inter-patient heterogeneity at genomic, epigenetic, and transcriptomic levels. Each of these molecular dimensions is correlated yet characterizes the disease in its own unique way. In order to arrive at a comprehensive molecular portrait of the tumor, multiple groups have proposed statistical and computational algorithms to synthesize various channels of information including methods developed by us (iCluster [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]) and others (PARADIGM [<xref ref-type="bibr" rid="CR3">3</xref>], CoCA [<xref ref-type="bibr" rid="CR4">4</xref>], SNF [<xref ref-type="bibr" rid="CR5">5</xref>], CIMLR [<xref ref-type="bibr" rid="CR6">6</xref>]) to stratify disease populations. However, the majority of the work has focused on unsupervised clustering that utilizes the molecular data alone.</p>
    <p id="Par6">A complexity of applying unsupervised learning to molecular phenotypes lies in that it does not necessarily lead to unique answers. This limitation is well understood in the field of text learning. Consider the problem of clustering a collection of documents where multiple data substructures can be present including authorship, topic, and style. The outcome of the clustering is likely driven by a mixture of these underlying structures. As a result, there is often no single “right” answer in unsupervised clustering problems. In most complex data applications, many local optima exist that poses special challenges in optimization. Xing et al. [<xref ref-type="bibr" rid="CR7">7</xref>] proposed a weighted distance metric allowing users to specify what they consider “meaningful” in defining similarity toward a more efficient and local optima-free clustering performance.</p>
    <p id="Par7">Drawing analogy with the text learning problem described above, the molecular profile of a tumor is influenced by a multitude of factors including cell-of-origin [<xref ref-type="bibr" rid="CR8">8</xref>], histology (e.g., squamous vs. adenocarcinoma), tumor microenvironment (e.g., immune cell infiltration [<xref ref-type="bibr" rid="CR9">9</xref>]), dedifferentiation states [<xref ref-type="bibr" rid="CR10">10</xref>], and specific pathway activation [<xref ref-type="bibr" rid="CR11">11</xref>]. Conventional unsupervised clustering applied to the most variable features is inevitably driven by the dominant variation from major factors, for example, cell-of-origin [<xref ref-type="bibr" rid="CR8">8</xref>] or ancestry [<xref ref-type="bibr" rid="CR12">12</xref>] (germline variation) in the study cohort. When patient outcome-related stratification is of interest, a more directed clustering approach is needed.</p>
    <p id="Par8">To overcome the current limitation of molecular clustering analysis, we developed the <italic>survClust</italic> algorithm as a supervised learning approach that aims to identify cancer subtypes that are not just molecularly distinct but also prognostically significant. It is an outcome-weighted integrative clustering algorithm for survival stratification based on multidimensional omics-profiling data. The algorithm learns a weighted distance matrix that downweights molecular features with no relevance to the outcome of interest. This method can be used on individual platforms alone, or by integrating various molecular platforms, to mine biological information leading to distinct survival subgroups. In this study, we analyzed over 6000 tumors across 18 cancer types. Each disease type was classified by <italic>survClust</italic> based on six molecular assays—somatic point mutations, DNA copy number, DNA methylation, mRNA expression, miRNA expression, protein expression, and the integration of the six assays. The results have revealed novel survival subtypes not previously identified by unsupervised clustering.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data source</title>
      <p id="Par9">The analysis in this study was conducted on the Cancer Genome Atlas dataset. This included six molecular data types: somatic point mutations, DNA copy number, DNA methylation, mRNA expression, miRNA expression, and protein expression across 6209 tumor samples covering 18 cancer types. Data pre-processing and normalization procedures are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note.</p>
    </sec>
    <sec id="Sec4">
      <title>survClust workflow</title>
      <p id="Par10">Let <bold><italic>X</italic></bold><sub><bold><italic>m</italic></bold></sub> be the <italic>m</italic>th (<italic>m</italic> = 1,…,<italic>M</italic>) data type of dimension <italic>N</italic><sub><italic>m</italic></sub> (number of samples in the <italic>m</italic>th data type) by <italic>p</italic><sub><italic>m</italic></sub> (number of features in the corresponding data type). Rows are samples and columns are molecular features. Data types may consist of continuous (gene expression, copy number log-ratio, DNA methylation, miRNA, protein expression) or binary (mutation status) data. Overall survival is defined as the time from diagnosis to death or last follow-up. The number of samples in each tumor type and the number of molecular features in each data type are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
      <p id="Par11">For a pair of two samples <italic>a</italic> and <italic>b</italic>, the weighted distance [<xref ref-type="bibr" rid="CR7">7</xref>] is calculated as follows:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {d}_w\left(\boldsymbol{a},\boldsymbol{b}\right)=\sqrt{{\left(\boldsymbol{a}-\boldsymbol{b}\right)}^{\boldsymbol{T}}\ \boldsymbol{W}\left(\boldsymbol{a}-\boldsymbol{b}\right)}, $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msup><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par12">where <bold><italic>a</italic></bold> and <bold><italic>b</italic></bold> are feature vectors of length <italic>p</italic> for samples <italic>a</italic> and <italic>b,</italic> respectively, and <bold><italic>W</italic></bold> is a <italic>p</italic> × <italic>p</italic> diagonal weight matrix with <bold><italic>W</italic></bold> = <italic>diag</italic> {<italic>w</italic><sub>1</sub>, …, <italic>w</italic><sub><italic>p</italic></sub>}. Samples are close to each other when the value of <italic>d</italic><sub><italic>w</italic></sub> is small and dissimilar when <italic>d</italic><sub><italic>w</italic></sub> is large.</p>
      <p id="Par13">The weights <italic>w</italic><sub><italic>j</italic></sub> (<italic>j</italic> = 1, …, <italic>p</italic>) are obtained by fitting a univariable Cox proportional hazards model fitted for each feature:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ h\left(t|{\boldsymbol{x}}_{\boldsymbol{p}}\right)={h}_o\times \exp \left({\boldsymbol{x}}_{\boldsymbol{j}}^{\boldsymbol{T}}\ast \beta \right), $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>h</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:mo>∗</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par14">where <italic>t</italic> represents the survival time, <bold><italic>x</italic></bold><sub><bold><italic>j</italic></bold></sub> is the <italic>j</italic>th column of matrix <bold><italic>X</italic></bold> of length <italic>N</italic>, <italic>h</italic><sub>0</sub> is the baseline hazard function, <italic>β</italic> is the regression coefficient, and exp(<italic>β</italic>) is the hazard ratio (HR).</p>
      <p id="Par15">We consider the absolute value of HR on the logarithmic scale as the weight <italic>w</italic>. An HR = 1 corresponds to the null that the feature is not associated with survival. This is reflected in a log (1) = 0 weighting in the distance matrix. Since <bold><italic>W</italic></bold> is a diagonal matrix with diagonal elements <italic>w</italic><sub><italic>j</italic></sub> (<italic>j</italic> = 1, …, <italic>p</italic>), we can simply use Euclidean distance for computing distances if we transform the data as follows:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{X}}^{\prime }=\boldsymbol{X}\ast {\boldsymbol{W}}^{\frac{\mathbf{1}}{\mathbf{2}}}. $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mspace width="0.25em"/><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>∗</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mfrac><mml:mn mathvariant="bold">1</mml:mn><mml:mn mathvariant="bold">2</mml:mn></mml:mfrac></mml:msup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par16">Euclidean distances are sensitive to scale of the observations so after incorporating weights, we standardize the data by its grand total:
<disp-formula id="Equa"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{{\boldsymbol{X}}^{\prime }}{\sum \limits_{\boldsymbol{i}}\sum \limits_{\boldsymbol{j}}{x}_{ij}^{\prime }}, $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="bold-italic">j</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:mfrac><mml:mo mathvariant="bold">,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par17">where <inline-formula id="IEq1"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \sum \limits_{\boldsymbol{i}}\sum \limits_{\boldsymbol{j}}{x}_{ij}^{\prime } $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="bold-italic">j</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:math><inline-graphic xlink:href="13073_2020_804_Article_IEq1.gif"/></alternatives></inline-formula> is the grand total of the weighted matrix <bold><italic>X</italic></bold>′, with <italic>i</italic> rows (<italic>N</italic> samples) and <italic>j</italic> columns (<italic>p</italic> features). Then, one can compute the pairwise distance between samples <italic>a</italic> (<italic>i</italic> = 1) and <italic>b</italic>(<italic>i</italic> = 2) as:
<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {d}_w\left(\boldsymbol{a}^{\prime },\boldsymbol{b}^{\prime}\right)={d}_w\left(\boldsymbol{b}^{\prime },\boldsymbol{a}^{\prime}\right)=\sqrt{\sum \limits_{j=1}^p{\left({a_j}^{\prime }-{b_j}^{\prime}\right)}^2.} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfenced><mml:mo mathvariant="bold">=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfenced><mml:mo mathvariant="bold">=</mml:mo><mml:msqrt><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo mathvariant="bold">.</mml:mo></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="13073_2020_804_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par18">Conversely, a weighted distance matrix <bold><italic>D</italic></bold> is calculated for all pairwise samples across <italic>M</italic> data types. All samples having full survival information are kept, and the union of all samples (<italic>N</italic><sub>union</sub>) across <italic>M</italic> data types is utilized when analyzing a wide number of samples. Non-overlapping samples in data types are added as <italic>NA</italic> to have a uniform set of <italic>N</italic><sub>union</sub> samples.</p>
      <p id="Par19">The integrated weighted distance matrix is calculated by averaging over the weighted distance matrices:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{I}}_{\boldsymbol{w}}=\sum \limits_{m=1}^M{\boldsymbol{\gamma}}_{\boldsymbol{m}}{\boldsymbol{D}}_{\boldsymbol{m}}, $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mi mathvariant="bold-italic">w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par20">where <inline-formula id="IEq2"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\gamma}}_{\boldsymbol{m}}=\frac{\mathbf{1}}{\boldsymbol{M}}\boldsymbol{\forall}\boldsymbol{m}. $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub><mml:mo mathvariant="bold-italic">=</mml:mo><mml:mfrac><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mfrac><mml:mo mathvariant="bold-italic">∀</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo mathvariant="bold-italic">.</mml:mo></mml:math><inline-graphic xlink:href="13073_2020_804_Article_IEq2.gif"/></alternatives></inline-formula> The integrated weighted matrix <bold><italic>I</italic></bold><sub><bold><italic>w</italic></bold></sub> averages the inter- and intra-sample similarity profiles over the <italic>M</italic> data types. <bold><italic>I</italic></bold><sub><bold><italic>w</italic></bold></sub> is then processed by <italic>survClust</italic> via classical multidimensional scaling (MDS) [<xref ref-type="bibr" rid="CR13">13</xref>] and clustered using k-means [<xref ref-type="bibr" rid="CR14">14</xref>]. Classical MDS assumes Euclidean distances; however, in cases of non-Euclidean distances, Mardia et al. [<xref ref-type="bibr" rid="CR15">15</xref>] provided a method to obtain the resulting positive semidefinite scalar product matrix. Note that <italic>I</italic><sub><italic>w</italic></sub> follows the Euclidean norm and hence can be represented in <italic>n</italic> − 1 dimensions. The strong assumption of the Euclidean norm is also important for k-means, as it is essentially trying to assign samples to the closest centroid or calculating the sum of squared deviations from centroids.</p>
    </sec>
    <sec id="Sec5">
      <title>Weighted distance metric for mutation data</title>
      <p id="Par21">Somatic mutation data is represented as a binary data matrix where each entry is coded as 1 if the <italic>j</italic>th gene is mutated in the <italic>i</italic>th sample, and 0 otherwise. A challenge with the mutation data matrix is the sparsity. It is known that somatic mutation data exhibit a long-tailed distribution in which a relatively small number of variants appear in tumors frequently while the vast majority of variants occur extremely infrequently. We consider genes that are mutated in &gt; 1% of the samples. After incorporating weights, this data is no longer binary, but it still remains sparse. Due to such data sparsity, computing the Euclidean distance is not appropriate and may lead to inflated distance measures [<xref ref-type="bibr" rid="CR16">16</xref>]. To combat this problem, we propose a weighted binary distance metric for such a scenario.</p>
      <p id="Par22">Let <inline-formula id="IEq3"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{X}}_{\boldsymbol{mut}}^{\prime } $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:msubsup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">mut</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13073_2020_804_Article_IEq3.gif"/></alternatives></inline-formula> be the weighted mutation data matrix (see Eq. <xref rid="Equ3" ref-type="">3</xref>) of dimension <italic>N</italic> (samples) by <italic>p</italic> (genes). Then, the pairwise distance between sample vectors <bold><italic>a</italic></bold> and <bold><italic>b</italic></bold> is calculated as follows:
<disp-formula id="Equc"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {d}_w\left(\boldsymbol{a},\boldsymbol{b}\right)={d}_w\left(\boldsymbol{b},\boldsymbol{a}\right)=\frac{w_{01}+{w}_{10}\ }{w_{01}+{w}_{10}+{w}_{11}}, $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msub><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mfenced><mml:mo mathvariant="bold-italic">=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par23">where</p>
      <p id="Par24"><italic>w</italic><sub>01</sub> = sum of weights of <italic>p</italic> features that are zero in sample vector <bold><italic>a</italic></bold> but non-zero in sample vector <bold><italic>b</italic></bold><bold>;</bold></p>
      <p id="Par25"><italic>w</italic><sub>10</sub> = sum of weights of <italic>p</italic> features that are non-zero in sample vector <bold><italic>a</italic></bold> but zero in sample vector <bold><italic>b</italic></bold><bold>;</bold></p>
      <p id="Par26"><italic>w</italic><sub>11</sub> = sum of weights of <italic>p</italic> features that are non-zero in sample vector <bold><italic>a</italic></bold> and non-zero in sample vector <bold><italic>b</italic></bold><bold>.</bold></p>
      <p id="Par27">Note that <italic>d</italic><sub><italic>w</italic></sub>(<bold><italic>a</italic></bold>, <bold><italic>b</italic></bold>) is a proportion of the sum of effect sizes in which only one is non-zero among those in which at least one is non-zero [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Cross-validation</title>
      <p id="Par28"><italic>survClust</italic> classifies sample populations by incorporating outcome information. Cross-validation was used to prevent overfitting and arrive at more generalizable solutions. The <italic>cv.survclust</italic> function performs cross-validation for the desired number of folds and outputs cross-validated solution labels. In the data analysis, we performed 5-fold cross-validation in the following steps: (1) Split the data into 5 random partitions, label 4 of them as the training sets and the remaining one as the test set. (2) The weighted distance matrix was calculated from the training data set alone (Eq. <xref rid="Equ1" ref-type="">1</xref>). <italic>survClust</italic> clustering was performed to arrive at outcome-weighted labels in the training set. (3) Each test set sample was assigned a class label based on its molecular feature vector and weights derived from the training set. We note the survival information for the test sample was not used in assigning its class label, ensuring an unbiased assessment of survival association for the class assignment on the test set. (4) Step 2 was repeated until predictions were made on all 5 test data sets across all 5 folds. (6) Clusters were tracked by <italic>centroid relabeling</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note) across folds, and we obtained outcome-weighted class labels for our entire dataset. This concluded one round of cross-validation. All results shown here are results from cross-validated labels across 50 rounds of cross-validation. Cluster labeling consistency was preserved across rounds of cross-validation via a similar approach to centroid relabeling. The final class label for a sample was assigned based on a consensus voting, i.e., the class that the sample was assigned the highest number of times in the 50 rounds of cross-validation. This is achieved by another function called <italic>consensus.summary</italic>.</p>
    </sec>
    <sec id="Sec7">
      <title>Choice of the number of clusters <bold><italic>k</italic></bold></title>
      <p id="Par29">We use both the logrank test statistic and a standardized pooled within-cluster sum of squares calculated from cross-validation to choose an appropriate <italic>k</italic>.</p>
    </sec>
    <sec id="Sec8">
      <title>The logrank statistic</title>
      <p id="Par30">The logrank test statistic is based on a non-parametric approach that quantifies survival difference between resulting subtypes and makes no assumption about the survival distributions. It tests the null hypothesis that there is no difference in survival between the groups.</p>
      <p id="Par31">For a particular <italic>k</italic> cluster solution, we have <italic>k</italic> cross-validated labels. Each class is distinct in survival, and we can compare the difference between classes using the logrank test statistic as follows [<xref ref-type="bibr" rid="CR18">18</xref>]:
<disp-formula id="Equd"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\chi}^2=\frac{\sum \limits_k\left({O}_k-{E}_k\right)}{\sqrt{V}}, $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:msqrt><mml:mi>V</mml:mi></mml:msqrt></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par32">where <italic>O</italic><sub><italic>k</italic></sub> = observed number of events in the <italic>k</italic>th group over time, <italic>E</italic><sub><italic>k</italic></sub> = expected number of events in the <italic>k</italic>th group over time and <italic>V</italic> = ∑ <italic>Var</italic> (<italic>O</italic><sub><italic>k</italic></sub> − <italic>E</italic><sub><italic>k</italic></sub>) = ∑ <italic>V</italic><sub><italic>k</italic></sub>.</p>
      <p id="Par33">For a two-group comparison, the logrank statistic follows a chi-square distribution with 1 degree of freedom. A value greater than 3.84 is considered statistically significant at an alpha of 0.05. The optimal <italic>k</italic> is the one with the maximum logrank statistic.</p>
    </sec>
    <sec id="Sec9">
      <title>Standardized pooled within-cluster sum of squares</title>
      <p id="Par34">Here we calculate the pooled within-cluster sum of squares and standardize it by the total sum of squares similar to methodology used in the gap statistic [<xref ref-type="bibr" rid="CR19">19</xref>] to select the appropriate number of clusters.</p>
      <p id="Par35">Suppose that the final labels have clustered the data into <italic>k</italic> clusters <italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>, …. <italic>C</italic><sub><italic>k</italic></sub>, with <italic>C</italic><sub><italic>r</italic></sub> denoting the indices of observations in cluster <italic>r</italic>, and <italic>n</italic><sub><italic>r</italic></sub> = |<italic>C</italic><sub><italic>r</italic></sub>|. Let
<disp-formula id="Eque"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {w}_r=\sum \limits_{\begin{array}{c}i,j\in {C}_r\\ {}i&gt;j\ \end{array}}{I_w}_{ij}, $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:msub><mml:mi>w</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">where <italic>w</italic><sub><italic>r</italic></sub> is the sum of all pairwise distances in cluster <italic>r</italic>, {<italic>ij</italic>} represents a pair of samples belonging to a cluster <italic>C</italic><sub><italic>r</italic></sub>, and <bold><italic>I</italic></bold><sub><bold><italic>w</italic></bold></sub> is calculated from Eq. <xref rid="Equ4" ref-type="">4</xref>. Then, the standardized pooled within-cluster sum of squares is:</p>
      <p id="Par37">
        <disp-formula id="Equf">
          <alternatives>
            <tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_s=\sum \limits_{r=1}^k{w}_r/\sum \limits_{\begin{array}{c}i\\ {}i&gt;j\end{array}}\sum \limits_j{I_w}_{ij}. $$\end{document}</tex-math>
            <mml:math id="M26" display="block">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>W</mml:mi>
                </mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:munderover>
                <mml:mo movablelimits="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:munderover>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:msub>
              <mml:mstyle scriptlevel="0">
                <mml:mrow>
                  <mml:mo fence="true" maxsize="1.2em" minsize="1.2em" stretchy="true" symmetric="true">/</mml:mo>
                </mml:mrow>
              </mml:mstyle>
              <mml:munder>
                <mml:mo movablelimits="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi>i</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow/>
                        <mml:mi>i</mml:mi>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:munder>
              <mml:munder>
                <mml:mo movablelimits="false">∑</mml:mo>
                <mml:mi>j</mml:mi>
              </mml:munder>
              <mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>I</mml:mi>
                    <mml:mi>w</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>.</mml:mo>
            </mml:math>
            <graphic xlink:href="13073_2020_804_Article_Equf.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par38">Here <italic>W</italic><sub><italic>s</italic></sub> decreases monotonically as the number of clusters <italic>k</italic> increases. The optimal number of clusters is where <italic>W</italic><sub><italic>s</italic></sub> is minimized and creates an “elbow” or a point of inflection, where addition of more clusters does not improve cluster separation. Another property of <italic>W</italic><sub><italic>s</italic></sub> is that it can be used to compare among different datasets as it lies between 0 and 1 after standardization. This is useful for comparing <italic>survClust</italic> runs between individual data types and when we integrate them.</p>
    </sec>
    <sec id="Sec10">
      <title>Adjusted Rand index</title>
      <p id="Par39">The Rand index is used to measure agreement between two classification labels. When this Rand index is adjusted for chance, it is called the adjusted Rand index. The Rand index and adjusted Rand index have a maximum of 1 and a minimum of 0. Here 0 means the two data labels have no shared information and 1 means they are the same labels.</p>
    </sec>
    <sec id="Sec12">
      <title>Simulation</title>
      <p id="Par40">Continuing from the simulation study presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we go into detail about cross-validation and how to choose <bold>k</bold> for a <italic>survClust</italic> run. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the input matrix was subjected to 50 rounds of 3-fold cross-validation (2/3 training and 1/3 test). The <italic>survClust</italic> fit for a cluster <bold><italic>k</italic></bold> based on training data from each fold was used to predict cluster membership for the test data. Final sample labels were aggregated over all folds and cluster meaning was preserved across folds via centroid relabeling (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of <italic>survClust.</italic>
<bold>a</bold> A simulated data example, consisting of features that define 3 patient subtypes without direct association with survival (shaded in red), features that define 3 patient subtypes with distinct survival outcome (shaded in blue), and random features generated from Gaussian noise (gray). <bold>b</bold> Euclidean distance matrix demonstrating patient-level pairwise similarity, with darker blue shade representative of higher similarity. Color panels above the distance matrix show the three-class solution obtained by unsupervised algorithm via k-means and the concordance between the simulated 3 survival subtypes (the truth). Kaplan-Meier curves for the 3 unsupervised subtypes show no distinction in survival outcome. <bold>c</bold>
<italic>survClust</italic> employs a patient outcome-weighted distance matrix to identify the desired subtypes with distinct Kaplan-Meier curves. <bold>d</bold>
<italic>survClust</italic> allows integrative analysis of multiple data modalities to identify survival-associated molecular subtypes</p></caption><graphic xlink:href="13073_2020_804_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par41">The logrank test statistic and standardized pooled within-cluster sum of squares was calculated for the consolidated test labels over 3-folds for each round. Additional file <xref rid="MOESM1" ref-type="media">1</xref><bold>:</bold> Fig. S1c summarizes these metrics for 50 rounds of cross-validation for <bold>k</bold> = 2–7. The figure shows that logrank is maximized for <italic>k</italic> = 3, and the standardized pooled within-cluster sum of squares has an elbow at <italic>k</italic> = 3, pointing to the optimal <italic>k</italic> of 3. The final class labels are assigned by consolidating solutions across all folds in all rounds of cross-validations.</p>
      <p id="Par42">It is interesting that the choice of <italic>k</italic> is strongly echoed across these two different metrics. Another simulation scenario is presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2. Here survClust was able to identify the 4-class simulated truth when there is conflicting information present in individual platforms.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results</title>
    <sec id="Sec14">
      <title>The <italic>survClust</italic> model: an overview</title>
      <p id="Par43">The molecular profile of a tumor often harbors information on a multitude of factors including cell lineage, tumor microenvironment, cell differentiation, and other clinical and histopathological features. Some of these factors are associated with treatment response and/or survival outcome, while others are not. If a particular patient outcome (e.g., patient survival) is of interest, a more supervised approach is needed. We demonstrate this using a simulated data example (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). In this scenario, we simulated three risk subgroups in a cohort of 300 hypothetical patient samples with distinct survival hazard rates in each subgroup (a median survival of 4, 3, and 2 years, respectively). A set of 15 features was then simulated from a mixture Gaussian distribution with different means in the three risk subgroups. Another set of 15 features was simulated in the same way but permutated to disrupt the feature-risk group association. A third group of 270 features was simulated from Gaussian noise. Figure <xref rid="Fig1" ref-type="fig">1</xref>b shows that an unsupervised clustering using the K-means algorithm failed to identify the survival subtypes in the context of complex feature variations. To identify outcome-associated clustering solution, <italic>survClust</italic> utilizes a weighted distance metric:
<disp-formula id="Equg"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ d\left(\boldsymbol{a},\boldsymbol{b}\right)=\sqrt{{\left(\boldsymbol{a}-\boldsymbol{b}\right)}^T\ \boldsymbol{W}\left(\boldsymbol{a}-\boldsymbol{b}\right)}, $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13073_2020_804_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">where (<bold><italic>a</italic></bold>, <bold><italic>b</italic></bold>) denote a pair of sample vectors measured for <italic>p</italic> features and <bold><italic>W</italic></bold> is a diagonal weight matrix over <italic>p</italic> features with <bold><italic>W</italic></bold> = <italic>diag</italic> {<italic>w</italic><sub>1</sub>, …, <italic>w</italic><sub><italic>p</italic></sub>}. The weights <italic>w</italic><sub><italic>p</italic></sub> ′ <italic>s</italic> are obtained by fitting a univariable Cox proportional hazards model for each feature in the training data with repeated training-test sample splits for cross-validation (see more details in the “<xref rid="Sec2" ref-type="sec">Methods</xref>” section). Figure <xref rid="Fig1" ref-type="fig">1</xref>c shows that <italic>survClust</italic> was able to identify the true risk groups with 97.15% accuracy [95% CI = 94–100%], whereas the accuracy from an unsupervised clustering was 67.50% without reducing the effect of noise features and features unrelated to survival.</p>
      <p id="Par45">Our algorithm allows the integration of multiple data modalities. Given <italic>m</italic> data types measured over the respective feature space (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d), the algorithm learns a weighted distance matrix from each molecular data type by incorporating a vector of Cox regression hazard ratio as weights. Each feature is weighed and a pairwise distance matrix is calculated <bold>(</bold>we refer to this step as <bold>getDist)</bold>. This step reduces the computation considerably by transforming the problem from sample by feature to sample by sample. Note that different sample sizes across data types are allowed, i.e., a sample can be measured for some but not all platforms. Next, the weighted pairwise distance matrices are integrated by summing overweighted <italic>m</italic> data types (<bold>combineDist</bold>), which retains all samples with at least one data type available, with complete pairwise information. <bold>survClust</bold> then projects the integrated and weighted distance matrix into a lower dimensional space via multidimensional scaling (MDS) and then clusters sample points into subgroups via the K-means algorithm. More details can be found in the “<xref rid="Sec2" ref-type="sec">Methods</xref>” section.</p>
    </sec>
    <sec id="Sec15">
      <title><italic>survClust</italic> is more powerful than unsupervised clustering in identifying clinically relevant molecular subtypes</title>
      <p id="Par46">We applied <italic>survClust</italic> to the TCGA data set including 6209 tumor samples in 18 cancer types to identify survival outcome-associated subtypes defined by somatic mutation, DNA copy number, DNA methylation, mRNA expression, and protein expression, individually and integratively. A summary of the sample sizes and feature space is included in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 compares the survival association (logrank statistic) for the <italic>survClust</italic> integrated subtypes versus those derived from unsupervised clustering methods commonly used in TCGA studies including COCA and iCluster. The logrank statistic compares estimates of the hazard functions of each subgroup to the expected values under the null hypothesis (all subgroups have identical hazard functions). Larger logrank statistic suggests stronger evidence of survival association. For example, although unsupervised classification of the liver cancer samples elaborates on molecularly distinct subtypes, they do not exhibit significant survival separation (<italic>P</italic> = 0.42, logrank statistic = 1.71) [<xref ref-type="bibr" rid="CR20">20</xref>]. The <italic>survClust</italic> integrative classification, on the other hand, identified subtypes that are molecularly distinct and also show significant survival difference (<italic>P</italic> &lt; 0.001, logrank statistic = 21.56) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, Fig. S8). In addition to the multi-platform integrative analysis, we also present a comprehensive comparison of the <italic>survClust</italic> classification vs TCGA unsupervised clustering analysis for each individual molecular platform as summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3–7. By differentially weighting the molecular features by the corresponding survival association in constructing the distance matrix, we show that <italic>survClust</italic> is more powerful for identifying subtypes that are directly relevant to stratify the outcome of interest, leading to substantially more distinct survival subgroups than those existing molecular subclasses obtained by unsupervised clustering. To further demonstrate, we highlight the <italic>survClust</italic> analysis of low-grade glioma and kidney papillary renal cell carcinoma below.</p>
    </sec>
    <sec id="Sec16">
      <title><italic>survClust</italic> identifies a poor prognostic <italic>IDH-</italic>mutant low-grade glioma subgroup</title>
      <p id="Par47">Low-grade gliomas (LGG) have a unique molecular footprint, characterized by <italic>IDH1/2</italic> mutation status and codeletion in chromosome 1p and19q regions of the genome [<xref ref-type="bibr" rid="CR21">21</xref>]. As shown previously, mutations in <italic>IDH1</italic> and <italic>IDH2</italic> genes are present in a majority of the low-grade gliomas and define a subtype associated with favorable prognosis [<xref ref-type="bibr" rid="CR22">22</xref>]. <italic>IDH</italic>-mutant tumors with chromosome 1p and 19q codeletion (<italic>IDH</italic>-mutant-codel) exhibit the most prolonged survival times followed by <italic>IDH</italic>-mutant tumors without the codeletion (<italic>IDH-</italic>mutant-non-codel), with <italic>IDH-</italic>WT tumors demonstrating more aggressive clinical behavior. We performed <italic>survClust</italic> on 6 available molecular platforms (somatic mutation, DNA copy number, DNA methylation, mRNA expression, and protein expression) in 512 LGG samples as profiled by the TCGA. The optimal number of clusters <italic>k</italic> was chosen by assessing <italic>survClust</italic> fits over logrank test statistics and standardized pooled within-cluster sum of squares in cross-validation (see the “<xref rid="Sec2" ref-type="sec">Methods</xref>” section). Cross-validation was performed to ensure unbiased estimation of survival association and to avoid overfitting.</p>
      <p id="Par48">The integrated <italic>survClust</italic> solution for LGG was optimized at <italic>k</italic> = 5, with the <italic>IDH</italic>-mutant-codel (c3) and <italic>IDH</italic>-mutant-non-codel (c1) subtypes associated with good prognosis as expected (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). By contrast, the <italic>IDH</italic>-WT subclass (c5) showed association with poor survival, enriched for mutations in <italic>EGFR</italic> and <italic>PTEN</italic> gene and concurrent chromosome 7 gain and 10 loss, resembling glioblastomas. Interestingly, <italic>survClust</italic> identified a small <italic>IDH</italic>-mutant subtype characterized by <italic>CDKN2A</italic> deletion (c4) that showed markedly worse survival among the <italic>IDH</italic>-mutant tumors, similar to the <italic>IDH</italic>-WT group (c5) that tends to behave far more aggressively with prognosis similar to glioblastomas. In addition, a copy number quiet subgroup (c2) was identified that showed high expression of mir-1307 and mir-29c (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). These results highlight the strength of <italic>survClust</italic> in identifying clinically relevant molecular stratifications and the potential to refine the existing paradigm in glioma subtyping to inform clinical decision-making.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Outcome-weighted integrative clustering of low-grade glioma (LGG) and kidney papillary cell carcinoma using <italic>survClust</italic>. <bold>a</bold>
<italic>survClust</italic> identifies an <italic>IDH</italic>-mutant <italic>CDKN2A</italic>-loss subtype similar to <italic>IDH</italic>-wt tumors in terms of the aggressive clinical behavior. Top: Kaplan-Meier curves of the integrated <italic>survClust</italic> subtypes of LGG. Middle: <italic>Panelmap</italic> summarizing major association of mutational and clinical features of the integrated LGG subtypes. Bottom: Copy number profile for each of the integrated subtypes. <bold>b</bold>
<italic>survClust</italic> identifies prognostic kidney papillary renal cell carcinoma (KIRP) subtypes</p></caption><graphic xlink:href="13073_2020_804_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title><italic>survClust</italic> identifies prognostic subtypes of kidney papillary renal cell carcinoma (KIRP)</title>
      <p id="Par49">Three survival distinct subtypes were identified using <italic>survClust</italic> integrating DNA copy number, mRNA expression, DNA methylation, and miRNA and protein expression profiles of 289 tumor samples. The c3 subtype was associated with poor survival (median survival time = 1.63 years) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), younger age (median age 57 years), and the female gender (55%). The defining genomic characteristics include <italic>CDKN2A</italic> loss and arm-level gains in multiple chromosomes including 7, 12, 15, and 17 as described previously [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
    </sec>
    <sec id="Sec18">
      <title><italic>survClust</italic> identifies clinically relevant mutational subgroups across cancer types</title>
      <p id="Par50"><italic>survClust</italic> is a flexible framework and can be applied to individual data types for patient stratification. For example, somatic mutation-based stratification is often of interest in a clinical sequencing setting. To illustrate this, we applied <italic>survClust</italic> to mutation data alone using a hazard ratio weighted binary distance-based clustering. A <italic>circomap</italic> plot was created to facilitate annotation and visualization of the results across cancer types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). <italic>survClust</italic> identified high TMB subgroups in nearly all cancer types included in this analysis. Correlating mutational signatures [<xref ref-type="bibr" rid="CR24">24</xref>] with these subtypes in <italic>circomap</italic> further revealed etiology underlying these hypermutated tumors. The smoking signature tracks lung cancer (LUSC and LUAD) and the subset of head and neck cancer (HNSC) with elevated TMB. The DNA mismatch repair (MMR) signature tracks high TMB subgroups in stomach cancer (STAD), endometrial cancer (UCEC), and colon cancer (COAD). The APOBEC signature is prevalent in the bladder (BLCA) and cervical cancers (CESC). Finally, the aristolochic acid signature (signature 22) is enriched in a liver cancer subgroup identified by <italic>survClust</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4e), which is consistent with aristolochic acid and their derivatives being implicated in liver cancers in Asian populations [<xref ref-type="bibr" rid="CR25">25</xref>].
<fig id="Fig3"><label>Fig. 3</label><caption><p><italic>survClust</italic> identifies mutational subtypes associated with survival across cancer types. <bold>a</bold>
<italic>Circomap</italic> showing total mutation burden (TMB) in brown color and mutational signatures (smoking, MMR, APOBEC, POLE, and aging) in tumors across bladder (BLCA), cervical (CESC), colon (COAD), head and neck (HNSC), liver (LIHC), lung adenocarcinoma (LUAD), lung squamous cell (LUSC), stomach (STAD), and endometrial (UCEC) cancers. Outer circle indicates mutation-based <italic>survClust</italic> membership. <bold>b</bold>
<italic>survClust</italic> mutation subtypes in endometrial cancer<bold>.</bold> From top to bottom<italic>:</italic> Kaplan-Meier curves for the 4 mutation subtypes; <italic>panelmap</italic> depicting significantly mutated genes, MSI status, histology, and TMB associated with the subtypes; and beeswarm plot showing CD8 T cell marker expression (<italic>y</italic>-axis) across the 4 subtypes (<italic>x</italic>-axis). Red line depicts the median, and top and bottom black bars represent the 25th and 75th percentile, respectively. <bold>c</bold>
<italic>survClust</italic> mutation subtypes in bladder cancer. From top to bottom: Kaplan-Meier curves for the 3 mutation subtypes; <italic>panelmap</italic> depicting significantly mutated genes, APOBEC load, and TMB associated with the 3 subtypes; and beeswarm plot showing CD8 T cell expression (<italic>y</italic>-axis) across the 3 subtypes (<italic>x</italic>-axis)</p></caption><graphic xlink:href="13073_2020_804_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par51">In endometrial cancer, <italic>survClust</italic> confirmed a previously known ultra-high mutated subtype associated with the POLE mutation signature (c2) and a hypermutated microsatellite instability (MSI) (c4) subtype [<xref ref-type="bibr" rid="CR26">26</xref>] (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). The <italic>panelmap</italic> in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b (middle panel) shows that c4 correlated well with clinical MSI status (<italic>P</italic> &lt; 0.001) and predominantly carried mutants in <italic>ARID1A</italic>, <italic>PIK3CA,</italic> and <italic>PTEN</italic> genes. The c1 subtype, consisting of primarily high-grade serious tumors, was associated with the worse outcome with a 5-year survival of 58% compared to 95%, 84%, and 83% for c2 (POLE), c3, and c4 (MMR), respectively, and characterized by higher frequency of mutations in <italic>TP53</italic>, <italic>PPP2R1A</italic> genes, low TMB, and older patients with serous endometrial tumors (60%). The c3 subtype was characterized by a higher frequency of <italic>CTNNB1</italic> mutants. Immune cell decomposition data derived using the CIBERSORT [<xref ref-type="bibr" rid="CR27">27</xref>] algorithm was also correlated with the subgroups. Interestingly, high expression of CD8 T cell immune marker was observed in the POLE (c2) and MSI (c4) subtype (<italic>P</italic> &lt; 0.001) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b).</p>
      <p id="Par52"><italic>survClust</italic> stratified the bladder cancer cohort into 3 TMB subgroups—with high (c1), intermediate (c3), and low (c2) mutation burden. The c1 subtype was associated with good outcome, high TMB, high neo-antigen load, high APOBEC load, and high expression of the CD8 T cell immune marker (<italic>P</italic> = 0.002) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). The c3 subtype showed intermediate TMB and APOBEC load with a median survival time of 3.48 years. Patients with a low TMB and low APOBEC load performed the worst in terms of survival with a median survival time of 1.91 years.</p>
      <p id="Par53">A similar pattern emerged when <italic>survClust</italic> was run on colorectal cancer mutation data classifying the disease population into three clusters—two low TMB groups and a MMR-associated high TMB group (c1) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4b). c1 was also associated with CD8 T cell infiltration (<italic>P</italic> = 0.004) and showed concordance with MLH1 silencing status. A similar subdivision of the low TMB group by <italic>TP53</italic> mutation status was seen where c3 carried <italic>TP53</italic> mutant samples unlike c2. Correlation with histology revealed significant enrichment of the mucinous adenocarcinoma subtype in c1 and c2 (c1, <italic>n</italic> = 20, 29%; c2, <italic>n</italic> = 24, 20%) compared to c3 (<italic>n</italic> = 9, 5%). In addition to the hypermutated subtypes of endometrial, bladder, and colorectal cancers, we also observed high TMB subgroups with concurrently high expression of CD8 T cell markers in the cervical cancer c1 subtype (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4a and S5a), head and neck cancer c4 subtype (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4c, S5c), lung adenocarcinoma c3 subtype (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4f and S5f), lung squamous cell carcinoma c4 subtype (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4g and S5g), and stomach cancer c1 subtype (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4h and S5h). There are prior observations that high mutational burden is associated with increased neo-antigen load and activated T cell infiltration in lung cancer [<xref ref-type="bibr" rid="CR28">28</xref>]. Our analysis revealed that such associations may be more widely present in multiple cancer types.</p>
    </sec>
    <sec id="Sec19">
      <title><italic>survClust</italic> identifies distinct copy number subtypes associated with clinical features across cancer types</title>
      <p id="Par54">To identify copy number alterations that define clinically relevant subtypes, segmented data of 18 cancer types was processed via the CBS algorithm [<xref ref-type="bibr" rid="CR29">29</xref>] and analyzed with <italic>survClust</italic>. Subtypes characterized by different degrees in the Fraction of Genome Altered (FGA) emerged in various cancer types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Interestingly, low FGA was associated with better survival in several cancer types including colon, head and neck, lung adenocarcinoma, soft tissue sarcoma, and endometrial cancer (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 and S7).
<fig id="Fig4"><label>Fig. 4</label><caption><p><italic>survClust</italic> identifies copy number patterns associated with patient survival outcome across various cancer types. <bold>a</bold>
<italic>Circomap</italic> showing fraction genome altered (FGA) and gene-level copy number alterations in each tumor across colorectal <italic>(</italic>COAD), head and neck (HNSC), kidney renal papillary cell carcinoma (KIRP), low-grade glioma (LGG), liver (LIHC), lung adenocarcinoma (LUAD), ovarian (OV), soft tissue sarcoma (SARC), and endometiral (UCEC) cancers. The outer circle indicates the <italic>survClust</italic> membership. <bold>b</bold> <italic>survClust</italic> is more powerful than unsupervised clustering in identifying survival-associated copy number subtypes in liver cancer</p></caption><graphic xlink:href="13073_2020_804_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par55">The <italic>circomap</italic> plot in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a also revealed associations of subtypes with high-level amplification of major cancer genes including <italic>CCND1</italic> amplification in head and neck cancer (c3), <italic>CCNE1</italic> (c5) and <italic>AKT2</italic>(c6) amplification in ovarian cancer, and <italic>MDM2</italic> amplification (c4) in sarcoma (S Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). Notably, amplification of the 19q13.2 region in the ovarian cancer c6 subtype harboring the <italic>AKT2</italic> gene is associated with poor survival (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7f, Table S8) which was consistent with previous findings that <italic>AKT2</italic> amplification is associated with ovarian cancer aggressiveness [<xref ref-type="bibr" rid="CR30">30</xref>]. The <italic>CCND1</italic> amplified subtype of head and neck cancer (c3) was also associated with poor survival (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7b). Amplification in the <italic>MYC</italic> gene is broadly present in multiple cancer types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a <italic>circomap</italic>). Among cancer gene deletions, <italic>CDKN2A</italic> loss defined multiple subgroups associated with poor survival including papillary kidney cancer (c1), low-grade glioma (c4), lung adenocarcinoma (c4), and soft tissue sarcoma (c1) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 and S7).</p>
      <p id="Par56">Colorectal cancer was classified into three varying FGA subtypes with prognostic implications. c1 had low FGA, while c2 and c3 carried heavy genome alterations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6a). Even though c1 and c2 had dissimilar FGA, they performed similarly in terms of survival as compared to c3, which had poor outcome with median survival time of 4.5 years (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7a). Gain in the MYC gene was seen throughout the cancer type, and c2 was uniquely characterized by loss of the chromosome 20 p-arm, which harbors the hsa-mir-103–2 previously reported to be downregulated in colorectal tumors [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
      <p id="Par57"><italic>survClust</italic> is designed to capture the contribution of survival-associated molecular features and reduce the influence from those that are not related to the outcome of interest. Figure <xref rid="Fig4" ref-type="fig">4</xref>b provides another example that this approach is better at identifying prognostically relevant subtypes compared to the unsupervised clustering approach applied in the original study [<xref ref-type="bibr" rid="CR20">20</xref>]. <italic>survClust</italic> identified 6 unique CN groups in liver cancer with significant survival differences among subgroups. The c5 subtype was characterized by high FGA and associated with poor outcome with a median survival time of 0.77 years. This cluster was distinguished by a loss of chromosome 15. The c2 subtype was associated with the lowest FGA and a median survival time of 6.81 years. The c4 subtype was enriched for <italic>CDKN2A</italic> deletion with a median survival time of 2.15 years. In contrast, unsupervised clustering generated subgroups with distinct molecular differences but did not show any separation in terms of survival.</p>
    </sec>
    <sec id="Sec20">
      <title>Integration of multiple data types enhances the identification of survival distinct subgroups</title>
      <p id="Par58">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows that the integrated <italic>survClust</italic> solution outperformed individual platforms based on the cross-validated logrank statistics for multiple cancer types including cervical cancer, head and neck cancer, papillary kidney cancer, lower grade glioma, and liver and endometrial cancers. In general, the integrated solutions always emerge at or near the top in performance as compared to the individual platform-specific solutions.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Integration of multiple data types enhances the identification of survival distinct subgroups. <bold>a–h</bold> Each panel has two plots: the plot on the left summarizes median cross-validated logrank statistic across <italic>k</italic> = 2 to 8 (number of clusters). Each line is a data type (see legend), and the black line represents the <italic>survClust</italic> run on integrating all 6 platforms. Plot on the right summarizes the adjusted Rand index between cross-validated <italic>survClust</italic> solutions of individual data types and the integration of all. In this comparison, the <italic>survClust</italic> solution was chosen for an appropriate <italic>k</italic> which maximized logrank statistic and minimized the standardized pooled within sum of squares</p></caption><graphic xlink:href="13073_2020_804_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par59">Next, we used the adjusted Rand index (RI) to evaluate the concordance between different solutions. RI is calculated as the proportion of sample pairs that are assigned together in the same cluster in one solution versus another, adjusted for what is expected by random chance. It provides an indirect measure of how much a particular data type contributes to the integrated solution. A non-zero adjusted RI across solutions would suggest shared biology across assay types in some tumors. For example, the mutation subtypes of endometrial cancer (Fig. <xref rid="Fig5" ref-type="fig">5</xref>h) have the highest adjusted RI (0.56) as compared to the integrated solution, which is consistent with the fact that POLE and MSI are the two major prognostic subtypes that are predominantly defined through mutation burden (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Nevertheless, the integrated solution also shows clearly that there is additional information in DNA methylation, DNA copy number, and mRNA expression being effectively incorporated by <italic>survClust</italic> that improves the survival stratification. In bladder cancer, the integrated solution is most concordant with the mRNA cluster solution (adjusted RI = 0.39), which indicates influence by mRNA features toward integration (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Classification by mutation data type seemed to have little or no overlap between other assays (adjusted RI close to 0), although the integrated solution retained some information. (adjusted RI = 0.03).</p>
      <p id="Par60">The integrated solution classified cervical cancer samples better than the rest of the platforms and pointed toward a 5-cluster solution (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Interestingly, a high degree of heterogeneity among different platforms was observed as represented by a small adjusted RI across the board. The head and neck cancer integrated solution showed great improvement over individual platforms for <italic>k</italic> &gt; 2 solutions. The <italic>k</italic> = 4 integrated solution clearly resulted from effective integration of multiple data types including DNA methylation, DNA copy number, and mRNA expression with adjusted RIs of 0.33, 0.26, and 0.25, respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). In this case, RPPA provided very little information toward the integrated solution.</p>
      <p id="Par61">The integrated survClust analysis stratified papillary kidney cancer type into 3 groups, with CN sharing maximum information with the integrated solution (adjusted RI = 0.32), followed by mRNA (0.31), miRNA (0.24), RPPA (0.23), and methylation (0.19). Lower grade glioma displayed a wide range of variability among platform type in terms of the logrank statistic (logrank statistic, <italic>x</italic>-axis from 0 to 250). The <italic>k</italic> = 5 integrated solution performed the best among the 6 platforms with larger contributions from mRNA (RI = 0.63), copy number (RI = 0.62), and mutation (RI = 0.57) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). The integrated solution of liver cancer did not show much improvement over individual assay types. Note that we did not use protein data while integrating as more than half was missing (RPPA, <italic>n</italic> = 182; integrated <italic>n</italic> = 371). miRNA, mRNA, and copy number showed high median logrank statistics over rounds of cross-validation demonstrating their role as potential prognostic classifiers.</p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Discussion</title>
    <p id="Par62">Cancer is a complex disease. Integrative analysis of multi-omic molecular profiling has the potential to unpack the complexity of the disease to reveal insights into disease etiology and to identify subtypes with distinct outcome for clinical utility. Unsupervised clustering methods have been developed to define cancer subtypes across multiple data modalities [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>] and to stratify cancer patients into molecularly distinct subtypes. In some cases, these molecular subtypes were shown to be associated with survival such as the integrated subtypes of breast cancer [<xref ref-type="bibr" rid="CR33">33</xref>]. In other cases, unsupervised molecular stratification led to subtypes related to other factors such as the etiologically distinct molecular subtypes in gastric adenocarcinoma cancer [<xref ref-type="bibr" rid="CR34">34</xref>], the histology-associated molecular subtypes of esophageal cancer [<xref ref-type="bibr" rid="CR35">35</xref>], and the cell-of-origin-driven pan-cancer subtypes [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par63">When unsupervised clustering does not lead to survival-associated subtypes, a supervised approach is needed in order to identify clinically relevant patient stratifications. Nevertheless, there is a lack of supervised clustering methods specifically designed for cancer genomics application, which emphasizes the potential utility of <italic>survClust</italic>. A strong use-case scenario for such an approach is explained in the simulation example presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, where unsupervised clustering alone was not enough to distinguish survival-associated clusters unless survival unrelated features are downweighed, by an approach like <italic>survClust</italic>. Similar limitation of such a canonical clustering approach can also be seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, where classic unsupervised clustering identified copy number distinct classes not associated with any prognostic significance in liver cancer samples.</p>
    <p id="Par64">Our approach is innovative in several aspects. First, it directly incorporates survival information in the clustering approach by utilizing weighted distance matrices. Specifically, molecular features are weighted by their corresponding log-hazard ratio (logHR) estimated from univariable Cox regression from training data. As a result, informative features will have large weights in clustering whereas noninformative features will have weights close to zero and thus minimal influence on the clustering. When unsupervised clustering fails to identify survival-associated subtypes, we show that our supervised analysis allows effective extraction of survival information and leads to clinically relevant molecular stratification. Secondly, <italic>survClust</italic> facilitates multi-modal clustering by integrating the weighted distance matrices. It then projects the integrated and weighted distance matrix into a lower dimensional space via multidimensional scaling (MDS) in which sample points are organized into subgroups via the K-means algorithm. Our analysis showed that the integrated analysis outperformed the individual data types in multiple cancer types, highlighting the importance of the multi-omic approach. Finally, we developed various visualization tools including <italic>panelmap</italic> and <italic>circomap</italic> that greatly facilitate the interpretation of the results.</p>
    <p id="Par65">As more clinically annotated genomic data becomes available as a result of clinical sequencing programs [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>], our method will provide a useful tool to facilitate patient stratification for clinical decision-making. In this study, we analyzed 18 cancer types in ~ 6200 tumors. Each disease type was classified by <italic>survClust</italic> based on six molecular assays—somatic point mutation, DNA copy number, DNA methylation, mRNA expression, miRNA expression, protein expression, and integration of the aforementioned six assays.</p>
    <p id="Par66">The supervised clustering approach provides a more direct way to identify survival-associated molecular subclasses, leading to substantially more distinct survival subgroups than those existing molecular subclasses obtained by unsupervised clustering. In this study, <italic>survClust</italic> analysis of copy number data alone identified aggressive clinical behavior of tumors with <italic>CDKN2A</italic> deletion in multiple cancer types, and poor survival for a subtype of ovarian cancer carrying aberration on Chromosome 19. Furthermore, the integrated clustering analysis via <italic>survClust</italic> shed light on clinical subtypes that were not identified by individual platform alone. For instance, the integrative analysis of the glioma using <italic>survClust</italic> revealed a small novel subtype characterized by <italic>CDKN2A</italic> deletion and <italic>IDH1/2</italic> mutation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), whereas the individual platform analysis mostly agreed with previously known subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4d, S6d). This again underlines the power of the proposed approach in identifying novel clinically relevant subtypes by integrating across ‘omics data types and their underlying association with outcome.</p>
    <p id="Par67">There are several limitations to our current approach. First, the current method focuses on time to event outcome (patient survival) as the clinical endpoint of interest. A future extension of the algorithm will be needed for molecular stratification associated with other types of outcome such as treatment response which requires a modification of the weighting scheme appropriate for binary and categorical types of outcome. Secondly, the current integration across multiple data types does not allow different weights for the distance matrices computed from each individual data modality. A weighted matrix integration may further allow more flexible integration of the different data types. Also, the integrated results presented in the paper were run on a large feature space (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) that retains as many samples as possible across individual data types. Although such an approach is more comprehensive, the computational cost is high. Feature selection approach may be considered to further improve computational efficiency in future work.</p>
  </sec>
  <sec id="Sec22">
    <title>Conclusions</title>
    <p id="Par68">In molecular stratification analysis, it is common to apply an existing unsupervised clustering method followed by a post hoc clinical association analysis. Such a “two-step” approach does not always guarantee the molecular subtypes are prognostically distinct as we demonstrated in our study. To address this challenge, we developed the <italic>survClust</italic> algorithm as a more powerful supervised learning approach, aiming at the identification of cancer subtypes that are not just molecularly distinct, but also prognostically significant. We analyzed over 6000 tumors across 18 cancer types from the Cancer Genome Atlas study, across six molecular data types including somatic point mutations, DNA copy number, DNA methylation, mRNA expression, miRNA expression, protein expression, and the integration of the six data modalities. The results have revealed prognostic molecular subtypes not previously identified by unsupervised clustering.</p>
  </sec>
  <sec id="Sec23">
    <title>Availability and requirements</title>
    <p id="Par69">Project name: survClust</p>
    <p id="Par70">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/arorarshi/survClust">https://github.com/arorarshi/survClust</ext-link></p>
    <p id="Par71">Operating system(s): Linux, Mac OS X, Windows</p>
    <p id="Par72">Programming language: R</p>
    <p id="Par73">License: GNU, GPL</p>
    <p id="Par74">Any restrictions to use by non-academics: None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2020_804_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Supplemental File containing all Supplemental Figures, Supplemental Tables, and Supplemental Note including additional details on the method and data analysis. <bold>Table S1.</bold> Supplementary Table summarizing input data of 18 cancer types across number of samples analyzed and total number of features that went into clustering for mutation, Copy Number (CN), Methylation, mRNA expression, miRNA and Protein. <bold>Table S2.</bold> Supplementary Table showing comparisons of survClust integrated solution versus unsupervised clustering results from published TCGA studies. <bold>Table S3.</bold> Summary of survival association for the survClust Copy Number solutions versus unsupervised TCGA solutions using the logrank statistic. <bold>Table S4.</bold> Summary of survival association for the survClust Methylation expression solution versus available TCGA solutions using the logrank statistic. <bold>Table S5.</bold> Summary of survival association for the survClust mRNA expression solution versus available TCGA solutions using the logrank statistic. <bold>Table S6.</bold> Summary of survival association for the survClust miRNA expression solution versus available TCGA solutions using the logrank statistic. <bold>Table S7.</bold> Summary of survival association for the survClust Protein expression solution vs available TCGA solutions using the logrank statistic. <bold>Table S8.</bold> Cross tabulation of the ovarian cancer copy number survClust class labels vs <italic>AKT</italic> gene Copy number changes. <bold>Figure S1.</bold> survClust simulation analysis. <bold>Figure S2.</bold> A second simulation example. <bold>Figure S3.</bold> survClust integrated solution of low grade glioma (LGG). <bold>Figure S4.</bold> survClust identifies tumor mutation burden (TMB) patterns across cancer types. <bold>Figure S5.</bold> CD8 expression stratified by the survClust mutation subclasses across various cancer types. <bold>Figure S6.</bold> survClus tidentifies copy number alteration patterns across cancer types, Global view of Copy Number Changes. <bold>Figure S7.</bold> survClust identifies FGA patterns across cancer types that associate with survival (Kaplan Meier curves). <bold>Figure S8.</bold> survClust integrated solution across six molecular platforms in various cancer types. <bold>Supplementary Note</bold> Description of data pre-processing, simulation details and the centroid re-labeling approach.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s13073-020-00804-8.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank the Associate Editor and the reviewers for their valuable comments.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AA, ABO, VES, and RS developed the methodology and designed the study. AA developed the software implementation and performed the data analysis. AA and RS designed and prepared the figures and tables and drafted the manuscript. ABO and VES assisted in writing the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>AA, VES, and RS are supported by National Cancer Institute (NCI) Cancer Center Support Grant P30 CA008748-54. AA and RS are partially supported by NCI P01 CA206980. ABO is supported by NCI Cancer Center Support Grant P30CA082103.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>survClust</italic> is freely available as an R package at our github repository [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    <p>Mutation data along with relevant clinical annotations were plotted using <italic>panelmap</italic> [<xref ref-type="bibr" rid="CR39">39</xref>]. The <italic>Circos</italic> package was used to make pan-cancer plots, and the code used for these plots is available in a function called <italic>circomap</italic> [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    <p>All datasets are available at the NCI genomic data commons website [<xref ref-type="bibr" rid="CR40">40</xref>]. Details on how the data was processed for the results shown in the manuscript are discussed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par75">All patient data are open access data from the Cancer Genome Atlas (TCGA) study obtained from Genomic Data Commons and the PanCanAtlas publication website. This study was a retrospective analysis of existing public access patient data from TCGA; therefore, patient consent was not required.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par76">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par77">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Ladanyi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Integrative clustering of multiple genomic data types using a joint latent variable model with application to breast and lung cancer subtype analysis</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2906</fpage>
        <lpage>2912</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp543</pub-id>
        <?supplied-pmid 19759197?>
        <pub-id pub-id-type="pmid">19759197</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mo</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pattern discovery and cancer gene identification in integrated cancer genomic data</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>4245</fpage>
        <lpage>4250</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1208949110</pub-id>
        <?supplied-pmid 23431203?>
        <pub-id pub-id-type="pmid">23431203</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaske</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inference of patient-specific pathway activities from multi-dimensional cancer genomics data using PARADIGM</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>i237</fpage>
        <lpage>i245</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq182</pub-id>
        <?supplied-pmid 20529912?>
        <pub-id pub-id-type="pmid">20529912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues of origin</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>158</volume>
        <fpage>929</fpage>
        <lpage>944</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.06.049</pub-id>
        <?supplied-pmid 25109877?>
        <pub-id pub-id-type="pmid">25109877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Similarity network fusion for aggregating data types on a genomic scale</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>333</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2810</pub-id>
        <?supplied-pmid 24464287?>
        <pub-id pub-id-type="pmid">24464287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramazzotti</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Multi-omic tumor data reveal diversity of molecular mechanisms that correlate with survival</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>4453</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06921-8</pub-id>
        <?supplied-pmid 30367051?>
        <pub-id pub-id-type="pmid">30367051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Xing E, Michael J, Stuart JR, Andrew Ng. Distance metric learning with application to clustering with side-information. Adv Neural Inf Processing Systems. 2002;15:521–8.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-of-origin patterns dominate the molecular classification of 10,000 tumors from 33 types of cancer</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>291</fpage>
        <lpage>304 e296</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.022</pub-id>
        <?supplied-pmid 29625048?>
        <pub-id pub-id-type="pmid">29625048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorsson</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The immune landscape of cancer</article-title>
        <source>Immunity</source>
        <year>2018</year>
        <volume>48</volume>
        <fpage>812</fpage>
        <lpage>830 e814</lpage>
        <pub-id pub-id-type="doi">10.1016/j.immuni.2018.03.023</pub-id>
        <?supplied-pmid 5982584?>
        <pub-id pub-id-type="pmid">29628290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malta</surname>
            <given-names>TM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Machine learning identifies stemness features associated with oncogenic dedifferentiation</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>338</fpage>
        <lpage>354 e315</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.034</pub-id>
        <?supplied-pmid 5902191?>
        <pub-id pub-id-type="pmid">29625051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanchez-Vega</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Oncogenic signaling pathways in The Cancer Genome Atlas</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>321</fpage>
        <lpage>337 e310</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.035</pub-id>
        <?supplied-pmid 6070353?>
        <pub-id pub-id-type="pmid">29625050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novembre</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genes mirror geography within Europe</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>98</fpage>
        <lpage>U95</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07331</pub-id>
        <?supplied-pmid 18758442?>
        <pub-id pub-id-type="pmid">18758442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Torgerson</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <source>Theory and methods of scaling</source>
        <year>1958</year>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartigan</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Algorithm AS 136: a k-means clustering algorithm</article-title>
        <source>J J Royal Stat Soc Series C</source>
        <year>1979</year>
        <volume>28</volume>
        <fpage>100</fpage>
        <lpage>108</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardia</surname>
            <given-names>K</given-names>
          </name>
          <collab>V. &amp; Methods</collab>
        </person-group>
        <article-title>Some properties of clasical multi-dimesional scaling</article-title>
        <source>J Commun Stat Theory</source>
        <year>1978</year>
        <volume>7</volume>
        <fpage>1233</fpage>
        <lpage>1241</lpage>
        <pub-id pub-id-type="doi">10.1080/03610927808827707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gallagher</surname>
            <given-names>ED</given-names>
          </name>
        </person-group>
        <article-title>Ecologically meaningful transformations for ordination of species data</article-title>
        <source>Oecologia</source>
        <year>2001</year>
        <volume>129</volume>
        <fpage>271</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1007/s004420100716</pub-id>
        <pub-id pub-id-type="pmid">28547606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Maes</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Multivariate analysis</source>
        <year>1979</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Academic press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrington</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Fleming</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>A class of rank test procedures for censored survival-data</article-title>
        <source>Biometrika</source>
        <year>1982</year>
        <volume>69</volume>
        <fpage>553</fpage>
        <lpage>566</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/69.3.553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>
        <source>J Roy Stat Soc B</source>
        <year>2001</year>
        <volume>63</volume>
        <fpage>411</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Ally A, Balasundaram M, Carlsen R, Chuah E, Clarke A, Dhalla N, Holt RA, Jones SJ, Lee D, Ma Y, Marra MA .Comprehensive and integrative genomic characterization of hepatocellular carcinoma. Cell. 2017;169(7):1327-41.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Network, C. G. A. R</collab>
        </person-group>
        <article-title>Comprehensive, integrative genomic analysis of diffuse lower-grade gliomas</article-title>
        <source>N Engl J. Med.</source>
        <year>2015</year>
        <volume>372</volume>
        <fpage>2481</fpage>
        <lpage>2498</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1402121</pub-id>
        <pub-id pub-id-type="pmid">26061751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yan</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IDH1 and IDH2 mutations in gliomas</article-title>
        <source>N Engl J Med</source>
        <year>2009</year>
        <volume>360</volume>
        <fpage>765</fpage>
        <lpage>773</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa0808710</pub-id>
        <?supplied-pmid 19228619?>
        <pub-id pub-id-type="pmid">19228619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Network, C. G. A. R</collab>
        </person-group>
        <article-title>Comprehensive molecular characterization of papillary renal-cell carcinoma</article-title>
        <source>N Engl J Med</source>
        <year>2016</year>
        <volume>374</volume>
        <fpage>135</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1505917</pub-id>
        <pub-id pub-id-type="pmid">26536169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Alexandrov LB, et al. Signatures of mutational processes in human cancer. Nature. 2013;500(7463):415–21.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Zhou, Q et al<italic>.</italic> Worldwide research trends on aristolochic acids (1957–2017): suggestions for researchers. PloS one. 2019;14(5);e0216135.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated genomic characterization of endometrial carcinoma</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>497</volume>
        <fpage>67</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12113</pub-id>
        <pub-id pub-id-type="pmid">23636398</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chae</surname>
            <given-names>YK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutations in DNA repair genes are associated with increased neo-antigen load and activated T cell infiltration in lung adenocarcinoma</article-title>
        <source>Oncotarget</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>7949</fpage>
        <lpage>7960</lpage>
        <pub-id pub-id-type="doi">10.18632/oncotarget.23742</pub-id>
        <?supplied-pmid 29487705?>
        <pub-id pub-id-type="pmid">29487705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Lucito</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wigler</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxh008</pub-id>
        <?supplied-pmid 15475419?>
        <pub-id pub-id-type="pmid">15475419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bellacosa</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular alterations of the Akt2 oncogene in ovarian and breast carcinomas</article-title>
        <source>Int J Cancer</source>
        <year>1995</year>
        <volume>64</volume>
        <fpage>280</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.2910640412</pub-id>
        <?supplied-pmid 7657393?>
        <pub-id pub-id-type="pmid">7657393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheffer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Association of survival and disease progression with chromosomal instability: a genomic exploration of colorectal cancer</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>7131</fpage>
        <lpage>7136</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0902232106</pub-id>
        <?supplied-pmid 19359472?>
        <pub-id pub-id-type="pmid">19359472</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cummins</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The colorectal microRNAome</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2006</year>
        <volume>103</volume>
        <fpage>3687</fpage>
        <lpage>3692</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0511155103</pub-id>
        <?supplied-pmid 16505370?>
        <pub-id pub-id-type="pmid">16505370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Curtis</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genomic and transcriptomic architecture of 2,000 breast tumours reveals novel subgroups</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>346</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10983</pub-id>
        <pub-id pub-id-type="pmid">22522925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Network, C. G. A. R</collab>
        </person-group>
        <article-title>Comprehensive molecular characterization of gastric adenocarcinoma</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>513</volume>
        <fpage>202</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13480</pub-id>
        <pub-id pub-id-type="pmid">25079317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Network, C. G. A. R</collab>
        </person-group>
        <article-title>Integrated genomic characterization of oesophageal carcinoma</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>541</volume>
        <fpage>169</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1038/nature20805</pub-id>
        <pub-id pub-id-type="pmid">28052061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Zehir A, et al. Mutational landscape of metastatic cancer revealed from prospective clinical sequencing of 10,000 patients. Nat Med. 2017. 23(6);703.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Micheel CM, et al<italic>.</italic> American Association for Cancer Research Project Genomics Evidence Neoplasia Information Exchange: from inception to first data release and beyond—lessons learned and member institutions’ perspectives. JCO Clin Cancer Informatics. 2018;2:1–14.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Arora</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>arorarshi/survClust: integrated supervised clustering based on survival data</source>
        <year>2020</year>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Arora</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>arorarshi/panelmap: a data visualization tool for summarizing categorical and continuous data types for known groups</source>
        <year>2020</year>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>Commons, N. G. d</collab>
        </person-group>
        <source>Cell-of-origin patterns dominate the molecular classification of 10,000 tumors from 33 types of cancer</source>
        <year>2018</year>
      </element-citation>
    </ref>
  </ref-list>
</back>
