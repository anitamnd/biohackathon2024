<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8570784</article-id>
    <article-id pub-id-type="pmid">34358287</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab578</article-id>
    <article-id pub-id-type="publisher-id">btab578</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Bioimage Informatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OpenPhi: an interface to access Philips iSyntax whole slide images for computational pathology</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Mulliqi</surname>
          <given-names>Nita</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 171 77 Stockholm, <country country="SE">Sweden</country></aff>
        <xref rid="btab578-cor1" ref-type="corresp"/>
        <xref rid="btab578-FM1" ref-type="author-notes"/>
        <!--nita.mulliqi@ki.se-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9470-4783</contrib-id>
        <name>
          <surname>Kartasalo</surname>
          <given-names>Kimmo</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 171 77 Stockholm, <country country="SE">Sweden</country></aff>
        <aff><institution>Faculty of Medicine and Health Technology, Tampere University</institution>, 33014 Tampere, <country country="FI">Finland</country></aff>
        <xref rid="btab578-cor1" ref-type="corresp"/>
        <!--kimmo.kartasalo@ki.se-->
        <xref rid="btab578-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olsson</surname>
          <given-names>Henrik</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 171 77 Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Xiaoyi</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 171 77 Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Egevad</surname>
          <given-names>Lars</given-names>
        </name>
        <aff><institution>Department of Oncology and Pathology, Karolinska Institutet</institution>, 171 64 Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eklund</surname>
          <given-names>Martin</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 171 77 Stockholm, <country country="SE">Sweden</country></aff>
        <xref rid="btab578-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9086-9591</contrib-id>
        <name>
          <surname>Ruusuvuori</surname>
          <given-names>Pekka</given-names>
        </name>
        <aff><institution>Faculty of Medicine and Health Technology, Tampere University</institution>, 33014 Tampere, <country country="FI">Finland</country></aff>
        <aff><institution>Institute of Biomedicine, University of Turku</institution>, 20014 Turku, <country country="FI">Finland</country></aff>
        <xref rid="btab578-FM2" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Vitek</surname>
          <given-names>Olga</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btab578-FM1">
        <p>The first two authors, Nita Mulliqi and Kimmo Kartasalo, should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="btab578-FM2">
        <p>The authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Last Authors.</p>
      </fn>
      <corresp id="btab578-cor1">To whom correspondence should be addressed. <email>nita.mulliqi@ki.se</email> or <email>kimmo.kartasalo@ki.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-08-06">
      <day>06</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>21</issue>
    <fpage>3995</fpage>
    <lpage>3997</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>03</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>17</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab578.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Digital pathology enables applying computational methods, such as deep learning, in pathology for improved diagnostics and prognostics, but lack of interoperability between whole slide image formats of different scanner vendors is a challenge for algorithm developers. We present OpenPhi—Open PatHology Interface, an Application Programming Interface for seamless access to the iSyntax format used by the Philips Ultra Fast Scanner, the first digital pathology scanner approved by the United States Food and Drug Administration. OpenPhi is extensible and easily interfaced with existing vendor-neutral applications.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>OpenPhi is implemented in Python and is available as open-source under the MIT license at: <ext-link xlink:href="https://gitlab.com/BioimageInformaticsGroup/openphi" ext-link-type="uri">https://gitlab.com/BioimageInformaticsGroup/openphi</ext-link>. The Philips Software Development Kit is required and available at: <ext-link xlink:href="https://www.openpathology.philips.com" ext-link-type="uri">https://www.openpathology.philips.com</ext-link>. OpenPhi version 1.1.1 is additionally provided as Supplementary Data.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2019-01466</award-id>
        <award-id>2020-00692</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002341</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>341967</award-id>
        <award-id>334782</award-id>
        <award-id>335976</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Pathology is transitioning into a digital discipline (<xref rid="btab578-B7" ref-type="bibr">Pantanowitz <italic toggle="yes">et al.</italic>, 2018</xref>). Digitization of microscopy slides into Whole Slide Images (WSI) has been feasible for over 20 years, but the milestone event of regulatory approval by the United States Food and Drug Administration (FDA) for the Philips Ultra Fast Scanner (UFS), based on non-inferiority to conventional microscopy (<xref rid="btab578-B6" ref-type="bibr">Mukhopadhyay <italic toggle="yes">et al.</italic>, 2018</xref>), is expected to promote the clinical adoption of the technology. Application of image analysis and deep learning on WSI data has enabled computational pathology, which aims at e.g. improved diagnosis and prognosis of diseases and reduction of inter-observer variability among pathologists (<xref rid="btab578-B1" ref-type="bibr">Bera <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>However, the nature of WSI data imposes challenges to developers. The multi-gigapixel WSIs frequently exceed memory capacity, a problem typically tackled by resolution pyramid approaches implemented in image formats specific to each scanner vendor. As a consequence, standard image processing libraries cannot be used with WSIs. The Digital Imaging and Communications in Medicine (DICOM) Standards Committee Working Group 26 has released a standard to improve the interoperability of WSIs (<xref rid="btab578-B8" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2011</xref>) which, despite its potential, has still not been widely adopted (<xref rid="btab578-B4" ref-type="bibr">Herrmann <italic toggle="yes">et al.</italic>, 2018</xref>). Reverse engineering of proprietary formats has resulted in vendor-neutral WSI libraries such as OpenSlide (<xref rid="btab578-B3" ref-type="bibr">Goode <italic toggle="yes">et al.</italic>, 2013</xref>). However, none of these libraries support the Philips iSyntax format (<xref rid="btab578-B5" ref-type="bibr">Hulsken, 2020</xref>). With increasing clinical use of the FDA approved Philips UFS, it is crucial for developers to have efficient ways of accessing the growing number of iSyntax WSIs. One approach for circumventing this issue is converting iSyntax to an open format (<ext-link xlink:href="https://github.com/glencoesoftware/isyntax2raw" ext-link-type="uri">https://github.com/glencoesoftware/isyntax2raw</ext-link>), e.g. OME-TIFF (<xref rid="btab578-B2" ref-type="bibr">Besson <italic toggle="yes">et al.</italic>, 2019</xref>). However, conversion is problematic in the case of large datasets, since typically one is also required to archive the original data. Moreover, in view of clinical use, utilizing the native format of the scanner may be desirable due to regulatory considerations.</p>
    <p>Philips recently released a Software Development Kit (SDK) for iSyntax, but several challenges remain. Firstly, the SDK represents a relatively low-level interface requiring familiarity with the non-standard iSyntax format. This not only slows down algorithm development, but also increases the risk of software bugs. Secondly, since iSyntax and the SDK are proprietary and closed source, they have thus far not been incorporated into libraries such as OpenSlide. This means developers cannot rely on a single vendor-neutral application programming interface (API) for compatibility across scanners, but need to customize software for Philips. To mitigate these problems, we present OpenPhi—Open PatHology Interface, an API that functions as a compatibility layer on top of the Philips SDK. OpenPhi works as a plug-in interface in Python, the language widely used by deep learning libraries and developers.</p>
  </sec>
  <sec>
    <title>2 Methodology and key features</title>
    <p>The structure of OpenPhi follows the iSyntax data model (<xref rid="btab578-F1" ref-type="fig">Fig. 1</xref>). The names, parameters and output of the API methods adhere to the OpenSlide Python API, allowing adapting existing vendor-neutral code for iSyntax compatibility by replacing OpenSlide with OpenPhi. OpenPhi itself has no strict requirements for the operating system or Python version. To meet the current requirements of the Philips SDK 2.0, we developed OpenPhi on Ubuntu 18.04 and Python 3.6.9. We verified the practical usability of OpenPhi by integrating it with a previously developed deep learning framework for Gleason grading of prostate biopsies (<xref rid="btab578-B9" ref-type="bibr">Ström <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <fig position="float" id="btab578-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Left: WSIs contain: (1) a label image for sample identification, (2) a macro image of the glass slide and (3) a multiresolution pyramid of the high-resolution pixel data. OpenPhi provides a compatibility layer, facilitating access to iSyntax WSIs via the Philips SDK, while adhering to a unified API consistent with the OpenSlide Python API. Middle: streamlined access to the images and metadata is provided to developers by a set of high-level methods. Right: applications capable of analyzing WSIs in vendor-neutral manner can be built relying on the unified API.</p>
      </caption>
      <graphic xlink:href="btab578f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Reading label and macro images</title>
      <p>The label image associated with an iSyntax file typically contains some form of sample identification numbers in a format specific to each clinical laboratory, and can be e.g. processed using optical character recognition algorithms to extract this information. The macro image, representing a low-resolution view of the glass slide acquired before scanning, may be utilized e.g. for coarse segmentation tasks or for troubleshooting purposes.</p>
    </sec>
    <sec>
      <title>2.2 Reading regions of interest</title>
      <p>The <italic toggle="yes">read_region</italic> method extracts pixel data from a rectangular region in the WSI at a desired resolution. Typically, only a limited amount of pixels are required at any given time by downstream applications, necessitating efficient random access across different locations and resolution levels. Unlike most WSI formats, iSyntax achieves this using a recursive Discrete Wavelet Transform to avoid storing downsampled copies of the image. The extracted pixel arrays can be used e.g. as input to deep neural networks.</p>
    </sec>
    <sec>
      <title>2.3 Reading a whole slide image</title>
      <p>The <italic toggle="yes">get_thumbnail</italic> and<italic toggle="yes"> read_wsi</italic> methods read the entire WSI at desired maximum dimensions or a specified resolution, respectively. This is typically performed to obtain a more detailed view of the entire scanned area than the macro image. Typical use cases include segmentation of tissue regions and multi-step analysis with progressively increased resolution.</p>
    </sec>
    <sec>
      <title>2.4 Extracting metadata</title>
      <p>DICOM compliant metadata attributes are extracted as DICOM tags. All other metadata information are provided adhering to the OpenSlide generic properties format. Metadata properties include e.g. dimensions and pixel sizes of each resolution level, imaging parameters and device identifiers. The DICOM metadata tags can for example be utilized by developers building downstream applications capable of generating DICOM compliant output WSIs.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We present OpenPhi, an API that provides developers streamlined access to the Philips iSyntax image format. Building on the API, developers can implement algorithms with minimal effort spent on dealing with the intricacies of the proprietary format and on adapting existing vendor-neutral code. This can facilitate the computational pathology community to utilize the growing resources of WSI data stored in iSyntax format.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab578_Supplementary_Data</label>
      <media xlink:href="btab578_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Carin Cavalli-Björkman, Edvin Lökk, Tony Ström and Peter Ström for technical assistance with whole slide scanning and Teemu Tolonen for providing sample WSIs for testing.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Swedish Research Council [2019-01466, 2020-00692] and Academy of Finland [341967, 334782, 335976].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>The data underlying this article are available in Zenodo, at <ext-link xlink:href="https://doi.org/10.5281/zenodo.5037046" ext-link-type="uri">https://doi.org/10.5281/zenodo.5037046</ext-link>.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab578-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bera</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Artificial intelligence in digital pathology—new tools for diagnosis and precision oncology</article-title>. <source>Nat. Rev. Clin. Oncol</source>., <volume>16</volume>, <fpage>703</fpage>–<lpage>715</lpage>.<pub-id pub-id-type="pmid">31399699</pub-id></mixed-citation>
    </ref>
    <ref id="btab578-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Besson</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <part-title>Bringing open data to whole slide imaging</part-title>. In: <source>Reyes-Aldasoro C. <italic toggle="yes">et al</italic>. (eds.) <italic toggle="yes">Digital Pathology. ECDP 2019. Lecture Notes in Computer Science</italic>, Vol. 11435</source>, <publisher-name>Springer</publisher-name>, Cham, pp. <fpage>3</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btab578-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goode</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Openslide: a vendor-neutral software foundation for digital pathology</article-title>. <source>J. Pathol. Inf</source>., <volume>4</volume>, <fpage>27</fpage>.</mixed-citation>
    </ref>
    <ref id="btab578-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Herrmann</surname><given-names>M.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Implementing the DICOM standard for digital pathology</article-title>. <source>J. Pathol. Inf</source>., <volume>9</volume>, <fpage>37</fpage>.</mixed-citation>
    </ref>
    <ref id="btab578-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hulsken</surname><given-names>B.</given-names></string-name></person-group> (<year>2020</year>) Fast compression method for medical images on the web. <italic toggle="yes">arXiv preprint arXiv:2005.08713</italic>.</mixed-citation>
    </ref>
    <ref id="btab578-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mukhopadhyay</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Whole slide imaging versus microscopy for primary diagnosis in surgical pathology: a multicenter blinded randomized noninferiority study of 1992 cases (pivotal study)</article-title>. <source>Am. J. Surg. Pathol</source>., <volume>42</volume>, <fpage>39</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">28961557</pub-id></mixed-citation>
    </ref>
    <ref id="btab578-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pantanowitz</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Twenty years of digital pathology: an overview of the road travelled, what is on the horizon, and the emergence of vendor-neutral archives</article-title>. <source>J. Pathol. Inf</source>., <volume>9</volume>, <fpage>40</fpage>.</mixed-citation>
    </ref>
    <ref id="btab578-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Standardization in digital pathology: supplement 145 of the DICOM standards</article-title>. <source>J. Pathol. Inf</source>., <volume>2</volume>, <fpage>23</fpage>.</mixed-citation>
    </ref>
    <ref id="btab578-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ström</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Artificial intelligence for diagnosis and grading of prostate cancer in biopsies: a population-based, diagnostic study</article-title>. <source>Lancet Oncol</source>., <volume>21</volume>, <fpage>222</fpage>–<lpage>232</lpage>.<pub-id pub-id-type="pmid">31926806</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
