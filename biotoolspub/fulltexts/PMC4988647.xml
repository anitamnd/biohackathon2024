<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4988647</article-id>
    <article-id pub-id-type="pmid">27532626</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-16-14718</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0160716</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Particle Physics</subject>
            <subj-group>
              <subject>Elementary Particles</subject>
              <subj-group>
                <subject>Photons</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Spectrum Analysis Techniques</subject>
          <subj-group>
            <subject>Spectrophotometry</subject>
            <subj-group>
              <subject>Fluorophotometry</subject>
              <subj-group>
                <subject>Fluorescence Resonance Energy Transfer</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Equipment</subject>
          <subj-group>
            <subject>Optical Equipment</subject>
            <subj-group>
              <subject>Lasers</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Electromagnetic Radiation</subject>
            <subj-group>
              <subject>Luminescence</subject>
              <subj-group>
                <subject>Fluorescence</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Linguistics</subject>
          <subj-group>
            <subject>Phonology</subject>
            <subj-group>
              <subject>Syntax</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FRETBursts: An Open Source Toolkit for Analysis of Freely-Diffusing Single-Molecule FRET</article-title>
      <alt-title alt-title-type="running-head">FRETBursts: Open Source Burst Analysis for Freely-Diffusing SmFRET</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9348-1397</contrib-id>
        <name>
          <surname>Ingargiola</surname>
          <given-names>Antonino</given-names>
        </name>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lerner</surname>
          <given-names>Eitan</given-names>
        </name>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chung</surname>
          <given-names>SangYoon</given-names>
        </name>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weiss</surname>
          <given-names>Shimon</given-names>
        </name>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Michalet</surname>
          <given-names>Xavier</given-names>
        </name>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Dept. Chemistry and Biochemistry, Univ. of California Los Angeles, Los Angeles, CA, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Degtyar</surname>
          <given-names>Vadim E.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of California Berkeley, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>Dr. Weiss discloses equity in Nesher Technologies and intellectual property used in the research reported here. The work at UCLA was conducted in Dr. Weiss’s Laboratory. The declared conflict of interest of Prof. Shimon Weiss does not alter the authors’ adherence to PLOS ONE policies on sharing data and materials. In particular, all data and software used in this paper is freely and permanently available accessible online under an open license.</p>
      </fn>
      <fn fn-type="con">
        <p>
          <list list-type="simple">
            <list-item>
              <p><bold>Conceived and designed the experiments:</bold> AI EL SC XM SW.</p>
            </list-item>
            <list-item>
              <p><bold>Performed the experiments:</bold> AI EL SC.</p>
            </list-item>
            <list-item>
              <p><bold>Analyzed the data:</bold> AI.</p>
            </list-item>
            <list-item>
              <p><bold>Contributed reagents/materials/analysis tools:</bold> AI EL SC.</p>
            </list-item>
            <list-item>
              <p><bold>Wrote the paper:</bold> AI EL SC XM.</p>
            </list-item>
            <list-item>
              <p>Designed and implemented the software: AI. Reviewed and tested the software: EL SC XM. Reviewed the manuscript: SW.</p>
            </list-item>
          </list>
        </p>
      </fn>
      <corresp id="cor001">* E-mail: <email>ingargiola.antonino@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>8</month>
      <year>2016</year>
    </pub-date>
    <volume>11</volume>
    <issue>8</issue>
    <elocation-id>e0160716</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>7</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 Ingargiola et al</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Ingargiola et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0160716.pdf"/>
    <abstract>
      <p>Single-molecule Förster Resonance Energy Transfer (smFRET) allows probing intermolecular interactions and conformational changes in biomacromolecules, and represents an invaluable tool for studying cellular processes at the molecular scale. smFRET experiments can detect the distance between two fluorescent labels (donor and acceptor) in the 3-10 nm range. In the commonly employed confocal geometry, molecules are free to diffuse in solution. When a molecule traverses the excitation volume, it emits a burst of photons, which can be detected by single-photon avalanche diode (SPAD) detectors. The intensities of donor and acceptor fluorescence can then be related to the distance between the two fluorophores. While recent years have seen a growing number of contributions proposing improvements or new techniques in smFRET data analysis, rarely have those publications been accompanied by software implementation. In particular, despite the widespread application of smFRET, no complete software package for smFRET burst analysis is freely available to date. In this paper, we introduce FRETBursts, an open source software for analysis of freely-diffusing smFRET data. FRETBursts allows executing all the fundamental steps of smFRET bursts analysis using state-of-the-art as well as novel techniques, while providing an open, robust and well-documented implementation. Therefore, FRETBursts represents an ideal platform for comparison and development of new methods in burst analysis. We employ modern software engineering principles in order to minimize bugs and facilitate long-term maintainability. Furthermore, we place a strong focus on reproducibility by relying on Jupyter notebooks for FRETBursts execution. Notebooks are executable documents capturing all the steps of the analysis (including data files, input parameters, and results) and can be easily shared to replicate complete smFRET analyzes. Notebooks allow beginners to execute complex workflows and advanced users to customize the analysis for their own needs. By bundling analysis description, code and results in a single document, FRETBursts allows to seamless share analysis workflows and results, encourages reproducibility and facilitates collaboration among researchers in the single-molecule community.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM95904</award-id>
        <principal-award-recipient>
          <name>
            <surname>Michalet</surname>
            <given-names>Xavier</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM069709</award-id>
        <principal-award-recipient>
          <name>
            <surname>Weiss</surname>
            <given-names>Shimon</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by National Institutes of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov/">http://www.nih.gov/</ext-link>) grant R01-GM95904 awarded to XM and SW and grant R01-GM069709 awarded to SW. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="3"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All smFRET data files are available from the figshare database (DOIs <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.3156418.v1">10.6084/m9.figshare.3156418.v1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.1098961.v3">10.6084/m9.figshare.1098961.v3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.1456362.v15">10.6084/m9.figshare.1456362.v15</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All smFRET data files are available from the figshare database (DOIs <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.3156418.v1">10.6084/m9.figshare.3156418.v1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.1098961.v3">10.6084/m9.figshare.1098961.v3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.1456362.v15">10.6084/m9.figshare.1456362.v15</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <sec id="sec002">
      <title>Open Science and Reproducibility</title>
      <p>Over the past 20 years, single molecule FRET (smFRET) has grown into one of the most useful techniques in single-molecule spectroscopy [<xref rid="pone.0160716.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0160716.ref002" ref-type="bibr">2</xref>]. While it is possible to extract information on sub-populations using ensemble measurements (e.g. [<xref rid="pone.0160716.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0160716.ref004" ref-type="bibr">4</xref>]), smFRET unique feature is its ability to very straightforwardly resolve conformational changes of biomolecules or measure binding-unbinding kinetics in heterogeneous samples [<xref rid="pone.0160716.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0160716.ref009" ref-type="bibr">9</xref>]. smFRET measurements on freely diffusing molecules (the focus of this paper) have the additional advantage, over measurements performed on immobilized molecules, of allowing to probe molecules and processes without perturbation from surface immobilization or additional functionalization needed for surface attachment [<xref rid="pone.0160716.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0160716.ref011" ref-type="bibr">11</xref>].</p>
      <p>The increasing amount of work using freely-diffusing smFRET has motivated a growing number of theoretical contributions to the specific topic of data analysis [<xref rid="pone.0160716.ref012" ref-type="bibr">12</xref>–<xref rid="pone.0160716.ref024" ref-type="bibr">24</xref>]. Despite this profusion of publications, most research groups still rely on their own implementation of a limited number of methods, with very little collaboration or code sharing. To clarify this statement, let us point that our own group’s past smFRET papers merely mention the use of custom-made software without additional details [<xref rid="pone.0160716.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0160716.ref017" ref-type="bibr">17</xref>]. Even though some of these software tools are made available upon request, or sometimes shared publicly on websites, it remains hard to reproduce and validate results from different groups, let alone build upon them. Additionally, as new methods are proposed in literature, it is generally difficult to quantify their performance compared to other methods. An independent quantitative assessment would require a complete reimplementation, an effort few groups can afford. As a result, potentially useful analysis improvements are either rarely or slowly adopted by the community. In contrast with other established traditions such as sharing protocols and samples, in the domain of scientific software, we have relegated ourselves to islands of non-communication.</p>
      <p>From a more general standpoint, the non-availability of the code used to produce scientific results, hinders reproducibility, makes it impossible to review and validate the software’s correctness and prevents improvements and extensions by other scientists. This situation, common in many disciplines, represents a real impediment to the scientific progress. Since the pioneering work of the Donoho group in the 90’s [<xref rid="pone.0160716.ref025" ref-type="bibr">25</xref>], it has become evident that developing and maintaining open source scientific software for reproducible research is a critical requirement of the modern scientific enterprise [<xref rid="pone.0160716.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0160716.ref027" ref-type="bibr">27</xref>].</p>
      <p>Other disciplines have started tackling this issue [<xref rid="pone.0160716.ref028" ref-type="bibr">28</xref>], and even in the single-molecule field a few recent publications have provided software for analysis of surface-immobilized experiments [<xref rid="pone.0160716.ref029" ref-type="bibr">29</xref>–<xref rid="pone.0160716.ref033" ref-type="bibr">33</xref>]. For freely-diffusing smFRET experiments, although it is common to find mention of “code available from the authors upon reques” in publications, there is a dearth of such open source code, with, to our knowledge, the notable exception of a single example [<xref rid="pone.0160716.ref034" ref-type="bibr">34</xref>]. To address this issue, we have developed FRETBursts, an open source Python software for analysis of freely-diffusing single-molecule FRET measurements. FRETBursts can be used, inspected and modified by anyone interested in using state-of-the art smFRET analysis methods or implementing modifications or completely new techniques. FRETBursts therefore represents an ideal platform for quantitative comparison of different methods for smFRET burst analysis. Technically, a strong emphasis has been given to the reproducibility of complete analysis workflows. FRETBursts uses Jupyter Notebooks [<xref rid="pone.0160716.ref035" ref-type="bibr">35</xref>], an interactive and executable document containing textual narrative, input parameters, code, and computational results (tables, plots, etc.). A notebook thus captures the various analysis steps in a document which is easy to share and execute. To minimize the possibility of bugs being introduced inadvertently [<xref rid="pone.0160716.ref036" ref-type="bibr">36</xref>], we employ modern software engineering techniques such as unit testing and continuous integration [<xref rid="pone.0160716.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0160716.ref037" ref-type="bibr">37</xref>]. FRETBursts is hosted on GitHub [<xref rid="pone.0160716.ref038" ref-type="bibr">38</xref>, <xref rid="pone.0160716.ref039" ref-type="bibr">39</xref>], where users can write comments, report issues or contribute code. In a related effort, we recently introduced Photon-HDF5 [<xref rid="pone.0160716.ref040" ref-type="bibr">40</xref>], an open file format for timestamp-based single-molecule fluorescence experiments. An other related open source tool is PyBroMo [<xref rid="pone.0160716.ref041" ref-type="bibr">41</xref>], a freely-diffusing smFRET simulator which produces Photon-HDF5 files that are directly analyzable with FRETBursts. Together with all the aforementioned tools, FRETBursts contributes to the growing ecosystem of open tools for reproducible science in the single-molecule field.</p>
    </sec>
    <sec id="sec003">
      <title>Paper Overview</title>
      <p>This paper is written as an introduction to smFRET burst analysis and its implementation in FRETBursts. The aim is illustrating the specificities and trade-offs involved in various approaches with sufficient details to enable readers to customize the analysis for their own needs.</p>
      <p>After a brief overview of FRETBursts features (section FRETBursts Overview), we introduce essential concepts and terminology for smFRET burst analysis (section Architecture and Concepts). In section smFRET Burst Analysis, we illustrate the steps involved in smFRET burst analysis: (i) data loading (section Loading Data), (ii) definition of the excitation alternation periods (section Alternation Parameters), (iii) background correction (section Background Estimation), (iv) burst search (section Burst Search), (v) burst selection (section Burst Selection) and (vi) FRET histogram fitting (section Population Analysis). We conclude the section by surveying different methods proposed in litterature to study FRET dynamics (section FRET Dynamics). As an example of implementation of an advanced data processing technique, section Implementing Burst Variance Analysis walks the reader through implementing Burst Variance Analysis (BVA) [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>]. Finally, section Conclusions summarizes what we believe to be the strengths of FRETBursts software.</p>
      <p>Throughout this paper, links to relevant sections of documentation and other web resources are displayed as “(link)”. In order to make the text more legible, we have concentrated Python-specific details in paragraphs titled <italic>Python details</italic>. These subsections provide deeper insights for readers already familiar with Python and can be initially skipped by readers who are not. Finally, note that all commands and figures in this paper can be regenerated using the accompanying notebooks (<ext-link ext-link-type="uri" xlink:href="https://github.com/tritemio/fretbursts_paper">link</ext-link>).</p>
    </sec>
  </sec>
  <sec id="sec004">
    <title>FRETBursts Overview</title>
    <sec id="sec005">
      <title>Technical Features</title>
      <p>FRETBursts can analyze smFRET measurements from one or multiple excitation spots [<xref rid="pone.0160716.ref042" ref-type="bibr">42</xref>]. The supported excitation schemes include single laser, alternating laser excitation (ALEX) with either CW lasers (μs-ALEX [<xref rid="pone.0160716.ref043" ref-type="bibr">43</xref>]) or pulsed lasers (ns-ALEX [<xref rid="pone.0160716.ref044" ref-type="bibr">44</xref>] or pulsed-interleaved excitation (PIE) [<xref rid="pone.0160716.ref045" ref-type="bibr">45</xref>]).</p>
      <p>The software implements both standard and novel algorithms for smFRET data analysis including background estimation as a function of time (including background accuracy metrics), sliding-window burst search [<xref rid="pone.0160716.ref010" ref-type="bibr">10</xref>], dual-channel burst search (DCBS) [<xref rid="pone.0160716.ref017" ref-type="bibr">17</xref>] and modular burst selection methods based on user-defined criteria (including a large set of pre-defined selection rules). Novel features include burst size selection with <italic>γ</italic>-corrected burst sizes, burst weighting, burst search with background-dependent threshold (in order to guarantee a minimal signal-to-background ratio [<xref rid="pone.0160716.ref046" ref-type="bibr">46</xref>]). Moreover, FRETBursts provides a large set of fitting options to characterize FRET subpopulations. In particular, distributions of burst quantities (such as <italic>E</italic> or <italic>S</italic>) can be assessed through (1) histogram fitting (with arbitrary model functions), (2) non-parametric weighted kernel density estimation (KDE), (3) weighted expectation-maximization (EM), (4) maximum likelihood fitting using Gaussian models or Poisson statistic. Finally FRETBursts includes a large number of predefined and customizable plot functions which (thanks to the <italic>matplotlib</italic> graphic library [<xref rid="pone.0160716.ref047" ref-type="bibr">47</xref>]) produce publication quality plots in a wide range of formats.</p>
      <p>Additionally, implementations of population dynamics analysis such as Burst Variance Analysis (BVA) [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>] and two-channel kernel density distribution estimator (2CDE) [<xref rid="pone.0160716.ref024" ref-type="bibr">24</xref>] are available as FRETBursts notebooks (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%20Burst%20Variance%20Analysis.ipynb">BVA link</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%202CDE%20Method.ipynb">2CDE link</ext-link>).</p>
    </sec>
    <sec id="sec006">
      <title>Software Availability</title>
      <p>FRETBursts is hosted and openly developed on GitHub. FRETBursts homepage (<ext-link ext-link-type="uri" xlink:href="http://tritemio.github.io/FRETBursts">link</ext-link>) contains links to the various resources. Pre-built packages are provided for Windows, OS X and Linux. Installation instructions can be found in the Reference Documentation (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/getting_started.html">link</ext-link>). A description of FRETBursts execution using Jupyter notebooks is reported in <xref ref-type="supplementary-material" rid="pone.0160716.s001">S1 Appendix</xref>. Detailed information on development style, testing strategies and contributions guidelines are reported in <xref ref-type="supplementary-material" rid="pone.0160716.s002">S2 Appendix</xref>. Finally, to facilitate evaluation and comparison with other software, we set up an on-line services allowing to execute FRETBursts without requiring any installation on the user’s computer (<ext-link ext-link-type="uri" xlink:href="https://github.com/tritemio/FRETBursts_notebooksrun-online">link</ext-link>).</p>
    </sec>
  </sec>
  <sec id="sec007">
    <title>Architecture and Concepts</title>
    <p>In this section, we introduce some general burst analysis concepts and notations used in FRETBursts.</p>
    <sec id="sec008">
      <title>Photon Streams</title>
      <p>The raw data collected during a smFRET experiment consists in one or more arrays of photon timestamps, whose temporal resolution is set by the acquisition hardware, typically between 10 and 50 ns. In single-spot measurements, all timestamps are stored in a single array. In multispot measurements [<xref rid="pone.0160716.ref042" ref-type="bibr">42</xref>], there are as many timestamps arrays as excitation spots. Each array contains timestamps from both donor (D) and acceptor (A) channels. When alternating excitation lasers are used (ALEX measurements) [<xref rid="pone.0160716.ref016" ref-type="bibr">16</xref>], a further distinction between photons emitted during the D or A excitation periods can be made.</p>
      <p>In FRETBursts, the corresponding sets of photons are called “photon streams” and are specified with a <monospace>Ph_sel</monospace> object (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/ph_sel.html">link</ext-link>). In non-ALEX smFRET data, there are 3 photon streams (<xref rid="pone.0160716.t001" ref-type="table">Table 1</xref>), while in two-color ALEX data, there are 5 streams (<xref rid="pone.0160716.t002" ref-type="table">Table 2</xref>).</p>
      <table-wrap id="pone.0160716.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Photon selection syntax (non-ALEX).</title>
        </caption>
        <alternatives>
          <graphic id="pone.0160716.t001g" xlink:href="pone.0160716.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Photon selection</th>
                <th align="left" rowspan="1" colspan="1">code</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">All-photons</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(’all’)</monospace>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">D-emission</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(Dex=’Dem’)</monospace>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">A-emission</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(Dex=’Aem’)</monospace>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <table-wrap id="pone.0160716.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Photon selection syntax (ALEX).</title>
        </caption>
        <alternatives>
          <graphic id="pone.0160716.t002g" xlink:href="pone.0160716.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Photon selection</th>
                <th align="left" rowspan="1" colspan="1">code</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">All-photons</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(’all’)</monospace>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">D-emission during D-excitation</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(Dex=’Dem’)</monospace>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">A-emission during D-excitation</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(Dex=’Aem’)</monospace>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">D-emission during A-excitation</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(Aex=’Dem’)</monospace>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">A-emission during A-excitation</td>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>Ph_sel(Aex=’Aem’)</monospace>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The <monospace>Ph_sel</monospace> class (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/ph_sel.html">link</ext-link>) allows the specification of any combination of photon streams. For example, in ALEX measurements, the D-emission during A-excitation stream is usually ignored because it does not contain any useful signal [<xref rid="pone.0160716.ref016" ref-type="bibr">16</xref>]. To indicate all but photons in this photon stream, the syntax is <monospace>Ph_sel(Dex=’DAem’, Aex=’Aem’)</monospace>, which indicates selection of donor and acceptor photons (<monospace>DAem</monospace>) during donor excitation (<monospace>Dex</monospace>) and only acceptor photons (<monospace>Aem</monospace>) during acceptor excitation (<monospace>Aex</monospace>).</p>
    </sec>
    <sec id="sec009">
      <title>Background Definitions</title>
      <p>An estimation of the background rates is needed to both select a proper threshold for burst search, and to correct the raw burst counts by subtracting background counts.</p>
      <p>The recorded stream of timestamps is the result of two processes: one characterized by a high count rate, due to fluorescence photons of single molecules crossing the excitation volume, and another characterized by a lower count rate, due to “background counts” originating from detector dark counts, afterpulsing, out-of-focus molecules and sample scattering and/or impurities [<xref rid="pone.0160716.ref020" ref-type="bibr">20</xref>, <xref rid="pone.0160716.ref048" ref-type="bibr">48</xref>]. The signature of these two types of processes can be observed in the inter-photon delays distribution (i.e. the waiting times between two subsequent timestamps) as illustrated in <xref ref-type="fig" rid="pone.0160716.g001">Fig 1(a)</xref>. The “tail” of the distribution (a straight line in semi-log scale) corresponds to exponentially-distributed time-delays, indicating that those counts are generated by a Poisson process. At short timescales, the distribution departs from an exponential due to the contribution of the higher rate process of single molecules traversing the excitation volume. To estimate the background rate (i.e. the inverse of the exponential time constant), it is necessary to define a time-delay threshold above which the distribution can be considered exponential. Finally, a parameter estimation method needs to be specified, such as Maximum Likelihood Estimation (MLE) or non-linear least squares curve fitting of the time-delay histogram (both supported in FRETBursts).</p>
      <fig id="pone.0160716.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Inter-photon delays fitted with and exponential function.</title>
          <p>Experimental distributions of inter-photon delays (<italic>dots</italic>) and corresponding fits of the exponential tail (<italic>solid lines</italic>). (<italic>Panel a</italic>) An example of inter-photon delays distribution (<italic>red dots</italic>) and an exponential fit of the tail of the distribution (<italic>black line</italic>). (<italic>Panel b</italic>) Inter-photon delays distribution and exponential fit for different photon streams as obtained with <monospace>dplot(d, hist_bg)</monospace>. The <italic>dots</italic> represent the experimental histogram for the different photon streams. The <italic>solid lines</italic> represent the corresponding exponential fit of the tail of the distributions. The legend shows abbreviations of the photon streams and the fitted background rates.</p>
        </caption>
        <graphic xlink:href="pone.0160716.g001"/>
      </fig>
      <p>It is advisable to monitor the background as a function of time throughout the measurement, in order to account for possible variations. Experimentally, we found that when the background is not constant, it usually varies on time scales of tens of seconds (see <xref ref-type="fig" rid="pone.0160716.g002">Fig 2</xref>). FRETBursts divides the acquisition in constant-duration time windows called <italic>background periods</italic> and computes the background rates for each of these windows (see section Background Estimation). Note that FRETBursts uses these local background rates also during burst search, in order to compute time-dependent burst detection thresholds and for background correction of burst data (see section Burst Search).</p>
      <fig id="pone.0160716.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Background rates as a function of time.</title>
          <p>Estimated background rate as a function of time for two μs-ALEX measurements. Different colors represent different photon streams. (<italic>Panel a</italic>) A measurement performed with a sealed sample chamber exhibiting constant a background as a function of time. (<italic>Panel b</italic>) A measurement performed on an unsealed sample exhibiting significant background variations due to sample evaporation and/or photobleaching (likely impurities on the cover-glass). These plots are produced by the command <monospace>dplot(d, timetrace_bg)</monospace> after estimation of background. Each data point in these figures is computed for a 30 s time window.</p>
        </caption>
        <graphic xlink:href="pone.0160716.g002"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>The <monospace>Data</monospace> Class</title>
      <p>The <monospace>Data</monospace> class (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/data_class.html">link</ext-link>) is the fundamental data container in FRETBursts. It contains the measurement data and parameters (attributes) as well as several methods for data analysis (background estimation, burst search, etc…). All analysis results (bursts data, estimated parameters) are also stored as <monospace>Data</monospace> attributes.</p>
      <p>There are 3 important “burst counts” attributes which contain the number of photons detected in the donor or the acceptor channel during donor or acceptor excitation periods (<xref rid="pone.0160716.t003" ref-type="table">Table 3</xref>). The attributes in <xref rid="pone.0160716.t003" ref-type="table">Table 3</xref> are background-corrected by default. Furthermore, <monospace>na</monospace> is corrected for leakage and direct excitation (section Bursts Corrections) if the relative coefficients are specified (by default they are set to 0). There is also a closely related attribute named <monospace>nda</monospace> for donor photons detected during acceptor excitation. <monospace>nda</monospace> is normally neglected as it only contains background.</p>
      <table-wrap id="pone.0160716.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title><monospace>Data</monospace> attributes names and descriptions for burst photon counts in different photon streams.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0160716.t003g" xlink:href="pone.0160716.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Name</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>nd</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">number of photons detected by the donor channel (during donor excitation period in ALEX case)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>na</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">number of photons detected by the acceptor channel (during donor excitation period in ALEX case)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>naa</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">number of photons detected by the acceptor channel during acceptor excitation period (present only in ALEX measurements)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <sec id="sec011">
        <title>Python details</title>
        <p>Many <monospace>Data</monospace> attributes are lists of arrays (or scalars) with the length of the lists equal to the number of excitation spots. This means that in single-spot measurements, an array of burst-data is accessed by specifying the index as 0, for example <monospace>Data.nd[0]</monospace>. <monospace>Data</monospace> implements a shortcut syntax to access the first element of a list with an underscore, so that an equivalently syntax is <monospace>Data.nd_</monospace> instead of <monospace>Data.nd[0]</monospace>.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Introduction to Burst Search</title>
      <p>Identifying single-molecule fluorescence bursts in the stream of photons is one of the most crucial steps in the analysis of freely-diffusing single-molecule FRET data. The widely used “sliding window” algorithm, introduced by the Seidel group in 1998 [<xref rid="pone.0160716.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0160716.ref012" ref-type="bibr">12</xref>], involves searching for <italic>m</italic> consecutive photons detected during a period shorter than Δ<italic>t</italic>. In other words, bursts are regions of the photon stream where the local rate (computed using <italic>m</italic> photons) is above a minimum threshold rate. Since a universal criterion to choose the rate threshold and the number of photons <italic>m</italic> is, as of today, lacking, it has become a common practice to manually adjust those parameters for each specific measurement. Commonly employed values for <italic>m</italic> are between 5 and 15 photons.</p>
      <p>A more general approach consists in taking into account the background rate of the specific measurements and in choosing a rate threshold that is <italic>F</italic> times larger than the background rate (typical values for <italic>F</italic> are between 4 and 9). This approach ensures that all resulting bursts have a signal-to-background ratio (SBR) larger than (<italic>F</italic> − 1) [<xref rid="pone.0160716.ref046" ref-type="bibr">46</xref>]. A consistent criterion for choosing the threshold is particularly important when comparing different measurements with different background rates, when the background significantly varies during measurements or in multi-spot measurements where each spot has a different background rate.</p>
      <p>A second important aspect of burst search is the choice of photon stream used to perform the search. In most cases, for instance when identifying FRET sub-populations, the burst search should use all photons, the so called all-photon burst search (APBS) [<xref rid="pone.0160716.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0160716.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0160716.ref017" ref-type="bibr">17</xref>]. In other cases, for example when focusing on donor-only or acceptor-only populations, it is better to perform the search using only donor or acceptor signal. In order to handle the general case and to provide flexibility, FRETBursts allows performing the burst search on arbitrary selections of photons (see section Photon Streams for more information on photon stream definitions).</p>
      <p>Additionally, Nir <italic>et al.</italic> [<xref rid="pone.0160716.ref017" ref-type="bibr">17</xref>] proposed a dual-channel burst search (DCBS) which can help mitigating artifacts due to photophysics effects such as blinking. During DCBS, a search is performed on two photon streams and bursts are defined as periods during which both photon streams exhibit a rate higher than the threshold, implementing the equivalent of an AND logic operation. Conventionally, the term DCBS refers to a burst search where the two photon streams are (1) all photons during donor excitation (<monospace>Ph_sel(Dex=’DAem’)</monospace>) and (2) acceptor channel photons during acceptor excitation (<monospace>Ph_sel(Aex=’Aem’)</monospace>). In FRETBursts, the user can choose arbitrary photon streams as input, an in general this kind of search is called a “AND-gate burst search”. For additional details on burst search refer to the documentation (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.io/en/latest/burstsearch.html">link</ext-link>).</p>
      <p>After burst search, it is necessary to further select bursts, for instance by specifying a minimum number of photons (or burst size). In the most basic form, this selection can be performed during burst search by discarding bursts with size smaller than a threshold <italic>L</italic> (typically 30 or higher), as originally proposed by Eggeling <italic>et al.</italic> [<xref rid="pone.0160716.ref010" ref-type="bibr">10</xref>]. This method, however, neglects the effect of background and <italic>γ</italic> factor on the burst size and can lead to a selection bias for some channels and/or sub-populations. For this reason, we suggest performing a burst size selection after background correction, taking into account the <italic>γ</italic> factor, as discussed in sections Corrected Burst Sizes and Weights and Burst Selection. In special cases, users may choose to replace (or combine) the burst selection based on burst size with another criterion such as burst duration or brightness (see section Burst Selection).</p>
    </sec>
    <sec id="sec013">
      <title>Corrected Burst Sizes and Weights</title>
      <p>The number of photons detected during a burst –the “burst size”– is computed using either all photons, or photons detected during donor excitation period. To compute the burst size, FRETBursts uses one of the following formulas:
<disp-formula id="pone.0160716.e001"><alternatives><graphic xlink:href="pone.0160716.e001.jpg" id="pone.0160716.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pone.0160716.e002"><alternatives><graphic xlink:href="pone.0160716.e002.jpg" id="pone.0160716.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>n</italic><sub><italic>d</italic></sub>, <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>aa</italic></sub> are, similarly to the attributes in <xref rid="pone.0160716.t003" ref-type="table">Table 3</xref>, the background-corrected burst counts in different channels and excitation periods. The factor <italic>γ</italic> takes into account different fluorescence quantum yields of donor and acceptor fluorophores and different photon detection efficiencies between donor and acceptor detection channels [<xref rid="pone.0160716.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0160716.ref049" ref-type="bibr">49</xref>]. <xref ref-type="disp-formula" rid="pone.0160716.e001">Eq (1)</xref> includes counts collected during donor excitation periods only, while <xref ref-type="disp-formula" rid="pone.0160716.e002">Eq (2)</xref> includes all counts. Burst sizes computed according to Eqs (<xref ref-type="disp-formula" rid="pone.0160716.e001">1</xref>) or (<xref ref-type="disp-formula" rid="pone.0160716.e002">2</xref>) are called <italic>γ</italic>-corrected burst sizes.</p>
      <p>The burst search algorithm yields a set of bursts whose sizes approximately follow an exponential distribution. Compared to bursts with smaller sizes, bursts with large sizes are less frequent, but contain more information per-burst (having higher SNR). Therefore, selecting bursts by size is an important step (see Burst Selection). A threshold set too low may result in unresolvable sub-populations because of broadening of FRET peaks and appearance of shot-noise artifacts in the FRET (and <italic>S</italic>) distribution (i.e. spurious narrow peaks due to <italic>E</italic> and <italic>S</italic> being computed as the ratio of small integers). Conversely, too large a threshold may result in too low a number of bursts therefore poor representation of the FRET distribution. Additionally, especially when computing fractions of sub-populations (e.g. ratio of number of bursts in each sub-population), it is important to use <italic>γ</italic>-corrected burst sizes as selection criterion, in order to avoid under-representing some FRET sub-populations due to different quantum yields of donor and acceptor dyes and/or different photon detection efficiencies of donor and acceptor channels.</p>
      <p>An alternative method to apply <italic>γ</italic> correction consist in discarding a constant fraction of photons chosen randomly from either the D<sub>em</sub> or A<sub>em</sub> photon stream [<xref rid="pone.0160716.ref017" ref-type="bibr">17</xref>]. This simple method transforms the measurement data in order to achieve <italic>γ</italic> = 1, overcoming the issue of selection bias between populations. This approach has also the advantage of preserving the binomial distribution of D and A photons in each burst, so that peaks of FRET populations are easier to model statistically. The only drawback is that, by discarding a fraction of photons, this method leads to information loss and therefore to a potential decrease in sensitivity and/or accuracy.</p>
      <p>A simple way to mitigate the dependence of the FRET distribution on the burst size selection threshold is weighting bursts proportionally to their size so that the bursts with largest sizes will have the largest weights. Using size as weights (instead of any other monotonically increasing function of size) can be justified noticing that the variance of bursts proximity ratio (PR) is inversely proportional to the burst size (see <xref ref-type="supplementary-material" rid="pone.0160716.s006">S6 Appendix</xref> for details).</p>
      <p>In general, a weighting scheme is used for building efficient estimators for a population parameter (e.g. the population FRET efficiency <italic>E</italic><sub><italic>p</italic></sub>). But, it can also be used to build weighted histograms or Kernel Density Estimation (KDE) plots which emphasize FRET subpopulations peaks without excluding small size bursts. Traditionally, for optimal results when not using weights, the FRET histogram is manually adjusted by finding an ad-hoc (high) size-threshold which selects only bursts with the highest size (and thus lowest variance). Building size-weighted FRET histograms is a simple method to balance the need of reducing the peaks width with the need of including as much bursts as possible to reduce statistical noise. As a practical example, by fixing the burst size threshold to a low value (e.g. 10-20 photons) and using weights, is possible to build a FRET histogram with well-defined FRET sub-populations peaks without the need of searching an optimal burst-size threshold (<xref ref-type="supplementary-material" rid="pone.0160716.s006">S6 Appendix</xref>).</p>
      <sec id="sec014">
        <title>Python details</title>
        <p>FRETBursts has the option to weight bursts using <italic>γ</italic>-corrected burst sizes which optionally include acceptor excitation photons <monospace>naa</monospace>. A weight proportional to the burst size is applied by passing the argument <monospace>weights=’size’</monospace> to histogram or KDE plot functions. The <monospace>weights</monospace> keyword can be also passed to fitting functions in order to fit the weighted E or S distributions (see section Population Analysis). Other weighting functions (for example depending quadratically on the size) are listed in the <monospace>fret_fit.get_weights</monospace> documentation (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/fret_fit.htmlfretbursts.fret_fit.get_weights">link</ext-link>). However, using weights different from the size is not recommended due to their less efficient use of burst information (<xref ref-type="supplementary-material" rid="pone.0160716.s006">S6 Appendix</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec015">
    <title>smFRET Burst Analysis</title>
    <sec id="sec016">
      <title>Loading Data</title>
      <p>While FRETBursts can load several data files formats, we encourage users to adopt the recently introduced Photon-HDF5 file format [<xref rid="pone.0160716.ref040" ref-type="bibr">40</xref>]. Photon-HDF5 is an HDF5-based, open format, specifically designed for freely-diffusing smFRET and other timestamp-based experiments. Photon-HDF5 is a self-documented, platform- and language-independent binary format, which supports compression and allows saving photon data (e.g. timestamps) and measurement-specific metadata (e.g. setup and sample information, authors, provenance, etc.). Moreover, Photon-HDF5 is designed for long-term data preservation and aims to facilitate data sharing between different software and research groups. All example data files provided with FRETBursts use the Photon-HDF5 format.</p>
      <p>To load data from a Photon-HDF5 file, we use the function <monospace>loader.photon_hdf5</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/loader.htmlfretbursts.loader.photon_hdf5">link</ext-link>):</p>
      <disp-quote>
        <p>
          <monospace>d = loader.photon_hdf5(filename)</monospace>
        </p>
      </disp-quote>
      <p specific-use="continuation">where <monospace>filename</monospace> is a string containing the file path. This command loads the measurement data into the variable <monospace>d</monospace>, a <monospace>Data</monospace> object (see section The <monospace>Data</monospace> Class).</p>
      <p>The same command can load data from a variety of smFRET measurements supported by the Photon-HDF5 format, taking advantage of the rich metadata included with each file. For instance, data generated using different excitation schemes such as CW excitation or pulsed excitation, single-laser vs two alternating lasers, etc., or with any number of excitation spots, are automatically recognized and interpreted accordingly.</p>
      <p>FRETBursts also supports loading μs-ALEX data stored in.sm files (a custom binary format used in the Weiss lab) and ns-ALEX data stored in.spc files (a binary format used by TCSPC Becker &amp; Hickl acquisition hardware). Alternatively, these and other formats (such as ht3, a binary format used by PicoQuant hardware) can be converted into Photon-HDF5 files using phconvert, a file conversion library and utility for Photon-HDF5 (<ext-link ext-link-type="uri" xlink:href="http://photon-hdf5.github.io/phconvert/">link</ext-link>). More information on loading different file formats can be found in the <monospace>loader</monospace> module’s documentation (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/loader.html">link</ext-link>).</p>
    </sec>
    <sec id="sec017">
      <title>Alternation Parameters</title>
      <p>For μs-ALEX and ns-ALEX data, Photon-HDF5 normally stores parameters defining alternation periods corresponding to donor and acceptor laser excitation. At load time, a user can plot these parameters and change them if deemed necessary. In μs-ALEX measurements [<xref rid="pone.0160716.ref050" ref-type="bibr">50</xref>], CW laser lines are alternated on timescales of the order of 10 to 100 μs. Plotting an histogram of timestamps modulo the alternation period, it is possible to identify the donor and acceptor excitation periods (see <xref ref-type="fig" rid="pone.0160716.g003">Fig 3a</xref>). In ns-ALEX measurements [<xref rid="pone.0160716.ref044" ref-type="bibr">44</xref>], pulsed lasers with equal repetition rates are delayed with respect to one another with typical delays of 10 to 100 ns. In this case, forming an histogram of TCSPC times (nanotimes) will allow the definition of periods of fluorescence after excitation of either the donor or the acceptor (see <xref ref-type="fig" rid="pone.0160716.g003">Fig 3b</xref>). In both cases, the function <monospace>plot_alternation_hist</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/plots.htmlfretbursts.burst_plot.plot_alternation_hist">link</ext-link>) will plot the relevant alternation histogram (<xref ref-type="fig" rid="pone.0160716.g003">Fig 3</xref>) using currently selected (or default) values for donor and acceptor excitation periods.</p>
      <fig id="pone.0160716.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Alternation histograms for μs-ALEX and ns-ALEX measurements.</title>
          <p>Histograms used for the selection/determination of the alternation periods for two typical smFRET-ALEX experiments. Distributions of photons detected by donor channel are in <italic>green</italic>, and by acceptor channel in <italic>red</italic>. The light <italic>green</italic> and <italic>red</italic> shaded areas indicate the donor and acceptor period definitions. (a) μs-ALEX alternation histogram, i.e. histogram of timestamps <italic>modulo</italic> the alternation period for a smFRET measurement (in timestamp clock unit). (b) ns-ALEX TCSPC nanotime histogram for a smFRET measurement (in TDC or TAC bin unit). Both plots have been generated by the same plot function (<monospace>plot_alternation_hist()</monospace>). Additional information on these specific measurements can be found in the attached notebook (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/fretbursts_paper/blob/master/notebooks/Figures%20-%20ALEX%20histograms.ipynb">link</ext-link>).</p>
        </caption>
        <graphic xlink:href="pone.0160716.g003"/>
      </fig>
      <p>To change the period definitions, we can type:</p>
      <disp-quote>
        <p>
          <monospace>d.add(D_ON = (2100, 3900), A_ON = (100, 1900))</monospace>
        </p>
      </disp-quote>
      <p specific-use="continuation">where <monospace>D_ON</monospace> and <monospace>A_ON</monospace> are pairs of numbers (tuples in python) representing the <italic>start</italic> and <italic>stop</italic> values for D or A excitation periods. The previous command works for both μs-ALEX and ns-ALEX measurements. After changing the parameters, a new alternation plot will show the updated period definitions.</p>
      <p>The alternation period definition can be applied to the data using the function <monospace>loader.alex_apply_period</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/loader.htmlfretbursts.loader.alex_apply_period">link</ext-link>):</p>
      <disp-quote>
        <p>
          <monospace>loader.alex_apply_period(d)</monospace>
        </p>
      </disp-quote>
      <p>After this command, <monospace>d</monospace> will contain only photons inside the defined excitation periods. If the user needs to update the periods definition, the data file will need to be reloaded and the steps above repeated as described.</p>
    </sec>
    <sec id="sec018">
      <title>Background Estimation</title>
      <p>The first step of smFRET analysis involves estimating background rates. For example, the following command:</p>
      <disp-quote>
        <p>
          <monospace>d.calc_bg(bg.exp_fit, time_s = 30, tail_min_us=’auto’)</monospace>
        </p>
      </disp-quote>
      <p specific-use="continuation">estimates the background rates in windows of 30 s using the default iterative algorithm for choosing the fitting threshold (Background Definitions). Beginner users can simply use the previous command and proceed to burst search (Burst Search). For more advanced users, this section provides details on the different background estimation and plotting functions provided by FRETBursts.</p>
      <p>First, we show how to estimate the background every 30 s, using a fixed inter-photon delay threshold of 2 ms (the same for all photon streams):</p>
      <disp-quote>
        <p>
          <monospace>d.calc_bg(bg.exp_fit, time_s = 30, tail_min_us = 2000)</monospace>
        </p>
      </disp-quote>
      <p>The first argument (<monospace>bg.exp_fit</monospace>) is the function used to fit the background rate for each photon stream (see section Background Definitions). The function <monospace>bg.exp_fit</monospace> estimates the background using a maximum likelihood estimation (MLE) of the delays distribution. The second argument, <monospace>time_s</monospace>, is the duration of the <italic>background period</italic> (section Background Definitions) and the third, <monospace>tail_min_us</monospace>, is the minimum inter-photon delay to use when fitting the distribution to the specified model function. To use different thresholds for each photon stream we pass a tuple (i.e. a comma-separated list of values, <ext-link ext-link-type="uri" xlink:href="https://docs.python.org/3.5/tutorial/datastructures.htmltuples-and-sequences">link</ext-link>) instead of a scalar. However, the recommended approach is to choose the threshold automatically using <monospace>tail_min_us=’auto’</monospace>. This approach uses an heuristic algorithm described in the <italic>Background estimation</italic> section of the μs-ALEX tutorial (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/FRETBursts%20-%20us-ALEX%20smFRET%20burst%20analysis.ipynbBackground-estimation">link</ext-link>). Finally, it is possible to use a rigorous but slower approach to find an optimal threshold, as described in <xref ref-type="supplementary-material" rid="pone.0160716.s005">S5 Appendix</xref>.</p>
      <p>FRETBursts provides two kinds of plots to represent the background. One shows the histograms of inter-photon delays compared to the fitted exponential distribution, shown in <xref ref-type="fig" rid="pone.0160716.g001">Fig 1</xref>) (see section Background Definitions for details on the inter-photon distribution). This plot is created with the command:</p>
      <disp-quote>
        <p>
          <monospace>dplot(d, hist_bg, period = 0)</monospace>
        </p>
      </disp-quote>
      <p>This command illustrates the general form of a plotting commands in FRETBursts, as described in <xref ref-type="supplementary-material" rid="pone.0160716.s004">S4 Appendix</xref>. Here we only note that the argument <monospace>period</monospace> is an integer specifying the background period to be plotted (when omitted, the default is 0, i.e. the first period). <xref ref-type="fig" rid="pone.0160716.g001">Fig 1</xref> allows to quickly identify pathological cases where the background fitting procedure returns unreasonable values.</p>
      <p>The second background-related plot represents a timetrace of background rates, as shown in <xref ref-type="fig" rid="pone.0160716.g002">Fig 2</xref>. This plot allows monitoring background rate variations occurring during the measurement and is obtained with the command:</p>
      <disp-quote>
        <p>
          <monospace>dplot(d, timetrace_bg)</monospace>
        </p>
      </disp-quote>
      <p>Normally, samples should have a fairly constant background rate as a function of time as in <xref ref-type="fig" rid="pone.0160716.g002">Fig 2(a)</xref>. However, sometimes, non-ideal experimental conditions can yield a time-varying background rate, as illustrated in <xref ref-type="fig" rid="pone.0160716.g002">Fig 2(b)</xref>. A possible reason for the observed behavior could be buffer evaporation from an open sample (we strongly recommend using a sealed observation chamber whenever possible). Additionally, cover-glass impurities can contribute to the background. These impurities tend to bleach on timescales of minutes resulting in background variations during the course of the measurement.</p>
      <sec id="sec019">
        <title>Python details</title>
        <p>The estimated background rates are stored in the <monospace>Data</monospace> attributes <monospace>bg_dd</monospace>, <monospace>bg_ad</monospace> and <monospace>bg_aa</monospace>, corresponding to photon streams <monospace>Ph_sel(Dex=’Dem’)</monospace>, <monospace>Ph_sel(Dex=’Aem’)</monospace> and <monospace>Ph_sel(Aex=’Aem’)</monospace> respectively. These attributes are lists of arrays (one array per excitation spot). The arrays contain the estimated background rates in the different time windows (background periods). Additional background fitting functions (e.g. least-square fitting of inter-photon delay histogram) are available in <monospace>bg</monospace> namespace (i.e. the <monospace>background</monospace> module, <ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/background.html">link</ext-link>).</p>
      </sec>
    </sec>
    <sec id="sec020">
      <title>Burst Search</title>
      <p>Following background estimation, burst search is the next step of the analysis. In FRETBursts, a standard burst search using a single photon stream (see section Introduction to Burst Search) is performed by calling the <monospace>Data.burst_search</monospace> method (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/data_class.htmlfretbursts.burstlib.Data.burst_search">link</ext-link>). For example, the following command:</p>
      <disp-quote>
        <p>
          <monospace>d.burst_search(F = 6, m = 10, ph_sel = Ph_sel(’all’))</monospace>
        </p>
      </disp-quote>
      <p specific-use="continuation">performs a burst search on all photons (<monospace>ph_sel = Ph_sel(’all’)</monospace>), with a count rate threshold equal to 6 times the local background rate (<monospace>F = 6</monospace>), using 10 consecutive photons to compute the local count rate (<monospace>m = 10</monospace>). A different photon stream, threshold (<italic>F</italic>) or number of photons <italic>m</italic> can be selected by passing different values. These parameters are good general-purpose starting point for smFRET analysis but they can be adjusted if needed.</p>
      <p>Note that the previous burst search does not perform any burst size selection (however, by definition, the minimum bursts size is effectively <italic>m</italic>). An additional parameter <italic>L</italic> can be passed to impose a minimum burst size before any correction. However, it is recommended to select bursts only after applying background corrections, as discussed in the next section Burst Selection.</p>
      <p>It might sometimes be useful to specify a fixed photon-rate threshold, instead of a threshold depending on the background rate, as in the previous example. In this case, instead of <italic>F</italic>, the argument <monospace>min_rate_cps</monospace> can be used to specify the threshold (in counts-per-second). For example, a burst search with a 50 kcps threshold is performed as follows:</p>
      <disp-quote>
        <p>
          <monospace>d.burst_search(min_rate_cps = 50e3, m = 10,</monospace>
        </p>
        <p>      <monospace>ph_sel = Ph_sel(’all’))</monospace></p>
      </disp-quote>
      <p>Finally, to perform a DCBS burst search (or in general an AND gate burst search, see section Introduction to Burst Search) we use the function <monospace>burst_search_and_gate</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/plugins.htmlfretbursts.burstlib_ext.burst_search_and_gate">link</ext-link>), as illustrated in the following example:</p>
      <disp-quote>
        <p>
          <monospace>d_dcbs = bext.burst_search_and_gate(d, F = 6, m = 10)</monospace>
        </p>
      </disp-quote>
      <p>The last command puts the burst search results in a new copy of the <monospace>Data</monospace> variable <monospace>d</monospace> (in this example the copy is called <monospace>d_dcbs</monospace>). Since FRETBursts shares the timestamps and detectors arrays between different copies of <monospace>Data</monospace> objects, the memory usage is minimized, even when several copies are created.</p>
      <sec id="sec021">
        <title>Python details</title>
        <p>Note that, while <monospace>d.burst_search()</monospace> is a method of <monospace>Data</monospace>, <monospace>bext.burst_search_and_gate()</monospace> is a function in the <monospace>bext</monospace> module taking a <monospace>Data</monospace> object as a first argument and returning a new <monospace>Data</monospace> object.</p>
        <p>The function <monospace>burst_search_and_gate</monospace> accepts optional arguments, <monospace>ph_sel1</monospace> and <monospace>ph_sel2</monospace>, whose default values correspond to the classical DCBS photon stream selection (see section Introduction to Burst Search). These arguments can be specified to select different photon streams than those used in a classical DCBS.</p>
        <p>The <monospace>bext</monospace> module (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/plugins.html">link</ext-link>) collects “plugin” functions that provides additional algorithms for processing <monospace>Data</monospace> objects.</p>
      </sec>
    </sec>
    <sec id="sec022">
      <title>Bursts Corrections</title>
      <p>In μs-ALEX, there are 3 important correction parameters: <italic>γ</italic>-factor, donor leakage into the acceptor channel and acceptor direct excitation by the donor excitation laser [<xref rid="pone.0160716.ref016" ref-type="bibr">16</xref>]. These corrections can be applied to burst data by simply assigning values to the respective <monospace>Data</monospace> attributes:</p>
      <disp-quote>
        <p>
          <monospace>d.gamma = 0.85</monospace>
        </p>
        <p>
          <monospace>d.leakage = 0.15</monospace>
        </p>
        <p>
          <monospace>d.dir_ex = 0.08</monospace>
        </p>
      </disp-quote>
      <p>These attributes can be assigned either before or after the burst search. In the latter case, existing burst data are automatically updated using the new correction parameters.</p>
      <p>These correction factors can be used to display corrected FRET distributions. However, when the goal is to fit the FRET efficiency of sub-populations, it is simpler to fit the background-corrected PR histogram and then correct the population-level PR value (see SI in [<xref rid="pone.0160716.ref016" ref-type="bibr">16</xref>]). Correcting PR of each population (instead of correcting the data in each burst) avoids distortion of the FRET distribution and keeps peaks of static FRET subpopulations closer to the ideal binomial statistics [<xref rid="pone.0160716.ref019" ref-type="bibr">19</xref>].</p>
      <p>FRETBursts implements the correction formulas for <italic>E</italic> and <italic>S</italic> in the functions <monospace>fretmath.correct_E_gamma_leak_dir</monospace> and <monospace>fretmath.correct_S</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/fretmath.html">link</ext-link>). A derivation of these correction formulas (using computer-assisted algebra) can be found online as an interactive notebook (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/notebooks/blob/master/Derivation%20of%20FRET%20and%20S%20correction%20formulas.ipynb">link</ext-link>).</p>
    </sec>
    <sec id="sec023">
      <title>Burst Selection</title>
      <p>After burst search, it is common to select bursts according to different criteria. One of the most common is burst size.</p>
      <p>For instance, to select bursts with more than 30 photons detected during the donor excitation (computed after background correction), we use following command:</p>
      <disp-quote>
        <p>
          <monospace>ds = d.select_bursts(select_bursts.size, th1 = 30)</monospace>
        </p>
      </disp-quote>
      <p>The previous command creates a new <monospace>Data</monospace> variable (<monospace>ds</monospace>) containing the selected bursts. <monospace>th1</monospace> defines the lower bound for burst size, while <monospace>th2</monospace> defines the upper bound (when not specified, as in the previous example, the upper bound is +∞). As before, the new object (<monospace>ds</monospace>) will share the photon data arrays with the original object (<monospace>d</monospace>) in order to minimize the amount of used memory.</p>
      <p>The first argument of <monospace>select_bursts</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/data_class.htmlburst-selection-methods">link</ext-link>) is a python function implementing the “selection rule” (<monospace>select_bursts.size</monospace> in this example); all remaining arguments (only <monospace>th1</monospace> in this case) are parameters of the selection rule. The <monospace>select_bursts</monospace> module (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/burst_selection.html">link</ext-link>) contains numerous built-in selection functions (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/burst_selection.htmlmodule-fretbursts.select_bursts">link</ext-link>). For example, <monospace>select_bursts.ES</monospace> is used to select a region on the E-S ALEX histogram, <monospace>select_bursts.width</monospace> to select bursts based on their duration. New custom criteria can be readily implemented by defining a new selection function, which requires only a couple of lines of code (see the <monospace>select_bursts</monospace> module’s source code for examples, <ext-link ext-link-type="uri" xlink:href="https://github.com/tritemio/FRETBursts/blob/master/fretbursts/select_bursts.py">link</ext-link>).</p>
      <p>Finally, different criteria can be combined sequentially. For example, with the following commands:</p>
      <disp-quote>
        <p>
          <monospace>ds = d.select_bursts(select_bursts.size,</monospace>
        </p>
        <p>         <monospace>th1 = 50, th2 = 200)</monospace></p>
        <p>
          <monospace>dsw = ds.select_bursts(select_bursts.width,</monospace>
        </p>
        <p>         <monospace>th1 = 0.5e-3, th2 = 3e-3)</monospace></p>
      </disp-quote>
      <p specific-use="continuation">bursts in <monospace>dsw</monospace> will have sizes between 50 and 200 photons, and duration between 0.5 and 3 ms.</p>
      <sec id="sec024">
        <title>Burst Size Selection</title>
        <p>In the previous section, we selected bursts by size, using only photons detected in both D and A channels during D excitation (i.e. D<sub>ex</sub> photons), as in <xref ref-type="disp-formula" rid="pone.0160716.e001">Eq (1)</xref>. Alternatively, a threshold on the burst size computed including all photons can be applied by adding <italic>n</italic><sub><italic>aa</italic></sub> to the burst size (see <xref ref-type="disp-formula" rid="pone.0160716.e002">Eq (2)</xref>). This is achieved by passing <monospace>add_naa = True</monospace> to the selection function. The complete selection command is:</p>
        <disp-quote>
          <p>
            <monospace>ds = d.select_bursts(select_bursts.size,</monospace>
          </p>
          <p>       <monospace>th1 = 30, add_naa = True)</monospace></p>
        </disp-quote>
        <p>The result of this selection is plotted in <xref ref-type="fig" rid="pone.0160716.g004">Fig 4</xref>. When <monospace>add_naa</monospace> is not specified, as in the previous section, the default is <monospace>add_naa = False</monospace> (i.e. compute size using only D<sub>ex</sub> photons).</p>
        <fig id="pone.0160716.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>E-S histogram showing FRET, D-only and A-only populations.</title>
            <p>A 2-D ALEX histogram and marginal E and S histograms for a 40-bp dsDNA with D-A distance of 17 bases (Donor dye: ATTO550, Acceptor dye: ATTO647N). Bursts are selected with a size-threshold of 30 photons, including A<sub>ex</sub> photons. The plot is obtained with <monospace>alex_jointplot(ds)</monospace>. The 2D E-S distribution plot (join plot) is an histogram with hexagonal bins, which reduce the binning artifacts (compared to square bins) and naturally resembles a scatter-plot when the burst density is low (see <xref ref-type="supplementary-material" rid="pone.0160716.s004">S4 Appendix</xref>). Three populations are visible: FRET population (middle), D-only population (top left) and A-only population (bottom, <italic>S</italic> &lt; 0.2). Compare with <xref ref-type="fig" rid="pone.0160716.g005">Fig 5</xref> where the FRET population has been isolated.</p>
          </caption>
          <graphic xlink:href="pone.0160716.g004"/>
        </fig>
        <p>Another important parameter for defining the burst size is the <italic>γ</italic>-factor, i.e. the product of the relative quantum yield and detection efficiency of the acceptor versus donor signals. As noted in section Corrected Burst Sizes and Weights, the <italic>γ</italic>-factor is used to compensate for different fluorescence quantum yields for the D and A fluorophores as well as different photon-detection efficiencies for the D and A channels. When <italic>γ</italic> is significantly different from 1, neglecting its effect on burst size leads to over-representing one FRET population versus the others.</p>
        <p>When the <italic>γ</italic> factor is known (and ≠1), a more unbiased selection of different FRET populations can be achieved passing the argument <monospace>gamma</monospace> to the selection function:</p>
        <disp-quote>
          <p>
            <monospace>ds = d.select_bursts(select_bursts.size,</monospace>
          </p>
          <p>       <monospace>th1 = 15, gamma = 0.65)</monospace></p>
        </disp-quote>
        <p>When not specified, <italic>γ</italic> = 1 is assumed. For more details on burst size selection, see the <monospace>select_bursts.size</monospace> documentation (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/burst_selection.htmlfretbursts.select_bursts.size">link</ext-link>).</p>
      </sec>
      <sec id="sec025">
        <title>Python details</title>
        <p>The method to compute <italic>γ</italic>-corrected burst sizes (with or without addition of <monospace>naa</monospace>) is <monospace>Data.burst_sizes</monospace> (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/data_class.htmlfretbursts.burstlib.Data.burst_sizes">link</ext-link>).</p>
      </sec>
      <sec id="sec026">
        <title>Select the FRET Populations</title>
        <p>In smFRET-ALEX experiments, donor-only (D-only) and acceptor-only (A-only) populations can be detected in addition to the FRET population(s). In most cases, the D-only and A-only populations are of no interest and need to be filtered out.</p>
        <p>In principle, using the E-S representation, D-only and A-only bursts can be excluded by selecting bursts within a range of <italic>S</italic> values (e.g. S = 0.2-0.8). This approach, however, simply truncates the burst distribution with arbitrary thresholds and is therefore not recommended for quantitative assessment of FRET populations.</p>
        <p>An alternative approach consists in applying two selection filters sequentially. First, the A-only population is filtered out by applying a threshold on the number of photons during D excitation (D<sub>ex</sub>). Second, the D-only population is filtered out by applying a threshold on the number of A photons during A excitation (A<sub>ex</sub>A<sub>em</sub>). The commands for these combined selections are:</p>
        <disp-quote>
          <p>
            <monospace>ds1 = d.select_bursts(select_bursts.size, th1 = 15)</monospace>
          </p>
          <p>
            <monospace>ds2 = ds1.select_bursts(select_bursts.naa, th1 = 15)</monospace>
          </p>
        </disp-quote>
        <p>Here, the variable <monospace>ds2</monospace> contains the combined burst selection. <xref ref-type="fig" rid="pone.0160716.g005">Fig 5</xref> shows the resulting filtered FRET population obtained with the previous selection.</p>
        <fig id="pone.0160716.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>E-S histogram after filtering out D-only and A-only populations.</title>
            <p>2-D ALEX histogram after selection of FRET population using the composition of two burst selection filters: (1) selection of bursts with counts in D<sub>ex</sub> stream larger than 15; (2) selection of bursts with counts in A<sub>ex</sub>A<sub>em</sub> stream larger than 15. Compare to <xref ref-type="fig" rid="pone.0160716.g004">Fig 4</xref> where all burst populations (FRET, D-only and A-only) are reported.</p>
          </caption>
          <graphic xlink:href="pone.0160716.g005"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec027">
      <title>Population Analysis</title>
      <p>Typically, after bursts selection, E or S histograms are fitted to a model. FRETBursts <monospace>mfit</monospace> module allows fitting histograms of bursts quantities (i.e. E or S) with arbitrary models. In this context, a model is an object specifying a function, the parameters varied during the fit and optional constraints for these parameters. This concept of model is taken from <italic>lmfit</italic> [<xref rid="pone.0160716.ref051" ref-type="bibr">51</xref>], the underlying library used by FRETBursts to perform the fits.</p>
      <p>Models can be created from arbitrary functions. FRETBursts includes predefined (i.e. built-in) models such as 1- to 3-Gaussian peaks or 2-Gaussian connected by a flat “plateau”. The latter is an empirical model which can be used to more accurately fit the center values of two populations when the peaks are connected by intermediate-FRET bursts (for the analytical definition of this function see the documentation, <ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.io/en/latest/mfit.htmlfretbursts.mfit.factory_two_gaussians">link</ext-link>). Built-in models are created by calling a corresponding factory function (whose names start with <monospace>mfit.factory_</monospace>) which initializes the parameters with values and constraints suitable for E and S histograms fits (see <italic>Factory Functions</italic> documentation, <ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/mfit.htmlmodel-factory-functions">link</ext-link>).</p>
      <p>As an example, we can fit the E histogram of bursts in the <monospace>ds</monospace> variable with two Gaussian peaks with the following command:</p>
      <disp-quote>
        <p>
          <monospace>bext.bursts_fitter(ds, ‘E’, binwidth = 0.03,</monospace>
        </p>
        <p>       <monospace>model = mfit.factory_two_gaussians())</monospace></p>
      </disp-quote>
      <p>Changing <monospace>’E’</monospace> with <monospace>’S’</monospace> will fit the S histogram instead. The <monospace>binwidth</monospace> argument specifies the histogram bin width and the <monospace>model</monospace> argument defines which model shall be used for fitting.</p>
      <p>All fitting results (including best fit values, uncertainties, etc…), are stored in the <monospace>E_fitter</monospace> (or <monospace>S_fitter</monospace>) attributes of the <monospace>Data</monospace> variable (named <monospace>ds</monospace> here). To print a comprehensive summary of the fit results, including uncertainties, reduced <italic>χ</italic><sup>2</sup> and correlation between parameters, we can use the following command:</p>
      <disp-quote>
        <p>
          <monospace>fit_res = ds.E_fitter.fit_res[0]</monospace>
        </p>
        <p>
          <monospace>print(fit_res.fit_report())</monospace>
        </p>
      </disp-quote>
      <p>Finally, to plot the fitted model together with the FRET histogram, as shown in <xref ref-type="fig" rid="pone.0160716.g006">Fig 6</xref>, we pass the parameter <monospace>show_model = True</monospace> to the <monospace>hist_fret</monospace> function (see <xref ref-type="supplementary-material" rid="pone.0160716.s004">S4 Appendix</xref> for an introduction to plotting in FRETBursts):</p>
      <disp-quote>
        <p>
          <monospace>dplot(ds, hist_fret, show_model = True)</monospace>
        </p>
      </disp-quote>
      <fig id="pone.0160716.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>FRET histogram fitted with two Gaussians.</title>
          <p>Example of a FRET histogram fitted with a 2-Gaussian model. After performing the fit (see main text), the plot is generated with <monospace>dplot(ds, hist_fret, show_model = True)</monospace>.</p>
        </caption>
        <graphic xlink:href="pone.0160716.g006"/>
      </fig>
      <p>For more examples on fitting bursts data and plotting results, refer to the fitting section of the μs-ALEX notebook (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/FRETBursts%20-%20us-ALEX%20smFRET%20burst%20analysis.ipynbFRET-fit:-in-depth-example">link</ext-link>), the <italic>Fitting Framework</italic> section of the documentation (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/fit.html">link</ext-link>) as well as the documentation for <monospace>bursts_fitter</monospace> function (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.org/en/latest/plugins.htmlfretbursts.burstlib_ext.bursts_fitter">link</ext-link>).</p>
      <sec id="sec028">
        <title>Python details</title>
        <p>Models returned by FRETBursts’s factory functions (<monospace>mfit.factory_*</monospace>) are <monospace>lmfit.Model</monospace> objects (<ext-link ext-link-type="uri" xlink:href="https://lmfit.github.io/lmfit-py/model.html">link</ext-link>). Custom models can be created by calling <monospace>lmfit.Model</monospace> directly. When an <monospace>lmfit.Model</monospace> is fitted, it returns a <monospace>ModelResults</monospace> object (<ext-link ext-link-type="uri" xlink:href="https://lmfit.github.io/lmfit-py/model.htmlthe-modelresult-class">link</ext-link>), which contains all information related to the fit (model, data, parameters with best values and uncertainties) and useful methods to operate on fit results. FRETBursts puts a <monospace>ModelResults</monospace> object of each excitation spot in the list <monospace>ds.E_fitter.fit_res</monospace>. For instance, to obtain the reduced <italic>χ</italic><sup>2</sup> value of the E histogram fit in a single-spot measurement <monospace>d</monospace>, we use the following command:</p>
        <disp-quote>
          <p>
            <monospace>d.E_fitter.fit_res[0].redchi</monospace>
          </p>
        </disp-quote>
        <p>Other useful attributes are <monospace>aic</monospace> and <monospace>bic</monospace> which contain statistics for the Akaike information criterion (AIC) [<xref rid="pone.0160716.ref052" ref-type="bibr">52</xref>] and the Bayes Information criterion (BIC) [<xref rid="pone.0160716.ref053" ref-type="bibr">53</xref>]. AIC and BIC are general-purpose statistical criteria for comparing the suitability of multiple models according to the data. By penalizing models with higher number of parameters, these criteria strike a balance between the need of achieving high goodness of fit with the need of keeping the model complexity low to avoid overfitting [<xref rid="pone.0160716.ref054" ref-type="bibr">54</xref>].</p>
        <p>Examples of definition and modification of fit models are provided in the aforementioned μs-ALEX notebook (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/FRETBursts%20-%20us-ALEX%20smFRET%20burst%20analysis.ipynbFRET-fit:-in-depth-example">link</ext-link>). Users can also refer to the comprehensive lmfit’s documentation (<ext-link ext-link-type="uri" xlink:href="http://lmfit.github.io/lmfit-py/">link</ext-link>).</p>
      </sec>
    </sec>
    <sec id="sec029">
      <title>FRET Dynamics</title>
      <p>Single-molecule FRET histograms show more information than just mean FRET efficiencies. While in general the presence of several peaks clearly indicates the existence of multiple subpopulations, a single peak cannot a priori be associated with a single population defined by a unique FRET efficiency without further analysis.</p>
      <p>Shot-noise analysis [<xref rid="pone.0160716.ref017" ref-type="bibr">17</xref>] or probability distribution analysis (PDA) [<xref rid="pone.0160716.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0160716.ref055" ref-type="bibr">55</xref>] allow to compute the minimum width of a static FRET population (i.e. caused by the statistics of discrete photon-detection events). Typically, several mechanisms contribute to the broadening of the experimental FRET peak beyond the shot-noise limit. These include heterogeneities in the sample resulting in a distribution of Förster radii, or actual conformational changes giving rise to a distribution of D-A distances [<xref rid="pone.0160716.ref008" ref-type="bibr">8</xref>].</p>
      <p>Gopich and Szabo developed an elegant analytical model for the FRET distribution of <italic>M</italic> interconverting states based on superposition of Gaussian peaks [<xref rid="pone.0160716.ref056" ref-type="bibr">56</xref>]. Unfortunately, the method is not of straightforward application for freely-diffusing data as it requires a special selection criterion for filtering bursts with quasi-Poisson rates. Santoso et al. [<xref rid="pone.0160716.ref057" ref-type="bibr">57</xref>] and Kalinin et al. [<xref rid="pone.0160716.ref058" ref-type="bibr">58</xref>] extended the PDA approach to estimate conversion rates between different states by comparing FRET histograms as a function of the time-bin size. In addition, Gopich and Szabo [<xref rid="pone.0160716.ref059" ref-type="bibr">59</xref>, <xref rid="pone.0160716.ref060" ref-type="bibr">60</xref>] developed a related method to compute conversion rates using a likelihood function which depends on photon timestamps (overcoming the time binning and FRET histogramming step and directly applicable to freely-diffusing data). In case of measurement including lifetime, the multiparameter fluorescence detection (MFD) method allows to identify dynamics from the deviation from the linear relation between lifetime and E [<xref rid="pone.0160716.ref008" ref-type="bibr">8</xref>]. Hoffman et al. [<xref rid="pone.0160716.ref061" ref-type="bibr">61</xref>] proposed a method called RASP (recurrence analysis of single particles) to extend the timescale of detectable kinetics. Hoffman et al. compute the probability that two nearby bursts are due to the same molecule and therefore allows setting a time-threshold for considering consecutive bursts as the same single-molecule event.</p>
      <p>Other interesting approaches include combining smFRET and FCS for detecting and quantifying kinetics on timescales much shorter than the diffusion time [<xref rid="pone.0160716.ref062" ref-type="bibr">62</xref>–<xref rid="pone.0160716.ref064" ref-type="bibr">64</xref>]. In addition, Bayes-based methods have been proposed to fit static populations [<xref rid="pone.0160716.ref065" ref-type="bibr">65</xref>, <xref rid="pone.0160716.ref066" ref-type="bibr">66</xref>], or to study dynamics [<xref rid="pone.0160716.ref067" ref-type="bibr">67</xref>].</p>
      <p>Finally, two related methods for discriminating between static heterogeneity and sub-millisecond dynamics are Burst Variance Analysis (BVA) proposed by Torella et al. [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>] and two-channel kernel density estimator (2CDE) proposed by Tomov et al. [<xref rid="pone.0160716.ref024" ref-type="bibr">24</xref>]. The BVA method is described in the next section. The 2CDE method, which has been implemented in FRETBursts, computes local photon rates from timestamps within bursts using Kernel Density Estimation (KDE) (FRETBursts includes general-purpose functions to compute KDE of photon timestamps in the <monospace>phrates</monospace> module, (<ext-link ext-link-type="uri" xlink:href="http://fretbursts.readthedocs.io/en/latest/phrates.html">link</ext-link>)). From time variations of local rates, it is possible to infer the presence of some dynamics. In particular, the 2CDE method builds, for each burst, a quantity (<italic>E</italic>)<sub><italic>D</italic></sub> (or (1 − <italic>E</italic>)<sub><italic>A</italic></sub>), which is equal to the burst average <italic>E</italic> when no dynamics is present, but is biased toward an higher (or lower) value in presence of dynamics. From these quantities, a burst “estimator” (called FRET-2CDE) is derived. For a user, the 2CDE method amounts to plotting the 2-D histogram of <italic>E</italic> versus FRET-2CDE, and assessing the vertical position of the various populations: populations centered around FRET-2CDE = 10 undergo no dynamics, while population biased towards higher FRET-2CDE values undergo dynamics.</p>
      <p>The BVA and 2CDE methods are implemented in two notebooks included with FRETBursts (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%20Burst%20Variance%20Analysis.ipynb">BVA link</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%202CDE%20Method.ipynb">2CDE link</ext-link>). To use them, a user needs to download the relevant notebook and run the anaysis therein. The other methods mentioned in this section are not currently implemented in FRETBursts. However, users can implement their additional favorite method taking advantage of FRETBursts functions for burst analysis and timestamps/bursts manipulation. To facilitate this task, in the next section, we show how to perform low-level analysis of timestamps and bursts data by implementing the BVA method from scratch. An additional example showing how to split bursts in constant time-bins can be found in the respective FRETBursts notebook (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%20Working%20with%20timestamps%20and%20bursts.ipynb">link</ext-link>). These examples serve as a guide for implementing new methods. We welcome researchers willing to implement new methods to ask questions on GitHub or on the mailing list. We also encourage sharing eventual new methods implemented in FRETBursts for the benefit the entire community.</p>
    </sec>
  </sec>
  <sec id="sec030">
    <title>Implementing Burst Variance Analysis</title>
    <p>In this section, we describe how to implement burst variance analysis (BVA) as described in [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>]. FRETBursts provides well-tested, general-purpose functions for timestamps and burst data manipulation and therefore simplifies implementing custom burst analysis algorithms such as BVA.</p>
    <sec id="sec031">
      <title>BVA Overview</title>
      <p>The BVA method has been developed to identify the presence of dynamics in FRET distributions [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>], and has been successfully applied to identify biomolecular processes with dynamics on the millisecond time-scale [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0160716.ref068" ref-type="bibr">68</xref>].</p>
      <p>The basic idea behind BVA is to subdivide bursts into contiguous burst chunks (sub-bursts) comprising a fixed number <italic>n</italic> of photons, and to compare the empirical variance of acceptor counts of all sub-bursts in a burst, with the theoretical shot-noise-limited variance. An empirical variance of sub-bursts larger than the shot-noise-limited value indicates the presence of dynamics.</p>
      <p>In a FRET (sub-)population originating from a single static FRET efficiency, the sub-bursts acceptor counts <italic>n</italic><sub><italic>a</italic></sub> can be modeled as a binomial-distributed random variable <italic>N</italic><sub><italic>a</italic></sub> ∼ B(<italic>n</italic>, <italic>E</italic><sub><italic>p</italic></sub>), where <italic>n</italic> is the number of photons in each sub-burst and <italic>E</italic><sub><italic>p</italic></sub> is the estimated population proximity-ratio (PR). Note that we can use the PR because, regardless of the molecular FRET efficiency, the detected counts are partitioned between donor and acceptor channels according to a binomial distribution with success probability equal to the PR. The only approximation done here is neglecting the presence of background (a reasonable approximation since the backgrounds counts are in general a very small fraction of the total counts). We refer the interested reader to [<xref rid="pone.0160716.ref023" ref-type="bibr">23</xref>] for further discussion.</p>
      <p>If <italic>N</italic><sub><italic>a</italic></sub> follows a binomial distribution, the random variable <italic>E</italic><sub>sub</sub> = <italic>N</italic><sub><italic>a</italic></sub>/<italic>n</italic>, has a standard deviation reported in <xref ref-type="disp-formula" rid="pone.0160716.e003">Eq (3)</xref>.
<disp-formula id="pone.0160716.e003"><alternatives><graphic xlink:href="pone.0160716.e003.jpg" id="pone.0160716.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Std</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>sub</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>BVA analysis consists of four steps: 1) dividing bursts into consecutive sub-bursts containing a constant number of consecutive photons <italic>n</italic>, 2) computing the PR of each sub-burst, 3) calculating the empirical standard deviation (<italic>s</italic><sub><italic>E</italic></sub>) of sub-bursts PR in each burst, and 4) comparing <italic>s</italic><sub><italic>E</italic></sub> to the expected standard deviation of a shot-noise-limited distribution (<xref ref-type="disp-formula" rid="pone.0160716.e003">Eq (3)</xref>). If, as in <xref ref-type="fig" rid="pone.0160716.g007">Fig 7</xref>, the observed FRET efficiency distribution originates from a static mixture of sub-populations (of different non-interconverting molecules) characterized by distinct FRET efficiencies, <italic>s</italic><sub><italic>E</italic></sub> of each burst is only affected by shot-noise and will follow the expected standard deviation curve based on <xref ref-type="disp-formula" rid="pone.0160716.e003">Eq (3)</xref>. Conversely, if the observed distribution originates from biomolecules belonging to a single species, which interconverts between different FRET sub-populations (over times comparable to the diffusion time), as in <xref ref-type="fig" rid="pone.0160716.g008">Fig 8</xref>, <italic>s</italic><sub><italic>E</italic></sub> of each burst will be larger than the expected shot-noise-limited standard deviation, and will be located above the shot-noise standard deviation curve (right panel of <xref ref-type="fig" rid="pone.0160716.g008">Fig 8</xref>). Sample in <xref ref-type="fig" rid="pone.0160716.g008">Fig 8</xref> is single stranded DNA (<italic>A</italic><sub>31</sub>-TA, as described in [<xref rid="pone.0160716.ref069" ref-type="bibr">69</xref>]), designed to form a transient hairpin in 400mM NaCl.</p>
      <fig id="pone.0160716.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>BVA distribution for a static mixture sample.</title>
          <p>The left panel shows the E-S histogram for a mixture of single stranded DNA (20dT) and double stranded DNA (20dT-20dA) molecules in 200 mM MgCl<sub>2</sub>. The right panel shows the corresponding BVA plot. Since both 20dT and 20dT-20dA are stable and have no dynamics, the BVA plots shows <italic>s</italic><sub><italic>E</italic></sub> peaks lying on the static standard deviation curve (<italic>red curve</italic>).</p>
        </caption>
        <graphic xlink:href="pone.0160716.g007"/>
      </fig>
      <fig id="pone.0160716.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0160716.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>BVA distribution for a hairpin sample undergoing dynamics.</title>
          <p>The left panel shows the E-S histogram for a single stranded DNA sample (<italic>A</italic><sub>31</sub>-TA, see text), designed to form a transient hairpin in 400mM NaCl. The right panel shows the corresponding BVA plot. Since the transition between hairpin and open structure causes a significant change in FRET efficiency, <italic>s</italic><sub><italic>E</italic></sub> lies largely above the static standard deviation curve (<italic>red curve</italic>).</p>
        </caption>
        <graphic xlink:href="pone.0160716.g008"/>
      </fig>
    </sec>
    <sec id="sec032">
      <title>BVA Implementation</title>
      <p>The following paragraphs describe the low-level details involved in implementing the BVA using FRETBursts. The main goal is to illustrate a real-world example of accessing and manipulating timestamps and burst data. For a ready-to-use BVA implementation users can refer to the corresponding notebook included with FRETBursts (<ext-link ext-link-type="uri" xlink:href="http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%20Burst%20Variance%20Analysis.ipynb">link</ext-link>).</p>
      <sec id="sec033">
        <title>Python details</title>
        <p>For BVA implementation, two photon streams are needed: all-photons during donor excitation (D<sub>ex</sub>) and acceptor photons during donor excitation (D<sub>ex</sub>A<sub>em</sub>). These photon stream selections are obtained by computing boolean masks as follows (see <xref ref-type="supplementary-material" rid="pone.0160716.s003">S3 Appendix</xref>):</p>
        <disp-quote>
          <p>
            <monospace>Dex_mask = ds.get_ph_mask(ph_sel = Ph_sel(Dex=’DAem’))</monospace>
          </p>
          <p>
            <monospace>DexAem_mask = ds.get_ph_mask(ph_sel = Ph_sel(Dex=’Aem’))</monospace>
          </p>
          <p>
            <monospace>DexAem_mask_d = AemDex_mask[Dex_mask]</monospace>
          </p>
        </disp-quote>
        <p>Here, the first two variables (<monospace>Dex_mask</monospace> and <monospace>DexAem_mask</monospace>) select photon from the all-photons timestamps array, while <monospace>DexAem_mask_d</monospace>, selects A-emitted photons from the array of photons emitted during D-excitation. As shown below, the latter is needed to count acceptor photons in burst chunks.</p>
        <p>Next, we need to express bursts start-stop data as indexes of the D-excitation photon stream (by default burst start-stop indexes refer to all-photons timestamps array):</p>
        <disp-quote>
          <p>
            <monospace>ph_d = ds_FRET.get_ph_times(ph_sel = Ph_sel(Dex=’DAem’))</monospace>
          </p>
          <p>
            <monospace>bursts = ds_FRET.mburst[0]</monospace>
          </p>
          <p>
            <monospace>bursts_d = bursts.recompute_index_reduce(ph_d)</monospace>
          </p>
        </disp-quote>
        <p>Here, <monospace>ph_d</monospace> contains the D<sub>ex</sub> timestamps, <monospace>bursts</monospace> the original burst data and <monospace>bursts_d</monospace> the burst data with start-stop indexes relative to <monospace>ph_d</monospace>.</p>
        <p>Finally, with the previous variables at hand, the BVA algorithm can be easily implemented by computing the <italic>s</italic><sub><italic>E</italic></sub> quantity for each burst:</p>
        <disp-quote>
          <p>
            <monospace>n = 7</monospace>
          </p>
          <p>
            <monospace>E_sub_std = []</monospace>
          </p>
          <p>
            <monospace>for burst in bursts_d:</monospace>
          </p>
          <p>  <monospace>E_sub = []</monospace></p>
          <p>  <monospace>startlist = range(burst.istart, burst.istop + 2—n, n)</monospace></p>
          <p>  <monospace>stoplist = [i + n for i in startlist]</monospace></p>
          <p>  <monospace>for start, stop in zip(startlist, stoplist):</monospace></p>
          <p>   <monospace>A_D = DexAem_mask_d[start:stop].sum()</monospace></p>
          <p>   <monospace>E = A_D / n</monospace></p>
          <p>   <monospace>E_sub.append(E)</monospace></p>
          <p>  <monospace>E_sub_std.append(np.std(E_sub))</monospace></p>
        </disp-quote>
        <p>Here, <monospace>n</monospace> is the BVA parameter defining the number of photons in each burst chunk. The outer loop iterates through bursts, while the inner loop iterates through sub-bursts. The variables <monospace>startlist</monospace> and <monospace>stoplist</monospace> are the list of start-stop indexes for all sub-bursts in current burst. In the inner loop, <monospace>A_D</monospace> and <monospace>E</monospace> contain the number of acceptor photons and FRET efficiency for the current sub-burst. Finally, for each burst, the standard deviation of <monospace>E</monospace> is appended to the list <monospace>E_sub_std</monospace>.</p>
        <p>By plotting the 2D distribution of <italic>s</italic><sub><italic>E</italic></sub> (i.e. <monospace>E_sub_std</monospace>) versus the average (uncorrected) E we obtain the BVA plots of Figs <xref ref-type="fig" rid="pone.0160716.g007">7</xref> and <xref ref-type="fig" rid="pone.0160716.g008">8</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec034">
    <title>Conclusions</title>
    <p>FRETBursts is an open source and openly developed (see <xref ref-type="supplementary-material" rid="pone.0160716.s002">S2 Appendix</xref>) implementation of established smFRET burst analysis methods made available to the single-molecule community. It implements several novel concepts which improve the analysis results, such as time-dependent background estimation, background-dependent burst search threshold, burst weighting and <italic>γ</italic>-corrected burst size selection. More importantly, FRETBursts provides a library of thoroughly-tested functions for timestamps and burst manipulation, making it an ideal platform for developing and comparing new analytical techniques.</p>
    <p>We envision FRETBursts both as a state-of-the-art burst analysis software as well as a platform for development and assessment of novel algorithms. To underpin this envisioned role, FRETBursts is developed following modern software engineering practices, such as DRY principle (<ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself">link</ext-link>) to reduce duplication and KISS principle (<ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/KISS_principle">link</ext-link>) to reduce over-engineering. Furthermore, to minimize the number software errors [<xref rid="pone.0160716.ref036" ref-type="bibr">36</xref>, <xref rid="pone.0160716.ref070" ref-type="bibr">70</xref>], we employ defensive programming [<xref rid="pone.0160716.ref039" ref-type="bibr">39</xref>] which includes code readability, unit and regression testing and continuous integration [<xref rid="pone.0160716.ref028" ref-type="bibr">28</xref>]. Finally, being open source, any scientist can inspect the source code, fix errors, adapt it to her own needs.</p>
    <p>We believe that, in the single-molecule community, standard open source software implementations, such as FRETBursts, can enhance reliability and reproducibility of analysis and promote a faster adoption of novel methods, while reducing the duplication of efforts among different groups.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec035">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0160716.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Notebook Workflow.</title>
        <p>A description of the notebook workflow used by FRETBursts.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0160716.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0160716.s002">
      <label>S2 Appendix</label>
      <caption>
        <title>Development and Contributions.</title>
        <p>A description of development philosophy and techniques as well as how to contribute to the FRETBursts project.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0160716.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0160716.s003">
      <label>S3 Appendix</label>
      <caption>
        <title>Timestamps and Burst Data.</title>
        <p>General concepts of how timestamps and bursts data are stored and handled in FRETBursts.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0160716.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0160716.s004">
      <label>S4 Appendix</label>
      <caption>
        <title>Plotting Data.</title>
        <p>A description of the syntax used to perform plots in FRETBursts and of the 2-D hexagonal-bin histogram used in E-S plots.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0160716.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0160716.s005">
      <label>S5 Appendix</label>
      <caption>
        <title>Background Estimation With Optimal Threshold.</title>
        <p>A description of the algorithm used by FRETBursts to compute the optimal threshold for background estimation.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0160716.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0160716.s006">
      <label>S6 Appendix</label>
      <caption>
        <title>Burst Weights.</title>
        <p>Theory underpinning the choice of using burst size as weights for FRET estimation.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0160716.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Eyal Nir and Dr. Toma Tomov for support in the implementation of the 2CDE method and Dr. Achillefs Kapanidis and Dr. Nicole Robb for providing experimental data for testing the BVA implementation. This work was supported by National Institutes of Health (NIH) grant R01-GM95904 and R01-GM069709. Dr. Weiss discloses equity in Nesher Technologies and intellectual property used in the research reported here. The work at UCLA was conducted in Dr. Weiss’s Laboratory.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0160716.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>S</given-names></name>. <article-title>Fluorescence Spectroscopy of Single Biomolecules</article-title>. <source>Science</source>. <year>1999</year>;<volume>283</volume>(<issue>5408</issue>):<fpage>1676</fpage>–<lpage>1683</lpage>. <pub-id pub-id-type="doi">10.1126/science.283.5408.1676</pub-id><?supplied-pmid 10073925?><pub-id pub-id-type="pmid">10073925</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hohlbein</surname><given-names>J</given-names></name>, <name><surname>Craggs</surname><given-names>TD</given-names></name>, <name><surname>Cordes</surname><given-names>T</given-names></name>. <article-title>Alternating-laser excitation: single-molecule FRET and beyond</article-title>. <source>Chemical Society Reviews</source>. <year>2014</year>;<volume>43</volume>(<issue>4</issue>):<fpage>1156</fpage>–<lpage>1171</lpage>. <pub-id pub-id-type="doi">10.1039/C3CS60233H</pub-id><?supplied-pmid 24037326?><pub-id pub-id-type="pmid">24037326</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Lerner</surname><given-names>E</given-names></name>, <name><surname>Orevi</surname><given-names>T</given-names></name>, <name><surname>Ben Ishay</surname><given-names>E</given-names></name>, <name><surname>Amir</surname><given-names>D</given-names></name>, <name><surname>Haas</surname><given-names>E</given-names></name>. <article-title>Kinetics of fast changing intramolecular distance distributions obtained by combined analysis of FRET efficiency kinetics and time-resolved FRET equilibrium measurements</article-title>. <source>Biophysical Journal</source>. <year>2014</year>;<volume>106</volume>(<issue>3</issue>):<fpage>667</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2013.11.4500</pub-id><?supplied-pmid 24507607?><pub-id pub-id-type="pmid">24507607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Rahamim</surname><given-names>G</given-names></name>, <name><surname>Chemerovski-Glikman</surname><given-names>M</given-names></name>, <name><surname>Rahimipour</surname><given-names>S</given-names></name>, <name><surname>Amir</surname><given-names>D</given-names></name>, <name><surname>Haas</surname><given-names>E</given-names></name>. <article-title>Resolution of Two Sub-Populations of Conformers and Their Individual Dynamics by Time Resolved Ensemble Level FRET Measurements</article-title>. <source>PLoS ONE</source>. <year>2015</year>;<volume>10</volume>(<issue>12</issue>):<fpage>e0143732</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0143732</pub-id><?supplied-pmid 26699718?><pub-id pub-id-type="pmid">26699718</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Selvin</surname><given-names>PR</given-names></name>. <article-title>The renaissance of fluorescence resonance energy transfer</article-title>. <source>Nature Structural &amp; Molecular Biology</source>. <year>2000</year>;<volume>7</volume>(<issue>9</issue>):<fpage>730</fpage>–<lpage>734</lpage>. <pub-id pub-id-type="doi">10.1038/78948</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Roy</surname><given-names>R</given-names></name>, <name><surname>Hohng</surname><given-names>S</given-names></name>, <name><surname>Ha</surname><given-names>T</given-names></name>. <article-title>A practical guide to single-molecule FRET</article-title>. <source>Nature Methods</source>. <year>2008</year>;<volume>5</volume>(<issue>6</issue>):<fpage>507</fpage>–<lpage>516</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1208</pub-id><?supplied-pmid 18511918?><pub-id pub-id-type="pmid">18511918</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Schuler</surname><given-names>B</given-names></name>, <name><surname>Eaton</surname><given-names>WA</given-names></name>. <article-title>Protein folding studied by single-molecule FRET</article-title>. <source>Current Opinion in Structural Biology</source>. <year>2008</year>;<volume>18</volume>(<issue>1</issue>):<fpage>16</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1016/j.sbi.2007.12.003</pub-id><?supplied-pmid 18221865?><pub-id pub-id-type="pmid">18221865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref008">
      <label>8</label>
      <mixed-citation publication-type="book"><name><surname>Sisamakis</surname><given-names>E</given-names></name>, <name><surname>Valeri</surname><given-names>A</given-names></name>, <name><surname>Kalinin</surname><given-names>S</given-names></name>, <name><surname>Rothwell</surname><given-names>PJ</given-names></name>, <name><surname>Seidel</surname><given-names>CAM</given-names></name>. <chapter-title>Accurate Single-Molecule FRET Studies Using Multiparameter Fluorescence Detection</chapter-title> In: <source>Methods in Enzymology</source>. vol. <volume>475</volume>
<edition>1st ed</edition>
<publisher-name>Elsevier Inc.</publisher-name>; <year>2010</year> p. <fpage>455</fpage>–<lpage>514</lpage>. <comment>Available from: </comment><pub-id pub-id-type="doi">10.1016/S0076-6879(10)75018-7</pub-id><pub-id pub-id-type="pmid">20627168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Haran</surname><given-names>G</given-names></name>. <article-title>How when and why proteins collapse: the relation to folding</article-title>. <source>Current Opinion in Structural Biology</source>. <year>2012</year>;<volume>22</volume>(<issue>1</issue>):<fpage>14</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1016/j.sbi.2011.10.005</pub-id><?supplied-pmid 22104965?><pub-id pub-id-type="pmid">22104965</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Eggeling</surname><given-names>C</given-names></name>, <name><surname>Fries</surname><given-names>JR</given-names></name>, <name><surname>Brand</surname><given-names>L</given-names></name>, <name><surname>Günther</surname><given-names>R</given-names></name>, <name><surname>Seidel</surname><given-names>CaM</given-names></name>. <article-title>Monitoring conformational dynamics of a single molecule by selective fluorescence spectroscopy</article-title>. <source>Proceedings of the National Academy of Sciences</source>.<year>1998</year>;<volume>95</volume>(<issue>4</issue>):<fpage>1556</fpage>–<lpage>1561</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.95.4.1556</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dahan</surname><given-names>M</given-names></name>, <name><surname>Deniz</surname><given-names>AA</given-names></name>, <name><surname>Ha</surname><given-names>T</given-names></name>, <name><surname>Chemla</surname><given-names>DS</given-names></name>, <name><surname>Schultz</surname><given-names>PG</given-names></name>, <name><surname>Weiss</surname><given-names>S</given-names></name>. <article-title>Ratiometric measurement and identification of single diffusing molecules</article-title>. <source>Chemical Physics</source>. <year>1999</year>;<volume>247</volume>(<issue>1</issue>):<fpage>85</fpage>–<lpage>106</lpage>. <pub-id pub-id-type="doi">10.1016/S0301-0104(99)00132-9</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Fries</surname><given-names>JR</given-names></name>, <name><surname>Brand</surname><given-names>L</given-names></name>, <name><surname>Eggeling</surname><given-names>C</given-names></name>, <name><surname>Köllner</surname><given-names>M</given-names></name>, <name><surname>Seidel</surname><given-names>CAM</given-names></name>. <article-title>Quantitative Identification of Different Single Molecules by Selective Time-Resolved Confocal Fluorescence Spectroscopy</article-title>. <source>The Journal of Physical Chemistry A</source>. <year>1998</year>;<volume>102</volume>(<issue>33</issue>):<fpage>6601</fpage>–<lpage>6613</lpage>. <pub-id pub-id-type="doi">10.1021/jp980965t</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Eggeling</surname><given-names>C</given-names></name>, <name><surname>Berger</surname><given-names>S</given-names></name>, <name><surname>Brand</surname><given-names>L</given-names></name>, <name><surname>Fries</surname><given-names>JR</given-names></name>, <name><surname>Schaffer</surname><given-names>J</given-names></name>, <name><surname>Volkmer</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Data registration and selective single-molecule analysis using multi-parameter fluorescence detection</article-title>. <source>Journal of Biotechnology</source>. <year>2001</year>;<volume>86</volume>(<issue>3</issue>):<fpage>163</fpage>–<lpage>180</lpage>. <pub-id pub-id-type="doi">10.1016/S0168-1656(00)00412-0</pub-id><?supplied-pmid 11257530?><pub-id pub-id-type="pmid">11257530</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>K</given-names></name>, <name><surname>Yang</surname><given-names>H</given-names></name>. <article-title>Photon-by-Photon Determination of Emission Bursts from Diffusing Single Chromophores</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2005</year>;<volume>109</volume>(<issue>46</issue>):<fpage>21930</fpage>–<lpage>21937</lpage>. <pub-id pub-id-type="doi">10.1021/jp0546047</pub-id><?supplied-pmid 16853850?><pub-id pub-id-type="pmid">16853850</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Gopich</surname><given-names>I</given-names></name>, <name><surname>Szabo</surname><given-names>A</given-names></name>. <article-title>Theory of photon statistics in single-molecule Förster resonance energy transfer</article-title>. <source>The Journal of Chemical Physics</source>. <year>2005</year>;<volume>122</volume>(<issue>1</issue>):<fpage>014707</fpage><pub-id pub-id-type="doi">10.1063/1.1812746</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>NK</given-names></name>, <name><surname>Kapanidis</surname><given-names>AN</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Michalet</surname><given-names>X</given-names></name>, <name><surname>Mukhopadhyay</surname><given-names>J</given-names></name>, <name><surname>Ebright</surname><given-names>RH</given-names></name>, <etal>et al</etal><article-title>Accurate FRET Measurements within Single Diffusing Biomolecules Using Alternating-Laser Excitation</article-title>. <source>Biophysical Journal</source>. <year>2005</year>;<volume>88</volume>(<issue>4</issue>):<fpage>2939</fpage>–<lpage>2953</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.104.054114</pub-id><?supplied-pmid 15653725?><pub-id pub-id-type="pmid">15653725</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Nir</surname><given-names>E</given-names></name>, <name><surname>Michalet</surname><given-names>X</given-names></name>, <name><surname>Hamadani</surname><given-names>KM</given-names></name>, <name><surname>Laurence</surname><given-names>TA</given-names></name>, <name><surname>Neuhauser</surname><given-names>D</given-names></name>, <name><surname>Kovchegov</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Shot-Noise Limited Single-Molecule FRET Histograms: Comparison between Theory and Experiments</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2006</year>;<volume>110</volume>(<issue>44</issue>):<fpage>22103</fpage>–<lpage>22124</lpage>. <pub-id pub-id-type="doi">10.1021/jp063483n</pub-id><?supplied-pmid 17078646?><pub-id pub-id-type="pmid">17078646</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Antonik</surname><given-names>M</given-names></name>, <name><surname>Felekyan</surname><given-names>S</given-names></name>, <name><surname>Gaiduk</surname><given-names>A</given-names></name>, <name><surname>Seidel</surname><given-names>CAM</given-names></name>. <article-title>Separating structural heterogeneities from stochastic variations in fluorescence resonance energy transfer distributions via photon distribution analysis</article-title>. <source>Journal of Physical Chemistry B</source>. <year>2006</year>;<volume>110</volume>(<issue>13</issue>):<fpage>6970</fpage>–<lpage>6978</lpage>. <pub-id pub-id-type="doi">10.1021/jp057257 </pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Gopich</surname><given-names>IV</given-names></name>, <name><surname>Szabo</surname><given-names>A</given-names></name>. <article-title>Single-Molecule FRET with Diffusion and Conformational Dynamics</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2007</year>;<volume>111</volume>(<issue>44</issue>):<fpage>12925</fpage>–<lpage>12932</lpage>. <pub-id pub-id-type="doi">10.1021/jp075255e</pub-id><?supplied-pmid 17929964?><pub-id pub-id-type="pmid">17929964</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Gopich</surname><given-names>IV</given-names></name>. <article-title>Concentration Effects in “Single-Molecule” Spectroscopy</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2008</year>;<volume>112</volume>(<issue>19</issue>):<fpage>6214</fpage>–<lpage>6220</lpage>. <pub-id pub-id-type="doi">10.1021/jp0764182</pub-id><?supplied-pmid 18154285?><pub-id pub-id-type="pmid">18154285</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Camley</surname><given-names>BA</given-names></name>, <name><surname>Brown</surname><given-names>FLH</given-names></name>, <name><surname>Lipman</surname><given-names>EA</given-names></name>. <article-title>Förster transfer outside the weak-excitation limit</article-title>. <source>The Journal of Chemical Physics</source>. <year>2009</year>;<volume>131</volume>(<issue>10</issue>):<fpage>104509</fpage><pub-id pub-id-type="doi">10.1063/1.3230974</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Santoso</surname><given-names>Y</given-names></name>, <name><surname>Torella</surname><given-names>JP</given-names></name>, <name><surname>Kapanidis</surname><given-names>AN</given-names></name>. <article-title>Characterizing Single-Molecule FRET Dynamics with Probability Distribution Analysis</article-title>. <source>ChemPhysChem</source>. <year>2010</year>;<volume>11</volume>(<issue>10</issue>):<fpage>2209</fpage>–<lpage>2219</lpage>. <pub-id pub-id-type="doi">10.1002/cphc.201000129</pub-id><?supplied-pmid 20575136?><pub-id pub-id-type="pmid">20575136</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Torella</surname><given-names>JP</given-names></name>, <name><surname>Holden</surname><given-names>SJ</given-names></name>, <name><surname>Santoso</surname><given-names>Y</given-names></name>, <name><surname>Hohlbein</surname><given-names>J</given-names></name>, <name><surname>Kapanidis</surname><given-names>AN</given-names></name>. <article-title>Identifying Molecular Dynamics in Single-Molecule FRET Experiments with Burst Variance Analysis</article-title>. <source>Biophysical Journal</source>. <year>2011</year>;<volume>100</volume>(<issue>6</issue>):<fpage>1568</fpage>–<lpage>1577</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2011.01.066</pub-id><?supplied-pmid 21402040?><pub-id pub-id-type="pmid">21402040</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tomov</surname><given-names>TE</given-names></name>, <name><surname>Tsukanov</surname><given-names>R</given-names></name>, <name><surname>Masoud</surname><given-names>R</given-names></name>, <name><surname>Liber</surname><given-names>M</given-names></name>, <name><surname>Plavner</surname><given-names>N</given-names></name>, <name><surname>Nir</surname><given-names>E</given-names></name>. <article-title>Disentangling Subpopulations in Single-Molecule FRET and ALEX Experiments with Photon Distribution Analysis</article-title>. <source>Biophysical Journal</source>. <year>2012</year>;<volume>102</volume>(<issue>5</issue>):<fpage>1163</fpage>–<lpage>1173</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2011.11.4025</pub-id><?supplied-pmid 22404939?><pub-id pub-id-type="pmid">22404939</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref025">
      <label>25</label>
      <mixed-citation publication-type="book"><name><surname>Buckheit</surname><given-names>JB</given-names></name>, <name><surname>Donoho</surname><given-names>DL</given-names></name>. <chapter-title>WaveLab and Reproducible Research</chapter-title> In: <source>Wavelets and Statistics</source>. vol. <volume>103</volume>
<publisher-name>Springer Science + Business Media</publisher-name>; <year>1995</year> p. <fpage>55</fpage>–<lpage>81</lpage>. <comment>Available from: </comment><pub-id pub-id-type="doi">10.1007/978-1-4612-2544-7_5</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Ince</surname><given-names>DC</given-names></name>, <name><surname>Hatton</surname><given-names>L</given-names></name>, <name><surname>Graham-Cumming</surname><given-names>J</given-names></name>. <article-title>The case for open computer programs</article-title>. <source>Nature</source>. <year>2012</year>;<volume>482</volume>(<issue>7386</issue>):<fpage>485</fpage>–<lpage>488</lpage>. <pub-id pub-id-type="doi">10.1038/nature10836</pub-id><?supplied-pmid 22358837?><pub-id pub-id-type="pmid">22358837</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Vihinen</surname><given-names>M</given-names></name>. <article-title>No more hidden solutions in bioinformatics</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>(<issue>7552</issue>):<fpage>261</fpage>–<lpage>261</lpage>. <pub-id pub-id-type="doi">10.1038/521261a</pub-id><?supplied-pmid 25993922?><pub-id pub-id-type="pmid">25993922</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">Eglen S, Marwick B, Halchenko Y, Hanke M, Sufi S, Gleeson P, et al. Towards standard practices for sharing computer code and programs in neuroscience. bioRxiv. 2016;</mixed-citation>
    </ref>
    <ref id="pone.0160716.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>McKinney</surname><given-names>SA</given-names></name>, <name><surname>Joo</surname><given-names>C</given-names></name>, <name><surname>Ha</surname><given-names>T</given-names></name>. <article-title>Analysis of Single-Molecule FRET Trajectories Using Hidden Markov Modeling</article-title>. <source>Biophysical Journal</source>. <year>2006</year>;<volume>91</volume>(<issue>5</issue>):<fpage>1941</fpage>–<lpage>1951</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.106.082487</pub-id><?supplied-pmid 16766620?><pub-id pub-id-type="pmid">16766620</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Bronson</surname><given-names>JE</given-names></name>, <name><surname>Fei</surname><given-names>J</given-names></name>, <name><surname>Hofman</surname><given-names>JM</given-names></name>, <name><surname>Gonzalez</surname><given-names>RL</given-names></name>, <name><surname>Wiggins</surname><given-names>CH</given-names></name>. <article-title>Learning Rates and States from Biophysical Time Series: A Bayesian Approach to Model Selection and Single-Molecule FRET Data</article-title>. <source>Biophysical Journal</source>. <year>2009</year>;<volume>97</volume>(<issue>12</issue>):<fpage>3196</fpage>–<lpage>3205</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2009.09.031</pub-id><?supplied-pmid 20006957?><pub-id pub-id-type="pmid">20006957</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Greenfeld</surname><given-names>M</given-names></name>, <name><surname>Pavlichin</surname><given-names>DS</given-names></name>, <name><surname>Mabuchi</surname><given-names>H</given-names></name>, <name><surname>Herschlag</surname><given-names>D</given-names></name>. <article-title>Single Molecule Analysis Research Tool (SMART): An Integrated Approach for Analyzing Single Molecule Data</article-title>. <source>PLoS ONE</source>. <year>2012</year>;<volume>7</volume>(<issue>2</issue>):<fpage>e30024</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0030024</pub-id><?supplied-pmid 22363412?><pub-id pub-id-type="pmid">22363412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>König</surname><given-names>SLB</given-names></name>, <name><surname>Hadzic</surname><given-names>M</given-names></name>, <name><surname>Fiorini</surname><given-names>E</given-names></name>, <name><surname>Börner</surname><given-names>R</given-names></name>, <name><surname>Kowerko</surname><given-names>D</given-names></name>, <name><surname>Blanckenhorn</surname><given-names>WU</given-names></name>, <etal>et al</etal><article-title>BOBA FRET: Bootstrap-Based Analysis of Single-Molecule FRET Data</article-title>. <source>PLoS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e84157</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0084157</pub-id><pub-id pub-id-type="pmid">24386343</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>van de Meent</surname><given-names>JW</given-names></name>, <name><surname>Bronson</surname><given-names>JE</given-names></name>, <name><surname>Wiggins</surname><given-names>CH</given-names></name>, <name><surname>Gonzalez</surname><given-names>RL</given-names></name>. <article-title>Empirical Bayes Methods Enable Advanced Population-Level Analyses of Single-Molecule FRET Experiments</article-title>. <source>Biophysical Journal</source>. <year>2014</year>;<volume>106</volume>(<issue>6</issue>):<fpage>1327</fpage>–<lpage>1337</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2013.12.055</pub-id><?supplied-pmid 24655508?><pub-id pub-id-type="pmid">24655508</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">Murphy RR, Jackson SE, Klenerman D. pyFRET: A Python Library for Single Molecule Fluorescence Data Analysis. ArXiv. 2014;.</mixed-citation>
    </ref>
    <ref id="pone.0160716.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Shen</surname><given-names>H</given-names></name>. <article-title>Interactive notebooks: Sharing the code</article-title>. <source>Nature</source>. <year>2014</year>;<volume>515</volume>(<issue>7525</issue>):<fpage>151</fpage>–<lpage>152</lpage>. <pub-id pub-id-type="doi">10.1038/515151a</pub-id><?supplied-pmid 25373681?><pub-id pub-id-type="pmid">25373681</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref036">
      <label>36</label>
      <mixed-citation publication-type="other">Soergel DAW. Rampant software errors may undermine scientific results. F1000Research. 2015;</mixed-citation>
    </ref>
    <ref id="pone.0160716.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Wilson</surname><given-names>G</given-names></name>, <name><surname>Aruliah</surname><given-names>DA</given-names></name>, <name><surname>Brown</surname><given-names>CT</given-names></name>, <name><surname>Hong</surname><given-names>NPC</given-names></name>, <name><surname>Davis</surname><given-names>M</given-names></name>, <name><surname>Guy</surname><given-names>RT</given-names></name>, <etal>et al</etal><article-title>Best Practices for Scientific Computing</article-title>. <source>PLoS Biology</source>. <year>2014</year>;<volume>12</volume>(<issue>1</issue>):<fpage>e1001745</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1001745</pub-id><?supplied-pmid 24415924?><pub-id pub-id-type="pmid">24415924</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Blischak</surname><given-names>JD</given-names></name>, <name><surname>Davenport</surname><given-names>ER</given-names></name>, <name><surname>Wilson</surname><given-names>G</given-names></name>. <article-title>A Quick Introduction to Version Control with Git and GitHub</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>1</issue>):<fpage>e1004668</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004668</pub-id><?supplied-pmid 26785377?><pub-id pub-id-type="pmid">26785377</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Prlić</surname><given-names>A</given-names></name>, <name><surname>Procter</surname><given-names>JB</given-names></name>. <article-title>Ten Simple Rules for the Open Development of Scientific Software</article-title>. <source>PLoS Computational Biology</source>. <year>2012</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e1002802</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002802</pub-id><?supplied-pmid 23236269?><pub-id pub-id-type="pmid">23236269</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Ingargiola</surname><given-names>A</given-names></name>, <name><surname>Laurence</surname><given-names>T</given-names></name>, <name><surname>Boutelle</surname><given-names>R</given-names></name>, <name><surname>Weiss</surname><given-names>S</given-names></name>, <name><surname>Michalet</surname><given-names>X</given-names></name>. <article-title>Photon-HDF5: An Open File Format for Timestamp-Based Single-Molecule Fluorescence Experiments</article-title>. <source>Biophysical Journal</source>. <year>2016</year>;<volume>110</volume>(<issue>1</issue>):<fpage>26</fpage>–<lpage>33</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2015.11.013</pub-id><?supplied-pmid 26745406?><pub-id pub-id-type="pmid">26745406</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref041">
      <label>41</label>
      <mixed-citation publication-type="book"><name><surname>Ingargiola</surname><given-names>A</given-names></name>, <name><surname>Laurence</surname><given-names>T</given-names></name>, <name><surname>Boutelle</surname><given-names>R</given-names></name>, <name><surname>Weiss</surname><given-names>S</given-names></name>, <name><surname>Michalet</surname><given-names>X</given-names></name>. <chapter-title>Photon-HDF5: open data format and computational tools for timestamp-based single-molecule experiments</chapter-title> In: <source>Single Molecule Spectroscopy and Superresolution Imaging IX</source>. vol. <volume>971405</volume>
<publisher-name>SPIE</publisher-name>; <year>2016</year>
<comment>Available from: </comment><pub-id pub-id-type="doi">10.1117/12.2212085</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref042">
      <label>42</label>
      <mixed-citation publication-type="book"><name><surname>Ingargiola</surname><given-names>A</given-names></name>, <name><surname>Panzeri</surname><given-names>F</given-names></name>, <name><surname>Sarkhosh</surname><given-names>N</given-names></name>, <name><surname>Gulinatti</surname><given-names>A</given-names></name>, <name><surname>Rech</surname><given-names>I</given-names></name>, <name><surname>Ghioni</surname><given-names>M</given-names></name>, <etal>et al</etal><chapter-title>8-spot smFRET analysis using two 8-pixel SPAD arrays</chapter-title> In: <source>Single Molecule Spectroscopy and Superresolution Imaging VI</source>. vol. <volume>8590</volume>
<publisher-name>SPIE</publisher-name>; <year>2013</year> p. <fpage>85900E</fpage>–<lpage>85900E-11</lpage>. <comment>Available from: </comment><pub-id pub-id-type="doi">10.1117/12.2003704</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Kapanidis</surname><given-names>AN</given-names></name>, <name><surname>Laurence</surname><given-names>TA</given-names></name>, <name><surname>Lee</surname><given-names>NK</given-names></name>, <name><surname>Margeat</surname><given-names>E</given-names></name>, <name><surname>Kong</surname><given-names>X</given-names></name>, <name><surname>Weiss</surname><given-names>S</given-names></name>. <article-title>Alternating-Laser Excitation of Single Molecules</article-title>. <source>Accounts of Chemical Research</source>. <year>2005</year>;<volume>38</volume>(<issue>7</issue>):<fpage>523</fpage>–<lpage>533</lpage>. <pub-id pub-id-type="doi">10.1021/ar0401348</pub-id><?supplied-pmid 16028886?><pub-id pub-id-type="pmid">16028886</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Laurence</surname><given-names>TA</given-names></name>, <name><surname>Kong</surname><given-names>X</given-names></name>, <name><surname>Jäger</surname><given-names>M</given-names></name>, <name><surname>Weiss</surname><given-names>S</given-names></name>. <article-title>Probing structural heterogeneities and fluctuations of nucleic acids and denatured proteins</article-title>. <source>Proceedings of the National Academy of Sciences</source>.<year>2005</year>;<volume>102</volume>(<issue>48</issue>):<fpage>17348</fpage>–<lpage>17353</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0508584102</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Müller</surname><given-names>BK</given-names></name>, <name><surname>Zaychikov</surname><given-names>E</given-names></name>, <name><surname>Bräuchle</surname><given-names>C</given-names></name>, <name><surname>Lamb</surname><given-names>DC</given-names></name>. <article-title>Pulsed Interleaved Excitation</article-title>. <source>Biophysical Journal</source>. <year>2005</year>;<volume>89</volume>(<issue>5</issue>):<fpage>3508</fpage>–<lpage>3522</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.105.064766</pub-id><?supplied-pmid 16113120?><pub-id pub-id-type="pmid">16113120</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Michalet</surname><given-names>X</given-names></name>, <name><surname>Colyer</surname><given-names>RA</given-names></name>, <name><surname>Scalia</surname><given-names>G</given-names></name>, <name><surname>Ingargiola</surname><given-names>A</given-names></name>, <name><surname>Lin</surname><given-names>R</given-names></name>, <name><surname>Millaud</surname><given-names>JE</given-names></name>, <etal>et al</etal><article-title>Development of new photon-counting detectors for single-molecule fluorescence microscopy</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2012</year>;<volume>368</volume>(<issue>1611</issue>):<fpage>20120035</fpage>–<lpage>20120035</lpage>. <pub-id pub-id-type="doi">10.1098/rstb.2012.0035</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref047">
      <label>47</label>
      <mixed-citation publication-type="other">Droettboom M, Hunter J, Caswell TA, Firing E, Nielsen JH, Elson P, et al‥ matplotlib: matplotlib v1.5.1; 2016. <comment>Available from: </comment><pub-id pub-id-type="doi">10.5281/zenodo.44579</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Edman</surname><given-names>L</given-names></name>, <name><surname>Mets</surname><given-names>U</given-names></name>, <name><surname>Rigler</surname><given-names>R</given-names></name>. <article-title>Conformational transitions monitored for single molecules in solution</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1996</year>;<volume>93</volume>(<issue>13</issue>):<fpage>6710</fpage>–<lpage>6715</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.93.13.6710</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Deniz</surname><given-names>AA</given-names></name>, <name><surname>Dahan</surname><given-names>M</given-names></name>, <name><surname>Grunwell</surname><given-names>JR</given-names></name>, <name><surname>Ha</surname><given-names>T</given-names></name>, <name><surname>Faulhaber</surname><given-names>AE</given-names></name>, <name><surname>Chemla</surname><given-names>DS</given-names></name>, <etal>et al</etal><article-title>Single-pair fluorescence resonance energy transfer on freely diffusing molecules: Observation of Forster distance dependence and subpopulations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1999</year>;<volume>96</volume>(<issue>7</issue>):<fpage>3670</fpage>–<lpage>3675</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.96.7.3670</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Kapanidis</surname><given-names>AN</given-names></name>, <name><surname>Lee</surname><given-names>NK</given-names></name>, <name><surname>Laurence</surname><given-names>TA</given-names></name>, <name><surname>Doose</surname><given-names>S</given-names></name>, <name><surname>Margeat</surname><given-names>E</given-names></name>, <name><surname>Weiss</surname><given-names>S</given-names></name>. <article-title>Fluorescence-aided molecule sorting: Analysis of structure and interactions by alternating-laser excitation of single molecules</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2004</year>;<volume>101</volume>(<issue>24</issue>):<fpage>8936</fpage>–<lpage>8941</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0401690101</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref051">
      <label>51</label>
      <mixed-citation publication-type="other">Newville M, Nelson A, Stensitzki T, Ingargiola A, Allan D, Michał, et al‥ lmfit-py: release 0.9.3; 2016. <comment>Available from: </comment><pub-id pub-id-type="doi">10.5281/zenodo.49428</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Akaike</surname><given-names>H</given-names></name>. <article-title>A new look at the statistical model identification</article-title>. <source>IEEE Transactions on Automatic Control</source>. <year>1974</year>;<volume>19</volume>(<issue>6</issue>):<fpage>716</fpage>–<lpage>723</lpage>. <pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Schwarz</surname><given-names>G</given-names></name>. <article-title>Estimating the Dimension of a Model</article-title>. <source>The Annals of Statistics</source>. <year>1978</year>;<volume>6</volume>(<issue>2</issue>):<fpage>461</fpage>–<lpage>464</lpage>. <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref054">
      <label>54</label>
      <mixed-citation publication-type="book"><name><surname>Burnham</surname><given-names>KP</given-names></name>, <name><surname>Anderson</surname><given-names>DR</given-names></name>. <source>Model selection and multimodel inference: a practical information-theoretic approach</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2002</year><comment>Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/b97636">http://link.springer.com/10.1007/b97636</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Kalinin</surname><given-names>S</given-names></name>, <name><surname>Felekyan</surname><given-names>S</given-names></name>, <name><surname>Antonik</surname><given-names>M</given-names></name>, <name><surname>Seidel</surname><given-names>CAM</given-names></name>. <article-title>Probability Distribution Analysis of Single-Molecule Fluorescence Anisotropy and Resonance Energy Transfer</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2007</year>;<volume>111</volume>(<issue>34</issue>):<fpage>10253</fpage>–<lpage>10262</lpage>. <pub-id pub-id-type="doi">10.1021/jp072293p</pub-id><?supplied-pmid 17676789?><pub-id pub-id-type="pmid">17676789</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Gopich</surname><given-names>IV</given-names></name>, <name><surname>Szabo</surname><given-names>A</given-names></name>. <article-title>FRET Efficiency Distributions of Multistate Single Molecules</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2010</year>;<volume>114</volume>(<issue>46</issue>):<fpage>15221</fpage>–<lpage>15226</lpage>. <pub-id pub-id-type="doi">10.1021/jp105359z</pub-id><?supplied-pmid 21028764?><pub-id pub-id-type="pmid">21028764</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Santoso</surname><given-names>Y</given-names></name>, <name><surname>Kapanidis</surname><given-names>AN</given-names></name>. <article-title>Probing biomolecular structures and dynamics of single molecules using in-gel alternating-laser excitation</article-title>. <source>Analytical chemistry</source>. <year>2009</year>;<volume>81</volume>(<issue>23</issue>):<fpage>9561</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1021/ac901423e</pub-id><?supplied-pmid 19863108?><pub-id pub-id-type="pmid">19863108</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Kalinin</surname><given-names>S</given-names></name>, <name><surname>Sisamakis</surname><given-names>E</given-names></name>, <name><surname>Magennis</surname><given-names>SW</given-names></name>, <name><surname>Felekyan</surname><given-names>S</given-names></name>, <name><surname>Seidel</surname><given-names>CAM</given-names></name>. <article-title>On the Origin of Broadening of Single-Molecule FRET Efficiency Distributions beyond Shot Noise Limits</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2010</year>;<volume>114</volume>(<issue>18</issue>):<fpage>6197</fpage>–<lpage>6206</lpage>. <pub-id pub-id-type="doi">10.1021/jp100025v</pub-id><?supplied-pmid 20397670?><pub-id pub-id-type="pmid">20397670</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Gopich</surname><given-names>IV</given-names></name>, <name><surname>Szabo</surname><given-names>A</given-names></name>. <article-title>Decoding the Pattern of Photon Colors in Single-Molecule FRET</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2009</year>;<volume>113</volume>(<issue>31</issue>):<fpage>10965</fpage>–<lpage>10973</lpage>. <pub-id pub-id-type="doi">10.1021/jp903671p</pub-id><?supplied-pmid 19588948?><pub-id pub-id-type="pmid">19588948</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref060">
      <label>60</label>
      <mixed-citation publication-type="book"><name><surname>Gopich</surname><given-names>IV</given-names></name>, <name><surname>Szabo</surname><given-names>A</given-names></name>. <chapter-title>Theory of Single-Molecule FRET Efficiency Histograms</chapter-title> In: <name><surname>Komatsuzaki</surname><given-names>T</given-names></name>, <name><surname>Kawakami</surname><given-names>M</given-names></name>, <name><surname>Takahashi</surname><given-names>S</given-names></name>, <name><surname>Yang</surname><given-names>H</given-names></name>, <name><surname>Silbey</surname><given-names>RJ</given-names></name>, editors. <source>Single-Molecule Biophysics: Experiment and Theory, Volume 146. vol. 146 of Advances in Chemical Physics</source>. <publisher-loc>Hoboken NJ, USA</publisher-loc>: <publisher-name>John Wiley &amp; Sons, Inc.</publisher-name>; <year>2011</year> p. <fpage>245</fpage>–<lpage>297</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/9781118131374.ch10">http://doi.wiley.com/10.1002/9781118131374.ch10</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Hoffmann</surname><given-names>A</given-names></name>, <name><surname>Nettels</surname><given-names>D</given-names></name>, <name><surname>Clark</surname><given-names>J</given-names></name>, <name><surname>Borgia</surname><given-names>A</given-names></name>, <name><surname>Radford</surname><given-names>SE</given-names></name>, <name><surname>Clarke</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Quantifying heterogeneity and conformational dynamics from single molecule FRET of diffusing molecules: recurrence analysis of single particles (RASP)</article-title>. <source>Physical Chemistry Chemical Physics</source>. <year>2011</year>;<volume>13</volume>(<issue>5</issue>). <pub-id pub-id-type="doi">10.1039/c0cp01911a</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Laurence</surname><given-names>TA</given-names></name>, <name><surname>Kwon</surname><given-names>Y</given-names></name>, <name><surname>Yin</surname><given-names>E</given-names></name>, <name><surname>Hollars</surname><given-names>CW</given-names></name>, <name><surname>Camarero</surname><given-names>JA</given-names></name>, <name><surname>Barsky</surname><given-names>D</given-names></name>. <article-title>Correlation Spectroscopy of Minor Fluorescent Species: Signal Purification and Distribution Analysis</article-title>. <source>Biophysical Journal</source>. <year>2007</year>;<volume>92</volume>(<issue>6</issue>):<fpage>2184</fpage>–<lpage>2198</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.106.093591</pub-id><?supplied-pmid 17189306?><pub-id pub-id-type="pmid">17189306</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Torres</surname><given-names>T</given-names></name>, <name><surname>Levitus</surname><given-names>M</given-names></name>. <article-title>Measuring Conformational Dynamics: A New FCS-FRET Approach</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2007</year>;<volume>111</volume>(<issue>25</issue>):<fpage>7392</fpage>–<lpage>7400</lpage>. <pub-id pub-id-type="doi">10.1021/jp070659s</pub-id><?supplied-pmid 17547447?><pub-id pub-id-type="pmid">17547447</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Nettels</surname><given-names>D</given-names></name>, <name><surname>Hoffmann</surname><given-names>A</given-names></name>, <name><surname>Schuler</surname><given-names>B</given-names></name>. <article-title>Unfolded Protein and Peptide Dynamics Investigated with Single-Molecule FRET and Correlation Spectroscopy from Picoseconds to Seconds</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2008</year>;<volume>112</volume>(<issue>19</issue>):<fpage>6137</fpage>–<lpage>6146</lpage>. <pub-id pub-id-type="doi">10.1021/jp076971j</pub-id><?supplied-pmid 18410159?><pub-id pub-id-type="pmid">18410159</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>DeVore</surname><given-names>MS</given-names></name>, <name><surname>Gull</surname><given-names>SF</given-names></name>, <name><surname>Johnson</surname><given-names>CK</given-names></name>. <article-title>Classic Maximum Entropy Recovery of the Average Joint Distribution of Apparent FRET Efficiency and Fluorescence Photons for Single-Molecule Burst Measurements</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2012</year>;<volume>116</volume>(<issue>13</issue>):<fpage>4006</fpage>–<lpage>4015</lpage>. <pub-id pub-id-type="doi">10.1021/jp209861u</pub-id><?supplied-pmid 22338694?><pub-id pub-id-type="pmid">22338694</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Murphy</surname><given-names>RR</given-names></name>, <name><surname>Danezis</surname><given-names>G</given-names></name>, <name><surname>Horrocks</surname><given-names>MH</given-names></name>, <name><surname>Jackson</surname><given-names>SE</given-names></name>, <name><surname>Klenerman</surname><given-names>D</given-names></name>. <article-title>Bayesian Inference of Accurate Population Sizes and FRET Efficiencies from Single Diffusing Biomolecules</article-title>. <source>Analytical Chemistry</source>. <year>2014</year>;<volume>86</volume>(<issue>17</issue>):<fpage>8603</fpage>–<lpage>8612</lpage>. <pub-id pub-id-type="doi">10.1021/ac501188r</pub-id><?supplied-pmid 25105347?><pub-id pub-id-type="pmid">25105347</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Kou</surname><given-names>SC</given-names></name>, <name><surname>Sunney Xie</surname><given-names>X</given-names></name>, <name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>Bayesian analysis of single-molecule experimental data</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>. <year>2005</year>;<volume>54</volume>(<issue>3</issue>):<fpage>469</fpage>–<lpage>506</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9876.2005.00509.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Robb</surname><given-names>NC</given-names></name>, <name><surname>Cordes</surname><given-names>T</given-names></name>, <name><surname>Hwang</surname><given-names>LC</given-names></name>, <name><surname>Gryte</surname><given-names>K</given-names></name>, <name><surname>Duchi</surname><given-names>D</given-names></name>, <name><surname>Craggs</surname><given-names>TD</given-names></name>, <etal>et al</etal><article-title>The Transcription Bubble of the RNA Polymerase–Promoter Open Complex Exhibits Conformational Heterogeneity and Millisecond-Scale Dynamics: Implications for Transcription Start-Site Selection</article-title>. <source>Journal of Molecular Biology</source>. <year>2013</year>;<volume>425</volume>(<issue>5</issue>):<fpage>875</fpage>–<lpage>885</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2012.12.015</pub-id><?supplied-pmid 23274143?><pub-id pub-id-type="pmid">23274143</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Tsukanov</surname><given-names>R</given-names></name>, <name><surname>Tomov</surname><given-names>TE</given-names></name>, <name><surname>Masoud</surname><given-names>R</given-names></name>, <name><surname>Drory</surname><given-names>H</given-names></name>, <name><surname>Plavner</surname><given-names>N</given-names></name>, <name><surname>Liber</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Detailed Study of DNA Hairpin Dynamics Using Single-Molecule Fluorescence Assisted by DNA Origami</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2013</year>;<volume>117</volume>(<issue>40</issue>):<fpage>11932</fpage>–<lpage>11942</lpage>. <pub-id pub-id-type="doi">10.1021/jp4059214</pub-id><?supplied-pmid 24041226?><pub-id pub-id-type="pmid">24041226</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0160716.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Merali</surname><given-names>Z</given-names></name>. <article-title>Computational science:…Error</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>(<issue>7317</issue>):<fpage>775</fpage>–<lpage>777</lpage>. <pub-id pub-id-type="doi">10.1038/467775a</pub-id><?supplied-pmid 20944712?><pub-id pub-id-type="pmid">20944712</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
