<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10010604</article-id>
    <article-id pub-id-type="pmid">36825830</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad102</article-id>
    <article-id pub-id-type="publisher-id">btad102</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SMITH: spatially constrained stochastic model for simulation of intra-tumour heterogeneity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7302-0147</contrib-id>
        <name>
          <surname>Streck</surname>
          <given-names>Adam</given-names>
        </name>
        <aff><institution>Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Berlin Institute for Medical Systems Biology</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Computational Cancer Biology (ICCB), Center for Integrated Oncology (CIO), Cancer Research Center Cologne Essen (CCCE), Faculty of Medicine and University Hospital Cologne, University of Cologne</institution>, Cologne, <country country="DE">Germany</country></aff>
        <xref rid="btad102-cor1" ref-type="corresp"/>
        <xref rid="btad102-FM2" ref-type="author-notes"/>
        <!--adam.streck@mdc-berlin.de-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaufmann</surname>
          <given-names>Tom L</given-names>
        </name>
        <aff><institution>BIFOLD—Berlin Institute for the Foundations of Learning and Data</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Computational Cancer Biology (ICCB), Center for Integrated Oncology (CIO), Cancer Research Center Cologne Essen (CCCE), Faculty of Medicine and University Hospital Cologne, University of Cologne</institution>, Cologne, <country country="DE">Germany</country></aff>
        <aff><institution>Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Berlin Institute for Medical Systems Biology</institution>, Berlin, <country country="DE">Germany</country></aff>
        <xref rid="btad102-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Schwarz</surname>
          <given-names>Roland F</given-names>
        </name>
        <aff><institution>Institute for Computational Cancer Biology (ICCB), Center for Integrated Oncology (CIO), Cancer Research Center Cologne Essen (CCCE), Faculty of Medicine and University Hospital Cologne, University of Cologne</institution>, Cologne, <country country="DE">Germany</country></aff>
        <aff><institution>BIFOLD—Berlin Institute for the Foundations of Learning and Data</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Berlin Institute for Medical Systems Biology</institution>, Berlin, <country country="DE">Germany</country></aff>
        <xref rid="btad102-cor1" ref-type="corresp"/>
        <!--roland.schwarz@uni-koeln.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btad102-FM2">
        <p>The authors wish it to be known that, in their opinion, Adam Streck and Tom L Kaufmann should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btad102-cor1">To whom correspondence should be addressed. <email>roland.schwarz@uni-koeln.de</email> or <email>adam.streck@mdc-berlin.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-24">
      <day>24</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>3</issue>
    <elocation-id>btad102</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>18</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad102.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Simulations of cancer evolution are highly useful to study the effects of selection and mutation rates on cellular fitness. However, most methods are either lattice-based and cannot simulate realistically sized tumours, or they omit spatial constraints and lack the clonal dynamics of real-world tumours.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Stochastic model of intra-tumour heterogeneity (SMITH) is an efficient and explainable model of cancer evolution that combines a branching process with a new confinement mechanism limiting clonal growth based on the size of the individual clones as well as the overall tumour population. We demonstrate how confinement is sufficient to induce the rich clonal dynamics observed in spatial models and cancer samples across tumour types, while allowing for a clear geometric interpretation and simulation of 1 billion cells within a few minutes on a desktop PC.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>SMITH is implemented in C# and freely available at <ext-link xlink:href="https://bitbucket.org/schwarzlab/smith" ext-link-type="uri">https://bitbucket.org/schwarzlab/smith</ext-link>. For visualizations, we provide the accompanying Python package PyFish at <ext-link xlink:href="https://bitbucket.org/schwarzlab/pyfish" ext-link-type="uri">https://bitbucket.org/schwarzlab/pyfish</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Ministry for Education and Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01IS18025A</award-id>
        <award-id>01IS18037A</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Carcinogenesis is governed by random mutational processes and selection, which give rise to intra-tumour heterogeneity (ITH), a main driver of progression, metastasis and treatment resistance (<xref rid="btad102-B18" ref-type="bibr">Marusyk <italic toggle="yes">et al.</italic>, 2020</xref>). To understand ITH, algorithms for inferring cancer evolution from, for example, sequencing data of clinical tumour specimens have proven highly valuable (<xref rid="btad102-B2" ref-type="bibr">Beerenwinkel <italic toggle="yes">et al.</italic>, 2015</xref>). Due to computational advances and the increasing availability of data, forward simulations of cancer evolution are now gaining traction (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic>, 2021</xref>), as they allow direct testing of biological hypotheses and modelling assumptions and enable the rapid exploration of the effects of fitness distributions and mutation rates on cancer evolution.</p>
    <p>Models for simulating cancer evolution often employ variants of cellular automata, where cells or groups of cells are positioned on a 2D or a 3D lattice (<xref rid="btad102-B12" ref-type="bibr">Iwasaki and Innan, 2017</xref>). The lattice embedding directly creates spatial constraints which enable the simulation of, for example, biopsy results (<xref rid="btad102-B5" ref-type="bibr">Chkhaidze <italic toggle="yes">et al.</italic>, 2019</xref>) or the dispersal of cells in space (<xref rid="btad102-B32" ref-type="bibr">Waclaw <italic toggle="yes">et al.</italic>, 2015</xref>), or between neighbouring tissues (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>). However, capturing the mechanical behaviour of cells is difficult, and simplifying rules are frequently employed, for example, that a whole row of cells needs to be moved at once (<xref rid="btad102-B5" ref-type="bibr">Chkhaidze <italic toggle="yes">et al.</italic>, 2019</xref>), or that dead cells have to disappear from the lattice (<xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic>, 2021</xref>). Additionally, simulating realistically sized tumours of 1–2 cm in diameter comprising around 1 billion cells (<xref rid="btad102-B7" ref-type="bibr">Del Monte, 2009</xref>) remains difficult even on supercomputer architecture (<xref rid="btad102-B26" ref-type="bibr">Rosenbauer <italic toggle="yes">et al.</italic>, 2020</xref>). Thus, cells are usually grouped to uniform populations of glands (<xref rid="btad102-B28" ref-type="bibr">Sottoriva <italic toggle="yes">et al.</italic>, 2015</xref>), demes (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>) or severely limited in number (<xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>Conversely, stochastic models of well-mixed populations, such as the commonly used branching process model of cancer (<xref rid="btad102-B11" ref-type="bibr">Haccou <italic toggle="yes">et al.</italic>, 2005</xref>), are highly scalable, but assume an exponentially growing population without spatial constraints. These unconstrained models only exhibit a limited amount of clonal dynamics and are characterized by a low number of driver mutations and low-to-medium clonal diversity (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>). They have been successfully applied to modelling clonal haematopoiesis, where space is not a primary limiting factor (<xref rid="btad102-B33" ref-type="bibr">Watson <italic toggle="yes">et al.</italic>, 2020</xref>), but their applicability to solid tumours remains limited. Therefore, there is a general need for efficient and scalable models of tumour evolution that include spatial constraints.</p>
    <p>We therefore present Stochastic model of intra-tumour heterogeneity (SMITH)—a fast stochastic model of cancer evolution that can simulate realistically sized tumours of up to 1 billion cells. SMITH employs a classical branching model of cancer, with random cell birth and death processes modulated by fitness-increasing mutations, and without an explicit representation of cell location. SMITH additionally introduces <italic toggle="yes">confinement</italic>, a mechanic that limits the size of the growing population either by the size of the whole tumour (global confinement) or individually per clone (local confinement). Confinement separates the tumour into a proliferating shell and a static core, providing a natural way to represent both well-mixed and surface-growth models of cancer growth. Our approach is inspired by the observation that in solid tumours the number of cells that undergo cell division scales with the cell population raised to the power of two-thirds, corresponding to the surface area of a sphere (<xref rid="btad102-B29" ref-type="bibr">Talkington and Durrett, 2015</xref>).</p>
    <p>We systematically assess the effects of confinement and demonstrate that increasing global confinement, that is, increasing overall selection pressure, causes an increase in the number of driver mutations in the simulated tumours, whereas increasing local confinement increases the clonal diversity. We show in principle and in comparison to real cancer data (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>) that local and global confinement are sufficient to recreate most commonly observed patterns of cancer evolution, including neutral, ‘linear’ and ‘branched’ evolution. Additionally, we leverage the high performance of SMITH to repeatedly simulate realistically sized tumour cell populations, orders of magnitude faster than explicit spatial models and evaluate the most important modelling assumptions and choices made in literature, such as population size and fitness distribution.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Our model stochastically describes the size of tumour cell populations over time, thereby tracking the number of cells, their mutations and the evolutionary relationship between them. SMITH is based on a Galton–Watson branching process (<xref rid="btad102-B25" ref-type="bibr">Roch, 2015</xref>) and makes use of four key assumptions: (i) a low mutation probability with a non-negative fitness effect (driver mutations), (ii) a well-mixed population of cells, (iii) a spherical tumour shape and (iv) confined growth. Assumptions (i) and (ii) are common in branching process modelling and (iii) describes a well-studied group of tumours (<xref rid="btad102-B3" ref-type="bibr">Black and McGranahan, 2021</xref>). Assumption (iv) is specific to our model and directly changes the dynamics of the system. It is explained in detail in Section 2.5.</p>
    <sec>
      <title>2.1 Model overview</title>
      <p>A tumour as modelled by SMITH comprises two different types of cells: <italic toggle="yes">alive</italic> cells (which can be dividing or non-dividing) and <italic toggle="yes">necrotic</italic> cells. A newly created cell is always <italic toggle="yes">alive</italic>. Upon its death it can either be degraded (removed from the system) or remains embedded in the tumour as a <italic toggle="yes">necrotic</italic> cell, where it continues to contribute to the overall tumour mass, but does not divide any longer. SMITH does not model cellular position explicitly, it only keeps track of the number of cells in clones, where each clone is a collection of cells sharing the same set of mutations. Formally, a clone is a triplet <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> describe the number of alive and necrotic cells in that clone, respectively, and <italic toggle="yes">c<sub>M</sub></italic> describes the set of mutations shared by all the cells in <italic toggle="yes">c</italic>. Each mutation from the set of all possible mutations (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">M</mml:mi></mml:mrow></mml:math></inline-formula>) is unique. The set of possible mutations <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi mathvariant="script" class="calligraphy">M</mml:mi></mml:math></inline-formula> is thereby considered infinite (infinite sites assumption; <xref rid="btad102-B15" ref-type="bibr">Kimura, 1969</xref>) and every mutation can only occur once.</p>
      <p>SMITH is parametrized via <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>mut</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>, which describes the mutation probability per cell division, the average fitness increase of a mutation and the global and local confinement, respectively. Each parameter is explained in a corresponding section below.</p>
      <p>To describe the state of the system over time <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we denote as <italic toggle="yes">C<sup>t</sup></italic> the set of clones at time step <italic toggle="yes">t</italic>. All simulations start from a single clone with a single alive cell characterized by a single identifying mutation, that is, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. A simulation is then a transformation of <italic toggle="yes">C<sup>t</sup></italic> into <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> under the parameter set <italic toggle="yes">θ</italic>. For brevity, we use counts for alive and necrotic cells across the whole population as <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>We use two stopping conditions for the simulation: the maximum number of time steps <inline-formula id="IE9000"><mml:math id="IM9000" display="inline" overflow="scroll"><mml:mi>max_steps</mml:mi></mml:math></inline-formula> and the maximum population size <inline-formula id="IE9001"><mml:math id="IM9001" display="inline" overflow="scroll"><mml:mi>max_pop</mml:mi></mml:math></inline-formula>. The simulation stops at a step <italic toggle="yes">t</italic> when <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mtext>max_steps</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mtext>max</mml:mtext><mml:mo>_</mml:mo><mml:mtext>pop</mml:mtext></mml:math></inline-formula> or <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We also require the model to reach a minimum population <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mtext>min_pop</mml:mtext></mml:math></inline-formula>. If the simulation terminates while <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mtext>min</mml:mtext><mml:mo>_</mml:mo><mml:mtext>pop</mml:mtext></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mtext>max</mml:mtext><mml:mo>_</mml:mo><mml:mtext>steps</mml:mtext></mml:mrow></mml:math></inline-formula>, the result is discarded and the simulation restarts. For a schematic overview of the algorithm, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
      <fig position="float" id="btad102-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Confinement. (<bold>a</bold>) A tumour with four clones, where any individual cell is assumed to constitute one unit volume of space. Global confinement (dashed circle) splits the tumour into a proliferating shell, containing <italic toggle="yes">V</italic><sub>shell</sub> dividing cells, and a core with radius <italic toggle="yes">r</italic><sub>core</sub> of alive but not dividing and necrotic cells. The probability of a cell dividing is then a combination of its fitness and the probability of it being in the shell, given by the ratio <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext>shell</mml:mtext></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext>shell</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext>core</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Similarly, dead cells are either removed or become necrotic based on the shell fraction. (<bold>b</bold>) A model with only local confinement (dotted circles). Each clone is independent and its growth is restricted only by its own population. (<bold>c</bold>) An approximate illustration of the combination of the global and the local confinement (solid outline). Clones compete for shared resources but are also limited by their own size</p>
        </caption>
        <graphic xlink:href="btad102f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Cell turnover</title>
      <p>We first assume a basic system in homeostasis where the number of cells is kept constant on average and without novel mutations or necrosis. We define a birth and death process by sampling the number of cells that are born <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and that have died <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at time step <italic toggle="yes">t</italic> in clone <italic toggle="yes">c</italic> from a binomial distribution. The granularity of each simulation step is given by the value <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mtext>step_size</mml:mtext><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>, with the birth probability function <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>birth</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>step</mml:mtext><mml:mo>_</mml:mo><mml:mtext>size</mml:mtext></mml:mrow></mml:math></inline-formula> and the death probability <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>death</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>step</mml:mtext><mml:mo>_</mml:mo><mml:mtext>size</mml:mtext></mml:mrow></mml:math></inline-formula>. The number of alive cells at time step <italic toggle="yes">t </italic>+<italic toggle="yes"> </italic>1 is then defined as:
where <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> denotes the clone <italic toggle="yes">c</italic> at time step <italic toggle="yes">t</italic>. The next state of the simulation is then obtained as <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Necrosis is introduced in Section 2.5, therefore in the homeostatic system <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> stays at 0 for all <italic toggle="yes">t</italic>.</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>d</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mtext>Bin</mml:mtext>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>death</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mtext>Bin</mml:mtext>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>birth</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>=</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:msubsup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>d</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Note that if <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>birth</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>death</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the population size increases exponentially. In the opposite case, the population would eventually die out. We thus set the birth and death probability equal to the turnover probability, keeping the population size constant on average. However, due to stochastic fluctuations, the population will always die out after a large, but finite number of steps (extinction event). This behaviour is common to all frameworks that include stochastic cell death (<xref rid="btad102-B25" ref-type="bibr">Roch, 2015</xref>) and where the extinction probability grows with <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mtext>step_size</mml:mtext></mml:math></inline-formula> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). We avoid the problem in practice by setting a sufficiently small <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mtext>step_size</mml:mtext></mml:math></inline-formula> and a correspondingly large <inline-formula id="IE9002"><mml:math id="IM9002" display="inline" overflow="scroll"><mml:mi>min_pop</mml:mi></mml:math></inline-formula>. In summary, at this stage, our system comprises a single clone, which is roughly constant in size and shows no clonal dynamics.</p>
      <fig position="float" id="btad102-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Combinations of global and local confinement can create different modes of evolution: (<bold>a</bold>) non-spatial evolution in the absence of confinement, (<bold>b</bold>) linear evolution after addition of global confinement, (<bold>c</bold>) branched evolution if only local confinement is enabled and (<bold>d</bold>) linear-to-branched evolution for the combination of local and global confinement. Left columns show the distribution of the mean number of drivers per cell and the clonal diversity for all 100 simulations per parametrization. The theoretical limit for clonal sweeps is shown as a grey line. The middle and the right columns show the clonal evolution of a representative simulation run, marked by a red circle, through a fish plot and a phylogenetic tree. For the phylogenetic trees, extinct clones (fewer than 1.000 alive cells) are crossed out. Note that for both the fish plots and phylogenetic trees, we selected only clones with a population fraction higher than 1%</p>
        </caption>
        <graphic xlink:href="btad102f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Mutations</title>
      <p>We next introduce mutations into the model. Because each mutation is unique, a new mutation always creates a new clone. We extend <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> to
</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mtext>Bin</mml:mtext>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>θ</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>mut</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="bold">m</mml:mi>
            <mml:mi mathvariant="bold">u</mml:mi>
            <mml:mi mathvariant="bold">t</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>min</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>=</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:msubsup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>d</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mi mathvariant="bold">m</mml:mi>
            <mml:mi mathvariant="bold">u</mml:mi>
            <mml:mi mathvariant="bold">t</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>For simplicity, we only allow one driver mutation per cell division. Since <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>mut</mml:mtext></mml:mrow></mml:msub><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, this does not affect the simulation in practice.</p>
      <p>Mutated cells are removed from the group of new cells (<xref rid="E6" ref-type="disp-formula">Equation 6</xref>) and each of them spawns a new clone each with exactly one alive cell, such that for each <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>:
where <italic toggle="yes">m<sup>i</sup></italic> is a new, unique mutation. The new clones are then added to the updated population, that is, <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>∪</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>}</mml:mo><mml:mo>∪</mml:mo><mml:mi mathvariant="bold">children</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="bold">children</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>{</mml:mo>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>0</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>0</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:msub>
            <mml:mo>∪</mml:mo>
            <mml:mo>{</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>m</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msup>
            <mml:mo>}</mml:mo>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∣</mml:mo>
            <mml:mi>i</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:mo>{</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mo>…</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mi mathvariant="bold">m</mml:mi>
            <mml:mi mathvariant="bold">u</mml:mi>
            <mml:mi mathvariant="bold">t</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>}</mml:mo>
            <mml:mo>}</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Our homeostatic system now consists of several clones of equal fitness. In such a system, the appearance and disappearance of clones is simply due to stochastic fluctuations and the constant accumulation of new neutral mutations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>).</p>
    </sec>
    <sec>
      <title>2.4 Fitness</title>
      <p>We now leave the homeostatic scenario by introducing fitness-increasing driver mutations. The fitness increase <italic toggle="yes">F</italic>(<italic toggle="yes">m</italic>) that a new mutation <italic toggle="yes">m</italic> provides is drawn from a fitness distribution, <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mtext>dist</mml:mtext><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtext>uni</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>norm</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>const</mml:mtext><mml:mo>}</mml:mo></mml:math></inline-formula>, referring to the uniform, exponential, truncated normal and constant distributions, respectively. We use the term constant distribution as a shorthand for a single-element discrete uniform distribution. All the fitness distributions are set to a mean around <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> s.t.,
</p>
      <disp-formula id="E8">
        <label>(8)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>F</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>m</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi mathvariant="script" class="calligraphy">U</mml:mi>
                        <mml:mo>{</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>fit</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>fit</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>}</mml:mo>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo> </mml:mo>
                        <mml:mtext>if dist</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mtext>const</mml:mtext>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="script" class="calligraphy">U</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mn>0</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mn>2</mml:mn>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>θ</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>fit</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo> </mml:mo>
                        <mml:mtext>if dist</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mtext>uni</mml:mtext>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo> </mml:mo>
                        <mml:mtext>Exp</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>fit</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo> </mml:mo>
                        <mml:mtext>if dist</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mtext>exp</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="script" class="calligraphy">N</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mn>0</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mo>∞</mml:mo>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>fit</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>θ</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>fit</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo> </mml:mo>
                        <mml:mtext>if dist</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mtext>norm</mml:mtext>
                        <mml:mo>.</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Here, <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents the truncated normal distribution with a lower bound at 0 for which we chose a standard deviation of <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>, in line with <xref rid="btad102-B4" ref-type="bibr">Bozic <italic toggle="yes">et al.</italic> (2010)</xref>. Note that for the truncated normal distribution, a lower bound of 0 and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mo>μ</mml:mo><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> leads to an expected value of <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.027</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The exact shapes of the individual distributions are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>.</p>
      <p>To obtain the final fitness of the clone, we sum the effects of the individual mutations (in line with <xref rid="btad102-B10" ref-type="bibr">Fu <italic toggle="yes">et al.</italic>, 2022</xref>), using the function:
</p>
      <disp-formula id="E9">
        <label>(9)</label>
        <mml:math id="M9" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="bold">f</mml:mi>
            <mml:mi mathvariant="bold">i</mml:mi>
            <mml:mi mathvariant="bold">t</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
            <mml:mi>F</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>m</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>In addition to the above, our model also supports multiple variants of the fitness accumulation, detailed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>.</p>
    </sec>
    <sec>
      <title>2.5 Global confinement</title>
      <p>We now introduce quasi-spatial constraints into our model of a well-mixed population of cells. Driver mutations inevitably lead to exponential growth in the absence of limiting factors, which might include blood and nutrient supply or spatial constraints. We represent these constraints in an abstract manner using the <italic toggle="yes">confinement</italic> parameter <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. This global confinement acts in two ways. First, it limits the number of cells that can divide based on the size of the tumour. Second, it prevents some cells from disappearing after cell death, instead turning them into necrotic cells which continue to contribute to the overall size of the tumour.</p>
      <p>To formulate global confinement, we create a geometrical representation of the tumour as a sphere (<xref rid="btad102-F1" ref-type="fig">Fig. 1a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). We fix the spatial scale of our model such that each individual cell has unit volume and the volume of the whole tumour at the time <italic toggle="yes">t</italic> is equal to the number of its alive and necrotic cells <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. The tumour is thus divided into two regions, a proliferating <italic toggle="yes">shell</italic> and a quiescent <italic toggle="yes">core</italic>. Cells in the shell can divide and get removed when they die. Conversely, cells in the core cannot divide due to lack of space or resources, and turn into necrotic cells upon death. We denote <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mtext>shell-V</mml:mtext></mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> the volume of the shell and <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mtext>core-r</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> the radius of the core for the population contained in <italic toggle="yes">C<sup>t</sup></italic>. Under the assumption of a perfect sphere, we can compute the fraction <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">frac</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the tumour volume occupied by the shell, relative to the shell volume <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mtext>shell-V</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> and the radius of the core <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mtext>core-r</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> as follows:
</p>
      <disp-formula id="E10">
        <label>(10)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mi mathvariant="bold">frac</mml:mi>
          <mml:mo mathvariant="bold">(</mml:mo>
          <mml:msup>
            <mml:mi mathvariant="italic">C</mml:mi>
            <mml:mi mathvariant="italic">t</mml:mi>
          </mml:msup>
          <mml:mo>)</mml:mo>
          <mml:mo>=</mml:mo>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mtext>if</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:msubsup>
                    <mml:mi mathvariant="italic">C</mml:mi>
                    <mml:mi mathvariant="italic">a</mml:mi>
                    <mml:mi mathvariant="italic">t</mml:mi>
                  </mml:msubsup>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mtext>else</mml:mtext>
                  <mml:mo>,</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mtext>if</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:msub>
                    <mml:mo>θ</mml:mo>
                    <mml:mtext>conf</mml:mtext>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>max</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mtext>shell-V</mml:mtext>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mi mathvariant="italic">C</mml:mi>
                          <mml:mi mathvariant="italic">t</mml:mi>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msubsup>
                        <mml:mi mathvariant="italic">C</mml:mi>
                        <mml:mi mathvariant="italic">a</mml:mi>
                        <mml:mi mathvariant="italic">t</mml:mi>
                      </mml:msubsup>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mtext>else</mml:mtext>
                  <mml:mo>,</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mtext>where:</mml:mtext>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E11">
        <label>(11)</label>
        <mml:math id="M11" display="block" overflow="scroll">
          <mml:mstyle displaystyle="false">
            <mml:mtext>shell-V</mml:mtext>
          </mml:mstyle>
          <mml:mo>(</mml:mo>
          <mml:msup>
            <mml:mi>C</mml:mi>
            <mml:mi>t</mml:mi>
          </mml:msup>
          <mml:mo>)</mml:mo>
          <mml:mo>=</mml:mo>
          <mml:msubsup>
            <mml:mi>C</mml:mi>
            <mml:mi>a</mml:mi>
            <mml:mi>t</mml:mi>
          </mml:msubsup>
          <mml:mo>+</mml:mo>
          <mml:msubsup>
            <mml:mi>C</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>t</mml:mi>
          </mml:msubsup>
          <mml:mo>−</mml:mo>
          <mml:mfrac>
            <mml:mn>4</mml:mn>
            <mml:mo>3</mml:mo>
          </mml:mfrac>
          <mml:mo>π</mml:mo>
          <mml:msup>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mstyle displaystyle="false">
                  <mml:mtext>core</mml:mtext>
                </mml:mstyle>
                <mml:mstyle displaystyle="false">
                  <mml:mtext>-r(</mml:mtext>
                </mml:mstyle>
                <mml:mo>(</mml:mo>
                <mml:msup>
                  <mml:mi>C</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:msup>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mn>3</mml:mn>
          </mml:msup>
        </mml:math>
      </disp-formula>
      <disp-formula id="E12">
        <label>(12)</label>
        <mml:math id="M12" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtext>core-r</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:msup>
              <mml:mi>C</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>max</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mfrac>
                    <mml:mn>3</mml:mn>
                    <mml:mo>4</mml:mo>
                  </mml:mfrac>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>C</mml:mi>
                        <mml:mi>a</mml:mi>
                        <mml:mi>t</mml:mi>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mi>C</mml:mi>
                        <mml:mi>n</mml:mi>
                        <mml:mi>t</mml:mi>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo>π</mml:mo>
                  </mml:mfrac>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mo>3</mml:mo>
                </mml:mfrac>
              </mml:msup>
              <mml:mo>−</mml:mo>
              <mml:msubsup>
                <mml:mo>θ</mml:mo>
                <mml:mtext>conf</mml:mtext>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:mn>0</mml:mn>
              <mml:mo>)</mml:mo>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Note that the width of the shell is given by <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, meaning that lower confinement values lead to a larger shell and subsequently a larger proportion of proliferating cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6b</xref>). In particular, for <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the volume of the shell of a sphere approximates the surface area of that sphere, while for <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> the whole sphere is considered the shell, irrespective of its size. We then obtain the confined model:
</p>
      <disp-formula id="E13">
        <label>(13)</label>
        <mml:math id="M13" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>birth</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>min</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="bold">f</mml:mi>
                <mml:mi mathvariant="bold">i</mml:mi>
                <mml:mi mathvariant="bold">t</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>·</mml:mo>
                <mml:mi mathvariant="bold">frac</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:msup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>·</mml:mo>
                <mml:mtext>step</mml:mtext>
                <mml:mo>_</mml:mo>
                <mml:mtext>size</mml:mtext>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E14">
        <label>(14)</label>
        <mml:math id="M14" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>necro</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mi mathvariant="bold">frac</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E15">
        <label>(15)</label>
        <mml:math id="M15" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>n</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mtext>Bin</mml:mtext>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:msup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>necro</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:msup>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E16">
        <label>(16)</label>
        <mml:math id="M16" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>n</mml:mi>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>=</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>n</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:msubsup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mi>n</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The shell fraction <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">frac</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="E10" ref-type="disp-formula">Equation 10</xref>) limits the number of new cells (<xref rid="E13" ref-type="disp-formula">Equation 13</xref>) by limiting the birth probability. The death probability is not affected by the shell fraction; however, it does separate necrotic and removed cells. Note that the total number of necrotic cells is conditional on step_size through <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as given in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>.</p>
    </sec>
    <sec>
      <title>2.6 Local confinement</title>
      <p>Global confinement as defined above represents a competition of the whole cell population for shared resources. Additionally, in some tumours, local space or resource restrictions might apply, as for example in the case of breast cancer arising from the mammary glands, where smaller localized tumour cell populations press against the glandular epithelium (<xref rid="btad102-B17" ref-type="bibr">Lomakin <italic toggle="yes">et al.</italic>, 2022</xref>).</p>
      <p>We represent these local spatial constraints in our framework by adding a second (local) confinement term for each clone individually. When applied without global confinement, it limits each clone by its own population size (<xref rid="btad102-F1" ref-type="fig">Fig. 1b</xref>). When combined, the global confinement is modulated by the size of the clone (<xref rid="btad102-F1" ref-type="fig">Fig. 1c</xref>).</p>
      <p>To compute this effect, we introduce an additional function <italic toggle="yes">local</italic> that is equal to the function <italic toggle="yes">frac</italic> (<xref rid="E10" ref-type="disp-formula">Equation 10</xref>) where the parameter <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is used in place of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which further limits the birth probability of each clone <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> such that:
where <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mi mathvariant="bold">f</mml:mi></mml:mrow></mml:math></inline-formula> denotes substituting the parameter <italic toggle="yes">x</italic> in function <bold>f</bold> for <italic toggle="yes">y</italic>.</p>
      <disp-formula id="E17">
        <label>(17)</label>
        <mml:math id="M17" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="bold">local</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mo stretchy="false">[</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>θ</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>conf</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>θ</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>local</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">]</mml:mo>
            <mml:mi mathvariant="bold">frac</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E18">
        <label>(18)</label>
        <mml:math id="M18" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>p</mml:mi>
            <mml:mtext>birth</mml:mtext>
          </mml:msub>
          <mml:mo>(</mml:mo>
          <mml:msup>
            <mml:mi>c</mml:mi>
            <mml:mi>t</mml:mi>
          </mml:msup>
          <mml:mo>)</mml:mo>
          <mml:mo>=</mml:mo>
          <mml:mi>min</mml:mi>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold">f</mml:mi>
              <mml:mi mathvariant="bold">i</mml:mi>
              <mml:mi mathvariant="bold">t</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:msup>
                <mml:mi>c</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:msup>
              <mml:mo>)</mml:mo>
              <mml:mo>·</mml:mo>
              <mml:mi mathvariant="bold">frac</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:msup>
                <mml:mi>C</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:msup>
              <mml:mo>)</mml:mo>
              <mml:mo>·</mml:mo>
              <mml:mi mathvariant="bold">local</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:msup>
                <mml:mi>c</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:msup>
              <mml:mo>)</mml:mo>
              <mml:mo>·</mml:mo>
              <mml:mtext>step</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:mtext>size</mml:mtext>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="E19">
        <label>(19)</label>
        <mml:math id="M19" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>necro</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mi mathvariant="bold">frac</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>·</mml:mo>
            <mml:mi mathvariant="bold">local</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Observe that if we set <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the model is equal to the one in Section 2.5, with <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to Section 2.4, with <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to Section 2.3 and with <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>mut</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to Section 2.2.</p>
    </sec>
    <sec>
      <title>2.7 Model configuration</title>
      <p>We aim to simulate realistically sized tumours with <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>9</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> cells, corresponding to a tumour of <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mtext>cm</mml:mtext></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> in size (<xref rid="btad102-B7" ref-type="bibr">Del Monte, 2009</xref>). We set the minimum population size min_pop for a simulation to be considered to 1000 cells. <inline-formula id="IE9004"><mml:math id="IM9004" display="inline" overflow="scroll"><mml:mtext>max_pop</mml:mtext></mml:math></inline-formula> is then derived from min_pop as <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mn>1000</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>9</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, hence population doubling occurs 20 times starting from min_pop. To calibrate cell turnover <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mtext>step</mml:mtext><mml:mo>_</mml:mo><mml:mtext>size</mml:mtext></mml:mrow></mml:math></inline-formula>, we used the homeostatic model (Section 2.2) for a starting population size of 100 cells and evaluated <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mtext>step_size</mml:mtext><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.005</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>. We found that for <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mtext>step_size</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula> there was no extinction event within <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mtext>max_steps</mml:mtext><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:math></inline-formula> for any of the 1000 replicates considered, and we thus selected 0.01 as a turnover value for all further simulations. We fixed the limiting variable for the maximum number of generations <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mtext>max_steps</mml:mtext></mml:math></inline-formula> to 10<sup>6</sup>, such that without a mutation the initial cell divides on average <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mn>0.01</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> times. Assuming a typical division cycle of 24 h, this parametrization would correspond to <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>27</mml:mn></mml:mrow></mml:math></inline-formula> years of real time. In all subsequent simulations, the execution reached the maximum population size before reaching the maximum number of generations.</p>
      <p>As we are mainly interested in the effect of confinement, unless stated otherwise we fix the mutation probability and mean fitness gain of a single driver at <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>mut</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> in line with the literature (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic>, 2021</xref>). We additionally set <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mtext>dist</mml:mtext><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> as in <xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic> (2022)</xref>.</p>
      <p>For the robustness analysis in Sections 3.1and 3.2, we later perturbed these two parameters, testing <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>fit</mml:mtext></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.15</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>mut</mml:mtext></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.8 Population metrics</title>
      <p>To evaluate the individual simulation runs and to compare their clonal behaviour to prior work as well as experimental data, we use two previously introduced metrics: the <italic toggle="yes">mean number of drivers per cell</italic> and the <italic toggle="yes">clonal diversity index</italic> (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>). To speed up computation of summary statistics, we only consider clones larger than a minimum fraction <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mtext>cutoff</mml:mtext></mml:mrow></mml:math></inline-formula> of the population (<inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:msup><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>·</mml:mo><mml:mo> </mml:mo><mml:mtext>cutoff</mml:mtext><mml:mo>}</mml:mo></mml:math></inline-formula>) and only calculate the metrics at every time step at which the population of alive cells doubles. The Fish plots (e.g. <xref rid="btad102-F2" ref-type="fig">Fig. 2a–d</xref>) are not affected by the cutoff, but only display clones that reached at least 1% of the population at some point.</p>
      <p>The <italic toggle="yes">mean number of drivers per cell</italic> <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> tracks the mutational burden of the growing tumour and is defined as
</p>
      <disp-formula id="E20">
        <label>(20)</label>
        <mml:math id="M20" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:mover accent="true">
                <mml:mi>d</mml:mi>
                <mml:mo>¯</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>C</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:msup>
                <mml:mo>∈</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>C</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:msup>
              </mml:mrow>
            </mml:munder>
            <mml:mrow>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo>|</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:msubsup>
              <mml:mo>|</mml:mo>
              <mml:mo>·</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:msubsup>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>·</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi>C</mml:mi>
                          <mml:mo>˜</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mi>a</mml:mi>
                    <mml:mi>t</mml:mi>
                  </mml:msubsup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The <italic toggle="yes">clonal diversity index D</italic> reflects the total number of equally sized clones and their size and is based on the inverse Simpson index defined as expected:
</p>
      <disp-formula id="E21">
        <label>(21)</label>
        <mml:math id="M21" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>D</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>C</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>t</mml:mi>
            </mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                            </mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:msup>
                          <mml:mo>∈</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>C</mml:mi>
                                  <mml:mo>˜</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:msup>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>c</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>a</mml:mi>
                                    <mml:mi>t</mml:mi>
                                  </mml:msubsup>
                                  <mml:mo>·</mml:mo>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msubsup>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>C</mml:mi>
                                                <mml:mo>˜</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mi>a</mml:mi>
                                          <mml:mi>t</mml:mi>
                                        </mml:msubsup>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>This measure has been shown to have a lower boundary of 1 and to be robust to the presence or absence of small populations (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>).</p>
    </sec>
    <sec>
      <title>2.9 Comparing with real tumour data</title>
      <p>To compare our simulations to real data, we used six datasets from the following cancer types (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>): acute myeloid leukaemia (AML, single-cell DNA sequencing) (<xref rid="btad102-B21" ref-type="bibr">Morita <italic toggle="yes">et al.</italic>, 2020</xref>), kidney (clear cell renal cell carcinoma, multi-region whole-exome sequencing) (<xref rid="btad102-B30" ref-type="bibr">Turajlic <italic toggle="yes">et al.</italic>, 2018</xref>), mesothelioma (multi-region whole-exome sequencing) (<xref rid="btad102-B36" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2021</xref>), breast (triple-negative breast cancer, single-cell RNA sequencing) (<xref rid="btad102-B20" ref-type="bibr">Minussi <italic toggle="yes">et al.</italic>, 2021</xref>), lung (non-small cell lung cancer, multi-region whole-exome sequencing) (<xref rid="btad102-B13" ref-type="bibr">Jamal-Hanjani <italic toggle="yes">et al.</italic>, 2017</xref>), and uveal (uveal melanoma, single-cell RNA sequencing) (<xref rid="btad102-B8" ref-type="bibr">Durante <italic toggle="yes">et al.</italic>, 2020</xref>). One additional dataset of whole-genome sequenced breast cancer was discarded since it only had three samples available.</p>
      <p>To fit our simulations to the data, we considered all combinations for <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in the range of <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.125</mml:mn><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> each. For every combination, we simulated 100 runs and compared the simulation with the data using a score based on the Iterative Closest Point algorithm. To this end, we calculated the shortest Euclidean distance between the simulated data and the real data in the two-dimensional space defined by the mean number of drivers per cell and the clonal diversity. The final score (<inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula>) is then defined as the mean shortest distance for each simulated point, plus the mean shortest distance for each data point, i.e.
where <italic toggle="yes">X<sub>s</sub></italic> are the clones in a simulation and <italic toggle="yes">X<sub>d</sub></italic> in a real dataset.</p>
      <disp-formula id="E22">
        <label>(22)</label>
        <mml:math id="M22" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="bold">S</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>X</mml:mi>
              </mml:mrow>
              <mml:mi>s</mml:mi>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>X</mml:mi>
              </mml:mrow>
              <mml:mi>d</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:msub>
                <mml:mo>|</mml:mo>
              </mml:mrow>
            </mml:mfrac>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:msub>
                <mml:mo>∈</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:msub>
              </mml:mrow>
            </mml:munder>
            <mml:mi mathvariant="bold">E</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mi>s</mml:mi>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>X</mml:mi>
              </mml:mrow>
              <mml:mi>d</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>+</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msub>
                <mml:mo>|</mml:mo>
              </mml:mrow>
            </mml:mfrac>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msub>
                <mml:mo>∈</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msub>
              </mml:mrow>
            </mml:munder>
            <mml:mi mathvariant="bold">E</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mi>d</mml:mi>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>X</mml:mi>
              </mml:mrow>
              <mml:mi>s</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="E23">
        <label>(23)</label>
        <mml:math id="M23" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="bold">E</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>Y</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>min</mml:mi>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>d</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>d</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>y</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>D</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mi>D</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>y</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:msup>
            <mml:mo>∣</mml:mo>
            <mml:mi>y</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:mi>Y</mml:mi>
            <mml:mo>}</mml:mo>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Additionally, we also analysed the fit of the spatial simulation created by <xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic> (2022)</xref> to the six datasets. To this end, we downloaded all simulation results from <ext-link xlink:href="https://github.com/robjohnnoble/" ext-link-type="uri">https://github.com/robjohnnoble/</ext-link><monospace>ModesOfEvolution</monospace>, which included model parameters as well as the clonal diversity and mean number of drivers per cell for every simulation run. We then calculated a score (<inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula>) for every simulation parametrization and cancer type using <xref rid="E22" ref-type="disp-formula">Equation (22)</xref>. To allow for fair comparisons, we choose the parametrization with the best overlap for every cancer type by varying all model parameters available in the data: spatial constraint, mutation probability, fitness gain per driver and deme size.</p>
    </sec>
    <sec>
      <title>2.10 Smith implementation and performance</title>
      <p>SMITH has been implemented in C# as an open-source package under the MIT license and is available at <ext-link xlink:href="https://bitbucket.org/schwarzlab/smith" ext-link-type="uri">https://bitbucket.org/schwarzlab/smith</ext-link> with pre-compiled binaries for Windows, Linux and MacOS. Version 1.1 is used in this article and the code and data to reproduce the figures can also be found at <ext-link xlink:href="https://doi.org/10.5281/zenodo.6885040" ext-link-type="uri">https://doi.org/10.5281/zenodo.6885040</ext-link>. The Fish (Muller) plots were generated using the accompanying open-source Python library <italic toggle="yes">PyFish</italic>, available at <ext-link xlink:href="https://bitbucket.org/schwarzlab/pyfish" ext-link-type="uri">https://bitbucket.org/schwarzlab/pyfish</ext-link>.</p>
      <p>SMITH performance was evaluated against <italic toggle="yes">tumopp</italic>, a high-performance simulator of on-lattice cancer growth (<xref rid="btad102-B12" ref-type="bibr">Iwasaki and Innan, 2017</xref>). Both SMITH and <italic toggle="yes">tumopp</italic> were parameterized with the same driver mutation rates and effects, and performance was compared on population sizes ranging from 10<sup>4</sup> to 10<sup>9</sup> cells with 10-fold increases. Global confinement was set to 1 to mimic the surface-growth model of <italic toggle="yes">tumopp</italic>. Overall, the SMITH simulation proved to be about 1000-fold faster than <italic toggle="yes">tumopp</italic>. The maximum population <italic toggle="yes">tumopp</italic> was able to simulate with 32 GB of memory was 10<sup>7</sup> cells. Simulation of a tumour population of 10<sup>7</sup> cells took 2341.55 s in <italic toggle="yes">tumopp</italic> compared with 1.32 s in SMITH with confinement and 0.14 s without confinement. For a 1 billion model, the average runtime was 8.95 s without and 256.47 s with global confinement, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). The memory usage was less than 1 GB.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Global and local confinement recreates common modes of cancer evolution</title>
      <p>Recent investigations into common patterns of cancer evolution have revealed several major ‘modes’ of evolution. While non-spatial tumours, including lymphomas and leukaemia, are characterized by few driver events and rapid clonal expansions (<xref rid="btad102-B9" ref-type="bibr">Ferrando and López-Otín, 2017</xref>), in spatially organized solid tumours more diverse evolutionary patterns have been described, including ‘neutral’, ‘linear’ and ‘branched’ evolution (<xref rid="btad102-B31" ref-type="bibr">Vendramin <italic toggle="yes">et al.</italic>, 2021</xref>). We hypothesized that these evolutionary modes are driven by varying local and global constraints acting on these tumours, including available physical space, nutrient availability and blood supply. To test this hypothesis within the scope of our model, we fixed the mutation probability and fitness sampling and accumulation to literature derived default values (Section 2.7) and only varied local and global confinement (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8 and S9</xref>).</p>
      <p>In the absence of confinement, our model is mathematically equivalent to a traditional, non-spatial branching process (Section 2.1). By setting the average fitness increase per mutation to zero, we obtain a fully neutral growth pattern (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). This mode is characterized by variants that can reach fixation purely through genetic drift but rarely observed in real-life tumours (<xref rid="btad102-B28" ref-type="bibr">Sottoriva <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
      <fig position="float" id="btad102-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Different values for global and local confinement recreate the clonal evolution of different tumour types. For every dataset, we show the mean number of drivers per cell and the clonal diversity both for the real tumour samples (black crosses) and the 100 simulations with the global and local confinement combination that best fit the dataset (blue circles)</p>
        </caption>
        <graphic xlink:href="btad102f3" position="float"/>
      </fig>
      <p>With the default fitness increase of 0.1 per driver mutation and in the absence of confinement, SMITH simulations are characterized by a low number of clones that grow exponentially (<xref rid="btad102-F2" ref-type="fig">Fig. 2a</xref>), matching the unconstrained evolution of non-spatial tumours, in particular leukaemia (<xref rid="btad102-B16" ref-type="bibr">Lee and Bozic, 2022</xref>). These simulations are also characterized by low clonal diversity (median of 1.3) and a low mean number of drivers (median of 2.0) as earlier clones dominate the makeup of the tumour. Without spatial restrictions, these simulations reach the final size of 1 billion cells faster than any parametrization considered, in line with observations of exponential growth in leukaemia (<xref rid="btad102-B16" ref-type="bibr">Lee and Bozic, 2022</xref>).</p>
      <p>Intriguingly, adding global confinement to the model triggers development of the typical ‘linear’ or ‘ladder-like’ evolutionary patterns (<xref rid="btad102-B27" ref-type="bibr">Schwarz <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btad102-B31" ref-type="bibr">Vendramin <italic toggle="yes">et al.</italic>, 2021</xref>) characterized by repeated clonal sweeps where individual subclones successively take over the cell population (<xref rid="btad102-F2" ref-type="fig">Fig. 2b</xref>). Global confinement here simulates a global competition for space and resources which slows the growth of existing clones and favours well-adapted clones with higher fitness, creating a tumour with a high number of driver events. Consequently, we observe consistent accumulation of driver mutations (median of 5.7) at the expense of diversity (median of 1.9).</p>
      <p>In contrast, adding only local confinement to the model leads to rapid and parallel clonal expansions and a corresponding high clonal diversity (median of 112, <xref rid="btad102-F2" ref-type="fig">Fig. 2c</xref>). Local confinement thereby constricts the growth of each clone individually, as might, for example, be caused by local tissue structures such as glands (Section 2.6). Consequently, many subbranches co-exist in the phylogeny of these tumours and clones expand simultaneously creating a very diverse tumour with a highly ‘branched’ phylogeny. Arguably, local confinement alone is unlikely to exist in real-world tumours, as it omits the global limiting factor of shared resources.</p>
      <p>More realistically, real-world tumours will likely be constrained by both global and local growth restrictions and show patterns somewhere in between the linear and branched evolutionary modes. Notably, recent research has identified widespread transitions in tumours wherein mutations first occur successively in the early stage of tumour evolution. This is followed by branching of the evolutionary trees in the latter stage (<xref rid="btad102-B1" ref-type="bibr">Baslan <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btad102-B17" ref-type="bibr">Lomakin <italic toggle="yes">et al.</italic>, 2022</xref>). In our model, when global confinement is larger than local confinement (<inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), we also find a mixture of the linear and branched modes which we refer to as ‘linear-to-branched evolution’ (<xref rid="btad102-F2" ref-type="fig">Fig. 2d</xref>). These simulations evolve in two distinct phases. In the beginning, clones are small and global confinement typically leads to several early clonal sweeps. As the population grows, local confinement begins to exhibit a greater influence, disproportionately slowing the growth of larger clones and causing smaller clones to appear—a fully branched tumour emerges. The linear-to-branched mode of evolution shows both signs of rapid emergence of new clones (median of 8.2 mean number of drivers) and high clonal diversity (median of 12.6) reminiscent of real, spatially organized tumours (see below).</p>
      <p>The observed results were robust with regard to changes to the mutation probability (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>) and the fitness advantage gained by a single driver (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>). This robustness was to be expected as it was also observed in other simulation frameworks (<xref rid="btad102-B10" ref-type="bibr">Fu <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
      <p>In summary, varying local and global confinement allows us to recreate the evolutionary patterns observed in non-spatial and spatially organized tumours. Global and local confinement thereby directly affects the mean number of drivers and the extent of clonal diversity (for detailed analysis, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Confinement models recapitulate the clonal evolution of real-life tumours</title>
      <p>Next, we evaluated the ability of our model to fit real data from six different cancer types (AML, lung, kidney, uveal, mesothelioma and breast; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>) derived by <xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic> (2022)</xref> (Section 2.9). To this end, we varied the global and local confinement, each in the range of <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.125</mml:mn><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, with the model setup as given in Section 2.7. For each parameter combination, we created 100 simulations and found the optimal confinement values per dataset by minimizing the score function (<xref rid="E22" ref-type="disp-formula">Equation 22</xref>), which takes into account the mean number of drivers per cell and the clonal diversity (Section 2.9). For visualization of the optimal confinement values, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>.</p>
      <p>In AML, as expected, the optimal fit was achieved by setting both global and local confinement to zero, corresponding to a traditional non-spatial simulation (<xref rid="btad102-F3" ref-type="fig">Fig. 3a</xref>), appropriate for non-spatially organized cancers (<xref rid="btad102-B16" ref-type="bibr">Lee and Bozic, 2022</xref>).</p>
      <p>Most other spatially organized tumour types (kidney, mesothelioma, breast and lung) are characterized by a moderate number of drivers per cell (median of 4.9 for breast, 5.3 for kidney, 5.8 for mesothelioma and 6.0 for lung) and hence were fit best by a global confinement value of 0.5 (<xref rid="btad102-F3" ref-type="fig">Fig. 3b–e</xref>).</p>
      <p>Additionally, tumours of the kidney and mesothelioma datasets had a comparatively low median clonal diversity (2.9 and 4.1, respectively) resulting in a best fit in the absence of local confinement (<xref rid="btad102-F3" ref-type="fig">Fig. 3b, c</xref>) and leading to ‘linear’ evolutionary patterns marked by repeated clonal sweeps (see <xref rid="btad102-F2" ref-type="fig">Fig. 2c</xref>). In fact, two out of the five samples in the kidney dataset and one sample in the mesothelioma dataset are currently mid-sweep as demonstrated by a clonal diversity of <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>In contrast, the samples from the lung and breast cohorts were best fit with local confinement of <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.125</mml:mn></mml:mrow></mml:math></inline-formula> (<xref rid="btad102-F3" ref-type="fig">Fig. 3d, e</xref>) to account for their relatively high median clonal diversity of 8.1 and 8.0, respectively. The comparatively high local confinement in these tumours might correspond to localized growth into separate mammary glands for breast cancer and alveoli for lung cancer. With the combination of global and local confinement, these samples are best described with the linear-to-branched clonal evolution produced within our model (<xref rid="btad102-F2" ref-type="fig">Fig. 2d</xref>).</p>
      <p>Finally, the samples in the uveal cancer dataset have a comparatively high number of drivers (median of 11.2) which is recapitulated in our model through the highest global confinement value of 2, corresponding to half of the cells in the outer layer dividing, in combination with local confinement of 0.125 (<xref rid="btad102-F3" ref-type="fig">Fig. 3f</xref>). Interestingly, uveal melanomas indeed show unique physiological characteristics in that they are slowly growing and heavily restricted to the eye (<xref rid="btad102-B14" ref-type="bibr">Kaliki and Shields, 2017</xref>).</p>
      <p>Furthermore, we evaluated the robustness of our estimates and found that the scores for each dataset were robust to variations in fitness mean and mutation probability (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>) as described in Section 3.1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10 and S11</xref>).</p>
      <p>Next, we compared our best fits to the ones obtained from the explicitly spatial model of (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>) using the same score function (<xref rid="E22" ref-type="disp-formula">Equation 22</xref>) as above (Section 2.9). As expected, for the AML data, SMITH and the <italic toggle="yes">Noble</italic> model provided similarly good fits (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S15</xref>), owing to the fact that in the absence of confinement and spatial organization both models describe a non-spatial branching process. For the spatially organized cancer types, our model outperforms the Noble <italic toggle="yes">et al.</italic> model for all cancer types (kidney, lung, uveal and mesothelioma) with the exception of breast cancer, for which both models generate a similarly good fit (with 1.67 and 1.86, respectively, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S15</xref>).</p>
      <p>Interestingly, in the kidney cancer dataset, two out of the five samples are currently mid-clonal sweep, which is marked by a clonal diversity of <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>. Due to the spatial arrangement of the Noble <italic toggle="yes">et al.</italic> simulation, clonal sweeps are extremely rare to occur (less than 2% of the 2.700 simulations of the invasive glandular mode have clonal diversity <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>), whereas they frequently occur in our simulation framework (39% for <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>local</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>3.3 Population size affects the evolutionary dynamics of tumours</title>
      <p>Due to computational limitations, current explicit spatial models do not exceed 10<sup>7</sup> individual simulation voxels: 10<sup>6</sup> for <xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic> (2022)</xref> and <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> for <xref rid="btad102-B10" ref-type="bibr">Fu <italic toggle="yes">et al.</italic> (2022)</xref>, <xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic> (2021)</xref> and <xref rid="btad102-B28" ref-type="bibr">Sottoriva <italic toggle="yes">et al.</italic> (2015)</xref>. In some of these models, larger population sizes can be reached only by making each voxel represent a clone of a fixed size (e.g. 10<sup>4</sup> cells per gland in Sottoriva <italic toggle="yes">et al.</italic>). By replacing explicit spatial representations with the confinement mechanics, we can simulate populations beyond 1 billion cells, corresponding to tumour sizes commonly encountered in the clinic at initial diagnosis (<xref rid="btad102-B7" ref-type="bibr">Del Monte, 2009</xref>; <xref rid="btad102-B34" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2016</xref>). Leveraging the efficiency of SMITH, we investigated the advantages of simulating large populations and assessed how ITH changes over time in the course of repeated simulations.</p>
      <p>We observed that for all scenarios that include global or local confinement the mean number of drivers grows logarithmically with the population size (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S16</xref>), demonstrating that newly appearing clones eventually overtake the population. This logarithmic increase is of particular interest for the uveal cancer dataset which contains up to 14 mean drivers per cell, which would be difficult to reach in populations as small as 10<sup>6</sup> cells.</p>
      <p>In the absence of confinement (i.e. non-spatial), tumours develop mostly one clearly dominant clone with only a few competitors. Clonal diversity therefore barely reaches a score of 2 for the final size of 10<sup>9</sup> cells. If only global confinement is applied, clonal diversity plateaus after an initial surge at around 10<sup>6</sup> cells, after which clonal sweeps increase in frequency and repeatedly reduce the clonal diversity to 1. Conversely, with only local confinement active, clonal diversity continuously rises until the end of the simulation, since the growth rate of larger clones is dampened relative to smaller clones. When both local and global confinements are employed, we first see clonal sweeps until about 10<sup>7</sup> cells (corresponding to <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> cells in diameter for a solid tumour), after which we increasingly observe a branching behaviour and diversification of the tumour. Interestingly, this transition from a ‘linear’ progression to a branching in the phylogeny would be missed in simulations smaller than 10<sup>7</sup> cells.</p>
      <p>Furthermore, when investigating individual trajectories in the presence of global confinement, we observe extensive heterogeneity in their behaviour, governed by alternating periods of clonal sweeps and diversification (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S17</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The effects of spatial restrictions have long been observed in explicit spatial models, in particular in <xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic> (2021)</xref>, where the authors investigated both local and global growth limitations. Additionally, other authors postulated that it is indeed the explicit spatial representation from which ITH emerges (<xref rid="btad102-B10" ref-type="bibr">Fu <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>).</p>
    <p>Here, we have presented SMITH, a new simulation model for cancer evolution based on confinement, which limits population growth globally and locally in a non-linear way. By combining different values for global and local confinement, SMITH is able to reproduce commonly observed modes of cancer evolution including non-spatial, neutral, linear, branched as well as linear-to-branched evolution. Adjusting global and local confinement thereby directly affects the mean number of drivers per cell and the clonal diversity of a tumour, respectively. Additionally, we have demonstrated that specific combinations of global and local confinement can recreate the behaviour of real-life tumours. However, the available data are limited in size and additional data are needed to ascertain whether this observation generalizes to other cancer entities.</p>
    <p>Other extensions to branching processes have been proposed, including a logistic-growth model which focuses on modelling specific hallmarks of cancer (<xref rid="btad102-B22" ref-type="bibr">Nagornov and Kato, 2020</xref>). Others provided spherical interpretations of tumours in mathematical models of tumour growth (<xref rid="btad102-B6" ref-type="bibr">Dassios <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btad102-B24" ref-type="bibr">Paterson <italic toggle="yes">et al.</italic>, 2016</xref>). In implementing our confinement mechanism, we worked under the assumption of a spherical tumour, which gives rise to the <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> power law (Section 2.5). While this might not be suitable for all kinds of tumours, it should be noted that more general formulations of the confinement mechanism could easily be derived, as long as the growth rate scales non-linearly with the population size (see also <xref rid="btad102-B29" ref-type="bibr">Talkington and Durrett, 2015</xref>).</p>
    <p>One decisive advantage of our model is its speed advantage over explicit spatial models, which are commonly run on high-performance computers in parallel with cell populations limited to <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (<xref rid="btad102-B26" ref-type="bibr">Rosenbauer <italic toggle="yes">et al.</italic>, 2020</xref>). In contrast, SMITH performs a single simulation up to 10<sup>9</sup> cells in minutes on a desktop computer, which allows for the analysis of the variability of evolutionary trajectories under a variety of different parametrizations.</p>
    <p>Besides confinement, fitness mean and mutation rate, other modelling choices might influence the outcome of simulations, most prominently the choice of the fitness distribution. Other authors have proposed the use of a constant (<xref rid="btad102-B35" ref-type="bibr">West <italic toggle="yes">et al.</italic>, 2021</xref>), uniform (<xref rid="btad102-B10" ref-type="bibr">Fu <italic toggle="yes">et al.</italic>, 2022</xref>), normal (<xref rid="btad102-B28" ref-type="bibr">Sottoriva <italic toggle="yes">et al.</italic>, 2015</xref>) and exponential (<xref rid="btad102-B23" ref-type="bibr">Noble <italic toggle="yes">et al.</italic>, 2022</xref>) distribution from which to draw fitness values (Section 2.4). We systematically explored the effect of the choice of fitness distribution on the simulation results of SMITH (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S18</xref>). In the absence of confinement, corresponding to non-spatial evolution, the number of drivers and clonal diversity were largely unaffected, with the exception of the constant distribution (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S18</xref>) and in line with previous findings (<xref rid="btad102-B19" ref-type="bibr">McFarland <italic toggle="yes">et al.</italic>, 2013</xref>). In contrast, the choice of fitness distribution did influence the number of mean drivers per cell and the clonal diversity in the presence of spatial constraints but without fundamentally changing the effect of local and global confinement on the simulation outcomes. Further investigations into these and other commonly made modelling choices are warranted to improve comparability between models and parameters in the future. SMITH, with its fast computation, simplicity and the ability to capture different data types and evolutionary modes are well poised to serve as a testbed for such analyses in the future.</p>
    <p>In this work, we have developed a minimal model of tumour evolution centred around the concepts of global and local spatial restrictions. By linking our model to established modes of tumour evolution as well as real-life tumours, we propose local and global confinement as a major determinant of ITH and the clonal evolution of tumours.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad102_Supplementary_Data</label>
      <media xlink:href="btad102_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Klaus-Robert Müller for support, Jakub Slavík for mathematical consultations and Daniel Schütte for medical expertise. Computation has been performed on the HPC for Research cluster of the Berlin Institute of Health. They would also like to thank the Helmholtz Association (Germany) for support.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>A.S. and T.L.K. conceptualized the method and implemented the model. A.S., T.L.K. and R.F.S. designed the model and wrote the manuscript. R.F.S. supervised the project.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially funded by the German Ministry for Education and Research as BIFOLD—Berlin Institute for the Foundations of Learning and Data [Refs 01IS18025A and 01IS18037A]. R.F.S. is a Professor at the Cancer Research Center Cologne Essen (CCCE) funded by the Ministry of Culture and Science of the State of North Rhine-Westphalia.</p>
    <p><italic toggle="yes">Conflict of Interest:</italic> none declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad102-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baslan</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Ordered and deterministic cancer genome evolution after p53 loss</article-title>. <source>Nature</source>, <volume>608</volume>, <fpage>795</fpage>–<lpage>802</lpage>.<pub-id pub-id-type="pmid">35978189</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beerenwinkel</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Cancer evolution: mathematical models and computational inference</article-title>. <source>Syst. Biol</source>., <volume>64</volume>, <fpage>e1</fpage>–<lpage>e25</lpage>.<pub-id pub-id-type="pmid">25293804</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Black</surname><given-names>J.R.M.</given-names></string-name>, <string-name><surname>McGranahan</surname><given-names>N.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Genetic and non-genetic clonal diversity in cancer evolution</article-title>. <source>Nat. Rev. Cancer</source>, <volume>21</volume>, <fpage>379</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">33727690</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bozic</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Accumulation of driver and passenger mutations during tumor progression</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>18545</fpage>–<lpage>18550</lpage>.<pub-id pub-id-type="pmid">20876136</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chkhaidze</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Spatially constrained tumour growth affects the patterns of clonal selection and neutral drift in cancer genomic data</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007243</fpage>.<pub-id pub-id-type="pmid">31356595</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dassios</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Mathematical modelling of avascular ellipsoidal tumour growth</article-title>. <source>Quart. Appl. Math</source>., <volume>70</volume>, <fpage>1</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="btad102-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Del Monte</surname><given-names>U.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Does the cell number 109 still really fit one gram of tumor tissue?</article-title><source>Cell Cycle</source>, <volume>8</volume>, <fpage>505</fpage>–<lpage>506</lpage>.<pub-id pub-id-type="pmid">19176997</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durante</surname><given-names>M.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell analysis reveals new evolutionary complexity in uveal melanoma</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>496</fpage>.<pub-id pub-id-type="pmid">31980621</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferrando</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>López-Otín</surname><given-names>C.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Clonal evolution in leukemia</article-title>. <source>Nat. Med</source>., <volume>23</volume>, <fpage>1135</fpage>–<lpage>1145</lpage>.<pub-id pub-id-type="pmid">28985206</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal>; on behalf of the TRACERx Renal Consortium. (<year>2022</year>) <article-title>Spatial patterns of tumour growth impact clonal diversification in a computational model and the TRACERx renal study</article-title>. <source>Nat. Ecol. Evol</source>., <volume>6</volume>, <fpage>88</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">34949820</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Haccou</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2005</year>) <source>Branching Processes: Variation, Growth, and Extinction of Populations</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btad102-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iwasaki</surname><given-names>W.M.</given-names></string-name>, <string-name><surname>Innan</surname><given-names>H.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Simulation framework for generating intratumor heterogeneity patterns in a cancer cell population</article-title>. <source>PLoS ONE</source>, <volume>12</volume>, <fpage>e0184229</fpage>.<pub-id pub-id-type="pmid">28877206</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jamal-Hanjani</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Tracking the evolution of non-small-cell lung cancer</article-title>. <source>N. Engl. J. Med</source>., <volume>376</volume>, <fpage>2109</fpage>–<lpage>2121</lpage>.<pub-id pub-id-type="pmid">28445112</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaliki</surname><given-names>S.</given-names></string-name>, <string-name><surname>Shields</surname><given-names>C.L.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Uveal melanoma: Relatively rare but deadly cancer</article-title>. <source>Eye</source>, <volume>31</volume>, <fpage>241</fpage>–<lpage>257</lpage>.<pub-id pub-id-type="pmid">27911450</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimura</surname><given-names>M.</given-names></string-name></person-group> (<year>1969</year>) <article-title>The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutations</article-title>. <source>Genetics</source>, <volume>61</volume>, <fpage>893</fpage>–<lpage>903</lpage>.<pub-id pub-id-type="pmid">5364968</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Bozic</surname><given-names>I.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Inferring parameters of cancer evolution in chronic lymphocytic leukemia</article-title>. <source>PLoS Comput. Biol</source>., <volume>18</volume>, <fpage>e1010677</fpage>.<pub-id pub-id-type="pmid">36331987</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lomakin</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Spatial genomics maps the structure, nature and evolution of cancer clones</article-title>. <source>Nature</source>, <volume>611</volume>, <fpage>594</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">36352222</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marusyk</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Intratumor heterogeneity: The Rosetta stone of therapy resistance</article-title>. <source>Cancer Cell</source>, <volume>37</volume>, <fpage>471</fpage>–<lpage>484</lpage>.<pub-id pub-id-type="pmid">32289271</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McFarland</surname><given-names>Ch.D.</given-names></string-name></person-group><etal>et al</etal> (2013) <article-title>Impact of deleterious passenger mutations on cancer progression.</article-title><source>Proc. Nat. Acad. Sci.</source><volume>110</volume>(8), <fpage>2910</fpage>–<lpage>2915</lpage>.<pub-id pub-id-type="pmid">23388632</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minussi</surname><given-names>D.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Breast tumors maintain a reservoir of subclonal diversity during expansion</article-title>. <source>Nature</source>, <volume>592</volume>, <fpage>302</fpage>–<lpage>308</lpage>.<pub-id pub-id-type="pmid">33762732</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Clonal evolution of acute myeloid leukemia revealed by high-throughput single-cell genomics</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>5327</fpage>.<pub-id pub-id-type="pmid">33087716</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nagornov</surname><given-names>I.S.</given-names></string-name>, <string-name><surname>Kato</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) <article-title>tugHall: A simulator of cancer-cell evolution based on the hallmarks of cancer and tumor-related genes</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3597</fpage>–<lpage>3599</lpage>.<pub-id pub-id-type="pmid">32170925</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noble</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Spatial structure governs the mode of tumour evolution</article-title>. <source>Nat. Ecol. Evol</source>., <volume>6</volume>, <fpage>207</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">34949822</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paterson</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>An exactly solvable, spatial model of mutation accumulation in cancer</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>39511</fpage>.<pub-id pub-id-type="pmid">28004754</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Roch</surname><given-names>S.</given-names></string-name></person-group> (<year>2015</year>) Modern discrete probability: An essential toolkit. University Lecture.</mixed-citation>
    </ref>
    <ref id="btad102-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rosenbauer</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) Emerging tumor development by simulating single-cell events. <italic toggle="yes">Technical report</italic>, bioRxiv.</mixed-citation>
    </ref>
    <ref id="btad102-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwarz</surname><given-names>R.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Spatial and temporal heterogeneity in high-grade serous ovarian cancer: A phylogenetic analysis</article-title>. <source>PLoS Med</source>., <volume>12</volume>, <fpage>e1001789</fpage>.<pub-id pub-id-type="pmid">25710373</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sottoriva</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>A big bang model of human colorectal tumor growth</article-title>. <source>Nat. Genet</source>., <volume>47</volume>, <fpage>209</fpage>–<lpage>216</lpage>.<pub-id pub-id-type="pmid">25665006</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Talkington</surname><given-names>A.</given-names></string-name>, <string-name><surname>Durrett</surname><given-names>R.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Estimating tumor growth rates in vivo</article-title>. <source>Bull. Math. Biol</source>., <volume>77</volume>, <fpage>1934</fpage>–<lpage>1954</lpage>.<pub-id pub-id-type="pmid">26481497</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turajlic</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal>; <collab>TRACERx Renal Consortium</collab>. (<year>2018</year>) <article-title>Tracking cancer evolution reveals constrained routes to metastases: TRACERx renal</article-title>. <source>Cell</source>, <volume>173</volume>, <fpage>581</fpage>–<lpage>594.e12</lpage>.<pub-id pub-id-type="pmid">29656895</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vendramin</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Cancer evolution: Darwin and beyond</article-title>. <source>EMBO J</source>., <volume>40</volume>, <fpage>e108389</fpage>.<pub-id pub-id-type="pmid">34459009</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waclaw</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>A spatial model predicts that dispersal and cell turnover limit intratumour heterogeneity</article-title>. <source>Nature</source>, <volume>525</volume>, <fpage>261</fpage>–<lpage>264</lpage>.<pub-id pub-id-type="pmid">26308893</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watson</surname><given-names>C.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>The evolutionary dynamics and fitness landscape of clonal hematopoiesis</article-title>. <source>Science</source>, <volume>367</volume>, <fpage>1449</fpage>–<lpage>1454</lpage>.<pub-id pub-id-type="pmid">32217721</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welch</surname><given-names>H.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Breast-cancer tumor size, overdiagnosis, and mammography screening effectiveness</article-title>. <source>N. Engl. J. Med</source>., <volume>375</volume>, <fpage>1438</fpage>–<lpage>1447</lpage>.<pub-id pub-id-type="pmid">27732805</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>West</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Normal tissue architecture determines the evolutionary course of cancer</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>2060</fpage>.<pub-id pub-id-type="pmid">33824323</pub-id></mixed-citation>
    </ref>
    <ref id="btad102-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Clonal architecture in mesothelioma is prognostic and shapes the tumour microenvironment</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1751</fpage>.<pub-id pub-id-type="pmid">33741915</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
