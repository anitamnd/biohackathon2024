<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">gbe</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1759-6653</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10735302</article-id>
    <article-id pub-id-type="pmid">38085033</article-id>
    <article-id pub-id-type="doi">10.1093/gbe/evad227</article-id>
    <article-id pub-id-type="publisher-id">evad227</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Patchwork: Alignment-Based Retrieval and Concatenation of Phylogenetic Markers from Genomic Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Thalén</surname>
          <given-names>Felix</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
        <aff><institution>Cardio-CARE AG, Medizincampus Davos</institution>, <addr-line>Davos Wolfgang 7265</addr-line>, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Köhne</surname>
          <given-names>Clara G</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7295-6616</contrib-id>
        <name>
          <surname>Bleidorn</surname>
          <given-names>Christoph</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
        <xref rid="evad227-cor1" ref-type="corresp"/>
        <!--christoph.bleidorn@biologie.uni-goettingen.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lavrov</surname>
          <given-names>Dennis</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="evad227-cor1">Corresponding author: E-mail: <email>christoph.bleidorn@biologie.uni-goettingen.de</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-12">
      <day>12</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>evad227</elocation-id>
    <history>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="evad227.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Low-coverage whole-genome sequencing (also known as “genome skimming”) is becoming an increasingly affordable approach to large-scale phylogenetic analyses. While already routinely used to recover organellar genomes, genome skimming is rather rarely utilized for recovering single-copy nuclear markers. One reason might be that only few tools exist to work with this data type within a phylogenomic context, especially to deal with fragmented genome assemblies. We here present a new software tool called Patchwork for mining phylogenetic markers from highly fragmented short-read assemblies as well as directly from sequence reads. Patchwork is an alignment-based tool that utilizes the sequence aligner DIAMOND and is written in the programming language Julia. Homologous regions are obtained via a sequence similarity search, followed by a “hit stitching” phase, in which adjacent or overlapping regions are merged into a single unit. The novel sliding window algorithm trims away any noncoding regions from the resulting sequence. We demonstrate the utility of Patchwork by recovering near-universal single-copy orthologs within a benchmarking study, and we additionally assess the performance of Patchwork in comparison with other programs. We find that Patchwork allows for accurate retrieval of (putatively) single-copy genes from genome skimming data sets at different sequencing depths with high computational speed, outperforming existing software targeting similar tasks. Patchwork is released under the GNU General Public License version 3. Installation instructions, additional documentation, and the source code itself are all available via GitHub at <ext-link xlink:href="https://github.com/fethalen/Patchwork" ext-link-type="uri">https://github.com/fethalen/Patchwork</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>genome skimming</kwd>
      <kwd>low-coverage sequencing</kwd>
      <kwd>museomics</kwd>
      <kwd>phylogenomics</kwd>
      <kwd>short reads</kwd>
      <kwd>single-copy genes</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Göttingen</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003385</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <boxed-text id="evad227-box1" position="float">
    <caption>
      <title>Significance</title>
    </caption>
    <p>Even though current sequencing and computational methods allow for the completion of high-quality genomes for all life on earth, the availability of material for sequencing became a major bottleneck in phylogenomic studies, especially since material stored in museum collections—or during barcoding campaigns—is often not suitable for reconstructing high-quality, highly continuous genomes. At the same time, the output of short-read sequencing machines is increasing, and prices for these techniques are dropping. Short-read data are still routinely used to recover organellar genomes, but this so-called genome skimming approach is rather rarely utilized for recovering single-copy nuclear markers. We present a new software tool called Patchwork for mining phylogenetic markers from highly fragmented genome assemblies, as well as directly from short sequence reads. We demonstrate the accuracy of this new approach and show in a benchmarking study that it also outperforms existing software for similar tasks. Patchwork allows to compile preselected gene sets from low-coverage short-read sequencing data sets and is thereby ideally suited when including material from museum collections into phylogenomic studies.</p>
  </boxed-text>
  <sec sec-type="intro" id="evad227-s0">
    <title>Introduction</title>
    <p>Advancements in high-throughput sequencing techniques have revolutionized the field of phylogenetics and ultimately our understanding of the tree of life (<xref rid="evad227-B30" ref-type="bibr">Lemmon and Lemmon 2013</xref>). The availability of genomic and transcriptomic data for basically all desired taxa and for a reasonable price has transformed the field to phylogenomics: genome-scale phylogenetic systematic analyses (<xref rid="evad227-B35" ref-type="bibr">McCormack et al. 2013</xref>). Some challenges remain, however, as many studies still show incongruent results, low branch support, or lacking resolution (<xref rid="evad227-B39" ref-type="bibr">Philippe et al. 2017</xref>; <xref rid="evad227-B52" ref-type="bibr">Steenwyk et al. 2023</xref>). Even though complete genomes are becoming available for more and more eukaryotes, the access to high-molecular-weight DNA is the bottleneck in the quest for sequencing genomes of all life on earth (<xref rid="evad227-B5" ref-type="bibr">Blom 2021</xref>; <xref rid="evad227-B10" ref-type="bibr">Dahn et al. 2022</xref>). Nowadays and in the past, most large-scale phylogenomic studies were conducted using either transcriptome sequencing or genome subsampling methods such as target enrichment, which focuses on a set of preselected loci (<xref rid="evad227-B4" ref-type="bibr">Bleidorn 2017</xref>).</p>
    <p>Transcriptome sequencing offers a way to sequence only the expressed portion of a genome without prior sequence knowledge (<xref rid="evad227-B51" ref-type="bibr">Stark et al. 2019</xref>). Unfortunately, this approach requires freshly collected material or specifically stored material, e.g. deeply flash frozen or in RNAlater. Furthermore, smaller specimens may need to be pooled together to attain sufficient amounts of mRNA, and such practice risks mixing up individuals with undetected genetic variation. Unfortunately, a large amount of collected specimens only exist in natural history museum collections, and most of these are ethanol preserved and thus not usable for transcriptomic studies (<xref rid="evad227-B8" ref-type="bibr">Call et al. 2021</xref>). As taxon sampling is considered one of the most important factors for accurate phylogenetic tree reconstruction (<xref rid="evad227-B19" ref-type="bibr">Heath et al. 2008</xref>), it would be missing an opportunity to leave the potential of natural history collections untapped. Target enrichment approaches, on the other hand, require prior knowledge of target sequences (e.g. from well-annotated genomes) for the construction of oligonucleotide probes. Moreover, the number of enriched targets is limited by the number of oligonucleotides included in the enrichment kit of choice, and the efficiency of such approaches decreases as the bait-to-target distance increases (<xref rid="evad227-B6" ref-type="bibr">Bragg et al. 2016</xref>). Another downside is that the data produced are difficult to reuse for other types of genomic or evolutionary studies.</p>
    <p>A viable alternative to assemble taxon-rich phylogenomic data sets is low-coverage whole-genome sequencing (LC-WGS; also known as “shallow genome sequencing” or “genome skimming”) using short-read technologies such as Illumina sequencing (<xref rid="evad227-B13" ref-type="bibr">Dodsworth 2015</xref>). Relying solely on this approach has been shown to be inadequate for the reconstruction of highly contiguous reference-quality genomes (<xref rid="evad227-B42" ref-type="bibr">Rhie et al. 2021</xref>). However, due to the introduction of newer sequencing platforms (e.g. Illumina's NovaSeq sequencing platform) short-read WGS became relatively cheap and prices are even expected to drop with Ultima Genomics, another highly competitive sequencing platform entering the market (<xref rid="evad227-B49" ref-type="bibr">Simmons et al. 2023</xref>). Moreover, short-read sequencing library construction also allows that highly fragmented DNA can be used as input (<xref rid="evad227-B21" ref-type="bibr">Hu et al. 2021</xref>), thereby enabling the use of material from museum collections from all around the world (<xref rid="evad227-B41" ref-type="bibr">Raxworthy and Smith 2021</xref>). Consequently, LC-WGS can be used to generate data from various sources of targeted organisms to retrieve marker loci on a genome scale. While this so-called “genome skimming” approach has frequently been used to reconstruct organellar genomes or other high-copy fractions of eukaryote genomes (<xref rid="evad227-B43" ref-type="bibr">Richter et al. 2015</xref>; <xref rid="evad227-B22" ref-type="bibr">Jin et al. 2020</xref>), it seems currently underutilized to retrieve single-copy nuclear markers (<xref rid="evad227-B31" ref-type="bibr">Liu et al. 2021</xref>). One reason is that short-read assemblies of eukaryotic genomes tend to be highly discontinuous, and automated annotation of such large, fragmented genomes remains difficult (<xref rid="evad227-B46" ref-type="bibr">Salzberg 2019</xref>), as they are characterized by the presence of “genes in pieces,” where introns interrupt coding sequences (<xref rid="evad227-B44" ref-type="bibr">Rogozin et al. 2005</xref>). Depending on the coverage, short-read draft genomes are characterized by low N50s in the range of few (if at all) kilobase pairs (kb; <xref rid="evad227-B47" ref-type="bibr">Salzberg et al. 2012</xref>), and consequently, exons of a single gene usually end up on several contigs.</p>
    <p>The disuse of genome skimming in large-scale phylogenetics could potentially be ascribed to the lack of suitable data analysis methods (<xref rid="evad227-B55" ref-type="bibr">Zhang et al. 2019</xref>). Existing software tools for working with LC-WGS data in a phylogenomic context, such as aTRAM 2 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>, <xref rid="evad227-B2" ref-type="bibr">2018</xref>), ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>), and GeMoMa (<xref rid="evad227-B25" ref-type="bibr">Keilwagen et al. 2016</xref>, <xref rid="evad227-B24" ref-type="bibr">2018</xref>), are either written in an interpreted language (e.g. Perl or Python) that does not allow the program to scale well with the large biological data sets that are commonplace today (e.g. aTRAM 2, ALiBaSeq) or need well-annotated reference genomes or transcriptomes (e.g. GeMoMa). A recent addition to the portfolio of available tools for such programs is Read2Tree, which directly infers trees from unassembled data (<xref rid="evad227-B14" ref-type="bibr">Dylus et al. 2023</xref>).</p>
    <p>To address the limitations typically associated when working with genome skimming data, we present Patchwork, an alignment-based tool for mining phylogenetic markers directly from WGS data. Patchwork utilizes the sequence aligner DIAMOND (<xref rid="evad227-B7" ref-type="bibr">Buchfink et al. 2021</xref>) and is written in the programming language Julia (<xref rid="evad227-B3" ref-type="bibr">Bezanson et al. 2017</xref>) to achieve the best possible speed, thus allowing Patchwork to scale well with today's genome-scale data sets. In addition, our implementation focuses on ease of use, and our program handles each step in the analysis—from start to finish. Using our new approach, we targeted universal single-copy orthologs (USCOs), which are available based on careful analysis of a curated database (OrthoDB, <ext-link xlink:href="https://www.orthodb.org" ext-link-type="uri">www.orthodb.org</ext-link>). A set of 954 metazoan-specific USCOs has been validated against 364 metazoan genomes and shown to be indeed (i) single-copy and (ii) nearly universally present (<xref rid="evad227-B33" ref-type="bibr">Manni et al. 2021</xref>).</p>
  </sec>
  <sec sec-type="results" id="evad227-s1">
    <title>Results</title>
    <p>Patchwork is a reference- and alignment-based method for mining phylogenetic markers from WGS data, using either assembled contigs or reads as input (<xref rid="evad227-F1" ref-type="fig">Fig. 1</xref>). The aim of Patchwork is to capture multiexon or fragmented genes, scattered across different contigs or reads. One or more reference protein sequences guide the “stitching” process, where the best-scoring translated query nucleotide sequences for any given region are merged into continuous stretches of amino acid sequences. Merged sequences go through a masking step in which unaligned residues, ambiguous amino acid characters (letters that do not determine a unique amino acid; they are B, J, X, or Z, where B = D or N, J = I or L, X = unknown, and Z = E or Q), and stop codons are removed from query sequences. Optionally, the removal of stop codons and ambiguous amino acid characters may be skipped by providing the --retain-stops and --retain-ambiguous flags, respectively. Finally, Patchwork implements a sliding window–based alignment trimming step to remove poorly aligned residues (e.g. due to the presence of putative noncoding regions) from the resulting sequences. The output is available as nucleotide or amino acid sequences.</p>
    <fig position="float" id="evad227-F1" fig-type="figure">
      <label>Fig. 1.</label>
      <caption>
        <p>Graphical overview of the Patchwork algorithm. First, a) query sequences are aligned to the provided reference sequence. These alignments may or may not be overlapping. b) Overlapping alignments are realigned but only in the area in which they overlap. The best-scoring alignment is retained while all others are discarded. c) Nonaligned residues are then removed, and d) the remaining regions are concatenated into a single, continuous sequence.</p>
      </caption>
      <graphic xlink:href="evad227f1" position="float"/>
    </fig>
    <sec id="evad227-s1.1">
      <title>Benchmark</title>
      <p>To asses performance of our approach, we (i) test an ideal case where the query and reference species are identical, (ii) where the query and reference are 2 distant species, and (iii) compare Patchwork v.0.5.1 with ALiBaSeq v.1.2 (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM v.2.4.3 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). Throughout these benchmarks, we use Illumina short-read nucleotide sequences from the marine annelid <italic toggle="yes">Dimorphilus gyrociliatus</italic> (accession PRJEB37657 in the European Nucleotide Archive). A highly contiguous (N50 = 2.24 Mb) and complete (95.8% BUSCO genes recovered, metazoa_odb10) annotated version of the compact 73.8-Mb genome of this annelid is publicly available (<xref rid="evad227-B34" ref-type="bibr">Martín-Durán et al. 2021</xref>).</p>
      <p>As we only used short-read data sets at different coverages for our benchmark analyses, we created highly discontinuous assemblies with low N50s as typical for real-world low-coverage genomic data sets. We assembled these sequence reads using SPAdes and subsequently used Patchwork to search for near-USCOs (<xref rid="evad227-B48" ref-type="bibr">Seppey et al. 2019</xref>), using a preannotated set of USCOs from that same species as a reference. Next, we used that same assembly of <italic toggle="yes">D. gyrociliatus</italic> to search for USCOs, this time using USCOs from the leech <italic toggle="yes">Helobdella robusta</italic> as the reference, a clitellate annelid that diverged at least 400 mya from <italic toggle="yes">D. gyrociliatus</italic> (<xref rid="evad227-B15" ref-type="bibr">Erséus et al. 2020</xref>). Finally, we compared our program to ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM 2 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). For this comparison, we also subsampled the aforementioned <italic toggle="yes">D. gyrociliatus</italic> short reads in order to simulate various sequencing coverages. We decided not to include the software GeMoMa (<xref rid="evad227-B25" ref-type="bibr">Keilwagen et al. 2016</xref>) in this comparison, as it heavily relies on the availability of reference genomic or transcriptomic data. Read2Tree (<xref rid="evad227-B14" ref-type="bibr">Dylus et al. 2023</xref>) has also not been included in the comparisons, as its focus is tree inference and not marker retrieval.</p>
      <p>We compared the retrieved translated and stitched contigs, hereafter called “recovered markers,” to the reference <italic toggle="yes">D. gyrociliatus</italic> USCOs. For each reference sequence, the evaluation included percent identical positions out of all aligned positions as well as percent of reference sequence positions covered by the recovered markers. Patchwork automatically generates these statistics and produces a detailed output for each reference as well as an aggregated output over all references.</p>
    </sec>
    <sec id="evad227-s1.2">
      <title>Effect of Genome Fragmentation on Accuracy</title>
      <p>In the initial setup, we assessed the accuracy of Patchwork using a high-quality query assembly and 815 USCO reference sequences from the same species, <italic toggle="yes">D. gyrociliatus</italic>, and thereby exploring the program's performance for the hypothetical case where the entire set of reference sequences should be recoverable as exactly matching stitched contigs from the query sequences. We retrieved all of the initial 815 markers. On average, 95.9% of all aligned positions were identical matches, with a mean query coverage of 92.2%; this equals a combined measure of 88.4% identical matches for all reference positions, whether aligned to query residues or not (<xref rid="evad227-F2" ref-type="fig">Fig. 2</xref> and <xref rid="evad227-T1" ref-type="table">Table 1</xref>).</p>
      <fig position="float" id="evad227-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Percent identity and query coverage in markers based on a Patchwork analysis of a SPAdes assembly of <italic toggle="yes">D. gyrociliatus</italic>, targeting 815 single-copy orthologs from the same species.</p>
        </caption>
        <graphic xlink:href="evad227f2" position="float"/>
      </fig>
      <table-wrap position="float" id="evad227-T1">
        <label>Table 1</label>
        <caption>
          <p>Results from Patchwork when using a <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as the query and USCOs from a long-read assembly of <italic toggle="yes">D. gyrociliatus</italic> as a reference</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Variable</th>
              <th align="center" rowspan="1" colspan="1">Mean</th>
              <th align="center" rowspan="1" colspan="1">Min</th>
              <th align="center" rowspan="1" colspan="1">Median</th>
              <th align="center" rowspan="1" colspan="1">Max</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference length</td>
              <td rowspan="1" colspan="1">447.606</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">351.0</td>
              <td rowspan="1" colspan="1">2,748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query length</td>
              <td rowspan="1" colspan="1">407.953</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">322.0</td>
              <td rowspan="1" colspan="1">2,553</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Matches</td>
              <td rowspan="1" colspan="1">385.075</td>
              <td rowspan="1" colspan="1">24</td>
              <td rowspan="1" colspan="1">306.0</td>
              <td rowspan="1" colspan="1">2,549</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mismatches</td>
              <td rowspan="1" colspan="1">21.207</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">1,075</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Deletions</td>
              <td rowspan="1" colspan="1">42.131</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">5.0</td>
              <td rowspan="1" colspan="1">1,097</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query coverage</td>
              <td rowspan="1" colspan="1">92.181</td>
              <td rowspan="1" colspan="1">5.22</td>
              <td rowspan="1" colspan="1">98.71</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identity</td>
              <td rowspan="1" colspan="1">95.887</td>
              <td rowspan="1" colspan="1">30.91</td>
              <td rowspan="1" colspan="1">100.0</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="evad227-s1.3">
      <title>Effect of Reference Divergence</title>
      <p>In the second iteration, we aligned a set of high-coverage query assemblies against a very distant reference set, in order to estimate the program's performance when using highly divergent sequences as reference. For this purpose, the same <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as in the previous evaluation served as query sequence set, and 957 near-USCOs from the annotated genome of the leech <italic toggle="yes">H. robusta</italic> were used as a reference. We retrieved 943 out of the 957 <italic toggle="yes">H. robusta</italic> reference sequences. Of these, 769 successfully aligned back to 1 and only 1 of the 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs that were considered homologous to the <italic toggle="yes">H. robusta</italic> set (<xref rid="evad227-F3" ref-type="fig">Fig. 3</xref> and <xref rid="evad227-T2" ref-type="table">Table 2</xref>). For these 769 retrieved markers, the average percent identity measure was 89%, with a mean query coverage of 74.5%. Put differently, the recovered markers had an average of 67.2% identical matches against all reference positions.</p>
      <fig position="float" id="evad227-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Percent identity and query coverage in markers based on a Patchwork analysis of a SPAdes assembly of <italic toggle="yes">D. gyrociliatus</italic>, targeting 957 single-copy orthologs from the leech <italic toggle="yes">H. robusta</italic>.</p>
        </caption>
        <graphic xlink:href="evad227f3" position="float"/>
      </fig>
      <table-wrap position="float" id="evad227-T2">
        <label>Table 2</label>
        <caption>
          <p>Results from Patchwork when using a <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as the query and USCOs from <italic toggle="yes">H. robusta</italic> as a reference</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Variable</th>
              <th align="center" rowspan="1" colspan="1">Mean</th>
              <th align="center" rowspan="1" colspan="1">Min</th>
              <th align="center" rowspan="1" colspan="1">Median</th>
              <th align="center" rowspan="1" colspan="1">Max</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference length</td>
              <td rowspan="1" colspan="1">448.025</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">351.0</td>
              <td rowspan="1" colspan="1">2.748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query length</td>
              <td rowspan="1" colspan="1">309.93</td>
              <td rowspan="1" colspan="1">31</td>
              <td rowspan="1" colspan="1">259.0</td>
              <td rowspan="1" colspan="1">2.326</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Matches</td>
              <td rowspan="1" colspan="1">249.126</td>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">195.0</td>
              <td rowspan="1" colspan="1">2.326</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mismatches</td>
              <td rowspan="1" colspan="1">30.234</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">7.0</td>
              <td rowspan="1" colspan="1">355</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">deletions</td>
              <td rowspan="1" colspan="1">8.319</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">2.0</td>
              <td rowspan="1" colspan="1">268</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query coverage</td>
              <td rowspan="1" colspan="1">74.540</td>
              <td rowspan="1" colspan="1">5.41</td>
              <td rowspan="1" colspan="1">82.78</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identity</td>
              <td rowspan="1" colspan="1">89.008</td>
              <td rowspan="1" colspan="1">25.46</td>
              <td rowspan="1" colspan="1">96.99</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The recovered markers were evaluated against the set of 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs that were considered homologous to sequences in the <italic toggle="yes">H. robusta</italic> reference set.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="evad227-s1.4">
      <title>Program Comparison</title>
      <p>In the third setup, we compared the performance and runtime for Patchwork to that of ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM 2 (<xref rid="evad227-B2" ref-type="bibr">Allen et al. 2018</xref>), using a <italic toggle="yes">D. gyrociliatus</italic> short-read data set at different sequence coverage levels (1×, 3×, 5×, 10×, 20×, and 40×). While Patchwork can use both reads and assembled contigs as an input, ALiBaSeq uses assembled contigs, and aTRAM 2 is read based. Performance was assessed using a combined measure for accuracy and completeness of the recovered USCO markers annotated, hereafter called “total percent identity.” Patchwork with <italic toggle="yes">D. gyrociliatus</italic> assembly data performs best over almost all data sets (<xref rid="evad227-F4" ref-type="fig">Fig. 4</xref>), reaching as much as 62% total percent identity for data with at least 10× coverage. Only with a coverage of 1×, <italic toggle="yes">D. gyrociliatus</italic> read-based data seem to be better suited for marker retrieval. Cutoff thresholds during the assembly might lead to discarding part of the sequence data that is retained when using reads, therefore causing the latter to achieve higher query coverage for the 1× data set. Note that query coverage improves especially for read data when tantan masking in DIAMOND is disabled (i.e. by providing --masking 0 as an argument). For data sets with higher coverage, running Patchwork on read data still achieves well over 50% total percent identity. Using read data therefore is a valid option that could be considered if the compute resources necessary for assembling the sequences are scarce. The performance of Patchwork stays approximately constant for data sets with coverages of at least 10×, independent of the used data. By comparison, ALiBaSeq achieves approximately 7% less total percent identity than Patchwork with assemblies for all data sets and performs only slightly better than Patchwork with read data for a coverage over 10×. aTRAM 2, on the other hand, performs comparatively poorly, with a maximum total percent identity of about 22% for the data set with 20× coverage. This is mostly due to the small number of recovered markers; the markers themselves generally have a high percent identity value. For a coverage of 1×, aTRAM 2 was unable to recover any stitched contigs at all. The program was also not evaluated for the data set of 40× coverage as it had not completed within the cluster's maximum runtime of 5 d.</p>
      <fig position="float" id="evad227-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Accuracy and completeness of the recovered marker sequences for the different <italic toggle="yes">D. gyrociliatus</italic> data sets when run against a reference set of <italic toggle="yes">H. robusta</italic> USCOs. Accuracy and completeness were jointly measured as percent identical out of all aligned positions multiplied with the total percentage of aligned nongap positions. This integrated measure avoids a distorted performance estimation, e.g. due to small number of recovered markers but high percent identity in the aligned positions. Patchwork was run with <italic toggle="yes">D. gyrociliatus</italic> assemblies unless indicated differently. ALiBaSeq received assemblies, while aTRAM 2 received reads as input.</p>
        </caption>
        <graphic xlink:href="evad227f4" position="float"/>
      </fig>
      <p>Both Patchwork and ALiBaSeq are very fast; the programs terminated in under 5 min when using assembly data (<xref rid="evad227-F5" ref-type="fig">Fig. 5</xref>). The runtimes fluctuated only slightly between data sets. Using Patchwork with reads required more time for larger data sets, but even for the largest evaluated data set, it finished after half an hour. By comparison, running aTRAM 2 took days for all data sets.</p>
      <fig position="float" id="evad227-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>Program runtime for each <italic toggle="yes">D. gyrociliatus</italic> data set. Patchwork was run both as a script and as a compiled program. It received <italic toggle="yes">D. gyrociliatus</italic> assemblies unless indicated differently. ALiBaSeq was run on assemblies, while aTRAM 2 received reads as input.</p>
        </caption>
        <graphic xlink:href="evad227f5" position="float"/>
      </fig>
    </sec>
    <sec id="evad227-s1.5">
      <title>Patchwork in a Phylogenomic Context</title>
      <p>To demonstrate how our software could be utilized in a phylogenomic pipeline, we used it to retrieve a set of 957 metazoan-specific USCOs from a phthirapteran data set (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). When reusing a set of 15 lice Operaional Taxonomic Units (Hexapoda and Phthiraptera), we were able to retrieve all 957 USCOs, for all taxa. The resulting alignments contained few gaps for any marker; i.e. most markers were well above the 90% aligned position trimming threshold. The trimmed alignment contained 3,454,320 positions in total, compared to 5,383,303 before trimming (i.e. ∼64% positions were retained after trimming). Our phylogenetic reconstruction resulted in a well-supported tree (<xref rid="evad227-F6" ref-type="fig">Fig. 6</xref>), which is largely congruent with the original analysis (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>), with the exception of the position of <italic toggle="yes">Haematopinus macronemis</italic>. However, this placement is the only part of the tree that is not well supported, and reasons for incongruence are unclear, which could be, e.g. slightly different choice of phylogenetic markers. However, in general, the approach worked very well, and for 951 of 954 USCOs, nearly complete exonic data could be retrieved.</p>
      <fig position="float" id="evad227-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>Phylogenetic analysis of Phthiraptera relationships as recovered from a Maximum Likelihood analysis of a combined supermatrix using USCOs as recovered by Patchwork. Analysis was conducted using IQ-TREE 2 including model and partition finding. Bootstrap values from 1,000 pseudoreplicates are given at the branches.</p>
        </caption>
        <graphic xlink:href="evad227f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="evad227-s2">
    <title>Discussion</title>
    <p>Patchwork is a new software for quickly mining phylogenetic markers from WGS data. Since Patchwork can retrieve homologous regions even in distantly related taxa, this program lends itself especially well for recovering phylogenetic markers for phylogenomic studies. It is simultaneously an efficient way for increasing marker occupancy in poorly assembled genomes and/or in the presence of multilocus exons. Finally, Patchwork allows the user to combine 2 different data types—i.e. transcriptomic and genomic data—into a single data set, thus further enabling an even larger taxon sampling and encouraging data reusability.</p>
    <p>Special consideration should be taken to avoid the creation of chimeric sequences. One way in which such sequences may arise is when orthologous (i.e. genes related via a speciation event) and paralogous (i.e. genes related via a gene duplication event) sequences are merged together. To circumvent this issue, we recommend that the user limits the use of reference sequences to near-USCOs. Different lineage-specific sets of such USCOs are available based on carefully analyzed sets of homologous genes from a curated database (<xref rid="evad227-B33" ref-type="bibr">Manni et al. 2021</xref>). Besides their use in evaluating the quality of genomic and metagenomic data, USCOs became also prominent as preselected marker sets in phylogenomic analyses (<xref rid="evad227-B45" ref-type="bibr">Sahbou et al. 2022</xref>) and have been recently proposed as a unifying framework for DNA-based species delimitation (<xref rid="evad227-B12" ref-type="bibr">Dietz et al. 2023</xref>). Many programs, e.g. the aforementioned program BUSCO, exist for retrieving such sequences from an already assembled genome, and these could be used as reference sequences (<xref rid="evad227-B53" ref-type="bibr">Waterhouse et al. 2018</xref>). Additionally, several downstream analysis tools are available to control for the presence of possible cross-contamination, (unexpected) paralogous copies, or other artifacts confounding systematic studies (<xref rid="evad227-B32" ref-type="bibr">Lozano-Fernandez 2022</xref>). To control for the possible artifactual inclusion of stretches of noncoding sequences, the tool PREQUAL could be used to detect such and remove such regions (<xref rid="evad227-B54" ref-type="bibr">Whelan et al. 2018</xref>). Finally, multiple alignment tools such as MACSE (<xref rid="evad227-B40" ref-type="bibr">Ranwez et al. 2018</xref>) can be used to deal with putative confounding problems from the occurrence of premature stop codons, which might occur when working with data with coverage genomic data.</p>
    <p>The accuracy and the robustness of the results depends on how closely related the target and the reference species under study are. The difficulty stems from the ability to accurately predict noncoding regions in aligned contigs; because alignment trimming relies on gap-excluded identity, choosing the correct cutoff threshold becomes increasingly easier as the level of identity approaches 100% (the identity of noncoding regions is likely to stay the same, while the identity to coding regions increases). On the upside, high-quality genomes for practically all major lineages exist and are readily available online (<xref rid="evad227-B16" ref-type="bibr">Formenti et al. 2022</xref>). Moreover, and not surprisingly, the coverage of the input read data sets correlates with the performance of retrieving single-copy marker genes. Similar to a previous study (<xref rid="evad227-B31" ref-type="bibr">Liu et al. 2021</xref>), we also find that a coverage of 10× and more should be targeted when designing genome skimming studies. However, as seen in the proof of principle, even lower coverages enable the construction of phylogenomic data matrices. For very low-coverage data sets, the read-based mode outperforms assembly-based analyses. For the latter, assembly size seems to be more important than contiguity.</p>
    <p>In summary, Patchwork allows the retrieval of (putatively) single-copy genes from genome skimming data sets at different sequencing coverage with high computational speed. Availability and quality of biological specimens are becoming the major bottleneck for phylogenomic studies. Especially for phylogenomic studies relying on collection-based material, Patchwork offers a fast and efficient way for marker retrieval from short-read sequence data sets.</p>
  </sec>
  <sec sec-type="materials|methods" id="evad227-s3">
    <title>Materials and Methods</title>
    <p>Patchwork is implemented in Julia (<xref rid="evad227-B3" ref-type="bibr">Bezanson et al. 2017</xref>), a just-in-time (JIT)–compiled programming language that is typically faster than interpreted languages such as Python or R. Existing Julia bioinformatics packages such as BioAlignments.jl (<ext-link xlink:href="https://github.com/BioJulia/BioAlignments.jl" ext-link-type="uri">https://github.com/BioJulia/BioAlignments.jl</ext-link>) and BioSequences.jl (<ext-link xlink:href="https://github.com/BioJulia/BioSequences.jl" ext-link-type="uri">https://github.com/BioJulia/BioSequences.jl</ext-link>) were used to speed up the development process. Patchwork is obtainable from GitHub (<ext-link xlink:href="https://github.com/fethalen/Patchwork" ext-link-type="uri">https://github.com/fethalen/Patchwork</ext-link>), is distributed under the GPLv3 license, and targets both Linux and macOS (Windows users may run Patchwork by using the Windows Subsystem for Linux).</p>
    <p>In order to facilitate reproducibility, a Docker container (<xref rid="evad227-B36" ref-type="bibr">Merkel 2014</xref>) of Patchwork is also distributed via the BioContainers framework (<xref rid="evad227-B11" ref-type="bibr">da Veiga Leprevost et al. 2017</xref>). Similarly, we also provide an Apptainer definition file for users of the Apptainer/Singularity platform. Apptainer (formerly known as Singularity; <xref rid="evad227-B28" ref-type="bibr">Kurtzer et al. 2017</xref>) is another container platform that targets shared systems such as High-Performance Computing platforms, which are commonplace at universities today.</p>
    <p>Most phylogenomic studies include more than a handful of taxa, and concatenating these manually gets increasingly tedious as the data set size increases. Therefore, Patchwork also includes a set of complementary tools for streamlining the downstream analysis. For example, the script multi_patchwork.sh lets the user run Patchwork on multiple input files and concatenate homologous sequences from different taxa into 1 file.</p>
    <sec id="evad227-s3.1">
      <title>Initial Alignment and Database Construction</title>
      <p>First, all reference protein sequences, regardless of whether they are spread across multiple FASTA files or not, are pooled together into a single FASTA file, from which a DIAMOND database is created. There is also the option to use an existing DIAMOND-formatted database or a BLAST output file in a tabular format by using the --database or --tabular options, respectively. These files are both provided in the output of Patchwork and can thus be reutilized when trying out different parameters. In either case, DIAMOND's BLASTX algorithm is used to align translated nucleotide sequences to 1 or more reference protein sequences.</p>
      <p>Like DIAMOND, Patchwork, by default, scores alignments using the substitution matrix BLOSUM62 (<xref rid="evad227-B20" ref-type="bibr">Henikoff and Henikoff 1996</xref>), a gap open penalty of 11, and a gap extension penalty of 1. Other built-in or custom substitution matrices may be used in place of the default option. User-chosen gap open penalties and gap extension penalties may also be set, as long as they fall within the limits set by the substitution matrix of choice. For the users’ convenience, Patchwork supports a number of different DIAMOND options that can usually be provided in the same manner as in DIAMOND itself.</p>
      <p>For all Patchwork benchmarks, we observed that disabling DIAMOND's tantan masking (<xref rid="evad227-B17" ref-type="bibr">Frith 2011</xref>), by setting --masking 0, as described in <xref rid="evad227-T2" ref-type="table">Table 2</xref>, yielded higher query coverages. This effect was more pronounced for read data sets but could also be detected in assembled data sets. On the other hand, the number of exact matches in all aligned positions (i.e. percent identity) between the query and the reference decreased slightly. When combining both measures, however, disabling tantan masking improved the overall results.</p>
      <p>Since the alignment search is likely to result in more than 1 hit per reference region, certain measures are taken to ensure that none of these hits are overlapping: They are, “hit stitching” (also known as contig or exon stitching; i.e. merging of overlapping regions), removal of unaligned residues, and concatenation of nonoverlapping regions.</p>
    </sec>
    <sec id="evad227-s3.2">
      <title>Hit Stitching</title>
      <p>During “hit stitching,” all alignments made between the query region and the target sequence are merged in a way such that only the highest-scoring segment pair (HSP) for each region is retained. This results in a single, continuous sequence, and, as a consequence, some hits may be removed entirely (see also <xref rid="evad227-F1" ref-type="fig">Fig. 1</xref>).</p>
      <p>The “hit stitching” algorithm works as follows: First, query regions are sorted according to how they align to the target sequence—from first to last—and are added to the stack. Next, each pair of query regions on the stack is checked for overlaps. In case of an overlap, first, all regions are sorted by their first and last position at which they align to the reference sequence. The first region is added to the stack. Its start and end coordinates are then compared with those of the following region to check if they are overlapping. If they are not overlapping, the next adjacent region is added to the stack and compared with the following region. If they are overlapping, however, the region that is currently at the top of the stack is removed. The overlapping parts of this region and the next region are realigned to identify the best-scoring sequence at that particular interval. Then, based on the realignment score, the sequences are sliced such that the best-scoring sequence is retained at the overlapping region and so that the nonoverlapping, flanking parts of both regions, if existing, are preserved as well. Thus, a maximum of 3 sliced region parts are then added to the stack as new, separate regions: The sequence part preceding the overlap, which originates from the first region, the highest-scoring sequence at the overlap, which may be from either of the 2, and the sequence part that follows the overlap, which originates from the second region. The algorithm then continues in the same manner, comparing the topmost region of the stack with the following region, until all overlaps are removed and all regions have been added to the stack. This procedure may require multiple iterations, since in every run, only each pair of consecutive regions are compared and merged.</p>
      <p>Different aligned regions from the same contig are allowed to be stitched together. While “hit stitching” may result in the creation of chimeric sequences (i.e. 2 or more biological sequences incorrectly joined together), this procedure has the potential to increase coverage and to (correctly) join 2 or more regions that are located on separate contigs due to incomplete assembly or sequencing errors.</p>
    </sec>
    <sec id="evad227-s3.3">
      <title>Alignment Masking</title>
      <p>At this step, unaligned residues, ambiguous amino acid characters, and stop codons (also known as “termination codons”) are all removed from the resulting query sequence. Query sequences may contain residues that do not align to any particular region of the subject sequence. Such regions may be noncoding regions or simply insertions. In either case, unaligned residues are removed on the basis that inserts are less likely to constitute phylogenetically informative sites and risks introducing untranslated regions and therefore biasing the downstream analysis. Similarly, ambiguous amino acids are most likely noninformative, and stop codons are a clear indicator that noncoding characters have been included in the alignment. Although such regions are likely to be removed in the subsequent step (see above), the user may choose to keep stop codons and/or ambiguous amino acid characters by providing the flags --retain-stops and/or --retain-ambiguous.</p>
    </sec>
    <sec id="evad227-s3.4">
      <title>Sliding Window–Based Alignment Trimming</title>
      <p>One side effect of aligning translated nucleotide sequences to amino acid sequences is that one might recover noncoding portions of DNA, provided that the following 2 conditions are fulfilled: (i) the noncoding DNA is located in between 2 or more coding portions and (ii) there is a sequence region in the reference sequence that the noncoding region can align to. In the resulting alignment, noncoding portions are characterized by many indels, intercepted by occasional matches. The alignment of noncoding portions of DNA can already be observed in the alignments produced by DIAMOND, and thus, this side effect does not stem from Patchwork itself. In fact, the Patchwork algorithm will only include noncoding parts if nothing else aligns better to the affected region of the reference sequence.</p>
      <p>To mitigate this effect, we have implemented a sliding window–based alignment trimming approach to rid the alignments from these unwanted regions. This works by scanning the alignment from left to right, cutting all regions where the average distance between query and reference is above the user-provided distance threshold. The window size and the distance threshold can both be set by the user, but need not be, since we implemented default values for both. This step can also be skipped over in its entirety. This approach tries to avoid cases where a single bad, but correct, match would have otherwise been cut out.</p>
    </sec>
    <sec id="evad227-s3.5">
      <title>Concatenation and Realignment of Remaining Regions</title>
      <p>Finally, the resulting set of ordered, nonoverlapping sequence regions are concatenated into 1 continuous sequence. The concatenated sequence is then realigned to the reference to obtain the final output sequence and alignment score.</p>
    </sec>
    <sec id="evad227-s3.6">
      <title>Benchmark</title>
      <p>Patchwork v.0.5.1 was continuously run using Julia v.1.8.2 and DIAMOND v.2.0.13 (<xref rid="evad227-B7" ref-type="bibr">Buchfink et al. 2021</xref>), with the options --ultra-sensitive --frameshift 15 --masking 0. All analyses were performed on the high-performance computing cluster maintained by the <italic toggle="yes">Gesellschaft für wissenschaftliche Datenverarbeitung mbH Göttingen</italic> (GWDG), running the Scientific Linux release 7.9 (Nitrogen) operating system with a Linux kernel of version 3.10.0. All runs were allocated 32 Intel Xeon Platinum 9242 CPUs running at 2.30 GHz. Elapsed time was calculated as reported by Slurm.</p>
    </sec>
    <sec id="evad227-s3.7">
      <title>Effect of Genome Fragmentation on Accuracy</title>
      <p>A publicly available set of Illumina short-read sequences of <italic toggle="yes">D. gyrociliatus</italic> (<xref rid="evad227-B34" ref-type="bibr">Martín-Durán et al. 2021</xref>) was used for the query set. We used SPAdes v.3.15.3 to generate the de novo assembly, using a <italic toggle="yes">K</italic>-mer size of 55. A set of 815 <italic toggle="yes">D. gyrociliatus</italic> USCOs retrieved from the published high-quality genome assembly (GenBank, accession: <ext-link xlink:href="GCA_904063045.1" ext-link-type="DDBJ/EMBL/GenBank">GCA_904063045.1</ext-link>) served as the reference.</p>
    </sec>
    <sec id="evad227-s3.8">
      <title>Effect of Reference Divergence</title>
      <p>We reused the de novo assembly from the previous evaluation for the query, while a set of 957 near-USCOs from the annotated genome of the leech <italic toggle="yes">H. robusta</italic> (GenBank, accession: <ext-link xlink:href="GCA_000326865.1" ext-link-type="DDBJ/EMBL/GenBank">GCA_000326865.1</ext-link>) were used as reference sequences. We used the same parameter settings described above. For this evaluation, we did not use Patchwork's own accuracy and completeness assessment, because the true number of identical matches and the amount of query coverage are not known between the 2 divergent species <italic toggle="yes">D. gyrociliatus</italic> and <italic toggle="yes">H. robusta</italic>. We therefore chose to compare the recovered markers to a subset of the <italic toggle="yes">D. gyrociliatus</italic> USCOs described in the previous benchmark. More specifically, only those <italic toggle="yes">D. gyrociliatus</italic> USCOs that produced a hit when searching against the <italic toggle="yes">H. robusta</italic> USCOs with DIAMOND v2.0.13 in ultrasensitive mode were used, since only these were considered “recoverable” in this setup. The resulting <italic toggle="yes">D. gyrociliatus</italic> USCO set contains 778 sequences; 37 sequences were discarded. The set of recovered markers was searched against the reference USCO set using DIAMOND in --ultra-sensitive mode. For each reference sequence, we retrieved only the marker that produced the highest bit score during the alignment step. We then evaluated percent identical positions out of all aligned positions as well as percent of reference sequence positions covered by the recovered markers.</p>
    </sec>
    <sec id="evad227-s3.9">
      <title>Program Comparison</title>
      <p>In order to generate data sets at different sequencing coverages, we subsampled the trimmed <italic toggle="yes">D. gyrociliatus</italic> reads downloaded from NCBI GenBank. Corresponding read pairs were selected randomly from the paired-end data. Subsampling was done using Subsample.jl, a Julia package distributed together with Patchwork. The resulting data sets have coverages of 1×, 3×, 5×, 10×, 20×, and 40×.</p>
      <p>For each of the data sets, we produced a short-read-only de novo assembly, as ALiBaSeq is designed for assembly data, while aTRAM 2 requires read data and Patchwork can process both. We used the assembler SPAdes v.3.15.3 (<xref rid="evad227-B38" ref-type="bibr">Nurk et al. 2013</xref>), with a <italic toggle="yes">K</italic>-mer size of 33, and the quality of the assembly was assessed using QUAST v.5.0.2 (<xref rid="evad227-B18" ref-type="bibr">Gurevich et al. 2013</xref>). We aligned the <italic toggle="yes">D. gyrociliatus</italic> reads and assemblies against the same set of <italic toggle="yes">H. robusta</italic> USCOs mentioned before.</p>
      <p>ALiBaSeq v.1.2 was run with the <italic toggle="yes">D. gyrociliatus</italic> assemblies described above. The program requires BLAST; the version here used was 2.11.0. The program builds a database from the <italic toggle="yes">D. gyrociliatus</italic> sequences and searches this database with the <italic toggle="yes">H. robusta</italic> sequences before stitching the hits together. We set the parameters according to the guide for a protein-based search without reciprocal search, as explained in their documentation on GitHub (see the README file): -x a [extract all hits and join into (super)contigs] -f S [single alignment table (TBLASTN result file)] -e 1e-10 [<italic toggle="yes">e</italic>-value cutoff for further processing of TBLASTN hits] -c 1 [extract single best (super)contig] --amalgamate-hits [scoring scheme for (super)contigs] --is [enable contig stitching] –ac aa-tdna [search protein “baits” (<italic toggle="yes">H. robusta</italic> USCOs) against tDNA “target” database (<italic toggle="yes">D. gyrociliatus</italic> reads)].</p>
      <p>We ran aTRAM v.2.4.3 with the sampled <italic toggle="yes">D. gyrociliatus</italic> read data sets. The program further requires BLAST, as well as a de novo assembler, and exonerate. We used BLAST v.2.11.0 and exonerate v.2.2.0 (<xref rid="evad227-B50" ref-type="bibr">Slater and Birney 2005</xref>) and employed SPAdes v.3.15.3 for the assembly step. The full aTRAM 2 pipeline consists of 3 consecutive steps: Firstly, the preparation of a database from the <italic toggle="yes">D. gyrociliatus</italic> reads, secondly, the assembly of different loci, and lastly, a reference-guided stitching process. The parameter settings for the core module of aTRAM 2 as well as the stitcher were as follows: --evalue 1e-10 --file-filter “*.filtered contigs.fasta” --overlap N.</p>
      <p>Patchwork v.0.5.1 was run with both the sampled <italic toggle="yes">D. gyrociliatus</italic> read data sets and the assemblies we produced for these sampled read data. We ran the uncompiled program using Julia v.1.8.2 as well as the compiled version on each data set in order to perform runtime comparisons. Patchwork achieves all its objectives in a 1-step procedure, i.e. can be called with a single command, unlike ALiBaSeq and aTRAM 2. The program builds a DIAMOND database from the <italic toggle="yes">H. robusta</italic> sequences and, after obtaining <italic toggle="yes">D. gyrociliatus</italic> hits, proceeds to stitch them together. All nondefault parameter settings for Patchwork were as described above. They were used for both read-based runs and assembly-based runs.</p>
      <p>We ran the 3 programs with their respective parameter settings on the different <italic toggle="yes">D. gyrociliatus</italic> data sets against the <italic toggle="yes">H. robusta</italic> USCO set described above, which contains 957 sequences. The aTRAM 2 run for the 40× coverage read data set was ended prematurely because it had not terminated after 5 d. In a following step, the recovered markers produced by each program for each data set were evaluated with respect to completeness and accuracy of the resulting sequences by comparing them to the same set of 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs mentioned above, again because only this subset could be recovered by the programs in this setup. ALiBaSeq and aTRAM 2 output DNA sequences that contain the ambiguous nucleotide N in all positions that could not be recovered during stitching. These N were removed for the subsequent evaluation steps because they distort the query coverage measure; the amount of a reference sequence covered by the recovered marker is artificially increased due to the uninformative inserted N.</p>
      <p>Completeness and accuracy were measured jointly as percent identical aligned positions multiplied with the total amount of aligned, or recovered, positions (here called <italic toggle="yes">p</italic><sub>identical, cov</sub>):</p>
      <disp-formula id="UM0001">
        <mml:math id="UM1" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>p</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">identical</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">cov</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">match</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">aligned</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>⋅</mml:mo>
            <mml:mrow>
              <mml:mi mathvariant="normal">cov</mml:mi>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0002">
        <mml:math id="UM2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="normal">cov</mml:mi>
          </mml:mrow>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">recovered</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">length</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">recovered</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">USCOs</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">length</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">USCOs</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p><italic toggle="yes">n</italic><sub>match</sub> being the total number of exact matches in all alignments between recovered markers and reference USCOs and <italic toggle="yes">n</italic><sub>aligned</sub> the total number of aligned, i.e. nongap, positions. The coverage cov was computed as the ratio of the total lengths of all recovered markers <italic toggle="yes">s</italic><sub>recovered</sub> and all reference USCOs <italic toggle="yes">s</italic><sub>USCOs</sub>. We chose to combine the measures for accuracy of the recovered markers, i.e. percent identical out of all aligned positions, and completeness or query coverage, i.e. percent recovered positions, in order to avoid a distorted outcome. For example, a program might recover only a very small number of markers but these with high percent identity, such that using only the percent identity measure would have resulted in an overestimation of the program's performance.</p>
    </sec>
    <sec id="evad227-s3.10">
      <title>Patchwork in a Phylogenomic Context</title>
      <p>We retrieved the raw reads from the NCBI Sequence Read Archive (SRA accession SRR5088465, SRR5088468, SRR5308129 SRR5308123, SRR5088469 SRR5088471, SRR5088472, SRR5088473, SRR1182279, SRR5308136, SRR5308138, SRR5088474, SRR5088475, SRR5308112, and SRR5088466) using prefetch, vdb-validate, and fasterq-dump (with the flag --split-spot), all from the NCBI SRA toolkit (<xref rid="evad227-B29" ref-type="bibr">Leinonen et al. 2011</xref>). We ran Patchwork v.0.5.1 with each of the specimens as query input and a set of 957 near-USCOs from the leech <italic toggle="yes">H. robusta</italic> as reference sequences (see <xref rid="evad227-T2" ref-type="table">Table 2</xref> for parameter settings). A multiple sequence alignment (MSA) was constructed for each of these 957 loci using MAFFT (<xref rid="evad227-B23" ref-type="bibr">Katoh and Standley 2013</xref>) with the options –globalpair --ep 0.123. The resulting alignments were trimmed with trimAl (<xref rid="evad227-B9" ref-type="bibr">Capella-Gutiérrez et al. 2009</xref>), removing all positions with more than 90% gaps but retaining at least 60% of each alignment (options -gt 0.9 and -cons 60, respectively). We used FASconcat-G (<xref rid="evad227-B27" ref-type="bibr">Kück and Longo 2014</xref>) to concatenate the trimmed alignments into a supermatrix. This supermatrix was then input into IQ-TREE 2 (<xref rid="evad227-B37" ref-type="bibr">Minh et al. 2020</xref>), alongside its corresponding gene partition file, to reconstruct the phylogeny using the maximum likelihood (ML) approach. We ran IQ-TREE 2 with extended model selection and tree inference, calculating 1,000 replicates for the ultrafast bootstrap (command line options -m MFP and -B 1000, respectively).</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>This work used the Scientific Compute Cluster at GWDG, the joint data center of Max Planck Society for the Advancement of Science (MPG) and University of Göttingen. We acknowledge support by the Open Access Publication Funds of the Göttingen University.</p>
  </ack>
  <sec id="evad227-s4">
    <title>Funding</title>
    <p>This work was supported by the German Research Foundation (DFG) BL787/8-1.</p>
  </sec>
  <sec sec-type="data-availability" id="evad227-s5">
    <title>Data Availability</title>
    <p>The data underlying this article are available via GitHub at <ext-link xlink:href="https://github.com/animal-evolution-and-biodiversity/benchmarking-patchwork" ext-link-type="uri">https://github.com/animal-evolution-and-biodiversity/benchmarking-patchwork</ext-link>. Patchwork is distributed under the GPLv3 license via GitHub at <ext-link xlink:href="https://github.com/fethalen/patchwork" ext-link-type="uri">https://github.com/fethalen/patchwork</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature Cited</title>
    <ref id="evad227-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Boyd</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>NP</given-names></string-name>, <string-name><surname>Vachaspati</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Warnow</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Huang</surname>  <given-names>DI</given-names></string-name>, <string-name><surname>Grady</surname>  <given-names>PGS</given-names></string-name>, <string-name><surname>Bell</surname>  <given-names>KC</given-names></string-name>, <string-name><surname>Cronk</surname>  <given-names>QCB</given-names></string-name>, <string-name><surname>Mugisha</surname>  <given-names>L</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Phylogenomics from whole genome sequences using aTRAM</article-title>. <source>Syst Biol</source>. <year>2017</year>:<volume>66</volume>(<issue>5</issue>):<fpage>786</fpage>–<lpage>798</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syw105</pub-id>.<pub-id pub-id-type="pmid">28123117</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>LaFrance</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Folk</surname>  <given-names>RA</given-names></string-name>, <string-name><surname>Johnson</surname>  <given-names>KP</given-names></string-name>, <string-name><surname>Guralnick</surname>  <given-names>RP</given-names></string-name></person-group>. <article-title>aTRAM 2.0: an improved, flexible locus assembler for NGS data</article-title>. <source>Evol Bioinform</source>. <year>2018</year>:<volume>14</volume>:<comment>1176934318774546. </comment><pub-id pub-id-type="doi">10.1177/1176934318774546</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezanson</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Edelman</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Karpinski</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Shah</surname>  <given-names>VB</given-names></string-name></person-group>. <article-title>Julia: a fresh approach to numerical computing</article-title>. <source>SIAM Rev</source>. <year>2017</year>:<volume>59</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1137/141000671</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name></person-group>. <source>Phylogenomics. An introduction</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer International Publishing</publisher-name>; <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="evad227-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blom</surname>  <given-names>MPK</given-names></string-name></person-group>. <article-title>Opportunities and challenges for high-quality biodiversity tissue archives in the age of long-read sequencing</article-title>. <source>Mol Ecol</source>. <year>2021</year>:<volume>30</volume>(<issue>23</issue>):<fpage>5935</fpage>–<lpage>5948</lpage>. <pub-id pub-id-type="doi">10.1111/mec.15909</pub-id>.<pub-id pub-id-type="pmid">33786900</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bragg</surname>  <given-names>JG</given-names></string-name>, <string-name><surname>Potter</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bi</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Moritz</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>Exon capture phylogenomics: efficacy across scales of divergence</article-title>. <source>Mol Ecol Res</source>. <year>2016</year>:<volume>16</volume>(<issue>5</issue>):<fpage>1059</fpage>–<lpage>1068</lpage>. <pub-id pub-id-type="doi">10.1111/1755-0998.12449</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Reuter</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Drost</surname>  <given-names>H-G</given-names></string-name></person-group>. <article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>. <source>Nature Meth</source>. <year>2021</year>:<volume>18</volume>(<issue>4</issue>):<fpage>366</fpage>–<lpage>368</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-021-01101-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Call</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Mayer</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Twort</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Dietz</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Wahlberg</surname>  <given-names>N</given-names></string-name></person-group><etal>et al</etal>  <year>2021</year>. <article-title>Museomics: phylogenomics of the moth family Epicopeiidae (Lepidoptera) using target enrichment</article-title>. <source>Insect Syst Divers</source>. <volume>5</volume>(<issue>2</issue>):<fpage>6</fpage>. <pub-id pub-id-type="doi">10.1093/isd/ixaa021</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capella-Gutiérrez</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Silla-Martínez</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Gabaldón</surname>  <given-names>T</given-names></string-name></person-group>. <article-title>Trimal: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>  <year>2009</year>:<volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>.<pub-id pub-id-type="pmid">19505945</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dahn</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Mountcastle</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Balacco</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Winkler</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bista</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Schmitt</surname>  <given-names>AD</given-names></string-name>, <string-name><surname>Pettersson</surname>  <given-names>OV</given-names></string-name>, <string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Oliver</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Smith</surname>  <given-names>M</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Benchmarking ultra-high molecular weight DNA preservation methods for long-read and long-range sequencing</article-title>. <source>GigaScience</source>  <year>2022</year>:<volume>11</volume>:<fpage>giac068</fpage>. <pub-id pub-id-type="doi">10.1093/gigascience/giac068</pub-id>.<pub-id pub-id-type="pmid">35946988</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>da Veiga Leprevost</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Grüning</surname>  <given-names>BA</given-names></string-name>, <string-name><surname>Alves Aflitos</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Röst</surname>  <given-names>HL</given-names></string-name>, <string-name><surname>Uszkoreit</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Barsnes</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Perez-Riverol</surname>  <given-names>Y</given-names></string-name></person-group>. <article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>. <source>Bioinformatics</source>  <year>2017</year>:<volume>33</volume>(<issue>16</issue>):<fpage>2580</fpage>–<lpage>2582</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx192</pub-id>.<pub-id pub-id-type="pmid">28379341</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dietz</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Eberle</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Mayer</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Kukowka</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bohacz</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Baur</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Espeland</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Huber</surname>  <given-names>BA</given-names></string-name>, <string-name><surname>Hutter</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Mengual</surname>  <given-names>X</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Standardized nuclear markers improve and homogenize species delimitation in Metazoa</article-title>. <source>Methods Ecol Evol</source>. <year>2023</year>:<volume>14</volume>(<issue>2</issue>):<fpage>543</fpage>–<lpage>555</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.14041</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dodsworth</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Genome skimming for next-generation biodiversity analysis</article-title>. <source>Trends Plant Sci</source>. <year>2015</year>:<volume>20</volume>(<issue>9</issue>):<fpage>525</fpage>–<lpage>527</lpage>. <pub-id pub-id-type="doi">10.1016/j.tplants.2015.06.012</pub-id>.<pub-id pub-id-type="pmid">26205170</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dylus</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Altenhoff</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Majidian</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Sedlazeck</surname>  <given-names>FJ</given-names></string-name>, <string-name><surname>Dessimoz</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>Inference of phylogenetic trees directly from raw sequencing reads using Read2Tree</article-title>. <source>Nat Biotechnol</source>. <year>2023</year>. <pub-id pub-id-type="doi">10.1038/s41587-023-01753-4</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Erséus</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Williams</surname>  <given-names>BW</given-names></string-name>, <string-name><surname>Horn</surname>  <given-names>KM</given-names></string-name>, <string-name><surname>Halanych</surname>  <given-names>KM</given-names></string-name>, <string-name><surname>Santos</surname>  <given-names>SR</given-names></string-name>, <string-name><surname>James</surname>  <given-names>SW</given-names></string-name>, <string-name><surname>Des Creuzé Châtelliers</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Anderson</surname>  <given-names>FE</given-names></string-name></person-group>. <article-title>Phylogenomic analyses reveal a Palaeozoic radiation and support a freshwater origin for clitellate annelids</article-title>. <source>Zool Scr</source>. <year>2020</year>:<volume>49</volume>(<issue>5</issue>):<fpage>614</fpage>–<lpage>640</lpage>. <pub-id pub-id-type="doi">10.1111/zsc.12426</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Theissinger</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Fernandes</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Bista</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Bombarely</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Ciofi</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Crottini</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Godoy</surname>  <given-names>JA</given-names></string-name>, <string-name><surname>Höglund</surname>  <given-names>J</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>The era of reference genomes in conservation genomics</article-title>. <source>Trends Ecol Evol</source>. <year>2022</year>:<volume>37</volume>(<issue>3</issue>):<fpage>197</fpage>–<lpage>202</lpage>. <pub-id pub-id-type="doi">10.1016/j.tree.2021.11.008</pub-id>.<pub-id pub-id-type="pmid">35086739</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frith</surname>  <given-names>MC</given-names></string-name></person-group>. <article-title>A new repeat-masking method enables specific detection of homologous sequences</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>:<volume>39</volume>(<issue>4</issue>):<fpage>e23</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1212</pub-id>.<pub-id pub-id-type="pmid">21109538</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gurevich</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Saveliev</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Vyahhi</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Tesler</surname>  <given-names>G</given-names></string-name></person-group>. <article-title>QUAST: quality assessment tool for genome assemblies</article-title>. <source>Bioinformatics</source>  <year>2013</year>:<volume>29</volume>(<issue>8</issue>):<fpage>1072</fpage>–<lpage>1075</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>.<pub-id pub-id-type="pmid">23422339</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heath</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Hedtke</surname>  <given-names>SM</given-names></string-name>, <string-name><surname>Hillis</surname>  <given-names>DM</given-names></string-name></person-group>. <year>2008</year>. <article-title>Taxon sampling and the accuracy of phylogenetic analyses</article-title>. <source>J Syst Evol</source>. <volume>46</volume>:<fpage>239</fpage>–<lpage>257</lpage>. <pub-id pub-id-type="doi">10.3724/SP.J.1002.2008.08016</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname>  <given-names>JG</given-names></string-name>, <string-name><surname>Henikoff</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Blocks database and its applications</article-title>. <source>Meth Enzymol</source>. <year>1996</year>:<volume>266</volume>:<fpage>88</fpage>–<lpage>105</lpage>. <pub-id pub-id-type="doi">10.1016/S0076-6879(96)66008-X</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Chitnis</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Monos</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Dinh</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Next-generation sequencing technologies: an overview</article-title>. <source>Human Immunol</source>. <year>2021</year>:<volume>82</volume>(<issue>11</issue>):<fpage>801</fpage>–<lpage>811</lpage>. <pub-id pub-id-type="doi">10.1016/j.humimm.2021.02.012</pub-id>.<pub-id pub-id-type="pmid">33745759</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname>  <given-names>J-J</given-names></string-name>, <string-name><surname>Yu</surname>  <given-names>W-B</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>J-B</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>dePamphilis</surname>  <given-names>CW</given-names></string-name>, <string-name><surname>Yi</surname>  <given-names>T-S</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>D-Z</given-names></string-name></person-group>. <article-title>GetOrganelle: a fast and versatile toolkit for accurate de novo assembly of organelle genomes</article-title>. <source>Genome Biol</source>. <year>2020</year>:<volume>21</volume>(<issue>1</issue>):<fpage>241</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-020-02154-5</pub-id>.<pub-id pub-id-type="pmid">32912315</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname>  <given-names>DM</given-names></string-name></person-group>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>:<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keilwagen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Hartung</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Paulini</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Twardziok</surname>  <given-names>SO</given-names></string-name>, <string-name><surname>Grau</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Combining RNA-seq data and homology-based gene prediction for plants, animals and fungi</article-title>. <source>BMC Bioinformatics</source>  <year>2018</year>:<volume>19</volume>(<issue>1</issue>):<fpage>189</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-018-2203-5</pub-id>.<pub-id pub-id-type="pmid">29843602</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keilwagen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Wenk</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Erickson</surname>  <given-names>JL</given-names></string-name>, <string-name><surname>Schattat</surname>  <given-names>MH</given-names></string-name>, <string-name><surname>Grau</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Hartung</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Using intron position conservation for homology-based gene prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>:<volume>44</volume>(<issue>9</issue>):<fpage>e89</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw092</pub-id>.<pub-id pub-id-type="pmid">26893356</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knyshov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Gordon</surname>  <given-names>ERL</given-names></string-name>, <string-name><surname>Weirauch</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>New alignment-based sequence extraction software (ALiBaSeq) and its utility for deep level phylogenetics</article-title>. <source>PeerJ</source>  <year>2021</year>:<volume>9</volume>:<fpage>e11019</fpage>. <pub-id pub-id-type="doi">10.7717/peerj.11019</pub-id>.<pub-id pub-id-type="pmid">33850647</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kück</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Longo</surname>  <given-names>GC</given-names></string-name></person-group>. <article-title>FASconCAT-G: extensive functions for multiple sequence alignment preparations concerning phylogenetic studies</article-title>. <source>Frontiers Zool</source>. <year>2014</year>:<volume>11</volume>(<issue>1</issue>):<fpage>81</fpage>. <pub-id pub-id-type="doi">10.1186/s12983-014-0081-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname>  <given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname>  <given-names>MW</given-names></string-name></person-group>. <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>  <year>2017</year>:<volume>12</volume>(<issue>5</issue>):<fpage>e0177459</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>.<pub-id pub-id-type="pmid">28494014</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sugawara</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Shumway</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>:<volume>39</volume>(<issue>Database</issue>):<fpage>D19</fpage>–<lpage>D21</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemmon</surname>  <given-names>EM</given-names></string-name>, <string-name><surname>Lemmon</surname>  <given-names>AR</given-names></string-name></person-group>. <article-title>High-throughput genomic data in systematics and phylogenetics</article-title>. <source>Annu Rev Ecol Evol Syst</source>. <year>2013</year>:<volume>44</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135822</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>B-B</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>B-B</given-names></string-name>, <string-name><surname>Ma</surname>  <given-names>Z-Y</given-names></string-name>, <string-name><surname>Ren</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Hodel</surname>  <given-names>RGJ</given-names></string-name></person-group><etal>et al</etal>  <year>2021</year>. <article-title>Capturing single-copy nuclear genes, organellar genomes, and nuclear ribosomal DNA from deep genome skimming data for plant phylogenetics: a case study in Vitaceae</article-title>. <source>Appl Plant Sci</source>. <volume>11</volume>(<issue>4</issue>):<fpage>e11537</fpage>. <pub-id pub-id-type="doi">10.1111/jse.12806</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lozano-Fernandez</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>A practical guide to design and assess a phylogenomic study</article-title>. <source>Genome Biol Evol</source>. <year>2022</year>:<volume>14</volume>(<issue>9</issue>):<fpage>evac129</fpage>. <pub-id pub-id-type="doi">10.1093/gbe/evac129</pub-id>.<pub-id pub-id-type="pmid">35946263</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Berkeley</surname>  <given-names>MR</given-names></string-name>, <string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Simão</surname>  <given-names>FA</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>. <source>Mol Biol Evol</source>. <year>2021</year>:<volume>38</volume>(<issue>10</issue>):<fpage>4647</fpage>–<lpage>4654</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id>.<pub-id pub-id-type="pmid">34320186</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martín-Durán</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Vellutini</surname>  <given-names>BC</given-names></string-name>, <string-name><surname>Marlétaz</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Cetrangolo</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Cvetesic</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Thiel</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Henriet</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Grau-Bové</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Carrillo-Baltodano</surname>  <given-names>AM</given-names></string-name>, <string-name><surname>Gu</surname>  <given-names>W</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Conservative route to genome compaction in a miniature annelid</article-title>. <source>Nat Ecol Evol</source>. <year>2021</year>:<volume>5</volume>(<issue>2</issue>):<fpage>231</fpage>–<lpage>242</lpage>. <pub-id pub-id-type="doi">10.1038/s41559-020-01327-6</pub-id>.<pub-id pub-id-type="pmid">33199869</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCormack</surname>  <given-names>JE</given-names></string-name>, <string-name><surname>Hird</surname>  <given-names>SM</given-names></string-name>, <string-name><surname>Zellmer</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Carstens</surname>  <given-names>BC</given-names></string-name>, <string-name><surname>Brumfield</surname>  <given-names>RT</given-names></string-name></person-group>. <article-title>Applications of next-generation sequencing to phylogeography and phylogenetics</article-title>. <source>Mol Phylogenet Evol</source>. <year>2013</year>:<volume>66</volume>(<issue>2</issue>):<fpage>526</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1016/j.ympev.2011.12.007</pub-id>.<pub-id pub-id-type="pmid">22197804</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname>  <given-names>D</given-names></string-name></person-group>. <year>2014</year>. <article-title>Docker: lightweight linux containers for consistent development and deployment</article-title>. <source>Linux J</source>. <volume>239</volume>(<issue>2</issue>):<fpage>2</fpage>. <pub-id pub-id-type="doi">10.5555/2600239.2600241</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Schmidt</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Chernomor</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Woodhams</surname>  <given-names>MD</given-names></string-name>, <string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nurk</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bankevich</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Antipov</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Gurevich</surname>  <given-names>AA</given-names></string-name>, <string-name><surname>Korobeynikov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lapidus</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Prjibelski</surname>  <given-names>AD</given-names></string-name>, <string-name><surname>Pyshkin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Sirotkin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Sirotkin</surname>  <given-names>Y</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Assembling single-cell genomes and mini-metagenomes from chimeric MDA products</article-title>. <source>J Comput Biol</source>. <year>2013</year>:<volume>20</volume>(<issue>10</issue>):<fpage>714</fpage>–<lpage>737</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2013.0084</pub-id>.<pub-id pub-id-type="pmid">24093227</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Roure</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name></person-group><etal>et al</etal>  <year>2017</year>. <article-title>Pitfalls in supermatrix phylogenomics</article-title>. <source>Eur J Taxon</source>. <volume>283</volume>:<fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.5852/ejt.2017.283</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJP</given-names></string-name>, <string-name><surname>Cambon</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>MACSE v2: toolkit for the alignment of coding sequences accounting for frameshifts and stop codons</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>10</issue>):<fpage>2582</fpage>–<lpage>2584</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msy159</pub-id>.<pub-id pub-id-type="pmid">30165589</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raxworthy</surname>  <given-names>CJ</given-names></string-name>, <string-name><surname>Smith</surname>  <given-names>BT</given-names></string-name></person-group>. <article-title>Mining museums for historical DNA: advances and challenges in museomics</article-title>. <source>Trends Ecol Evol</source>. <year>2021</year>:<volume>36</volume>(<issue>11</issue>):<fpage>1049</fpage>–<lpage>1060</lpage>. <pub-id pub-id-type="doi">10.1016/j.tree.2021.07.009</pub-id>.<pub-id pub-id-type="pmid">34456066</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhie</surname>  <given-names>A</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Fedrigo</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Damas</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Koren</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Uliano-Silva</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Chow</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Fungtammasan</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Towards complete and error-free genome assemblies of all vertebrate species</article-title>. <source>Nature</source>  <year>2021</year>:<volume>592</volume>(<issue>7856</issue>):<fpage>737</fpage>–<lpage>746</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03451-0</pub-id>.<pub-id pub-id-type="pmid">33911273</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richter</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Schwarz</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Hering</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Böggemann</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>The utility of genome skimming for phylogenomic analyses as demonstrated for glycerid relationships (Annelida, Glyceridae)</article-title>. <source>Genome Biol Evol</source>. <year>2015</year>:<volume>7</volume>(<issue>12</issue>):<fpage>3443</fpage>–<lpage>3462</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evv224</pub-id>.<pub-id pub-id-type="pmid">26590213</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogozin</surname>  <given-names>IB</given-names></string-name>, <string-name><surname>Sverdlov</surname>  <given-names>AV</given-names></string-name>, <string-name><surname>Babenko</surname>  <given-names>VN</given-names></string-name>, <string-name><surname>Koonin</surname>  <given-names>EV</given-names></string-name></person-group>. <article-title>Analysis of evolution of exon-intron structure of eukaryotic genes</article-title>. <source>Brief Bioinformatics</source>  <year>2005</year>:<volume>6</volume>(<issue>2</issue>):<fpage>118</fpage>–<lpage>134</lpage>. <pub-id pub-id-type="doi">10.1093/bib/6.2.118</pub-id>.<pub-id pub-id-type="pmid">15975222</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sahbou</surname>  <given-names>A-E</given-names></string-name>, <string-name><surname>Iraqi</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Mentag</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Khayi</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>BuscoPhylo: a webserver for Busco-based phylogenomic analysis for non-specialists</article-title>. <source>Sci Rep</source>. <year>2022</year>:<volume>12</volume>(<issue>1</issue>):<fpage>17352</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-022-22461-0</pub-id>.<pub-id pub-id-type="pmid">36253435</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salzberg</surname>  <given-names>SL</given-names></string-name></person-group>. <article-title>Next-generation genome annotation: we still struggle to get it right</article-title>. <source>Genome Biol</source>. <year>2019</year>:<volume>20</volume>(<issue>1</issue>):<fpage>92</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1715-2</pub-id>.<pub-id pub-id-type="pmid">31097009</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salzberg</surname>  <given-names>SL</given-names></string-name>, <string-name><surname>Phillippy</surname>  <given-names>AM</given-names></string-name>, <string-name><surname>Zimin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Puiu</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Magoc</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Koren</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Treangen</surname>  <given-names>TJ</given-names></string-name>, <string-name><surname>Schatz</surname>  <given-names>MC</given-names></string-name>, <string-name><surname>Delcher</surname>  <given-names>AL</given-names></string-name>, <string-name><surname>Roberts</surname>  <given-names>M</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>GAGE: a critical evaluation of genome assemblies and assembly algorithms</article-title>. <source>Genome Res</source>. <year>2012</year>:<volume>22</volume>(<issue>3</issue>):<fpage>557</fpage>–<lpage>567</lpage>. <pub-id pub-id-type="doi">10.1101/gr.131383.111</pub-id>.<pub-id pub-id-type="pmid">22147368</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO: assessing genome assembly and annotation completeness</article-title>. <source>Methods Mol Biol</source>. <year>2019</year>:<volume>1962</volume>:<fpage>227</fpage>–<lpage>245</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-4939-9173-0_14</pub-id>.<pub-id pub-id-type="pmid">31020564</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simmons</surname>  <given-names>SK</given-names></string-name>, <string-name><surname>Lithwick-Yanai</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Adiconis</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Oberstrass</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Iremadze</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Geiger-Schuller</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Thakore</surname>  <given-names>PI</given-names></string-name>, <string-name><surname>Frangieh</surname>  <given-names>CJ</given-names></string-name>, <string-name><surname>Barad</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Almogy</surname>  <given-names>G</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Mostly natural sequencing-by-synthesis for scRNA-seq using Ultima sequencing</article-title>. <source>Nat Biotechnol</source>. <year>2023</year>:<volume>41</volume>(<issue>2</issue>):<fpage>204</fpage>–<lpage>211</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01452-6</pub-id>.<pub-id pub-id-type="pmid">36109685</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Slater</surname>  <given-names>GSC</given-names></string-name>, <string-name><surname>Birney</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>Automated generation of heuristics for biological sequence comparison</article-title>. <source>BMC Bioinformatics</source>  <year>2005</year>:<volume>6</volume>(<issue>1</issue>):<fpage>31</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-6-31</pub-id>.<pub-id pub-id-type="pmid">15713233</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stark</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Grzelak</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Hadfield</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>RNA sequencing: the teenage years</article-title>. <source>Nat Rev Genet</source>. <year>2019</year>:<volume>20</volume>(<issue>11</issue>):<fpage>631</fpage>–<lpage>656</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-019-0150-2</pub-id>.<pub-id pub-id-type="pmid">31341269</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steenwyk</surname>  <given-names>JL</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Shen</surname>  <given-names>XX</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Incongruence in the phylogenomics era</article-title>. <source>Nat Rev Genet</source>. <year>2023</year>:<volume>24</volume>(<issue>12):</issue><fpage>834</fpage>–<lpage>850</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-023-00620-x</pub-id>.<pub-id pub-id-type="pmid">37369847</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waterhouse</surname>  <given-names>RM</given-names></string-name>, <string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Simão</surname>  <given-names>FA</given-names></string-name>, <string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ioannidis</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Klioutchnikov</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Kriventseva</surname>  <given-names>EV</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO applications from quality assessments to gene prediction and phylogenomics</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>3</issue>):<fpage>543</fpage>–<lpage>548</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msx319</pub-id>.<pub-id pub-id-type="pmid">29220515</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whelan</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Irisarri</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Burki</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>PREQUAL: detecting non-homologous characters in sets of unaligned homologous sequences</article-title>. <source>Bioinformatics</source>  <year>2018</year>:<volume>34</volume>(<issue>22</issue>):<fpage>3929</fpage>–<lpage>3930</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty448</pub-id>.<pub-id pub-id-type="pmid">29868763</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Ding</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>C-D</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Orr</surname>  <given-names>MC</given-names></string-name>, <string-name><surname>Scheu</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Luan</surname>  <given-names>Y-X</given-names></string-name></person-group>. <article-title>Phylogenomics from low-coverage whole-genome sequencing</article-title>. <source>Methods Ecol Evol</source>. <year>2019</year>:<volume>10</volume>(<issue>4</issue>):<fpage>507</fpage>–<lpage>517</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13145</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">gbe</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1759-6653</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10735302</article-id>
    <article-id pub-id-type="pmid">38085033</article-id>
    <article-id pub-id-type="doi">10.1093/gbe/evad227</article-id>
    <article-id pub-id-type="publisher-id">evad227</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Patchwork: Alignment-Based Retrieval and Concatenation of Phylogenetic Markers from Genomic Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Thalén</surname>
          <given-names>Felix</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
        <aff><institution>Cardio-CARE AG, Medizincampus Davos</institution>, <addr-line>Davos Wolfgang 7265</addr-line>, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Köhne</surname>
          <given-names>Clara G</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7295-6616</contrib-id>
        <name>
          <surname>Bleidorn</surname>
          <given-names>Christoph</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
        <xref rid="evad227-cor1" ref-type="corresp"/>
        <!--christoph.bleidorn@biologie.uni-goettingen.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lavrov</surname>
          <given-names>Dennis</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="evad227-cor1">Corresponding author: E-mail: <email>christoph.bleidorn@biologie.uni-goettingen.de</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-12">
      <day>12</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>evad227</elocation-id>
    <history>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="evad227.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Low-coverage whole-genome sequencing (also known as “genome skimming”) is becoming an increasingly affordable approach to large-scale phylogenetic analyses. While already routinely used to recover organellar genomes, genome skimming is rather rarely utilized for recovering single-copy nuclear markers. One reason might be that only few tools exist to work with this data type within a phylogenomic context, especially to deal with fragmented genome assemblies. We here present a new software tool called Patchwork for mining phylogenetic markers from highly fragmented short-read assemblies as well as directly from sequence reads. Patchwork is an alignment-based tool that utilizes the sequence aligner DIAMOND and is written in the programming language Julia. Homologous regions are obtained via a sequence similarity search, followed by a “hit stitching” phase, in which adjacent or overlapping regions are merged into a single unit. The novel sliding window algorithm trims away any noncoding regions from the resulting sequence. We demonstrate the utility of Patchwork by recovering near-universal single-copy orthologs within a benchmarking study, and we additionally assess the performance of Patchwork in comparison with other programs. We find that Patchwork allows for accurate retrieval of (putatively) single-copy genes from genome skimming data sets at different sequencing depths with high computational speed, outperforming existing software targeting similar tasks. Patchwork is released under the GNU General Public License version 3. Installation instructions, additional documentation, and the source code itself are all available via GitHub at <ext-link xlink:href="https://github.com/fethalen/Patchwork" ext-link-type="uri">https://github.com/fethalen/Patchwork</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>genome skimming</kwd>
      <kwd>low-coverage sequencing</kwd>
      <kwd>museomics</kwd>
      <kwd>phylogenomics</kwd>
      <kwd>short reads</kwd>
      <kwd>single-copy genes</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Göttingen</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003385</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <boxed-text id="evad227-box1" position="float">
    <caption>
      <title>Significance</title>
    </caption>
    <p>Even though current sequencing and computational methods allow for the completion of high-quality genomes for all life on earth, the availability of material for sequencing became a major bottleneck in phylogenomic studies, especially since material stored in museum collections—or during barcoding campaigns—is often not suitable for reconstructing high-quality, highly continuous genomes. At the same time, the output of short-read sequencing machines is increasing, and prices for these techniques are dropping. Short-read data are still routinely used to recover organellar genomes, but this so-called genome skimming approach is rather rarely utilized for recovering single-copy nuclear markers. We present a new software tool called Patchwork for mining phylogenetic markers from highly fragmented genome assemblies, as well as directly from short sequence reads. We demonstrate the accuracy of this new approach and show in a benchmarking study that it also outperforms existing software for similar tasks. Patchwork allows to compile preselected gene sets from low-coverage short-read sequencing data sets and is thereby ideally suited when including material from museum collections into phylogenomic studies.</p>
  </boxed-text>
  <sec sec-type="intro" id="evad227-s0">
    <title>Introduction</title>
    <p>Advancements in high-throughput sequencing techniques have revolutionized the field of phylogenetics and ultimately our understanding of the tree of life (<xref rid="evad227-B30" ref-type="bibr">Lemmon and Lemmon 2013</xref>). The availability of genomic and transcriptomic data for basically all desired taxa and for a reasonable price has transformed the field to phylogenomics: genome-scale phylogenetic systematic analyses (<xref rid="evad227-B35" ref-type="bibr">McCormack et al. 2013</xref>). Some challenges remain, however, as many studies still show incongruent results, low branch support, or lacking resolution (<xref rid="evad227-B39" ref-type="bibr">Philippe et al. 2017</xref>; <xref rid="evad227-B52" ref-type="bibr">Steenwyk et al. 2023</xref>). Even though complete genomes are becoming available for more and more eukaryotes, the access to high-molecular-weight DNA is the bottleneck in the quest for sequencing genomes of all life on earth (<xref rid="evad227-B5" ref-type="bibr">Blom 2021</xref>; <xref rid="evad227-B10" ref-type="bibr">Dahn et al. 2022</xref>). Nowadays and in the past, most large-scale phylogenomic studies were conducted using either transcriptome sequencing or genome subsampling methods such as target enrichment, which focuses on a set of preselected loci (<xref rid="evad227-B4" ref-type="bibr">Bleidorn 2017</xref>).</p>
    <p>Transcriptome sequencing offers a way to sequence only the expressed portion of a genome without prior sequence knowledge (<xref rid="evad227-B51" ref-type="bibr">Stark et al. 2019</xref>). Unfortunately, this approach requires freshly collected material or specifically stored material, e.g. deeply flash frozen or in RNAlater. Furthermore, smaller specimens may need to be pooled together to attain sufficient amounts of mRNA, and such practice risks mixing up individuals with undetected genetic variation. Unfortunately, a large amount of collected specimens only exist in natural history museum collections, and most of these are ethanol preserved and thus not usable for transcriptomic studies (<xref rid="evad227-B8" ref-type="bibr">Call et al. 2021</xref>). As taxon sampling is considered one of the most important factors for accurate phylogenetic tree reconstruction (<xref rid="evad227-B19" ref-type="bibr">Heath et al. 2008</xref>), it would be missing an opportunity to leave the potential of natural history collections untapped. Target enrichment approaches, on the other hand, require prior knowledge of target sequences (e.g. from well-annotated genomes) for the construction of oligonucleotide probes. Moreover, the number of enriched targets is limited by the number of oligonucleotides included in the enrichment kit of choice, and the efficiency of such approaches decreases as the bait-to-target distance increases (<xref rid="evad227-B6" ref-type="bibr">Bragg et al. 2016</xref>). Another downside is that the data produced are difficult to reuse for other types of genomic or evolutionary studies.</p>
    <p>A viable alternative to assemble taxon-rich phylogenomic data sets is low-coverage whole-genome sequencing (LC-WGS; also known as “shallow genome sequencing” or “genome skimming”) using short-read technologies such as Illumina sequencing (<xref rid="evad227-B13" ref-type="bibr">Dodsworth 2015</xref>). Relying solely on this approach has been shown to be inadequate for the reconstruction of highly contiguous reference-quality genomes (<xref rid="evad227-B42" ref-type="bibr">Rhie et al. 2021</xref>). However, due to the introduction of newer sequencing platforms (e.g. Illumina's NovaSeq sequencing platform) short-read WGS became relatively cheap and prices are even expected to drop with Ultima Genomics, another highly competitive sequencing platform entering the market (<xref rid="evad227-B49" ref-type="bibr">Simmons et al. 2023</xref>). Moreover, short-read sequencing library construction also allows that highly fragmented DNA can be used as input (<xref rid="evad227-B21" ref-type="bibr">Hu et al. 2021</xref>), thereby enabling the use of material from museum collections from all around the world (<xref rid="evad227-B41" ref-type="bibr">Raxworthy and Smith 2021</xref>). Consequently, LC-WGS can be used to generate data from various sources of targeted organisms to retrieve marker loci on a genome scale. While this so-called “genome skimming” approach has frequently been used to reconstruct organellar genomes or other high-copy fractions of eukaryote genomes (<xref rid="evad227-B43" ref-type="bibr">Richter et al. 2015</xref>; <xref rid="evad227-B22" ref-type="bibr">Jin et al. 2020</xref>), it seems currently underutilized to retrieve single-copy nuclear markers (<xref rid="evad227-B31" ref-type="bibr">Liu et al. 2021</xref>). One reason is that short-read assemblies of eukaryotic genomes tend to be highly discontinuous, and automated annotation of such large, fragmented genomes remains difficult (<xref rid="evad227-B46" ref-type="bibr">Salzberg 2019</xref>), as they are characterized by the presence of “genes in pieces,” where introns interrupt coding sequences (<xref rid="evad227-B44" ref-type="bibr">Rogozin et al. 2005</xref>). Depending on the coverage, short-read draft genomes are characterized by low N50s in the range of few (if at all) kilobase pairs (kb; <xref rid="evad227-B47" ref-type="bibr">Salzberg et al. 2012</xref>), and consequently, exons of a single gene usually end up on several contigs.</p>
    <p>The disuse of genome skimming in large-scale phylogenetics could potentially be ascribed to the lack of suitable data analysis methods (<xref rid="evad227-B55" ref-type="bibr">Zhang et al. 2019</xref>). Existing software tools for working with LC-WGS data in a phylogenomic context, such as aTRAM 2 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>, <xref rid="evad227-B2" ref-type="bibr">2018</xref>), ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>), and GeMoMa (<xref rid="evad227-B25" ref-type="bibr">Keilwagen et al. 2016</xref>, <xref rid="evad227-B24" ref-type="bibr">2018</xref>), are either written in an interpreted language (e.g. Perl or Python) that does not allow the program to scale well with the large biological data sets that are commonplace today (e.g. aTRAM 2, ALiBaSeq) or need well-annotated reference genomes or transcriptomes (e.g. GeMoMa). A recent addition to the portfolio of available tools for such programs is Read2Tree, which directly infers trees from unassembled data (<xref rid="evad227-B14" ref-type="bibr">Dylus et al. 2023</xref>).</p>
    <p>To address the limitations typically associated when working with genome skimming data, we present Patchwork, an alignment-based tool for mining phylogenetic markers directly from WGS data. Patchwork utilizes the sequence aligner DIAMOND (<xref rid="evad227-B7" ref-type="bibr">Buchfink et al. 2021</xref>) and is written in the programming language Julia (<xref rid="evad227-B3" ref-type="bibr">Bezanson et al. 2017</xref>) to achieve the best possible speed, thus allowing Patchwork to scale well with today's genome-scale data sets. In addition, our implementation focuses on ease of use, and our program handles each step in the analysis—from start to finish. Using our new approach, we targeted universal single-copy orthologs (USCOs), which are available based on careful analysis of a curated database (OrthoDB, <ext-link xlink:href="https://www.orthodb.org" ext-link-type="uri">www.orthodb.org</ext-link>). A set of 954 metazoan-specific USCOs has been validated against 364 metazoan genomes and shown to be indeed (i) single-copy and (ii) nearly universally present (<xref rid="evad227-B33" ref-type="bibr">Manni et al. 2021</xref>).</p>
  </sec>
  <sec sec-type="results" id="evad227-s1">
    <title>Results</title>
    <p>Patchwork is a reference- and alignment-based method for mining phylogenetic markers from WGS data, using either assembled contigs or reads as input (<xref rid="evad227-F1" ref-type="fig">Fig. 1</xref>). The aim of Patchwork is to capture multiexon or fragmented genes, scattered across different contigs or reads. One or more reference protein sequences guide the “stitching” process, where the best-scoring translated query nucleotide sequences for any given region are merged into continuous stretches of amino acid sequences. Merged sequences go through a masking step in which unaligned residues, ambiguous amino acid characters (letters that do not determine a unique amino acid; they are B, J, X, or Z, where B = D or N, J = I or L, X = unknown, and Z = E or Q), and stop codons are removed from query sequences. Optionally, the removal of stop codons and ambiguous amino acid characters may be skipped by providing the --retain-stops and --retain-ambiguous flags, respectively. Finally, Patchwork implements a sliding window–based alignment trimming step to remove poorly aligned residues (e.g. due to the presence of putative noncoding regions) from the resulting sequences. The output is available as nucleotide or amino acid sequences.</p>
    <fig position="float" id="evad227-F1" fig-type="figure">
      <label>Fig. 1.</label>
      <caption>
        <p>Graphical overview of the Patchwork algorithm. First, a) query sequences are aligned to the provided reference sequence. These alignments may or may not be overlapping. b) Overlapping alignments are realigned but only in the area in which they overlap. The best-scoring alignment is retained while all others are discarded. c) Nonaligned residues are then removed, and d) the remaining regions are concatenated into a single, continuous sequence.</p>
      </caption>
      <graphic xlink:href="evad227f1" position="float"/>
    </fig>
    <sec id="evad227-s1.1">
      <title>Benchmark</title>
      <p>To asses performance of our approach, we (i) test an ideal case where the query and reference species are identical, (ii) where the query and reference are 2 distant species, and (iii) compare Patchwork v.0.5.1 with ALiBaSeq v.1.2 (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM v.2.4.3 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). Throughout these benchmarks, we use Illumina short-read nucleotide sequences from the marine annelid <italic toggle="yes">Dimorphilus gyrociliatus</italic> (accession PRJEB37657 in the European Nucleotide Archive). A highly contiguous (N50 = 2.24 Mb) and complete (95.8% BUSCO genes recovered, metazoa_odb10) annotated version of the compact 73.8-Mb genome of this annelid is publicly available (<xref rid="evad227-B34" ref-type="bibr">Martín-Durán et al. 2021</xref>).</p>
      <p>As we only used short-read data sets at different coverages for our benchmark analyses, we created highly discontinuous assemblies with low N50s as typical for real-world low-coverage genomic data sets. We assembled these sequence reads using SPAdes and subsequently used Patchwork to search for near-USCOs (<xref rid="evad227-B48" ref-type="bibr">Seppey et al. 2019</xref>), using a preannotated set of USCOs from that same species as a reference. Next, we used that same assembly of <italic toggle="yes">D. gyrociliatus</italic> to search for USCOs, this time using USCOs from the leech <italic toggle="yes">Helobdella robusta</italic> as the reference, a clitellate annelid that diverged at least 400 mya from <italic toggle="yes">D. gyrociliatus</italic> (<xref rid="evad227-B15" ref-type="bibr">Erséus et al. 2020</xref>). Finally, we compared our program to ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM 2 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). For this comparison, we also subsampled the aforementioned <italic toggle="yes">D. gyrociliatus</italic> short reads in order to simulate various sequencing coverages. We decided not to include the software GeMoMa (<xref rid="evad227-B25" ref-type="bibr">Keilwagen et al. 2016</xref>) in this comparison, as it heavily relies on the availability of reference genomic or transcriptomic data. Read2Tree (<xref rid="evad227-B14" ref-type="bibr">Dylus et al. 2023</xref>) has also not been included in the comparisons, as its focus is tree inference and not marker retrieval.</p>
      <p>We compared the retrieved translated and stitched contigs, hereafter called “recovered markers,” to the reference <italic toggle="yes">D. gyrociliatus</italic> USCOs. For each reference sequence, the evaluation included percent identical positions out of all aligned positions as well as percent of reference sequence positions covered by the recovered markers. Patchwork automatically generates these statistics and produces a detailed output for each reference as well as an aggregated output over all references.</p>
    </sec>
    <sec id="evad227-s1.2">
      <title>Effect of Genome Fragmentation on Accuracy</title>
      <p>In the initial setup, we assessed the accuracy of Patchwork using a high-quality query assembly and 815 USCO reference sequences from the same species, <italic toggle="yes">D. gyrociliatus</italic>, and thereby exploring the program's performance for the hypothetical case where the entire set of reference sequences should be recoverable as exactly matching stitched contigs from the query sequences. We retrieved all of the initial 815 markers. On average, 95.9% of all aligned positions were identical matches, with a mean query coverage of 92.2%; this equals a combined measure of 88.4% identical matches for all reference positions, whether aligned to query residues or not (<xref rid="evad227-F2" ref-type="fig">Fig. 2</xref> and <xref rid="evad227-T1" ref-type="table">Table 1</xref>).</p>
      <fig position="float" id="evad227-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Percent identity and query coverage in markers based on a Patchwork analysis of a SPAdes assembly of <italic toggle="yes">D. gyrociliatus</italic>, targeting 815 single-copy orthologs from the same species.</p>
        </caption>
        <graphic xlink:href="evad227f2" position="float"/>
      </fig>
      <table-wrap position="float" id="evad227-T1">
        <label>Table 1</label>
        <caption>
          <p>Results from Patchwork when using a <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as the query and USCOs from a long-read assembly of <italic toggle="yes">D. gyrociliatus</italic> as a reference</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Variable</th>
              <th align="center" rowspan="1" colspan="1">Mean</th>
              <th align="center" rowspan="1" colspan="1">Min</th>
              <th align="center" rowspan="1" colspan="1">Median</th>
              <th align="center" rowspan="1" colspan="1">Max</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference length</td>
              <td rowspan="1" colspan="1">447.606</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">351.0</td>
              <td rowspan="1" colspan="1">2,748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query length</td>
              <td rowspan="1" colspan="1">407.953</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">322.0</td>
              <td rowspan="1" colspan="1">2,553</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Matches</td>
              <td rowspan="1" colspan="1">385.075</td>
              <td rowspan="1" colspan="1">24</td>
              <td rowspan="1" colspan="1">306.0</td>
              <td rowspan="1" colspan="1">2,549</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mismatches</td>
              <td rowspan="1" colspan="1">21.207</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">1,075</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Deletions</td>
              <td rowspan="1" colspan="1">42.131</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">5.0</td>
              <td rowspan="1" colspan="1">1,097</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query coverage</td>
              <td rowspan="1" colspan="1">92.181</td>
              <td rowspan="1" colspan="1">5.22</td>
              <td rowspan="1" colspan="1">98.71</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identity</td>
              <td rowspan="1" colspan="1">95.887</td>
              <td rowspan="1" colspan="1">30.91</td>
              <td rowspan="1" colspan="1">100.0</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="evad227-s1.3">
      <title>Effect of Reference Divergence</title>
      <p>In the second iteration, we aligned a set of high-coverage query assemblies against a very distant reference set, in order to estimate the program's performance when using highly divergent sequences as reference. For this purpose, the same <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as in the previous evaluation served as query sequence set, and 957 near-USCOs from the annotated genome of the leech <italic toggle="yes">H. robusta</italic> were used as a reference. We retrieved 943 out of the 957 <italic toggle="yes">H. robusta</italic> reference sequences. Of these, 769 successfully aligned back to 1 and only 1 of the 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs that were considered homologous to the <italic toggle="yes">H. robusta</italic> set (<xref rid="evad227-F3" ref-type="fig">Fig. 3</xref> and <xref rid="evad227-T2" ref-type="table">Table 2</xref>). For these 769 retrieved markers, the average percent identity measure was 89%, with a mean query coverage of 74.5%. Put differently, the recovered markers had an average of 67.2% identical matches against all reference positions.</p>
      <fig position="float" id="evad227-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Percent identity and query coverage in markers based on a Patchwork analysis of a SPAdes assembly of <italic toggle="yes">D. gyrociliatus</italic>, targeting 957 single-copy orthologs from the leech <italic toggle="yes">H. robusta</italic>.</p>
        </caption>
        <graphic xlink:href="evad227f3" position="float"/>
      </fig>
      <table-wrap position="float" id="evad227-T2">
        <label>Table 2</label>
        <caption>
          <p>Results from Patchwork when using a <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as the query and USCOs from <italic toggle="yes">H. robusta</italic> as a reference</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Variable</th>
              <th align="center" rowspan="1" colspan="1">Mean</th>
              <th align="center" rowspan="1" colspan="1">Min</th>
              <th align="center" rowspan="1" colspan="1">Median</th>
              <th align="center" rowspan="1" colspan="1">Max</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference length</td>
              <td rowspan="1" colspan="1">448.025</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">351.0</td>
              <td rowspan="1" colspan="1">2.748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query length</td>
              <td rowspan="1" colspan="1">309.93</td>
              <td rowspan="1" colspan="1">31</td>
              <td rowspan="1" colspan="1">259.0</td>
              <td rowspan="1" colspan="1">2.326</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Matches</td>
              <td rowspan="1" colspan="1">249.126</td>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">195.0</td>
              <td rowspan="1" colspan="1">2.326</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mismatches</td>
              <td rowspan="1" colspan="1">30.234</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">7.0</td>
              <td rowspan="1" colspan="1">355</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">deletions</td>
              <td rowspan="1" colspan="1">8.319</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">2.0</td>
              <td rowspan="1" colspan="1">268</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query coverage</td>
              <td rowspan="1" colspan="1">74.540</td>
              <td rowspan="1" colspan="1">5.41</td>
              <td rowspan="1" colspan="1">82.78</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identity</td>
              <td rowspan="1" colspan="1">89.008</td>
              <td rowspan="1" colspan="1">25.46</td>
              <td rowspan="1" colspan="1">96.99</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The recovered markers were evaluated against the set of 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs that were considered homologous to sequences in the <italic toggle="yes">H. robusta</italic> reference set.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="evad227-s1.4">
      <title>Program Comparison</title>
      <p>In the third setup, we compared the performance and runtime for Patchwork to that of ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM 2 (<xref rid="evad227-B2" ref-type="bibr">Allen et al. 2018</xref>), using a <italic toggle="yes">D. gyrociliatus</italic> short-read data set at different sequence coverage levels (1×, 3×, 5×, 10×, 20×, and 40×). While Patchwork can use both reads and assembled contigs as an input, ALiBaSeq uses assembled contigs, and aTRAM 2 is read based. Performance was assessed using a combined measure for accuracy and completeness of the recovered USCO markers annotated, hereafter called “total percent identity.” Patchwork with <italic toggle="yes">D. gyrociliatus</italic> assembly data performs best over almost all data sets (<xref rid="evad227-F4" ref-type="fig">Fig. 4</xref>), reaching as much as 62% total percent identity for data with at least 10× coverage. Only with a coverage of 1×, <italic toggle="yes">D. gyrociliatus</italic> read-based data seem to be better suited for marker retrieval. Cutoff thresholds during the assembly might lead to discarding part of the sequence data that is retained when using reads, therefore causing the latter to achieve higher query coverage for the 1× data set. Note that query coverage improves especially for read data when tantan masking in DIAMOND is disabled (i.e. by providing --masking 0 as an argument). For data sets with higher coverage, running Patchwork on read data still achieves well over 50% total percent identity. Using read data therefore is a valid option that could be considered if the compute resources necessary for assembling the sequences are scarce. The performance of Patchwork stays approximately constant for data sets with coverages of at least 10×, independent of the used data. By comparison, ALiBaSeq achieves approximately 7% less total percent identity than Patchwork with assemblies for all data sets and performs only slightly better than Patchwork with read data for a coverage over 10×. aTRAM 2, on the other hand, performs comparatively poorly, with a maximum total percent identity of about 22% for the data set with 20× coverage. This is mostly due to the small number of recovered markers; the markers themselves generally have a high percent identity value. For a coverage of 1×, aTRAM 2 was unable to recover any stitched contigs at all. The program was also not evaluated for the data set of 40× coverage as it had not completed within the cluster's maximum runtime of 5 d.</p>
      <fig position="float" id="evad227-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Accuracy and completeness of the recovered marker sequences for the different <italic toggle="yes">D. gyrociliatus</italic> data sets when run against a reference set of <italic toggle="yes">H. robusta</italic> USCOs. Accuracy and completeness were jointly measured as percent identical out of all aligned positions multiplied with the total percentage of aligned nongap positions. This integrated measure avoids a distorted performance estimation, e.g. due to small number of recovered markers but high percent identity in the aligned positions. Patchwork was run with <italic toggle="yes">D. gyrociliatus</italic> assemblies unless indicated differently. ALiBaSeq received assemblies, while aTRAM 2 received reads as input.</p>
        </caption>
        <graphic xlink:href="evad227f4" position="float"/>
      </fig>
      <p>Both Patchwork and ALiBaSeq are very fast; the programs terminated in under 5 min when using assembly data (<xref rid="evad227-F5" ref-type="fig">Fig. 5</xref>). The runtimes fluctuated only slightly between data sets. Using Patchwork with reads required more time for larger data sets, but even for the largest evaluated data set, it finished after half an hour. By comparison, running aTRAM 2 took days for all data sets.</p>
      <fig position="float" id="evad227-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>Program runtime for each <italic toggle="yes">D. gyrociliatus</italic> data set. Patchwork was run both as a script and as a compiled program. It received <italic toggle="yes">D. gyrociliatus</italic> assemblies unless indicated differently. ALiBaSeq was run on assemblies, while aTRAM 2 received reads as input.</p>
        </caption>
        <graphic xlink:href="evad227f5" position="float"/>
      </fig>
    </sec>
    <sec id="evad227-s1.5">
      <title>Patchwork in a Phylogenomic Context</title>
      <p>To demonstrate how our software could be utilized in a phylogenomic pipeline, we used it to retrieve a set of 957 metazoan-specific USCOs from a phthirapteran data set (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). When reusing a set of 15 lice Operaional Taxonomic Units (Hexapoda and Phthiraptera), we were able to retrieve all 957 USCOs, for all taxa. The resulting alignments contained few gaps for any marker; i.e. most markers were well above the 90% aligned position trimming threshold. The trimmed alignment contained 3,454,320 positions in total, compared to 5,383,303 before trimming (i.e. ∼64% positions were retained after trimming). Our phylogenetic reconstruction resulted in a well-supported tree (<xref rid="evad227-F6" ref-type="fig">Fig. 6</xref>), which is largely congruent with the original analysis (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>), with the exception of the position of <italic toggle="yes">Haematopinus macronemis</italic>. However, this placement is the only part of the tree that is not well supported, and reasons for incongruence are unclear, which could be, e.g. slightly different choice of phylogenetic markers. However, in general, the approach worked very well, and for 951 of 954 USCOs, nearly complete exonic data could be retrieved.</p>
      <fig position="float" id="evad227-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>Phylogenetic analysis of Phthiraptera relationships as recovered from a Maximum Likelihood analysis of a combined supermatrix using USCOs as recovered by Patchwork. Analysis was conducted using IQ-TREE 2 including model and partition finding. Bootstrap values from 1,000 pseudoreplicates are given at the branches.</p>
        </caption>
        <graphic xlink:href="evad227f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="evad227-s2">
    <title>Discussion</title>
    <p>Patchwork is a new software for quickly mining phylogenetic markers from WGS data. Since Patchwork can retrieve homologous regions even in distantly related taxa, this program lends itself especially well for recovering phylogenetic markers for phylogenomic studies. It is simultaneously an efficient way for increasing marker occupancy in poorly assembled genomes and/or in the presence of multilocus exons. Finally, Patchwork allows the user to combine 2 different data types—i.e. transcriptomic and genomic data—into a single data set, thus further enabling an even larger taxon sampling and encouraging data reusability.</p>
    <p>Special consideration should be taken to avoid the creation of chimeric sequences. One way in which such sequences may arise is when orthologous (i.e. genes related via a speciation event) and paralogous (i.e. genes related via a gene duplication event) sequences are merged together. To circumvent this issue, we recommend that the user limits the use of reference sequences to near-USCOs. Different lineage-specific sets of such USCOs are available based on carefully analyzed sets of homologous genes from a curated database (<xref rid="evad227-B33" ref-type="bibr">Manni et al. 2021</xref>). Besides their use in evaluating the quality of genomic and metagenomic data, USCOs became also prominent as preselected marker sets in phylogenomic analyses (<xref rid="evad227-B45" ref-type="bibr">Sahbou et al. 2022</xref>) and have been recently proposed as a unifying framework for DNA-based species delimitation (<xref rid="evad227-B12" ref-type="bibr">Dietz et al. 2023</xref>). Many programs, e.g. the aforementioned program BUSCO, exist for retrieving such sequences from an already assembled genome, and these could be used as reference sequences (<xref rid="evad227-B53" ref-type="bibr">Waterhouse et al. 2018</xref>). Additionally, several downstream analysis tools are available to control for the presence of possible cross-contamination, (unexpected) paralogous copies, or other artifacts confounding systematic studies (<xref rid="evad227-B32" ref-type="bibr">Lozano-Fernandez 2022</xref>). To control for the possible artifactual inclusion of stretches of noncoding sequences, the tool PREQUAL could be used to detect such and remove such regions (<xref rid="evad227-B54" ref-type="bibr">Whelan et al. 2018</xref>). Finally, multiple alignment tools such as MACSE (<xref rid="evad227-B40" ref-type="bibr">Ranwez et al. 2018</xref>) can be used to deal with putative confounding problems from the occurrence of premature stop codons, which might occur when working with data with coverage genomic data.</p>
    <p>The accuracy and the robustness of the results depends on how closely related the target and the reference species under study are. The difficulty stems from the ability to accurately predict noncoding regions in aligned contigs; because alignment trimming relies on gap-excluded identity, choosing the correct cutoff threshold becomes increasingly easier as the level of identity approaches 100% (the identity of noncoding regions is likely to stay the same, while the identity to coding regions increases). On the upside, high-quality genomes for practically all major lineages exist and are readily available online (<xref rid="evad227-B16" ref-type="bibr">Formenti et al. 2022</xref>). Moreover, and not surprisingly, the coverage of the input read data sets correlates with the performance of retrieving single-copy marker genes. Similar to a previous study (<xref rid="evad227-B31" ref-type="bibr">Liu et al. 2021</xref>), we also find that a coverage of 10× and more should be targeted when designing genome skimming studies. However, as seen in the proof of principle, even lower coverages enable the construction of phylogenomic data matrices. For very low-coverage data sets, the read-based mode outperforms assembly-based analyses. For the latter, assembly size seems to be more important than contiguity.</p>
    <p>In summary, Patchwork allows the retrieval of (putatively) single-copy genes from genome skimming data sets at different sequencing coverage with high computational speed. Availability and quality of biological specimens are becoming the major bottleneck for phylogenomic studies. Especially for phylogenomic studies relying on collection-based material, Patchwork offers a fast and efficient way for marker retrieval from short-read sequence data sets.</p>
  </sec>
  <sec sec-type="materials|methods" id="evad227-s3">
    <title>Materials and Methods</title>
    <p>Patchwork is implemented in Julia (<xref rid="evad227-B3" ref-type="bibr">Bezanson et al. 2017</xref>), a just-in-time (JIT)–compiled programming language that is typically faster than interpreted languages such as Python or R. Existing Julia bioinformatics packages such as BioAlignments.jl (<ext-link xlink:href="https://github.com/BioJulia/BioAlignments.jl" ext-link-type="uri">https://github.com/BioJulia/BioAlignments.jl</ext-link>) and BioSequences.jl (<ext-link xlink:href="https://github.com/BioJulia/BioSequences.jl" ext-link-type="uri">https://github.com/BioJulia/BioSequences.jl</ext-link>) were used to speed up the development process. Patchwork is obtainable from GitHub (<ext-link xlink:href="https://github.com/fethalen/Patchwork" ext-link-type="uri">https://github.com/fethalen/Patchwork</ext-link>), is distributed under the GPLv3 license, and targets both Linux and macOS (Windows users may run Patchwork by using the Windows Subsystem for Linux).</p>
    <p>In order to facilitate reproducibility, a Docker container (<xref rid="evad227-B36" ref-type="bibr">Merkel 2014</xref>) of Patchwork is also distributed via the BioContainers framework (<xref rid="evad227-B11" ref-type="bibr">da Veiga Leprevost et al. 2017</xref>). Similarly, we also provide an Apptainer definition file for users of the Apptainer/Singularity platform. Apptainer (formerly known as Singularity; <xref rid="evad227-B28" ref-type="bibr">Kurtzer et al. 2017</xref>) is another container platform that targets shared systems such as High-Performance Computing platforms, which are commonplace at universities today.</p>
    <p>Most phylogenomic studies include more than a handful of taxa, and concatenating these manually gets increasingly tedious as the data set size increases. Therefore, Patchwork also includes a set of complementary tools for streamlining the downstream analysis. For example, the script multi_patchwork.sh lets the user run Patchwork on multiple input files and concatenate homologous sequences from different taxa into 1 file.</p>
    <sec id="evad227-s3.1">
      <title>Initial Alignment and Database Construction</title>
      <p>First, all reference protein sequences, regardless of whether they are spread across multiple FASTA files or not, are pooled together into a single FASTA file, from which a DIAMOND database is created. There is also the option to use an existing DIAMOND-formatted database or a BLAST output file in a tabular format by using the --database or --tabular options, respectively. These files are both provided in the output of Patchwork and can thus be reutilized when trying out different parameters. In either case, DIAMOND's BLASTX algorithm is used to align translated nucleotide sequences to 1 or more reference protein sequences.</p>
      <p>Like DIAMOND, Patchwork, by default, scores alignments using the substitution matrix BLOSUM62 (<xref rid="evad227-B20" ref-type="bibr">Henikoff and Henikoff 1996</xref>), a gap open penalty of 11, and a gap extension penalty of 1. Other built-in or custom substitution matrices may be used in place of the default option. User-chosen gap open penalties and gap extension penalties may also be set, as long as they fall within the limits set by the substitution matrix of choice. For the users’ convenience, Patchwork supports a number of different DIAMOND options that can usually be provided in the same manner as in DIAMOND itself.</p>
      <p>For all Patchwork benchmarks, we observed that disabling DIAMOND's tantan masking (<xref rid="evad227-B17" ref-type="bibr">Frith 2011</xref>), by setting --masking 0, as described in <xref rid="evad227-T2" ref-type="table">Table 2</xref>, yielded higher query coverages. This effect was more pronounced for read data sets but could also be detected in assembled data sets. On the other hand, the number of exact matches in all aligned positions (i.e. percent identity) between the query and the reference decreased slightly. When combining both measures, however, disabling tantan masking improved the overall results.</p>
      <p>Since the alignment search is likely to result in more than 1 hit per reference region, certain measures are taken to ensure that none of these hits are overlapping: They are, “hit stitching” (also known as contig or exon stitching; i.e. merging of overlapping regions), removal of unaligned residues, and concatenation of nonoverlapping regions.</p>
    </sec>
    <sec id="evad227-s3.2">
      <title>Hit Stitching</title>
      <p>During “hit stitching,” all alignments made between the query region and the target sequence are merged in a way such that only the highest-scoring segment pair (HSP) for each region is retained. This results in a single, continuous sequence, and, as a consequence, some hits may be removed entirely (see also <xref rid="evad227-F1" ref-type="fig">Fig. 1</xref>).</p>
      <p>The “hit stitching” algorithm works as follows: First, query regions are sorted according to how they align to the target sequence—from first to last—and are added to the stack. Next, each pair of query regions on the stack is checked for overlaps. In case of an overlap, first, all regions are sorted by their first and last position at which they align to the reference sequence. The first region is added to the stack. Its start and end coordinates are then compared with those of the following region to check if they are overlapping. If they are not overlapping, the next adjacent region is added to the stack and compared with the following region. If they are overlapping, however, the region that is currently at the top of the stack is removed. The overlapping parts of this region and the next region are realigned to identify the best-scoring sequence at that particular interval. Then, based on the realignment score, the sequences are sliced such that the best-scoring sequence is retained at the overlapping region and so that the nonoverlapping, flanking parts of both regions, if existing, are preserved as well. Thus, a maximum of 3 sliced region parts are then added to the stack as new, separate regions: The sequence part preceding the overlap, which originates from the first region, the highest-scoring sequence at the overlap, which may be from either of the 2, and the sequence part that follows the overlap, which originates from the second region. The algorithm then continues in the same manner, comparing the topmost region of the stack with the following region, until all overlaps are removed and all regions have been added to the stack. This procedure may require multiple iterations, since in every run, only each pair of consecutive regions are compared and merged.</p>
      <p>Different aligned regions from the same contig are allowed to be stitched together. While “hit stitching” may result in the creation of chimeric sequences (i.e. 2 or more biological sequences incorrectly joined together), this procedure has the potential to increase coverage and to (correctly) join 2 or more regions that are located on separate contigs due to incomplete assembly or sequencing errors.</p>
    </sec>
    <sec id="evad227-s3.3">
      <title>Alignment Masking</title>
      <p>At this step, unaligned residues, ambiguous amino acid characters, and stop codons (also known as “termination codons”) are all removed from the resulting query sequence. Query sequences may contain residues that do not align to any particular region of the subject sequence. Such regions may be noncoding regions or simply insertions. In either case, unaligned residues are removed on the basis that inserts are less likely to constitute phylogenetically informative sites and risks introducing untranslated regions and therefore biasing the downstream analysis. Similarly, ambiguous amino acids are most likely noninformative, and stop codons are a clear indicator that noncoding characters have been included in the alignment. Although such regions are likely to be removed in the subsequent step (see above), the user may choose to keep stop codons and/or ambiguous amino acid characters by providing the flags --retain-stops and/or --retain-ambiguous.</p>
    </sec>
    <sec id="evad227-s3.4">
      <title>Sliding Window–Based Alignment Trimming</title>
      <p>One side effect of aligning translated nucleotide sequences to amino acid sequences is that one might recover noncoding portions of DNA, provided that the following 2 conditions are fulfilled: (i) the noncoding DNA is located in between 2 or more coding portions and (ii) there is a sequence region in the reference sequence that the noncoding region can align to. In the resulting alignment, noncoding portions are characterized by many indels, intercepted by occasional matches. The alignment of noncoding portions of DNA can already be observed in the alignments produced by DIAMOND, and thus, this side effect does not stem from Patchwork itself. In fact, the Patchwork algorithm will only include noncoding parts if nothing else aligns better to the affected region of the reference sequence.</p>
      <p>To mitigate this effect, we have implemented a sliding window–based alignment trimming approach to rid the alignments from these unwanted regions. This works by scanning the alignment from left to right, cutting all regions where the average distance between query and reference is above the user-provided distance threshold. The window size and the distance threshold can both be set by the user, but need not be, since we implemented default values for both. This step can also be skipped over in its entirety. This approach tries to avoid cases where a single bad, but correct, match would have otherwise been cut out.</p>
    </sec>
    <sec id="evad227-s3.5">
      <title>Concatenation and Realignment of Remaining Regions</title>
      <p>Finally, the resulting set of ordered, nonoverlapping sequence regions are concatenated into 1 continuous sequence. The concatenated sequence is then realigned to the reference to obtain the final output sequence and alignment score.</p>
    </sec>
    <sec id="evad227-s3.6">
      <title>Benchmark</title>
      <p>Patchwork v.0.5.1 was continuously run using Julia v.1.8.2 and DIAMOND v.2.0.13 (<xref rid="evad227-B7" ref-type="bibr">Buchfink et al. 2021</xref>), with the options --ultra-sensitive --frameshift 15 --masking 0. All analyses were performed on the high-performance computing cluster maintained by the <italic toggle="yes">Gesellschaft für wissenschaftliche Datenverarbeitung mbH Göttingen</italic> (GWDG), running the Scientific Linux release 7.9 (Nitrogen) operating system with a Linux kernel of version 3.10.0. All runs were allocated 32 Intel Xeon Platinum 9242 CPUs running at 2.30 GHz. Elapsed time was calculated as reported by Slurm.</p>
    </sec>
    <sec id="evad227-s3.7">
      <title>Effect of Genome Fragmentation on Accuracy</title>
      <p>A publicly available set of Illumina short-read sequences of <italic toggle="yes">D. gyrociliatus</italic> (<xref rid="evad227-B34" ref-type="bibr">Martín-Durán et al. 2021</xref>) was used for the query set. We used SPAdes v.3.15.3 to generate the de novo assembly, using a <italic toggle="yes">K</italic>-mer size of 55. A set of 815 <italic toggle="yes">D. gyrociliatus</italic> USCOs retrieved from the published high-quality genome assembly (GenBank, accession: <ext-link xlink:href="GCA_904063045.1" ext-link-type="DDBJ/EMBL/GenBank">GCA_904063045.1</ext-link>) served as the reference.</p>
    </sec>
    <sec id="evad227-s3.8">
      <title>Effect of Reference Divergence</title>
      <p>We reused the de novo assembly from the previous evaluation for the query, while a set of 957 near-USCOs from the annotated genome of the leech <italic toggle="yes">H. robusta</italic> (GenBank, accession: <ext-link xlink:href="GCA_000326865.1" ext-link-type="DDBJ/EMBL/GenBank">GCA_000326865.1</ext-link>) were used as reference sequences. We used the same parameter settings described above. For this evaluation, we did not use Patchwork's own accuracy and completeness assessment, because the true number of identical matches and the amount of query coverage are not known between the 2 divergent species <italic toggle="yes">D. gyrociliatus</italic> and <italic toggle="yes">H. robusta</italic>. We therefore chose to compare the recovered markers to a subset of the <italic toggle="yes">D. gyrociliatus</italic> USCOs described in the previous benchmark. More specifically, only those <italic toggle="yes">D. gyrociliatus</italic> USCOs that produced a hit when searching against the <italic toggle="yes">H. robusta</italic> USCOs with DIAMOND v2.0.13 in ultrasensitive mode were used, since only these were considered “recoverable” in this setup. The resulting <italic toggle="yes">D. gyrociliatus</italic> USCO set contains 778 sequences; 37 sequences were discarded. The set of recovered markers was searched against the reference USCO set using DIAMOND in --ultra-sensitive mode. For each reference sequence, we retrieved only the marker that produced the highest bit score during the alignment step. We then evaluated percent identical positions out of all aligned positions as well as percent of reference sequence positions covered by the recovered markers.</p>
    </sec>
    <sec id="evad227-s3.9">
      <title>Program Comparison</title>
      <p>In order to generate data sets at different sequencing coverages, we subsampled the trimmed <italic toggle="yes">D. gyrociliatus</italic> reads downloaded from NCBI GenBank. Corresponding read pairs were selected randomly from the paired-end data. Subsampling was done using Subsample.jl, a Julia package distributed together with Patchwork. The resulting data sets have coverages of 1×, 3×, 5×, 10×, 20×, and 40×.</p>
      <p>For each of the data sets, we produced a short-read-only de novo assembly, as ALiBaSeq is designed for assembly data, while aTRAM 2 requires read data and Patchwork can process both. We used the assembler SPAdes v.3.15.3 (<xref rid="evad227-B38" ref-type="bibr">Nurk et al. 2013</xref>), with a <italic toggle="yes">K</italic>-mer size of 33, and the quality of the assembly was assessed using QUAST v.5.0.2 (<xref rid="evad227-B18" ref-type="bibr">Gurevich et al. 2013</xref>). We aligned the <italic toggle="yes">D. gyrociliatus</italic> reads and assemblies against the same set of <italic toggle="yes">H. robusta</italic> USCOs mentioned before.</p>
      <p>ALiBaSeq v.1.2 was run with the <italic toggle="yes">D. gyrociliatus</italic> assemblies described above. The program requires BLAST; the version here used was 2.11.0. The program builds a database from the <italic toggle="yes">D. gyrociliatus</italic> sequences and searches this database with the <italic toggle="yes">H. robusta</italic> sequences before stitching the hits together. We set the parameters according to the guide for a protein-based search without reciprocal search, as explained in their documentation on GitHub (see the README file): -x a [extract all hits and join into (super)contigs] -f S [single alignment table (TBLASTN result file)] -e 1e-10 [<italic toggle="yes">e</italic>-value cutoff for further processing of TBLASTN hits] -c 1 [extract single best (super)contig] --amalgamate-hits [scoring scheme for (super)contigs] --is [enable contig stitching] –ac aa-tdna [search protein “baits” (<italic toggle="yes">H. robusta</italic> USCOs) against tDNA “target” database (<italic toggle="yes">D. gyrociliatus</italic> reads)].</p>
      <p>We ran aTRAM v.2.4.3 with the sampled <italic toggle="yes">D. gyrociliatus</italic> read data sets. The program further requires BLAST, as well as a de novo assembler, and exonerate. We used BLAST v.2.11.0 and exonerate v.2.2.0 (<xref rid="evad227-B50" ref-type="bibr">Slater and Birney 2005</xref>) and employed SPAdes v.3.15.3 for the assembly step. The full aTRAM 2 pipeline consists of 3 consecutive steps: Firstly, the preparation of a database from the <italic toggle="yes">D. gyrociliatus</italic> reads, secondly, the assembly of different loci, and lastly, a reference-guided stitching process. The parameter settings for the core module of aTRAM 2 as well as the stitcher were as follows: --evalue 1e-10 --file-filter “*.filtered contigs.fasta” --overlap N.</p>
      <p>Patchwork v.0.5.1 was run with both the sampled <italic toggle="yes">D. gyrociliatus</italic> read data sets and the assemblies we produced for these sampled read data. We ran the uncompiled program using Julia v.1.8.2 as well as the compiled version on each data set in order to perform runtime comparisons. Patchwork achieves all its objectives in a 1-step procedure, i.e. can be called with a single command, unlike ALiBaSeq and aTRAM 2. The program builds a DIAMOND database from the <italic toggle="yes">H. robusta</italic> sequences and, after obtaining <italic toggle="yes">D. gyrociliatus</italic> hits, proceeds to stitch them together. All nondefault parameter settings for Patchwork were as described above. They were used for both read-based runs and assembly-based runs.</p>
      <p>We ran the 3 programs with their respective parameter settings on the different <italic toggle="yes">D. gyrociliatus</italic> data sets against the <italic toggle="yes">H. robusta</italic> USCO set described above, which contains 957 sequences. The aTRAM 2 run for the 40× coverage read data set was ended prematurely because it had not terminated after 5 d. In a following step, the recovered markers produced by each program for each data set were evaluated with respect to completeness and accuracy of the resulting sequences by comparing them to the same set of 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs mentioned above, again because only this subset could be recovered by the programs in this setup. ALiBaSeq and aTRAM 2 output DNA sequences that contain the ambiguous nucleotide N in all positions that could not be recovered during stitching. These N were removed for the subsequent evaluation steps because they distort the query coverage measure; the amount of a reference sequence covered by the recovered marker is artificially increased due to the uninformative inserted N.</p>
      <p>Completeness and accuracy were measured jointly as percent identical aligned positions multiplied with the total amount of aligned, or recovered, positions (here called <italic toggle="yes">p</italic><sub>identical, cov</sub>):</p>
      <disp-formula id="UM0001">
        <mml:math id="UM1" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>p</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">identical</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">cov</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">match</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">aligned</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>⋅</mml:mo>
            <mml:mrow>
              <mml:mi mathvariant="normal">cov</mml:mi>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0002">
        <mml:math id="UM2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="normal">cov</mml:mi>
          </mml:mrow>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">recovered</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">length</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">recovered</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">USCOs</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">length</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">USCOs</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p><italic toggle="yes">n</italic><sub>match</sub> being the total number of exact matches in all alignments between recovered markers and reference USCOs and <italic toggle="yes">n</italic><sub>aligned</sub> the total number of aligned, i.e. nongap, positions. The coverage cov was computed as the ratio of the total lengths of all recovered markers <italic toggle="yes">s</italic><sub>recovered</sub> and all reference USCOs <italic toggle="yes">s</italic><sub>USCOs</sub>. We chose to combine the measures for accuracy of the recovered markers, i.e. percent identical out of all aligned positions, and completeness or query coverage, i.e. percent recovered positions, in order to avoid a distorted outcome. For example, a program might recover only a very small number of markers but these with high percent identity, such that using only the percent identity measure would have resulted in an overestimation of the program's performance.</p>
    </sec>
    <sec id="evad227-s3.10">
      <title>Patchwork in a Phylogenomic Context</title>
      <p>We retrieved the raw reads from the NCBI Sequence Read Archive (SRA accession SRR5088465, SRR5088468, SRR5308129 SRR5308123, SRR5088469 SRR5088471, SRR5088472, SRR5088473, SRR1182279, SRR5308136, SRR5308138, SRR5088474, SRR5088475, SRR5308112, and SRR5088466) using prefetch, vdb-validate, and fasterq-dump (with the flag --split-spot), all from the NCBI SRA toolkit (<xref rid="evad227-B29" ref-type="bibr">Leinonen et al. 2011</xref>). We ran Patchwork v.0.5.1 with each of the specimens as query input and a set of 957 near-USCOs from the leech <italic toggle="yes">H. robusta</italic> as reference sequences (see <xref rid="evad227-T2" ref-type="table">Table 2</xref> for parameter settings). A multiple sequence alignment (MSA) was constructed for each of these 957 loci using MAFFT (<xref rid="evad227-B23" ref-type="bibr">Katoh and Standley 2013</xref>) with the options –globalpair --ep 0.123. The resulting alignments were trimmed with trimAl (<xref rid="evad227-B9" ref-type="bibr">Capella-Gutiérrez et al. 2009</xref>), removing all positions with more than 90% gaps but retaining at least 60% of each alignment (options -gt 0.9 and -cons 60, respectively). We used FASconcat-G (<xref rid="evad227-B27" ref-type="bibr">Kück and Longo 2014</xref>) to concatenate the trimmed alignments into a supermatrix. This supermatrix was then input into IQ-TREE 2 (<xref rid="evad227-B37" ref-type="bibr">Minh et al. 2020</xref>), alongside its corresponding gene partition file, to reconstruct the phylogeny using the maximum likelihood (ML) approach. We ran IQ-TREE 2 with extended model selection and tree inference, calculating 1,000 replicates for the ultrafast bootstrap (command line options -m MFP and -B 1000, respectively).</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>This work used the Scientific Compute Cluster at GWDG, the joint data center of Max Planck Society for the Advancement of Science (MPG) and University of Göttingen. We acknowledge support by the Open Access Publication Funds of the Göttingen University.</p>
  </ack>
  <sec id="evad227-s4">
    <title>Funding</title>
    <p>This work was supported by the German Research Foundation (DFG) BL787/8-1.</p>
  </sec>
  <sec sec-type="data-availability" id="evad227-s5">
    <title>Data Availability</title>
    <p>The data underlying this article are available via GitHub at <ext-link xlink:href="https://github.com/animal-evolution-and-biodiversity/benchmarking-patchwork" ext-link-type="uri">https://github.com/animal-evolution-and-biodiversity/benchmarking-patchwork</ext-link>. Patchwork is distributed under the GPLv3 license via GitHub at <ext-link xlink:href="https://github.com/fethalen/patchwork" ext-link-type="uri">https://github.com/fethalen/patchwork</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature Cited</title>
    <ref id="evad227-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Boyd</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>NP</given-names></string-name>, <string-name><surname>Vachaspati</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Warnow</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Huang</surname>  <given-names>DI</given-names></string-name>, <string-name><surname>Grady</surname>  <given-names>PGS</given-names></string-name>, <string-name><surname>Bell</surname>  <given-names>KC</given-names></string-name>, <string-name><surname>Cronk</surname>  <given-names>QCB</given-names></string-name>, <string-name><surname>Mugisha</surname>  <given-names>L</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Phylogenomics from whole genome sequences using aTRAM</article-title>. <source>Syst Biol</source>. <year>2017</year>:<volume>66</volume>(<issue>5</issue>):<fpage>786</fpage>–<lpage>798</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syw105</pub-id>.<pub-id pub-id-type="pmid">28123117</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>LaFrance</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Folk</surname>  <given-names>RA</given-names></string-name>, <string-name><surname>Johnson</surname>  <given-names>KP</given-names></string-name>, <string-name><surname>Guralnick</surname>  <given-names>RP</given-names></string-name></person-group>. <article-title>aTRAM 2.0: an improved, flexible locus assembler for NGS data</article-title>. <source>Evol Bioinform</source>. <year>2018</year>:<volume>14</volume>:<comment>1176934318774546. </comment><pub-id pub-id-type="doi">10.1177/1176934318774546</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezanson</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Edelman</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Karpinski</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Shah</surname>  <given-names>VB</given-names></string-name></person-group>. <article-title>Julia: a fresh approach to numerical computing</article-title>. <source>SIAM Rev</source>. <year>2017</year>:<volume>59</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1137/141000671</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name></person-group>. <source>Phylogenomics. An introduction</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer International Publishing</publisher-name>; <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="evad227-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blom</surname>  <given-names>MPK</given-names></string-name></person-group>. <article-title>Opportunities and challenges for high-quality biodiversity tissue archives in the age of long-read sequencing</article-title>. <source>Mol Ecol</source>. <year>2021</year>:<volume>30</volume>(<issue>23</issue>):<fpage>5935</fpage>–<lpage>5948</lpage>. <pub-id pub-id-type="doi">10.1111/mec.15909</pub-id>.<pub-id pub-id-type="pmid">33786900</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bragg</surname>  <given-names>JG</given-names></string-name>, <string-name><surname>Potter</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bi</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Moritz</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>Exon capture phylogenomics: efficacy across scales of divergence</article-title>. <source>Mol Ecol Res</source>. <year>2016</year>:<volume>16</volume>(<issue>5</issue>):<fpage>1059</fpage>–<lpage>1068</lpage>. <pub-id pub-id-type="doi">10.1111/1755-0998.12449</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Reuter</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Drost</surname>  <given-names>H-G</given-names></string-name></person-group>. <article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>. <source>Nature Meth</source>. <year>2021</year>:<volume>18</volume>(<issue>4</issue>):<fpage>366</fpage>–<lpage>368</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-021-01101-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Call</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Mayer</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Twort</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Dietz</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Wahlberg</surname>  <given-names>N</given-names></string-name></person-group><etal>et al</etal>  <year>2021</year>. <article-title>Museomics: phylogenomics of the moth family Epicopeiidae (Lepidoptera) using target enrichment</article-title>. <source>Insect Syst Divers</source>. <volume>5</volume>(<issue>2</issue>):<fpage>6</fpage>. <pub-id pub-id-type="doi">10.1093/isd/ixaa021</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capella-Gutiérrez</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Silla-Martínez</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Gabaldón</surname>  <given-names>T</given-names></string-name></person-group>. <article-title>Trimal: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>  <year>2009</year>:<volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>.<pub-id pub-id-type="pmid">19505945</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dahn</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Mountcastle</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Balacco</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Winkler</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bista</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Schmitt</surname>  <given-names>AD</given-names></string-name>, <string-name><surname>Pettersson</surname>  <given-names>OV</given-names></string-name>, <string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Oliver</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Smith</surname>  <given-names>M</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Benchmarking ultra-high molecular weight DNA preservation methods for long-read and long-range sequencing</article-title>. <source>GigaScience</source>  <year>2022</year>:<volume>11</volume>:<fpage>giac068</fpage>. <pub-id pub-id-type="doi">10.1093/gigascience/giac068</pub-id>.<pub-id pub-id-type="pmid">35946988</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>da Veiga Leprevost</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Grüning</surname>  <given-names>BA</given-names></string-name>, <string-name><surname>Alves Aflitos</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Röst</surname>  <given-names>HL</given-names></string-name>, <string-name><surname>Uszkoreit</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Barsnes</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Perez-Riverol</surname>  <given-names>Y</given-names></string-name></person-group>. <article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>. <source>Bioinformatics</source>  <year>2017</year>:<volume>33</volume>(<issue>16</issue>):<fpage>2580</fpage>–<lpage>2582</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx192</pub-id>.<pub-id pub-id-type="pmid">28379341</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dietz</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Eberle</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Mayer</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Kukowka</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bohacz</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Baur</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Espeland</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Huber</surname>  <given-names>BA</given-names></string-name>, <string-name><surname>Hutter</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Mengual</surname>  <given-names>X</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Standardized nuclear markers improve and homogenize species delimitation in Metazoa</article-title>. <source>Methods Ecol Evol</source>. <year>2023</year>:<volume>14</volume>(<issue>2</issue>):<fpage>543</fpage>–<lpage>555</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.14041</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dodsworth</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Genome skimming for next-generation biodiversity analysis</article-title>. <source>Trends Plant Sci</source>. <year>2015</year>:<volume>20</volume>(<issue>9</issue>):<fpage>525</fpage>–<lpage>527</lpage>. <pub-id pub-id-type="doi">10.1016/j.tplants.2015.06.012</pub-id>.<pub-id pub-id-type="pmid">26205170</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dylus</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Altenhoff</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Majidian</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Sedlazeck</surname>  <given-names>FJ</given-names></string-name>, <string-name><surname>Dessimoz</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>Inference of phylogenetic trees directly from raw sequencing reads using Read2Tree</article-title>. <source>Nat Biotechnol</source>. <year>2023</year>. <pub-id pub-id-type="doi">10.1038/s41587-023-01753-4</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Erséus</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Williams</surname>  <given-names>BW</given-names></string-name>, <string-name><surname>Horn</surname>  <given-names>KM</given-names></string-name>, <string-name><surname>Halanych</surname>  <given-names>KM</given-names></string-name>, <string-name><surname>Santos</surname>  <given-names>SR</given-names></string-name>, <string-name><surname>James</surname>  <given-names>SW</given-names></string-name>, <string-name><surname>Des Creuzé Châtelliers</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Anderson</surname>  <given-names>FE</given-names></string-name></person-group>. <article-title>Phylogenomic analyses reveal a Palaeozoic radiation and support a freshwater origin for clitellate annelids</article-title>. <source>Zool Scr</source>. <year>2020</year>:<volume>49</volume>(<issue>5</issue>):<fpage>614</fpage>–<lpage>640</lpage>. <pub-id pub-id-type="doi">10.1111/zsc.12426</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Theissinger</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Fernandes</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Bista</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Bombarely</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Ciofi</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Crottini</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Godoy</surname>  <given-names>JA</given-names></string-name>, <string-name><surname>Höglund</surname>  <given-names>J</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>The era of reference genomes in conservation genomics</article-title>. <source>Trends Ecol Evol</source>. <year>2022</year>:<volume>37</volume>(<issue>3</issue>):<fpage>197</fpage>–<lpage>202</lpage>. <pub-id pub-id-type="doi">10.1016/j.tree.2021.11.008</pub-id>.<pub-id pub-id-type="pmid">35086739</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frith</surname>  <given-names>MC</given-names></string-name></person-group>. <article-title>A new repeat-masking method enables specific detection of homologous sequences</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>:<volume>39</volume>(<issue>4</issue>):<fpage>e23</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1212</pub-id>.<pub-id pub-id-type="pmid">21109538</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gurevich</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Saveliev</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Vyahhi</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Tesler</surname>  <given-names>G</given-names></string-name></person-group>. <article-title>QUAST: quality assessment tool for genome assemblies</article-title>. <source>Bioinformatics</source>  <year>2013</year>:<volume>29</volume>(<issue>8</issue>):<fpage>1072</fpage>–<lpage>1075</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>.<pub-id pub-id-type="pmid">23422339</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heath</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Hedtke</surname>  <given-names>SM</given-names></string-name>, <string-name><surname>Hillis</surname>  <given-names>DM</given-names></string-name></person-group>. <year>2008</year>. <article-title>Taxon sampling and the accuracy of phylogenetic analyses</article-title>. <source>J Syst Evol</source>. <volume>46</volume>:<fpage>239</fpage>–<lpage>257</lpage>. <pub-id pub-id-type="doi">10.3724/SP.J.1002.2008.08016</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname>  <given-names>JG</given-names></string-name>, <string-name><surname>Henikoff</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Blocks database and its applications</article-title>. <source>Meth Enzymol</source>. <year>1996</year>:<volume>266</volume>:<fpage>88</fpage>–<lpage>105</lpage>. <pub-id pub-id-type="doi">10.1016/S0076-6879(96)66008-X</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Chitnis</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Monos</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Dinh</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Next-generation sequencing technologies: an overview</article-title>. <source>Human Immunol</source>. <year>2021</year>:<volume>82</volume>(<issue>11</issue>):<fpage>801</fpage>–<lpage>811</lpage>. <pub-id pub-id-type="doi">10.1016/j.humimm.2021.02.012</pub-id>.<pub-id pub-id-type="pmid">33745759</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname>  <given-names>J-J</given-names></string-name>, <string-name><surname>Yu</surname>  <given-names>W-B</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>J-B</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>dePamphilis</surname>  <given-names>CW</given-names></string-name>, <string-name><surname>Yi</surname>  <given-names>T-S</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>D-Z</given-names></string-name></person-group>. <article-title>GetOrganelle: a fast and versatile toolkit for accurate de novo assembly of organelle genomes</article-title>. <source>Genome Biol</source>. <year>2020</year>:<volume>21</volume>(<issue>1</issue>):<fpage>241</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-020-02154-5</pub-id>.<pub-id pub-id-type="pmid">32912315</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname>  <given-names>DM</given-names></string-name></person-group>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>:<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keilwagen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Hartung</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Paulini</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Twardziok</surname>  <given-names>SO</given-names></string-name>, <string-name><surname>Grau</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Combining RNA-seq data and homology-based gene prediction for plants, animals and fungi</article-title>. <source>BMC Bioinformatics</source>  <year>2018</year>:<volume>19</volume>(<issue>1</issue>):<fpage>189</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-018-2203-5</pub-id>.<pub-id pub-id-type="pmid">29843602</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keilwagen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Wenk</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Erickson</surname>  <given-names>JL</given-names></string-name>, <string-name><surname>Schattat</surname>  <given-names>MH</given-names></string-name>, <string-name><surname>Grau</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Hartung</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Using intron position conservation for homology-based gene prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>:<volume>44</volume>(<issue>9</issue>):<fpage>e89</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw092</pub-id>.<pub-id pub-id-type="pmid">26893356</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knyshov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Gordon</surname>  <given-names>ERL</given-names></string-name>, <string-name><surname>Weirauch</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>New alignment-based sequence extraction software (ALiBaSeq) and its utility for deep level phylogenetics</article-title>. <source>PeerJ</source>  <year>2021</year>:<volume>9</volume>:<fpage>e11019</fpage>. <pub-id pub-id-type="doi">10.7717/peerj.11019</pub-id>.<pub-id pub-id-type="pmid">33850647</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kück</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Longo</surname>  <given-names>GC</given-names></string-name></person-group>. <article-title>FASconCAT-G: extensive functions for multiple sequence alignment preparations concerning phylogenetic studies</article-title>. <source>Frontiers Zool</source>. <year>2014</year>:<volume>11</volume>(<issue>1</issue>):<fpage>81</fpage>. <pub-id pub-id-type="doi">10.1186/s12983-014-0081-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname>  <given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname>  <given-names>MW</given-names></string-name></person-group>. <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>  <year>2017</year>:<volume>12</volume>(<issue>5</issue>):<fpage>e0177459</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>.<pub-id pub-id-type="pmid">28494014</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sugawara</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Shumway</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>:<volume>39</volume>(<issue>Database</issue>):<fpage>D19</fpage>–<lpage>D21</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemmon</surname>  <given-names>EM</given-names></string-name>, <string-name><surname>Lemmon</surname>  <given-names>AR</given-names></string-name></person-group>. <article-title>High-throughput genomic data in systematics and phylogenetics</article-title>. <source>Annu Rev Ecol Evol Syst</source>. <year>2013</year>:<volume>44</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135822</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>B-B</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>B-B</given-names></string-name>, <string-name><surname>Ma</surname>  <given-names>Z-Y</given-names></string-name>, <string-name><surname>Ren</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Hodel</surname>  <given-names>RGJ</given-names></string-name></person-group><etal>et al</etal>  <year>2021</year>. <article-title>Capturing single-copy nuclear genes, organellar genomes, and nuclear ribosomal DNA from deep genome skimming data for plant phylogenetics: a case study in Vitaceae</article-title>. <source>Appl Plant Sci</source>. <volume>11</volume>(<issue>4</issue>):<fpage>e11537</fpage>. <pub-id pub-id-type="doi">10.1111/jse.12806</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lozano-Fernandez</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>A practical guide to design and assess a phylogenomic study</article-title>. <source>Genome Biol Evol</source>. <year>2022</year>:<volume>14</volume>(<issue>9</issue>):<fpage>evac129</fpage>. <pub-id pub-id-type="doi">10.1093/gbe/evac129</pub-id>.<pub-id pub-id-type="pmid">35946263</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Berkeley</surname>  <given-names>MR</given-names></string-name>, <string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Simão</surname>  <given-names>FA</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>. <source>Mol Biol Evol</source>. <year>2021</year>:<volume>38</volume>(<issue>10</issue>):<fpage>4647</fpage>–<lpage>4654</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id>.<pub-id pub-id-type="pmid">34320186</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martín-Durán</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Vellutini</surname>  <given-names>BC</given-names></string-name>, <string-name><surname>Marlétaz</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Cetrangolo</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Cvetesic</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Thiel</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Henriet</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Grau-Bové</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Carrillo-Baltodano</surname>  <given-names>AM</given-names></string-name>, <string-name><surname>Gu</surname>  <given-names>W</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Conservative route to genome compaction in a miniature annelid</article-title>. <source>Nat Ecol Evol</source>. <year>2021</year>:<volume>5</volume>(<issue>2</issue>):<fpage>231</fpage>–<lpage>242</lpage>. <pub-id pub-id-type="doi">10.1038/s41559-020-01327-6</pub-id>.<pub-id pub-id-type="pmid">33199869</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCormack</surname>  <given-names>JE</given-names></string-name>, <string-name><surname>Hird</surname>  <given-names>SM</given-names></string-name>, <string-name><surname>Zellmer</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Carstens</surname>  <given-names>BC</given-names></string-name>, <string-name><surname>Brumfield</surname>  <given-names>RT</given-names></string-name></person-group>. <article-title>Applications of next-generation sequencing to phylogeography and phylogenetics</article-title>. <source>Mol Phylogenet Evol</source>. <year>2013</year>:<volume>66</volume>(<issue>2</issue>):<fpage>526</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1016/j.ympev.2011.12.007</pub-id>.<pub-id pub-id-type="pmid">22197804</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname>  <given-names>D</given-names></string-name></person-group>. <year>2014</year>. <article-title>Docker: lightweight linux containers for consistent development and deployment</article-title>. <source>Linux J</source>. <volume>239</volume>(<issue>2</issue>):<fpage>2</fpage>. <pub-id pub-id-type="doi">10.5555/2600239.2600241</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Schmidt</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Chernomor</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Woodhams</surname>  <given-names>MD</given-names></string-name>, <string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nurk</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bankevich</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Antipov</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Gurevich</surname>  <given-names>AA</given-names></string-name>, <string-name><surname>Korobeynikov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lapidus</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Prjibelski</surname>  <given-names>AD</given-names></string-name>, <string-name><surname>Pyshkin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Sirotkin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Sirotkin</surname>  <given-names>Y</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Assembling single-cell genomes and mini-metagenomes from chimeric MDA products</article-title>. <source>J Comput Biol</source>. <year>2013</year>:<volume>20</volume>(<issue>10</issue>):<fpage>714</fpage>–<lpage>737</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2013.0084</pub-id>.<pub-id pub-id-type="pmid">24093227</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Roure</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name></person-group><etal>et al</etal>  <year>2017</year>. <article-title>Pitfalls in supermatrix phylogenomics</article-title>. <source>Eur J Taxon</source>. <volume>283</volume>:<fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.5852/ejt.2017.283</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJP</given-names></string-name>, <string-name><surname>Cambon</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>MACSE v2: toolkit for the alignment of coding sequences accounting for frameshifts and stop codons</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>10</issue>):<fpage>2582</fpage>–<lpage>2584</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msy159</pub-id>.<pub-id pub-id-type="pmid">30165589</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raxworthy</surname>  <given-names>CJ</given-names></string-name>, <string-name><surname>Smith</surname>  <given-names>BT</given-names></string-name></person-group>. <article-title>Mining museums for historical DNA: advances and challenges in museomics</article-title>. <source>Trends Ecol Evol</source>. <year>2021</year>:<volume>36</volume>(<issue>11</issue>):<fpage>1049</fpage>–<lpage>1060</lpage>. <pub-id pub-id-type="doi">10.1016/j.tree.2021.07.009</pub-id>.<pub-id pub-id-type="pmid">34456066</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhie</surname>  <given-names>A</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Fedrigo</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Damas</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Koren</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Uliano-Silva</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Chow</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Fungtammasan</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Towards complete and error-free genome assemblies of all vertebrate species</article-title>. <source>Nature</source>  <year>2021</year>:<volume>592</volume>(<issue>7856</issue>):<fpage>737</fpage>–<lpage>746</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03451-0</pub-id>.<pub-id pub-id-type="pmid">33911273</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richter</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Schwarz</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Hering</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Böggemann</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>The utility of genome skimming for phylogenomic analyses as demonstrated for glycerid relationships (Annelida, Glyceridae)</article-title>. <source>Genome Biol Evol</source>. <year>2015</year>:<volume>7</volume>(<issue>12</issue>):<fpage>3443</fpage>–<lpage>3462</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evv224</pub-id>.<pub-id pub-id-type="pmid">26590213</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogozin</surname>  <given-names>IB</given-names></string-name>, <string-name><surname>Sverdlov</surname>  <given-names>AV</given-names></string-name>, <string-name><surname>Babenko</surname>  <given-names>VN</given-names></string-name>, <string-name><surname>Koonin</surname>  <given-names>EV</given-names></string-name></person-group>. <article-title>Analysis of evolution of exon-intron structure of eukaryotic genes</article-title>. <source>Brief Bioinformatics</source>  <year>2005</year>:<volume>6</volume>(<issue>2</issue>):<fpage>118</fpage>–<lpage>134</lpage>. <pub-id pub-id-type="doi">10.1093/bib/6.2.118</pub-id>.<pub-id pub-id-type="pmid">15975222</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sahbou</surname>  <given-names>A-E</given-names></string-name>, <string-name><surname>Iraqi</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Mentag</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Khayi</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>BuscoPhylo: a webserver for Busco-based phylogenomic analysis for non-specialists</article-title>. <source>Sci Rep</source>. <year>2022</year>:<volume>12</volume>(<issue>1</issue>):<fpage>17352</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-022-22461-0</pub-id>.<pub-id pub-id-type="pmid">36253435</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salzberg</surname>  <given-names>SL</given-names></string-name></person-group>. <article-title>Next-generation genome annotation: we still struggle to get it right</article-title>. <source>Genome Biol</source>. <year>2019</year>:<volume>20</volume>(<issue>1</issue>):<fpage>92</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1715-2</pub-id>.<pub-id pub-id-type="pmid">31097009</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salzberg</surname>  <given-names>SL</given-names></string-name>, <string-name><surname>Phillippy</surname>  <given-names>AM</given-names></string-name>, <string-name><surname>Zimin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Puiu</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Magoc</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Koren</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Treangen</surname>  <given-names>TJ</given-names></string-name>, <string-name><surname>Schatz</surname>  <given-names>MC</given-names></string-name>, <string-name><surname>Delcher</surname>  <given-names>AL</given-names></string-name>, <string-name><surname>Roberts</surname>  <given-names>M</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>GAGE: a critical evaluation of genome assemblies and assembly algorithms</article-title>. <source>Genome Res</source>. <year>2012</year>:<volume>22</volume>(<issue>3</issue>):<fpage>557</fpage>–<lpage>567</lpage>. <pub-id pub-id-type="doi">10.1101/gr.131383.111</pub-id>.<pub-id pub-id-type="pmid">22147368</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO: assessing genome assembly and annotation completeness</article-title>. <source>Methods Mol Biol</source>. <year>2019</year>:<volume>1962</volume>:<fpage>227</fpage>–<lpage>245</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-4939-9173-0_14</pub-id>.<pub-id pub-id-type="pmid">31020564</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simmons</surname>  <given-names>SK</given-names></string-name>, <string-name><surname>Lithwick-Yanai</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Adiconis</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Oberstrass</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Iremadze</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Geiger-Schuller</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Thakore</surname>  <given-names>PI</given-names></string-name>, <string-name><surname>Frangieh</surname>  <given-names>CJ</given-names></string-name>, <string-name><surname>Barad</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Almogy</surname>  <given-names>G</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Mostly natural sequencing-by-synthesis for scRNA-seq using Ultima sequencing</article-title>. <source>Nat Biotechnol</source>. <year>2023</year>:<volume>41</volume>(<issue>2</issue>):<fpage>204</fpage>–<lpage>211</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01452-6</pub-id>.<pub-id pub-id-type="pmid">36109685</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Slater</surname>  <given-names>GSC</given-names></string-name>, <string-name><surname>Birney</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>Automated generation of heuristics for biological sequence comparison</article-title>. <source>BMC Bioinformatics</source>  <year>2005</year>:<volume>6</volume>(<issue>1</issue>):<fpage>31</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-6-31</pub-id>.<pub-id pub-id-type="pmid">15713233</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stark</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Grzelak</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Hadfield</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>RNA sequencing: the teenage years</article-title>. <source>Nat Rev Genet</source>. <year>2019</year>:<volume>20</volume>(<issue>11</issue>):<fpage>631</fpage>–<lpage>656</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-019-0150-2</pub-id>.<pub-id pub-id-type="pmid">31341269</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steenwyk</surname>  <given-names>JL</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Shen</surname>  <given-names>XX</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Incongruence in the phylogenomics era</article-title>. <source>Nat Rev Genet</source>. <year>2023</year>:<volume>24</volume>(<issue>12):</issue><fpage>834</fpage>–<lpage>850</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-023-00620-x</pub-id>.<pub-id pub-id-type="pmid">37369847</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waterhouse</surname>  <given-names>RM</given-names></string-name>, <string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Simão</surname>  <given-names>FA</given-names></string-name>, <string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ioannidis</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Klioutchnikov</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Kriventseva</surname>  <given-names>EV</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO applications from quality assessments to gene prediction and phylogenomics</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>3</issue>):<fpage>543</fpage>–<lpage>548</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msx319</pub-id>.<pub-id pub-id-type="pmid">29220515</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whelan</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Irisarri</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Burki</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>PREQUAL: detecting non-homologous characters in sets of unaligned homologous sequences</article-title>. <source>Bioinformatics</source>  <year>2018</year>:<volume>34</volume>(<issue>22</issue>):<fpage>3929</fpage>–<lpage>3930</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty448</pub-id>.<pub-id pub-id-type="pmid">29868763</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Ding</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>C-D</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Orr</surname>  <given-names>MC</given-names></string-name>, <string-name><surname>Scheu</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Luan</surname>  <given-names>Y-X</given-names></string-name></person-group>. <article-title>Phylogenomics from low-coverage whole-genome sequencing</article-title>. <source>Methods Ecol Evol</source>. <year>2019</year>:<volume>10</volume>(<issue>4</issue>):<fpage>507</fpage>–<lpage>517</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13145</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">gbe</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1759-6653</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10735302</article-id>
    <article-id pub-id-type="pmid">38085033</article-id>
    <article-id pub-id-type="doi">10.1093/gbe/evad227</article-id>
    <article-id pub-id-type="publisher-id">evad227</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Patchwork: Alignment-Based Retrieval and Concatenation of Phylogenetic Markers from Genomic Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Thalén</surname>
          <given-names>Felix</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
        <aff><institution>Cardio-CARE AG, Medizincampus Davos</institution>, <addr-line>Davos Wolfgang 7265</addr-line>, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Köhne</surname>
          <given-names>Clara G</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7295-6616</contrib-id>
        <name>
          <surname>Bleidorn</surname>
          <given-names>Christoph</given-names>
        </name>
        <aff><institution>Department for Animal Evolution and Biodiversity, Georg-August-Universität Göttingen</institution>, <addr-line>Göttingen 37073</addr-line>, <country country="DE">Germany</country></aff>
        <xref rid="evad227-cor1" ref-type="corresp"/>
        <!--christoph.bleidorn@biologie.uni-goettingen.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lavrov</surname>
          <given-names>Dennis</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="evad227-cor1">Corresponding author: E-mail: <email>christoph.bleidorn@biologie.uni-goettingen.de</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-12">
      <day>12</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>evad227</elocation-id>
    <history>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="evad227.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Low-coverage whole-genome sequencing (also known as “genome skimming”) is becoming an increasingly affordable approach to large-scale phylogenetic analyses. While already routinely used to recover organellar genomes, genome skimming is rather rarely utilized for recovering single-copy nuclear markers. One reason might be that only few tools exist to work with this data type within a phylogenomic context, especially to deal with fragmented genome assemblies. We here present a new software tool called Patchwork for mining phylogenetic markers from highly fragmented short-read assemblies as well as directly from sequence reads. Patchwork is an alignment-based tool that utilizes the sequence aligner DIAMOND and is written in the programming language Julia. Homologous regions are obtained via a sequence similarity search, followed by a “hit stitching” phase, in which adjacent or overlapping regions are merged into a single unit. The novel sliding window algorithm trims away any noncoding regions from the resulting sequence. We demonstrate the utility of Patchwork by recovering near-universal single-copy orthologs within a benchmarking study, and we additionally assess the performance of Patchwork in comparison with other programs. We find that Patchwork allows for accurate retrieval of (putatively) single-copy genes from genome skimming data sets at different sequencing depths with high computational speed, outperforming existing software targeting similar tasks. Patchwork is released under the GNU General Public License version 3. Installation instructions, additional documentation, and the source code itself are all available via GitHub at <ext-link xlink:href="https://github.com/fethalen/Patchwork" ext-link-type="uri">https://github.com/fethalen/Patchwork</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>genome skimming</kwd>
      <kwd>low-coverage sequencing</kwd>
      <kwd>museomics</kwd>
      <kwd>phylogenomics</kwd>
      <kwd>short reads</kwd>
      <kwd>single-copy genes</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Göttingen</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003385</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <boxed-text id="evad227-box1" position="float">
    <caption>
      <title>Significance</title>
    </caption>
    <p>Even though current sequencing and computational methods allow for the completion of high-quality genomes for all life on earth, the availability of material for sequencing became a major bottleneck in phylogenomic studies, especially since material stored in museum collections—or during barcoding campaigns—is often not suitable for reconstructing high-quality, highly continuous genomes. At the same time, the output of short-read sequencing machines is increasing, and prices for these techniques are dropping. Short-read data are still routinely used to recover organellar genomes, but this so-called genome skimming approach is rather rarely utilized for recovering single-copy nuclear markers. We present a new software tool called Patchwork for mining phylogenetic markers from highly fragmented genome assemblies, as well as directly from short sequence reads. We demonstrate the accuracy of this new approach and show in a benchmarking study that it also outperforms existing software for similar tasks. Patchwork allows to compile preselected gene sets from low-coverage short-read sequencing data sets and is thereby ideally suited when including material from museum collections into phylogenomic studies.</p>
  </boxed-text>
  <sec sec-type="intro" id="evad227-s0">
    <title>Introduction</title>
    <p>Advancements in high-throughput sequencing techniques have revolutionized the field of phylogenetics and ultimately our understanding of the tree of life (<xref rid="evad227-B30" ref-type="bibr">Lemmon and Lemmon 2013</xref>). The availability of genomic and transcriptomic data for basically all desired taxa and for a reasonable price has transformed the field to phylogenomics: genome-scale phylogenetic systematic analyses (<xref rid="evad227-B35" ref-type="bibr">McCormack et al. 2013</xref>). Some challenges remain, however, as many studies still show incongruent results, low branch support, or lacking resolution (<xref rid="evad227-B39" ref-type="bibr">Philippe et al. 2017</xref>; <xref rid="evad227-B52" ref-type="bibr">Steenwyk et al. 2023</xref>). Even though complete genomes are becoming available for more and more eukaryotes, the access to high-molecular-weight DNA is the bottleneck in the quest for sequencing genomes of all life on earth (<xref rid="evad227-B5" ref-type="bibr">Blom 2021</xref>; <xref rid="evad227-B10" ref-type="bibr">Dahn et al. 2022</xref>). Nowadays and in the past, most large-scale phylogenomic studies were conducted using either transcriptome sequencing or genome subsampling methods such as target enrichment, which focuses on a set of preselected loci (<xref rid="evad227-B4" ref-type="bibr">Bleidorn 2017</xref>).</p>
    <p>Transcriptome sequencing offers a way to sequence only the expressed portion of a genome without prior sequence knowledge (<xref rid="evad227-B51" ref-type="bibr">Stark et al. 2019</xref>). Unfortunately, this approach requires freshly collected material or specifically stored material, e.g. deeply flash frozen or in RNAlater. Furthermore, smaller specimens may need to be pooled together to attain sufficient amounts of mRNA, and such practice risks mixing up individuals with undetected genetic variation. Unfortunately, a large amount of collected specimens only exist in natural history museum collections, and most of these are ethanol preserved and thus not usable for transcriptomic studies (<xref rid="evad227-B8" ref-type="bibr">Call et al. 2021</xref>). As taxon sampling is considered one of the most important factors for accurate phylogenetic tree reconstruction (<xref rid="evad227-B19" ref-type="bibr">Heath et al. 2008</xref>), it would be missing an opportunity to leave the potential of natural history collections untapped. Target enrichment approaches, on the other hand, require prior knowledge of target sequences (e.g. from well-annotated genomes) for the construction of oligonucleotide probes. Moreover, the number of enriched targets is limited by the number of oligonucleotides included in the enrichment kit of choice, and the efficiency of such approaches decreases as the bait-to-target distance increases (<xref rid="evad227-B6" ref-type="bibr">Bragg et al. 2016</xref>). Another downside is that the data produced are difficult to reuse for other types of genomic or evolutionary studies.</p>
    <p>A viable alternative to assemble taxon-rich phylogenomic data sets is low-coverage whole-genome sequencing (LC-WGS; also known as “shallow genome sequencing” or “genome skimming”) using short-read technologies such as Illumina sequencing (<xref rid="evad227-B13" ref-type="bibr">Dodsworth 2015</xref>). Relying solely on this approach has been shown to be inadequate for the reconstruction of highly contiguous reference-quality genomes (<xref rid="evad227-B42" ref-type="bibr">Rhie et al. 2021</xref>). However, due to the introduction of newer sequencing platforms (e.g. Illumina's NovaSeq sequencing platform) short-read WGS became relatively cheap and prices are even expected to drop with Ultima Genomics, another highly competitive sequencing platform entering the market (<xref rid="evad227-B49" ref-type="bibr">Simmons et al. 2023</xref>). Moreover, short-read sequencing library construction also allows that highly fragmented DNA can be used as input (<xref rid="evad227-B21" ref-type="bibr">Hu et al. 2021</xref>), thereby enabling the use of material from museum collections from all around the world (<xref rid="evad227-B41" ref-type="bibr">Raxworthy and Smith 2021</xref>). Consequently, LC-WGS can be used to generate data from various sources of targeted organisms to retrieve marker loci on a genome scale. While this so-called “genome skimming” approach has frequently been used to reconstruct organellar genomes or other high-copy fractions of eukaryote genomes (<xref rid="evad227-B43" ref-type="bibr">Richter et al. 2015</xref>; <xref rid="evad227-B22" ref-type="bibr">Jin et al. 2020</xref>), it seems currently underutilized to retrieve single-copy nuclear markers (<xref rid="evad227-B31" ref-type="bibr">Liu et al. 2021</xref>). One reason is that short-read assemblies of eukaryotic genomes tend to be highly discontinuous, and automated annotation of such large, fragmented genomes remains difficult (<xref rid="evad227-B46" ref-type="bibr">Salzberg 2019</xref>), as they are characterized by the presence of “genes in pieces,” where introns interrupt coding sequences (<xref rid="evad227-B44" ref-type="bibr">Rogozin et al. 2005</xref>). Depending on the coverage, short-read draft genomes are characterized by low N50s in the range of few (if at all) kilobase pairs (kb; <xref rid="evad227-B47" ref-type="bibr">Salzberg et al. 2012</xref>), and consequently, exons of a single gene usually end up on several contigs.</p>
    <p>The disuse of genome skimming in large-scale phylogenetics could potentially be ascribed to the lack of suitable data analysis methods (<xref rid="evad227-B55" ref-type="bibr">Zhang et al. 2019</xref>). Existing software tools for working with LC-WGS data in a phylogenomic context, such as aTRAM 2 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>, <xref rid="evad227-B2" ref-type="bibr">2018</xref>), ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>), and GeMoMa (<xref rid="evad227-B25" ref-type="bibr">Keilwagen et al. 2016</xref>, <xref rid="evad227-B24" ref-type="bibr">2018</xref>), are either written in an interpreted language (e.g. Perl or Python) that does not allow the program to scale well with the large biological data sets that are commonplace today (e.g. aTRAM 2, ALiBaSeq) or need well-annotated reference genomes or transcriptomes (e.g. GeMoMa). A recent addition to the portfolio of available tools for such programs is Read2Tree, which directly infers trees from unassembled data (<xref rid="evad227-B14" ref-type="bibr">Dylus et al. 2023</xref>).</p>
    <p>To address the limitations typically associated when working with genome skimming data, we present Patchwork, an alignment-based tool for mining phylogenetic markers directly from WGS data. Patchwork utilizes the sequence aligner DIAMOND (<xref rid="evad227-B7" ref-type="bibr">Buchfink et al. 2021</xref>) and is written in the programming language Julia (<xref rid="evad227-B3" ref-type="bibr">Bezanson et al. 2017</xref>) to achieve the best possible speed, thus allowing Patchwork to scale well with today's genome-scale data sets. In addition, our implementation focuses on ease of use, and our program handles each step in the analysis—from start to finish. Using our new approach, we targeted universal single-copy orthologs (USCOs), which are available based on careful analysis of a curated database (OrthoDB, <ext-link xlink:href="https://www.orthodb.org" ext-link-type="uri">www.orthodb.org</ext-link>). A set of 954 metazoan-specific USCOs has been validated against 364 metazoan genomes and shown to be indeed (i) single-copy and (ii) nearly universally present (<xref rid="evad227-B33" ref-type="bibr">Manni et al. 2021</xref>).</p>
  </sec>
  <sec sec-type="results" id="evad227-s1">
    <title>Results</title>
    <p>Patchwork is a reference- and alignment-based method for mining phylogenetic markers from WGS data, using either assembled contigs or reads as input (<xref rid="evad227-F1" ref-type="fig">Fig. 1</xref>). The aim of Patchwork is to capture multiexon or fragmented genes, scattered across different contigs or reads. One or more reference protein sequences guide the “stitching” process, where the best-scoring translated query nucleotide sequences for any given region are merged into continuous stretches of amino acid sequences. Merged sequences go through a masking step in which unaligned residues, ambiguous amino acid characters (letters that do not determine a unique amino acid; they are B, J, X, or Z, where B = D or N, J = I or L, X = unknown, and Z = E or Q), and stop codons are removed from query sequences. Optionally, the removal of stop codons and ambiguous amino acid characters may be skipped by providing the --retain-stops and --retain-ambiguous flags, respectively. Finally, Patchwork implements a sliding window–based alignment trimming step to remove poorly aligned residues (e.g. due to the presence of putative noncoding regions) from the resulting sequences. The output is available as nucleotide or amino acid sequences.</p>
    <fig position="float" id="evad227-F1" fig-type="figure">
      <label>Fig. 1.</label>
      <caption>
        <p>Graphical overview of the Patchwork algorithm. First, a) query sequences are aligned to the provided reference sequence. These alignments may or may not be overlapping. b) Overlapping alignments are realigned but only in the area in which they overlap. The best-scoring alignment is retained while all others are discarded. c) Nonaligned residues are then removed, and d) the remaining regions are concatenated into a single, continuous sequence.</p>
      </caption>
      <graphic xlink:href="evad227f1" position="float"/>
    </fig>
    <sec id="evad227-s1.1">
      <title>Benchmark</title>
      <p>To asses performance of our approach, we (i) test an ideal case where the query and reference species are identical, (ii) where the query and reference are 2 distant species, and (iii) compare Patchwork v.0.5.1 with ALiBaSeq v.1.2 (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM v.2.4.3 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). Throughout these benchmarks, we use Illumina short-read nucleotide sequences from the marine annelid <italic toggle="yes">Dimorphilus gyrociliatus</italic> (accession PRJEB37657 in the European Nucleotide Archive). A highly contiguous (N50 = 2.24 Mb) and complete (95.8% BUSCO genes recovered, metazoa_odb10) annotated version of the compact 73.8-Mb genome of this annelid is publicly available (<xref rid="evad227-B34" ref-type="bibr">Martín-Durán et al. 2021</xref>).</p>
      <p>As we only used short-read data sets at different coverages for our benchmark analyses, we created highly discontinuous assemblies with low N50s as typical for real-world low-coverage genomic data sets. We assembled these sequence reads using SPAdes and subsequently used Patchwork to search for near-USCOs (<xref rid="evad227-B48" ref-type="bibr">Seppey et al. 2019</xref>), using a preannotated set of USCOs from that same species as a reference. Next, we used that same assembly of <italic toggle="yes">D. gyrociliatus</italic> to search for USCOs, this time using USCOs from the leech <italic toggle="yes">Helobdella robusta</italic> as the reference, a clitellate annelid that diverged at least 400 mya from <italic toggle="yes">D. gyrociliatus</italic> (<xref rid="evad227-B15" ref-type="bibr">Erséus et al. 2020</xref>). Finally, we compared our program to ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM 2 (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). For this comparison, we also subsampled the aforementioned <italic toggle="yes">D. gyrociliatus</italic> short reads in order to simulate various sequencing coverages. We decided not to include the software GeMoMa (<xref rid="evad227-B25" ref-type="bibr">Keilwagen et al. 2016</xref>) in this comparison, as it heavily relies on the availability of reference genomic or transcriptomic data. Read2Tree (<xref rid="evad227-B14" ref-type="bibr">Dylus et al. 2023</xref>) has also not been included in the comparisons, as its focus is tree inference and not marker retrieval.</p>
      <p>We compared the retrieved translated and stitched contigs, hereafter called “recovered markers,” to the reference <italic toggle="yes">D. gyrociliatus</italic> USCOs. For each reference sequence, the evaluation included percent identical positions out of all aligned positions as well as percent of reference sequence positions covered by the recovered markers. Patchwork automatically generates these statistics and produces a detailed output for each reference as well as an aggregated output over all references.</p>
    </sec>
    <sec id="evad227-s1.2">
      <title>Effect of Genome Fragmentation on Accuracy</title>
      <p>In the initial setup, we assessed the accuracy of Patchwork using a high-quality query assembly and 815 USCO reference sequences from the same species, <italic toggle="yes">D. gyrociliatus</italic>, and thereby exploring the program's performance for the hypothetical case where the entire set of reference sequences should be recoverable as exactly matching stitched contigs from the query sequences. We retrieved all of the initial 815 markers. On average, 95.9% of all aligned positions were identical matches, with a mean query coverage of 92.2%; this equals a combined measure of 88.4% identical matches for all reference positions, whether aligned to query residues or not (<xref rid="evad227-F2" ref-type="fig">Fig. 2</xref> and <xref rid="evad227-T1" ref-type="table">Table 1</xref>).</p>
      <fig position="float" id="evad227-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Percent identity and query coverage in markers based on a Patchwork analysis of a SPAdes assembly of <italic toggle="yes">D. gyrociliatus</italic>, targeting 815 single-copy orthologs from the same species.</p>
        </caption>
        <graphic xlink:href="evad227f2" position="float"/>
      </fig>
      <table-wrap position="float" id="evad227-T1">
        <label>Table 1</label>
        <caption>
          <p>Results from Patchwork when using a <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as the query and USCOs from a long-read assembly of <italic toggle="yes">D. gyrociliatus</italic> as a reference</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Variable</th>
              <th align="center" rowspan="1" colspan="1">Mean</th>
              <th align="center" rowspan="1" colspan="1">Min</th>
              <th align="center" rowspan="1" colspan="1">Median</th>
              <th align="center" rowspan="1" colspan="1">Max</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference length</td>
              <td rowspan="1" colspan="1">447.606</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">351.0</td>
              <td rowspan="1" colspan="1">2,748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query length</td>
              <td rowspan="1" colspan="1">407.953</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">322.0</td>
              <td rowspan="1" colspan="1">2,553</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Matches</td>
              <td rowspan="1" colspan="1">385.075</td>
              <td rowspan="1" colspan="1">24</td>
              <td rowspan="1" colspan="1">306.0</td>
              <td rowspan="1" colspan="1">2,549</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mismatches</td>
              <td rowspan="1" colspan="1">21.207</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">1,075</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Deletions</td>
              <td rowspan="1" colspan="1">42.131</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">5.0</td>
              <td rowspan="1" colspan="1">1,097</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query coverage</td>
              <td rowspan="1" colspan="1">92.181</td>
              <td rowspan="1" colspan="1">5.22</td>
              <td rowspan="1" colspan="1">98.71</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identity</td>
              <td rowspan="1" colspan="1">95.887</td>
              <td rowspan="1" colspan="1">30.91</td>
              <td rowspan="1" colspan="1">100.0</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="evad227-s1.3">
      <title>Effect of Reference Divergence</title>
      <p>In the second iteration, we aligned a set of high-coverage query assemblies against a very distant reference set, in order to estimate the program's performance when using highly divergent sequences as reference. For this purpose, the same <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as in the previous evaluation served as query sequence set, and 957 near-USCOs from the annotated genome of the leech <italic toggle="yes">H. robusta</italic> were used as a reference. We retrieved 943 out of the 957 <italic toggle="yes">H. robusta</italic> reference sequences. Of these, 769 successfully aligned back to 1 and only 1 of the 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs that were considered homologous to the <italic toggle="yes">H. robusta</italic> set (<xref rid="evad227-F3" ref-type="fig">Fig. 3</xref> and <xref rid="evad227-T2" ref-type="table">Table 2</xref>). For these 769 retrieved markers, the average percent identity measure was 89%, with a mean query coverage of 74.5%. Put differently, the recovered markers had an average of 67.2% identical matches against all reference positions.</p>
      <fig position="float" id="evad227-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Percent identity and query coverage in markers based on a Patchwork analysis of a SPAdes assembly of <italic toggle="yes">D. gyrociliatus</italic>, targeting 957 single-copy orthologs from the leech <italic toggle="yes">H. robusta</italic>.</p>
        </caption>
        <graphic xlink:href="evad227f3" position="float"/>
      </fig>
      <table-wrap position="float" id="evad227-T2">
        <label>Table 2</label>
        <caption>
          <p>Results from Patchwork when using a <italic toggle="yes">D. gyrociliatus</italic> SPAdes assembly as the query and USCOs from <italic toggle="yes">H. robusta</italic> as a reference</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Variable</th>
              <th align="center" rowspan="1" colspan="1">Mean</th>
              <th align="center" rowspan="1" colspan="1">Min</th>
              <th align="center" rowspan="1" colspan="1">Median</th>
              <th align="center" rowspan="1" colspan="1">Max</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference length</td>
              <td rowspan="1" colspan="1">448.025</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">351.0</td>
              <td rowspan="1" colspan="1">2.748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query length</td>
              <td rowspan="1" colspan="1">309.93</td>
              <td rowspan="1" colspan="1">31</td>
              <td rowspan="1" colspan="1">259.0</td>
              <td rowspan="1" colspan="1">2.326</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Matches</td>
              <td rowspan="1" colspan="1">249.126</td>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">195.0</td>
              <td rowspan="1" colspan="1">2.326</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mismatches</td>
              <td rowspan="1" colspan="1">30.234</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">7.0</td>
              <td rowspan="1" colspan="1">355</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">deletions</td>
              <td rowspan="1" colspan="1">8.319</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">2.0</td>
              <td rowspan="1" colspan="1">268</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Query coverage</td>
              <td rowspan="1" colspan="1">74.540</td>
              <td rowspan="1" colspan="1">5.41</td>
              <td rowspan="1" colspan="1">82.78</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identity</td>
              <td rowspan="1" colspan="1">89.008</td>
              <td rowspan="1" colspan="1">25.46</td>
              <td rowspan="1" colspan="1">96.99</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The recovered markers were evaluated against the set of 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs that were considered homologous to sequences in the <italic toggle="yes">H. robusta</italic> reference set.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="evad227-s1.4">
      <title>Program Comparison</title>
      <p>In the third setup, we compared the performance and runtime for Patchwork to that of ALiBaSeq (<xref rid="evad227-B26" ref-type="bibr">Knyshov et al. 2021</xref>) and aTRAM 2 (<xref rid="evad227-B2" ref-type="bibr">Allen et al. 2018</xref>), using a <italic toggle="yes">D. gyrociliatus</italic> short-read data set at different sequence coverage levels (1×, 3×, 5×, 10×, 20×, and 40×). While Patchwork can use both reads and assembled contigs as an input, ALiBaSeq uses assembled contigs, and aTRAM 2 is read based. Performance was assessed using a combined measure for accuracy and completeness of the recovered USCO markers annotated, hereafter called “total percent identity.” Patchwork with <italic toggle="yes">D. gyrociliatus</italic> assembly data performs best over almost all data sets (<xref rid="evad227-F4" ref-type="fig">Fig. 4</xref>), reaching as much as 62% total percent identity for data with at least 10× coverage. Only with a coverage of 1×, <italic toggle="yes">D. gyrociliatus</italic> read-based data seem to be better suited for marker retrieval. Cutoff thresholds during the assembly might lead to discarding part of the sequence data that is retained when using reads, therefore causing the latter to achieve higher query coverage for the 1× data set. Note that query coverage improves especially for read data when tantan masking in DIAMOND is disabled (i.e. by providing --masking 0 as an argument). For data sets with higher coverage, running Patchwork on read data still achieves well over 50% total percent identity. Using read data therefore is a valid option that could be considered if the compute resources necessary for assembling the sequences are scarce. The performance of Patchwork stays approximately constant for data sets with coverages of at least 10×, independent of the used data. By comparison, ALiBaSeq achieves approximately 7% less total percent identity than Patchwork with assemblies for all data sets and performs only slightly better than Patchwork with read data for a coverage over 10×. aTRAM 2, on the other hand, performs comparatively poorly, with a maximum total percent identity of about 22% for the data set with 20× coverage. This is mostly due to the small number of recovered markers; the markers themselves generally have a high percent identity value. For a coverage of 1×, aTRAM 2 was unable to recover any stitched contigs at all. The program was also not evaluated for the data set of 40× coverage as it had not completed within the cluster's maximum runtime of 5 d.</p>
      <fig position="float" id="evad227-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Accuracy and completeness of the recovered marker sequences for the different <italic toggle="yes">D. gyrociliatus</italic> data sets when run against a reference set of <italic toggle="yes">H. robusta</italic> USCOs. Accuracy and completeness were jointly measured as percent identical out of all aligned positions multiplied with the total percentage of aligned nongap positions. This integrated measure avoids a distorted performance estimation, e.g. due to small number of recovered markers but high percent identity in the aligned positions. Patchwork was run with <italic toggle="yes">D. gyrociliatus</italic> assemblies unless indicated differently. ALiBaSeq received assemblies, while aTRAM 2 received reads as input.</p>
        </caption>
        <graphic xlink:href="evad227f4" position="float"/>
      </fig>
      <p>Both Patchwork and ALiBaSeq are very fast; the programs terminated in under 5 min when using assembly data (<xref rid="evad227-F5" ref-type="fig">Fig. 5</xref>). The runtimes fluctuated only slightly between data sets. Using Patchwork with reads required more time for larger data sets, but even for the largest evaluated data set, it finished after half an hour. By comparison, running aTRAM 2 took days for all data sets.</p>
      <fig position="float" id="evad227-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>Program runtime for each <italic toggle="yes">D. gyrociliatus</italic> data set. Patchwork was run both as a script and as a compiled program. It received <italic toggle="yes">D. gyrociliatus</italic> assemblies unless indicated differently. ALiBaSeq was run on assemblies, while aTRAM 2 received reads as input.</p>
        </caption>
        <graphic xlink:href="evad227f5" position="float"/>
      </fig>
    </sec>
    <sec id="evad227-s1.5">
      <title>Patchwork in a Phylogenomic Context</title>
      <p>To demonstrate how our software could be utilized in a phylogenomic pipeline, we used it to retrieve a set of 957 metazoan-specific USCOs from a phthirapteran data set (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>). When reusing a set of 15 lice Operaional Taxonomic Units (Hexapoda and Phthiraptera), we were able to retrieve all 957 USCOs, for all taxa. The resulting alignments contained few gaps for any marker; i.e. most markers were well above the 90% aligned position trimming threshold. The trimmed alignment contained 3,454,320 positions in total, compared to 5,383,303 before trimming (i.e. ∼64% positions were retained after trimming). Our phylogenetic reconstruction resulted in a well-supported tree (<xref rid="evad227-F6" ref-type="fig">Fig. 6</xref>), which is largely congruent with the original analysis (<xref rid="evad227-B1" ref-type="bibr">Allen et al. 2017</xref>), with the exception of the position of <italic toggle="yes">Haematopinus macronemis</italic>. However, this placement is the only part of the tree that is not well supported, and reasons for incongruence are unclear, which could be, e.g. slightly different choice of phylogenetic markers. However, in general, the approach worked very well, and for 951 of 954 USCOs, nearly complete exonic data could be retrieved.</p>
      <fig position="float" id="evad227-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>Phylogenetic analysis of Phthiraptera relationships as recovered from a Maximum Likelihood analysis of a combined supermatrix using USCOs as recovered by Patchwork. Analysis was conducted using IQ-TREE 2 including model and partition finding. Bootstrap values from 1,000 pseudoreplicates are given at the branches.</p>
        </caption>
        <graphic xlink:href="evad227f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="evad227-s2">
    <title>Discussion</title>
    <p>Patchwork is a new software for quickly mining phylogenetic markers from WGS data. Since Patchwork can retrieve homologous regions even in distantly related taxa, this program lends itself especially well for recovering phylogenetic markers for phylogenomic studies. It is simultaneously an efficient way for increasing marker occupancy in poorly assembled genomes and/or in the presence of multilocus exons. Finally, Patchwork allows the user to combine 2 different data types—i.e. transcriptomic and genomic data—into a single data set, thus further enabling an even larger taxon sampling and encouraging data reusability.</p>
    <p>Special consideration should be taken to avoid the creation of chimeric sequences. One way in which such sequences may arise is when orthologous (i.e. genes related via a speciation event) and paralogous (i.e. genes related via a gene duplication event) sequences are merged together. To circumvent this issue, we recommend that the user limits the use of reference sequences to near-USCOs. Different lineage-specific sets of such USCOs are available based on carefully analyzed sets of homologous genes from a curated database (<xref rid="evad227-B33" ref-type="bibr">Manni et al. 2021</xref>). Besides their use in evaluating the quality of genomic and metagenomic data, USCOs became also prominent as preselected marker sets in phylogenomic analyses (<xref rid="evad227-B45" ref-type="bibr">Sahbou et al. 2022</xref>) and have been recently proposed as a unifying framework for DNA-based species delimitation (<xref rid="evad227-B12" ref-type="bibr">Dietz et al. 2023</xref>). Many programs, e.g. the aforementioned program BUSCO, exist for retrieving such sequences from an already assembled genome, and these could be used as reference sequences (<xref rid="evad227-B53" ref-type="bibr">Waterhouse et al. 2018</xref>). Additionally, several downstream analysis tools are available to control for the presence of possible cross-contamination, (unexpected) paralogous copies, or other artifacts confounding systematic studies (<xref rid="evad227-B32" ref-type="bibr">Lozano-Fernandez 2022</xref>). To control for the possible artifactual inclusion of stretches of noncoding sequences, the tool PREQUAL could be used to detect such and remove such regions (<xref rid="evad227-B54" ref-type="bibr">Whelan et al. 2018</xref>). Finally, multiple alignment tools such as MACSE (<xref rid="evad227-B40" ref-type="bibr">Ranwez et al. 2018</xref>) can be used to deal with putative confounding problems from the occurrence of premature stop codons, which might occur when working with data with coverage genomic data.</p>
    <p>The accuracy and the robustness of the results depends on how closely related the target and the reference species under study are. The difficulty stems from the ability to accurately predict noncoding regions in aligned contigs; because alignment trimming relies on gap-excluded identity, choosing the correct cutoff threshold becomes increasingly easier as the level of identity approaches 100% (the identity of noncoding regions is likely to stay the same, while the identity to coding regions increases). On the upside, high-quality genomes for practically all major lineages exist and are readily available online (<xref rid="evad227-B16" ref-type="bibr">Formenti et al. 2022</xref>). Moreover, and not surprisingly, the coverage of the input read data sets correlates with the performance of retrieving single-copy marker genes. Similar to a previous study (<xref rid="evad227-B31" ref-type="bibr">Liu et al. 2021</xref>), we also find that a coverage of 10× and more should be targeted when designing genome skimming studies. However, as seen in the proof of principle, even lower coverages enable the construction of phylogenomic data matrices. For very low-coverage data sets, the read-based mode outperforms assembly-based analyses. For the latter, assembly size seems to be more important than contiguity.</p>
    <p>In summary, Patchwork allows the retrieval of (putatively) single-copy genes from genome skimming data sets at different sequencing coverage with high computational speed. Availability and quality of biological specimens are becoming the major bottleneck for phylogenomic studies. Especially for phylogenomic studies relying on collection-based material, Patchwork offers a fast and efficient way for marker retrieval from short-read sequence data sets.</p>
  </sec>
  <sec sec-type="materials|methods" id="evad227-s3">
    <title>Materials and Methods</title>
    <p>Patchwork is implemented in Julia (<xref rid="evad227-B3" ref-type="bibr">Bezanson et al. 2017</xref>), a just-in-time (JIT)–compiled programming language that is typically faster than interpreted languages such as Python or R. Existing Julia bioinformatics packages such as BioAlignments.jl (<ext-link xlink:href="https://github.com/BioJulia/BioAlignments.jl" ext-link-type="uri">https://github.com/BioJulia/BioAlignments.jl</ext-link>) and BioSequences.jl (<ext-link xlink:href="https://github.com/BioJulia/BioSequences.jl" ext-link-type="uri">https://github.com/BioJulia/BioSequences.jl</ext-link>) were used to speed up the development process. Patchwork is obtainable from GitHub (<ext-link xlink:href="https://github.com/fethalen/Patchwork" ext-link-type="uri">https://github.com/fethalen/Patchwork</ext-link>), is distributed under the GPLv3 license, and targets both Linux and macOS (Windows users may run Patchwork by using the Windows Subsystem for Linux).</p>
    <p>In order to facilitate reproducibility, a Docker container (<xref rid="evad227-B36" ref-type="bibr">Merkel 2014</xref>) of Patchwork is also distributed via the BioContainers framework (<xref rid="evad227-B11" ref-type="bibr">da Veiga Leprevost et al. 2017</xref>). Similarly, we also provide an Apptainer definition file for users of the Apptainer/Singularity platform. Apptainer (formerly known as Singularity; <xref rid="evad227-B28" ref-type="bibr">Kurtzer et al. 2017</xref>) is another container platform that targets shared systems such as High-Performance Computing platforms, which are commonplace at universities today.</p>
    <p>Most phylogenomic studies include more than a handful of taxa, and concatenating these manually gets increasingly tedious as the data set size increases. Therefore, Patchwork also includes a set of complementary tools for streamlining the downstream analysis. For example, the script multi_patchwork.sh lets the user run Patchwork on multiple input files and concatenate homologous sequences from different taxa into 1 file.</p>
    <sec id="evad227-s3.1">
      <title>Initial Alignment and Database Construction</title>
      <p>First, all reference protein sequences, regardless of whether they are spread across multiple FASTA files or not, are pooled together into a single FASTA file, from which a DIAMOND database is created. There is also the option to use an existing DIAMOND-formatted database or a BLAST output file in a tabular format by using the --database or --tabular options, respectively. These files are both provided in the output of Patchwork and can thus be reutilized when trying out different parameters. In either case, DIAMOND's BLASTX algorithm is used to align translated nucleotide sequences to 1 or more reference protein sequences.</p>
      <p>Like DIAMOND, Patchwork, by default, scores alignments using the substitution matrix BLOSUM62 (<xref rid="evad227-B20" ref-type="bibr">Henikoff and Henikoff 1996</xref>), a gap open penalty of 11, and a gap extension penalty of 1. Other built-in or custom substitution matrices may be used in place of the default option. User-chosen gap open penalties and gap extension penalties may also be set, as long as they fall within the limits set by the substitution matrix of choice. For the users’ convenience, Patchwork supports a number of different DIAMOND options that can usually be provided in the same manner as in DIAMOND itself.</p>
      <p>For all Patchwork benchmarks, we observed that disabling DIAMOND's tantan masking (<xref rid="evad227-B17" ref-type="bibr">Frith 2011</xref>), by setting --masking 0, as described in <xref rid="evad227-T2" ref-type="table">Table 2</xref>, yielded higher query coverages. This effect was more pronounced for read data sets but could also be detected in assembled data sets. On the other hand, the number of exact matches in all aligned positions (i.e. percent identity) between the query and the reference decreased slightly. When combining both measures, however, disabling tantan masking improved the overall results.</p>
      <p>Since the alignment search is likely to result in more than 1 hit per reference region, certain measures are taken to ensure that none of these hits are overlapping: They are, “hit stitching” (also known as contig or exon stitching; i.e. merging of overlapping regions), removal of unaligned residues, and concatenation of nonoverlapping regions.</p>
    </sec>
    <sec id="evad227-s3.2">
      <title>Hit Stitching</title>
      <p>During “hit stitching,” all alignments made between the query region and the target sequence are merged in a way such that only the highest-scoring segment pair (HSP) for each region is retained. This results in a single, continuous sequence, and, as a consequence, some hits may be removed entirely (see also <xref rid="evad227-F1" ref-type="fig">Fig. 1</xref>).</p>
      <p>The “hit stitching” algorithm works as follows: First, query regions are sorted according to how they align to the target sequence—from first to last—and are added to the stack. Next, each pair of query regions on the stack is checked for overlaps. In case of an overlap, first, all regions are sorted by their first and last position at which they align to the reference sequence. The first region is added to the stack. Its start and end coordinates are then compared with those of the following region to check if they are overlapping. If they are not overlapping, the next adjacent region is added to the stack and compared with the following region. If they are overlapping, however, the region that is currently at the top of the stack is removed. The overlapping parts of this region and the next region are realigned to identify the best-scoring sequence at that particular interval. Then, based on the realignment score, the sequences are sliced such that the best-scoring sequence is retained at the overlapping region and so that the nonoverlapping, flanking parts of both regions, if existing, are preserved as well. Thus, a maximum of 3 sliced region parts are then added to the stack as new, separate regions: The sequence part preceding the overlap, which originates from the first region, the highest-scoring sequence at the overlap, which may be from either of the 2, and the sequence part that follows the overlap, which originates from the second region. The algorithm then continues in the same manner, comparing the topmost region of the stack with the following region, until all overlaps are removed and all regions have been added to the stack. This procedure may require multiple iterations, since in every run, only each pair of consecutive regions are compared and merged.</p>
      <p>Different aligned regions from the same contig are allowed to be stitched together. While “hit stitching” may result in the creation of chimeric sequences (i.e. 2 or more biological sequences incorrectly joined together), this procedure has the potential to increase coverage and to (correctly) join 2 or more regions that are located on separate contigs due to incomplete assembly or sequencing errors.</p>
    </sec>
    <sec id="evad227-s3.3">
      <title>Alignment Masking</title>
      <p>At this step, unaligned residues, ambiguous amino acid characters, and stop codons (also known as “termination codons”) are all removed from the resulting query sequence. Query sequences may contain residues that do not align to any particular region of the subject sequence. Such regions may be noncoding regions or simply insertions. In either case, unaligned residues are removed on the basis that inserts are less likely to constitute phylogenetically informative sites and risks introducing untranslated regions and therefore biasing the downstream analysis. Similarly, ambiguous amino acids are most likely noninformative, and stop codons are a clear indicator that noncoding characters have been included in the alignment. Although such regions are likely to be removed in the subsequent step (see above), the user may choose to keep stop codons and/or ambiguous amino acid characters by providing the flags --retain-stops and/or --retain-ambiguous.</p>
    </sec>
    <sec id="evad227-s3.4">
      <title>Sliding Window–Based Alignment Trimming</title>
      <p>One side effect of aligning translated nucleotide sequences to amino acid sequences is that one might recover noncoding portions of DNA, provided that the following 2 conditions are fulfilled: (i) the noncoding DNA is located in between 2 or more coding portions and (ii) there is a sequence region in the reference sequence that the noncoding region can align to. In the resulting alignment, noncoding portions are characterized by many indels, intercepted by occasional matches. The alignment of noncoding portions of DNA can already be observed in the alignments produced by DIAMOND, and thus, this side effect does not stem from Patchwork itself. In fact, the Patchwork algorithm will only include noncoding parts if nothing else aligns better to the affected region of the reference sequence.</p>
      <p>To mitigate this effect, we have implemented a sliding window–based alignment trimming approach to rid the alignments from these unwanted regions. This works by scanning the alignment from left to right, cutting all regions where the average distance between query and reference is above the user-provided distance threshold. The window size and the distance threshold can both be set by the user, but need not be, since we implemented default values for both. This step can also be skipped over in its entirety. This approach tries to avoid cases where a single bad, but correct, match would have otherwise been cut out.</p>
    </sec>
    <sec id="evad227-s3.5">
      <title>Concatenation and Realignment of Remaining Regions</title>
      <p>Finally, the resulting set of ordered, nonoverlapping sequence regions are concatenated into 1 continuous sequence. The concatenated sequence is then realigned to the reference to obtain the final output sequence and alignment score.</p>
    </sec>
    <sec id="evad227-s3.6">
      <title>Benchmark</title>
      <p>Patchwork v.0.5.1 was continuously run using Julia v.1.8.2 and DIAMOND v.2.0.13 (<xref rid="evad227-B7" ref-type="bibr">Buchfink et al. 2021</xref>), with the options --ultra-sensitive --frameshift 15 --masking 0. All analyses were performed on the high-performance computing cluster maintained by the <italic toggle="yes">Gesellschaft für wissenschaftliche Datenverarbeitung mbH Göttingen</italic> (GWDG), running the Scientific Linux release 7.9 (Nitrogen) operating system with a Linux kernel of version 3.10.0. All runs were allocated 32 Intel Xeon Platinum 9242 CPUs running at 2.30 GHz. Elapsed time was calculated as reported by Slurm.</p>
    </sec>
    <sec id="evad227-s3.7">
      <title>Effect of Genome Fragmentation on Accuracy</title>
      <p>A publicly available set of Illumina short-read sequences of <italic toggle="yes">D. gyrociliatus</italic> (<xref rid="evad227-B34" ref-type="bibr">Martín-Durán et al. 2021</xref>) was used for the query set. We used SPAdes v.3.15.3 to generate the de novo assembly, using a <italic toggle="yes">K</italic>-mer size of 55. A set of 815 <italic toggle="yes">D. gyrociliatus</italic> USCOs retrieved from the published high-quality genome assembly (GenBank, accession: <ext-link xlink:href="GCA_904063045.1" ext-link-type="DDBJ/EMBL/GenBank">GCA_904063045.1</ext-link>) served as the reference.</p>
    </sec>
    <sec id="evad227-s3.8">
      <title>Effect of Reference Divergence</title>
      <p>We reused the de novo assembly from the previous evaluation for the query, while a set of 957 near-USCOs from the annotated genome of the leech <italic toggle="yes">H. robusta</italic> (GenBank, accession: <ext-link xlink:href="GCA_000326865.1" ext-link-type="DDBJ/EMBL/GenBank">GCA_000326865.1</ext-link>) were used as reference sequences. We used the same parameter settings described above. For this evaluation, we did not use Patchwork's own accuracy and completeness assessment, because the true number of identical matches and the amount of query coverage are not known between the 2 divergent species <italic toggle="yes">D. gyrociliatus</italic> and <italic toggle="yes">H. robusta</italic>. We therefore chose to compare the recovered markers to a subset of the <italic toggle="yes">D. gyrociliatus</italic> USCOs described in the previous benchmark. More specifically, only those <italic toggle="yes">D. gyrociliatus</italic> USCOs that produced a hit when searching against the <italic toggle="yes">H. robusta</italic> USCOs with DIAMOND v2.0.13 in ultrasensitive mode were used, since only these were considered “recoverable” in this setup. The resulting <italic toggle="yes">D. gyrociliatus</italic> USCO set contains 778 sequences; 37 sequences were discarded. The set of recovered markers was searched against the reference USCO set using DIAMOND in --ultra-sensitive mode. For each reference sequence, we retrieved only the marker that produced the highest bit score during the alignment step. We then evaluated percent identical positions out of all aligned positions as well as percent of reference sequence positions covered by the recovered markers.</p>
    </sec>
    <sec id="evad227-s3.9">
      <title>Program Comparison</title>
      <p>In order to generate data sets at different sequencing coverages, we subsampled the trimmed <italic toggle="yes">D. gyrociliatus</italic> reads downloaded from NCBI GenBank. Corresponding read pairs were selected randomly from the paired-end data. Subsampling was done using Subsample.jl, a Julia package distributed together with Patchwork. The resulting data sets have coverages of 1×, 3×, 5×, 10×, 20×, and 40×.</p>
      <p>For each of the data sets, we produced a short-read-only de novo assembly, as ALiBaSeq is designed for assembly data, while aTRAM 2 requires read data and Patchwork can process both. We used the assembler SPAdes v.3.15.3 (<xref rid="evad227-B38" ref-type="bibr">Nurk et al. 2013</xref>), with a <italic toggle="yes">K</italic>-mer size of 33, and the quality of the assembly was assessed using QUAST v.5.0.2 (<xref rid="evad227-B18" ref-type="bibr">Gurevich et al. 2013</xref>). We aligned the <italic toggle="yes">D. gyrociliatus</italic> reads and assemblies against the same set of <italic toggle="yes">H. robusta</italic> USCOs mentioned before.</p>
      <p>ALiBaSeq v.1.2 was run with the <italic toggle="yes">D. gyrociliatus</italic> assemblies described above. The program requires BLAST; the version here used was 2.11.0. The program builds a database from the <italic toggle="yes">D. gyrociliatus</italic> sequences and searches this database with the <italic toggle="yes">H. robusta</italic> sequences before stitching the hits together. We set the parameters according to the guide for a protein-based search without reciprocal search, as explained in their documentation on GitHub (see the README file): -x a [extract all hits and join into (super)contigs] -f S [single alignment table (TBLASTN result file)] -e 1e-10 [<italic toggle="yes">e</italic>-value cutoff for further processing of TBLASTN hits] -c 1 [extract single best (super)contig] --amalgamate-hits [scoring scheme for (super)contigs] --is [enable contig stitching] –ac aa-tdna [search protein “baits” (<italic toggle="yes">H. robusta</italic> USCOs) against tDNA “target” database (<italic toggle="yes">D. gyrociliatus</italic> reads)].</p>
      <p>We ran aTRAM v.2.4.3 with the sampled <italic toggle="yes">D. gyrociliatus</italic> read data sets. The program further requires BLAST, as well as a de novo assembler, and exonerate. We used BLAST v.2.11.0 and exonerate v.2.2.0 (<xref rid="evad227-B50" ref-type="bibr">Slater and Birney 2005</xref>) and employed SPAdes v.3.15.3 for the assembly step. The full aTRAM 2 pipeline consists of 3 consecutive steps: Firstly, the preparation of a database from the <italic toggle="yes">D. gyrociliatus</italic> reads, secondly, the assembly of different loci, and lastly, a reference-guided stitching process. The parameter settings for the core module of aTRAM 2 as well as the stitcher were as follows: --evalue 1e-10 --file-filter “*.filtered contigs.fasta” --overlap N.</p>
      <p>Patchwork v.0.5.1 was run with both the sampled <italic toggle="yes">D. gyrociliatus</italic> read data sets and the assemblies we produced for these sampled read data. We ran the uncompiled program using Julia v.1.8.2 as well as the compiled version on each data set in order to perform runtime comparisons. Patchwork achieves all its objectives in a 1-step procedure, i.e. can be called with a single command, unlike ALiBaSeq and aTRAM 2. The program builds a DIAMOND database from the <italic toggle="yes">H. robusta</italic> sequences and, after obtaining <italic toggle="yes">D. gyrociliatus</italic> hits, proceeds to stitch them together. All nondefault parameter settings for Patchwork were as described above. They were used for both read-based runs and assembly-based runs.</p>
      <p>We ran the 3 programs with their respective parameter settings on the different <italic toggle="yes">D. gyrociliatus</italic> data sets against the <italic toggle="yes">H. robusta</italic> USCO set described above, which contains 957 sequences. The aTRAM 2 run for the 40× coverage read data set was ended prematurely because it had not terminated after 5 d. In a following step, the recovered markers produced by each program for each data set were evaluated with respect to completeness and accuracy of the resulting sequences by comparing them to the same set of 778 <italic toggle="yes">D. gyrociliatus</italic> USCOs mentioned above, again because only this subset could be recovered by the programs in this setup. ALiBaSeq and aTRAM 2 output DNA sequences that contain the ambiguous nucleotide N in all positions that could not be recovered during stitching. These N were removed for the subsequent evaluation steps because they distort the query coverage measure; the amount of a reference sequence covered by the recovered marker is artificially increased due to the uninformative inserted N.</p>
      <p>Completeness and accuracy were measured jointly as percent identical aligned positions multiplied with the total amount of aligned, or recovered, positions (here called <italic toggle="yes">p</italic><sub>identical, cov</sub>):</p>
      <disp-formula id="UM0001">
        <mml:math id="UM1" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>p</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">identical</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">cov</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">match</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">aligned</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>⋅</mml:mo>
            <mml:mrow>
              <mml:mi mathvariant="normal">cov</mml:mi>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0002">
        <mml:math id="UM2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="normal">cov</mml:mi>
          </mml:mrow>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">recovered</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">length</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">recovered</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">USCOs</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">length</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">USCOs</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p><italic toggle="yes">n</italic><sub>match</sub> being the total number of exact matches in all alignments between recovered markers and reference USCOs and <italic toggle="yes">n</italic><sub>aligned</sub> the total number of aligned, i.e. nongap, positions. The coverage cov was computed as the ratio of the total lengths of all recovered markers <italic toggle="yes">s</italic><sub>recovered</sub> and all reference USCOs <italic toggle="yes">s</italic><sub>USCOs</sub>. We chose to combine the measures for accuracy of the recovered markers, i.e. percent identical out of all aligned positions, and completeness or query coverage, i.e. percent recovered positions, in order to avoid a distorted outcome. For example, a program might recover only a very small number of markers but these with high percent identity, such that using only the percent identity measure would have resulted in an overestimation of the program's performance.</p>
    </sec>
    <sec id="evad227-s3.10">
      <title>Patchwork in a Phylogenomic Context</title>
      <p>We retrieved the raw reads from the NCBI Sequence Read Archive (SRA accession SRR5088465, SRR5088468, SRR5308129 SRR5308123, SRR5088469 SRR5088471, SRR5088472, SRR5088473, SRR1182279, SRR5308136, SRR5308138, SRR5088474, SRR5088475, SRR5308112, and SRR5088466) using prefetch, vdb-validate, and fasterq-dump (with the flag --split-spot), all from the NCBI SRA toolkit (<xref rid="evad227-B29" ref-type="bibr">Leinonen et al. 2011</xref>). We ran Patchwork v.0.5.1 with each of the specimens as query input and a set of 957 near-USCOs from the leech <italic toggle="yes">H. robusta</italic> as reference sequences (see <xref rid="evad227-T2" ref-type="table">Table 2</xref> for parameter settings). A multiple sequence alignment (MSA) was constructed for each of these 957 loci using MAFFT (<xref rid="evad227-B23" ref-type="bibr">Katoh and Standley 2013</xref>) with the options –globalpair --ep 0.123. The resulting alignments were trimmed with trimAl (<xref rid="evad227-B9" ref-type="bibr">Capella-Gutiérrez et al. 2009</xref>), removing all positions with more than 90% gaps but retaining at least 60% of each alignment (options -gt 0.9 and -cons 60, respectively). We used FASconcat-G (<xref rid="evad227-B27" ref-type="bibr">Kück and Longo 2014</xref>) to concatenate the trimmed alignments into a supermatrix. This supermatrix was then input into IQ-TREE 2 (<xref rid="evad227-B37" ref-type="bibr">Minh et al. 2020</xref>), alongside its corresponding gene partition file, to reconstruct the phylogeny using the maximum likelihood (ML) approach. We ran IQ-TREE 2 with extended model selection and tree inference, calculating 1,000 replicates for the ultrafast bootstrap (command line options -m MFP and -B 1000, respectively).</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>This work used the Scientific Compute Cluster at GWDG, the joint data center of Max Planck Society for the Advancement of Science (MPG) and University of Göttingen. We acknowledge support by the Open Access Publication Funds of the Göttingen University.</p>
  </ack>
  <sec id="evad227-s4">
    <title>Funding</title>
    <p>This work was supported by the German Research Foundation (DFG) BL787/8-1.</p>
  </sec>
  <sec sec-type="data-availability" id="evad227-s5">
    <title>Data Availability</title>
    <p>The data underlying this article are available via GitHub at <ext-link xlink:href="https://github.com/animal-evolution-and-biodiversity/benchmarking-patchwork" ext-link-type="uri">https://github.com/animal-evolution-and-biodiversity/benchmarking-patchwork</ext-link>. Patchwork is distributed under the GPLv3 license via GitHub at <ext-link xlink:href="https://github.com/fethalen/patchwork" ext-link-type="uri">https://github.com/fethalen/patchwork</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature Cited</title>
    <ref id="evad227-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Boyd</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>NP</given-names></string-name>, <string-name><surname>Vachaspati</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Warnow</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Huang</surname>  <given-names>DI</given-names></string-name>, <string-name><surname>Grady</surname>  <given-names>PGS</given-names></string-name>, <string-name><surname>Bell</surname>  <given-names>KC</given-names></string-name>, <string-name><surname>Cronk</surname>  <given-names>QCB</given-names></string-name>, <string-name><surname>Mugisha</surname>  <given-names>L</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Phylogenomics from whole genome sequences using aTRAM</article-title>. <source>Syst Biol</source>. <year>2017</year>:<volume>66</volume>(<issue>5</issue>):<fpage>786</fpage>–<lpage>798</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syw105</pub-id>.<pub-id pub-id-type="pmid">28123117</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>LaFrance</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Folk</surname>  <given-names>RA</given-names></string-name>, <string-name><surname>Johnson</surname>  <given-names>KP</given-names></string-name>, <string-name><surname>Guralnick</surname>  <given-names>RP</given-names></string-name></person-group>. <article-title>aTRAM 2.0: an improved, flexible locus assembler for NGS data</article-title>. <source>Evol Bioinform</source>. <year>2018</year>:<volume>14</volume>:<comment>1176934318774546. </comment><pub-id pub-id-type="doi">10.1177/1176934318774546</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezanson</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Edelman</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Karpinski</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Shah</surname>  <given-names>VB</given-names></string-name></person-group>. <article-title>Julia: a fresh approach to numerical computing</article-title>. <source>SIAM Rev</source>. <year>2017</year>:<volume>59</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1137/141000671</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name></person-group>. <source>Phylogenomics. An introduction</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer International Publishing</publisher-name>; <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="evad227-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blom</surname>  <given-names>MPK</given-names></string-name></person-group>. <article-title>Opportunities and challenges for high-quality biodiversity tissue archives in the age of long-read sequencing</article-title>. <source>Mol Ecol</source>. <year>2021</year>:<volume>30</volume>(<issue>23</issue>):<fpage>5935</fpage>–<lpage>5948</lpage>. <pub-id pub-id-type="doi">10.1111/mec.15909</pub-id>.<pub-id pub-id-type="pmid">33786900</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bragg</surname>  <given-names>JG</given-names></string-name>, <string-name><surname>Potter</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bi</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Moritz</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>Exon capture phylogenomics: efficacy across scales of divergence</article-title>. <source>Mol Ecol Res</source>. <year>2016</year>:<volume>16</volume>(<issue>5</issue>):<fpage>1059</fpage>–<lpage>1068</lpage>. <pub-id pub-id-type="doi">10.1111/1755-0998.12449</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Reuter</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Drost</surname>  <given-names>H-G</given-names></string-name></person-group>. <article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>. <source>Nature Meth</source>. <year>2021</year>:<volume>18</volume>(<issue>4</issue>):<fpage>366</fpage>–<lpage>368</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-021-01101-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Call</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Mayer</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Twort</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Dietz</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Wahlberg</surname>  <given-names>N</given-names></string-name></person-group><etal>et al</etal>  <year>2021</year>. <article-title>Museomics: phylogenomics of the moth family Epicopeiidae (Lepidoptera) using target enrichment</article-title>. <source>Insect Syst Divers</source>. <volume>5</volume>(<issue>2</issue>):<fpage>6</fpage>. <pub-id pub-id-type="doi">10.1093/isd/ixaa021</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capella-Gutiérrez</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Silla-Martínez</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Gabaldón</surname>  <given-names>T</given-names></string-name></person-group>. <article-title>Trimal: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>  <year>2009</year>:<volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>.<pub-id pub-id-type="pmid">19505945</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dahn</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Mountcastle</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Balacco</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Winkler</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bista</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Schmitt</surname>  <given-names>AD</given-names></string-name>, <string-name><surname>Pettersson</surname>  <given-names>OV</given-names></string-name>, <string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Oliver</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Smith</surname>  <given-names>M</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Benchmarking ultra-high molecular weight DNA preservation methods for long-read and long-range sequencing</article-title>. <source>GigaScience</source>  <year>2022</year>:<volume>11</volume>:<fpage>giac068</fpage>. <pub-id pub-id-type="doi">10.1093/gigascience/giac068</pub-id>.<pub-id pub-id-type="pmid">35946988</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>da Veiga Leprevost</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Grüning</surname>  <given-names>BA</given-names></string-name>, <string-name><surname>Alves Aflitos</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Röst</surname>  <given-names>HL</given-names></string-name>, <string-name><surname>Uszkoreit</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Barsnes</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Perez-Riverol</surname>  <given-names>Y</given-names></string-name></person-group>. <article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>. <source>Bioinformatics</source>  <year>2017</year>:<volume>33</volume>(<issue>16</issue>):<fpage>2580</fpage>–<lpage>2582</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx192</pub-id>.<pub-id pub-id-type="pmid">28379341</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dietz</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Eberle</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Mayer</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Kukowka</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bohacz</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Baur</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Espeland</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Huber</surname>  <given-names>BA</given-names></string-name>, <string-name><surname>Hutter</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Mengual</surname>  <given-names>X</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Standardized nuclear markers improve and homogenize species delimitation in Metazoa</article-title>. <source>Methods Ecol Evol</source>. <year>2023</year>:<volume>14</volume>(<issue>2</issue>):<fpage>543</fpage>–<lpage>555</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.14041</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dodsworth</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Genome skimming for next-generation biodiversity analysis</article-title>. <source>Trends Plant Sci</source>. <year>2015</year>:<volume>20</volume>(<issue>9</issue>):<fpage>525</fpage>–<lpage>527</lpage>. <pub-id pub-id-type="doi">10.1016/j.tplants.2015.06.012</pub-id>.<pub-id pub-id-type="pmid">26205170</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dylus</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Altenhoff</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Majidian</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Sedlazeck</surname>  <given-names>FJ</given-names></string-name>, <string-name><surname>Dessimoz</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>Inference of phylogenetic trees directly from raw sequencing reads using Read2Tree</article-title>. <source>Nat Biotechnol</source>. <year>2023</year>. <pub-id pub-id-type="doi">10.1038/s41587-023-01753-4</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Erséus</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Williams</surname>  <given-names>BW</given-names></string-name>, <string-name><surname>Horn</surname>  <given-names>KM</given-names></string-name>, <string-name><surname>Halanych</surname>  <given-names>KM</given-names></string-name>, <string-name><surname>Santos</surname>  <given-names>SR</given-names></string-name>, <string-name><surname>James</surname>  <given-names>SW</given-names></string-name>, <string-name><surname>Des Creuzé Châtelliers</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Anderson</surname>  <given-names>FE</given-names></string-name></person-group>. <article-title>Phylogenomic analyses reveal a Palaeozoic radiation and support a freshwater origin for clitellate annelids</article-title>. <source>Zool Scr</source>. <year>2020</year>:<volume>49</volume>(<issue>5</issue>):<fpage>614</fpage>–<lpage>640</lpage>. <pub-id pub-id-type="doi">10.1111/zsc.12426</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Theissinger</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Fernandes</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Bista</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Bombarely</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Ciofi</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Crottini</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Godoy</surname>  <given-names>JA</given-names></string-name>, <string-name><surname>Höglund</surname>  <given-names>J</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>The era of reference genomes in conservation genomics</article-title>. <source>Trends Ecol Evol</source>. <year>2022</year>:<volume>37</volume>(<issue>3</issue>):<fpage>197</fpage>–<lpage>202</lpage>. <pub-id pub-id-type="doi">10.1016/j.tree.2021.11.008</pub-id>.<pub-id pub-id-type="pmid">35086739</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frith</surname>  <given-names>MC</given-names></string-name></person-group>. <article-title>A new repeat-masking method enables specific detection of homologous sequences</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>:<volume>39</volume>(<issue>4</issue>):<fpage>e23</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1212</pub-id>.<pub-id pub-id-type="pmid">21109538</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gurevich</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Saveliev</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Vyahhi</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Tesler</surname>  <given-names>G</given-names></string-name></person-group>. <article-title>QUAST: quality assessment tool for genome assemblies</article-title>. <source>Bioinformatics</source>  <year>2013</year>:<volume>29</volume>(<issue>8</issue>):<fpage>1072</fpage>–<lpage>1075</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>.<pub-id pub-id-type="pmid">23422339</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heath</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Hedtke</surname>  <given-names>SM</given-names></string-name>, <string-name><surname>Hillis</surname>  <given-names>DM</given-names></string-name></person-group>. <year>2008</year>. <article-title>Taxon sampling and the accuracy of phylogenetic analyses</article-title>. <source>J Syst Evol</source>. <volume>46</volume>:<fpage>239</fpage>–<lpage>257</lpage>. <pub-id pub-id-type="doi">10.3724/SP.J.1002.2008.08016</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname>  <given-names>JG</given-names></string-name>, <string-name><surname>Henikoff</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Blocks database and its applications</article-title>. <source>Meth Enzymol</source>. <year>1996</year>:<volume>266</volume>:<fpage>88</fpage>–<lpage>105</lpage>. <pub-id pub-id-type="doi">10.1016/S0076-6879(96)66008-X</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Chitnis</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Monos</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Dinh</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Next-generation sequencing technologies: an overview</article-title>. <source>Human Immunol</source>. <year>2021</year>:<volume>82</volume>(<issue>11</issue>):<fpage>801</fpage>–<lpage>811</lpage>. <pub-id pub-id-type="doi">10.1016/j.humimm.2021.02.012</pub-id>.<pub-id pub-id-type="pmid">33745759</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname>  <given-names>J-J</given-names></string-name>, <string-name><surname>Yu</surname>  <given-names>W-B</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>J-B</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>dePamphilis</surname>  <given-names>CW</given-names></string-name>, <string-name><surname>Yi</surname>  <given-names>T-S</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>D-Z</given-names></string-name></person-group>. <article-title>GetOrganelle: a fast and versatile toolkit for accurate de novo assembly of organelle genomes</article-title>. <source>Genome Biol</source>. <year>2020</year>:<volume>21</volume>(<issue>1</issue>):<fpage>241</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-020-02154-5</pub-id>.<pub-id pub-id-type="pmid">32912315</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname>  <given-names>DM</given-names></string-name></person-group>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>:<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keilwagen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Hartung</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Paulini</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Twardziok</surname>  <given-names>SO</given-names></string-name>, <string-name><surname>Grau</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Combining RNA-seq data and homology-based gene prediction for plants, animals and fungi</article-title>. <source>BMC Bioinformatics</source>  <year>2018</year>:<volume>19</volume>(<issue>1</issue>):<fpage>189</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-018-2203-5</pub-id>.<pub-id pub-id-type="pmid">29843602</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keilwagen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Wenk</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Erickson</surname>  <given-names>JL</given-names></string-name>, <string-name><surname>Schattat</surname>  <given-names>MH</given-names></string-name>, <string-name><surname>Grau</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Hartung</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Using intron position conservation for homology-based gene prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>:<volume>44</volume>(<issue>9</issue>):<fpage>e89</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw092</pub-id>.<pub-id pub-id-type="pmid">26893356</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knyshov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Gordon</surname>  <given-names>ERL</given-names></string-name>, <string-name><surname>Weirauch</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>New alignment-based sequence extraction software (ALiBaSeq) and its utility for deep level phylogenetics</article-title>. <source>PeerJ</source>  <year>2021</year>:<volume>9</volume>:<fpage>e11019</fpage>. <pub-id pub-id-type="doi">10.7717/peerj.11019</pub-id>.<pub-id pub-id-type="pmid">33850647</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kück</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Longo</surname>  <given-names>GC</given-names></string-name></person-group>. <article-title>FASconCAT-G: extensive functions for multiple sequence alignment preparations concerning phylogenetic studies</article-title>. <source>Frontiers Zool</source>. <year>2014</year>:<volume>11</volume>(<issue>1</issue>):<fpage>81</fpage>. <pub-id pub-id-type="doi">10.1186/s12983-014-0081-x</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname>  <given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname>  <given-names>MW</given-names></string-name></person-group>. <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>  <year>2017</year>:<volume>12</volume>(<issue>5</issue>):<fpage>e0177459</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>.<pub-id pub-id-type="pmid">28494014</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sugawara</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Shumway</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>:<volume>39</volume>(<issue>Database</issue>):<fpage>D19</fpage>–<lpage>D21</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemmon</surname>  <given-names>EM</given-names></string-name>, <string-name><surname>Lemmon</surname>  <given-names>AR</given-names></string-name></person-group>. <article-title>High-throughput genomic data in systematics and phylogenetics</article-title>. <source>Annu Rev Ecol Evol Syst</source>. <year>2013</year>:<volume>44</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135822</pub-id>.</mixed-citation>
    </ref>
    <ref id="evad227-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>B-B</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>B-B</given-names></string-name>, <string-name><surname>Ma</surname>  <given-names>Z-Y</given-names></string-name>, <string-name><surname>Ren</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Hodel</surname>  <given-names>RGJ</given-names></string-name></person-group><etal>et al</etal>  <year>2021</year>. <article-title>Capturing single-copy nuclear genes, organellar genomes, and nuclear ribosomal DNA from deep genome skimming data for plant phylogenetics: a case study in Vitaceae</article-title>. <source>Appl Plant Sci</source>. <volume>11</volume>(<issue>4</issue>):<fpage>e11537</fpage>. <pub-id pub-id-type="doi">10.1111/jse.12806</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lozano-Fernandez</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>A practical guide to design and assess a phylogenomic study</article-title>. <source>Genome Biol Evol</source>. <year>2022</year>:<volume>14</volume>(<issue>9</issue>):<fpage>evac129</fpage>. <pub-id pub-id-type="doi">10.1093/gbe/evac129</pub-id>.<pub-id pub-id-type="pmid">35946263</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Berkeley</surname>  <given-names>MR</given-names></string-name>, <string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Simão</surname>  <given-names>FA</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>. <source>Mol Biol Evol</source>. <year>2021</year>:<volume>38</volume>(<issue>10</issue>):<fpage>4647</fpage>–<lpage>4654</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id>.<pub-id pub-id-type="pmid">34320186</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martín-Durán</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Vellutini</surname>  <given-names>BC</given-names></string-name>, <string-name><surname>Marlétaz</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Cetrangolo</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Cvetesic</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Thiel</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Henriet</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Grau-Bové</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Carrillo-Baltodano</surname>  <given-names>AM</given-names></string-name>, <string-name><surname>Gu</surname>  <given-names>W</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Conservative route to genome compaction in a miniature annelid</article-title>. <source>Nat Ecol Evol</source>. <year>2021</year>:<volume>5</volume>(<issue>2</issue>):<fpage>231</fpage>–<lpage>242</lpage>. <pub-id pub-id-type="doi">10.1038/s41559-020-01327-6</pub-id>.<pub-id pub-id-type="pmid">33199869</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCormack</surname>  <given-names>JE</given-names></string-name>, <string-name><surname>Hird</surname>  <given-names>SM</given-names></string-name>, <string-name><surname>Zellmer</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Carstens</surname>  <given-names>BC</given-names></string-name>, <string-name><surname>Brumfield</surname>  <given-names>RT</given-names></string-name></person-group>. <article-title>Applications of next-generation sequencing to phylogeography and phylogenetics</article-title>. <source>Mol Phylogenet Evol</source>. <year>2013</year>:<volume>66</volume>(<issue>2</issue>):<fpage>526</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1016/j.ympev.2011.12.007</pub-id>.<pub-id pub-id-type="pmid">22197804</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname>  <given-names>D</given-names></string-name></person-group>. <year>2014</year>. <article-title>Docker: lightweight linux containers for consistent development and deployment</article-title>. <source>Linux J</source>. <volume>239</volume>(<issue>2</issue>):<fpage>2</fpage>. <pub-id pub-id-type="doi">10.5555/2600239.2600241</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Schmidt</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Chernomor</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Woodhams</surname>  <given-names>MD</given-names></string-name>, <string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nurk</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bankevich</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Antipov</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Gurevich</surname>  <given-names>AA</given-names></string-name>, <string-name><surname>Korobeynikov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lapidus</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Prjibelski</surname>  <given-names>AD</given-names></string-name>, <string-name><surname>Pyshkin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Sirotkin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Sirotkin</surname>  <given-names>Y</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Assembling single-cell genomes and mini-metagenomes from chimeric MDA products</article-title>. <source>J Comput Biol</source>. <year>2013</year>:<volume>20</volume>(<issue>10</issue>):<fpage>714</fpage>–<lpage>737</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2013.0084</pub-id>.<pub-id pub-id-type="pmid">24093227</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Roure</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name></person-group><etal>et al</etal>  <year>2017</year>. <article-title>Pitfalls in supermatrix phylogenomics</article-title>. <source>Eur J Taxon</source>. <volume>283</volume>:<fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.5852/ejt.2017.283</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJP</given-names></string-name>, <string-name><surname>Cambon</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>MACSE v2: toolkit for the alignment of coding sequences accounting for frameshifts and stop codons</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>10</issue>):<fpage>2582</fpage>–<lpage>2584</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msy159</pub-id>.<pub-id pub-id-type="pmid">30165589</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raxworthy</surname>  <given-names>CJ</given-names></string-name>, <string-name><surname>Smith</surname>  <given-names>BT</given-names></string-name></person-group>. <article-title>Mining museums for historical DNA: advances and challenges in museomics</article-title>. <source>Trends Ecol Evol</source>. <year>2021</year>:<volume>36</volume>(<issue>11</issue>):<fpage>1049</fpage>–<lpage>1060</lpage>. <pub-id pub-id-type="doi">10.1016/j.tree.2021.07.009</pub-id>.<pub-id pub-id-type="pmid">34456066</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhie</surname>  <given-names>A</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Fedrigo</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Damas</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Formenti</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Koren</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Uliano-Silva</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Chow</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Fungtammasan</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Towards complete and error-free genome assemblies of all vertebrate species</article-title>. <source>Nature</source>  <year>2021</year>:<volume>592</volume>(<issue>7856</issue>):<fpage>737</fpage>–<lpage>746</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03451-0</pub-id>.<pub-id pub-id-type="pmid">33911273</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richter</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Schwarz</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Hering</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Böggemann</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Bleidorn</surname>  <given-names>C</given-names></string-name></person-group>. <article-title>The utility of genome skimming for phylogenomic analyses as demonstrated for glycerid relationships (Annelida, Glyceridae)</article-title>. <source>Genome Biol Evol</source>. <year>2015</year>:<volume>7</volume>(<issue>12</issue>):<fpage>3443</fpage>–<lpage>3462</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evv224</pub-id>.<pub-id pub-id-type="pmid">26590213</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogozin</surname>  <given-names>IB</given-names></string-name>, <string-name><surname>Sverdlov</surname>  <given-names>AV</given-names></string-name>, <string-name><surname>Babenko</surname>  <given-names>VN</given-names></string-name>, <string-name><surname>Koonin</surname>  <given-names>EV</given-names></string-name></person-group>. <article-title>Analysis of evolution of exon-intron structure of eukaryotic genes</article-title>. <source>Brief Bioinformatics</source>  <year>2005</year>:<volume>6</volume>(<issue>2</issue>):<fpage>118</fpage>–<lpage>134</lpage>. <pub-id pub-id-type="doi">10.1093/bib/6.2.118</pub-id>.<pub-id pub-id-type="pmid">15975222</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sahbou</surname>  <given-names>A-E</given-names></string-name>, <string-name><surname>Iraqi</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Mentag</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Khayi</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>BuscoPhylo: a webserver for Busco-based phylogenomic analysis for non-specialists</article-title>. <source>Sci Rep</source>. <year>2022</year>:<volume>12</volume>(<issue>1</issue>):<fpage>17352</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-022-22461-0</pub-id>.<pub-id pub-id-type="pmid">36253435</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salzberg</surname>  <given-names>SL</given-names></string-name></person-group>. <article-title>Next-generation genome annotation: we still struggle to get it right</article-title>. <source>Genome Biol</source>. <year>2019</year>:<volume>20</volume>(<issue>1</issue>):<fpage>92</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1715-2</pub-id>.<pub-id pub-id-type="pmid">31097009</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salzberg</surname>  <given-names>SL</given-names></string-name>, <string-name><surname>Phillippy</surname>  <given-names>AM</given-names></string-name>, <string-name><surname>Zimin</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Puiu</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Magoc</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Koren</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Treangen</surname>  <given-names>TJ</given-names></string-name>, <string-name><surname>Schatz</surname>  <given-names>MC</given-names></string-name>, <string-name><surname>Delcher</surname>  <given-names>AL</given-names></string-name>, <string-name><surname>Roberts</surname>  <given-names>M</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>GAGE: a critical evaluation of genome assemblies and assembly algorithms</article-title>. <source>Genome Res</source>. <year>2012</year>:<volume>22</volume>(<issue>3</issue>):<fpage>557</fpage>–<lpage>567</lpage>. <pub-id pub-id-type="doi">10.1101/gr.131383.111</pub-id>.<pub-id pub-id-type="pmid">22147368</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO: assessing genome assembly and annotation completeness</article-title>. <source>Methods Mol Biol</source>. <year>2019</year>:<volume>1962</volume>:<fpage>227</fpage>–<lpage>245</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-4939-9173-0_14</pub-id>.<pub-id pub-id-type="pmid">31020564</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simmons</surname>  <given-names>SK</given-names></string-name>, <string-name><surname>Lithwick-Yanai</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Adiconis</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Oberstrass</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Iremadze</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Geiger-Schuller</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Thakore</surname>  <given-names>PI</given-names></string-name>, <string-name><surname>Frangieh</surname>  <given-names>CJ</given-names></string-name>, <string-name><surname>Barad</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Almogy</surname>  <given-names>G</given-names></string-name>, <etal>et al</etal></person-group>  <article-title>Mostly natural sequencing-by-synthesis for scRNA-seq using Ultima sequencing</article-title>. <source>Nat Biotechnol</source>. <year>2023</year>:<volume>41</volume>(<issue>2</issue>):<fpage>204</fpage>–<lpage>211</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01452-6</pub-id>.<pub-id pub-id-type="pmid">36109685</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Slater</surname>  <given-names>GSC</given-names></string-name>, <string-name><surname>Birney</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>Automated generation of heuristics for biological sequence comparison</article-title>. <source>BMC Bioinformatics</source>  <year>2005</year>:<volume>6</volume>(<issue>1</issue>):<fpage>31</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-6-31</pub-id>.<pub-id pub-id-type="pmid">15713233</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stark</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Grzelak</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Hadfield</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>RNA sequencing: the teenage years</article-title>. <source>Nat Rev Genet</source>. <year>2019</year>:<volume>20</volume>(<issue>11</issue>):<fpage>631</fpage>–<lpage>656</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-019-0150-2</pub-id>.<pub-id pub-id-type="pmid">31341269</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steenwyk</surname>  <given-names>JL</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Shen</surname>  <given-names>XX</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Incongruence in the phylogenomics era</article-title>. <source>Nat Rev Genet</source>. <year>2023</year>:<volume>24</volume>(<issue>12):</issue><fpage>834</fpage>–<lpage>850</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-023-00620-x</pub-id>.<pub-id pub-id-type="pmid">37369847</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waterhouse</surname>  <given-names>RM</given-names></string-name>, <string-name><surname>Seppey</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Simão</surname>  <given-names>FA</given-names></string-name>, <string-name><surname>Manni</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ioannidis</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Klioutchnikov</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Kriventseva</surname>  <given-names>EV</given-names></string-name>, <string-name><surname>Zdobnov</surname>  <given-names>EM</given-names></string-name></person-group>. <article-title>BUSCO applications from quality assessments to gene prediction and phylogenomics</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>3</issue>):<fpage>543</fpage>–<lpage>548</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msx319</pub-id>.<pub-id pub-id-type="pmid">29220515</pub-id></mixed-citation>
    </ref>
    <ref id="evad227-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whelan</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Irisarri</surname>  <given-names>I</given-names></string-name>, <string-name><surname>Burki</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>PREQUAL: detecting non-homologous characters in sets of unaligned homologous sequences</article-title>. <source>Bioinformatics</source>  <year>2018</year>:<volume>34</volume>(<issue>22</issue>):<fpage>3929</fpage>–<lpage>3930</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty448</pub-id>.<pub-id pub-id-type="pmid">29868763</pub-id>
</mixed-citation>
    </ref>
    <ref id="evad227-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Ding</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>C-D</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Orr</surname>  <given-names>MC</given-names></string-name>, <string-name><surname>Scheu</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Luan</surname>  <given-names>Y-X</given-names></string-name></person-group>. <article-title>Phylogenomics from low-coverage whole-genome sequencing</article-title>. <source>Methods Ecol Evol</source>. <year>2019</year>:<volume>10</volume>(<issue>4</issue>):<fpage>507</fpage>–<lpage>517</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13145</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
