<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870860</article-id>
    <article-id pub-id-type="pmid">28203700</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx073</article-id>
    <article-id pub-id-type="publisher-id">btx073</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Threshold-seq: a tool for determining the threshold in short RNA-seq datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Magee</surname>
          <given-names>Rogan</given-names>
        </name>
        <xref ref-type="aff" rid="btx073-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Loher</surname>
          <given-names>Phillipe</given-names>
        </name>
        <xref ref-type="aff" rid="btx073-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Londin</surname>
          <given-names>Eric</given-names>
        </name>
        <xref ref-type="aff" rid="btx073-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rigoutsos</surname>
          <given-names>Isidore</given-names>
        </name>
        <xref ref-type="corresp" rid="btx073-cor1"/>
        <xref ref-type="aff" rid="btx073-aff1"/>
        <!--<email>isidore.rigoutsos@jefferson.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hofacker</surname>
          <given-names>Ivo</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx073-aff1">Computational Medicine Center, Thomas Jefferson University, Philadelphia, PA, USA</aff>
    <author-notes>
      <corresp id="btx073-cor1">To whom correspondence should be addressed. Email: <email>isidore.rigoutsos@jefferson.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-02-14">
      <day>14</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>13</issue>
    <fpage>2034</fpage>
    <lpage>2036</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>2</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx073.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>We present ‘Threshold-seq,’ a new approach for determining thresholds in deep-sequencing datasets of short RNA transcripts. Threshold-seq addresses the critical question of how many reads need to support a short RNA molecule in a given dataset before it can be considered different from ‘background.’ The proposed scheme is easy to implement and incorporate into existing pipelines.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p>Source code of Threshold-seq is freely available as an R package at: <ext-link ext-link-type="uri" xlink:href="http://cm.jefferson.edu/threshold-seq/">http://cm.jefferson.edu/threshold-seq/</ext-link></p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>‘Short RNA-seq’ is widely employed to study categories of non-coding RNAs (ncRNAs), typically between 15 and 30 nucleotides (nts) in length (<xref rid="btx073-B1" ref-type="bibr">Bartel, 2004</xref>; <xref rid="btx073-B2" ref-type="bibr">Cloonan <italic>et al.</italic>, 2011</xref>; <xref rid="btx073-B6" ref-type="bibr">Londin <italic>et al.</italic>, 2015</xref>). The benefits of short RNA-seq include its comprehensive nature, relatively low cost, and the relative ease with which it can be implemented and executed. Unlike microarray approaches where one is constrained to quantifying the abundance of only the ncRNAs represented by the microarray’s probes, short RNA-seq quantifies <italic>any</italic> ncRNA that is present in a sample.</p>
    <p>A number of factors establish the <italic>effective</italic> depth at which a given RNA sample is sequenced. These factors include RNA quality, library preparation, degree of multiplexing, DNA contamination, micro-organism contamination (e.g. by <italic>mycoplasma</italic>), etc. In the general case, the relative contributions of these factors cannot be quantified. Given these considerations, any two RNA-seq datasets will have different sequencing depths. The idea behind ‘<italic>normalization</italic>’ is to account for the uneven sequencing depths of datasets that are about to be compared, in order to ‘equalize’ the read counts of transcripts that are common to the datasets being compared. A popular <italic>normalization</italic> approach has been to express RNA transcript abundance in terms of ‘Reads Per Million Mapped’ reads (RPMM) values. RPMM can be applied to individual datasets. Several other normalization approaches have been suggested over the years; they are summarized and reviewed elsewhere (<xref rid="btx073-B3" ref-type="bibr">Dillies <italic>et al.</italic>, 2013</xref>; <xref rid="btx073-B4" ref-type="bibr">Garmire and Subramaniam, 2012</xref>; <xref rid="btx073-B7" ref-type="bibr">Tam <italic>et al.</italic>, 2015</xref>).</p>
    <p>It is important to stress that normalization methods do not answer the question of how to establish the level of support below which one would likely be immersed in noise. The idea behind ‘<italic>thresholding</italic>’ is to separate molecules of putative biological relevance from those that likely result from degradation or aberrant transcription (‘background’ noise). A frequent and arbitrary threshold choice has been to use 1.0 RPMM. However, this choice will lead to complications if a dataset contains <italic>outlier features</italic> that receive a lot of support compared to the rest of the features that are present: such outliers can cause high variability in the number of features that are retained and analyzed (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
    <p>Here, we present Threshold-seq, a novel approach to thresholding short RNA-seq datasets. Threshold-seq adapts to sequencing depth variations and permits dynamic selection of dataset-specific thresholds that strike a balance between the competing requirements of <italic>sensitivity</italic> and <italic>specificity</italic>. Threshold-seq alleviates the above-mentioned influence of outliers by calculating a threshold through analysis of <italic>the number of distinct molecules</italic> that can be identified in a dataset. In other words, Threshold-seq does not rely only on <italic>the number of reads</italic> in the dataset.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Threshold-seq proceeds as follows. After adapter removal and quality trimming, the sequenced reads are mapped uniquely to the genome of interest (<xref rid="btx073-B6" ref-type="bibr">Londin <italic>et al.</italic>, 2015</xref>). <underline>No thresholding</underline> is applied at this step: all sequences that are supported by at least one read are kept: let <italic>K</italic> be the number of unique sequences that are kept. Note that <italic>K</italic> is <italic>not</italic> user-defined; it is determined from the dataset being analyzed. Each of the <italic>K</italic> sequences that are kept is then paired with a count that reflects its support in terms of mapped reads: thus, we generate a collection <italic>S</italic> of <italic>K</italic> pairs of the type (sequence, count). We iterate over the following three steps for a total of <italic>N</italic> times (default <italic>N </italic>=<italic> </italic>1000). During the <italic>n</italic>-th iteration (1 ≤ <italic>n </italic>≤<italic> N</italic>):
<list list-type="order"><list-item><p>we randomly resample <italic>K</italic> (sequence, count) pairs with replacement. i.e. we draw <italic>K</italic> (sequence, count) pairs from the original pool of <italic>K</italic> unique sequence-count values, creating a collection <italic>S′</italic> that contains as many (sequence, count) pairs as the original collection <italic>S</italic>. However, owing to our use of replacement during resampling, the latter being a key element of our approach, <italic>S′ </italic>≠ <italic>S.</italic></p></list-item><list-item><p>for the <italic>resampled K</italic> (sequence, count) pairs, we approximate numerically the cumulative distribution CDF as follows: <italic>CDF <sup>n</sup></italic><inline-formula id="IE1"><mml:math id="IEQ1"><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>F</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>F</italic>(<italic>i</italic>) is the fraction of the resampled sequences that are paired with a count of exactly <italic>i</italic> reads;</p></list-item><list-item><p>for a user-defined interval [<italic>MIN</italic>, <italic>MAX</italic>] (default interval =  [0.90, 0.99]), we report the abscissas <italic>x<sub>o</sub></italic>, <italic>x<sub>1</sub>, x<sub>2</sub>, …, x<sub>max</sub></italic> at which <italic>CDF<sup>n</sup></italic>(<italic>x</italic><sub>0</sub>)=MIN, <italic>CDF<sup>n</sup></italic>(<italic>x</italic><sub>1</sub>)<italic>=MIN </italic>+ <italic>ε</italic>, <italic>CDF<sup>n</sup></italic>(<italic>x</italic><sub>2</sub>)=<italic> MIN </italic>+<italic> </italic>2<italic>ε</italic>, …, <italic>CDF <sup>n</sup></italic>(<italic>x</italic><sub>max</sub>)=<italic>MAX</italic> (default <italic>ε </italic>= 0.5%).</p></list-item></list></p>
    <p>We then identify <italic>CDF</italic><sub>target</sub> as the <italic>smallest</italic> CDF value at which multiple values of <italic>x</italic> were reported across <italic>N</italic> iterations: <italic>CDF</italic><sub>target</sub> is the smallest value within [<italic>MIN</italic>, <italic>MAX</italic>] at which biologically relevant sequences begin to differentiate themselves from background. Finally, we report as the threshold of choice, <italic>x</italic><sub>thresh</sub>, the value <italic>mode</italic>(<italic>x<sub>n</sub></italic>) over all values <italic>x<sub>n</sub></italic> that satisfy <italic>CDF<sup>n</sup></italic>(<italic>x<sub>n</sub></italic>)=<italic>CDF</italic><sub>target</sub>. In other words, <italic>x</italic><sub>thresh</sub> is the most frequent abscissa at which the CDF reaches <italic>CDF</italic><sub>target</sub> (illustrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>) across <italic>N</italic> iterations.</p>
    <p>To compare Threshold-seq with arbitrary thresholds, we used two public collections of datasets for which technical replicates are available: (i) five samples from the GEUVADIS RNA sequencing project (1000 Genomes Project; see also <xref rid="btx073-B5" ref-type="bibr">Lappalainen <italic>et al.</italic>, 2013</xref>); and (ii) three samples that we published previously (<xref rid="btx073-B6" ref-type="bibr">Londin <italic>et al.</italic>, 2015</xref>). The GEUVADIS datasets were sequenced at seven different sequencing centers and have different sequencing depths even though they are technical replicates (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). Our three samples were sequenced at two locations (our University and Applied Biosystems/Thermo Fisher Scientific—see also Supplement for more details). By working with these datasets, we can evaluate our method while removing biological variability.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>For each of the 44 analyzed datasets (5 biological samples × 7 technical replicates plus 3 biological samples × 3 technical replicates), we compare the results of Threshold-seq to several fixed RPMM threshold choices ranging from 0.5 to 5.0 (<xref ref-type="fig" rid="btx073-F1">Figs 1 and 2</xref>). We also compare Threshold-seq to thresholds in terms of absolute read numbers (<xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1 and S2</xref>). For each of the five GEUVADIS samples, we examined the corresponding seven technical replicates and identified: (i) collection A of all sequences that are supported by one or more reads and are <italic>present in all seven replicates</italic> of the sample; we refer to the set A as the set of <italic>positives</italic>; (ii) collection B of all sequences that are supported by one or more reads and are <italic>absent from at least one of the seven replicates</italic>; we refer to the set B as the set of <italic>negatives</italic>; and, (iii) collection C of all sequences that go <italic>above threshold in at least one of the seven replicates</italic>. Thus, for a given choice of threshold, the true positives will be equal to C ∩ A; the false positives will be equal to C ∩ B; and, the true negatives will be equal to B\C. In <xref ref-type="fig" rid="btx073-F1">Figure 1</xref>, we plot sensitivity (<italic>X</italic>-axis) vs. specificity (Y-axis) for different choices of RPMM threshold, ranging from 0.5 to 5.0 (in steps of 0.5). For each of our three samples, we examined its three technical replicates and repeated the above analysis (<xref ref-type="fig" rid="btx073-F2">Fig. 2</xref>). Note how Threshold-seq adaptively approaches the RPMM value that achieves a balance between sensitivity and specificity and how that value differs across the eight samples shown in <xref ref-type="fig" rid="btx073-F1">Figures 1</xref> and <xref ref-type="fig" rid="btx073-F2">2</xref>. Also, importantly, Threshold-seq is reliable over a large range of values for <italic>N</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S3 and S4</xref>).</p>
    <fig id="btx073-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Comparison of Threshold-seq with arbitrary RPMM thresholds. The shown five samples were sequenced in seven technical replicates. In each case, we plot the obtained sensitivity (<italic>X</italic>-axis) vs. the obtained specificity (<italic>Y</italic>-axis) for different RPMM thresholds from 0.5 to 5 in increments of 0.5. Dark circles show the Threshold-seq equivalent metrics in each case</p>
      </caption>
      <graphic xlink:href="btx073f1"/>
    </fig>
    <fig id="btx073-F2" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>Comparison of Threshold-seq with arbitrary RPMM thresholds. The shown three samples were sequenced in three technical replicates. In each case, we plot the obtained sensitivity (<italic>X</italic>-axis) vs. the obtained specificity (<italic>Y</italic>-axis) for different RPMM thresholds from 0.5 to 5 in increments of 0.5. Dark circles show the Threshold-seq equivalent metrics in each case</p>
      </caption>
      <graphic xlink:href="btx073f2"/>
    </fig>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented Threshold-seq, a method for automatically establishing read thresholds when analyzing short RNA-seq datasets. Threshold-seq works on any short RNA-seq dataset regardless of choice of mapping program and of parameters. Threshold-seq can work with individual datasets; i.e. it does <italic>not</italic> require the availability of technical or of biological replicates. In <xref ref-type="fig" rid="btx073-F1">Figure 1</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref> we show that when using low absolute thresholds (e.g. 5 reads) or low RPM values (e.g. 1.0 RPM) more distinct sequences go above threshold (=high sensitivity) at the expense of low specificity; on the other hand, using a higher absolute threshold (e.g. 15 reads) or higher RPM (e.g. 5.0 RPM) improves specificity, at the expense of lower sensitivity. By resampling the distinct sequences of the dataset at hand, Threshold-seq achieves a good balance between sensitivity and specificity. Threshold-seq will capture those sequences of a sample that can be confidently assumed to represent biologically relevant features in the tissue/cell of origin, while remaining immune to any outliers that could be present in the data (see also <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by a W. M. Keck Foundation grant (IR), NIH/NCI grant R21-CA195204 (IR), and by Institutional Funds.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx073_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx073-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bartel</surname><given-names>D.P.</given-names></name></person-group> (<year>2004</year>) 
<article-title>MicroRNAs: genomics, biogenesis, mechanism, and function</article-title>. <source>Cell</source>, <volume>116</volume>, <fpage>281</fpage>–<lpage>297</lpage>.<pub-id pub-id-type="pmid">14744438</pub-id></mixed-citation>
    </ref>
    <ref id="btx073-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cloonan</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>MicroRNAs and their isomiRs function cooperatively to target common biological pathways</article-title>. <source>Genome Biol</source>., <volume>12</volume>, <fpage>R126.</fpage><pub-id pub-id-type="pmid">22208850</pub-id></mixed-citation>
    </ref>
    <ref id="btx073-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dillies</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>A comprehensive evaluation of normalization methods for Illumina high-throughput RNA sequencing data analysis</article-title>. <source>Brief. Bioinform</source>., <volume>14</volume>, <fpage>671</fpage>–<lpage>683</lpage>.<pub-id pub-id-type="pmid">22988256</pub-id></mixed-citation>
    </ref>
    <ref id="btx073-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Garmire</surname><given-names>L.X.</given-names></name>, <name name-style="western"><surname>Subramaniam</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Evaluation of normalization methods in mammalian microRNA-Seq data</article-title>. <source>RNA</source>, <volume>18</volume>, <fpage>1279</fpage>–<lpage>1288</lpage>.<pub-id pub-id-type="pmid">22532701</pub-id></mixed-citation>
    </ref>
    <ref id="btx073-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lappalainen</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>. <source>Nature</source>, <volume>501</volume>, <fpage>506</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">24037378</pub-id></mixed-citation>
    </ref>
    <ref id="btx073-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Londin</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Analysis of 13 cell types reveals evidence for the expression of numerous novel primate- and tissue-specific microRNAs</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>., <volume>112</volume>, <fpage>E1106</fpage>–<lpage>E1115</lpage>.<pub-id pub-id-type="pmid">25713380</pub-id></mixed-citation>
    </ref>
    <ref id="btx073-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tam</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Optimization of miRNA-seq data preprocessing</article-title>. <source>Brief. Bioinform</source>., <volume>16</volume>, <fpage>950</fpage>–<lpage>963</lpage>.<pub-id pub-id-type="pmid">25888698</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
