<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">J. Appl. Cryst.</journal-id>
    <journal-title-group>
      <journal-title>Journal of Applied Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0021-8898</issn>
    <issn pub-type="epub">1600-5767</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5541358</article-id>
    <article-id pub-id-type="publisher-id">fs5146</article-id>
    <article-id pub-id-type="doi">10.1107/S1600576717007877</article-id>
    <article-id pub-id-type="coden">JACGAR</article-id>
    <article-id pub-id-type="pii">S1600576717007877</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computer Programs</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>SAXS4COLL</italic>: an integrated software tool for analysing fibrous collagen-based tissues</article-title>
      <alt-title>
        <italic>SAXS4COLL</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Abass</surname>
          <given-names>Ahmed</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bell</surname>
          <given-names>James S.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Spang</surname>
          <given-names>Martin T.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hayes</surname>
          <given-names>Sally</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meek</surname>
          <given-names>Keith M.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boote</surname>
          <given-names>Craig</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>Structural Biophysics Group, School of Optometry and Vision Science, <institution>Cardiff University</institution>, Maindy Road, Cardiff CF24 4HQ, <country>UK</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>bootec@cardiff.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>07</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>50</volume>
    <issue>Pt 4</issue>
    <issue-id pub-id-type="publisher-id">j170400</issue-id>
    <fpage>1235</fpage>
    <lpage>1240</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Ahmed Abass et al. 2017</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://creativecommons.org/licenses/by/2.0/uk/</ali:license_ref>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S1600576717007877">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p><italic>SAXS4COLL</italic> is an interactive computer program for reduction and analysis of small-angle X-ray scattering data from fibrous collagen tissues, combining data reduction, bespoke background subtraction, semi-automated peak detection and calibration.</p>
    </abstract>
    <abstract>
      <p>This article provides an overview of a new integrated software tool for reduction and analysis of small-angle X-ray scattering (SAXS) data from fibrous collagen tissues, with some wider applicability to other cylindrically symmetric scattering systems. <italic>SAXS4COLL</italic> combines interactive features for data pre-processing, bespoke background subtraction, semi-automated peak detection and calibration. Both equatorial and meridional SAXS peak parameters can be measured, and the former can be deconstructed into cylinder and lattice contributions. Finally, the software combines functionality for determination of collagen spatial order parameters with a rudimentary orientation plot capability.</p>
    </abstract>
    <kwd-group>
      <kwd>small-angle X-ray scattering</kwd>
      <kwd>fibrillar collagen</kwd>
      <kwd>data reduction</kwd>
      <kwd>data processing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>Medical Research Council</funding-source>
        <award-id>MR/K000837/1</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>With continual advances in synchrotron power and beamline technology, the use of small-angle X-ray scattering (SAXS) techniques to study biomolecular structures has increased significantly in the past few decades (Jacques &amp; Trewhella, 2010<xref ref-type="bibr" rid="bb2"> ▸</xref>). The widening application of synchrotron-based SAXS methods has driven efforts to produce computing applications capable of analysing increasingly large SAXS datasets more efficiently (Jacques &amp; Trewhella, 2010<xref ref-type="bibr" rid="bb2"> ▸</xref>). One area in which these benefits have been felt is in the study of noncrystalline and semi-crystalline fibrous materials, including synthetic polymers, DNA, muscle and collagen-based connective tissues. Between 1992 and 2005 a productive partnership between synchrotron and academic institution personnel [Collaborative Computing Project (CCP)13; Squire <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb7"> ▸</xref>] led to the development of a suite of software for use by the small-angle scattering and fibre diffraction communities. Most notably, the generic CCP13 routine <italic>FibreFix</italic> (Rajkumar <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb6"> ▸</xref>) was developed to allow semi-automatic determination of structural parameters from noncrystalline diffraction patterns. <italic>FibreFix</italic> is an integrated software suite for Windows and Linux operating systems which features an interactive graphical user interface (GUI) to select, process and present data. Further, more specialized software has also been developed under CCP13. These include <italic>HELIX</italic> (Squire &amp; Knupp, 2004<xref ref-type="bibr" rid="bb8"> ▸</xref>) for simulation of helical molecules and <italic>MusLABEL</italic> (Squire &amp; Knupp, 2004<xref ref-type="bibr" rid="bb8"> ▸</xref>) for modelling striated muscle. However, currently there exists no integrated software tool aimed specifically for the analysis of SAXS patterns from collagen-based tissues. This paper represents a new interactive SAXS data analysis program originally produced for the investigation of corneal collagen structure and suitable for processing SAXS data from any fibrous collagen specimen. The presented <italic>SAXS4COLL</italic> software is a GUI-based system for pre-processing of fibrous collagen SAXS patterns, fitting bespoke power-law background functions to the integrated scattered signal, identifying and calibrating the equatorial (interference function and cylinder transform) and meridional (axial D period) peaks, and semi-quantitatively determining preferential collagen orientation. The program supports semi-automated batch processing to allow rapid loading and analysis of similar files, such that background and cylinder transform parameters can be retained or quickly modified. This program was developed in MATLAB R2016b (The MathWorks Inc., Natick, MA, USA) as a GUI application. An overview of the GUI layout is presented in Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Data pre-processing   </title>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>Input file format   </title>
      <p>Input files should be converted to a standard high-resolution image file format compatible with the <monospace>imread.m</monospace> function in MATLAB (accepted formats include TIFF, JPEG or PNG) for processing in the <italic>SAXS4COLL</italic> software.</p>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title>Pattern centring   </title>
      <p><italic>SAXS4COLL</italic> enables semi-automated centring of the SAXS pattern. A pattern with circular peaks is loaded, for example from a calibrant such as tendon collagen, silver behenate, silicon <italic>etc</italic>. The user is then instructed to select seven points around the circumference of one of the calibrant diffraction rings (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>
<italic>a</italic>). The software uses the MATLAB routine <italic>Circle fit</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/matlabcentral/fileexchange/5557-circle-fit">http://www.mathworks.com/matlabcentral/fileexchange/5557-circle-fit</ext-link>) to automatically calculate the geometric centre of the selected circle and records it as the pattern centre/straight-through beam position (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>
<italic>b</italic>). <italic>SAXS4COLL</italic> allows the user to repeat the centring process, if necessary.</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Negative data correction   </title>
      <p>Where detector calibration leads to the raw SAXS patterns containing negative intensity data, <italic>SAXS4COLL</italic> makes an automatic correction in which the minimum value of the intensity matrix is subtracted from the whole matrix in order to shift magnitudes above zero.</p>
    </sec>
    <sec id="sec2.4">
      <label>2.4.</label>
      <title>Background image subtraction   </title>
      <p><italic>SAXS4COLL</italic> gives the user the option of setting a certain SAXS image as a background image. This is used to remove/reduce background scatter such as flare from the beamstop and diffuse scatter from the specimen cell. If the user does not identify a background image, the software sets the background matrix to zeros.</p>
    </sec>
    <sec id="sec2.5">
      <label>2.5.</label>
      <title>Removal of outlier points   </title>
      <p>Outlier points, such as beamstop flare from the main X-ray beam, may be removed interactively and considered as missing points, or not a number (NaN). In the GUI, moveable upper limit (UL) and lower limit (LL) sliders enable the user to exclude any outlier element in the X-ray pattern matrix and treat it as a missing data point. A radial limit range for the azimuth integration is selected using the limit sliders, lower radial limit (Ri) and upper radial limit (Rio), as shown in Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>. A before and after comparison of the use of the limit sliders is shown in Figs. 3<xref ref-type="fig" rid="fig3"> ▸</xref>(<italic>a</italic>) and 3<xref ref-type="fig" rid="fig3"> ▸</xref>(<italic>b</italic>). The pattern colour scale is automatically updated accordingly.</p>
    </sec>
    <sec id="sec2.6">
      <label>2.6.</label>
      <title>Compensation of missing data   </title>
      <p>Owing to the modular nature of some X-ray detectors, such as the Pilatus range, data may be missing in the gaps between the detector modules (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>
<italic>b</italic>). Assuming negligible out-of-plane effects, the SAXS pattern from a collagenous tissue has rotational symmetry of order 2 about the scattering centre, and this symmetry can be used to populate regions of lost data. By pressing the ‘Smooth’ button, the software considers each white pixel and looks for a valid data point at the symmetrically opposite point of the pattern to populate it with. Circumferential interpolation is then used to populate any remaining lost data points, which can be minimized through careful selection of the centre point at the start of a SAXS experiment. Once all the white pixels have been populated with data, the reconstructed SAXS data pattern is displayed (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>
<italic>c</italic>).</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Calibration   </title>
    <p>The loading of a calibration file, such as a SAXS pattern from hydrated rat-tail tendon, results in a display of the raw pattern alongside the azimuthally integrated radial SAXS profile (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>). The user then selects an appropriate calibration peak, for example the first-order meridional peak from tendon collagen, by clicking on the integrated SAXS intensity plot (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>
<italic>b</italic>). The pixel value of the calibration peak, as displayed by the software (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>
<italic>b</italic>), is then entered into the calibration input box alongside the corresponding period in nanometres, for example 67 nm for the collagen first order (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>
<italic>a</italic>). These values will be stored by <italic>SAXS4COLL</italic> and subsequently used to automatically calibrate the specimen collagen peak positions.</p>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Interactive background fitting   </title>
    <p>Residual scatter from the specimen cell and non-collagen components of the specimen can be interactively removed by fitting a background function to the pre-processed data. The software invites the user to specify three points on the azimuthally integrated SAXS signal, presented as a double natural log plot (Fig. 5<xref ref-type="fig" rid="fig5"> ▸</xref>). The program then fits a straight-line background function to the chosen points, which equates to the general power function in linear space<disp-formula id="fd1"><graphic xlink:href="j-50-01235-efd1.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <italic>I</italic> is the integrated SAXS intensity, <italic>R</italic> is the radial pixel position, and <italic>a</italic> and <italic>b</italic> are constants. An adjustable zoom option facilitates accurate fitting of the background function and the program allows repeated fittings.</p>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Collagen peak detection and fitting   </title>
    <sec id="sec5.1">
      <label>5.1.</label>
      <title>Calculation of structure parameters   </title>
      <p><italic>SAXS4COLL</italic> enables the identification of a meridional peak from a plot of the background-subtracted, azimuthally integrated SAXS signal, and allows the user to input the order of the reflection (<italic>e.g.</italic> from the collagen axial D period). The user is required to click near the peak and the software will then automatically find the nearest maximum. In some patterns there may exist equatorial reflections arising from lateral order in the collagen fibril spatial organization. The program gives the user the option of manually identifying the collagen equatorial interference function peak, referred to as the interfibrillar peak in the GUI, from which the average Bragg collagen fibril separation distance is calculated (Fig. 6<xref ref-type="fig" rid="fig6"> ▸</xref>
<italic>a</italic>). Again the program will detect the closest peak to the selected point. The software then requires the user to manually adjust the fit of the equatorial fibril (cylinder) transform, which takes the form of a Bessel function of the first kind (see §5.2<xref ref-type="sec" rid="sec5.2"/>), using the sliders to the right of the plot (Fig. 6<xref ref-type="fig" rid="fig6"> ▸</xref>
<italic>b</italic>). The position of the first subsidiary Bessel peak is used to calculate the average collagen fibril diameter (Meek &amp; Quantock, 2001<xref ref-type="bibr" rid="bb4"> ▸</xref>). The software automatically calibrates the positions of the meridional peak, the Bessel function peak and the interfibrillar peak to determine, respectively, the D period, the fibril diameter and, to a first approximation, the Bragg fibril separation and the relative spatial order of collagen (see §5.2<xref ref-type="sec" rid="sec5.2"/>). The order parameter (in a.u.) is computed from the interfibrillar peak height divided by the half height width (HHW).</p>
    </sec>
    <sec id="sec5.2">
      <label>5.2.</label>
      <title><bold>Refinement of the interference function</bold>   </title>
      <p>The equatorial integrated SAXS pattern from a fibrous collagen specimen, <italic>I</italic>(<italic>K</italic>), is the product of the ‘interference function’ from the lattice, <italic>G</italic>(<italic>K</italic>), and the scattered amplitude of a single collagen cylinder – often termed the ‘fibril transform’ or ‘cylinder transform’, <italic>F</italic>
<sup>2</sup>:<disp-formula id="fd2"><graphic xlink:href="j-50-01235-efd2.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <italic>K</italic> is the scattering vector magnitude (Meek &amp; Quantock, 2001<xref ref-type="bibr" rid="bb4"> ▸</xref>). If we assume that the collagen cylinder length is infinitely longer than its radius, and that the electron density along its length is uniform, then the scatter amplitude can be represented as<disp-formula id="fd3"><graphic xlink:href="j-50-01235-efd3.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <italic>r</italic> is the cylinder radius and <italic>J</italic>
<sub>1</sub> is a Bessel function of the first kind (Oster &amp; Riley, 1952<xref ref-type="bibr" rid="bb5"> ▸</xref>). The intensity profile of the cylinder transform, <italic>F</italic>
<sup>2</sup>(<italic>Kr</italic>), has maxima when <italic>Kr</italic> = 0, 5.14, 8.42 <italic>etc</italic>. Hence, in cases where the fibril sizes are sufficiently uniform to generate a well defined, unimodal cylinder transform, the software allows division of the Bessel function from the background-subtracted data to yield a Bessel-compensated interference function (Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>
<italic>a</italic>) and allows the user to detect the shifted interfibrillar peak from this compensated function (Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>
<italic>a</italic>). Bessel-compensated interfibrillar spacing and height/HHW order parameters are calculated and displayed alongside the non-Bessel-compensated values (Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>
<italic>b</italic>).</p>
    </sec>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title>Collagen orientation   </title>
    <p><italic>SAXS4COLL</italic> is able to produce polar vector plots showing the predominant orientation of collagen in each SAXS pattern. Collagen fibril orientation data from X-ray scattering patterns may be useful for biomechanical interpretation of the tissue and, for example, have been shown to be highly amenable for application in finite element analyses (Whitford <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb9"> ▸</xref>; Coudrillier <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb1"> ▸</xref>). The user is required to identify the radial positions of the inner and outer integration limits by clicking each side of the peak of interest in the power subtraction curve. The software then displays the orientation polar plot (based on the azimuthal distribution of radially integrated intensity) automatically. This flexibility allows the orientation to be calculated from either the equatorial (interfibrillar peak) or meridional SAXS signals. The software has an adjustable zero-phase low-pass filter to smooth the polar plot shape. The variable plotted is the preferentially aligned collagen, defined as the total azimuthal scatter after background subtraction minus the minimum azimuthal (<italic>i.e.</italic> isotropic) scatter (Meek &amp; Boote, 2009<xref ref-type="bibr" rid="bb3"> ▸</xref>) (Fig. 8<xref ref-type="fig" rid="fig8"> ▸</xref>). The polar plot is saved automatically as a TIFF file, while the data from the plot (aligned scatter <italic>versus</italic> azimuth angle) are saved to an Excel spreadsheet.</p>
  </sec>
  <sec id="sec7">
    <label>7.</label>
    <title>Batch processing   </title>
    <p>By default, once the first data file is loaded, <italic>SAXS4COLL</italic> enters semi-automated batch processing mode. Consecutive images may be loaded with a single click and processed automatically with the same background and cylinder transform parameters applied. Alternatively the processing parameters can be modified as desired. The output polar plot and structure parameter data from a batch are saved within common Excel spreadsheets unless directed otherwise by the user.</p>
  </sec>
  <sec id="sec8">
    <label>8.</label>
    <title>Program availabilty   </title>
    <p>This software is available as a stand-alone executable which does not require MATLAB to be installed on the user’s computer. However MATLAB will be required to run the source code. Microsoft Excel is required to view certain saved data files. The <italic>SAXS4COLL</italic> software has been developed for research purposes with no commercial interest. Users can obtain the program at no cost by downloading the stand-alone executable and MATLAB source code/supporting files at the following addresses:</p>
    <p>Executable:</p>
    <p>Doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.4775743">https://doi.org/10.6084/m9.figshare.4775743</ext-link>
</p>
    <p>Web link: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/7be18c69b8b0bd113db7">https://figshare.com/s/7be18c69b8b0bd113db7</ext-link>
</p>
    <p>Code:</p>
    <p>Doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.4776478">https://doi.org/10.6084/m9.figshare.4776478</ext-link>
</p>
    <p>Web link: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/94d1afd980b785b99d69">https://figshare.com/s/94d1afd980b785b99d69</ext-link>
</p>
    <p>User Guide:</p>
    <p>Doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.4776484">https://doi.org/10.6084/m9.figshare.4776484</ext-link>
</p>
    <p>Web link: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/9c7c7e5873610d8c6d1d">https://figshare.com/s/9c7c7e5873610d8c6d1d</ext-link>
</p>
  </sec>
  <sec id="sec9">
    <label>9.</label>
    <title>Conclusion   </title>
    <p><italic>SAXS4COLL</italic> was designed to satisfy the requirement for rapid automated data reduction and analysis of increasingly large collagen SAXS datasets, while retaining sufficient user interaction and flexibility to cater for variance in data type and quality across specimen types and different SAXS beamlines. The software displays all processing stages and gives the user full control to accept or repeat and adjust parameters at any stage until the user is satisfied with the result. The software produces an organized Microsoft Excel spreadsheet with a record of the data processing stages and results.</p>
    <p><italic>SAXS4COLL</italic> combines interactive features for data pre-processing, bespoke background subtraction, semi-automated peak detection and calibration. Both equatorial and meridional SAXS peak parameters can be measured, and the former can be deconstructed into cylinder and lattice contributions. Finally, the software combines functionality for determination of collagen spatial order parameters with a rudimentary orientation plot capability. While complete automation of the <italic>SAXS4COLL</italic> processing is not practical given the amount of user judgment required in analysis, the program maximizes efficiency by supporting a quick-load feature and semi-automated batch analysis. Directories of related files can be rapidly loaded with one click and the original background/cylinder transform fitting parameters either retained or quickly modified. In addition to collagen-based tissues, <italic>SAXS4COLL</italic> could be adapted for use in other cylindrically symmetric scattering systems such as lamellar polymers (<italic>e.g.</italic> latex, silks <italic>etc</italic>.). The MATLAB source code is available to download for users who require modification of the program functionality (<italic>e.g.</italic> bespoke background functions) to cater for more diverse datasets.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to the Diamond Light Source for access to Beamline I22. We also thank the Bristol Eye Bank for providing human ocular tissues, data from which were used to develop and test the software. The assistance of Dr Christina Kamma-Lorger and Dr James Doutch in testing the software is also gratefully acknowledged.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Coudrillier, B., Pijanka, J. K., Jefferys, J., Goel, A., Quigley, H. A., Boote, C. &amp; Nguyen, T. D. (2015). <italic>PLoS One</italic>, <bold>10</bold>, e0131396.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Jacques, D. A. &amp; Trewhella, J. (2010). <italic>Protein Sci.</italic>
<bold>19</bold>, 642–657.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Meek, K. M. &amp; Boote, C. (2009). <italic>Prog. Retin. Eye Res.</italic>
<bold>28</bold>, 369–392.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Meek, K. M. &amp; Quantock, A. J. (2001). <italic>Prog. Retin. Eye Res.</italic>
<bold>20</bold>, 95–137.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Oster, G. &amp; Riley, D. P. (1952). <italic>Acta Cryst.</italic>
<bold>5</bold>, 272–276.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Rajkumar, G., AL-Khayat, H. A., Eakins, F., Knupp, C. &amp; Squire, J. M. (2007). <italic>J. Appl. Cryst.</italic>
<bold>40</bold>, 178–184.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Squire, J. M., AL-Khayat, H. A., Arnott, S., Crawshaw, J., Denny, R., Diakun, G., Dover, D., Forsyth, T., He, A., Knupp, C., Mant, G., Rajkumar, G., Rodman, M., Shotton, M. &amp; Windle, A. (2003). <italic>Fibre Diff. Rev.</italic>
<bold>11</bold>, 7–19.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Squire, J. M. &amp; Knupp, C. (2004). <italic>J. Muscle Res. Cell Motil.</italic>
<bold>25</bold>, 423–438.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Whitford, C., Studer, H., Boote, C., Meek, K. M. &amp; Elsheikh, A. (2015). <italic>J. Mech. Behav. Biomed. Mater.</italic>
<bold>42</bold>, 76–87.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Layout of the <italic>SAXS4COLL</italic> GUI, illustrating the positions of the main processing and display windows, including image display windows (axes 1 and 2), background fitting and display windows (axes 3 and 4), the fibre orientation plot window (axes 6), and the collagen fibril lattice function display window (axes 7).</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig1"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Pattern centring. (<italic>a</italic>) Selection of seven points (crosses) on a chosen calibrant diffraction ring (in this case from tendon collagen). (<italic>b</italic>) Calculated centre (red cross). The dashed red circle represents the best fit to the selected points.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig2"/>
  </fig>
  <fig id="fig3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Removal of outliers and recovery of undetected areas of unprocessed patterns. (<italic>a</italic>) Original unprocessed image. (<italic>b</italic>) Adjusting slider limits; the lower limit (LL) threshold has been set to 6.1 such that undetected data (in this case from detector gaps) appear as white areas. (<italic>c</italic>) The same pattern after compensation. The SAXS azimuthally integrated signal is shown under each pattern.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig3"/>
  </fig>
  <fig id="fig4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Interactive calibration using rat-tail tendon collagen. (<italic>a</italic>) Calibrant SAXS pattern displayed in the <italic>SAXS4COLL</italic> GUI. (<italic>b</italic>) Radial SAXS signal display, showing manual selection of the collagen meridional first-order peak position to be used for calibration.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig4"/>
  </fig>
  <fig id="fig5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Power function background fitting. The azimuthally integrated scattering signal (blue) is fitted with a power-law background function (black). User-selected fitting points are shown as red, yellow and green crosses.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig5"/>
  </fig>
  <fig id="fig6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Collagen peak detection and fibril transform (Bessel function) fitting. (<italic>a</italic>) Power-function-subtracted data with fitted Bessel function curve and the interfibrillar peak (green circle) and third-order meridional peak (black circle) detected. Magenta circles show the detected HHW limits. (<italic>b</italic>) Expanded view of the Bessel function fitting.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig6"/>
  </fig>
  <fig id="fig7" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Division of the cylinder transform to obtain the Bessel-compensated interference function. (<italic>a</italic>) New interfibrillar peak (green circle) selection from Bessel-compensated interference function. Black circles show the search region of the interfibrillar peak and magenta circles show detected HHW limits. (<italic>b</italic>) The results table, displaying collagen structure parameters before (top panel) and after (bottom panel) Bessel compensation. The last line of the top panel shows the fibril diameter calculated from the fitted Bessel function used for compensation.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig7"/>
  </fig>
  <fig id="fig8" orientation="portrait" position="float">
    <label>Figure 8</label>
    <caption>
      <p>Collagen orientation polar plot. The aligned collagen scatter (from fibrils preferentially oriented over and above any underlying randomly oriented collagen) is represented as a polar vector plot. The length of a vector from the plot centre to edge in any direction is proportional to the relative number of collagen fibrils preferentially oriented at that angle. In this example the orientation distribution of the fibrils is approximately orthogonal bimodal.</p>
    </caption>
    <graphic xlink:href="j-50-01235-fig8"/>
  </fig>
</floats-group>
