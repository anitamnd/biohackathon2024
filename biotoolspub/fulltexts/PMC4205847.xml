<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Pub. Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4205847</article-id>
    <article-id pub-id-type="pii">ncomms5893</article-id>
    <article-id pub-id-type="doi">10.1038/ncomms5893</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An exact arithmetic toolbox for a consistent and reproducible structural analysis of metabolic network models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chindelevitch</surname>
          <given-names>Leonid</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Trigg</surname>
          <given-names>Jason</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Regev</surname>
          <given-names>Aviv</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Mathematics Department, Computer Science and Artificial Intelligence Laboratory, MIT</institution>, Cambridge, Massachusetts 02139, <country>USA</country></aff>
      <aff id="a2"><label>2</label><institution>Broad Institute, 7 Cambridge Center</institution>, Cambridge, Massachusetts 02142, <country>USA</country></aff>
      <aff id="a3"><label>3</label><institution>Howard Hughes Medical Institute</institution>, 4000 Jones Bridge Road, Chevy Chase, MD 20815, <country>USA</country></aff>
      <aff id="a4"><label>4</label><institution>Department of Biology, MIT</institution>, Cambridge, Massachusetts 02139, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>bab@mit.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>07</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>4893</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>06</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>08</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014, Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-sa/4.0/">http://creativecommons.org/licenses/by-nc-sa/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>Constraint-based models are currently the only methodology that allows the study of metabolism at the whole-genome scale. Flux balance analysis is commonly used to analyse constraint-based models. Curiously, the results of this analysis vary with the software being run, a situation that we show can be remedied by using exact rather than floating-point arithmetic. Here we introduce MONGOOSE, a toolbox for analysing the structure of constraint-based metabolic models in exact arithmetic. We apply MONGOOSE to the analysis of 98 existing metabolic network models and find that the biomass reaction is surprisingly blocked (unable to sustain non-zero flux) in nearly half of them. We propose a principled approach for unblocking these reactions and extend it to the problems of identifying essential and synthetic lethal reactions and minimal media. Our structural insights enable a systematic study of constraint-based metabolic models, yielding a deeper understanding of their possibilities and limitations.</p>
    </abstract>
    <abstract abstract-type="web-summary">
      <p><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="i1" xlink:href="ncomms5893-i1.jpg"/>Current tools to analyse constraint-based models of metabolic networks have limited accuracy due to their use of floating-point arithmetic. Here the authors present MONGOOSE, a new computational tool that analyses such models in exact arithmetic, providing improved accuracy and reproducibility.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Flux balance analysis (FBA)<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref> has been the dominant approach to analysing constraint-based metabolic network models, as an alternative to mass-action kinetic models<xref ref-type="bibr" rid="b7">7</xref> and biochemical systems analysis<xref ref-type="bibr" rid="b8">8</xref> that cannot currently be performed on a whole-genome scale. This analysis of metabolic network models typically reveals a number of key structural elements. It allows the identification of blocked reactions, which are reactions that cannot have a non-zero flux due to the constraints of the model<xref ref-type="bibr" rid="b9">9</xref>, as well as enzyme subsets, which are groups of reactions constrained to have proportional fluxes to one another<xref ref-type="bibr" rid="b10">10</xref>. FBA leads to predictions about the growth rate of a cell under various conditions defined by the availability of specific nutrients<xref ref-type="bibr" rid="b5">5</xref>, the minimal media, smallest sets of nutrients allowing growth<xref ref-type="bibr" rid="b11">11</xref>, essential genes<xref ref-type="bibr" rid="b12">12</xref> and synthetic lethal reactions<xref ref-type="bibr" rid="b13">13</xref>, groups of one or two reactions whose deletion is predicted to disable growth altogether.</p>
  <p>Most previously published tools for FBA use floating-point arithmetic<xref ref-type="bibr" rid="b14">14</xref>. Here, we argue that performing FBA in floating-point arithmetic may lead to inconsistent and occasionally irreproducible analysis results. These arise because floating-point arithmetic is designed to provide a correct answer to a question about a slightly perturbed version of the input, which makes sense in most applications, but not metabolic network analysis. Indeed, since the stoichiometric coefficients are small integers or ratios of such integers, the perturbed version of the input does not correspond to a valid model. In other words, floating-point arithmetic does not provide a mechanism for ensuring that the constraints of the model are satisfied exactly, rather than within a small tolerance.</p>
  <p>Moreover, while previously published tools perform some structural analysis of the input model, there are several features that these analyses tend to lack. First, the blockage of a reaction in the model is usually remedied by the addition of one or more reactions from a database of biochemical reactions<xref ref-type="bibr" rid="b15">15</xref>, even though the blockage may also be due to incorrect irreversibility constraints on the reactions in the model, an idea that has only been explored sporadically<xref ref-type="bibr" rid="b16">16</xref>. Second, the fact that some reversible reactions are able to proceed in only one of the two possible directions due to model constraints, suggesting a discrepancy between model functionality and biological assumptions, has not been recognized in previous analyses. Last, the structural analysis was not guaranteed to stop after a single cycle, proceeding instead over multiple iterations<xref ref-type="bibr" rid="b10">10</xref>.</p>
  <p>We address these limitations by introducing the MONGOOSE (MetabOlic Network GrOwth Optimization Solved Exactly) toolbox. Its core is an exact arithmetic-based algorithmic pipeline (<xref ref-type="fig" rid="f1">Fig. 1</xref>) which incorporates a structural analysis supported by new theoretical results. In particular, MONGOOSE classifies each blocked reaction into one of three categories based on the cause of blockage, and proposes small sets of constraints that can be relaxed to remove the blockage. The toolbox also identifies semiblocked reactions, those reversible reactions in which one of the two possible directions is blocked and similarly proposes ways of unblocking them. In addition, the structural analysis performed by MONGOOSE is proven to converge after a single cycle and allows the user to perform further analyses like the identification of minimal media, essential genes or synthetic lethal reactions on a significantly smaller model.</p>
  <p>We apply MONGOOSE to the 98 genome-scale metabolic network reconstructions collected in the UCSD Systems Biology repository<xref ref-type="bibr" rid="b17">17</xref>. We show significant differences between the results of MONGOOSE and COBRA<xref ref-type="bibr" rid="b14">14</xref>, a widely used toolkit for metabolic network analysis, and produce independently verifiable correctness certificates for those of MONGOOSE. Furthermore, we surprisingly find that of the 89 networks with a well-defined biomass reaction, 44 cannot exhibit <italic>in silico</italic> growth under any condition (are blocked). MONGOOSE provides a detailed diagnosis of the reason for this situation by identifying a small set of constraints whose relaxation resolves the blockage. Our toolbox also identifies all essential and synthetic lethal reactions and defines minimal media<xref ref-type="bibr" rid="b11">11</xref>, problems for which MONGOOSE provides the additional benefit of a dramatic lossless compression of the metabolic network, similar in spirit to the use of compressive methods in genomics<xref ref-type="bibr" rid="b18">18</xref>. This compression allows the complete analysis of all 98 models to finish in less than one day.</p>
  <p>MONGOOSE thus produces certifiably consistent and reproducible results, while leveraging its structural insights to convert many previously intractable problems in metabolic network analysis, including those involving energy balance analysis, to more tractable ones. Finally, MONGOOSE provides a module for checking the correctness of any flux mode or cutset (set of reactions whose deletion disables growth) in exact arithmetic. The software implementing MONGOOSE is freely available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://mongoose.csail.mit.edu/">http://mongoose.csail.mit.edu/</ext-link>, and also as Supplementary Software.</p>
  <sec disp-level="1" sec-type="results">
    <title>Results</title>
    <sec disp-level="2">
      <title>Overview of the MONGOOSE pipeline</title>
      <p>The MONGOOSE pipeline is designed to perform a complete structural analysis and reduction of a metabolic network. Previous methods, such as the approach introduced by Gagneur and Klamt<xref ref-type="bibr" rid="b10">10</xref>, were able to perform such analysis as well, but this analysis was substantially less complete than the one we present here. In particular, MONGOOSE provides a more detailed classification of blocked reactions, identifies semiblocked reactions, groups together all the enzyme subsets, and converges in a single iteration instead of multiple ones. If the biomass reaction is blocked, MONGOOSE can unblock it by relaxing a small number of constraints. Importantly, the structural analysis results in the reduction of the metabolic network model to a smaller model which preserves all the information contained in it.</p>
      <p>The reduced metabolic network can then be used to efficiently identify essential and synthetic lethal reactions and minimal growth media. The complete pipeline is illustrated in <xref ref-type="fig" rid="f1">Fig. 1</xref> and described in more detail in the Methods, where the structural features identified by MONGOOSE are demonstrated on a small example from the MetaTool website<xref ref-type="bibr" rid="b19">19</xref>, augmented with an additional seven metabolites and 10 reactions for illustration purposes. An additional illustration of structural features identified by MONGOOSE is provided in <xref ref-type="supplementary-material" rid="S1">Supplementary Figure 1</xref>.</p>
      <p>In addition to the more extensive structural analysis, a key distinguishing feature of MONGOOSE is its use of exact arithmetic. This ensures that a certificate is produced for each feature which can be verified independently of the analysis. Such a certificate may consist, for instance, of the coefficients of a linear combination of the model constraints that imply that a particular reaction is blocked (cannot have a non-zero flux), or that two reactions in an enzyme subset always have fluxes that are proportional to one another. Existence of these certificates and an effective way of producing them are guaranteed by the theoretical results in <xref ref-type="supplementary-material" rid="S1">Supplementary Notes 1–8</xref>.</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE identifies novel structural features</title>
      <p>Unlike previous work<xref ref-type="bibr" rid="b14">14</xref><xref ref-type="bibr" rid="b20">20</xref>, where blocked reactions are identified regardless of the cause of blockage (with the possible exception of dead ends, reactions which contain a unique internal metabolite<xref ref-type="bibr" rid="b14">14</xref>), MONGOOSE distinguishes between three kinds of blocked reactions. We further introduce two kinds of semiblocked reactions, that is, reversible reactions which only admit flux in one of the directions, a feature that, to the best of our knowledge, has not been identified in earlier work.</p>
      <p>For each topology-blocked reaction (one whose blockage follows from the topology of the metabolic network), MONGOOSE returns an informative causal chain leading to the identification of the blockage, which helps remove the blockage in many cases. For each stoichiometry-blocked reaction <italic>i</italic>, MONGOOSE can identify a linear combination of the metabolites that contains a 1 in position <italic>i</italic> and a 0 everywhere else; the structural result we prove in <xref ref-type="supplementary-material" rid="S1">Supplementary Note 2</xref> shows that there is always such a linear combination. For each irreversibility-blocked reaction <italic>i</italic>, MONGOOSE can identify a subset of irreversible reactions that is responsible for the blockage. For each semiblocked reaction <italic>i</italic>, MONGOOSE can identify a subset of the constraints that is responsible for the semiblockage. It also labels semiblocked reactions as irreversible and reverses the direction of the effectively reverse ones by multiplying their stoichiometric coefficients by –1.</p>
      <p>In addition to deleting all blocked reactions and adjusting semiblocked reactions to be irreversible, MONGOOSE groups reactions that always have proportional fluxes into enzyme subsets, using a previously described method<xref ref-type="bibr" rid="b10">10</xref>, which we show in <xref ref-type="supplementary-material" rid="S1">Supplementary Note 5</xref> to be sufficient to identify all such subsets. This process reduces the size of the model without losing any information. As a final step, MONGOOSE identifies and removes a maximal set of redundant flux balance constraints, those that can be created from the remaining ones by taking linear combinations. This reduction sets the stage for further analyses, such as the identification of essential and synthetic lethal reactions and of minimal media.</p>
    </sec>
    <sec disp-level="2">
      <title>Consistency and reproducibility require exact arithmetic</title>
      <p>A fundamental question in constraint-based metabolic network models is whether a particular reaction can be active under given environmental conditions (growth media). Biochemical reactions, and therefore stoichiometric matrices, have rational coefficients. In fact, except for a small number of reactions involving cofactors, most of these coefficients tend to be small integers. Since the constraints on a metabolic network are represented through its stoichiometric matrix, it is critical that this representation be accurate. However, the linear programming solvers typically used in metabolic network analysis represent the entries of stoichiometric matrices as floating-point numbers, leading to a marginal loss of accuracy.</p>
      <p>While such loss of accuracy is acceptable in many applications, issues resulting from it have been attested to in the context of integer programs, which use the results of linear programs to make branching decisions in a branch-and-bound approach<xref ref-type="bibr" rid="b21">21</xref>. Our experience also shows this accuracy loss to be a problem for metabolic network analysis. Indeed, it is not sufficient to know whether a slightly perturbed version of a metabolic network can have a non-zero flux through a given reaction because this knowledge gives no information about whether this condition is true for the actual network. This argument implies that backward stability, the usual requirement for numerical linear algebra algorithms<xref ref-type="bibr" rid="b22">22</xref>, is not sufficient for metabolic network analysis, and forward stability (the right answer for the actual network) is needed. In addition, our theoretical results, proven in <xref ref-type="supplementary-material" rid="S1">Supplementary Notes 1–8</xref>, break down in floating-point arithmetic and only hold in exact arithmetic.</p>
      <p>For this reason we implement all our algorithms in exact arithmetic and perform all our linear optimizations using the QSopt_ex solver<xref ref-type="bibr" rid="b23">23</xref>. One major advantage of using this solver is that it provides a certificate for the correctness of the solution to a linear optimization problem, meaning that its results can be verified independently of the solver. This ability is to be contrasted with an almost exclusive use of floating-point-based linear program solvers in the field of metabolic network analysis today, which only provide approximate certificates and whose solutions are only approximately correct. While some existing approaches, such as the MetaTool toolbox<xref ref-type="bibr" rid="b19">19</xref>, do use exact arithmetic, their application to the analysis of genome-scale metabolic networks is mostly restricted to elementary mode enumeration. Instead of using exact arithmetic, one could attempt to compute the tolerance required to guarantee an exact solution based on the input stoichiometric matrix. Unfortunately, as we discuss in the Methods, this computation turns out to be difficult in its own right, while approximating the tolerance from below gives extremely small values that would make the calculation of a solution prohibitive.</p>
    </sec>
    <sec disp-level="2">
      <title>The results of MONGOOSE reveal inconsistencies in COBRA</title>
      <p>To certify that exact arithmetic gives different results from floating-point arithmetic in practice, we compared our results with those produced by the popular COBRA toolbox<xref ref-type="bibr" rid="b14">14</xref>. Under default settings, COBRA successfully parsed 30 models out of the 98 models we investigated. Both COBRA and MONGOOSE detected a well-defined biomass reaction in 17 of these 30 network models. In terms of deciding whether the biomass reaction is blocked, there were multiple discrepancies between COBRA and MONGOOSE. Specifically, three of the models—the <italic>Escherichia coli</italic> iAF1260, <italic>Helicobacter pylori</italic> iIT341 and <italic>Mycobacterium tuberculosis</italic> iNJ661—were predicted to be able to grow by COBRA, but not by MONGOOSE. This difference is due to COBRA not enforcing the flux balance constraints on internal metabolites exactly—even if the deviations from exact flux balance are small, they can make the difference between a feasible and an infeasible problem.</p>
      <p>Similarly, significant differences were identified between the total numbers of blocked reactions predicted by COBRA and by MONGOOSE. The differences did not all go in the same direction. For instance, in the <italic>Escherichia coli</italic> iJO1366 model, COBRA and MONGOOSE respectively found 878 and 639 blocked reactions out of a total 2,583, while in the <italic>Saccharomyces cerevisiae</italic> iND750 model, they respectively found 635 and 796 blocked reactions out of a total 1,266. These discrepancies clearly show that the floating-point approach differs from the exact arithmetic approach not only in theory, but also in important practical cases.</p>
      <p>To further investigate the discrepancy between the floating-point and the exact arithmetic analyses, we extracted the smallest of the models, the <italic>Helicobacter pylori</italic> iIT341, predicted not to be able to grow by MONGOOSE, into a 363 × 461 stoichiometric matrix which we then submitted to the various solvers available at NEOS<xref ref-type="bibr" rid="b24">24</xref> to optimize its growth rate in rich media. Out of six linear programming solvers on NEOS, five predicted a non-zero growth rate, and only CPLEX<xref ref-type="bibr" rid="b25">25</xref> predicted a zero growth rate, in agreement with QSopt_ex used by MONGOOSE.</p>
      <p>This result suggests that a toolbox like COBRA is highly sensitive to the particular floating-point solver it uses and will be unlikely to predict the status of the biomass reaction correctly in a large genome-scale metabolic network unless it uses a solver such as CPLEX<xref ref-type="bibr" rid="b25">25</xref>, which has the stringent feasibility tolerance (maximum allowed violation of a constraint in a linear program) of 10<sup>−6</sup> as its default value. However, even in case the feasibility tolerance is set to the smallest allowed value of 10<sup>−9</sup>, rounding errors lead to the failure of identifying many pairs of reactions as belonging to the same enzyme subset, as we show in <xref ref-type="fig" rid="f2">Fig. 2</xref> and describe in detail in the Methods; thus the use of an exact arithmetic solver, like QSOpt_ex used in MONGOOSE, is justified.</p>
      <p>To make it easier for users of other toolboxes, such as COBRA<xref ref-type="bibr" rid="b14">14</xref> or CellNetAnalyzer<xref ref-type="bibr" rid="b20">20</xref>, to verify the correctness of the results they obtain, we also provide a module in MONGOOSE which can either validate or correct these external computation results by using exact arithmetic. To do so, it suffices to provide MONGOOSE with a description of the metabolic network and a description of the flux vector or cutset produced by the external software. For flux modes, MONGOOSE computes the distance from the given vector to the flux cone determined by the model, and either validates the result if this distance is 0, or produces the flux mode closest to the given one if it is not. For cutsets, MONGOOSE checks whether the set of reactions indeed forms a cutset for the reaction of interest, and if it does not, finds a small additional set of reactions that can be added to it to form a cutset.</p>
    </sec>
    <sec disp-level="2">
      <title>The biomass reaction is blocked in 44 out of 89 models</title>
      <p>When MONGOOSE is run on previously published models (<xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>), the most striking feature is the fact that 44 out of the 89 models containing a well-defined biomass reaction cannot exhibit growth without the additional modifications discussed below. The fact that this result had not been discovered before is due to our novel use of exact arithmetic for the genome-scale analysis.</p>
      <p>This finding likely indicates that the current state of our knowledge of metabolism may be less complete than thought, and illustrates the sensitivity of constraint-based models to the particular coefficients used to reflect the biomass composition. Overall, very small perturbations to the coefficients of a biomass reaction are typically insufficient to enable growth (<xref ref-type="supplementary-material" rid="S1">Supplementary Note 8</xref>). However, the smallest perturbation required to be made to the coefficients of the biomass reaction, defined as the smallest <italic>δ</italic> such that changing all biomass coefficients by values at most <italic>δ</italic> enables growth, varies substantially across the blocked models we investigated, from one as small as 3 × 10<sup>−8</sup> for the iIN800 model of <italic>Saccharomyces cerevisiae</italic> to 5.3 for a model of <italic>Staphylococcus aureus</italic>. These values are shown in the last column of <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>. This finding suggests that in a few models, making small changes to the biomass coefficients is indeed sufficient to remove the blockages, while in the majority of models, further modifications may be required.</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE diagnoses blockages and proposes ways to remedy them</title>
      <p>MONGOOSE also diagnoses the underlying cause of blockage and proposes possible solutions. MONGOOSE distinguishes between three types of blocked reactions (further discussed in the Methods). Often, a topology-blocked biomass reaction can be resolved immediately by either adding a biomass export reaction or treating the biomass metabolite as external, or correcting obvious typographical errors in the model. These approaches resolve the problem for 23 out of the 33 topology-blocked models (highlighted in yellow in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>), with 11 actually being able to produce biomass after the correction and the rest being blocked for the more complicated reasons described below.</p>
      <p>Furthermore, many models do not contain a proper specification of external metabolites, or have incorrectly compartmentalized transport reactions. We correct all of these models and unblock three out of the five that were previously blocked. All these models are highlighted in blue in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>. In addition to being topology–blocked, the biomass reaction can be stoichiometry or irreversibility–blocked. For the first type of blockage, our approach relaxes some balance constraints on internal metabolites, allowing them not to be perfectly balanced; for the second type of blockage, it relaxes some directionality constraints on irreversible reactions, allowing them to proceed in the reverse direction. We find that all the 44 models which cannot exhibit growth can be unblocked by relaxing an average of five constraints (<xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE finds other blocked reactions and enzyme subsets</title>
      <p>In addition to the biomass reaction being blocked in many of the models we investigated, most of them have a large fraction of other blocked reactions. This fraction varies from 3.8% for <italic>Buchnera aphidicola</italic> to 95.1% for <italic>Pichia pastoris</italic> PpaMBEL1254, with an average of 36.3%. As with blocked biomass reactions, this situation suggests gaps in the current state of our knowledge of metabolism.</p>
      <p>All semiblocked reactions (ones for which only one direction is effectively possible) are converted to be irreversible, and effectively reverse ones are flipped (multiplied by –1). We find that up to 30% of all unblocked reactions are effectively forward, and up to 20% of all unblocked reactions are effectively reverse, with the maximal values reached by <italic>Rhodobacter sphaeroides</italic> and <italic>Pichia pastoris</italic> PpaMBEL1254, respectively. The average fractions of effectively forward and effectively reverse reactions are 12.0% and 5.5%, respectively.</p>
      <p>We find that a significant fraction of the unblocked reactions in each network is part of an enzyme subset (reactions whose fluxes are constrained to be proportional to one another). This fraction varies from 16.0% for <italic>Aspergillus nidulans</italic> to 91.8% for <italic>Pichia pastoris</italic> PpaMBEL1254, with an average of 53.2%. The biomass reaction is in an enzyme subset when it is not blocked in all but five of the models, possibly because of the large number of metabolites (and hence constraints) it typically involves.</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE identifies small reaction cutsets and minimal media</title>
      <p>A reaction cutset is a set of reactions whose deletion disables growth by forcing the flux through the growth reaction to be 0. A cutset containing only one reaction is called an essential reaction. An essential reaction is thus one which is indispensable for biomass production <italic>in silico</italic> (since we do not constrain the fluxes through exchange reactions, this corresponds to essentiality for growth in a rich medium). This definition of essentiality is identical to the one used in early work on constraint-based models<xref ref-type="bibr" rid="b26">26</xref> as well as more recently in ref. <xref ref-type="bibr" rid="b27">27</xref>, but differs from non-standard topological approaches<xref ref-type="bibr" rid="b6">6</xref> and the flux surplus rather than flux balance model<xref ref-type="bibr" rid="b28">28</xref>.</p>
      <p>In addition to those reactions which are in an enzyme subset with the biomass reaction, there may be other reactions that are essential. We find that up to 77.2% (for <italic>Buchnera aphidicola</italic>) of all unblocked reactions not in an enzyme subset with the biomass reaction are essential, with an average of 9.7%. A cutset containing two reactions neither of which is essential is called a synthetic lethal pair. We find that up to 9.7% (for <italic>Buchnera aphidicola</italic>) of all unblocked nonessential reaction pairs are synthetic lethal, with an average of 0.31%.</p>
      <p>A minimal medium is a smallest set of exchange reactions that is sufficient for the organism to produce biomass<xref ref-type="bibr" rid="b11">11</xref>. While the MONGOOSE pipeline cannot find the smallest set of such reactions (this is a computationally intractable problem in general<xref ref-type="bibr" rid="b12">12</xref>), it is able to find small minimal media for all the organisms with an unblocked biomass reaction. The size of the smallest minimal medium ranges between 1 and 43 exchange reactions, with an average of 10.</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE significantly reduces the size of the networks</title>
      <p>A remarkable result of applying the MONGOOSE pipeline is that the resulting stoichiometric matrix is significantly smaller than the original stoichiometric matrix, providing an average 4.2-fold reduction in the number of reactions. This reduction in size varies from a factor of 1.35 for the metabolic network of <italic>Saccharomyces cerevisiae</italic> iLL672 to a factor of 139 for <italic>Pichia pastoris</italic> PpaMBEL1254. We reduce a stoichiometric matrix by observing that blocked reactions do not contribute to the metabolic capabilities of the model; enzyme subsets can be combined into single reactions without loss of information; and redundant constraints do not change a model’s behaviour. We say that a stoichiometric matrix is in canonical form if it contains no blocked reactions, enzyme subsets or redundant constraints, and show (<xref ref-type="supplementary-material" rid="S1">Supplementary Note 6</xref>) that the proposed reduction process finishes after a single iteration because the reduced network is guaranteed to not contain any of these structural elements.</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE applies energy balance analysis to reduced networks</title>
      <p>Energy balance analysis<xref ref-type="bibr" rid="b29">29</xref><xref ref-type="bibr" rid="b30">30</xref><xref ref-type="bibr" rid="b31">31</xref> provides an additional set of constraints on possible flux vectors to ensure that they are consistent with the laws of thermodynamics. These constraints require, for each admissible flux vector <bold><italic>v</italic></bold>, an energy vector <bold><italic>w</italic></bold> in the row space of the part of the stoichiometric matrix <italic>S</italic> containing internal reactions whose entries have signs opposite to the corresponding entries of <italic><bold>v</bold></italic>. We consider weakly feasible flux vectors (called T-feasible vectors in ref. <xref ref-type="bibr" rid="b30">30</xref>) by allowing <italic><bold>w</bold></italic> to have non-zeros where <bold><italic>v</italic></bold> has zeros, but not vice versa (<xref ref-type="disp-formula" rid="eq4">equation (2)</xref>). We can apply the same theoretical results that we used to structurally analyse and reduce the stoichiometric matrix <italic>S</italic> to energy balance analysis, which allows us to identify several structural features.</p>
      <p>Enzyme subsets that contain only internal reactions and add up to a reaction with all coefficients equal to 0 are blocked, because any energy vector would have to have a 0 in the position corresponding to such a reaction, therefore constraining its flux to 0 as well. Such reactions, which we call zero loops, are a special case of type III loops<xref ref-type="bibr" rid="b31">31</xref>. The fraction of enzyme subsets that are zero loops reached 55.0% for <italic>Pichia pastoris</italic> PpaMBEL1254, with an average of 1.7%. In addition to zero loops, energy-blocked reactions can be identified from the irreversibility constraints, when the requirement that <inline-formula id="d33e537"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e538" xlink:href="ncomms5893-m1.jpg"/></inline-formula> implies that <italic><bold>w</bold></italic><sub><italic>i</italic></sub>=0 and hence <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0. The fraction of energy-blocked reactions after the deletion of zero loops reached 88.3% for the <italic>Buchnera aphidicola</italic> model, with an average of 6.4%.</p>
      <p>Energy balance analysis also allows us to identify unidirectional reactions (analogous to the semiblocked reactions), reversible reactions which only have one possible direction due to the energy balance constraints. The fraction of unblocked reactions that were effectively reverse due to energy balance constraints reached a maximum of 11.3% for <italic>Chromohalobacter salexigens</italic>, with an average of 1.1%. Surprisingly, there were no effectively forward reactions due to energy balance constraints in any of the models. Additionally, any isozymes (reactions that are multiples of one another) can be grouped into a single isozyme subset for the purpose of energy balance analysis, as their energy vectors are constrained to have proportional values; they are analogous to the enzyme subsets deduced from the flux balance constraints. The fraction of unblocked internal reactions in an isozyme subset reached 85.1% for <italic>Methanosarcina acetivorans</italic> iMB745, with an average of 16.8%. All the model-specific results are displayed in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>.</p>
      <p>Because the constraints imposed by energy balance are nonlinear, the reductions obtained by using them lead to further reductions due to the flux balance constraints. For this reason, MONGOOSE alternates between the reductions due to energy balance and flux balance until no further changes can be made due to either one. This requires an average of six iterations. After this process terminates, the growth reaction ends up being blocked due to the combined effect of flux balance and energy balance constraints in 30 out of 59 models where it is not blocked due to flux balance constraints alone (we indicate this as ‘EnergyBlocked’ in the GrowStatus column in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>). In additon, the final network is significantly smaller than the initial reduced network. The reduction in size varies from a factor of 1.01 for <italic>Shewanella oneidensis</italic> to 68 for <italic>Buchnera aphidicola</italic>, with an average reduction factor of 2.33.</p>
    </sec>
    <sec disp-level="2">
      <title>MONGOOSE exhibits a reasonable running time</title>
      <p>While the exact arithmetic approach used by MONGOOSE necessarily slows down the computations, in our experience, the slowdown never exceeds an order of magnitude. Thus, the complete structural analysis of all 98 metabolic network models required a total of only 10 h of processing on a single processor. This corresponds to an average of 6 min per metabolic network model. In comparison, the COBRA toolbox<xref ref-type="bibr" rid="b14">14</xref> required, on average, just under a minute to find the blocked reactions based on flux variability analysis in a metabolic network, with the average computed over the networks it was able to parse directly. COBRA does not appear to identify enzyme subsets directly, only to find correlated sets of fluxes based on a sample of flux vectors from the model, which appears sufficiently different from our task to justify excluding it from the comparison.</p>
      <p>This small decrease in speed is, however, more than compensated for by the reproducibility and robustness of the results, as well as the significant reduction of the size of the metabolic network that speeds up all subsequent analyses. In particular, the complete identification of all essential reactions and synthetic lethal pairs in the 56 models with a well-defined biomass reaction that was not blocked required a total of 5 h of additional processing time, or less than 6 min per metabolic model, using the search algorithm described in Methods. The iterative application of energy and flux balance to the reduced networks required an additional 12.5 h.</p>
    </sec>
  </sec>
  <sec disp-level="1" sec-type="discussion">
    <title>Discussion</title>
    <p>We asserted that while constraint-based metabolic network models are a valuable tool for gaining insight into metabolism, their analysis needs to be done in exact arithmetic to ensure that their results are consistent and reproducible. The fact that MONGOOSE revealed that 44 out of 89 previously published networks containing biomass reactions cannot exhibit <italic>in silico</italic> growth may point to the need for more complete network reconstructions or, more likely, to the need for a more accurate measurement of biomass coefficients.</p>
    <p>Our work provides several important contributions to the field of metabolic network analysis. On the theoretical front, MONGOOSE is grounded in a solid theoretical basis consisting of novel results about the structure of constraint-based genome-scale metabolic network models. Furthermore, to the best of our knowledge, the need for using exact arithmetic in metabolic network analysis has never been explicitly demonstrated on a large collection of existing genome-scale metabolic network models, as we have done using MONGOOSE.</p>
    <p>On the practical front, MONGOOSE makes three key contributions. First, it is able to perform a complete structural analysis of the network as a preprocessing step, providing useful insights into possible sources of incompleteness and identifying and troubleshooting any issues leading to the blockage of the growth (biomass) reaction. Second, MONGOOSE substantially compresses the metabolic network, making it more feasible to perform further analyses (gene essentiality, synthetic lethality, minimal media and some energy balance analysis) without losing any information. Third, MONGOOSE provides an automated interface that parses the network, translates the problem into a format suitable for any linear programming solver and parses the solution returned by the solver into a format suitable for further processing, as well as a module for checking the validity of flux vectors and cutsets obtained by any other solver in exact arithmetic. All these features can be readily integrated with existing pipelines for metabolic network analysis.</p>
    <p>An approach based on our theoretical results could also be used to identify some or all elementary flux modes<xref ref-type="bibr" rid="b12">12</xref> and minimal cutsets<xref ref-type="bibr" rid="b13">13</xref> in a metabolic network, as discovered independently by another research group<xref ref-type="bibr" rid="b32">32</xref>. Future work could also include more fully incorporating energy balance constraints into the analysis, as well as making use of additional information, such as the Gibbs’ free energy of reactions, to further constrain the problem, along the lines of refs <xref ref-type="bibr" rid="b16">16</xref>, <xref ref-type="bibr" rid="b33">33</xref>, <xref ref-type="bibr" rid="b34">34</xref>. Additional refinements could include restricting the proposed changes to metabolic networks with blocked growth based on biological knowledge, such as not allowing certain reactions to proceed in the reverse direction when unblocking irreversibility blockages.</p>
    <p>Our primary focus has been on identifying potential model inaccuracies as opposed to prediction, because we believe that a faithful representation of the philosophy of constraint-based modelling coupled with reliability and reproducibility of results has a higher priority than predictive power. If any existing models are designed in such a way that the inaccuracies in them cancel out the errors introduced by floating-point arithmetic to produce good agreement with experimental results, reversing the effect of floating-point errors may temporarily result in a decrease of predictive power, but only until model inaccuracies are corrected in turn. In the future, we plan to combine our analysis efforts with comparing predictions to experimental data. The joint efforts of model developers and analysis tool developers will ultimately result in models with high predictive power under a robust analysis method.</p>
    <p>We believe that the exact arithmetic approach to the analysis of constraint-based metabolic networks opens a number of new possibilities in metabolic network analysis. First, the genome-scale metabolic network reconstructions with blocked biomass reactions can be completed or their coefficients measured more accurately. Second, the MONGOOSE methodology may be used to reconcile the predictions of metabolic network models with experimental data, leading to further refinement. Finally, MONGOOSE can be used to support genome-scale network reconstruction by helping the modeller identify incompletely reconstructed pathways or unexpected features that can be resolved experimentally. We are currently engaged in a project of this type focusing on the reconstruction of a metabolic network model for <italic>Bordetella pertussis</italic>. It is our hope that the community will adopt the MONGOOSE software as the basis for further development of metabolic network analysis methods.</p>
  </sec>
  <sec disp-level="1" sec-type="methods">
    <title>Methods</title>
    <p>This section is organized as follows. We start by describing the parser that we developed for MONGOOSE. We go on to explain why exact arithmetic is necessary for analysing metabolic networks models in a consistent and reproducible way. We describe the way we compare the results of MONGOOSE with those of COBRA<xref ref-type="bibr" rid="b14">14</xref>, a widely used metabolic network analysis tool, and CPLEX<xref ref-type="bibr" rid="b25">25</xref>, an industrial-strength linear programming solver. We continue by illustrating the structural features MONGOOSE identifies on an example network, and describing its pipeline for the structural analysis of a metabolic network. We conclude with three possible extensions to this analysis—energy balance analysis, the identification of essential and synthetic lethal reactions, and the computational design of minimal media.</p>
    <sec disp-level="2">
      <title>Description of the parser</title>
      <p>We downloaded 98 genome-scale metabolic networks representing 60 different organisms from the UCSD Systems Biology group website<xref ref-type="bibr" rid="b17">17</xref> and parsed them. The majority of the models were either provided in SBML format<xref ref-type="bibr" rid="b35">35</xref> or as Excel spreadsheets. In both cases, we performed the parsing using our own scripts in Python<xref ref-type="bibr" rid="b36">36</xref>. A few additional models provided in PDF format had to be converted into a spreadsheet format before they could be parsed. We preserved all compartment information, and considered metabolites in different compartments to be distinct, constraining them separately.</p>
      <p>We built our parser for models in SBML format on top of libSBML<xref ref-type="bibr" rid="b37">37</xref>, and the one for models in Excel spreadsheet format, on top of xlrd<xref ref-type="bibr" rid="b38">38</xref>. Because there is such a variety of formats within the latter, we had to make the parser sufficiently flexible to accommodate all of them. In addition to parsing the files, it is also able to identify a limited number of typos and other human errors introduced at the time of model generation or transcription. All the models we analysed have been extensively corrected from all the errors found by the parser, and the corrections are presented in <xref ref-type="supplementary-material" rid="S1">Supplementary Table 2</xref>.</p>
    </sec>
    <sec disp-level="2">
      <title>Importance of exact arithmetic</title>
      <p>Although floating-point arithmetic does not guarantee a solution that satisfies the problem constraints, there is a tolerance (defined by the linear program) that could ensure that we actually get correct results from a floating-point computation. This tolerance is the reciprocal of the largest determinant of a square submatrix of the constraint matrix <italic>A</italic>. Indeed, when a vertex is being computed, the coordinates in the basis <italic>B</italic> are determined by <italic>A</italic><sub><italic>B</italic></sub><italic><bold>x</bold></italic>=<italic>b</italic><sub><italic>B</italic></sub>, while the others are all 0, and Cramer’s rule<xref ref-type="bibr" rid="b22">22</xref> shows that the denominator of the solution to this system equals this determinant. We note that this can be much larger than the ratio of the magnitudes of the largest and smallest entries in the constraint matrix. For instance, a Hadamard matrix of order 20 gives a ratio of 1 as all its entries are 1 or –1, but would require a tolerance of 20<sup>−10</sup>, or about 10<sup>−13</sup>.</p>
      <p>This problem of finding the largest determinant of a square submatrix of an integer matrix <italic>A</italic> turns out to be NP-hard<xref ref-type="bibr" rid="b39">39</xref>. Khachiyan<xref ref-type="bibr" rid="b40">40</xref> gives a fast approximation algorithm that gets it within a factor of <italic>m</italic><sup>(<italic>m</italic>/2)</sup>, where <italic>m</italic> is the number of rows of <italic>A</italic> (metabolites in the network). An alternative algorithm suggested by Michel Goemans in personal communication can approximate its logarithm within a factor of 2/5 using the fact that this logarithm can be extended to a submodular nonmonotone function on the columns of <italic>A</italic>. Unfortunately, neither of these results is practical as these estimates would require a precision of about 100 digits for a typical genome-scale metabolic network model, making calculations prohibitively slow.</p>
    </sec>
    <sec disp-level="2">
      <title>Comparisons to COBRA</title>
      <p>Under default settings, COBRA successfully parsed 30 models out of the 98 models we investigated, as they were written in a version of the Systems Biology Markup Language<xref ref-type="bibr" rid="b35">35</xref> matching its defaults. We did not attempt to use COBRA to parse any models in spreadsheet formats because that would have required substantial changes to many of the source files. Hence we restricted the comparison with the former models.</p>
      <p>In all our experiments, COBRA’s parameters were set to their default values, including the use of GLPK<xref ref-type="bibr" rid="b41">41</xref> as the linear program solver. By default, COBRA declares a reaction to be blocked if the minimum and maximum absolute fluxes through it are less than <italic>δ</italic>=10<sup>−10</sup>, while the exact arithmetic of MONGOOSE does not require any arbitrary thresholds.</p>
    </sec>
    <sec disp-level="2">
      <title>Comparisons with CPLEX</title>
      <p>We tested whether the structural features detected by MONGOOSE are also detected by CPLEX with its lowest feasibility tolerance of 10<sup>−9</sup>. We did so by creating a linear problem in CPLEX format for every feature in every metabolic network that MONGOOSE found, and tested its feasibility with CPLEX. In particular, for blocked reactions, we tested whether flux was feasible; for semiblocked reactions, we tested whether flux in the blocked direction was feasible; and for enzyme subsets, we tested whether the linear combination of the reaction fluxes could be non-zero. Out of these experiments, CPLEX was not successful with enzyme subsets, failing to identify over 100 of them in the models we tested. The results in <xref ref-type="fig" rid="f2">Fig. 2</xref> show the eight models that had the most failures, as well as the proportion of failures relative to the total number of pairs of reactions in an enzyme susbet. Although CPLEX successfully determined the blocked and semiblocked reactions in the networks we examined, we expect it to have more difficulties detecting such reactions as the size of metabolic networks continues to grow.</p>
    </sec>
    <sec disp-level="2">
      <title>Structural features identified by MONGOOSE</title>
      <p>Given a metabolic network with stoichiometric matrix <italic>S</italic> (reduced to contain only internal metabolites) and set of irreversible reactions <inline-formula id="d33e754"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e755" xlink:href="ncomms5893-m2.jpg"/></inline-formula>, the set of admissible fluxes contains all the vectors <italic><bold>v</bold></italic> that satisfy the constraints</p>
      <p>
        <disp-formula id="eq3">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e763" xlink:href="ncomms5893-m3.jpg"/>
        </disp-formula>
      </p>
      <p>A reaction <italic>i</italic> is said to be blocked if the constraints imply that <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0.</p>
      <p>If energy balance constraints are imposed on the model, then <italic><bold>v</bold></italic> is an admissible flux vector if and only if</p>
      <p>
        <disp-formula id="eq4">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e784" xlink:href="ncomms5893-m4.jpg"/>
        </disp-formula>
      </p>
      <p>where <inline-formula id="d33e787"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e788" xlink:href="ncomms5893-m5.jpg"/></inline-formula> is the set of internal reactions (those not containing any extracellular metabolites). A reaction <italic>i</italic> is said to be blocked due to energy if energy balance constraints imply that <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0.</p>
      <p>Topology-blocked reactions are an extension of the notion of dead-end reactions<xref ref-type="bibr" rid="b14">14</xref>. Although a dead-end reaction is a reaction that contains a unique internal metabolite (and is therefore constrained to have no flux to balance fluxes on that metabolite), a topology-blocked reaction is one that is revealed to be blocked in this way by the successive deletion of dead-end reactions from the network. This terminology is identical to the one used in the recent version of the sybilSBML<xref ref-type="bibr" rid="b42">42</xref> package for R<xref ref-type="bibr" rid="b43">43</xref>. In addition to orphan metabolites (ones that only participate in a single reaction), the notion of dead-end metabolite is sometimes extended to one that is only produced or only consumed; this is the definition used in the COBRA toolbox<xref ref-type="bibr" rid="b14">14</xref>. In our classification, such a metabolite would lead to a stoichiometry-blocked or an irreversibility-blocked reaction, two concepts which we discuss next.</p>
      <p>Stoichiometry-blocked reactions are reactions that are blocked only by the flux balance constraint <italic>S<bold>v</bold></italic>=<bold>0</bold>. In other words, a stoichiometry-blocked reaction would be blocked even if all irreversible reactions were allowed to have flux in either direction. The corresponding notion in energy balance analysis is zero loops.</p>
      <p>Irreversibility-blocked reactions are reactions blocked by the entire set of constraints in <xref ref-type="disp-formula" rid="eq3">equation (1)</xref>. In other words, an irreversibility-blocked reaction would be able to have non-zero flux through it, if some or all of the irreversible reactions were allowed to have flux in either direction. The corresponding notion in energy balance analysis is energy-blocked reactions.</p>
      <p>Semiblocked reactions are those that are postulated to be reversible, but are in fact constrained by <xref ref-type="disp-formula" rid="eq3">equation (1)</xref> to only admit flux in one direction, either forward (<italic><bold>v</bold></italic><sub><italic>i</italic></sub>≥0) or reverse (<italic><bold>v</bold></italic><sub><italic>i</italic></sub>≤0). We classify these as effectively forward or effectively reverse, depending on the allowed direction of fluxes through them. Our notion of semiblocked reactions is similar to the directionality analysis in ref. <xref ref-type="bibr" rid="b29">29</xref>, but differs from it in that it only depends on flux balance and irreversibility constraints, rather than the energy balance ones. The corresponding notion in energy balance analysis is unidirectional reactions.</p>
      <p>Enzyme subsets are maximal sets of reactions such that any steady-state fluxes in the set are in a fixed ratio. In particular, two reactions, <italic>i</italic> and <italic>j</italic>, are part of an enzyme subset if and only if there is a constant <italic>κ</italic>≠0 such that <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=<italic>κ<bold>v</bold></italic><sub><italic>j</italic></sub> for all modes <italic><bold>v</bold></italic>. Each enzyme subset can be grouped together into a single reaction, which further reduces the size of the metabolic network without loss of information. The corresponding notion in energy balance analysis is isozyme subsets.</p>
      <p>In the example network below, reactions R1 and R2 are topology-blocked (note that only reaction R2 is a dead end in the sense of ref. <xref ref-type="bibr" rid="b14">14</xref>, though both are detected as such by removeDeadEnds), reactions R3 and R4 are stoichiometry-blocked, and reactions R5 through R10 are irreversibility-blocked. In addition, reactions Eno, Acn, AspC, Gdh and IlvEAvtA are semiblocked; of these, the first four are effectively forward and the last one is effectively reverse. Reactions Acn and GltA form an enzyme subset, reactions IlvEAvtA and AlaCon form another enzyme subset, and reactions Icl and Mas form a third enzyme subset. In each case, the proportionality coefficient between the fluxes is 1, consistent with the findings in ref. <xref ref-type="bibr" rid="b19">19</xref>. We note that reactions Acn and GltA are both irreversible, as are reactions IlvEAvtA and AlaCon; it is always the case that the reactions in each subset are either all irreversible (with positive proportionality coefficients) or all reversible, provided that the semiblocked reactions have been properly adjusted, as we show in Methods. Finally, the flux balance constraints on A through G, as well as on metabolites Ala, Cit, CoA and Gly are deleted as redundant. This reduces the example network from an initial size of 23 × 34 to a final size of 12 × 21.</p>
      <p>Example network:
<list id="l1" list-type="bullet"><list-item><p>internal metabolites: A, B, C, D, E, F, G; AcCoA, Ala, Asp, Cit, CoA, Fum, Glu, Gly, IsoCit, Mal, OAA, OG, PEP, Pyr, Succ, SucCoA.</p></list-item><list-item><p>external metabolites: ADP, Alaex, AMP, Aspex, ATP, CO2, FAD, FADH2, Gluex, NAD, NADH, NADP, NADPH, NH3, PG, Sucex.</p></list-item><list-item><p>reactions:</p></list-item></list></p>
      <p>
        <disp-formula id="i2">
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-i2.jpg"/>
        </disp-formula>
      </p>
    </sec>
    <sec disp-level="2">
      <title>Description of the MONGOOSE pipeline</title>
      <p>MONGOOSE performs all its computations using the fractions module available in versions 2.6 and higher of Python<xref ref-type="bibr" rid="b36">36</xref>. All linear optimizations are performed with the QSopt_ex solver<xref ref-type="bibr" rid="b23">23</xref>, which uses the simplex algorithm<xref ref-type="bibr" rid="b44">44</xref> and tests solution optimality in exact arithmetic. The rational dual variables output by the solver provide a certificate for the correctness of the solution to our linear optimization problems and can be verified independently of the solver.</p>
      <p>The MONGOOSE pipeline begins by converting an input metabolic model (in the form of a stoichiometric matrix) into canonical form. A canonical form of a stoichiometric matrix contains just the right amount of information needed to perform further analysis, the results of which can then be post-processed to obtain results for the original network. Formally, a matrix is said to be in canonical form if it contains no blocked reactions, unidirectional reactions (reversible reactions which can only proceed in the forward or only in the reverse direction) or enzyme subsets, and has linearly independent rows. Below we describe each step of the process for reducing a network to its canonical form.</p>
      <p>A reaction is said to be blocked if it cannot have non-zero flux in any mode. We propose to classify blocked reactions by the cause of blockage. Recall from the previous subsection that reaction <italic>i</italic> is topology-blocked if it contains a metabolite not participating in any other reaction, stoichiometry-blocked if <italic>S<bold>v</bold></italic>=<bold>0</bold> implies that <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0, or irreversibility-blocked if <xref ref-type="disp-formula" rid="eq3">equation (1)</xref> implies <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0. Since topology-blocked reactions are also stoichiomety-blocked, and stoichiomety-blocked reactions are also irreversibility-blocked, we use the simplest cause of blockage that applies in our classification.</p>
      <p>Topology-blocked reactions are readily identified by a simple analysis of the number of reactions each metabolite is involved in. Stoichiometry-blocked reactions can be identified in a fully reversible network <italic>S</italic> by performing a Gauss–Jordan elimination on <italic>S</italic> to find rows with a unique 1 in them, while irreversibility-blocked reactions in a fully irreversible network can be identified by the algorithm given in <xref ref-type="supplementary-material" rid="S1">Supplementary Note 3</xref>.</p>
      <p>It is surprising that algorithms guaranteed to work only on a fully reversible and a fully irreversible network respectively can be combined to work on a general network. Nevertheless, the simple algorithm consisting of a sequential application of these two algorithms turns <italic>S</italic> into a consistent matrix by deleting all its blocked reactions, as shown in <xref ref-type="supplementary-material" rid="S1">Supplementary Note 4</xref>.</p>
      <p>We call a reversible reaction unidirectional if it can sustain a flux of only one sign. If this sign is positive, we call the reaction effectively forward, whereas if it is negative, we call it effectively reverse.</p>
      <p>To decide whether a reversible reaction <italic>i</italic> is unidirectional, it suffices to test the feasibility of two linear programs, one with <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=1 and one with <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=–1. Since <italic>S</italic> is now a consistent matrix, at least one of those will always be feasible. Once all unidirectional reactions have been identified, we reverse the effectively reverse reactions by multiplying all their coefficients in <italic>S</italic> by –1, and then add all the unidirectional reactions to <inline-formula id="d33e989"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e990" xlink:href="ncomms5893-m6.jpg"/></inline-formula>.</p>
      <p><xref ref-type="supplementary-material" rid="S1">Supplementary Note 5</xref> shows that all the enzyme subsets can be identified from the proportional columns of the nullspace matrix <italic>K</italic> of <italic>S</italic>. Hence, the algorithm given by Gagneur and Klamt<xref ref-type="bibr" rid="b10">10</xref> correctly identifies all such subsets (something that was not known before the structural results presented here). Furthermore, since <italic>S</italic> no longer has any unidirectional reactions, any enzyme subset will consist either only of irreversible reactions or only of reversible reactions.</p>
      <p>If an enzyme subset containing reactions <italic>i</italic><sub>1</sub>,<italic>i</italic><sub>2</sub>,…,<italic>i</italic><sub><italic>t</italic></sub> has been identified, let <italic>r</italic><sub><italic>j</italic></sub> be the ratio of the flux through <italic>i</italic><sub><italic>j</italic></sub> to the flux through <italic>i</italic><sub>1</sub>, for 2≤<italic>j</italic>≤<italic>t</italic>. We can then lump the enzyme subset together into a single new reaction <inline-formula id="d33e1050"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1051" xlink:href="ncomms5893-m7.jpg"/></inline-formula> (here, subscripts indicate matrix columns). This significantly reduces the size of <italic>S</italic> without losing any information, since any mode in the compressed matrix can be expanded back to a mode in the original matrix<xref ref-type="bibr" rid="b10">10</xref>.</p>
      <p>After we make <italic>S</italic> consistent, deal with the unidirectional reactions and lump together the enzyme subsets, we can remove the redundant constraints (rows that are linear combinations of other rows) by Gaussian elimination on <italic>S</italic><sup><italic>T</italic></sup>. Each of these corresponds to a conservation relation among the metabolites in the network<xref ref-type="bibr" rid="b45">45</xref>. Unlike the reduction process described by Gagneur and Klamt<xref ref-type="bibr" rid="b10">10</xref>, the reduction process that we propose here is guaranteed to converge after one iteration (<xref ref-type="supplementary-material" rid="S1">Supplementary Note 6</xref>). The resulting matrix is said to be in canonical form.</p>
      <p>Once the matrix is in canonical form, it may be necessary to unblock its biomass reaction. If the biomass reaction is topology-blocked, this indicates an incompleteness in the model (one of the biomass components cannot be produced). If it is stoichiometry-blocked, it can be unblocked by removing balance constraints from a small subset of metabolites. This subset of metabolites can provide clues in a rational search for missing reactions. Finding the smallest such subset is NP-hard<xref ref-type="bibr" rid="b12">12</xref>; however, a small subset can be found by a linear program based on the key observation that we can look for vectors <italic><bold>v</bold></italic> with <italic><bold>v</bold></italic><sub>biomass</sub>=1 such that <italic>S<bold>v</bold></italic> has small support. If the biomass reaction is irreversibility-blocked due to the directional restrictions on some reactions, it can be unblocked by making a small subset of the irreversible reactions reversible. As above, finding the smallest such subset is NP-hard, but a small subset can be found by a linear program. Indeed, here we look for a vector <italic><bold>v</bold></italic> such that <italic>S<bold>v</bold></italic>=<bold>0</bold> with <italic><bold>v</bold></italic><sub>biomass</sub>=1 and few components of <italic><bold>v</bold></italic> are negative, which by <xref ref-type="supplementary-material" rid="S1">Supplementary Note 3</xref> is equivalent to finding a small cutset for the biomass reaction in the nullspace matrix of <italic>S</italic>.</p>
      <p>Once the stoichiometric matrix is in canonical form and its biomass reaction has been unblocked if necessary, further queries can be performed on the metabolic model as described in the following subsections.</p>
    </sec>
    <sec disp-level="2">
      <title>Energy balance analysis</title>
      <p>The energy balance constraints on a network with stoichiometric matrix <italic>S</italic> and internal reactions <inline-formula id="d33e1136"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1137" xlink:href="ncomms5893-m8.jpg"/></inline-formula> are given by <xref ref-type="disp-formula" rid="eq4">equation (2)</xref>. Similarly to FBA, energy balance analysis constraints can be used to reduce the model and identify its structural features, with the key difference that instead of applying to the nullspace of the entire stoichiometric matrix <italic>S</italic>, the constraints apply to the row space of <inline-formula id="d33e1145"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1146" xlink:href="ncomms5893-m9.jpg"/></inline-formula>, the part of the stoichiometric matrix containing the internal reactions. The structural analysis and reduction proceed analogously to FBA, with the key difference that unlike the nullspace of <italic>S</italic>, for which a basis must be constructed via a Gauss–Jordan elimination, the row space of <inline-formula id="d33e1152"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1153" xlink:href="ncomms5893-m10.jpg"/></inline-formula> is given explicitly by the model. Once the analysis is completed, the reduced version of <inline-formula id="d33e1155"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1156" xlink:href="ncomms5893-m11.jpg"/></inline-formula> is merged back with the external reactions in <italic>S</italic>, and it is at that stage that any redundant constraints are eliminated.</p>
      <p>The final stage of the analysis involves finding restrictions on the signs of the flux vectors. This task can be accomplished by finding all the elementary flux modes of the network containing only the internal reactions<xref ref-type="bibr" rid="b29">29</xref>. While this is a computationally intractable problem, <xref ref-type="supplementary-material" rid="S1">Supplementary Note 8</xref> shows that this analysis can be performed on the fully reduced network, rather than the original network, without loss of information.</p>
    </sec>
    <sec disp-level="2">
      <title>Essential and synthetic lethal reactions</title>
      <p>In a metabolic model, a reaction is predicted to be essential if disabling it blocks the biomass reaction. To find all such reactions, we first compute some modes involving the biomass reaction, and then test those reactions that are active in each of those modes for essentiality. To test whether a reaction <italic>i</italic> is essential, we check whether the biomass reaction can be active when <xref ref-type="disp-formula" rid="eq3">equation (1)</xref> holds with <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0. Note that every reaction in an enzyme subset with the biomass reaction is automatically essential. To find all the remaining ones, we generate a short flux mode <italic><bold>u</bold></italic> in the reduced network such that <italic><bold>u</bold></italic><sub>biomass</sub>=1 by minimizing the 1-norm of <italic><bold>u</bold></italic>, and then check essentiality of each reaction <italic>i</italic> active in <italic><bold>u</bold></italic> by checking for feasibility of <xref ref-type="disp-formula" rid="eq3">equation (1)</xref> with <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0 and <italic><bold>v</bold></italic><sub>biomass</sub>=1. In this way, for each <italic>i</italic>, we obtain a certificate of essentiality or a vector <italic><bold>v</bold></italic> with <italic><bold>v</bold></italic><sub><italic>i</italic></sub>=0 and <italic><bold>v</bold></italic><sub>biomass</sub>=1.</p>
      <p>A pair of reactions is called synthetic lethal if neither of them is essential, but disabling both of them disables growth. To compute all pairs of synthetic lethal reactions, we use the vector <italic><bold>u</bold></italic> from the previous step together with the vectors <italic><bold>v</bold></italic> corresponding to each nonessential reaction <italic>i</italic> active in <italic><bold>u</bold></italic>. Let <italic>L</italic> be the number of such vectors. Let <italic>G</italic> denote the set of nonessential reactions active in at least one of these vectors. We construct a matrix <italic>M</italic> of size |<italic>G</italic>| with <italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub> being the number of modes that contain both <italic>i</italic> and <italic>j</italic>, with the diagonal element <italic>M</italic><sub><italic>i</italic>,<italic>i</italic></sub> being the number of vectors that contain reaction <italic>i</italic>. The pair {<italic>i</italic>,<italic>j</italic>} is synthetic lethal for the <italic>L</italic> vectors if and only if each one of them contains either <italic>i</italic> or <italic>j</italic>, which is to say that <italic>M</italic><sub><italic>i</italic>,<italic>i</italic></sub>+<italic>M</italic><sub><italic>j</italic>,<italic>j</italic></sub>−<italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub>=<italic>L</italic>, so we only check pairs satisfying this condition. This leads to a substantial reduction in the number of checks.</p>
    </sec>
    <sec disp-level="2">
      <title>Minimal media</title>
      <p>A minimal medium is a minimal subset of the exchange reactions <inline-formula id="d33e1356"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1357" xlink:href="ncomms5893-m12.jpg"/></inline-formula> that can sustain the organism’s growth. The problem of finding all minimal media is NP-hard, and has been studied previously<xref ref-type="bibr" rid="b11">11</xref>. MONGOOSE can identify a number of small minimal media as follows. It starts by finding a vector <italic><bold>v</bold></italic> satisfying <xref ref-type="disp-formula" rid="eq3">equation (1)</xref> with <italic><bold>v</bold></italic><sub>biomass</sub>=1 that minimizes the sum of components corresponding to <inline-formula id="d33e1375"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1376" xlink:href="ncomms5893-m13.jpg"/></inline-formula>. This is a minimal medium. At each subsequent step, constraints are introduced to steer the solution away from any previously found ones.</p>
      <p>More specifically, if we denote by <italic>R</italic>(<italic><bold>v</bold></italic>) the set of non-zero components of <italic><bold>v</bold></italic>, a minimal medium <italic><bold>v</bold></italic> uniquely minimizes ∑<sub><italic>j</italic>∉<italic>R</italic>(<italic><bold>v</bold></italic>)</sub><italic><bold>v</bold></italic><sub><italic>j</italic></sub> with a value of 0. It can be shown that the medium with the second-best value, <italic><bold>u</bold></italic>, will be a linear combination of <italic><bold>v</bold></italic> and another minimal medium <italic><bold>w</bold></italic>, if an active-set algorithm<xref ref-type="bibr" rid="b46">46</xref> such as the simplex algorithm<xref ref-type="bibr" rid="b44">44</xref> is used. <italic><bold>u</bold></italic> can be found by solving the linear program</p>
      <p>
        <disp-formula id="eq14">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1437" xlink:href="ncomms5893-m14.jpg"/>
        </disp-formula>
      </p>
      <p>for some small number <italic>ε</italic>&gt;0. Once <italic><bold>u</bold></italic> is found, we can simply subtract the largest multiple of <italic><bold>v</bold></italic> that still keeps it nonnegative, and this will be <italic><bold>w</bold></italic>. The same procedure can now be repeated starting from <italic><bold>w</bold></italic> instead of <italic><bold>v</bold></italic>. This procedure continues until no new minimal medium is found.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Author contributions</title>
    <p>L.C. designed, implemented and tested the MONGOOSE toolbox. J.T. implemented the internally used classes and the installation package. A.R. supervised stages of the research and proposed additional research questions. B.B. guided all stages of the research, proposed additional research questions and verified the proofs of all the theoretical results. L.C. and B.B. wrote the manuscript with editing guidance from A.R.</p>
  </sec>
  <sec disp-level="1">
    <title>Additional information</title>
    <p><bold>How to cite this article:</bold> Chindelevitch, L. <italic>et al.</italic> An exact arithmetic toolbox for a consistent and reproducible structural analysis of metabolic network models. <italic>Nat. Commun.</italic> 5:4893 doi: 10.1038/ncomms5893 (2014).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e18" content-type="local-data">
      <caption>
        <title>Supplementary Figure, Notes and References</title>
        <p>Supplementary Figure 1, Supplementary Notes 1-8 and Supplementary References</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-s1.pdf"/>
    </supplementary-material>
    <supplementary-material id="d33e24" content-type="local-data">
      <caption>
        <title>Supplementary Data 1</title>
        <p>Table listing the results of running the MONGOOSE pipeline on 98 existing metabolic network models listed at http://systemsbiology.ucsd.edu/InSilicoOrganisms/OtherOrganisms</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-s2.xls"/>
    </supplementary-material>
    <supplementary-material id="d33e30" content-type="local-data">
      <caption>
        <title>Supplementary Data 2</title>
        <p>Complete listing of the modifications made to Excel and SBML files containing metabolic models in order to resolve warnings or errors produced during parsing by MONGOOSE.</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-s3.xls"/>
    </supplementary-material>
    <supplementary-material id="d33e36" content-type="local-data">
      <caption>
        <title>Supplementary Software</title>
        <p>Collection of Python files containing the MONGOOSE pipeline.</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-s4.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank a number of people without whose help this work would not have been possible: Deborah Hung, Michael Schnall-Levin, Michael Baym, Michel Goemans, Jeremy Zucker, Sebastian Will, George Tucker, Daniel Espinoza and Dan Steffy. We thank all the reviewers for their helpful comments and suggestions that helped improve the manuscript. Dan Park helped create the MONGOOSE website. Amy Rossman helped create the figures appearing in this manuscript. L.C. is funded by a postgraduate scholarship from the National Science and Engineering Research Council of Canada. Funding for this work was provided by National Institutes of Health grant GM108348. A.R. was supported by HHMI.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Varma</surname><given-names>A.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title>Metabolic flux balancing: basic concepts, scientific and practical use</article-title>. <source>Nat. Biotechnol.</source>
<volume>12</volume>, <fpage>994</fpage>–<lpage>998</lpage> (<year>1994</year>).</mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Covert</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>Metabolic modeling of microbial strains in silico</article-title>. <source>Trends Biochem. Sci.</source><volume>26</volume>, <fpage>179</fpage>–<lpage>186</lpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11246024</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>N.</given-names></name>, <name><surname>Papin</surname><given-names>J.</given-names></name>, <name><surname>Schilling</surname><given-names>C.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title>Genome-scale microbial <italic>in silico</italic> models: the constraints-based approach</article-title>. <source>Trends Biotechnol.</source>
<volume>21</volume>, <fpage>162</fpage>–<lpage>169</lpage> (<year>2003</year>).<pub-id pub-id-type="pmid">12679064</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>N.</given-names></name>, <name><surname>Reed</surname><given-names>J.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title>Genome-scale models of microbial cells: evaluating the consequences of constraints</article-title>. <source>Nat. Rev. Microbiol.</source>
<volume>2</volume>, <fpage>886</fpage>–<lpage>897</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15494745</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Varma</surname><given-names>A.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title>Stoichiometric flux balance models quantitatively predict growth and metabolic by-product secretion in wild-type <italic>Escherichia coli</italic> W3110</article-title>. <source>Appl. Environ. Microbiol.</source>
<volume>60</volume>, <fpage>3724</fpage>–<lpage>3731</lpage> (<year>1994</year>).<pub-id pub-id-type="pmid">7986045</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Wunderlich</surname><given-names>Z.</given-names></name> &amp; <name><surname>Mirny</surname><given-names>L.</given-names></name>
<article-title>Using the topology of metabolic networks to predict viability of mutant strains</article-title>. <source>Biophys. J.</source>
<volume>91</volume>, <fpage>2304</fpage>–<lpage>2311</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16782788</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Horn</surname><given-names>F.</given-names></name> &amp; <name><surname>Jackson</surname><given-names>R.</given-names></name>
<article-title>General mass action kinetics</article-title>. <source>Arch. Ration. Mech. Anal.</source>
<volume>47</volume>, <fpage>81</fpage>–<lpage>116</lpage> (<year>1972</year>).</mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Savageau</surname><given-names>M.</given-names></name><article-title>Biochemical systems analysis: I. some mathematical properties of the rate law for the component enzymatic reactions</article-title>. <source>J. Theor. Biol.</source><volume>25</volume>, <fpage>365</fpage>–<lpage>369</lpage> (<year>1969</year>).<pub-id pub-id-type="pmid">5387046</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Schuster</surname><given-names>R.</given-names></name> &amp; <name><surname>Schuster</surname><given-names>S.</given-names></name>
<article-title>Detecting strictly detailed balanced subnetworks in open chemical reaction networks</article-title>. <source>J. Math. Chem.</source>
<volume>6</volume>, <fpage>17</fpage>–<lpage>40</lpage> (<year>1991</year>).</mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Gagneur</surname><given-names>J.</given-names></name> &amp; <name><surname>Klamt</surname><given-names>S.</given-names></name>
<article-title>Computation of elementary modes: a unifying framework and the new binary approach</article-title>. <source>BMC Bioinformatics</source>
<volume>5</volume>, (<year>2004</year>).</mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Suthers</surname><given-names>P.</given-names></name><italic>et al.</italic><article-title>A genome-scale metabolic reconstruction of <italic>Mycoplasma genitalium</italic>, iPS189</article-title>. <source>PLoS Comput. Biol.</source><volume>5</volume>, (<year>2009</year>).</mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Acuña</surname><given-names>V.</given-names></name><italic>et al.</italic><article-title>Modes and cuts in metabolic networks: complexity and algorithms</article-title>. <source>BioSystems</source><volume>95</volume>, <fpage>51</fpage>–<lpage>60</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">18722501</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Klamt</surname><given-names>S.</given-names></name> &amp; <name><surname>Gilles</surname><given-names>E.</given-names></name>
<article-title>Minimal cut sets in biochemical reaction networks</article-title>. <source>Bioinformatics</source>
<volume>20</volume>, <fpage>226</fpage>–<lpage>234</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">14734314</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Becker</surname><given-names>S.</given-names></name><italic>et al.</italic><article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA toolbox</article-title>. <source>Nat. Protoc.</source><volume>2</volume>, <fpage>727</fpage>–<lpage>738</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17406635</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Orth</surname><given-names>J.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title>Gap-filling analysis of the iJO1366 <italic>Escherichia coli</italic> metabolic network reconstruction for discovery of metabolic functions</article-title>. <source>BMC Syst. Biol.</source>
<volume>6</volume>, <fpage>30</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22548736</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Mo</surname><given-names>M.</given-names></name>, <name><surname>Palsson</surname><given-names>B.</given-names></name> &amp; <name><surname>Herrgard</surname><given-names>M.</given-names></name>
<article-title>Connecting extracellular metabolomic measurements to intracellular flux states in yeast</article-title>. <source>BMC Syst. Biol.</source>
<volume>3</volume>, <fpage>37</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19321003</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="other"> In Silico Organisms <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://systemsbiology.ucsd.edu/InSilicoOrganisms/OtherOrganisms">http://systemsbiology.ucsd.edu/InSilicoOrganisms/OtherOrganisms</ext-link> (<year>2013</year>).</mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Loh</surname><given-names>P.-R.</given-names></name>, <name><surname>Baym</surname><given-names>M.</given-names></name> &amp; <name><surname>Berger</surname><given-names>B.</given-names></name>
<article-title>Compressive genomics</article-title>. <source>Nat. Biotechnol.</source>
<volume>30</volume>, <fpage>627</fpage>–<lpage>630</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22781691</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>von Kamp</surname><given-names>A.</given-names></name> &amp; <name><surname>Schuster</surname><given-names>S.</given-names></name>
<article-title>Metatool 5.0: fast and flexible elementary modes analysis</article-title>. <source>Bioinformatics</source>
<volume>22</volume>, <fpage>1930</fpage>–<lpage>1931</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16731697</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Klamt</surname><given-names>S.</given-names></name>, <name><surname>Saez-Rodriguez</surname><given-names>J.</given-names></name> &amp; <name><surname>Gilles</surname><given-names>E.</given-names></name>
<article-title>Structural and functional analysis of cellular networks with CellNetAnalyzer</article-title>. <source>BMC Syst. Biol.</source>
<volume>1</volume>, (<year>2007</year>).</mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Neumaier</surname><given-names>A.</given-names></name> &amp; <name><surname>Shcherbina</surname><given-names>O.</given-names></name>
<article-title>Safe bounds in linear and mixed-integer programming</article-title>. <source>Math. Program. A</source>
<volume>99</volume>, <fpage>283</fpage>–<lpage>296</lpage> (<year>2004</year>).</mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Trefethen</surname><given-names>L.</given-names></name> &amp; <name><surname>Bau</surname><given-names>D.</given-names></name>
<source>Society for Industrial and Applied Mathematics</source> SIAM, 1997.</mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Applegate</surname><given-names>D.</given-names></name>, <name><surname>Cook</surname><given-names>W.</given-names></name>, <name><surname>Dash</surname><given-names>S.</given-names></name> &amp; <name><surname>Espinoza</surname><given-names>D.</given-names></name>
<article-title>Exact solutions to linear programming problems</article-title>. <source>Oper. Res. Lett.</source>
<volume>35</volume>, <fpage>693</fpage>–<lpage>699</lpage> (<year>2007</year>).</mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="other"> NEOS Server for Optimization <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.neos-server.org/">http://www.neos-server.org/</ext-link> (<year>2013</year>).</mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="other"> CPLEX Optimizer <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www-01.ibm.com/software/integration/optimization/cplex-optimizer">http://www-01.ibm.com/software/integration/optimization/cplex-optimizer</ext-link> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Edwards</surname><given-names>J.</given-names></name>, <name><surname>Ibarra</surname><given-names>R.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title><italic>In silico</italic> predictions of <italic>Escherichia coli</italic> metabolic capabilities are consistent with experimental data</article-title>. <source>Nat. Biotechnol.</source>
<volume>19</volume>, <fpage>125</fpage>–<lpage>130</lpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11175725</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Samal</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>Low degree metabolites explain essential reactions and enhance modularity in biological networks</article-title>. <source>BMC Bioinformatics</source><volume>7</volume>, <fpage>118</fpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16524470</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>DeMartino</surname><given-names>A.</given-names></name>, <name><surname>Granata</surname><given-names>D.</given-names></name>, <name><surname>Marinari</surname><given-names>E.</given-names></name>, <name><surname>Martelli</surname><given-names>C.</given-names></name> &amp; <name><surname>Van Kerrebroeck</surname><given-names>V.</given-names></name>
<article-title>Optimal fluxes, reaction replaceability, and response to enzymopathies in the human red blood cell</article-title>. <source>J. Biomed. Biotechnol.</source> doi:<pub-id pub-id-type="doi">10.1155/2010/415148</pub-id> (<year>2010</year>).</mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>F.</given-names></name>, <name><surname>Qian</surname><given-names>H.</given-names></name> &amp; <name><surname>Beard</surname><given-names>D.</given-names></name>
<article-title><italic>Ab initio</italic> prediction of thermodynamically feasible reaction directions from biochemical network stoichiometry</article-title>. <source>Metab. Eng.</source>
<volume>7</volume>, <fpage>251</fpage>–<lpage>259</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16140239</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>Beard</surname><given-names>D.</given-names></name>, <name><surname>Babson</surname><given-names>E.</given-names></name>, <name><surname>Curtis</surname><given-names>E.</given-names></name> &amp; <name><surname>Qian</surname><given-names>H.</given-names></name>
<article-title>Thermodynamic constraints for biochemical networks</article-title>. <source>J. Theor. Biol.</source>
<volume>228</volume>, <fpage>327</fpage>–<lpage>333</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15135031</pub-id></mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>Schellenberger</surname><given-names>J.</given-names></name>, <name><surname>Lewis</surname><given-names>N.</given-names></name> &amp; <name><surname>Palsson</surname><given-names>B.</given-names></name>
<article-title>Elimination of thermodynamically infeasible loops in steady-state metabolic models</article-title>. <source>Biophys. J.</source>
<volume>100</volume>, <fpage>544</fpage>–<lpage>553</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21281568</pub-id></mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Ballerstein</surname><given-names>K.</given-names></name>, <name><surname>von Kamp</surname><given-names>A.</given-names></name>, <name><surname>Klamt</surname><given-names>S.</given-names></name> &amp; <name><surname>Haus</surname><given-names>U.</given-names></name>
<article-title>Minimal cut sets in a metabolic network are elementary modes in a dual network</article-title>. <source>Bioinformatics</source>
<volume>28</volume>, <fpage>381</fpage>–<lpage>387</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22190691</pub-id></mixed-citation>
    </ref>
    <ref id="b33">
      <mixed-citation publication-type="journal"><name><surname>Kümmel</surname><given-names>A.</given-names></name>, <name><surname>Panke</surname><given-names>S.</given-names></name> &amp; <name><surname>Heinemann</surname><given-names>M.</given-names></name>
<article-title>Systematic assignment of thermodynamic constraints in metabolic network models</article-title>. <source>BMC Bioinformatics</source>
<volume>7</volume>, <fpage>512</fpage> (<year>2006</year>).<pub-id pub-id-type="pmid">17123434</pub-id></mixed-citation>
    </ref>
    <ref id="b34">
      <mixed-citation publication-type="journal"><name><surname>De Martino</surname><given-names>D.</given-names></name>, <name><surname>Figliuzzi</surname><given-names>M.</given-names></name>, <name><surname>De Martino</surname><given-names>A.</given-names></name> &amp; <name><surname>Marinari</surname><given-names>E.</given-names></name>
<article-title>A scalable algorithm to explore the Gibbs energy landscape of genome-scale metabolic networks</article-title>. <source>PLoS Comput. Biol.</source>
<volume>8</volume>, <fpage>e1002562</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22737065</pub-id></mixed-citation>
    </ref>
    <ref id="b35">
      <mixed-citation publication-type="other"> SBML. The Systems Biology Markup Language <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://sbml.org/">http://sbml.org/</ext-link> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b36">
      <mixed-citation publication-type="journal"><name><surname>van Rossum</surname><given-names>G.</given-names></name><source>Python Reference Manual, Technical Report CS-R9525</source> Centrum voor Wiskunde en Informatica (<year>1995</year>).</mixed-citation>
    </ref>
    <ref id="b37">
      <mixed-citation publication-type="journal"><name><surname>Bornstein</surname><given-names>B. J.</given-names></name>, <name><surname>Keating</surname><given-names>S. M.</given-names></name>, <name><surname>Jouraku</surname><given-names>A.</given-names></name> &amp; <name><surname>Hucka</surname><given-names>M.</given-names></name>
<article-title>LibSBML: an API Library for SBML</article-title>. <source>Bioinformatics</source>
<volume>24</volume>, <fpage>880</fpage>–<lpage>881</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18252737</pub-id></mixed-citation>
    </ref>
    <ref id="b38">
      <mixed-citation publication-type="other"> xlrd. Library for developers to extract data from Microsoft Excel spreadsheet files <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://pypi.python.org/pypi/xlrd">http://pypi.python.org/pypi/xlrd</ext-link> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b39">
      <mixed-citation publication-type="journal"><name><surname>Papadimitriou</surname><given-names>S.</given-names></name><article-title>The largest subdeterminant in a matrix</article-title>. <source>Bull. Math. Soc. Greece</source><volume>15</volume>, <fpage>96</fpage>–<lpage>105</lpage> (<year>1984</year>).</mixed-citation>
    </ref>
    <ref id="b40">
      <mixed-citation publication-type="journal"><name><surname>Khachiyan</surname><given-names>L.</given-names></name><article-title>On the complexity of approximating extremal determinants in matrices</article-title>. <source>J. Complexity</source><volume>11</volume>, <fpage>138</fpage>–<lpage>153</lpage> (<year>1994</year>).</mixed-citation>
    </ref>
    <ref id="b41">
      <mixed-citation publication-type="other"> GLPK: GNU Linear Programming Kit <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.gnu.org/software/glpk">http://www.gnu.org/software/glpk</ext-link> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="b42">
      <mixed-citation publication-type="other"> sybilSBML: SBML Integration in Package sybil <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/sybilSBML/">http://cran.r-project.org/web/packages/sybilSBML/</ext-link> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b43">
      <mixed-citation publication-type="other">The R Project for Statistical Computing. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b44">
      <mixed-citation publication-type="journal"><name><surname>Dantzig</surname><given-names>G.</given-names></name>, <name><surname>Orden</surname><given-names>A.</given-names></name> &amp; <name><surname>Wolfe</surname><given-names>P.</given-names></name>
<article-title>The generalized simplex method for minimizing a linear form under linear inequality constraints</article-title>. <source>Pacific J. Math.</source>
<volume>5</volume>, <fpage>183</fpage>–<lpage>195</lpage> (<year>1955</year>).</mixed-citation>
    </ref>
    <ref id="b45">
      <mixed-citation publication-type="journal"><name><surname>Schuster</surname><given-names>S.</given-names></name> &amp; <name><surname>Höfer</surname><given-names>T.</given-names></name>
<article-title>Determining all extreme semi-positive conservation relations in chemical reaction systems: a test criterion for conservativity</article-title>. <source>J. Chem. Soc.</source>
<volume>87</volume>, <fpage>2561</fpage>–<lpage>2566</lpage> (<year>1991</year>).</mixed-citation>
    </ref>
    <ref id="b46">
      <mixed-citation publication-type="journal"><name><surname>Nocedal</surname><given-names>J.</given-names></name> &amp; <name><surname>Wright</surname><given-names>S. J.</given-names></name>
<source>Numerical Optimization</source> 2nd edn Springer (<year>2006</year>).</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Flowchart of the MONGOOSE pipeline.</title>
      <p>A schematic representation of the interaction between different parts of the MONGOOSE pipeline.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Comparison of CPLEX and MONGOOSE.</title>
      <p>MONGOOSE identifies all reaction pairs that are in an enzyme subset for these eight metabolic networks. The reaction pairs detected as being in an enzyme subset by CPLEX are shown in blue, while those not detected as such are shown in red.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms5893-f2"/>
  </fig>
</floats-group>
