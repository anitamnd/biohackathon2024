<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9010828</article-id>
    <article-id pub-id-type="publisher-id">841764</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2022.841764</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MiRKAT-MC: A Distance-Based Microbiome Kernel Association Test With Multi-Categorical Outcomes</article-title>
      <alt-title alt-title-type="left-running-head">Jiang et al.</alt-title>
      <alt-title alt-title-type="right-running-head">MiRKAT-MC for Microbiome Studies with Multi-Categorical Outcomes</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Zhiwen</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1608477/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Mengyu</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1712362/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Jun</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/701930/overview"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhao</surname>
          <given-names>Ni</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/685248/overview"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhan</surname>
          <given-names>Xiang</given-names>
        </name>
        <xref rid="aff5" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/628873/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Biostatistics</institution>, <institution>Gillings School of Global Public Health</institution>, <institution>University of North Carolina</institution>, <addr-line>Chapel Hill</addr-line>, <addr-line>NC</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department Department of Biostatistics and Bioinformatics</institution>, <institution>Rollins School of Public Health</institution>, <institution>Emory University</institution>, <addr-line>Atlanta</addr-line>, <addr-line>GA</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Quantitative Health Sciences</institution>, <institution>Mayo Clinic</institution>, <addr-line>Rochester</addr-line>, <addr-line>MN</addr-line>, <country>United States</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Department of Biostatistics</institution>, <institution>Bloomberg School of Public Health</institution>, <institution>Johns Hopkins University</institution>, <addr-line>Baltimore</addr-line>, <addr-line>MD</addr-line>, <country>United States</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Department of Biostatistics, School of Public Health and Beijing International Center for Mathematical Research, Peking University</institution>, <addr-line>Beijing</addr-line>, <country>China</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p><bold>Edited by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/535152/overview" ext-link-type="uri">Harinder Singh</ext-link>, J. Craig Venter Institute, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p><bold>Reviewed by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/815764/overview" ext-link-type="uri">Ximing Xu</ext-link>, Children’s Hospital of Chongqing Medical University, China</p>
        <p><ext-link xlink:href="https://loop.frontiersin.org/people/1670944/overview" ext-link-type="uri">Rajesh Kumar</ext-link>, National Institutes of Health (NIH), United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Ni Zhao, <email>nzhao10@jhu.edu</email>; Xiang Zhan, <email>zhanx@bjmu.edu.cn</email>
</corresp>
      <fn fn-type="other">
        <p>This article was submitted to Computational Genomics, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>841764</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Jiang, He, Chen, Zhao and Zhan.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Jiang, He, Chen, Zhao and Zhan</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Increasing evidence has elucidated that the microbiome plays a critical role in many human diseases. Apart from continuous and binary traits that measure the extent or presence of a disease, multi-categorical outcomes including variations/subtypes of a disease or ordinal levels of disease severity are commonly seen in clinical studies. On top of that, studies with clustered design (i.e., family-based and longitudinal studies) are popular alternatives to population-based ones as they are able to identify characteristics on both individual and population levels and to investigate the trajectory of traits of interest over time. However, existing methods for microbiome association analysis are inadequate to handle multi-categorical outcomes, neither independent nor clustered data. We propose a microbiome kernel association test with multi-categorical outcomes (MiRKAT-MC). Our method is versatile to deal with both nominal and ordinal outcomes for independent and clustered data. In addition, it incorporates multiple ecological distances to allow for different association patterns between outcomes and microbiome compositions to be incorporated. A computationally efficient pseudo-permutation strategy is used to evaluate the statistical significance. Comprehensive simulations show that MiRKAT-MC preserves the nominal type I error and increases statistical powers under various scenarios and data types. We also apply MiRKAT-MC to real data sets with nominal and ordinal outcomes to gain biological insights. MiRKAT-MC is easy to implement, and freely available via an R package at <ext-link xlink:href="https://github.com/Zhiwen-Owen-Jiang/MiRKATMC" ext-link-type="uri">https://github.com/Zhiwen-Owen-Jiang/MiRKATMC</ext-link> with a Graphical User Interface through R Shinny also available.</p>
    </abstract>
    <kwd-group>
      <kwd>beta-diversity</kwd>
      <kwd>longitudinal studies</kwd>
      <kwd>microbiome association analysis</kwd>
      <kwd>multi-categorical outcomes</kwd>
      <kwd>kernel association test</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1 Introduction</title>
    <p>The diverse microbial cells including bacteria, archaea, and fungi that colonize the mucosal and skin environment constitute the human microbiome (<xref rid="B10" ref-type="bibr">Gilbert et al., 2018</xref>). It is broadly acknowledged that the human microbiome and its interaction with the immune, endocrine, and nervous systems are associated with a variety of illnesses, ranging from inflammatory bowel disease (<xref rid="B23" ref-type="bibr">Ni et al., 2017</xref>), to cancer (<xref rid="B16" ref-type="bibr">Kostic et al., 2013a</xref>), and to major depressive disorder (<xref rid="B14" ref-type="bibr">Jiang et al., 2015</xref>). A key step in investigating the relationship between microbiome and human disorders lies in quantifying the taxonomic composition. Currently, the most commonly used method is through the sequencing of the 16S ribosomal RNA gene, which, as a biomarker, is present in all prokaryotic cells and reflects the evolutionary distance between distinct genomes. Computationally, the 16S rRNA sequencing tags can be assigned into Operational Taxonomic Units (OTU) or Amplicon Sequence Variants (ASV) as computational surrogate of microbial taxa (<xref rid="B29" ref-type="bibr">Schloss, 2010</xref>; <xref rid="B3" ref-type="bibr">Callahan et al., 2016</xref>). Through sequencing, the microbial community can be directly quantified, without the need of labor-intensive bacterial culturing. For instance, the disparity between microbiome communities from two samples can be assessed via an ecological distance/dissimilarity metric, such as the UniFrac distance (<xref rid="B21" ref-type="bibr">Lozupone and Knight, 2005</xref>) and the Bray-Curtis dissimilarity (<xref rid="B2" ref-type="bibr">Bray and Curtis, 1957</xref>).</p>
    <p>Identifying links between microbiome and diseases is often achieved by microbiome-wide association studies (MWAS) (<xref rid="B17" ref-type="bibr">Kostic et al., 2013b</xref>), which in turn provide insight into the biological mechanisms of human health and disease conditions. The data type of the investigated outcomes varies from study to study. Typically, samples can be dichotomized as cases and controls when exploring human diseases. For example, (<xref rid="B22" ref-type="bibr">Naseribafrouei et al., 2014</xref>) discovered potential correlation between depression and fecal microbiota, where study participants were classified as depression vs. non-depression. On the other hand, multi-categorical (nominal or ordinal) outcomes are also frequently encountered and investigated in many microbiome studies. For instance, Scher et al. (<xref rid="B26" ref-type="bibr">Scher et al., 2013</xref>) explored the association between rheumatoid arthritis (RA) and gut microbiota by recruiting patients with three different categories of arthritis: new-onset RA, treated RA, and psoriatic arthritis (PsA). Parikh et al. (<xref rid="B24" ref-type="bibr">Parikh et al., 2020</xref>) investigated the association between Apolipoprotein E (APOE) alleles and gut microbiome in murine models, where the APOE gene encodes a major cholesterol carrier protein that supports lipid transport and injury repair in the brain. Polymorphism in APOE gene is a major risk for developing Alzheimer disease. In this study, the APOE gene was coded as a nominal variable of different genotypes (APOE2 APOE3, and APOE4). Furthermore, Schirmer et al. Schirmer et al. (<xref rid="B27" ref-type="bibr">Schirmer et al., 2018</xref>) investigated the association between severity of ulcerative colitis and gut microbiome, where disease severity was treated as an ordinal variable with four levels: inactive, mild, moderate and severe.</p>
    <p>Association analysis between a host trait and microbiome compositions can be generally addressed by PERMANOVA (<xref rid="B1" ref-type="bibr">Anderson, 2001</xref>), which partitions the total variation across the microbiome data cloud in the space of a chosen dissimilarity measure into multiple directions. PERMANOVA is able to accommodate both binary and multi-categorical outcomes, but fails to incorporate multiple distance metrics, where distinct distances capture distinct underlying association patterns and therefore are more powerful under different circumstances. Hence, Tang et al. (<xref rid="B30" ref-type="bibr">Tang et al., 2016</xref>) proposed PERMANOVA-S to incorporate multiple distance metrics into a single test. However, it is not adequate to multi-categorical outcomes unless we combine multiple categories into a binary variable, which potentially leads to significant power loss. An alternative to PERMANOVA is the family of microbiome regression-based kernel association tests (MiRKAT) (<xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>; <xref rid="B32" ref-type="bibr">Wilson et al., 2021</xref>). Utilizing the classic mixed effect models, the MiRKAT approaches summarize the microbiome structure as a kernel similarity matrix (constructed through the sample-sample distance metric) and model it as a random effect. Adjusting for covariates is straightforward in this framework. The association test is conducted via a variance component score test with <italic>p</italic>-value calculated in multiple ways, including analytical (<xref rid="B8" ref-type="bibr">Chen et al., 2016</xref>; <xref rid="B35" ref-type="bibr">Zhan et al., 2017a</xref>), permutation (<xref rid="B15" ref-type="bibr">Koh et al., 2019</xref>) and fast pseudo-permutation approaches (<xref rid="B36" ref-type="bibr">Zhan et al., 2017b</xref>). However, existing MiRKAT tests are not able to accommodate multi-categorical outcomes.</p>
    <p>Beyond population-based studies in which all samples are independent, nowadays, researchers frequently collect microbiome data that are clustered or longitudinal in nature. For instance, Goodrich et al. (<xref rid="B11" ref-type="bibr">Goodrich et al., 2014</xref>) collected stool samples from female twins in the United Kingdom to investigate the relationship between obesity and gut microbiome. Flores et al. (<xref rid="B9" ref-type="bibr">Flores et al., 2014</xref>) explored the effect of antibiotic use on temporal variability of the microbiome diversity and community structure in gut, palm and tongue. Methods available to address correlated outcomes in microbiome studies burgeoned in the recent years (<xref rid="B6" ref-type="bibr">Chen and Li, 2016</xref>; <xref rid="B37" ref-type="bibr">Zhan et al., 2018</xref>; <xref rid="B38" ref-type="bibr">Zhang et al., 2018</xref>; <xref rid="B15" ref-type="bibr">Koh et al., 2019</xref>). For instance, GLMM-MiRKAT (<xref rid="B15" ref-type="bibr">Koh et al., 2019</xref>) extends MiRKAT for continuous, binary and count outcomes in longitudinal studies. It adopts kernel regression-based generalized linear mixed models to construct variance component tests and uses permutations to calculate the <italic>p</italic>-value. Unfortunately, only exchangeable clusters which contain identical number of observations and the same time points can be permuted in this approach. Thus, the permutation procedure will be very complicated and inefficient for unbalanced study designs. On top of that, permutation tends to be computationally intensive when the sample size increases (especially for studies with multi-categorical outcomes) or when small <italic>p</italic>-values are needed for multiple comparison adjustment. These drawbacks also exist for PERMANOVA.</p>
    <p>In this paper, we propose a new distance-based microbiome kernel association test for multi-categorical outcomes (MiRKAT-MC), when samples are independent or clustered. MiRKAT-MC works for both nominal and ordinal outcomes, through the use of the generalized logit model (GLM) and the proportional odds model (POM), respectively. We utilize a fast pseudo-permutation technique (<xref rid="B36" ref-type="bibr">Zhan et al., 2017b</xref>) to calculate <italic>p</italic>-values. This approach features several advantages over its potential competitors: 1) it avoids the complication in designing a suitable permutation scheme for inference; 2) it is computationally efficient and much faster than direct permutations; 3) it controls the type I error and maintains high statistical power compared to the analytical approach. For the last point, due to the small sample size and the over-dispersion in microbiome data, it is quite difficult to approximate the MiRKAT test statistics, especially for clustered/longitudinal data and for outcomes that are not normally distributed.</p>
    <p>Another common challenge in distance-based methods lies in how to select an appropriate ecological distance to construct the kernel, because the statistical power highly depends on a proper kernel to capture the underlying association pattern. Attempting multiple kernels and cherry-picking the smallest <italic>p</italic>-value yields inflated type I errors. On the other hand, naively adjusting the results by Bonferroni correction will reduce the statistical power substantially, mainly because the individual tests are highly correlated. We propose an omnibus test that combines the individual <italic>p</italic>-values from tests with different kernels through the harmonic mean procedure (HMP) (<xref rid="B31" ref-type="bibr">Wilson, 2019</xref>). The omnibus test is not necessarily the most powerful one: which test is the most powerful depends on the true nature of association, which is unknown prior to analysis. Nevertheless, our omnibus test is robust regardless of the real association pattern in that it loses little power compared to the most powerful one, and is much more powerful than choosing an inappropriate kernel.</p>
    <p>In summary, the goal of this paper is to introduce novel statistical methods to examine the association between a multi-categorical outcome (both nominal and ordinal) and microbiome composition under different study designs (e.g., independent design, clustered design). Our major contributions are two-fold. First, we have cast the association analysis between a multi-categorical outcome and microbiome composition into frameworks of generalized logit models and proportional odds models (with additional random effects accounting for within-cluster correlations for clustered design). Our second contribution is proposing a robust <italic>p</italic>-value calculation procedure via a novel fast pseudo-permutation technique (<xref rid="B36" ref-type="bibr">Zhan et al., 2017b</xref>), avoiding the complicated and time-consuming permutation approach yet providing valid statistical inference. Finally, we provide a free R software to implement our proposed methods. It is a useful tool for microbiome researchers to investigate the relationship between the microbiome community and a multi-categorical outcome under a wide range of study designs, which was not readily available before.</p>
  </sec>
  <sec id="s2">
    <title>2 Materials and Methods</title>
    <p>To associate microbiome compositions with a multi-categorical outcome, we build upon generalized logit models (GLM) for nominal outcomes and proportional odds models (POM) for ordinal outcomes, and relate the microbiome profile with the outcome through the flexible semi-parametric kernel machine regression framework (<xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>). Our proposed MiRKAT-MC includes MiRKAT-MCN (for nominal outcomes) and MiRKAT-MCO (for ordinal outcomes). For both tests, we propose two versions, one for independent samples and another for clustered/longitudinal samples through the use of additional random effects in the generalized logit mixed model (GLMM) or the proportional odds mixed model (POMM).</p>
    <sec id="s2-1">
      <title>2.1 GLM and POM for Independent Data</title>
      <p>We first describe the GLM and POM model without considering the high dimensional microbiome data. Let <bold><italic>Y</italic></bold>
<sub><italic>i</italic></sub> denote the multi-categorical outcome with total <italic>J</italic> categories for the <italic>i</italic>-th subject. Here, <italic>bmY</italic>
<sub><italic>i</italic></sub> is a vector with the <italic>j</italic>-th element being <italic>y</italic>
<sub><italic>ji</italic></sub>, a binary variable denoting whether the <italic>i</italic>-th sample belongs to the <italic>j</italic>-th category, <italic>i</italic> = 1, … , <italic>N</italic>, <italic>j</italic> = 1, … , <italic>J</italic>. That is, <italic>y</italic>
<sub><italic>ji</italic></sub> = 1 means subject <italic>i</italic> is of category <italic>j</italic> and otherwise, <italic>y</italic>
<sub><italic>ji</italic></sub> = 0. In practice, <italic>y</italic>
<sub><italic>ji</italic></sub> can represent any mutually-exclusive categorical traits (nominal and ordinal), such as subtypes of cancers and increasing levels of disease severity that <inline-formula id="inf1"><mml:math id="m1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo movablelimits="false" form="prefix">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. From a probability perspective, <bold><italic>Y</italic></bold>
<sub><italic>i</italic></sub> can be considered as from a multinomial distribution with <italic>J</italic> categories. Let <italic>π</italic>
<sub><italic>j</italic></sub> (<bold><italic>x</italic></bold>
<sub><italic>i</italic></sub>) = Pr (<italic>y</italic>
<sub><italic>ji</italic></sub> = 1|<bold><italic>x</italic></bold>
<sub><italic>i</italic></sub>) be the conditional probability that subject <italic>i</italic> is of category <italic>j</italic> with <italic>∑</italic>
<sub><italic>j</italic></sub>
<italic>π</italic>
<sub><italic>j</italic></sub> (<bold><italic>x</italic></bold>
<sub><italic>i</italic></sub>) = 1, where <bold><italic>x</italic></bold>
<sub><italic>i</italic></sub> denotes the set of covariates that we want to associate <italic>Y</italic>
<sub><italic>i</italic></sub> with (such as race, gender and age). If <italic>bmY</italic>
<sub><italic>i</italic></sub> is nominal, we can set the last category <italic>J</italic> as a reference without loss of generalization, and form the following GLM:<disp-formula id="e1"><mml:math id="m2" overflow="scroll"><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><label>(1)</label></disp-formula>where <italic>j</italic> = 1, … , <italic>J</italic> − 1. The left-hand side of <xref rid="e1" ref-type="disp-formula">Eq. 1</xref> is the logit of a conditional probability, and each coordinate of <bold><italic>β</italic></bold>
<sub><italic>j</italic></sub> represents the increase in log-odds of falling into category <italic>j</italic> vs. the reference category <italic>J</italic> resulting from a one-unit increase in the corresponding covariate while holding the other covariates constant. This model simultaneously describes the effects of <bold><italic>x</italic></bold>
<sub><italic>i</italic></sub> on all outcome categories in contrast to the reference. In this model, parameters <bold><italic>β</italic></bold>
<sub><italic>j</italic></sub>, <italic>j</italic> = 1, … , <italic>J</italic> − 1 can be different among categories. If the categories are ordinal, we can utilize the order information and form the following POM:<disp-formula id="e2"><mml:math id="m3" overflow="scroll"><mml:mtext>logit</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><label>(2)</label></disp-formula>where <italic>j</italic> = 1, … , <italic>J</italic> − 1, and<disp-formula id="equ1"><mml:math id="m4" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:mi>Pr</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula>Here, <italic>ν</italic>
<sub><italic>j</italic></sub> (<bold><italic>x</italic></bold>
<sub><italic>i</italic></sub>) is the conditional cumulative probability, and the corresponding response, defined by <inline-formula id="inf2"><mml:math id="m5" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo movablelimits="false" form="prefix">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, is called the cumulative response. The ordinal information is thus utilized in the way that the original categories enter the groups in a sequence. In contrast to GLM, <bold><italic>β</italic></bold> here keeps constant across <italic>J</italic> − 1 logits and the intercepts have to satisfy <italic>α</italic>
<sub>1</sub> &lt; … &lt; <italic>α</italic>
<sub><italic>J</italic>−1</sub> in the proportional odds model.</p>
      <p>Finally, we notice that there are other recent attempts to develop association analysis for multi-categorical outcomes using multinomial logistic regression (i.e., GLM model (1)), usually in the context of genome wide association studies (<xref rid="B12" ref-type="bibr">He et al., 2021</xref>; <xref rid="B19" ref-type="bibr">Liu et al., 2021</xref>). Despite the shared motivations, MiRKAT-MC is distinct from existing methods in multiple aspects. First, none of the existing approaches specifically models ordinal outcomes and thus MiKAT-MC under POM is statistically novel. Second, MiRKAT-MC includes options that utilize GLMM and POMM (described <xref rid="s2-2" ref-type="sec">Section 2.2</xref>) to accommodate non-independent data from more complicated study designs. Last, our pseudo-permutation approach for obtaining <italic>p</italic>-values is novel and tends to outperform the asymptotic results as in existing methods when sample sizes are small, which is usually the case in microbiome data.</p>
    </sec>
    <sec id="s2-2">
      <title>2.2 GLMM and POMM for Clustered/Longitudinal Data</title>
      <p>Similarly, we first describe the GLMM and POMM models without considering the complex microbiome data. Suppose cluster <italic>i</italic> has <italic>m</italic>
<sub><italic>i</italic></sub> observations. Let <inline-formula id="inf3"><mml:math id="m6" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> represent the multi-categorical outcome of the <italic>k</italic>-th observation in cluster <italic>i</italic>, <italic>i</italic> = 1, … , <italic>n</italic>, <italic>k</italic> = 1, … , <italic>m</italic>
<sub><italic>i</italic></sub> and <inline-formula id="inf4"><mml:math id="m7" overflow="scroll"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo movablelimits="false" form="prefix">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> be the total number of observations in the study. Following notations in the previous section, let <italic>π</italic>
<sub><italic>j</italic></sub> (<bold><italic>x</italic></bold>
<sub><italic>ik</italic></sub>|<bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub>) = Pr (<italic>y</italic>
<sub><italic>jik</italic></sub> = 1|<bold><italic>x</italic></bold>
<sub><italic>ik</italic></sub>, <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub>) and setting the <italic>J</italic>-th category as reference, the GLMM for clustered/longitudinal data can be written as:<disp-formula id="e3"><mml:math id="m8" overflow="scroll"><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><label>(3)</label></disp-formula>where <inline-formula id="inf5"><mml:math id="m9" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> denote covariates and <inline-formula id="inf6"><mml:math id="m10" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> are corresponding regression coefficients, <bold><italic>u</italic></bold>
<sub><italic>ik</italic></sub> is the design matrix for the random effect term <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub>. We introduce <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> to model correlations among observations within cluster <italic>i</italic> of category <italic>j</italic>. The model definition is completed by specifying the distribution of the random effect <inline-formula id="inf7"><mml:math id="m11" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where the variance-covariance matrix <bold><italic>G</italic></bold>
<sub><italic>j</italic></sub> for the <italic>j</italic>-th category is unstructured. We also allow <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> to be correlated across categories.</p>
      <p>The corresponding POMM for ordinal outcomes is as follows:<disp-formula id="e4"><mml:math id="m12" overflow="scroll"><mml:mtext>logit</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><label>(4)</label></disp-formula>One main difference between models (<xref rid="e3" ref-type="disp-formula">Eqs. 3</xref>, <xref rid="e4" ref-type="disp-formula">4</xref>) lies in model (<xref rid="e4" ref-type="disp-formula">Eq. 4</xref>) restricts <bold><italic>b</italic></bold>
<sub><italic>i</italic></sub> to be identical across category comparisions, and thus <inline-formula id="inf8"><mml:math id="m13" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with a fixed variance-covariance matrix <bold><italic>G</italic></bold>. Here, we essentially assume that the random effects across the ordered categories are the same, which guarantees in proportional odds. Specifically, for a fixed cluster <italic>i</italic>, the random effect <bold><italic>b</italic></bold>
<sub><italic>i</italic></sub> has identical value across different categories <italic>j</italic>. But for different clusters <italic>i</italic> and <italic>i</italic>′, <bold><italic>b</italic></bold>
<sub><italic>i</italic></sub> and <bold><italic>b</italic></bold>
<sub><italic>i</italic>′</sub> may be different and both have normal distribution <inline-formula id="inf9"><mml:math id="m14" overflow="scroll"><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The variance-covariance matrix <bold><italic>G</italic></bold> is unstructured as well. The same constraints for <bold><italic>α</italic></bold>
<sub><italic>j</italic></sub> and <bold><italic>β</italic></bold> as in model (<xref rid="e2" ref-type="disp-formula">Eq. 2</xref>) also apply in the POMM model (<xref rid="e4" ref-type="disp-formula">Eq. 4</xref>).</p>
    </sec>
    <sec id="s2-3">
      <title>2.3 Microbiome Association Analysis Under Models for Multi-Categorical Variables</title>
      <p>We extend the previous described models to incorporate the complex microbiome data. For independent data, let <inline-formula id="inf10"><mml:math id="m15" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> be the composition of <italic>p</italic> OTUs for sample <italic>i</italic> (subject to appropriate normalization and transformation). We relate the multivariate outcome to the microbiome community and the covariates with the following model<disp-formula id="e5"><mml:math id="m16" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(5)</label></disp-formula>for <italic>i</italic> = 1, … , <italic>N</italic>, <italic>j</italic> = 1, … , <italic>J</italic>, where <italic>η</italic> = <italic>g</italic> (⋅) and <italic>g</italic> (⋅) is a link function. For GLM, <italic>g</italic> (<italic>π</italic>
<sub><italic>ji</italic></sub>) = log (<italic>π</italic>
<sub><italic>ji</italic></sub>/<italic>π</italic>
<sub><italic>Ji</italic></sub>), <italic>π</italic>
<sub><italic>ji</italic></sub> = <italic>E</italic> (<italic>y</italic>
<sub><italic>ji</italic></sub>|<italic>h</italic>
<sub><italic>ji</italic></sub>), and <italic>h</italic>
<sub><italic>ji</italic></sub> = <italic>h</italic>
<sub><italic>j</italic></sub> (<bold><italic>z</italic></bold>
<sub><italic>i</italic></sub>); for POM, <italic>g</italic> (<italic>ν</italic>
<sub><italic>ji</italic></sub>) = log{<italic>ν</italic>
<sub><italic>ji</italic></sub>/(1 − <italic>ν</italic>
<sub><italic>ji</italic></sub>)}, <inline-formula id="inf11"><mml:math id="m17" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the conditional mean of the cumulative response <inline-formula id="inf12"><mml:math id="m18" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. <italic>h</italic>
<sub><italic>j</italic></sub> (⋅) are unknown real functions corresponding to the effects of microbiome on the <italic>j</italic>-th category. For POM, <italic>h</italic>
<sub><italic>j</italic></sub> (⋅) are identical across categories, and <italic>α</italic>
<sub><italic>j</italic></sub> and <bold><italic>β</italic></bold>
<sub><italic>j</italic></sub> are subject to the constraints described in model (<xref rid="e2" ref-type="disp-formula">Eq. 2</xref>).</p>
      <p>For clustered studies, let <italic>y</italic>
<sub><italic>jik</italic></sub> be a binary variable denoting whether the <italic>k</italic>-th observation of the <italic>i</italic>-th cluster belongs to the <italic>j</italic>-th category, where <italic>k</italic> = 1, … , <italic>m</italic>
<sub><italic>i</italic></sub>, <italic>i</italic> = 1, … , <italic>n</italic> and <italic>j</italic> = 1, … , <italic>J</italic>. We let <inline-formula id="inf13"><mml:math id="m19" overflow="scroll"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo movablelimits="false" form="prefix">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> be the total number of observations. <inline-formula id="inf14"><mml:math id="m20" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> represent <italic>p</italic> OTUs for the <italic>k</italic>-th observation in the <italic>i</italic>-th cluster. The mixed effect model proceeds as<disp-formula id="e6"><mml:math id="m21" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(6)</label></disp-formula>where <italic>η</italic>
<sub><italic>jik</italic></sub> = <italic>g</italic> [<italic>E</italic> (<italic>y</italic>
<sub><italic>jik</italic></sub>|<bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub>, <italic>h</italic>
<sub><italic>jik</italic></sub>)], <italic>h</italic>
<sub><italic>jik</italic></sub> = <italic>h</italic>
<sub><italic>j</italic></sub> (<bold><italic>z</italic></bold>
<sub><italic>ik</italic></sub>), and <italic>g</italic> (⋅) is the same link function as model (<xref rid="e5" ref-type="disp-formula">Eq. 5</xref>). To illustrate our methodology, we here give some specific examples of the random effects <bold><italic>u</italic></bold>
<sub><italic>ik</italic></sub>. When <italic>u</italic>
<sub><italic>ik</italic></sub> = 1, <italic>b</italic>
<sub><italic>ji</italic></sub> is the random intercept which can be assumed normally distributed <inline-formula id="inf15"><mml:math id="m22" overflow="scroll"><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. When <inline-formula id="inf16"><mml:math id="m23" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, where <italic>t</italic>
<sub><italic>ik</italic></sub> is the time for the <italic>k</italic>-th observation in the <italic>i</italic>-th cluster (for longitudinal studies), <inline-formula id="inf17"><mml:math id="m24" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> denote the random intercept and random slope with a bivariate normal distribution <inline-formula id="inf18"><mml:math id="m25" overflow="scroll"><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="inf19"><mml:math id="m26" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mtable class="matrix"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula>. Usually, <bold><italic>G</italic></bold>
<sub><italic>jj</italic></sub> is specified as “unstructured” in generalized linear mixed effect models, providing much flexibility to capture cluster specific correlations. Again, for POMM, <italic>α</italic>
<sub><italic>j</italic></sub>, <bold><italic>β</italic></bold>
<sub><italic>jm</italic></sub>, and <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> are subject to the constraints described in model (<xref rid="e4" ref-type="disp-formula">Eq. 4</xref>), and <italic>h</italic>
<sub><italic>jik</italic></sub> (⋅) should be identical across categories.</p>
      <p>Our primary goal is to test the null hypothesis <italic>H</italic>
<sub>0</sub>: <italic>h</italic>
<sub>1</sub> (⋅) = … = <italic>h</italic>
<sub><italic>J</italic>−1</sub> (⋅) = 0 in <xref rid="e5" ref-type="disp-formula">Eq. 5</xref>, <xref rid="e6" ref-type="disp-formula">6</xref>. One feasible approach is to develop such a test leveraging the kernel machine regression-based association analysis framework (<xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>). Through the critical connection between kernel machine regression and mixed models (<xref rid="B18" ref-type="bibr">Liu et al., 2007</xref>), <inline-formula id="inf20"><mml:math id="m27" overflow="scroll"><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> can be considered as random effect with mean <bold>0</bold> and variance <bold><italic>K</italic></bold>*. We assume that each <inline-formula id="inf21"><mml:math id="m28" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> for independent data (or <inline-formula id="inf22"><mml:math id="m29" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> for clustered data) is independent and is of the same (multivariate) distribution. In such a case, <bold><italic>K</italic></bold>* = <bold><italic>I</italic></bold>
<sub><italic>J</italic>−1</sub> ⊗ <italic>τ</italic>
<bold><italic>K</italic></bold>, where <bold><italic>I</italic></bold>
<sub><italic>J</italic>−1</sub> denote (<italic>J</italic> − 1)-th order identity matrix, <italic>τ</italic> is an unspecified constant, <bold><italic>K</italic></bold> is an <italic>N</italic> × <italic>N</italic> kernel matrix, and ⊗ denotes Kronecker product. Following (<xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>), the kernel matrix can be easily constructed by a specific ecological distance matrix <bold><italic>D</italic></bold>
<disp-formula id="e7"><mml:math id="m30" overflow="scroll"><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(7)</label></disp-formula>where <bold>1</bold>
<sub><italic>N</italic></sub> is a vector of 1’s and <bold><italic>I</italic></bold>
<sub><italic>N</italic></sub> is the identity matrix.</p>
      <p>Typical distance measures for microbiome data include the Bray-Curtis dissimilarity, the weighted, unweighted or generalized UniFrac distances (<xref rid="B21" ref-type="bibr">Lozupone and Knight, 2005</xref>). The kernel matrix defined by <xref rid="e7" ref-type="disp-formula">Eq. 7</xref> measures sample-pairwise similarities. Using this transformation, ecological information (e.g., taxonomic or the phylogenetic relationship between taxa) encoded in the distance <bold><italic>D</italic></bold> is preserved in <bold><italic>K</italic></bold>, and thus in the functions of microbiome effect <italic>h</italic>
<sub><italic>j</italic></sub> (⋅)’s (which are assumed to be in the space spanned by <bold><italic>K</italic></bold>). As demonstrated in previous studies, the embedding of such ecological information may boost statistical power for detecting an underlying association under many scenarios (<xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>). Here, we first focus the simpler case in which a single distance (e.g., Bray-Curtis dissimilarity) is considered. Omnibus test utilizing multiple kernels will be described later in this session.</p>
      <p>To develop the distance-based kernel association test, we further translate association analysis working model (<xref rid="e5" ref-type="disp-formula">Eqs. 5</xref>, <xref rid="e6" ref-type="disp-formula">6</xref>) into matrix language. For independent data,<disp-formula id="e8"><mml:math id="m31" overflow="scroll"><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mo>,</mml:mo></mml:math><label>(8)</label></disp-formula>where <inline-formula id="inf23"><mml:math id="m32" overflow="scroll"><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1,1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula id="inf24"><mml:math id="m33" overflow="scroll"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:mfenced open="[" close="]"><mml:mrow><mml:mtable class="matrix"><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula id="inf25"><mml:math id="m34" overflow="scroll"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula id="inf26"><mml:math id="m35" overflow="scroll"><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1,1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is distributed as multivariate normal with mean zero and covariance matrix <bold><italic>K</italic></bold>* = <bold><italic>I</italic></bold>
<sub><italic>J</italic>−1</sub> ⊗ <italic>τ</italic>
<bold><italic>K</italic></bold>. Hence, testing <italic>H</italic>
<sub>0</sub>: <bold><italic>h</italic></bold> = <bold>0</bold> is equivalent to testing <italic>H</italic>
<sub>0</sub>: <italic>τ</italic> = 0, which can be accomplished by a variance component score test. The mathematical derivation of the variance component score test can be found in <xref rid="s10" ref-type="sec">Supplementary Section 1.1</xref> of the online <xref rid="s10" ref-type="sec">Supplementary Material</xref>. In brief, the test statistic for <bold><italic>h</italic></bold> = <bold>0</bold> in (<xref rid="e8" ref-type="disp-formula">Eq. 8</xref>) is<disp-formula id="e9"><mml:math id="m36" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(9)</label></disp-formula>where <bold><italic>y</italic></bold>* is a working response vector, <bold><italic>W</italic></bold> is a working weight matrix, and <inline-formula id="inf27"><mml:math id="m37" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the estimated coefficients under the null. For GLM, <inline-formula id="inf28"><mml:math id="m38" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, where <bold><italic>D</italic></bold>
<sub><italic>π</italic></sub> = <italic>∂</italic>
<bold><italic>η</italic></bold>/<italic>∂</italic>
<bold><italic>π</italic></bold>, <inline-formula id="inf29"><mml:math id="m39" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a vector of fitted values returned by the null model <bold><italic>η</italic></bold> = <bold><italic>Xβ</italic></bold>. <inline-formula id="inf30"><mml:math id="m40" overflow="scroll"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <bold><italic>V</italic></bold>
<sub><italic>π</italic></sub> is the variance-covariance matrix of the multinomial distribution evaluated at <bold><italic>π</italic></bold>. For POM, <inline-formula id="inf31"><mml:math id="m41" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">ν</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, where <bold><italic>D</italic></bold>
<sub><italic>ν</italic></sub> = <italic>∂</italic>
<bold><italic>η</italic></bold>/<italic>∂</italic>
<bold><italic>ν</italic></bold>. <inline-formula id="inf32"><mml:math id="m42" overflow="scroll"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, where <bold><italic>V</italic></bold>
<sub><italic>ν</italic></sub> is the variance-covariance matrix of the cumulative probability <bold><italic>ν</italic></bold>.</p>
      <p>For clustered study design, we write model (<xref rid="e6" ref-type="disp-formula">Eq. 6</xref>) in matrix notations<disp-formula id="e10"><mml:math id="m43" overflow="scroll"><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mo>,</mml:mo></mml:math><label>(10)</label></disp-formula>where each component has three levels - category, cluster, and observation, except for <bold><italic>β</italic></bold> and <bold><italic>b</italic></bold>. Please refer to <xref rid="s10" ref-type="sec">Supplementary Section 1.2</xref> of the online <xref rid="s10" ref-type="sec">Supplementary Material</xref> for details of the model structure. Similarly, by applying pseudo-likelihood approach (<xref rid="B33" ref-type="bibr">Wolfinger and O’connell, 1993</xref>), the test statistic is<disp-formula id="e11"><mml:math id="m44" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced open="(" close=")"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(11)</label></disp-formula>For GLMM, <inline-formula id="inf33"><mml:math id="m45" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="inf34"><mml:math id="m46" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a vector of fitted values returned by the null model <bold><italic>η</italic></bold> = <bold><italic>Xβ</italic></bold> + <bold><italic>Ub</italic></bold>, and <inline-formula id="inf35"><mml:math id="m47" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a vector of estimated coefficients of the fix effect, <inline-formula id="inf36"><mml:math id="m48" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a vector of predicted values of <bold><italic>b</italic></bold>. <bold>Σ</bold> = <bold><italic>W</italic></bold>
<sup>−1</sup> + <bold><italic>UG</italic></bold>*<bold><italic>U</italic></bold>′, where <bold><italic>W</italic></bold>
<sup>−1</sup> = <bold><italic>D</italic></bold>
<sub><italic>π</italic></sub>
<bold><italic>V</italic></bold>
<sub><italic>π</italic></sub>
<bold><italic>D</italic></bold>
<sub><italic>π</italic></sub>, and <bold><italic>G</italic></bold>* is a (<italic>J</italic> − 1) × (<italic>J</italic> − 1) block matrix with entries <bold><italic>I</italic></bold>
<sub><italic>n</italic></sub> ⊗<bold><italic>G</italic></bold>
<sub><italic>jh</italic></sub>, <italic>j</italic>, <italic>h</italic> = 1, … , <italic>J</italic> − 1. For POMM, <inline-formula id="inf37"><mml:math id="m49" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">ν</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <bold><italic>W</italic></bold>
<sup>−1</sup> = <bold><italic>D</italic></bold>
<sub><italic>ν</italic></sub>
<bold><italic>V</italic></bold>
<sub><italic>ν</italic></sub>
<bold><italic>D</italic></bold>
<sub><italic>ν</italic></sub> and <bold><italic>G</italic></bold>* is a (<italic>J</italic> − 1) block diagonal matrix with entries <bold><italic>I</italic></bold>
<sub><italic>n</italic></sub> ⊗<bold><italic>G</italic></bold>
<sub><italic>jj</italic></sub>.</p>
    </sec>
    <sec id="s2-4">
      <title>2.4 <italic>p</italic>-Value Calculation</title>
      <p>While deriving the test statistics for <italic>Q</italic>
<sub>1</sub> and <italic>Q</italic>
<sub>2</sub> is relatively straightforward in the pseudo-likelihood framework (as detailed in <xref rid="s10" ref-type="sec">Supplementary Section 1</xref> of the online <xref rid="s10" ref-type="sec">Supplementary Material</xref>), obtaining their null distributions to calculate <italic>p</italic>-values is never an easy task. A major challenge lies in that classic asymptotic results in the likelihood framework tend to be inaccurate due to the relatively small sample size in microbiome studies (e.g., less than few hundred) and the over-dispersion in microbiome data (<xref rid="B8" ref-type="bibr">Chen et al., 2016</xref>). Small-sample correction procedures are available within relatively easier models such as the linear regression models or linear mixed model in literature (<xref rid="B8" ref-type="bibr">Chen et al., 2016</xref>; <xref rid="B35" ref-type="bibr">Zhan et al., 2017a</xref>; <xref rid="B37" ref-type="bibr">Zhan et al., 2018</xref>; <xref rid="B34" ref-type="bibr">Zhan et al., 2021</xref>). Yet, such an attempt in the more-complicated models (e.g., GLM, POM, GLMM, and POMM) considered in the current paper does not work out due to mathematical complexities of these models (e.g., canonical links are often unavailable or very complicated in such models). To this end, we resort to a pseudo-permutation strategy (<xref rid="B36" ref-type="bibr">Zhan et al., 2017b</xref>) to obtain accurate <italic>p</italic>-values in finite samples.</p>
      <p>Briefly, the null distribution of all permutations of the test statistic can be approximated by the Pearson type III density, which is achieved by matching the first three moments. This strategy leads to a fast <italic>p</italic>-value calculation since we only need to use the matched Pearson type III density for <italic>p</italic>-value calculation without the need to draw real permutations (<xref rid="B36" ref-type="bibr">Zhan et al., 2017b</xref>). Essentially, we observe that the test statistics <italic>Q</italic>
<sub>1</sub> and <italic>Q</italic>
<sub>2</sub> can be reformulated as the trace of the product of two kernels matrix: a kernel matrix for outcomes (<bold><italic>K</italic></bold>
<sub><italic>Y</italic></sub>) and a kernel matrix for microbiome data (<bold><italic>K</italic></bold> in <xref rid="e7" ref-type="disp-formula">Eq. 7</xref>). Here we still assume that the kernel matrix for microbiome data is identical across multiple categories. Therefore, we use <bold><italic>K</italic></bold> instead of the original <bold><italic>K</italic></bold>* = <bold><italic>I</italic></bold>
<sub><italic>J</italic>−1</sub> ⊗<bold><italic>K</italic></bold> in test statistics <italic>Q</italic>
<sub>1</sub> (<xref rid="e9" ref-type="disp-formula">Eq. 9</xref>) and <italic>Q</italic>
<sub>2</sub> (<xref rid="e11" ref-type="disp-formula">Eq. 11</xref>). In the proposed framework, let the weighted residual <bold><italic>ϵ</italic></bold> = <bold><italic>W</italic></bold> (<bold><italic>y</italic></bold>* − <bold><italic>Xβ</italic></bold>) for independent data or <bold><italic>ϵ</italic></bold> = <bold>Σ</bold>
<sup>−1</sup> (<bold><italic>y</italic></bold>* − <bold><italic>Xβ</italic></bold>) for longitudinal data. The outcome kernel will be <inline-formula id="inf38"><mml:math id="m50" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, where <inline-formula id="inf39"><mml:math id="m51" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is an <italic>N</italic> × (<italic>J</italic> − 1) matrix, where <bold><italic>ϵ</italic></bold>
<sub><italic>j</italic></sub> is the weighted residuals for the <italic>j</italic>-th category. Originally, <inline-formula id="inf40"><mml:math id="m52" overflow="scroll"><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a vector of length <italic>N</italic> (<italic>J</italic> − 1), where <italic>Vec</italic> (⋅) denotes the operator that transforms a matrix into a column vector by vertically stacking the columns of the matrix. We refer the readers to previous publications for further details of <italic>p</italic>-values using the Pearson type III distribution (<xref rid="B36" ref-type="bibr">Zhan et al., 2017b</xref>).</p>
      <p>Finally, recall that <italic>p</italic>-values of tests using different microbiome kernels could vary greatly depending on whether the kernel of choice captures the true underlying association pattern. To this end, we propose an omnibus test that first conducts individual tests using one of the kernels (Bray-Curtis, UniFrac, weighted UniFrac etc). And then combines these individual <italic>p</italic>-values (corresponding to different microbiome kernels) using the harmonic mean <italic>p</italic>-value (HMP) procedure (<xref rid="B31" ref-type="bibr">Wilson, 2019</xref>) for an omnibus <italic>p</italic>-value, based on which to conclude our inference of statistical association. This approach tends to be robust: it loses little power compared to when the best kernel (which is unknown in practice) is used and gains substantial power compared to when a poor choice of kernel is used.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>3 Results</title>
    <sec id="s3-1">
      <title>3.1 Simulation Studies</title>
      <sec id="s3-1-1">
        <title>3.1.1 Design of Simulations</title>
        <p>We conducted comprehensive simulations to evaluate empirical type I error of MiRKAT-MC when there is no true associations, and statistical powers under different association patterns. For both independent and clustered study designs, microbiome compositions were simulated similarly as in previous studies (<xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>). Briefly, we first fitted a Dirchlet-multinomial distribution to a real upper-respiratory-tract microbiome dataset (<xref rid="B5" ref-type="bibr">Charlson et al., 2010</xref>), which contains 856 OTUs for 60 samples, and estimated the mean and dispersion parameters. We then used these estimated parameters to generate microbiome read counts via the Dirchlet-multinomial distribution. We intended to investigate what the most powerful kernel is when the causal OTUs are with or without phylogenetic relationships, and whether the abundance matters.</p>
        <sec id="s3-1-1-1">
          <title>3.1.1.1 Independent Data</title>
          <p>We considered simulations when there are three categories (<italic>J</italic> = 3) and when there are five categories (<italic>J</italic> = 5). Data from each sample was simulated independently, according to following model<disp-formula id="e12"><mml:math id="m53" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(12)</label></disp-formula>where <italic>i</italic> = 1, … , <italic>N</italic> and <italic>j</italic> = 1, … , <italic>J</italic> − 1. We set the sample size <italic>N</italic> = 80 or 200 for when <italic>J</italic> = 3, and <italic>N</italic> = 150 or 300 when <italic>J</italic> = 5. We simulated both nominal and ordinal outcomes, using appropriate link functions of <italic>η</italic>. For nominal data (GLM), <italic>α</italic>
<sub><italic>j</italic></sub> = −2, and for ordinal data (POM), <italic>α</italic>
<sub><italic>j</italic></sub> = <italic>j</italic> − 4. <italic>x</italic>
<sub><italic>i</italic>1</sub> is a Bernoulli variable with probability of 0.5, whereas <italic>x</italic>
<sub><italic>i</italic>2</sub> is a standard normal variable with mean 0 and variance 1. <inline-formula id="inf41"><mml:math id="m54" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> is a set of outcome-associated OTUs among the <italic>p</italic> OTUs in the community. <italic>β</italic> = 0 for type I error simulations, for which the choice of <inline-formula id="inf42"><mml:math id="m55" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> doesn’t matter. <italic>scale</italic> is the operation that standardize the data to be mean 0 and variance 1 across all the samples.</p>
          <p>For statistical power evaluation, we considered three scenarios. Under the first two scenarios, causal OTUs (in <inline-formula id="inf43"><mml:math id="m56" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>) were selected from clusters of related taxa on a phylogenetic tree. In specific, we first partitioned the simulated OTUs into 20 clusters through the partitioning-around-medoids (PAM) algorithm based on the corresponding phylogenetic tree. For scenario 1, we randomly chose a common cluster of the OTUs as the causal OTUs. For scenario 2, we chose the rarest cluster as the causal OTUs. For scenario 3, we picked the 10 most abundant OTUs without consideration of phylogenetic information. These three scenarios correspond to situations in which the weighted UniFrac, unweighted UniFrac and the Bray-Curtis distances are expected to be the most powerful, respectively. For scenarios 1 and 3, <italic>β</italic> = 0.6, 0.8, 1.2, 1.6, 2.0, and <italic>β</italic> = 2, 4, 6, 8, 10 for scenario 2.</p>
          <p>For each scenario, we employed the weighted UniFrac (<italic>K</italic>
<sub><italic>w</italic></sub>), the unweighted UniFrac (<italic>K</italic>
<sub><italic>u</italic></sub>), the Bray-Curtis (<italic>K</italic>
<sub><italic>BC</italic></sub>) and a generalized UniFrac kernel with the parameter of 0.5 (<italic>K</italic>
<sub>5</sub>) for association testing. We also conducted the omnibus test by combining the <italic>p</italic>-values from all individual tests. To obtain convincing results, we generated 10,000 replicates to estimate the empirical type I errors and 2,000 replicates for statistical powers. Statistical significance was established under the nominal level of <italic>α</italic> = 0.05 for all the simulation studies.</p>
        </sec>
        <sec id="s3-1-1-2">
          <title>3.1.1.2 Clustered Data</title>
          <p>We simulated two scenarios to assess MiRKAT-MC when data is clustered. We simulated a family based study and a longitudinal study. For family-based data, we included only a random intercept in the model to capture the correlation between samples, while for longitudinal data, both a random intercept and a random slope of time were involved in the model. We set the number of clusters <italic>n</italic> = 30 or 60 for three categories (<italic>J</italic> = 3), and <italic>n</italic> = 50 or 100 for five categories (<italic>J</italic> = 5). We simulated data under an unbalanced design: i.e., clusters may have a different number of observations. To achieve this, <italic>n</italic>/2 of the clusters have three observations and the other <italic>n</italic>/2 of the clusters have four observations. In this way, the total numbers of observations are <italic>N</italic> = 105 (<italic>n</italic> = 30) and <italic>N</italic> = 210 (<italic>n</italic> = 60) when <italic>J</italic> = 3 and <italic>N</italic> = 175 (<italic>n</italic> = 50) and <italic>N</italic> = 350 (<italic>n</italic> = 100) when <italic>J</italic> = 5. Within each cluster, the outcome category may vary over observations; e.g., in longitudinal studies, a person may be of one disease category at one time point and of a different disease category at a different time point.</p>
          <p>The following model was utilized to simulate the data<disp-formula id="e13"><mml:math id="m57" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><label>(13)</label></disp-formula>where <italic>i</italic> = 1, … , <italic>n</italic>, <italic>j</italic> = 1, … , <italic>J</italic> − 1, and <italic>k</italic> = 1, … , <italic>m</italic>
<sub><italic>i</italic></sub>. The definition of the parameters <italic>η</italic>, <italic>α</italic>
<sub><italic>j</italic></sub>, <italic>β x</italic>
<sub><italic>ik</italic>1</sub>, <italic>x</italic>
<sub><italic>ik</italic>2</sub>, <inline-formula id="inf44"><mml:math id="m58" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> and <italic>scale</italic> function are identical to the counterparts in model (<xref rid="e12" ref-type="disp-formula">Eq. 12</xref>). The same three scenarios of choices of <inline-formula id="inf45"><mml:math id="m59" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> were considered for power assessment. When the model included only a random intercept, <italic>u</italic>
<sub><italic>ik</italic></sub> = 1 and <italic>b</italic>
<sub><italic>ji</italic></sub> was generated from <inline-formula id="inf46"><mml:math id="m60" overflow="scroll"><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="inf47"><mml:math id="m61" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>1,4</mml:mn></mml:math></inline-formula> being the variance, respectively. When considering both a random intercept and a random slope of time, <inline-formula id="inf48"><mml:math id="m62" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <italic>b</italic>
<sub><italic>ji</italic></sub> was simulated from <inline-formula id="inf49"><mml:math id="m63" overflow="scroll"><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="inf50"><mml:math id="m64" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mtable class="matrix"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula>. We set <inline-formula id="inf51"><mml:math id="m65" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>1,4</mml:mn></mml:math></inline-formula>, respectively, and <italic>g</italic>
<sub><italic>jj</italic>12</sub> = <italic>g</italic>
<sub><italic>gg</italic>21</sub> were determined by <inline-formula id="inf52"><mml:math id="m66" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. Thus, the correlation between the random intercept and the random slope was fixed at <inline-formula id="inf53"><mml:math id="m67" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>. The generation of random effect <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> was different for GLMM and POMM. Specifically, for a fixed cluster <italic>i</italic>, for GLMM, we generated a new random vector of <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> for each category <italic>j</italic> from the above distribution. For the ease of data generation, we kept <bold><italic>G</italic></bold>
<sub><italic>jj</italic></sub> the same across categories and did not consider correlation of <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> between categories for nominal data. However, as we discussed in model (<xref rid="e3" ref-type="disp-formula">Eq. 3</xref>), GLMM enjoys the freedom of different <bold><italic>G</italic></bold>
<sub><italic>jj</italic></sub> and correlated <bold><italic>b</italic></bold>
<sub><italic>ji</italic></sub> across different categories. In contrast, for POMM, we generated a new random vector of <bold><italic>b</italic></bold>
<sub><italic>i</italic></sub> only once for each cluster <italic>i</italic> and then plugged the same <bold><italic>b</italic></bold>
<sub><italic>i</italic></sub> in model (<xref rid="e13" ref-type="disp-formula">Eq. 13</xref>) for different categories.</p>
        </sec>
      </sec>
      <sec id="s3-1-2">
        <title>3.1.2 Simulation Results</title>
        <p>Empirical type I error rates of MiRKAT-MCN (for nominal outcomes) and MiRKAT-MCO (for ordinal outcomes) for independent data are reported in <xref rid="T1" ref-type="table">Table 1</xref>. As seen in the table, the empirical type I errors (at <italic>α</italic> = 0.05) of MiRKAT-MC are all very close to the expected level. Empirical type I error rates under different mixed models for clustered data are reported in <xref rid="s10" ref-type="sec">Supplementary Tables S1–S4</xref> (<xref rid="s10" ref-type="sec">Supplementary Section 2.1</xref>, online <xref rid="s10" ref-type="sec">Supplementary Material</xref>), which also show well-controlled type I errors for both nominal and ordinal outcomes.</p>
        <table-wrap position="float" id="T1">
          <label>TABLE 1</label>
          <caption>
            <p>Empirical type I error rates of MiRKAT-MC for independent data with three-categories.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th rowspan="2" align="left" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">MiRKAT-MCN</th>
                <th colspan="2" align="center" rowspan="1">MiRKAT-MCO</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"><italic>N</italic> = 80</th>
                <th align="center" rowspan="1" colspan="1"><italic>N</italic> = 200</th>
                <th align="center" rowspan="1" colspan="1"><italic>N</italic> = 80</th>
                <th align="center" rowspan="1" colspan="1"><italic>N</italic> = 200</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>w</sub>
</td>
                <td align="center" rowspan="1" colspan="1">0.0463</td>
                <td align="center" rowspan="1" colspan="1">0.0465</td>
                <td align="center" rowspan="1" colspan="1">0.0440</td>
                <td align="center" rowspan="1" colspan="1">0.0470</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>u</sub>
</td>
                <td align="center" rowspan="1" colspan="1">0.0436</td>
                <td align="center" rowspan="1" colspan="1">0.0491</td>
                <td align="center" rowspan="1" colspan="1">0.0487</td>
                <td align="center" rowspan="1" colspan="1">0.0492</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>BC</sub>
</td>
                <td align="center" rowspan="1" colspan="1">0.0488</td>
                <td align="center" rowspan="1" colspan="1">0.0468</td>
                <td align="center" rowspan="1" colspan="1">0.0469</td>
                <td align="center" rowspan="1" colspan="1">0.0449</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>5</sub>
</td>
                <td align="center" rowspan="1" colspan="1">0.0479</td>
                <td align="center" rowspan="1" colspan="1">0.0518</td>
                <td align="center" rowspan="1" colspan="1">0.0476</td>
                <td align="center" rowspan="1" colspan="1">0.0466</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HMP</td>
                <td align="center" rowspan="1" colspan="1">0.0502</td>
                <td align="center" rowspan="1" colspan="1">0.0475</td>
                <td align="center" rowspan="1" colspan="1">0.0461</td>
                <td align="center" rowspan="1" colspan="1">0.0455</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p><italic>N</italic> denotes the sample size. K<sub>w</sub>, the weighted UniFrac kernel; K<sub>u</sub>, the unweighted UniFrac kernel; K<sub>BC</sub>, the Bray-Curtis kernel; K<sub>5</sub>, the generalized UniFrac kernel with parameter 0.5; HMP, the omnibus test using harmonic mean <italic>p</italic>-value test.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p><xref rid="F1" ref-type="fig">Figure 1</xref> shows the statistical powers of MiRKAT-MC using independent data with three categories. The results with five categories using independent data are in <xref rid="s10" ref-type="sec">Supplementary Figure S1</xref> (<xref rid="s10" ref-type="sec">Supplementary Section 2.2</xref>, online <xref rid="s10" ref-type="sec">Supplementary Material</xref>). We observe that the tests with weighted UniFrac, unweighted UniFrac, and Bray-Curtis kernels are most powerful for scenarios 1, 2, and 3, respectively, regardless of whether the outcome is nominal or ordinal. However, the tests with Bray-Curtis kernel produced very little power in scenario 2, and the tests with unweighted UniFrac showed little power in scenario 3: the statistical power are close to their expected type I error. This is due to the differences in the true association signals that each of the kernels is designed to capture. The weighted UniFrac kernel is most powerful to capture signals that are dominated by common taxa in a cluster on a phylogenetic tree, while the unweighted UniFrac kernel shows its strengths when rare OTUs in a phylogenetic cluster determine the association (<xref rid="B7" ref-type="bibr">Chen et al., 2012</xref>). In contrast, the Bray-Curtis kernel is more appropriate when the outcome is associated with a set of OTUs with high abundance without referring to a phylogenetic tree. The Omnibus test considering all four kernels is robust. For example, among the tests using single kernels, only Bray-Curtis kernel shows significant powers under scenario 3. Yet, the omnibus test is still able to detect the association.</p>
        <fig position="float" id="F1">
          <label>FIGURE 1</label>
          <caption>
            <p>Statistical powers of MiRKAT-MC for independent data with three categories. Scenario 1: <inline-formula id="inf54"><mml:math id="m68" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> = A randomly selected common cluster among 20 clusters by PAM; Scenario 2: <inline-formula id="inf55"><mml:math id="m69" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> = The rarest cluster among 20 clusters by PAM; Scenario 3: <inline-formula id="inf56"><mml:math id="m70" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> = 10 most abundant OTUs. K<sub>w</sub>, the weighted UniFrac kernel; K<sub>u</sub>, the unweighted UniFrac kernel; K<sub>BC</sub>, the Bray-Curtis kernel; K<sub>5</sub>, the generalized UniFrac kernel with parameter 0.5; HMP, the omnibus test using harmonic mean <italic>p</italic>-value test. <bold>(A)</bold> MiRKAT-MCN with 80 total samples; <bold>(B)</bold> MiRKAT-MCO with 80 total samples; <bold>(C)</bold> MiRKAT-MCN with 200 total samples; <bold>(D)</bold> MiRKAT-MCO with 200 total samples.</p>
          </caption>
          <graphic xlink:href="fgene-13-841764-g001" position="float"/>
        </fig>
        <p><xref rid="T2" ref-type="table">Table 2</xref> shows the empirical type I error for our proposed methods when the data are clustered. Again, type I errors are well controlled to their nominal level. The statistical powers for simulations when data is clustered are presented in <xref rid="s10" ref-type="sec">Supplementary Figures S2–S5</xref> (<xref rid="s10" ref-type="sec">Supplementary Section 2.2</xref>, online <xref rid="s10" ref-type="sec">Supplementary Material</xref>). Under three categories, <xref rid="s10" ref-type="sec">Supplementary Figure S2</xref> corresponds to models with random intercepts, while <xref rid="s10" ref-type="sec">Supplementary Figure S3</xref> presents models with both random intercepts and random slopes. Similarly, <xref rid="s10" ref-type="sec">Supplementary Figure S4</xref> corresponds to models with random intercepts with five categories; <xref rid="s10" ref-type="sec">Supplementary Figure S5</xref> is about models with both random intercepts and random slopes with five categories. The conclusions are similar to those of independent data. In addition, we observe that given a simulation scenario, a choice of kernel and an effect size, when the variance of the random effect (elements in <bold><italic>G</italic></bold>
<sub><italic>jj</italic></sub> in <xref rid="e13" ref-type="disp-formula">Eq. 13</xref>) increases, the statistical power decreases. It is because with the increase of the random effects, the within-cluster correlation increases, leading to a lower effective sample size.</p>
        <table-wrap position="float" id="T2">
          <label>TABLE 2</label>
          <caption>
            <p>Empirical type I errors of MiRKAT-MC for clustered data with a random intercept and a random slope model with three-category outcomes.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th colspan="3" align="center" rowspan="1"><italic>n</italic> = 30 (<italic>N</italic> = 105)</th>
                <th colspan="3" align="center" rowspan="1"><italic>n</italic> = 60 (<italic>N</italic> = 210)</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">
                  <italic>g</italic>
                </th>
                <th align="char" char="." rowspan="1" colspan="1">0.25</th>
                <th align="char" char="." rowspan="1" colspan="1">1</th>
                <th align="char" char="." rowspan="1" colspan="1">4</th>
                <th align="char" char="." rowspan="1" colspan="1">0.25</th>
                <th align="char" char="." rowspan="1" colspan="1">1</th>
                <th align="char" char="." rowspan="1" colspan="1">4</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td colspan="7" align="left" rowspan="1">MiRKAT-MCN</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>w</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0498</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0492</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0467</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0478</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0496</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0484</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>u</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0521</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0533</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0486</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0449</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0508</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0478</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>BC</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0519</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0542</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0494</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0522</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0478</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0497</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>5</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0527</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0516</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0521</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0521</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0468</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0505</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> HMP</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0514</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0533</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0472</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0465</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0478</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0488</td>
              </tr>
              <tr>
                <td colspan="7" align="left" rowspan="1">MiRKAT-MCO</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>w</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0500</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0473</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0474</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0449</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0498</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0457</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>u</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0486</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0506</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0487</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0483</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0483</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0538</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>BC</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0535</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0507</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0487</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0453</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0493</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0485</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> K<sub>5</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0519</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0471</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0489</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0476</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0501</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0486</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"> HMP</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0495</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0467</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0481</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0452</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0483</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0475</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p><italic>n</italic> indicates the number of clusters while <italic>N</italic> is the number of total observations. <italic>g</italic> denotes the variance of random effects. The definition of K<sub>w</sub>, K<sub>u</sub>, K<sub>BC</sub>, K<sub>5</sub>, and HMP is the same as <xref rid="T1" ref-type="table">Table 1</xref>.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
    <sec id="s3-2">
      <title>3.2 Real Data Analysis</title>
      <sec id="s3-2-1">
        <title>3.2.1 Associations Between Antibiotic Exposure and Gut Microbiome in Non-Obese Diabetic Mice in a Longitudinal Study</title>
        <p>In the original study (<xref rid="B20" ref-type="bibr">Livanos et al., 2016</xref>), 555 non-obese diabetic mice were randomly assigned to three groups with each group exposed to distinct patterns and doses of antibiotics. The mice that were born to the same female and that were of the same sex constituted a cluster and each cluster received the same treatment. The first group (51 clusters, 203 mice) received sub-therapeutic continuous (STAT) antibiotic exposure, the second group (42 clusters, 167 mice) received therapeutic-dose pulsed (PAT) antibiotic exposure, and the last group (47 clusters, 135 mice) was not exposed to antibiotics and served as the control group (<xref rid="B13" ref-type="bibr">Hu et al., 2020</xref>). Microbiome data from fecal, cecal or ileal samples were collected longitudinally for each cluster by sacrificing a mouse, at 3, 6, 10, and 13 weeks from the start of the experiment (week 0). The number of observations per cluster varied from 2 (i.e., at week 3 and 6) to 4 (i.e., at week 3, 6, 10, and 13).</p>
        <p>The goal of this application is to test the association between treatment groups (STAT, PAT or control) and gut microbiome. Here, we exclusively analyzed the fecal samples, leaving 499 samples from 140 clusters over time. The gut microbiome was profiled from each sample and the raw sequence data is available on the Qiita database (study ID 10508). Specifically, the V4 region of the bacterial 16S rRNA gene was PCR amplified, followed by performing paired-end sequencing of the amplicon library. We reprocessed the pre-joined and trimmed sequencing data through DADA2 pipeline in R (<xref rid="B3" ref-type="bibr">Callahan et al., 2016</xref>). As a result, the amplicon sequence variant (ASV) table was constructed. After removing chimeras identified by consensus across samples, the table contained 3031 ASVs. The ASV table was rarefied to an equal depth of 5,000 for each sample. We then assigned taxonomy based on Ribosomal Database Project’s (RDP) training set 16, and constructed a phylogenetic tree using R package “phangorn” (<xref rid="B28" ref-type="bibr">Schliep, 2010</xref>). The tree was rooted by specifying the middle tip (i.e., 1515) as the outgroup. We calculated the UniFrac distance based on the rooted tree and the rarefied ASV table with the “GUniFrac” R package (<xref rid="B7" ref-type="bibr">Chen et al., 2012</xref>).</p>
        <p>Here we first visually checked the relationship between gut microbiome composition and antibiotic treatment groups under different dissimilarity measures with PCoA plots (<xref rid="F2" ref-type="fig">Figure 2</xref>). All 499 fecal samples are included in the plot, although they might be collected at different time points. Microbiome composition of the PAT group is clearly separated from that of the STAT group and that of the control group, under weighted UniFrac distance, generalized UniFrac distance and Bray-Curtis dissimilarity. However, under unweighted UniFrac distance, it is hard to distinguish the microbiome compositions of three treatment groups since they are clustered at two areas.</p>
        <fig position="float" id="F2">
          <label>FIGURE 2</label>
          <caption>
            <p>The two-dimensional PCoA plots depicting microbiome composition for different antibiotic treatment groups under various dissimilarity measures. All 499 fecal samples are included in the plots. PAT, therapeutic-dose pulsed antibiotic exposure; STAT, sub-therapeutic continuous antibiotic exposure. The crosses denote the centroid of points of each treatment group. <bold>(A)</bold> W.UniFrac: weighted UniFrac distance; <bold>(B)</bold> U.UniFrac: unweighted UniFrac distance; <bold>(C)</bold> G.UniFrac(0.5): generalized UniFrac distance with tuning parameter <italic>a</italic> = 0.5; <bold>(D)</bold> Bray-Curtis: Bray-Curtis dissimilarity.</p>
          </caption>
          <graphic xlink:href="fgene-13-841764-g002" position="float"/>
        </fig>
        <p>To show the performance of MiRKAT-MCN on independent nominal data, we selected samples at week 3 only. All 140 clusters had microbiome data available. By setting treatment groups as the dependent variable and adjusting for gender of mice, we observed very significant association between gut microbiome and the antibiotic treatment groups using weighted, unweighted, and generalized UniFrac kernels, Bray-Curtis kernel, and the omnibus test (all <italic>p</italic>-values <inline-formula id="inf57"><mml:math id="m71" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:math></inline-formula>). To better show the performance of the proposed model, and since the sample sizes of microbiome studies are usually smaller, we randomly subsampled 90 samples from the 140 samples at week 3. The down-sampled data consisted of 41 male and 49 female mice, and there were 36, 22, and 32 mice in the STAT, PAT and control groups, respectively. With the reduced sample size, all tests, including the tests using each of the kernels and the omnibus test, identified significant association between microbiome and antibiotic treament, with all <italic>p</italic>-values less than 0.0001, except for when using the unweighted kernel (<italic>p</italic>-value = 0.01).</p>
        <p>We also applied MiRKAT-MCN for clustered data to this study. Similarly, we randomly selected 30 clusters with 105 samples (17 male and 13 female mice clusters) from the original dataset for analysis, where there were 15, 6, and 9 clusters in STAT, PAT, and control group, respectively. We applied MiRKAT-MCN for clustered data to evaluate the association between antibiotic treatment and microbiome, adjusting for sex and time (in weeks), and accounting for the cluster-specific correlation through a random intercept and a random slope of time. Again, we employed the same kernels as above and the omnibus test for analysis. Apart from the test using the unweighted UniFrac kernel with <italic>p</italic>-value only 0.03, all other tests were highly significant with <italic>p</italic>-values less than 0.001.</p>
        <p>These two analyses indicate that antibiotic exposure during early life did alter the microbiome composition in non-obese diabetic mice, no matter we stared at the week 3 or inspected over time. Moreover, the disparities of <italic>p</italic>-values by using different kernels, although all significant, suggest that the antibiotic use may have affected the relative abundance of OTUs, because the unweighted UniFrac kernel, which only accounts presence/absence of taxa and gives higher weight to rare taxa, provides the least significant result.</p>
      </sec>
      <sec id="s3-2-2">
        <title>3.2.2 Associations Between Obesity and Gut Microbiome in a Family-Based Study</title>
        <p>A study was conducted by Goodrich et al. (<xref rid="B11" ref-type="bibr">Goodrich et al., 2014</xref>) to investigate the role of host genetics on gut microbiome, and their impact on host phenotype, such as the body mass index (BMI). Fecal samples were collected from families in the United Kingdom. The V4 region of 16S rRNA gene was sequenced to identify the microbiome composition. The raw data was downloaded from the European Bioinformatics Institute (EBI) with accession numbers ERP006339 and ERP006342. We used QIIME (version 1.9.0-dev) (<xref rid="B4" ref-type="bibr">Caporaso et al., 2010</xref>) to assign the sequencing tags to 7,365 non-singleton OTUs at 97<italic>%</italic> similarity using the reference-based OTU-picking approach, and to generate a rooted phylogenetic tree. All samples were rarefied to 10,000 counts per sample before calculating the distance measures.</p>
        <p>For this analysis, we focused on 311 samples from 145 monozygotic twin pairs. All the twins were female, aged from 27 to 83 with an median age of 63. In order to compare the performance of different methods, we treated the BMI as continuous, binary, three-category ordinal and three-category nominal data, and applied CSKAT (<xref rid="B37" ref-type="bibr">Zhan et al., 2018</xref>), GLMM-MiRKAT (<xref rid="B15" ref-type="bibr">Koh et al., 2019</xref>), MiRKAT-MCO and MiRKAT-MCN for each outcome type, respectively. CSKAT was developed for microbiome association analysis of clustered/longitudinal study for continuous outcomes while GLMM-MiRKAT was for the similar association analysis for binary and count outcomes, respectively. For binary outcome, we classified the study participants into a non-obese (248 samples) and an obese group (63 samples) based on BMI <inline-formula id="inf58"><mml:math id="m72" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 30 or BMI ≥30. For the three-category outcome, we classify study participants into normal (BMI <inline-formula id="inf59"><mml:math id="m73" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 25), overweight (25 ≤ BMI <inline-formula id="inf60"><mml:math id="m74" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 30), and obese (BMI ≥30) groups, where there were 147, 101, and 63 samples in each group, respectively. We can treat the three categories as nominal or ordinal when applying MiRKAT-MC. For all the analyses, we assessed the microbiome-BMI (or BMI category) association, adjusting for age and including a twin-level random intercept to capture the within-twin-pair correlations due to common genetic, biological and other environmental factors. The weighted, unweighted, generalized UniFrac distance and the Bray-Curtis distance were used to construct kernel functions based on <xref rid="e7" ref-type="disp-formula">Eq. 7</xref>. The test statistics of CSKAT and GLMM-MiRKAT followed the original papers, but we used the same technique as MiRKAT-MC to calculate <italic>p</italic>-values, in order to ensure comparability.</p>
        <p><xref rid="F3" ref-type="fig">Figure 3</xref> compares the microbiome Shannon index across the three BMI categories. The decreasing trend of Shannon index from the normal category to the obese category implies that higher BMI may reduce the microbiome diversity. The results of association analyses are shown in <xref rid="T3" ref-type="table">Table 3</xref>, where the smallest significant <italic>p</italic>-value of each kernel across four methods is bolded. At the first glance, all the individual tests provided significant association at type I error of 0.05 except when the weighted UniFrac kernel was used. The omnibus test also provided significant association. However, MiRKAT-MCO gave the smallest <italic>p</italic>-values when using the unweighted UniFrac, the generalized UniFrac and the omnibus test. MiRKAT-MCO was always more powerful than MiRKAT-MCN in this analysis, which is reasonable because MiRKAT-MCO utilized the order information in data. Both MiRKAT-MCO and MiRKAT-MCN were more powerful than GLMM-MiRKAT except when the weighted UniFrac kernel was used, for which none of the methods was significant. Our results are also consistent with the conclusion of the previous study (<xref rid="B37" ref-type="bibr">Zhan et al., 2018</xref>) that the unweighted UniFrac kernel and the Bray-Curtis kernel were most suitable for this dataset.</p>
        <fig position="float" id="F3">
          <label>FIGURE 3</label>
          <caption>
            <p>The boxplot of Shannon index across BMI categories in United Kingdom twins study. Normal: BMI <inline-formula id="inf61"><mml:math id="m75" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 25; Overweight: 25 ≤ BMI <inline-formula id="inf62"><mml:math id="m76" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 30; Obese: BMI ≥30. The circle on each box denotes the mean of Shannon Index in that category.</p>
          </caption>
          <graphic xlink:href="fgene-13-841764-g003" position="float"/>
        </fig>
        <table-wrap position="float" id="T3">
          <label>TABLE 3</label>
          <caption>
            <p><italic>p</italic>-values of testing for the BMI-microbiome association in United Kingdom twins dataset using different methods and kernels.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">CSKAT</th>
                <th align="center" rowspan="1" colspan="1">GLMM-MiRKAT-Binary</th>
                <th align="center" rowspan="1" colspan="1">MiRKAT-MCO</th>
                <th align="center" rowspan="1" colspan="1">MiRKAT-MCN</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>w</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1455</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1750</td>
                <td align="char" char="." rowspan="1" colspan="1">0.2223</td>
                <td align="char" char="." rowspan="1" colspan="1">0.3268</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>u</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0036</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0182</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0014</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0033</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>BC</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0012</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0021</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0016</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0015</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K<sub>5</sub>
</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0278</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0370</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0194</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0264</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HMP</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0036</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0075</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.0030</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.0040</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>The bold value is the smallest significant <italic>p</italic>-value across four methods given the kernel/method. The definition of K<sub>w</sub>, K<sub>u</sub>, K<sub>BC</sub>, K<sub>5</sub>, and HMP is the same as <xref rid="T1" ref-type="table">Table 1</xref>.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>4 Discussion</title>
    <p>Multi-categorical outcomes, both nominal and ordinal, are increasingly common in biological and biomedical research over recent years. Investigating the subtle microbiome composition differences among multiple subtypes of a disease provides a broad view of microbiome variation. It is typically a first step to a further study of microbiome functionality and other related topics. Additionally, clustered designs, as a supplement to population-based studies, have become very popular recently when researchers are interested in dynamic variations or the variations among related individuals. While the toolbox for analyzing data collected from population-based studies is plentiful, methods for analyzing these clustered data are underdeveloped. To fill these research gaps, we proposed MiRKAT-MC for testing for association between multi-categorical outcomes and microbial community compositions for both population-based and clustered/longitudinal studies.</p>
    <p>Our major contributions in this paper are two-fold. First, we have successfully used the generalized logit model and the proportional odds model to enable direct association analysis between multi-categorical outcomes and microbiome compositions, without the need of combining categories or conducting pairwise comparisons. Existing approaches either compare two categories at a time and then conduct multiple testing correction, or combine multiple groups into a single category and compare it to the baseline. The pair-wise comparison approach tends to lose power due to the burden of multiple comparison. In addition, combining multiple groups into a single category can lead to substantial power loss when the microbiome effects on the categories are in opposite directions. However, when we have more than two categories, MiRKAT-MC can incorporate the heterogeneity in microbiome data and compare all non-reference categories to the reference category. Comparing to the potential alternative approach that first compares each pair of categories followed by multiple comparison adjustment, MiRKAT-MC would be much more powerful. Moreover, the new association analysis framework in the proportional odds model is extremely appealing for ordinal outcome data, as none of the existing approaches takes advantage of the order information in this particular type of data. Second, we have adapted a fast pseudo-permutation strategy previously developed under linear models to more complicated GLM(M) and POM(M) to achieve efficient and accurate <italic>p</italic>-values calculation. Unlike the ascendants which calculate <italic>p</italic>-values through either asymptotic distribution or direct permutation among exchangeable clusters, MiRKAT-MC controls type I error perfectly, even when the sample size is small, yet avoids the time-consuming and complex permutation.</p>
    <p>As a non-parametric distance-based method, MiRKAT-MC comes with some limitations. First of all, the choice of distance metrics is subjective and could impact its performance. To this point, we propose to conduct analysis using multiple kernels/distances, generate multiple <italic>p</italic>-values and combine them via the harmonic mean approach (<xref rid="B31" ref-type="bibr">Wilson, 2019</xref>). Secondly, like other community level analysis of microbiome (<xref rid="B1" ref-type="bibr">Anderson, 2001</xref>; <xref rid="B39" ref-type="bibr">Zhao et al., 2015</xref>; <xref rid="B30" ref-type="bibr">Tang et al., 2016</xref>; <xref rid="B15" ref-type="bibr">Koh et al., 2019</xref>), MiRKAT-MC aggregates information across all taxa to form a community level test. This usually serves as the first step in understanding microbiome-phenotype relationship. However, these approaches do not provide insight on which taxa are driving the overall association. Thirdly, we used microbiome beta-diversity to define our distance/kernel matrix, which is convenient and proven useful. Many beta-diversities have been proposed and widely used in microbiome studies, which capture distinct characteristics of the underlying association pattern (see (<xref rid="B25" ref-type="bibr">Plantinga et al., 2017</xref>)). However, recent literature indicated that the structure of microbiome community may vary even when their diversities and compositions are comparable. In that context, if we are able to develop a sample-to-sample distance matrix that captures the important structure variations, such distance can be easily incorporated into our framework. Developing a kernel/distance for subtle structural differences in microbiome communities can be an interesting scientific endeavor, however, it is beyond the scope of this paper.</p>
    <p>Computational efficiency of MiRKAT-MC is investigated and reported in <xref rid="T4" ref-type="table">Table 4</xref>. MiRKAT-MC is extremely fast when dealing with independent data. When data is clustered, the computational time increases substantially, mainly because of the increased time in fitting the null GLMM/POMM in the presence of random effects. Nevertheless, the computational time for MiRKAT-MC is very manageable even with clustered data. Given that most microbiome studies are relatively small in sample size, for three-category data, MiRKAT-MC can usually be accomplished in 0.1 s for population-based studies with sample size less than 200, and in 7 s for clustered studies with total sample size less than 210.</p>
    <table-wrap position="float" id="T4">
      <label>TABLE 4</label>
      <caption>
        <p>Computation efficiency of MiRKAT-MC. Each result is the average time of one association test averaged from running 100 replicate association tests.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead valign="top">
          <tr>
            <th colspan="2" align="left" rowspan="1"/>
            <th align="center" rowspan="1" colspan="1">MiRKAT-MCN (s)</th>
            <th align="center" rowspan="1" colspan="1">MiRKAT-MCO (s)</th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td colspan="2" align="left" rowspan="1">Independent data</td>
            <td align="left" rowspan="1" colspan="1"/>
            <td align="left" rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="2" align="left" colspan="1"> <italic>J</italic> = 3</td>
            <td align="left" rowspan="1" colspan="1"><italic>N</italic> = 80</td>
            <td align="char" char="." rowspan="1" colspan="1">0.0150</td>
            <td align="char" char="." rowspan="1" colspan="1">0.0139</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1"><italic>N</italic> = 200</td>
            <td align="char" char="." rowspan="1" colspan="1">0.0914</td>
            <td align="char" char="." rowspan="1" colspan="1">0.0796</td>
          </tr>
          <tr>
            <td rowspan="2" align="left" colspan="1"> <italic>J</italic> = 5</td>
            <td align="left" rowspan="1" colspan="1"><italic>N</italic> = 150</td>
            <td align="char" char="." rowspan="1" colspan="1">0.0978</td>
            <td align="char" char="." rowspan="1" colspan="1">0.0426</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1"><italic>N</italic> = 300</td>
            <td align="char" char="." rowspan="1" colspan="1">0.7627</td>
            <td align="char" char="." rowspan="1" colspan="1">0.2568</td>
          </tr>
          <tr>
            <td colspan="2" align="left" rowspan="1">Longitudinal data</td>
            <td align="left" rowspan="1" colspan="1"/>
            <td align="left" rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="2" align="left" colspan="1"> <italic>J</italic> = 3</td>
            <td align="left" rowspan="1" colspan="1"><italic>n</italic> = 30 (<italic>N</italic> = 105)</td>
            <td align="char" char="." rowspan="1" colspan="1">6.438</td>
            <td align="char" char="." rowspan="1" colspan="1">2.844</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1"><italic>n</italic> = 60 (<italic>N</italic> = 210)</td>
            <td align="char" char="." rowspan="1" colspan="1">6.672</td>
            <td align="char" char="." rowspan="1" colspan="1">2.994</td>
          </tr>
          <tr>
            <td rowspan="2" align="left" colspan="1"> <italic>J</italic> = 5</td>
            <td align="left" rowspan="1" colspan="1"><italic>n</italic> = 50 (<italic>N</italic> = 175)</td>
            <td align="char" char="." rowspan="1" colspan="1">11.964</td>
            <td align="char" char="." rowspan="1" colspan="1">4.758</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1"><italic>n</italic> = 100 (<italic>N</italic> = 350)</td>
            <td align="char" char="." rowspan="1" colspan="1">26.328</td>
            <td align="char" char="." rowspan="1" colspan="1">15.252</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn>
          <p>For longitudinal data, both random intercepts and random slopes of time are included in the null models. The weighted UniFrac kernel was applied without loss of generalization. <italic>n</italic> denotes the number of clusters, whereas <italic>N</italic> is the total sample size. All the computation was conducted on a Macbook Pro (15-inch, 2019) laptop with 2.3 GHz 8-Core Intel Core i9 processor and 16 GB memory, without using parallel or other speed-up strategies.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>In summary, we propose MiRKAT-MC, a microbiome regression association test for multi-categorical outcomes with independent and clustered study designs. The proposed methods show well controlled type I errors and high power over multiple scenarios through extensive simulations and better performance than competitors in real data analyses. It is easy to use and fast to compute. We believe that MiRKAT-MC will enrich the toolbox of researchers to conduct microbiome research with multi-categorical outcomes.</p>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>The original contributions presented in the study are included in the article/<xref rid="s10" ref-type="sec">Supplementary Material</xref>, further inquiries can be directed to the corresponding authors.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>ZJ developed the method, conducted the simulation studies and real data applications, wrote the manuscript and the R program. MH and JC preprocessed the real data. XZ and NZ conceived the study and critically reviewed the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec id="s7">
    <title>Funding</title>
    <p>This study was supported in part by NIH for the Environmental Influences of Child Health Outcomes 531 (ECHO) Data Analysis Center (U24OD023382) and by Mayo Clinic Center for Individualized Medicine.</p>
  </sec>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors, and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec id="s10">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fgene.2022.841764/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fgene.2022.841764/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SM1" position="float" content-type="local-data">
      <media xlink:href="Image3.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM2" position="float" content-type="local-data">
      <media xlink:href="Image1.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM3" position="float" content-type="local-data">
      <media xlink:href="Image4.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM4" position="float" content-type="local-data">
      <media xlink:href="Image2.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM5" position="float" content-type="local-data">
      <media xlink:href="Image5.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM6" position="float" content-type="local-data">
      <media xlink:href="DataSheet1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>M. J.</given-names></name></person-group> (<year>2001</year>). <article-title>A New Method for Non-parametric Multivariate Analysis of Variance</article-title>. <source>Austral Ecol.</source>
<volume>26</volume>, <fpage>32</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1111/j.1442-9993.2001.01070.pp.x</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>J. R.</given-names></name><name><surname>Curtis</surname><given-names>J. T.</given-names></name></person-group> (<year>1957</year>). <article-title>An Ordination of the upland forest Communities of Southern wisconsin</article-title>. <source>Ecol. Monogr.</source>
<volume>27</volume>, <fpage>325</fpage>–<lpage>349</lpage>. <pub-id pub-id-type="doi">10.2307/1942268</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callahan</surname><given-names>B. J.</given-names></name><name><surname>McMurdie</surname><given-names>P. J.</given-names></name><name><surname>Rosen</surname><given-names>M. J.</given-names></name><name><surname>Han</surname><given-names>A. W.</given-names></name><name><surname>Johnson</surname><given-names>A. J. A.</given-names></name><name><surname>Holmes</surname><given-names>S. P.</given-names></name></person-group> (<year>2016</year>). <article-title>DADA2: High-Resolution Sample Inference from Illumina Amplicon Data</article-title>. <source>Nat. Methods</source>
<volume>13</volume>, <fpage>581</fpage>–<lpage>583</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>
<pub-id pub-id-type="pmid">27214047</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>J. G.</given-names></name><name><surname>Kuczynski</surname><given-names>J.</given-names></name><name><surname>Stombaugh</surname><given-names>J.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Bushman</surname><given-names>F. D.</given-names></name><name><surname>Costello</surname><given-names>E. K.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Qiime Allows Analysis of High-Throughput Community Sequencing Data</article-title>. <source>Nat. Methods</source>
<volume>7</volume>, <fpage>335</fpage>–<lpage>336</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
<pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlson</surname><given-names>E. S.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Custers-Allen</surname><given-names>R.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Sinha</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Disordered Microbial Communities in the Upper Respiratory Tract of Cigarette Smokers</article-title>. <source>PloS one</source>
<volume>5</volume>, <fpage>e15216</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0015216</pub-id>
<pub-id pub-id-type="pmid">21188149</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>E. Z.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2016</year>). <article-title>A Two-Part Mixed-Effects Model for Analyzing Longitudinal Microbiome Compositional Data</article-title>. <source>Bioinformatics</source>
<volume>32</volume>, <fpage>2611</fpage>–<lpage>2617</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw308</pub-id>
<pub-id pub-id-type="pmid">27187200</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Charlson</surname><given-names>E. S.</given-names></name><name><surname>Hoffmann</surname><given-names>C.</given-names></name><name><surname>Lewis</surname><given-names>J.</given-names></name><name><surname>Wu</surname><given-names>G. D.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Associating Microbiome Composition with Environmental Covariates Using Generalized Unifrac Distances</article-title>. <source>Bioinformatics</source>
<volume>28</volume>, <fpage>2106</fpage>–<lpage>2113</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts342</pub-id>
<pub-id pub-id-type="pmid">22711789</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Chen</surname><given-names>W.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Schaid</surname><given-names>D. J.</given-names></name></person-group> (<year>2016</year>). <article-title>Small Sample Kernel Association Tests for Human Genetic and Microbiome Association Studies</article-title>. <source>Genet. Epidemiol.</source>
<volume>40</volume>, <fpage>5</fpage>–<lpage>19</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.21934</pub-id>
<pub-id pub-id-type="pmid">26643881</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flores</surname><given-names>G. E.</given-names></name><name><surname>Caporaso</surname><given-names>J. G.</given-names></name><name><surname>Henley</surname><given-names>J. B.</given-names></name><name><surname>Rideout</surname><given-names>J. R.</given-names></name><name><surname>Domogala</surname><given-names>D.</given-names></name><name><surname>Chase</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Temporal Variability Is a Personalized Feature of the Human Microbiome</article-title>. <source>Genome Biol.</source>
<volume>15</volume>, <fpage>531</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-014-0531-y</pub-id>
<pub-id pub-id-type="pmid">25517225</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>J. A.</given-names></name><name><surname>Blaser</surname><given-names>M. J.</given-names></name><name><surname>Caporaso</surname><given-names>J. G.</given-names></name><name><surname>Jansson</surname><given-names>J. K.</given-names></name><name><surname>Lynch</surname><given-names>S. V.</given-names></name><name><surname>Knight</surname><given-names>R.</given-names></name></person-group> (<year>2018</year>). <article-title>Current Understanding of the Human Microbiome</article-title>. <source>Nat. Med.</source>
<volume>24</volume>, <fpage>392</fpage>–<lpage>400</lpage>. <pub-id pub-id-type="doi">10.1038/nm.4517</pub-id>
<pub-id pub-id-type="pmid">29634682</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodrich</surname><given-names>J. K.</given-names></name><name><surname>Waters</surname><given-names>J. L.</given-names></name><name><surname>Poole</surname><given-names>A. C.</given-names></name><name><surname>Sutter</surname><given-names>J. L.</given-names></name><name><surname>Koren</surname><given-names>O.</given-names></name><name><surname>Blekhman</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Human Genetics Shape the Gut Microbiome</article-title>. <source>Cell</source>
<volume>159</volume>, <fpage>789</fpage>–<lpage>799</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2014.09.053</pub-id>
<pub-id pub-id-type="pmid">25417156</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Q.</given-names></name><name><surname>Liu</surname><given-names>Y.</given-names></name><name><surname>Liu</surname><given-names>M.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Hsu</surname><given-names>L.</given-names></name></person-group> (<year>2021</year>). <article-title>Random Effect Based Tests for Multinomial Logistic Regression in Genetic Association Studies</article-title>. <source>Genet. Epidemiol.</source>
<volume>45</volume>, <fpage>736</fpage>–<lpage>740</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22427</pub-id>
<pub-id pub-id-type="pmid">34403161</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J.</given-names></name><name><surname>Wang</surname><given-names>C.</given-names></name><name><surname>Blaser</surname><given-names>M. J.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2020</year>). <article-title>Joint Modeling of Zero‐inflated Longitudinal Proportions and Time‐to‐event Data with Application to a Gut Microbiome Study</article-title>. <source>Biometrics</source>. [<comment>Epub-ahead of prin</comment>]. <pub-id pub-id-type="doi">10.1111/biom.13515</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>H.</given-names></name><name><surname>Ling</surname><given-names>Z.</given-names></name><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Mao</surname><given-names>H.</given-names></name><name><surname>Ma</surname><given-names>Z.</given-names></name><name><surname>Yin</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>Altered Fecal Microbiota Composition in Patients with Major Depressive Disorder</article-title>. <source>Brain Behav. Immun.</source>
<volume>48</volume>, <fpage>186</fpage>–<lpage>194</lpage>. <pub-id pub-id-type="doi">10.1016/j.bbi.2015.03.016</pub-id>
<pub-id pub-id-type="pmid">25882912</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koh</surname><given-names>H.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name></person-group> (<year>2019</year>). <article-title>A Distance-Based Kernel Association Test Based on the Generalized Linear Mixed Model for Correlated Microbiome Studies</article-title>. <source>Front. Genet.</source>
<volume>10</volume>, <fpage>458</fpage>. <pub-id pub-id-type="doi">10.3389/fgene.2019.00458</pub-id>
<pub-id pub-id-type="pmid">31156711</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kostic</surname><given-names>A. D.</given-names></name><name><surname>Chun</surname><given-names>E.</given-names></name><name><surname>Robertson</surname><given-names>L.</given-names></name><name><surname>Glickman</surname><given-names>J. N.</given-names></name><name><surname>Gallini</surname><given-names>C. A.</given-names></name><name><surname>Michaud</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2013a</year>). <article-title>Fusobacterium Nucleatum Potentiates Intestinal Tumorigenesis and Modulates the Tumor-Immune Microenvironment</article-title>. <source>Cell Host &amp; Microbe</source>
<volume>14</volume>, <fpage>207</fpage>–<lpage>215</lpage>. <pub-id pub-id-type="doi">10.1016/j.chom.2013.07.007</pub-id>
<pub-id pub-id-type="pmid">23954159</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kostic</surname><given-names>A. D.</given-names></name><name><surname>Howitt</surname><given-names>M. R.</given-names></name><name><surname>Garrett</surname><given-names>W. S.</given-names></name></person-group> (<year>2013b</year>). <article-title>Exploring Host-Microbiota Interactions in Animal Models and Humans</article-title>. <source>Genes Dev.</source>
<volume>27</volume>, <fpage>701</fpage>–<lpage>718</lpage>. <pub-id pub-id-type="doi">10.1101/gad.212522.112</pub-id>
<pub-id pub-id-type="pmid">23592793</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>D.</given-names></name><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Ghosh</surname><given-names>D.</given-names></name></person-group> (<year>2007</year>). <article-title>Semiparametric Regression of Multidimensional Genetic Pathway Data: Least-Squares Kernel Machines and Linear Mixed Models</article-title>. <source>Biometrics</source>
<volume>63</volume>, <fpage>1079</fpage>–<lpage>1088</lpage>. <pub-id pub-id-type="doi">10.1111/j.1541-0420.2007.00799.x</pub-id>
<pub-id pub-id-type="pmid">18078480</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>M.</given-names></name><name><surname>Liu</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Hsu</surname><given-names>L.</given-names></name><name><surname>He</surname><given-names>Q.</given-names></name></person-group> (<year>2021</year>). <article-title>A Method for Subtype Analysis with Somatic Mutations</article-title>. <source>Bioinformatics</source>
<volume>37</volume>, <fpage>50</fpage>–<lpage>56</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1090</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Livanos</surname><given-names>A. E.</given-names></name><name><surname>Greiner</surname><given-names>T. U.</given-names></name><name><surname>Vangay</surname><given-names>P.</given-names></name><name><surname>Pathmasiri</surname><given-names>W.</given-names></name><name><surname>Stewart</surname><given-names>D.</given-names></name><name><surname>McRitchie</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Antibiotic-mediated Gut Microbiome Perturbation Accelerates Development of Type 1 Diabetes in Mice</article-title>. <source>Nat. Microbiol.</source>
<volume>1</volume>, <fpage>16140</fpage>. <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.140</pub-id>
<pub-id pub-id-type="pmid">27782139</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozupone</surname><given-names>C.</given-names></name><name><surname>Knight</surname><given-names>R.</given-names></name></person-group> (<year>2005</year>). <article-title>Unifrac: a New Phylogenetic Method for Comparing Microbial Communities</article-title>. <source>Appl. Environ. Microbiol.</source>
<volume>71</volume>, <fpage>8228</fpage>–<lpage>8235</lpage>. <pub-id pub-id-type="doi">10.1128/aem.71.12.8228-8235.2005</pub-id>
<pub-id pub-id-type="pmid">16332807</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naseribafrouei</surname><given-names>A.</given-names></name><name><surname>Hestad</surname><given-names>K.</given-names></name><name><surname>Avershina</surname><given-names>E.</given-names></name><name><surname>Sekelja</surname><given-names>M.</given-names></name><name><surname>Linløkken</surname><given-names>A.</given-names></name><name><surname>Wilson</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Correlation between the Human Fecal Microbiota and Depression</article-title>. <source>Neurogastroenterol. Motil.</source>
<volume>26</volume>, <fpage>1155</fpage>–<lpage>1162</lpage>. <pub-id pub-id-type="doi">10.1111/nmo.12378</pub-id>
<pub-id pub-id-type="pmid">24888394</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ni</surname><given-names>J.</given-names></name><name><surname>Shen</surname><given-names>T. D.</given-names></name><name><surname>Chen</surname><given-names>E. Z.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Bailey</surname><given-names>A.</given-names></name><name><surname>Roggiani</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>A Role for Bacterial Urease in Gut Dysbiosis and Crohn's Disease</article-title>. <source>Sci. Transl Med.</source>
<volume>9</volume>, e<fpage>aah6888</fpage>. <pub-id pub-id-type="doi">10.1126/scitranslmed.aah6888</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parikh</surname><given-names>I. J.</given-names></name><name><surname>Estus</surname><given-names>J. L.</given-names></name><name><surname>Zajac</surname><given-names>D. J.</given-names></name><name><surname>Malik</surname><given-names>M.</given-names></name><name><surname>Maldonado Weng</surname><given-names>J.</given-names></name><name><surname>Tai</surname><given-names>L. M.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Murine Gut Microbiome Association with Apoe Alleles</article-title>. <source>Front. Immunol.</source>
<volume>11</volume>, <fpage>200</fpage>. <pub-id pub-id-type="doi">10.3389/fimmu.2020.00200</pub-id>
<pub-id pub-id-type="pmid">32117315</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plantinga</surname><given-names>A.</given-names></name><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Jenq</surname><given-names>R. R.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name></person-group> (<year>2017</year>). <article-title>MiRKAT-S: a Community-Level Test of Association between the Microbiota and Survival Times</article-title>. <source>Microbiome</source>
<volume>5</volume>, <fpage>17</fpage>. <pub-id pub-id-type="doi">10.1186/s40168-017-0239-9</pub-id>
<pub-id pub-id-type="pmid">28179014</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scher</surname><given-names>J. U.</given-names></name><name><surname>Sczesnak</surname><given-names>A.</given-names></name><name><surname>Longman</surname><given-names>R. S.</given-names></name><name><surname>Segata</surname><given-names>N.</given-names></name><name><surname>Ubeda</surname><given-names>C.</given-names></name><name><surname>Bielski</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Expansion of Intestinal Prevotella Copri Correlates with Enhanced Susceptibility to Arthritis</article-title>. <source>elife</source>
<volume>2</volume>, <fpage>e01202</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.01202</pub-id>
<pub-id pub-id-type="pmid">24192039</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schirmer</surname><given-names>M.</given-names></name><name><surname>Denson</surname><given-names>L.</given-names></name><name><surname>Vlamakis</surname><given-names>H.</given-names></name><name><surname>Franzosa</surname><given-names>E. A.</given-names></name><name><surname>Thomas</surname><given-names>S.</given-names></name><name><surname>Gotman</surname><given-names>N. M.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Compositional and Temporal Changes in the Gut Microbiome of Pediatric Ulcerative Colitis Patients Are Linked to Disease Course</article-title>. <source>Cell Host &amp; Microbe</source>
<volume>24</volume>, <fpage>600</fpage>–<lpage>610</lpage>. <comment>e4</comment>. <pub-id pub-id-type="doi">10.1016/j.chom.2018.09.009</pub-id>
<pub-id pub-id-type="pmid">30308161</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schliep</surname><given-names>K. P.</given-names></name></person-group> (<year>2010</year>). <article-title>Phangorn: Phylogenetic Analysis in R</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>592</fpage>–<lpage>593</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq706</pub-id>
<pub-id pub-id-type="pmid">21169378</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schloss</surname><given-names>P. D.</given-names></name></person-group> (<year>2010</year>). <article-title>The Effects of Alignment Quality, Distance Calculation Method, Sequence Filtering, and Region on the Analysis of 16s Rrna Gene-Based Studies</article-title>. <source>Plos Comput. Biol.</source>
<volume>6</volume>, <fpage>e1000844</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000844</pub-id>
<pub-id pub-id-type="pmid">20628621</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Z.-Z.</given-names></name><name><surname>Chen</surname><given-names>G.</given-names></name><name><surname>Alekseyenko</surname><given-names>A. V.</given-names></name></person-group> (<year>2016</year>). <article-title>Permanova-s: Association Test for Microbial Community Composition that Accommodates Confounders and Multiple Distances</article-title>. <source>Bioinformatics</source>
<volume>32</volume>, <fpage>2618</fpage>–<lpage>2625</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw311</pub-id>
<pub-id pub-id-type="pmid">27197815</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>D. J.</given-names></name></person-group> (<year>2019</year>). <article-title>The Harmonic Mean P -value for Combining Dependent Tests</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>
<volume>116</volume>, <fpage>1195</fpage>–<lpage>1200</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1814092116</pub-id>
<pub-id pub-id-type="pmid">30610179</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>N.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Koh</surname><given-names>H.</given-names></name><name><surname>Fu</surname><given-names>W.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Mirkat: Kernel Machine Regression-Based Global Association Tests for the Microbiome</article-title>. <source>Bioinformatics</source>
<volume>37</volume>, <fpage>1595</fpage>–<lpage>1597</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa951</pub-id>
<pub-id pub-id-type="pmid">33225342</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolfinger</surname><given-names>R.</given-names></name><name><surname>O'connell</surname><given-names>M.</given-names></name></person-group> (<year>1993</year>). <article-title>Generalized Linear Mixed Models a Pseudo-likelihood Approach</article-title>. <source>J. Stat. Comput. Simulation</source>
<volume>48</volume>, <fpage>233</fpage>–<lpage>243</lpage>. <pub-id pub-id-type="doi">10.1080/00949659308811554</pub-id>
</mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Banerjee</surname><given-names>K.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name></person-group> (<year>2021</year>). <article-title>Variant‐set Association Test for Generalized Linear Mixed Model</article-title>. <source>Genet. Epidemiol.</source>
<volume>45</volume>, <fpage>402</fpage>–<lpage>412</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22378</pub-id>
<pub-id pub-id-type="pmid">33604919</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Tong</surname><given-names>X.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Maity</surname><given-names>A.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name></person-group> (<year>2017a</year>). <article-title>A Small-Sample Multivariate Kernel Machine Test for Microbiome Association Studies</article-title>. <source>Genet. Epidemiol.</source>
<volume>41</volume>, <fpage>210</fpage>–<lpage>220</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22030</pub-id>
<pub-id pub-id-type="pmid">28019040</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Plantinga</surname><given-names>A.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name></person-group> (<year>2017b</year>). <article-title>A Fast Small‐sample Kernel independence Test for Microbiome Community‐level Association Analysis</article-title>. <source>Biom</source>
<volume>73</volume>, <fpage>1453</fpage>–<lpage>1463</lpage>. <pub-id pub-id-type="doi">10.1111/biom.12684</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Xue</surname><given-names>L.</given-names></name><name><surname>Zheng</surname><given-names>H.</given-names></name><name><surname>Plantinga</surname><given-names>A.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Schaid</surname><given-names>D. J.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>A Small‐sample Kernel Association Test for Correlated Data with Application to Microbiome Association Studies</article-title>. <source>Genet. Epidemiol.</source>
<volume>42</volume>, <fpage>772</fpage>–<lpage>782</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22160</pub-id>
<pub-id pub-id-type="pmid">30218543</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Pei</surname><given-names>Y.-F.</given-names></name><name><surname>Zhang</surname><given-names>L.</given-names></name><name><surname>Guo</surname><given-names>B.</given-names></name><name><surname>Pendegraft</surname><given-names>A. H.</given-names></name><name><surname>Zhuang</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Negative Binomial Mixed Models for Analyzing Longitudinal Microbiome Data</article-title>. <source>Front. Microbiol.</source>
<volume>9</volume>, <fpage>1683</fpage>. <pub-id pub-id-type="doi">10.3389/fmicb.2018.01683</pub-id>
<pub-id pub-id-type="pmid">30093893</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Carroll</surname><given-names>I. M.</given-names></name><name><surname>Ringel-Kulka</surname><given-names>T.</given-names></name><name><surname>Epstein</surname><given-names>M. P.</given-names></name><name><surname>Zhou</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>Testing in Microbiome-Profiling Studies with Mirkat, the Microbiome Regression-Based Kernel Association Test</article-title>. <source>Am. J. Hum. Genet.</source>
<volume>96</volume>, <fpage>797</fpage>–<lpage>807</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.04.003</pub-id>
<pub-id pub-id-type="pmid">25957468</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
