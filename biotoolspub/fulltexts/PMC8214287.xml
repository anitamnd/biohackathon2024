<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8214287</article-id>
    <article-id pub-id-type="publisher-id">4184</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04184-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SVNN: an efficient PacBio-specific pipeline for structural variations calling using neural networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Akbarinejad</surname>
          <given-names>Shaya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hadadian Nejad Yousefi</surname>
          <given-names>Mostafa</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Goudarzi</surname>
          <given-names>Maziar</given-names>
        </name>
        <address>
          <email>goudarzi@sharif.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.412553.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 0740 9747</institution-id><institution>Department of Computer Engineering, </institution><institution>Sharif University of Technology, </institution></institution-wrap>Azadi Ave., Tehran, Iran </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>335</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Once aligned, long-reads can be a useful source of information to identify the type and position of structural variations. However, due to the high sequencing error of long reads, long-read structural variation detection methods are far from precise in low-coverage cases. To be accurate, they need to use high-coverage data, which in turn, results in an extremely time-consuming pipeline, especially in the alignment phase. Therefore, it is of utmost importance to have a structural variation calling pipeline which is both fast and precise for low-coverage data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we present SVNN, a fast yet accurate, structural variation calling pipeline for PacBio long-reads that takes raw reads as the input and detects structural variants of size larger than 50 bp. Our pipeline utilizes state-of-the-art long-read aligners, namely NGMLR and Minimap2, and structural variation callers, videlicet Sniffle and SVIM. We found that by using a neural network, we can extract features from Minimap2 output to detect a subset of reads that provide useful information for structural variation detection. By only mapping this subset with NGMLR, which is far slower than Minimap2 but better serves downstream structural variation detection, we can increase the sensitivity in an efficient way. As a result of using multiple tools intelligently, SVNN achieves up to 20 percentage points of sensitivity improvement in comparison with state-of-the-art methods and is three times faster than a naive combination of state-of-the-art tools to achieve almost the same accuracy.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">Since prohibitive costs of using high-coverage data have impeded long-read applications, with SVNN, we provide the users with a much faster structural variation detection platform for PacBio reads with high precision and sensitivity in low-coverage scenarios.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Structural variation calling</kwd>
      <kwd>PacBio</kwd>
      <kwd>Long reads</kwd>
      <kwd>Neural networks</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">The complete catalog of genetic variants can be categorized into single-nucleotide polymorphism (SNP), small insertions, and deletions (indels), and structural variations (SV). Structural variations like insertion, deletion, translocations, inversion, and duplications of size larger than 50bp have been associated with a plethora of human diseases and phenotypic traits [<xref ref-type="bibr" rid="CR1">1</xref>]. In particular, SVs are shown to contribute to different human diseases, including autism, Down syndrome, Alzheimer’s, and also play a pivotal role in the development of aggressive cancers [<xref ref-type="bibr" rid="CR2">2</xref>]. Despite their importance, characterization of this type of genetic variation lagged behind other forms of variation, e.g. single-nucleotide polymorphism [<xref ref-type="bibr" rid="CR3">3</xref>], thus developing new methods is needed.</p>
    <p id="Par16">Currently, SV calling tools mostly use short paired-end reads [<xref ref-type="bibr" rid="CR4">4</xref>]. The variations can be found by the abnormality in the distance between two reads in a pair, alteration in the coverage of a specific region, or split-mapped reads [<xref ref-type="bibr" rid="CR5">5</xref>]. However, the most salient disadvantage of short-read methods is their limited ability to span and find large SVs. The situation is exacerbated in repetitive regions of the genome and results in the lack of sensitivity, down to 10% [<xref ref-type="bibr" rid="CR6">6</xref>], and high false discovery rate, up to 89% [<xref ref-type="bibr" rid="CR7">7</xref>], in short-read tools. On the other hand, long reads are more confidently mapped to repetitive regions, where structural variations abound and are more likely to span breakpoints [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par17">The downside of long-read platforms is high sequencing error, e.g. up to 15% for Pacific Biosciences (PacBio) sequencers [<xref ref-type="bibr" rid="CR9">9</xref>]. As a result, to identify SV breakpoint coordinates, high-coverage reads are required, which in turn, make the alignment phase extremely time-consuming. Among the most notable long-read aligners such as NGMLR [<xref ref-type="bibr" rid="CR10">10</xref>], Minimap2 [<xref ref-type="bibr" rid="CR11">11</xref>], IMOS [<xref ref-type="bibr" rid="CR12">12</xref>], BWA-MEM [<xref ref-type="bibr" rid="CR13">13</xref>], and BLASR [<xref ref-type="bibr" rid="CR14">14</xref>], we found Minimap2 to be the fastest and NGMLR to be the most accurate for SV calling—particularly in finding translocations—though significantly slower than Minimap2. Based on our experiments, other aligners (BWA-MEM, and BLASR) were both slower and less accurate than NGMLR for the purpose of SV calling. After the alignment phase, a specialized long-read SV caller is needed to interpret SV’s footprints in alignment file. At this time, four of the most important tools for SV calling are SVIM [<xref ref-type="bibr" rid="CR15">15</xref>], Sniffles [<xref ref-type="bibr" rid="CR10">10</xref>], PBHoney [<xref ref-type="bibr" rid="CR16">16</xref>] and SMRT-SV [<xref ref-type="bibr" rid="CR17">17</xref>]. Among these SV calling tools, we found SVIM, and Sniffles to be the best in terms of their accuracy and the variety of types of SVs they can detect.</p>
    <p id="Par18">There are a number of softwares available that integrate both alignment and structural variation detection parts. Nanopype [<xref ref-type="bibr" rid="CR18">18</xref>] is one of them, which utilizes Minimap2, NGMLR, and GraphMap as the aligner and Sniffles as the SV detection tool. However, these pipelines can only use one of the mentioned tools at a time. We hypothesized that if we intelligently combine tools that are either fast or accurate, we can devise a new pipeline which is both fast and accurate. To achieve this feat, we gave all input reads to Minimap2, which is fast; and then we designed and used a neural network to identify only a subset of reads that are useful for SV detection from numerous features of the output of Minimap2. In the next step, only this subset is given to NGMLR, hence minimizing the hefty computational cost of NGMLR while taking advantage of the information it provides for SV detection tools. The logic behind our hypothesis was first, we investigated that only a small fraction of all reads (less than 1%) are used for SV detection, and second, these reads are usually mapped harder to the reference compared to normal reads and therefore might share some common characteristics which can be leveraged in a learning model. Furthermore, we figured out that if we use SVIM alongside Sniffles as SV caller, the sensitivity will be considerably higher in low-coverage situations without aggravating the false discovery rate.</p>
    <p id="Par19">In this paper, we present SVNN: a pipeline for SV detection that intelligently combines Minimap2 and NGMLR for the mapping phase, and SVIM and Sniffles for the SV calling phase. Consequently, the recall rate of our pipeline is considerably higher in low-coverage situations. Concretely, SVNN is up to 3 times faster than the case when we use NGMLR and Sniffles and shows a maximum of 15% recall improvement compared to the case when we utilize Minimap2 and Sniffles.</p>
    <p id="Par20">The heart of our method is a learning model which detects useful reads for structural variation detection and maps this subset of reads. The concept is not restricted to the tools. We chose these tools as they are today’s state of the arts. However, if more advance tools come for alignment or SV calling in the future, we can incorporate them into our platform by retraining the model.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par21">SVNN implements an efficient and accurate pipeline for the detection of structural variations, including indels, inversions, translocations, and duplications. It takes raw long-reads as input and detects SVs in Variant Call Format (VCF). By mapping all reads with Minimap2, and only a useful fragment of all reads with NGMLR, and then calling SVs with SVIM and Sniffles, we ensured SVNN to be precise and efficient at the same time.</p>
    <p id="Par22">We noted that only 0.7% of reads are split by NGMLR and these are the useful reads for SV detection. In other words, the aligning time of only this 0.7% of reads is necessary for SV detection, and the aligning time of the rest of 99.3% of the reads can be avoided for SV calling, as they do not provide useful information for this purpose. Therefore, we can utilize Minimap2 which is up to 10 times faster than NGMLR to map all reads, and then use a classifier to find a superset of reads that are not split by Minimap2 but would have been split by NGMLR (which we call them “informative reads”), and only align this superset of informative reads by NGMLR. We then feed the output of both NGMLR and Minimap2 to Sniffles and SVIM.<fig id="Fig1"><label>Fig. 1</label><caption><p>Baseline pipeline</p></caption><graphic xlink:href="12859_2021_4184_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par23">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the baseline pipeline, which consists of Minimap2 and Sniffles. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the pipeline of the most sensitive case, which maps all reads by Minimap2 and NGMLR, and then feeds their output to Sniffles and SVIM. In Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, golden-colored boxes represent stages that we devised to make the pipeline work. Finally, Fig. <xref rid="Fig3" ref-type="fig">3</xref> shows our pipeline (SVNN), which benefits of every tool while minimizing the overheads. In this pipeline, we first align reads by Minimap2, and then by using a neural network, we try to find informative reads and map only this small subset using NGMLR. Moreover, the sensitivity of combining NGMLR and Minimap2 is higher than utilizing each one separately; as a result, SVNN is more accurate than NGMLR, yet remarkably faster. We further observed by incorporating SVIM alongside Sniffles, the final results will be even better; therefore, we adopted both tools to improve the accuracy of SVNN. In the following, the 6 stages of our pipeline are thoroughly explained.<fig id="Fig2"><label>Fig. 2</label><caption><p>The most sensitive pipeline</p></caption><graphic xlink:href="12859_2021_4184_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>SVNN pipeline</p></caption><graphic xlink:href="12859_2021_4184_Fig3_HTML" id="MO3"/></fig></p>
    <sec id="Sec3">
      <title>Stages of the pipeline</title>
      <p id="Par24">Here we describe the different stages of our pipeline, which is presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
      <sec id="Sec4">
        <title>Map with Minimap2</title>
        <p id="Par25">In this stage, raw reads are mapped to the reference genome by Minimap2. Both reads and reference are defined by the user.</p>
      </sec>
      <sec id="Sec5">
        <title>Find informative reads</title>
        <p id="Par26">In this stage, some features are extracted from the output of the previous step. Subsequently, these features are fed to a pre-trained neural network to detect informative reads. Here, only a small subset of reads is selected to be given to NGMLR.</p>
        <p id="Par27">By exhaustive search through different hyperparameters of the neural network, we chose a neural network with five fully-connected hidden layers with 18, 30, 18, 11, and 5 neurons in each layer, and tanh as the activation function.</p>
        <p id="Par28">To select which features to use for the detection of informative reads, we first took advantage of SAM file tags, specified by Minimap2. These features include:<list list-type="bullet"><list-item><p id="Par29">s1: Chaining score</p></list-item><list-item><p id="Par30">s2: Chaining score of the best secondary chain</p></list-item><list-item><p id="Par31">cm: Number of minimizers on the chain</p></list-item><list-item><p id="Par32">NM: Total number of mismatches and gaps in the alignment</p></list-item><list-item><p id="Par33">AS: Alignment score</p></list-item></list>However, we saw that these features alone are not suitable indicators for informative read classification. Therefore, we extracted more features ourselves. Since informative reads are the reads that should have been split, we assumed that the alignment of these reads would be noisier compared to other reads. Therefore, we extracted these features:<list list-type="bullet"><list-item><p id="Par34">Total number of insertions.</p></list-item><list-item><p id="Par35">Total number of deletions.</p></list-item><list-item><p id="Par36">Total number of mismatches.</p></list-item><list-item><p id="Par37">Longest number of deletions, insertions, and mismatches in a row for a read.</p></list-item><list-item><p id="Par38">Longest number of deletions, insertions, and mismatches in a row with one match in between.</p></list-item><list-item><p id="Par39">Length of soft-clipped at two ends of the read.</p></list-item><list-item><p id="Par40">All aligned reads are divided into 100 bp bins. First, second, third, and fourth bins with the most number of insertions, deletions, and mismatches are selected, and their values are returned.</p></list-item><list-item><p id="Par41">Length of the read.</p></list-item></list>It is important to note that these features are location-independent, which means none of these features rely on the location of the reads. Therefore, if our training datasets are prone to have SVs in a specific location in the reference, it will not overfit to that location.</p>
        <p id="Par42">To train our network, we label informative reads 1 and label other reads 0. The goal of the neural network is to classify these reads.</p>
      </sec>
      <sec id="Sec6">
        <title>Map with NGMLR</title>
        <p id="Par43">In this stage, selected informative reads from the previous step and split reads of Minimap2 are given to NGMLR. Since Minimap2 split some reads wrongly, especially reads that span translocation, Minimap2 split reads are given to NGMLR as well.</p>
      </sec>
      <sec id="Sec7">
        <title>Unify Minimap2 and NGMLR outputs</title>
        <p id="Par44">As NGMLR and Minimap2 use different tags in the SAM file, we cannot simply combine their outputs; otherwise, samtools raise an error for converting SAM to BAM. As a result, these tags must become the same before combining them. After combining, the SAM file is converted to the BAM file with samtools.</p>
        <p id="Par45">This stage creates redundancy. In particular, a read might be split by both NGMLR and Minimap2. In this case, the SV detection tool would count this read as two separate reads that support an SV.</p>
      </sec>
      <sec id="Sec8">
        <title>Detect SVs by SVIM and Sniffles</title>
        <p id="Par46">BAM file generated from the last step is given separately to SVIM and Sniffles. This step, too, creates redundancy, as one SV can be detected by both Sniffles and SVIM.</p>
      </sec>
      <sec id="Sec9">
        <title>Filter redundant SVs</title>
        <p id="Par47">As we saw, steps 4 and 5 create redundancy. To be detected, each SV needs to be supported by a minimum number of supporting reads. When we combine Minimap2 and NGMLR outputs, some SVs might be supported 2 times by a single read. To resolve this, we count the number of unique supporting reads, and if this number is less than the minimum required supporting reads, we remove that SV.</p>
        <p id="Par48">Also, in step 5, an SV might be detected by both Sniffles and SVIM. To resolve this redundancy, those SVs that are of the same type and their difference in breakpoint location is less than 50 bp, are unified, and the SV with more number of supporting reads would be selected.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Experiments and results</title>
    <sec id="Sec11">
      <title>Preparing training and test data</title>
      <p id="Par49">For training of our neural network, we injected SVs to chromosomes 21 and 22 of hg 19 by SURVIVOR [<xref ref-type="bibr" rid="CR19">19</xref>]. We generated more than 16 references with SURVIVOR out of the original reference. Each of our references includes either indel, duplation, translocation, or inversion of length 80 to 1kbp, 1k to 10 kbp, 10k to 30kbp, and 30 to 50kb. Then, by PBSIM [<xref ref-type="bibr" rid="CR20">20</xref>], we generated PacBio-like reads with 20×, 30×, and 50× coverages. In total, we created 30 fastQ files that include PacBio-like reads from 16 references with SVs. Afterward, we mapped these 30 fastQ files with Minimap2 and NGMLR. We labeled reads that were not split by Minimap2 but were split by NGMLR by a ’1’ tag, and others by a ’0’ tag. Reads that were split by Minimap2 were removed because these reads are given to NGMLR anyway, and there is no need for the neural network to learn to classify these reads. We then extracted our desired features from each read and saved them with their corresponding label to a CSV file.</p>
      <p id="Par50">To test the performance of SVNN, we carried out two types of experiments. In the first type, we used the simulated reads mapped to the unchanged reference. We injected more than 800 SVs to chromosomes 21 and 22, 214 deletions, 186 insertions, 100 duplications, 100 inversions, and 200 translocations. Their length varies from 80 to 50kbp. Like before, we created PacBio-like reads with PBSIM, in 8×, 10×, and 12× coverages. To show our method also generalizes to chromosomes other than chromosomes 21 and 22, which the neural network was trained on, we injected 600 SVs, including 198 deletions, 202 insertions, 100 inversions, and 100 duplications to chromosome 1 and generated PacBio-like reads with 12× coverage. We mapped these reads with Minimap2 and extracted features to our trained neural network to classify reads. To evaluate the performance of the neural network on test sets, we mapped these reads with NGMLR as well.</p>
      <p id="Par51">Since simulation cannot precisely imitate real biological data, in the second part of our experiments we utilized the real PacBio reads of the NA12878 dataset. We selected those reads that were mapped to chromosome 21 and 22 with NGMLR, and among them, we sampled reads to produce a 12× coverage subset of the dataset. We injected 10 insertions and 10 deletions to the reference genome and mapped real reads to this altered genome. The task of the structural variation caller in this scenario is to find the inverse variation that was injected.</p>
    </sec>
    <sec id="Sec12">
      <title>Accuracy results</title>
      <p id="Par52">We compared SVNN with three other pipelines: the baseline, which is Minimap2-Sniffles combination, NGMLR-Sniffles combination, and the most sensitive method, which uses both NGMLR and Minimap2 as the aligner, and Sniffles and SVIM as SV caller. We measured two parameters for each pipeline: Sensitivity and False Discovery Rate (FDR). Sensitivity is the ratio of correctly detected SVs to all SVs, and FDR is falsely detected SVs to all detected SVs. An SV is detected correctly if its type is correct, and its breakpoint distance to the original breakpoint is less than 10bp. Multiple reads must confirm the location and type of a structural variation to make sure the SV is called correctly and is not a false positive. The minimum number of those reads, which is identified by the user, is called supporting reads. We considered the minimum supporting reads for Sniffles to be half of the coverage; for example, the minimum supporting reads for 10× coverage is 5. The reason for this choice is that we need at least half of the average depth support that SV.</p>
      <sec id="Sec13">
        <title>Accuracy of simulated reads</title>
        <p id="Par53">Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> show the accuracy of different methods with SVs in chromosomes 21 and 22 for 10, 8, and 12× coverage respectively. In 10× coverage, SVNN’s overall sensitivity, compared to baseline, has improved 14.2 percentage points, but FDR increased 1.8 percentage points, which is negligible in comparison to the increase in sensitivity. Moreover, compared to the most sensitive method, SVNN’s sensitivity is only 0.7 percentage points far from that of the most sensitive case, with 1.8 percentage points improved FDR. The most noticeable improvement, compared to the baseline, is seen in deletion with 22 percentage points. Then duplication with 21 percentage points and translocation with 18 percentage points improvement.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Accuracy of different methods for simulated reads with 10× coverage on chromosomes 21 and 22</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">DEL recall (%)</th><th align="left">INS recall (%)</th><th align="left">INV recall (%)</th><th align="left">DUP recall (%)</th><th align="left">TRA recall (%)</th><th align="left">Overall recall (%)</th><th align="left">FDR (%)</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">58.8</td><td align="left">41</td><td align="left">92</td><td align="left">57</td><td align="left">57</td><td align="left">58</td><td align="left">3.2</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">61.6</td><td align="left">14.5</td><td align="left">92</td><td align="left">60</td><td align="left">66.5</td><td align="left">55.5</td><td align="left">2.5</td></tr><tr><td align="left">Most sensitive method</td><td align="left">81.3</td><td align="left">46.2</td><td align="left">95</td><td align="left">78</td><td align="left">76</td><td align="left">73</td><td align="left">6.8</td></tr><tr><td align="left">SVNN</td><td align="left">80.8</td><td align="left">46.2</td><td align="left">95</td><td align="left">78</td><td align="left">75</td><td align="left">72.2</td><td align="left">5</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Accuracy of different methods for simulated reads with 8× coverage on chromosomes 21 and 22</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">DEL recall (%)</th><th align="left">INS recall (%)</th><th align="left">INV recall (%)</th><th align="left">DUP recall (%)</th><th align="left">TRA recall (%)</th><th align="left">Overall recall (%)</th><th align="left">FDR (%)</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">62.6</td><td align="left">42.9</td><td align="left">91</td><td align="left">65</td><td align="left">54.5</td><td align="left">58.25</td><td align="left">3.8</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">58.4</td><td align="left">13.9</td><td align="left">87</td><td align="left">63</td><td align="left">62</td><td align="left">53.1</td><td align="left">3.5</td></tr><tr><td align="left">Most sensitive method</td><td align="left">84.5</td><td align="left">49.4</td><td align="left">94</td><td align="left">80</td><td align="left">78</td><td align="left">75.5</td><td align="left">9</td></tr><tr><td align="left">SVNN</td><td align="left">79.4</td><td align="left">47.3</td><td align="left">94</td><td align="left">74</td><td align="left">78</td><td align="left">72.7</td><td align="left">6.1</td></tr></tbody></table></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Accuracy of different methods for simulated reads with 12× coverage on chromosomes 21 and 22</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">DEL recall (%)</th><th align="left">INS recall (%)</th><th align="left">INV recall (%)</th><th align="left">DUP recall (%)</th><th align="left">TRA recall (%)</th><th align="left">Overall recall (%)</th><th align="left">FDR (%)</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">63.3</td><td align="left">37.1</td><td align="left">92</td><td align="left">64</td><td align="left">50</td><td align="left">57.5</td><td align="left">3</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">62.6</td><td align="left">10.2</td><td align="left">88</td><td align="left">67</td><td align="left">63</td><td align="left">54.25</td><td align="left">3.4</td></tr><tr><td align="left">Most sensitive method</td><td align="left">85.9</td><td align="left">47.8</td><td align="left">95</td><td align="left">80</td><td align="left">76.5</td><td align="left">75.1</td><td align="left">6.4</td></tr><tr><td align="left">SVNN</td><td align="left">84.1</td><td align="left">46.2</td><td align="left">95</td><td align="left">77</td><td align="left">76.5</td><td align="left">73.8</td><td align="left">4.6</td></tr></tbody></table></table-wrap></p>
        <p id="Par54">In 8× coverage (Table <xref rid="Tab2" ref-type="table">2</xref>), SVNN is 14 percentage points more sensitive than the baseline pipeline. Like before, the most impressive progress is seen in deletion and translocation detection. Furthermore, due to the fewer number of supporting reads, the sensitivity of SVNN did not change very much compared to the most sensitive method, but FDR reduced to 6.1%.</p>
        <p id="Par55">In 12× coverage, most improvement is seen in translocation with a 26% difference. Also, compared to the baseline, we had 16.3 percentage points improvement in sensitivity and a 1.6 percentage point increase in FDR. Compared to the most sensitive method, we experienced only a 1.3 percentage point reduction in sensitivity but a 1.8 percentage point improvement in FDR.</p>
        <p id="Par56">We can observe from these tables that for calling some SVs, like translocations, NGMLR works best (for alignment phase) and, for calling some others, like insertions, Minimap2 works best.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Accuracy of different methods for simulated reads with 12× coverage on chromosome 1</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">DEL recall (%)</th><th align="left">INS recall (%)</th><th align="left">INV recall (%)</th><th align="left">DUP recall (%)</th><th align="left">Overall recall (%)</th><th align="left">FDR (%)</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">71.2</td><td align="left">41.1</td><td align="left">92</td><td align="left">68</td><td align="left">64</td><td align="left">3.4</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">67.7</td><td align="left">13.8</td><td align="left">84</td><td align="left">70</td><td align="left">52.6</td><td align="left">2.8</td></tr><tr><td align="left">Most sensitive method</td><td align="left">85.8</td><td align="left">49.5</td><td align="left">95</td><td align="left">90</td><td align="left">75.5</td><td align="left">4.6</td></tr><tr><td align="left">SVNN</td><td align="left">83.3</td><td align="left">45.5</td><td align="left">95</td><td align="left">88</td><td align="left">73.3</td><td align="left">4</td></tr></tbody></table></table-wrap></p>
        <p id="Par57">Table <xref rid="Tab4" ref-type="table">4</xref> shows the result of different methods on chromosome 1. Here, SVNN’s sensitivity is 9.3 percentage points better compared to the baseline method. The gain in recall rate is especially seen in the detection of deletions and duplications with 12 and 10 percentage points respectively.</p>
        <p id="Par58">The results on chromosome 1 show that the model is not overfitted to the location of reads, or the chromosome they are generated from. Our model was trained based on reads from chromosomes 21 and 22, however, it worked properly to classify informative reads on chromosome 1 too.</p>
        <p id="Par59">It is evident from Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab4" ref-type="table">4</xref> that all these methods are least sensitive in detecting insertions.</p>
      </sec>
      <sec id="Sec14">
        <title>Accuracy of real reads</title>
        <p id="Par60">Table <xref rid="Tab5" ref-type="table">5</xref> depicts the accuracy of four different pipelines when the reference is altered and reads are real with 12× coverage. 10 insertions were simulated by deleting 10 regions of chromosomes 21 and 22, and 10 deletions were simulated by inserting a random sequence to different locations of the reference. Since in this case, duplications are treated like deletions, they cannot be simulated. Unfortunately, regarding these PacBio reads, neither Sniffles nor SVIM worked accurately for detecting inversions and translocations. Therefore, we avoided adding them to the reference. Among the simulated SVs, SVNN worked 10 percentage points better than Minimap2-Sniffles, 20 percentage points better than NGMLR-Sniffles, and was on par with the most sensitive method.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Accuracy of different methods for real reads with 12× coverage on chromosomes 21 and 22</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">DEL recall (%)</th><th align="left">INS recall (%)</th><th align="left">Overall recall (%)</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">70</td><td align="left">60</td><td align="left">65</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">70</td><td align="left">40</td><td align="left">55</td></tr><tr><td align="left">Most sensitive method</td><td align="left">80</td><td align="left">70</td><td align="left">75</td></tr><tr><td align="left">SVNN</td><td align="left">80</td><td align="left">70</td><td align="left">75</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Speed results</title>
      <p id="Par61">In Tables <xref rid="Tab6" ref-type="table">6</xref>, <xref rid="Tab7" ref-type="table">7</xref>, <xref rid="Tab8" ref-type="table">8</xref>, <xref rid="Tab9" ref-type="table">9</xref> and <xref rid="Tab10" ref-type="table">10</xref>, the running time for each phase is described in each column. All times are in seconds. These times are derived from running each task on a computer with an Intel Core i7 quad-core CPU and 16 GigaBytes of RAM. The last column of these tables shows the speed-up of SVNN compared to the method in that row. For example, when 1.98 is written in the speed-up column, it means the ratio of running time of this method to SVNN is 1.98, or in other words, SVNN is 1.98 times faster than this method.</p>
      <sec id="Sec16">
        <title>Speed analysis of simulated reads</title>
        <p id="Par62">
          <table-wrap id="Tab6">
            <label>Table 6</label>
            <caption>
              <p>Running time of different methods for simulated reads with 10× coverage on chromosomes 21 and 22</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <th align="left">Method</th>
                  <th align="left" colspan="9">Time (s)</th>
                  <th align="left"/>
                </tr>
                <tr>
                  <th align="left"/>
                  <th align="left">Minimap2</th>
                  <th align="left">NGMLR</th>
                  <th align="left">Find reads in fastQ</th>
                  <th align="left">Unify outputs</th>
                  <th align="left">SAM to BAM</th>
                  <th align="left">Sniffles</th>
                  <th align="left">SVIM</th>
                  <th align="left">Remove redundancy</th>
                  <th align="left">Total</th>
                  <th align="left">Speed-up</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">Baseline method</td>
                  <td align="left">204</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">61</td>
                  <td align="left">37</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">302</td>
                  <td align="left">0.25</td>
                </tr>
                <tr>
                  <td align="left">NGMLR-Sniffles</td>
                  <td align="left">–</td>
                  <td align="left">1961</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">50</td>
                  <td align="left">34</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">2045</td>
                  <td align="left">1.74</td>
                </tr>
                <tr>
                  <td align="left">Most sensitive method</td>
                  <td align="left">204</td>
                  <td align="left">1961</td>
                  <td align="left">–</td>
                  <td align="left">28</td>
                  <td align="left">65</td>
                  <td align="left">37</td>
                  <td align="left">43</td>
                  <td align="left">2</td>
                  <td align="left">2340</td>
                  <td align="left">1.98</td>
                </tr>
                <tr>
                  <td align="left">SVNN</td>
                  <td align="left">204</td>
                  <td align="left">665</td>
                  <td align="left">146</td>
                  <td align="left">21</td>
                  <td align="left">64</td>
                  <td align="left">37</td>
                  <td align="left">40</td>
                  <td align="left">2</td>
                  <td align="left">1179</td>
                  <td align="left">1</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap id="Tab7">
            <label>Table 7</label>
            <caption>
              <p>Running time of different methods for simulated reads with 8× coverage on chromosomes 21 and 22</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <th align="left">Method</th>
                  <th align="left" colspan="9">Time (s)</th>
                  <th align="left"/>
                </tr>
                <tr>
                  <th align="left"/>
                  <th align="left">Minimap2</th>
                  <th align="left">NGMLR</th>
                  <th align="left">Find reads in fastQ</th>
                  <th align="left">Unify outputs</th>
                  <th align="left">SAM to BAM</th>
                  <th align="left">Sniffles</th>
                  <th align="left">SVIM</th>
                  <th align="left">Remove redundancy</th>
                  <th align="left">Total</th>
                  <th align="left">Speed-up</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">Baseline method</td>
                  <td align="left">163</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">47</td>
                  <td align="left">27</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">233</td>
                  <td align="left">0.24</td>
                </tr>
                <tr>
                  <td align="left">NGMLR-Sniffles</td>
                  <td align="left">–</td>
                  <td align="left">1586</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">42</td>
                  <td align="left">25</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">1653</td>
                  <td align="left">1.68</td>
                </tr>
                <tr>
                  <td align="left">Most sensitive method</td>
                  <td align="left">163</td>
                  <td align="left">1586</td>
                  <td align="left">–</td>
                  <td align="left">16</td>
                  <td align="left">50</td>
                  <td align="left">29</td>
                  <td align="left">35</td>
                  <td align="left">2</td>
                  <td align="left">1881</td>
                  <td align="left">1.91</td>
                </tr>
                <tr>
                  <td align="left">SVNN</td>
                  <td align="left">163</td>
                  <td align="left">590</td>
                  <td align="left">104</td>
                  <td align="left">13</td>
                  <td align="left">50</td>
                  <td align="left">27</td>
                  <td align="left">32</td>
                  <td align="left">2</td>
                  <td align="left">981</td>
                  <td align="left">1</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap id="Tab8">
            <label>Table 8</label>
            <caption>
              <p>Running time of different methods for simulated reads with 12× coverage on chromosomes 21 and 22</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <th align="left"/>
                  <th align="left" colspan="9">Time (s)</th>
                  <th align="left"/>
                </tr>
                <tr>
                  <th align="left">Method</th>
                  <th align="left">Minimap2</th>
                  <th align="left">NGMLR</th>
                  <th align="left">Find reads in fastQ</th>
                  <th align="left">Unify outputs</th>
                  <th align="left">SAM to BAM</th>
                  <th align="left">Sniffles</th>
                  <th align="left">SVIM</th>
                  <th align="left">Remove redundancy</th>
                  <th align="left">Total</th>
                  <th align="left">Speed-up</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">Baseline method</td>
                  <td align="left">281</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">78</td>
                  <td align="left">72</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">431</td>
                  <td align="left">0.28</td>
                </tr>
                <tr>
                  <td align="left">NGMLR-Sniffles</td>
                  <td align="left">–</td>
                  <td align="left">2687</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">66</td>
                  <td align="left">67</td>
                  <td align="left">–</td>
                  <td align="left">–</td>
                  <td align="left">2820</td>
                  <td align="left">1.84</td>
                </tr>
                <tr>
                  <td align="left">Most sensitive method</td>
                  <td align="left">281</td>
                  <td align="left">2687</td>
                  <td align="left">–</td>
                  <td align="left">51</td>
                  <td align="left">119</td>
                  <td align="left">77</td>
                  <td align="left">51</td>
                  <td align="left">2</td>
                  <td align="left">3266</td>
                  <td align="left">2.14</td>
                </tr>
                <tr>
                  <td align="left">SVNN</td>
                  <td align="left">281</td>
                  <td align="left">766</td>
                  <td align="left">196</td>
                  <td align="left">43</td>
                  <td align="left">117</td>
                  <td align="left">74</td>
                  <td align="left">50</td>
                  <td align="left">2</td>
                  <td align="left">1529</td>
                  <td align="left">1</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
        </p>
        <p id="Par63">Tables <xref rid="Tab6" ref-type="table">6</xref>, <xref rid="Tab7" ref-type="table">7</xref> and <xref rid="Tab8" ref-type="table">8</xref> show the running time of all methods in 10, 8 and, 12× coverage, with SVs located in chromosomes 21 and 22. Table <xref rid="Tab9" ref-type="table">9</xref> shows the running time of all methods in 12× coverage executed on chromosome 1. By observing Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab6" ref-type="table">6</xref>, we see that in 10× coverage, SVNN only lacks 0.8 percentage points in sensitivity than the most sensitive method, but it is 2 times faster. In this coverage, SVNN’s sensitivity is 16.7 percentage points more than NGMLR-Sniffles, and its running time is 1.74 times less.</p>
        <p id="Par64">In Table <xref rid="Tab8" ref-type="table">8</xref>, in 12× coverage, SVNN is 1.84 times faster than NGMLR-Sniffles and sensitivity improved 19.55 percentage points. In this coverage, the speed compared to the most sensitive method amazingly got 2.1 times faster.</p>
        <p id="Par65">Nowhere in our experiments, was the speed-up as high as in Table <xref rid="Tab9" ref-type="table">9</xref>. The speed-up compared to the most sensitive method and NGMLR-Sniffles is 3.6 and 3.1, respectively. The reason for this higher speed-up is that the SVs were injected in a single chromosome, and therefore, translocations could not be simulated. Not having translocations made the learning model much more accurate, and a smaller subset of reads was selected to be mapped by NGMLR.<table-wrap id="Tab9"><label>Table 9</label><caption><p>Running time of different methods for simulated reads with 12× coverage on chromosome 1</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="9">Time (s)</th><th align="left"/></tr><tr><th align="left">Method</th><th align="left">Minimap2</th><th align="left">NGMLR</th><th align="left">Find reads in fastQ</th><th align="left">Unify outputs</th><th align="left">SAM to BAM</th><th align="left">Sniffles</th><th align="left">SVIM</th><th align="left">Remove redundancy</th><th align="left">Total</th><th align="left">Speed-up</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">556</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">203</td><td align="left">130</td><td align="left">–</td><td align="left">–</td><td align="left">889</td><td align="left">0.48</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">–</td><td align="left">5446</td><td align="left">–</td><td align="left">–</td><td align="left">202</td><td align="left">123</td><td align="left">–</td><td align="left">–</td><td align="left">5771</td><td align="left">3.14</td></tr><tr><td align="left">Most sensitive method</td><td align="left">556</td><td align="left">5446</td><td align="left">–</td><td align="left">105</td><td align="left">346</td><td align="left">142</td><td align="left">147</td><td align="left">1</td><td align="left">6743</td><td align="left">3.66</td></tr><tr><td align="left">SVNN</td><td align="left">556</td><td align="left">278</td><td align="left">439</td><td align="left">97</td><td align="left">205</td><td align="left">128</td><td align="left">134</td><td align="left">1</td><td align="left">1838</td><td align="left">1</td></tr></tbody></table></table-wrap><table-wrap id="Tab10"><label>Table 10</label><caption><p>Running time of different methods for real reads with 12× coverage on chromosomes 21 and 22</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="9">Time (s)</th><th align="left"/></tr><tr><th align="left">Method</th><th align="left">Minimap2</th><th align="left">NGMLR</th><th align="left">Find reads in fastQ</th><th align="left">Unify outputs</th><th align="left">SAM to BAM</th><th align="left">Sniffles</th><th align="left">SVIM</th><th align="left">Remove redundancy</th><th align="left">Total</th><th align="left">Speed-up</th></tr></thead><tbody><tr><td align="left">Baseline method</td><td align="left">838</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">82</td><td align="left">41</td><td align="left">–</td><td align="left">–</td><td align="left">961</td><td align="left">0.27</td></tr><tr><td align="left">NGMLR-Sniffles</td><td align="left">–</td><td align="left">3577</td><td align="left">–</td><td align="left">–</td><td align="left">86</td><td align="left">60</td><td align="left">–</td><td align="left">–</td><td align="left">3723</td><td align="left">1.04</td></tr><tr><td align="left">Most sensitive method</td><td align="left">838</td><td align="left">3577</td><td align="left">–</td><td align="left">91</td><td align="left">142</td><td align="left">98</td><td align="left">85</td><td align="left">10</td><td align="left">4841</td><td align="left">1.35</td></tr><tr><td align="left">SVNN</td><td align="left">838</td><td align="left">1780</td><td align="left">561</td><td align="left">87</td><td align="left">132</td><td align="left">96</td><td align="left">81</td><td align="left">9</td><td align="left">3584</td><td align="left">1</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec17">
        <title>Speed analysis of real reads</title>
        <p id="Par66">Our learning model was trained on simulated reads by PBSIM, it had never seen examples of real reads. Therefore, its specificity dropped significantly for real reads. About 50% of reads were identified as informative reads. As a result, more reads were given to NGMLR, and the program took much longer to run. Despite the difference between the training and test sets, SVNN is 1.35 times faster than the most sensitive method and 1.04 times faster than NGMLR-Sniffles. This means on real data, which our model has not seen, SVNN achieves 20 percentage points improvement in accuracy compared to NGMLR-Sniffles and still finishes its task faster.</p>
        <p id="Par67">Another point we see in real data is that almost all steps took longer to run compared to 12x synthetic reads in Table <xref rid="Tab8" ref-type="table">8</xref>. The main reason for this observation is that real reads were on average longer than synthetic reads. Average length of real reads was 4500 bps, while average synthetic read length was 2800 bps.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Conclusions</title>
    <p id="Par68">In this paper, we have presented SVNN: an SV detection pipeline that leverages both the speed of Minimap2 and the accuracy of NGMLR for SV calling. Our main aim in this work had been devising a tool for SV detection which can be fast while maintaining high sensitivity. Not only did we achieve this feat, but we also were able to increase the sensitivity up to 20 percentage points. SVNN’s high recall rate and low false discovery, make it suitable for low-coverage situations, thus even further minimizing the cost of long-read applications. SVNN is available for Linux and has a user-friendly interface. The user only needs to specify raw reads, the reference, and the number of supporting reads; SVNN takes care of the rest. SVNN can also be extended to include other tools. By retraining another network, new tools can be integrated together. This paper is written as a proof-of-concept to show that for an end-to-end bioinformatics application like SV calling, we can use a learning model to combine the plus sides of existing tools, and considerably improve their performance.</p>
    <p id="Par69">In the future, we can improve the performance of SVNN in two directions: speed-wise, and FDR-wise. Since NGMLR is still the computational bottleneck of SVNN, we can speed up the whole process by multi-node implementation or parallel implementation of NGMLR on GPU. On the other hand, as we saw, FDR increases when we use Minimap2 for alignment. The reason is that some reads are wrongly split by Minimap2. Hence, another neural network can be trained to classify the wrongly split reads and reduce the FDR.</p>
    <p id="Par70">Furthermore, since SVNN was trained on PacBio-like reads, it currently is not suitable for Oxford Nanopore reads. We plan to train another model for the Nanopore reads, and provide users with two separate models which they can choose from based on what type of reads they have: PacBio or Nanopore.</p>
  </sec>
  <sec id="Sec19">
    <title>Availability and requirements</title>
    <p id="Par71"><italic>Project name</italic> SVNN</p>
    <p id="Par72">
      <italic>Project home page</italic>
      <ext-link ext-link-type="uri" xlink:href="http://easy.ce.sharif.edu/svnn/">http://easy.ce.sharif.edu/svnn/</ext-link>
    </p>
    <p id="Par73"><italic>Operating system(s)</italic> Ubuntu</p>
    <p id="Par74"><italic>Programming language</italic> Python and C++</p>
    <p id="Par75"><italic>Other requirements</italic> Python 3.5 or higher, G++ 11 or higher</p>
    <p id="Par76"><italic>License</italic> CC BY 4.0</p>
    <p id="Par77"><italic>Any restrictions to use by non-academics</italic> None.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par4">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>SV</term>
        <def>
          <p id="Par5">Structural variation</p>
        </def>
      </def-item>
      <def-item>
        <term>PacBio</term>
        <def>
          <p id="Par6">Pacific Biosciences</p>
        </def>
      </def-item>
      <def-item>
        <term>DEL</term>
        <def>
          <p id="Par7">Deletion</p>
        </def>
      </def-item>
      <def-item>
        <term>INS</term>
        <def>
          <p id="Par8">Insertion</p>
        </def>
      </def-item>
      <def-item>
        <term>DUP</term>
        <def>
          <p id="Par9">Duplication</p>
        </def>
      </def-item>
      <def-item>
        <term>INV</term>
        <def>
          <p id="Par10">Inversion</p>
        </def>
      </def-item>
      <def-item>
        <term>INDEL</term>
        <def>
          <p id="Par11">Insertion and Deletion</p>
        </def>
      </def-item>
      <def-item>
        <term>INVDEL</term>
        <def>
          <p id="Par12">Inversion flanked with deletion</p>
        </def>
      </def-item>
      <def-item>
        <term>INVDUP</term>
        <def>
          <p id="Par13">Inverted duplications</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p id="Par14">Variant Call Format</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>Mostafa Hadadian Nejad Yousefi is now with Bernoulli Institute, University of Groningen, Groningen, The Netherlands</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>SA and MHNY designed the pipeline of SVNN under the supervision of MG. SA is responsible for the implementation of SVNN and collecting the results. All authors discussed the results. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The authors declare that they have no source for funding.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source codes and a detailed manual are freely available at <ext-link ext-link-type="uri" xlink:href="http://easy.ce.sharif.edu/svnn/">http://easy.ce.sharif.edu/svnn/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par78">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par79">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par80">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weischenfeldt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Symmons</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Spitz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>Phenotypic impact of genomic structural variation: insights from and for human disease</article-title>
        <source>Nat Rev Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>125</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3373</pub-id>
        <pub-id pub-id-type="pmid">23329113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Zapatka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stütz</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Zichner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weischenfeldt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jäger</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Remke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shih</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Northcott</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Pfaff</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Genome sequencing of pediatric medulloblastoma links catastrophic dna rearrangements with tp53 mutationse</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <issue>1–2</issue>
        <fpage>59</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.12.013</pub-id>
        <pub-id pub-id-type="pmid">22265402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurles</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Dermitzakis</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Tyler-Smith</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The functional impact of structural variation in humans</article-title>
        <source>Trends Genet</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>238</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2008.03.001</pub-id>
        <pub-id pub-id-type="pmid">18378036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kosugi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Momozawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Terao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kubo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kamatani</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of structural variation detection algorithms for whole genome sequencing</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>117</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1720-5</pub-id>
        <pub-id pub-id-type="pmid">31159850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Structural variation detection from next generation sequencing</article-title>
        <source>Next Gener Seq Appl</source>
        <year>2016</year>
        <volume>1</volume>
        <fpage>007</fpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Steinberg</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hoekzema</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Graves-Lindsay</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Munson</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Kronenberg</surname>
            <given-names>ZN</given-names>
          </name>
          <name>
            <surname>Vives</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Discovery and genotyping of structural variation from long-read haploid genome sequence data</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>677</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214007.116</pub-id>
        <pub-id pub-id-type="pmid">27895111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mills</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Abyzov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cheetham</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping copy number variation by population-scale genome sequencing</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>470</volume>
        <issue>7332</issue>
        <fpage>59</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09708</pub-id>
        <pub-id pub-id-type="pmid">21293372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Kocher</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Detection and visualization of complex structural variants from long reads</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>20</issue>
        <fpage>508</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2539-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>de Cesare</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Piazza</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sebastiano</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>XJ</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive comparison of pacific biosciences and oxford nanopore technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Research</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.10571.2</pub-id>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Rescheneder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smolka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Accurate detection of complex structural variations using single-molecule sequencing</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>461</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0001-7</pub-id>
        <pub-id pub-id-type="pmid">29713083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yousefi</surname>
            <given-names>MHN</given-names>
          </name>
          <name>
            <surname>Goudarzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Motahari</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>IMOS: improved meta-aligner and Minimap2 on spark</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>51</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2592-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with bwa-mem. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1303.3997">arXiv:1303.3997</ext-link>; 2013.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</article-title>
        <source>BMC Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SVIM: structural variant identification using mapped long reads</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>7</issue>
        <fpage>2907</fpage>
        <lpage>2915</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz041</pub-id>
        <pub-id pub-id-type="pmid">30668829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>English</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Salerno</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>PBHoney: identifying genomic variants via long-read discordance and interrupted mapping</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>180</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Sudmant</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Malig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Antonacci</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Surti</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Sandstrom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boitano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Landolin</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Resolving the complexity of the human genome using single-molecule sequencing</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>517</volume>
        <issue>7536</issue>
        <fpage>608</fpage>
        <lpage>611</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13907</pub-id>
        <pub-id pub-id-type="pmid">25383537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giesselmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hetzel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>F-J</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kretzmer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Nanopype: a modular and scalable nanopore data processing pipeline</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>22</issue>
        <fpage>4770</fpage>
        <lpage>4772</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz461</pub-id>
        <pub-id pub-id-type="pmid">31192347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeffares</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Jolly</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hoti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rallis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Balloux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bähler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Transient structural variations have strong effects on quantitative traits and reproductive isolation in fission yeast</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14061</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ono</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamada</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PBSIM: PacBio reads simulator-toward accurate genome assembly</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>119</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts649</pub-id>
        <pub-id pub-id-type="pmid">23129296</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
