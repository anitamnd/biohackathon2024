<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4314203</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-44827</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0117711</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Metagenomic Profiling of Known and Unknown Microbes with MicrobeGPS</article-title>
      <alt-title alt-title-type="running-head">Metagenomic Profiling of Known and Unknown Microbes with MicrobeGPS</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lindner</surname>
          <given-names>Martin S.</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Renard</surname>
          <given-names>Bernhard Y.</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Research Group Bioinformatics (NG4), Robert Koch Institute, Berlin, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Moreno-Hagelsieb</surname>
          <given-names>Gabriel</given-names>
        </name>
        <role>Academic Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Wilfrid Laurier University, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: MSL BYR. Performed the experiments: MSL. Analyzed the data: MSL BYR. Contributed reagents/materials/analysis tools: MSL BYR. Wrote the paper: MSL BYR. Wrote and designed the software: MSL.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>RenardB@rki.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>e0117711</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>10</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2015 Lindner, Renard</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Lindner, Renard</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0117711.pdf"/>
    <abstract>
      <p>Microbial community profiling identifies and quantifies organisms in metagenomic sequencing data using either reference based or unsupervised approaches. However, current reference based profiling methods only report the presence and abundance of single reference genomes that are available in databases. Since only a small fraction of environmental genomes is represented in genomic databases, these approaches entail the risk of false identifications and often suggest a higher precision than justified by the data. Therefore, we developed MicrobeGPS, a novel metagenomic profiling approach that overcomes these limitations. MicrobeGPS is the first method that identifies microbiota in the sample and estimates their genomic distances to known reference genomes. With this strategy, MicrobeGPS identifies organisms down to the strain level and highlights possibly inaccurate identifications when the correct reference genome is missing. We demonstrate on three metagenomic datasets with different origin that our approach successfully avoids misleading interpretation of results and additionally provides more accurate results than current profiling methods. Our results indicate that MicrobeGPS can enable reference based taxonomic profiling of complex and less characterized microbial communities. MicrobeGPS is open source and available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/microbegps/">https://sourceforge.net/projects/microbegps/</ext-link> as source code and binary distribution for Windows and Linux operating systems.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by the German Federal Ministry of Health [IIA5-2512-FSB-725 to B.Y.R.]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="2"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files; software is available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/microbegps/">https://sourceforge.net/projects/microbegps/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files; software is available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/microbegps/">https://sourceforge.net/projects/microbegps/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Recent advances in experimental and computational technologies have increased the number and diversity of sequenced microbial organisms. Today, single cell sequencing [<xref rid="pone.0117711.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0117711.ref002" ref-type="bibr">2</xref>] and metagenome assembly [<xref rid="pone.0117711.ref003" ref-type="bibr">3</xref>] allow extracting the genomic sequences even for uncultivable bacteria. With the increasing number of microbial reference sequences, reference based metagenomic analysis methods became significantly more powerful and popular [<xref rid="pone.0117711.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0117711.ref007" ref-type="bibr">7</xref>].</p>
    <p>Although the taxonomic resolution of reference based methods in whole genome sequencing metagenomic experiments is higher than for other strategies such as 16S rRNA [<xref rid="pone.0117711.ref008" ref-type="bibr">8</xref>] or composition based taxonomic profiling [<xref rid="pone.0117711.ref009" ref-type="bibr">9</xref>], these methods encounter a different problem: the reference genome databases are still far from complete and—due to constant evolution—will never be. In practice, the often proposed species or strain level accuracy [<xref rid="pone.0117711.ref005" ref-type="bibr">5</xref>] is only achieved if sufficient sequenced strains of the organism of interest are available. Otherwise, these methods are at risk of suggesting accuracy to the user that is not justified by the underlying reference data when they report the presence of a species in the database which happens to be the closest sequenced relative to the organism in the sample. For example, the NCBI bacterial genomes contain the <italic>Akkermansia muciniphila</italic> ATCC BAA-835 genome, which is the only representative of the class <italic>Verrucomicrobiae</italic> in the database. If a related <italic>Verrucomicrobium</italic> is sequenced, current tools are likely to report <italic>A. muciniphila</italic> ATCC BAA-835 without warning the user that the identified strain has considerable difference to the true organism. This holds both for abundance estimation and for read binning approaches.</p>
    <p>This problem becomes evident when considering current approaches for assessing the composition of microbial communities via metagenomics. For example, MetaPhlAn [<xref rid="pone.0117711.ref004" ref-type="bibr">4</xref>] is a fast and popular metagenomic abundance estimation tool which maps reads to a set of selected marker sequences that are unique for each organism in the database. The marker sequences are carefully selected such that a read can only match to one marker and can therefore be assigned to a distinct organism. Therefore, the abundances of organisms can be easily calculated by extrapolating the number of reads on the marker sequences to the whole genome. Together with the small size of the marker sequence database, this makes MetaPhlAn very fast while the accuracy is comparable to other reference based methods. However, since the genomes are reduced to short marker sequences, there is no possibility to detect or even quantify differences between the sequenced organism and the reference. Organisms that contain marker sequences of different reference strains (e.g. by horizontal gene transfer) show up in the results multiple times and it is not possible to detect such cases. A second approach based on marker genes is mOTUs [<xref rid="pone.0117711.ref010" ref-type="bibr">10</xref>], which is inspired by profiling methods using the 16S rRNA phylogenetic marker gene. Here, the authors selected a set of ten marker genes that are more discriminative for phylogenetic inference and do not suffer from differing copy numbers. Using whole genome sequencing data instead of amplicon sequencing, the reads are mapped to the marker genes and the taxonomic profile of the sample is calculated. Since the selected marker sequences are single copy genes, mOTUs also allows species abundance estimation. However, due to the marker based approach, mOTUs suffers from the same drawbacks as MetaPhlAn. Another recent approach for both abundance estimation and read binning is Pathoscope [<xref rid="pone.0117711.ref005" ref-type="bibr">5</xref>], a method that analyzes read alignments to whole genomes with particular focus on reads mapping to multiple genomes. The program calculates a probability for each read alignment that is used in a Bayesian mixture model. The reads are then reassigned to their most likely origin by finding the optimal model parameters. This allows Pathoscope to differentiate between highly similar strains even for very low sequencing depth. Although Pathoscope is able to identify the closest related reference when the true genome is not present in the database, it is not clear from the results whether the reported organism is a perfect match or not. There is a variety of further tools available, however, to the best of our knowledge, none of the existing tools quantifies the distance between reference genome and organism in the dataset.</p>
    <p>Here, we present MicrobeGPS, a tool that accurately identifies microbial organisms in metagenomic sequencing data, estimates their abundance, and quantifies their distances to known reference genomes. In contrast to current methods which typically estimate the abundances of available reference genomes, MicrobeGPS approaches the problem from a biological perspective and finds microbial organisms that are then described with suitable reference genomes. Here, a microbial organism is characterized by its sequencing depth in a similar fashion as the composition-based AbundanceBin [<xref rid="pone.0117711.ref011" ref-type="bibr">11</xref>] method. MicrobeGPS searches for reads that are likely to originate from genomic regions that are unique to one organism in the dataset. Based on this information, MicrobeGPS creates clusters of reference genomes supporting the same candidate organism. The supporting genomes determine the taxonomic affiliation of the candidate while the genome–dataset validity score [<xref rid="pone.0117711.ref012" ref-type="bibr">12</xref>] quantifies the distance between candidate and supporting genomes. This observation driven approach makes MicrobeGPS unique in the sense that the tool reports highly accurate identifications and abundances in the case of suitable reference genomes. Otherwise, it describes the contained organism using the closest related known reference genomes providing a sound quantification of sequence disagreement. The graphical user interface eases data analysis and interpretation as it provides interactively browsable results, color representation of quantitative traits, as well as interactive graphs and taxonomy trees.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>The MicrobeGPS method is outlined in <xref ref-type="fig" rid="pone.0117711.g001">Fig. 1</xref> and is described in this section. The fundamental idea behind MicrobeGPS is that we use already characterized reference genomes to <italic>describe</italic> the identity of the (possibly unknown) organisms in a metagenomic dataset (see <xref ref-type="fig" rid="pone.0117711.g002">Fig. 2a</xref>). This approach contrasts current methods that typically seek to directly identify and quantify reference genomes (species/strains) or higher taxa in the dataset. In analogy to the global positioning system GPS, MicrobeGPS estimates the taxonomic position of an organism in the sample by measuring the genomic distance between the organism and the closest related reference genomes. In contrast to taxonomic binning approaches (such as Pathoscope or Megan [<xref rid="pone.0117711.ref013" ref-type="bibr">13</xref>]), MicrobeGPS does not assign each read to a single taxon, but operates on the whole dataset to identify the taxa present in the sample.</p>
    <fig id="pone.0117711.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0117711.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>MicrobeGPS workflow.</title>
        <p>As a first step, MicrobeGPS reads and analyzes the SAM files of the metagenomic reads mapped to a set of reference genomes. Early filtering of the reads helps reducing the amount of data by discarding reads that are not meaningful for MicrobeGPS. Then, MicrobeGPS estimates the Genome Dataset Validity score and the local sequencing depth of each reference genome and uses this information to extract <italic>core reads</italic> (CR), reads that are presumably unique for a particular organism in the sample. Based on the CR and the shared reads, MicrobeGPS clusters the reference genomes into groups, where each group represents a single biological candidate organism in the sample.</p>
      </caption>
      <graphic xlink:href="pone.0117711.g001"/>
    </fig>
    <fig id="pone.0117711.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0117711.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>GPS principle and GDV score.</title>
        <p>(a) The taxonomic <italic>location</italic> of an unknown organism (dark) is estimated by calculating distances to already known and taxonomically classified reference genomes (light), inspired by the global positioning system GPS. The GDV measures the distance between references and organism: (b) The available reference genome shares parts of its sequence with the unknown genome in the sample. (c) The GDV of the reference genome with respect to the unknown genome is defined as the fraction of the reference genome that agrees with the unknown genome. (d) Since the unknown genome is realized as a set of short reads obtained by sequencing a biological sample, the GDV of the reference genome with respect to the unknown genome can be estimated from the sequencing reads mapped to the reference genome as described in [<xref rid="pone.0117711.ref012" ref-type="bibr">12</xref>].</p>
      </caption>
      <graphic xlink:href="pone.0117711.g002"/>
    </fig>
    <p>The distance between reference genome and the organism is measured by the genome–dataset validity (GDV) as follows. Consider an unknown organism in the sample that shares parts of its genome sequence with a known genome (<xref ref-type="fig" rid="pone.0117711.g002">Fig. 2b</xref>). Then, the GDV is defined as the fraction of the reference genome that has a counterpart in the unknown genome as shown in <xref ref-type="fig" rid="pone.0117711.g002">Fig. 2c</xref>. Since the unknown genome is realized as a set of short reads, the true GDV of the reference genome is not directly observable. In practice, not all shared parts of the reference genome may be covered by reads (<xref ref-type="fig" rid="pone.0117711.g002">Fig. 2d</xref>). Therefore, the GDV is estimated as described below based on prior work in [<xref rid="pone.0117711.ref012" ref-type="bibr">12</xref>].</p>
    <p>MicrobeGPS builds on the assignment of reads to a collection of reference genomes. Based on coverage depth observed locally on the reference genomes, MicrobeGPS identifies reads that are likely to originate from a genomic region that is unique to one of the organisms in the sample. These reads are then used together with the other shared reads to create clusters of reference genomes, where each cluster represents a single organism in the dataset. The following sections describe the details of our method.</p>
    <sec id="sec002a">
      <title>Local sequencing depth and GDV estimation</title>
      <p>A metagenomic dataset contains sequencing reads derived from an environmental community of microbial organisms. In a whole genome NGS experiment, the number of reads from each organism can be assumed to be proportional to its genome length and its abundance in the community. The reads are sampled from random positions in the genome such that we assume a homogeneous sequencing depth on the original genomes. Apart from influences such as extreme GC bias, this assumption is justified for the current NGS devices [<xref rid="pone.0117711.ref014" ref-type="bibr">14</xref>].</p>
      <p>As a first step, MicrobeGPS requires the sequencing reads to be mapped to a broad collection of microbial reference genomes. Considering the vast amounts of data produced by current sequencers, it makes sense to use a fast read mapper that reports all or the N best read mappings. We had good experience with Bowtie 2 [<xref rid="pone.0117711.ref015" ref-type="bibr">15</xref>], NGM [<xref rid="pone.0117711.ref016" ref-type="bibr">16</xref>] and Masai [<xref rid="pone.0117711.ref017" ref-type="bibr">17</xref>], but other tools supporting the SAM format as output are also feasible.</p>
      <p>MicrobeGPS excludes reads from the analysis that originate from highly conserved regions, such as 16S rRNA reads. Since these reads can be mapped to almost all bacterial genomes they are not informative in our setup and can suppress the faint signals of very low abundant organisms. Furthermore, MicrobeGPS discards reference genomes without sufficient supporting reads or a highly uneven read distribution on the genome. Multiple reference sequences (chromosomes, plasmids) belonging to the same organism are grouped at this stage.</p>
      <p>In the next step, we estimate the sequencing depth in the covered regions on each reference genome. For that purpose we compose a mixture distribution of three probability distributions:
<disp-formula id="pone.0117711.e001"><alternatives><graphic xlink:href="pone.0117711.e001.jpg" id="pone.0117711.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>∣</mml:mo><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>∣</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<italic>z</italic> is the zero distribution as used in [<xref rid="pone.0117711.ref018" ref-type="bibr">18</xref>] to construct a zero-inflated Poisson distribution in combination with the Poisson distribution <italic>P. T</italic>
<sub><italic>λ</italic></sub> is a Poisson tail distribution as introduced in [<xref rid="pone.0117711.ref012" ref-type="bibr">12</xref>] to account for skews in the Poisson distribution due to differences between reference genome and sequencing reads. The <italic>α</italic>
<sub><italic>i</italic></sub> are the mixing coefficients. This mixture distribution is fitted to the histogram of genome coverage depths of each reference genome using a modified EM algorithm, providing estimates for the parameter <italic>λ</italic> and the mixing coefficients <italic>α</italic>
<sub><italic>i</italic></sub>. Then, the parameter <italic>λ</italic> of the Poisson distribution represents the sequencing depth on the genomic regions shared between reference genome and the organism in the sample.</p>
      <p>The genome–dataset validity score (GDV) is defined as the fraction of the reference genome for which there is evidence in the dataset. Therefore, the GDV can be calculated from the mixing coefficient of the zero distribution: GDV = 1 − <italic>α</italic>
<sub>1</sub>. As shown in the original publication, the zero-inflated Poisson distribution with tail provides more accurate estimates of the GDV for sequencing depths ≥ 1× than the negative binomial counterpart. A modification of this approach to ultra–low sequencing depths (≤ 1×) is described in detail in <xref ref-type="supplementary-material" rid="pone.0117711.s001">S1 Text</xref>. In brief, the histogram of genome coverage depths is replaced by the histogram of distances between read start positions and the mixture distribution consists of three geometric distributions. In practice, the former approach is used for sequencing depths ≥ 1×, the latter for sequencing depths &lt; 1×. With this strategy, MicrobeGPS is able to recover the GDV and the original sequencing depth of an organism down to 0.05× even if the closest related available reference genome has only low similarity.</p>
      <p>The GDV takes values between 0 (reference genome has no similarity to an organism in the sample) and 1 (reference genome is completely represented in the sample). In practice, GDV scores larger than 0.8 almost always indicate highly relevant reference sequences. Scores below 0.2 should always be treated with caution, as they may either indicate a very distant relation or can be the result of spurious read mappings. In a metagenome where the majority of constituents are unknown, GDV scores higher than 0.2 can be typically regarded as informative, although it should be clear that a species level identification is not appropriate.</p>
    </sec>
    <sec id="sec002b">
      <title>Reference genome clustering</title>
      <p>Once the local sequencing depths are estimated, MicrobeGPS extracts all core reads (CR) from the dataset. The CR are a subset of all reads {<italic>r</italic>} and are defined as
<disp-formula id="pone.0117711.e002"><alternatives><graphic xlink:href="pone.0117711.e002.jpg" id="pone.0117711.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mi>r</mml:mi><mml:mspace width="4pt"/><mml:mo>∣</mml:mo><mml:mspace width="4pt"/></mml:mrow><mml:mfrac><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">D</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo movablelimits="true" form="prefix">min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">D</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>mean</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="normal">D</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where D<sub><italic>r</italic></sub> are the sequencing depths of reference genomes that the read <italic>r</italic> maps to. In other words, a read <italic>r</italic> is a CR, when it maps to multiple reference genomes with similar local sequencing depth, i.e. the maximum relative difference between the sequencing depths on the target genomes of a read does not exceed the user defined limit <italic>t</italic> (default: <italic>t</italic> = 0.2). Generally, a higher <italic>t</italic> leads to more reads classified as CR because larger differences in sequencing depth are allowed. This can be useful for datasets with novel organisms or with low sequencing depth, where the local sequencing depth estimation may be not as accurate as for high sequencing depth datasets. CR are likely to originate from a genomic region that is unique to one particular organism with respect to all other organisms in the sample: if the read would originate from a non-unique genomic region and could be assigned to multiple organisms, it is likely that these organisms have different sequencing depths. However, it is still possible that two or more organisms have the same sequencing depth such that false CR are identified; these cases require specialized treatment as described in the following steps.</p>
      <p>At this stage, MicrobeGPS still works on the level of reference genomes, where it is not clear how the number of reference genomes relates to the number of true organisms. While a very uncommon bacterium might be represented by only a single reference genome, the presence of a well-studied model organism in the sample, such as <italic>Escherichia coli</italic>, will make a lot more reference genomes appear meaningful. Therefore, MicrobeGPS creates clusters of reference genomes in the final step, where each cluster represents a single organism in the dataset. First, MicrobeGPS clusters reference genomes sharing high numbers of CR using a greedy strategy: a reference genome is compared to all existing clusters and the fraction of shared CR out of all shared reads are computed. If the reference genome shares sufficient CR with the existing clusters, MicrobeGPS assigns the genome to the cluster with the highest overlap. Requiring a minimum CR overlap with clusters (default: 20% of all CR) allows accounting for organisms with similar sequencing depth: the number of CR shared with a cluster representing a different organism is typically lower than the total number of CR. If a lower CR overlap is used, the method requires less CR to be shared between reference genomes in order to assign them to the same cluster. This, however, bares the risk of falsely assigning genomes to the same cluster that represent different organisms. On the other hand, requiring a high overlap may lead to multiple clusters representing the same organism. If no suitable cluster can be identified based on the CR, MicrobeGPS searches in a second step for clusters with a very high fraction of shared reads (default: 60% of all reads are shared between reference genome and cluster). The influence of this parameter is similar to the minimum CR overlap. However, we set a higher default value here, as the fraction of shared reads is not as discriminative as the fraction of shared CR. Finally, a new cluster is created if the genome cannot be assigned to any existing cluster based on the shared CR or all shared reads. This greedy clustering strategy has two advantages over existing clustering schemes: First, the number of clusters is not required beforehand as for k-means [<xref rid="pone.0117711.ref019" ref-type="bibr">19</xref>]. Second, it is not necessary to calculate a full distance matrix between the reference genomes as for hierarchical clustering [<xref rid="pone.0117711.ref020" ref-type="bibr">20</xref>], which is computationally expensive. Furthermore, clustering can be sped up if scientific names or genome identifiers are available for the reference sequences. Then, taxonomically related genomes are clustered previous to other genomes, reducing the number of necessary comparisons. Compared to other traditional clustering approaches, such as hierarchical clustering, our approach was designed with focus on low run time rather than mathematical exactness and proves to be robust in application.</p>
      <p>The clustering step has quadratic complexity in the number of reference genomes for the worst case when each reference genome is used to create a new cluster. However, with reasonable choice of parameters (e.g., default), the complexity is between linear and quadratic in practice, depending on the structure of the reference genome collection and the composition of the microbial community. With the number of reads <italic>M</italic> and the number of reference genomes <italic>N</italic>, the worst case complexity of MicrobeGPS is <italic>O</italic>(<italic>MN</italic>
<sup>2</sup>). However, due to the greedy algorithm, the average case complexity is <italic>O</italic>(<italic>MN</italic>) in practice.</p>
      <p>In summary, each cluster is built up of one or more reference genomes and represents one organism in the sample, identified by its sequencing depth and the reads shared between the supporting genomes. If taxonomic information is provided with the reference genomes, MicrobeGPS assigns the lowest common ancestor taxon name of all supporting genomes to the candidate to facilitate interpretation of the results. Discrimination between organisms with similar sequencing depth is achieved by requiring a minimum overlap of reference genomes for clustering such that only highly similar organisms with equal sequencing depth are at risk to be falsely regarded as one organism. The distances between the identified candidate organisms and their associated reference genomes are given by the GDV and allow estimating the taxonomic identity of the organism.</p>
    </sec>
  </sec>
  <sec id="sec003">
    <title>Experiments &amp; Results</title>
    <p>In this section, we present experimental results that demonstrate on the one hand that MicrobeGPS provides more accurate community composition estimates than previous approaches and on the other hand that MicrobeGPS provides a new quality in analyzing microbial communities. The former is demonstrated on artificial metagenomic data allowing comparison of different tools to a gold standard. For the latter, we reanalyze two different real microbial communities that are challenging and highlight the benefits of MicrobeGPS.</p>
    <sec id="sec003a">
      <title>Comparison on artificial mock community</title>
      <p>We compared MicrobeGPS to other methods on the Human Microbiome Project (HMP) Mock Community (MC) metagenomic dataset [<xref rid="pone.0117711.ref021" ref-type="bibr">21</xref>] which is an in vitro synthetic mixture of 21 known bacteria. Although the complexity is below that of typical metagenomes, this dataset is particularly suitable as it includes all typical problems occurring in real data that can hardly be reproduced in simulated datasets such as GC bias, read noise, or mutations. Originally, two mixtures were created: one with even abundance profile, i.e. all organisms are about equally abundant, and one with staggered abundance profile, where the abundances spread over several orders of magnitude. We used the staggered data set because it resembles a natural abundance distribution and is more challenging for the tools. The Illumina sequencing data of the staggered abundance distribution mixture are available from NCBI SRA (accession SRX055381) and contain 7.9 million 75 bp reads. We analyzed the community composition of MC with the state-of-the-art methods Pathoscope [<xref rid="pone.0117711.ref005" ref-type="bibr">5</xref>], MetaPhlAn [<xref rid="pone.0117711.ref004" ref-type="bibr">4</xref>], and mOTUs [<xref rid="pone.0117711.ref010" ref-type="bibr">10</xref>] and compared results with MicrobeGPS. Both MicrobeGPS and Pathoscope build upon the alignment of the metagenomic reads to a database of microbial reference genomes. As reference genome database, we used the HMP [<xref rid="pone.0117711.ref022" ref-type="bibr">22</xref>] and the NCBI [<xref rid="pone.0117711.ref023" ref-type="bibr">23</xref>] bacterial reference genomes for both tools. The reads were mapped with Bowtie 2 (v. 2.1.0, parameters—fast -p 12—no-unal -k 60) to both reference databases for further processing with Pathoscope 1.0 and MicrobeGPS 1.0.0 (Linux binaries). We used default parameters for Pathoscope and configured MicrobeGPS to discard reads mapping to more than 50 references and consider only references with 10 or more unique reads. MetaPhlAn 1.7.7 and mOTUs (standalone version) are shipped with their own curated sets of marker genes for identification. Both tools were configured as suggested in the manuals; MetaPhlAn was set to report species level abundance estimates. On the same hardware, the run time of the marker gene based methods MetaPhlAn (2:19 min) and mOTUs (10:53 min) was lower than for Pathoscope (15:08 min) and MicrobeGPS (31:37 min).</p>
      <p>MicrobeGPS reported 24 (HMP) and 23 (NCBI) candidate organisms, Pathoscope reported abundance estimates for 828 (NCBI) and 690 (HMP) reference sequences. MetaPhlAn reported abundance estimates for 32 species, mOTUs for 16 species. We sorted the results by estimated abundances and selected the <italic>N</italic> most abundant identifications of each tool and compared the results to the ground truth. For each <italic>N</italic>, we calculated the sensitivity, false positive rate and precision for the selected set. Plotting the sensitivity against the false positive rate allowed to determine receiver operator characteristic (ROC) for each tool. Additionally, we calculated the F-measure [<xref rid="pone.0117711.ref024" ref-type="bibr">24</xref>]—the harmonic mean of sensitivity and precision—for all <italic>N</italic> and report its maximum for each setup. The quantitative measures are summarized in <xref rid="pone.0117711.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="pone.0117711.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0117711.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Comparison of taxonomic profiling methods on HMP mock community data.</title>
          <p>We compared the four tools MetaPhlAn, mOTUs, Pathoscope, and MicrobeGPS. For Pathoscope and MicrobeGPS, we used two different reference genome sets, HMP and NCBI (see text). For each tool, we report the overall precision and sensitivity with respect to the ground truth. The maximum F-measure and the area under the ROC curve (AUC) were calculated comparing the <italic>N</italic> most abundant identifications to the ground truth. Highest scores are written in bold font. For Pathoscope, we manually applied a relative abundance cutoff of 10<sup>−5</sup>.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0117711.t001g" xlink:href="pone.0117711.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">
                  <bold>Method</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>Precision</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>Recall</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>F-measure</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>AUC</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaPhlAn</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.9048</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6129</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8372</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8738</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>mOTUs</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>1.0000</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.7619</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8649</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7619</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Pathoscope (NCBI)</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.3333</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.9524</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.5714</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8419</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Pathoscope (HMP)</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.3947</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7143</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7222</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7031</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MicrobeGPS (NCBI)</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.8261</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9048</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.9268</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.9032</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MicrobeGPS (HMP)</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.7500</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8571</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8372</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8503</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Pathoscope reports substantially longer lists of identified (and sometimes highly similar) reference genomes than the other tools. Often, it is not clear to the user if they are all in the sample or only some of them. To make the results of Pathoscope comparable, we only used the top 60 most abundant organisms for the comparison, which corresponds to a relative abundance cutoff of 10<sup>−5</sup>. For both NCBI and HMP references, MicrobeGPS reports better results than Pathoscope, both in terms of F-measure and AUC (see <xref ref-type="fig" rid="pone.0117711.g003">Fig. 3</xref>). Best performance is achieved with NCBI genomes, where MicrobeGPS correctly identified 19 among the first 20 reported organisms. MetaPhlAn is comparable to MicrobeGPS with HMP reference genomes and better than Pathoscope. Although mOTUs had no false positive identification, only 16 out of 21 organisms were found. Even more pronounced than in MetaPhlAn, mOTUs misses the low abundant organisms in the sample that are correctly captured by MicrobeGPS and Pathoscope. This had negative influence on the sensitivity of mOTUs, yielding a comparably low F-measure and AUC.</p>
      <fig id="pone.0117711.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0117711.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Evaluation of taxonomic profiling tools on <italic>in vitro</italic> metagenomes.</title>
          <p>We compared MicrobeGPS to Pathoscope [<xref rid="pone.0117711.ref005" ref-type="bibr">5</xref>], MetaPhlAn [<xref rid="pone.0117711.ref004" ref-type="bibr">4</xref>], and mOTUs [<xref rid="pone.0117711.ref010" ref-type="bibr">10</xref>] on the in vitro HMP mock community dataset [<xref rid="pone.0117711.ref021" ref-type="bibr">21</xref>] with known composition. The number of true and false positive identifications among the top <italic>N</italic>, <italic>N</italic> ≤ 60, reported organisms were counted and ROC curves were calculated. The large circle indicates the point of maximum F-measure for each method. MicrobeGPS outperforms the other methods both in terms of AUC and F-measure. MicrobeGPS in combination with the NCBI reference genomes provide the best results, both in terms of F-measure and AUC.</p>
        </caption>
        <graphic xlink:href="pone.0117711.g003"/>
      </fig>
      <p>The main error sources of MicrobeGPS are missing genomes in the reference databases and false positive identifications. For example, HMP lacks <italic>Streptococcus pneumoniae</italic> and <italic>Deinococcus radiodurans</italic> reference genomes. For <italic>D. radiodurans</italic>, MicrobeGPS and Pathoscope report the closest available relative, <italic>Deinococcus deserti</italic>. However, from the Pathoscope output it does not become clear that <italic>D. deserti</italic> is not a perfect match. In contrast, MicrobeGPS reports a low GDV score (0.02) and high mapping error rate (0.12) here, indicating that the candidate is distantly related but not identical to <italic>D. deserti</italic>. The number of false positive identifications from MicrobeGPS is lower than from Pathoscope or MetaPhlAn. On the other hand, MicrobeGPS identifies more correct organisms (NCBI: 19, HMP: 18) in the sample than mOTUs (16). Additionally, the false identifications receive low quality scores in MicrobeGPS and can therefore be spotted easily in the graphical user interface. However, we observed one exception, <italic>Stenotrophomonas maltophilia</italic>, which was detected by all three tools and received a considerably high (0.76) GDV score in MicrobeGPS, but was not listed in the MC dataset ground truth. The unique read matches to <italic>S. maltophilia</italic> were verfied via BLAST search. Therefore, we speculate that <italic>S. maltophilia</italic> was actually present in the sample, probably as contamination.</p>
      <p>While other <italic>Streptococci</italic> were present in the dataset and reported by the tools, the very low abundant <italic>S. pneumoniae</italic> was neither detected nor explained by a closely related genome by any of the tools. Instead, MicrobeGPS assigned the <italic>S. pneumoniae</italic> genome to the <italic>Streptococcus mutans</italic> candidate such that it could only be identified as separate organism via manual inspection of the reference genomes supporting the <italic>S. mutans</italic> candidate. Although MetaPhlAn should in principle be able to recover such situations, it fails to make the score and only reports one out of three <italic>Streptococci</italic>.</p>
      <p>Taken together, this experiment showed that MicrobeGPS is able to estimate microbial community compositions more accurately than previous approaches. In cases where the identified organism did not agree with the reference genomes, MicrobeGPS quantified the divergence between sequenced organism and reference genome with the GDV score. MicrobeGPS therefore allows differentiating between cases where the suitable reference genome was available and cases where a distantly related genome had to be selected as representative. This differentiation is not possible for MetaPhlAn and Pathoscope.</p>
    </sec>
    <sec id="sec003b">
      <title>Application to human gut microbiome</title>
      <p>We further analyzed three human gut metagenomes with MicrobeGPS to evaluate its potential on real data. The datasets (IDs 1122, 2535, and 2638) were acquired from diarrhea patients during the Shiga-toxigenic <italic>E. coli</italic> (STEC) outbreak in Germany, 2011 [<xref rid="pone.0117711.ref025" ref-type="bibr">25</xref>] and were downloaded from NCBI SRA (accessions ERX237457, ERX234998, ERX237461). The datasets contained between 332,257 and 879,176 paired-end reads with length 2×151 bp. Clinical tests identified a <italic>Clostridium difficile</italic> infection in dataset 1122 and high abundances of STEC in datasets 2535 and 2638. We reanalyzed the three datasets and used the NCBI bacterial genomes as reference database. For testing purposes, we also removed the STEC reference sequence from the set of reference genomes. The reads were mapped with Bowtie 2 using the same settings as in the first experiment. MicrobeGPS was configured to report genomes with at least one uniquely matching read.</p>
      <p>MicrobeGPS presented 41 candidate organisms for dataset 1122, indicating a higher complexity than the MC dataset. In accordance with the diagnosed <italic>C. difficile</italic> infection, we found a candidate supported by five <italic>C. difficile</italic> genomes and being closest related to <italic>C. difficile</italic> Bl9. However, the reported GDV score is low (0.23) and suggests that the infecting strain differs from all strains available in the database. Higher GDV scores are reported for candidates supported by <italic>Alistipes finegoldii</italic> (0.81) or <italic>Bacteroides vulgatus</italic> (0.79). The most abundant candidate (<italic>A. finegoldii</italic>, 232,090 reads) and the smallest highly relevant candidate (<italic>Eggerthella lenta</italic>, 80 reads) differ by a factor of 2901 in their abundance. Nevertheless, the typical gut bacterium <italic>E. lenta</italic> is a highly valid candidate since most reads mapped uniquely and the reads are homogeneously distributed over the genome (Kolmogorov-Smirnov test p-value below 0.05).</p>
      <p>The most abundant candidate in datasets 2535 and 2638 was closely related to <italic>E. coli</italic>, however, none of the supporting references could be identified as perfect match since STEC was not part of the reference database. When added to the database, STEC was the most abundant supporting genome and was identified as almost perfect match (GDV = 0.99), as shown in <xref ref-type="fig" rid="pone.0117711.g004">Fig. 4</xref>. This is contrasting to dataset 1122, where the <italic>E. coli</italic> candidate had lower abundance and the supporting reference genomes had lower GDV; the STEC genomes were not reported as supporting genomes for the <italic>E. coli</italic> candidate. Since <italic>E. coli</italic> is a common human gut bacterium, we expect that the non-pathogenic <italic>E. coli</italic> was also present in the datasets 2535 and 2638, but was assigned to the same candidate as the high abundant STEC due to the high sequence similarity. This challenging scenario could benefit follow-up analyses with tools specialized to differentiating highly similar organisms in metagenomic samples, such as GASiC [<xref rid="pone.0117711.ref026" ref-type="bibr">26</xref>]. Although no <italic>C. difficile</italic> infection was diagnosed for both samples, MicrobeGPS identified candidates mainly supported by <italic>C. difficile</italic> in both datasets, similarly to dataset 1122. This may not necessarily be wrong since <italic>C. difficile</italic> is a common gut bacterium, but shows that using this set of genomes does not allow the distinction between pathogenic and non-pathogenic <italic>C. difficile</italic> strains.</p>
      <fig id="pone.0117711.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0117711.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Identification of STEC strains in human gut metagenomes.</title>
          <p>Three human gut metagenome datasets [<xref rid="pone.0117711.ref025" ref-type="bibr">25</xref>], one of them without (1122) and two with STEC infection (2535, 2638), were analyzed with MicrobeGPS. MicrobeGPS identified one <italic>E. coli</italic>–related candidate in each dataset. In the datasets with STEC infection, MicrobeGPS finds the highest GDV scores for different STEC strains, showing almost perfect agreement between the sequenced organism and reference genome. In dataset 1122, MicrobeGPS only finds other <italic>E. coli</italic> strains with much lower GDV scores, indicating correctly that this sample was not infected with STEC.</p>
        </caption>
        <graphic xlink:href="pone.0117711.g004"/>
      </fig>
      <p>Altogether, this experiment demonstrated the ability of MicrobeGPS handling real data and identifying the correct strain if available and locating the candidate as good as possible otherwise.</p>
    </sec>
    <sec id="sec003c">
      <title>Reanalysis of Lake Lanier metagenome</title>
      <p>Our method is not restricted to the analysis of human-associated microbiomes and is particularly suitable for the exploration of communities with few known reference genomes. Therefore, we reanalyzed the Lake Lanier freshwater metagenome datasets (AUG1, AUG2, SEPT, NOV) [<xref rid="pone.0117711.ref027" ref-type="bibr">27</xref>, <xref rid="pone.0117711.ref028" ref-type="bibr">28</xref>], a series of four datasets from the same location at different time points. In the original study, the authors assessed the community composition by means of 16S rRNA gene amplicon sequencing and by assembling the metagenomic sequencing reads into contigs and subsequently identifying genes in the sequences. These genes were then searched in databases of all sequenced bacterial and archaeal genomes. Here, MicrobeGPS offers a third way, since the metagenomic sequencing reads are used directly to infer the composition of the community. Therefore, we downloaded the published datasets from NCBI SRA (accessions SRX039150, SRX039152, SRX039381, SRX039382). The dataset sizes were between 13.6 million (SEPT) and 17.1 million (NOV) 2×101 bp paired-end reads. The NCBI bacterial genomes served as reference database for MicrobeGPS and reads were mapped with Bowtie 2 using the same settings as in the previous experiments. MicrobeGPS was used with default settings.</p>
      <p>These datasets posed a particularly challenging problem to MicrobeGPS since only about 1% of the reads in each dataset could be mapped to the NCBI bacterial genomes database, indicating that the freshwater metagenome is still far less studied than other environments such as the human microbiome.</p>
      <p>MicrobeGPS identified between 165 and 238 candidate organisms per dataset from 15 bacterial phyla (see <xref ref-type="fig" rid="pone.0117711.g005">Fig. 5</xref>), indicating a much higher community complexity than the MC or STEC datasets. However, the MicrobeGPS quality measures clearly pointed out that the majority of detected candidates diverge strongly from the genomic material in the sample: The highest observed GDV score was 0.45 (<italic>Anabaena</italic> Sp. 90 in AUG1), but the majority of GDV scores were below 0.05. This indicates that the available reference genome sequences are not suitable for species accurate identification in these datasets and the low scores warn the user that each individual candidate should be treated with caution.</p>
      <fig id="pone.0117711.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0117711.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>High level taxonomic analysis of freshwater metagenome.</title>
          <p>We estimated the composition of the four Lake Lanier metagenomic time series datasets [<xref rid="pone.0117711.ref027" ref-type="bibr">27</xref>] on the phylum level (<italic>Proteobacteria</italic> were expanded to the class level), since species accurate identification was not possible due to low coverage and insufficient similarity to reference genomes. MicrobeGPS detected all phyla reported in the original study based on 16S amplicons and assembled contigs with comparable abundances and showed temporal abundance shifts similar to the other approaches.</p>
        </caption>
        <graphic xlink:href="pone.0117711.g005"/>
      </fig>
      <p>Nevertheless, when looking at a more coarse level, we obtained more meaningful results and our observations largely agreed with the results presented in the original studies. Both approaches reported <italic>Proteobacteria</italic> as the most abundant phylum and all originally reported phyla were also identified by MicrobeGPS. Our overall estimated abundances show patterns similar to the assembled contigs approach presented in File S1, Figure S4 in [<xref rid="pone.0117711.ref028" ref-type="bibr">28</xref>]. Also the temporal variations could be reproduced with MicrobeGPS: while the relative abundances of <italic>Proteobacteria</italic>, <italic>Actinobacteria</italic> and <italic>Verrucomicrobia</italic> were relatively stable over all datasets, we also observed a significant drop of abundance for <italic>Cyanobacteria</italic> in the NOV dataset and an increase of <italic>Bacteroidetes. Planctomycetes</italic>, which were hardly detected in the 16S analysis, show highest abundances in the SEPT dataset in both the assembly based and MicrobeGPS analysis.</p>
      <p>However, we also observed that the structure of the reference genome database influenced the relative abundance quantification of the different phyla. The 16S approach detected higher fractions of <italic>Cyanobacteria</italic> and <italic>Verrucomicrobia</italic> than MicrobeGPS, but lower fractions of <italic>Proteobacteria</italic>. We attribute this skew to the uneven representation of the phyla in the reference database: the database contained 1104 <italic>Proteobacteria</italic> genomes, but only 71 <italic>Cyanobacteria</italic> and 4 <italic>Verrucomicrobia</italic> genomes. This limitation is inherent to reference genome based approaches and was also observed in the assembly based analysis [<xref rid="pone.0117711.ref028" ref-type="bibr">28</xref>].</p>
      <p>For comparison, we profiled the four Lake Lanier datasets with MetaPhlAn and compared the results to the analysis in the original study and to MicrobeGPS. We used the reference sequence database provided by MetaPhlAn in combination with the Bowtie 2 mapper, as suggested in the MetaPhlAn manual. MetaPhlAn was configured to report abundances for all taxonomic levels (—tax_lev = a). All datasets were analyzed separately. The estimated abundances are shown in <xref rid="pone.0117711.t002" ref-type="table">Table 2</xref>.</p>
      <table-wrap id="pone.0117711.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0117711.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Reanalysis of the Lake Lanier metagenomic datasets with MetaPhlAn.</title>
          <p>The numbers are the estimated percentage abundances on the phylum level. A dash indicates that the phylum was not detected by MetaPhlAn in the dataset.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0117711.t002g" xlink:href="pone.0117711.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">
                  <bold>Dataset</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>AUG1</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>AUG2</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>SEPT</bold>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <bold>NOV</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Cyanobacteria</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">73.3</td>
                <td align="left" rowspan="1" colspan="1">59.9</td>
                <td align="left" rowspan="1" colspan="1">59.3</td>
                <td align="left" rowspan="1" colspan="1">3.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Proteobacteria</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">14.2</td>
                <td align="left" rowspan="1" colspan="1">19.9</td>
                <td align="left" rowspan="1" colspan="1">30.7</td>
                <td align="left" rowspan="1" colspan="1">74.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Bacteroidetes</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">9.5</td>
                <td align="left" rowspan="1" colspan="1">10.1</td>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">14.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Chlamydiae</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">1.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Actinobacteria</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">7.1</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Chloroflexi</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">-</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In contrast to MicrobeGPS, MetaPhlAn detected only 3–5 phyla and 6–9 different species with varying abundances in the datasets without providing any information about the accuracy of the results. These results suggest a community complexity far lower than what one would expect for a freshwater metagenome and than what was observed in the original study and the MicrobeGPS analysis. Furthermore, most MetaPhlAn abundance estimates do not coincide with the other approaches. For example, <italic>Cyanobacteria</italic> abundance was estimated between 59% and 74% in the first three datasets, three times higher than MicrobeGPS. <italic>Actinobacteria</italic> were only detected in AUG2 and NOV and <italic>Verrucomicrobia</italic> were not found at all, although the two other approaches reported considerable abundances for both phyla in all datasets.</p>
      <p>This experiment showed that MicrobeGPS estimates microbial community compositions similarly to traditional approaches like manual assembly and 16S based taxonomic profiling even on challenging datasets, where other methods have severe problems.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec004">
    <title>Discussion</title>
    <p>Reference based taxonomic profiling is currently the most accurate way of assessing the composition of microbial communities as it allows—in principle—strain accurate identification of organisms in metagenomes. However, current tools tend to overestimate their accuracy as they report a specific strain or species as present when the dataset contains a previously unknown related organism. We demonstrated that the user has in practice no possibility to differentiate between cases with strain accurate identification and identification of a related organism.</p>
    <p>Therefore, we introduced MicrobeGPS, a novel approach to the taxonomic profiling problem which is beneficial in two ways. First, MicrobeGPS provides more accurate community composition estimates than other reference based methods. Second and more important, MicrobeGPS identifies candidate organisms by their sequencing depth and recruits known reference genomes supporting the candidate. The quality measures calculated for each detected candidate organism allow the user to judge the quality and reliability of the identification. Thereby, unknown organisms that are not represented in current reference genome collections can be evaluated critically and their supporting reference genomes provide valuable information about the organism’s taxonomic affiliation. Here, MicrobeGPS is far ahead of related tools that only report estimated abundances for hundreds of genomes without any other quality information, and thus contributes to the trustworthiness of already powerful reference-based metagenomic analyses.</p>
    <p>The GDV score turned out as a valuable measure of sequence disagreement, quantifying similarity between the organism in the sample and the available reference genome. Compared to the average nucleotide identity (ANI, see [<xref rid="pone.0117711.ref029" ref-type="bibr">29</xref>]), a common measure for genomic similarity which only operates on the regions shared between genomes, the GDV score is designed to compare an existing genome to a set of sequencing reads and is particularly applicable when the genome shares only small regions with the sequenced organism. If the only similarity between the sequenced organism and the reference genomes is a single gene transferred with only very few mutations from one of the species available as reference to the organism in the sample, the ANI assigns a high identity as it only considers regions shared between the genomes. In contrast, the GDV is close to zero since only a very small part of the whole reference genome is actually present in the dataset.</p>
    <p>Our experiments demonstrated that MicrobeGPS provides more concise and accurate results than previous approaches on <italic>in vitro</italic> microbial communities with known composition. On real datasets, MicrobeGPS is able to provide strain accurate identifications for well-studied species (such as <italic>E. coli</italic>) with sufficient reference genomes and at the same time coarse identification of organisms where no perfectly matching reference genome is available. This dynamic adaptation to the structure of the reference genome set is comparable to lowest common ancestor approaches while being more informative about the quality and reliability of each candidate. When no accurate identification on low taxonomic levels is possible, as in the Lake Lanier experiment, the user can analyze the dataset on a higher level (e.g. <italic>phylum</italic>). Here, MicrobeGPS produces community composition estimates that are comparable to established approaches involving assembly of the sequence reads into contigs or the analysis of 16S rRNA amplicon data.</p>
    <p>The benefits of MicrobeGPS come at the cost of an increased run time and memory footprint: on the same hardware Pathoscope is about 50% faster than MicrobeGPS. Approximately one third of the run time is used to map the reads, one third to transform the SAM file into the datastructures required by MicrobeGPS, and the last third to calculate the GDV scores and the clustering. The interactive graphical user interface requires that all mapping information is kept in memory. The memory consumption strongly depends on the number of shared read matches; in our experiments we observed peak memory consumptions between 1 GB (Lake Lanier datasets) and 38 GB (MC dataset). Thus, smaller datasets can be processed on a laptop computer while larger datasets may require a larger (e.g. workstation) computer.</p>
    <p>In particular in comparison to other taxonomic profiling methods, such as MetaPhlAn, Kraken, or Taxy [<xref rid="pone.0117711.ref030" ref-type="bibr">30</xref>], it would be desirable for MicrobeGPS to have lower runtime. However, the advantage of MicrobeGPS over other methods originates from taking full advantage of the whole reference genome sequence. Therefore, a strategy as used in MetaPhlAn would not be applicable. Yet, a k-mer based approach, as used in Kraken or Taxy, might also be applicable for MicrobeGPS. Instead of searching for core reads (CR), one could search for core words, i.e. k-mers found in different metagenomes with similar coverage. In our opinion, such an approach could have the potential to speed up MicrobeGPS while possibly keeping the strength of the current, alignment-based method.</p>
    <p>Despite the significant improvement on the status quo, MicrobeGPS still suffers from a problem that is common to all reference based taxonomic profiling approaches—the influence of the reference database. Especially in the two real data experiments, we saw that MicrobeGPS is able to identify on species or strain level when the database contains sufficient reference genomes, but only finds distantly related organisms if no suitable reference genome is available. Furthermore, unbalanced databases skew the abundance estimates, where taxonomic groups with many reference genomes appear more abundant than groups with few reference genomes. However, MicrobeGPS reduced the influence of the reference genome database in comparison to recent methods and makes the problem of missing reference genomes tractable.</p>
    <p>While reference based taxonomic profiling could previously only be applied to microbial communities with known structure where the reference genomes of the most dominant organisms are known, our experiments demonstrated that MicrobeGPS can also be used for taxonomic profiling of less explored communities such as the Lake Lanier metagenome. This result in combination with the growing databases of reference genomes could pave the way for the application of reference based taxonomic profiling beyond applications such as clinical diagnostics [<xref rid="pone.0117711.ref005" ref-type="bibr">5</xref>]. Compared to traditional methods such as 16S rRNA based profiling or lowest common ancestor approaches, we showed that our method has the advantage that strain specific identification is in principle possible, but can fall back to more coarse identifications when reference genomes are missing. Yet, the approach may still not be applicable to microbial communities with extremely complex composition and only few known genomes, such as soil metagenomes.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec005">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0117711.s001">
      <label>S1 Text</label>
      <caption>
        <title>Sequencing depth estimation for low abundant organisms.</title>
        <p>The framework introduced in [<xref rid="pone.0117711.ref012" ref-type="bibr">12</xref>] allows estimating the local sequencing depth and GDV score of a reference genome down to 0.2× sequencing depth. Here, we present an extension of the framework such that sequencing depths and GDV scores of genomes with down to 0.01× sequencing depth can be estimated.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0117711.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Temesgen H. Dadi (Freie Universität Berlin) for contributing the command line interface of MicrobeGPS.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0117711.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Mason</surname><given-names>OU</given-names></name>, <name><surname>Hazen</surname><given-names>TC</given-names></name>, <name><surname>Borglin</surname><given-names>S</given-names></name>, <name><surname>Chain</surname><given-names>PS</given-names></name>, <name><surname>Dubinsky</surname><given-names>EA</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Metagenome, metatranscriptome and single-cell sequencing reveal microbial response to Deepwater Horizon oil spill</article-title>. <source>ISME J</source>
<volume>6</volume>: <fpage>1715</fpage>–<lpage>1727</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2012.59</pub-id>
<pub-id pub-id-type="pmid">22717885</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Dodsworth</surname><given-names>JA</given-names></name>, <name><surname>Blainey</surname><given-names>PC</given-names></name>, <name><surname>Murugapiran</surname><given-names>SK</given-names></name>, <name><surname>Swingley</surname><given-names>WD</given-names></name>, <name><surname>Ross</surname><given-names>CA</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Single-cell and metagenomic analyses indicate a fermentative and saccharolytic lifestyle for members of the OP9 lineage</article-title>. <source>Nat Commun</source>
<volume>4</volume>: <fpage>1854</fpage>
<pub-id pub-id-type="doi">10.1038/ncomms2884</pub-id>
<pub-id pub-id-type="pmid">23673639</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Nagarajan</surname><given-names>N</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>Sequence assembly demystified</article-title>. <source>Nature Reviews Genetics</source>
<volume>14</volume>: <fpage>157</fpage>–<lpage>167</lpage>. <pub-id pub-id-type="doi">10.1038/nrg3367</pub-id>
<?supplied-pmid 23358380?><pub-id pub-id-type="pmid">23358380</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Segata</surname><given-names>N</given-names></name>, <name><surname>Waldron</surname><given-names>L</given-names></name>, <name><surname>Ballarini</surname><given-names>A</given-names></name>, <name><surname>Narasimhan</surname><given-names>V</given-names></name>, <name><surname>Jousson</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>. <source>Nat Methods</source>
<volume>9</volume>: <fpage>811</fpage>–<lpage>814</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2066</pub-id>
<?supplied-pmid 22688413?><pub-id pub-id-type="pmid">22688413</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Francis</surname><given-names>OE</given-names></name>, <name><surname>Bendall</surname><given-names>M</given-names></name>, <name><surname>Manimaran</surname><given-names>S</given-names></name>, <name><surname>Hong</surname><given-names>C</given-names></name>, <name><surname>Clement</surname><given-names>NL</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Pathoscope: species identification and strain attribution with unassembled sequencing data</article-title>. <source>Genome Res</source>
<volume>23</volume>: <fpage>1721</fpage>–<lpage>1729</lpage>. <pub-id pub-id-type="doi">10.1101/gr.150151.112</pub-id>
<?supplied-pmid 23843222?><pub-id pub-id-type="pmid">23843222</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Bonfert</surname><given-names>T</given-names></name>, <name><surname>Csaba</surname><given-names>G</given-names></name>, <name><surname>Zimmer</surname><given-names>R</given-names></name>, <name><surname>Friedel</surname><given-names>CC</given-names></name> (<year>2013</year>) <article-title>Mining RNA–seq data for infections and contaminations</article-title>. <source>PLOS ONE</source>
<volume>8</volume>: <fpage>e73071</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0073071</pub-id>
<?supplied-pmid 24019895?><pub-id pub-id-type="pmid">24019895</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wood</surname><given-names>D</given-names></name>, <name><surname>Salzberg</surname><given-names>S</given-names></name> (<year>2014</year>) <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>
<volume>15</volume>: <fpage>R46</fpage>
<pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
<?supplied-pmid 24580807?><pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Von Mering</surname><given-names>C</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <name><surname>Tringe</surname><given-names>S</given-names></name>, <name><surname>Doerks</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Quantitative phylogenetic assessment of microbial communities in diverse environments</article-title>. <source>Science</source>
<volume>315</volume>: <fpage>1126</fpage>–<lpage>1130</lpage>. <pub-id pub-id-type="doi">10.1126/science.1133420</pub-id>
<?supplied-pmid 17272687?><pub-id pub-id-type="pmid">17272687</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Simon</surname><given-names>C</given-names></name>, <name><surname>Daniel</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>Metagenomic analyses: past and future trends</article-title>. <source>Appl Environ Microbiol</source>
<volume>77</volume>: <fpage>1153</fpage>–<lpage>1161</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.02345-10</pub-id>
<?supplied-pmid 21169428?><pub-id pub-id-type="pmid">21169428</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Mende</surname><given-names>DR</given-names></name>, <name><surname>Zeller</surname><given-names>G</given-names></name>, <name><surname>Izquierdo-Carrasco</surname><given-names>F</given-names></name>, <name><surname>Berger</surname><given-names>SA</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>. <source>Nat Methods</source>
<volume>10</volume>: <fpage>1196</fpage>–<lpage>1199</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2693</pub-id>
<?supplied-pmid 24141494?><pub-id pub-id-type="pmid">24141494</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>YW</given-names></name>, <name><surname>Ye</surname><given-names>Y</given-names></name> (<year>2011</year>) <article-title>A novel abundance-based algorithm for binning metagenomic sequences using l-tuples</article-title>. <source>J Comp Biol</source>
<volume>18</volume>: <fpage>523</fpage>–<lpage>534</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2010.0245</pub-id>
</mixed-citation>
    </ref>
    <ref id="pone.0117711.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Lindner</surname><given-names>MS</given-names></name>, <name><surname>Kollock</surname><given-names>M</given-names></name>, <name><surname>Zickmann</surname><given-names>F</given-names></name>, <name><surname>Renard</surname><given-names>BY</given-names></name> (<year>2013</year>) <article-title>Analyzing genome coverage profiles with applications to quality control in metagenomics</article-title>. <source>Bioinformatics</source>
<volume>29</volume>: <fpage>1260</fpage>–<lpage>1267</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt147</pub-id>
<?supplied-pmid 23589648?><pub-id pub-id-type="pmid">23589648</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Auch</surname><given-names>AF</given-names></name>, <name><surname>Qi</surname><given-names>J</given-names></name>, <name><surname>Schuster</surname><given-names>SC</given-names></name> (<year>2007</year>) <article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>
<volume>17</volume>: <fpage>377</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id>
<?supplied-pmid 17255551?><pub-id pub-id-type="pmid">17255551</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Metzker</surname><given-names>ML</given-names></name> (<year>2009</year>) <article-title>Sequencing technologies–the next generation</article-title>. <source>Nat Rev Genet</source>
<volume>11</volume>: <fpage>31</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2626</pub-id>
<?supplied-pmid 19997069?><pub-id pub-id-type="pmid">19997069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2012</year>) <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>
<volume>9</volume>: <fpage>357</fpage>–<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
<?supplied-pmid 22388286?><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Sedlazeck</surname><given-names>FJ</given-names></name>, <name><surname>Rescheneder</surname><given-names>P</given-names></name>, <name><surname>von Haeseler</surname><given-names>A</given-names></name> (<year>2013</year>) <article-title>NextGenMap: fast and accurate read mapping in highly polymorphic genomes</article-title>. <source>Bioinformatics</source>
<volume>29</volume>: <fpage>2790</fpage>–<lpage>2791</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt468</pub-id>
<?supplied-pmid 23975764?><pub-id pub-id-type="pmid">23975764</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Siragusa</surname><given-names>E</given-names></name>, <name><surname>Weese</surname><given-names>D</given-names></name>, <name><surname>Reinert</surname><given-names>K</given-names></name> (<year>2013</year>) <article-title>Fast and accurate read mapping with approximate seeds and multiple backtracking</article-title>. <source>Nucleic Acids Res</source>
<volume>41</volume>: <fpage>e78</fpage>–<lpage>e78</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt005</pub-id>
<?supplied-pmid 23358824?><pub-id pub-id-type="pmid">23358824</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Lambert</surname><given-names>D</given-names></name> (<year>1992</year>) <article-title>Zero-inflated Poisson regression, with an application to defects in manufacturing</article-title>. <source>Technometrics</source>
<volume>34</volume>: <fpage>1</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.2307/1269547</pub-id>
</mixed-citation>
    </ref>
    <ref id="pone.0117711.ref019">
      <label>19</label>
      <mixed-citation publication-type="book"><name><surname>MacQueen</surname><given-names>J</given-names></name> (<year>1967</year>) <article-title>Some methods for classification and analysis of multivariate observations</article-title>. In: <source>Proceedings of the fifth Berkeley symposium on mathematical statistics and probability</source>. <publisher-loc>California, USA</publisher-loc>, <volume>volume 1</volume>, pp. <fpage>281</fpage>–<lpage>297</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0117711.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>SC</given-names></name> (<year>1967</year>) <article-title>Hierarchical clustering schemes</article-title>. <source>Psychometrika</source>
<volume>32</volume>: <fpage>241</fpage>–<lpage>254</lpage>. <pub-id pub-id-type="doi">10.1007/BF02289588</pub-id>
<?supplied-pmid 5234703?><pub-id pub-id-type="pmid">5234703</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Methé</surname><given-names>BA</given-names></name>, <name><surname>Nelson</surname><given-names>KE</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>, <name><surname>Creasy</surname><given-names>HH</given-names></name>, <name><surname>Giglio</surname><given-names>MG</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>A framework for human microbiome research</article-title>. <source>Nature</source>
<volume>486</volume>: <fpage>215</fpage>–<lpage>221</lpage>. <pub-id pub-id-type="doi">10.1038/nature11209</pub-id>
<pub-id pub-id-type="pmid">22699610</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Nelson</surname><given-names>KE</given-names></name>, <name><surname>Weinstock</surname><given-names>GM</given-names></name>, <name><surname>Highlander</surname><given-names>SK</given-names></name>, <name><surname>Worley</surname><given-names>KC</given-names></name>, <name><surname>Creasy</surname><given-names>HH</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>A catalog of reference genomes from the human microbiome</article-title>. <source>Science</source>
<volume>328</volume>: <fpage>994</fpage>–<lpage>999</lpage>. <pub-id pub-id-type="doi">10.1126/science.1183605</pub-id>
<?supplied-pmid 20489017?><pub-id pub-id-type="pmid">20489017</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Pruitt</surname><given-names>KD</given-names></name>, <name><surname>Tatusova</surname><given-names>T</given-names></name>, <name><surname>Brown</surname><given-names>GR</given-names></name>, <name><surname>Maglott</surname><given-names>DR</given-names></name> (<year>2012</year>) <article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>D130</fpage>–<lpage>D135</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr1079</pub-id>
<?supplied-pmid 22121212?><pub-id pub-id-type="pmid">22121212</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref024">
      <label>24</label>
      <mixed-citation publication-type="book"><name><surname>Van Rijsbergen</surname><given-names>CJ</given-names></name> (<year>1979</year>) <source>Information Retrieval</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Butterworths</publisher-name>, <edition>2nd edition</edition>.</mixed-citation>
    </ref>
    <ref id="pone.0117711.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Loman</surname><given-names>NJ</given-names></name>, <name><surname>Constantinidou</surname><given-names>C</given-names></name>, <name><surname>Christner</surname><given-names>M</given-names></name>, <name><surname>Rohde</surname><given-names>H</given-names></name>, <name><surname>Chan</surname><given-names>JZM</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>A culture-independent sequence-based metagenomics approach to the investigation of an outbreak of shiga-toxigenic Escherichia coli O104:H4</article-title>. <source>JAMA</source>
<volume>309</volume>: <fpage>1502</fpage>–<lpage>1510</lpage>. <pub-id pub-id-type="doi">10.1001/jama.2013.3231</pub-id>
<?supplied-pmid 23571589?><pub-id pub-id-type="pmid">23571589</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Lindner</surname><given-names>MS</given-names></name>, <name><surname>Renard</surname><given-names>BY</given-names></name> (<year>2013</year>) <article-title>Metagenomic abundance estimation and diagnostic testing on species level</article-title>. <source>Nucleic Acids Res</source>
<volume>41</volume>: <fpage>e10</fpage>
<pub-id pub-id-type="doi">10.1093/nar/gks803</pub-id>
<?supplied-pmid 22941661?><pub-id pub-id-type="pmid">22941661</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Oh</surname><given-names>S</given-names></name>, <name><surname>Caro-Quintero</surname><given-names>A</given-names></name>, <name><surname>Tsementzi</surname><given-names>D</given-names></name>, <name><surname>DeLeon-Rodriguez</surname><given-names>N</given-names></name>, <name><surname>Luo</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Metagenomic insights into the evolution, function, and complexity of the planktonic microbial community of Lake Lanier, a temperate freshwater ecosystem</article-title>. <source>Appl Environ Microbiol</source>
<volume>77</volume>: <fpage>6000</fpage>–<lpage>6011</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.00107-11</pub-id>
<?supplied-pmid 21764968?><pub-id pub-id-type="pmid">21764968</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Poretsky</surname><given-names>R</given-names></name>, <name><surname>Rodriguez-R</surname><given-names>LM</given-names></name>, <name><surname>Luo</surname><given-names>C</given-names></name>, <name><surname>Tsementzi</surname><given-names>D</given-names></name>, <name><surname>Konstantinidis</surname><given-names>KT</given-names></name> (<year>2014</year>) <article-title>Strengths and limitations of 16S rRNA gene amplicon sequencing in revealing temporal microbial community dynamics</article-title>. <source>PLOS ONE</source>
<volume>9</volume>: <fpage>e93827</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0093827</pub-id>
<?supplied-pmid 24714158?><pub-id pub-id-type="pmid">24714158</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Konstantinidis</surname><given-names>KT</given-names></name>, <name><surname>Tiedje</surname><given-names>JM</given-names></name> (<year>2005</year>) <article-title>Genomic insights that advance the species definition for prokaryotes</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>102</volume>: <fpage>2567</fpage>–<lpage>2572</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0409727102</pub-id>
<?supplied-pmid 15701695?><pub-id pub-id-type="pmid">15701695</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0117711.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Meinicke</surname><given-names>P</given-names></name>, <name><surname>Aßhauer</surname><given-names>KP</given-names></name>, <name><surname>Lingner</surname><given-names>T</given-names></name> (<year>2011</year>) <article-title>Mixture models for analysis of the taxonomic composition of metagenomes</article-title>. <source>Bioinformatics</source>
<volume>27</volume>: <fpage>1618</fpage>–<lpage>1624</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr266</pub-id>
<?supplied-pmid 21546400?><pub-id pub-id-type="pmid">21546400</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
