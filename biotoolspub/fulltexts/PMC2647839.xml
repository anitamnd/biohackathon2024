<?properties open_access?>
<?properties no_embargo?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title>Bioinformatics</journal-title>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2647839</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp017</article-id>
    <article-id pub-id-type="publisher-id">btp017</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AssociationViewer: a scalable and integrated software tool for visualization of large-scale variation data in genomic context</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Martin</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valsesia</surname>
          <given-names>Armand</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Telenti</surname>
          <given-names>Amalio</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xenarios</surname>
          <given-names>Ioannis</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stevenson</surname>
          <given-names>Brian J.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Swiss Institute of Bioinformatics, <sup>2</sup>Ludwig Institute for Cancer Research, 1015 Lausanne and <sup>3</sup>Institute of Microbiology, University Hospital, University of Lausanne, 1011 Lausanne, Switzerland</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: John Quackenbush</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>3</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>1</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>1</month>
      <year>2009</year>
    </pub-date>
    <volume>25</volume>
    <issue>5</issue>
    <fpage>662</fpage>
    <lpage>663</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>9</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>12</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>1</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Author(s)</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> We present a tool designed for visualization of large-scale genetic and genomic data exemplified by results from genome-wide association studies. This software provides an integrated framework to facilitate the interpretation of SNP association studies in genomic context. Gene annotations can be retrieved from Ensembl, linkage disequilibrium data downloaded from HapMap and custom data imported in BED or WIG format. AssociationViewer integrates functionalities that enable the aggregation or intersection of data tracks. It implements an efficient cache system and allows the display of several, very large-scale genomic datasets.</p>
      <p><bold>Availability:</bold> The Java code for AssociationViewer is distributed under the GNU General Public Licence and has been tested on Microsoft Windows XP, MacOSX and GNU/Linux operating systems. It is available from the SourceForge repository. This also includes Java webstart, documentation and example datafiles.</p>
      <p>
        <bold>Contact:</bold>
        <email>brian.stevenson@licr.org</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp017/DC1">Supplementary data</ext-link> are available at <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/associationview/">http://sourceforge.net/projects/associationview/</ext-link> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Advances in genotyping platforms have enabled the identification of millions of single nucleotide polymorphism (SNPs) in the human genome, which are intensively used to study the impact of genomic variation on phenotype. Dedicated software like WGAViewer (Ge <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>) was developed to facilitate the interpretation of results from early genome-wide association (GWA) studies. Recent dramatic increases in array resolution—the latest Affymetrix and Illumina arrays offer more than 1.8 M features—have created a novel and immediate need for efficient and scalable visualization tools. Scientists and clinicians strongly rely on such tools to interpret their results, while bioinformaticians need scalable applications to check the results from their high-throughput analyses. In this context, we have developed AssociationViewer, a software tool for visualization of GWA studies in genomic context. The program can efficiently handle large genomic datasets, is extensible to any genomic data represented in BED or WIG format and implements aggregation (union) or intersection of data tracks.</p>
  </sec>
  <sec id="SEC2">
    <title>2 PROGRAM OVERVIEW</title>
    <sec id="SEC2.1">
      <title>2.1 Cache and memory management</title>
      <p>With increasing data volumes, efficient resource management is essential. One approach is to store the data in a cache with fast indexing mechanisms to retrieve the data, and to keep in memory only the information that is visualized. We implemented such a system in AssociationViewer. For comparison, loading a single dataset with 500 K SNPs in WGAViewer needs about 224 MB of RAM, whereas loading 10 different datasets (a total of 10 M data points) and displaying all genes on chromosome 1 needs only 50 MB in AssociationViewer.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Data import and export</title>
      <p>A typical GWA dataset consists of a list of SNPs with <italic>P</italic>-values derived from an association analysis. In AssociationViewer, such data can be imported from PLINK (Purcell <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007</xref>) output or other text files. Import of data in BED and WIG format is also possible (<xref ref-type="fig" rid="F1">Fig. 1</xref>C). These formats are extensively used by the bioinformatics community and in the UCSC genome browser (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2002</xref>) to describe genomic and transcriptomic data. BED describes gene features, whereas WIG allows representation of any single position associated with a score (<xref ref-type="fig" rid="F1">Fig. 1</xref>A1). AssociationViewer allows export in WIG format (<xref ref-type="fig" rid="F1">Fig. 1</xref>F). Window images can also be exported in many popular formats.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>General view of AssociationViewer (<bold>A</bold> and <bold>B</bold>). Also displayed are the input files (<bold>C</bold>), annotation data downloaded (<bold>D</bold>), cross-references (<bold>E</bold>) and export format (<bold>F</bold>).</p></caption><graphic xlink:href="btp017f1"/></fig>
</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Annotation retrieval</title>
      <p>Gene and transcript data (<xref ref-type="fig" rid="F1">Fig. 1</xref>A3) can be downloaded from Ensembl (Hubbard <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2007</xref>) and Biomart (Kasprzyk <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2004</xref>). Tag SNPs can be retrieved from the Hapmap website (The International HapMap Consortium, <xref ref-type="bibr" rid="B9">2007</xref>) (<xref ref-type="fig" rid="F1">Fig. 1</xref>D). The user can choose to connect to Ensembl or HapMap releases for NCBI Builds 35 or 36.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Genome navigation and data interaction</title>
      <p>Navigation in AssociationViewer is intuitive (<xref ref-type="fig" rid="F1">Fig. 1</xref>A). The user selects a chromosome either by clicking on the appropriate ideogram or via genomic coordinates. Scrolling or zooming is done via a mouse or the appropriate icons. One can search for SNPs, either by providing IDs, a coordinate range, a score cut-off or a list of neighbouring genes. Genes are found using similar options except that there is no score-based filter. Retrieved data (position, function description) are displayed in a table (<xref ref-type="fig" rid="F1">Fig. 1</xref>B) which includes cross-references to Ensembl (Hubbard <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2007</xref>), IntAct (Kerien <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2007</xref>), iHop (Fernández <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2007</xref>), dbSNP (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/">http://www.ncbi.nlm.nih.gov/</ext-link>), STRING (Von Mering <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2007</xref>) (<xref ref-type="fig" rid="F1">Fig. 1</xref>E). The sequence surrounding a SNP and any associated SNPs can be downloaded and displayed in a table summary and in a linkage disequilibrium (LD) plot (<xref ref-type="fig" rid="F1">Fig. 1</xref>A2).</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 GWA specialized functions</title>
      <p>To better understand the distribution of GWA <italic>P</italic>-values, AssociationViewer can produce QQ plots to identify where a SNP's <italic>P</italic>-value strongly deviates from random expectation. To compare SNP <italic>P</italic>-values between different data tracks, it can generate a Manhattan plot. To rank SNPs with highly significant <italic>P</italic>-values and obtain information for possible gene candidates, it can generate a ‘top hit’ report.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Track merging—aggregation and intersection</title>
      <p>When browsing multiple tracks, it can become tedious to visualize a region of interest. Merging two or more tracks can help this situation. In AssociationViewer WIG (score) tracks are aggregated in two steps: (i) within each track, set all values to 1 if they are greater than the mean score for that track, otherwise set them to 0; (ii) sum the discretized values at each position over all tracks. BED (gene) tracks are aggregated by merging features together and providing a colour code representing the overlap density.</p>
      <p>Intersection between WIG tracks is also possible, generating a tabulated report of common positions and scores. This is useful when comparing GWA results from different studies on the same phenotype. For example, intersecting SNPs with significant <italic>P</italic>-values from different GWAs and deriving a top hit report will sort these SNPs by the number of times they were replicated in the different GWAs. This is a useful functionality to integrate different studies, to reduce the data complexity and to facilitate interpretation of the results.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions|discussion" id="SEC3">
    <title>3 CONCLUSION AND DISCUSSION</title>
    <p>AssociationViewer is a flexible software tool that permits visualization of GWA data. It implements essential features such as a ‘top hits’ report, SNP annotation retrieval, QQ and LD plots. Any genomic or transcriptomic data represented in BED or WIG format can be imported. Genomic annotation can be downloaded from Ensembl, BioMart and Hapmap.</p>
    <p>The ability to handle very large datasets is often limited in visualization software. We optimized resource management by using an efficient cache system and limiting the amount of information held in memory. As a result, our software performs remarkably well when simultaneously visualizing several large-scale GWA datasets.</p>
    <p>The aggregation and intersection of data tracks are useful functionalities to reduce data complexity. The intersection feature report offers the possibility to integrate and visualize results from different studies. As a proof of concept, simple aggregation methods were implemented in the current version of AssociationViewer, but more elaborate algorithms will be developed in future versions.</p>
    <p>Dedicated resources for SNP and copy number variant datasets are being set up [e.g. Ensembl Variation, European Genotype Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ega/">http://www.ebi.ac.uk/ega/</ext-link>), Database of Genomic Variants (Iafrate <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2004</xref>)]. Once connection to these resources is possible, we plan to enable queries via the API to visualize results within AssociationViewer.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="btp017_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="btp017_bioinf-2008-1495-File002.doc"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="btp017_bioinf-2008-1495-File003.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Nicolas Guex for helpful input on the features and usability of AssociationViewer, Sébastien Moretti and Laurent Falquet for testing the software and Victor Jongeneel for encouragement and support. We also thank Dongliang Ge and David Goldstein (Duke University) for discussions during the early stages of this work.</p>
    <p><italic>Funding</italic>: Swiss National Science Foundation; Infectigen; University of Lausanne; Swiss Institute of Bioinformatics; Ludwig Institute for Cancer Research.</p>
    <p><italic>Conflict of Interest</italic>: none declared</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernández</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iHOP Web services</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>W21</fpage>
        <lpage>W26</lpage>
        <pub-id pub-id-type="pmid">17485473</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ge</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WGAViewer: software for genomic annotation of whole genome association studies</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>640</fpage>
        <lpage>643</lpage>
        <pub-id pub-id-type="pmid">18256235</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubbard</surname>
            <given-names>TJP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2007</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D610</fpage>
        <lpage>D617</lpage>
        <pub-id pub-id-type="pmid">17148474</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iafrate</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of large-scale variation in the human genome</article-title>
        <source>Nat. Genet.</source>
        <year>2004</year>
        <volume>36</volume>
        <fpage>949</fpage>
        <lpage>951</lpage>
        <pub-id pub-id-type="pmid">15286789</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kasprzyk</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EnsMart: a generic system for fast and flexible access to biological data</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>160</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="pmid">14707178</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerien</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IntAct—open source resource for molecular interaction data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D561</fpage>
        <lpage>D565</lpage>
        <pub-id pub-id-type="pmid">17145710</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: a toolset for whole-genome association and population-based linkage analysis</article-title>
        <source>Am. J. Hum. Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <collab>The International HapMap Consortium</collab>
        <article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>851</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Von Mering</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STRING 7—recent developments in the integration and prediction of protein interactions</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D358</fpage>
        <lpage>D362</lpage>
        <pub-id pub-id-type="pmid">17098935</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
