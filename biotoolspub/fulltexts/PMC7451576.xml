<?properties open_access?>
<?subarticle pone.0238108.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7451576</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238108</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-20-12646</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Malignant Tumors</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Forecasting</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Forecasting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Basic Cancer Research</subject>
            <subj-group>
              <subject>Cancer Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genomic Medicine</subject>
              <subj-group>
                <subject>Cancer Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Human Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Genome Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
            <subj-group>
              <subject>Alleles</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Shiny-SoSV: A web-based performance calculator for somatic structural variant detection</article-title>
      <alt-title alt-title-type="running-head">Shiny-SoSV</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gong</surname>
          <given-names>Tingting</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4524-7280</contrib-id>
        <name>
          <surname>Hayes</surname>
          <given-names>Vanessa M.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6104-3763</contrib-id>
        <name>
          <surname>Chan</surname>
          <given-names>Eva K. F.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Garvan Institute of Medical Research, Darlinghurst, New South Wales, Australia</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Central Clinical School, University of Sydney, Camperdown, New South Wales, Australia</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>St Vincent’s Clinical School, University of New South Wales, Randwick, New South Wales, Australia</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Chong</surname>
          <given-names>Zechen</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Alabama at Birmingham, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>eva.chan@health.nsw.gov.au</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>8</issue>
    <elocation-id>e0238108</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Gong et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Gong et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0238108.pdf"/>
    <abstract>
      <p>Somatic structural variants are an important contributor to cancer development and evolution. Accurate detection of these complex variants from whole genome sequencing data is influenced by a multitude of parameters. However, there are currently no tools for guiding study design nor are there applications that could predict the performance of somatic structural variant detection. To address this gap, we developed Shiny-SoSV, a user-friendly web-based calculator for determining the impact of common variables on the sensitivity, precision and F1 score of somatic structural variant detection, including choice of variant detection tool, sequencing depth of coverage, variant allele fraction, and variant breakpoint resolution. Using simulation studies, we determined singular and combinatoric effects of these variables, modelled the results using a generalised additive model, allowing structural variant detection performance to be predicted for any combination of predictors. Shiny-SoSV provides an interactive and visual platform for users to easily compare individual and combined impact of different parameters. It predicts the performance of a proposed study design, on somatic structural variant detection, prior to the commencement of benchwork. Shiny-SoSV is freely available at <ext-link ext-link-type="uri" xlink:href="https://hcpcg.shinyapps.io/Shiny-SoSV">https://hcpcg.shinyapps.io/Shiny-SoSV</ext-link> with accompanying user’s guide and example use-cases.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Australian Government Research Training Program Scholarship</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Gong</surname>
            <given-names>Tingting</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008719</institution-id>
            <institution>Movember Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PRoMis</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6104-3763</contrib-id>
          <name>
            <surname>Chan</surname>
            <given-names>Eva K. F.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000927</institution-id>
            <institution>Prostate Cancer Foundation of Australia</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PRoMis</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6104-3763</contrib-id>
          <name>
            <surname>Chan</surname>
            <given-names>Eva K. F.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002337</institution-id>
            <institution>Petre Foundation</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4524-7280</contrib-id>
          <name>
            <surname>Hayes</surname>
            <given-names>Vanessa M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was financially supported by an Australian Government Research Training Program Scholarship awarded to T.G., by a Movember Revolutionary Team Award (PRoMis) from Movember Australia and the Prostate Cancer Foundation Australia, by the University of Sydney Foundation and Petre Foundation funding received by V.M.H. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="2"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All input data to the prediction models, R scripts for model fitting, and source code for the Rshiny app are available from the Git Hub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/tgong1/Shiny-SoSV">https://github.com/tgong1/Shiny-SoSV</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All input data to the prediction models, R scripts for model fitting, and source code for the Rshiny app are available from the Git Hub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/tgong1/Shiny-SoSV">https://github.com/tgong1/Shiny-SoSV</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Somatic structural variants (SVs) are large (&gt; 50 bp) genomic rearrangements that arise in tumours and could directly contribute to cancer development and progression [<xref rid="pone.0238108.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0238108.ref003" ref-type="bibr">3</xref>]. The advent of next generation sequencing (NGS) has facilitated an increase in the efficiency and accuracy of detecting somatic variants in cancer genomes. However, due to limitations of short-read NGS, large SVs can only be inferred through alignment signatures. For example, read pairs that map farther or closer apart than expected are suggestive of a deletion or insertion event respectively, while read pairs aligned with inconsistent orientation are indicative of an inversion or duplication event. Attempts to improve SV detection have thus spurred many computational developments, resulting in the publication and availability of numerous SV detection tools (e.g. [<xref rid="pone.0238108.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0238108.ref008" ref-type="bibr">8</xref>]). These tools are based on different, sometimes overlapping algorithms and multiple evaluation studies have shown that these tools differ substantially in their sensitivity and breakpoint precision [<xref rid="pone.0238108.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0238108.ref012" ref-type="bibr">12</xref>].</p>
    <p>SV detection is further complicated in cancer samples due to variable tumour purity (proportion of cancer to non-cancerous cells in a sample) and variant allele frequency (VAF, proportion of the sequencing reads captured as harbouring the variant at a given genomic locus). Although histopathology can provide an overall estimate of tumour purity, it typically only reflects an approximate estimate of VAF, due to further complexity created through tumour sub-clonality and variability between histopathology and sequencing samples. Although deeper sequencing may increase sensitivity [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>], numerous studies have shown that the benefit of increasing coverage does saturate (e.g. [<xref rid="pone.0238108.ref013" ref-type="bibr">13</xref>]). Thus, knowing how much sequencing depth to increase is not obvious with decisions typically based on experience or “gut instinct”.</p>
    <p>Taken together, there are many alterable variables that can affect somatic SV detection in NGS analyses. Yet, informed decisions on these variables are rarely easily made, especially by non-bioinformaticians in clinical settings. To address this, we have developed Shiny-SoSV, a web-based interactive application to help estimate the performance (sensitivity, precision and F1 score) of somatic SV detection based on four user-modifiable parameters: VAF, sequencing depth of tumour and matched-normal samples, and SV breakpoint precision.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Simulation of structural variants</title>
      <p>To evaluate the sensitivity and accuracy of SV detection, a simulation study was devised. Two sets of SVs including 200 (somatic) and 2,000 (germline) of each of six SV types (deletion (DEL), duplication (DUP), inversion (INV), domestic insertion (DINS), foreign insertion (FINS) and translocation (TRA)) were simulated with SVEngine [<xref rid="pone.0238108.ref014" ref-type="bibr">14</xref>], as previously described [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>], totalling 1,200 somatic and 12,000 germline SVs (<xref ref-type="supplementary-material" rid="pone.0238108.s017">S1 Table</xref>). The numbers of SVs simulated were based on previous studies that have suggested the presence of 5,000 to 10,000 polymorphic SVs in the human genome [<xref rid="pone.0238108.ref015" ref-type="bibr">15</xref>] and between a handful to up to 1000 somatic SVs across a range of tumour types [<xref rid="pone.0238108.ref016" ref-type="bibr">16</xref>]. These findings support what we have also observed in our own work [<xref rid="pone.0238108.ref017" ref-type="bibr">17</xref>, <xref rid="pone.0238108.ref018" ref-type="bibr">18</xref>]. It is worth noting that, very similar results were observed when the number of germline SVs were reduced to match the number of somatic SVs except for two callers (<xref ref-type="supplementary-material" rid="pone.0238108.s021">S1 File</xref>). For each SV type, variable lengths were included ranging from 50 bp to 1,000,000 bp. Here, SV length is the length of the rearranged sequence; for example, the SV length of a TRA is the length of the translocated piece of DNA fragment.</p>
      <p>SVs were randomly distributed along the genome (GRCh38), masking N-gap, centromeric and telomeric regions. N-gap and centromeric regions were based on gap [last updated 24/12/2013] and centromeres [last update 17/08/2014] tables from the University of California at Santa Cruz (UCSC) Genome Browser, while telomeric regions are defined as the 10 Mbp of both ends of each chromosome of GRCh38.</p>
    </sec>
    <sec id="sec004">
      <title>Simulation of short paired-end reads</title>
      <p>NGS data was simulated to reflect the typical matched tumour-normal whole genome sequencing (WGS) approach for cancer genomics, namely using paired-end short-read sequencing, where genomic DNA is fragmented to a typical size range of 500 bp (insert size) and the two ends of each fragment sequenced inwards to up to 150 bp (read length).</p>
      <p>The 12,000 simulated germline SVs were spiked into both the normal and tumour genomes (FASTA format), while the 1,200 simulated somatic SVs were additionally spiked into the tumour genome. Paired short-reads were sampled using SVEngine [<xref rid="pone.0238108.ref014" ref-type="bibr">14</xref>] from the altered FASTA to 120x depth of coverage. Insert size of read-pairs was simulated with a normal distribution with mean of 500 bp and standard deviation of 100 bp, while read length was set to 150 bp. Other parameters were kept as SVEngine default, including random embedding of sequencing error and small variants (base error rate = 0.02, rate of mutation = 0.001, fraction of indels = 0.15, probability an indel is extended = 0.3). Sequencing reads (FASTQ format) were aligned to human genome reference GRCh38 using BWA-MEM v0.7.17-r1194 [<xref rid="pone.0238108.ref019" ref-type="bibr">19</xref>], generating alignment files (BAM format). Different depths of sequencing coverage were obtained by subsampling from the two 120x datasets using Picard DownsampleSam (<ext-link ext-link-type="uri" xlink:href="http://picard.sourceforge.net/">http://picard.sourceforge.net</ext-link>). Different tumour purity levels (VAF) were emulated by merging varying ratios of normal to tumour aligned reads, using Picard MergeSamFiles, to create the final tumour files (BAM). Here, tumour purity and VAF are used interchangeably as SVs are assumed independent of each other.</p>
      <p>The simulation was conducted to include a comprehensive combination of depths of coverage of the normal and tumour samples, VAF and SV breakpoint precision threshold (explained below in section “Defining true positive calls and concordant callsets”). The following parameter values were simulated:</p>
      <list list-type="bullet">
        <list-item>
          <p>Normal sample coverage: 20x, 30x, 40x, 50x, 60x, 70x, 80x, 90x, 100x;</p>
        </list-item>
        <list-item>
          <p>Tumour sample coverage: 20x, 30x, 40x, 50x, 60x, 70x, 80x, 90x, 100x;</p>
        </list-item>
        <list-item>
          <p>VAF: 0.05, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1.00;</p>
        </list-item>
        <list-item>
          <p>Breakpoint precision threshold (bp): 2, 10, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200.</p>
        </list-item>
      </list>
      <p>In all, this resulted in a total of 891 tumour/normal pairs of BAM files, encompassing all exhaustive combinations of parameter values.</p>
    </sec>
    <sec id="sec005">
      <title>Somatic SV detection</title>
      <p>Somatic SVs were detected using five SV callers, namely Manta [<xref rid="pone.0238108.ref004" ref-type="bibr">4</xref>], Lumpy [<xref rid="pone.0238108.ref005" ref-type="bibr">5</xref>], GRIDSS [<xref rid="pone.0238108.ref006" ref-type="bibr">6</xref>], Delly [<xref rid="pone.0238108.ref007" ref-type="bibr">7</xref>] and SvABA [<xref rid="pone.0238108.ref008" ref-type="bibr">8</xref>] for each tumour/normal pair and high-confidence calls were post-filtered as described previously [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>]. Each SV caller was executed using default parameters.</p>
      <p>These five callers were chosen to provide a wide representation of different SV detection methods and because they have been shown to be best performers within their class in recent benchmarking studies [<xref rid="pone.0238108.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0238108.ref012" ref-type="bibr">12</xref>]. While, both Delly and Lumpy use discordant read-pair and split-read methods, Lumpy integrates the two methods into a single SV detection step, called “evidence clustering”, whereas Delly uses them in separate calling and refining steps [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>]. Manta, GRIDSS and SvABA further use local-assembly with different methods of targeted assembly, windowed local assembly and genome-wide break-end assembly respectively [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>]. Additionally, Manta, Lumpy, GRIDSS and Delly were identified as popular tools among 46 callers published from 2009 to 2017, based on the criteria of Web of Science counts in a recent benchmarking study [<xref rid="pone.0238108.ref012" ref-type="bibr">12</xref>]. While SvABA was published in 2018 and not included in that study, it has shown good performance for both germline and somatic SV detection in other studies [<xref rid="pone.0238108.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>].</p>
    </sec>
    <sec id="sec006">
      <title>Defining true positive calls and concordant callsets</title>
      <p>Candidate SV callsets were compared against “true” simulated SV sets as previously described [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>]. In brief, a true positive (TP) SV call must meet two criteria: i) reported SV type must match the simulated type and ii) detected breakpoints must be within <italic>T</italic> bp from the simulated breakpoints. To pass the second criterion, all breakpoint positions corresponding to a SV event must be within a prescribed breakpoint precision threshold (<italic>T</italic>). We have applied varying values of <italic>T</italic>, as mentioned above.</p>
      <p>The total number of true positives is calculated as the number of calls in a callset satisfying both TP criteria. The number of false positives (FP) is the number of SV calls in a callset not satisfying either TP criteria. Thus, following the confusion matrix, we define: sensitivity = TP / (TP + FN) and precision = TP / (TP + FP). F1 score is calculated as 2 * (sensitivity * precision) / (sensitivity + precision).</p>
      <p>SV detection performance were also calculated for each SV type (DEL, DUP, INV, DINS, FINS and TRA) using the criteria as described above where possible, or with minor modifications as follows. For DINS and TRA, we require that both breakends (BNDs) of their fusion junctions to satisfy the TP criteria described to be considered as a true positive [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>]. Precision was not calculated for DINS and FINS, but for a general “INS” as reported by the callers. As INS is not reported by Lumpy, precision estimate of INS is not available for this SV caller. Similarly, neither DUP nor INS are reported by SvABA, however, the presence of these two SV types can be inferred through post-analysis, albeit indistinguishable [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>]. Therefore, the precision of DUP/INS was combined for SvABA. Furthermore, F1 scores of INS were calculated using sensitivity estimates for either DINS or FINS. Similarly, for SvABA, DUP/INS F1 scores were calculated using sensitivity values from DINS, FINS or DUP.</p>
      <p>The union and intersection callsets for each pair of SV callers were also derived, resulting in another 40 callsets for each simulated dataset. Two SV calls were considered the same if they have matching SV type [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>] and their reported breakpoint positions are within 5 bp of each other. The union callset of two SV callers is SV calls detected by either Caller_1 or Caller_2, while the intersection callset are calls reported by both Caller_1 and Caller_2. In both union and intersection cases, Caller_1 is the “dominant caller” such that any overlapping calls in the final callset is taken from the output from Caller_1 (including coordinates and SV types).</p>
    </sec>
    <sec id="sec007">
      <title>Predictive model selection</title>
      <p>A generalised additive model (GAM) was used to assess and predict the relationships between predictor variables (VAF, tumour coverage, normal coverage and breakpoint precision threshold <italic>T</italic>) and response variables (sensitivity and precision and F1 score) for each SV caller and all pairs of callers. The choice of GAM was motivated by non-linear relationships observed between some response and predictor variables.</p>
      <p>In particular, we observed VAF to have a non-linear effect on sensitivity for all SV callers (<xref ref-type="fig" rid="pone.0238108.g001">Fig 1A</xref> and <xref ref-type="supplementary-material" rid="pone.0238108.s001">S1A Fig</xref>) and precision on some SV callers (<xref ref-type="fig" rid="pone.0238108.g002">Fig 2A</xref>). However, the non-linear effect of VAF on precision is less obvious at lower breakpoint precision resolution (higher <italic>T</italic>) and for some SV callers, such as GRIDSS (<xref ref-type="supplementary-material" rid="pone.0238108.s001">S1B Fig</xref>). Tumour coverage has a greater non-linear impact on sensitivity and precision on samples at low VAF (<xref ref-type="supplementary-material" rid="pone.0238108.s002">S2 Fig</xref>). Different SV callers have different breakpoint detection resolution, as previously described [<xref rid="pone.0238108.ref010" ref-type="bibr">10</xref>] and SvABA was found to have the lowest breakpoint resolution among the five SV callers examined (<xref ref-type="fig" rid="pone.0238108.g004">Fig 4</xref>). Consequently, breakpoint precision threshold (<italic>T</italic>) has greater effect for SvABA and less so for other callers (<xref ref-type="supplementary-material" rid="pone.0238108.s003">S3 Fig</xref>). Additionally, most SV callers have lower breakpoint resolution at low tumour coverage and low VAF (e.g. 20x and 0.2 respectively in <xref ref-type="fig" rid="pone.0238108.g004">Fig 4</xref>). The impact of <italic>T</italic> on sensitivity, therefore, appears to be variably dependent on tumour coverage and VAF. For example, the sensitivity of Manta increases with increasing <italic>T</italic> at low VAF (e.g. 0.2) and is only obvious at tumour coverage &lt; 60x (<xref ref-type="supplementary-material" rid="pone.0238108.s003">S3A Fig</xref>). Similarly, precision is predominantly influenced by <italic>T</italic> at low tumour coverage and VAF (<xref ref-type="supplementary-material" rid="pone.0238108.s003">S3B Fig</xref>). Normal coverage has no notable impact, except for Manta, which was observed to have only a minor effect on sensitivity and only at low normal coverage (&lt; 40x) (<xref ref-type="supplementary-material" rid="pone.0238108.s004">S4 Fig</xref>). The observed relationships between F1 score and predictor variables (<xref ref-type="fig" rid="pone.0238108.g003">Fig 3</xref>) were similar as for sensitivity.</p>
      <fig id="pone.0238108.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Relationship between sensitivity and predictor variables.</title>
          <p>Shown are the effects of (a) tumour purity/VAF, (b) tumour coverage, (c) normal coverage and (d) breakpoint precision threshold on somatic SV detection sensitivity for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        </caption>
        <graphic xlink:href="pone.0238108.g001"/>
      </fig>
      <fig id="pone.0238108.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Relationship between precision and predictor variables.</title>
          <p>Shown are the effects of (a) tumour purity/VAF, (b) tumour coverage, (c) normal coverage and (d) breakpoint precision threshold on somatic SV detection precision, represented in log-scale, for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        </caption>
        <graphic xlink:href="pone.0238108.g002"/>
      </fig>
      <fig id="pone.0238108.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Relationship between F1 score and predictor variables.</title>
          <p>Shown are the effects of (a) tumour purity/VAF, (b) tumour coverage, (c) normal coverage and (d) breakpoint precision threshold on somatic SV detection F1 score for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        </caption>
        <graphic xlink:href="pone.0238108.g003"/>
      </fig>
      <fig id="pone.0238108.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Breakpoint resolution of structural variant calling.</title>
          <p>Results are based on simulation SV Set 1 with tumour coverage of 20x, 60x and 90x, matched normal coverage of 60x and variant allele frequency of 0.2, 0.5 and 1. This figure shows the cumulated frequency of the number true positive structural variants detected by each caller for breakpoint precision thresholds less than 2,000 bp.</p>
        </caption>
        <graphic xlink:href="pone.0238108.g004"/>
      </fig>
      <p>In order to select the model with the most appropriate set of parameters and that best explain the relationships between predictor and response variables, we examined eight models (Model (1)–(8)) for sensitivity, precision and F1 score, independently for each SV caller. To account for non-linear joint relationships, smooth functions (<italic>f</italic>) were applied to the tensor product of selected predictor variables. Smoothing parameters were estimated using restricted maximum likelihood (REML), rather than the default generalised cross validation (GCV), to avoid local minima [<xref rid="pone.0238108.ref020" ref-type="bibr">20</xref>]. Further, as the response variables are proportions with values between 0 and 1, the beta regression (betar) with logistic link function was used.
<disp-formula id="pone.0238108.e001"><alternatives><graphic xlink:href="pone.0238108.e001.jpg" id="pone.0238108.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi mathvariant="normal">Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pone.0238108.e002"><alternatives><graphic xlink:href="pone.0238108.e002.jpg" id="pone.0238108.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mi mathvariant="normal">Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mspace width="0.25em"/><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pone.0238108.e003"><alternatives><graphic xlink:href="pone.0238108.e003.jpg" id="pone.0238108.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi>Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pone.0238108.e004"><alternatives><graphic xlink:href="pone.0238108.e004.jpg" id="pone.0238108.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mi>Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:math></alternatives><label>(4)</label></disp-formula>
<disp-formula id="pone.0238108.e005"><alternatives><graphic xlink:href="pone.0238108.e005.jpg" id="pone.0238108.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi>Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:math></alternatives><label>(5)</label></disp-formula>
<disp-formula id="pone.0238108.e006"><alternatives><graphic xlink:href="pone.0238108.e006.jpg" id="pone.0238108.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi mathvariant="normal">Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:math></alternatives><label>(6)</label></disp-formula>
<disp-formula id="pone.0238108.e007"><alternatives><graphic xlink:href="pone.0238108.e007.jpg" id="pone.0238108.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mi>Y</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mstyle displaystyle="false"><mml:mo>⨂</mml:mo></mml:mstyle><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:math></alternatives><label>(7)</label></disp-formula>
<disp-formula id="pone.0238108.e008"><alternatives><graphic xlink:href="pone.0238108.e008.jpg" id="pone.0238108.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mi>Y</mml:mi><mml:mo>≈</mml:mo><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:math></alternatives><label>(8)</label></disp-formula>
where Y is response variable, which is sensitivity, precision or F1 score.</p>
      <p>To select the models for sensitivity, precision and F1 score, we used cross-validation for accuracy calculation of each model for each SV caller. Each time, one simulated value of a variable (e.g. all data with 20x tumour coverage) was left out for model fitting and error estimation. The average root mean squared error (RMSE) and mean absolute error (MAE) for each candidate model and five SV callers are reported in <xref rid="pone.0238108.t001" ref-type="table">Table 1</xref> and <xref ref-type="supplementary-material" rid="pone.0238108.s018">S2 Table</xref> respectively. If multiple models achieved similarly low RMSE and MAE, the simplest model was selected to avoid over-fitting. As a result, for sensitivity, Model 2, 5 and 3 was selected for Manta, Lumpy and SvABA respectively, and Model 6 for GRIDSS and Delly. In addition, we found that matched normal coverage has no significant effect on Lumpy, SvABA and Delly sensitivity (<xref ref-type="supplementary-material" rid="pone.0238108.s019">S3 Table</xref>), therefore, the term was excluded in the models for these SV callers. For precision, Model 3 was selected for Manta, Model 2 for Lumpy and Delly and Model 5 for GRIDSS and SvABA. For F1 score, Model 2, 6 and 3 was selected for Manta, GRIDSS and SvABA respectively, and Model 5 for Lumpy and Delly. In the chosen models for F1 score, matched normal coverage was not observed to have any significant effect on SvABA and Delly (<xref ref-type="supplementary-material" rid="pone.0238108.s019">S3 Table</xref>), and thus normal coverage was excluded from the final F1 score prediction models for these two callers.</p>
      <table-wrap id="pone.0238108.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238108.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Predictive model comparison and selection.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0238108.t001g" xlink:href="pone.0238108.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Error Estimate (RMSE)</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Models</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Manta</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Lumpy</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">GRIDSS</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">SvABA</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Delly</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="8" style="border-bottom:thick" colspan="1">Sensitivity</td>
                <td align="center" rowspan="1" colspan="1">(1)</td>
                <td align="center" rowspan="1" colspan="1">0.041</td>
                <td align="center" rowspan="1" colspan="1">0.034</td>
                <td align="center" rowspan="1" colspan="1">0.051</td>
                <td align="center" rowspan="1" colspan="1">0.052</td>
                <td align="center" rowspan="1" colspan="1">0.021</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(2)</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.041</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.034</td>
                <td align="center" rowspan="1" colspan="1">0.051</td>
                <td align="center" rowspan="1" colspan="1">0.053</td>
                <td align="center" rowspan="1" colspan="1">0.021</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(3)</td>
                <td align="center" rowspan="1" colspan="1">0.042</td>
                <td align="center" rowspan="1" colspan="1">0.034</td>
                <td align="center" rowspan="1" colspan="1">0.051</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.052</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.021</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(4)</td>
                <td align="center" rowspan="1" colspan="1">0.042</td>
                <td align="center" rowspan="1" colspan="1">0.034</td>
                <td align="center" rowspan="1" colspan="1">0.051</td>
                <td align="center" rowspan="1" colspan="1">0.053</td>
                <td align="center" rowspan="1" colspan="1">0.021</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(5)</td>
                <td align="center" rowspan="1" colspan="1">0.042</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.034</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.051</td>
                <td align="center" rowspan="1" colspan="1">0.053</td>
                <td align="center" rowspan="1" colspan="1">0.021</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(6)</td>
                <td align="center" rowspan="1" colspan="1">0.042</td>
                <td align="center" rowspan="1" colspan="1">0.036</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.051</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.058</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.021</bold>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(7)</td>
                <td align="center" rowspan="1" colspan="1">0.068</td>
                <td align="center" rowspan="1" colspan="1">0.061</td>
                <td align="center" rowspan="1" colspan="1">0.092</td>
                <td align="center" rowspan="1" colspan="1">0.091</td>
                <td align="center" rowspan="1" colspan="1">0.026</td>
              </tr>
              <tr>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">(8)</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.136</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.094</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.144</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.148</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.167</td>
              </tr>
              <tr>
                <td align="center" rowspan="8" style="border-bottom:thick" colspan="1">Precision</td>
                <td align="center" rowspan="1" colspan="1">(1)</td>
                <td align="center" rowspan="1" colspan="1">0.012</td>
                <td align="center" rowspan="1" colspan="1">0.012</td>
                <td align="center" rowspan="1" colspan="1">0.007</td>
                <td align="center" rowspan="1" colspan="1">0.029</td>
                <td align="center" rowspan="1" colspan="1">0.061</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(2)</td>
                <td align="center" rowspan="1" colspan="1">0.012</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.012</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.007</td>
                <td align="center" rowspan="1" colspan="1">0.029</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.061</bold>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(3)</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.012</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.013</td>
                <td align="center" rowspan="1" colspan="1">0.007</td>
                <td align="center" rowspan="1" colspan="1">0.029</td>
                <td align="center" rowspan="1" colspan="1">0.156</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(4)</td>
                <td align="center" rowspan="1" colspan="1">0.013</td>
                <td align="center" rowspan="1" colspan="1">0.013</td>
                <td align="center" rowspan="1" colspan="1">0.007</td>
                <td align="center" rowspan="1" colspan="1">0.029</td>
                <td align="center" rowspan="1" colspan="1">0.156</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(5)</td>
                <td align="center" rowspan="1" colspan="1">0.017</td>
                <td align="center" rowspan="1" colspan="1">0.013</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.007</bold>
                </td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.029</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.156</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(6)</td>
                <td align="center" rowspan="1" colspan="1">0.019</td>
                <td align="center" rowspan="1" colspan="1">0.017</td>
                <td align="center" rowspan="1" colspan="1">0.007</td>
                <td align="center" rowspan="1" colspan="1">0.032</td>
                <td align="center" rowspan="1" colspan="1">0.156</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(7)</td>
                <td align="center" rowspan="1" colspan="1">0.018</td>
                <td align="center" rowspan="1" colspan="1">0.015</td>
                <td align="center" rowspan="1" colspan="1">0.012</td>
                <td align="center" rowspan="1" colspan="1">0.046</td>
                <td align="center" rowspan="1" colspan="1">0.151</td>
              </tr>
              <tr>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">(8)</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.024</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.020</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.013</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.055</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">0.148</td>
              </tr>
              <tr>
                <td align="center" rowspan="8" colspan="1">F1 score</td>
                <td align="center" rowspan="1" colspan="1">(1)</td>
                <td align="center" rowspan="1" colspan="1">0.039</td>
                <td align="center" rowspan="1" colspan="1">0.032</td>
                <td align="center" rowspan="1" colspan="1">0.048</td>
                <td align="center" rowspan="1" colspan="1">0.057</td>
                <td align="center" rowspan="1" colspan="1">0.019</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(2)</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.039</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.032</td>
                <td align="center" rowspan="1" colspan="1">0.048</td>
                <td align="center" rowspan="1" colspan="1">0.058</td>
                <td align="center" rowspan="1" colspan="1">0.019</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(3)</td>
                <td align="center" rowspan="1" colspan="1">0.040</td>
                <td align="center" rowspan="1" colspan="1">0.032</td>
                <td align="center" rowspan="1" colspan="1">0.048</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.057</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.019</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(4)</td>
                <td align="center" rowspan="1" colspan="1">0.040</td>
                <td align="center" rowspan="1" colspan="1">0.032</td>
                <td align="center" rowspan="1" colspan="1">0.048</td>
                <td align="center" rowspan="1" colspan="1">0.058</td>
                <td align="center" rowspan="1" colspan="1">0.019</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(5)</td>
                <td align="center" rowspan="1" colspan="1">0.040</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.032</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.048</td>
                <td align="center" rowspan="1" colspan="1">0.060</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.019</bold>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(6)</td>
                <td align="center" rowspan="1" colspan="1">0.040</td>
                <td align="center" rowspan="1" colspan="1">0.034</td>
                <td align="center" style="background-color:#E7E6E6" rowspan="1" colspan="1">
                  <bold>0.048</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.065</td>
                <td align="center" rowspan="1" colspan="1">0.020</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(7)</td>
                <td align="center" rowspan="1" colspan="1">0.066</td>
                <td align="center" rowspan="1" colspan="1">0.060</td>
                <td align="center" rowspan="1" colspan="1">0.091</td>
                <td align="center" rowspan="1" colspan="1">0.101</td>
                <td align="center" rowspan="1" colspan="1">0.021</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(8)</td>
                <td align="center" rowspan="1" colspan="1">0.132</td>
                <td align="center" rowspan="1" colspan="1">0.088</td>
                <td align="center" rowspan="1" colspan="1">0.143</td>
                <td align="center" rowspan="1" colspan="1">0.163</td>
                <td align="center" rowspan="1" colspan="1">0.146</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Recognising performance differences for different SV types, we repeated the same evaluation analysis individually for each of the six SV types, where possible (<xref ref-type="supplementary-material" rid="pone.0238108.s021">S1 File</xref>), with the most appropriate prediction model identified using the same approach (<xref ref-type="supplementary-material" rid="pone.0238108.s020">S4 Table</xref>). Despite detection performance variability observed among SV types, it is noteworthy that the impact of predictor variables on the detection of individual SV type (<xref ref-type="supplementary-material" rid="pone.0238108.s005">S5</xref>–<xref ref-type="supplementary-material" rid="pone.0238108.s016">S16</xref> Figs) is similar to the impact on overall performance (Figs <xref ref-type="fig" rid="pone.0238108.g001">1</xref>–<xref ref-type="fig" rid="pone.0238108.g003">3</xref>).</p>
      <p>The R package <italic>mgcv</italic> default of thin plate regression spline (tp) was used as the smoothing basis. As tp tend to result in lower mean squared error [<xref rid="pone.0238108.ref020" ref-type="bibr">20</xref>], it was implemented for our purpose. Basis dimension was set as the default for all smoothing terms.</p>
      <p>The models for pairwise union and intersection of SV callers were chosen to be the same as the dominant caller. GAM models were then fitted for each SV caller and each pair of SV callers.</p>
    </sec>
    <sec id="sec008">
      <title>Web-based application design</title>
      <p>Shiny-SoSV is a web application developed using R package shiny v1.3.2, and is hosted on shinyapps.io, built to provide a visual platform for exploring the behaviour of sensitivity and precision with various predictor variables through two main interactive plots. R objects of class “gam” from the GAM models make up the data underlying Shiny-SoSV. Manipulation of response variables by users via the web app are registered by R/shiny, which then signals a call to the function predict(), returning predicted sensitivity, precision and F1 score values along with estimated standard errors. Plots of predicted sensitivity and precision with confidence intervals are generated with R package ggplot2 version 3.1.1 [<xref rid="pone.0238108.ref021" ref-type="bibr">21</xref>]. Comparison and interaction effects of two or more predictors are possible by selecting additional variables, including selection of multiple SV callers via checkboxes and one or more numeric parameters via slider bars or checkboxes (<xref ref-type="fig" rid="pone.0238108.g005">Fig 5</xref>).</p>
      <fig id="pone.0238108.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Shiny-SoSV user interface.</title>
          <p>Shown is a snapshot of Shiny-SoSV, displaying sensitivity and precision estimates evaluated across variant allele frequency (Tumour purity/VAF) (Black box labelled “Visualisation”). In this example, the overall performances of two SV callers (Manta and Lumpy) and their union callsets (distinguished by line colours) are displayed (controlled by red box labelled “Choice of SV caller(s)”) for three different tumour depths of coverage settings (line types; 30x, 60x, 100x) (controlled by indigo coloured box labelled “Choice of other parameters”). The desired sensitivity and precision are set as 80% (Blue box labelled “Acceptable detection performance levels”). Confidence intervals of all estimates are shown as grey ribbons, which may be difficult to see due to tight intervals.</p>
        </caption>
        <graphic xlink:href="pone.0238108.g005"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Results and discussion</title>
    <sec id="sec010">
      <title>Prediction model validation</title>
      <p>To test the robustness and predictive ability of the models, we used somatic SV calling evaluation results from (1) an independent simulation set, (2) the ICGC-TCGA DREAM Somatic Mutation Calling Challenge (ICGC-TCGA DREAM Challenge) [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>] and <italic>in silico</italic> mixing of cancer cell lines [<xref rid="pone.0238108.ref022" ref-type="bibr">22</xref>].</p>
      <sec id="sec011">
        <title>Validation on an independent simulation set</title>
        <p>An independent simulation set was generated for validation using a separate simulated SV set (<xref ref-type="supplementary-material" rid="pone.0238108.s017">S1 Table</xref>) with exhaustive combinations of the following parameter values:</p>
        <list list-type="bullet">
          <list-item>
            <p>Normal sample coverage: 25x, 45x, 60x, 75x, 90x;</p>
          </list-item>
          <list-item>
            <p>Tumour sample coverage: 25x, 45x, 60x, 75x, 90x;</p>
          </list-item>
          <list-item>
            <p>VAF: 0.10, 0.35, 0.50, 0.75, 0.90;</p>
          </list-item>
          <list-item>
            <p>Breakpoint precision threshold (bp): 5, 40, 100, 150, 180.</p>
          </list-item>
        </list>
        <p>The results in <xref rid="pone.0238108.t002" ref-type="table">Table 2</xref> suggest that we can predict sensitivity, precision and F1 score to within 6% error rate. Compared with the cross-validation error estimation for the chosen prediction models in <xref rid="pone.0238108.t001" ref-type="table">Table 1</xref>, all predictions with this independent data set achieved similar error rate (difference within 1%), with the exception of precision estimates for SvABA (1.3% lower RMSE) and Delly (2% lower RMSE). Relative to other callers, SvABA and Delly report fewer (&lt; 10) total number of detected SVs at the combinations of low tumour coverage (20x), VAF (0.05) and breakpoint precision threshold (2bp), resulting in imprecise precision estimation, which has the effect of inflating error rate. As the lowest tumour coverage, VAF and breakpoint precision threshold simulated for this independent validation data set are higher than the range where SvABA and Delly struggle to make positive calls, it resulted in a lower error rate estimates for precision prediction for these two callers.</p>
        <table-wrap id="pone.0238108.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0238108.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Predictive model validation.</title>
          </caption>
          <alternatives>
            <graphic id="pone.0238108.t002g" xlink:href="pone.0238108.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" rowspan="1" colspan="1">Error Estimate (RMSE)</th>
                  <th align="center" rowspan="1" colspan="1">Manta</th>
                  <th align="center" rowspan="1" colspan="1">Lumpy</th>
                  <th align="center" rowspan="1" colspan="1">GRIDSS</th>
                  <th align="center" rowspan="1" colspan="1">SvABA</th>
                  <th align="center" rowspan="1" colspan="1">Delly</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Sensitivity</td>
                  <td align="center" rowspan="1" colspan="1">0.044</td>
                  <td align="center" rowspan="1" colspan="1">0.045</td>
                  <td align="center" rowspan="1" colspan="1">0.053</td>
                  <td align="center" rowspan="1" colspan="1">0.048</td>
                  <td align="center" rowspan="1" colspan="1">0.021</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Precision</td>
                  <td align="center" rowspan="1" colspan="1">0.015</td>
                  <td align="center" rowspan="1" colspan="1">0.020</td>
                  <td align="center" rowspan="1" colspan="1">0.013</td>
                  <td align="center" rowspan="1" colspan="1">0.016</td>
                  <td align="center" rowspan="1" colspan="1">0.041</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">F1 score</td>
                  <td align="center" rowspan="1" colspan="1">0.044</td>
                  <td align="center" rowspan="1" colspan="1">0.042</td>
                  <td align="center" rowspan="1" colspan="1">0.051</td>
                  <td align="center" rowspan="1" colspan="1">0.055</td>
                  <td align="center" rowspan="1" colspan="1">0.015</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
      <sec id="sec012">
        <title>Validation using evaluation results from synthetic data using cell lines</title>
        <p>The ICGC-TCGA DREAM Challenge conducted a crowdsourced benchmarking of SV callers and reported results on three different simulated tumours from 15 teams [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>]. Each tumour sample was simulated with SVs spiked into a sub-sampling of Illumina paired-end short-read sequencing reads from a cell line using BAMSurgeon [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>] and each matched-normal sample was derived from a separate (non-overlapping) sub-sampling of the same original BAM file. Both of tumour and matched normal samples were sampled to around 30-40x coverage. Three synthetic datasets (denoted as in_silico 1–3) were generated, based on two different cell lines and three different SV sets containing different types and numbers of SVs (371, 655 and 2,886) spiked in at different frequencies (100%, 80% and mixture of subsets of SV at 20%, 33%, and 50% VAF). Detailed description of the challenge and datasets can be found at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn312572/wiki/62018">https://www.synapse.org/#!Synapse:syn312572/wiki/62018</ext-link>. SVs reported by each team were evaluated based on a single criterion that the called SV breakpoint is within 100 bp of a simulated SV, while correct SV type was not required. So, this TP criterion is more lenient than the TP criteria used in our study. Among the teams that participated, Teams 1 and 2 used Delly and Manta respectively, which allowed their sensitivity and precision to be predicted using our GAM models and compared to their reported evaluation results (<xref ref-type="fig" rid="pone.0238108.g006">Fig 6</xref>). Teams were allowed to use different versions and parameters on different datasets and make multiple submissions for each dataset, which resulted in multiple sensitivity and precision results for each team and dataset combination (e.g. sensitivity ranging from 53% to 74% of Team 1 for in_sillico 3). Overall, our models achieved low error rate (MAE = 3.4%) for precision but higher error rate (MAE = 9.3%) for sensitivity prediction, especially for in_silico 2 and 3. This is likely due to a combinations of differences in simulation and evaluation methods, and different versions and parameters of SV callers used by the DREAM Challenge participants [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>].</p>
        <fig id="pone.0238108.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Comparison of GAM prediction and observed performance from the ICGC-TCGA DREAM Challenge.</title>
            <p>Shown are predicted sensitivity (a) and precision (b) by GAM model versus reported sensitivity and precision from Lee et al. [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>]. Team 1 and Team 2 have used SV callers of Delly and Manta respectively. Sensitivity and precision are predicted based on predictor variables of tumour and normal coverage as 30x, breakpoint precision threshold as 100 bp and VAF as 100%, 80% and 50% for three datasets respectively.</p>
          </caption>
          <graphic xlink:href="pone.0238108.g006"/>
        </fig>
      </sec>
      <sec id="sec013">
        <title>Validation using evaluation results from in silico mixing of cancer cell lines</title>
        <p>We also validated our prediction models using somatic SV evaluation results based on two cancer cell lines (COLO-829 and HCC-1143), recently reported by Arora <italic>et al</italic>. [<xref rid="pone.0238108.ref022" ref-type="bibr">22</xref>]. In that study, the authors performed whole-genome sequencing of the cancer cell lines along with their matched normal cell lines, to up to 278x coverage. By down-sampling and mixing different fractions of data from the tumour and normal samples, the authors evaluated somatic SV calling performance for different tumour purity/VAF (at 80x tumour and 40x normal coverage) and different tumour and normal coverages (at VAF of 1). This allowed us to compare our prediction curve to their reported SV performance on cancer cell lines with predictor variables VAF (<xref ref-type="fig" rid="pone.0238108.g007">Fig 7</xref>), tumour coverage (<xref ref-type="fig" rid="pone.0238108.g008">Fig 8</xref>) and matched normal coverage (<xref ref-type="fig" rid="pone.0238108.g009">Fig 9</xref>).</p>
        <fig id="pone.0238108.g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <title>Prediction curve across tumour purity/VAF.</title>
            <p>Shown are the evaluation results of AllSomatic set (in red) and HighConf set (in blue) from cancer cell lines and prediction curve of (a) sensitivity, (b) precision and (c) F1 score across tumour purity/VAF. Prediction are based on tumour purity/VAF from 0.05 to 1, tumour coverage of 80x, normal coverage of 40x and breakpoint precision threshold of 200bp.</p>
          </caption>
          <graphic xlink:href="pone.0238108.g007"/>
        </fig>
        <fig id="pone.0238108.g008" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g008</object-id>
          <label>Fig 8</label>
          <caption>
            <title>Prediction curve across tumour coverage.</title>
            <p>Shown are the evaluation results of AllSomatic set (in red) and HighConf set (in blue) from cancer cell lines and prediction curve of (a) sensitivity, (b) precision and (c) F1 score across tumour coverage. Prediction are based on tumour coverage from 20x to 90x, tumour purity/VAF of 100%, normal coverage of 40x and breakpoint precision threshold of 200bp.</p>
          </caption>
          <graphic xlink:href="pone.0238108.g008"/>
        </fig>
        <fig id="pone.0238108.g009" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0238108.g009</object-id>
          <label>Fig 9</label>
          <caption>
            <title>Prediction curve across normal coverage.</title>
            <p>Shown are the evaluation results of AllSomatic set (in red) and HighConf set (in blue) from cancer cell lines and prediction curve of (a) sensitivity, (b) precision and (c) F1 score across normal coverage. Prediction are based on normal coverage from 20x to 40x, tumour purity/VAF of 100%, tumour coverage of 80x and breakpoint precision threshold of 200bp.</p>
          </caption>
          <graphic xlink:href="pone.0238108.g009"/>
        </fig>
        <p>In the study of Arora <italic>et al</italic>., evaluation results were reported for two callsets: AllSomatic and HighConf. The AllSomatic set was defined as the union set of three SV callers (SvABA, Manta and Lumpy) and filtering on a panel of normal, while the HighConf set is a subset of AllSomatic set, including SVs called by two of the three callers or called by Manta or Lumpy with either additional CNV or split-read support [<xref rid="pone.0238108.ref022" ref-type="bibr">22</xref>]. For validation, we compared Arora <italic>et al</italic>.’s results with our prediction curves derived from our union and intersection callsets for all pairwise combination of the three SV callers. Overall, our prediction model of these three variables (VAF, tumour and normal coverages) on SV detection is similar to the evaluation results reported by Arora <italic>et al</italic>. Specifically, we verified that VAF has a non-linear effect on sensitivity, and VAF and tumour coverage have stronger impacts on sensitivity than precision. Interestingly, we note that the evaluation results reported by Arora <italic>et al</italic>. is more similar to our predictions for the intersection callset for Manta and Lumpy and union callset for Lumpy and SvABA. This suggests these latter two callsets perform similarly to the additional filtering steps employed by Arora <italic>et al</italic>. Furthermore, we note that, in general, our prediction of sensitivity for pairwise intersection callsets are lower than reported by Arora <italic>et al</italic>. We believe this is likely due to our more stringent definition for concordance of two callsets, requiring breakpoint precision threshold of 5bp, compared to Arora et al.’s requirement of 300bp and at least 50% reciprocal overlap.</p>
      </sec>
    </sec>
    <sec id="sec014">
      <title>Application features</title>
      <p>The aim of Shiny-SoSV is to support decision-making on variables impacting one’s ability to detect somatic SVs from WGS data. In particular, this app was designed to empower users in planning their WGS experiment for efficient somatic SV detection. To this end, seven key features were implemented.</p>
      <list list-type="bullet">
        <list-item>
          <p><italic>Inclusion of important predictor variables</italic>. We have included five variables in Shiny-SoSV. With the exception of VAF, all can be modified by the study investigator prior to the commencement of sequencing. This is important as it allows users to adjust experimental plans accordingly. Even though VAF is intrinsic to the biology of the sample, it is by far the most important predictor for somatic variant detection [<xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0238108.ref023" ref-type="bibr">23</xref>]. Therefore, VAF is included mainly to determine minimum required tumour purity and support tuning of other modifiable variables.</p>
        </list-item>
        <list-item>
          <p><italic>Predictor variables are easy to modify</italic>. To make it user friendly, we have implemented tick boxes and slider bars for value selection across a range of variable choices. For example, users can choose any single or pairs of SV caller(s).</p>
        </list-item>
        <list-item>
          <p><italic>Intuitive visualisation of the impact of predictor variables on responses</italic>. To compare somatic SV detection performance with different choices of parameter values, GAM prediction models were implemented allowing prediction curves to be dynamically generated for easy visualisation. The prediction can be visualised via line plots with confidence intervals based on choices of different combinations of variables, in one figure.</p>
        </list-item>
        <list-item>
          <p><italic>Ability to evaluate multiple variables simultaneously</italic>. For example, users can examine the change of sensitivity (y-axis) across VAF (x-axis) with different choices of SV callers (line colour) and tumour coverages (line types) (<xref ref-type="fig" rid="pone.0238108.g004">Fig 4</xref>).</p>
        </list-item>
        <list-item>
          <p><italic>Simple reporting of minimum requirements to achieve user’s objective</italic>. To further simplify decision-making, a summary table of minimum required value for each predictor variable, including SV callers, depth of coverage and tumour purity and breakpoint resolution, is reported for a user-defined detection performance level.</p>
        </list-item>
        <list-item>
          <p><italic>Inclusion of commonly used SV callers</italic>, <italic>representing different SV calling methods</italic>. The five SV callers included in Shiny-SoSV are commonly used and have shown good performance in multiple recent benchmarking studies. They were also chosen to represent different combinations of SV calling methods. The simulated samples and SV set can be used for evaluation of future callers and be added to Shiny-SoSV.</p>
        </list-item>
        <list-item>
          <p><italic>Ability to estimate performance by SV type</italic>. In addition to the main user interface for prediction of overall SV detection performance, users can further predict and compare the performance across different SV types.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec015">
      <title>Application limitations</title>
      <p>While we have endeavoured to create a performance calculator for real-world use, we recognise certain limitations and challenges. Firstly, the performance prediction was based on a series of simulated data, which we appreciate cannot fully encompass the complexity of real tumour sample and errors in real sequencing processes. However, by concurrently including both germline and somatic SVs, and including a range of SV types and SV sizes, we believe the simulation results provide a baseline estimate. Secondly, in general, real unknown VAF can be lower than histopathological estimates of tumour purity, due to potential tumour sub-clonality and heterogeneity. We therefore present the prediction here to represent the upper limits of sensitivity and precision that can be achieved. Thirdly, we have included four predictor variables totalling 10,692 unique permutations of predictor values for prediction model fitting of each callset. However, other variables, such as average mapping quality, read length, insert sizes and nucleotide complexity, have been shown to impact variant detection, albeit with lower effect size [<xref rid="pone.0238108.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0238108.ref011" ref-type="bibr">11</xref>]. Adding more variables and more data points could provide a better prediction model and more sophisticated calculator for SV detection performance prediction.</p>
    </sec>
    <sec id="sec016">
      <title>Application utility</title>
      <p>The web-based app is hosted indefinitely at <ext-link ext-link-type="uri" xlink:href="https://hcpcg.shinyapps.io/shiny-sosv">https://hcpcg.shinyapps.io/shiny-sosv</ext-link> by Shiny from RStudio. Both the input data to the GAM and R script for GAM fitting, as well as the resulting GAM R objects are provided with the Git release, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tgong1/Shiny-SoSV">https://github.com/tgong1/Shiny-SoSV</ext-link>. Additionally, the source code for launching the shiny app is available at this GitHub repository, allowing both data and app versions to be tracked. An extensive User Guide is provided with Shiny-SoSV release, detailing the user-interface and available options. To help further enhance usability, multiple end-user cases also accompany Shiny-SoSV.</p>
      <p>To illustrate the utility of Shiny-SoSV here, we present a common example use-case.</p>
      <p><italic>Suppose, based on histopathology, a user is aware their cohort of cancer samples have tumour purities between 20% and 60%, and they want to know to what depth of coverage they should sequence their tumour samples, assuming all matched normal samples will be sequenced to the default of 30x</italic>.</p>
      <p>As demonstrated in <xref ref-type="fig" rid="pone.0238108.g005">Fig 5</xref>, the Shiny-SoSV user can select to evaluate the effect of “Tumour purity/VAF” (“Evaluation across”) on either or both “Sensitivity” and “Precision” (“evaluation measurements”). On the side bar, the user can select individual or combination(s) of SV callers (e.g. Manta, Lumpy, and their union set) for comparison and up to three tumour coverage settings (e.g. 30x, 60x and 100x) simultaneously, while keeping all other parameters unchanged. From this, it is immediately obvious that VAF has a great impact on sensitivity, while little impact on precision. Sensitivity of all SV callers increases rapidly from VAF of 5% to 30%. At VAF &gt; 30%, improvements in sensitivity notably slows for all SV callers, with Manta showing relatively larger improvements until it reaches the limit (saturation) with this combination of parameters for this caller. The table below the plots provides the user with the information required to make decisions on sequencing depth, which is further dependent on his/her budget and objective (i.e. acceptable sensitivity and precision level). For example, for a desired sensitivity and precision of 80%, the user may elect to sequence at 60x using the SV caller(s) chosen (e.g. union set of Manta and Lumpy) for all samples. However, if the resulting cost is prohibitive, the user may choose to sequence only the subset of samples with tumour purity &gt; 32% to up to 30x depth of coverage whilst still achieving the desired 80% sensitivity and precision levels.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Conclusions</title>
    <p>Shiny-SoSV provides an easy to use and interactive graphical user interface for evaluating the effects of multiple variables impacting somatic SV detection. The current release allows evaluation of common effectors of SV detection using five popular SV callers. Inclusion of addition SV callers can easily be incorporated with existing simulation datasets, while assessment of additional variables (such as mapping quality, insert sizes and nucleotide complexity) can be achieved with further simulation efforts. In sum, we believe Shiny-SoSV will enable bioinformaticians, and importantly also non-bioinformaticians, to optimally design WGS experiments for detecting SVs in cancer genomes.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec018">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0238108.s001">
      <label>S1 Fig</label>
      <caption>
        <title>The joint impact of tumour purity/VAF and breakpoint precision threshold on sensitivity and precision.</title>
        <p>Shown are the effect of the interaction of VAF and breakpoint precision threshold (by colour) on sensitivity (a) and precision in log scale (b) for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). Results are based on simulation data set with tumour coverage of 20x, 60x and 90x, breakpoint precision threshold of 2bp, 60bp, 100bp and 200bp and normal coverage of 60x.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s002">
      <label>S2 Fig</label>
      <caption>
        <title>The joint impact of tumour coverage and tumour purity/VAF on sensitivity and precision.</title>
        <p>Shown are the effect of the interaction of tumour coverage and VAF (by colour) on sensitivity (a) and precision in log scale (b) for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). Results are based on simulation data set with breakpoint precision threshold of 10bp, 100bp and 200bp, VAF of 0.05, 0.3 0.5 and 1 and normal coverage of 60x.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s003">
      <label>S3 Fig</label>
      <caption>
        <title>The joint impact of breakpoint precision threshold and tumour coverage on sensitivity and precision.</title>
        <p>Shown are the effect of the interaction of breakpoint precision threshold and tumour coverage (by colour) on sensitivity (a) and precision in log scale (b) for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). Results are based on simulation data set with VAF of 0.2, 0.5 and 1, tumour coverage of 20x, 40x, 60x and 90x and normal coverage of 60x.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s004">
      <label>S4 Fig</label>
      <caption>
        <title>The joint impact of normal coverage and VAF on sensitivity and precision.</title>
        <p>Shown are the effect of the interaction of normal coverage and VAF (by colour) on sensitivity (a) and precision in log scale (b) for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). Results are based on simulation data set with breakpoint precision threshold of 10bp, 100bp and 200bp, VAF of 0.05, 0.3 0.5 and 1 and tumour coverage of 60x.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Relationship between SV type sensitivity and tumour purity/VAF.</title>
        <p>Shown are the effects of tumour purity/VAF on somatic SV type detection sensitivity for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Relationship between SV type sensitivity and tumour coverage.</title>
        <p>Shown are the effects of tumour coverage on somatic SV type detection sensitivity for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Relationship between SV type sensitivity and normal coverage.</title>
        <p>Shown are the effects of normal coverage on somatic SV type detection sensitivity for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s008">
      <label>S8 Fig</label>
      <caption>
        <title>Relationship between SV type sensitivity and breakpoint precision threshold.</title>
        <p>Shown are the effects of breakpoint precision threshold on somatic SV type detection sensitivity for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s009">
      <label>S9 Fig</label>
      <caption>
        <title>Relationship between SV type precision and tumour purity/VAF.</title>
        <p>Shown are the effects of tumour purity/VAF on somatic SV type detection precision for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. Precision of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s010">
      <label>S10 Fig</label>
      <caption>
        <title>Relationship between SV type precision and tumour coverage.</title>
        <p>Shown are the effects of tumour coverage on somatic SV type detection precision for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. Precision of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s011">
      <label>S11 Fig</label>
      <caption>
        <title>Relationship between SV type precision and normal coverage.</title>
        <p>Shown are the effects of normal coverage on somatic SV type detection precision for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. Precision of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s012">
      <label>S12 Fig</label>
      <caption>
        <title>Relationship between SV type precision and breakpoint precision threshold.</title>
        <p>Shown are the effects of breakpoint precision threshold on somatic SV type detection precision for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. Precision of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s013">
      <label>S13 Fig</label>
      <caption>
        <title>Relationship between SV type F1 score and tumour purity/VAF.</title>
        <p>Shown are the effects of tumour purity/VAF on somatic SV type detection F1 score for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. F1 score of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s014">
      <label>S14 Fig</label>
      <caption>
        <title>Relationship between SV type F1 score and tumour coverage.</title>
        <p>Shown are the effects of tumour coverage on somatic SV type detection F1 score for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. F1 score of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s014.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s015">
      <label>S15 Fig</label>
      <caption>
        <title>Relationship between SV type F1 score and normal coverage.</title>
        <p>Shown are the effects of normal coverage on somatic SV type detection F1 score for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. F1 score of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s015.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s016">
      <label>S16 Fig</label>
      <caption>
        <title>Relationship between SV type F1 score and breakpoint precision threshold.</title>
        <p>Shown are the effects of breakpoint precision threshold on somatic SV type detection F1 score for five SV callers (Manta, Lumpy, GRIDSS, SvABA, Delly). INS is not detectable by Lumpy. F1 score of DUP for SvABA shown can also be INS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0238108.s016.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s017">
      <label>S1 Table</label>
      <caption>
        <title>Simulation SV sets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0238108.s017.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s018">
      <label>S2 Table</label>
      <caption>
        <title>Predictive model comparison and selection based on MAE.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0238108.s018.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s019">
      <label>S3 Table</label>
      <caption>
        <title>The parametric coefficients and approximate significance of smooth terms of the selected GAM models.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0238108.s019.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s020">
      <label>S4 Table</label>
      <caption>
        <title>Predictive model comparison and selection for each SV type.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0238108.s020.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238108.s021">
      <label>S1 File</label>
      <caption>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0238108.s021.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We gratefully acknowledge the comments and suggestions on the manuscript from Dr Timothy Peters at Garvan Institute of Medical Research.</p>
    <p>We thank Nicolas Robine, Minita Shah and Jennifer Shelton from the New York Genome Center for providing the evaluation data for cell lines COLO829 and HCC-1143.</p>
    <p>We acknowledge the high-performance computing resources generously provided by the National Computational Infrastructure (Raijin), the Garvan Institute of Medical Research (Wolfpack) and the University of Sydney (Artemis).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0238108.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Tubio</surname><given-names>JM</given-names></name>. <article-title>Somatic structural variation and cancer</article-title>. <source>Brief Funct Genomics</source>. <year>2015</year>;<volume>14</volume>(<issue>5</issue>):<fpage>339</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1093/bfgp/elv016</pub-id> .<?supplied-pmid 25903743?><pub-id pub-id-type="pmid">25903743</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Baca</surname><given-names>SC</given-names></name>, <name><surname>Prandi</surname><given-names>D</given-names></name>, <name><surname>Lawrence</surname><given-names>MS</given-names></name>, <name><surname>Mosquera</surname><given-names>JM</given-names></name>, <name><surname>Romanel</surname><given-names>A</given-names></name>, <name><surname>Drier</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Punctuated evolution of prostate cancer genomes</article-title>. <source>Cell</source>. <year>2013</year>;<volume>153</volume>(<issue>3</issue>):<fpage>666</fpage>–<lpage>77</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2013.03.021</pub-id> .<?supplied-pmid 23622249?><pub-id pub-id-type="pmid">23622249</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Northcott</surname><given-names>PA</given-names></name>, <name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Zichner</surname><given-names>T</given-names></name>, <name><surname>Stütz</surname><given-names>AM</given-names></name>, <name><surname>Erkek</surname><given-names>S</given-names></name>, <name><surname>Kawauchi</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Enhancer hijacking activates GFI1 family oncogenes in medulloblastoma</article-title>. <source>Nature</source>. <year>2014</year>;<volume>511</volume>(<issue>7510</issue>):<fpage>428</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1038/nature13379</pub-id><?supplied-pmid 25043047?><pub-id pub-id-type="pmid">25043047</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Schulz-Trieglaff</surname><given-names>O</given-names></name>, <name><surname>Shaw</surname><given-names>R</given-names></name>, <name><surname>Barnes</surname><given-names>B</given-names></name>, <name><surname>Schlesinger</surname><given-names>F</given-names></name>, <name><surname>Kallberg</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Manta: rapid detection of structural variants and indels for germline and cancer sequencing applications</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>8</issue>):<fpage>1220</fpage>–<lpage>2</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv710</pub-id> .<?supplied-pmid 26647377?><pub-id pub-id-type="pmid">26647377</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Layer</surname><given-names>RM</given-names></name>, <name><surname>Chiang</surname><given-names>C</given-names></name>, <name><surname>Quinlan</surname><given-names>AR</given-names></name>, <name><surname>Hall</surname><given-names>IM</given-names></name>. <article-title>LUMPY: a probabilistic framework for structural variant discovery</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>6</issue>):<fpage>R84</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-6-r84</pub-id><?supplied-pmid 24970577?><pub-id pub-id-type="pmid">24970577</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Cameron</surname><given-names>DL</given-names></name>, <name><surname>Schroder</surname><given-names>J</given-names></name>, <name><surname>Penington</surname><given-names>JS</given-names></name>, <name><surname>Do</surname><given-names>H</given-names></name>, <name><surname>Molania</surname><given-names>R</given-names></name>, <name><surname>Dobrovic</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>GRIDSS: sensitive and specific genomic rearrangement detection using positional de Bruijn graph assembly</article-title>. <source>Genome Res</source>. <year>2017</year>;<volume>27</volume>(<issue>12</issue>):<fpage>2050</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1101/gr.222109.117</pub-id><?supplied-pmid 29097403?><pub-id pub-id-type="pmid">29097403</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Rausch</surname><given-names>T</given-names></name>, <name><surname>Zichner</surname><given-names>T</given-names></name>, <name><surname>Schlattl</surname><given-names>A</given-names></name>, <name><surname>Stütz</surname><given-names>AM</given-names></name>, <name><surname>Benes</surname><given-names>V</given-names></name>, <name><surname>Korbel</surname><given-names>JO</given-names></name>. <article-title>DELLY: structural variant discovery by integrated paired-end and split-read analysis</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2012</year>;<volume>28</volume>(<issue>18</issue>):<fpage>i333</fpage>–<lpage>i9</lpage>. Epub 09/03. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts378</pub-id> .<?supplied-pmid 22962449?><pub-id pub-id-type="pmid">22962449</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Wala</surname><given-names>JA</given-names></name>, <name><surname>Bandopadhayay</surname><given-names>P</given-names></name>, <name><surname>Greenwald</surname><given-names>NF</given-names></name>, <name><surname>O'Rourke</surname><given-names>R</given-names></name>, <name><surname>Sharpe</surname><given-names>T</given-names></name>, <name><surname>Stewart</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>SvABA: genome-wide detection of structural variants and indels by local assembly</article-title>. <source>Genome Research</source>. <year>2018</year>;<volume>28</volume>(<issue>4</issue>):<fpage>581</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="doi">10.1101/gr.221028.117</pub-id><?supplied-pmid 29535149?><pub-id pub-id-type="pmid">29535149</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Kosugi</surname><given-names>S</given-names></name>, <name><surname>Momozawa</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Terao</surname><given-names>C</given-names></name>, <name><surname>Kubo</surname><given-names>M</given-names></name>, <name><surname>Kamatani</surname><given-names>Y</given-names></name>. <article-title>Comprehensive evaluation of structural variation detection algorithms for whole genome sequencing</article-title>. <source>Genome Biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>117</fpage><pub-id pub-id-type="doi">10.1186/s13059-019-1720-5</pub-id><?supplied-pmid 31159850?><pub-id pub-id-type="pmid">31159850</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Hayes</surname><given-names>VM</given-names></name>, <name><surname>Chan</surname><given-names>EKF</given-names></name>. <article-title>Detection of somatic structural variants from short-read next-generation sequencing data</article-title>. <source>Briefings in Bioinformatics</source>. <year>2020</year><pub-id pub-id-type="doi">10.1093/bib/bbaa056</pub-id><?supplied-pmid 32379294?><pub-id pub-id-type="pmid">32379294</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>AY</given-names></name>, <name><surname>Ewing</surname><given-names>AD</given-names></name>, <name><surname>Ellrott</surname><given-names>K</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Houlahan</surname><given-names>KE</given-names></name>, <name><surname>Bare</surname><given-names>JC</given-names></name>, <etal>et al</etal><article-title>Combining accurate tumor genome simulation with crowdsourcing to benchmark somatic structural variant detection</article-title>. <source>Genome Biology</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>188</fpage><pub-id pub-id-type="doi">10.1186/s13059-018-1539-5</pub-id><?supplied-pmid 30400818?><pub-id pub-id-type="pmid">30400818</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Cameron</surname><given-names>DL</given-names></name>, <name><surname>Di Stefano</surname><given-names>L</given-names></name>, <name><surname>Papenfuss</surname><given-names>AT</given-names></name>. <article-title>Comprehensive evaluation and characterisation of short read general-purpose structural variant calling software</article-title>. <source>Nature communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>3240</fpage>–. <pub-id pub-id-type="doi">10.1038/s41467-019-11146-4</pub-id> .<?supplied-pmid 31324872?><pub-id pub-id-type="pmid">31324872</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Chaisson</surname><given-names>MJP</given-names></name>, <name><surname>Sanders</surname><given-names>AD</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <name><surname>Malhotra</surname><given-names>A</given-names></name>, <name><surname>Porubsky</surname><given-names>D</given-names></name>, <name><surname>Rausch</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>. <source>Nature Communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>1784</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-08148-z</pub-id><?supplied-pmid 30992455?><pub-id pub-id-type="pmid">30992455</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Xia</surname><given-names>LC</given-names></name>, <name><surname>Ai</surname><given-names>D</given-names></name>, <name><surname>Lee</surname><given-names>H</given-names></name>, <name><surname>Andor</surname><given-names>N</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>NR</given-names></name>, <etal>et al</etal><article-title>SVEngine: an efficient and versatile simulator of genome structural variations with features of cancer clonal evolution</article-title>. <source>Gigascience</source>. <year>2018</year>;<volume>7</volume>(<issue>7</issue>). <pub-id pub-id-type="doi">10.1093/gigascience/giy081</pub-id><?supplied-pmid 29982625?><pub-id pub-id-type="pmid">29982625</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Quinlan</surname><given-names>AR</given-names></name>, <name><surname>Hall</surname><given-names>IM</given-names></name>. <article-title>Characterizing complex structural variation in germline and somatic genomes. Trends in genetics</article-title>: <source>TIG</source>. <year>2012</year>;<volume>28</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>53</lpage>. Epub 2011/11/15. <pub-id pub-id-type="doi">10.1016/j.tig.2011.10.002</pub-id> .<?supplied-pmid 22094265?><pub-id pub-id-type="pmid">22094265</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Campbell</surname><given-names>PJ</given-names></name>, <name><surname>Getz</surname><given-names>G</given-names></name>, <name><surname>Korbel</surname><given-names>JO</given-names></name>, <name><surname>Stuart</surname><given-names>JM</given-names></name>, <name><surname>Jennings</surname><given-names>JL</given-names></name>, <name><surname>Stein</surname><given-names>LD</given-names></name>, <etal>et al</etal><article-title>Pan-cancer analysis of whole genomes</article-title>. <source>Nature</source>. <year>2020</year>;<volume>578</volume>(<issue>7793</issue>):<fpage>82</fpage>–<lpage>93</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-020-1969-6</pub-id><?supplied-pmid 32025007?><pub-id pub-id-type="pmid">32025007</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Jaratlerdsiri</surname><given-names>W</given-names></name>, <name><surname>Chan</surname><given-names>EKF</given-names></name>, <name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Petersen</surname><given-names>DC</given-names></name>, <name><surname>Kalsbeek</surname><given-names>AMF</given-names></name>, <name><surname>Venter</surname><given-names>PA</given-names></name>, <etal>et al</etal><article-title>Whole Genome Sequencing Reveals Elevated Tumor Mutational Burden and Initiating Driver Mutations in African Men with Treatment-Naive, High-Risk Prostate Cancer</article-title>. <source>Cancer Research</source>. <year>2018</year>:<fpage>canres.0254</fpage>2018. <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-0254</pub-id><?supplied-pmid 30217929?><pub-id pub-id-type="pmid">30217929</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Crumbaker</surname><given-names>M</given-names></name>, <name><surname>Chan</surname><given-names>EKF</given-names></name>, <name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Corcoran</surname><given-names>N</given-names></name>, <name><surname>Jaratlerdsiri</surname><given-names>W</given-names></name>, <name><surname>Lyons</surname><given-names>RJ</given-names></name>, <etal>et al</etal><article-title>The Impact of Whole Genome Data on Therapeutic Decision-Making in Metastatic Prostate Cancer: A Retrospective Analysis</article-title>. <source>Cancers (Basel).</source><year>2020</year>;<volume>12</volume>(<issue>5</issue>). Epub 2020/05/13. <pub-id pub-id-type="doi">10.3390/cancers12051178</pub-id><?supplied-pmid 32392735?><pub-id pub-id-type="pmid">32392735</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>14</issue>):<fpage>1754</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><?supplied-pmid 19451168?><pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Wood</surname><given-names>SN</given-names></name>. <article-title>Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models</article-title>. <source>Journal of the Royal Statistical Society (B)</source>. <year>2011</year>;<volume>73</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>36</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0238108.ref021">
      <label>21</label>
      <mixed-citation publication-type="book"><name><surname>Wickham</surname><given-names>H.</given-names></name><source>ggplot2: Elegent Graphics for Data Analysis</source>: <publisher-name>Springer-Verlag</publisher-name><publisher-loc>New York</publisher-loc>; <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="pone.0238108.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Arora</surname><given-names>K</given-names></name>, <name><surname>Shah</surname><given-names>M</given-names></name>, <name><surname>Johnson</surname><given-names>M</given-names></name>, <name><surname>Sanghvi</surname><given-names>R</given-names></name>, <name><surname>Shelton</surname><given-names>J</given-names></name>, <name><surname>Nagulapalli</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Deep whole-genome sequencing of 3 cancer cell lines on 2 sequencing platforms</article-title>. <source>Scientific Reports</source>. <year>2019</year>;<volume>9</volume>(<issue>1</issue>):<fpage>19123</fpage><pub-id pub-id-type="doi">10.1038/s41598-019-55636-3</pub-id><?supplied-pmid 31836783?><pub-id pub-id-type="pmid">31836783</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238108.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>B</given-names></name>, <name><surname>Conroy</surname><given-names>JM</given-names></name>, <name><surname>Morrison</surname><given-names>CD</given-names></name>, <name><surname>Odunsi</surname><given-names>AO</given-names></name>, <name><surname>Qin</surname><given-names>M</given-names></name>, <name><surname>Wei</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Structural variation discovery in the cancer genome using next generation sequencing: computational solutions and perspectives</article-title>. <source>Oncotarget</source>. <year>2015</year>;<volume>6</volume>(<issue>8</issue>):<fpage>5477</fpage>–<lpage>89</lpage>. <pub-id pub-id-type="doi">10.18632/oncotarget.3491</pub-id><?supplied-pmid 25849937?><pub-id pub-id-type="pmid">25849937</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0238108.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238108.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chong</surname>
          <given-names>Zechen</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Zechen Chong</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Zechen Chong</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238108" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Jun 2020</named-content>
    </p>
    <p>PONE-D-20-12646</p>
    <p>Shiny-SoSV: A web-based performance calculator for somatic structural variant detection</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Chan,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>Please submit your revised manuscript by July 31st. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at <email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p>
    <p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Zechen Chong</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at <ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2. Thank you for stating the following in the Acknowledgments Section of your manuscript:</p>
    <p>'T.G. is funded by an Australian Government Research Training Program Scholarship, E.K.F.C</p>
    <p>is funded in part by a Movember Revolutionary Team Award (PRoMis) from Movember</p>
    <p>Australia and the Prostate Cancer Foundation Australia, and V.M.H. is funded by the</p>
    <p>University of Sydney Foundation and Petre Foundation, Australia.'</p>
    <p>We note that you have provided funding information that is not currently declared in your Funding Statement. However, funding information should not appear in the Acknowledgments section or other areas of your manuscript. We will only publish funding information present in the Funding Statement section of the online submission form.</p>
    <p>Please remove any funding-related text from the manuscript and let us know how you would like to update your Funding Statement. Currently, your Funding Statement reads as follows:</p>
    <p>'The funders had no role in study design, data collection and analysis, decision to</p>
    <p>publish, or preparation of the manuscript.'</p>
    <p>Additional Editor Comments (if provided):</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: The authors developed a web-based interactive app to help evaluate the effects of multiple variables on somatic SV detection sensitivity and precision. The impact of sequencing coverage, tumor purity, breakpoint precision threshold and performance of 5 SV caller tools were assessed through building generalised additive models. I think it contributes towards easy-use tools for researchers to plan their WGS experiment, especially for choosing desired sample coverage which affects the sequencing cost.</p>
    <p>The manuscript is well-written and the webpage is nicely built. The app is easy to use with nice design and I like the descriptive and practical illustrations of examples albeit the prediction model is relatively simple with just four variables included as discussed in the limitation section.</p>
    <p>I would like to see the following points to be addressed.</p>
    <p>1. Since structural variations are generally defined into 5 categories: deletions (DELs), insertions (INSs), duplications (DUPs), inversions (INVs), and translocations (TRAs), and some SV callers performs better with certain SV types according to the information they leveraged to call variation, it would be helpful to see the prediction curves with each SV class besides the pooled sensitivity and precision if researchers have interest in a particular SV type. If there is a difference, I would be keen to see further discussion about whether it resulted from the underlying algorithm based on read depth, paired-end read discordance, or split-reads or other possible sources.</p>
    <p>2. In the model validation section, both simulated dataset and cell-line synthetic datasets from ICGC-TCGA DREAM were used. Tumour cell line, however, is still simplification phenomena compared with real cancer tissues. I wonder how the model performs with in silico mixtures of real tumour samples.</p>
    <p>3. The authors used sensitivity and precision as evaluation metrics and built two prediction models respectively. F1 score is the harmonic mean of precision and sensitivity and a single prediction curve can help users to make choice more easily.</p>
    <p>4. As for the selected GAM prediction models, what are the coefficients and significance of both the main and interaction effects of used predictors? A supplementary table may help to understand the variable effects.</p>
    <p>Other than those there were the following minor observations:</p>
    <p>5. p.7, first paragraph of “Prediction Model Validation”. The two “predict”s are redundant in “The results suggest that we can predict sensitivity and precision prediction”.</p>
    <p>6. Figure legend of Fig. S4. Missing space in “simulation data Set 1with tumour coverage”.</p>
    <p>7. p.9, second point in “Application limitations”. Does the real unknown VAF is always lower than histopathological estimates so the predictions here are the upper limits?</p>
    <p>8. The data points in scatterplots of Fig.1 and Fig.2 are overlapped, making it hard to inspect different sets.</p>
    <p>Reviewer #2: The author described a tool called the Shiny-SoSV, which provides an interactive and visual platform for users to compare individual and combined impact of different parameters in somatic structural variant detection.</p>
    <p>The author used simulation data to help estimate the performance (sensitivity and precision) of</p>
    <p>somatic SV detection. And three parameters were included in the Shiny-SoSV tool, which was: variant allele frequency (VAF); sequencing depth of tumor and matched-normal samples; SV breakpoint precision.</p>
    <p>In this study, the author detected somatic SVs using five SV callers: Manta, Lumpy, GRIDSS, Delly and SvABA for each tumour/normal pair and high-confidence calls were post filtered as described previously. However, the author didn’t give reason for why they used these five SV callers. There are many other popular tools. It will be more helpful if the author could simply introduce the tools, and the reason for selecting these five SV callers.</p>
    <p>Reviewer #3: This paper presented a web-based tool , Shiny-SoSV, for predicting performance of somatic SV calling with different tumor purity and sequencing depth. The predictive model was selected and trained with simulation datasets and was validated with another two in-silico datasets. Shiny-SoSV was able to accurately predict somatic SV detection performance for five commonly used SV callers. It can advise users on the selection of SV caller or sequencing depth. There are some concerns about this paper:</p>
    <p>1.As mentioned in Application limitations, the predictive model was trained with simulated datasets, and validated using another simulation replicate and an in-silico dateset from ICGC-TCGA challenge. In real tumor/normal sample sequencing data, the situation can be way more complicated than simulation. The model can be more confident if some real datasets are included for validation.</p>
    <p>2.Overall, the simulation experiment design was well explained. Only the part about simulation replicates (three replicates Set 1-3, and three replicates of Set 1 itself) was confusing, as well as Table 1. Table 1 can be modified to show how the replicates was designed more intuitively.</p>
    <p>3.About the simulated SV set, there were 1,200 germline SVs and 1,200 somatic SVs for each simulation. But there are around 20,000-30,000 SVs in normal human genome. This much lower number of germline SVs may facilitate somatic SV detection in the simulation, as there were much less noisy reads containing germline SV breakpoints.</p>
    <p>4.The results for model validation with Set3 in Table 3 are very interesting. For sensitivity, in four out of five SV callers , RMSE and MAE are lower than RMSE and MAE with same Model in Table 2. But for precision, all five SV callers have higher RMSE and MAE in Set3. More explanation or discussion are expected than just showing RMSE and MAE values in the table.</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Cong Zhang</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: Yes: Yu Chen</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0238108.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238108.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238108" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">8 Aug 2020</named-content>
    </p>
    <p>Reviewer #1: The authors developed a web-based interactive app to help evaluate the effects of multiple variables on somatic SV detection sensitivity and precision. The impact of sequencing coverage, tumor purity, breakpoint precision threshold and performance of 5 SV caller tools were assessed through building generalised additive models. I think it contributes towards easy-use tools for researchers to plan their WGS experiment, especially for choosing desired sample coverage which affects the sequencing cost.</p>
    <p>The manuscript is well-written and the webpage is nicely built. The app is easy to use with nice design and I like the descriptive and practical illustrations of examples albeit the prediction model is relatively simple with just four variables included as discussed in the limitation section.</p>
    <p>I would like to see the following points to be addressed.</p>
    <p>&lt;&lt; Authors’ Response to Reviewer 1 &gt;&gt; </p>
    <p>#RESPONSE: We thank Reviewer 1 for their positive and constructive comments. We address Reviewer 1’s points below: </p>
    <p>1. Since structural variations are generally defined into 5 categories: deletions (DELs), insertions (INSs), duplications (DUPs), inversions (INVs), and translocations (TRAs), and some SV callers performs better with certain SV types according to the information they leveraged to call variation, it would be helpful to see the prediction curves with each SV class besides the pooled sensitivity and precision if researchers have interest in a particular SV type. If there is a difference, I would be keen to see further discussion about whether it resulted from the underlying algorithm based on read depth, paired-end read discordance, or split-reads or other possible sources.</p>
    <p>#RESPONSE: We agree that a breakdown of performance metrics by SV type would be valuable and have done this in our revised manuscript. Specifically, we have expanded the Materials and Methods section “Defining true positive calls and concordant callsets” and “Predictive model selection”, included a new section “Evaluation and predictive model selection of SV type” in supplementary material S1 File, as well as added an additional “tab” in Shiny-SoSV for visualisation and prediction of SV caller performance by SV type.</p>
    <p>#RESPONSE: In general, the impact of the evaluated predictor variables on the detection performance of individual SV type is similar to the impact on overall (SV type aggregated) performance. In our revised manuscript, we examined eight candidate GAM models for each SV type and SV caller, and have chosen the model with lowest estimated RMSE, as summarized in S4 Table.</p>
    <p>#RESPONSE: In brief, we did find a difference in performances for different SV types, where, in general, the best performance was for the detection of DELs for any combination of variables, while INS was hard to detect. These findings support our previous findings [10]. The variability in detection performance by different SV callers for different SV types is mainly due to differences in the callers’ underlying detection and filtering algorithms. In the case of FINS, inserted sequences are absent from the reference genome, which results in weak or an absence of read-alignment signature. Therefore, sensitivity for FINS detection is low and only small FINS, which are within library insert size (500bp), are detectable by the callers evaluated, with the exception of Manta. Programmatically, Manta reports large INS irrespective of whether the inserted sequences can be fully assembled. An interesting finding was general low sensitivity in DEL detection by SvABA, which is predominantly due to its high default cut-off (97bp) of SV sizes [10]. Finally, we showed that SV callers that integrate local-assembly (Manta, GRIDSS and SvABA) perform better in DUP detection than the other callers. </p>
    <p>2. In the model validation section, both simulated dataset and cell-line synthetic datasets from ICGC-TCGA DREAM were used. Tumour cell line, however, is still simplification phenomena compared with real cancer tissues. I wonder how the model performs with in silico mixtures of real tumour samples.</p>
    <p>#RESPONSE: This is a very valid question. In order to address this, we have taken advantage of a recent study of cancer cell lines (COLO-829 and HCC-1143), where the authors examined somatic SV calling performance for different levels of tumour purity, tumour coverage and normal coverage [22]. We compared their evaluation results with our prediction models in a newly added section “Validation using evaluation results from in silico mixing of cancer cell lines” of our revised manuscript, including the addition of Figs 7-9. Although the study of Arora et al. [22] did not present SV calling performance for individual callers, their reported sensitivity, precision and F1 score of their AllSomatic and HighConf callsets could be compared with our predictions of pairwise union and intersection callsets. Overall, we found similar trends of predicted SV calling performance with their evaluation results.</p>
    <p>3. The authors used sensitivity and precision as evaluation metrics and built two prediction models respectively. F1 score is the harmonic mean of precision and sensitivity and a single prediction curve can help users to make choice more easily.</p>
    <p>#RESPONSE: We agree that the predictive curve of F1 score can help users make quick decisions aiming to balance the sensitivity and precision. A new Fig 3 has been added to show the relationship between F1 score and predictor variables for each SV caller. The candidate models (Model (1)-(8)) were expanded and generalized to include F1 score as a response variable in the revised manuscript. Consequently, cross-validation error estimations of candidate models for F1 score were also added to Table 1 and Table S2. Furthermore, the predictive curve of F1 score has now been added alongside sensitivity and precision response variables in the main user interface of the Shiny-SoSV app. The accompanying user’s guide as well as example use-cases have also been updated to demonstrate the utility of F1 score prediction curve.</p>
    <p>4. As for the selected GAM prediction models, what are the coefficients and significance of both the main and interaction effects of used predictors? A supplementary table may help to understand the variable effects.</p>
    <p>#RESPONSE: Thank you for a good suggestion. We have now added a supplementary table (Table S3) for the results of GAM prediction models, including the coefficients and significance of terms the models.</p>
    <p>Other than those there were the following minor observations:</p>
    <p>5. p.7, first paragraph of “Prediction Model Validation”. The two “predict”s are redundant in “The results suggest that we can predict sensitivity and precision prediction”.</p>
    <p>#RESPONSE: The sentence has been modified to remove one “predict”. </p>
    <p>6. Figure legend of Fig. S4. Missing space in “simulation data Set 1with tumour coverage”.</p>
    <p>#RESPONSE: Spaced added.</p>
    <p>7. p.9, second point in “Application limitations”. Does the real unknown VAF is always lower than histopathological estimates so the predictions here are the upper limits?</p>
    <p>#RESPONSE: In practice, VAF can be lower or higher than histopathological estimates. However, in our experience, the real unknown VAF is typically lower than histopathology estimates of tumour purity predominantly because of tumour heterogeneity (presence of clonal and sub-clonal tumour cells). VAF simulated in this study represent tumour purity, which is the fraction of tumour to normal cells. The intent of the stated sentence was to bring awareness to the fact that tumour heterogeneity causing lower VAF for subsets of SVs, which in turn can be a limitation for accurately predicting overall SV detection performance. </p>
    <p>#RESPONSE: Further compounding this complication are that, in practice, there is significant variability in histopathological estimates of tumour purity between pathologists and that the actual piece of tissue used for clinical pathology is almost always different to the tissue sample used for sequencing. All these factors can result in discordance between sequencing and biochemical estimates of VAF. However, this discussion is beyond the scope of this paper on our web-based application. </p>
    <p>8. The data points in scatterplots of Fig.1 and Fig.2 are overlapped, making it hard to inspect different sets.</p>
    <p>#RESPONSE: Fig 1 and Fig 2 have been modified to only contain one dataset. In addition, point size has been reduced to make them easier to see among different variables. </p>
    <p>Reviewer #2: The author described a tool called the Shiny-SoSV, which provides an interactive and visual platform for users to compare individual and combined impact of different parameters in somatic structural variant detection. The author used simulation data to help estimate the performance (sensitivity and precision) of somatic SV detection. And three parameters were included in the Shiny-SoSV tool, which was: variant allele frequency (VAF); sequencing depth of tumor and matched-normal samples; SV breakpoint precision.</p>
    <p>In this study, the author detected somatic SVs using five SV callers: Manta, Lumpy, GRIDSS, Delly and SvABA for each tumour/normal pair and high-confidence calls were post filtered as described previously. However, the author didn’t give reason for why they used these five SV callers. There are many other popular tools. It will be more helpful if the author could simply introduce the tools, and the reason for selecting these five SV callers.</p>
    <p>&lt;&lt; Authors’ Response to Reviewer 2 &gt;&gt; </p>
    <p>#RESPONSE: We thank Reviewer 2 for raising this important point and we agree that a brief description of these tools and why we chose them would be helpful to readers who are not intimately involved with somatic SV detection. We have now provided a brief explanation in the Methods section “Somatic SV detection”, as quoted here:</p>
    <p>#RESPONSE: “These five callers were chosen to provide a wide representation of different SV detection methods and because they have been shown to be best performers within their class in recent benchmarking studies [9-12]. Specifically, both Delly and Lumpy use discordant read-pair and split-read methods, but Lumpy integrate two methods into one SV detection step, called “evidence clustering”, whereas Delly use them in two separate calling and refining steps [10]. Manta, GRIDSS and SvABA further use local-assembly with different methods of targeted assembly, windowed local assembly and genome-wide break-end assembly respectively [10]. Additionally, Manta, Lumpy, GRIDSS and Delly were identified as popular tools among 46 callers published from 2009 to 2017, based on the criteria of Web of Science counts in a recent benchmarking study [12]. While SvABA was published in 2018 and not included in that study, it has shown good performance for both germline and somatic SV detection in other studies [9, 10].”</p>
    <p>#RESPONSE: In anticipation of new and better SV callers being developed in the future, we have made the simulated BAM files and simulated SV sets available via GitHub, with the idea that additional SV callers can be evaluated under identical conditions and so can be compared with the callers already available in Shiny-SoSV.</p>
    <p> </p>
    <p>Reviewer #3: This paper presented a web-based tool , Shiny-SoSV, for predicting performance of somatic SV calling with different tumor purity and sequencing depth. The predictive model was selected and trained with simulation datasets and was validated with another two in-silico datasets. Shiny-SoSV was able to accurately predict somatic SV detection performance for five commonly used SV callers. It can advise users on the selection of SV caller or sequencing depth. There are some concerns about this paper:</p>
    <p>&lt;&lt; Authors’ Response to Reviewer 3&gt;&gt; </p>
    <p>#RESPONSE: We thank Reviewer 3 for their thoughtful comments, which we address below: </p>
    <p>1. As mentioned in Application limitations, the predictive model was trained with simulated datasets, and validated using another simulation replicate and an in-silico dateset from ICGC-TCGA challenge. In real tumor/normal sample sequencing data, the situation can be way more complicated than simulation. The model can be more confident if some real datasets are included for validation.</p>
    <p>RESPONSE: We appreciate this concern from the reviewer. Unfortunately, for obvious reasons, validation with real datasets is difficult because true positives and negatives are generally unknown. This was our original reasoning for using the ICGC-TCGA challenge dataset. However, recognising the need to demonstrate the validity of our prediction model with “more realistic” data, we have since used the published evaluation results of two cancer cell lines (COLO-829 and HCC-1143) for this purpose. In the study of Arora et al. [22], the authors examined somatic SV calling performance on cancer cell lines for different levels of tumour purity, tumour coverage and normal coverage. We compared their evaluation results with our prediction models in a newly added section “Validation using evaluation results from in silico mixing of cancer cell lines” of our revised manuscript, including the addition of Figs 7-9. Although the study of Arora et al. [22] did not present SV calling performance for individual callers, their reported sensitivity, precision and F1 score of their AllSomatic and HighConf callsets were compared with our predictions of pairwise union and intersection callsets. </p>
    <p>#RESPONSE: In summary, we found good concordance between our prediction model and all three validation datasets derived from different settings of increasing complexity. </p>
    <p>2. Overall, the simulation experiment design was well explained. Only the part about simulation replicates (three replicates Set 1-3, and three replicates of Set 1 itself) was confusing, as well as Table 1. Table 1 can be modified to show how the replicates was designed more intuitively.</p>
    <p>#RESPONSE: We have now made the modification to describe the simulated and evaluated variables for model selection and validation separately under the sections of “Simulation of short paired-end reads” and “Predictive model validation” respectively in the main text, instead of in a table format, as following:</p>
    <p>#RESPONSE: “The simulation was conducted to include a comprehensive combination of depths of coverage of the normal and tumour samples, VAF and SV breakpoint precision threshold (explained below in section “Defining true positive calls and concordant callsets”). The following parameter values were simulated:</p>
    <p>Normal samples coverage: 20x, 30x, 40x, 50x, 60x, 70x, 80x, 90x, 100x</p>
    <p>Tumour sample coverage: 20x, 30x, 40x, 50x, 60x, 70x, 80x, 90x, 100x</p>
    <p>VAF: 0.05, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1.00</p>
    <p>Breakpoint precision threshold (bp): 2, 10, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200</p>
    <p>In all, this resulted in a total of 891 tumour/normal pairs of BAM files, encompassing all exhaustive combinations of parameter values.”</p>
    <p>#RESPONSE: “An independent simulation set was generated for validation using a separate simulated SV set (S1 Table) with exhaustive combinations of the following parameter values:</p>
    <p>Normal samples coverage: 25x, 45x, 60x, 75x, 90x;</p>
    <p>Tumour sample coverage: 25x, 45x, 60x, 75x, 90x;</p>
    <p>VAF: 0.10, 0.35, 0.50, 0.75, 0.90;</p>
    <p>Breakpoint precision threshold (bp): 5, 40, 100, 150, 180.”</p>
    <p>3. About the simulated SV set, there were 1,200 germline SVs and 1,200 somatic SVs for each simulation. But there are around 20,000-30,000 SVs in normal human genome. This much lower number of germline SVs may facilitate somatic SV detection in the simulation, as there were much less noisy reads containing germline SV breakpoints.</p>
    <p>#RESPONSE: This is a very good point and we absolutely agree that in reality there are more germline SVs than somatic SVs in cancer genomes. Therefore, we have repeated our entire study by increasing the number of germline SVs by ten-fold, with new combinations of evaluated variables for both model selection and validation data sets. All results, including figures and tables, have been updated in the revised paper with these new results derived from the new simulation datasets.</p>
    <p>#RESPONSE: We have further provided a detailed discussion of the impact of our simulation design to the SV evaluation results in section “SV simulation design comparison” of supplementary material S1 File. In brief, we observed no more than 5% change in sensitivity and less than 1% change in precision for most of the callers. The exceptions were the sensitivity of Manta and Delly, where we observed 2.5%-7.5% reduction for Manta and up to 15% for Delly at low VAF (&lt; 0.5). </p>
    <p>4. The results for model validation with Set3 in Table 3 are very interesting. For sensitivity, in four out of five SV callers, RMSE and MAE are lower than RMSE and MAE with same Model in Table 2. But for precision, all five SV callers have higher RMSE and MAE in Set3. More explanation or discussion are expected than just showing RMSE and MAE values in the table.</p>
    <p>#RESPONSE: We have added a discussion comparing error rate of validation data set in Table 2 and cross-validation error estimation for the chosen prediction models in Table 1 and an explanation on the change, especially the decreasing RMSE for precision prediction of SvABA and Delly.</p>
    <supplementary-material content-type="local-data" id="pone.0238108.s022">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_FINAL.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0238108.s022.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0238108.r003" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238108.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chong</surname>
          <given-names>Zechen</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Zechen Chong</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Zechen Chong</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238108" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">11 Aug 2020</named-content>
    </p>
    <p>Shiny-SoSV: A web-based performance calculator for somatic structural variant detection</p>
    <p>PONE-D-20-12646R1</p>
    <p>Dear Dr. Chan,</p>
    <p>We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p>
    <p>Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p>
    <p>An invoice for payment will follow shortly after the formal acceptance. To ensure an efficient process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="http://www.editorialmanager.com/pone/">http://www.editorialmanager.com/pone/</ext-link>, click the 'Update My Information' link at the top of the page, and double check that your user information is up-to-date. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>Kind regards,</p>
    <p>Zechen Chong</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
  </body>
</sub-article>
<sub-article id="pone.0238108.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238108.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chong</surname>
          <given-names>Zechen</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Zechen Chong</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Zechen Chong</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238108" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Aug 2020</named-content>
    </p>
    <p>PONE-D-20-12646R1 </p>
    <p>Shiny-SoSV: A web-based performance calculator for somatic structural variant detection </p>
    <p>Dear Dr. Chan:</p>
    <p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>If we can help with anything else, please email us at <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE and supporting open access. </p>
    <p>Kind regards, </p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Zechen Chong </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
