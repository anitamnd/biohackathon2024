<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ1747 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEgr9 jpg ?>
<?FILEgr10 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEsi1 svg ?>
<?FILEsi2 svg ?>
<?FILEsi3 svg ?>
<?FILEsi4 svg ?>
<?FILEsi5 svg ?>
<?FILEsi6 svg ?>
<?FILEsi7 svg ?>
<?FILEsi8 svg ?>
<?FILEsi9 svg ?>
<?FILEsi10 svg ?>
<?FILEsi11 svg ?>
<?FILEsi12 svg ?>
<?FILEsi13 svg ?>
<?FILEsi14 svg ?>
<?FILEsi15 svg ?>
<?FILEsi16 svg ?>
<?FILEsi17 svg ?>
<?FILEsi18 svg ?>
<?FILEsi19 svg ?>
<?FILEsi20 svg ?>
<?FILEsi21 svg ?>
<?FILEsi22 svg ?>
<?FILEsi23 svg ?>
<?FILEsi24 svg ?>
<?FILEsi25 svg ?>
<?FILEsi26 svg ?>
<?FILEsi27 svg ?>
<?FILEsi28 svg ?>
<?FILEsi29 svg ?>
<?FILEsi30 svg ?>
<?FILEsi31 svg ?>
<?FILEsi32 svg ?>
<?FILEsi33 svg ?>
<?FILEsi34 svg ?>
<?FILEsi35 svg ?>
<?FILEsi36 svg ?>
<?FILEsi37 svg ?>
<?FILEsi38 svg ?>
<?FILEsi39 svg ?>
<?FILEsi40 svg ?>
<?FILEsi41 svg ?>
<?FILEsi42 svg ?>
<?FILEsi43 svg ?>
<?FILEsi44 svg ?>
<?FILEsi45 svg ?>
<?FILEsi46 svg ?>
<?FILEsi47 svg ?>
<?FILEsi48 svg ?>
<?FILEsi49 svg ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9464881</article-id>
    <article-id pub-id-type="pii">S2001-0370(22)00393-2</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2022.08.059</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CASPIAN: A method to identify chromatin topological associated domains based on spatial density cluster<sup><xref ref-type="fn" rid="d35e87">☆</xref></sup></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Gong</surname>
          <given-names>Haiyan</given-names>
        </name>
        <email>ghaiyan@xs.ustb.edu.cn</email>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Yang</surname>
          <given-names>Yi</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Zhang</surname>
          <given-names>Xiaotong</given-names>
        </name>
        <email>zxt@ies.ustb.edu.cn</email>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Li</surname>
          <given-names>Minghong</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au025">
        <name>
          <surname>Zhang</surname>
          <given-names>Sichen</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au030">
        <name>
          <surname>Chen</surname>
          <given-names>Yang</given-names>
        </name>
        <email>yc@ibms.pumc.edu.cn</email>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005"><label>a</label>School of Computer and Communication Engineering, Beijing Key Laboratory of Knowledge Engineering for Materials Science, Beijing Advanced Innovation Center for Materials Genome Engineering, University of Science and Technology Beijing, Beijing 100083, China</aff>
      <aff id="af010"><label>b</label>The State Key Laboratory of Medical Molecular Biology, Department of Biochemistry and Molecular Biology, Institute of Basic Medical Sciences, School of Basic Medicine, Chinese Academy of Medical Sciences, Peking Union Medical College, Beijing 100005, China</aff>
      <aff id="af015"><label>c</label>Shunde Graduate School, University of Science and Technology Beijing, Foshan 528399, Guangdong, China</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding authors at: School of Computer and Communication Engineering, Beijing Key Laboratory of Knowledge Engineering for Materials Science, Beijing Advanced Innovation Center for Materials Genome Engineering, University of Science and Technology Beijing, Beijing 100083, China (X. Zhang). The State Key Laboratory of Medical Molecular Biology, Department of Biochemistry and Molecular Biology, Institute of Basic Medical Sciences, School of Basic Medicine, Chinese Academy of Medical Sciences, Peking Union Medical College, Beijing 100005, China (Y. Chen). <email>zxt@ies.ustb.edu.cn</email><email>yc@ibms.pumc.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>05</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <volume>20</volume>
    <fpage>4816</fpage>
    <lpage>4824</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Author(s)</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab005">
      <p>With the development of Hi-C technology, the detection of topologically associated domains (TADs) boundaries plays an important role in exploring the relationship between gene structure and expression. However, a method that can identify accurate TAD boundaries from the Hi-C contact matrix with different resolutions is currently lacking. We proposed a method named CASPIAN that can identify chromatin TAD boundaries based on the spatial density clustering algorithm. CASPIAN requires few parameters to call TADs. This method is realized using the hierarchical density-based clustering method HDBSCAN, where the distance of pairwise bins is calculated based on three distance metrics (Euclidean, Manhattan, and Chebyshev distance metric) to adapt to the characteristics of the Hi-C contact matrix generated from simulation experiments or normalized methods. Our results show that, same as standard methods (e.g., Insulation Score, TopDom), CASPIAN can enrich factors related to promoting the gene expression, such as CTCF, H3K4me1, H3K4me3, RAD21, POLR2A, and SMC3. We also calculated the approximate proportion of various factors anchored at the TAD boundaries to observe the distribution of these factors surrounding the TAD boundaries. In conclusion, CASPIAN is an easy method to explore the relationship between transcription factors and TAD boundaries. CASPIAN is available online (https://gitee.com/ghaiyan/caspian).</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Hi-C</kwd>
      <kwd>Chromatin structure</kwd>
      <kwd>TAD</kwd>
      <kwd>Spatial distance</kwd>
      <kwd>Cluster</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0005">Chromosome structure plays an important role in the gene expression and transcription, and available research has shown that chromosome structure is hierarchical with A/B compartments <xref rid="b0005" ref-type="bibr">[1]</xref>, topologically associated domains (TADs) <xref rid="b0010" ref-type="bibr">[2]</xref>, sub-TADs <xref rid="b0015" ref-type="bibr">[3]</xref>, and Loops <xref rid="b0005" ref-type="bibr">[1]</xref>. An “A” compartment is defined as an open and expression-active chromatin domain with high gene density, and a “B” compartment is defined as a closed and expression-inactive domain with low gene density. Girelli et.al. <xref rid="b0020" ref-type="bibr">[4]</xref> revealed that “A” compartments were more central than “B” compartments in relation to their radial distribution in the cell nucleus, the features of active chromatin, gene density, and expression increased globally toward the nuclear interior in parallel. This proved that gene function is related to the chromatin structure. TADs are thought to be the basic unit of chromatin organization and play significant roles in gene transcription, regulation and replication <xref rid="b0025" ref-type="bibr">[5]</xref>. Increasing evidence indicates that when TAD boundaries are disrupted, gene expression is adversely affected, leading to diseases such as dysmorphic syndromes and cancer <xref rid="b0010" ref-type="bibr">[2]</xref>, <xref rid="b0030" ref-type="bibr">[6]</xref>. Chromatin Loops are reported to be squeezed to form chromatin domains <xref rid="b0035" ref-type="bibr">[7]</xref>, resulting in the spatial proximity <xref rid="b0040" ref-type="bibr">[8]</xref> of chromatin, such as enhancer-promoter interactions, that are real and biological chromatin interactions. The methods of identifying significant chromatin interactions from chromatin contact matrices are usually used to identify chromatin Loops. Existing studies show that some TADs are related to the chromatin Loops mediated by the CCCTC-binding factor (CTCF). Most of the two boundaries of a TAD coincide with the two anchor sites of a chromatin Loop <xref rid="b0045" ref-type="bibr">[9]</xref>, <xref rid="b0050" ref-type="bibr">[10]</xref>, <xref rid="b0055" ref-type="bibr">[11]</xref>. Therefore, the identification of TADs can better facilitate our understanding of the mechanisms of chromatin formation.</p>
    <p id="p0010">Observation of the Hi-C contact heatmap has shown that TAD areas appear to be “triangles” on the diagonal of the heat map when the Hi-C resolution is less than 100 kb and that the intra-TAD interactions are merely <inline-formula><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>2</mml:mn><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> those of interactions between nearby TADs <xref rid="b0010" ref-type="bibr">[2]</xref>, <xref rid="b0035" ref-type="bibr">[7]</xref>. This indicates two fundamental features of TAD organization: the “self-association” property within TAD regions and the “insulation” property between adjacent TADs. The boundaries of TADs are enriched with the CTCF, cohesin complex, housekeeping genes, histone mark H3K4me3, as well as other factors <xref rid="b0010" ref-type="bibr">[2]</xref>, <xref rid="b0060" ref-type="bibr">[12]</xref>, and all of these properties are essential features upon which various computational algorithms for identifying TADs rely.</p>
    <p id="p0015">Over the past decade, most researchers identified TADs by extracting 1-dimensional (1D) features from contact matrices for segmentation or by using clustering algorithms. The former includes methods such as Directionality Index (DI) <xref rid="b0010" ref-type="bibr">[2]</xref>, Insulation score <xref rid="b0050" ref-type="bibr">[10]</xref>, Arrowhead <xref rid="b0065" ref-type="bibr">[13]</xref>, TopDom <xref rid="b0070" ref-type="bibr">[14]</xref>, HiCSeg <xref rid="b0075" ref-type="bibr">[15]</xref>, TADtree <xref rid="b0085" ref-type="bibr">[17]</xref>, rGAMP <xref rid="b0060" ref-type="bibr">[12]</xref>, PSYCHIC <xref rid="b0090" ref-type="bibr">[18]</xref>, HiCDB <xref rid="b0095" ref-type="bibr">[19]</xref>, EAST <xref rid="b0100" ref-type="bibr">[20]</xref>, TADBD <xref rid="b0105" ref-type="bibr">[21]</xref>, and TADreg <xref rid="b0110" ref-type="bibr">[22]</xref>, convert the identification of TADs to be the local changes associated with topological features in the 1D signal. The latter methods including DHDF <xref rid="b0115" ref-type="bibr">[23]</xref>, TAD_Identification <xref rid="b0120" ref-type="bibr">[24]</xref>, IC-Finder <xref rid="b0125" ref-type="bibr">[25]</xref>, MrTADFinder <xref rid="b0130" ref-type="bibr">[26]</xref>, 3DnetMod <xref rid="b0135" ref-type="bibr">[27]</xref>, SpectralTAD <xref rid="b0140" ref-type="bibr">[28]</xref>, ClusterTAD <xref rid="b0145" ref-type="bibr">[29]</xref>, and TADpole <xref rid="b0150" ref-type="bibr">[30]</xref> identified TADs by clustering algorithms. However, most of these methods cannot identify TADs from high-resolution Hi-C contact matrices (Dali et al. <xref rid="b0155" ref-type="bibr">[31]</xref> have proved that only Arrowhead and DomainCaller could be run at 5 kb resolution on a server with 23 GB of RAM.), or the identified TAD boundaries cannot anchor factors with a high ratio (i.e., the ratio of TAD boundaries anchoring factors or transciption elements, such as CTCF, enhancer, promoter), or the parameters of TAD callers are too many for researchers to understand how to set suitable parameters to identify TADs.</p>
    <p id="p0020">Hence, we propose a chromatin topological associated domains (TADs) identification algorithm named CASPIAN based on the spatial density cluster without setting too many parameters. This method considers three distance metrics (Euclidean, Manhattan, and Chebyshev distance metric) to do clustering from the Hi-C contact matrix generated by simulated experiments or by different Hi-C normalized methods to detect TADs. Results show that CASPIAN using Euclidean distance metric could always perform well for simulated Hi-C contact matrix or real Hi-C data at different resolutions (5 kb, 25 kb, and 50 kb). By observing the average P-value and anchor ratio of different factors target ChIP-seq surrounding the TAD boundaries, we conclude that TAD boundaries are enriched with factors related to promoting the gene expression (CTCF, H3K4me1, H3K4me3, RAD21, POLR2A, and SMC3), in particular, the detected TAD boundaries anchor about 70% CTCF, 29% enhancer, 14% promoters,30% H3K36me3, 40% H3K4me1, 30% H3K4me3, 30% POLR2A, 60% RAD21, and 50% SMC3. By assessing the recalling ratio of TADs called by other methods, CASPIAN can recall more TADs that are detected from Insulation score <xref rid="b0050" ref-type="bibr">[10]</xref> and TopDom <xref rid="b0070" ref-type="bibr">[14]</xref>. Overall, our CASPIAN method can detect TAD boundaries from simulated Hi-C and real Hi-C generated with different resolutions to help explore the distribution of different factors surrounding the TAD boundaries.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Methods</title>
    <sec id="s0015">
      <label>2.1</label>
      <title>Overview of the CASPIAN Framework</title>
      <p id="p0025"><xref rid="f0005" ref-type="fig">Fig. 1</xref>(a) illustrates the data analysis pipeline of CASPI-AN, including three modules for identifying chromatin TAD boundaries: the data preprocessing module, the cluster module, and the TADs generation module. The data preprocessing module is designed for obtaining a raw contact matrix or a normalized contact matrix from raw sequence Hi-C data. The cluster module applies hierarchical density-based clustering methods <xref rid="b0160" ref-type="bibr">[32]</xref> to classify these Hi-C bins’ features with different labels. The TADs generation module divides the boundaries of TAD according to these clustering results.<fig id="f0005"><label>Fig. 1</label><caption><p>Overview of the CASPIAN Framework. (a) The data pipeline for CASPIAN to identify and evaluate chromatin TAD boundaries. (b) The workflow for HDBSCAN.</p></caption><graphic xlink:href="gr1"/></fig></p>
    </sec>
    <sec id="s0020">
      <label>2.2</label>
      <title>The Data Preprocessing Module</title>
      <p id="p0030">By processing the raw Hi-C sequence data with mapping and alignment, we could get the raw Hi-C matrix. The Hi-C experiment measures the probability of physical proximity between pairs of chromosomal loci at the genome scale, but there are some systematic biases during the experiment that seriously affect the experimental results <xref rid="b0165" ref-type="bibr">[33]</xref>. Therefore, it’s essential to normalize Hi-C data to eliminate system bias. In this paper, we chose the vanilla coverage (VC) and Knight &amp; Ruiz methods (KR) <xref rid="b0170" ref-type="bibr">[34]</xref> to do Hi-C data normalization. The VC algorithm divided each bin of the matrix by its row sum and column sum to remove different sequencing coverage of each loci. The KR algorithm <xref rid="b0170" ref-type="bibr">[34]</xref> aimed to balance nonnegative square contact matrices to eliminate this bias, which is widely used for correcting Hi-C contact matrices.</p>
    </sec>
    <sec id="s0025">
      <label>2.3</label>
      <title>The Cluster Module</title>
      <p id="p0035">The CASPIAN method is designed to cluster bins based on the chromosome space distance density. Importantly, the DBSCAN <xref rid="b0175" ref-type="bibr">[35]</xref> (density-based spatial clustering of applications with noise) clustering algorithm does not need to set the number of clusters and can be used to divide clusters with complex shapes. The principle of DBSCAN is to identify points in dense regions of the feature space where many data points are close together, and this is similar to the characteristics of TADs in chromatin. Therefore, we can apply DBSCAN to identify TADs without considering the number of TADs.</p>
      <sec id="s0030">
        <label>2.3.1</label>
        <title>The Description of DBSCAN</title>
        <p id="p0040">The DBSCAN algorithm has two parameters: the minimum number of points in the radius, <inline-formula><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the neighborhood radius, <italic>eps</italic>. Given a sample, let <inline-formula><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eps</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represent a sphere within the radius of the neighborhood centered on the sample. The function <inline-formula><mml:math id="M4" altimg="si4.svg"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> given below counts the number of samples contained in the set. A sample <inline-formula><mml:math id="M5" altimg="si5.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> is called a core sample if it satisfies Eq. <xref rid="e0005" ref-type="disp-formula">(1)</xref>:<disp-formula id="e0005"><label>(1)</label><mml:math id="M6" altimg="si6.svg"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eps</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>⩾</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p>
        <p id="p0045">The DBSCAN algorithm puts core samples that are less than <italic>eps</italic> away from each other into a cluster. The algorithm first randomly selects a sample <inline-formula><mml:math id="M7" altimg="si7.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and then finds all samples whose distance is less than or equal to <italic>eps</italic>. If the number of samples within <italic>eps</italic> from <inline-formula><mml:math id="M8" altimg="si8.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is less than <inline-formula><mml:math id="M9" altimg="si9.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, then the sample is marked as noise, that is, it does not belong to any cluster. If this sample is a core sample, it is assigned a new cluster label. After this, all neighbors within <inline-formula><mml:math id="M10" altimg="si10.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eps</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are visited. If these neighbors have not been assigned a cluster label, and assign them the cluster label just created; if these neighbors are core samples, visit their neighbors. The cluster grows until there are no more core samples within the cluster’s neighborhood radius. The above steps are then repeated until all samples have been visited. Altogether there are three types of samples: core samples, boundary samples (samples whose distance from the core samples is within <italic>eps</italic>), and noise.</p>
        <p id="p0050">However, the parameters (<italic>eps</italic> and <inline-formula><mml:math id="M11" altimg="si11.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) of DBSCAN algorithm determine the quality of clustering. In this paper, we chose the extended algorithm HDBSCAN to do clustering without manual selection of parameter <italic>eps</italic> and <inline-formula><mml:math id="M12" altimg="si12.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="s0035">
        <label>2.3.2</label>
        <title>The Description of HDBSCAN</title>
        <p id="p0055">Given a sample set <inline-formula><mml:math id="M13" altimg="si13.svg"><mml:mrow><mml:mi>X</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, as <xref rid="f0005" ref-type="fig">Fig. 1</xref>(b) shows, we can cluster the samples based on HDBSCAN within six steps:</p>
        <p id="p00551">(1) Choose the Minkowski distance metric (Manhattan, Euclidean, or Chebyshev) to calculate the core distance <inline-formula><mml:math id="M14" altimg="si14.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of sample <inline-formula><mml:math id="M15" altimg="si15.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="M16" altimg="si16.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to its <inline-formula><mml:math id="M17" altimg="si17.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>-nearest neighbor including <inline-formula><mml:math id="M18" altimg="si18.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where the Manhattan distance, Euclidean distance, and Chebyshev distance can be described as Eq. <xref rid="e0010" ref-type="disp-formula">(2)</xref>, the core distance satisfies the Eq. <xref rid="e0005" ref-type="disp-formula">(1)</xref>.<disp-formula id="e0010"><label>(2)</label><mml:math id="M19" altimg="si19.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo linebreak="goodbreak">=</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>where A, B are two data sets with same number <italic>n</italic> of data, <inline-formula><mml:math id="M20" altimg="si20.svg"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. When <italic>p</italic> is equal to be 1, the Minkowski distance is the Manhattan distance. When <italic>p</italic> is equal to be 2, the Minkowski distance is the Euclidean distance. When <italic>p</italic> is equal to be <inline-formula><mml:math id="M21" altimg="si21.svg"><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>, the Minkowski distance is the Chebyshev distance.</p>
        <p id="p00552">(2) Caculate the mutual reachability distance to generate the Mutual Reachability Graph <inline-formula><mml:math id="M22" altimg="si22.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where the mutual reachability distance (<inline-formula><mml:math id="M23" altimg="si23.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mreach</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>) between sample <inline-formula><mml:math id="M24" altimg="si24.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M25" altimg="si25.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is defined as Eq. <xref rid="e0015" ref-type="disp-formula">(3)</xref> shows. The Mutual Reachability Graph <inline-formula><mml:math id="M26" altimg="si26.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pts</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a complete graph, where the vertices are the samples of <italic>X</italic>, the weight of each edge is the mutual reachability distance between pairwise samples.<disp-formula id="e0015"><label>(3)</label><mml:math id="M27" altimg="si27.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mreach</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo linebreak="goodbreak">=</mml:mo><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p id="p00553">(3) Create the minimum spanning tree based on the minimum spanning tree algorithm prime <xref rid="b0185" ref-type="bibr">[37]</xref>.</p>
        <p id="p00554">(4) Create a hierarchical cluster similar to the preocess of Huffman tree construction. Firstly, sort all the edges in the tree by increasing distance. Secondly, select each edge in turn and merge the two subgraphs of the edge link.</p>
        <p id="p00555">(5) Condense the clustered tree. Firstly, determine the minimum cluster size <italic>n</italic>. Secondly, traverse the clustering tree from top to bottom to see if the number of the two sample subsets generated by the split is greater than n. If the number of samples of a child node in the left or right sons is <inline-formula><mml:math id="M28" altimg="si28.svg"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, delete the node directly, and the other child node retains the identity of the parent node. If both of the sample size of the two child nodes is <inline-formula><mml:math id="M29" altimg="si29.svg"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, then delete both of its child nodes. If the number of samples in both child nodes is <inline-formula><mml:math id="M30" altimg="si30.svg"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, then the original clustering tree keeps unchanged.</p>
        <p id="p00556">(6) Label these samples based on the cluster stability. Let <inline-formula><mml:math id="M31" altimg="si31.svg"><mml:mrow><mml:mi>λ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="italic">dist</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>dist</italic> is the mutual reachability distance. For the vertices of a tree, define <inline-formula><mml:math id="M32" altimg="si32.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">birth</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M33" altimg="si33.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be the <inline-formula><mml:math id="M34" altimg="si34.svg"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> value when the cluster splits and becomes its own cluster or the <inline-formula><mml:math id="M35" altimg="si35.svg"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> value when a cluster splits into smaller clusters. For a sample <italic>p</italic> in a given cluster, we define <inline-formula><mml:math id="M36" altimg="si36.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be <inline-formula><mml:math id="M37" altimg="si37.svg"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> value of the point “outlier”, where <inline-formula><mml:math id="M38" altimg="si38.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">birth</mml:mi></mml:mrow></mml:msub><mml:mo>⩽</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The cluster stability is define to be <inline-formula><mml:math id="M39" altimg="si39.svg"><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="italic">cluster</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">-</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">birth</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Firstly, initialize the cluster by assigning each leaf node of the condensed tree to be a cluster. Secondly, walk through the tree from the bottom up with the following process. If the stability of the current node is less than the sum of the stability of the two children nodes, then we set the stability of this node to be the sum of the stability of its children nodes. If the stability of the current node is greater than the sum of the stability of the two children nodes, the current node is defined as a cluster.</p>
      </sec>
    </sec>
    <sec id="s0040">
      <label>2.4</label>
      <title>The TADs Generation Module</title>
      <p id="p0060">As described above, each bin is labeled based on the clustering module. Research has shown that the length of TAD is between 100 kb and 5 Mb <xref rid="b0180" ref-type="bibr">[36]</xref>. Therefore, for a continuous area formed by bins with a same label is identified to be a TAD, when the number of <inline-formula><mml:math id="M40" altimg="si40.svg"><mml:mrow><mml:mi mathvariant="italic">bins</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">resolution</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>100</mml:mn><mml:mi mathvariant="italic">kb</mml:mi></mml:mrow></mml:math></inline-formula>. For example, when the resolution of Hi-C data is equal to be 50 kb, then the continuous area must contain at least 2 bins with a same label.</p>
    </sec>
    <sec id="s0045">
      <label>2.5</label>
      <title>Simulated Hi-C Data</title>
      <p id="p0065">We used the simulated Hi-C data proposed by Mattia etc. <xref rid="b0190" ref-type="bibr">[38]</xref> for TAD callers. The simulation process is described as the following. These bins coordinates inside a TAD are randomly simulated by sampling TAD sizes from a uniform distribution with minimum TAD bins size value of 3 and a maximum TAD bins size value of 50. The simulated contact matrix contains a fixed number of TADs and a random sampling of TAD sizes. The target size of the simulated contact matrix is defined based on the expected average of the uniformly distributed TAD sizes. Using this strategy, 171 TADs were simulated at 40 kb resolution with a target size similar to the size of the human chromosome 5 (180.92 Mb), i.e., the same used to estimate the power-law decay parameters. Among the 171 TADs, we used the simulated 40 kb resolution Hi-C contact matrix when noise levels 4, 8, 12, and 16 to compare with other TAD callers. To assess the performance of CASPIAN at different resolutions, we also downloaded the synthetic Hi-C dataset provided by Trussart etc. <xref rid="b0195" ref-type="bibr">[39]</xref>. This synthetic Hi-C dataset was generated by a worm-like chain (WLC) model, which was characterized by the physical thickness (the diameter, unit: nm), the stiffness (the persistence length, unit: nm), the level of DNA compaction of the chain (the linear density, unit: bp/nm), the experimental noise level to select pairwise interactions with a Gaussian probability model. In this paper, we used the synthetic Hi-C dataset with a linear density of 40, 75, 150 bp/nm and a noise level of 50, 100, 150, and 200.</p>
    </sec>
    <sec id="s0050">
      <label>2.6</label>
      <title>Real Hi-C Data</title>
      <p id="p0070">To obtain the Hi-C contact matrix, we downloaded the Hi-C data (486.85 million read pairs of sequencing coverage) in the GM12878 cell line with the accession number 4DNFI1UEG1HD from the 4dnucleome platform (https://data.4dnucleome.org/). By executing the jar package juicer_tools_1.22.01.jar, we could get an N*N raw, KR-normalized, or VC-normalized matrix at 5 kb, 25 kb or 50 kb resolution, where N is the number of bins.</p>
      <p id="p0075">To run the Directionality Index (DI) <xref rid="b0010" ref-type="bibr">[2]</xref> and Insulation Score (IS) <xref rid="b0050" ref-type="bibr">[10]</xref> algorithms, we downloaded the.mcool format Hi-C data in the GM12878 cell line with the accession number 4DNFIXP4QG5B from the 4dnucleome platform.</p>
    </sec>
    <sec id="s0055">
      <label>2.7</label>
      <title>ChIP-seq Data</title>
      <p id="p0080">The CTCF, POLR2A, RAD21, SMC3, H3K4me3, H3K3-6me3, and H3K9me3 target ChIP-seq data were downloaded from ENCODE platform <xref rid="b0080" ref-type="bibr">[16]</xref> (www.encodeproject.org <xref rid="b0200" ref-type="bibr">[40]</xref>) with accession number ENCFF749HDD, ENCFF002GST, ENCF-F822QJA, ENCFF775OOS, ENCFF480KNX, ENCFF537K-DM, ENCFF174RRQ, ENCFF218YZR, respectively.</p>
      <p id="p0085">We used the replicated peaks files (bed narrow peak file type) to calculate the number of peaks where the identified TAD boundaries anchor. We used the signal p-value files (bigWig file type) to plot the average p-value of ChIP-seq data around the genomic bins of identified TAD boundaries within 40 kb genomic distance.</p>
    </sec>
    <sec id="s0060">
      <label>2.8</label>
      <title>Evaluating the Quality of TADs</title>
      <p id="p0090">To evaluate the quality of TADs, we chose the following metrics. First, we chose the average length of identified TADs and the number of identified TADs to be the metrics.</p>
      <p id="p0095">Second, to compare the similarity of TADs identified by CASPIAN with the simulated TADs (the true TADs) from simulation Hi-C data or TADs identified from other existing methods, bins are divided into three clusters according to the TAD results: bins in TAD boundaries, bins within TADs, and bins between TADs. The Fowlkes-Mallows score (FMS), and Rand index (RI) provided by the scikit-learn tool <xref rid="b0205" ref-type="bibr">[41]</xref> are then used to evaluate the extent of the agreement between two clusters. The FMS is defined as the mean of the precision and recall as shown in Eq. <xref rid="e0020" ref-type="disp-formula">(4)</xref>.<disp-formula id="e0020"><label>(4)</label><mml:math id="M41" altimg="si41.svg"><mml:mrow><mml:mi mathvariant="italic">FMI</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FP</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FN</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p id="p0100">In Eq. <xref rid="e0020" ref-type="disp-formula">(4)</xref>, TP is the number of true-positive sample pairs, FP is the number of false-positive sample pairs, and FN is the number of false-negative sample pairs. The FMI ranges from 0 to 1, and a higher value indicates more similarity between the two clusters.</p>
      <p id="p0105">The Rand Index is defined as <inline-formula><mml:math id="M42" altimg="si42.svg"><mml:mrow><mml:mi mathvariant="italic">RI</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> to compute the similarity between two clusters, where <inline-formula><mml:math id="M43" altimg="si43.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of agreeing pairs, <italic>N</italic> is the number of pairs. A higher RI value indicates more similarity between two clusters.</p>
      <p id="p0110">Third, one existing study <xref rid="b0010" ref-type="bibr">[2]</xref> has suggested that TAD boundaries are enriched with CTCF, H3K4me3, H3K36me3, and transcription start sites (TSSs). Because CTCF is related to some active transcriptional activity, the RAD21 and SMC3 are all transcription factors that promote transcription. Hence, both the ratio of anchoring CTCF binding sites and histone modification mark H3K4me3, H3K36me3, and transcription factors signal (POLR2A, RAD21, and SMC3) are applied to evaluate the TAD quality.</p>
      <p id="p0115">Last, reasearches <xref rid="b0045" ref-type="bibr">[9]</xref>, <xref rid="b0050" ref-type="bibr">[10]</xref>, <xref rid="b0055" ref-type="bibr">[11]</xref> have shown that some of the two boundaries of a TAD coincide with the two anchor sites of a chromatin Loop (such as enhancer-promoter interaction). Therefore, we also explore the ratio of TAD boundaries identified by different TAD callers anchoring enhancer or promoter elements to validate the correctness of identified TAD boundaries. We define <inline-formula><mml:math id="M44" altimg="si44.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">ratio</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">TAD</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">ratio</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">TAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M45" altimg="si45.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of TAD boundaries anchoring an enhancer element, <inline-formula><mml:math id="M46" altimg="si46.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of TAD boundaries anchoring an promoter element, <inline-formula><mml:math id="M47" altimg="si47.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">TAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of TAD boundaries identified by TAD callers.</p>
    </sec>
    <sec id="s0065">
      <label>2.9</label>
      <title>Baselines</title>
      <p id="p0120">In this paper, we chose the following methods to compare with CASPIAN: Insulation Score (IS) <xref rid="b0050" ref-type="bibr">[10]</xref>, TopDom <xref rid="b0070" ref-type="bibr">[14]</xref>, Directionality Index (DI) <xref rid="b0010" ref-type="bibr">[2]</xref>, IC-Finder <xref rid="b0125" ref-type="bibr">[25]</xref>, HiCSeg <xref rid="b0075" ref-type="bibr">[15]</xref>, and ClusterTAD <xref rid="b0145" ref-type="bibr">[29]</xref>. We chose the above methods by considering two factors: 1) whether TADs identified by these methods are hierarchical. Because we do not consider identifying hierarchical TADs structures in this paper. 2) the only input data of TAD callers is Hi-C contact matrix. Among these methods, Insulation Score, Directionality Index (DI), TopDom, IC-Finder, and HiCSeg are five standard TAD callers, ClusterTAD is a TAD caller based on a clustering algorithm. Since the TADs identified in this paper do not consider the hierarchical structure, the above-selected methods all can not detect hierarchical TADs. All scripts for calling TADs by the above methods can be found in “Scripts_for_TAD_caller.txt”, which can be downloaded from https://gitee.com/ghaiyan/caspian.</p>
    </sec>
  </sec>
  <sec id="s0070">
    <label>3</label>
    <title>Results and Discussion</title>
    <sec id="s0075">
      <label>3.1</label>
      <title>Determination of the Distance Metric</title>
      <p id="p0125">For the first step of HDBSCAN, considering the characteristic of TADs (i.e., the triangular domain on the diagonal of the Hi-C map) in the Hi-C contact map, we used the Minkowski distance including Manhattan, Euclidean, and Chebyshev distance to measure the distance of pairwise bins. For simulated and real Hi-C contact matrix, the three distance metrics had a different performance.</p>
      <p id="p0130">Firstly, we explored the distance metrics how to affect the TAD quality of TADs identified from simulated 40 kb resolution Hi-C contact matrices with noise leveling 4, 8, 12, 16 provided by an existing study <xref rid="b0190" ref-type="bibr">[38]</xref>. As <xref rid="f0010" ref-type="fig">Fig. 2</xref> and Figure S1-S3 show, CASPIAN using the Euclidean distance metric gets similar TADs segmentation results with the simulated TADs provided by Mattia et al. <xref rid="b0190" ref-type="bibr">[38]</xref> from the aspect of heatmap visualization, CASPIAN using the Manhattan distance metric not only detects the simulated TADs provided by Mattia, etc <xref rid="b0190" ref-type="bibr">[38]</xref>, but also detects more TADs within these TADs, CASPIAN using the Chebyshev distance metric detects tiny TADs, but obviously differs from the simulated TADs. As <xref rid="f0015" ref-type="fig">Fig. 3</xref> shows, we used the rand index (RI) and Fowlkes-Mallows score (FMS) to measure the similarity between identified TADs and simulated TADs. These results show that CASPIAN using the Euclidean distance metric performs much better than the other two distance metrics on simulated Hi-C data with noise leveling 4, 8, 12, 16, where RI and FMS are both close to 1.<fig id="f0010"><label>Fig. 2</label><caption><p>Heatmaps with detected TAD boundaries based on a simulated 40 kb resolution Hi-C contact matrix at noise level 4, where the identified TADs are outlined by black lines.</p></caption><graphic xlink:href="gr2"/></fig><fig id="f0015"><label>Fig. 3</label><caption><p>Histogram plot of RI and FMS to show the similarity of TADs called from different methods compared to the simulated TADs with different noise value. Figure  (a), (b), (c), (d) represent the comparison with 4, 8, 12, 16 noise simulated data, respectively.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0135">To assess the performance of CASPIAN under different simulation conditions, we used the synthetic Hi-C dataset provided by Trussart et al. <xref rid="b0195" ref-type="bibr">[39]</xref> with a linear density of 40, 75, 150 bp/nm and a noise level of 50, 100, 150, 200 to detect TAD boundaries using CASPIAN (Figure S4, S5, S6). The heatmaps under different conditions show that the Hi-C contact matrix at a lower noise level is sparser than the Hi-C contact matrix at a higher noise level, and the Hi-C contact matrix with higher linear density is sparser than the Hi-C contact matrix with lower linear density. Therefore, we think the Hi-C contact matrix with high linear density at a low noise level is similar to the real Hi-C contact matrix at high resolution, the Hi-C contact matrix with low linear density at a high noise level is similar to the real Hi-C contact matrix at low resolution. The number of TADs detected using CASPIAN with different distance metrics (Table S1) shows that the Euclidean metric performs more robust than Manhattan and Chebyshev metrics. Figure S4, S5 and S6 show that CASPIAN using the Euclidean metric performs better than using the Manhattan and Chebyshev metrics on detecting TAD boundaries under different simulation conditions. Therefore, we recommend users run CASPIAN using Euclidean metric in most conditions.</p>
      <p id="p0140">We next explored the distance metrics how to affect the TAD quality of TADs identified from the real Hi-C contact matrix of all chromosomes (from chromosome 1 to chromosome 22) in the GM12878 cell line at 50 kb resolution. By comparing the distribution of mean P-value of the CTCF, POLR2A, RAD21, SMC3, H3K4me3, H3K36me3, and H3K9me3 target ChIP-seq data near the locus of identified TAD boundaries ranging from −40 kb to  + 40 kb genomic distance. As <xref rid="f0020" ref-type="fig">Fig. 4</xref> shows, Near the boundaries of identified TADs by CASPIAN using the three distance metrics, CTCF, POLR2A, RAD21, SMC3, H3K4me3, and H3K36me3 factors are enriched, chromatin modifications H3K9me3 is unenriched. The results are consistent with the results that boundaries of TADs are enriched for the insulator binding protein CTCF and housekeeping genes as Dixon, et al. <xref rid="b0010" ref-type="bibr">[2]</xref> reported. This indicates that CASPIAN using all the three distance metrics could detect TAD boundaries correctly. However, from the aspect of factors enrichment at the TAD boundaries (the genomic distance from boundary  = 0), the Euclidean and Manhattan distance metrics perform better than the Chebyshev distance metric. We also compared the distributions at 25 kb (Figure S7) and 5 kb (Figure S15) resolution, and get a similar conclusion with the results at 50 kb resolution. We detected TADs from 5 kb resolution KR-normalized Hi-C contact matrix (chromosome 9, 11, 12, 13, 14, 15) in the GM12878 cell line by CASPIAN using the Euclidean distance metric. As Figure S15 shows, we plotted the mean P-value of CTCF target ChIP-seq surrounding the TAD boundaries within 400 kb genomic distance. The results show that TADs called from 5 kb resolution Hi-C contact matrix also show enrichment for factors related to promoting the gene expression (CTCF, H3K4me1, H3K4me3, RAD21, POLR2A, and SMC3). This means CASPIAN could also detect TADs accurately from Hi-C data at a high resolution (e.g., 5 kb).<fig id="f0020"><label>Fig. 4</label><caption><p>The plots of mean P-value calculated from different target factor ChIP-seq surrounding the genomic locus of identified TAD boundaries from −40 kb to  + 40 kb genomic distance. From left to right, represents the identified TADs results by using the Euclidean, Chebyshev, and Manhattan distance metrics, respectively. From top to bottom, represent the CTCF, H3K4me3, H3K36me3, POLR2A, SMC3, and H3K9me3 target factors ChIP-seq. The Hi-C contact matrices used in the plots are from all chromosomes (from chromosome 1 to chromosome 22) in the GM12878 cell line at 50 kb resolution.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0145">To assess the performance of CASPIAN using different distance metrics on different normalization datasets, as <xref rid="f0025" ref-type="fig">Fig. 5</xref> shows, we compared the number of detected TADs, the anchor ratio of factors including the CTCF, POLR2A, RAD21, SMC3, H3K4me3, H3K36me3, and H3K9me3 within 20 kb genomic distance. <xref rid="f0025" ref-type="fig">Fig. 5</xref>a shows that CASPIAN using the Manhattan distance metric detects more TADs than using the other two distance metrics for raw or VC-normalized Hi-C contact matrix, CASPIAN using the Chebyshev distance metric detects more TADs than using the other two distance metrics for KR-normalized Hi-C contact matrix. However, from the aspect of the anchor ratio of the CTCF factor, <xref rid="f0025" ref-type="fig">Fig. 5</xref>b shows that CASPIAN using the three distance metric have a similar anchor ratio (all close to 0.6) of CTCF for VC-normalized Hi-C contact matrix, CASPIAN using the Euclidean and Manhattan distance metric performs better than the Chebyshev distance metrics for the raw and KR-normalized Hi-C contact matrix. Hence, from the aspect of TADs count and CTCF anchor ratio, for the raw and VC-normalized Hi-C contact matrix, CASPIAN using the Manhattan distance metric performs better than the other two distance metrics. For the KR–normalized Hi-C contact matrix, the Chebyshev distance metric performs better.<fig id="f0025"><label>Fig. 5</label><caption><p>The comparison of TAD boundary detection results from raw, VC-normalized, and KR-normalized Hi-C contact matrix of all chromosomes (from chr1 to chr22) in GM12878 cell on 50 kb resolution using different methods using three different distance metrics. (a). Comparison of the number of identified TADs. (b - d). Comparison of the anchor ratio of CTCF, H3K36me3, and H3K9me3 within 20 kb genomic distance. Blue represents the results of CASPIAN using the Euclidean distance metric. Orange represents the results of CASPIAN using the Manhattan distance metric. Green represents the results of CASPIAN using the Chebyshev distance metric.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0150">We also performed the comparison anchor ratio of H3K36me3, H3K9mes (<xref rid="f0025" ref-type="fig">Fig. 5</xref>c, d), H3K4me1, H3K4me3, RAD21, POLR2A, and SMC3 (Figure S8). The results show that CASPIAN using the Manhattan distance metric could always anchor more factors related to promoting the gene expression (H3K4me1, H3K4me3, RAD21, POLR2A, and SMC3) for raw and KR-normalized Hi-C, CASPIAN using the Euclidean distance metric could always anchor more factors related to promoting the gene expression for VC-normalized Hi-C (<xref rid="f0025" ref-type="fig">Fig. 5</xref>c, Figure S8), CASPIAN using the Chebyshev distance metrics anchor more factors (H3K9me3) related to inhibiting the gene expression (<xref rid="f0025" ref-type="fig">Fig. 5</xref>d) for the three types of Hi-C contact matrices.</p>
    </sec>
    <sec id="s0080">
      <label>3.2</label>
      <title>Assessment of CASPIAN on Simulated Hi-C datasets</title>
      <p id="p0155">We next evaluated the performance of CASPIAN by comparing the results on simulated 40 kb resolution Hi-C data at 4, 8, 12, and 16 noise levels with other five methods: Insulation Score <xref rid="b0050" ref-type="bibr">[10]</xref>, TopDom <xref rid="b0070" ref-type="bibr">[14]</xref>, IC-Finder <xref rid="b0125" ref-type="bibr">[25]</xref>, HiCSeg <xref rid="b0075" ref-type="bibr">[15]</xref>, and ClusterTAD <xref rid="b0145" ref-type="bibr">[29]</xref>. We didn’t compare Directionality Index (DI) <xref rid="b0010" ref-type="bibr">[2]</xref> with CASPIAN on simulated Hi-C contact matrix due to the input Hi-C data format (.cool or.hic format) requirment of DI method. The true TADs and TADs identified by the six methods are outlined on the heatmap. The heatmaps at 4 noise level (<xref rid="f0010" ref-type="fig">Fig. 2</xref>) show that CASPIAN using the Euclidean distance metric is more similar to the true TADs than the other methods. The heatmaps at 8, 12, and 16 noise levels (Figure S1-S3) show that CASPIAN using the Euclidean or Manhattan distance metric, TopDom, Insulation score, HiCSeg, and IC-Finder are all similar to the true TADs.</p>
      <p id="p0160">When we compared the identified TAD boundaries with the simulated TAD boundaries from the aspect of cluster similarity, values of the RI and FMI metrics show that CASPIAN using the Euclidean distance metric had the highest cluster similarity compared with the true TADs when noise levels 4, the same RI and FMI values with TopDom when noise levels 8 and 12. Therefore, CASPIAN using the Euclidean distance metric performs better than the other existing methods in terms of cluster quality compared with the simulated TADs.</p>
    </sec>
    <sec id="s0085">
      <label>3.3</label>
      <title>Assessment of CASPIAN on Real Hi-C Datasets</title>
      <p id="p0165">To assess the performance of CASPIAN on real Hi-C datasets even further, we tested CASPIAN, Insulation Score <xref rid="b0050" ref-type="bibr">[10]</xref>, TopDom <xref rid="b0070" ref-type="bibr">[14]</xref>, IC-Finder <xref rid="b0125" ref-type="bibr">[25]</xref>, HiCSeg <xref rid="b0075" ref-type="bibr">[15]</xref>, Directionality Index (DI) <xref rid="b0010" ref-type="bibr">[2]</xref> ClusterTAD <xref rid="b0145" ref-type="bibr">[29]</xref> on the KR-normalized Hi-C contact matrics (from chromosome 1 to chromosome 22) of the GM12878 cell line at 50 kb resolution. We tested Directionality Index (DI) <xref rid="b0010" ref-type="bibr">[2]</xref> on the cool file of Hi-C data (from chromosome 1 to chromosome 22) of the GM12878 cell line at 50 kb resolution. The results of Insulation Score, TopDom, ClusterTAD, IC-Finder, and HiCSeg were calculated using the recommended parameters in their published code. The result of DI was calculated using the fanc directionality tool (https://vaquerizaslab.github.io/fanc/) and HMM_calls.m provided by PSYCHIC <xref rid="b0080" ref-type="bibr">[16]</xref>. The results of CASPIAN were generated by choosing the Euclidean, Manhattan, and Chebyshev distance metrics, respectively.</p>
      <p id="p0170">Firstly, we plotted the KR-normalized Hi-C contact heatmaps with detected TAD boundaries of chromosome 1 from bin 140 to bin 250 in the GM12878 cell line at 50 kb resolution. The plots (<xref rid="f0030" ref-type="fig">Fig. 6</xref>) show that CASPIAN using the Euclidean distance metric has a more accurate visualization performance than the other methods. By comparing the visualization performance of TADs identified by CASPIAN using different distance metrics, we found that CASPIAN using the Euclidean metric and Chebyshev distance metric is more likely to identify tiny TADs, CASPIAN using the Manhattan metric is more likely to identify TADs with big size. By overlapping these TADs identified by CASPIAN using the three distance metrics (the top three heatmaps of <xref rid="f0030" ref-type="fig">Fig. 6</xref>), we found some TADs identified by CASPIAN using the Chebyshev or Euclidean metric are sub-TADs of TADs identified by CASPIAN using the Manhattan metric. Therefore, we can also identify hierarchical TADs by combining the TAD results identified by CASPIAN using the three distance metrics.<fig id="f0030"><label>Fig. 6</label><caption><p>Heatmaps with detected TAD boundaries using different methods based on a real 50 kb resolution Hi-C contact matrix, where the identified TADs are outlined by black lines.</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0175">Secondly, we observed the distribution of the mean P-value of CTCF target ChIP-seq surrounding the TAD boundaries of TADs detected by the above methods. The results (<xref rid="f0035" ref-type="fig">Fig. 7</xref>) show that CASPIAN using the Manhattan distance metric gets the highest mean P-value (0.61), CASPIAN using the Euclidean distance metric gets a similar mean P-value with HiCSeg, TopDom, Insulation Score, and DI. This means that CASPIAN using the Manhattan distance metric could enrich more CTCF factors than other methods in the domains of the TAD boundaries. We also observed the distribution of the mean P-value of H3K4me3 (Figure S9), H3K36me3 (Figure S10), POLR2A (Figure S11), SMC3 (Figure S12), H3K9me3 (Figure S13), H3K4me3 (Figure S9). The results show that the TAD boundaries identified by CASPIAN are enriched with factors related to promoting the gene expression.<fig id="f0035"><label>Fig. 7</label><caption><p>The plots of mean P-value calculated from CTCF target ChIP-seq around the genomic locus of identified TAD boundaries of all chromosomes (from chr1 to chr22) in GM12878 cell on 50 kb resolution using different methods from −40 kb to  + 40 kb genomic distance. The plot of the Insulation Score is calculated from −400 kb to  + 400 kb.</p></caption><graphic xlink:href="gr7"/></fig></p>
      <p id="p0180">Thirdly, we compared CASPIAN with other methods on the number of TADs, the average length of TADs, and the anchor ratio of different factors. The TADs were detected from Hi-C data of all chromosomes (from chromosome 1 to chromosome 22) in the GM12878 cell line at 50 kb resolution. The results show that CASPIAN obtains about 2000–5000 TADs with TAD lengths ranging from 0.4 Mb to 2 Mb (<xref rid="f0040" ref-type="fig">Fig. 8</xref>a,b), where the average TAD size (0.4 Mb - 2 Mb) is reasonable as study <xref rid="b0180" ref-type="bibr">[36]</xref> showed. CASPIAN using the Euclidean distance metric identified about 3000 TADs with avergae TAD size of 0.81 MB. This result is similar to the TADs identified by DI method. As article <xref rid="b0155" ref-type="bibr">[31]</xref> described, the number and size of identified TADs are correlated with the resolution, sequencing depth of the Hi-C data and TAD callers. At 50 KB resolution, the average TAD size ranged from 215 kb to 1.2 Mb. Most tools identified more tiny TADs at a higher resolution. <xref rid="f0040" ref-type="fig">Fig. 8</xref>a,b show that CASPIAN using the Euclidean or Chebyshev distance metric tends to identify tiny TADs, while CASPIAN using the Chebyshev distance metric identified more tiny TADs (about 5000) than CASPIAN using the Euclidean metric (about 3000). CASPIAN using the Manhattan metric tends to identify TADs with a big size. Therefore, we can choose CASPIAN using the Chebyshev distance metric to identify more tiny TADs. These TAD callers including CASPIAN have a anchor ratio of CTCF about 0.6–0.7 (<xref rid="f0040" ref-type="fig">Fig. 8</xref>c), H3K36me3 0.2 (<xref rid="f0040" ref-type="fig">Fig. 8</xref>d), H3K4me1 0.4, H3K4me3 0.3, H3K9me3 0.1, POLR2A 0.3, RAD21 0.4–0.6 and SMC3 0.3–0.5 (Figure S14). Though CASPIAN doesn’t always anchor the highest ratio of the above factors, we could get an approximate anchoring ratio for various factors by observing the distribution of these anchor ratios provided by different TAD callers. These results further indicate that a large number of transcription factors related to gene transcription or histone modified ChIP-seq signals are enriched near the TADs boundary.<fig id="f0040"><label>Fig. 8</label><caption><p>The comparison of TAD boundary detection results of all chromosomes (from chr1 to chr22) in GM12878 cell at 50 kb resolution using different methods. (a). Comparison of the number of detected TADs. (b) Comparison of the average length of TADs. (c, d) Comparison of the anchor ratio of CTCF and H3K36me3 target factors.</p></caption><graphic xlink:href="gr8"/></fig></p>
      <p id="p0185">Fourthly, to examine the similarity between TADs called by CASPIAN and other methods, we calculated the RI and FMS values between the TADs called by different methods. As <xref rid="f0045" ref-type="fig">Fig. 9</xref> shows, we calculated the RI and FMS values between TADs separately called by CASPIAN using the Euclidean, Manhattan, and Chebyshev distance metric and TADs called by other existing methods. The comparison results among TADs separately called by CASPIAN using the Euclidean, Manhattan, and Chebyshev distance metrics show that CASPIAN using the Euclidean metric could always recall the TADs called by the other two metrics, with the highest RI and FMS values. The comparison results between TADs called by CASPIAN and other methods show that CASPIAN could always recall the TADs called by Insulation score and TopDom. Particularly, CASPIAN using the Manhattan distance metric has the highest RI value of 0.9 and the highest FMS value of 0.93 compared with the Insulation score, and CASPIAN using the Euclidean distance metric has the highest RI value of 0.72 and the highest FMS value of 0.83 compared with the Insulation score. By comparing the p values between RI (or FMS) calculated by CASPIAN and other methods, we found that the similarity (RI and FMS) between CASPIAN using the Euclidean metric and CASPIAN using the Manhattan metric is similar with the similarity between CASPIAN using the Euclidean metric and IS, the similarity (FMS) between CASPIAN using the Manhattan metric and TopDom (or clusterTAD, or DI), where p value = 1. The p values were calculated by the Mann–Whitney-Wilcoxon test two-sided with Bonferroni correction. Hence, we could get the conclusion that CASPIAN using the Manhattan distance metric can recall more TADs called by other methods compared with the other two distance metrics.<fig id="f0045"><label>Fig. 9</label><caption><p>The similarity between the TAD boundaries identified from CASPIAN and other methods. (a). The box plot describes the Rand Index (RI) between TAD boundaries identified from CASPIAN using the Euclidean distance metric and other methods. (b). The box plot describes the Fowlkes-Mallows score (FMS) between TAD boundaries identified from CASPIAN using the Euclidean distance metric and other methods. (c). The box plot describes the RI value between TAD boundaries identified from CASPIAN using the Manhattan distance metric and other methods. (d). The box plot describes the FMS value between TAD boundaries identified from CASPIAN using the Manhattan distance metric and other methods. (e). The box plot describes the RI value between TAD boundaries identified from CASPIAN using the Chebyshev distance metric and other methods. (f). The box plot describes the FMS value between TAD boundaries identified from CASPIAN using the Chebyshev distance metric and other methods. The p value statistics were calculated by the Mann–Whitney-Wilcoxon test two-sided with Bonferroni correction.</p></caption><graphic xlink:href="gr9"/></fig></p>
      <p id="p0190">Lastly, to verify the correctness of TAD boundaries, firstly, we identified the TAD boundaries by running CASPI-AN using different distance metrics from the Hi-C contact matrix of GM12878 cell line at 5 kb, 25 kb, and 50 kb resolution. Then, we downloaded the enhancer-promoter interactions (EPIs) dataset of the GM12878 cell line provided by https://github.com/wgmao/EPIANN/tree/master/GM12878, where the EPIs dataset is always used for training and verifying the accuracy of identifying EPIs. In this paper, we used the EPIs dataset of the GM12878 cell line to verify the correctness and function of TAD boundaries. For example, we plotted the Hi-C heatmap with TAD boundaries and CTCF, H3K27ac, H3K4me1, H3K4me3 ChIP-seq tracks of the area of chr11:34165000–34575000 in GM12878 cell, where GM12878—chr11:34264981–34267400 is enhancer domain, GM12878—chr11:34378274–34380867 is promoter domain, GM12878—chr11:34264981–34267400 and GM12878—chr11: 34378274–34380867 is labeled to be a pair of enhancer-promoter interaction (<xref rid="f0050" ref-type="fig">Fig. 10</xref>). We extracted the promoters and enhancers domains of GM12878 from the EPIs datasets, and analyzed the ratio of identified TADs anchoring promoters or enhancers (Table S3 and Table S4). By comparing the anchor ratio of promoters and enhancers, we found these TAD callers including our method (CASPIAN) obtained a <inline-formula><mml:math id="M48" altimg="si48.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">ratio</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values about 0.29, a <inline-formula><mml:math id="M49" altimg="si49.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">ratio</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values about 0.14. Table S2 and Table S3 futher validated that CASPIAN performed better than other TAD callers in anchoring enhancers and promoters.<fig id="f0050"><label>Fig. 10</label><caption><p>A plot of Hi-C heatmap with TAD boundaries and CTCF, H3K27ac, H3K4me1, H3K4me3 ChIP-seq track of the area of chr11:34165000–34575000 in GM12878 cell. TADs are identified from 5 kb resolution Hi-C contact matrix using CASPIAN- Euclidian.</p></caption><graphic xlink:href="gr10"/></fig></p>
    </sec>
  </sec>
  <sec id="s0090">
    <label>4</label>
    <title>Conclusion</title>
    <p id="p0195">In this study, we proposed a method named CASPIAN that includes three modules to detect TADs based on the spatial density cluster algorithm. Our CASPIAN method considers three different pairwise distance metrics (Euclidean, Manhattan, and Chebyshev distance metric) to cluster the bins in the Hi-C contact matrix generated by different Hi-C normalization methods. By assessing the CASPIAN methods on the simulated and real Hi-C data, we think the Euclidean distance metric is more suitable for simulated Hi-C data. <xref rid="f0025" ref-type="fig">Fig. 5</xref> and <xref rid="f0035" ref-type="fig">Fig. 7</xref> show that CASPIAN using the Euclidian/Manhattan distance metrics performs better than using the Chebyshev distance metric on the number of detecting TADs and ratio of anchoring CTCF, H3K36me3 from raw and VC-normalized Hi-C. Therefore, we recommend that we can choose CASPIAN using the Manhattan distance metric to detect more TADs with a higher anchoring ratio from raw Hi-C contact matrix without normalization steps, choose CASPIAN using Chebyshev distance metric from KR-normalized Hi-C contact matrix. We do not recommend using CASPIAN to detect TADs from VC-normalized Hi-C contact matrix. In this paper, we provide CASPIAN with three distance metrics to detect TADs at the same time. Therefore, we can also choose the best TAD results by screening from the quality file (number of TAD, anchor ratio of CTCF).</p>
    <p id="p0200">By observing the mean P-value of ChIP-seq and TAD boundaries’ anchor ratio of CTCF, POLR2A, RAD21, SMC3, H3K4me3, H3K36me3, and H3K9me3, we conclude that the boundaries of TAD could always anchor more factors related to promoting the gene expression (CTCF, H3K4me1, H3K4me3, RAD21, POLR2A, and SMC3). The comparison of TADs similarity between CASPIAN and other methods shows that CASPIAN could recall the TADs called by Insulation score and TopDom. By comparing the ratio of TAD boundaries anchoring enhancer and promoter elements, we found that 29% of TAD boundaries identifed by most TAD callers anchored enhancers, and 14% anchored promoters. CASPIAN performed better than other methods in anchoring enhancers and promoters.</p>
    <p id="p0205">With the development of bioinformatics research, many TAD callers are developed to identify TAD boudaries. We listed a table (Table S4) to compare these TAD callers on input, parameters, output and resolution that tools could support. Though CASPIAN has the advantages of identifying TADs from high-resolution Hi-C data, anchoring more enhancers and promoters than other TAD callers, few parameters, and providing the visualization of TADs. There still exist some limitations to its capabilities. The time to detect TADs on high-resolution (e.g., 5 kb) Hi-C data is quite long. Future work may include exploration into improving identification efficiency at high-resolution Hi-C data by investigating algorithms for parallel computing.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="p0215">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Van Berkum</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <volume>326</volume>
        <year>2009</year>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <volume>485</volume>
        <year>2012</year>
        <fpage>376</fpage>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Berlivet</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Paquette</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Dumouchel</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Langlais</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustering of tissue-specific sub-TADs accompanies the regulation of HoxA genes in developing limbs</article-title>
        <source>PLoS genetics</source>
        <volume>9</volume>
        <year>2013</year>
        <object-id pub-id-type="publisher-id">e1004018</object-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Girelli</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kallas</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GPSeq reveals the radial organization of chromatin in the cell nucleus</article-title>
        <source>Nat Biotechnol</source>
        <volume>38</volume>
        <year>2020</year>
        <fpage>1184</fpage>
        <lpage>1193</lpage>
        <pub-id pub-id-type="pmid">32451505</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Gorkin</surname>
            <given-names>D.U.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Chromatin domains: the unit of chromosome organization</article-title>
        <source>Molecular cell</source>
        <volume>62</volume>
        <year>2016</year>
        <fpage>668</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="pmid">27259200</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Lupiáñez</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Breaking TADs: how alterations of chromatin domains result in disease</article-title>
        <source>Trends in Genetics</source>
        <volume>32</volume>
        <year>2016</year>
        <fpage>225</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="pmid">26862051</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Wit</surname>
            <given-names>E.D.</given-names>
          </name>
        </person-group>
        <article-title>TADs as the caller calls them</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>432</volume>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Montefiori</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wuerffel</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Roqueiro</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extremely long-range chromatin loops link topological domains to facilitate a diverse antibody repertoire</article-title>
        <source>Cell reports</source>
        <volume>14</volume>
        <year>2016</year>
        <fpage>896</fpage>
        <lpage>906</lpage>
        <pub-id pub-id-type="pmid">26804913</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CTCF-mediated human 3D genome architecture reveals chromatin topology for transcription</article-title>
        <source>Cell</source>
        <volume>163</volume>
        <year>2015</year>
        <fpage>1611</fpage>
        <lpage>1627</lpage>
        <pub-id pub-id-type="pmid">26686651</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Crane</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Bian</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>R.P.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.R.</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>B.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Condensin-driven remodeling of X chromosome topology during dosage compensation</article-title>
        <source>Nature</source>
        <volume>523</volume>
        <year>2015</year>
        <fpage>240</fpage>
        <pub-id pub-id-type="pmid">26030525</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Anania</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Acemel</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>Jedamzick</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In vivo dissection of a clustered-CTCF domain boundary reveals developmental principles of regulatory insulation</article-title>
        <source>Nat Genet</source>
        <volume>54</volume>
        <year>2022</year>
        <fpage>1026</fpage>
        <lpage>1036</lpage>
        <pub-id pub-id-type="pmid">35817979</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Identifying topologically associating domains and subdomains by Gaussian Mixture model And Proportion test</article-title>
        <source>Nature communications</source>
        <volume>8</volume>
        <year>2017</year>
        <fpage>535</fpage>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>S.S.</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>E.K.</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>I.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <volume>159</volume>
        <year>2014</year>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Tjong</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopDom: an efficient and deterministic method for identifying topological domains in genomes</article-title>
        <source>Nucleic acids research</source>
        <volume>44</volume>
        <year>2015</year>
        <fpage>e70</fpage>
        <pub-id pub-id-type="pmid">26704975</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Lévy-Leduc</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mary-Huard</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional segmentation for analyzing Hi-C data</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <year>2014</year>
        <fpage>i386</fpage>
        <lpage>i392</lpage>
        <pub-id pub-id-type="pmid">25161224</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Ron</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Globerson</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Promoter-enhancer interactions identified from Hi-C data using probabilistic models and hierarchical topological domains. Nature</article-title>
        <source>Communications</source>
        <volume>8</volume>
        <issue>1</issue>
        <year>2017</year>
        <fpage>2237</fpage>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Weinreb</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>B.J.</given-names>
          </name>
        </person-group>
        <article-title>Identification of hierarchical chromatin domains</article-title>
        <source>Bioinformatics</source>
        <volume>32</volume>
        <year>2015</year>
        <fpage>1601</fpage>
        <lpage>1609</lpage>
        <pub-id pub-id-type="pmid">26315910</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Ron</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Globerson</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Promoter-enhancer interactions identified from Hi-C data using probabilistic models and hierarchical topological domains</article-title>
        <source>Nature Communications</source>
        <volume>8</volume>
        <year>2017</year>
        <fpage>2237</fpage>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M.Q.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>HiCDB: a sensitive and robust method for detecting contact domain boundaries</article-title>
        <source>Nucleic acids research</source>
        <volume>46</volume>
        <year>2018</year>
        <fpage>11239</fpage>
        <lpage>11250</lpage>
        <pub-id pub-id-type="pmid">30184171</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <mixed-citation publication-type="other" id="h0100">Abbas Roayaei Ardakany, S.L. in 17th International Workshop on Algorithms in Bioinformatics (WABI 2017) Vol. 88 (ed Russell Schwartz and Knut Reinert) (Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik, Dagstuhl, Germany, 2017).</mixed-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Lyu</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>TADBD: a sensitive and fast method for detection of typologically associated domain boundaries</article-title>
        <source>BioTechniques</source>
        <volume>69</volume>
        <year>2020</year>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Mourad</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>TADreg: a versatile regression framework for TAD identification, differential analysis and rearranged 3D genome prediction</article-title>
        <source>BMC bioinformatics</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">34983366</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M.Q.</given-names>
          </name>
        </person-group>
        <article-title>A novel method to identify topological domains using Hi-C data</article-title>
        <source>Quantitative Biology</source>
        <volume>3</volume>
        <year>2015</year>
        <fpage>81</fpage>
        <lpage>89</lpage>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hero</surname>
            <given-names>A.O.</given-names>
            <suffix>III</suffix>
          </name>
          <name>
            <surname>Rajapakse</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Spectral identification of topological domains</article-title>
        <source>Bioinformatics</source>
        <volume>32</volume>
        <year>2016</year>
        <fpage>2151</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="pmid">27153657</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Haddad</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Vaillant</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Jost</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>IC-Finder: inferring robustly the hierarchical organization of chromatin folding</article-title>
        <source>Nucleic acids research</source>
        <volume>45</volume>
        <year>2017</year>
        <fpage>e81</fpage>
        <pub-id pub-id-type="pmid">28130423</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Yan</surname>
            <given-names>K.-K.</given-names>
          </name>
          <name>
            <surname>Lou</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>MrTADFinder: A network modularity based approach to identify topologically associating domains in multiple resolutions</article-title>
        <source>PLoS computational biology</source>
        <volume>13</volume>
        <year>2017</year>
        <object-id pub-id-type="publisher-id">e1005647</object-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>H.K.</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>J.E.</given-names>
          </name>
        </person-group>
        <article-title>Detecting hierarchical genome folding with network modularity</article-title>
        <source>Nature Methods</source>
        <volume>15</volume>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Cresswell</surname>
            <given-names>K.G.</given-names>
          </name>
          <name>
            <surname>Stansfield</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Dozmorov</surname>
            <given-names>M.G.</given-names>
          </name>
        </person-group>
        <article-title>SpectralTAD: an R package for defining a hierarchy of topologically associated domains using spectral clustering</article-title>
        <source>Bmc Bioinformatics</source>
        <volume>21</volume>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03652-w</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Oluwadare</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>ClusterTAD: an unsupervised machine learning approach to detecting topologically associated domains of chromosomes from Hi-C data</article-title>
        <source>BMC bioinformatics</source>
        <volume>18</volume>
        <year>2017</year>
        <fpage>480</fpage>
        <pub-id pub-id-type="pmid">29137603</pub-id>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Soler-Vila</surname>
            <given-names>S.P.</given-names>
          </name>
          <name>
            <surname>Cuscó</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Farabella</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Di Stefano</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>Marc A.</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical chromatin organization detected by TADpole</article-title>
        <source>Nucleic Acids Research</source>
        <volume>48</volume>
        <year>2020</year>
        <fpage>e39</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa087</pub-id>
        <pub-id pub-id-type="pmid">32083658</pub-id>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Dali</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A critical assessment of topologically associating domain prediction tools</article-title>
        <source>Nucleic acids research</source>
        <volume>45</volume>
        <issue>6</issue>
        <year>2017</year>
        <fpage>2994</fpage>
        <lpage>3005</lpage>
        <pub-id pub-id-type="pmid">28334773</pub-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>Campello</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Moulavi</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Zimek</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical density estimates for data clustering, visualization, and outlier detection</article-title>
        <source>ACM Transactions on Knowledge Discovery from Data (TKDD)</source>
        <volume>10</volume>
        <year>2015</year>
        <fpage>1</fpage>
        <lpage>51</lpage>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Yaffe</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic modeling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>
        <source>Nature genetics</source>
        <volume>43</volume>
        <year>2011</year>
        <fpage>1059</fpage>
        <pub-id pub-id-type="pmid">22001755</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Knight</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Ruiz</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>A fast algorithm for matrix balancing</article-title>
        <source>IMA Journal of Numerical Analysis</source>
        <volume>33</volume>
        <year>2013</year>
        <fpage>1029</fpage>
        <lpage>1047</lpage>
      </element-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Bäcklund</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hedblom</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Neijman</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>A density-based spatial clustering of application with noise</article-title>
        <source>Data Mining TNM033</source>
        <year>2011</year>
        <fpage>11</fpage>
        <lpage>30</lpage>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Rocha</surname>
            <given-names>P.P.</given-names>
          </name>
          <name>
            <surname>Raviram</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bonneau</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Breaking TADs: insights into hierarchical genome organization[J]</article-title>
        <source>Epigenomics</source>
        <volume>7</volume>
        <issue>4</issue>
        <year>2015</year>
        <fpage>523</fpage>
        <lpage>526</lpage>
        <pub-id pub-id-type="pmid">26111025</pub-id>
      </element-citation>
    </ref>
    <ref id="b0185">
      <label>37</label>
      <element-citation publication-type="journal" id="h0185">
        <person-group person-group-type="author">
          <name>
            <surname>Prim</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <article-title>Shortest connection networks and some generalizations</article-title>
        <source>The Bell System Technical Journal</source>
        <volume>36</volume>
        <year>1957</year>
        <fpage>1389</fpage>
        <lpage>1401</lpage>
      </element-citation>
    </ref>
    <ref id="b0190">
      <label>38</label>
      <element-citation publication-type="journal" id="h0190">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>F.M.</given-names>
          </name>
          <name>
            <surname>Nicoletti</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Pal</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Livi</surname>
            <given-names>C.M.</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bicciato</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Comparison of computational methods for Hi-C data analysis</article-title>
        <source>Nature methods</source>
        <volume>14</volume>
        <year>2017</year>
        <fpage>679</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="pmid">28604721</pub-id>
      </element-citation>
    </ref>
    <ref id="b0195">
      <label>39</label>
      <element-citation publication-type="journal" id="h0195">
        <person-group person-group-type="author">
          <name>
            <surname>Trussart</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Serra</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Baù</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Junier</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Serrano</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>M.A.</given-names>
          </name>
        </person-group>
        <article-title>Assessing the limits of restraint-based 3D modeling of genomes and genomic domains</article-title>
        <source>Nucleic Acids Res</source>
        <volume>43</volume>
        <issue>7</issue>
        <year>2015</year>
        <fpage>3465</fpage>
        <lpage>3477</lpage>
        <pub-id pub-id-type="pmid">25800747</pub-id>
      </element-citation>
    </ref>
    <ref id="b0200">
      <label>40</label>
      <mixed-citation publication-type="other" id="h0200">Consortium, E.P. An integrated encyclopedia of DNA elements in the human genome. Nature 489, 57 (2012).</mixed-citation>
    </ref>
    <ref id="b0205">
      <label>41</label>
      <element-citation publication-type="journal" id="h0205">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: Machine learning in Python</article-title>
        <source>the Journal of machine Learning research</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0100" sec-type="supplementary-material">
    <title>Supplementary data</title>
    <p id="p0225">The following are the Supplementary data to this article:</p>
    <p id="p0230">
      <supplementary-material content-type="local-data" id="m0005">
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <fn-group>
    <fn id="d35e87">
      <label>☆</label>
      <p id="np005">This work has been supported by the National Key R&amp;D Program of China [2018YFB0704301, 2018YFB0704304, 2018YFA0801402], the Scientific and Technological Innovation Foundation of Shunde Graduate School, USTB [BK20BF009], the National Natural Science Foundation of China [31871343] and the CAMS Innovation Fund for Medical Sciences (2020-RC310-009). Funding for open access charge: Department of Computer Science and Technology, Advanced Innovation Center for Materials Genome Engineering, University of Science and Technology Beijing.</p>
    </fn>
    <fn id="s0095" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0220">Supplementary data associated with this article can be found, in the online version, at <ext-link ext-link-type="doi" xlink:href="10.1016/j.csbj.2022.08.059" id="ir005">https://doi.org/10.1016/j.csbj.2022.08.059</ext-link>.</p>
    </fn>
  </fn-group>
</back>
