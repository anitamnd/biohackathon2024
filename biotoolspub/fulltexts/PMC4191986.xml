<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4191986</article-id>
    <article-id pub-id-type="pmid">25299648</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-16407</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0108358</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics Statistics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Cancer Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancer Detection and Diagnosis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Probability Distribution</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Statistics (Mathematics)</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Statistical Inference</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Inferring Tree Causal Models of Cancer Progression with Probability Raising</article-title>
      <alt-title alt-title-type="running-head">Inferring Tree Causal Models of Cancer Progression</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Loohuis</surname>
          <given-names>Loes Olde</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Caravagna</surname>
          <given-names>Giulio</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Graudenzi</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ramazzotti</surname>
          <given-names>Daniele</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mauri</surname>
          <given-names>Giancarlo</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Antoniotti</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mishra</surname>
          <given-names>Bud</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Center for Neurobehavioral Genetics, University of California Los Angeles, Los Angeles, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Dipartimento di Informatica Sistemistica e Comunicazione, Università degli Studi, Milano-Bicocca, Milano, Italy</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Courant Institute of Mathematical Sciences, New York University, New York, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kaderali</surname>
          <given-names>Lars</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Technische Universität Dresden, Medical Faculty, Germany</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>l.oldeloohuis@gmail.com</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: LO GC AG DR GM MA BM. Performed the experiments: LO GC AG DR. Analyzed the data: LO GC AG DR. Wrote the paper: LO GC AG DR MA BM GM. Software implementation: DR.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>10</issue>
    <elocation-id>e108358</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>8</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Olde Loohuis et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Olde Loohuis et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Existing techniques to reconstruct tree models of progression for accumulative processes, such as cancer, seek to estimate causation by combining correlation and a frequentist notion of temporal priority. In this paper, we define a novel theoretical framework called CAPRESE (CAncer PRogression Extraction with Single Edges) to reconstruct such models based on the notion of probabilistic causation defined by Suppes. We consider a general reconstruction setting complicated by the presence of noise in the data due to biological variation, as well as experimental or measurement errors. To improve tolerance to noise we define and use a shrinkage-like estimator. We prove the correctness of our algorithm by showing asymptotic convergence to the correct tree under mild constraints on the level of noise. Moreover, on synthetic data, we show that our approach outperforms the state-of-the-art, that it is efficient even with a relatively small number of samples and that its performance quickly converges to its asymptote as the number of samples increases. For real cancer datasets obtained with different technologies, we highlight biologically significant differences in the progressions inferred with respect to other competing techniques and we also show how to validate conjectured biological relations with progression models.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by the National Science Foundation grants CCF-0836649 and CCF-0926166 and by Regione Lombardia (Italy) under the research projects RetroNet through the ASTIL [12-4-5148000-40]; U.A 053 and NEDD Project [ID14546A Rif SAL-7] Fondo Accordi Istituzionali 2009. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All data are included within the paper.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All data are included within the paper.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Cancer is a disease of evolution. Its initiation and progression are caused by dynamic somatic alterations to the genome manifested as point mutations, structural alterations, DNA methylation and histone modification changes <xref rid="pone.0108358-Hanahan1" ref-type="bibr">[1]</xref>.</p>
    <p>These genomic alterations are generated by random processes, and since individual tumor cells compete for space and resources, the fittest variants are naturally selected for. For example, if through some mutations a cell acquires the ability to ignore anti-growth signals from the body, this cell may thrive and divide, and its progeny may eventually dominate some part(s) of the tumor. This <italic>clonal expansion</italic> can be seen as a <italic>discrete state</italic> of the cancer's progression, marked by the acquisition of a set of genetic events. Cancer progression can then be thought of as a sequence of these discrete steps, where the tumor acquires certain distinct properties at each state. Different progression sequences are possible, but some are more common than others, and not every order is viable <xref rid="pone.0108358-Luo1" ref-type="bibr">[2]</xref>.</p>
    <p>In the last two decades, many specific genes and genetic mechanisms that are involved in different types of cancer have been identified (see e.g. <xref rid="pone.0108358-Vogelstein1" ref-type="bibr">[3]</xref>, <xref rid="pone.0108358-Frank1" ref-type="bibr">[4]</xref> for an overview of common cancer genes and <xref rid="pone.0108358-Bell1" ref-type="bibr">[5]</xref>, <xref rid="pone.0108358-Imielinski1" ref-type="bibr">[6]</xref> for specific genetic analyses of ovarian carcinoma and lung adenocarcinoma, respectively), and <italic>therapies</italic> targeting the activity of these genes are now being developed at a fast pace <xref rid="pone.0108358-Luo1" ref-type="bibr">[2]</xref>. However, unfortunately, the <italic>causal and temporal relations</italic> among the genetic events driving cancer progression remain largely elusive.</p>
    <p>The main reason for this state of affairs is that information revealed in the data is usually obtained only at one (or a few) points in time, rather than over the course of the disease. Extracting this dynamic information from the available <italic>cross-sectional</italic> data is challenging, and a combination of mathematical, statistical and computational techniques is needed. In recent years, several methods to extract progression models from cross-sectional data have been developed, starting from the seminal work on single-path-models by Fearon and Vogelstein <xref rid="pone.0108358-Vogelstein2" ref-type="bibr">[7]</xref>. In particular, different models of oncogenetic trees were developed over the years. At the core of some of these methods, e.g. <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>, <xref rid="pone.0108358-Desper2" ref-type="bibr">[9]</xref>, is the use of <italic>correlation</italic> to identify relations among genetic events. These techniques reconstruct <italic>tree</italic> models of progression as independent acyclic paths with branches and no confluences. Distinct models of oncogenetic trees are instead based on <italic>maximum likelihood estimation</italic>, e.g., <xref rid="pone.0108358-vonHeydebreck1" ref-type="bibr">[10]</xref>, <xref rid="pone.0108358-Beerenwinkel1" ref-type="bibr">[11]</xref>, <xref rid="pone.0108358-Beerenwinkel2" ref-type="bibr">[12]</xref>. More general <italic>Markov chain</italic> models, e.g., <xref rid="pone.0108358-Hjelm1" ref-type="bibr">[13]</xref>, describe more flexible probabilistic networks, despite the computationally expensive parameter estimation. Other recent models are Conjunctive Bayesian Networks, CBNs <xref rid="pone.0108358-Beerenwinkel3" ref-type="bibr">[14]</xref>, <xref rid="pone.0108358-Gerstung1" ref-type="bibr">[15]</xref>, that extract <italic>directed acyclic graphs</italic>, yet imposing specific constraints on the joint occurrence of events. Finally, in a slightly different context, temporal models were reconstructed from time-course gene expression data <xref rid="pone.0108358-Gupta1" ref-type="bibr">[16]</xref>, <xref rid="pone.0108358-Ramakrishnan1" ref-type="bibr">[17]</xref>.</p>
    <p>In this paper we present a novel theoretical framework called CAPRESE (CAncer PRogression Extraction with Single Edges) to reconstruct cumulative progressive phenomena, such as cancer progression. We assume the original problem setting of <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>, and propose a new a technique to infer <italic>probabilistic progression trees</italic> from cross-sectional data. Unlike maximum likelihood estimation-based techniques, our goal is the extraction of the <italic>minimal</italic> progression model explaining the order in which mutations occur and accumulate. The method is technology agnostic, i.e., it can be applied to dataset derived from all types of (epi-)genetic data such as deep exome sequencing, bisulfite sequencing, SNP arrays, etc., (see <xref ref-type="sec" rid="s3">Results</xref>), and takes as input a set of pre-selected genetic events of which the presence or the absence of each event is recorded for each sample.</p>
    <p>CAPRESE is based on two main ingredients: <inline-formula><inline-graphic xlink:href="pone.0108358.e001.jpg"/></inline-formula> rather than using <italic>correlation</italic> to infer progression structures, we base our technique on a notion of <italic>probabilistic causation</italic>, and <inline-formula><inline-graphic xlink:href="pone.0108358.e002.jpg"/></inline-formula>, to increase robustness against noise, we adopt a <italic>shrinkage-like estimator</italic> to measure causation among any pair of events. More specifically, with respect to our first ingredient, we adopt the notion of (prima facie) causation proposed by Suppes in <xref rid="pone.0108358-Suppes1" ref-type="bibr">[18]</xref>. Its basic intuition is simple: event <inline-formula><inline-graphic xlink:href="pone.0108358.e003.jpg"/></inline-formula> causes event <inline-formula><inline-graphic xlink:href="pone.0108358.e004.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="pone.0108358.e005.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="pone.0108358.e006.jpg"/></inline-formula> occurs <italic>before</italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e007.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e008.jpg"/></inline-formula> the occurrence of <inline-formula><inline-graphic xlink:href="pone.0108358.e009.jpg"/></inline-formula>
<italic>raises the probability</italic> of observing <inline-formula><inline-graphic xlink:href="pone.0108358.e010.jpg"/></inline-formula>. This is a very basic notion of probabilistic causation that in itself does not address many of the problems associated with it (such as asymmetry, common causes, and screening off <xref rid="pone.0108358-Hitchcock1" ref-type="bibr">[19]</xref>), and includes <italic>spurious</italic> as well as <italic>genuine</italic> causes. However, as it turns out, this basic notion combined with a filter for independent progressions starting from the same root, is an excellent tool to guide progression extraction from cross-sectional data – one that outperforms the commonly used correlation-based methods.</p>
    <p>Probabilistic causation was used in biomedical applications before (e.g., to find driver genes from CNV data in <xref rid="pone.0108358-Ionita1" ref-type="bibr">[20]</xref>, and to extract causes from biological time series data in <xref rid="pone.0108358-Kleinberg1" ref-type="bibr">[21]</xref>), but, to the best of our knowledge, never to infer <italic>progression models</italic> in the <italic>absence</italic> of direct temporal information.</p>
    <p>The extraction problem is complicated by the presence of both false positive and false negative observations (see <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref> for a discussion on this issue based on the reconstruction by <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>), such as the one provided by the intrinsic variability of biological processes (e.g., <italic>genetic heterogeneity</italic>) and <italic>experimental errors</italic>. This poses a problem, because while probability raising is a very precise tool, it, by itself, is not robust enough against noise. Conditional on the amount of noise, we will rely both on probabilistic causation and on a more robust (but less precise) correlation-based metric in an optimal way. To do this we introduce our second ingredient, a <italic>shrinkage-like estimator</italic> to measure causation among any pair of events. The intuition behind this estimator, which is closely related to a shrinkage estimator from <xref rid="pone.0108358-Efron1" ref-type="bibr">[23]</xref>, is to find the optimal balance between probability raising on the one hand and correlation on the other, depending on the amount of noise.</p>
    <p>We prove correctness of our algorithm by showing that with increasing sample sizes, the reconstructed tree asymptotically converges to the correct one (Theorem 3). Under mild constraints on the noise rates, this result holds for the reconstruction problem in the presence of uniform noise as well.</p>
    <p>We also study the performance of CAPRESE in more realistic settings with limited sample sizes. Using synthetic data, we show that under these conditions, our algorithm outperforms the state-of-the-art tree reconstruction algorithm of <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref> (see <xref ref-type="sec" rid="s3">Results</xref>). In particular, our shrinkage-like estimator provides, on average, an increased robustness to noise which ensures it to outperform oncotrees <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>. Performance is defined in terms of <italic>structural similarity</italic> between the reconstructed tree and the actual tree, rather than on their induced distribution as is done, e.g., in <xref rid="pone.0108358-Beerenwinkel1" ref-type="bibr">[11]</xref>. This metric is especially appropriate for the goal of reconstructing a progression model where data-likelihood fit is secondary to “calling” the possibly minimal set of causal relations.</p>
    <p>Also, we show that CAPRESE works well already with a relatively low number of samples and that its performance quickly converges to its asymptote as the number of samples increases. This outcome hints at the applicability of the algorithm with relatively small datasets without compromising its efficiency.</p>
    <p>We remark that further analyses on synthetic data suggests that CAPRESE outperforms a well known bayesian probabilistic graphical model as well (i.e., <italic>Conjunctive Bayesian Networks</italic>
<xref rid="pone.0108358-Beerenwinkel3" ref-type="bibr">[14]</xref>, <xref rid="pone.0108358-Gerstung1" ref-type="bibr">[15]</xref>), which was originally conceived for the reconstruction of more complex topologies, e.g. DAGs, but was proven effective in reconstructing tree topologies as well <xref rid="pone.0108358-Hainke1" ref-type="bibr">[24]</xref> (see <xref ref-type="sec" rid="s3">Results</xref>).</p>
    <p>Finally, we apply our technique to alterations assessed with both Comparative Genomic Hybridization and Next Generation Sequencing techniques (see <xref ref-type="sec" rid="s3">Results</xref>). In the former case, we show that the algorithm of <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref> and CAPRESE highlight biologically important differences in ovarian, gastrointestinal and oral cancer, but our inferences are statistically more significant. In the latter, we validate a recently discovered relation among two key genes involved in leukemia.</p>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>Methods</title>
    <sec id="s2a">
      <title>Problem setting</title>
      <p>The set-up of the reconstruction problem is as follows. Assuming that we have a set <inline-formula><inline-graphic xlink:href="pone.0108358.e011.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0108358.e012.jpg"/></inline-formula> mutations (<italic>events</italic>, in probabilistic terminology) and <inline-formula><inline-graphic xlink:href="pone.0108358.e013.jpg"/></inline-formula> samples, we represent a cross-sectional dataset as an <inline-formula><inline-graphic xlink:href="pone.0108358.e014.jpg"/></inline-formula> binary matrix in which an entry <inline-formula><inline-graphic xlink:href="pone.0108358.e015.jpg"/></inline-formula> if the mutation <inline-formula><inline-graphic xlink:href="pone.0108358.e016.jpg"/></inline-formula> was observed in sample <inline-formula><inline-graphic xlink:href="pone.0108358.e017.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0108358.e018.jpg"/></inline-formula> otherwise. The problem we solve in this paper is to extract a set of edges <inline-formula><inline-graphic xlink:href="pone.0108358.e019.jpg"/></inline-formula> yielding a progression <italic>tree</italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e020.jpg"/></inline-formula> from this matrix which, we remark, only implicitly provides information of progression timing. The root of <inline-formula><inline-graphic xlink:href="pone.0108358.e021.jpg"/></inline-formula> is modeled using a (special) event <inline-formula><inline-graphic xlink:href="pone.0108358.e022.jpg"/></inline-formula> such that <italic>heterogenous progression paths</italic> or <italic>forests</italic> can be reconstructed. More precisely, we aim at reconstructing a <italic>rooted tree</italic> that satisfies: <inline-formula><inline-graphic xlink:href="pone.0108358.e023.jpg"/></inline-formula> each node has at most one incoming edge, <inline-formula><inline-graphic xlink:href="pone.0108358.e024.jpg"/></inline-formula> the root has no incoming edges <inline-formula><inline-graphic xlink:href="pone.0108358.e025.jpg"/></inline-formula> there are no <italic>cycles</italic>.</p>
      <p>Each progression tree subsumes a distribution of observing a subset of the mutations in a cancer sample that can be formalized as follows:</p>
      <p><bold>Definition 1.</bold> (Tree-induced distribution) <italic>Let </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e026.jpg"/></inline-formula>
<italic> be a tree and </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e027.jpg"/></inline-formula>
<italic> a labeling function denoting the independent probability of each edge, </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e028.jpg"/></inline-formula>
<italic> generates a distribution where the probability of observing a sample with the set of alterations </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e029.jpg"/></inline-formula>
<italic> is</italic>
</p>
      <p>
        <disp-formula id="pone.0108358.e030">
          <graphic xlink:href="pone.0108358.e030.jpg" position="anchor" orientation="portrait"/>
          <label>(1)</label>
        </disp-formula>
        <italic>where all events in </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e031.jpg"/>
        </inline-formula>
        <italic> are assumed to be reachable from the root </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e032.jpg"/>
        </inline-formula>
        <italic>, and </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e033.jpg"/>
        </inline-formula>
        <italic> is the set of edges connecting the root to the events in </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e034.jpg"/>
        </inline-formula>
        <italic>.</italic>
      </p>
      <p>We would like to emphasize two properties related to the tree-induced distribution. First, the distribution subsumes that, given any oriented edge <inline-formula><inline-graphic xlink:href="pone.0108358.e035.jpg"/></inline-formula>, an observed sample contains alteration <inline-formula><inline-graphic xlink:href="pone.0108358.e036.jpg"/></inline-formula> with probability <inline-formula><inline-graphic xlink:href="pone.0108358.e037.jpg"/></inline-formula>, that is the probability of observing <inline-formula><inline-graphic xlink:href="pone.0108358.e038.jpg"/></inline-formula> after <inline-formula><inline-graphic xlink:href="pone.0108358.e039.jpg"/></inline-formula>. For this reason, if <inline-formula><inline-graphic xlink:href="pone.0108358.e040.jpg"/></inline-formula> causes <inline-formula><inline-graphic xlink:href="pone.0108358.e041.jpg"/></inline-formula>, the probability of observing <inline-formula><inline-graphic xlink:href="pone.0108358.e042.jpg"/></inline-formula> will be greater than the probability of observing <inline-formula><inline-graphic xlink:href="pone.0108358.e043.jpg"/></inline-formula> accordingly to the temporal priority principle which states that all causes must precede, in time, their effects <xref rid="pone.0108358-Reichenbach1" ref-type="bibr">[25]</xref>.</p>
      <p>Second, the input dataset is a set of samples generated, ideally, from an unknown distribution induced by an unknown tree or forest that we aim at reconstructing. However, in some cases, it could be that no tree exists whose induced distribution generates <italic>exactly</italic> those input data. When this happens, the set of observed samples slightly diverges from any tree-induced distribution. To model these situations a notion of <italic>noise</italic> can be introduced, which depends on the context in which data are gathered. Adding noise to the model complicates the reconstruction problem (see <xref ref-type="sec" rid="s3">Results</xref>).</p>
      <sec id="s2a1">
        <title>The <italic>oncotree</italic> approach</title>
        <p>In <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref> Desper <italic>et al.</italic> developed a method to extract progression trees, named <italic>“oncotrees”</italic>, from static CNV data. In <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref> Szabo <italic>et al.</italic> extended the setting of Desper's reconstruction problem to account for both <italic>false positives</italic> and <italic>negatives</italic> in the input data. In these oncotrees, nodes represent CNV events and edges correspond to possible progressions from one event to the next.</p>
        <p>The reconstruction problem is exactly as described above, and each tree is rooted in the special event <inline-formula><inline-graphic xlink:href="pone.0108358.e044.jpg"/></inline-formula>. The choice of which edge to include in a tree is based on the estimator<disp-formula id="pone.0108358.e045"><graphic xlink:href="pone.0108358.e045.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>which assigns to each edge <inline-formula><inline-graphic xlink:href="pone.0108358.e046.jpg"/></inline-formula> a weight accounting for both the relative and joint frequencies of the events – thus measuring <italic>correlation</italic>. The estimator is evaluated after including <inline-formula><inline-graphic xlink:href="pone.0108358.e047.jpg"/></inline-formula> to each sample of the dataset. In this definition the rightmost term is the (symmetric) <italic>likelihood ratio</italic> for <inline-formula><inline-graphic xlink:href="pone.0108358.e048.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e049.jpg"/></inline-formula> occurring together, while the leftmost is the asymmetric <italic>temporal priority</italic> measured by rate of occurrence. This implicit form of timing assumes that, if <inline-formula><inline-graphic xlink:href="pone.0108358.e050.jpg"/></inline-formula> occurs <italic>more often</italic> than <inline-formula><inline-graphic xlink:href="pone.0108358.e051.jpg"/></inline-formula>, then it likely occurs <italic>earlier</italic>, thus satisfying<disp-formula id="pone.0108358.e052"><graphic xlink:href="pone.0108358.e052.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>An oncotree is the rooted tree whose total weight (i.e., sum of all the weights of the edges) is maximized, and can be reconstructed in <inline-formula><inline-graphic xlink:href="pone.0108358.e053.jpg"/></inline-formula> steps using Edmond's algorithm <xref rid="pone.0108358-Edmonds1" ref-type="bibr">[26]</xref>. By construction, the resulting graph is a proper tree rooted in <inline-formula><inline-graphic xlink:href="pone.0108358.e054.jpg"/></inline-formula>: each event occurs only once, <italic>confluences</italic> are absent, i.e., any event is caused by at most one other event. This method has been used to derive progressions for various cancer datasets e.g., <xref rid="pone.0108358-Kainu1" ref-type="bibr">[27]</xref>, <xref rid="pone.0108358-Huang1" ref-type="bibr">[28]</xref>, <xref rid="pone.0108358-Radmacher1" ref-type="bibr">[29]</xref>), and even though several methods that extend this framework exists (e.g. <xref rid="pone.0108358-Desper2" ref-type="bibr">[9]</xref>, <xref rid="pone.0108358-Beerenwinkel1" ref-type="bibr">[11]</xref>, <xref rid="pone.0108358-Gerstung1" ref-type="bibr">[15]</xref>), to the best of our knowledge, it is currently the only method that aims to solve exactly the same problem as the one investigated in this paper and thus provide a benchmark to compare against.</p>
      </sec>
    </sec>
    <sec id="s2b">
      <title>A probabilistic approach to causation</title>
      <p>We briefly review the approach to probabilistic causation, on which our method is based. For an extensive discussion on this topic we refer to <xref rid="pone.0108358-Hitchcock1" ref-type="bibr">[19]</xref>.</p>
      <p>In his seminal work <xref rid="pone.0108358-Suppes1" ref-type="bibr">[18]</xref>, Suppes proposed the following notion.</p>
      <p><bold>Definition 2.</bold> (Probabilistic causation, <xref rid="pone.0108358-Suppes1" ref-type="bibr">[18]</xref>). <italic>For any two events </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e055.jpg"/></inline-formula>
<italic> and </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e056.jpg"/></inline-formula>
<italic>, occurring respectively at times </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e057.jpg"/></inline-formula>
<italic> and </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e058.jpg"/></inline-formula>
<italic>, under the mild assumptions that </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e059.jpg"/></inline-formula>
<italic>, the event </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e060.jpg"/></inline-formula>
<italic> is a prima facie cause of the event </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e061.jpg"/></inline-formula>
<italic> if it occurs before the effect and the cause raises the probability of the effect, i.e.,</italic>
<disp-formula id="pone.0108358.e062"><graphic xlink:href="pone.0108358.e062.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>
</p>
      <p>As discussed in <xref rid="pone.0108358-Hitchcock1" ref-type="bibr">[19]</xref> the above conditions are not, in general, sufficient to claim that event <inline-formula><inline-graphic xlink:href="pone.0108358.e063.jpg"/></inline-formula> is a cause of event <inline-formula><inline-graphic xlink:href="pone.0108358.e064.jpg"/></inline-formula>. In fact a prima facie cause is either <italic>genuine</italic> or <italic>spurious</italic>. In the latter case, the fact that the conditions hold in the observations is due either to coincidence or to the presence of a certain third <italic>confounding factor</italic>, related both to <inline-formula><inline-graphic xlink:href="pone.0108358.e065.jpg"/></inline-formula> and to <inline-formula><inline-graphic xlink:href="pone.0108358.e066.jpg"/></inline-formula>
<xref rid="pone.0108358-Suppes1" ref-type="bibr">[18]</xref>. Genuine causes, instead, satisfy Definition 2 and are not screened-off by any confounding factor. However, they need not be direct causes. See <xref ref-type="fig" rid="pone-0108358-g001">Figure 1</xref>.</p>
      <fig id="pone-0108358-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Prima facie topology.</title>
          <p>Example prima facie topology where all edges <inline-formula><inline-graphic xlink:href="pone.0108358.e067.jpg"/></inline-formula> represent prima facie causes, according to Definition 3: <inline-formula><inline-graphic xlink:href="pone.0108358.e068.jpg"/></inline-formula> is a probability raiser of <inline-formula><inline-graphic xlink:href="pone.0108358.e069.jpg"/></inline-formula> and it occurs more frequently. In left, we filter out spurious causes and select only the real ones among the genuine, yielding a single-cause prima facie topology.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g001"/>
      </fig>
      <p>Note that we consider cross-sectional data where no information about <inline-formula><inline-graphic xlink:href="pone.0108358.e070.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e071.jpg"/></inline-formula> is available, so in our reconstruction setting we are restricted to consider solely the <italic>probability raising</italic> (PR) property, i.e., <inline-formula><inline-graphic xlink:href="pone.0108358.e072.jpg"/></inline-formula>, which makes it harder to discriminate among genuine and spurious causes. Now we review some of its properties.</p>
      <p><bold>Proposition 1.</bold> (Dependency). <italic>Whenever the</italic> PR <italic>holds between two events </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e073.jpg"/></inline-formula>
<italic> and </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e074.jpg"/></inline-formula>
<italic>, then the events are</italic> statistically dependent <italic>in a positive sense, i.e.,</italic>
<disp-formula id="pone.0108358.e075"><graphic xlink:href="pone.0108358.e075.jpg" position="anchor" orientation="portrait"/><label>(4)</label></disp-formula>
</p>
      <p>This and the next proposition are well-known facts of the PR; their derivation as well as the proofs of all the results we present is in the <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref>. Notice that the opposite implication holds as well: when the events <inline-formula><inline-graphic xlink:href="pone.0108358.e076.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e077.jpg"/></inline-formula> are still dependent but in a negative sense, i.e., <inline-formula><inline-graphic xlink:href="pone.0108358.e078.jpg"/></inline-formula>, the PR does not hold, i.e., <inline-formula><inline-graphic xlink:href="pone.0108358.e079.jpg"/></inline-formula>.</p>
      <p>We would like to use the asymmetry of the PR to determine whether a pair of events <inline-formula><inline-graphic xlink:href="pone.0108358.e080.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e081.jpg"/></inline-formula> satisfy a causation relation so to place <inline-formula><inline-graphic xlink:href="pone.0108358.e082.jpg"/></inline-formula> before <inline-formula><inline-graphic xlink:href="pone.0108358.e083.jpg"/></inline-formula> in the progression tree but, unfortunately, the PR satisfies the following property.</p>
      <p><bold>Proposition 2.</bold> (Mutual PR). <inline-formula><inline-graphic xlink:href="pone.0108358.e084.jpg"/></inline-formula>.</p>
      <p>That is, if <inline-formula><inline-graphic xlink:href="pone.0108358.e085.jpg"/></inline-formula> raises the probability of observing <inline-formula><inline-graphic xlink:href="pone.0108358.e086.jpg"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="pone.0108358.e087.jpg"/></inline-formula> raises the probability of observing <inline-formula><inline-graphic xlink:href="pone.0108358.e088.jpg"/></inline-formula> too.</p>
      <p>Nevertheless, in order to determine causes and effects among the genetic events, we can use our <italic>degree of confidence</italic> in our estimate of probability raising to decide the direction of the causation relationship between pairs of events. In other words, if <inline-formula><inline-graphic xlink:href="pone.0108358.e089.jpg"/></inline-formula> raises the probability of <inline-formula><inline-graphic xlink:href="pone.0108358.e090.jpg"/></inline-formula>
<italic>more</italic> than the other way around, then <inline-formula><inline-graphic xlink:href="pone.0108358.e091.jpg"/></inline-formula> is a more likely cause of <inline-formula><inline-graphic xlink:href="pone.0108358.e092.jpg"/></inline-formula> than <inline-formula><inline-graphic xlink:href="pone.0108358.e093.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0108358.e094.jpg"/></inline-formula>. Notice that this is sound as long as each event has <italic>at most</italic> one cause; otherwise, <italic>frequent late events</italic> with more than one cause, which are rather common in biological progressive phenomena, should be treated differently. As mentioned, the PR is not symmetric, and the <italic>direction</italic> of probability raising depends on the relative frequencies of the events. We make this asymmetry precise in the following proposition.</p>
      <p><bold>Proposition 3.</bold> (Probability raising and temporal priority). <italic>For any two events </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e095.jpg"/></inline-formula>
<italic> and </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e096.jpg"/></inline-formula>
<italic> such that the probability raising </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e097.jpg"/></inline-formula>
<italic> holds, we have</italic>
<disp-formula id="pone.0108358.e098"><graphic xlink:href="pone.0108358.e098.jpg" position="anchor" orientation="portrait"/><label>(5)</label></disp-formula>
</p>
      <p>That is, given that the PR holds between two events, <inline-formula><inline-graphic xlink:href="pone.0108358.e099.jpg"/></inline-formula> raises the probability of <inline-formula><inline-graphic xlink:href="pone.0108358.e100.jpg"/></inline-formula>
<italic>more</italic> than <inline-formula><inline-graphic xlink:href="pone.0108358.e101.jpg"/></inline-formula> raises the probability of <inline-formula><inline-graphic xlink:href="pone.0108358.e102.jpg"/></inline-formula>, if and only if <inline-formula><inline-graphic xlink:href="pone.0108358.e103.jpg"/></inline-formula> is observed more frequently than <inline-formula><inline-graphic xlink:href="pone.0108358.e104.jpg"/></inline-formula>. Notice that we use the ratio to assess the PR inequality. The proof of this proposition is technical and can be found in the <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref>. From this result it follows that if we measure the timing of an event by the rate of its occurrence (that is, <inline-formula><inline-graphic xlink:href="pone.0108358.e105.jpg"/></inline-formula> implies that <inline-formula><inline-graphic xlink:href="pone.0108358.e106.jpg"/></inline-formula> happens before <inline-formula><inline-graphic xlink:href="pone.0108358.e107.jpg"/></inline-formula>), this notion of PR subsumes the same notion of temporal priority induced by a tree. We also remark that this is also the temporal priority made explicit in the coefficients of Desper's method. Given these results, we define the following notion of causation.</p>
      <p>
        <bold>Definition 3.</bold>
        <italic>We state that </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e108.jpg"/>
        </inline-formula>
        <italic> is a prima facie cause of </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e109.jpg"/>
        </inline-formula>
        <italic> if </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e110.jpg"/>
        </inline-formula>
        <italic> is a probability raiser of </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e111.jpg"/>
        </inline-formula>
        <italic>, and it occurs more frequently:</italic>
      </p>
      <p>
        <disp-formula id="pone.0108358.e112">
          <graphic xlink:href="pone.0108358.e112.jpg" position="anchor" orientation="portrait"/>
        </disp-formula>
      </p>
      <p>We term <italic>prima facie topology</italic> a directed acyclic graph (over some events) where each edge represents a prima facie cause. When at most a single incoming edge is assigned to each event (i.e., an event has at most a <italic>unique cause</italic>, in the real world), we term this structure <italic>single-cause prima facie topology</italic>. Intuitively, this last class of topologies correspond to the trees or, more generally forests when they have disconnected components, that we aim at reconstructing.</p>
      <p>Before moving on to introducing our algorithm let us discuss our definition of <italic>causation</italic>, its role in the definition of the reconstruction problem and some of its limitations. As already mentioned, it may be that for some prima facie cause <inline-formula><inline-graphic xlink:href="pone.0108358.e113.jpg"/></inline-formula> of an event <inline-formula><inline-graphic xlink:href="pone.0108358.e114.jpg"/></inline-formula>, there is a third event <inline-formula><inline-graphic xlink:href="pone.0108358.e115.jpg"/></inline-formula> prior to both, such that <inline-formula><inline-graphic xlink:href="pone.0108358.e116.jpg"/></inline-formula> causes <inline-formula><inline-graphic xlink:href="pone.0108358.e117.jpg"/></inline-formula> and ultimately <inline-formula><inline-graphic xlink:href="pone.0108358.e118.jpg"/></inline-formula> causes <inline-formula><inline-graphic xlink:href="pone.0108358.e119.jpg"/></inline-formula>. Alternatively, <inline-formula><inline-graphic xlink:href="pone.0108358.e120.jpg"/></inline-formula> may cause both <inline-formula><inline-graphic xlink:href="pone.0108358.e121.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e122.jpg"/></inline-formula> independently, and the causation relationship observed from <inline-formula><inline-graphic xlink:href="pone.0108358.e123.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0108358.e124.jpg"/></inline-formula> is merely <italic>spurious</italic>. In the context of the tree-reconstruction problem, namely when it is assumed that each event has at most a unique cause, the aim is to filter out the spurious edges from a general prima facie topology, so to extract a single-cause prima facie structure (see <xref ref-type="fig" rid="pone-0108358-g001">Figure 1</xref>).</p>
      <p>Definition 3 summarizes Suppes basic notion of prima facie cause, while it is ignoring deeper discussions of causation that aim at distinguishing between actual genuine and spurious causes, e.g. screening-off, background context, d-separation <xref rid="pone.0108358-Cartwright1" ref-type="bibr">[30]</xref>, <xref rid="pone.0108358-Pearl1" ref-type="bibr">[31]</xref>, <xref rid="pone.0108358-Hitchcock1" ref-type="bibr">[19]</xref>. For our purposes however, the above definition is sufficient when <inline-formula><inline-graphic xlink:href="pone.0108358.e125.jpg"/></inline-formula> all the significant events are considered, i.e., all the genuine causes are observed as in a closed-world assumption, and <inline-formula><inline-graphic xlink:href="pone.0108358.e126.jpg"/></inline-formula> we aim at extracting the <italic>order</italic> of progression among them (or determine that there is no apparent relation), rather than extracting causalities <italic>per se</italic>. Note that these assumptions are strong and might be weakened in the future (see <xref ref-type="sec" rid="s4">Discussions</xref>), but are shared by us and <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>.</p>
      <p>Finally, we recall a few algebraic requirements necessary for our framework to be well-defined. First of all, the PR must be computable: every mutation <inline-formula><inline-graphic xlink:href="pone.0108358.e127.jpg"/></inline-formula> should be observed with probability strictly <inline-formula><inline-graphic xlink:href="pone.0108358.e128.jpg"/></inline-formula>. Moreover, we need each pair of mutations <inline-formula><inline-graphic xlink:href="pone.0108358.e129.jpg"/></inline-formula> to be <italic>distinguishable</italic> in terms of PR, that is, for each pair of mutations <inline-formula><inline-graphic xlink:href="pone.0108358.e130.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e131.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e132.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0108358.e133.jpg"/></inline-formula> similarly to the above condition. Any non-distinguishable pair of events can be merged as a single composite event. From now on, we will assume these conditions to be verified.</p>
    </sec>
    <sec id="s2c">
      <title>Performance measure and synthetic datasets</title>
      <p>We made use of <italic>synthetic data</italic> to evaluate the performance of CAPRESE as a function of dataset size and the false positive and negative rates. Many distinct synthetic datasets were created for this purpose, as explained below. The algorithm's performance was measured in terms of <italic>Tree Edit Distance</italic> (TED, <xref rid="pone.0108358-Zhang1" ref-type="bibr">[32]</xref>), i.e., the minimum-cost sequence of node edit operations (relabeling, deletion and insertion) that transforms the reconstructed trees into the ones generating the data. The choice of this measure of evaluation is motivated by the fact that we are interested in the <italic>structure</italic> behind the progressive phenomenon of cancer evolution and, in particular, we are interested in a measure of the genuine causes that we miss and of the spurious causes that we fail to recognize (and eliminate). Also, since topologies with similar distributions can be structurally different we choose to measure performance using structural distance rather than a distance in terms of distributions. Within the realm of ‘structural metrics' however, we have also evaluated the performance with the <italic>Hamming Distance</italic>
<xref rid="pone.0108358-Hamming1" ref-type="bibr">[33]</xref>, another commonly used structural metric, and we obtained analogous results (not shown here).</p>
      <sec id="s2c1">
        <title>Synthetic data generation and experimental setting</title>
        <p>Synthetic datasets were generated by sampling from various random trees constrained to have depth <inline-formula><inline-graphic xlink:href="pone.0108358.e134.jpg"/></inline-formula>, since wide branches are harder to reconstruct than straight paths, and by sampling event probabilities in <inline-formula><inline-graphic xlink:href="pone.0108358.e135.jpg"/></inline-formula> (see <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref>).</p>
        <p>Unless explicitly specified, in all the experiments we used <inline-formula><inline-graphic xlink:href="pone.0108358.e136.jpg"/></inline-formula> distinct random trees (or forests, accordingly to the test to perform) of <inline-formula><inline-graphic xlink:href="pone.0108358.e137.jpg"/></inline-formula> events each. This seems a fairly reasonable number of events and is in line with the usual size of reconstructed trees, e.g. <xref rid="pone.0108358-Samuelson1" ref-type="bibr">[34]</xref>, <xref rid="pone.0108358-Gunawan1" ref-type="bibr">[35]</xref>, <xref rid="pone.0108358-Longerich1" ref-type="bibr">[36]</xref>, <xref rid="pone.0108358-Pathare1" ref-type="bibr">[37]</xref>. The <italic>scalability</italic> of the techniques was tested against the number of samples by ranging <inline-formula><inline-graphic xlink:href="pone.0108358.e138.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0108358.e139.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0108358.e140.jpg"/></inline-formula>, with a step of <inline-formula><inline-graphic xlink:href="pone.0108358.e141.jpg"/></inline-formula>, and by replicating <inline-formula><inline-graphic xlink:href="pone.0108358.e142.jpg"/></inline-formula> independent datasets for each parameters setting (see the caption of the figures for details).</p>
        <p>We included a form of <italic>noise</italic> in generating the datasets, in order to account for <inline-formula><inline-graphic xlink:href="pone.0108358.e143.jpg"/></inline-formula> the realistic presence of <italic>biological noise</italic> (such as the one provided by bystander mutations, genetic heterogeneity, etc.) and <inline-formula><inline-graphic xlink:href="pone.0108358.e144.jpg"/></inline-formula>
<italic>experimental errors</italic>. A noise parameter <inline-formula><inline-graphic xlink:href="pone.0108358.e145.jpg"/></inline-formula> denotes the probability that any event assumes a random value (with uniform probability), after sampling from the tree-induced distribution. Algorithmically this process generates, on average, <inline-formula><inline-graphic xlink:href="pone.0108358.e146.jpg"/></inline-formula> random entries in each sample (e.g. with <inline-formula><inline-graphic xlink:href="pone.0108358.e147.jpg"/></inline-formula> we have, on average, one error per sample). We wish to assess whether these noisy samples can mislead the reconstruction process, even for low values of <inline-formula><inline-graphic xlink:href="pone.0108358.e148.jpg"/></inline-formula>. Notice that assuming a uniformly distributed noise may appear simplistic since some events may be more robust, or easy to measure, than others. However, introducing in the data both <italic>false positives</italic> (at rate <inline-formula><inline-graphic xlink:href="pone.0108358.e149.jpg"/></inline-formula>) and <italic>negatives</italic> (at rate <inline-formula><inline-graphic xlink:href="pone.0108358.e150.jpg"/></inline-formula>) makes the inference problem substantially harder, and was first investigated in <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref>.</p>
        <p>In the <xref ref-type="sec" rid="s3">Results</xref> section, we refer to datasets generated with rate <inline-formula><inline-graphic xlink:href="pone.0108358.e151.jpg"/></inline-formula> as noisy synthetic dataset. In the numerical experiments, <inline-formula><inline-graphic xlink:href="pone.0108358.e152.jpg"/></inline-formula> is usually discretized by <inline-formula><inline-graphic xlink:href="pone.0108358.e153.jpg"/></inline-formula>, (i.e., <inline-formula><inline-graphic xlink:href="pone.0108358.e154.jpg"/></inline-formula> noise).</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <sec id="s3a">
      <title>Extracting progression trees with probability raising and a shrinkage-like estimator</title>
      <p>The CAPRESE reconstruction method is described in Algorithm 1. The algorithm is similar to Desper's and Szabo's algorithm, the main difference being an alternative weight function based on a shrinkage-like estimator.</p>
      <p><bold>Algorithm 1.</bold> CAPRESE: a tree-like reconstruction with a shrinkage-like estimator.</p>
      <list list-type="simple">
        <list-item>
          <p>1: consider a set of <inline-formula><inline-graphic xlink:href="pone.0108358.e155.jpg"/></inline-formula> genetic events <inline-formula><inline-graphic xlink:href="pone.0108358.e156.jpg"/></inline-formula> plus a special event <inline-formula><inline-graphic xlink:href="pone.0108358.e157.jpg"/></inline-formula>, added to each sample of the dataset;</p>
        </list-item>
        <list-item>
          <p>2: define a <inline-formula><inline-graphic xlink:href="pone.0108358.e158.jpg"/></inline-formula> matrix <inline-formula><inline-graphic xlink:href="pone.0108358.e159.jpg"/></inline-formula> where each entry contains the shrinkage-like estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e160.jpg"/></inline-formula> according to the observed probability of the events <inline-formula><inline-graphic xlink:href="pone.0108358.e161.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e162.jpg"/></inline-formula>;</p>
        </list-item>
        <list-item>
          <p>3: [PR causation] define a tree <inline-formula><inline-graphic xlink:href="pone.0108358.e163.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0108358.e164.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0108358.e165.jpg"/></inline-formula> if and only if: <inline-formula><inline-graphic xlink:href="pone.0108358.e166.jpg"/></inline-formula>
</p>
        </list-item>
        <list-item>
          <p>4: [Independent progressions filter] define <inline-formula><inline-graphic xlink:href="pone.0108358.e167.jpg"/></inline-formula>, replace edge <inline-formula><inline-graphic xlink:href="pone.0108358.e168.jpg"/></inline-formula> with edge <inline-formula><inline-graphic xlink:href="pone.0108358.e169.jpg"/></inline-formula> if, for all <inline-formula><inline-graphic xlink:href="pone.0108358.e170.jpg"/></inline-formula>, it holds <inline-formula><inline-graphic xlink:href="pone.0108358.e171.jpg"/></inline-formula>
</p>
        </list-item>
      </list>
      <p><bold>Definition 4.</bold> (Shrinkage-like estimator). <italic>We define</italic> the shrinkage-like estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e172.jpg"/></inline-formula>
<italic>of the confidence in the causation relationship from </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e173.jpg"/></inline-formula>
<italic> to </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e174.jpg"/></inline-formula>
<italic> as</italic>
<disp-formula id="pone.0108358.e175"><graphic xlink:href="pone.0108358.e175.jpg" position="anchor" orientation="portrait"/><label>(6)</label></disp-formula>
</p>
      <p>
        <italic>where</italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0108358.e176.jpg"/>
        </inline-formula>
        <italic>and</italic>
        <disp-formula id="pone.0108358.e177">
          <graphic xlink:href="pone.0108358.e177.jpg" position="anchor" orientation="portrait"/>
          <label>(7)</label>
        </disp-formula>
      </p>
      <p>This estimator is similar in spirit to a shrinkage estimator (see <xref rid="pone.0108358-Efron1" ref-type="bibr">[23]</xref>) and combines a normalized version of PR, the <italic>raw estimate</italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e178.jpg"/></inline-formula>, with a <italic>correction factor</italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e179.jpg"/></inline-formula> (in our case a correlation-based measure of temporal distance among events), to define a proper order in the confidence of each causation relationship. Our <inline-formula><inline-graphic xlink:href="pone.0108358.e180.jpg"/></inline-formula> is the analogous of the <italic>shrinkage coefficient</italic> and can have a Bayesian interpretation based on the strength of our belief that <inline-formula><inline-graphic xlink:href="pone.0108358.e181.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e182.jpg"/></inline-formula> are causally relevant to one another and the evidence that <inline-formula><inline-graphic xlink:href="pone.0108358.e183.jpg"/></inline-formula> raises the probability of <inline-formula><inline-graphic xlink:href="pone.0108358.e184.jpg"/></inline-formula>. In the absence of a closed form solution for the optimal value of <inline-formula><inline-graphic xlink:href="pone.0108358.e185.jpg"/></inline-formula>, one may rely on cross-validation of simulated data. The power of shrinkage (and our shrinkage-like estimator) lies in the possibility of determining an optimal value for <inline-formula><inline-graphic xlink:href="pone.0108358.e186.jpg"/></inline-formula> to balance the effect of the correction factor on the raw model estimate to ensure optimal performances on ill posed instances of the inference problem. A crucial difference, however, between our estimator and classical shrinkage, is that our estimator aims at improving the performance of the <italic>overall</italic> reconstruction process, not limited to the performance of the estimator itself as is the case in shrinkage. That is, the metric <inline-formula><inline-graphic xlink:href="pone.0108358.e187.jpg"/></inline-formula> induces an ordering to the events reflecting our confidence for their causation. Furthermore, since we make no assumption about the underlying distribution, we learn it empirically by cross-validation. In the next sections we show that the shrinkage-like estimator is an effective way to get such an ordering especially when data are noisy. In CAPRESE we use a pairwise matrix version of the estimator.</p>
      <sec id="s3a1">
        <title>The raw estimator and the correction factor</title>
        <p>By considering only the raw estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e188.jpg"/></inline-formula>, we would include an edge <inline-formula><inline-graphic xlink:href="pone.0108358.e189.jpg"/></inline-formula> in the tree consistently in terms of <inline-formula><inline-graphic xlink:href="pone.0108358.e190.jpg"/></inline-formula> Definition 3 (<xref ref-type="sec" rid="s2">Methods</xref>) and <inline-formula><inline-graphic xlink:href="pone.0108358.e191.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="pone.0108358.e192.jpg"/></inline-formula> is the best probability raiser for <inline-formula><inline-graphic xlink:href="pone.0108358.e193.jpg"/></inline-formula>. When <inline-formula><inline-graphic xlink:href="pone.0108358.e194.jpg"/></inline-formula> the events <inline-formula><inline-graphic xlink:href="pone.0108358.e195.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e196.jpg"/></inline-formula> are indistinguishable in terms of temporal priority, thus <inline-formula><inline-graphic xlink:href="pone.0108358.e197.jpg"/></inline-formula> is not sufficient to decide their causal relation, if any. This intrinsic ambiguity is unlikely in practice even if, in principle, it is possible. Notice that this formulation of <inline-formula><inline-graphic xlink:href="pone.0108358.e198.jpg"/></inline-formula> is a monotonic normalized version of the PR ratio.</p>
        <p><bold>Proposition 4.</bold> (Monotonic normalization). <italic>For any two events </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e199.jpg"/></inline-formula>
<italic> and </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e200.jpg"/></inline-formula>
<italic> we have</italic>
<disp-formula id="pone.0108358.e201"><graphic xlink:href="pone.0108358.e201.jpg" position="anchor" orientation="portrait"/><label>(8)</label></disp-formula>
</p>
        <p>This raw model estimator satisfies <inline-formula><inline-graphic xlink:href="pone.0108358.e202.jpg"/></inline-formula>: when it tends to <inline-formula><inline-graphic xlink:href="pone.0108358.e203.jpg"/></inline-formula> the pair of events appear disjointly (i.e., they show an anti- causation pattern), when it tends to <inline-formula><inline-graphic xlink:href="pone.0108358.e204.jpg"/></inline-formula> no causation or anti- causation can be inferred and the two events are statistically independent and, when it tends to <inline-formula><inline-graphic xlink:href="pone.0108358.e205.jpg"/></inline-formula>, the causation relationship between the two events is genuine. Therefore, <inline-formula><inline-graphic xlink:href="pone.0108358.e206.jpg"/></inline-formula> provides a quantification of the degree of confidence for a PR causation relationship. In fact, for any given possible causation edge <inline-formula><inline-graphic xlink:href="pone.0108358.e207.jpg"/></inline-formula>, the term <inline-formula><inline-graphic xlink:href="pone.0108358.e208.jpg"/></inline-formula> gives an estimate of the <italic>error rate</italic> of <inline-formula><inline-graphic xlink:href="pone.0108358.e209.jpg"/></inline-formula>, therefore the numerator of the raw model <inline-formula><inline-graphic xlink:href="pone.0108358.e210.jpg"/></inline-formula> provides an estimate of how often <inline-formula><inline-graphic xlink:href="pone.0108358.e211.jpg"/></inline-formula> is actually caused by <inline-formula><inline-graphic xlink:href="pone.0108358.e212.jpg"/></inline-formula>. The <inline-formula><inline-graphic xlink:href="pone.0108358.e213.jpg"/></inline-formula> estimator is then normalized to range between <inline-formula><inline-graphic xlink:href="pone.0108358.e214.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e215.jpg"/></inline-formula>.</p>
        <p>However, <inline-formula><inline-graphic xlink:href="pone.0108358.e216.jpg"/></inline-formula> does not provide a general criterion to disambiguate among genuine causes of a given event. We show a specific case in which <inline-formula><inline-graphic xlink:href="pone.0108358.e217.jpg"/></inline-formula> is not a sufficient estimator. Let us consider, for instance, a causal linear path: <inline-formula><inline-graphic xlink:href="pone.0108358.e218.jpg"/></inline-formula>. In this case, when evaluating the candidate parents <inline-formula><inline-graphic xlink:href="pone.0108358.e219.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e220.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0108358.e221.jpg"/></inline-formula> we have: <inline-formula><inline-graphic xlink:href="pone.0108358.e222.jpg"/></inline-formula>, so <inline-formula><inline-graphic xlink:href="pone.0108358.e223.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e224.jpg"/></inline-formula> are genuine causes of <inline-formula><inline-graphic xlink:href="pone.0108358.e225.jpg"/></inline-formula>, though we would like to select <inline-formula><inline-graphic xlink:href="pone.0108358.e226.jpg"/></inline-formula>, instead of <inline-formula><inline-graphic xlink:href="pone.0108358.e227.jpg"/></inline-formula>. Accordingly, we can only infer that <inline-formula><inline-graphic xlink:href="pone.0108358.e228.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e229.jpg"/></inline-formula>, i.e., a partial ordering, which does not help to disentangle the relation among <inline-formula><inline-graphic xlink:href="pone.0108358.e230.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e231.jpg"/></inline-formula> with respect to <inline-formula><inline-graphic xlink:href="pone.0108358.e232.jpg"/></inline-formula>.</p>
        <p>In this case, the <inline-formula><inline-graphic xlink:href="pone.0108358.e233.jpg"/></inline-formula> coefficient can be used to determine which of the two genuine causes occurs closer, in time, to <inline-formula><inline-graphic xlink:href="pone.0108358.e234.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0108358.e235.jpg"/></inline-formula>, in the example above). In general, such a correction factor provides information on the <italic>temporal distance</italic> between events, in terms of statistical dependency. In other words, the higher the <inline-formula><inline-graphic xlink:href="pone.0108358.e236.jpg"/></inline-formula> coefficient, the closer two events are. Therefore, when dealing with noisy data and limited sample sizes, there are situations where, by using the <inline-formula><inline-graphic xlink:href="pone.0108358.e237.jpg"/></inline-formula> estimator alone, we could infer a wrong transitive edge to be the most likely cause even in the presence of the real cause. For this reason, we reduce the <inline-formula><inline-graphic xlink:href="pone.0108358.e238.jpg"/></inline-formula> estimator to the correction factor <inline-formula><inline-graphic xlink:href="pone.0108358.e239.jpg"/></inline-formula>, which, for each given edge <inline-formula><inline-graphic xlink:href="pone.0108358.e240.jpg"/></inline-formula>, is normalized within <inline-formula><inline-graphic xlink:href="pone.0108358.e241.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e242.jpg"/></inline-formula>.</p>
        <p>The shrinkage-like estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e243.jpg"/></inline-formula> then results in the combination of the raw PR estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e244.jpg"/></inline-formula> and of the <inline-formula><inline-graphic xlink:href="pone.0108358.e245.jpg"/></inline-formula> correction factor, which respects the temporal priority induced by <inline-formula><inline-graphic xlink:href="pone.0108358.e246.jpg"/></inline-formula>.</p>
        <p><bold>Proposition 5.</bold> (Coherence in dependency and temporal priority). <italic>The </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e247.jpg"/></inline-formula>
<italic> correction factor is symmetrical and subsumes the same notion of dependency of the raw estimator </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e248.jpg"/></inline-formula>
<italic>, that is</italic>
<disp-formula id="pone.0108358.e249"><graphic xlink:href="pone.0108358.e249.jpg" position="anchor" orientation="portrait"/><label>(9)</label></disp-formula>
</p>
      </sec>
      <sec id="s3a2">
        <title>The independent progressions filter</title>
        <p>As in Desper's approach, we also add a <italic>root</italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e250.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0108358.e251.jpg"/></inline-formula> in order to separate different progression paths, i.e., the different sub-trees rooted in <inline-formula><inline-graphic xlink:href="pone.0108358.e252.jpg"/></inline-formula>. CAPRESE initially builds a unique tree by using the estimator; typically, the most likely event will be at the top of the progression even if there may be rare cases where more than one event has no valid parent, in these cases we would already be reconstructing a forest. In the reconstructed tree, all the edges represent the most confident prima facie cause, although some of those could still be spurious causes. Then the correlation-like weight between any node <inline-formula><inline-graphic xlink:href="pone.0108358.e253.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e254.jpg"/></inline-formula> is computed as<disp-formula id="pone.0108358.e255"><graphic xlink:href="pone.0108358.e255.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>If this quantity is greater than the weight of <inline-formula><inline-graphic xlink:href="pone.0108358.e256.jpg"/></inline-formula> with each upstream connected element <inline-formula><inline-graphic xlink:href="pone.0108358.e257.jpg"/></inline-formula>, we consider the best prima facie cause of <inline-formula><inline-graphic xlink:href="pone.0108358.e258.jpg"/></inline-formula> to be a spurious cause and we substitute the edge <inline-formula><inline-graphic xlink:href="pone.0108358.e259.jpg"/></inline-formula> with the edge <inline-formula><inline-graphic xlink:href="pone.0108358.e260.jpg"/></inline-formula>. Note that in this work we are ignoring deeper discussions of probabilistic causation that aim at distinguishing between actual genuine causes and spurious causes. Instead, we remove spurious causes by using a filter based on correlation because the probability raising of the omnipresent event <inline-formula><inline-graphic xlink:href="pone.0108358.e261.jpg"/></inline-formula> is not well defined (see <xref ref-type="sec" rid="s2">Methods</xref>). In addition, we remark that the evaluation for an edge to be a genuine or a spurious cause takes into account all the given events. Because of this, if events are added or removed from the dataset, the same edge can be defined to be genuine or spurious as the set of events included in the model is varied arbitrarily. However, since we do not consider the problem of selecting the set of progression events, we assume that all and only the relevant events for the problem at hand are already known a priori and included in the model.</p>
        <p>Finally, note that this filter is indeed implying a non-negative threshold for the shrinkage-like estimator, when an edge is valid.</p>
        <p><bold>Theorem 1.</bold> (Independent progressions). <italic>Let </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e262.jpg"/></inline-formula>
<italic> a set of </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e263.jpg"/></inline-formula> prima facie causes <italic>for some </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e264.jpg"/></inline-formula>
<italic>, and let </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e265.jpg"/></inline-formula>
<italic>. The reconstructed tree by CAPRESE contains edge </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e266.jpg"/></inline-formula>
<italic> instead of </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e267.jpg"/></inline-formula>
<italic> if, for all </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e268.jpg"/></inline-formula>
<disp-formula id="pone.0108358.e269"><graphic xlink:href="pone.0108358.e269.jpg" position="anchor" orientation="portrait"/><label>(10)</label></disp-formula>
</p>
        <p>The proof of this theorem can be found in the <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref>. What this theorem suggests is that, in principle, by examining the level of statistical dependency of each pair of events, it would be possible to determine how many trees compose the reconstructed forest. Furthermore, it suggests that CAPRESE could be defined by first processing the independent progressions filter, and then using <inline-formula><inline-graphic xlink:href="pone.0108358.e270.jpg"/></inline-formula> to build the independent progression trees in the forest.</p>
        <p>To conclude, the algorithm reconstructs a well defined tree (or, more in general, forest).</p>
        <p><bold>Theorem 2.</bold> (Algorithm correctness). <italic>CAPRESE reconstructs a well defined tree </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e271.jpg"/></inline-formula>
<italic> without disconnected components, transitive connections and cycles.</italic>
</p>
        <p>Additionally, asymptotically with the number of samples, the reconstructed tree is the correct one.</p>
        <p><bold>Theorem 3.</bold> (Asymptotic convergence). <italic>Let </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e272.jpg"/></inline-formula>
<italic> be the forest to reconstruct from a set of </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e273.jpg"/></inline-formula>
<italic> input samples, given as the input matrix </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e274.jpg"/></inline-formula>
<italic>. If </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e275.jpg"/></inline-formula>
<italic> is strictly sampled from the distribution induced by </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e276.jpg"/></inline-formula>
<italic> and infinite samples are available, i.e., </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e277.jpg"/></inline-formula>
<italic>, CAPRESE with </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e278.jpg"/></inline-formula>
<italic> correctly reconstructs </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e279.jpg"/></inline-formula>
<italic>.</italic>
</p>
        <p>The proof of these Theorems are also in the <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref>. These theorems considered datasets where the observed and theoretical probabilities match, because of <inline-formula><inline-graphic xlink:href="pone.0108358.e280.jpg"/></inline-formula>. However, data often contains false positives and negatives (i.e., data are noisy) and resistance to their effects is desirable in any inferential technique. With this in mind, we prove a corollary of the theorem analoguos to a result appearing in <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref>.</p>
        <p><bold>Corollary 1.</bold> (Uniform noise). <italic>Let the input matrix </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e281.jpg"/></inline-formula>
<italic> be strictly sampled from the distribution induced by </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e282.jpg"/></inline-formula>
<italic> with sample size </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e283.jpg"/></inline-formula>
<italic>, but let it be corrupted by noise levels of false positives </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e284.jpg"/></inline-formula>
<italic> and false negatives </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e285.jpg"/></inline-formula>
<italic>. Let </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e286.jpg"/></inline-formula>
<italic>, CAPRESE correctly reconstructs </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e287.jpg"/></inline-formula>
<italic> for </italic>
<inline-formula><inline-graphic xlink:href="pone.0108358.e288.jpg"/></inline-formula>
<italic> whenever</italic>
<disp-formula id="pone.0108358.e289"><graphic xlink:href="pone.0108358.e289.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p><italic>and</italic><inline-formula><inline-graphic xlink:href="pone.0108358.e290.jpg"/></inline-formula>.</p>
        <p>Essentially, this corollary states that CAPRESE (and so the estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e291.jpg"/></inline-formula>) is robust against a noise affecting all samples equally. Also, the fact that it holds for <inline-formula><inline-graphic xlink:href="pone.0108358.e292.jpg"/></inline-formula> is sound with the theory of shrinkage estimators for which, asymptotically, the corrector factor is not needed to regularize the ill posed problem.</p>
      </sec>
    </sec>
    <sec id="s3b">
      <title>Optimal shrinkage-like coefficient</title>
      <p>Theorem 3 and Corollary 1 state that with infinite samples and mild constraints on the false positive/negative rates we get optimal results with <inline-formula><inline-graphic xlink:href="pone.0108358.e293.jpg"/></inline-formula>. Precisely, for the uniform noise model that we applied to synthetic data (see <xref ref-type="sec" rid="s2">Methods</xref>) we have <inline-formula><inline-graphic xlink:href="pone.0108358.e294.jpg"/></inline-formula>, thus the hypothesis required by Corollary 1 is<disp-formula id="pone.0108358.e295"><graphic xlink:href="pone.0108358.e295.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      <p>For <inline-formula><inline-graphic xlink:href="pone.0108358.e296.jpg"/></inline-formula>, which we set in data generation (see <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref>), this inequality implies correct reconstruction for <inline-formula><inline-graphic xlink:href="pone.0108358.e297.jpg"/></inline-formula> (a <inline-formula><inline-graphic xlink:href="pone.0108358.e298.jpg"/></inline-formula> error rate), with infinite samples. However, we are interested in performance and the optimal value of <inline-formula><inline-graphic xlink:href="pone.0108358.e299.jpg"/></inline-formula> in situations in which we have finite sample sizes as well. Here, we empirically estimate the optimal <inline-formula><inline-graphic xlink:href="pone.0108358.e300.jpg"/></inline-formula> value, both in the case of trees and forests, as a function of noise and sample size. In the next section, we assess performance of our algorithm empirically.</p>
      <p>In <xref ref-type="fig" rid="pone-0108358-g002">Figure 2</xref>, we show the variation of the performance of CAPRESE as a function of <inline-formula><inline-graphic xlink:href="pone.0108358.e301.jpg"/></inline-formula>, for datasets with 150 samples generated from tree topologies. The optimal value, i.e., lowest Tree Edit Distance (TED, see <xref ref-type="sec" rid="s2">Methods</xref>), for noise-free datasets (i.e., <inline-formula><inline-graphic xlink:href="pone.0108358.e302.jpg"/></inline-formula>) is obtained for <inline-formula><inline-graphic xlink:href="pone.0108358.e303.jpg"/></inline-formula>, whereas for the noisy datasets a series of U-shaped curves suggests a unique optimum value for <inline-formula><inline-graphic xlink:href="pone.0108358.e304.jpg"/></inline-formula>, immediately observable for <inline-formula><inline-graphic xlink:href="pone.0108358.e305.jpg"/></inline-formula>. Identical results are obtained when dealing with forests (not shown here). In addition, further experiments with <inline-formula><inline-graphic xlink:href="pone.0108358.e306.jpg"/></inline-formula> varying around the typical sample size (<inline-formula><inline-graphic xlink:href="pone.0108358.e307.jpg"/></inline-formula>) show that the optimal <inline-formula><inline-graphic xlink:href="pone.0108358.e308.jpg"/></inline-formula> is largely insensitive to the dataset size (see <xref ref-type="fig" rid="pone-0108358-g003">Figure 3</xref>). Thus we have limited our analysis to datasets with the typical sample size that is characteristic of data currently available.</p>
      <fig id="pone-0108358-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Optimal shrinkage-like coefficient for reconstruction performance.</title>
          <p>We show here the performance in the reconstruction of trees (TED surface) with <inline-formula><inline-graphic xlink:href="pone.0108358.e309.jpg"/></inline-formula> samples as a function of the shrinkage-like coefficient <inline-formula><inline-graphic xlink:href="pone.0108358.e310.jpg"/></inline-formula>. Notice the global optimal performance for <inline-formula><inline-graphic xlink:href="pone.0108358.e311.jpg"/></inline-formula> when <inline-formula><inline-graphic xlink:href="pone.0108358.e312.jpg"/></inline-formula> and for <inline-formula><inline-graphic xlink:href="pone.0108358.e313.jpg"/></inline-formula> when <inline-formula><inline-graphic xlink:href="pone.0108358.e314.jpg"/></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g002"/>
      </fig>
      <fig id="pone-0108358-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Optimal <inline-formula><inline-graphic xlink:href="pone.0108358.e315.jpg"/></inline-formula> with datasets of different size.</title>
          <p>We show the analogous of <xref ref-type="fig" rid="pone-0108358-g002">Figure 2</xref> with 50 and 250 samples. The estimation of the optimal shrinkage-like coefficient <inline-formula><inline-graphic xlink:href="pone.0108358.e316.jpg"/></inline-formula> appears to be irrespective of the sample size.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g003"/>
      </fig>
      <p>Summarizing, <xref ref-type="fig" rid="pone-0108358-g002">Figures 2</xref> and <xref ref-type="fig" rid="pone-0108358-g003">3</xref> suggest that for sample size below 250 without false positives and negatives the PR raw estimate <inline-formula><inline-graphic xlink:href="pone.0108358.e317.jpg"/></inline-formula> suffices to drive reconstruction to good results (TED is 0 with 250 samples), i.e.,<disp-formula id="pone.0108358.e318"><graphic xlink:href="pone.0108358.e318.jpg" position="anchor" orientation="portrait"/><label>(11)</label></disp-formula>which is obtained by setting <inline-formula><inline-graphic xlink:href="pone.0108358.e319.jpg"/></inline-formula> to a very small value, e.g. <inline-formula><inline-graphic xlink:href="pone.0108358.e320.jpg"/></inline-formula>, in order to consider at least a small contribution of the correction factor too. Conversely, when <inline-formula><inline-graphic xlink:href="pone.0108358.e321.jpg"/></inline-formula>, the best performance is obtained by averaging the shrinkage-like effect, i.e.,</p>
      <p><disp-formula id="pone.0108358.e322"><graphic xlink:href="pone.0108358.e322.jpg" position="anchor" orientation="portrait"/><label>(12)</label></disp-formula>These results suggest that, in general, a unique optimal value for the shrinkage-like coefficient can be determined, even in situations not captured by Theorem 3 and Corollary 1.</p>
    </sec>
    <sec id="s3c">
      <title>Performance of CAPRESE compared to <italic>oncotrees</italic>
</title>
      <p>An analogue of Theorem 3 holds for Despers's oncotrees (Theorem 3.3, <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>), and an analogue of Corollary 1 holds for Szabo's extension with uniform noise (Reconstruction Theorem 1, <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref>). Thus, with infinite samples both approaches reconstruct the correct trees/forests. With finite samples and noise, however, their performance may show different patterns, as speed of convergence may vary. We investigate this issue in the current section.</p>
      <p>In <xref ref-type="fig" rid="pone-0108358-g004">Figure 4</xref> we compare the performance of CAPRESE with oncotrees, for the case of noise-free synthetic data with the optimal shrinkage-like coefficient: <inline-formula><inline-graphic xlink:href="pone.0108358.e323.jpg"/></inline-formula>, <xref ref-type="disp-formula" rid="pone.0108358.e318">equation (11</xref>). Since Szabo's algorithm is equivalent to Desper's without false negatives and positives, we rely solely on Szabo's implementation <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref>. In <xref ref-type="fig" rid="pone-0108358-g005">Figure 5</xref> we show an example of reconstructed tree where CAPRESE infers the correct tree while oncotrees mislead a causation relation.</p>
      <fig id="pone-0108358-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Comparison on noise-free synthetic data.</title>
          <p>Performance of CAPRESE (dashed line) and oncotrees (full line) in average TED when data are generated by random trees (left) and forests (right). In this case <inline-formula><inline-graphic xlink:href="pone.0108358.e324.jpg"/></inline-formula> (no false positives/negatives) and <inline-formula><inline-graphic xlink:href="pone.0108358.e325.jpg"/></inline-formula> in the estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e326.jpg"/></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g004"/>
      </fig>
      <fig id="pone-0108358-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Example of reconstructed trees.</title>
          <p>Example of reconstruction from a dataset with 100 samples generated by the left tree (the theoretical probabilities are shown, i.e., the doubly-circled event appears in a sample with probability.08), with <inline-formula><inline-graphic xlink:href="pone.0108358.e327.jpg"/></inline-formula>. In the sampled dataset oncotrees mislead the cause of the doubly-circled mutation (<inline-formula><inline-graphic xlink:href="pone.0108358.e328.jpg"/></inline-formula> for the true edge and <inline-formula><inline-graphic xlink:href="pone.0108358.e329.jpg"/></inline-formula> for the wrong one). CAPRESE infers the correct cause (the values of the estimator <inline-formula><inline-graphic xlink:href="pone.0108358.e330.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0108358.e331.jpg"/></inline-formula> are shown, similar results are obtained for <inline-formula><inline-graphic xlink:href="pone.0108358.e332.jpg"/></inline-formula>).</p>
        </caption>
        <graphic xlink:href="pone.0108358.g005"/>
      </fig>
      <p>In general, one can observe that the TED of CAPRESE is, on average, always bounded above by the TED of oncotrees, both in the case of trees and forests. For trees, with 50 samples the average TED of CAPRESE is around 6, whereas for Desper's technique it is around 13. The performance of both algorithms improves as long as the number of samples is increased: CAPRESE has the best performance (i.e., TED ≈0) with 250 samples, while oncotrees have TED around 6. When forests are considered, the difference between the performance of the algorithms reduces slightly, but also in this case CAPRESE clearly outperforms oncotrees.</p>
      <p>Notice that the improvement due to the increase in the sample size seems to reach a <italic>plateau</italic>, and the initial TED for our estimator seems rather close to the plateau value. This empirical analysis suggests that CAPRESE has already good performances with few samples, a favorable adjoint to Theorem 3. This result has some important practical implications, particularly considering the scarcity of available biological data.</p>
      <p>In <xref ref-type="fig" rid="pone-0108358-g006">Figure 6</xref> we extend the comparison to <italic>noisy</italic> datasets. In this case, we used the optimal shrinkage-like coefficient: <inline-formula><inline-graphic xlink:href="pone.0108358.e333.jpg"/></inline-formula>, <xref ref-type="disp-formula" rid="pone.0108358.e322">equation (12</xref>). The results confirm what observed without false positives and negatives, as CAPRESE outperforms oncotrees up to <inline-formula><inline-graphic xlink:href="pone.0108358.e334.jpg"/></inline-formula>, for all the sizes of the sample sets. In the <xref ref-type="supplementary-material" rid="pone.0108358.s001">File S1</xref> we show similar plots for the noise-free case.</p>
      <fig id="pone-0108358-g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Reconstruction with noisy synthetic data and <inline-formula><inline-graphic xlink:href="pone.0108358.e335.jpg"/></inline-formula>.</title>
          <p>Performance of CAPRESE and oncotrees as a function of the number of samples and noise <inline-formula><inline-graphic xlink:href="pone.0108358.e336.jpg"/></inline-formula>. According to <xref ref-type="fig" rid="pone-0108358-g002">Figure 2</xref> the shrinkage-like coefficient is set to <inline-formula><inline-graphic xlink:href="pone.0108358.e337.jpg"/></inline-formula>. The magnified image shows the convergence to Desper's performance for <inline-formula><inline-graphic xlink:href="pone.0108358.e338.jpg"/></inline-formula>. The barplot represents the percentage of times the best performance is achieved at <inline-formula><inline-graphic xlink:href="pone.0108358.e339.jpg"/></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g006"/>
      </fig>
      <p>We can thus draw the conclusion that our algorithm performs better with finite samples and noise, since less samples are required to get good performances and a higher resistance to false positives and negatives is shown.</p>
    </sec>
    <sec id="s3d">
      <title>Performance of CAPRESE compared to <italic>Conjunctive Bayesian Networks</italic>
</title>
      <p>Inspired by Desper's seminal work, Beerenwinkel and others developed methods to estimate the constraints on the order in which mutations accumulate during cancer progression, using a probabilistic graphical model called <italic>Conjuntive Bayesian Networks</italic> (CBN) <xref rid="pone.0108358-Beerenwinkel3" ref-type="bibr">[14]</xref>, <xref rid="pone.0108358-Gerstung1" ref-type="bibr">[15]</xref>. While the goal of this research was to reconstruct <italic>direct acyclic graphs</italic> and not trees per se, evidence presented in <xref rid="pone.0108358-Hainke1" ref-type="bibr">[24]</xref> suggests that, in the absence of noise, these models perform better than oncotrees even at reconstructing <italic>trees</italic>. For this reason, we performed experiments similar to the ones suggested above, comparing CAPRESE to the extension of CBN called <italic>hidden-CBN</italic> (h-CBN) that accounts for noisy genotype observations <xref rid="pone.0108358-Gerstung1" ref-type="bibr">[15]</xref>. This method combines CBNs with a simulated annealing algorithm for structure search and a denoising of the genotypes via the maximum a posteriori estimates to compute the most likely progression. One aspect that complicates a comparison between CAPRESE and (h-)CBN is that the methods assume different models. For example, at the heart of CBN is a monotonicity assumption (i.e., an event can only occur if all its predecessors have occurred) not assumed by CAPRESE. Despite the differences between the model assumptions, we present a preliminary comparison between the methods in Appendix S3, indicating that we not only outperform oncotrees, but h-CBNs as well. In particular, this suggests that CAPRESE converges much faster than h-CBNs with respect to the sample size, also in the presence of noise.</p>
      <p>We also analyze the rate of <italic>false positives/negatives</italic> reconstructed by CAPRESE when (synthetic) data are sampled from DAGs (Appendix S3). The rate of <italic>false positives</italic> goes to 0 as the sample size increases, implying that CAPRESE is capable of reconstructing a tree subsumed by the underlying causal DAG topology. In addition, the number of <italic>false negatives</italic> approaches a value proportional to the connectivity of the model from which the data was generated. This is expected, since CAPRESE will assign at most one cause to each considered event. However, it should be noted that further experiments with samples selected from a wider array of topologies should be performed to confirm these results and compare both methods in full. While not within the scope of the current paper, these issues will be addressed in future work.</p>
    </sec>
    <sec id="s3e">
      <title>Case studies</title>
      <p>In the next subsections we apply CAPRESE to real cancer data obtained by <italic>Comparative Genomic Hybridization</italic> (CGH) and <italic>Next Generation Sequencing</italic> (NGS). This shows the potential application of reconstruction techniques to various types of mutational profiles and various cancers.</p>
    </sec>
    <sec id="s3f">
      <title>Performance on cancer CGH datasets</title>
      <p>Encouraged by the results in previous sections, we test our reconstruction approach on a real <italic>ovarian cancer</italic> dataset made available within the oncotree package <xref rid="pone.0108358-Desper1" ref-type="bibr">[8]</xref>. The data was collected through the public platform SKY/M-FISH <xref rid="pone.0108358-Knutsen1" ref-type="bibr">[38]</xref>, used to allow investigators to share molecular cytogenetic data. The data was obtained by using the CGH technique on samples from <italic>papillary serous cystadenocarcinoma</italic> of the ovary. This technique uses fluorescent staining to detect CNV data at the resolution of chromosome arms. While the recent emergence of NGS approaches make the dataset itself rather outdated, the underlying principles remain the same and the dataset provides a valid test-case for our approach. The seven most commonly occurring events are selected from the 87 samples, and the set of events are the following gains and losses on chromosomes arms <inline-formula><inline-graphic xlink:href="pone.0108358.e340.jpg"/></inline-formula> (e.g., <inline-formula><inline-graphic xlink:href="pone.0108358.e341.jpg"/></inline-formula> denotes a deletion of the <inline-formula><inline-graphic xlink:href="pone.0108358.e342.jpg"/></inline-formula> arm of the <inline-formula><inline-graphic xlink:href="pone.0108358.e343.jpg"/></inline-formula> chromosome).</p>
      <p>In <xref ref-type="fig" rid="pone-0108358-g007">Figure 7</xref> we compare the trees reconstructed by the two approaches. Our technique differs from Desper's by predicting the causal sequence of alterations<disp-formula id="pone.0108358.e344"><graphic xlink:href="pone.0108358.e344.jpg" position="anchor" orientation="portrait"/></disp-formula>when used either <inline-formula><inline-graphic xlink:href="pone.0108358.e345.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0108358.e346.jpg"/></inline-formula>. Notice that among the samples in the dataset some are not generated by the distribution induced by the recovered tree, thus comparing the reconstruction for both <inline-formula><inline-graphic xlink:href="pone.0108358.e347.jpg"/></inline-formula>s is necessary.</p>
      <fig id="pone-0108358-g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g007</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Reconstruction of ovarian cancer progression.</title>
          <p>Trees reconstructed by oncotrees and CAPRESE (with <inline-formula><inline-graphic xlink:href="pone.0108358.e348.jpg"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="pone.0108358.e349.jpg"/></inline-formula> the same tree is reconstructed). The set of CGH events considered are gains on <inline-formula><inline-graphic xlink:href="pone.0108358.e350.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e351.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e352.jpg"/></inline-formula> and losses on <inline-formula><inline-graphic xlink:href="pone.0108358.e353.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e354.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e355.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e356.jpg"/></inline-formula>. Events on chromosomes arms containing the key genes for ovarian cancer are in bolded circles. In the left tree all edge weights are the observed probabilities of events. In the right the full edges are the causation inferred with the PR and the weights represent the scores used by CAPRESE. Weights on dashed lines are as in the left tree.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g007"/>
      </fig>
      <p>At this point, we do not have a biological interpretation for this result. However, we do know that common cancer genes reside in these regions, e.g. the tumor suppressor gene PDGFR on <inline-formula><inline-graphic xlink:href="pone.0108358.e357.jpg"/></inline-formula> and the oncogene MYC on <inline-formula><inline-graphic xlink:href="pone.0108358.e358.jpg"/></inline-formula>), and loss of heterozygosity on the short arm of chromosome <inline-formula><inline-graphic xlink:href="pone.0108358.e359.jpg"/></inline-formula> is quite common (see, e.g., <ext-link ext-link-type="uri" xlink:href="http://www.genome.jp/kegg/">http://www.genome.jp/kegg/</ext-link>). Recently, evidence has been reported that <inline-formula><inline-graphic xlink:href="pone.0108358.e360.jpg"/></inline-formula> contains many cooperating cancer genes <xref rid="pone.0108358-Xue1" ref-type="bibr">[39]</xref>.</p>
      <p>In order to assign a confidence level to these inferences we applied both parametric and non-parametric <italic>bootstrapping methods</italic> to our results. Essentially, these tests consist of using the reconstructed trees (in the parametric case), or the probability observed in the dataset (in the non-parametric case) to generate new synthetic datasets, and then reconstructs again the progressions (see, e.g., <xref rid="pone.0108358-Efron2" ref-type="bibr">[40]</xref> for an overview of these methods and <xref rid="pone.0108358-Szabo2" ref-type="bibr">[41]</xref> for the use of bootstrap for evalutating the confidence of oncogenetic trees.). The confidence is given by the number of times the trees in <xref ref-type="fig" rid="pone-0108358-g007">Figure 7</xref> are reconstructed from the generated data. A similar approach can be used to estimate the confidence of every edge separately. For oncotrees the <italic>exact tree</italic> is obtained 83 times out of 1000 non-parametric resamples, so its estimated confidence is 8.3%. For CAPRESE the confidence is <inline-formula><inline-graphic xlink:href="pone.0108358.e361.jpg"/></inline-formula>. In the parametric case with false positive and false negative error rates of 0.21 and 0.027, following <xref rid="pone.0108358-Szabo1" ref-type="bibr">[22]</xref>, the confidence of oncotrees is <inline-formula><inline-graphic xlink:href="pone.0108358.e362.jpg"/></inline-formula> while the confidence of our method is much higher: <inline-formula><inline-graphic xlink:href="pone.0108358.e363.jpg"/></inline-formula>. When error rates are forced to 0 the confidence of oncotrees raises to <inline-formula><inline-graphic xlink:href="pone.0108358.e364.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e365.jpg"/></inline-formula> respectively.</p>
      <p>For the non-parametric case, edges confidence is shown in <xref ref-type="table" rid="pone-0108358-t001">Table 1</xref>. Most notably, our algorithm reconstructs the inference <inline-formula><inline-graphic xlink:href="pone.0108358.e366.jpg"/></inline-formula> with high confidence (confidence <inline-formula><inline-graphic xlink:href="pone.0108358.e367.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0108358.e368.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0108358.e369.jpg"/></inline-formula>), while the confidence of the edge <inline-formula><inline-graphic xlink:href="pone.0108358.e370.jpg"/></inline-formula> is only <inline-formula><inline-graphic xlink:href="pone.0108358.e371.jpg"/></inline-formula>, almost the same as <inline-formula><inline-graphic xlink:href="pone.0108358.e372.jpg"/></inline-formula> (confidence <inline-formula><inline-graphic xlink:href="pone.0108358.e373.jpg"/></inline-formula>). The confidences are similar with either <inline-formula><inline-graphic xlink:href="pone.0108358.e374.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0108358.e375.jpg"/></inline-formula>.</p>
      <table-wrap id="pone-0108358-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Estimated confidence for ovarian progression.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0108358-t001-1" xlink:href="pone.0108358.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td colspan="8" align="left" rowspan="1">Oncotrees (overall confidence 8.3%)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e376.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e377.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e378.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e379.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e380.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e381.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e382.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e383.jpg"/>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e384.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.99</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.06</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.51</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.22</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.8</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.06</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e385.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.92</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.08</td>
                <td align="left" rowspan="1" colspan="1">0.16</td>
                <td align="left" rowspan="1" colspan="1">.04</td>
                <td align="left" rowspan="1" colspan="1">.02</td>
                <td align="left" rowspan="1" colspan="1">.007</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e386.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">.002</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.04</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.09</td>
                <td align="left" rowspan="1" colspan="1">.04</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e387.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">.001</td>
                <td align="left" rowspan="1" colspan="1">.002</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.52</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.39</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.009</td>
                <td align="left" rowspan="1" colspan="1">.16</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e388.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.27</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.14</td>
                <td align="left" rowspan="1" colspan="1">.05</td>
                <td align="left" rowspan="1" colspan="1">.11</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e389.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.07</td>
                <td align="left" rowspan="1" colspan="1">.08</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.59</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e390.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e391.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.003</td>
                <td align="left" rowspan="1" colspan="1">.003</td>
                <td align="left" rowspan="1" colspan="1">.04</td>
                <td align="left" rowspan="1" colspan="1">.01</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
            </tbody>
          </table>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td colspan="8" align="left" rowspan="1">CAPRESE (overall confidence 8.6%)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e392.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e393.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e394.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e395.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e396.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e397.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e398.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e399.jpg"/>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e400.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.99</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.06</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.51</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.22</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.8</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.06</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e401.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.92</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.06</td>
                <td align="left" rowspan="1" colspan="1">.16</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.62</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.01</td>
                <td align="left" rowspan="1" colspan="1">.008</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e402.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">.002</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.03</td>
                <td align="left" rowspan="1" colspan="1">.002</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.09</td>
                <td align="left" rowspan="1" colspan="1">.04</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e403.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">.001</td>
                <td align="left" rowspan="1" colspan="1">.002</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.5</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">.26</td>
                <td align="left" rowspan="1" colspan="1">.009</td>
                <td align="left" rowspan="1" colspan="1">.17</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e404.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.29</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.09</td>
                <td align="left" rowspan="1" colspan="1">.05</td>
                <td align="left" rowspan="1" colspan="1">.12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e405.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.07</td>
                <td align="left" rowspan="1" colspan="1">.08</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>.59</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e406.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0108358.e407.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">.001</td>
                <td align="left" rowspan="1" colspan="1">.003</td>
                <td align="left" rowspan="1" colspan="1">.004</td>
                <td align="left" rowspan="1" colspan="1">.01</td>
                <td align="left" rowspan="1" colspan="1">.01</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>Frequency of edge occurrences in the non-parametric bootstrap test, for the trees shown in <xref ref-type="fig" rid="pone-0108358-g007">Figure 7</xref>. Bold entries are the edges recovered by the algorithms.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec id="s3f1">
        <title>Analysis of other CGH datasets</title>
        <p>We report the differences between the reconstructed trees also based on datasets of gastrointestinal and oral cancer (<xref rid="pone.0108358-Gunawan1" ref-type="bibr">[35]</xref>, <xref rid="pone.0108358-Pathare1" ref-type="bibr">[37]</xref> respectively). In the case of gastrointestinal stromal cancer, among the <inline-formula><inline-graphic xlink:href="pone.0108358.e408.jpg"/></inline-formula> CGH events considered in <xref rid="pone.0108358-Gunawan1" ref-type="bibr">[35]</xref> (gains on <inline-formula><inline-graphic xlink:href="pone.0108358.e409.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e410.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e411.jpg"/></inline-formula>, losses on <inline-formula><inline-graphic xlink:href="pone.0108358.e412.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e413.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e414.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e415.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e416.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e417.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e418.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e419.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e420.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e421.jpg"/></inline-formula>), oncotrees identify the path progression<disp-formula id="pone.0108358.e422"><graphic xlink:href="pone.0108358.e422.jpg" position="anchor" orientation="portrait"/></disp-formula>while CAPRESE reconstructs the branch<disp-formula id="pone.0108358.e423"><graphic xlink:href="pone.0108358.e423.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>In the case of oral cancer, among the 12 CGH events considered in <xref rid="pone.0108358-Pathare1" ref-type="bibr">[37]</xref> (gains on <inline-formula><inline-graphic xlink:href="pone.0108358.e424.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e425.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e426.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e427.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e428.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e429.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e430.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e431.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e432.jpg"/></inline-formula>, losses on <inline-formula><inline-graphic xlink:href="pone.0108358.e433.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0108358.e434.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0108358.e435.jpg"/></inline-formula>), the reconstructed trees differ since oncotrees identifies the path<disp-formula id="pone.0108358.e436"><graphic xlink:href="pone.0108358.e436.jpg" position="anchor" orientation="portrait"/></disp-formula>while our algorithm reconstructs the path<disp-formula id="pone.0108358.e437"><graphic xlink:href="pone.0108358.e437.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>These examples show that CAPRESE provides important differences in the reconstruction compared to oncotrees.</p>
      </sec>
    </sec>
    <sec id="s3g">
      <title>Performance on cancer NGS datasets</title>
      <p>In this section we show the application of reconstruction techniques to the validation of a specific relation among recurrent mutations involved in <italic>atypical Chronic Myeloid Leukemia</italic> (ACML).</p>
      <p>In <xref rid="pone.0108358-Piazza1" ref-type="bibr">[42]</xref> Piazza <italic>et al.</italic> used high-throughput <italic>exome sequencing technology</italic> to identity somatically acquired mutations in 64 ACML patients, and found a previously unidentified recurring <italic>missense point mutation</italic> hitting SETBP1. By re-sequencing SETBP1 in samples with ACML and other common human cancers, they found that around 25% of the ACML patients tested positive for SETBP1, while most of the other types of tumors were negative. Assessing the possible relationship between SETBP1 variants and the mutations in many driver ACML oncogenes such as (e.g., ASXL1, TET2, KRAS, etc.) no significant association or mutual exclusion with SETBP1 was found but for ASXL1, which was frequently mutated together with SETBP1, hinting at a potential relation among the events. In particular, ASXL1 was presenting either a <italic>non-sense point</italic> or a <italic>indel</italic> type of somatic mutation.</p>
      <p>Hence, we reconstructed ACML progression models from the datasets provided in <xref rid="pone.0108358-Piazza1" ref-type="bibr">[42]</xref>, with the goal of assessing a <italic>potential causal dependency</italic> between mutated SETBP1 and ASXL1. A more extensive analysis is postponed, as we only seek to clearly illustrate the functionalities of the algorithm here.</p>
      <p>As a first case (<xref ref-type="fig" rid="pone-0108358-g008">Figure 8</xref>, left), we treated the ASXL1 missense point and indel mutations as indistinguishable, and we merged the two events in the dataset. Afterwards, we separated the two types of mutations for ASXL1 (<xref ref-type="fig" rid="pone-0108358-g008">Figure 8</xref>, right).</p>
      <fig id="pone-0108358-g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0108358.g008</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Validating the S<sc>etbp</sc>1 - ASXL1 relation in atypical Chronic Myeloid Leukemia.</title>
          <p>Progression models where ASXL1 indel and non-sense point are merged (left) and separate (right) suggest that a missense point mutation hitting SETBP1 can cause a non-sense point mutation in ASXL1, that the observed ASXL1 mutations might be independent and that indel ASXL1 is an early event with high confidence.</p>
        </caption>
        <graphic xlink:href="pone.0108358.g008"/>
      </fig>
      <p>In particular, it is interesting to notice that, when the ASXL1 mutations are considered equivalent, the inference suggests that the mutations belong to two independent progression paths (i.e., the independent progression filters “breaks” every potential causal relation among the events). Conversely, when the mutations are kept separate, the progression model suggests that: <inline-formula><inline-graphic xlink:href="pone.0108358.e438.jpg"/></inline-formula> the missense point mutation hitting SETBP1 can cause a non-sense point mutation in ASXL1 and <inline-formula><inline-graphic xlink:href="pone.0108358.e439.jpg"/></inline-formula> the observed ASXL1 mutations seems to be independent. Concerning edges confidence, as before assessed via non-parametric bootstrap, it is worth noting that the confidence in the indel ASXL1 mutation being an early event raises consistently in the latter case.</p>
      <p>All in all, it seems that a progression model allows to test the significance of the association firstly observed in <xref rid="pone.0108358-Piazza1" ref-type="bibr">[42]</xref> and also refines the knowledge by suggesting a specific causal and temporal relations among events. With this this in mind, ad-hoc sequencing experiments might be set up to assess these predictions, eventually providing a strong evidence that could be used to, e.g., synthesize a progression-specific ACML-effective drug.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>In this work we have introduced a novel framework for the reconstruction of the causal topologies underlying cumulative progressive phenomena, based on the <italic>probability raising</italic> notion of causation. Besides such a probabilistic notion, we also introduced the use of a <italic>shrinkage-like estimator</italic> to efficiently unravel ambiguous causal relations, often present when data are noisy. As a first step towards the definition of our new framework, we have here presented an effective novel technique called CAPRESE (CAncer PRogression Extraction with Single Edges) for the reconstruction of tree or, more generally, forest models of progression which combines probabilistic causation and a shrinkage-like estimation.</p>
    <p>We prove correctness of CAPRESE by showing asymptotic convergence to the correct tree. Under mild constraints on the noise rates, this result holds for the reconstruction problem in the presence of uniform noise as well. Moreover, we also compare our technique to the standard tree reconstruction algorithm based on correlation (i.e., Oncontrees) and to a more general bayesian probabilistic graphical model (i.e., Conjunctive Bayesian Networks), and show that CAPRESE outperforms the state-of-the-art on synthetic data, also exhibiting a noteworthy efficiency with relatively small datasets. Furthermore, we tested our technique on ovarian, gastrointestinal and oral cancer CGH data and NGS leukemia data. The CGH analysis suggested that our approach can infer, with high confidence, novel causal relationships which would remain unpredictable in a correlation-based attack. The NGS analysis allowed validating a causal and temporal relation among key mutations in atypical chronic myeloid leukemia.</p>
    <p>One of the strong points of CAPRESE is that it can be applied to genomic data of any kind, even heterogeneous, and at any resolution, as shown. In fact, it simply requires a set of samples in which the presence or the absence of some alterations supposed to be involved in a causal cumulative process have been assessed. Notice also that the results of our technique can be used not only to describe the <italic>progression</italic> of the process, but also to <italic>classify</italic> different progression types. In the case of cancer, for instance, this genome-level classifier could be used to group patients according to the position of the detected individual genomic alterations in the progression model (e.g., at a specific point of the tree) and, consequently, to set up a genome-specific <italic>therapy design</italic> aimed, for instance, at blocking or slowing certain progression paths instead of others, as was studied in <xref rid="pone.0108358-OldeLoohuis1" ref-type="bibr">[43]</xref>.</p>
    <p>Several future research directions are possible. First, more complex models of progression, e.g. directed acyclic graphs, could be inferred with probability raising and compared to the standard approaches of <xref rid="pone.0108358-Beerenwinkel3" ref-type="bibr">[14]</xref>, <xref rid="pone.0108358-Gerstung1" ref-type="bibr">[15]</xref>, <xref rid="pone.0108358-Gerstung2" ref-type="bibr">[44]</xref>, as we explained in the <xref ref-type="sec" rid="s1">introduction</xref>. These models, rather than trees, could explain the common phenomenon of <italic>preferential progression paths</italic> in the target process via, e.g., <italic>confluence</italic> among events. In the case of cancer, for instance, these models would be certainly more suitable than trees to describe the accumulation of mutations.</p>
    <p>Second, the shrinkage-like estimator itself could be improved by introducing, for instance, different correction factors. In addition, an analytical formulation of the optimal shrinkage-like coefficient could be investigated by starting from the hypotheses which apply to our problem setting, along the lines of <xref rid="pone.0108358-Efron3" ref-type="bibr">[45]</xref>.</p>
    <p>Third, advanced statistical techniques such as <italic>bootstrapping</italic>
<xref rid="pone.0108358-Efron2" ref-type="bibr">[40]</xref> could be used to account for more sophisticated models of noise within data, so as to decipher complex causal dependencies.</p>
    <p>Finally, a further development of the framework could involve the introduction of <italic>timed data</italic>, in order to extend our techniques to settings where a temporal information on the samples is available.</p>
    <sec id="s4a">
      <title>Software availability</title>
      <p>The implementation of CAPRESE is part of the TRanslational ONCOlogy (TRONCO) R package and is available for download at standard R repositories.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0108358.s001">
      <label>File S1</label>
      <caption>
        <p>
          <bold>Contains Proofs, Synthetic Data Generation, and Further Results.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0108358.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful for the many excellent comments we received from anonymous reviewers.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0108358-Hanahan1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Hanahan</surname><given-names>D</given-names></name>, <name><surname>Weinberg</surname><given-names>RA</given-names></name> (<year>2011</year>) <article-title>Hallmarks of cancer: The next generation</article-title>. <source>Cell</source>
<volume>144</volume>: <fpage>646</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">21376230</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Luo1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>J</given-names></name>, <name><surname>Solimini</surname><given-names>NL</given-names></name>, <name><surname>Elledge</surname><given-names>SJ</given-names></name> (<year>2009</year>) <article-title>Principles of cancer therapy: Oncogene and non-oncogene addiction</article-title>. <source>Cell</source>
<volume>136</volume>: <fpage>823</fpage>–<lpage>837</lpage>.<pub-id pub-id-type="pmid">19269363</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Vogelstein1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Vogelstein</surname><given-names>B</given-names></name>, <name><surname>Kinzler</surname><given-names>K</given-names></name> (<year>2004</year>) <article-title>Cancer genes and the pathways they control</article-title>. <source>Nature medicine</source>
<volume>10</volume>: <fpage>789</fpage>–<lpage>799</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Frank1">
      <label>4</label>
      <mixed-citation publication-type="other">Frank SA (2007) Dynamics of Cancer. Princeton University Press.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Bell1">
      <label>5</label>
      <mixed-citation publication-type="other">Bell D, Berchuck A, Birrer M, Chien J, Cramer D, <etal>et al</etal>.. (2011) Integrated genomic analyses of ovarian carcinoma. Nature.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Imielinski1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Imielinski</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Mapping the hallmarks of lung adenocarcinoma with massively parallel sequencing</article-title>. <source>Cell</source>
<volume>150</volume>: <fpage>1107</fpage>–<lpage>1120</lpage>.<pub-id pub-id-type="pmid">22980975</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Vogelstein2">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Vogelstein</surname><given-names>B</given-names></name>, <name><surname>Fearon</surname><given-names>ER</given-names></name>, <name><surname>Hamilton</surname><given-names>SR</given-names></name>, <name><surname>Kern</surname><given-names>SE</given-names></name>, <name><surname>Preisinger</surname><given-names>AC</given-names></name>, <etal>et al</etal> (<year>1988</year>) <article-title>Genetic alterations during colorectal-tumor development</article-title>. <source>New England Journal of Medicine</source>
<volume>319</volume>: <fpage>525</fpage>–<lpage>532</lpage>.<pub-id pub-id-type="pmid">2841597</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Desper1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Desper</surname><given-names>R</given-names></name>, <name><surname>Jiang</surname><given-names>F</given-names></name>, <name><surname>Kallioniemi</surname><given-names>O</given-names></name>, <name><surname>Moch</surname><given-names>H</given-names></name>, <name><surname>Papadimitriou</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>1999</year>) <article-title>Inferring tree models for oncogenesis from comparative genome hybridization data</article-title>. <source>Journal of Computational Biology</source>
<volume>6</volume>: <fpage>37</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">10223663</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Desper2">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Desper</surname><given-names>R</given-names></name>, <name><surname>Jiang</surname><given-names>F</given-names></name>, <name><surname>Kallioniemi</surname><given-names>O</given-names></name>, <name><surname>Moch</surname><given-names>H</given-names></name>, <name><surname>Papadimitriou</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2000</year>) <article-title>Distance-based reconstruction of tree models for oncogenesis</article-title>. <source>Journal of Computational Biology</source>
<volume>7</volume>: <fpage>789</fpage>–<lpage>803</lpage>.<pub-id pub-id-type="pmid">11382362</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-vonHeydebreck1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>von Heydebreck</surname><given-names>A</given-names></name>, <name><surname>Gunawan</surname><given-names>B</given-names></name>, <name><surname>Füzesi</surname><given-names>L</given-names></name> (<year>2004</year>) <article-title>Maximum likelihood estimation of oncogenetic tree models</article-title>. <source>Biostatistics</source>
<volume>5</volume>: <fpage>545</fpage>–<lpage>56</lpage>.<pub-id pub-id-type="pmid">15475418</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Beerenwinkel1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Däumer</surname><given-names>M</given-names></name>, <name><surname>Hoffmann</surname><given-names>D</given-names></name>, <name><surname>Kaiser</surname><given-names>R</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Learning multiple evolutionary pathways from cross-sectional data</article-title>. <source>Journal of Computational Biology</source>
<volume>12</volume>: <fpage>584</fpage>–<lpage>598</lpage>.<pub-id pub-id-type="pmid">16108705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Beerenwinkel2">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Kaiser</surname><given-names>R</given-names></name>, <name><surname>Hoffmann</surname><given-names>D</given-names></name>, <name><surname>Selbig</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Mtreemix: a software package for learning and using mixture models of mutagenetic trees</article-title>. <source>Bioinformatics</source>
<volume>21</volume>: <fpage>2106</fpage>–<lpage>2107</lpage>.<pub-id pub-id-type="pmid">15657098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Hjelm1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Hjelm</surname><given-names>M</given-names></name>, <name><surname>Höglund</surname><given-names>M</given-names></name>, <name><surname>Lagergren</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>New probabilistic network models and algorithms for oncogenesis</article-title>. <source>Journal of Computational Biology</source>
<volume>13</volume>: <fpage>853</fpage>–<lpage>865</lpage>.<pub-id pub-id-type="pmid">16761915</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Beerenwinkel3">
      <label>14</label>
      <mixed-citation publication-type="other">Beerenwinkel N, Eriksson N, Sturmfels B (2007) Conjunctive bayesian networks. Bernoulli: 893–909.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Gerstung1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Gerstung</surname><given-names>M</given-names></name>, <name><surname>Baudis</surname><given-names>M</given-names></name>, <name><surname>Moch</surname><given-names>H</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2009</year>) <article-title>Quantifying cancer progression with conjunctive bayesian networks</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>2809</fpage>–<lpage>2815</lpage>.<pub-id pub-id-type="pmid">19692554</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Gupta1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Gupta</surname><given-names>A</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name> (<year>2008</year>) <article-title>Extracting dynamics from static cancer expression data</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>
<volume>5</volume>: <fpage>172</fpage>–<lpage>182</lpage>.<pub-id pub-id-type="pmid">18451427</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Ramakrishnan1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Ramakrishnan</surname><given-names>N</given-names></name>, <name><surname>Tadepalli</surname><given-names>S</given-names></name>, <name><surname>Watson</surname><given-names>LT</given-names></name>, <name><surname>Helm</surname><given-names>RF</given-names></name>, <name><surname>Antoniotti</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Reverse engineering dynamic temporal models of biological processes and their relationships</article-title>. <source>PNAS</source>
<volume>107</volume>: <fpage>12511</fpage>–<lpage>12516</lpage>.<pub-id pub-id-type="pmid">20571120</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Suppes1">
      <label>18</label>
      <mixed-citation publication-type="other">Suppes P (1970) A probabilistic theory of causality. North Holland Publishing Company.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Hitchcock1">
      <label>19</label>
      <mixed-citation publication-type="other">Hitchcock C (2012) Probabilistic causation. In: Zalta E, editor, The Stanford Encyclopedia of Philosophy. Winter 2012 edition.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Ionita1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Ionita</surname><given-names>I</given-names></name>, <name><surname>Daruwala</surname><given-names>R</given-names></name>, <name><surname>Mishra</surname><given-names>B</given-names></name> (<year>2006</year>) <article-title>Mapping Tumor-Suppressor genes with multipoint statistics from Copy-Number–Variation data</article-title>. <source>American Journal of Human Genetics</source>
<volume>79</volume>: <fpage>13</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">16773561</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Kleinberg1">
      <label>21</label>
      <mixed-citation publication-type="other">Kleinberg S (2012) Causality, Probability, and Time. Cambridge University Press.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Szabo1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Szabo</surname><given-names>A</given-names></name>, <name><surname>Boucher</surname><given-names>K</given-names></name> (<year>2002</year>) <article-title>Estimating an oncogenetic tree when false negatives and positives are present</article-title>. <source>Mathematical biosciences</source>
<volume>176</volume>: <fpage>219</fpage>–<lpage>236</lpage>.<pub-id pub-id-type="pmid">11916510</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Efron1">
      <label>23</label>
      <mixed-citation publication-type="other">Efron B (2013) Large-Scale Inference: Empirical Bayes Methods for Estimation, Testing, and Prediction. Cambridge University Press.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Hainke1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Hainke</surname><given-names>K</given-names></name>, <name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Fried</surname><given-names>R</given-names></name> (<year>2012</year>) <article-title>Cumulative disease progression models for cross-sectional data: A review and comparison</article-title>. <source>Biometrical Journal</source>
<volume>54</volume>: <fpage>617</fpage>–<lpage>640</lpage>.<pub-id pub-id-type="pmid">22886685</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Reichenbach1">
      <label>25</label>
      <mixed-citation publication-type="other">Reichenbach H (1956) The Direction of Time. University of California Press.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Edmonds1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Edmonds</surname><given-names>J</given-names></name> (<year>1967</year>) <article-title>Optimum branchings</article-title>. <source>Journal of Research of the National Bureau of Standards B</source>
<volume>71</volume>: <fpage>233</fpage>–<lpage>240</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Kainu1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kainu</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2000</year>) <article-title>Somatic deletions in hereditary breast cancers implicate 13q21 as a putative novel breast cancer susceptibility locus</article-title>. <source>Proceedings of the National Academy of Sciences</source>
<volume>97</volume>: <fpage>9603</fpage>–<lpage>9608</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Huang1">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>Q</given-names></name>, <name><surname>Yu</surname><given-names>G</given-names></name>, <name><surname>McCormick</surname><given-names>S</given-names></name>, <name><surname>Mo</surname><given-names>J</given-names></name>, <name><surname>Datta</surname><given-names>B</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>Genetic differences detected by comparative genomic hybridization in head and neck squamous cell carcinomas from different tumor sites: construction of oncogenetic trees for tumor progression</article-title>. <source>Genes, Chromosomes and Cancer</source>
<volume>34</volume>: <fpage>224</fpage>–<lpage>233</lpage>.<pub-id pub-id-type="pmid">11979556</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Radmacher1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Radmacher</surname><given-names>M</given-names></name>, <name><surname>Simon</surname><given-names>R</given-names></name>, <name><surname>Desper</surname><given-names>R</given-names></name>, <name><surname>Taetle</surname><given-names>R</given-names></name>, <name><surname>Schäffer</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2001</year>) <article-title>Graph models of oncogenesis with an application to melanoma</article-title>. <source>Journal of theoretical biology</source>
<volume>212</volume>: <fpage>535</fpage>–<lpage>548</lpage>.<pub-id pub-id-type="pmid">11597184</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Cartwright1">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Cartwright</surname><given-names>N</given-names></name> (<year>1979</year>) <article-title>Causal laws and effective strategies</article-title>. <source>Noûs</source>
<volume>13</volume>: <fpage>419</fpage>–<lpage>437</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Pearl1">
      <label>31</label>
      <mixed-citation publication-type="other">Pearl J (2000) Causality: Models, Reasoning, and Inference. Cambridge University Press.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Zhang1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>K</given-names></name>, <name><surname>Shasha</surname><given-names>D</given-names></name> (<year>1989</year>) <article-title>Simple fast algorithms for the editing distance between trees and related problems</article-title>. <source>SIAM journal on computing</source>
<volume>18</volume>: <fpage>1245</fpage>–<lpage>1262</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Hamming1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Hamming</surname><given-names>RW</given-names></name> (<year>1950</year>) <article-title>Error-detecting and error-correcting codes</article-title>. <source>Bell System Technical Journal</source>
<volume>29</volume>: <fpage>147</fpage>–<lpage>160</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Samuelson1">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Samuelson</surname><given-names>E</given-names></name>, <name><surname>Karlsson</surname><given-names>S</given-names></name>, <name><surname>Partheen</surname><given-names>K</given-names></name>, <name><surname>Nilsson</surname><given-names>S</given-names></name>, <name><surname>Szpirer</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Bac cgh-array identified specific small-scale genomic imbalances in diploid dmba-induced rat mammary tumors</article-title>. <source>BMC cancer</source>
<volume>12</volume>: <fpage>352</fpage>.<pub-id pub-id-type="pmid">22894538</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Gunawan1">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Gunawan</surname><given-names>B</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>An oncogenetic tree model in gastrointestinal stromal tumours (gists) identifies different pathways of cytogenetic evolution with prognostic implications</article-title>. <source>The Journal of pathology</source>
<volume>211</volume>: <fpage>463</fpage>–<lpage>470</lpage>.<pub-id pub-id-type="pmid">17226762</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Longerich1">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Longerich</surname><given-names>T</given-names></name>, <name><surname>Mueller</surname><given-names>M</given-names></name>, <name><surname>Breuhahn</surname><given-names>K</given-names></name>, <name><surname>Schirmacher</surname><given-names>P</given-names></name>, <name><surname>Benner</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Oncogenetic tree modeling of human hepatocarcinogenesis</article-title>. <source>International Journal of Cancer</source>
<volume>130</volume>: <fpage>575</fpage>–<lpage>583</lpage>.<pub-id pub-id-type="pmid">21400513</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Pathare1">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Pathare</surname><given-names>S</given-names></name>, <name><surname>Schäffer</surname><given-names>A</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Mahimkar</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Construction of oncogenetic tree models reveals multiple pathways of oral cancer progression</article-title>. <source>International journal of cancer</source>
<volume>124</volume>: <fpage>2864</fpage>–<lpage>2871</lpage>.<pub-id pub-id-type="pmid">19267402</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Knutsen1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Knutsen</surname><given-names>T</given-names></name>, <name><surname>Gobu</surname><given-names>V</given-names></name>, <name><surname>Knaus</surname><given-names>R</given-names></name>, <name><surname>Padilla-Nash</surname><given-names>H</given-names></name>, <name><surname>Augustus</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>The interactive online sky/m-fish &amp; cgh database and the entrez cancer chromosomes search database: Linkage of chromosomal aberrations with the genome sequence</article-title>. <source>Genes, Chromosomes and Cancer</source>
<volume>44</volume>: <fpage>52</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">15934046</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Xue1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Xue</surname><given-names>W</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>A cluster of cooperating tumor-suppressor gene candidates in chromosomal deletions</article-title>. <source>Proceedings of the National Academy of Sciences</source>
<volume>109</volume>: <fpage>8212</fpage>–<lpage>8217</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Efron2">
      <label>40</label>
      <mixed-citation publication-type="other">Efron B (1982) The jackknife, the bootstrap and other resampling plans, volume 38. SIAM.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Szabo2">
      <label>41</label>
      <mixed-citation publication-type="other">Szabo A, Boucher KM (2008) Oncogenetic trees. Handbook of Cancer Models with Applications to Cancer Screening, Cancer Treatment and Risk Assessment World Scientific.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Piazza1">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Piazza</surname><given-names>R</given-names></name>, <name><surname>Valletta</surname><given-names>S</given-names></name>, <name><surname>Winkelmann</surname><given-names>N</given-names></name>, <name><surname>Redaelli</surname><given-names>S</given-names></name>, <name><surname>Spinelli</surname><given-names>R</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Recurrent setbp1 mutations in atypical chronic myeloid leukemia</article-title>. <source>Nature Genetics</source>
<volume>45</volume>: <fpage>18</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">23222956</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-OldeLoohuis1">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Olde Loohuis</surname><given-names>L</given-names></name>, <name><surname>Witzel</surname><given-names>A</given-names></name>, <name><surname>Mishra</surname><given-names>B</given-names></name> (<year>2014</year>) <article-title>Cancer hybrid automata: Model, beliefs &amp; therapy</article-title>. <source>Information and Computation</source>
<volume>236</volume>: <fpage>68</fpage>–<lpage>86</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0108358-Gerstung2">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Gerstung</surname><given-names>M</given-names></name>, <name><surname>Eriksson</surname><given-names>N</given-names></name>, <name><surname>Lin</surname><given-names>J</given-names></name>, <name><surname>Vogelstein</surname><given-names>B</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name> (<year>2011</year>) <article-title>The temporal order of genetic and pathway alterations in tumorigenesis</article-title>. <source>PloS one</source>
<volume>6</volume>: <fpage>e27136</fpage>.<pub-id pub-id-type="pmid">22069497</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0108358-Efron3">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Efron</surname><given-names>B</given-names></name>, <name><surname>Morris</surname><given-names>C</given-names></name> (<year>1973</year>) <article-title>Stein's estimation rule and its competitors–an empirical bayes approach</article-title>. <source>Journal of the American Statistical Association</source>
<volume>68</volume>: <fpage>117</fpage>–<lpage>130</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
