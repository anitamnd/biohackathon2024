<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870649</article-id>
    <article-id pub-id-type="pmid">28881972</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx237</article-id>
    <article-id pub-id-type="publisher-id">btx237</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2017: The 25th Annual Conference Intelligent Systems for Molecular Biology Held Jointly with the 16th Annual European Conference on Computational Biology, Prague, Czech Republic, July 21–25, 2017</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Hitseq</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Abundance estimation and differential testing on strain level in metagenomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fischer</surname>
          <given-names>Martina</given-names>
        </name>
        <xref ref-type="aff" rid="btx237-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strauch</surname>
          <given-names>Benjamin</given-names>
        </name>
        <xref ref-type="aff" rid="btx237-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Renard</surname>
          <given-names>Bernhard Y</given-names>
        </name>
        <xref ref-type="corresp" rid="btx237-cor1"/>
        <!--<email>renardB@rki.de</email>-->
        <xref ref-type="aff" rid="btx237-aff1"/>
      </contrib>
    </contrib-group>
    <aff id="btx237-aff1">Bioinformatics Unit (MF1), Department for Methods Development and Research Infrastructure, Robert Koch Institute, Berlin, Germany</aff>
    <author-notes>
      <corresp id="btx237-cor1">To whom correspondence should be addressed. Email: <email>renardB@rki.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-07-12">
      <day>12</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>14</issue>
    <fpage>i124</fpage>
    <lpage>i132</lpage>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx237.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Current metagenomics approaches allow analyzing the composition of microbial communities at high resolution. Important changes to the composition are known to even occur on strain level and to go hand in hand with changes in disease or ecological state. However, specific challenges arise for strain level analysis due to highly similar genome sequences present. Only a limited number of tools approach taxa abundance estimation beyond species level and there is a strong need for dedicated tools for strain resolution and differential abundance testing.</p>
      </sec>
      <sec id="SA2">
        <title>Methods</title>
        <p>We present <italic>DiTASiC</italic> (<bold>Di</bold>fferential <bold>T</bold>axa <bold>A</bold>bundance including <bold>Si</bold>milarity <bold>C</bold>orrection) as a novel approach for quantification and differential assessment of individual taxa in metagenomics samples. We introduce a generalized linear model for the resolution of shared read counts which cause a significant bias on strain level. Further, we capture abundance estimation uncertainties, which play a crucial role in differential abundance analysis. A novel statistical framework is built, which integrates the abundance variance and infers abundance distributions for differential testing sensitive to strain level.</p>
      </sec>
      <sec id="SA3">
        <title>Results</title>
        <p>As a result, we obtain highly accurate abundance estimates down to sub-strain level and enable fine-grained resolution of strain clusters. We demonstrate the relevance of read ambiguity resolution and integration of abundance uncertainties for differential analysis. Accurate detections of even small changes are achieved and false-positives are significantly reduced. Superior performance is shown on latest benchmark sets of various complexities and in comparison to existing methods.</p>
      </sec>
      <sec id="SA4">
        <title>Availability and Implementation</title>
        <p>DiTASiC code is freely available from <ext-link ext-link-type="uri" xlink:href="https://rki_bioinformatics.gitlab.io/ditasic">https://rki_bioinformatics.gitlab.io/ditasic</ext-link>.</p>
      </sec>
      <sec id="SA5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Deutsche Forschungsgemeinschaft</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001659</named-content>
        </funding-source>
        <award-id>RE3474/2-1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Rapid advances in next generation sequencing (NGS) technologies have revolutionized the field of metagenomics (<xref rid="btx237-B29" ref-type="bibr">Oulas <italic>et al.</italic>, 2015</xref>; <xref rid="btx237-B47" ref-type="bibr">Wooley <italic>et al.</italic>, 2010</xref>). Metagenomics enables the study of complex communities in environmental or human samples by direct analysis of whole shotgun metagenomes, without prior need for cultivation. Among others, two major goals in metagenomics profiling studies are pursued. One is to unravel the taxonomic composition of the community in a given sample, the second concerns the abundance change of taxa between different metagenomes (<xref rid="btx237-B27" ref-type="bibr">Neelakanta and Sultana, 2013</xref>).</p>
    <p>Especially, differences occurring on strain level in microbiomes can be of high relevance for disease and health state (<xref rid="btx237-B25" ref-type="bibr">Nawy, 2015</xref>). Investigations on strain level have been proven to be crucial for the understanding of evolutionary processes, adaption, pathogenicity, drug resistance and transmission (<xref rid="btx237-B14" ref-type="bibr">Lieberman <italic>et al.</italic>, 2014</xref>; <xref rid="btx237-B36" ref-type="bibr">Rosen <italic>et al.</italic>, 2015</xref>; <xref rid="btx237-B42" ref-type="bibr">Shapiro <italic>et al.</italic>, 2012</xref>; <xref rid="btx237-B43" ref-type="bibr">Snitkin <italic>et al.</italic>, 2011</xref>). However, although importance of resolution on strain level is acknowledged, there are still only a limited number of tools focusing on accurate profiling beyond species level (<xref rid="btx237-B39" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>).</p>
    <p>Altogether, in this context, three main concepts are relevant: strain identification, abundance estimation and differential abundance assessment. Our objective in this work is to address all these steps by specifically focusing on strain level resolution and its arising challenges. In particular for differential abundance evaluation on the strain level, there is a need for novel tools. Here, we use the term strain level referring to the highest possible resolution available and always work on the exact genome level.</p>
    <p>Many concepts have been pioneered for taxa identification and quantification, apart from assembly and binning methods, diverse metagenomics profiling tools have specialized on this task (<xref rid="btx237-B15" ref-type="bibr">Lindgreen <italic>et al.</italic>, 2016</xref>; <xref rid="btx237-B39" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>). In practice, these concern the assignment of the sequenced reads to taxa and corresponding inference of taxa abundance. Read assignment can be conducted either by the full alignment of reads to genome sequences or by using pseudo-alignment approaches (<xref rid="btx237-B46" ref-type="bibr">Wood and Salzberg, 2014</xref>). The latter is sufficient for many metagenomics quantification studies due to the fact that only the assignment of reads is required and not exact alignments. Another variant is to rely on marker genes instead of complete genome sequences (<xref rid="btx237-B41" ref-type="bibr">Segata <italic>et al.</italic>, 2012</xref>; <xref rid="btx237-B38" ref-type="bibr">Scholz <italic>et al.</italic>, 2016</xref>; <xref rid="btx237-B20" ref-type="bibr">Luo <italic>et al.</italic>, 2015</xref>); however, a general drawback is the requirement of high-sequencing coverage contrasting typical metagenomics scenarios of many low abundant taxa (<xref rid="btx237-B13" ref-type="bibr">Li, 2015</xref>). One of the first and popular reference-based tools for read assignment in metagenomics was MEGAN (<xref rid="btx237-B8" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>), which assigns the reads to the lowest common ancestor in the taxonomic tree at which a unique alignment is achieved. However, this approach limits MEGAN to the identification and quantification of only higher taxonomic levels. A main characteristic on strain level is the presence of highly similar reference sequences, causing many reads to match to multiple genomes equally. A further common practice is to assign multiply mapped reads heuristically to reference genomes according to uniquely mapped read proportions (<xref rid="btx237-B17" ref-type="bibr">Liu <italic>et al.</italic>, 2017</xref>; <xref rid="btx237-B26" ref-type="bibr">Nayfach <italic>et al.</italic>, 2016</xref>). Yet, this can easily result in biased abundance estimates due to reference sequence similarities as observed e.g. by <xref rid="btx237-B17" ref-type="bibr">Liu <italic>et al.</italic>, 2017</xref>. GRAMMy (<xref rid="btx237-B48" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>) and GASiC (<xref rid="btx237-B16" ref-type="bibr">Lindner and Renard, 2013</xref>) were the first tools to include reference genome similarities in a model for the resolution of ambiguously mapped reads. Since being based on read alignments, these methods can encounter computational limits in large sample sizes. A new era evolved by utilizing fast k-mer approaches, significantly accelerating read assignments, with Kraken being a popular representative (<xref rid="btx237-B46" ref-type="bibr">Wood and Salzberg, 2014</xref>), but showing reduced resolution power on strain level (<xref rid="btx237-B37" ref-type="bibr">Schaeffer <italic>et al.</italic>, 2017</xref>). As a consequence, the importance of combining fast mapping approaches with methods for read ambiguity resolution was recognized. This was likewise applied in the field of RNA-Seq, resulting in the development of kallisto (<xref rid="btx237-B3" ref-type="bibr">Bray <italic>et al.</italic>, 2016</xref>), which promises to also support metagenomics abundance analysis (<xref rid="btx237-B37" ref-type="bibr">Schaeffer <italic>et al.</italic>, 2017</xref>). kallisto consists of two parts, a new fast pseudo-aligner based on k-mer hashing and an expectation–maximization (EM) algorithm on equivalence classes, which carries out the statistical resolution of read ambiguities.</p>
    <p>In this work, we present DiTASiC (Differential Taxa Abundance including Similarity Correction) which relies on pseudo-alignments for mapping and is built on a novel generalized linear model (GLM) framework for read ambiguity resolution. Hereby, we significantly improve on our previous development in this field, GASiC. Our new model framework is developed to adapt more precisely to the characteristics of absolute mapping count data observed for taxa. Moreover, our method improves on existing pure abundance profiling strategies by including additional error terms in the model and capturing abundance estimation uncertainties.</p>
    <p>The integration of variance of abundance estimates plays a crucial role for the differential abundance analysis. This variance reflects the uncertainty in the resolution of read mapping ambiguities in the presence of similar reference sequences. Hence, it is of particular importance on strain level to integrate this variance to enable accurate detections of differential or non-differential abundance of a taxon in co-existence of similar strains, most notably in the case of smaller changes.</p>
    <p>Most approaches developed for identification of differential abundance in the field of comparative metagenomics focus exclusively on experimental sources of variance, namely on sample variance relevant within technical and biological replicates. A large variety of tools is available (<xref rid="btx237-B9" ref-type="bibr">Jonsson <italic>et al.</italic>, 2016</xref>); amongst others, software packages implementing diverse parametric and non-parametric statistical standard tests (<xref rid="btx237-B10" ref-type="bibr">Karlsson <italic>et al.</italic>, 2013</xref>; <xref rid="btx237-B31" ref-type="bibr">Parks <italic>et al.</italic>, 2014</xref>; <xref rid="btx237-B32" ref-type="bibr">Parks and Beiko, 2010</xref>; <xref rid="btx237-B40" ref-type="bibr">Segata <italic>et al.</italic>, 2011</xref>; <xref rid="btx237-B45" ref-type="bibr">White <italic>et al.</italic>, 2009</xref>). Another group comprises zero-inflated models either combined with Gaussian mixture distribution (<xref rid="btx237-B33" ref-type="bibr">Paulson <italic>et al.</italic>, 2013</xref>), log-normal distribution (<xref rid="btx237-B44" ref-type="bibr">Sohn <italic>et al.</italic>, 2015</xref>), or beta-regression (<xref rid="btx237-B34" ref-type="bibr">Peng <italic>et al.</italic>, 2015</xref>), concentrating on the potential sparsity in count data. Further, popular methods from RNA-Seq analysis such as edgeR (<xref rid="btx237-B35" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>), DESeq2 (<xref rid="btx237-B18" ref-type="bibr">Love <italic>et al.</italic>, 2014</xref>) and voom (<xref rid="btx237-B12" ref-type="bibr">Law <italic>et al.</italic>, 2014</xref>) are also commonly applied in comparative metagenomics. Without doubt, the integration of experimental variance is of high necessity when comparing groups of samples. However, here, we want to emphasize and raise awareness for variance in abundance estimates and its impact on differential abundance analysis on strain level.</p>
    <p>Further it should be noted that many methods treat the differential assessment of taxa and genes equivalently. However, assumptions such as the majority of features will show non-differential abundance, which has widely been proven for gene expression, are not necessarily valid for taxa abundance in a sample. Antibiotics treatment and other life influential factors have shown rapid changes of microbial compositions in human samples (<xref rid="btx237-B4" ref-type="bibr">David <italic>et al.</italic>, 2014</xref>) and similar scenarios are found in ecological environments (<xref rid="btx237-B6" ref-type="bibr">Gibbons and Gilbert, 2015</xref>). Thus, commonly used assumptions cannot be easily transferred to composition change.</p>
    <p>In summary, we present DiTASiC, which addresses abundance estimation as well as differential abundance of taxa specifically focusing on strain level. A new GLM framework is proposed for resolution of read mapping ambiguities and allows inference of highly accurate taxa abundance estimates. Second, a statistical framework, which integrates abundance estimate uncertainties, is built for differential abundance testing. Here, no prior assumptions on overall composition change are required. A resulting list of tested taxa is reported with estimated abundances, fold-changes and <italic>P</italic>-values to infer significance. The performance of DiTASiC is evaluated on different metagenomics data sets from four different data sources and in comparison to existing tools.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>DiTASiC is designed as a comprehensive approach for abundance estimation and differential abundance assessment of individual taxa. Thereby, the main focus is on distinguishing on the strain level with highly similar sequences and its corresponding challenges. The steps of the DiTASiC workflow are illustrated in <xref ref-type="fig" rid="btx237-F1">Figure 1</xref>, it consists of three main parts: mapping, abundance estimation and differential abundance assessment.</p>
    <fig id="btx237-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Workflow of DiTASiC. It consists of three main parts: (i) mapping, (ii) taxa abundance estimation and (iii) differential abundance assessment. (i) We rely on prior pre-filtering of species by external profiling tools such as Kraken or Mash. Reads are mapped to the given reference genome sequences and the number of matching reads per reference are counted (mapping abundance). A similarity matrix reflecting the genome similarities is constructed. (ii) Subsequently, a GLM is built for resolution of read count ambiguities, resulting in corrected abundance estimates along with standard errors. (iii) For the comparison of metagenomes, abundances are formulated as distributions and their divergence reflects differential events. A final list of tested taxa with fold change and adjusted <italic>P</italic>-values is reported</p>
      </caption>
      <graphic xlink:href="btx237f1"/>
    </fig>
    <p>In the first two parts we built on some of the core ideas of our previously published tool GASiC (<xref rid="btx237-B16" ref-type="bibr">Lindner and Renard, 2013</xref>), while strongly improving on abundance quantification and introducing new methodology to address the critical aspects of variance of abundance estimates and differential abundance.</p>
    <p>In a metagenomics sample measured by NGS technologies we face millions to billions of reads which are derived from diverse taxa. DiTASiC relies on a pre-filtering of species by fast profiling tools such as Kraken (<xref rid="btx237-B46" ref-type="bibr">Wood and Salzberg, 2014</xref>), CLARK (<xref rid="btx237-B30" ref-type="bibr">Ounit <italic>et al.</italic>, 2015</xref>), Kaiju (<xref rid="btx237-B24" ref-type="bibr">Menzel <italic>et al.</italic>, 2016</xref>), or by using Mash (<xref rid="btx237-B28" ref-type="bibr">Ondov <italic>et al.</italic>, 2016</xref>), a genome distance calculator, to reduce the number of potential reference genomes and keep the main focus on species expected in the data. Here, we specifically aim at revealing the picture on the highest available strain levels. In the first <bold>mapping</bold> step, all reads are assigned to the given references as a first attempt to decipher their potential origin. The number of hits per reference genome is counted. We refer to it as <italic>mapping abundance</italic> of a taxon. In the next step of <bold>abundance estimation</bold>, a new generalized linear model (GLM) is introduced for the resolution of <italic>shared</italic> read counts, which are crucial on strain level. As a result, more accurate abundance estimates are obtained for the different strains along with standard errors for abundance uncertainty. In the last section, the focus is on the comparison of whole metagenomics samples and the assessment of <bold>differential abundance</bold> of taxa. Thereby, we concentrate on a method to integrate the variance of abundance estimates. Abundances are transformed into distributions, divergence of distributions is used to infer differential events and corresponding <italic>P</italic>-values are calculated.</p>
    <p>The details of the three DiTASiC parts are explained in the following sections. The following notation is applied: different metagenomics samples are denoted as D = {<italic>D<sub>k</sub>, k = 1,…, K</italic>}, each containing <italic>N =</italic> {<italic>N<sub>k</sub>, k= 1,…, K</italic>} total input reads. A set of taxa <italic>S =</italic> {<italic>S<sub>i</sub>, i= 1,…, M</italic>} with known reference sequences is considered. Thereby, <italic>S<sub>i</sub></italic> is synonymously used for both the taxa itself as well as its exact reference genome. Mapping and abundance estimation are addressed for each data set separately, while the last step of differential abundance estimation is defined on a pair of samples from D.</p>
    <sec>
      <title>2.1 Mapping</title>
      <p>To identify their origin, the assignment of reads is conducted by a <italic>competitive</italic> mapping approach, which means all selected reference genome sequences <italic>S</italic> are simultaneously offered to all reads of a sample <italic>D</italic> ϵ D for mapping. Particularly on strain level, reference sequences exhibit high sequence similarities, thus some reads are expected to match to different genome sequences equally well. These reads are defined as <italic>shared reads</italic> and we account for all their multiple hits. However, the exact matching position in a reference genome <italic>S<sub>i</sub></italic> is not of importance and several position hits of one read on the same reference <italic>S<sub>i</sub></italic> are counted as one. For the mapping itself, a pseudo-alignment approach provided as part of the kallisto implementation (<xref rid="btx237-B3" ref-type="bibr">Bray <italic>et al.</italic>, 2016</xref>) is applied. As no exact alignments are required for our purpose, a pseudo-aligner is sufficient and proves to be much faster and accurate using a fast kmer-based approach. Here, we gain significant improvements over our previously published tool GASiC, which relied on individual reference alignments by Bowtie 2 (<xref rid="btx237-B11" ref-type="bibr">Langmead and Salzberg, 2012</xref>).</p>
      <p>Altogether, we extract and count the number of read hits each reference genome receives and refer to it as <italic>mapping abundance c<sub>i</sub></italic> of taxon <italic>S<sub>i</sub></italic>. In case the data set <italic>D</italic> consists of mainly dissimilar references and is dominated by clearly unique mappings, the observed mapping abundances <italic>c<sub>i</sub></italic> may already closely reflect the underlying true abundances of the taxa. However, if many similar references are present, which is a common scenario on strain level, a large bias is present due to multiple hits of shared reads. The sum of the mapping abundances of all taxa then drastically exceeds the number of input reads.</p>
    </sec>
    <sec>
      <title>2.2 Abundance estimation</title>
      <p>Following the idea introduced in GASiC, we rely on a simulation-based representation of reference genome similarities to resolve the effect of shared reads. A similarity matrix is constructed, which encodes the proportion of reads which are expected to be shared among all pairwise combinations of reference sequences considered. Reads are simulated using Mason (<xref rid="btx237-B7" ref-type="bibr">Holtgrewe, 2010</xref>) based on each reference sequence, and are subsequently mapped to all references following the same competitive mapping setup as applied to the reads of <italic>D</italic> in the step before. The key element is to imitate sequencing, read, and mapping characteristics as good as possible to reproduce the source of ambiguities. Parameters such as read length and mismatch probability are crucial for the simulation of reads, and are inferred from the raw reads of <italic>D</italic>. The square matrix <italic>A</italic> = <italic>(a<sub>ij</sub>), i,j = 1,…,M</italic>, is computed column-wise for each reference, with <italic>a<sub>ij</sub></italic> referring to the count of reads simulated from reference <italic>j</italic> which map to reference <italic>i</italic>. Next, the matrix is normalized column-wise by the read count <italic>a<sub>jj</sub></italic>, the number of simulated reads which are assigned back to their reference of origin. Thus, the matrix <italic>A =  (a<sub>ij</sub>/a<sub>jj</sub>), i,j = 1,…,M</italic>, holds values between zero and one.</p>
      <p>Replacing the classic linear model of GASiC, we formulate a new GLM with the vector of absolute mapping abundances <italic>c</italic> and similarity matrix <italic>A</italic> to correct for the shared read biases. Aiming to recover the true, but unknown, abundances <italic>r</italic> of the taxa:
<disp-formula id="E1"><mml:math id="EQ1"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>·</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:math></disp-formula>
with <italic>A = (a<sub>ij</sub>), i,j= 1,…,M, c = (c<sub>1</sub>, c<sub>2</sub>, …, c<sub>M</sub>)</italic><sup>T</sup><italic>, r = (r<sub>1</sub>, r<sub>2</sub>, …, r<sub>M</sub>)</italic><sup>T</sup> with non-negativity constraint <italic>r ≥ 0</italic>, and error term ɛ.</p>
      <p>The observed mapping count <italic>c<sub>i</sub></italic> of taxon <italic>i</italic> corresponds to a summed mixture of the underlying true abundance <italic>r<sub>i</sub></italic> of taxon <italic>i</italic> and a proportion of shared read counts <italic>r<sub>j</sub></italic> due to the other references:
<disp-formula id="IE1"><mml:math id="IEQ1"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>,</mml:mo><mml:mtext>with taxon</mml:mtext><mml:mi>i</mml:mi><mml:mtext>and taxa</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:math></disp-formula>
The GLM is defined by an identity link function as a linear relation of components holds to explain the observed mapping counts. However, in this setting of discrete counts the error ɛ is defined to follow a Poisson distribution. We expect and observed no overdispersion in the abundance estimates within a sample after ambiguity correction by the model (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). This is in contrast to measurements of replicate samples, which may display overdispersion and motivate a negative-binomial assumption (<xref rid="btx237-B1" ref-type="bibr">Anders and Huber, 2010</xref>). The GLM is internally solved by an ‘iteratively reweighted least squares’ to find the maximum likelihood estimates referring to the <italic>‘true’ abundance estimates r<sub>i</sub></italic> for each taxon <italic>i</italic>. Along with the abundance estimates, standard errors are computed which report the range of accuracy and reliability of the abundance estimates. Further, <italic>P</italic>-values are given for each taxa estimate as a measure of significance.</p>
      <p>In case of high uncertainty about the presence of a crucial amount of taxa within the selected set of references, the application of an implemented filtering is possible. Thereby, <italic>P</italic>-values above a set threshold, commonly a value of 0.05, and estimates below a minimum number of assigned reads are used as indicators for false-positive estimates. The filtering step helps to numerically stabilize the equation system in case of many absent taxa and a re-optimization step is subsequently conducted.</p>
    </sec>
    <sec>
      <title>2.3 Differential abundance</title>
      <p>In this section, the focus is on comparing metagenomics samples. The objective is to identify which taxa significantly change their abundance from one metagenome sample to another as well as which hold a constant abundance. For the differential abundance assessment of similar strains the integration of the variance of their abundance estimates is crucial. Hence, in place of directly comparing abundance point estimates of taxa between samples, we make use of the estimates as well as their standard errors.</p>
      <p>First, the comparison of different samples requires accounting for potentially different numbers of total input reads <italic>N</italic>. The number of input reads has a significant impact on the computed abundances <italic>r</italic> and standard error estimates. A linear dependence is clearly noticeable (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>) and is in agreement with theoretical derivations of the GLM framework. The abundance count estimate <italic>r</italic> scales linear with the number of reads whereas the standard error scales quadratic. This means the accuracy of abundance estimates improves with increased number of input reads as expected. Altogether, a normalization factor is required and a factor of <italic>N<sub>x</sub>/N<sub>y</sub></italic> is correspondingly applied to samples <italic>D<sub>x</sub></italic> and <italic>D<sub>y</sub></italic> to achieve a comparable base between samples.</p>
      <p>In the next step, we integrate abundance estimates and corresponding standard errors to infer an abundance distribution for each taxon in each sample. Here, it is assumed that the unknown true abundance count of a taxon underlies a Poisson distribution. The potential bias due to falsely assigned reads to taxa, after correction for read ambiguities by the GLM model, is not expected to exceed the variance of a Poisson distribution. But, an analytical approach is not feasible here, as the exact distribution is described in practice by a mixture of Poisson distributions. However, an empirical approach can be pursued, which is realized by a two-step sampling process: In the first step, we define intervals with abundance estimates <italic>r<sub>i</sub></italic> ± <italic>their standard errors</italic> as boundaries for each listed taxon. We use a scale unit of one standard error, as this reflects the uncertainty interval which is expected to contain the abundance estimate. Subsequently, potential abundance point estimates are uniformly sampled from this interval. Concurrently each of these sampled values refers to a λ value of a Poisson distribution. In the second step, for each taxon and each potential λ of it, 500 values in a default setup are drawn from the corresponding defined Poisson distribution with parameter λ. This creates one empirical distribution based on a specific λ for the taxon. Pooling all empirical distributions, created by all the different λ which are assigned to the taxon, results in an overall empirical distribution comprising 50 000 Poisson draws by default setup. We refer to it as <italic>empirical abundance distribution</italic> of a taxon.</p>
      <p>In order to assess whether taxa show differential abundance between two samples, their abundance distributions need to be compared. As we rely on empirical distributions here, no analytical form of standard differential testing is applicable. Yet, we can transfer the assessment of differential abundance to the question to which extent the corresponding abundance distributions overlap. Clearly separated distributions refer to a significant abundance change, while an increasing overlap points to smaller or no significant difference. Measuring the separation of the distributions is implemented by randomly drawing pairs of values from either distribution. The difference within each pair is computed and yields an overall <italic>distribution of differences</italic> as a result. Thereby, the location of the zero value related to the distribution of differences is meaningful. A zero value moving towards the center of the distribution reflects a higher previous overlap and corresponds to a less significant abundance change. An empirical <italic>P</italic>-value is correspondingly inferred by determining the quantile of the zero value within the distribution.</p>
      <p>In case a taxon is only detected within one sample, while absent in the other, the single abundance distribution of the taxon is tested against a user-defined threshold corresponding to a minimum read count. The latter test yields the significance of taxa presence in this one sample.</p>
      <p>Generally, <italic>P</italic>-values are calculated individually for all taxa considered in the samples of comparison, either to assess differential abundance of taxa present in both samples or to infer new appearance of taxa in only one sample. Thus, <italic>P</italic>-values need to be adjusted for multiplicity, which is performed by the method of Benjamini-Hochberg (<xref rid="btx237-B2" ref-type="bibr">Benjamini and Hochberg, 1995</xref>). A final report is provided listing all taxa tested for differential abundance along with normalized abundance estimates for each sample, log2 fold changes, and adjusted <italic>P</italic>-values.</p>
    </sec>
    <sec>
      <title>2.4 Implementation</title>
      <p>DiTASiC is implemented in Python3 and R (version ≥ 3.3.1), and is available from <ext-link ext-link-type="uri" xlink:href="https://rki_bioinformatics.gitlab.io/ditasic">https://rki_bioinformatics.gitlab.io/ditasic</ext-link>. Further, a linked webpage and user manual provides easy guidance through the three main commands. DiTASiC is based on a flexible design and allows the integration of mapping algorithms and read simulators of choice. Our implementation uses the current state of the art pseudo-alignment algorithm provided within the kallisto framework (<xref rid="btx237-B3" ref-type="bibr">Bray <italic>et al.</italic>, 2016</xref>), which can be individually called by the command <italic>kallisto pseudo</italic>. As a prerequisite, an overall index is built on selected reference sequences. Using the generated tsv and ec file formats, we extract the mapping counts of the contigs and merge them according to genomes. This allows circumventing the use of large SAM files. Further, read simulators need to be optimally adapted to capture the read characteristics. Here, the Mason simulator (<xref rid="btx237-B7" ref-type="bibr">Holtgrewe, 2010</xref>) serves as default.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experimental setup</title>
    <p>We tested DiTASiC and existing approaches on a variety of data sets from four different sources (<xref rid="btx237-T1" ref-type="table">Table 1</xref>), challenging the tools by number of taxa, total number of input reads, read characteristics, abundance complexity and degree of reference similarities.
<table-wrap id="btx237-T1" orientation="portrait" position="float"><label>Table 1</label><caption><p>Characteristics of the four data sources: CAMI, FAMeS, Illumina 100 data (i100) and the simulation setups (Sim (1), (2), (3))</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Source</th><th rowspan="1" colspan="1">CAMI</th><th rowspan="1" colspan="1">FAMeS</th><th rowspan="1" colspan="1">Sim (1)</th><th rowspan="1" colspan="1">Sim (2)</th><th rowspan="1" colspan="1">Sim (3)</th><th rowspan="1" colspan="1">i100</th></tr><tr><th rowspan="1" colspan="1">Samples</th><th rowspan="1" colspan="1">Set 1-2</th><th rowspan="1" colspan="1">LC, MC, HC</th><th rowspan="1" colspan="1">Set 1-3</th><th rowspan="1" colspan="1">Set 4-9</th><th rowspan="1" colspan="1">Set 10-11</th><th rowspan="1" colspan="1"/></tr></thead><tbody><tr><td rowspan="1" colspan="1">References</td><td rowspan="1" colspan="1">225</td><td rowspan="1" colspan="1">122</td><td rowspan="1" colspan="1">35</td><td rowspan="1" colspan="1">35</td><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">100</td></tr><tr><td rowspan="1" colspan="1">Genera</td><td rowspan="1" colspan="1">128</td><td rowspan="1" colspan="1">81</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">63</td></tr><tr><td rowspan="1" colspan="1">Species</td><td rowspan="1" colspan="1">199</td><td rowspan="1" colspan="1">108</td><td rowspan="1" colspan="1">22</td><td rowspan="1" colspan="1">22</td><td rowspan="1" colspan="1">26</td><td rowspan="1" colspan="1">85</td></tr><tr><td rowspan="1" colspan="1">Reads (M)</td><td rowspan="1" colspan="1">∼150</td><td rowspan="1" colspan="1">∼1.0</td><td rowspan="1" colspan="1">0.75<sup>a</sup></td><td rowspan="1" colspan="1">0.75<sup>a</sup></td><td rowspan="1" colspan="1">0.75<sup>a</sup></td><td rowspan="1" colspan="1">53.3</td></tr><tr><td rowspan="1" colspan="1">Length (bp)</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">110</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">75</td></tr><tr><td rowspan="1" colspan="1">Abundance range</td><td rowspan="1" colspan="1">0.0009–8%</td><td rowspan="1" colspan="1">2–20%</td><td rowspan="1" colspan="1">1–30%</td><td rowspan="1" colspan="1">0.1–15%</td><td rowspan="1" colspan="1">0.1–2%</td><td rowspan="1" colspan="1">0.8–2.2%</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Note</italic>: Each reference set is defined by the union of references of the underlying samples. All read profiles follow Illumina characteristics (<sup>a</sup>reads are simulated by Mason).</p></fn></table-wrap-foot></table-wrap></p>
    <p>A comprehensive simulation setup is established to enable abundance estimation as well as differential evaluation on an exact ground truth at which taxa proportions are known. In total, we consider 11 different simulation sets characterized by many strain clusters (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>-3), and distinguish between three groups: Group (1) serves to evaluate the abundance performance with different proportions of absent taxa, group (2) defined by all 35 taxa ensures an unbiased differential abundance evaluation in pairwise comparisons and group (3) focuses on the resolution of large and highly similar strain clusters as well as on the impact of missing strains. Further, we relied on the Illumina based FAMeS data set of <xref rid="btx237-B49" ref-type="bibr">Pignatelli and Moya (2011)</xref>, evolved from the original set by <xref rid="btx237-B21" ref-type="bibr">Mavromatis <italic>et al.</italic> (2007)</xref>, which covers low (LC), medium (MC) and high complexity (HC) metagenomics profiles (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). Additionally, we tested the popular Illumina 100 data sample (<xref rid="btx237-B23" ref-type="bibr">Mende <italic>et al.</italic>, 2012</xref>), which serves as benchmark set in the latest relevant studies (<xref rid="btx237-B19" ref-type="bibr">Lu <italic>et al.</italic>, 2017</xref>; <xref rid="btx237-B37" ref-type="bibr">Schaeffer <italic>et al.</italic>, 2017</xref>). Last, we used two benchmark data sets of medium complexity from a current comparative metagenomics challenge, CAMI (<xref rid="btx237-B39" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>). We further extended the CAMI sets by simulated spike-in data, adding 30 new strains of genera already present in the original set and 20 million reads per sample, to create an additional ground truth for differential assessment. Further details on the data sets and parameter settings are found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>. In all presented data sets, ground truth of relative abundances of taxa is available. Comparing the samples, a ground truth to classify differentially or non-differentially abundant taxa is given for the simulation and CAMI study, while fold-change accuracy can be assessed in all data sources.</p>
  </sec>
  <sec>
    <title>4 Results</title>
    <p>In the following sections, we demonstrate the performance of DiTASiC on the presented data sets in comparison to existing tools. We separately investigate three aspects: (i) abundance estimation, (ii) absent and missing taxa and (iii) differential abundance. Evaluations focus on the accuracy of estimates of relative taxa abundance as well as fold change, and on sensitivity and specificity concerning detection of differentially abundant taxa.</p>
    <sec>
      <title>4.1 Abundance estimation</title>
      <p>In this first part, we address the quantification of taxa in a given metagenomics sample, aiming for the highest taxonomic level. We highlight the strength of our proposed GLM model for the resolution of shared read counts and subsequent inference of corrected abundance estimates for taxa considered.</p>
      <p>We compare to our previously published tool GASiC (<xref rid="btx237-B16" ref-type="bibr">Lindner and Renard, 2013</xref>), which relies on individual reference alignments and a non-negative LASSO modelling approach for abundance estimation, and present significant improvements. Further we test against the most recently published tool for RNA-Seq analysis, kallisto (<xref rid="btx237-B3" ref-type="bibr">Bray <italic>et al.</italic>, 2016</xref>; <xref rid="btx237-B37" ref-type="bibr">Schaeffer <italic>et al.</italic>, 2017</xref>), which has also been shown to perform superior to other existing tools in the application to metagenomics. We also evaluate on the same benchmark data to allow further comparison of tools (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Although we compare against the full version of kallisto, it is important to note, that we use and integrate the pseudo-aligner of kallisto for mapping purpose, but not kallisto’s quantification and modelling framework. Yet our main focus in this work is the modeling and resolution of arising read ambiguities due to highly similar genome sequences considered. Hence, the comparison of DiTASiC to kallisto in this section refers to a comparison of our GLM model to the statistical EM framework of kallisto.</p>
      <p>All tools are applied to each sample individually, in total we consider and evaluate 17 different samples from four data sources.</p>
      <p>The output of all three tools are absolute read counts assigned to each taxa in the data set considered. Normalization is applied by dividing all absolute taxa counts by the total number of input reads of the corresponding sample. We receive an estimation of a quantitative taxa composition of a sample as a result.</p>
      <p>All data sets described here provide a ground truth of taxa abundance proportions, enabling us to assess the difference between truth and estimate. As an error measure we apply the <italic>SSE</italic> (Sum of Squared Errors) to evaluate the accuracy of the given estimates, the SSE also penalizes abundance estimates obtained for absent taxa.</p>
      <p>The resulting error measures of abundance estimation by DiTASiC, GASiC and kallisto, according to all different data sets are reported in <xref rid="btx237-T2" ref-type="table">Table 2</xref>. Overall, DiTASiC strongly reduces the error on all data sets compared with GASiC by several orders of magnitude. Further, DiTASiC shows either comparable and in many cases improved performance to kallisto. Generally, reported error values are dependent on data size and prevailing genome similarities. However, the presented values refer to a remarkably high accuracy of abundance estimates overall. Smallest divergences of estimates from the ground truth are found for the FAMeS data sets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S5</xref>). This is expected due to less pronounced reference similarities within the data and moderate median abundance proportions, meaning less challenge for the resolution models. The CAMI data do pose a much greater challenge, considering 255 taxa for quantification with several strain clusters and some extremely small relative abundance values. Yet, highly accurate taxa estimates, apart from few small outliers, are obtained by DiTASiC; notably also for very low relative abundances below 0.01% (see also <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>). CAMI data were not analyzed with GASiC due to computational limitations. The commonly used i100 data set is characterized by shorter reads derived from different bacterial strain clusters. DiTASiC achieves an improved accuracy in comparison to kallisto, and also to further tools when compared with the values reported in a recent benchmark study of different abundance profiling tools on the i100 set (<xref rid="btx237-B37" ref-type="bibr">Schaeffer <italic>et al.</italic>, 2017</xref>) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S7</xref>). The simulation data serves as a challenge with a high number of similar strains and a smaller number of reads available for assignment. In comparison, samples in CAMI hold 150 times more reads with only seven times more taxa. The results show that DiTASiC performs superior in all sets of simulation group (2), where all taxa are present, while errors are proportionally higher in sets of group (1), where taxa are absent. Group (1) is primarily defined by the absence of distant strains or entire strain clusters; the EM algorithm of kallisto proves to be slightly more accurate in these scenarios. However, sets in simulation group (3) are characterized by the absence of strains from highly similar clusters and by the presence of very large clusters of high sequence similarities. Here, DiTASiC demonstrates to be more powerful (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8</xref>). Notably, we observe an increased error of abundance estimates in kallisto predominantly for highly similar strain sequences. In contrast, DiTASiC reveals its particular strength in the resolution of these strain clusters, it demonstrates to precisely distinguish abundances down to sub-strains with sequence similarities above 95%. Different examples are found for the CAMI, i100 and simulation data, considering diverse <italic>Escherichia coli</italic> cluster, <italic>Corynebacterium</italic> and <italic>Staphylococcus aureus</italic> cluster (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9</xref>). Here, an accurate cluster resolution is obtained by DiTASiC, and common errors such as abundance interchange or equalization of similar sub-strains are avoided.
<table-wrap id="btx237-T2" orientation="portrait" position="float"><label>Table 2</label><caption><p>Accuracy of taxa abundance estimates by DiTASiC, kallisto and GASiC</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">DiTASiC</th><th rowspan="1" colspan="1">kallisto</th><th rowspan="1" colspan="1">GASiC</th></tr></thead><tbody><tr><td rowspan="2" colspan="1">CAMI</td><td rowspan="1" colspan="1">Set 1</td><td rowspan="1" colspan="1"><bold>6.98 e-02</bold></td><td rowspan="1" colspan="1">1.05 e-01</td><td rowspan="1" colspan="1">n.a.</td></tr><tr><td rowspan="1" colspan="1">Set 2</td><td rowspan="1" colspan="1"><bold>5.36 e-02</bold></td><td rowspan="1" colspan="1">5.69 e-02</td><td rowspan="1" colspan="1">n.a.</td></tr><tr><td rowspan="1" colspan="1">i100</td><td rowspan="1" colspan="1">i100</td><td rowspan="1" colspan="1"><bold>8.23 e-06</bold></td><td rowspan="1" colspan="1">5.62 e-05</td><td rowspan="1" colspan="1">9.32 e-04</td></tr><tr><td rowspan="3" colspan="1">FAMeS</td><td rowspan="1" colspan="1">LC</td><td rowspan="1" colspan="1">6.87 e-06</td><td rowspan="1" colspan="1"><bold>1.73 e-08</bold></td><td rowspan="1" colspan="1">3.18 e-04</td></tr><tr><td rowspan="1" colspan="1">MC</td><td rowspan="1" colspan="1">3.07 e-08</td><td rowspan="1" colspan="1"><bold>1.70 e-08</bold></td><td rowspan="1" colspan="1">4.17 e-04</td></tr><tr><td rowspan="1" colspan="1">HC</td><td rowspan="1" colspan="1">8.34 e-08</td><td rowspan="1" colspan="1"><bold>2.79 e-08</bold></td><td rowspan="1" colspan="1">7.79 e-05</td></tr><tr><td rowspan="3" colspan="1">Simulation group (1)</td><td rowspan="1" colspan="1">Set 1</td><td rowspan="1" colspan="1">8.38 e-07</td><td rowspan="1" colspan="1"><bold>7.61 e-07</bold></td><td rowspan="1" colspan="1">6.92 e-03</td></tr><tr><td rowspan="1" colspan="1">Set 2</td><td rowspan="1" colspan="1"><bold>9.33 e-07</bold></td><td rowspan="1" colspan="1">9.61 e-07</td><td rowspan="1" colspan="1">1.13 e-02</td></tr><tr><td rowspan="1" colspan="1">Set 3</td><td rowspan="1" colspan="1">4.37 e-07</td><td rowspan="1" colspan="1"><bold>2.59 e-07</bold></td><td rowspan="1" colspan="1">9.73 e-03</td></tr><tr><td rowspan="6" colspan="1">Simulation group (2)</td><td rowspan="1" colspan="1">Set 4</td><td rowspan="1" colspan="1"><bold>2.54 e-06</bold></td><td rowspan="1" colspan="1">4.09 e-05</td><td rowspan="1" colspan="1">6.10 e-03</td></tr><tr><td rowspan="1" colspan="1">Set 5</td><td rowspan="1" colspan="1"><bold>1.85 e-06</bold></td><td rowspan="1" colspan="1">5.94 e-05</td><td rowspan="1" colspan="1">8.54 e-03</td></tr><tr><td rowspan="1" colspan="1">Set 6</td><td rowspan="1" colspan="1"><bold>2.67 e-06</bold></td><td rowspan="1" colspan="1">3.46 e-05</td><td rowspan="1" colspan="1">2.22 e-03</td></tr><tr><td rowspan="1" colspan="1">Set 7</td><td rowspan="1" colspan="1"><bold>3.41 e-06</bold></td><td rowspan="1" colspan="1">2.84 e-04</td><td rowspan="1" colspan="1">6.55 e-03</td></tr><tr><td rowspan="1" colspan="1">Set 8</td><td rowspan="1" colspan="1"><bold>4.93 e-06</bold></td><td rowspan="1" colspan="1">2.99 e-04</td><td rowspan="1" colspan="1">2.27 e-03</td></tr><tr><td rowspan="1" colspan="1">Set 9</td><td rowspan="1" colspan="1"><bold>4.15 e-06</bold></td><td rowspan="1" colspan="1">5.37 e-05</td><td rowspan="1" colspan="1">1.63 e-03</td></tr><tr><td rowspan="2" colspan="1">Simulation group (3)</td><td rowspan="1" colspan="1">Set 10</td><td rowspan="1" colspan="1"><bold>3.94 e-06</bold></td><td rowspan="1" colspan="1">5.43 e-05</td><td rowspan="1" colspan="1">1.84 e-02</td></tr><tr><td rowspan="1" colspan="1">Set 11</td><td rowspan="1" colspan="1"><bold>3.39 e-05</bold></td><td rowspan="1" colspan="1">5.07 e-04</td><td rowspan="1" colspan="1">7.29 e-03</td></tr></tbody></table><table-wrap-foot><fn id="tblfn2"><p><italic>Note</italic>: Accuracy is defined by the <italic>SSE</italic> between estimates and available ground truth. A significant error reduction is shown for DiTASiC compared with GASiC and a comparable performance is observed for kallisto (highest accuracy is depicted in bold print). GASiC was not run on CAMI data due to computational limitations.</p></fn></table-wrap-foot></table-wrap></p>
      <p><xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S10</xref> visualizes the taxa abundance estimates of the different tools in comparison to the observed mapping abundances, exemplary for three simulation sets of different complexity. It clearly demonstrates how the mapping abundance, biased due to read ambiguities, mainly overestimates the ground truth and further assigns abundance counts to absent taxa. GASiC shows some significant over- and underestimations, while the accuracy of DiTASiC and kallisto is consistently high. Further, a study of two replicate sets, defined by read sets simulated with the same abundance profile, proves robustness and precise reproducibility of results by DiTASiC as well as kallisto, with significant improvement over GASiC (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11</xref>).</p>
    </sec>
    <sec>
      <title>4.2 Absent and missing taxa</title>
      <p>We recommend prior pre-filtering of references to focus on reference genomes of species expected in the data. Still, frequently we consider more references than taxa actually present in the data and an inclusion of all potentially abundant strains is advised.</p>
      <p>Hence, in the simulation groups (1) and (3) and the FAMeS data, which hold different proportions of absent taxa, we tested the detection performance of DiTASiC. The internal filtering is conducted to infer potential false-positive taxa in the given sets. In the simulation group (1) the abundant taxa proportions of 28, 40 and 45%, respectively, are exactly detected with neither false-positive nor false-negative calls. In the FAMeS data, proportion of absent taxa based on the reference set corresponds to 8, 9 and 8% in the three samples. DiTASiC achieves sensitivity and specificity of 100% for the MC and HC data. In the LC set, a false-negative is caused by missing one abundant taxon, resulting in a decreased sensitivity of 99.1%. (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). In simulation group (3), set 10 serves to study the impact of absent strains from highly similar clusters and indicates un-biased abundance estimation of strains of the affected clusters by DiTASiC (refer to <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S7</xref>). In another study, reads derived from 55 taxa are contrasted to a reduced reference set of 35 taxa to investigate the impact of missing taxa in a selected reference set. First, we observe that 11% of the reads are not aligned; second, it is shown that abundance estimates of some taxa are overestimated by DiTASiC. However, a closer look reveals that it concerns closely related strains which show an increased abundance due to missing strains within their cluster. The results propose that no overall abundance bias is caused (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S12</xref>).</p>
    </sec>
    <sec>
      <title>4.3 Differential taxa abundance</title>
      <p>Here, we evaluate pairwise comparisons of metagenomics samples, aiming to reveal the change of taxa compositions at the highest taxonomic level. We demonstrate how the entire process of read ambiguity resolution and incorporating the uncertainty of abundance estimates has a crucial impact on differential assessment on strain level. As a result, a more accurate detection of differential events is achieved, particularly in case of small changes. False-positives are significantly reduced.</p>
      <p>In order to evaluate independent of technical and biological variance factors, we do not consider replicate samples and comparisons here. This way we can test our specifically addressed differential method and prove the validity and impact of the abundance variance without bias. We compare our approach to STAMP (<xref rid="btx237-B32" ref-type="bibr">Parks and Beiko, 2010</xref>; <xref rid="btx237-B31" ref-type="bibr">Parks <italic>et al.</italic>, 2014</xref>), which is available for pairwise comparisons to exemplary demonstrate the importance of the issues of read ambiguities and abundance estimation uncertainties. The mapping abundances of the taxa serve as input for STAMP. STAMP is a software package providing several statistical tests for differential taxonomic and functional assessment and a user-friendly graphical interface. The recommended option of a G-test with Yates continuity correction followed by a Benjamini-Hochberg adjustment is selected.</p>
      <p>Different metagenome comparisons are conducted within the presented data sources. Evaluations focus on correct detections of differentially abundant taxa and on accuracy of taxa fold changes.</p>
      <p>For the simulation data and the CAMI spike-in data, ground truth is available for specific classification into differential and non-differential taxa, results are described by measures of sensitivity, specificity and accuracy as combined measure of correct detections. For the FAMeS and the original CAMI data, no classification is provided, here, the accuracy of fold changes is evaluated by using the <italic>SSE</italic> instead.</p>
      <p>Different pairwise comparisons of the simulation data cover various scenarios of non-differential and differential events. A <italic>P</italic>-value cutoff of 0.05, adjusted for multiplicity, is used to define differentially abundant taxa. Evaluation results for the simulation data are presented in <xref rid="btx237-T3" ref-type="table">Table 3</xref>. For all scenarios, DiTASiC reports no false-positive hits, holding a false discovery rate (FDR) of zero and a resulting specificity of one. Further, in five out of eight comparisons also a sensitivity of 100% is achieved. In the other three cases, the detection of one known differentially abundant taxon fails resulting in one false-negative detection and corresponding sensitivities of 97%. Here, it concerns the differential detection of the sub-strain <italic>E.coli K12 MG1655</italic>, which holds accurate abundance estimates but fairly large standard errors, arising due to uncertainties because of high sequence similarity of 98% with another <italic>E.coli</italic> sub-strain <italic>DH10B</italic>. The known relative abundance decrease by 1% is very small and hereby falls in the abundance variance range, while an increase by 3% for sub-strain <italic>DH10B</italic> could be detected as well as differences below 1% for the other <italic>E.coli</italic> strains in the cluster. In general contrast are the results obtained for STAMP, showing a strong tendency of identifying non-differential taxa as differentially expressed, causing high numbers of false-positives. As abundance estimates underlie some variation, additionally biased due to read ambiguities, these results confirm how the inclusion of standard errors is crucial to identify taxa with consistent abundances. The FDR of STAMP ranges from 12 to 63% and the overall accuracy from 46 to 86%.
<table-wrap id="btx237-T3" orientation="portrait" position="float"><label>Table 3</label><caption><p>Evaluation of differential taxa abundance by DiTASiC and STAMP based on sample comparisons within the simulation data and the CAMI data set</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/></colgroup><tbody><tr><td rowspan="1" colspan="1">Data source</td><td rowspan="1" colspan="1">Samples compared</td><td rowspan="1" colspan="1">No. of non-differential events</td><td rowspan="1" colspan="1">No. of differential events</td><td colspan="4" rowspan="1">False positives (FPs) and False negatives (FNs)</td><td colspan="2" rowspan="1">FDR</td><td colspan="2" rowspan="1">Sensitivity | Specificity</td><td colspan="2" rowspan="1">Accuracy</td></tr><tr><td colspan="4" rowspan="1"/><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td colspan="2" rowspan="1"><italic>DiTASiC</italic></td><td colspan="2" rowspan="1"><italic>STAMP</italic></td><td rowspan="1" colspan="1"><italic>DiTASiC</italic></td><td rowspan="1" colspan="1"><italic>STAMP</italic></td><td rowspan="1" colspan="1"><italic>DiTASiC</italic></td><td rowspan="1" colspan="1"><italic>STAMP</italic></td><td rowspan="1" colspan="1"><italic>DiTASiC</italic></td><td rowspan="1" colspan="1"><italic>STAMP</italic></td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">FP</td><td rowspan="1" colspan="1">FN</td><td rowspan="1" colspan="1">FP</td><td rowspan="1" colspan="1">FN</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td colspan="14" rowspan="1"><hr/></td></tr><tr><td rowspan="2" colspan="1"><bold>CAMI</bold> spike-in data</td><td rowspan="2" colspan="1">Samples S1 versus S2</td><td colspan="12" rowspan="1"/></tr><tr><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.50</td><td rowspan="1" colspan="1">1 | 1</td><td rowspan="1" colspan="1">1 | 0.5</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.5</td></tr><tr><td rowspan="8" colspan="1"><bold>Simulation group (2):</bold> Pairwise sample 
comparisons of different simulation sets (numbered from 4 to 9)</td><td rowspan="1" colspan="1">set 4 versus set 5</td><td rowspan="1" colspan="1">35</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">n.a.</td><td rowspan="1" colspan="1">n.a.</td><td rowspan="1" colspan="1">n.a. | 1</td><td rowspan="1" colspan="1">n.a | 1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1">set 5 versus set 9</td><td rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.63</td><td rowspan="1" colspan="1">1 | 1</td><td rowspan="1" colspan="1">1 | 0.7</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.66</td></tr><tr><td rowspan="1" colspan="1">set 5 versus set 6</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.51</td><td rowspan="1" colspan="1">0.94 | 1</td><td rowspan="1" colspan="1">0.89 | 0.5</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.43</td></tr><tr><td rowspan="1" colspan="1">set 6 versus set 7</td><td rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.47</td><td rowspan="1" colspan="1">1 | 1</td><td rowspan="1" colspan="1">1 | 0.51</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.54</td></tr><tr><td rowspan="1" colspan="1">set 7 versus set 8</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">1 | 1</td><td rowspan="1" colspan="1">1 | 0.59</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.8</td></tr><tr><td rowspan="1" colspan="1">set 6 versus set 8</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">29</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.12</td><td rowspan="1" colspan="1">1 | 1</td><td rowspan="1" colspan="1">1 | 0.6</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.89</td></tr><tr><td rowspan="1" colspan="1">set 4 versus set 7</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.14</td><td rowspan="1" colspan="1">0.97 | 1</td><td rowspan="1" colspan="1">1 | 0.5</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.86</td></tr><tr><td rowspan="1" colspan="1">set 4 versus set 8</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.14</td><td rowspan="1" colspan="1">0.97 | 1</td><td rowspan="1" colspan="1">1 | 0.5</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.86</td></tr></tbody></table><table-wrap-foot><fn id="tblfn3"><p><italic>Note</italic>: A <italic>P</italic>-value cutoff of 0.05 is used to define differentially abundant taxa. In most scenarios, DiTASiC achieves exact detections, holding a FDR of zero and accuracy above 97% overall. A reduced accuracy performance by STAMP, using mapping abundances, confirms the significant impact of read ambiguities and abundance estimate uncertainties. In case of no differential events, FDR and sensitivity cannot be computed (n.a.). </p></fn></table-wrap-foot></table-wrap></p>
      <p>A similar situation is observed for the CAMI spike-in data. DiTASiC correctly detects all 15 differential and 15 non-differential taxa. However, all 30 taxa are found to be differentially abundant by STAMP, resulting in an accuracy of only 50%. Considering the entire CAMI data set, fold changes, spanning from 0.0009 to 1024, are proven to be highly accurate for DiTASiC with an <italic>SSE</italic> 19 times smaller compared with the STAMP output. Further, the assigned <italic>P</italic>-values by DiTASiC clearly separate the spiked-in non-differential and differential taxa (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S13</xref>). All other taxa of the data set, holding fold change values greater than zero, also receive very small <italic>P</italic>-values stating differential abundance, but cannot be further confirmed.</p>
      <p>Pairwise metagenome comparisons within the FAMeS data also exhibit high fold change accuracies, as consequence to the former highly accurate abundance estimates. Corresponding <italic>SSE</italic> values are two magnitudes smaller compared with the ones computed by STAMP (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>Our work demonstrates the challenges concerning strain level resolution in metagenomics data and the need for dedicated methods for quantification and differential abundance testing. DiTASiC addresses these challenges and provides novel approaches.</p>
    <p>The inference of taxa abundances by directly counting mapped reads is not suitable on strain level. Although read mappers have significantly improved in speed and mapping accuracy, they cannot resolve shared read assignments and thereby cannot directly output correct abundances. Our results show the bias introduced by the pseudo-aligner of kallisto (without its well working EM-based quantification framework): the abundances of most taxa are overestimated and many actually absent taxa are assigned positive abundances. This effect is due to shared read counts, caused by highly similar reference sequences of strains in a metagenomics sample. DiTASiC is based on a new GLM framework, adapted to characteristics of taxa data for the resolution of shared read counts. As a result, it provides highly accurate abundance estimates for taxa in different metagenomics samples. Thereby, DiTASiC proves excellent performance independent of abundance profile complexities and also shows reduced errors in comparison to existing tools on a recent benchmark study on the i100 data (<xref rid="btx237-B37" ref-type="bibr">Schaeffer <italic>et al.</italic>, 2017</xref>). It enables accuracy in a large range of relative abundances from 0.001 to 30% present in the various data sets. Further, while generally the read coverage in a metagenomics sample is a critical factor for abundance estimation, the degree of reference similarities of present taxa means a greater challenge. Thus, on the FAMeS data set with 122 taxa, but many dissimilar species, all tools achieve overall higher abundance accuracy compared with the simulation sets with only 35 taxa holding almost the same number of input reads, but different challenging strain clusters. However, the GLM model of DiTASiC proves specific strength in highly accurate abundance resolution within strain clusters, as is shown for various examples in the i100, CAMI and simulation studies. In particular, it demonstrates to precisely distinguish abundances down to sub-strains which share sequence similarities above 95%. Whereas this is more challenging for kallisto, which was similarly reported in a benchmark study by <xref rid="btx237-B22" ref-type="bibr">McLoughlin (2016)</xref>. An important point is that the similarity matrix used in DiTASiC is not necessarily symmetric. Hence, the simulated proportion of reads shared from reference <italic>i</italic> with reference <italic>j</italic> can differ from the proportion reference <italic>j</italic> shares with reference <italic>i</italic>. We observe these dissimilarities in the matrix e.g. for the <italic>E.coli</italic> clusters and hypothesize that this may explain the good performance of DiTASiC, as it allows capturing sub-strain sequences, which may be shorter, but highly similar to other longer strain sequences.</p>
    <p>The framework of DiTASiC is also robust with increasing sequencing error, as the internal matrix simulations account for the error profiles found in the raw reads. However, as a consequence, misaligned reads in addition to shared reads will cause abundance bias, which poses another resolution challenge. Further, missing or unknown taxa in reference sets may introduce quantification bias. However, one of our studies indicates that closely related strains compensate for missing ones and not affected strain cluster remain stable. Overall, DiTASiC shows certain robustness on imperfect reference sets with either missing or false-positive taxa included. Nevertheless, explicitly accounting for non-mapped reads and their missed abundance proportion could be included in future work.</p>
    <p>All in all, the accuracy of the abundance estimation has an immediate impact on the accuracy that can be achieved in the differential abundance analysis of the taxa. This is clearly observable in the comparisons of the FAMeS data sets, which result in highly accurate fold change estimates in consequence of the accurate abundance estimates that were obtained.</p>
    <p>However, for differential abundance testing, in order to distinguish differentially and non-differentially abundant taxa, the uncertainty of the abundance estimates plays a crucial role. Especially on strain level, this variance reflects uncertainties in the underlying read ambiguity resolution in the presence of highly similar reference sequences. DiTASiC introduces a new statistical framework, which integrates the abundance variance and forms abundance distributions for differential testing sensitive to strain level.</p>
    <p>Generally in comparative metagenomics, it is difficult to predict how a community of taxa in a sample will change, as there is a variety of influential factors involved. A study by (<xref rid="btx237-B4" ref-type="bibr">David <italic>et al.</italic>, 2014</xref>), demonstrates how human actions can cause next-day abundance change in the microbiome. Hence, putting assumptions on data for composition change is complex. Further, although taxa abundance data and gene expression data share discrete count data characteristics, assumptions commonly made for gene expression for differential analysis cannot be easily transferred. One of the most common assumptions is that the majority of features will not be differentially changed. This is reasonable for genes in a cell as no global change of expression of all genes is biologically expected. In metagenomics studies though, antibiotics treatment has shown to cause rapid change of microbial compositions in human samples (<xref rid="btx237-B5" ref-type="bibr">Dethlefsen and Relman, 2011</xref>). Further, gene expression data in RNA-Seq studies are often characterized by overdispersion and correspondingly modelled by negative binomial distributions.</p>
    <p>Different popular RNA-Seq tools as well as standard statistical tests are frequently applied to metagenomics gene data for differential analysis, however, have been shown to not capture the data well in all cases (<xref rid="btx237-B9" ref-type="bibr">Jonsson <italic>et al.</italic>, 2016</xref>). Similar problems are observed when considering differential taxa abundance. In a study of plaque samples, DESeq and edgeR were also shown to not fit the data properly (<xref rid="btx237-B33" ref-type="bibr">Paulson <italic>et al.</italic>, 2013</xref>). Hence overall, it is important to distinguish gene and taxa level and critically assess corresponding assumptions. Furthermore, defining assumptions to capture all diverse structures of metagenomics data might pose an almost impossible challenge. Here, we propose an independent statistical framework for differential testing of all individual taxa in the set, without putting any assumptions on overall composition change.</p>
    <p>We evaluated our approach on diverse scenarios, covering sets with only non-differential events to sets with overall change, and can indicate overall correct detections. Further, the method is not dependent on the presence of a taxon in both samples of comparison, it also serves as test on taxa emergence or extinction.</p>
    <p>In contrast, STAMP yields many false-positives, which reflects the importance of read ambiguity resolution and integration of abundance uncertainties for strain level analysis. In cases of extremely similar strain sequences, however, large standard errors for the estimates can occur, as shown for the two <italic>E.coli</italic> sub-strains, and can consequently cause a lower limit for the detection of very small fold-changes in DiTASiC.</p>
    <p>Generally, DiTASiC is neither limited to bacteria nor any taxonomic level. Also its concept is applicable to any ambiguity resolution in which the similarities causing the ambiguities can be described. Further, variance of sample replicates pose another crucial variance source, integration could be achieved by not sampling from the mixture of Poisson distributions of one experiment, but across all replicates. DiTASiC is independent of specific databases or any additional data information, it simply relies on the raw reads and on a (pre-filtered) species reference set in fasta format, the latter can also contain assemblies or fragmented sequences.</p>
  </sec>
  <sec>
    <title>6 Conclusion</title>
    <p>This contribution focuses on the resolution on strain level in metagenomics data concerning taxa quantification and differential abundance assessment. We point out the challenges arising on strain level due to the presence of highly similar reference sequences. We present DiTASiC, which provides a new GLM framework for the resolution of shared read counts and introduce a statistical framework, which integrates abundance variances, for differential testing sensitive to strain level. As a result, highly accurate abundance estimates down to sub-strain level as well as detections of differentially abundant taxa are obtained. Evaluations are conducted on different data sources and in comparison to existing methods.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx237_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Kathrin Trappe, Tobias Loka and Vitor Piro (Robert Koch Institute) for critical reading and helpful comments on the article as well as Martin S. Lindner for inspiring discussions.</p>
    <sec>
      <title>Funding</title>
      <p>We acknowledge financial support by Deutsche Forschungsgemeinschaft [grant number RE3474/2-1 to B.Y.R.].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx237-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Anders</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R106.</fpage><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group> (<year>1995</year>) 
<article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser B (Methodological)</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btx237-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bray</surname><given-names>N.L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>525</fpage>–<lpage>527</lpage>.<pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>David</surname><given-names>L.A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Host lifestyle affects human microbiota on daily timescales</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R89.</fpage><pub-id pub-id-type="pmid">25146375</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dethlefsen</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Relman</surname><given-names>D.A.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Incomplete recovery and individualized responses of the human distal gut microbiota to repeated antibiotic perturbation</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>108(Suppl 1)</volume>, <fpage>4554</fpage>–<lpage>4561</lpage>.<pub-id pub-id-type="pmid">20847294</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gibbons</surname><given-names>S.M.</given-names></name>, <name name-style="western"><surname>Gilbert</surname><given-names>J.A.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Microbial diversity–exploration of natural ecosystems and microbiomes</article-title>. <source>Curr. Opin. Genet. Dev</source>., <volume>35</volume>, <fpage>66</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">26598941</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Holtgrewe</surname><given-names>M.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Mason – a read simulator for second generation sequencing data</article-title>. <source>Tech. Rep. FU Berl</source>.</mixed-citation>
    </ref>
    <ref id="btx237-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>D.H.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>., <volume>17</volume>, <fpage>377</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">17255551</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jonsson</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Statistical evaluation of methods for identification of differentially abundant genes in comparative metagenomics</article-title>. <source>BMC Genomics</source>, <volume>17</volume>, <fpage>78.</fpage><pub-id pub-id-type="pmid">26810311</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Karlsson</surname><given-names>F.H.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Gut metagenome in European women with normal, impaired and diabetic glucose control</article-title>. <source>Nature</source>, <volume>498</volume>, <fpage>99</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">23719380</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>357</fpage>–<lpage>359</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Law</surname><given-names>C.W.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R29.</fpage><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Microbiome, metagenomics, and high-dimensional compositional data analysis</article-title>. <source>Annu. Rev. Stat. Appl</source>., <volume>2</volume>, <fpage>73</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="btx237-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lieberman</surname><given-names>T.D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Genetic variation of a bacterial pathogen within individuals with cystic fibrosis provides a record of selective pressures</article-title>. <source>Nat. Gene</source>., <volume>46</volume>, <fpage>82</fpage>–<lpage>87</lpage>.</mixed-citation>
    </ref>
    <ref id="btx237-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lindgreen</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>19233.</fpage><pub-id pub-id-type="pmid">26778510</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lindner</surname><given-names>M.S.</given-names></name>, <name name-style="western"><surname>Renard</surname><given-names>B.Y.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Metagenomic abundance estimation and diagnostic testing on species level</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>e10.</fpage><pub-id pub-id-type="pmid">22941661</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>AFS: identification and quantification of species composition by metagenomic sequencing</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1396</fpage>–<lpage>1398</lpage>.<pub-id pub-id-type="pmid">28453677</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Love</surname><given-names>M.I.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550.</fpage><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lu</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Bracken: estimating species abundance in metagenomics data</article-title>. <source>PeerJ Comput. Sci</source>., <volume>3</volume>, <fpage>e104.</fpage></mixed-citation>
    </ref>
    <ref id="btx237-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Luo</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>ConStrains identifies microbial strains in metagenomic datasets</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>1045</fpage>–<lpage>1052</lpage>.<pub-id pub-id-type="pmid">26344404</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mavromatis</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Use of simulated data sets to evaluate the fidelity of metagenomic processing methods</article-title>. <source>Nat. Methods</source>, <volume>4</volume>, <fpage>495</fpage>–<lpage>500</lpage>.<pub-id pub-id-type="pmid">17468765</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McLoughlin</surname><given-names>K.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Technical report: benchmarking for quasispecies abundance inference with confidence intervals from metagenomic sequence data</article-title>. <source>Tech. Rep</source>., LLNL-TR-681108</mixed-citation>
    </ref>
    <ref id="btx237-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mende</surname><given-names>D.R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Assessment of metagenomic assembly using simulated next generation sequencing data</article-title>. <source>Plos One</source>, <volume>7</volume>, <fpage>e31386.</fpage><pub-id pub-id-type="pmid">22384016</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Menzel</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Fast and sensitive taxonomic classification for metagenomics with Kaiju</article-title>. <source>Nat. Commun</source>., <volume>7</volume>, <fpage>11257.</fpage><pub-id pub-id-type="pmid">27071849</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nawy</surname><given-names>T.</given-names></name></person-group> (<year>2015</year>) 
<article-title>MICROBIOLOGY: the strain in metagenomics</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>1005.</fpage><pub-id pub-id-type="pmid">26824103</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nayfach</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>An integrated metagenomics pipeline for strain profiling reveals novel patterns of bacterial transmission and biogeography</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>1612</fpage>–<lpage>1625</lpage>.<pub-id pub-id-type="pmid">27803195</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Neelakanta</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Sultana</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) 
<article-title>The use of metagenomic approaches to analyze changes in microbial communities</article-title>. <source>Microbiol. Insights</source>, <volume>6</volume>, <fpage>37</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">24826073</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ondov</surname><given-names>B.D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>132.</fpage><pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oulas</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Metagenomics: tools and insights for analyzing next-generation sequencing data derived from biodiversity studies</article-title>. <source>Bioinformatics Biol. Insights</source>, <volume>9</volume>, <fpage>75</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btx237-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ounit</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>236.</fpage><pub-id pub-id-type="pmid">25879410</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pignatelli</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Moya</surname><given-names>A.</given-names></name></person-group> (<year>2011</year>) 
<article-title> Evaluating the fidelity of de novo short read metagenomic assembly using simulated data</article-title>. <source>PloS One</source>, <volume>6</volume>, <fpage>e19984</fpage>.<pub-id pub-id-type="pmid">21625384</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parks</surname><given-names>D.H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>STAMP: statistical analysis of taxonomic and functional profiles</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>3123</fpage>–<lpage>3124</lpage>.<pub-id pub-id-type="pmid">25061070</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parks</surname><given-names>D.H.</given-names></name>, <name name-style="western"><surname>Beiko</surname><given-names>R.G.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Identifying biologically relevant differences between metagenomic communities</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>715</fpage>–<lpage>721</lpage>.<pub-id pub-id-type="pmid">20130030</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Paulson</surname><given-names>J.N.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1200</fpage>–<lpage>1202</lpage>.<pub-id pub-id-type="pmid">24076764</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peng</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Zero-inflated beta regression for differential abundance analysis with metagenomics data</article-title>. <source>J. Comput. Biol</source>., <volume>23</volume>, <fpage>102</fpage>–<lpage>110</lpage>.</mixed-citation>
    </ref>
    <ref id="btx237-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rosen</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Microbial diversity. Fine-scale diversity and extensive recombination in a quasisexual bacterial population occupying a broad niche</article-title>. <source>Science</source>, <volume>348</volume>, <fpage>1019</fpage>–<lpage>1023</lpage>.<pub-id pub-id-type="pmid">26023139</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schaeffer</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Pseudoalignment for metagenomic read assignment</article-title>. <source>Bioinformatics</source>, <comment>DOI: 10.1093/bioinformatics/btx106</comment>.</mixed-citation>
    </ref>
    <ref id="btx237-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scholz</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Strain-level microbial epidemiology and population genomics from shotgun metagenomics</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>435</fpage>–<lpage>438</lpage>.<pub-id pub-id-type="pmid">26999001</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sczyrba</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Critical Assessment of Metagenome Interpretation – a benchmark of computational metagenomics software</article-title>. <source>bioRxiv</source>, <fpage>99127</fpage>.</mixed-citation>
    </ref>
    <ref id="btx237-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Segata</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Metagenomic biomarker discovery and explanation</article-title>. <source>Genome Biol</source>., <volume>12</volume>, <fpage>R60.</fpage><pub-id pub-id-type="pmid">21702898</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Segata</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>811</fpage>–<lpage>814</lpage>.<pub-id pub-id-type="pmid">22688413</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shapiro</surname><given-names>B.J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Population genomics of early events in the ecological differentiation of bacteria</article-title>. <source>Science</source>, <volume>336</volume>, <fpage>48</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">22491847</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Snitkin</surname><given-names>E.S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Genome-wide recombination drives diversification of epidemic strains of Acinetobacter baumannii</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>108</volume>, <fpage>13758</fpage>–<lpage>13763</lpage>.<pub-id pub-id-type="pmid">21825119</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sohn</surname><given-names>M.B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A robust approach for identifying differentially abundant features in metagenomic samples</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2269</fpage>–<lpage>2275</lpage>.<pub-id pub-id-type="pmid">25792553</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>White</surname><given-names>J.R.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Statistical methods for detecting differentially abundant features in clinical metagenomic samples</article-title>. <source>PLoS Comput. Biol</source>., <volume>5</volume>, <fpage>e1000352.</fpage><pub-id pub-id-type="pmid">19360128</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wood</surname><given-names>D.E.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R46.</fpage><pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wooley</surname><given-names>J.C.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>A primer on metagenomics</article-title>. <source>PLoS Comput. Biol</source>., <volume>6</volume>, <fpage>e1000667.</fpage><pub-id pub-id-type="pmid">20195499</pub-id></mixed-citation>
    </ref>
    <ref id="btx237-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xia</surname><given-names>L.C.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Accurate genome relative abundance estimation based on shotgun metagenomic reads</article-title>. <source>PloS One</source>, <volume>6</volume>, <fpage>e27992.</fpage><pub-id pub-id-type="pmid">22162995</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
