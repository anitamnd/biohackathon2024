<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5704956</article-id>
    <article-id pub-id-type="pmid">28218897</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.4189</article-id>
    <article-id pub-id-type="manuscript">nihpa847619</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mapping DNA Methylation with High Throughput Nanopore Sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rand</surname>
          <given-names>Arthur C.</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jain</surname>
          <given-names>Miten</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eizenga</surname>
          <given-names>Jordan M.</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Musselman-Brown</surname>
          <given-names>Audrey</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olsen</surname>
          <given-names>Hugh E.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Akeson</surname>
          <given-names>Mark</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Paten</surname>
          <given-names>Benedict</given-names>
        </name>
      </contrib>
      <aff id="A1">Department of Biomolecular Engineering, University of California, Santa Cruz</aff>
      <aff id="A2">Genomics Institute, University of California, Santa Cruz</aff>
    </contrib-group>
    <author-notes>
      <fn id="FN1" fn-type="equal">
        <label>*</label>
        <p id="P1">These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>15</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <volume>14</volume>
    <issue>4</issue>
    <fpage>411</fpage>
    <lpage>413</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.4189-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:
<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P2">Chemical modifications to DNA regulate its biological function. We present a framework for mapping methylation to cytosine and adenosine with the Oxford Nanopore Technologies MinION using its ionic current signal. We map three cytosine variants and two adenine variants. The results show that our model is sensitive enough to detect changes in genomic DNA methylation levels as a function of growth phase in <italic>E. coli</italic>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P3">Chemical modifications of DNA influence its biological function. In mammals, alkylation of carbon-5 yields several cytosine variants: C<sup>5</sup>-methylcytosine (5-mC), C<sup>5</sup>-hydroxymethylcytosine (5-hmC), C<sup>5</sup>-formylcytosine, and C<sup>5</sup>-carboxylcytosine. These marks play a role in aging, gene regulation, imprinting, and disease<sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref></sup>. In prokaryotes, 5-mC and N<sup>4</sup>-methylcytosine contribute to gene regulation and restriction-modification systems<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. Some eukaryotic and prokaryotic organisms also methylate adenine to N<sup>6</sup>-methyladenine (6-mA). This residue is important for a variety of biological processes including methylation-dependent mismatch repair and transcriptional regulation<sup><xref rid="R3" ref-type="bibr">3</xref>–<xref rid="R7" ref-type="bibr">7</xref></sup>.</p>
  <p id="P4">Several methods can detect DNA methylation. Illumina-based sequencing uses bisulfite treatment to detect cytosine methylation. Single-molecule real time (SMRT) sequencing generates long reads and can detect multiple modifications to DNA simultaneously using enzyme kinetics<sup><xref rid="R8" ref-type="bibr">8</xref>–<xref rid="R14" ref-type="bibr">14</xref></sup>. Previous studies have shown that ionic current measurements from low-throughput nanopore sensors can discriminate among all five C5-cytosine variants<sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref></sup>.</p>
  <p id="P5">Here we show that DNA modifications can be detected as changes in the Oxford Nanopore Technologies (ONT) MinION’s ionic current signal. The MinION is a high-throughput nanopore-based single-molecule device that can sequence long unamplified DNA fragments<sup><xref rid="R17" ref-type="bibr">17</xref></sup>. We present a generative model that can perform inference on the methylation status of individual bases in a reference sequence. The model consists of a variable-order hidden Markov model (HMM) with a hierarchical Dirichlet process (HDP) to learn ionic current distributions (<xref ref-type="supplementary-material" rid="SD2">Figure S1</xref>, <bold>Online Methods</bold>). We refer to the full model as an HMM-HDP. We classify individual C, 5-mC, and 5-hmC bases on single molecules of synthetic oligonucleotides. We also map 5-mC at the inner cytosine of C<bold>C</bold>(A/T)GG motifs and 6-mA at G<bold>A</bold>TC motifs in <italic>E. coli</italic> genomic DNA (gDNA) from multiple growth conditions to demonstrate that we can quantify changes in methylation levels in realistic conditions.</p>
  <p id="P6">The MinION continuously records ionic current and then divides it into segments referred to as events (See <bold>Online Methods</bold> for details). Our method models each event as a nucleotide string of length <italic>k</italic>, a k-mer. Each k-mer is associated with a distribution of ionic currents in picoamps (pA). We model the events with a pair-HMM that tracks a reference sequence and allows reference nucleotides to be any of several potentially modified bases (<xref ref-type="supplementary-material" rid="SD2">Figure S1A and B</xref>). We use a HDP mixture model to learn the effects that different base modifications have on the ionic current (<xref ref-type="supplementary-material" rid="SD2">Figure S1C and D</xref>), the HDP ties together the parameters between different k-mer distributions<sup><xref rid="R18" ref-type="bibr">18</xref></sup>. Our method calls methylation variants based on the posterior probability of event-to-k-mer aligned pairs. We call the methylation status as the variant with the highest marginal probability. With multiple reads, we sum the probabilities from the individual reads aligned to a position and call the variant with the highest posterior mean. Details about the model can be found in the <bold>Online Methods</bold>.</p>
  <p id="P7">We evaluated our method’s performance at discriminating cytosine variants with a three-way cytosine classification experiment with synthetic oligonucleotide substrates, where each molecule bears only C, 5-mC, or 5-hmC. See <bold>Online Methods</bold> for details. We also used these experiments to compare our model to a more naive HMM in which emission distributions are maximum likelihood normal distributions. The nucleotide sequences required the model to learn 2,868 new 6-mer ionic current distributions with methylated bases in addition to the 1,784 canonical ones. We measured the per-read accuracy by the proportion of correct methylation calls on a single strand. The template reads had higher classification accuracy (74% and 80% mean and median accuracy, respectively) than the complement reads (67% and 76% mean and median accuracy, respectively), corroborating previous results on average sequence identity (<xref ref-type="fig" rid="F1">Figure 1A</xref>)<sup><xref rid="R19" ref-type="bibr">19</xref></sup>. The HMM-HDP performance was also significantly better than the simpler HMM(<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>). The HMM-HDP model classified different cytosines at accuracies ranging from 16% to 95% with median accuracy of 76% for template reads and 70% for the complement reads (<xref ref-type="fig" rid="F1">Figure 1B</xref>, <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>). Calling sites as unmodified cytosine is the most common error, with 5-mC being the most commonly miscalled variant (<xref ref-type="fig" rid="F1">Figure 1C</xref>, <xref ref-type="supplementary-material" rid="SD2">S2</xref>).</p>
  <p id="P8">We hypothesized that variability in sequence context accuracy results from ionic current distributions that vary only slightly between the methylation states. To test this hypothesis, we compared the mean pairwise Hellinger distance between the ionic current distributions of the 6-mers overlapping a site and the site’s classification accuracy (<xref ref-type="fig" rid="F1">Figure 1D</xref>). The Pearson correlation was 0.52 (p = 6.6E-33, t = 12.98, df = 445) on the template strand and 0.36 (p = 9.0E-15, t = 8.02, df = 445) on the complement strand (<xref ref-type="fig" rid="F2">Figure 2D</xref>, <xref ref-type="supplementary-material" rid="SD2">S3</xref>), suggesting that there is indeed a relationship between the similarity of the distributions and methylation calling accuracy.</p>
  <p id="P9">To test our method’s ability to map cytosine and adenine methylation in a controlled system, we sequenced pUC19 plasmid DNA grown in <italic>E. coli</italic> containing both <italic>dam</italic> and <italic>dcm</italic> methyltransferases. These substrates are completely methylated at C<bold>C</bold>(A/T)GG and G<bold>A</bold>TC motifs<sup><xref rid="R4" ref-type="bibr">4</xref></sup>. The mean per-read cytosine variant calling accuracy was 79% and 72% on the template and complement strands, respectively. The accuracy for calling adenine variants on the two strands was 70% and 58%. The ionic current of events mapped to cytosine motifs showed a more pronounced difference between methylation states than events mapped to adenine motifs (<xref ref-type="fig" rid="F2">Figure 2</xref>, top), likely contributing to the lower accuracy calling adenine variants.</p>
  <p id="P10">To assess the effect of variations in data quality among reads, we explored the relationship between the accuracy and the ungapped alignment score, a proxy for data variation. The variation in per-read accuracy was correlated with the ungapped alignment score (<xref ref-type="fig" rid="F2">Figure 2</xref>-bottom). To assess our method’s ability to call methylation variants with multiple reads, we randomly sampled 40× coverage and called cytosine and adenine variants. The best cutoff values classified 96% and 86% of the residues correctly for cytosine and adenine residues, respectively (<xref ref-type="supplementary-material" rid="SD1">Table S2A and B</xref>).</p>
  <p id="P11">To evaluate the model’s ability to classify 5-mC in a more realistic experimental setup, we mapped 5-mC at C<bold>C</bold>(A/T)GG motifs in <italic>E. coli</italic> gDNA and PCR-amplified DNA (pcrDNA). We evenly divided 3,418 constitutively methylated cytosines into a training and testing set. We assumed that none of cytosines in the DNA amplicons were methylated and that all of the cytosines in the gDNA were methylated. Based on these labels, the model was able to correctly classify 96% of the cytosines motifs in the test set (<xref ref-type="supplementary-material" rid="SD1">Table S2C</xref>).</p>
  <p id="P12">Chemical modifications to DNA happen post-replication, and they often depend on the state of the cell. One condition that is known to affect methylation levels in <italic>E. coli</italic> is growth phase<sup><xref rid="R4" ref-type="bibr">4</xref></sup>. We sequenced gDNA isolated from <italic>E. coli</italic> cultures harvested at three different growth phases: early-exponential (0.4 OD), late-exponential (0.8 OD), and stationary (24 hours). For cytosine classification, we used both template and complement reads and called 23,004 (95.5%), 23,789 (98.7%), and 24,034 (99.8%) of the cytosines as methylated in the early-exponential, late-exponential, and stationary-growth phases respectively. These results are consistent with previous studies that showed increasing levels of cytosine methylation from early-exponential phase growth through stationary phase growth (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD1">Table S3</xref>)<sup><xref rid="R20" ref-type="bibr">20</xref></sup>.</p>
  <p id="P13">In the adenine classification experiments, we only used template reads to assay for methylation levels because our previous experiments with pUC19 plasmid DNA showed that using only template reads gave the highest accuracy (<xref ref-type="supplementary-material" rid="SD1">Table S2A</xref>). The classifier called 33,930 (89%), 34,884 (91%), and 31,901 (83%) of the adenines as methylated in the early-exponential, late-exponential, and stationary growth phases respectively. Transcriptional levels of <italic>dam</italic> have been shown to reach a maximum during exponential phase growth, followed by a decrease during stationary phase growth<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R21" ref-type="bibr">21</xref></sup>. Our results are consistent with this pattern (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD1">Table S3</xref>). Details of how the models were evaluated are described in the <bold>Online Methods</bold>.</p>
  <p id="P14">Using the MinION’s ionic current signal, we achieved a median three-way cytosine methylation classification read accuracy of 80% on synthetic DNA. We tested our method in a model system by mapping 5-mC and 6-mA bases in <italic>E. coli</italic> gDNA and plasmid gDNA. We correctly mapped the methylation status of 96% of the cytosines in E. coli DNA and 86% of the adenines in pUC19 plasmid DNA with 20× and 40× coverage, respectively. To demonstrate the utility of the method in a dynamic system, we show that genome-wide changes in methylation at different growth phases in <italic>E. coli</italic> can be detected even with imperfect training data.</p>
  <p id="P15">We anticipate numerous applications for this method. For instance, it could be used to phase multiple base modifications simultaneously on long reads. In addition, since our method does not require any additional sample preparation, this information is available in any MinION sequencing experiment that uses gDNA. Lastly, changing the set of base modifications our model detects is straightforward as long as there is appropriate training data (<xref ref-type="supplementary-material" rid="SD2">Supplementary Discussion</xref>). We intend to develop and release models that detect a broader array of modifications in the future.</p>
  <sec id="S1">
    <title>Online Methods</title>
    <sec id="S2">
      <title>MinION sequencing</title>
      <p id="P16">The sequencing runs on synthetic oligonucleotides were performed in late 2015 using R7.3 chemistry (SQK-MAP006 sequencing kits). The R7.3 MinION sequencing protocol records ionic current at 3kHz and modeled event as corresponding to 6-mers. The pUC19 plasmid DNA, <italic>E. coli</italic> gDNA and pcrDNA were sequenced using R9 chemistry (EXP-NSK007 sequencing kits). The R9 version uses a different pore and increased sequencing speed. In this version of the protocol, the MinION samples ionic current at 4kHz and the events are modeled as 5-mers. We initially used a 6-mer lookup table for the R9 pore provided by ONT, then estimated our own 5-mer model from a collection of reads (<xref ref-type="supplementary-material" rid="SD2">Supplemental Information</xref> - Estimating emission distributions for R9 nanopores).</p>
    </sec>
    <sec id="S3">
      <title>Sequencing controlled synthetic DNA substrates containing C, 5-mC, or 5-hmC</title>
      <p id="P17">We used 897 bp synthetic DNA oligonucleotides from ZYMO Research (Catalog # D5405) that contain entirely C, 5-mC, or 5-hmC bases. Apart from the cytosines, the oligonucleotides have identical sequences. We performed sequencing experiments using R7.3 chemistry (SQK-MAP006 sequencing kits) with four MinION flow cells: one for each of the three substrates, and one where all the substrates were with barcoded with uniquely identifying sequences (EXP-NBD001 barcoding kit) and run together on one flow cell. The runs where the strands were sequenced individually produced 68,920, 27,073, and 70,641, reads for the C, 5-mC, and 5-hmC strands, respectively. The run where the strands were barcoded and sequenced together produced 6,966, 294, and 467 reads for the C, 5-mC, and 5-hmC strands, respectively. The reads spanned the full length of the substrate. All models were trained on the reads where the strands were run in separate flow cells. The bar-coded reads served as our test dataset. This experimental design maximized the amount of training data while controlling for batch effects between MinION runs. Sequence data were processed using Metrichor (versions 1.15.0 and 1.19.0), and only “pass” 2D reads that covered the full length of the reference sequence were used for downstream analysis</p>
    </sec>
    <sec id="S4">
      <title>Preparation of DNA control substrates containing 6-mA and 5-mC</title>
      <p id="P18">We purchased pUC19 vector DNA from New England Biolabs (NEB cat. number N3041S). This DNA is isolated from <italic>E. coli</italic> strain ER2272 that contains genes methyltransferase (MTase) genes <italic>dam</italic> and <italic>dcm</italic>. The <italic>dam</italic> MTase methylates the adenine in G<bold>A</bold>TC sequence contexts and the <italic>dcm</italic> MTase methylates the inner cytosine at C<bold>C</bold>(A/T)GG sequence contexts (bold letter indicating methylated position). We linearized the plasmid by restriction digest at a unique SspI (NEB cat. number R0132S) restriction site. The linearized plasmid was purified by excising the band from an agarose gel following electrophoresis. The DNA was eluted from the gel using the Wizard SV kit (Promega) as per manufacturer's instructions. To generate an unmethylated substrate, we PCR amplified the plasmid with primers around the SspI restriction site (forward: 5′ ATT ATT GAA GCA TTT ATC AGG GTT ATT GTC, reverse: 5′ ATT GAA AAA GGA AGA GTA TGA GTA TTC AAC) with Q5 high-fidelity polymerase master mix (NEB cat. number M0492S) as per the manufacturer's specifications. The PCR reaction was purified with 0.4× AMPure SPRI beads using standard procedures.</p>
    </sec>
    <sec id="S5">
      <title>Sequencing for pUC19 plasmid DNA</title>
      <p id="P19">We sequenced the methylated plasmid and an unmethylated PCR amplicon in the same flow cell (see Methods). The pUC19 DNA sequence is 2,686 bp long. It contains 30 adenine residues in GATC motifs and 10 cytosines at CC(A/T)GG motifs. The motifs are palindromic, so they each contain two potentially modified residues: one on each strand. The reads covered the entire length of the substrate.</p>
      <p id="P20">The purified PCR-amplified and linear pUC19 DNA were individually barcoded (EXP-NBD002 barcoding kit). Roughly equimolar amounts of the barcoded material was combined and sequenced on the MinION using R9 chemistry (NSK-007 sequencing kit). The sequencing run produced 27,293 and 17,220 pass 2D reads in the pcrDNA and gDNA, respectively.</p>
    </sec>
    <sec id="S6">
      <title>Data selection and partitioning for experiments with pUC19 DNA</title>
      <p id="P21">Reads that covered the entire length of the plasmid sequence were shuffled and 40% of the reads were used to train the models and the remaining 60% for testing (see <italic>Supervised training of model parameters</italic>). For methylation variant calling, 40 full-length reads were randomly selected from the test read alignments and used to call the methylation status of the adenines and cytosines in the reference. This process was iterated 100 times to generate an error rate distribution.</p>
    </sec>
    <sec id="S7">
      <title>Sequencing for genomic and amplified <italic>E. coli</italic> DNA</title>
      <p id="P22">We performed one sequencing run using standard procedures on genomic gDNA from <italic>E. coli</italic> strain K-12 MG1655 (DSMZ) and another run on DNA that was pcrDNA using a whole-genome amplification kit (Qiagen REPLI-g). Both runs were done independently using R9 chemistry (EXP-NSK007 sequencing kits). The gDNA run produced 18,177 pass 2D reads (132 Mb) with an average read length of 7.3 kb. The pcrDNA run produced 61,408 pass 2D reads (387 Mb) with an average read length of 6.3 kb. The reads were shuffled and evenly divided into two groups, one was used for training the model and the other for classification experiments.</p>
    </sec>
    <sec id="S8">
      <title>Data selection and partitioning for experiments with <italic>E. coli</italic> DNA</title>
      <p id="P23">Previous research has mapped the locations of 5-mC on the CC(A/T)GG motifs using bisulfite sequencing<sup><xref rid="R20" ref-type="bibr">20</xref>20</sup>. These data reported 1,709 high-confidence methylated motifs in stationary phase cells. We divided the motifs into a training group and test group. Care was taken to be sure that k-mers in the test group were observed in the training group (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Dividing <italic>E. coli</italic> methylation motifs into training and test groups). The HDP-HMM was trained on alignments generated with pcrDNA reads supplemented with events from gDNA reads that aligned to the high-confidence methylated sites from the training group. We used the trained model to classify the methylation status of cytosines in the test group motifs from the held out portion of reads from the pcrDNA and gDNA sequencing runs.</p>
      <p id="P24">The models used in the growth phase experiments were trained it on all 3,418 known-methylated cytosines. We trained the model on reads from stationary phase genomic DNA and PCR amplified DNA. We evaluated the model by classifying the 3,418 known cytosines, accuracy and precision were 96% and 92%, respectively. To train the adenine classification model we labeled all adenines at G<bold>A</bold>TC sites in the <italic>E. coli</italic> genome as methylated in reads from stationary phase cells (see <xref ref-type="supplementary-material" rid="SD2">Supplemental Information</xref> - Adenine classification with approximate labels). In total, we classified 24,100 cytosines at C<bold>C</bold>(A/T)GG motifs and 38,248 adenines at G<bold>A</bold>TC motifs. To directly evaluate the accuracy of the model we called variants on the pUC19 plasmid using the procedure described previously. The model had an estimated accuracy and precision of 87(+/−)3% and 84(+/−)4%, respectively. However, the pUC19 sequence does not contain all of the GATC contexts in the <italic>E. coli</italic> genome, so this measure of accuracy may not fully generalize. Our results are also concordant with previously described results using SMRT sequencing (see <xref ref-type="supplementary-material" rid="SD2">Supplementary Discussion</xref>).</p>
    </sec>
    <sec id="S9">
      <title>Hierarchical Dirichlet process mixture model</title>
      <p id="P25">The HDP mixture is a statistical model in which a collection of mixture distributions are composed of a countably infinite set of shared mixture components. The weights of the components in each mixture distribution are determined according to a separate Dirichlet process on the shared collection of components<sup><xref rid="R19" ref-type="bibr">19</xref></sup>. In addition, the mixture components themselves are distributed according to a Dirichlet process that draws components from a base distribution (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Hierarchical Dirichlet Process Mixture Model for Ionic Current Distributions). In our model, the base distribution is the normal-inverse gamma distribution, which is a conjugate prior to the normal distribution (that is, to the mixture components).</p>
      <p id="P26">Sharing mixture components statistically shrinks our estimates of the current distributions toward each other (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Grouping 6-mers with different HDP topologies). This boosts statistical strength since each distribution can share the information learned by the others. We also have the option of adding a further layer of Dirichlet processes between the Dirichlet process that generates the distribution over shared components and the Dirichlet processes that generate the k-mer distributions (<xref ref-type="supplementary-material" rid="SD2">Figure S1D</xref>). This encourages a greater degree of shrinkage within each subtree. We experimented with several topologies for this tree, each representing a different grouping of k-mers based on their sequence composition (see <italic>Structure of the hierarchical Dirichlet process</italic>).</p>
    </sec>
    <sec id="S10">
      <title>Structure of variable-order hidden Markov model</title>
      <p id="P27">Our HMM is structured to allow alignment of multiple different bases at a given position in the reference sequence. We term these positions <italic>ambiguous positions</italic>. Positions in the reference are designated ambiguous before the alignment begins. In three-way classification experiments on synthetic oligonucleotides, we allow for C, 5-mC, and 5-hmC to be aligned to a given cytosine. In two-way classification experiments, the model is restricted to C and 5-mC or A and 6-mA in the cases of alignment to cytosine and adenine, respectively. These experiments also restrict ambiguous sites to the known methylation motifs.</p>
      <p id="P28">The fact that each event corresponds to multiple positions in the reference means that more than one event reports on a single ambiguous position. Accordingly, we tie the probabilities of consistent methylation variant calls by configuring our HMM in a variable-order meta-structure that allows for multiple paths over a reference k-mer depending on the number of methylation possibilities (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Variable-Order Hidden Markov Model). The dynamic programming matrix has high-dimensional cells to accommodate these paths. We restrict the recursion by only allowing transitions if the bases in positions 2-k in the first k-mer are identical to the bases at positions 1-(k-1) in the second k-mer (<xref ref-type="supplementary-material" rid="SD2">Figure S1B, Figure S5</xref>). The joint probability for the read’s event sequence and the reference is calculated with the forward-backward algorithm, and the likelihood of each methylation variant at each ambiguous position is calculated by marginalizing over the HMM’s states. We treat the template and complement event sequences as independent, so a given event sequence is aligned to the appropriate nucleotide sequence and reports on only the cytosines in that strand. To make methylation variant calls using multiple reads, the variant with the greatest posterior mean given the reads is called.</p>
    </sec>
    <sec id="S11">
      <title>Structure of the hierarchical Dirichlet process</title>
      <p id="P29">The HDP bolsters its statistical strength by sharing information between the set of distributions it estimates. In effect, this encourages the distributions to be more similar to each other than if they were modeled independently. The HDP model also can encourage a greater degree of similarity between pre-specified subgroups of distributions (see Methods and <xref ref-type="supplementary-material" rid="SD2">Supplemental Information</xref> - Grouping 6-mers with different HDP topologies). This can increase statistical strength further, assuming that the subgroups reflect clusters of similarity in the true distributions.</p>
      <p id="P30">Since the biophysical relationship between each given k-mer sequence and the observed ionic current distribution is poorly understood, we empirically tested whether different subgroupings would increase statistical strength using reads from the synthetic oligonucleotides. We tested HDP models with five different subgroupings of 6-mers. The two-level HDP does not separate them into any subgroups (<xref ref-type="supplementary-material" rid="SD2">Figure S1C</xref>), whereas the rest of the models group 6-mers by features of their 6-mer sequence (<xref ref-type="supplementary-material" rid="SD2">Figure S1D</xref>). The “Multiset” HDP. The “Composition” HDP groups 6-mers by how many purines and pyrimidines they contain. The “MiddleNucleotides” HDP groups 6-mers based on the center two bases in the 6-mer. Finally, the “GroupMultiset” HDP groups the 6-mers by their nucleotide content without regard to their order or their methylation status. The best performing model was the “Multiset” model (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>, <bold>Online Methods</bold>). Although it was a small gain in accuracy over the simpler ungrouped model, we used the “Multiset” model for all further analyses.</p>
    </sec>
    <sec id="S12">
      <title>Mapping of reads and event alignment</title>
      <p id="P31">We align the ionic current events from each read to the reference sequence in a two step process. First we generate a guide alignment between the read’s nucleotide sequence and the reference, which we then use to constrain a second alignment of events to the reference. The guide alignment uses a concatenated sequence from Metrichor’s ‘2D alignment’ table, which allows for each base to be mapped to an event in the template and complement event sequence (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Making a read sequence from the 2D alignment table). This nucleotide sequence is aligned to the reference with BWA-MEM in ont2d mode<sup><xref rid="R22" ref-type="bibr">22</xref></sup>. Runs of consecutive matches in the guide alignment serve as anchors for the event sequence alignment. The anchors are mapped back to events in the template and complement event sequences. The dynamic programming is constrained by these anchors similar to the method described by Paten et al.<sup><xref rid="R23" ref-type="bibr">23</xref></sup> (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Banded alignment). The template and complement event sequences are independently aligned to the reference using the HMM described below.</p>
    </sec>
    <sec id="S13">
      <title>Computing posterior probabilities of alignments and ungapped alignment scores</title>
      <p id="P32">Our HMM takes the event sequences as input and aligns them to a reference nucleotide sequence. Let <italic>x<sub>i</sub></italic> be a k-mer in the reference sequence <italic>S</italic>, and <italic>e<sub>j</sub></italic> be an event in the event sequence <italic>E</italic>, and <italic>e<sub>j</sub> x<sub>i</sub></italic> mean that event <italic>e<sub>j</sub></italic> is aligned to k-mer <italic>x<sub>i</sub></italic>. The model calculates <italic>P</italic>(<italic>e<sub>j</sub> x<sub>i</sub></italic>|<italic>E, S, Θ</italic>), the posterior probability for event/k-mer aligned pairs given the model <italic>Θ</italic>. We also leverage the posterior probabilities to compute a measure of alignment quality, the ungapped alignment score, U.A.S., which is defined as
<disp-formula id="FD1"><mml:math id="M1" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>◊</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:math></disp-formula>where <italic>N</italic> is the total number of aligned pairs in the alignment <italic>π</italic>.</p>
    </sec>
    <sec id="S14">
      <title>Generating preliminary alignments without consideration for methylation status</title>
      <p id="P33">ONT provides a lookup table of parameters describing normal distributions that they use characterizes the current distributions of the 4096 canonical base 6-mers both for R7.3 and R9 sequencing protocols. In the case of R9, however, we estimated a new 5-mer lookup table for the 1,024 canonical k-mers (<xref ref-type="supplementary-material" rid="SD2">Supplemental Information</xref> - Estimating emission distributions for R9 nanopores). We leverage this table to heuristically initialize the emission distributions in our HMM-HDP over the expanded alphabet. To do so, we generate a preliminary alignments using the lookup table and then infer the methylation status of the events based on their flow cell or barcode. We can then use high probability aligned pairs from this alignment to train the emission distributions of the HMM-HDP, for more details see <xref ref-type="supplementary-material" rid="SD2">Supplemental Information</xref> - Training the HMM-HDP model.</p>
    </sec>
    <sec id="S15">
      <title>Supervised training of model parameters</title>
      <p id="P34">We train the HMM with a variant of the Baum-Welch procedure. First, we heuristically initialize the emission distributions by training them on aligned events above a probability threshold (0.9 for the synthetic oligonucleotides and 0.8 for the <italic>E. coli</italic> and plasmid DNA) from the preliminary alignment described above. In the three-way classification control experiments on synthetic oligonucleotides using normal distributions, this entails calculating the maximum likelihood normal distribution for each 6-mer. For the HMM-HDP, we estimate the posterior mean density for each k-mer’s distribution using a Markov chain Monte Carlo (MCMC) algorithm (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Training the HMM-HDP model). In both cases, only the distributions for the ionic current means are learned following the preliminary alignment. A separate neural net experiment suggested that the event noise did not add to classification accuracy (<xref ref-type="supplementary-material" rid="SD2">Supplementary Methods</xref> - Classification of Ionic Current Events with Neural Networks). At this step, we also re-estimate the HMM’s transition probabilities independently. We then produce new alignments and re-estimate the emission distributions from high confidence assignments as in the initialization. This process is iterated until the model’s variant calling accuracy stops improving.</p>
      <p id="P35">The MCMC algorithm we use for the HDP is the Chinese Restaurant Franchise Algorithm, a Gibbs sampler for HDP mixture models<sup><xref rid="R18" ref-type="bibr">18</xref>18</sup>. We discard a number of burn-in iterations equal to 30-times the total number of assignment data points and then collect 10,000 samples, thinning sampling iterations by 100. Whenever we record samples from the Markov chain, we evaluate the posterior predictive distribution for each 6-mer at a grid of 1200 evenly spaced points in the interval between 30 pA and 90 pA for R7.3. For R9 experiments we use a grid of 1800 evenly spaced points in the interval between 50 pA and 140 pA. After sampling, we compute our estimate of the posterior mean density as the mean of the sampled densities at each grid point. Subsequently, we interpolate within the grid using natural cubic splines.</p>
    </sec>
    <sec id="S16">
      <title>Code availability</title>
      <p id="P36">All relevant code can be accessed at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ArtRand/signalAlign">https://github.com/ArtRand/signalAlign</ext-link>. Code for reproducing results and examples of how to use the described model can be found at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ArtRand/CytosineMethylationAnalysis">https://github.com/ArtRand/CytosineMethylationAnalysis</ext-link>.</p>
    </sec>
    <sec id="S17">
      <title>Data availability</title>
      <p id="P37">All generated <italic>E. coli</italic>, pUC19, and synthetic oligo data is available upon request.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS847619-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d36e755" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS847619-supplement-2.pdf" orientation="portrait" xlink:type="simple" id="d36e759" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S18">
    <p id="P38">Research reported in this publication was supported by the National Human Genome Research Institute of the US National Institutes of Health under award numbers HG006321 (M.A.), HG007827 (M.A.) and 5U54HG007990 (B.P.).</p>
  </ack>
  <fn-group>
    <fn id="FN2" fn-type="con">
      <p id="P39">Author contributions</p>
      <p id="P40">B.P. conceived of the experiments. B.P. and M.A. directed the research. A.C.R. implemented the models and performed analysis. M.J. and H.E.O. performed the sequencing experiments and performed sequence data analysis. J.M.E. implemented the HDP model and Gibbs sampler. A.M-B. performed initial experiments. All authors contributed to writing the manuscript.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN3">
      <p id="P41">Competing financial interests</p>
      <p id="P42">M.A. is a consultant to Oxford Nanopore Technologies.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schübeler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Function and information content of DNA methylation</article-title>
        <source>Nature</source>
        <volume>517</volume>
        <fpage>321</fpage>
        <lpage>326</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25592537</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation: roles in mammalian development</article-title>
        <source>Nat. Rev. Genet</source>
        <volume>14</volume>
        <fpage>204</fpage>
        <lpage>220</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">23400093</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sánchez-Romero</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Cota</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Casadesús</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation in bacteria: from the methyl group to the methylome</article-title>
        <source>Curr. Opin. Microbiol</source>
        <volume>25</volume>
        <fpage>9</fpage>
        <lpage>16</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25818841</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinus</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Løbner-Olesen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DNA Methylation</article-title>
        <source>EcoSal Plus</source>
        <volume>6</volume>
        <year>2014</year>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinus</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Casadesus</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Roles of DNA adenine methylation in host-pathogen interactions: mismatch repair, transcriptional regulation, and more</article-title>
        <source>FEMS Microbiol. Rev</source>
        <volume>33</volume>
        <fpage>488</fpage>
        <lpage>503</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19175412</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenetic Switch Driven by DNA Inversions Dictates Phase Variation in Streptococcus pneumoniae</article-title>
        <source>PLoS Pathog</source>
        <volume>12</volume>
        <fpage>e1005762</fpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27427949</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greer</surname>
            <given-names>EL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA Methylation on N6-Adenine in C. elegans</article-title>
        <source>Cell</source>
        <volume>161</volume>
        <fpage>868</fpage>
        <lpage>878</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25936839</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flusberg</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct detection of DNA methylation during single-molecule, real-time sequencing</article-title>
        <source>Nat. Methods</source>
        <volume>7</volume>
        <fpage>461</fpage>
        <lpage>465</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20453866</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frommer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A genomic sequencing protocol that yields a positive display of 5-methylcytosine residues in individual DNA strands</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A</source>
        <volume>89</volume>
        <fpage>1827</fpage>
        <lpage>1831</lpage>
        <year>1992</year>
        <pub-id pub-id-type="pmid">1542678</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Waldor</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>Entering the era of bacterial epigenomics with single molecule real time DNA sequencing</article-title>
        <source>Curr. Opin. Microbiol</source>
        <volume>16</volume>
        <fpage>192</fpage>
        <lpage>198</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">23434113</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>NR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A role for the bacterial GATC methylome in antibiotic stress survival</article-title>
        <source>Nat. Genet</source>
        <year>2016</year>
        <pub-id pub-id-type="doi">10.1038/ng.3530</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beaulaurier</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single molecule-level detection and long read-based phasing of epigenetic variations in bacterial methylomes</article-title>
        <source>Nat. Commun</source>
        <volume>6</volume>
        <fpage>7438</fpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26074426</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Booth</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Oxidative bisulfite sequencing of 5-methylcytosine and 5-hydroxymethylcytosine</article-title>
        <source>Nat. Protoc</source>
        <volume>8</volume>
        <fpage>1841</fpage>
        <lpage>1851</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">24008380</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saletore</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The birth of the Epitranscriptome: deciphering the function of RNA modifications</article-title>
        <source>Genome Biol</source>
        <volume>13</volume>
        <fpage>175</fpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">23113984</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wescoe</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Nanopores discriminate among five C5-cytosine variants in DNA</article-title>
        <source>J. Am. Chem. Soc</source>
        <volume>136</volume>
        <fpage>16582</fpage>
        <lpage>16587</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25347819</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laszlo</surname>
            <given-names>AH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection and mapping of 5-methylcytosine and 5-hydroxymethylcytosine with nanopore MspA</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A</source>
        <volume>110</volume>
        <fpage>18904</fpage>
        <lpage>18909</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">24167255</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ip</surname>
            <given-names>CLC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MinION Analysis and Reference Consortium: Phase 1 data release and analysis</article-title>
        <source>F1000Res</source>
        <volume>4</volume>
        <fpage>1075</fpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26834992</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teh</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical Dirichlet Processes</article-title>
        <source>J. Am. Stat. Assoc</source>
        <volume>101</volume>
        <fpage>1566</fpage>
        <lpage>1581</lpage>
        <year>2006</year>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved data analysis for the MinION nanopore sequencer</article-title>
        <source>Nat. Methods</source>
        <volume>12</volume>
        <fpage>351</fpage>
        <lpage>356</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25686389</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kahramanoglou</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomics of DNA cytosine methylation in Escherichia coli reveals its role in stationary phase transcription</article-title>
        <source>Nat. Commun</source>
        <volume>3</volume>
        <fpage>886</fpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22673913</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seshasayee</surname>
            <given-names>ASN</given-names>
          </name>
        </person-group>
        <article-title>An Assessment of the Role of DNA Adenine Methyltransferase on Gene Expression Regulation in E coli</article-title>
        <source>PLoS One</source>
        <volume>2</volume>
        <fpage>e273</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17342207</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Herrero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Sequence progressive alignment, a framework for practical large-scale probabilistic consistency alignment</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>295</fpage>
        <lpage>301</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19056777</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p id="P43">Cytosine methylation variant calling accuracy results on synthetic oligonucleotides. Results are from classification of 6,966, 294, and 467, C, 5-mC, and 5-hmC strands respectively that were barcoded and sequenced in the same MinION flow cell. A. Per-read accuracy distribution is shown for the maximum-likelihood estimate (MLE) normal distributions and the ‘Multiset’ HDP model. The triangles represent the mean of the distribution. B. Average three-way classification accuracy for all sites on the substrate. Dotted lines represent the mean across all sites for template (blue) and complement reads (green). C. Confusion matrix showing HMM-HDP three-way cytosine classification performance on template reads of synthetic oligonucleotides. D. Scatter plot showing the correlation between the log-odds of correct classification and the mean pairwise Hellinger distance between the methylation statuses of the 6-mer distributions overlapping a cytosine.</p>
    </caption>
    <graphic xlink:href="nihms847619f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p id="P44">Observed and learned ionic current distributions and read accuracy correlation with ungapped alignment score for 6-mA in GATC motifs (left) and 5-mC in CC(A/T)GG motifs (right). Top: Comparison of the influence of 6-mA and 5-mC on ionic current levels for representative 5-mers. The empirical ionic current levels from 100 aligned events are shown as a normalized histogram and the HDP-learned probability densities were are shown as curves. The HDP density was sampled on 900 point grid from 50 to 140 pA. Bottom. Correlation between ungapped alignment score (see Methods) and per-read accuracy for 500 randomly sampled template reads.</p>
    </caption>
    <graphic xlink:href="nihms847619f2"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p id="P45">Changes in genome-wide cytosine methylation at different stages of culture growth. Bar height represents the percentage of residues that were called as methylated. Axes are broken to accentuate differences between the growth phases.</p>
    </caption>
    <graphic xlink:href="nihms847619f3"/>
  </fig>
</floats-group>
