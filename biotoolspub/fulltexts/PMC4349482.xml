<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4349482</article-id>
    <article-id pub-id-type="publisher-id">486</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0486-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BiNChE: A web tool and library for chemical enrichment analysis based on the ChEBI ontology</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Moreno</surname>
          <given-names>Pablo</given-names>
        </name>
        <address>
          <email>pmoreno@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Beisken</surname>
          <given-names>Stephan</given-names>
        </name>
        <address>
          <email>beisken@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harsha</surname>
          <given-names>Bhavana</given-names>
        </name>
        <address>
          <email>bh4@sanger.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Muthukrishnan</surname>
          <given-names>Venkatesh</given-names>
        </name>
        <address>
          <email>venkat@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tudose</surname>
          <given-names>Ilinca</given-names>
        </name>
        <address>
          <email>tudose@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dekker</surname>
          <given-names>Adriano</given-names>
        </name>
        <address>
          <email>adekker@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dornfeldt</surname>
          <given-names>Stefanie</given-names>
        </name>
        <address>
          <email>stefanie.dornfeldt@student.uni-halle.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Taruttis</surname>
          <given-names>Franziska</given-names>
        </name>
        <address>
          <email>franziska_taruttis@yahoo.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grosse</surname>
          <given-names>Ivo</given-names>
        </name>
        <address>
          <email>grosse@informatik.uni-halle.de</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hastings</surname>
          <given-names>Janna</given-names>
        </name>
        <address>
          <email>hastings@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Neumann</surname>
          <given-names>Steffen</given-names>
        </name>
        <address>
          <email>steffen.neumann@ipb-halle.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Steinbeck</surname>
          <given-names>Christoph</given-names>
        </name>
        <address>
          <email>steinbeck@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><label/>Cheminformatics and Metabolism, European Molecular Biology Laboratory - European Bioinformatics Institute, Cambridge, UK </aff>
      <aff id="Aff2"><label/>Dept. of Stress- and Developmental Biology, Leibniz Institute of Plant Biochemistry, Halle, Germany </aff>
      <aff id="Aff3"><label/>Dept. of Statistical Bioinformatics, Institute for Functional Genomics, University of Regensburg, Halle, Germany </aff>
      <aff id="Aff4"><label/>Institute of Computer Science, Martin Luther University Halle-Wittenberg, Halle, Germany </aff>
      <aff id="Aff5"><label/>German Centre for Integrative Biodiversity Research (iDiv) Halle-Jena-Leipzig, Leipzig, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <issue>1</issue>
    <elocation-id>56</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>10</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Moreno et al.; licensee BioMed Central. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Ontology-based enrichment analysis aids in the interpretation and understanding of large-scale biological data. Ontologies are hierarchies of biologically relevant groupings. Using ontology annotations, which link ontology classes to biological entities, enrichment analysis methods assess whether there is a significant over or under representation of entities for ontology classes. While many tools exist that run enrichment analysis for protein sets annotated with the Gene Ontology, there are only a few that can be used for small molecules enrichment analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We describe BiNChE, an enrichment analysis tool for small molecules based on the ChEBI Ontology. BiNChE displays an interactive graph that can be exported as a high-resolution image or in network formats. The tool provides plain, weighted and fragment analysis based on either the ChEBI Role Ontology or the ChEBI Structural Ontology.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>BiNChE aids in the exploration of large sets of small molecules produced within Metabolomics or other Systems Biology research contexts. The open-source tool provides easy and highly interactive web access to enrichment analysis with the ChEBI ontology tool and is additionally available as a standalone library.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0486-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Ontology</kwd>
      <kwd>Enrichment</kwd>
      <kwd>Small molecules</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>High-throughput “omics” research produces large sets of data for genes, proteins, and metabolites. Ontology-based enrichment analysis helps to investigate and filter these data sets by assigning meanings to statistical patterns found. Ontologies are hierarchies of biologically relevant groupings such as processes, functions, or activities. Ontology annotations link ontology classes to the biological entities that are known to belong to those groupings or participate in those processes, functions or activities. For example, the Gene Ontology (GO [<xref ref-type="bibr" rid="CR1">1</xref>]) provides hierarchies of cellular compartments, biological processes, and molecular functions. GO annotations link genes and proteins to those GO classes where the genes are expressed, which processes they participate in, and which functions they bear. Enrichment analysis methods assess whether there is a significant over or under representation of entities for ontology classes, when compared to a background population representing the null hypothesis that the data are not enriched for that class. No classes would be found to be enriched if, for example, the measured biological entities’ annotations were found to be evenly distributed between all available ontology classes, or proportionately according to the known biological distribution for the measured sample (as represented in the proportionality of the background annotation set).</p>
    <p>Many enrichment analysis tools have been designed for use with genes or proteins and the GO, including GOMiner, FatiGO, BiNGO and GSEA. For a review, please see Huang <italic>et al.</italic> [<xref ref-type="bibr" rid="CR2">2</xref>]. These tools take as input lists of gene or protein identifiers and test for enrichment of GO classes against the background of the full set of GO annotations. With the advent of small molecule high throughput data arising from metabolomics – the study of the chemical processes involving metabolites by measuring the presence and quantity of different chemicals in biological samples – similar tools are now needed for small molecules.</p>
    <p>ChEBI (Chemical Entities of Biological Interest) is a manually curated database and ontology that organizes small molecule knowledge [<xref ref-type="bibr" rid="CR3">3</xref>]. ChEBI offers both an ontology of chemical structural classes, such as carboxylic acid and steroid, and a role ontology in which biological and chemical activity classes are organized, such as toxin and solvent. ChEBI also contains fully specifed small molecules at the leaf level of the structural hierarchy – i.e. those that might be measured in metabolomics experiments – such as proline and caffeine. Molecules are linked to structural classes with the <italic>is_a</italic> relation and to functional classes with the <italic>has_role</italic> relation. For example, cefpodoxime (CHEBI:3504) <italic>is_a</italic> carboxylic acid (CHEBI:33575) and <italic>has_role</italic> antibiotic (CHEBI:22582). ChEBI’s chemical ontology straightforwardly allows enrichment analysis techniques to be transferred to the case of small molecules. Here, we present BiNChE, an enrichment analysis tool for the ChEBI ontology. It is available online at http://www.ebi.ac.uk/chebi/tools/binche/ and as open source software libraries (<ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNChE">https://github.com/pcm32/BiNChE</ext-link>
and <ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNCheWeb">https://github.com/pcm32/BiNCheWeb</ext-link>).</p>
    <p>BiNChE is not the first chemical enrichment analysis service. MSEA [<xref ref-type="bibr" rid="CR4">4</xref>] was the first small molecule enrichment analysis service, but it only used collections of small molecules that were considered relevant, rather than chemical ontologies with their richer structure. MBRole [<xref ref-type="bibr" rid="CR5">5</xref>] was the first small molecule enrichment analysis service to harness ChEBI’s ontology for enrichment. While MBRole now provides a number of different chemical knowledge organization schemes for enrichment analysis, including ChEBI, it displays the results as a plain table, losing the richness of the structure in the underlying ontologies. BiNChE, by contrast, returns graph results and offers a rich visualisation interface. Neither does MBRole include weighted analysis, that is, the ability to influence the enrichment analysis through the inclusion of intensity values, fold-changes or <italic>p</italic>-values as weights for the molecules – an option offered by BiNChE.</p>
    <p>Chemical enrichment analysis is also possible with non-dedicated tools. BiNGO [<xref ref-type="bibr" rid="CR6">6</xref>] is a plugin for Cytoscape that is widely used for protein enrichment analysis and generates interactive graph-based outputs which mimic the structure of the input ontology. BiNGO can be used with ontologies other than the GO, including a chemical ontology, such as ChEBI. However, this requires the manual generation of ontology and annotation files in the custom BiNGO format, which is not straightforward for most users, and the use of the Cytoscape desktop application, rather than being available as a Web utility. The National Center for Biomedical Ontology (NCBO) has also developed an ontology-neutral enrichment analysis tool [<xref ref-type="bibr" rid="CR7">7</xref>], but that is available exclusively by web service, i.e. there is no associated graphical user interface, and the output it provides is either a tag cloud image (sized for relative frequency) or XML, lacking detail from the source ontology and the statistical significance of the enrichment.</p>
    <p>Performing an enrichment analysis with ChEBI has additional subtleties when compared to the GO, further hindering the applicability of generic tools to the chemical case. Firstly, ChEBI includes actual small molecules at the leaf level, while the GO does not include genes or proteins. Thus, ChEBI contains both complex class definitions and content that is analogous to GO annotations. Secondly, while the GO is available in separate files for its three main branches, and in slimmed versions that facilitate enrichment analysis, the ChEBI ontology is only available as a single ontology file that includes the roles and the structural classification. ChEBI also includes parts that are irrelevant for small molecule enrichment analyses, such as sub-atomic particles. All of these issues are solved by BiNChE. In contrast to BiNChE, the use of generic enrichment analysis tools would require manual pre-processing of the ChEBI ontology to remove irrelevant parts of the ontology such as small molecules and sub-atomic particles. Subsequently one would also have to produce a file which annotates each queried ChEBI entity with its ChEBI ontology ancestor terms in order to resemble the use case expected by these tools where proteins are given that have annotated Gene Ontology terms.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>BiNChE is implemented in Java version 1.6, starting from the open source code of BiNGO. The application is divided into two projects (with no duplication of code between them): a core engine, which can be used as an standalone desktop application or as a Java library for integration with other projects; and a web application, which displays the enrichment analysis results through an interactive visualization of the ChEBI ontology. The graph based visualization relies on CytoscapeWeb [<xref ref-type="bibr" rid="CR8">8</xref>] for rendering and provides export functions to generate publication quality images. Results can be also retrieved in tabular and network data formats.</p>
    <p>The web-based display of the results (Figure <xref rid="Fig1" ref-type="fig">1</xref>) enables the user to modify the resulting enrichment graph through manual re-arrangements and built-in layout algorithms. Nodes representing ChEBI entities display additional information when hovered over. These include the name of the entity, ChEBI identifier, p-value of the binomial test, corrected p-value for multiple hypothesis testing, percentage of the sample that is contained within the ontology term, and the fold of enrichment. The fold of enrichment is the ratio between the enrichment in the sample and enrichment in the background population. Additional color formatting and the ability to selectively hide nodes based on different criteria improves the visualization of interesting parts of the network. A contextual menu with a link to the ChEBI entity web entry, as well as other operations such as the selection of descendants can be triggered by right-clicking the nodes. These features are shown in detail in the wiki (<ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#graphical-exploration-of-results">https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#graphical-exploration-of-results</ext-link>) and in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Screenshot of a result graph from the BiNChE web interface.</bold> Screenshot of a result graph from the BiNChE web interface. Highly enriched nodes are shown in red (increasing transparency as significance decreases). The interface allows selection of nodes (shown in blue) either manually or through right click functions (such as “Select Descendants”). The graph can be exported in different formats, zoomed, and its layout altered manually or through automated algorithms. Nodes and labels can be hidden.</p></caption><graphic xlink:href="12859_2015_486_Fig1_HTML" id="MO1"/></fig></p>
    <p>The tool performs three main types of enrichment analysis: weighted, plain (i.e. unweighted) and fragment. The plain analysis requires a list of ChEBI identifiers to be submitted, and relies on a binomial test to define whether the provided list is enriched for any ChEBI classes. The test is executed – as in any ontology-based enrichment analysis – for each class in the ontology and can be subdivided into a couple of steps that result in a p-value for each term.</p>
    <p>A ‘trial’ corresponds to checking whether one of the queried ChEBI identifiers belongs to the ChEBI class being tested. A ‘success’ is registered when the queried ChEBI identifier does belong to the ontology class. The probability of success is given by the total number of possible ChEBI identifiers that belong to that particular ChEBI ontology class, divided by the total number of classes of the ChEBI ontology. It is noteworthy that this implies that the same number of successes within two different ChEBI ontology classes does not guarantee the same level of enrichment, as the level of enrichment also depends on the population-based probability.</p>
    <p>For the weighted analysis, the tool accepts as input a list of ChEBI identifiers accompanied by real numbers from 0 to 1 – the <italic>weights</italic> – which can represent intensities or any measurement that reflects differential relevance of the small molecules in an experiment. This type of enrichment uses an implementation of the SaddleSum algorithm [<xref ref-type="bibr" rid="CR9">9</xref>], which assesses the significance of a <italic>weight</italic> accumulation within an ontology class, drawing a background weight distribution from the complete list of <italic>weights</italic> provided.</p>
    <p>The fragment analysis is a special case of weighted analysis, where only the chemical structure branch of the ontology is used. “Fragments” should be understood as molecular fragments or functional groups. Data would typically come from fragmentation mass spectrometry experiments. ChEBI roles are not relevant for the targeted use case of determining candidate structures for a measured spectrum. This analysis uses different pruning strategies on the resulting graph to highlight molecular entities that are enriched. In contrast to the standard weighted analysis option, terminal molecular leaves or root vertices are not removed.</p>
    <p>Results are corrected for multiple hypothesis testing using Benjamini &amp; Hochberg’s false-discovery rate, which is widely used by most enrichment analysis tools and in general whenever a hypothesis test is repeated many times. A hypothesis test implies a small risk of false positive errors occurring. For a single test the likelihood of such a false positive is normally acceptable, but the repeated execution of a test – in this case, for each class in the ontology – means that the likelihood of such an error accumulates, leading to an unacceptably high probability of false positives. That is, an ontology class may appear significantly enriched for a given input set when it is not. Multiple hypothesis testing correction mechanisms aim to reduce the risk of false positives to an acceptable level.</p>
    <p>Currently the enrichment is calculated taking the entire ontology as background population, which is the default offered by the underlying BiNGO implementation.</p>
    <p>The enrichment analysis may be executed with the full ChEBI ontology, although for the results visualisation BiNChE uses only the <italic>is_a</italic> and <italic>has_part</italic> relations from ChEBI’s set of relationship types. That is because the other chemical relationships included in ChEBI, such as <italic>has_functional_parent</italic>, are not hierarchical – they are not transitively inherited and do not directly connect molecules with chemical classes. These relationships are mostly used to capture knowledge at the leaf level, between specific molecular entities, as additional separate information to that captured in the structure-based <italic>is_a</italic> classification. For example, acyclovir has functional parent guanine, but while guanine is a purine nucleobase, acyclovir is not a purine nucleobase. The results display relies on the underlying transitivity of the used relationships in order to lay out the display.</p>
    <p>The analysis can also be constrained to either the structural branch of the ChEBI ontology – which is oriented towards cheminformatics and chemical fragment based analysis use cases – or the role branch of the ChEBI ontology, catering for chemical biology enrichment analysis use cases.</p>
    <p>Displaying data on top of ChEBI is daunting because of the size and complexity of the ontology. Using ChEBI directly with BiNGO, even after producing all the required files, results in a large and complex graph structure. To this end, we implemented pruning strategies (detailed in the wiki (<ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNCheWeb/wiki/BiNChE">https://github.com/pcm32/BiNCheWeb/wiki/BiNChE</ext-link>) and in Additional file <xref rid="MOESM1" ref-type="media">1</xref>) that, while retaining the key ontology information, remove unnecessary detail. While this can be achieved in GO-based enrichment through the use of GO Slim files, losing details of the overall knowledge organization, our tool performs pruning on-demand for each enrichment analysis, and retains the broad structure of the ontology classification. This means that chemical knowledge relevant to each particular enrichment result is retained.</p>
    <p>In BiNChE, individual pruning methods are combined in different ways into pruning strategies. A pruning strategy applies the individual methods either once or iteratively. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the different pruning methods. As an example, after calculating enrichment p-values, the plain enrichment analysis option available in the web application prunes the resulting ChEBI graph through the following pruning strategy: <bold>Pre loop:</bold> High p-value Branch Pruner (at 0.05), Linear Branch Collapser Pruner and Root Children Pruner (3 levels of depth). These are applied only once, at the beginning, in that order. <bold>Loop:</bold> Molecule Leaves Pruner, High p-value Branch Pruner, Linear Branch Collapser Pruner, and Zero Degree Vertex Pruner. These are applied iteratively until no change is seen in the graph. <bold>Final run:</bold> No pruner.
<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Pruning methods used to decrease the complexity of a result graph.</bold> Illustration of the different pruning methods implemented to reduce the complexity of the graph-based output. For all cases, edges are directed and equivalent, even if they represent different relationships. Arrows are shown where relevant. <bold>(a)</bold> The Zero Degree Vertex Pruner excludes nodes that have neither incoming nor outgoing edges. These normally appear once the other pruners have been applied. <bold>(b)</bold> The Root Children Pruner removes higher levels of the ontology that are deemed irrelevant to the enrichment analysis as they represent very general classes of objects (such as “chemical entity” or “ion”). <bold>(c)</bold> The Molecule Leaves Pruner removes all nodes of the graph that do not have any incoming edges and represent a distinct small molecule – and not a class of small molecules. A small molecule is defined as distinct if the node representing it has an InChI line notation. <bold>(d)</bold> The High p-value Branch Pruner looks for branches of the graph where only nodes with high p-value (&gt;0.05) are present and removes those branches. <bold>(e)</bold> The Linear Branch Collapser Pruner finds linear stretches (nodes have only one incoming and one outgoing edge) and collapses them, leaving the nodes that surround those stretches connected.</p></caption><graphic xlink:href="12859_2015_486_Fig2_HTML" id="MO2"/></fig></p>
    <p>It is relevant to apply these methods iteratively because each of them changes the topology of the graph, potentially increasing the number of nodes that can be removed. While in the case of the plain enrichment analysis no pruners are used in the “Final run”, this is different for the weighted and fragment analysis. Furthermore, users of the API can change the pruning strategies by adding or removing pruning methods to each phase, to suit their needs. On a typical execution, a pruning strategy like the one described will remove somewhere between a few hundred and a few thousand nodes from the result, clearly improving the comprehensibility of the resulting visualization and allowing the researcher to focus on those parts of the ontology that are most relevant for his or her data.</p>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <p>The primary driving use case for developing the BiNChE tool is the need to assist and further automate the interpretation of results in metabolomics experiments. In metabolomics experiments, the small molecules in a sample of (for example) bodily fluid are identified, quantified and used to compare different experimental groups, e.g. diseased patients and healthy patients. These comparisons result in lists of small molecules that are enriched for particular groups. These molecules can then yield information about the underlying biological processes, such as metabolic pathways, that are executing differentially between the groups. Executing an enrichment analysis with the ChEBI role ontology gives information about which biological role categories are over represented in the target condition, which can yield deeper insights into mechanisms of action.</p>
    <p>MetaboLights is a repository for cross-species, cross-technique metabolomics experiments and derived information hosted at the European Bioinformatics Institute (EBI) [<xref ref-type="bibr" rid="CR10">10</xref>]. The study MTBLS23: “Model-driven multi-omic data analysis elucidates metabolic immunomodulators of macrophage activation” [<xref ref-type="bibr" rid="CR11">11</xref>] contains lists of ChEBI identifiers corresponding to small molecules for which the concentration either increases or decreases during macrophage activation when presented with bacterial lipopolysaccharides (LPS). Applying plain enrichment analysis – using both structural and role ontologies as shown in the wiki (<ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#plain-metabolomics-of-macrophages">https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#plain-metabolomics-of-macrophages</ext-link>) – to the list of ChEBI identifiers of the molecules that decrease in concentration during macrophage activation M1, reveals that there is an over representation of amino acids among the small molecules whose concentration diminishes during that activation phase, particularly in pyruvate derived amino acids, aspartate family amino acids, and serine derived amino acids.</p>
    <p>In the study itself, the authors mention that certain amino acid biosynthesis pathways are relevant during M1 activation [<xref ref-type="bibr" rid="CR11">11</xref>]. While the amino acid biosynthesis pathways are deemed relevant during M1 activation by the study, they are not exactly those BiNChE detects as enriched in the depletion list. The analysis provides a complementary view on the complex interplay of amino acids in the macrophage activation process.</p>
    <p>In study MTBLS35: “Salmonella Modulates Metabolism during Growth under Conditions that Induce Expression of Virulence Genes” [<xref ref-type="bibr" rid="CR12">12</xref>] researchers identified 66 metabolites through GC-MS that vary in concentration (decrease or increase) within Salmonella during virulence induction. Plain enrichment analysis of the complete set of small molecules shows an over representation of mostly amino-acids, fatty-acids, and nucleobases. A closer look into the data set shows that 3 sets of metabolites – within the original 66 – can be distinguised, representing: molecules with higher abundance before the induction of virulence, molecules with higher abundances 4 hours after virulence induction, and molecules with higher abundances 20 hours after virulence induction. Enrichment analysis of the first set of small molecules shows overrepresentation of nucleobases, purins, lipids and carbohydrates. The second set shows that after the first four hours of virulence, fatty acids, monosaccharides (different to those from the non-virulence phase), and amino acids have higher abundances. Finally, after 20 hours of induction, the enrichment analysis shows that small molecules in higher abundances are overrepresented in amino acids much more strongly. This use case can be inspected in detail – including lists of small molecules to submit to BiNChE – on the wiki <ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#plain-mtbls35-salmonella-modulates-metabolism-during-growth-under-conditions-that-induce-expression-of-virurulence-genes">https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#plain-mtbls35-salmonella-modulates-metabolism-during-growth-under-conditions-that-induce-expression-of-virurulence-genes</ext-link>) and in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <p>ChEBI enrichment analysis is also useful for metabolite identification. MetFrag is an in-silico fragmentation tool for computer assisted identification of metabolite mass spectra [<xref ref-type="bibr" rid="CR13">13</xref>]. Running MetFrag with default settings results in a list of 15 putative identifications of the fragmentation spectrum. The identifiers (available at the wiki (<ext-link ext-link-type="uri" xlink:href="https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#plain-metabolite-identification-through-fragments">https://github.com/pcm32/BiNCheWeb/wiki/BiNChE#plain-metabolite-identification-through-fragments</ext-link>)) can be used as input for BiNChE after identifier conversion. Amongst others, plain analysis shows significant enrichment in the term <italic>flavonoids</italic>. This suggests that the spectrum represents a compound with a C<sub>15</sub> or C<sub>16</sub> skeleton. While in this example that particular information is already encoded in the molecule identifiers themselves, the advantage offered by enrichment analysis with BiNChE is that it provides the ability to highlight key information such as this in an automated fashion. In a high-throughput experiment or pipeline where hundreds or thousands of small molecules are identified, the researcher cannot be expected to examine them all manually, so these kind of insights (such as C<sub>15</sub> or C<sub>16</sub> skeletons being relevant within a chemical set) would only surface from an analysis like the one proposed here.</p>
    <p>Naturally, many studies will yield a number of molecules that might not be present in ChEBI and hence not annotated to the classes of the ontology. In these cases, whatever molecules are present in ChEBI act as a sample of the complete set provided by the study or pipeline. The conclusions drawn from using BiNChE with this subset should be treated with appropriate caution considering the set submitted as a sample of the complete population of small molecules relevant to the problem. For studies that provide chemical entities through different chemical identifiers or directly via chemical structures, mapping to ChEBI identifiers can be achieved through services such as UniChem [<xref ref-type="bibr" rid="CR14">14</xref>] or the Chemical Identifier Resolver (<ext-link ext-link-type="uri" xlink:href="http://cactus.nci.nih.gov/chemical/structure">http://cactus.nci.nih.gov/chemical/structure</ext-link>). In future work, methods for automatically determining candidate class membership for novel molecules within the ChEBI ontology based on chemical structures – analogous to the automatic annotation of gene and protein identifiers to the Gene Ontology by, for example, species homology – will be developed.</p>
    <p>The web tool can accept a list of hundreds of input ChEBI identifiers, from which only the well-defined small molecules will have an impact on the enrichment analysis. The biggest lists we have tested have been in the order of a thousand molecules, and with inputs of this size BiNChE took typically less than 10 seconds to produce a graph with which the user could interact. The interface was responsive at this level, although this will depend on the client machine used.</p>
  </sec>
  <sec id="Sec4" sec-type="conclusion">
    <title>Conclusions</title>
    <p>BiNChE provides easy and highly interactive web access to enrichment analysis with the ChEBI ontology, as well as a Java standalone executable and library, which can be integrated into automated pipelines. We have given examples of typical use cases and indicated how it can help to facilitate an understanding of the biological and chemical significance of sets of metabolites, which is of particular relevance in metabolomics and systems biology.</p>
  </sec>
  <sec id="Sec5">
    <title>Availability and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p><bold>Project name:</bold> BiNChE</p>
        </list-item>
        <list-item>
          <p><bold>Project home page:</bold>http://www.ebi.ac.uk/chebi/tools/binche/</p>
        </list-item>
        <list-item>
          <p><bold>Operating system(s):</bold> Platform independent</p>
        </list-item>
        <list-item>
          <p><bold>Programming language:</bold> Java 1.6</p>
        </list-item>
        <list-item>
          <p><bold>License:</bold> GNU GPLv3</p>
        </list-item>
        <list-item>
          <p><bold>Any restrictions to use by non-academics:</bold> None.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec6">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12859_2015_486_MOESM1_ESM.pdf">
          <label>Additional file 1</label>
          <caption>
            <p>
              <bold>Supplementary Material.</bold>
            </p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>PM and SB adapted the BiNGO source code to produce the base BiNChE core Java Library, produced JavaDocs and the Wiki, and supervised development of the web interface (taking decisions on the technologies to use for it). BH developed the web interface. VM and AD helped supervise and contributed to the development of the web interface, as well as handling server side configuration. IT and JH produced the input version of the ontology, with all the suitable requirements for BiNChE. JH advised on general ontological aspects and took care of the integration with the ChEBI production environment, as well as helping supervise the web development. PM and SN proposed the use of SaddleSum for the fragmentation-based use case, which was implemented in the core library by SD and FT, under the advice of IG. PM, JH, SN and CS articulated the research idea. PM, SB, and JH wrote the manuscript. All authors contributed to and have approved the final version.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The project is funded by the European Molecular Biology Laboratory (EMBL).</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene Ontology: tool for the unification of biology</article-title>
        <source>Nat Genet</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>25</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/75556</pub-id>
        <?supplied-pmid 10802651?>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lempicki</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics enrichment tools: paths toward the comprehensive functional analysis of large gene lists</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn923</pub-id>
        <pub-id pub-id-type="pmid">19033363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hastings</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>De Matos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ennis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Harsha</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kale</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The ChEBI reference database and ontology for biologically relevant chemistry: enhancements for 2013</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>D456</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1146</pub-id>
        <?supplied-pmid 23180789?>
        <pub-id pub-id-type="pmid">23180789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>MSEA: a web-based tool to identify biologically meaningful patterns in quantitative metabolomic data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>W71</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq329</pub-id>
        <?supplied-pmid 20457745?>
        <pub-id pub-id-type="pmid">20457745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chagoyeny</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pazos</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>MBRole: enrichment analysis of metabolomic data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>730</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr001</pub-id>
        <pub-id pub-id-type="pmid">21208985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maere</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Heymans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuiper</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BiNGO: a Cytoscape plugin to assess overrepresentation of gene ontology categories in biological networks</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3448</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti551</pub-id>
        <?supplied-pmid 15972284?>
        <pub-id pub-id-type="pmid">15972284</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirrell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Evani</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Berman</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Mooney</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Musen</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>An ontology-neutral framework for enrichment analysis</article-title>
        <source>AMIA Annu Symp Proc</source>
        <year>2010</year>
        <volume>2010</volume>
        <fpage>797</fpage>
        <lpage>801</lpage>
        <?supplied-pmid 21347088?>
        <pub-id pub-id-type="pmid">21347088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopes</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Franz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kazi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Donaldson</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Cytoscape Web: an interactive web-based network browser</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2347</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq430</pub-id>
        <?supplied-pmid 20656902?>
        <pub-id pub-id-type="pmid">20656902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Stojmirović A</collab>
          <name>
            <surname>Yu</surname>
            <given-names>Y-K</given-names>
          </name>
        </person-group>
        <article-title>Robust and accurate data enrichment statistics via distribution function of sum of weights</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2752</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq511</pub-id>
        <?supplied-pmid 20826881?>
        <pub-id pub-id-type="pmid">20826881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haug</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Salek</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hastings</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>de Matos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rijnbeek</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaboLights–an open-access general-purpose repository for metabolomics studies and associated meta-data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>Database issue</issue>
        <fpage>D781</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1004</pub-id>
        <?supplied-pmid 23109552?>
        <pub-id pub-id-type="pmid">23109552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bordbar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mo</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Nakayasu</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Schrimpe-Rutledge</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>YM</given-names>
          </name>
          <name>
            <surname>Metz</surname>
            <given-names>TO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-driven multi-omic data analysis elucidates metabolic immunomodulators of macrophage activation</article-title>
        <source>Mol Syst Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>558</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2012.21</pub-id>
        <?supplied-pmid 22735334?>
        <pub-id pub-id-type="pmid">22735334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>YM</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Kidwai</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>BLD</given-names>
          </name>
          <name>
            <surname>Brewer</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Salmonella Modulates Metabolism during Growth under Conditions that induce expression of virulence genes</article-title>
        <source>Mol BioSyst</source>
        <year>2013</year>
        <volume>9.6</volume>
        <fpage>1552</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Müller-Hannemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>In silico fragmentation for computer assisted identification of metabolite mass spectra</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>148</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-148</pub-id>
        <?supplied-pmid 20307295?>
        <pub-id pub-id-type="pmid">20307295</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chambers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hersey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Velankar</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UniChem: a unified chemical structure cross-referencing and identifier tracking system</article-title>
        <source>J Cheminformatics</source>
        <year>2013</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-5-3</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
