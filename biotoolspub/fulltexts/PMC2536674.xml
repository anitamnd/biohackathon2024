<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2536674</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-343</article-id>
    <article-id pub-id-type="pmid">18706106</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-343</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Parameter estimation for robust HMM analysis of ChIP-chip data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Humburg</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>peter.humburg@csiro.au</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Bulger</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>dbulger@efs.mq.edu.au</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Stone</surname>
          <given-names>Glenn</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>glenn.stone@csiro.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Statistics, Macquarie University, North Ryde, NSW 2109, Australia</aff>
    <aff id="I2"><label>2</label>CSIRO Mathematical and Information Sciences, North Ryde, NSW 2113, Australia</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>8</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>343</fpage>
    <lpage>343</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/343"/>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>5</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>8</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Humburg et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Humburg et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Humburg
               Peter
               
               
               peter.humburg@csiro.au
            </dc:author><dc:title>
            Parameter estimation for robust HMM analysis of ChIP-chip data
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 343-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;343&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Tiling arrays are an important tool for the study of transcriptional activity, protein-DNA interactions and chromatin structure on a genome-wide scale at high resolution. Although hidden Markov models have been used successfully to analyse tiling array data, parameter estimation for these models is typically <italic>ad hoc</italic>. Especially in the context of ChIP-chip experiments, no standard procedures exist to obtain parameter estimates from the data. Common methods for the calculation of maximum likelihood estimates such as the Baum-Welch algorithm or Viterbi training are rarely applied in the context of tiling array analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we develop a hidden Markov model for the analysis of chromatin structure ChIP-chip tiling array data, using <italic>t </italic>emission distributions to increase robustness towards outliers. Maximum likelihood estimates are used for all model parameters. Two different approaches to parameter estimation are investigated and combined into an efficient procedure.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We illustrate an efficient parameter estimation procedure that can be used for HMM based methods in general and leads to a clear increase in performance when compared to the use of <italic>ad hoc </italic>estimates. The resulting hidden Markov model outperforms established methods like TileMap in the context of histone modification studies.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Background</title>
    <p>High density oligonucleotide tiling arrays allow the investigation of transcriptional activity, protein-DNA interactions and chromatin structure across a whole genome. Tiling arrays have been used in a wide range of studies, including investigation of transcription factor activity [<xref ref-type="bibr" rid="B1">1</xref>] and of histone modifications in animals [<xref ref-type="bibr" rid="B2">2</xref>] and plants [<xref ref-type="bibr" rid="B3">3</xref>], as well as DNA methylation [<xref ref-type="bibr" rid="B4">4</xref>]. Analyses of these data are usually based either on a sliding window [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B5">5</xref>], or on hidden Markov models (HMMs) [<xref ref-type="bibr" rid="B6">6</xref>-<xref ref-type="bibr" rid="B8">8</xref>]. Other approaches have been suggested, e.g., by Huber <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] and Reiss <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>], but are less common.</p>
    <p>Parameter estimates for sliding window approaches as well as hidden Markov models are typically <italic>ad hoc</italic>. Although there are some notable exceptions in gene expression studies [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B11">11</xref>], no established procedures exist to obtain good parameter estimates from tiling array data, especially in the context of chromatin immunoprecipitation (ChIP-chip) experiments. Attempts have been made to obtain parameter estimates by integrating genome annotations into the analysis [<xref ref-type="bibr" rid="B12">12</xref>]. While this may provide good results when investigating transcriptional activity in well studied organisms, it is limited by the quality of available annotations. For ChIP-chip studies the required annotation data is unavailable. A method for the localisation of transcription factors from ChIP-chip experiments by Keleş [<xref ref-type="bibr" rid="B13">13</xref>] does obtain the required parameter estimates from the data and allows for variations in length of enriched regions.</p>
    <p>Methods designed for the analysis of ChIP-chip data focus almost exclusively on the study of transcription factors [[<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>], and [<xref ref-type="bibr" rid="B13">13</xref>]]. While this is an important class of experiments, ChIP-chip studies are not limited to transcription factors, and the analysis of other ChIP-chip experiments may require new methods. One other area of active research that utilises ChIP-chip experiments is the study of histone modifications and chromatin structure [<xref ref-type="bibr" rid="B3">3</xref>]. Although both types of experiment employ the same technology, there are several important differences between them. Most importantly, the 147 bp of DNA bound by a histone complex are considerably longer than the typical transcription factor binding site, and the histone modifications of interest are expected to affect several neighbouring histones. Consequently the ChIP fragments derived from a transcription factor binding site all originate from a small region containing the given binding site while regions affected by histone modifications can be much longer than the ChIP fragments used. As a result of this, the data from histone modification experiments usually contain long regions of interest encompassing several non-overlapping ChIP fragments, rather than the short and relatively isolated peaks produced by transcription factor studies.</p>
    <p>Here we consider the analysis of data from a histone modification study in <italic>Arabidopsis </italic>[<xref ref-type="bibr" rid="B3">3</xref>]. These data consist of four ChIP samples for histone H3 with lysine 27 trimethylation (H3K27me3) and four histone H3 ChIP samples that act as a control. The aim of this analysis is to identify and characterise regions throughout the genome that exhibit enrichment for H3K27me3. It is desirable to use a method which is specifically designed for the analysis of histone modifications or flexible enough to accomodate the varying length of enriched regions. Furthermore, the method should obtain all parameter estimates from the data without the use of genome annotations and be robust towards outliers. Amongst the methods discussed above TileMap [<xref ref-type="bibr" rid="B7">7</xref>] comes closest to these requirements. Although it was developed with transcription factor analysis in mind it is general enough that it should provide useful results for other ChIP-chip experiments. This is emphasised by its application to histone modification [<xref ref-type="bibr" rid="B3">3</xref>] and DNA methylation [<xref ref-type="bibr" rid="B4">4</xref>] data as well as transtription factor analysis [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. TileMap obtains some, but not all, of the required parameter estimates from the data. To provide a method which meets the requirements oulined above we develop a two state HMM with <italic>t </italic>emission distributions. All parameter estimates for the model are obtained by maximum likelihood estimation using the Baum-Welch algorithm [<xref ref-type="bibr" rid="B16">16</xref>] and Viterbi training [<xref ref-type="bibr" rid="B17">17</xref>]. These methods have the advantage that no prior knowledge about parameter values is required and one need not rely on frequently unavailable genome annotations. To assess the performance of our model, we apply it to simulated and real data. Results are compared to those produced by TileMap. The remainder of this article is structured as follows. In Section 2 the hidden Markov model is developed and MLEs for all parameters are derived in Section 4. The performance of the resulting model is assessed in terms of sensitivity and specificity on simulated data in Sections 2.3.3–2.3.6. In Section 2.3.7 the model is used to analyse a public ChIP-chip data set [<xref ref-type="bibr" rid="B3">3</xref>] and results are compared to the original analysis of these data.</p>
  </sec>
  <sec>
    <title>2 Results and discussion</title>
    <p>Tiling array data consists of a series of measurements taken along the genome. Typically, microarray probes are designed to interrogate the genome at regular intervals. Design constraints such as probe affinity and uniqueness cause differences in probe density along the genome and can lead to large gaps between probes. Here we assume that the probe density is homogeneous except for a number of large gaps where the distance between adjacent probes is larger than max_gap. In the following analyses we use max_gap = 200 bp. This is identical to the value used by Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="B3">3</xref>], allowing for a direct comparison of results. Consider a ChIP-chip tiling array experiment with two conditions, a ChIP sample <bold>X</bold><sub>1 </sub>targeting the protein of interest and a control sample <bold>X</bold><sub>2</sub>. Each sample <bold>X</bold><sub><italic>l </italic></sub>has <italic>m</italic><sub><italic>l </italic></sub>replicates (<italic>l </italic>= 1, 2) providing measurements for <italic>K </italic>genomic locations. The measurements for each probe are summarised by the "shrinkage <italic>t</italic>" statistic [<xref ref-type="bibr" rid="B18">18</xref>]:</p>
    <p>
      <disp-formula id="bmcM1">
        <label>(1)</label>
        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-343-i1" overflow="scroll">
          <mml:semantics>
            <mml:mrow>
              <mml:msub>
                <mml:mi>y</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>¯</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>¯</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>v</mml:mi>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                            <mml:mo>∗</mml:mo>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>m</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>v</mml:mi>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                            <mml:mo>∗</mml:mo>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>m</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:semantics>
        </mml:math>
      </disp-formula>
    </p>
    <p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-343-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is a James-Stein shrinkage estimate of the probe variance obtained by calculating</p>
    <p>
      <disp-formula id="bmcM2">
        <label>(2)</label>
        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-343-i3" overflow="scroll">
          <mml:semantics>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>v</mml:mi>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
                <mml:mo>∗</mml:mo>
              </mml:msubsup>
              <mml:mo>=</mml:mo>
              <mml:msubsup>
                <mml:mover accent="true">
                  <mml:mi>λ</mml:mi>
                  <mml:mo>ˆ</mml:mo>
                </mml:mover>
                <mml:mi>l</mml:mi>
                <mml:mo>∗</mml:mo>
              </mml:msubsup>
              <mml:msubsup>
                <mml:mi>s</mml:mi>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mtext>median</mml:mtext>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
              <mml:mo>+</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>−</mml:mo>
              <mml:msubsup>
                <mml:mover accent="true">
                  <mml:mi>λ</mml:mi>
                  <mml:mo>ˆ</mml:mo>
                </mml:mover>
                <mml:mi>l</mml:mi>
                <mml:mo>∗</mml:mo>
              </mml:msubsup>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:msubsup>
                <mml:mi>s</mml:mi>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:semantics>
        </mml:math>
      </disp-formula>
    </p>
    <p>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-343-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> are the usual unbiased empirical variances and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-343-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>l</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is the estimated optimal pooling parameter</p>
    <p>
      <disp-formula id="bmcM3">
        <label>(3)</label>
        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-343-i6" overflow="scroll">
          <mml:semantics>
            <mml:mrow>
              <mml:msubsup>
                <mml:mover accent="true">
                  <mml:mi>λ</mml:mi>
                  <mml:mo>ˆ</mml:mo>
                </mml:mover>
                <mml:mi>l</mml:mi>
                <mml:mo>*</mml:mo>
              </mml:msubsup>
              <mml:mo>=</mml:mo>
              <mml:mi>min</mml:mi>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mtext>Var</mml:mtext>
                            </mml:mrow>
                            <mml:mo stretchy="true">︿</mml:mo>
                          </mml:mover>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msubsup>
                            <mml:mi>s</mml:mi>
                            <mml:mrow>
                              <mml:mi>l</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msubsup>
                                <mml:mi>s</mml:mi>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo>−</mml:mo>
                              <mml:msubsup>
                                <mml:mi>s</mml:mi>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                  <mml:mtext>median</mml:mtext>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:semantics>
        </mml:math>
      </disp-formula>
    </p>
    <p>Other moderated <italic>t </italic>statistics have been suggested and could be used instead, most notably the empirical Bayes <italic>t </italic>statistic used by Ji and Wong [<xref ref-type="bibr" rid="B7">7</xref>] and the moderated <italic>t </italic>of Smyth [<xref ref-type="bibr" rid="B19">19</xref>]. All of these approaches are designed to increase performance compared to the ordinary <italic>t </italic>statistic by incorporating information from all probes on the microarray into individual probe statistics. Here we choose the "shrinkage <italic>t</italic>" because it does not require any knowledge about the underlying distribution of probe values while providing similar performance compared to more complex models [<xref ref-type="bibr" rid="B18">18</xref>].</p>
    <sec>
      <title>2.1 Hidden Markov Model</title>
      <p>To detect enriched regions we use a two state discrete time hidden Markov model with continuous emission distributions and homogeneous transition probabilities (Figure <xref ref-type="fig" rid="F1">1</xref>), i.e., the transition probabilities depend only on the current state of the model. The use of homogeneous transition probabilities assumes equally-spaced probes within each observation sequence as well as a geometric distribution of the length of enriched regions. As discussed above there will be some variation in probe distances. Using a relatively small value for max_gap ensures that the assumption of homogeneity holds at least approximately. The two states of the model correspond to enrichment or no enrichment in the ChIP sample. The model is characterised by the set of states <bold>S </bold>= {<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>}, the initial state distribution <italic>p</italic>, the matrix of transition probabilities <italic>A </italic>and the state specific emission density functions <italic>f</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1, 2. The emission distribution of state <italic>S</italic><sub><italic>i </italic></sub>is modelled as a <italic>t </italic>distribution with location parameter <italic>μ</italic><sub><italic>i</italic></sub>, scale parameter <italic>σ</italic><sub><italic>i</italic></sub>, and <italic>ν</italic><sub><italic>i </italic></sub>degrees of freedom.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p>Hidden Markov model for the analysis of ChIP-chip tiling array data.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-343-1"/>
      </fig>
      <p>The use of <italic>t </italic>distributions has the advantage that their sensitivity to outliers can be adjusted via the degrees of freedom parameter, making them more robust and versatile than normal distributions. This is particularly useful when <italic>ν </italic>is estimated from the data [<xref ref-type="bibr" rid="B20">20</xref>]. It should be noted that the <italic>y</italic><sub><italic>k </italic></sub>modelled here are from a <italic>t</italic>-like distribution (Equation (1)). While this in itself might suggest the use of <italic>t </italic>distributions for the <italic>f</italic><sub><italic>i</italic></sub>s, they are primarily chosen for their robustness. In the following we will refer to this model by its parameter vector <italic>θ </italic>= (<italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>), where <italic>θ</italic><sub>1 </sub>is the ordered pair (<italic>p</italic>, <italic>A</italic>) and <italic>θ</italic><sub>2 </sub>the ordered triple (<italic>μ</italic>, <italic>σ</italic>, <italic>ν</italic>).</p>
      <p>Given a hidden Markov model <italic>θ </italic>and an observation sequence <italic>Y</italic>, it is possible to compute the sequence of states <italic>Q </italic>= <italic>q</italic><sub>1</sub><italic>q</italic><sub>2</sub>...<italic>q</italic><sub><italic>K </italic></sub>that is most likely to produce <italic>Y</italic>. There are several approaches to obtaining <italic>Q </italic>[<xref ref-type="bibr" rid="B21">21</xref>]. Usually <italic>Q </italic>is computed either by maximising the posterior probabilities <italic>P</italic>(<italic>q</italic><sub><italic>k </italic></sub>= <italic>S</italic><sub><italic>i</italic></sub>|<italic>Y</italic>; <italic>θ</italic>), <italic>k </italic>= 1, ..., <italic>K </italic>or by calculating the sequence that maximises <italic>P</italic>(<italic>Q|Y</italic>; <italic>θ</italic>). The latter provides the single most likely sequence of states and can be computed efficiently by the Viterbi algorithm [<xref ref-type="bibr" rid="B22">22</xref>]. For the particular model used here both approaches are equivalent.</p>
    </sec>
    <sec>
      <title>2.2 Parameter Estimation</title>
      <p>In this section we will discuss two different approaches to estimate <italic>θ </italic>for the model described in Section 2.1. The methods under consideration are the EM algorithm, which is usually known as the Baum-Welch algorithm in the context of HMMs, and Viterbi training. While the Baum-Welch algorithm is guaranteed to converge to a local maximum of the likelihood function, it is computationally intensive. Viterbi training provides a faster alternative but may not converge to a local maximum.</p>
      <sec>
        <title>2.2.1 Initial Estimates</title>
        <p>Both optimisation algorithms discussed here require initial parameter estimates. These are obtained from the data by first partitioning the vector of observations <italic>Y </italic>into two clusters using <italic>k</italic>-means clustering [<xref ref-type="bibr" rid="B23">23</xref>]. From these clusters the location and scale parameters of the corresponding states are obtained as the mean and variance of the observations in the cluster. In the following, <italic>ν</italic><sub>1 </sub>= <italic>ν</italic><sub>2 </sub>= 6 is used as initial estimate for the degrees of freedom parameters.</p>
      </sec>
      <sec>
        <title>2.2.2 Baum-Welch Algorithm</title>
        <p>The Baum-Welch algorithm [<xref ref-type="bibr" rid="B16">16</xref>] is a well established iterative method for estimating parameters of HMMs. It represents the EM algorithm [<xref ref-type="bibr" rid="B24">24</xref>] for the specific case of HMMs. This algorithm can be used to optimise the transition parameters <italic>θ</italic><sub>1 </sub>as well as the emission parameters <italic>θ</italic><sub>2</sub>. Each iteration of the algorithm consists of two phases. During the first phase, the current parameter estimates are used to determine for each probe statistic in the observation sequence how likely it is to be produced by the different states of the model. In the second phase, parameters for the emission distributions of each state are estimated using contributions from all observations, according to the probability that they were produced by the respective state of the model. The state transition parameters are updated in a similar fashion, accounting for the probability of transitions between states based on the observation sequence and the current model. After each iteration this procedure results in a model which explains the observed data better than the previous one, approaching a locally optimal solution. Using this method parameter estimates are updated until convergence is achieved. The details of the resulting algorithm are outlined in Section 4.1.</p>
        <p>This method of parameter estimation is computationally expensive and time-consuming for a typical tiling array data set. The computing time can be reduced by fixing the degrees of freedom for the emission distributions in advance, thus avoiding the root-finding required for the estimation of these parameters. While this does not provide the same flexibility as estimating the required degree of robustness from the data it reduces the complexity of the optimisation problem. It is noted by Liu and Rubin [<xref ref-type="bibr" rid="B25">25</xref>] that attempts to estimate the degrees of freedom are more likely to produce results which are of little practical interest. The impact on classification performance of this choice is investigated in Section 2.3.</p>
        <p>The formulation of the Baum-Welch algorithm used in this article is based on the description given by Rabiner [<xref ref-type="bibr" rid="B21">21</xref>] and on the EM algorithm derived by Peel and McLachlan [<xref ref-type="bibr" rid="B26">26</xref>] for fitting mixtures of <italic>t </italic>distributions.</p>
      </sec>
      <sec>
        <title>2.2.3 Viterbi Training</title>
        <p>While the Baum-Welch algorithm described in Section 2.2.2 is expected to provide good parameter estimates, it is computationally expensive. A faster model-fitting procedure can be devised by replacing the first phase of the Baum-Welch algorithm with a maximisation step. This method was introduced in [<xref ref-type="bibr" rid="B17">17</xref>] as segmental <italic>k</italic>-means and is now commonly referred to as Viterbi training. Unlike the Baum-Welch algorithm which allows each probe statistic to contribute to the parameter estimates for all states, Viterbi training assigns each observation to the state that is most likely to produce the given probe statistic. Thus each observation contributes to exactly one state of the model. While each iteration of this method is faster than one iteration of the Baum-Welch algorithm some iterations may decrease the likelihood of the model, thus failing to advance it towards a useful solution. See Section 4.2 for further details on the implementation of Viterbi training used here.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Testing</title>
      <sec>
        <title>2.3.1 Simulated Data</title>
        <p>To assess the ability to distinguish between enriched and non-enriched probes of the models obtained by the different parameter estimation methods discussed in Section 2.2, we simulate data with known enriched regions. To ensure that the simulation study is providing meaningful results, it is based as closely on real data as possible. To this end, two independent analyses of the H3K27me3 data published by Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="B3">3</xref>] are carried out, one using TileMap [<xref ref-type="bibr" rid="B7">7</xref>], the other based on our model. The result of each analysis is used to generate a new dataset with known enriched regions. See Section 4 for further details. In the following these data are referred to as datasets I and II respectively. Since the simulation procedure is likely to bias results towards the model that was used in the process, we concentrate on the analysis of dataset I, with some results for dataset II presented for comparison. The use of data based on both models allows us to consider their performance under advantageous and disadvantageous conditions.</p>
      </sec>
      <sec>
        <title>2.3.2 Performance Measure</title>
        <p>The performance of different models on these data is determined in terms of false positive and false negative rates at probe level. While the relative importance of false positives and false negatives depends on the experiment under consideration, they are often equally problematic in the context of ChIP-chip experiments, especially when considering experiments which investigate differences between different cell lines or developmental stages, where all incorrect classifications are of equal concern. In this context, we define false positives as probes that are classified as non-enriched by the analysis of the real data but are called enriched in the subsequent analysis of simulated data, and vice versa for false negatives.</p>
        <p>The output of each model is the estimated posterior probability of enrichment for each probe. In practice, probe calls ("enriched" or "non-enriched") are generated from this posterior probability based on a 0.5 cut-off. For any given model, classification performance will change with the chosen threshold. Thus we assess model performance across a range of cut-offs, reporting the relative number of false positives and false negatives as well as the error rate. The latter is also used to determine the cut-off that minimises incorrect classification results, and model performance is judged on the numbers of incorrect classifications at this optimal cut-off and at the usual 0.5 cut-off, and on the distance between the optimal cut-off and 0.5. The trade-off between sensitivity and specificity provided by the different models is characterised with ROC curves and the associated AUC values.</p>
        <p>Another measure of interest is the ability to characterise the length distribution of enriched regions correctly. When studying chromatin structure the extent of structural changes is of interest; this is the case for the data studied in Section 2.3.7. This property of the different models is investigated in Section 2.3.6.</p>
      </sec>
      <sec>
        <title>2.3.3 Estimating Degrees of Freedom</title>
        <p>We now consider the performance of both the Baum-Welch procedure and Viterbi training when all model parameters, including the degrees of freedom <italic>ν</italic>, are estimated from the data. Both parameter estimation methods are used to fit an HMM to datasets I and II, and the performance of resulting models is assessed in terms of the achieved error rate (Figure <xref ref-type="fig" rid="F2">2</xref>), ROC curves (Figure <xref ref-type="fig" rid="F3">3</xref>) and their associated AUC (Table <xref ref-type="table" rid="T1">1</xref>) for both datasets. To assess how well these methods perform in comparison to an established algorithm, we also fit a TileMap model to the two simulated datasets. The three models are compared to each other, as well as an <italic>ad hoc </italic>model which simply uses, without optimisation, the initial parameter estimates used by the two parameter optimisation methods. When comparing the performance of these models on both simulated datasets, it is important to consider that the simulation procedure introduces a bias towards the underlying model.</p>
        <fig position="float" id="F2">
          <label>Figure 2</label>
          <caption>
            <p><bold>Error rate for different models on datasets I and II</bold>. Error rate resulting from the different models on dataset I (left) and II (right). When the total number of incorrect probe calls is considered, both parameter estimation procedures outperform TileMap on dataset I for cut-offs larger than 0.2. Both Baum-Welch and Viterbi training provide models with an optimal cut-off close to 0.5, while TileMap significantly underestimates the posterior probability resulting in an optimal cut-off of 0.19. The models with optimised parameters show similar performance on both datasets. On dataset II TileMap's performance is reduced in comparison to the results on dataset I. The main differences between the models considered here occur at error rates of 0–0.08. The relevant area of the figures in the top row is magnified in the plots below.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-2"/>
        </fig>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p><bold>ROC curves for different models on datasets I and II</bold>. TileMap and the models with Baum-Welch and Viterbi training parameter estimates show similar performance on dataset I (left) with a small advantage for the models with optimised parameters. Comparison with a model using <italic>ad hoc </italic>parameter estimates highlights the performance increase achieved by optimising model parameters. On dataset II (right) TileMap performs similarly to the model with <italic>ad hoc </italic>parameter estimates. Figures on the bottom provide a close-up view of the plots above.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-3"/>
        </fig>
        <table-wrap position="float" id="T1">
          <label>Table 1</label>
          <caption>
            <p>AUC for different models on both simulated datasets.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td/>
                <td align="center">TileMap</td>
                <td align="center">Baum-Welch</td>
                <td align="center">Viterbi-Training</td>
                <td align="center">Viterbi-EM</td>
                <td align="center">ad hoc</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">dataset I</td>
                <td align="center">0.9986</td>
                <td align="center">0.9998</td>
                <td align="center">0.9997</td>
                <td align="center">0.9998</td>
                <td align="center">0.9869</td>
              </tr>
              <tr>
                <td align="left">dataset II</td>
                <td align="center">0.9749</td>
                <td align="center">0.9995</td>
                <td align="center">0.9994</td>
                <td align="center">0.9995</td>
                <td align="center">0.9728</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>All models with optimised parameters outperform TileMap on both simulated datasets. While TileMap performs well on dataset I it is only slightly better than the model with <italic>ad hoc </italic>parameter estimates.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>Estimating all parameters from the data with either the Baum-Welch algorithm or Viterbi training leads to models with high sensitivity, producing fewer false negatives than TileMap for any given cut-off [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>]. At the same time they lead to an increased number of false positives [see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>] compared to TileMap, indicating a slight reduction of specificity. When considering the error rate it becomes apparent that both Baum-Welch and Viterbi training provide a favourable trade-off between sensitivity and specificity. These models reduce the number of incorrect classifications compared to TileMap both at the usual 0.5 cut-off and at the optimal cut-off. Moreover, while the Baum-Welch algorithm and Viterbi training both lead to models with an optimal cut-off close to 0.5 (0.51 and 0.42 respectively), TileMap provides an optimal cut-off of 0.19, indicating that it underestimates the posterior probability of enrichment. This becomes even more apparent when considering the result for dataset II where the optimal cut-off for TileMap is at 0.002 compared to 0.5 for Baum-Welch and 0.41 for Viterbi training. This result suggests that TileMap is more tuned towards avoiding false positives than false negatives. From the above results we estimate that the weight given to false positives by TileMap is approximately 3.2 and 26 times larger than the weight for false negatives on datasets I and II respectively. The ROC curves (Figure <xref ref-type="fig" rid="F3">3</xref>) provide further evidence that the models with MLEs outperform TileMap. Although all three models perform well on dataset I, both parameter optimisation methods lead to better results than TileMap. The benefits of optimising parameter estimates are further highlighted by the performance of the model with <italic>ad hoc </italic>estimates that is used as starting point for the optimisation procedures. On both datasets, optimised parameters provide a notable increase in performance, with TileMap performing only slightly better than the <italic>ad hoc </italic>model on dataset II.</p>
      </sec>
      <sec>
        <title>2.3.4 Fixed Degrees of Freedom</title>
        <p>Estimating <italic>ν</italic>, the degrees of freedom, for <italic>t </italic>distributions from the data is time-consuming and may not be very accurate, especially for relatively large values of <italic>ν</italic>. In this section we investigate the effect of fixing <italic>ν </italic>a priori for both states of the model. Only the case <italic>ν</italic><sub>1 </sub>= <italic>ν</italic><sub>2 </sub>is considered here. The remaining parameters are estimated from the training data using the Baum-Welch algorithm and Viterbi training with <italic>ν </italic>= 3, 4, ..., 50. For each value of <italic>ν</italic>, we report the error rate (Figure <xref ref-type="fig" rid="F4">4</xref>) as well as the AUC (Figure <xref ref-type="fig" rid="F5">5</xref>) on the simulated data.</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p><bold>Model performance for different choices of <italic>ν</italic></bold>. The Baum-Welch model (red) performs better for relatively small values of <italic>ν </italic>while Viterbi training (blue) favours larger <italic>ν</italic>. For the optimal choice of <italic>ν </italic>the Baum-Welch parameter estimates lead to an optimal cut-off close to 0.5.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-4"/>
        </fig>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p><bold>AUC for different choices of <italic>ν </italic>and increasing numberof iterations</bold>. Change in AUC for different choices of <italic>ν </italic>(left). The Baum-Welch model performs better for relatively small values of <italic>ν </italic>while Viterbi training favours larger <italic>ν</italic>. Improvements in AUC with increasing number of iterations (right). The performance of the Viterbi trained model improves substantially during the first five iterations. Further iterations only produce small changes in the AUC. The Baum-Welch method requires more iterations to obtain the same AUC as as the Viterbi model. After 20 iterations the Baum-Welch model starts to outperform the Viterbi model.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-5"/>
        </fig>
        <p>For the best combination of <italic>ν </italic>and cut-off, both parameter estimation methods result in models with a classification performance comparable to the case of variable degrees of freedom (Figure <xref ref-type="fig" rid="F2">2</xref>). While the Baum-Welch algorithm tends to produce models with an optimal cut-off close to 0.5, Viterbi training only achieves this for large values of <italic>ν</italic>. Notably, the best classification performance of the Viterbi trained model is achieved with 14 degrees of freedom and a 0.37 cut-off compared to 7 degrees of freedom and a 0.49 cut-off from Baum-Welch. This results in a decreased performance of the Viterbi model relative to the Baum-Welch model at the 0.5 cut-off.</p>
      </sec>
      <sec>
        <title>2.3.5 Convergence</title>
        <p>To reduce the time required for parameter estimation it is useful to limit the number of iterations. While each iteration of the Baum-Welch algorithm is guaranteed to improve the likelihood of the model, small changes to the parameter values do not necessarily lead to significant changes in the classification result. Furthermore, Viterbi training is not guaranteed to converge to a local maximum of the likelihood function and a likelihood based convergence criterion may not be appropriate for this method. Here we investigate the convergence of both algorithms based on the error rate and AUC to gauge the number of iterations required to achieve good classification results. Parameter estimation is performed with 60 iterations for both algorithms. Current estimates are used to classify the test data at every 5<sup>th </sup>iteration and AUC (Figure <xref ref-type="fig" rid="F5">5</xref>) and error rate (Figure <xref ref-type="fig" rid="F6">6</xref>) are determined.</p>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p><bold>Error rate at optimal and 0.5 cutoff for increasing number of iterations</bold>. Parameter estimates obtained by the Baum-Welch algorithm (filled symbols) and Viterbi training (open symbols) improve model performance with increasing nuber of iterations. Viterbi training quickly approaches its optimal solution and initially outperforms Baum-Welch. The final model produced by the Baum-Welch algorithm provides a lower error rate than Viterbi training.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-6"/>
        </fig>
        <p>The most striking difference in the convergence behaviour of the two methods is that Viterbi training appears to obtain good parameter estimates within a small number of iterations. Further iterations of the algorithm do not improve results substantially, whereas the Baum-Welch procedure provides parameter estimates that are better than the ones obtained by Viterbi training, both in terms of likelihood and classification performance, but takes substantially longer to obtain these estimates. The Baum-Welch algorithm not only requires more iterations than Viterbi training, but the time required for each iteration is also longer.</p>
      </sec>
      <sec>
        <title>2.3.6 Length Distribution of Enriched Regions</title>
        <p>When studying histone modifications one possible characteristic of interest is the length of enriched regions. To assess how accurately the different methods reflect the length distribution of enriched regions, we compare the length of regions predicted by TileMap and by the model (using Baum-Welch parameter estimates) to the length distribution of enriched regions in the simulated data (the "true length distribution"). Note that this length distribution may vary from the one found in real data. Nevertheless this comparison highlights some of the differences between the two models. Quantile-quantile plots of the respective length distributions show that TileMap systematically underestimates the length of enriched regions (Figure <xref ref-type="fig" rid="F7">7</xref> (bottom left) and Figure <xref ref-type="fig" rid="F8">8</xref> (bottom left)). While this effect is relatively small on dataset I there is some indication that it increases with region length and long regions may not be characterised appropriately by TileMap (Figure <xref ref-type="fig" rid="F7">7</xref> (top left)). This observation is further supported by the length distribution of enriched regions produced by TileMap on dataset II (Figure <xref ref-type="fig" rid="F8">8</xref> (left)). Enriched regions in dataset II are generally longer than regions in dataset I. This difference is not captured by TileMap. Both TileMap and the Baum-Welch trained model produce several regions that are shorter than the shortest enriched region in the simulated data (Figure <xref ref-type="fig" rid="F7">7</xref> (bottom)). There are two possible explanations for these short regions. They may be caused by underestimating the length of enriched regions, possibly splitting one enriched region into several predicted regions, or they may represent spurious enriched results produced by the model. In each case there is the possibility that the occurrence of extremely short regions is caused either by an intrinsic shortcoming of the model or by artifacts introduced during the simulation process. Since the simulation relies on TileMap to identify enriched and non-enriched probes it is inevitable that some probes will be misclassified. Subsequently these probes may be included in the simulated data, causing short disruptions of enriched and non-enriched regions. A sufficiently sensitive model could detect these unintended changes between enriched and non-enriched states.</p>
        <fig position="float" id="F7">
          <label>Figure 7</label>
          <caption>
            <p><bold>Length distribution of enriched regions from dataset I</bold>. Quantile-quantile plots comparing length distributions of enriched regions found with TileMap (left) and with the model based on maximum likelihood estimates (right) to the true length distribution of enriched regions in dataset I. Figures on the bottom provide a close-up view of the plots above. Each dot represents a percentile of the length distributions.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-7"/>
        </fig>
        <fig position="float" id="F8">
          <label>Figure 8</label>
          <caption>
            <p><bold>Length distribution of enriched regions from dataset II</bold>. Quantile-quantile plots comparing length distributions of enriched regions found with TileMap (left) and with the model based on maximum likelihood estimates (right) to the true length distribution of enriched regions in dataset II. Figures on the bottom provide a close-up view of the plots above. Each dot represents a percentile of the length distributions.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-8"/>
        </fig>
        <p>To investigate further which of these is the case, we first examine the number of enriched probes contained in the short regions found by the Baum-Welch model and by TileMap respectively. The model with Baum-Welch parameter estimates found 126 regions with less than 10 probes. These regions contain a total of 866 probes of which 717 are in enriched regions. While this indicates that the majority of short regions is due to underestimating the length of enriched regions, several spurious probe calls remain. TileMap produced 249 regions with less than 10 probes, containing a total of 1781 probes, of which 1753 are in enriched regions. This is strong evidence that almost all of these short regions are caused by underestimating the length of enriched regions, and is consistent with the above observation that TileMap systematically underestimates the length of enriched regions.</p>
        <p>To investigate whether the spurious short regions produced by the Baum-Welch model are due to an intrinsic shortcoming of the model or are artifacts introduced by the simulation procedure, we turn to real data. Here we focus on enriched regions containing only a single probe, which are most likely to be false positives. On dataset I the Baum-Welch model produced six of these extremely short regions. One of these probes is a true positive from an enriched region containing ten probes, i.e., the length of this region is underestimated by the Baum-Welch model. Of the remaining five probes three are identical, leaving three unique probes to be investigated further. For each of these three probes, we determine its position in the real data and its distance from enriched regions identified by TileMap and by our model (Section 2.3.7). Two of the probes are found to be located close to enriched regions identified by TileMap (142 and 391 bp) and all three probes are contained within enriched regions identified by our model [see Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>]. This suggests that these probes may have been misclassified by TileMap during the original analysis, leading to an overestimation of the number of false positives produced by the Baum-Welch model on dataset I.</p>
      </sec>
      <sec>
        <title>2.3.7 Application to ChIP-Chip Data</title>
        <p>To investigate the performance of our model further, we apply it to the data of [<xref ref-type="bibr" rid="B3">3</xref>] and compare the result to the original analysis. Based on the results of the simulation study (Sections 2.3.3–2.3.6) we use the following procedure:</p>
        <p>1. Quantile normalise and log transform data;</p>
        <p>2. Calculate probe statistics (Equation (2));</p>
        <p>3. Obtain initial estimates (Section 2.2.1);</p>
        <p>4. Use 5 iterations of Viterbi training to improve initial estimates;</p>
        <p>5. Use 15 iterations of Baum-Welch algorithm to obtain maximum likelihood estimates;</p>
        <p>6. Apply resulting model to data to identify enriched regions.</p>
        <p>This results in the detection of 5285 H3K27me3 regions covering 12.9 Mb of genomic sequence. Of these enriched regions, 3962 (~75%) are overlapping at least one annotated transcript. A total of 4982 or about 18.9% of all annotated genes are found to be enriched for H3K27me3. While most of the enriched regions cover a single gene, some regions are found to contain up to seven genes (Figure <xref ref-type="fig" rid="F9">9(b)</xref>). Enriched regions are predominantly longer than 1 kb with some extending over more than 20 kb (Figure <xref ref-type="fig" rid="F9">9(c)</xref>).</p>
        <fig position="float" id="F9">
          <label>Figure 9</label>
          <caption>
            <p><bold>Analysis of ChIP-chip data</bold>. (a) Gene density in areas surrounding genes that contain H3K27me3 enriched regions and genes that do not contain enriched regions. (b) Number of genes found in H3K27me3 regions. While most enriched regions cover a single gene, there is a substantial number of H3K27me3 regions that cover several genes and enriched regions are found to contain up to seven genes. (c) Length distribution of H3K27me3 regions.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-343-9"/>
        </fig>
        <p>To assess whether there is a difference between regions of the genome that show H3K27me3 enrichment and the rest of the genome, we investigate the density of genes in the neighbourhood of genes that appear to be regulated by H3K27me3, and compare this to the gene density in other regions of the genome. For this purpose we obtain the gene density for the 50 kb upstream and downstream of each gene as (bp annotated as genes)/100 kb. The resulting gene densities for genes with and without enriched regions are summarised in Figure <xref ref-type="fig" rid="F9">9(a)</xref>. There are visible differences between the two distributions which we test for significance with a two sided Kolmogorov-Smirnov test; this results in an approximate <italic>p</italic>-value of 2 × 10<sup>-15</sup>. The significance of this result is further confirmed by a resampling experiment: the smallest <italic>p</italic>-value obtained from a series of 10000 resampled datasets is 1 × 10<sup>-6</sup>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>With the use of MLEs for all model parameters, our model clearly improves classification performance on simulated data compared to <italic>ad hoc </italic>estimates, and outperforms TileMap. While our model produced some short regions that appear to be false positives, they are readily explained as a result of the simulation process. Comparison of results on simulated and real data suggests that TileMap produced a large number of false negatives in the original analysis used as the basis for the simulation. Inevitably, these false negatives were selected as part of non-enriched regions during the simulation process. The fact that the model with Baum-Welch parameter estimates was able to identify these isolated enriched probes despite the non-enriched contexts where they appeared emphasises the high sensitivity of the model.</p>
    <p>TileMap's apparent tendency to penalise false positives more than false negatives clearly contributes to its relatively low performance in our comparisons which are based on the assumption that both types of error are equally problematic. While this is the case for the application considered here, one may argue that false positives are indeed of greater concern in some cases. When this is the case, TileMap's trade-off between sensitivity and specificity may lead to better results. However, it should be noted that the relative weights given to false positives and false negatives by TileMap can vary substantially between datasets. The parameter estimation procedure used for our model on the other hand provides consistent performance at the chosen cut-off.</p>
    <p>The model-fitting procedure derived from the results of the simulation study (Sections 2.3.3–2.3.6) provides a fast and reliable approach to parameter estimation. This method retains all the favourable properties of the Baum-Welch algorithm while utilising the reduced computing time provided by Viterbi training. The use of MLEs ensures that model parameters are appropriate for the data. Results from the simulation study show that estimating model parameters from the data improves the model's ability to recognise enriched regions of varying length and generally improves classification performance.</p>
    <sec>
      <title>3.1 Future Work</title>
      <p>The analysis of the H3K27me3 data (Section 2.3.7) largely confirms the analysis of [<xref ref-type="bibr" rid="B3">3</xref>] although there are some notable differences. Most importantly, the H3K27me3 regions detected by our analysis are longer than the ones determined by TileMap (Figure <xref ref-type="fig" rid="F10">10</xref>). While Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="B3">3</xref>] found few regions longer than 1 kb, our analysis indicates that over 70% of enriched regions have a length of at least 1 kb, with the longest region spanning over 20 kb. Accordingly we find more regions that extend over several genes (Figure <xref ref-type="fig" rid="F9">9(b)</xref>). This may have implications for conclusions about the spreading of H3K27me3 regions in <italic>Arabidopsis</italic>.</p>
      <p>At this stage, the biological significance of the observed difference in gene density in the neighbourhood of enriched and non-enriched genes is unclear. However, it indicates that the two groups of genes differ in a significant way. This suggests that the partition into enriched and non-enriched genes produced by our analysis is indeed meaningful.</p>
      <fig position="float" id="F10">
        <label>Figure 10</label>
        <caption>
          <p><bold>Length distribution of enriched regions from real data</bold>. Length distribution of enriched regions as determined by TileMap (blue) and Baum-Welch (red). Region length is determined in terms of probes per region. Both distributions were truncated at 10 for the simulation, ensuring that all regions in the simulated data contain at least ten probes.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-343-10"/>
      </fig>
      <p>The hidden Markov model presented in this article uses homogeneous transition probabilities, assuming that all probes are spaced out equally along the genome. To satisfy this assumption at least approximately, we use a fixed cut-off of 200 bp to partition the sequence of probe statistics such that there are no large gaps between probes. This arbitrary cut-off could be avoided by using a continuous time hidden Markov model.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Methods</title>
    <sec>
      <title>4.1 Baum-Welch Algorithm</title>
      <p>The Baum-Welch algorithm [<xref ref-type="bibr" rid="B16">16</xref>] used to estimate parameters for our model is outlined in Section 2.2.2; further details are given below. Computing the likelihood of the long observation sequences produced by tiling arrays involves products of many small contributions. This typically results in likelihoods below machine precision. To avoid this effect computations are carried out in log-space, using the identity</p>
      <p>
        <disp-formula id="bmcM4"><label>(4)</label>ln(<italic>x </italic>+ <italic>y</italic>) = ln(<italic>x</italic>) + ln (1 + <italic>e</italic><sup>ln(<italic>y</italic>)-ln(<italic>x</italic>)</sup>).</disp-formula>
      </p>
      <p>In the following we use <sup>ln</sup>∑ to denote summations which should be computed via Equation (4). The sequence of probe statistics <italic>Y </italic>is split into <italic>D </italic>observation sequences <italic>Y </italic><sup>(<italic>d</italic>) </sup>such that the distance between probes within each observation sequence is at most max_gap and the distance between the end points of different observation sequences is greater than max_gap.</p>
      <p>The emission distribution of state <italic>S</italic><sub><italic>i </italic></sub>is given as</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-343-i7" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>f</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
                <mml:mo>;</mml:mo>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mi>σ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mi>ν</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>Γ</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>ν</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mi>Γ</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>ν</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mfrac>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>σ</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:mi>π</mml:mi>
                        <mml:msub>
                          <mml:mi>ν</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:msup>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msub>
                                          <mml:mi>y</mml:mi>
                                          <mml:mi>k</mml:mi>
                                        </mml:msub>
                                        <mml:mo>−</mml:mo>
                                        <mml:msub>
                                          <mml:mi>μ</mml:mi>
                                          <mml:mi>i</mml:mi>
                                        </mml:msub>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:msup>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>σ</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:msub>
                                      <mml:mi>ν</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mfrac>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>ν</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>For a given parameter set <italic>θ </italic>we can obtain new parameter estimates for transition probabilities by calculating</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-343-i8" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>ξ</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mi>ln</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mi>q</mml:mi>
                  <mml:mi>k</mml:mi>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mi>q</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:msub>
                <mml:mo>|</mml:mo>
                <mml:msup>
                  <mml:mi>Y</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>;</mml:mo>
                <mml:mi>θ</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">]</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-343-i9" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>α</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ln</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ln</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:msub>
                          <mml:mi>f</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                        <mml:mo>;</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mi>β</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                        <mml:mo>−</mml:mo>
                        <mml:mi>ln</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msup>
                          <mml:mi>Y</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>d</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>;</mml:mo>
                        <mml:mi>θ</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here <italic>α</italic><sub><italic>k </italic></sub>and <italic>β</italic><sub><italic>k </italic></sub>are known as forward and backward variables. For observation sequence <italic>d</italic>, <italic>d </italic>= 1, ..., <italic>D</italic>, they are defined as</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-343-i10" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>α</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msub>
                  <mml:mi>p</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msub>
                  <mml:mi>f</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mi>y</mml:mi>
                  <mml:mn>1</mml:mn>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>;</mml:mo>
                <mml:msub>
                  <mml:mi>θ</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-343-i11" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>α</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>ln</mml:mi>
                            <mml:mstyle displaystyle="true">
                              <mml:munderover>
                                <mml:mo>∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mi>N</mml:mi>
                              </mml:munderover>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>α</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:msubsup>
                                <mml:mo>+</mml:mo>
                                <mml:mi>ln</mml:mi>
                                <mml:mo stretchy="false">[</mml:mo>
                                <mml:msub>
                                  <mml:mi>a</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo stretchy="false">]</mml:mo>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ln</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:msub>
                          <mml:mi>f</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                        <mml:mo>;</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where 1 ≤ <italic>i </italic>≤ <italic>N</italic>, 1 ≤ <italic>j </italic>≤ <italic>N</italic>, 1 ≤ <italic>k </italic>&lt;<italic>K</italic><sub><italic>d </italic></sub>and</p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-343-i12" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>β</mml:mi>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>K</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:msub>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM11">
          <label>(11)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-343-i13" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>β</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ln</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:msub>
                          <mml:mi>f</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                        <mml:mo>;</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mi>β</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where 1 ≤ <italic>i </italic>≤ <italic>N</italic>, 1 ≤ <italic>i </italic>≤ <italic>N</italic>, <italic>k </italic>= <italic>K</italic><sub><italic>d </italic></sub>- 1, ..., 1. Note that ln [<italic>P</italic>(<italic>Y </italic><sup>(<italic>d</italic>)</sup>; <italic>θ</italic>)] is given by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-343-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula> We then calculate</p>
      <p>
        <disp-formula id="bmcM12">
          <label>(12)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-9-343-i15" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>γ</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mi>q</mml:mi>
                  <mml:mi>k</mml:mi>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>|</mml:mo>
                <mml:msup>
                  <mml:mi>Y</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>;</mml:mo>
                <mml:mi>θ</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">]</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-9-343-i16" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mi>α</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>+</mml:mo>
                <mml:msubsup>
                  <mml:mi>β</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>−</mml:mo>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msup>
                  <mml:mi>Y</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>;</mml:mo>
                <mml:mi>θ</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">]</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM14">
          <label>(14)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-9-343-i17" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Combining the estimates from all observation sequences we obtain new parameter estimates for the transition probabilities:</p>
      <p>
        <disp-formula id="bmcM15">
          <label>(15)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-9-343-i18" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>a</mml:mi>
                    <mml:mo>ˆ</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>D</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>ln</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow/>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>K</mml:mi>
                            <mml:mi>d</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>ξ</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>−</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>D</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>ln</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow/>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>K</mml:mi>
                            <mml:mi>d</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>γ</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM16">
          <label>(16)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-9-343-i19" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>p</mml:mi>
                    <mml:mo>ˆ</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>D</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>γ</mml:mi>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>−</mml:mo>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Calculations for the re-estimation of <italic>θ</italic><sub>2 </sub>may involve negative values and cannot be carried out in log-space.</p>
      <p>To obtain the required parameter estimates we first define <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-9-343-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> and then compute</p>
      <p>
        <disp-formula id="bmcM17">
          <label>(17)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-9-343-i21" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>u</mml:mi>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ν</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ν</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mi>k</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:msubsup>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM18">
          <label>(18)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-9-343-i22" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>ˆ</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>K</mml:mi>
                                <mml:mi>d</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>τ</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                            <mml:msubsup>
                              <mml:mi>u</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                            <mml:msubsup>
                              <mml:mi>y</mml:mi>
                              <mml:mi>k</mml:mi>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>K</mml:mi>
                                <mml:mi>d</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>τ</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                            <mml:msubsup>
                              <mml:mi>u</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM19">
          <label>(19)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-9-343-i23" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>σ</mml:mi>
                    <mml:mo>ˆ</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>K</mml:mi>
                                <mml:mi>d</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>τ</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                            <mml:msubsup>
                              <mml:mi>u</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mi>y</mml:mi>
                                      <mml:mi>k</mml:mi>
                                      <mml:mi>d</mml:mi>
                                    </mml:msubsup>
                                    <mml:mo>−</mml:mo>
                                    <mml:msub>
                                      <mml:mover accent="true">
                                        <mml:mi>μ</mml:mi>
                                        <mml:mo>ˆ</mml:mo>
                                      </mml:mover>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>K</mml:mi>
                                <mml:mi>d</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>τ</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>There is no closed form estimate for <italic>ν</italic><sub><italic>i</italic></sub>. To obtain <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-9-343-i24" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> one has to find a solution to the equation</p>
      <p>
        <disp-formula id="bmcM20">
          <label>(20)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-9-343-i25" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mi>ψ</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>ν</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mfrac>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:mi>ln</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>ν</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mfrac>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mstyle displaystyle="true">
                              <mml:msubsup>
                                <mml:mo>∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>K</mml:mi>
                                    <mml:mi>d</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:msubsup>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mi>τ</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>K</mml:mi>
                                <mml:mi>d</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>τ</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mstyle>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>ln</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mi>u</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:msubsup>
                              <mml:mi>u</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:mi>ψ</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>ν</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mfrac>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mi>ln</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>ν</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mfrac>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>ψ </italic>is the digamma function. Standard root-finding techniques are employed to find a solution to (20).</p>
    </sec>
    <sec>
      <title>4.2 Viterbi Training</title>
      <p>Viterbi training provides a faster alternative to the Baum-Welch algorithm. See Section 2.2.3 for a high level description of the algorithm. Details of the parameter estimation procedure are given below. Instead of calculating the conditional expectation of the complete data log likelihood, this algorithm first computes the most likely state sequence <italic>Q </italic>given the observation sequence <italic>Y </italic>and the current model <italic>θ</italic>. The sequence <italic>Y </italic>is partitioned according to <italic>Q</italic>, assigning each observation to the state that it most likely originated from. New estimates for <italic>θ</italic><sub>1 </sub>are then obtained by calculating</p>
      <p>
        <disp-formula id="bmcM21">
          <label>(21)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-9-343-i26" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>p</mml:mi>
                    <mml:mo>ˆ</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>D</mml:mi>
                </mml:mfrac>
                <mml:mo>|</mml:mo>
                <mml:mo>{</mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mn>...</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>:</mml:mo>
                <mml:msubsup>
                  <mml:mi>q</mml:mi>
                  <mml:mn>1</mml:mn>
                  <mml:mi>d</mml:mi>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>}</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM22">
          <label>(22)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-9-343-i27" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>a</mml:mi>
                    <mml:mo>ˆ</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>|</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>...</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>:</mml:mo>
                    <mml:msubsup>
                      <mml:mi>q</mml:mi>
                      <mml:mi>k</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:msubsup>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>S</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mtext> and </mml:mtext>
                    <mml:msubsup>
                      <mml:mi>q</mml:mi>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:msubsup>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>S</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                    <mml:mo>}</mml:mo>
                    <mml:mo>|</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Updates for <italic>μ </italic>and <italic>σ </italic>are obtained as in Section 2.2.1. The degrees of freedom <italic>ν </italic>can be either fixed in advance or estimated from the data using Equation (20) by setting <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-9-343-i28" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:semantics></mml:math></inline-formula> if <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-9-343-i29" overflow="scroll"><mml:semantics><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-9-343-i30" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:semantics></mml:math></inline-formula> otherwise.</p>
    </sec>
    <sec>
      <title>4.3 Simulated Data</title>
      <p>In a first step following the original analysis by [<xref ref-type="bibr" rid="B3">3</xref>], TileMap [<xref ref-type="bibr" rid="B7">7</xref>] is used with the HMM option to define enriched and non-enriched probes. Note that, although this classification of probes is not perfect, it can be assumed that most probes are assigned to the correct group. The length distribution of enriched and non-enriched regions detected by TileMap is used to determine the length distributions for the simulated data after removing all regions that contain less than 10 probes (Figure <xref ref-type="fig" rid="F10">10</xref>). Data are generated by first determining the length of enriched and non-enriched regions from the empirical length distributions and then sampling data points from the respective TileMap generated clusters. Following this procedure, 600 sequences with one to ten enriched regions in each sequence are generated. A second dataset is generated by applying the model described in Section 2. Note that, although this procedure relies on the classifications produced by the respective models, the resampling procedure will place individual probe values in a new context of surrounding probes, which may lead to different probe calls in the analysis of the simulated data. Prior to analysis all data are quantile normalised.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Availability</title>
    <p>The parameter estimation methods used in this article are available as part of the R package tileHMM from the authors' webpage <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/TileHMM/"/> and from CRAN. The simulated data used in this study is available from the authors' web page.</p>
  </sec>
  <sec>
    <title>6 Authors' contributions</title>
    <p>PH conducted the research and wrote the manuscript. DB critically revised the manuscript. GS conceived the project. DB and GS provided supervision to PH. All authors have read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>False negative probe calls resulting from different models</bold>. For any given cut-off TileMap produces more false negatives than the Baum-Welch and Viterbi trained models.</p>
      </caption>
      <media xlink:href="1471-2105-9-343-S1.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>False positive probe calls resulting from different models</bold>. For any given cut-off TileMap produces fewer false positives than the Baum-Welch and Viterbi trained models.</p>
      </caption>
      <media xlink:href="1471-2105-9-343-S2.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Origin of isolated enriched probes in dataset I</bold>. The isolated enriched probes identified in dataset I by the Baum-Welch model originate from enriched regions identified by the Baum-Welch model in the real data. Two out of three probes are located close to enriched regions identified by TileMap.</p>
      </caption>
      <media xlink:href="1471-2105-9-343-S3.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>PH is supported by an MQRES scholarship from Macquarie University and a top-up scholarship from CSIRO. The authors would like to thank Michael Buckley for his helpful suggestions.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cawley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bekiranov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Kapranov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sekinger</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Kampa</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Piccolboni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sementchenko</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yamanaka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tammana</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Helt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Struhl</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>Unbiased Mapping of Transcription Factor Binding Sites along Human Chromosomes 21 and 22 Points to Widespread Regulation of Noncoding RNAs</article-title>
        <source>Cell</source>
        <year>2004</year>
        <volume>116</volume>
        <fpage>499</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="pmid">14980218</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0092-8674(04)00127-8</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Kamal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lindblad-Toh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bekiranov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Huebert</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>III</surname>
            <given-names>EJK</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Genomic Maps and Comparative Analysis of Histone Modifications in Human and Mouse</article-title>
        <source>Cell</source>
        <year>2005</year>
        <volume>120</volume>
        <fpage>169</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="pmid">15680324</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cell.2005.01.001</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Clarenz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cokus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bernatavichute</surname>
            <given-names>YV</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jacobsen</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Whole-Genome Analysis of Histone H3 Lysine 27 Trimethylation in Arabidopsis</article-title>
        <source>PLoS Biol</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e129</fpage>
        <pub-id pub-id-type="pmid">17439305</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050129</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yazaki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sundaresan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cokus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>SWL</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>IR</given-names>
          </name>
          <name>
            <surname>Shinn</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jacobsen</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide High-Resolution Mapping and Functional Analysis of DNA Methylation in Arabidopsis</article-title>
        <source>Cell</source>
        <year>2006</year>
        <volume>126</volume>
        <fpage>1189</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="pmid">16949657</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cell.2006.08.003</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertone</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stolc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Royce</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Tongprasit</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Samanta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Global Identification of Human Transcribed Sequences with Genome Tiling Arrays</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>306</volume>
        <fpage>2242</fpage>
        <lpage>2246</lpage>
        <pub-id pub-id-type="pmid">15539566</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1103388</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>A hidden Markov model for analyzing ChIP-chip experiments on genome tiling arrays and its application to p53 binding sequences</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>i274</fpage>
        <lpage>i282</lpage>
        <pub-id pub-id-type="pmid">15961467</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1046</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>TileMap: create chromosomal map of tiling array hybridisations</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3629</fpage>
        <lpage>3636</lpage>
        <pub-id pub-id-type="pmid">16046496</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti593</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Munch</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Arctander</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A hidden Markov model approach for determining expression from genomic tiling micro arrays</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>239</fpage>
        <pub-id pub-id-type="pmid">16672042</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-239</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Toedling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Transcript mapping with high-density oligonucleotide tiling arrays</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1963</fpage>
        <lpage>1970</lpage>
        <pub-id pub-id-type="pmid">16787969</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl289</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reiss</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Facciotti</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Baliga</surname>
            <given-names>NS</given-names>
          </name>
        </person-group>
        <article-title>Model-based deconvolution of genome-wide DNA binding</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>396</fpage>
        <lpage>403</lpage>
        <pub-id pub-id-type="pmid">18056063</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm592</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toyoda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shinozaki</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Tiling array-driven elucidation of transcriptional structures based on maximum-likelihood and Markov models</article-title>
        <source>The Plant Journal</source>
        <year>2005</year>
        <volume>43</volume>
        <fpage>611</fpage>
        <lpage>621</lpage>
        <pub-id pub-id-type="pmid">16098113</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1365-313X.2005.02470.x</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Royce</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A supervised hidden Markov model framework for efficiently segmenting tiling array data in transcriptional an ChIP-chip experiments: systematically incorporating validated biological knowledge</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>3016</fpage>
        <lpage>3024</lpage>
        <pub-id pub-id-type="pmid">17038339</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl515</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keleş</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mixture Modeling for Genome-Wide Localization of Transcription Factors</article-title>
        <source>Biometrics</source>
        <year>2007</year>
        <volume>63</volume>
        <fpage>10</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">17447925</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2005.00659.x</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vokes</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>A comparative analysis of genome-wide chromatin immunoprecipitation data for mammalian transcription factors</article-title>
        <source>Nucl Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>e146</fpage>
        <pub-id pub-id-type="pmid">17090591</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkl803</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Girardot</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brehme</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tongprasit</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stolc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Furlong</surname>
            <given-names>EEM</given-names>
          </name>
        </person-group>
        <article-title>A core transcriptional network for early mesoderm development in Drosophila melanogaster</article-title>
        <source>Genes &amp; Development</source>
        <year>2007</year>
        <volume>21</volume>
        <fpage>436</fpage>
        <lpage>449</lpage>
        <pub-id pub-id-type="pmid">17322403</pub-id>
        <pub-id pub-id-type="doi">10.1101/gad.1509007</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baum</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Petrie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Soules</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A Maximization Technique Occuring in the Statistical Analysis of Probabilistic Functions of Markov Chains</article-title>
        <source>The Annals of Mathematical Statistics</source>
        <year>1970</year>
        <volume>41</volume>
        <fpage>164</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177697196</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juang</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Rabiner</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>A segmental k-means algorithm for estimating parameters of hidden Markov models</article-title>
        <source>IEEE Transactions on Acoustics, Speech, and Signal Processing</source>
        <year>1990</year>
        <volume>38</volume>
        <fpage>1639</fpage>
        <lpage>1641</lpage>
        <pub-id pub-id-type="doi">10.1109/29.60082</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Opgen-Rhein</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Accurate Ranking of differentially expressed genes by a distribution-free shrinkage approach</article-title>
        <source>Statistical applications in Genetics and Molecular Biology</source>
        <year>2007</year>
        <volume>6</volume>
        <fpage>Article 9</fpage>
        <pub-id pub-id-type="pmid">17402924</pub-id>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1252</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear Models and Empirical Bayes Methods for Assessing Differential Expression in Microarray Experiments</article-title>
        <source>Statistical Applications in Genetics and Molecular Biology</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>Article 3</fpage>
        <pub-id pub-id-type="pmid">16646809</pub-id>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lange</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Little</surname>
            <given-names>RJA</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JMG</given-names>
          </name>
        </person-group>
        <article-title>Robust Statistical Modeling Using the t Distribution</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>1989</year>
        <volume>84</volume>
        <fpage>881</fpage>
        <lpage>896</lpage>
        <pub-id pub-id-type="doi">10.2307/2290063</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabiner</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on Hidden Markov Models and Selected Applications in Speech Recognition</article-title>
        <source>Proceedings of the IEEE</source>
        <year>1989</year>
        <volume>77</volume>
        <fpage>257</fpage>
        <lpage>286</lpage>
        <pub-id pub-id-type="doi">10.1109/5.18626</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viterbi</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Error bounds for convolutional codes and an assymptotically optimal decoding algorithm</article-title>
        <source>IEEE Transactions on Information Theory</source>
        <year>1967</year>
        <volume>13</volume>
        <fpage>260</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1109/TIT.1967.1054010</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartigan</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>A K-means clustering algorithm</article-title>
        <source>Applied Statistics</source>
        <year>1979</year>
        <volume>28</volume>
        <fpage>100</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.2307/2346830</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum Likelihood for Incomplete Data via the EM Algorithm</article-title>
        <source>Journal of the Royal Statistical Society, Series B</source>
        <year>1977</year>
        <volume>39</volume>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>ML estimation of the t distribution using EM and its extensions, ECM and ECME</article-title>
        <source>Statistica Sinica</source>
        <year>1995</year>
        <volume>5</volume>
        <fpage>19</fpage>
        <lpage>39</lpage>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Robust mixture modelling using the t distribution</article-title>
        <source>Statistics and Computing</source>
        <year>2000</year>
        <volume>10</volume>
        <fpage>339</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1008981510081</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
