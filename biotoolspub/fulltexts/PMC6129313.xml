<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6129313</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty197</article-id>
    <article-id pub-id-type="publisher-id">bty197</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhenotypeSimulator: A comprehensive framework for simulating multi-trait, multi-locus genotype to phenotype relationships</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Meyer</surname>
          <given-names>Hannah Verena</given-names>
        </name>
        <xref ref-type="corresp" rid="bty197-cor1"/>
        <!--<email>hannah@ebi.ac.uk</email>-->
        <xref ref-type="aff" rid="bty197-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Birney</surname>
          <given-names>Ewan</given-names>
        </name>
        <xref ref-type="aff" rid="bty197-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty197-aff1">European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Trust Genome Campus, Hinxton, Cambridge, UK</aff>
    <author-notes>
      <corresp id="bty197-cor1">To whom correspondence should be addressed. E-mail: <email>hannah@ebi.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-03-29">
      <day>29</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>17</issue>
    <fpage>2951</fpage>
    <lpage>2956</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>01</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty197.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Simulation is a critical part of method development and assessment. With the increasing sophistication of multi-trait and multi-locus genetic analysis techniques, it is important that the community has flexible simulation tools to challenge and explore the properties of these methods.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed <italic>PhenotypeSimulator</italic>, a comprehensive phenotype simulation scheme that can model multiple traits with multiple underlying genetic loci as well as complex covariate and observational noise structure. This package has been designed to work with many common genetic tools both for input and output. We describe the underlying components of this simulation tool and illustrate its use on an example dataset.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><italic>PhenotypeSimulator</italic> is available as a well documented R/CRAN package and the code is available on github: <ext-link ext-link-type="uri" xlink:href="https://github.com/HannahVMeyer/PhenotypeSimulator">https://github.com/HannahVMeyer/PhenotypeSimulator</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">HVM</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">EB</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003038</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">EMBL</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The relationship between genotype and phenotype has been a topic for over a 100 years of biological research. There are a multitude of phenotypes for each organism, defined by the observations and measurements one can make on individuals, and these phenotypes can be related to each other in complex ways. Furthermore, the link between genotype and phenotype is equally complex, with many phenotypes being influenced by more than one genetic locus (polygenic effects) and one locus influencing many phenotypes (pleiotropic effects). Finally, a multitude of environmental and measurement effects influence phenotypes. Statistical genetics continues to develop novel ways to analyse genotype to phenotype relationships; models range from simple linear models with genetic variant effects on a single trait to complex linear mixed models (LMMs) with additional genetic and non-genetic random effect components on multiple traits. All models account for observational noise and, usually, known environmental covariates (<xref rid="bty197-B17" ref-type="bibr">Loh <italic>et al.</italic>, 2014</xref>; <xref rid="bty197-B19" ref-type="bibr">Marigorta and Gibson, 2014</xref>; <xref rid="bty197-B26" ref-type="bibr">Stephens, 2013</xref>; <xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>). With the increase in analysis complexity, researchers require sophisticated simulations of realistic genotype and phenotype structures. These simulations are critical for testing methods and exploring the impact of different phenotypic and genetic architectures of biological traits. The simulated genotypes and phenotypes reflect perceived understanding of the true phenotype structure but do not guarantee the biological correctness of real phenotypes. However, they are invaluable in model design, as any model showing flawed statistics on the possibly simplified biological model will suffer from at least the same flaws on the true biological data.</p>
    <p>Many simulation packages put a strong focus on the genotype simulation allowing for the simulation of different evolutionary selection processes via forward-time (<xref rid="bty197-B2" ref-type="bibr">Carvajal-Rodríguez, 2008</xref>; <xref rid="bty197-B13" ref-type="bibr">Lambert <italic>et al.</italic>, 2008</xref>; <xref rid="bty197-B14" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>; <xref rid="bty197-B20" ref-type="bibr">Neuenschwander <italic>et al.</italic>, 2008</xref>; <xref rid="bty197-B23" ref-type="bibr">Peng and Kimmel, 2005</xref>) and coalescent-based simulation (<xref rid="bty197-B6" ref-type="bibr">Ewing and Hermisson, 2010</xref>; <xref rid="bty197-B11" ref-type="bibr">Hudson, 2002</xref>; <xref rid="bty197-B12" ref-type="bibr">Kelleher <italic>et al.</italic>, 2016</xref>) frameworks. More recently, re-sampling-based approaches have been developed, where existing genotype data are sampled and combined to generate the genotypes of the simulated samples, while retaining the original allele frequency and LD patterns (<xref rid="bty197-B28" ref-type="bibr">Wright <italic>et al.</italic>, 2007</xref>; <xref rid="bty197-B27" ref-type="bibr">Su <italic>et al.</italic>, 2011</xref>). The majority of these methods allow for the simulation of simple case-control phenotypes or a single quantitative phenotype. In contrast, software packages that focus on more complex phenotype simulation often rely on simple genotype simulations (<xref rid="bty197-B22" ref-type="bibr">O’Reilly <italic>et al.</italic>, 2012</xref>; <xref rid="bty197-B24" ref-type="bibr">Porter and O’Reilly, 2017</xref>) or only support externally simulated genotype data (<xref rid="bty197-B9" ref-type="bibr">Günther <italic>et al.</italic>, 2011</xref>; <xref rid="bty197-B29" ref-type="bibr">Zhbannikov <italic>et al.</italic>, 2017</xref>) (a list of common genotype and phenotype simulation tools and their simulation strategy is given in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, SupplementaryTable.pdf). Among the software with a focus on phenotype simulation, MultiPhen (<xref rid="bty197-B22" ref-type="bibr">O’Reilly <italic>et al.</italic>, 2012</xref>) and MultiTraitGWAS (<xref rid="bty197-B24" ref-type="bibr">Porter and O’Reilly, 2017</xref>) facilitate the simulation of multiple phenotypes per individual. They both offer the simulation of phenotypes with genetic variant effects and an observational noise term with user-defined covariance structure. In addition, MultiTraitGWAS can simulate non-genetic covariate terms.</p>
    <p>Here, we introduce <italic>PhenotypeSimulator</italic>, an R/CRAN package for the flexible simulation of phenotypes with different genetic and non-genetic variance components. <italic>PhenotypeSimulator</italic> is a framework focusing on the simulation of phenotypes, with a particular emphasis on complexity of both multiple phenotypes and multiple genetic loci, which is not provided by other multi-phenotype simulation software (<xref rid="bty197-B22" ref-type="bibr">O’Reilly <italic>et al.</italic>, 2012</xref>; <xref rid="bty197-B24" ref-type="bibr">Porter and O’Reilly, 2017</xref>). In addition to genetic variant effects, it allows for the simulation of infinitesimal genetic effects (i.e. genetic background) which are a key component of standard LMMs for genetic association studies, various non-genetic covariate effects and noise effects with pre-defined covariance structure. <italic>PhenotypeSimulator</italic> offers similar genotype simulation as used in other software (<xref rid="bty197-B22" ref-type="bibr">O’Reilly <italic>et al.</italic>, 2012</xref>; <xref rid="bty197-B24" ref-type="bibr">Porter and O’Reilly, 2017</xref>) and studies (<xref rid="bty197-B16" ref-type="bibr">Lippert <italic>et al.</italic>, 2013</xref>). We have written <italic>PhenotypeSimulator</italic> to be easily integrated with external genotype simulation software (such as coalescent and forward time simulation and re-sampling approaches) and it can generate output suitable as input for a number of standard genetic association tools such as PLINK (<xref rid="bty197-B4" ref-type="bibr">Chang <italic>et al.</italic>, 2015</xref>), GEMMA (<xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>) or SNPTEST (<xref rid="bty197-B18" ref-type="bibr">Marchini <italic>et al.</italic>, 2007</xref>). We demonstrate the usage and application of <italic>PhenotypeSimulator</italic> by simulating phenotypes and using it to evaluate the power of different LMM designs in a genetic association study.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Phenotype simulation with <italic>PhenotypeSimulator</italic></title>
      <sec>
        <title>2.1.1 Phenotype components</title>
        <p>In <italic>PhenotypeSimulator</italic>, the phenotypes <inline-formula id="IE2"><mml:math id="IM1"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> of <italic>N</italic> samples and <italic>P</italic> traits are generated as the sum of (i) genetic variant effects <inline-formula id="IE3"><mml:math id="IM2"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, (ii) infinitesimal genetic effects <inline-formula id="IE4"><mml:math id="IM3"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, (iii) non-genetic covariate effects <inline-formula id="IE5"><mml:math id="IM4"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, (iv) correlated non-genetic effects <inline-formula id="IE6"><mml:math id="IM5"><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and (v) observational noise effects <inline-formula id="IE7"><mml:math id="IM6"><mml:mrow><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">N</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. For components (i)–(iii) and (v), the user can chose a certain percentage of their variance to be shared across all traits (shared) and the remainder to be independent (ind) across traits. By allowing for a split in variance components, we provide the opportunity to simulate scenarios where the components affect the trait set in a heterogeneous manner, allowing to simulate for instance pleiotropic effects for the genetic variants.</p>
        <p> Genetic variant effects: For the genetic variant effects, <italic>S</italic> random SNPs for <italic>N</italic> samples are drawn from the (simulated) genotypes. From the <italic>S</italic> random SNPs, a proportion <inline-formula id="IE8"><mml:math id="IM7"><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:math></inline-formula> is selected to be causal across all traits. The shared genetic variant effect is simulated as the matrix product of this shared causal SNP matrix <inline-formula id="IE9"><mml:math id="IM8"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo>×</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and the shared effect size matrix <inline-formula id="IE10"><mml:math id="IM9"><mml:mrow><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mo>θ</mml:mo><mml:mo>×</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The columns of the shared effect size matrix are simulated to be perfectly correlated, i.e. the effect of a SNP genetic effect is proportionally the same for all affected traits. The effect sizes for <inline-formula id="IE11"><mml:math id="IM10"><mml:mrow><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> can either be simulated to have normal or uniform properties. The is implemented as follows in <italic>PhenotypeSimulator</italic>: <bold>B</bold><sup>shared</sup> is the matrix product of the two vectors <inline-formula id="IE12"><mml:math id="IM11"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mo>θ</mml:mo><mml:mo>×</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM12"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. To simulate effect sizes with approximately normal properties (<xref rid="bty197-B21" ref-type="bibr">Oliveira and Seijas-Macias, 2012</xref>; Equations (31)–(33)), <italic>b<sub>s</sub></italic> and <italic>b<sub>p</sub></italic> are drawn from two normal distributions, where <inline-formula id="IE14"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE15"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mo>σ</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM15"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mo>σ</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> specified by the user. For the simulation of uniformly distributed effect sizes, <italic>b<sub>s</sub></italic> and <inline-formula id="IE18"><mml:math id="IM17"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are drawn from two exponential distributions whose negative normalized log product yields an approximate uniform distribution (<xref rid="bty197-B25" ref-type="bibr">Song, 2005</xref>) across the user-defined range. The remaining <inline-formula id="IE19"><mml:math id="IM18"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula><italic>S</italic> SNPs are simulated to have an independent effect across a specified number of traits <inline-formula id="IE20"><mml:math id="IM19"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. To realize this structure, <inline-formula id="IE21"><mml:math id="IM20"><mml:mrow><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is initialized with either normally or uniformly distributed entries, with <italic>μ<sub>B</sub></italic> and <italic>σ<sub>B</sub></italic> as specified by the user (same as for shared effect). Subsequently, <inline-formula id="IE22"><mml:math id="IM21"><mml:mrow><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> traits are randomly selected and the row entries for <bold>B</bold><sup>ind</sup> at these traits set to zero. The independent genetic variant effect is the matrix product of <inline-formula id="IE23"><mml:math id="IM22"><mml:mrow><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <bold>B</bold><sup>ind.</sup></p>
        <p>Non-genetic covariate effects: The non-genetic covariate effects are based on <italic>K</italic> non-genetic covariates <inline-formula id="IE24"><mml:math id="IM23"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, with a proportion <italic>γ</italic> being shared across all traits yielding the shared covariates matrix <inline-formula id="IE25"><mml:math id="IM24"><mml:mrow><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The proportion of <inline-formula id="IE26"><mml:math id="IM25"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:math></inline-formula> non-genetic covariates that are independent make up the independent covariates matrix <inline-formula id="IE27"><mml:math id="IM26"><mml:mrow><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The distributions for each of the <italic>K</italic> non-genetic covariates are independent and can be either normal, uniform, binomial or categorical. The distribution and respective parameters are chosen by the user. The effect size matrices <inline-formula id="IE28"><mml:math id="IM27"><mml:mrow><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mo>γ</mml:mo><mml:mo>×</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM28"><mml:mrow><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> were designed as described for the genetic effects. The final non-genetic covariate effects are the matrix product of the covariate matrices and their effect size matrices: <inline-formula id="IE30"><mml:math id="IM29"><mml:mrow><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE31"><mml:math id="IM30"><mml:mrow><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        <p>Infinitesimal genetic effects: The basis of the infinitesimal genetic effect <bold>U</bold> is the <italic>N </italic>×<italic> N</italic> genetic relationship matrix <bold>K</bold>, either estimated from the genotypes of the simulated samples as <inline-formula id="IE32"><mml:math id="IM31"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mi mathvariant="bold">X</mml:mi><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>m</italic> is the mean value of the diagonal elements of <inline-formula id="IE33"><mml:math id="IM32"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> or provided by the user. A suitable model for simulating the infinitesimal genetic effect <inline-formula id="IE34"><mml:math id="IM33"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with the known <italic>N </italic>×<italic> N</italic> sample covariance <bold>K</bold> and trait covariance <bold>C</bold> is a multivariate normal distribution (as for instance by <xref rid="bty197-B3" ref-type="bibr">Casale <italic>et al.</italic>, 2015</xref>; <xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>) where
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>⊗</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The structure of <bold>C</bold> depends on the desired design of the covariance effect, which can be either shared or independent across traits. This distribution can be realized by simulating a random variable <inline-formula id="IE35"><mml:math id="IM34"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as iid <inline-formula id="IE36"><mml:math id="IM35"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and setting
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">Z</mml:mi><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE37"><mml:math id="IM36"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> reflects the genetic relationship i.e. sample covariance with <inline-formula id="IE38"><mml:math id="IM37"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE39"><mml:math id="IM38"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the trait covariance with <inline-formula id="IE40"><mml:math id="IM39"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, respectively (<italic>M</italic> and <italic>L</italic> depend on the rank of <italic>K</italic> and <italic>C</italic>, hence are bound by <italic>N</italic> and <italic>P</italic>). A detailed derivation of <xref ref-type="disp-formula" rid="E2">Equation (2)</xref> from <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> (SimulationSchemeInfinitesimalGeneticEffect.pdf) and has similarly been applied in (<xref rid="bty197-B3" ref-type="bibr">Casale <italic>et al.</italic>, 2015</xref>). By recasting <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> as <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>, the infinitesimal genetic effect <bold>U</bold> described by a multivariate normal distribution is effectively modelled as the product of three matrices, representing the sample covariance (<bold>B</bold>), a normally distributed variable (<bold>Z</bold>) and the trait covariance (<bold>A</bold>). Different designs of <bold>A</bold> will allow for the simulation of shared and independent genetic random effects. For the independent effect, <bold>A</bold><sup>ind</sup> is a diagonal matrix with normally distributed entries: <inline-formula id="IE41"><mml:math id="IM40"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, such that <inline-formula id="IE42"><mml:math id="IM41"><mml:mrow><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">Z</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. <bold>A</bold><sup>shared</sup> of the shared effect is simulated as a matrix of column rank one, with normally distributed entries in column one and zeros elsewhere: <inline-formula id="IE43"><mml:math id="IM42"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE44"><mml:math id="IM43"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> such that <inline-formula id="IE45"><mml:math id="IM44"><mml:mrow><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">Z</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Correlated non-genetic effects: Correlated non-genetic effects are simulated as a multivariate normal distribution with a covariance matrix described by a defined trait-by-trait correlation. Any correlation structure between the phenotypes can be simulated with this effect component, as the desired correlation matrix <bold>C</bold> can be supplied by the user. In addition, as a simple approximation for spatially correlated phenotypes (as they might occur, for instance, in image-based phenotypes, for an example, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, SimulationBasedOnExampleData.pdf), <italic>PhenotypeSimulator</italic> provides the construction of such a <bold>C</bold> as follows: traits of distance <italic>d</italic> = 1 (adjacent trait columns) will have the highest specified correlation <italic>r</italic>, traits with <italic>d</italic> = 2 have a correlation of <italic>r</italic><sup>2</sup>, up to traits with <inline-formula id="IE46"><mml:math id="IM45"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with a correlation of <inline-formula id="IE47"><mml:math id="IM46"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, such that the correlation is highest at the first off-diagonal element and decreases exponentially by distance from the diagonal. The correlated non-genetic effect matrix is simulated as <inline-formula id="IE48"><mml:math id="IM47"><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mo>∼</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>Observational noise: The observational noise effects <inline-formula id="IE49"><mml:math id="IM48"><mml:mi mathvariant="bold">Ψ</mml:mi></mml:math></inline-formula> are simulated as the sum of a shared and an independent observational noise effect. Both effect components are simulated by the matrix product of <inline-formula id="IE50"><mml:math id="IM49"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE51"><mml:math id="IM50"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. To realize the shared effect <inline-formula id="IE52"><mml:math id="IM51"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ψ</mml:mi></mml:mstyle><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (which introduces perfect correlation between the traits in this component), <bold>A</bold><sup>shared</sup> is simulated as a matrix of row rank one, with normally distributed entries in row one and zeros elsewhere: <inline-formula id="IE53"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE54"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. <bold>A</bold> of the independent component is a diagonal matrix with normally distributed entries: <inline-formula id="IE55"><mml:math id="IM54"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p><italic>PhenotypeSimulator</italic> requires at least one phenotype component to simulate the phenotypes. Components can be combined as specified by the user and the correlation they introduce in the trait structure can be controlled by the specified levels of independent and shared effects (at the extremes, components can be simulated to either only have shared or independent effects). If desired, a simple phenotype structure following a model as cast, for instance, in the multivariate normal model by <xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens (2014)</xref> can be achieved by specifying only genetic variant effects, non-genetic covariate effects, infinitesimal genetic effects and observational noise.</p>
      </sec>
      <sec>
        <title>2.1.2 Scaling and phenotype construction</title>
        <p><italic>PhenotypeSimulator</italic> enables the specification of the amount of variance that each component should contribute to the total phenotypic variance. Every component is thereby scaled by a factor <italic>a</italic> such that its average column variance <inline-formula id="IE56"><mml:math id="IM55"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> explains a specified percentage <italic>x</italic> of the total variance:</p>
        <p><disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>x</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mtext>col</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula>
The final simulated phenotype <bold>Y</bold> is expressed as the sum of the scaled genetic variant effects, the non-genetic covariates, the correlated non-genetic effects and observational noise effects:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi mathvariant="bold">Y</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mrow><mml:mtext>ind</mml:mtext></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Case study</title>
      <p>The analysis code and parameters of this case study, from the data simulation to the genome-wide association study, can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> (Simulation-and-LinearModel.pdf).</p>
      <sec>
        <title>2.2.1 Data simulation</title>
        <p>Genotypes (8 073 414 genetic variants) for 1000 individuals were simulated via Hapgen2 (<xref rid="bty197-B27" ref-type="bibr">Su <italic>et al.</italic>, 2011</xref>) (re-sampling approach), based on the European Samples of the 1000 Genomes project (<xref rid="bty197-B1" ref-type="bibr">1000 Genomes Project Consortium, 2012</xref>). Phenotypes were simulated with <italic>PhenotypeSimulator</italic>, using the simulated genotypes as basis for the SNP and infinitesimal genetic effects. A total of three phenotypes for 1000 samples with the ten SNP genetic effects shared across all traits (randomly sampled from the simulated genotypes), four non-genetic covariates, an infinitesimal genetic, a correlated noise and an observational noise effect were simulated. For the genetic variant effects, only shared effects across traits were simulated. For the remainder of the phenotype component, 80% of their variance was simulated to be shared across all traits while the remaining proportion of variance remained independent. The total genetic variance was set to 40%, leaving 60% of variance explained by the noise terms.</p>
      </sec>
      <sec>
        <title>2.2.2 Genome-wide association study</title>
        <p>The simulated genotypes, phenotypes, kinship and covariates were used in GWAS. Two different types of GWAS were conducted (i) a multi-trait association study, jointly mapping all three traits and (ii) single-trait association studies, where each trait was individually tested for association with the genotypes. Single-trait GWAS was run for all three traits. All GWAS were conducted with GEMMA (version 0.96) (<xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>). In both, the multi-trait and single-trait GWAS, the phenotypes (-p flag) were modeled as the sum of genetic (simulated SNPs; -g flag) and non-genetic (simulated covariates; -c flag) fixed effects, a random genetic effect (with the eigenvectors and values of the kinship matrix, -u and -d flag) and observational noise (LMM with likelihood ratio test using the -lmm 2 flag). For a comparison of the number of causal SNPs recovered in the multi-trait and single-trait GWAS, the <italic>P</italic>-values of the single-trait GWAS were adjusted by the number of test conducted (Bonferroni adjustment for three tests).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p><italic>PhenotypeSimulator</italic> works by:
<list list-type="order"><list-item><p>Simulating or importing genotypes (<xref ref-type="fig" rid="bty197-F1">Fig. 1</xref>, genotypes),
</p></list-item><list-item><p>simulating genetic and non-genetic phenotype components of interest (<xref ref-type="fig" rid="bty197-F1">Fig. 1</xref>, light grey boxes),</p></list-item><list-item><p>scaling each component according to a certain proportion of variance explained (<xref ref-type="fig" rid="bty197-F1">Fig. 1</xref>, scaling),</p></list-item><list-item><p>combining re-scaled phenotype components into a final phenotype (<xref ref-type="fig" rid="bty197-F1">Fig. 1</xref>, phenotypes), and</p></list-item><list-item><p>saving phenotypes and genotypes in standard output formats (<xref ref-type="fig" rid="bty197-F1">Fig. 1</xref>, output).</p></list-item></list><italic>PhenotypeSimulator</italic> can simulate simple bi-allelic SNPs, where each SNP is simulated from a binomial distribution with two trials and probability equal to the given allele frequencies [as for instance used in (<xref rid="bty197-B16" ref-type="bibr">Lippert <italic>et al.</italic>, 2013</xref>)]. This simple approach, however, does not simulate any dependency between the genotypes as is observed with LD structure in the genome. To allow for more complex genotype structures, <italic>PhenotypeSimulator</italic> can import genotypes generated from different genotype simulation software, covering genotypes simulated from coalescent models GENOME (<xref rid="bty197-B15" ref-type="bibr">Liang <italic>et al.</italic>, 2007</xref>), a re-sampling-based approach HAPGEN2 (<xref rid="bty197-B27" ref-type="bibr">Su <italic>et al.</italic>, 2011</xref>) and different forward-time approaches delimited-formats as given by simuPOP (<xref rid="bty197-B23" ref-type="bibr">Peng and Kimmel, 2005</xref>), ForSim (<xref rid="bty197-B13" ref-type="bibr">Lambert <italic>et al.</italic>, 2008</xref>) and GenomePop2 (<xref rid="bty197-B2" ref-type="bibr">Carvajal-Rodríguez, 2008</xref>). In addition, standard genotype formats such as PLINK (<xref rid="bty197-B4" ref-type="bibr">Chang <italic>et al.</italic>, 2015</xref>) or BIMBAM (<xref rid="bty197-B8" ref-type="bibr">Guan and Stephens, 2008</xref>) are supported.</p>
    <fig id="bty197-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Phenotype simulation scheme. <italic>PhenotypeSimulator</italic> takes genotypes from a number of different input formats and uses these as the basis for the simulation of the genetic effects. In addition to the genetic effects, non-genetic covariates, observational noise and non-genetic correlation structure can be simulated. The effect structure of the upper four components can be divided into a shared effect across traits or an independent effect for a number of traits, allowing for complex phenotype structures such as the simulation of pleiotropy. Before combining the phenotype components, they are scaled to a user-defined proportion of the total phenotypic variance. Finally, the simulated phenotype and its components can be saved into a number of different genetic output formats. Arrows, lines and rectangles mark the dimensions of each component</p>
      </caption>
      <graphic xlink:href="bty197f1"/>
    </fig>
    <p>These genotypes form the basis for the simulation of the genetic components of the phenotypes: genetic variants that are associated with the phenotype and infinitesimal genetic effects simulating underlying population structure and relatedness in a cohort. In addition, <italic>PhenotypeSimulator</italic> offers the simulation of other non-genetic components, which reflect environmental, experimental or other unexplained variance in the data. Although in many genetic association studies, the sources of non-genetic correlation are often combined, we have found it valuable to separate these components to explore the impact of different correlation structures from these sources. The environmental components can be simulated as covariates with different distributions mimicking influences such as sex (binary), age (uniform/normal) or country of origin (categorical), correlated non-genetic effects and observational noise. Correlated non-genetic effects can be used to simulate a phenotype component with a defined level of correlation between traits. For instance, such effects can reflect correlation structure decreasing in phenotypes with ordered or spatial components, e.g. in imaging data. Observational noise captures any non-specified effects that arise due to, e.g. experimental measurement error. <italic>PhenotypeSimulator</italic> can also be used with a combined non-genetic covariance model, similar to more standard LMMs (<xref rid="bty197-B22" ref-type="bibr">O’Reilly <italic>et al.</italic>, 2012</xref>; <xref rid="bty197-B24" ref-type="bibr">Porter and O’Reilly, 2017</xref>; <xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>).</p>
    <p>The proportion of variance assigned to each component will differ depending on the biological understanding of the simulated phenotype. <italic>PhenotypeSimulator</italic> allows for the specification of these variance proportions and, in addition, provides the option to divide the explained variance into two components: one that is shared across phenotypes and a second component that acts independently on certain phenotypes. For instance, the level of shared and independent effects for a genetic variant allows for the simulation of different levels of pleiotropy.</p>
    <p>There are many ways to simulate these phenotype components depending on the scope and the model to be tested. Typically, it is assumed that the overall phenotype structure is well represented by an additive linear combination of individual components (<xref rid="bty197-B17" ref-type="bibr">Loh <italic>et al.</italic>, 2014</xref>; <xref rid="bty197-B19" ref-type="bibr">Marigorta and Gibson, 2014</xref>; <xref rid="bty197-B26" ref-type="bibr">Stephens, 2013</xref>; <xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>). <italic>PhenotypeSimulator</italic> assumes this phenotype structure and sums the individual phenotype components to generate the final phenotypes.</p>
    <p>The simulated genotypes and phenotypes can automatically be written into a number of formats for standard genetic association software such as PLINK (<xref rid="bty197-B4" ref-type="bibr">Chang <italic>et al.</italic>, 2015</xref>), BIMBAM (<xref rid="bty197-B8" ref-type="bibr">Guan and Stephens, 2008</xref>), GEMMA (<xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>) or SNPTEST (<xref rid="bty197-B18" ref-type="bibr">Marchini <italic>et al.</italic>, 2007</xref>).</p>
    <p>To demonstrate the usage and application of <italic>Phenotype Simulator</italic>, we simulated a set of phenotypes and used them to evaluate the power of different LMM designs in genome-wide association studies (GWAS). We simulated genotype data for 1000 individuals via a re-sampling-based approach (<xref rid="bty197-B27" ref-type="bibr">Su <italic>et al.</italic>, 2011</xref>), mimicking population structure from four populations in the 1000 Genomes project (<xref rid="bty197-B1" ref-type="bibr">1000 Genomes Project Consortium, 2012</xref>). We generated a phenotype set consisting of 3 traits with 10 genetic variant effects and 4 non-genetic covariates. For 10 genetic variant effects, we randomly selected 10 variants from the genotypes and simulated shared genetic variant effects across all phenotypes. We introduced additional correlation structure by including an infinitesimal genetic effect based on the individuals’ kinship estimates as well as a non-genetic correlated and an observational noise effect (parameters and R code in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, Simulation-and-LinearModel.pdf). <xref ref-type="fig" rid="bty197-F2">Figure 2A</xref> shows the trait-to-trait correlations of the final phenotype and each of its components. The final phenotypes served as the response variable in the GWAS based on LMM with the simulated SNPs and non-genetic covariates as fixed effects and the kinship estimated from the genotypes as part of the genetic random effect (<xref rid="bty197-B30" ref-type="bibr">Zhou and Stephens, 2014</xref>). We analysed the power of jointly modeling all three phenotypes (multivariate LMM) and the power of univariate models where the association of each phenotype is analysed separately (<xref ref-type="fig" rid="bty197-F2">Fig. 2B</xref>). For our simulated phenotypes with shared genetic variant effects only, the multi-trait GWAS shows a greater power compared to any of the single trait analyses. The multi-trait GWAS detected 4 out of 10 SNPs for which a phenotype effect was modelled that pass the commonly used genome-wide significant threshold of 5 × 10<sup>−8</sup> (<xref rid="bty197-B7" ref-type="bibr">Fadista <italic>et al.</italic>, 2016</xref>). The single-trait GWAS only recovered three of these SNPs. The ability of linear (mixed) models to detect the SNPs for which a phenotype effect was modeled depends on the allele frequencies of these SNPs and the effect size (<xref rid="bty197-B5" ref-type="bibr">Cohen, 1992</xref>; <xref rid="bty197-B10" ref-type="bibr">Halsey <italic>et al.</italic>, 2015</xref>): the higher the effect size and/or the allele frequencies the better the power to detect the SNP effects. The <italic>P</italic>-values of all SNPs with simulated effect on the phenotypes in relation to their allele frequencies and simulated effect sizes can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> (Simulation-and-LinearModel.pdf), showing a strong trend for SNPs with high allele frequencies and large simulated effect sizes to have low <italic>P</italic>-values.
</p>
    <fig id="bty197-F2" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>Phenotype simulation and genome-wide association study as a downstream application. (<bold>A</bold>) Heatmaps of the trait-by-trait correlation (Pearson correlation) of a simulated phenotype <bold>Y</bold> and its five phenotype components: genetic variant effects <bold>XB</bold>, infinitesimal genetic effects <bold>U</bold>, non-genetic covariates <bold>WA</bold>, correlated non-genetic effects <bold>T</bold> and observational noise <inline-formula id="IE1"><mml:math id="IM56"><mml:mi mathvariant="bold">Ψ</mml:mi></mml:math></inline-formula>. The non-genetic covariates consist of four independent components, two following a binomial and two following a normal distribution. The genetic variant effect of ten causal SNPs with shared effect across all traits, yielding the strong correlation structure observed above (see Section 2). (<bold>B</bold>) Quantile-quantile plots of <italic>P</italic>-values observed from a multivariate linear mixed model (mvLMM) and univariate linear mixed models (uvLMM) fitted to each of the about eight million genome-wide SNPs (grey), including the ten SNPs for which a phenotype effect was modelled (green). The R code and detailed description of the simulation and analysis are provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> (Simulation-and-LinearModel.pdf)</p>
      </caption>
      <graphic xlink:href="bty197f2"/>
    </fig>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><italic>PhenotypeSimulator</italic> offers a framework for complex multi-trait, multi-locus phenotype simulations in quantitative genetics packaged in an easy to use manner for statistical geneticists. There are a variety of key features of <italic>PhenotypeSimulator</italic> that have both driven its development and usage. First, it is the only simulation package that we know that can simulate complex multi-trait phenotypes with complex multi-locus genetics, including a population structure term with phenotypic correlation. Second, realistic covariate structures can be created with similar properties (e.g. categorical covariates or covariates drawn from different distributions) to real covariates. Third, the different components can be independently extracted and scaled, for example having the ‘true’ variance components and covariance matrices from the simulation readily available for comparison to inference schemes. Finally, we have developed <italic>PhenotypeSimulator</italic> as a flexible component in the standard genetics pipeline, with the ability to both read genetic formats from well used tools and output phenotypes compatible with many tools. This allows easy large-scale deployment for comprehensive simulation across many parameter settings. The underlying model for <italic>PhenotypeSimulator</italic> corresponds to the common place LMM framework. As such, it is limited in its use for benchmarking between methods, where LMMs methods are likely to perform best. However, the need for an underlying model is true for any simulation package. We have extensively documented <italic>PhenotypeSimulator</italic> for ease of use, providing vignettes for sample genotype simulation with the supported genotype simulation tools (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, sample-scripts-external-genotype-simulation.pdf), a user manual for <italic>PhenotypeSimulator</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, UsagePhenotypeSimulator.pdf) and a full application documentation from genotype simulation to GWAS (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, Simulation-and-LinearModel.pdf). Furthermore, the code is present on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/HannahVMeyer/PhenotypeSimulator">https://github.com/HannahVMeyer/PhenotypeSimulator</ext-link>) and we welcome other additions to this tool. For example, although we currently model polygenic and pleiotropic effects, we have not yet modelled epistatic effects and would enthusiastically accept extensions in this area.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty197_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We gratefully acknowledge helpful discussion about phenotype simulation strategies with Francesco Paolo Casale and Valentina Iotchkova. We thank Valentina Iotchkova for her input on the paper draft, the package documentation and design. We thank Konrad Rudolph for his help with the R-package development. We thank the anonymous reviewers for their comprehensive review and testing of the package.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>HVM and EB are funded from EMBL core funds.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="bty197-B1">
      <mixed-citation publication-type="journal"><collab>1000 Genomes Project Consortium</collab> (<year>2012</year>) 
<article-title>An integrated map of genetic variation from 1, 092 human genomes</article-title>. <source>Nature</source>, <volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carvajal-Rodríguez</surname><given-names>A.</given-names></name></person-group> (<year>2008</year>) 
<article-title>GENOMEPOP: a program to simulate genomes in populations</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>223.</fpage><pub-id pub-id-type="pmid">18447924</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Casale</surname><given-names>F.P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Efficient set tests for the genetic analysis of correlated traits</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>755</fpage>–<lpage>758</lpage>.<pub-id pub-id-type="pmid">26076425</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chang</surname><given-names>C.C.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>GigaSci</source>., <volume>4</volume>, <fpage>7.</fpage></mixed-citation>
    </ref>
    <ref id="bty197-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cohen</surname><given-names>J.</given-names></name></person-group> (<year>1992</year>) 
<article-title>A power primer</article-title>. <source>Psychol. Bull</source>., <volume>112</volume>, <fpage>155</fpage>–<lpage>159</lpage>.<pub-id pub-id-type="pmid">19565683</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ewing</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Hermisson</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>) 
<article-title>MSMS: a coalescent simulation program including recombination, demographic structure and selection at a single locus</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2064</fpage>–<lpage>2065</lpage>.<pub-id pub-id-type="pmid">20591904</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fadista</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The (in)famous GWAS P-value threshold revisited and updated for low-frequency variants</article-title>. <source>Eur. J. Hum. Genet</source>., <volume>24</volume>, <fpage>1202</fpage>–<lpage>1205</lpage>.<pub-id pub-id-type="pmid">26733288</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guan</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Practical issues in imputation-based association mapping</article-title>. <source>PLoS Genet</source>., <volume>4</volume>, <fpage>e1000279.</fpage><pub-id pub-id-type="pmid">19057666</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Günther</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>phenosim—a software to simulate phenotypes for testing in genome-wide association studies</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>265.</fpage><pub-id pub-id-type="pmid">21714868</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Halsey</surname><given-names>L.G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>The fickle P value generates irreproducible results</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>179</fpage>–<lpage>185</lpage>.<pub-id pub-id-type="pmid">25719825</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>R.R.</given-names></name></person-group> (<year>2002</year>) 
<article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source>, <volume>18</volume>, <fpage>337</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kelleher</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>. <source>PLOS Comput. Biol</source>., <volume>12</volume>, <fpage>e1004842.</fpage><pub-id pub-id-type="pmid">27145223</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lambert</surname><given-names>B.W.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>ForSim: a tool for exploring the genetic architecture of complex traits with controlled truth</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1821</fpage>–<lpage>1822</lpage>.<pub-id pub-id-type="pmid">18565989</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>SimRare: a program to generate and analyze sequence-based data for association studies of quantitative and qualitative traits</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2703</fpage>–<lpage>2704</lpage>.<pub-id pub-id-type="pmid">22914216</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liang</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>GENOME: a rapid coalescent-based whole genome simulator</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>1565</fpage>–<lpage>1567</lpage>.<pub-id pub-id-type="pmid">17459963</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lippert</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>The benefits of selecting phenotype-specific variants for applications of mixed models in genomics</article-title>. <source>Sci. Rep</source>., <volume>3</volume>, <fpage>1815.</fpage><pub-id pub-id-type="pmid">23657357</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Loh</surname><given-names>P-r.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Efficient Bayesian mixed model analysis increases association power in large cohorts</article-title>. <source>Nat. Genet</source>., <volume>47</volume>, <fpage>1</fpage>–<lpage>79</lpage>.</mixed-citation>
    </ref>
    <ref id="bty197-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marchini</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>A new multipoint method for genome-wide association studies by imputation of genotypes</article-title>. <source>Nat. Genet</source>., <volume>39</volume>, <fpage>906</fpage>–<lpage>913</lpage>.<pub-id pub-id-type="pmid">17572673</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marigorta</surname><given-names>U.M.</given-names></name>, <name name-style="western"><surname>Gibson</surname><given-names>G.</given-names></name></person-group> (<year>2014</year>) 
<article-title>A simulation study of gene-by-environment interactions in GWAS implies ample hidden effects</article-title>. <source>Front. Genet</source>., <volume>5</volume>, <fpage>225.</fpage><pub-id pub-id-type="pmid">25101110</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Neuenschwander</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>quantiNemo: an individual-based program to simulate quantitative traits with explicit genetic architecture in a dynamic metapopulation</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1552</fpage>–<lpage>1553</lpage>.<pub-id pub-id-type="pmid">18450810</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oliveira</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Seijas-Macias</surname><given-names>A.</given-names></name></person-group> (<year>2012</year>) 
<article-title>An approach to distribution of the product of two normal variables</article-title>. <source>Discuss. Math</source>., <volume>32</volume>, <fpage>87</fpage>.</mixed-citation>
    </ref>
    <ref id="bty197-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>O’Reilly</surname><given-names>P.F.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>MultiPhen: joint model of multiple phenotypes can increase discovery in GWAS</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e34861</fpage>.<pub-id pub-id-type="pmid">22567092</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peng</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Kimmel</surname><given-names>M.</given-names></name></person-group> (<year>2005</year>) 
<article-title>simuPOP: a forward-time population genetics simulation environment</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3686</fpage>–<lpage>3687</lpage>.<pub-id pub-id-type="pmid">16020469</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Porter</surname><given-names>H.F.</given-names></name>, <name name-style="western"><surname>O’Reilly</surname><given-names>P.F.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Multivariate simulation framework reveals performance of multi-trait GWAS methods</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>38837.</fpage><pub-id pub-id-type="pmid">28287610</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>W.T.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Relationships among some univariate distributions</article-title>. <source>IIE Trans</source>., <volume>37</volume>, <fpage>651</fpage>–<lpage>656</lpage>.</mixed-citation>
    </ref>
    <ref id="bty197-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>) 
<article-title>A unified framework for association analysis with multiple related phenotypes</article-title>. <source>PloS One</source>, <volume>8</volume>, <fpage>e65245.</fpage><pub-id pub-id-type="pmid">23861737</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Su</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>HAPGEN2: simulation of multiple disease SNPs</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2304</fpage>–<lpage>2305</lpage>.<pub-id pub-id-type="pmid">21653516</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wright</surname><given-names>F.A.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Simulating association studies: a data-based resampling method for candidate regions or whole genome scans</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>2581</fpage>–<lpage>2588</lpage>.<pub-id pub-id-type="pmid">17785348</pub-id></mixed-citation>
    </ref>
    <ref id="bty197-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhbannikov</surname><given-names>I.Y.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>cophesim: a comprehensive phenotype simulator for testing novel association methods [version 1; referees: 2 approved]</article-title>. <source>F1000 Res</source>., <volume>6</volume>, <fpage>1294.</fpage></mixed-citation>
    </ref>
    <ref id="bty197-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Efficient multivariate linear mixed model algorithms for genome-wide association studies</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>407</fpage>–<lpage>409</lpage>.<pub-id pub-id-type="pmid">24531419</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
