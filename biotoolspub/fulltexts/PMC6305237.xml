<?properties open_access?>
<?subarticle report40128?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6305237</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.16680.1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ranacapa: An R package and Shiny web app to explore environmental DNA data with exploratory statistics and interactive visualizations</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 1; referees: 1 approved</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kandlikar</surname>
          <given-names>Gaurav S.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3043-6780</contrib-id>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gold</surname>
          <given-names>Zachary J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cowen</surname>
          <given-names>Madeline C.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meyer</surname>
          <given-names>Rachel S.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Freise</surname>
          <given-names>Amanda C.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kraft</surname>
          <given-names>Nathan J.B.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moberg-Parker</surname>
          <given-names>Jordan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1445-9587</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sprague</surname>
          <given-names>Joshua</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kushner</surname>
          <given-names>David J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Curd</surname>
          <given-names>Emily E.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Ecology and Evolutionary Biology, University of California, Los Angeles, Los Angeles, CA, 90095, USA</aff>
      <aff id="a2"><label>2</label>Department of Microbiology and Microbial Genetics, University of California, Los Angeles, Los Angeles, CA, 90095, USA</aff>
      <aff id="a3"><label>3</label>Channel Islands National Park, National Park Service, Ventura, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:gkandlikar@ucla.edu">gkandlikar@ucla.edu</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>1734</elocation-id>
    <history>
      <date date-type="accepted">
        <day>23</day>
        <month>10</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2018 Kandlikar GS et al.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-7-18233.pdf"/>
    <abstract>
      <p>Environmental DNA (eDNA) metabarcoding is becoming a core tool in ecology and conservation biology, and is being used in a growing number of education, biodiversity monitoring, and public outreach programs in which professional research scientists engage community partners in primary research. Results from eDNA analyses can engage and educate natural resource managers, students, community scientists, and naturalists, but without significant training in bioinformatics, it can be difficult for this diverse audience to interact with eDNA results. Here we present the R package ranacapa, at the core of which is a Shiny web app that helps perform exploratory biodiversity analyses and visualizations of eDNA results. The app requires a taxonomy-by-sample matrix and a simple metadata file with descriptive information about each sample. The app enables users to explore the data with interactive figures and presents results from simple community ecology analyses. We demonstrate the value of ranacapa to two groups of community partners engaging with eDNA metabarcoding results.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>environmental DNA</kwd>
      <kwd>data visualization</kwd>
      <kwd>citizen science</kwd>
      <kwd>community science</kwd>
      <kwd>shiny</kwd>
      <kwd>metabarcoding</kwd>
      <kwd>education</kwd>
      <kwd>community ecology</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>National Science Foundation</funding-source>
        <award-id>DEGNo.1650604</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>University of California President’s Research Catalyst Awards</funding-source>
        <award-id>CA-16-376437</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>National Science Foundation</funding-source>
        <award-id>DEB-1644641</award-id>
      </award-group>
      <funding-statement>GSK and ZJG were supported by the US-NSF Graduate Research Fellowship [DEG No. 1650604]. NJBK was supported the National Science Foundation [DEB-1644641]. EEC, RSM, and the CALeDNA program are supported by the University of California President’s Research Catalyst Award [CA-16-376437].</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The targeted amplification and sequencing of DNA that living organisms shed into their physical environment, termed “environmental DNA (eDNA) metabarcoding,” is revolutionizing microbiology, ecology, and conservation research (
<xref rid="ref-8" ref-type="bibr">Deiner
<italic>et al</italic>., 2017</xref>;
<xref rid="ref-26" ref-type="bibr">Taberlet
<italic>et al.</italic> 2012</xref>). Sequencing of eDNA extracted from field-collected soil, water, or sediment samples can yield insight into a range of questions, from profiling the composition of ancient plant and animal communities (
<xref rid="ref-24" ref-type="bibr">Pedersen
<italic>et al</italic>., 2015</xref>), to monitoring populations of rare or endangered species (
<xref rid="ref-1" ref-type="bibr">Balasingham
<italic>et al</italic>., 2018</xref>). As the cost of eDNA metabarcoding declines and sample collection techniques become more streamlined (e.g.
<xref rid="ref-27" ref-type="bibr">Thomas
<italic>et al</italic>. (2018)</xref>), professional research scientists are increasingly using eDNA metabarcoding as a platform to engage a diversity of community partners, including natural resource managers, undergraduate students, and citizen scientists in primary research. However, developing robust and impactful community science programs that engage community partners in all steps of the research process remains a challenge.</p>
    <p>eDNA metabarcoding-based projects work well for programs that partner researchers with community scientists because non-experts can be quickly trained to collect samples in the field, and because eDNA metabarcoding is an exciting framework for research pertinent to disciplines such as medicine, agriculture, ecology, and geography (
<xref rid="ref-8" ref-type="bibr">Deiner
<italic>et al</italic>., 2017</xref>). Community partners in such programs can have heterogeneous backgrounds, ranging from curious members of the public for whom collecting samples in the field is their first scientific research experience (e.g.
<ext-link ext-link-type="uri" xlink:href="http://www.ucedna.com/">University of California’s CALeDNA program</ext-link>), to professional natural resource managers who regularly collaborate with research scientists (e.g.
<ext-link ext-link-type="uri" xlink:href="https://oceansolutions.stanford.edu/project-environmental-dna">Center for Ocean Solutions’ eDNA project</ext-link>). A key ingredient to promote sustained success of such programs is that community partners should be able to engage across multiple stages of the research project, not only in sample collection (
<xref rid="ref-9" ref-type="bibr">European Citizen Science Association, 2015</xref>;
<xref rid="ref-22" ref-type="bibr">Pandya, 2012</xref>). This can be a challenge for community science programs because although it is relatively easy to train community partners to collect eDNA samples, it is far more challenging to train them to independently visualize and analyze results from these studies. Indeed, learning the bioinformatic tools necessary for managing the large, multidimensional datasets generated in these studies can be difficult for professional researchers (
<xref rid="ref-5" ref-type="bibr">Carey &amp; Papin, 2018</xref>), let alone for the non-technical audience of some community science programs.</p>
    <p>To address this challenge, we created the R package “
<monospace><italic>ranacapa</italic></monospace>”, at the core of which is a Shiny web app that can be used to visualize results from eDNA sequencing studies and perform simple community ecology analyses.
<monospace><italic>ranacapa</italic></monospace> complements existing visualization platforms (e.g. Phinch (
<xref rid="ref-50" ref-type="bibr">Bik &amp; Phinch Interactive, 2014</xref>), Phyloseq-Shiny (
<xref rid="ref-52" ref-type="bibr">McMurdie &amp; Holmes, 2015</xref>),
<ext-link ext-link-type="uri" xlink:href="https://view.qiime2.org/">QIIME2 Viewer</ext-link>), because in addition to interactive visualizations,
<monospace><italic>ranacapa</italic></monospace> includes brief explanations of several core analyses used in eDNA studies and includes links to additional educational resources.
<monospace><italic>ranacapa</italic></monospace> works with community matrices generated via QIIME (
<xref rid="ref-3" ref-type="bibr">Caporaso
<italic>et al</italic>., 2010</xref>) or the
<ext-link ext-link-type="uri" xlink:href="https://github.com/limey-bean/Anacapa">Anacapa</ext-link> sequence analysis pipeline, the latter being used extensively by the CALeDNA program.</p>
    <p>Here, we describe the package and how it is used by two community science partnerships based at the University of California, Los Angeles (UCLA): first, a collaboration between eDNA researchers and resource managers at the National Park Service, and second, a partnership between community ecology researchers and an undergraduate microbiology course at UCLA. As we show in the Use cases, empowering community partners to interact with the data and perform simple but insightful community ecology analyses can help make these collaborations more enriching and valuable to both parties.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>At the core of
<monospace><italic>ranacapa</italic></monospace> is a Shiny web app (
<xref rid="ref-7" ref-type="bibr">Chang
<italic>et al</italic>., 2018</xref>), which is available at
<ext-link ext-link-type="uri" xlink:href="http://gauravsk.shinyapps.io/ranacapa">http://gauravsk.shinyapps.io/ranacapa</ext-link> or with
<monospace><italic>ranacapa::runRanacapa()</italic></monospace>. The package also includes two categories of helper functions (
<xref rid="T1" ref-type="table">Table 1</xref>) that transform user-uploaded taxonomy and metadata tables into
<monospace><italic>R</italic></monospace> objects that can be visualized and analyzed using the Phyloseq (
<xref rid="ref-18" ref-type="bibr">McMurdie &amp; Holmes, 2013</xref>) and Vegan (
<xref rid="ref-21" ref-type="bibr">Oksanen
<italic>et al</italic>., 2018</xref>) packages.
<monospace><italic>ranacapa</italic></monospace> is available for installation from
<ext-link ext-link-type="uri" xlink:href="https://github.com/gauravsk/ranacapa">Github</ext-link> or CRAN:</p>
    <p>
      <preformat>
        <styled-content style="font-size:15px;color:#00000A; font-style:italic">devtools</styled-content>
        <styled-content style="font-size:15px;color:#CE5C00; font-style:italic">::</styled-content>
        <styled-content style="font-size:15px;color:#204A87; font-style:italic">install_github</styled-content>
        <styled-content style="font-size:15px;color:#00000A; font-style:italic">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06; font-style:italic">"gauravsk/ranacapa"</styled-content>
        <styled-content style="font-size:15px;color:#00000A; font-style:italic">)</styled-content>
        <styled-content style="font-size:15px;color:#204A87; font-style:italic">install.packages</styled-content>
        <styled-content style="font-size:15px;color:#00000A; font-style:italic">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06; font-style:italic">"ranacapa"</styled-content>
        <styled-content style="font-size:15px;color:#00000A; font-style:italic">)</styled-content>
      </preformat>
    </p>
    <table-wrap id="T1" orientation="portrait" position="anchor">
      <label>Table 1. </label>
      <caption>
        <title>Functions included within the ranacapa package.</title>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Name</th>
            <th align="left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">scrub_seqNum_column</td>
            <td align="left" rowspan="1" colspan="1">Removes any "xxx_seq_number" columns from the input taxonomy file if present
<break/>(depends on which version of Anacapa was used to assign taxonomy)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">scrub_taxon_paths</td>
            <td align="left" rowspan="1" colspan="1">Replaces empty cells in input taxonomy tables with “Unknown”</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">validate_input_files</td>
            <td align="left" rowspan="1" colspan="1">Verifies that the input taxonomy file and input mapping file meet specifications</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">convert_biom_to_taxon_table</td>
            <td align="left" rowspan="1" colspan="1">Converts a phyloseq-imported biom table into an Anacapa-formatted taxonomy
<break/>table</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">group_anacapa_by_taxonomy</td>
            <td align="left" rowspan="1" colspan="1">Summarizes a site-abundance table from the Anacapa pipeline to each unique
<break/>taxon</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">categorize_continuous_vector</td>
            <td align="left" rowspan="1" colspan="1">Categorizes a continuous vector into low, medium, and high</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">convert_anacapa_to_phyloseq</td>
            <td align="left" rowspan="1" colspan="1">Converts a site-abundance table from the Anacapa pipeline and the associated
<break/>metadata file into a phyloseq object</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">vegan_otu</td>
            <td align="left" rowspan="1" colspan="1">Creates a community matrix in the vegan package style using a phyloseq object
<break/>and an otu_table object</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">custom_rarefaction</td>
            <td align="left" rowspan="1" colspan="1">Rarefies a phyloseq object to a custom sample depth and with a given number of
<break/>replicates</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">pairwise_adonis
<sup><xref ref-type="other" rid="FN1">1</xref></sup>
</td>
            <td align="left" rowspan="1" colspan="1">Wrapper function for multilevel pairwise comparison</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">ggrare
<sup><xref ref-type="other" rid="FN2">2</xref></sup>
</td>
            <td align="left" rowspan="1" colspan="1">Makes a rarefaction curve using ggplot2</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">runRanacapaApp</td>
            <td align="left" rowspan="1" colspan="1">Runs the ranacapa Shiny app with tabs for interactive visualizations and statistical
<break/>analyses</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn>
          <p id="FN1"><sup>1</sup> adopted from
<ext-link ext-link-type="uri" xlink:href="https://github.com/pmartinezarbizu/pairwiseAdonis">https://github.com/pmartinezarbizu/pairwiseAdonis</ext-link> (GPL-3 License)</p>
        </fn>
        <fn>
          <p id="FN2"><sup>2 </sup>adopted from
<ext-link ext-link-type="uri" xlink:href="https://github.com/mahendra-mariadassou/phyloseq-extended">https://github.com/mahendra-mariadassou/phyloseq-extended</ext-link> (GPL-3 License)</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>The
<monospace><italic>ranacapa</italic></monospace> Shiny app allows users to interact with eDNA results through statistical summaries and interactive plots, displayed in the following tabs:</p>
    <p><bold>•   Sequencing depth</bold>: Introduces the potential for variation in sequencing depth among samples and explains the basic logic behind rarefying samples in metagenomics studies (
<xref ref-type="fig" rid="f1">Figure 1</xref>). Users can rarefy the dataset to a sampling depth, or can proceed through the rest of the app without rarefying samples. The documentation acknowledges recent disagreement regarding the value of rarefying in metabarcoding and eDNA sequencing studies (
<xref rid="ref-19" ref-type="bibr">McMurdie &amp; Holmes, 2014</xref>).</p>
    <fig fig-type="figure" id="f1" orientation="portrait" position="float">
      <label>Figure 1. </label>
      <caption>
        <title>Taxon accumulation curve as shown in the ranacapa Shiny app.</title>
        <p> The online version of this figure is interactive.</p>
      </caption>
      <graphic xlink:href="f1000research-7-18233-g0000"/>
    </fig>
    <p><bold>•   Taxonomy heatmap</bold>: Shows the taxon-by-sample matrix as an interactive heatmap made using
<monospace><italic>heatmaply::heatmaply()</italic></monospace> (
<xref rid="ref-10" ref-type="bibr">Galili
<italic>et al</italic>., 2018</xref>), where the color of each cell represents the number of times a given taxon was sequenced in a sample (
<xref ref-type="fig" rid="f2">Figure 2</xref>). Users can filter the taxon list by selecting or deselecting specific taxa.</p>
    <fig fig-type="figure" id="f2" orientation="portrait" position="float">
      <label>Figure 2. </label>
      <caption>
        <title>Taxonomy heatmap as shown in the
<monospace>ranacapa</monospace> Shiny app.</title>
        <p>Taxonomy is shown at the Order level in this figure; in the app, users can choose the taxonomic level to show in the heatmap. Users can also select or deselect individual taxa to be shown in the heatmap. The online version of this figure is interactive.</p>
      </caption>
      <graphic xlink:href="f1000research-7-18233-g0001"/>
    </fig>
    <p><bold>•   Taxonomy barplot</bold>: Shows the taxonomy-by-sample matrix as an interactive barplot (
<xref ref-type="fig" rid="f3">Figure 3</xref>).</p>
    <fig fig-type="figure" id="f3" orientation="portrait" position="float">
      <label>Figure 3. </label>
      <caption>
        <title>Taxonomy barplot as shown in the
<monospace>ranacapa</monospace> Shiny app.</title>
        <p>Taxonomy is shown at the Order level in this figure; in the app, users can choose the taxonomic level to show in the barplot. The online version of this figure is interactive.</p>
      </caption>
      <graphic xlink:href="f1000research-7-18233-g0002"/>
    </fig>
    <p><bold>•   Alpha diversity plots</bold>: Introduces the concept of alpha diversity as the local diversity measured in a single habitat or sample. Users can plot alpha diversity as observed taxon richness or as Shannon diversity per sample, or can group samples according to a variable in the metadata file (
<xref ref-type="fig" rid="f4">Figure 4</xref>).</p>
    <fig fig-type="figure" id="f4" orientation="portrait" position="float">
      <label>Figure 4. </label>
      <caption>
        <title>Alpha diversity boxplots as shown in the
<monospace>ranacapa</monospace> Shiny app.</title>
        <p>Users can select the X-axis variable using a dropdown menu in the app. The online version of this figure is interactive.</p>
      </caption>
      <graphic xlink:href="f1000research-7-18233-g0003"/>
    </fig>
    <p><bold>•   Alpha diversity statistics</bold>: Allows users to choose a variable from the metadata, and generates an alpha diversity ANOVA table according to the user-selected variable. The tab also shows the output from a post-hoc Tukey test.</p>
    <p><bold>•   Beta diversity plots</bold>: Introduces the concept of beta diversity as the turnover in species composition across habitats (or samples). The tab includes an ordination plot generated by
<monospace><italic>phyloseq::plot_ordination()</italic></monospace>, which in turn uses an ordination object made with
<monospace><italic>phyloseq::ordinate(., method = "PCoA")</italic></monospace>. Points on the PCoA plot are colored according to a user-selected metadata variable (
<xref ref-type="fig" rid="f5">Figure 5</xref>).</p>
    <fig fig-type="figure" id="f5" orientation="portrait" position="float">
      <label>Figure 5. </label>
      <caption>
        <title>PCoA ordination of the samples as shown in the
<monospace>ranacapa</monospace> Shiny app.</title>
        <p>Users can select the grouping variable with a dropdown menu in the app. The online version of this figure is interactive.</p>
      </caption>
      <graphic xlink:href="f1000research-7-18233-g0004"/>
    </fig>
    <p>    The beta diversity plots tab also includes a dendrogram that groups sites based on Ward’s cluster analysis (
<monospace><italic>stats::hclust(distance_object, method = "ward.d2")</italic></monospace>), where
<monospace><italic>distance_object</italic></monospace> is made using
<monospace><italic>phyloseq::distance()</italic></monospace>. For both figures, users can toggle between using Jaccard and Bray-Curtis dissimilarity. </p>
    <p><bold>•   Beta diversity statistics</bold>: Shows results from two statistical tests of species turnover across sites. The first test is a multivariate ANOVA of taxon turnover across sites, implemented with
<monospace><italic>vegan::adonis()</italic></monospace>. The second statistical test, which is implemented with
<monospace><italic>vegan::betadisper()</italic></monospace>, is of heterogeneity of variances among samples. This test compares the degree of sample-to-sample variation within habitats (or within other user-selected groups).</p>
  </sec>
  <sec>
    <title>Operation</title>
    <p><monospace><italic>ranacapa</italic></monospace> depends on
<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/">Bioconductor</ext-link> v 3.7, which in turn relies on
<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">R</ext-link> v 3.5.0. The Shiny app has been tested on Chrome and Firefox on Windows, Mac-OSX, and Ubuntu.</p>
    <sec>
      <title>Input file structure</title>
      <p>The
<monospace><italic>ranacapa</italic></monospace> Shiny app requires two input files. The first requirement is a taxon-by-sample matrix, uploaded either as a rich, dense
<monospace><italic>.biom</italic></monospace> table, or as a tab-separated
<monospace><italic>.txt</italic></monospace> file. Qiime2-generated
<monospace><italic>.qza</italic></monospace> files generated by QIIME2 are not immediately suitable for ranacapa, as they do not contain full taxonomy information. If the site-by-species matrix is uploaded as a
<monospace><italic>.txt</italic></monospace> file, the file should match the specifications of the output files from the
<ext-link ext-link-type="uri" xlink:href="https://github.com/limey-bean/Anacapa">Anacapa eDNA sequence analysis pipeline</ext-link>. In Anacapa output, each row represents a taxonomic identification, and each column (save one) represents the number of times that taxon appears in each sequenced sample. One column, named
<monospace><italic>sum.taxonomy</italic></monospace> must contain the taxonomic identification, with taxonomic rank separated by a semicolon, e.g. “
<monospace><italic>Chordata;Actinopteri;Chaetodontiformes;Chaetodontidae;Chaetodon;Chaetodon reticulatus</italic></monospace> .” A valid input file is structured as follows:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#00000A; font-style:italic">sum.taxonomy	Arch_point_1 	Arch_point_2 	Black_seabass_reef_1 Black_seabass_reef_2
&lt;full path&gt;	0		0               0                    0	
&lt;full path&gt;	0		0               43                   87
&lt;full path&gt;	0		0		0		     0
&lt;full path&gt;     0               0               0          	     0
&lt;full path&gt;	24		36              30          	     16
&lt;full path&gt; 	0		0               0                    0
&lt;full path&gt;	0		0               0                    0	
&lt;full path&gt; 	0		0               16                   177
&lt;full path&gt;	0		0               0                    0
&lt;full path&gt;     0		0               0           	     0
</styled-content>
        </preformat>
      </p>
      <p>The second requirement is a tab-separated
<monospace><italic>.txt</italic></monospace> file that contains sample metadata. The first column in the metadata file should match the sample names in the taxonomy table; the remaining columns contain sample information for each of the samples in the taxon-by-site matrix. The metadata should contain categorical variables with two or more categories per variable. A valid metadata file for the taxonomy table above is structured as follows:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#00000A; font-style:italic">Sample 	        	Sample_or_Control  Island	    Protection	  Locality
Black_seabass_reef_1	Sample		   Anacapa          MPA		  Black_seabass_reef
Arch_point_1            Sample 		   Santa Barbara    non-MPA	  Arch_point
Arch_point_2            Sample 		   Santa Barbara    non-MPA	  Arch_point
Black_seabass_reef_2	Sample		   Anacapa          MPA		  Black_seabass_reef</styled-content>
        </preformat>
      </p>
      <p>The
<monospace><italic>ranacapa</italic></monospace> function
<monospace><italic>validate_input_files()</italic></monospace> verifies that both the taxonomy table and the metadata files match structural requirements, which are documented in the function help files.</p>
    </sec>
  </sec>
  <sec>
    <title>Use cases</title>
    <p>We expect that researchers with expertise in bioinformatics will use the sequence analysis pipeline of their choice to assign taxonomy to eDNA datasets, and generate clean taxonomy and metadata files that can be visualized in
<monospace><italic>ranacapa</italic></monospace>. Researchers can share these files with their partners, and emphasize the analyses or visualizations most appropriate to their use case. We now show how
<monospace><italic>ranacapa</italic></monospace> can facilitate authentic communication between researchers and community partners in two settings.</p>
    <sec>
      <title>Use case 1: Partnership between eDNA researchers and natural resource managers</title>
      <p>A team of UCLA researchers partnered with resource managers at the Channel Islands National Park Service to assess the potential for eDNA as a biodiversity monitoring tool to supplement time-intensive visual biodiversity surveys in the Southern California Channel Islands (
<xref rid="ref-8" ref-type="bibr">Deiner
<italic>et al</italic>., 2017</xref>;
<xref rid="ref-17" ref-type="bibr">Lessios, 1996</xref>;
<xref rid="ref-28" ref-type="bibr">Usseglio, 2015</xref>). For this partnership, resource managers collected and filtered 30 unique one-liter water samples for eDNA analysis at permanent monitoring sites inside and adjacent to protected areas, and research scientists at UCLA performed eDNA sequencing of the mitochondrial 12S (
<xref rid="ref-20" ref-type="bibr">Miya
<italic>et al</italic>., 2015</xref>) and CO1 (
<xref rid="ref-16" ref-type="bibr">Leray
<italic>et al</italic>., 2013</xref>) genes, targeting bony fishes, elasmobranches, and invertebrate taxa. The researchers processed sequences and assigned taxonomy using the Anacapa pipeline, and shared results with the resource managers using the
<monospace><italic>ranacapa</italic></monospace> Shiny app.</p>
      <p>The taxonomy heatmap of species detected using the 12S and CO1 metabarcodes (
<xref ref-type="fig" rid="f2">Figure 2</xref>) was the most valuable visualization to this collaboration, because it allowed the resource managers to filter the large observed species list down to a particular set of key taxa that they regularly monitor. The heatmap showed that this pilot study detected 36 of the 70 key metazoans at the species level, and the remaining 34 at the genus, family, or order level. This indicates that eDNA-based studies can provide critical information for ongoing management efforts and provide new insights into the spatial and temporal distributions of these species. The value of
<monospace><italic>ranacapa</italic></monospace> in this scenario was to quickly sort through long species lists generated by eDNA sequencing to highlight the strengths and weaknesses in using eDNA to monitor diversity in the Channel Islands. The data from this study are packaged as the demo dataset for the
<monospace><italic>ranacapa</italic></monospace> Shiny app and are available online (
<xref rid="ref-13" ref-type="bibr">Kandlikar
<italic>et al</italic>., 2018a</xref>).</p>
    </sec>
    <sec>
      <title>Use case 2: Partnership between eDNA researchers and an undergraduate microbiology course</title>
      <p>A team of community ecology and environmental DNA researchers in the CALeDNA program collaborated with instructors of a research-based environmental microbiology course at UCLA (
<xref rid="ref-25" ref-type="bibr">Shapiro
<italic>et al</italic>., 2015</xref>), in which students used eDNA metabarcoding to study the impact of a local wildfire on the plant and soil microbial community. The goal of this twenty-week course was to provide undergraduate students an authentic experience in basic microbiology and microbial community ecology research. Over the first ten weeks, eDNA researchers on the instructional team sequenced the ITS2 (
<xref rid="ref-11" ref-type="bibr">Gu
<italic>et al</italic>., 2013</xref>) and 16S SSU RNA (
<xref rid="ref-4" ref-type="bibr">Caporaso
<italic>et al</italic>., 2012</xref>) metabarcoding regions from student-collected soil samples and used the Anacapa pipeline to generate taxon-by-sample tables.</p>
      <p>The course instructors used the
<monospace><italic>ranacapa</italic></monospace> Shiny app to introduce students to the structure of eDNA sequencing results. The students were encouraged to explore data and perform the statistical analyses most pertinent to the hypotheses they had formed at the beginning of the course. A key benefit of using
<monospace><italic>ranacapa</italic></monospace> was that despite having no prior bioinformatics experience, students could begin exploring the biodiversity in their samples in a matter of minutes by using the online instance of the Shiny app. This allowed the instructors to focus classroom time on biological questions rather than on troubleshooting bioinformatics problems, as had been the case in previous sessions of the course. The course instructors noted that visualizing eDNA data in
<monospace><italic>ranacapa</italic></monospace> helped students understand the relationships between taxon-by-site matrices and the various metadata they had collected in the field. By significantly reducing the time and difficulty in visualizing basic biodiversity patterns,
<monospace><italic>ranacapa</italic></monospace> helped students develop and pursue more sophisticated analyses during the remainder of the course, using tools such as STAMP (
<xref rid="ref-23" ref-type="bibr">Parks
<italic>et al</italic>., 2014</xref>) and PICRUSt (
<xref rid="ref-15" ref-type="bibr">Langille
<italic>et al</italic>., 2013</xref>). The taxonomy tables and metadata files used in this course are available online (
<xref rid="ref-14" ref-type="bibr">Kandlikar
<italic>et al</italic>., 2018b</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>Summary and future directions</title>
    <p>Metabarcode sequencing of environmental DNA is becoming a key tool in a wide variety of ecological studies, and results from these studies are of interest to a broad audience. Our
<monospace><italic>R</italic></monospace> package and Shiny app
<monospace><italic>ranacapa</italic></monospace> helps users conduct exploratory analyses and visualizations on eDNA datasets, and is a step toward more fully engaging participants in all phases of eDNA sequencing-based community science projects.</p>
    <p>We propose three avenues for future work with ranacapa. First, we plan to use
<monospace><italic>ranacapa</italic></monospace> as the primary tool to present eDNA results from hundreds of samples sequenced by the CALeDNA community science program. Second,
<monospace><italic>ranacapa</italic></monospace> is being integrated into the upcoming undergraduate curriculum module “Pipeline for Undergraduate Microbiome Analysis”, which will be an open-source, comprehensive suite of analysis and data visualization tools for undergraduate researchers. Finally, in the long-term, we believe there is great promise in linking
<monospace><italic>ranacapa</italic></monospace> with packages that connect with APIs of online biodiversity databases (e.g. Taxize (
<xref rid="ref-6" ref-type="bibr">Chamberlain &amp; Szöcs, 2013</xref>), rinat (
<xref rid="ref-2" ref-type="bibr">Barve &amp; Hart, 2017</xref>)). This will help users explore a much wider range of biodiversity questions, for example, by programmatically asking whether their samples include invasive species that are absent from other nearby sites. In sum, tools like
<monospace><italic>ranacapa</italic></monospace> that allow non-technical audiences to easily interact with results from eDNA sequencing studies have great potential to engage community partners with a wide range of backgrounds and interests in primary research.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>•   A Shiny app, including a dataset generated for demonstrations, is available at
<ext-link ext-link-type="uri" xlink:href="https://gauravsk.shinyapps.io/ranacapa">https://gauravsk.shinyapps.io/ranacapa</ext-link>
</p>
    <p>•   
<monospace>Source code is available from GitHub:</monospace>
<ext-link ext-link-type="uri" xlink:href="https://github.com/gauravsk/ranacapa">https://github.com/gauravsk/ranacapa</ext-link>
</p>
    <p>•   Archived source code at time of publication:
<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.5281/zenodo.1464285">http://dx.doi.org/10.5281/zenodo.1464285</ext-link> (
<xref rid="ref-12" ref-type="bibr">Kandlikar &amp; Cowen, 2018</xref>)</p>
    <p>•   Software license (GPL-3)</p>
  </sec>
  <sec>
    <title>Data availability</title>
    <p>Datasets used for the Use cases are available from Figshare:</p>
    <p>Dataset 1: Taxon table and metadata file for Channel Islands eDNA samples (mitochondrial 12S and CO1 metabarcodes sequenced)
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7199477.v1">https://doi.org/10.6084/m9.figshare.7199477.v1</ext-link> (
<xref rid="ref-13" ref-type="bibr">Kandlikar
<italic>et al</italic>., 2018a</xref>)</p>
    <p>Dataset 2: Taxon table and metadata file for Santa Monica Mountains eDNA samples (16S and plant-ITS metabarcodes sequenced)
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7199510.v1">https://doi.org/10.6084/m9.figshare.7199510.v1</ext-link> (
<xref rid="ref-14" ref-type="bibr">Kandlikar
<italic>et al</italic>., 2018b</xref>)</p>
    <p>Both datasets are available under a CC-BY 4.0 license</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Sabrina Shirazi, Rachel Turba, Chris Dao, and Keith Mitchell for providing feedback on developmental versions of this package. We also thank Mahendra Mariadassau and Pedro Martinez Arbizu for making the
<monospace><italic>phyloseq-extended</italic></monospace> and
<monospace><italic>pairwiseAdonis</italic></monospace> packages openly available with a GPL-3 License.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balasingham</surname><given-names>KD</given-names></name><name><surname>Walter</surname><given-names>RP</given-names></name><name><surname>Mandrak</surname><given-names>NE</given-names></name><etal/></person-group>:
<article-title>Environmental DNA detection of rare and invasive fish species in two Great Lakes tributaries.</article-title><source><italic>Mol Ecol.</italic></source><year>2018</year>;<volume>27</volume>(<issue>1</issue>):<fpage>112</fpage>–<lpage>127</lpage>.
<pub-id pub-id-type="doi">10.1111/mec.14395</pub-id><?supplied-pmid 29087006?><pub-id pub-id-type="pmid">29087006</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barve</surname><given-names>V</given-names></name><name><surname>Hart</surname><given-names>E</given-names></name></person-group>:
<article-title>Rinat: Access iNaturalist data through apis</article-title>.<year>2017</year><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/rinat/rinat.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-50">
      <mixed-citation publication-type="journal">
        <collab>Bik, Phinch Interactive: </collab>
        <article-title>Phinch: An interactive, exploratory data visualization framework for –Omic datasets.</article-title>
        <source>
          <italic>bioRXiv.</italic>
        </source>
        <year>2014</year>
        <pub-id pub-id-type="doi">10.1101/009944</pub-id>
      </mixed-citation>
    </ref>
    <ref id="ref-3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Kuczynski</surname><given-names>J</given-names></name><name><surname>Stombaugh</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>QIIME allows analysis of high-throughput community sequencing data.</article-title><source><italic>Nat Methods.</italic></source><year>2010</year>;<volume>7</volume>(<issue>5</issue>):<fpage>335</fpage>–<lpage>336</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id><!--<pub-id pub-id-type="pmcid">3156573</pub-id>--><?supplied-pmid 20383131?><pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Lauber</surname><given-names>CL</given-names></name><name><surname>Walters</surname><given-names>WA</given-names></name><etal/></person-group>:
<article-title>Ultra-high-throughput microbial community analysis on the Illumina HiSeq and MiSeq platforms.</article-title><source><italic>ISME J.</italic></source><year>2012</year>;<volume>6</volume>(<issue>8</issue>):<fpage>1621</fpage>–<lpage>1624</lpage>.
<pub-id pub-id-type="doi">10.1038/ismej.2012.8</pub-id><!--<pub-id pub-id-type="pmcid">3400413</pub-id>--><?supplied-pmid 22402401?><pub-id pub-id-type="pmid">22402401</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carey</surname><given-names>MA</given-names></name><name><surname>Papin</surname><given-names>JA</given-names></name></person-group>:
<article-title>Ten simple rules for biologists learning to program.</article-title><source><italic>PLoS Comput Biol.</italic></source><year>2018</year>;<volume>14</volume>(<issue>1</issue>):<fpage>e1005871</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005871</pub-id><!--<pub-id pub-id-type="pmcid">5754048</pub-id>--><?supplied-pmid 29300745?><pub-id pub-id-type="pmid">29300745</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chamberlain</surname><given-names>SA</given-names></name><name><surname>Szöcs</surname><given-names>E</given-names></name></person-group>:
<article-title>taxize: taxonomic search and retrieval in R [version 1; referees: 3 approved].</article-title><source><italic>F1000Res.</italic></source><year>2013</year>;<volume>2</volume>:<fpage>191</fpage>.
<pub-id pub-id-type="doi">10.12688/f1000research.2-191.v2</pub-id><!--<pub-id pub-id-type="pmcid">3901538</pub-id>--><?supplied-pmid 24555091?><pub-id pub-id-type="pmid">24555091</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>W</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Allaire</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Shiny: Web application framework for r</article-title>.<year>2018</year><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shiny/shiny.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deiner</surname><given-names>K</given-names></name><name><surname>Bik</surname><given-names>HM</given-names></name><name><surname>Mächler</surname><given-names>E</given-names></name><etal/></person-group>:
<article-title>Environmental DNA metabarcoding: Transforming how we survey animal and plant communities.</article-title><source><italic>Mol Ecol.</italic></source><year>2017</year>;<volume>26</volume>(<issue>21</issue>):<fpage>5872</fpage>–<lpage>5895</lpage>.
<pub-id pub-id-type="doi">10.1111/mec.14350</pub-id><?supplied-pmid 28921802?><pub-id pub-id-type="pmid">28921802</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <mixed-citation publication-type="journal"><collab>European Citizen Science Association</collab>:
<article-title>Ten principles of citizen science</article-title>.<year>2015</year><ext-link ext-link-type="uri" xlink:href="https://www.wilsoncenter.org/sites/default/files/ten_principles_of_citizen_science_english.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galili</surname><given-names>T</given-names></name><name><surname>O’Callaghan</surname><given-names>A</given-names></name><name><surname>Sidi</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>heatmaply: an R package for creating interactive cluster heatmaps for online publishing.</article-title><source><italic>Bioinformatics.</italic></source><year>2018</year>;<volume>34</volume>(<issue>9</issue>):<fpage>1600</fpage>–<lpage>1602</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btx657</pub-id><!--<pub-id pub-id-type="pmcid">5925766</pub-id>--><?supplied-pmid 29069305?><pub-id pub-id-type="pmid">29069305</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>W</given-names></name><name><surname>Song</surname><given-names>J</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><etal/></person-group>:
<article-title>Application of the ITS2 Region for Barcoding Medicinal Plants of Selaginellaceae in Pteridophyta.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e67818</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0067818</pub-id><!--<pub-id pub-id-type="pmcid">3694882</pub-id>--><?supplied-pmid 23826345?><pub-id pub-id-type="pmid">23826345</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kandlikar</surname><given-names>G</given-names></name><name><surname>Cowen</surname><given-names>M</given-names></name></person-group>:
<article-title>gauravsk/ranacapa: First release of ranacapa (Version v1.0.0).</article-title><source><italic>Zenodo.</italic></source><year>2018</year><pub-id pub-id-type="doi">10.5281/zenodo.1464285</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kandlikar</surname><given-names>GS</given-names></name><name><surname>Gold</surname><given-names>ZJ</given-names></name><name><surname>Cowen</surname><given-names>MC</given-names></name><etal/></person-group>:
<article-title>Taxon table and metadata file for Channel Islands eDNA samples (mitochondrial 12S and CO1 metabarcodes sequenced).</article-title><source><italic>Figshare.</italic></source><year>2018a</year><pub-id pub-id-type="doi">10.6084/m9.figshare.7199477.v1</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kandlikar</surname><given-names>GS</given-names></name><name><surname>Gold</surname><given-names>ZJ</given-names></name><name><surname>Cowen</surname><given-names>MC</given-names></name><etal/></person-group>:
<article-title>Taxon table and metadata file for Santa Monica Mountains eDNA samples (16S and plant-ITS metabarcodes sequenced).</article-title><source><italic>Figshare.</italic></source><year>2018b</year><pub-id pub-id-type="doi">10.6084/m9.figshare.7199510.v1</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langille</surname><given-names>MG</given-names></name><name><surname>Zaneveld</surname><given-names>J</given-names></name><name><surname>Caporaso</surname><given-names>JG</given-names></name><etal/></person-group>:
<article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2013</year>;<volume>31</volume>(<issue>9</issue>):<fpage>814</fpage>–<lpage>821</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.2676</pub-id><!--<pub-id pub-id-type="pmcid">3819121</pub-id>--><?supplied-pmid 23975157?><pub-id pub-id-type="pmid">23975157</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leray</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>JY</given-names></name><name><surname>Meyer</surname><given-names>CP</given-names></name><etal/></person-group>:
<article-title>A new versatile primer set targeting a short fragment of the mitochondrial COI region for metabarcoding metazoan diversity: application for characterizing coral reef fish gut contents.</article-title><source><italic>Front Zool.</italic></source><year>2013</year>;<volume>10</volume>:<fpage>34</fpage>.
<pub-id pub-id-type="doi">10.1186/1742-9994-10-34</pub-id><!--<pub-id pub-id-type="pmcid">3686579</pub-id>--><?supplied-pmid 23767809?><pub-id pub-id-type="pmid">23767809</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lessios</surname><given-names>HA</given-names></name></person-group>:
<article-title>METHODS for quantifying abundance of marine organisms.</article-title>In:
<italic>Methods and techniques of underwater research.</italic>(eds. Lang, M. &amp; Baldwin, C.). American Academy of Underwater Sciences (AAUS),<year>1996</year>;<fpage>149</fpage>–<lpage>157</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://www.researchgate.net/profile/Harilaos_Lessios/publication/255605529_METHODS_FOR_QUANTIFYING_ABUNDANCE_OF_MARINE_ORGANISMS/links/0f3175370d7bf514b0000000/METHODS-FOR-QUANTIFYING-ABUNDANCE-OF-MARINE-ORGANISMS.pdf">Reference Source</ext-link>
</mixed-citation>
    </ref>
    <ref id="ref-18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>PJ</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group>:
<article-title>phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>4</issue>):<fpage>e61217</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id><!--<pub-id pub-id-type="pmcid">3632530</pub-id>--><?supplied-pmid 23630581?><pub-id pub-id-type="pmid">23630581</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>PJ</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group>:
<article-title>Waste not, want not: why rarefying microbiome data is inadmissible.</article-title><source><italic>PLoS Comput Biol.</italic></source><year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003531</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id><!--<pub-id pub-id-type="pmcid">3974642</pub-id>--><?supplied-pmid 24699258?><pub-id pub-id-type="pmid">24699258</pub-id></mixed-citation>
    </ref>
    <ref id="ref-52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>PJ</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group>:
<article-title>Shiny-phyloseq: Web application for interactive microbiome analysis with provenance tracking.</article-title><source><italic>Bioinformatics.</italic></source><year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>282</fpage>–<lpage>283</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu616</pub-id><!--<pub-id pub-id-type="pmcid">4287943</pub-id>--><?supplied-pmid 25262154?><pub-id pub-id-type="pmid">25262154</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miya</surname><given-names>M</given-names></name><name><surname>Sato</surname><given-names>Y</given-names></name><name><surname>Fukunaga</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>MiFish, a set of universal PCR primers for metabarcoding environmental DNA from fishes: detection of more than 230 subtropical marine species.</article-title><source><italic>R Soc Open Sci.</italic></source><year>2015</year>;<volume>2</volume>(<issue>7</issue>):<fpage>150088</fpage>.
<pub-id pub-id-type="doi">10.1098/rsos.150088</pub-id><!--<pub-id pub-id-type="pmcid">4632578</pub-id>--><?supplied-pmid 26587265?><pub-id pub-id-type="pmid">26587265</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oksanen</surname><given-names>J</given-names></name><name><surname>Blanchet</surname><given-names>FG</given-names></name><name><surname>Friendly</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Vegan: Community ecology package</article-title>.<year>2018</year><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/vegan/vegan.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandya</surname><given-names>RE</given-names></name></person-group>:
<article-title>A framework for engaging diverse communities in citizen science in the US.</article-title><source><italic>Front Ecol Environ.</italic></source><year>2012</year>;<volume>10</volume>(<issue>6</issue>):<fpage>314</fpage>–<lpage>317</lpage>.
<pub-id pub-id-type="doi">10.1890/120007</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname><given-names>DH</given-names></name><name><surname>Tyson</surname><given-names>GW</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>STAMP: statistical analysis of taxonomic and functional profiles.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>21</issue>):<fpage>3123</fpage>–<lpage>3124</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu494</pub-id><!--<pub-id pub-id-type="pmcid">4609014</pub-id>--><?supplied-pmid 25061070?><pub-id pub-id-type="pmid">25061070</pub-id></mixed-citation>
    </ref>
    <ref id="ref-24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedersen</surname><given-names>MW</given-names></name><name><surname>Overballe-Petersen</surname><given-names>S</given-names></name><name><surname>Ermini</surname><given-names>L</given-names></name><etal/></person-group>:
<article-title>Ancient and modern environmental DNA.</article-title><source><italic>Philos Trans R Soc Lond B Biol Sci.</italic></source><year>2015</year>;<volume>370</volume>(<issue>1660</issue>):<fpage>20130383</fpage>.
<pub-id pub-id-type="doi">10.1098/rstb.2013.0383</pub-id><!--<pub-id pub-id-type="pmcid">4275890</pub-id>--><?supplied-pmid 25487334?><pub-id pub-id-type="pmid">25487334</pub-id></mixed-citation>
    </ref>
    <ref id="ref-25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>C</given-names></name><name><surname>Moberg-Parker</surname><given-names>J</given-names></name><name><surname>Toma</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Comparing the Impact of Course-Based and Apprentice-Based Research Experiences in a Life Science Laboratory Curriculum.</article-title><source><italic>J Microbiol Biol Educ.</italic></source><year>2015</year>;<volume>16</volume>(<issue>2</issue>):<fpage>186</fpage>–<lpage>197</lpage>.
<pub-id pub-id-type="doi">10.1128/jmbe.v16i2.1045</pub-id><!--<pub-id pub-id-type="pmcid">4690559</pub-id>--><?supplied-pmid 26751568?><pub-id pub-id-type="pmid">26751568</pub-id></mixed-citation>
    </ref>
    <ref id="ref-26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taberlet</surname><given-names>P</given-names></name><name><surname>Coissac</surname><given-names>E</given-names></name><name><surname>Hajibabaei</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Environmental DNA.</article-title><source><italic>Mol Ecol.</italic></source><year>2012</year>;<volume>21</volume>(<issue>8</issue>):<fpage>1789</fpage>–<lpage>1793</lpage>.
<pub-id pub-id-type="doi">10.1111/j.1365-294X.2012.05542.x</pub-id><?supplied-pmid 22486819?><pub-id pub-id-type="pmid">22486819</pub-id></mixed-citation>
    </ref>
    <ref id="ref-27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>AC</given-names></name><name><surname>Howard</surname><given-names>J</given-names></name><name><surname>Nguyen</surname><given-names>PL</given-names></name><etal/></person-group>:
<article-title>ANDe: A fully integrated environmental DNA sampling system.</article-title><source><italic>Methods Ecol Evol.</italic></source><year>2018</year>;<volume>9</volume>(<issue>6</issue>):<fpage>1379</fpage>–<lpage>1385</lpage>.
<pub-id pub-id-type="doi">10.1111/2041-210X.12994</pub-id></mixed-citation>
    </ref>
    <ref id="ref-28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Usseglio</surname><given-names>P</given-names></name></person-group>:
<article-title>Quantifying reef fishes: Bias in observational approaches.</article-title>In:
<italic>Ecology of fishes on coral reefs.</italic>(ed. Mora, C.). Cambridge University Press,<year>2015</year>;<fpage>270</fpage>–<lpage>273</lpage>.
<pub-id pub-id-type="doi">10.1017/CBO9781316105412.035</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report40128" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.18233.r40128</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Grünwald</surname>
          <given-names>Niklaus J.</given-names>
        </name>
        <xref ref-type="aff" rid="r40128a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1656-7602</contrib-id>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Foster</surname>
          <given-names>Zach</given-names>
        </name>
        <xref ref-type="aff" rid="r40128a2">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r40128a1"><label>1</label>Horticultural Crops Research Laboratory, USDA Agricultural Research Service (United States Department of Agriculture), Corvallis, OR, USA</aff>
      <aff id="r40128a2"><label>2</label>Deptartment of Botany &amp; Plant Pathology, Oregon State University, Corvallis, OR, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <related-article id="d35e2383" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.16680.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors present the R package rancapa that implements an interactive shiny web app available at
<ext-link ext-link-type="uri" xlink:href="https://gauravsk.shinyapps.io/ranacapa">https://gauravsk.shinyapps.io/ranacapa</ext-link> for exploration of environmental DNA characterized by amplicon sequencing. This app facilitates many of the standard tests and plots done for metabarcoding data. The app requires two dataset to run, namely a taxonomy-by-sample matrix file and a simple metadata file with descriptive information on the actual environmental samples. This package is particularly useful to anybody interested in exploring biome diversity but lacking extensive computational and bioinformatics skills. We appreciate the focus on open-source code and accessibility, in particular testing the app with Ubuntu and using the color-blind friendly viridis color palette. There are some minor changes in the style of plots and wording we would like to see, but these are a matter of opinion and do not affect the validity of the results. The authors admirably point out flaws and potential pitfalls in the analysis that often go unmentioned (e.g. the drawbacks of rarefaction). Although there is always room for improvement, we feel this app is quite useful as is and it is described well in the associated article. We suggest many improvements that could be made, but most of these are intended as constructive suggestions.</p>
    <p>
      <bold>Specific comments:</bold>
      <list list-type="bullet">
        <list-item>
          <p>keywords: include “R package”</p>
        </list-item>
      </list>
      <bold>Introduction</bold>
      <list list-type="bullet">
        <list-item>
          <p>The sentence “A key ingredient to promote sustained success of such programs is that community partners should be able to engage across multiple stages of the research project, not only in sample collection” is a bit awkward. Perhaps something like the following would be more clear: “Such programs are more likely to succeed if community partners are able to be involved in multiple stages of the research project, not only sample collection”</p>
        </list-item>
        <list-item>
          <p>End of paragraph 2: “let alone for the non-technical audience of some community science programs.” We suggest “audience” be replaced with “members”, “partners”, or “collaborators”, since they are involved in the project.</p>
        </list-item>
      </list>
      <bold>Implementation</bold>
      <list list-type="bullet">
        <list-item>
          <p>Paragraph 1, sentence 1: The command “ranacapa::runRanacapa()” does not work. Should it be “ranacapa::runRanacapaApp()”?</p>
        </list-item>
        <list-item>
          <p>Figure 4: It would be nice if the results of the Tukey’s HSD test be included on the graph using letter codes.</p>
        </list-item>
        <list-item>
          <p>Sequencing depth, sentence 2: “Users can rarefy the data set to a sampling depth, or can proceed through the rest of the app without rarefying samples.” It's nice to have the option, but if sequences are not rarefied, perhaps they should be converted to proportions? The taxon abundance plots (e.g. the heat map) is biased without some correction for sampling depth and proportions would avoid the loss of data associated with rarefaction. While converting to proportions will not remove sample-size bias for alpha and beta diversity analyses, it will remove the bias for taxon abundance analyses for the most part. The conversion to proportions could also be an option in just the taxon abundance analyses.</p>
        </list-item>
        <list-item>
          <p>Beta diversity plots, sentence 1: “Introduces the concept of beta diversity as the turnover in species composition across habitats (or samples).” The word “turnover” seems to imply a change over time, rather than a comparison between communities. Perhaps something like: “Introduces the concept of beta diversity as a way to compare community composition across habitats (or samples).”</p>
        </list-item>
        <list-item>
          <p>Beta diversity statistics, sentence 1: “Shows results from two statistical tests of species turnover across sites.” See comment above on “turnover”.</p>
        </list-item>
      </list>
      <bold>Suggestions on the software</bold>
      <list list-type="bullet">
        <list-item>
          <p>Exploring ranacapa at
<ext-link ext-link-type="uri" xlink:href="https://gauravsk.shinyapps.io/ranacapa">https://gauravsk.shinyapps.io/ranacapa</ext-link> shows the interactive tools. We suggest that screenshots from the actual shinyapp be presented as figures as they provide the context for exploring the data. For example under Figure 2, the legend states that users can also select or deselect individual taxa’ but the figure 2 in the manuscript does not show this. This is confusing.</p>
        </list-item>
        <list-item>
          <p>We also suggest giving explicit examples for executing the shiny app on a desktop maybe right after the installation instructions.</p>
        </list-item>
      </list>
      <bold>Data import</bold>
      <list list-type="bullet">
        <list-item>
          <p>The proper format for input data is described in the article, but it would be nice if it was repeated in the “data import” section of the app as well. You could also include tips to convert common formats to the needed format here.</p>
        </list-item>
      </list>
      <bold>Sequencing depth</bold>
      <list list-type="bullet">
        <list-item>
          <p>Second paragraph, first sentence: “In eDNA sequencing, such variation in how deeply a given sample is sequenced can happen for a variety for reasons-”. Should the “-” be a “:”?</p>
        </list-item>
        <list-item>
          <p>Third paragraph, first sentence: You use double quotes for “deeply” in the first paragraph, but single quotes for ‘rarefy’.</p>
        </list-item>
        <list-item>
          <p>Add proportions as an alternative to rarefaction instead of “none”?</p>
        </list-item>
        <list-item>
          <p>The rarefied samples plot is a good idea, but hard to read in its current state. Perhaps change the faceting settings so that there is one column of plots or have a option to choose the sample shown?</p>
        </list-item>
        <list-item>
          <p>Taxonomy bar pot: The number of similar colors make this hard to read without selecting individual taxa. We know this is a limitation of stacked barcharts, but it might make it more readable to sort the taxa by average abundance and then stagger the colors like so: For example, if there are 30 taxa, then the first 10 get colors 1, 4, 7, 10, 13, 16, 19, 22, 25, 28 (seq(1,30, 30 / 10)). Also have the most abundant taxa be the lowest on the stacked bars. That way adjacent colors can be differentiated and the colors of rare taxa won't be confused with the colors of the abundant taxa.</p>
        </list-item>
      </list>
      <bold>Taxonomy heatmap</bold>
      <list list-type="bullet">
        <list-item>
          <p>How about faceting by sample metadata or clustering samples by similarity? You could use the results of the Ward’s Hierarchical Clustering like you do in the beta diversity section.</p>
        </list-item>
        <list-item>
          <p>Can you make the height of the plot depend on the number of samples plotted? Also, making the “Select taxa to visualize” box taller would be nice.</p>
        </list-item>
      </list>
      <bold>Alpha diversity plots</bold>
      <list list-type="bullet">
        <list-item>
          <p>You use the term “species richness” without explicitly defining it, although you implicitly define it. It might be a good idea to point out that “observed” is the same as “species richness”.</p>
        </list-item>
        <list-item>
          <p>Plotting the results of the Tukey’s HSD test on this plot would be great. Actually this tab could probably be combined with the “alpha diversity stats” tab.</p>
        </list-item>
        <list-item>
          <p>The color and the different point shapes are not needed, but that’s just a question of style.</p>
        </list-item>
      </list>
      <bold>Alpha diversity stats</bold>
      <list list-type="bullet">
        <list-item>
          <p>You say “ANOVAs only work when each group is represented by a few samples”, which is great to point out. How about just not allowing for the ANOVA and Tukey’s HSD if there are not multiple samples per treatment?</p>
        </list-item>
        <list-item>
          <p>How about not showing the Tukey’s test result if the ANOVA p-value is more than 0.1? You do say “the following results are meaningful only if the ANOVA table above suggests that sites are in fact unequal in terms of their diversity”, but it's very tempting to look at the results of the Tukey’s HSD test anyway. Alternatively, you could add a warning above the Tukey’s HSD results if the ANOVA p-value is more than 0.1.</p>
        </list-item>
        <list-item>
          <p>How about using the DT package to make the Tukey’s HSD results table sortable, like you do for other tables? The first thing most people will want to do is sort by p-value.</p>
        </list-item>
      </list>
      <bold>Beta diversity plots</bold>
      <list list-type="bullet">
        <list-item>
          <p>You say “samples that are distant in this plot have very different species lists”. That is not exactly true. Samples that are more distant from each other are more different from each other, but they all might be quite similar in terms of the species present; The PCoA will always show differences, no matter how small.</p>
        </list-item>
        <list-item>
          <p>An explanation of how to interpret the percent of the variation explained by each axis would be nice.</p>
        </list-item>
        <list-item>
          <p>How about confidence interval ellipsis for the sample types?</p>
        </list-item>
        <list-item>
          <p>How about allowing exploration of other dimensions (maybe in a 3d plot as well)?</p>
        </list-item>
        <list-item>
          <p>In the clustering dendrogram, how about coloring sample names by sample type? Ideally, it would be the same colors used in the PCoA plot, so you would not need a second legend.</p>
        </list-item>
      </list>
      <bold>Beta diversity stats</bold>
      <list list-type="bullet">
        <list-item>
          <p>How about displaying the results of the Adonis analysis in a table instead of a printed data.frame, like how it is done in the “Homogeneity of Variances” analysis? Tables from the DT package would be nice, so we can sort by p-value.</p>
        </list-item>
      </list>
      <bold>Data export</bold>
      <list list-type="bullet">
        <list-item>
          <p>It would be nice to provide an option to export the data in the taxmap format from the taxa package
<sup><xref rid="rep-ref-40128-1" ref-type="bibr">1</xref></sup>. Zach Foster can help implement this.</p>
        </list-item>
      </list>
    </p>
    <p>We have read this submission. We believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-40128-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>ZSL</given-names></name><name><surname>Chamberlain</surname><given-names>S</given-names></name><name><surname>Grünwald</surname><given-names>NJ</given-names></name></person-group>:
<article-title>Taxa: An R package implementing data standards and methods for taxonomic data.</article-title><source><italic>F1000Res</italic></source>.<year>2018</year>;<volume>7</volume>:
<elocation-id>10.12688/f1000research.14013.2</elocation-id><fpage>272</fpage><pub-id pub-id-type="doi">10.12688/f1000research.14013.2</pub-id><?supplied-pmid 29707201?><pub-id pub-id-type="pmid">29707201</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
</sub-article>
<sub-article id="report40129" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.18233.r40129</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bik</surname>
          <given-names>Holly M.</given-names>
        </name>
        <xref ref-type="aff" rid="r40129a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4356-3837</contrib-id>
      </contrib>
      <aff id="r40129a1"><label>1</label>Department of Nematology, University of California, Riverside, Riverside, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <related-article id="d35e2657" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.16680.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This article presents a new R software package and shiny app called "ranacapa", aimed at producing rapid visualization and exploration of eDNA metabarcoding datasets. Overall I found this software tool to be exciting and user friendly, and the outlined use cases provided good examples of the need for such tools amongst end users including researchers and undergraduate students. The R shiny app was easy to explore using the demo dataset, and the plots were responsive and visually useful. </p>
    <p> When trying to install ranacapa in RStudio (via install.packages), I am consistently getting an error message stating that "package ‘ranacapa’ is not available (for R version 3.3.2)". Furthermore, ranacapa does not appear to be listed as a package currently available in CRAN</p>
    <p> (https://cran.r-project.org/web/packages/available_packages_by_name.html#available-packages-R).</p>
    <p> Further investigation suggests that this package requires R 3.5.0 or higher to run, but this is not obvious for end users with older versions of R installed. Is it possible to add back compatibility to older versions of R? Especially for end users using HPC facilities who may be unable to update the base R version on their cluster.</p>
    <p> "Taxonomy-by-sample matrix" - since ranacapa uses a non-standard input (essentially an OTU table summarized by taxonomy), it would be useful to provide specific instructions and/or a conversion script where users can take their QIIME BIOM files or tab-delimited OTU tables and convert them into a format that is suitable for uploading into ranacapa. Users with minimal technical expertise may struggle to convert their data in the correct way. Especially useful would be R scripts or package commands (e.g. phyloseq) that will output taxonomy-by-sample-matrixes in the correct format.</p>
    <p> The R shiny web app does not provide much information regarding file formatting (users must read the F1000 article for specific information). The only documentation online states that the imported files should be in .biom or .txt formats. What format(s) are supported for the header row (commented out vs. plain text)? Are there any limitations on sparse vs. dense or JSON vs. HDF5 BIOM files (e.g. from QIIME 1 or QIIME2)? Detailed information and documentation should be provided on the website itself in addition to the F1000 article.</p>
    <p> For the metdatata file - can users directly import QIIME-formatted mapping files (e.g. with a header row beginning with #SampleID that has been validated via Keemi)? Or does this file need to be be edited further for ranacapa?</p>
    <p> For the demo file on the web server - what study did this file come from? It would be useful to have some contextual information about the file, eDNA markers used, questions/hypotheses, and study design so that end users can explore the demo dataset in a more thoughtful way. </p>
    <p> Some components of the R Shiny web app do not always seem to function correctly over a slow internet connection - it seems to freeze up and require re-loading, and/or users are presented with an error message. This error message sometimes goes away and the plots pop up as expected after a few minutes. Better error dialogs or "please wait" message boxes would be much less frustrating for the end user to figure out what is happening.</p>
    <p> Sequencing Depth - the rarefaction depth slider bar is straightforward and should be familiar to most users, however, what impact do multiple rarefactions have on the displayed graphs? Are the rarefaction curves averaged somehow before being displayed? Further information on this parameter would be useful to include in the explanatory text.</p>
    <p> Taxonomy heatmap - when choosing a lower taxonomic level, the taxonomy strings are overlapping and unreadable. Zooming in cuts off some of the categories on the x-axis. It would be better to be able to expand the heatmap along the y-axis (stretch it out) so you can read the taxonomy labels while still being able to view all of the heatmap information.</p>
    <p> Taxonomy heatmap - when selecting a taxon to visualize, users might want to see more detail at lower taxonomic levels, however, selecting a taxon to visualize and then choosing a different taxonomic rank currently removes this filter choice and reverts back to showing all taxa at that level.</p>
    <p> Alpha Diversity Plots - what is the difference between Observed vs. Shannon diversity visualizations? The explanatory text only partially explains the difference between these two options, and could be clarified to explicitly state the important differences in these two calculations. Furthermore, what do high vs. low numerical values mean for each of the two indices, in biological terms (e.g. lower number of species)? These kind of diversity statistics may be familiar for ecologists and microbiome researchers, but are likely to be confusing for citizen scientists, students, or scientists outside of these fields.</p>
    <p> Alpha Diversity Stats - Unless you have a strong statistical background, it is impossible to interpret the numbers and outputs listed in this tab in the ranacapa shiny app. More explanation is needed to guide users in what they should be looking for - what columns are most important in the ANOVA table to see if samples are in fact unequal in terms of their diversity? In the post-hoc tests, should users be looking for P values &lt;0.05 in the last column? </p>
    <p> Beta Diversity - the Jaccard and Bray-Curtis indexes could be explained more plainly. Jaccard is the simplest measure of shared taxa/OTUs, while Bray-Curtis is an index focused on the most abundant taxa/OTUs in the dataset. Also some explanation of the PCoA axes (e.g. that they explain variation but do not relate to metadata) would be useful. Adding the Canberra index might also be useful here, as this is another useful index which ignores the most abundant taxa and looks at differences across rare species.</p>
    <p> Beta Diversity Stats - same comment as Alpha Diversity stats (see above). Needs more context and explanation to be accessible to end users without a statistical background.</p>
    <p> Use Case 1 - how was the UCLA eDNA dataset filtered down to the set of key taxa that resource managers were looking for? Was this done via R command line, or via the R shiny app interface? Custom filtering is likely to be a common use case, and it would be valuable to add in more specific information regarding how this type of taxon filtering can be accomplished for any dataset.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article id="report40402" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.18233.r40402</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cordier</surname>
          <given-names>Tristan</given-names>
        </name>
        <xref ref-type="aff" rid="r40402a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7398-4790</contrib-id>
      </contrib>
      <aff id="r40402a1"><label>1</label>Department of Genetics and Evolution, University of Geneva, Geneva, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <related-article id="d35e2770" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.16680.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The manuscript “ranacapa: An R package and Shiny web app to explore environmental DNA data with exploratory statistics and interactive visualizations” is describing an R package to visualize metabarcoding data and perform summary statistics. </p>
    <p> I think that such application will be very useful for quick results sharing within any project that involves stakeholders with various background. Too many projects still rely solely on a printed (or pdf) report with key chosen figures, orienting the readers towards the main messages. I do believe that such application will provide a nice complement to a project report for people that want to dive into the results, or explore the robustness of the conclusion that are highlighted in a report. </p>
    <p> I also agree with the authors that such tools are particularly interesting for sharing results with non-expert enthusiasts and students. I appreciate the accompanying text to present the specificity of composition (count) data and the possible flaws when analyzing such data. The website “Gusta Me” (
<ext-link ext-link-type="uri" xlink:href="https://mb3is.megx.net/gustame">https://mb3is.megx.net/gustame</ext-link>) could maybe be mentioned as an external resource for guiding further the users for the interpretation of results, or to guide any additional analysis. </p>
    <p> I wonder how such application is intended to be deployed. Do the authors plan to let research scientists deploy the app within their own computational resources or do they plan to make the application accessible (
<ext-link ext-link-type="uri" xlink:href="https://gauravsk.shinyapps.io/ranacapa/">https://gauravsk.shinyapps.io/ranacapa/</ext-link>) opened to the community? </p>
    <p> I made few comments on the GUI that the authors may or may not follow. The most important point to address would be to allow users to write their PERMANOVA model. </p>
    <p> Data import: 
<list list-type="bullet"><list-item><p>Maybe add the expected format, with a toy example, indicating the separator character (tab or comma or semi-comma?). This is mentioned in the GitHub page of the project (not the separator though), but I think this would be nice to have it here also. My guess is that many users would not even get to the GitHub page before using the app. </p></list-item></list> Sequencing depth: 
<list list-type="bullet"><list-item><p>Would it be possible to add a “free” input field? As it is now, it is not easy to get a precise value. The slider does not allow this kind of precision, it increases or decreases by 1000 but on the demo example, it is stuck to 10006. </p></list-item><list-item><p>Would it be possible to include normalization as an option? At least the relative abundance for a start, because as you mention on the accompanying text, we are far from having reach a consensus on that matter. </p></list-item><list-item><p>What means the first field “select the variable”, do you mean to rarefy not samples but something else? I don’t understand. </p></list-item></list> Taxonomy barplot: 
<list list-type="bullet"><list-item><p>I personally don’t like taxonomic barplots, but I recognize that they can be useful to easily illustrate some obvious differences (or similarities) between experimental treatments to an audience unfamiliar with metabarcoding data. The lowest taxonomic ranks return a (way) too many categories. In the presented example. Even the highest taxonomic rank (phylum), it yields too many categories to easily visualize what is actually in the samples, because colors are too close to each other. There is no solution, I just don’t like these plots. But it is nice to have this option in the app anyway. </p></list-item></list> Taxonomy heatmap:
<list list-type="bullet"><list-item><p>Is there an option to scale differently the X and Y axis? In the example dataset, it is actually a similar problem as for taxonomy barplot, lowest taxonomic rank gives too many rows on the plots. A way to better see is to zoom in, but then the horizontal axis is quite messed up. </p></list-item><list-item><p>Maybe it would be nice to have input fields to manage those axes and font size. </p></list-item></list> Alpha-diversity plots:
<list list-type="bullet"><list-item><p>I guess the data behind is the rarefied version of the dataset, but this should be clear. Maybe the box can be there, but in grey to show that it would not make sense to use the raw dataset? </p></list-item></list> Alpha-diversity stats: I think this is fine.  </p>
    <p> Beta-diversity plots:
<list list-type="bullet"><list-item><p>The users should be able to refine the ordination plots, its size, the size of each axis. </p></list-item><list-item><p>Why the ordination plots configuration (and the cluster analysis) is changing when we select different variables to group the dot shapes and colors?  </p></list-item></list> Beta-diversity analyses:
<list list-type="bullet"><list-item><p>Would it be possible to let the user write his own model? As for now, it is not possible to have an interaction term, or a nested model. </p></list-item><list-item><p>To be able to select the sample as variable does not make sense. </p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
