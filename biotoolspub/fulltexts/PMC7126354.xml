<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7126354</article-id>
    <article-id pub-id-type="publisher-id">808</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-020-00808-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetaEuk—sensitive, high-throughput gene discovery, and annotation for large-scale eukaryotic metagenomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Levy Karin</surname>
          <given-names>Eli</given-names>
        </name>
        <address>
          <email>eli.levy.karin@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mirdita</surname>
          <given-names>Milot</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Söding</surname>
          <given-names>Johannes</given-names>
        </name>
        <address>
          <email>soeding@mpibpc.mpg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.418140.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2104 4211</institution-id><institution>Quantitative and Computational Biology, </institution><institution>Max-Planck Institute for Biophysical Chemistry, </institution></institution-wrap>37077 Göttingen, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>48</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Metagenomics is revolutionizing the study of microorganisms and their involvement in biological, biomedical, and geochemical processes, allowing us to investigate by direct sequencing a tremendous diversity of organisms without the need for prior cultivation. Unicellular eukaryotes play essential roles in most microbial communities as chief predators, decomposers, phototrophs, bacterial hosts, symbionts, and parasites to plants and animals. Investigating their roles is therefore of great interest to ecology, biotechnology, human health, and evolution. However, the generally lower sequencing coverage, their more complex gene and genome architectures, and a lack of eukaryote-specific experimental and computational procedures have kept them on the sidelines of metagenomics.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">MetaEuk is a toolkit for high-throughput, reference-based discovery, and annotation of protein-coding genes in eukaryotic metagenomic contigs. It performs fast searches with 6-frame-translated fragments covering all possible exons and optimally combines matches into multi-exon proteins. We used a benchmark of seven diverse, annotated genomes to show that MetaEuk is highly sensitive even under conditions of low sequence similarity to the reference database. To demonstrate MetaEuk’s power to discover novel eukaryotic proteins in large-scale metagenomic data, we assembled contigs from 912 samples of the Tara Oceans project. MetaEuk predicted &gt;12,000,000 protein-coding genes in 8 days on ten 16-core servers. Most of the discovered proteins are highly diverged from known proteins and originate from very sparsely sampled eukaryotic supergroups.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The open-source (GPLv3) MetaEuk software (<ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/metaeuk">https://github.com/soedinglab/metaeuk</ext-link>) enables large-scale eukaryotic metagenomics through reference-based, sensitive taxonomic and functional annotation.</p>
        <p id="Par4">
          <media xlink:href="40168_2020_808_MOESM2_ESM.mp4" id="MOESM2">
            <caption>
              <p>Video abstract</p>
            </caption>
          </media>
        </p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>MetaEuk</kwd>
      <kwd>Eukaryotes</kwd>
      <kwd>Homology detection</kwd>
      <kwd>Prediction</kwd>
      <kwd>Annotation</kwd>
      <kwd>Contigs</kwd>
      <kwd>Marine</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010661</institution-id>
            <institution>Horizon 2020 Framework Programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>685778</award-id>
        <principal-award-recipient>
          <name>
            <surname>Söding</surname>
            <given-names>Johannes</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par5">Unicellular eukaryotes are present in almost all environments, including soil [<xref ref-type="bibr" rid="CR1">1</xref>], oceans [<xref ref-type="bibr" rid="CR2">2</xref>], and plant and animal-associated microbiomes [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. They exhibit both autotrophic and heterotrophic lifestyles [<xref ref-type="bibr" rid="CR5">5</xref>], exist in symbiosis with plants and animals [<xref ref-type="bibr" rid="CR6">6</xref>], and interact with other microbial organisms [<xref ref-type="bibr" rid="CR7">7</xref>]. They account for roughly half of the global primary productivity in the oceans, mostly by photosynthesis [<xref ref-type="bibr" rid="CR8">8</xref>], are key contributors to the carbon and nitrogen cycles through carbon-dioxide fixation, organic matter degradation, and denitrification [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], and have been shown to be a source for chemically bioactive compounds [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par6">Since the advent of metabarcoding using 18S rRNA genes, the known evolutionary diversity of unicellular eukaryotes has increased by orders of magnitude [<xref ref-type="bibr" rid="CR13">13</xref>], and novel phyla and supra-kingdoms are still being discovered [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. Due to their vast diversity [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], unicellular eukaryotes are certain to hold invaluable secrets for biotechnology and biomedicine.</p>
    <p id="Par7">Protein-coding genes are major keys for understanding eukaryotic functions and activities [<xref ref-type="bibr" rid="CR18">18</xref>]. Metatranscriptomic and metagenomic studies provide unique means to reveal protein-coding genes. However, despite the great potential of studying uncultivatable eukaryotes in their natural environment, they have received little attention in metatranscriptomic and metagenomic studies so far, with a few notable exceptions e.g., [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. The unique features of eukaryotic data, i.e., lower genomic coverage due to lower population densities in metagenomic samples, fewer reference genomes, increased genome sizes, and higher complexity of gene structure negatively impact all stages of metagenomic analyses, from assembly, through binning, to protein prediction and annotation [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p id="Par8">Specifically, identifying protein-coding genes in eukaryotes is inherently more challenging than in prokaryotes due to the exon-intron architecture of eukaryotic genes. To date, methods for eukaryotic gene calling e.g., [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>] consider two types of information when training models for gene prediction: intrinsic sequence signals (e.g., CpG islands) and extrinsic data, such as transcriptomics or an annotated genome from a closely related organism. As splicing signatures are not well conserved throughout evolution, the predictive power of the trained models declines fast when applied to organisms that are phylogenetically distant from the organism on which the model was trained [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p id="Par9">While these methods are very useful for genomics, their applicability to metagenomic data is severely limited. First, the transcriptomic or genomic data of annotated organisms that are sufficiently closely related are usually not available. Second, since the models need to be trained on a relatively narrow clade, the application of such methods to metagenomic data requires to first bin the assembled contigs by their assumed genome of origin as performed by [<xref ref-type="bibr" rid="CR27">27</xref>], which is often quite inaccurate and slow, especially when the number of contigs is large, the coverage is low, the contigs are short, and the metagenomic data are species-rich [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. Finally, model-training in itself is time consuming, taking hours to days per genomic bin [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR27">27</xref>], limiting this approach to the analysis of few genomic bins at a time.</p>
    <p id="Par10">Previously, methods that bypass or reduce the need to explicitly train models to detect protein-coding genes have been proposed in the context of genomics e.g., [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. These methods extract putative protein-coding fragments from the genome and join those that bear sequence similarity to available transcriptomic or protein sequence targets. Since the joined fragments can be separated by non-coding (intronic) regions, their match to the target is termed “spliced alignment.” Even at a genomic level, a brute force application of the spliced alignment approach poses a serious computational burden as it requires aligning each putative fragment to each target as well as recovering the set of putative fragments that best match a target.</p>
    <p id="Par11">Here, we developed MetaEuk, a novel and sensitive reference-based approach to identify single- and multi-exon protein-coding genes in eukaryotic metagenomic data. MetaEuk takes as input a set of assembled contigs and a reference database of target protein sequences or profiles. MetaEuk scans each contig in all six reading frames and extracts putative protein fragments between stop codons in each frame. Thus, MetaEuk makes no assumption about the splicing signal and does not rely on any preceding binning step. MetaEuk uses the MMseqs2 code library [<xref ref-type="bibr" rid="CR33">33</xref>] for a very fast, yet sensitive identification of putative exons within the fragments. This step also discards the vast majority of fragments, which significantly reduces the computation time of all succeeding steps. The combinatorial task of considering all possible sets of putative exons to best match a given target is solved by means of dynamic programming. Since MetaEuk uses a homology-based strategy to identify protein-coding genes, it can directly confer annotations to the discovered genes from the matched target proteins.</p>
    <p id="Par12">We benchmarked MetaEuk by using annotated genomes and proteins of seven unicellular organisms from different parts of the eukaryotic tree of life under conditions of increasing evolutionary distance to sequences in the reference database. Despite its high speed and low false positive rates, MetaEuk is able to discover a large fraction of the known proteins in these benchmark genomes. We next applied MetaEuk to study marine eukaryotes. We assembled all Tara Oceans metagenomic samples [<xref ref-type="bibr" rid="CR20">20</xref>] and focused on ~1,300,000 contigs of at least 5 kbp in length. We clustered more than 330,000,000 proteins to create a comprehensive catalog of over 87,000,000 protein profiles to serve as a reference database. We found the MetaEuk collection of &gt;12,000,000 marine proteins is highly diverged, offering major eukaryotic lineage expansions.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The MetaEuk algorithm</title>
      <p id="Par13">The main steps of the algorithm are presented schematically in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, and a detailed description is provided in the Methods section. For each input contig, all possible protein-coding fragments are translated in six reading frames and searched against a reference target database of protein sequences or profiles. Fragments from the same contig and strand that hit a reference target <italic>T</italic> are examined together. In each fragment, only the part that was aligned to the target protein <italic>T</italic> is considered as a putative exon. The putative exons are ordered according to their start position on the contig. Based on their contig locations and the locations of their aligned region on the target <italic>T</italic>, any two putative exons are either compatible or not. A dynamic programming procedure recovers the highest scoring path of compatible pairs of putative exons by computing the maximum scores of all paths ending with each putative exon. Since homologies among targets in the reference database can lead to multiple calls of the same protein-coding gene, redundancies are reduced by clustering the calls. To that end, all calls are ordered by their start position on the contig. The first call defines a new cluster and all calls that overlap it on the contig are assigned to its cluster if they share an exon with it. The next cluster is defined by the first unassigned call. After all calls are clustered, the best scoring call is selected as the representative of the cluster, termed a “prediction.” Finally, as overlaps of genes on the same strand are very rare as reviewed by [<xref ref-type="bibr" rid="CR34">34</xref>], gene predictions overlapping others on the same strand with a better <italic>E</italic>-value are removed.
<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>MetaEuk algorithm.</bold> Input to MetaEuk are assembled metagenomic contigs and a reference database of protein sequences. <bold>1</bold> Six-frame translation of all putative protein-coding fragments from each contig. <bold>2</bold> Fragments on the same contig and strand that hit the same reference protein <italic>T</italic> are examined together. <bold>3</bold> Putative exons are identified and ordered according to their start position on the contig. The highest score and path (denoted with a star) of a set of compatible putative exons is computed by dynamic programming, in which individual scores of the putative exons are summed and unmatched amino acids are penalized. <bold>4</bold> Redundancies among gene calls due to homologous targets (<italic>T</italic>, <italic>T’</italic>, and <italic>“T”</italic>) are reduced and a representative prediction (denoted with a star) is retained. <bold>5</bold> Contradicting predictions of overlapping genes on the same strand are resolved by excluding the prediction with the higher <italic>E</italic>-value</p></caption><graphic xlink:href="40168_2020_808_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Performance evaluation on benchmark data</title>
      <p id="Par14">We evaluated MetaEuk using seven annotated unicellular eukaryotic organisms obtained from the NCBI’s genome assembly database [<xref ref-type="bibr" rid="CR35">35</xref>] (Table <xref rid="Tab1" ref-type="table">1</xref>). These organisms are varied in terms of their phylogenetic group, genome size, number of annotated proteins, fraction of multi-exon genes, and assembly quality. MetaEuk was run on the assembled scaffolds of each of these organisms against the UniRef90 [<xref ref-type="bibr" rid="CR36">36</xref>] database with an average run time of 42 min per genome, or 0.5 Mbp/min, on a server with two 8-core Intel Xeon E5-2640v3 CPUs and 128 GB RAM (Table <xref rid="Tab1" ref-type="table">1</xref>). The NCBI data included the scaffold coordinates of the annotated protein-coding genes and their exons. In the following sections, we used this information to assess MetaEuk’s sensitivity and precision by mapping MetaEuk predictions to annotated proteins in their scaffold location. This was done based on the scaffold boundaries of the MetaEuk prediction and the annotated protein and by requiring high sequence identity of their protein alignment. We then computed the coverage of individual exons of the annotated proteins to which MetaEuk predictions were mapped. These mappings are fully described in the Methods section.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Species used to benchmark MetaEuk</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Species</th><th>Group</th><th>Genome size (Mbp)</th><th># scaffolds</th><th># annotated proteins</th><th>% multi-exon proteins</th><th>GC%</th><th>MetaEuk run time against UniRef90</th></tr></thead><tbody><tr><td><italic>Schizosaccharomyces pombe</italic></td><td>Fungi</td><td>12.59</td><td>4</td><td>5132</td><td>47</td><td>36</td><td>35 m</td></tr><tr><td><italic>Acanthamoeba castellanii str. Neff</italic></td><td>Amoebozoa</td><td>42.02</td><td>384</td><td>14,974</td><td>91</td><td>57.8</td><td>59 m</td></tr><tr><td><italic>Phytomonas sp. isolate EM1</italic></td><td>Excavata</td><td>17.78</td><td>138</td><td>6381</td><td>0</td><td>48</td><td>37 m</td></tr><tr><td><italic>Babesia bigemina</italic></td><td>Alveolates</td><td>13.84</td><td>483</td><td>5079</td><td>54</td><td>50.6</td><td>35 m</td></tr><tr><td>Nucleomorph of <italic>Lotharella oceanica</italic></td><td>Rhizaria</td><td>0.68</td><td>4</td><td>668</td><td>39</td><td>32.8</td><td>24 m</td></tr><tr><td><italic>Phaeodactylum tricornutum</italic></td><td>Stramenopiles</td><td>27.45</td><td>88</td><td>10,408</td><td>46</td><td>48.8</td><td>51 m</td></tr><tr><td><italic>Aspergillus nidulans</italic></td><td>Eurotiomycetes</td><td>30.28</td><td>91</td><td>9556</td><td>88</td><td>50.3</td><td>52 m</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Sensitivity at evolutionary distance</title>
      <p id="Par15">Sequences from major eukaryotic clades, such as Rhizaria, Stramenopiles, and Dinoflagellata are poorly represented in public protein databases, despite their high abundance in the environment [<xref ref-type="bibr" rid="CR17">17</xref>]. We therefore measured the ability of MetaEuk to identify homologous protein-coding genes in organisms, which have distant evolutionary relatives in the reference database, as would be the case in a typical metagenomic analysis. To that end, for each annotated organism, we considered five sets of MetaEuk predictions. The first is the base set, which consisted of all predictions. Since we worked with annotated species, their proteins are well represented in UniRef90. The base set therefore reflects ideal conditions, in which the queried organisms are close to the reference database. The other four sets reflect an increasing evolutionary distance and were generated by excluding MetaEuk gene calls whose Smith-Waterman alignment (computed using MMseqs2) to their UniRef90 target had more than 90%, 80%, 60%, or 40% sequence identity. We measured sensitivity as the fraction of annotated proteins from the query genome to which a MetaEuk prediction was mapped (see Methods). For all organisms, the sensitivity of the base set of predictions was at least 92%, and sensitivity decreased with the sequence identity threshold (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). However, even at low thresholds (40–60%), a significant fraction of the annotated proteins could be discovered.
<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>MetaEuk evaluation on benchmark.</bold> MetaEuk predictions were mapped to annotated proteins. <bold>a</bold> Conditions of increasing evolutionary divergence were simulated by excluding gene calls based on their sequence identity to their target. Sensitivity is the fraction of annotated proteins from the query genome to which a MetaEuk prediction was mapped. <bold>b</bold> Fraction of exons covered by MetaEuk (color saturation). The number of MetaEuk predictions is indicated on top of each bar. <bold>c</bold> In an annotation-dependent precision estimation, MetaEuk predictions that mapped to an annotated protein were considered as “true” and the rest as “false.” These sets of predictions are well separated by their <italic>E</italic>-values, as indicated by the high AUC-PR values. <bold>d</bold> Fraction of annotated protein-coding genes that were split by MetaEuk into two (dark grey) or three (black) different predictions. <bold>e</bold> Comparison of the <italic>E</italic>-values computed by MetaEuk and by the Smith-Waterman algorithm for <italic>A. castellani</italic> proteins. The Spearman rho values indicate high correlation for <italic>A. castellani</italic> and for the other organisms (Supp. Figure <xref rid="MOESM1" ref-type="media">S3A</xref>)</p></caption><graphic xlink:href="40168_2020_808_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Annotated exon coverage</title>
      <p id="Par16">We next assessed MetaEuk’s performance at the level of individual exons. For each MetaEuk prediction from the base set and its mapped annotated protein, we computed the proportion of annotated exons that were covered by the prediction (see Methods). Overall, the majority of predictions covered the majority of exons and, as expected, the fraction of predictions that cover all annotated exons decreases with the number of exons in the annotated protein (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). For all organisms, most (77–91%) annotated exons were covered by MetaEuk predictions. In addition, we found that the fraction of multi-exon MetaEuk predictions was similar to that presented in Table <xref rid="Tab1" ref-type="table">1</xref> (average difference 10%, Supp. Figure <xref rid="MOESM1" ref-type="media">S1A</xref>) and that single-exon predictions tended to have longer exons than multi-exon predictions (Supp. Figure <xref rid="MOESM1" ref-type="media">S1B</xref>). An additional measure of completeness of MetaEuk predictions is the coverage of the target UniRef90 protein based on which the prediction was made. We therefore aligned each predicted MetaEuk protein to its target and found that on average, &gt;83% of predictions covered &gt;90% of their target (Supp. Figure <xref rid="MOESM1" ref-type="media">S2</xref>).</p>
    </sec>
    <sec id="Sec7">
      <title>Precision</title>
      <p id="Par17">MetaEuk predictions that were mapped to annotated proteins were considered as true predictions. We first measured the precision of MetaEuk by using the NCBI annotations as gold standard and regarded all predictions in the base set that were not mapped to an annotated protein (8–35%, Supp. Figure <xref rid="MOESM1" ref-type="media">S2</xref>) as false. We computed precision-recall curves by treating the predictions’ <italic>E</italic>-values as a classifying score. We found good separation (AUC-PR &gt; 0.7 in all cases) between predictions that mapped to annotated proteins and the rest (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). However, a prediction that does not map to a known protein is not necessarily false as it might reflect an unannotated protein. We found that about 40% of the unmapped predictions overlap a protein-coding gene on the opposite strand or are on scaffolds that had no annotation at all (Supp. Figure <xref rid="MOESM1" ref-type="media">S2</xref>), suggestive of post hoc exclusion criteria in the NCBI annotation procedure. For this reason, we also measured the precision of MetaEuk independently of external annotations by using an inverted sequence null model. For this annotation-free approach, we ran standard MetaEuk on the inverted sequences of the six frame-translated putative fragments. Each prediction based on these inverted sequences can therefore be considered a false positive. We applied the same <italic>E</italic>-value cutoff for reporting predictions based on the original sequence data and based on the inverted set. For all organisms, the total number of false positive predictions produced by this approach was low (0–12), indicating very high precision (&gt; 99.9%).</p>
    </sec>
    <sec id="Sec8">
      <title>Redundancy reduction</title>
      <p id="Par18">MetaEuk’s redundancy reduction procedure divides gene calls into disjoint clusters and retains a representative call as gene prediction for each cluster (see Methods). This reduces the number of potential protein-coding genes that need to be inspected. For example, for <italic>S. pombe</italic>, MetaEuk produced over 1,100,000 calls that were reduced to a total of 5564 predictions in the base set. A full reduction of redundancy is achieved when no two predictions correspond to same protein-coding gene. We thus identified cases in which two or more MetaEuk predictions were mapped to the same protein-coding gene. We found that for all benchmark organisms, redundancy is greatly reduced, as more than 99% of the annotated protein-coding genes in the benchmark scaffolds are only predicted once (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>).</p>
    </sec>
    <sec id="Sec9">
      <title>Statistical scores</title>
      <p id="Par19">For each prediction, MetaEuk computes a bit-score between the set of translated and joined putative exons and the target protein. Based on this bit-score and the size of the reference database, an <italic>E</italic>-value is computed (see Methods). We evaluated MetaEuk’s bit-scores and <italic>E</italic>-values by comparing them to those computed for each predicted protein and its target by the Smith-Waterman algorithm. Since MetaEuk penalizes missing and overlapping amino acids when joining putative exons, we expect the MetaEuk bit-score to be more conservative than the direct Smith-Waterman alignment bit-score. We found very high levels of agreement between the MetaEuk statistics and the Smith-Waterman statistics (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>, Supp. Figure <xref rid="MOESM1" ref-type="media">S3</xref>). This suggests a straightforward statistical interpretation of MetaEuk prediction scores.</p>
    </sec>
    <sec id="Sec10">
      <title>Effect of contig length</title>
      <p id="Par20">Assembling metagenomic reads often produces contigs that are much shorter than the scaffolds of the organisms we used for benchmarking MetaEuk (Table <xref rid="Tab1" ref-type="table">1</xref>). We thus aimed to assess the effect of analyzing shorter genomic stretches by artificially dividing each of the scaffolds from Table <xref rid="Tab1" ref-type="table">1</xref> into shorter contigs following a typical length distribution with a minimum of 5 kbp in length and a median of 6.8 kbp (see Methods). Any protein-coding gene that spans more than one contig is expected to result in incomplete MetaEuk predictions. Indeed, while the sensitivity measured by the mapping to annotated proteins remained similar to that recorded on the original scaffolds (Supp. Figure <xref rid="MOESM1" ref-type="media">S4A</xref>), we found that more predictions were partial and covered fewer annotated exons (Supp. Figure <xref rid="MOESM1" ref-type="media">S4B</xref>) as well as an increase of up to 15% in annotated genes being split into more than one MetaEuk prediction (Supp. Figure <xref rid="MOESM1" ref-type="media">S4D</xref>).</p>
    </sec>
    <sec id="Sec11">
      <title>Eukaryotic protein-coding genes in the ocean</title>
      <p id="Par21">To date, little is known about the biological activities of eukaryotes in the oceans [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. We aimed to use MetaEuk to discover eukaryotic protein-coding genes in the Tara Oceans metagenomic dataset [<xref ref-type="bibr" rid="CR20">20</xref>]. We first used MEGAHIT [<xref ref-type="bibr" rid="CR38">38</xref>] to assemble all 912 samples of this project. We retained 1,351,204 contigs of at least 5 kbp in length that were classified as potentially eukaryotic by EukRep [<xref ref-type="bibr" rid="CR27">27</xref>]. We next constructed a comprehensive set of reference proteins by uniting over 21,000,000 representative sequences of the Uniclust50 database [<xref ref-type="bibr" rid="CR39">39</xref>], the MERC dataset of over 292,000,000 protein sequence fragments assembled from eukaryotic Tara Oceans metatranscriptomic datasets [<xref ref-type="bibr" rid="CR40">40</xref>], and over 18,500,000 protein sequences of MMETSP, the Marine Microbial Eukaryotic Transcriptome Sequencing Project [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR41">41</xref>]. We clustered the joint dataset of 331,913,793 proteins using the combined Linclust/MMseqs2 four-step cascaded clustering workflow [<xref ref-type="bibr" rid="CR42">42</xref>] with a minimal sequence identity of 20% and high sensitivity (-s 7). This resulted in 87,984,812 clusters, most of which (&gt; 97%) contained proteins from a single reference dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). For each cluster, a multiple sequence alignment was generated, based on which a sequence profile was computed.
<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>Reference profiles composition.</bold> Proteins from three datasets: MERC (292 million), MMETSP (18.5 million), and Uniclust50 (21 million) were clustered into ~ 88 million clusters. Most clusters contained proteins from a single reference dataset. The profiles computed based on these clusters served as the reference database for the MetaEuk run on the Tara Oceans contigs</p></caption><graphic xlink:href="40168_2020_808_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par22">MetaEuk’s run using this reference database took 8 days on ten 2x8-core servers and resulted in 12,111,301 predictions with no same-strand overlaps in 1,287,197 of the Tara Oceans contigs. Due to sequence similarities among the assembled contigs, some of these proteins are identical to each other, leaving a total of 6,158,526 unique proteins. We examined the distribution of predictions per contig, the number of putative exons in each prediction and the length of putative exons in single-exon and multi-exon predictions. We found that the number of predictions increases as a function of the contig length (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>), about 24% of predictions had more than one putative exon (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>) and multi-exon predictions tend to have shorter putative exons than single-exon predictions (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). We analyzed the contribution of each reference dataset to the profiles based on which the MetaEuk predictions were made. MERC, MMETSP, and Uniclust50 contributed 77.4%, 5.7%, and 4.3% of the predictions, respectively. The rest of the predictions were based on mixed-dataset clusters (Supp. Figure <xref rid="MOESM1" ref-type="media">S5</xref>). We then used MMseqs2 to query the MetaEuk predicted proteins against their targets. Over 33% of the MetaEuk predictions have less than 60% sequence identity to their MERC, MMETSP, or Uniclust50 target (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). Finally, we found that 70% of the MetaEuk predicted proteins covered at least 80% of their reference target (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>MetaEuk predictions on Tara Oceans contigs.</bold> MetaEuk was run on over 1.3 million contigs assembled from Tara Oceans metagenomic reads against a reference database of ~88 million protein profiles. <bold>a</bold> The number of MetaEuk predictions per contig increases with its length. Horizontal lines mark contig length quartiles. <bold>b</bold> Most (76%) MetaEuk predictions had a single putative exon. The absolute number of predictions is indicated above each bar. <bold>c</bold> Single-exon predictions tend to have longer putative exons than multi-exon predictions</p></caption><graphic xlink:href="40168_2020_808_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p><bold>MetaEuk predictions compared to the reference datasets.</bold> MetaEuk predicted proteins were queried against the representative sequence of their target reference cluster. <bold>a</bold> About one third of the predicted MetaEuk proteins had less than 60% sequence identity to their target. <bold>b</bold> Targets are well covered by MetaEuk predicted proteins</p></caption><graphic xlink:href="40168_2020_808_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par23">We next explored the taxonomic composition of the MetaEuk proteins. Since the majority (77%) of MetaEuk predictions were based on homologies to the MERC dataset, for which no taxonomic annotation is available, we queried the MetaEuk marine protein collection against the Uniclust90 dataset [<xref ref-type="bibr" rid="CR39">39</xref>] and the MMETSP dataset, both annotated using NCBI taxonomy (see Methods). We found that 63% of predictions based on homologies to the MERC dataset did not match any protein in either of the reference datasets, which means ~49% (63% of 77%) of the MetaEuk marine protein collection could not be assigned any taxonomy. This is in agreement with 52% of unassigned unigenes assembled from Tara Oceans metatranscriptomics [<xref ref-type="bibr" rid="CR20">20</xref>]. We next assigned taxonomic labels to each assembled contig by conferring the taxonomic label with the best <italic>E</italic>-value of all MetaEuk predictions in the contig. This allowed us to annotate 92% of the contigs for which MetaEuk produced predictions (87% of all input contigs). We found that 82% of the contigs were assigned to the domain Eukaryota and 9% to non-eukaryotes, mostly bacteria (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). We then examined the assigned eukaryotic supergroups below the domain level. About 12% of the eukaryotic contigs could not be assigned a supergroup. Among the most abundant eukaryotic supergroups are Metazoa and Chlorophyta (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>).
<fig id="Fig6"><label>Fig. 6</label><caption><p><bold>Taxonomy of Tara Oceans contigs with MetaEuk predictions.</bold> The best-scoring taxonomic label of all predictions on each contig was conferred to the contig. Contigs were divided into four categories according to their number of MetaEuk predictions. Over 82% of the contigs were assigned to the domain Eukaryota. <bold>a</bold> The proportion of unassigned contigs decreases with the number of MetaEuk predictions on the contig. The fraction of eukaryotic contigs out of all assigned contigs is about 90% in all four categories. <bold>b</bold> Eukaryotic taxonomic labels below the domain level</p></caption><graphic xlink:href="40168_2020_808_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par24">The high fraction of unassignable predictions (49%) prompted us to seek an additional way to assess the diversity of the MetaEuk marine proteins. We thus collected orthologous sequences of the large subunits of RNA polymerases, which are universal phylogenetic markers [<xref ref-type="bibr" rid="CR43">43</xref>] from 985 organisms for which we had taxonomic information, as well as 1076 MetaEuk proteins, which consisted of all five Pfam domains of the large subunit in the right order (see Methods). We aligned these sequences using MAFFT [<xref ref-type="bibr" rid="CR44">44</xref>] and constructed the maximum-likelihood phylogeny using RAxML [<xref ref-type="bibr" rid="CR45">45</xref>]. The aim of this analysis was to delineate the diversity of eukaryotic taxa of the MetaEuk marine protein collection and not to resolve the exact phylogenetic relationships among them. As can be seen in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, MetaEuk proteins offer major lineage expansions in under-sampled eukaryotic supergroups. Importantly, the strict ortholog collection procedure performed for this analysis results in a conservative estimate of the diversity level of the MetaEuk marine proteins collection.
<fig id="Fig7"><label>Fig. 7</label><caption><p><bold>Diversity of MetaEuk marine eukaryotic proteins.</bold> Homologous sequences of the large subunits of RNA polymerases of 985 species as well as 1076 MetaEuk marine proteins were collected and a maximum-likelihood tree was computed based on their alignment. MetaEuk sequences (black) expand major eukaryotic lineages, including deeply rooted supergroups (denoted with star)</p></caption><graphic xlink:href="40168_2020_808_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par25">We presented MetaEuk, an algorithm designed for large-scale analysis of eukaryotic metagenomic data. We demonstrated its utility for discovering proteins from highly diverged eukaryotic groups by analyzing assemblies of a huge set of 912 marine metagenomics samples. MetaEuk makes no assumption concerning splice site signatures and does not require a preceding binning procedure, which renders it suitable for the analysis of contigs from a mixture of highly diverged organisms. In order to achieve this, MetaEuk considers all possible putative protein-coding fragments from each input contig. Applying the spliced alignment dynamic programming procedure to recover the optimal set of putative exons directly on these fragments would result in a run time complexity per contig that is quadratic in the number of its fragments times the number of targets in the reference database. This is not feasible for metagenomics, as the number of fragments can be very high (e.g., from 1,351,204 Tara Oceans contigs, 152,519,258 fragments were extracted) and the reference database should be as comprehensive as possible (in this study, we used more than 87,000,000 protein profiles). To circumvent this limitation, MetaEuk takes advantage of the ultra-fast MMseqs2 search algorithm, which allows it to find putative exons matching a reference protein sequence with sufficient significance (in this study, a lenient <italic>E</italic>-value of 100). MetaEuk does not require significance at the exon level as it can combine sub-significant single exon matches to highly significant multi-exon matches. For example, two putative exons each with an <italic>E</italic>-value of 10 (corresponding to a bit-score of 25–40 in this study), are not individually significant but the sum of their bit-scores of at least 50 corresponds to a significant <italic>E</italic>-value of 10<sup>-5</sup>.</p>
    <p id="Par26">MetaEuk is not designed to recover accurate splice sites, but rather to identify the protein-coding parts within exons. Indeed, we showed that MetaEuk predictions on the benchmark covered the majority (77–91%) of exons in annotated proteins. Since MetaEuk relies on local alignment at the amino acid level, it could potentially report pseudogenes, which still bear sequence similarity to reference proteins. However, we found that the majority of benchmark predictions (65–92%) mapped to NCBI annotated protein-coding genes, while the rest could be well separated from those that mapped by their <italic>E</italic>-values (AUC-PR &gt; 0.7). Furthermore, unmapped predictions can reflect a missing annotation or post hoc exclusion criteria (e.g., removal of annotations that overlap a better scoring one on the opposite strand). We therefore measured precision independently of annotations by running standard MetaEuk on the inverted sequences of the putative protein fragments extracted from the contigs. By using this annotation-free approach, we showed that MetaEuk’s precision was greater than 99.9% for all benchmark organisms. Put together, MetaEuk’s strength is in describing the protein-coding repertoire of versatile environments rather than in constructing statistical models of exon-intron transitions.</p>
    <p id="Par27">The Tara Oceans contigs analyzed in this study were assembled from Illumina HiSeq 2000 short reads. High population diversity, repeat regions, and sequencing errors are among the major factors contributing to the computational challenge associated with metagenomic assembly (reviewed by [<xref ref-type="bibr" rid="CR46">46</xref>]). These factors reduce the quality of the assembly as reflected, for example, in shorter contig lengths, chimeric contigs and contigs containing strand inversions. These in turn, directly and negatively impact MetaEuk. Shorter contigs limit its ability to discover multi-exon protein-coding genes as it searches for them within a contig. In addition, predictions on contig edges can be partial, which is more likely to happen in a highly fragmented assembly. By dividing each of the benchmark scaffolds to contigs whose lengths were drawn at random based on the length distribution of the Tara Ocean contigs, we showed that while MetaEuk retains its overall sensitivity to detect protein-coding genes even under conditions of increasing evolutionary distance between the query organism and the target reference database, the completeness of its predictions is reduced. We thus expect MetaEuk to benefit from future improvements in assembly algorithms, higher sequencing coverage, and long-read sequencing technology [<xref ref-type="bibr" rid="CR47">47</xref>–<xref ref-type="bibr" rid="CR50">50</xref>].</p>
    <p id="Par28">In addition to developing MetaEuk, we generated two useful resources for the analysis of eukaryotes as part of this study. The first is the comprehensive protein profile database, which was computed using protein sequences from three sources: MERC, MMETSP, and Uniclust50. With ~88 million records, it is the largest profile database focused on eukaryotes to date. Since MERC was assembled from the Tara Oceans metatranscriptomic data, we expected it to be a valuable resource for discovering protein-coding genes in the same environment. Indeed, we found that the majority of MetaEuk predictions (77%) were based on MERC protein profiles. Furthermore, the high fraction of MERC-based predictions that could not be assigned a taxonomic label (63%) demonstrates the uniqueness of this resource.</p>
    <p id="Par29">The second resource is the MetaEuk marine protein collection, which is available on our search web server (<ext-link ext-link-type="uri" xlink:href="https://search.mmseqs.com">https://search.mmseqs.com</ext-link>) for easy investigation [<xref ref-type="bibr" rid="CR51">51</xref>]. Using a phylogenetic marker protein, we showed that this collection contains proteins spanning major eukaryotic lineages, including supergroups with very few available genomes. Over 33% of these proteins have less than 60% sequence identity to the representative reference proteins that were used to predict them, indicating their diversity with respect to the reference database. Unlike the MERC and MMETSP proteins, MetaEuk proteins are predicted in the context of genomic contigs. This allows us to learn of the number of putative exons that code for them as well as to examine them together with other proteins on the same contig. The latter is useful for conferring taxonomic annotations to unlabeled predictions on the same contig as well as for detecting complex functional modules, by searching for co-occurrences of the module’s proteins on the same contig.</p>
    <p id="Par30">As was demonstrated by the challenge of assigning taxonomy to highly diverged eukaryotic proteins, the paucity of eukaryotic sequences in reference databases is currently a major limitation in the study of eukaryotes. Thus, we expect the resources produced in this study and further analyses of eukaryotic metagenomic data using MetaEuk to produce a more comprehensive description of the tree of life [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR54">54</xref>].</p>
  </sec>
  <sec id="Sec13">
    <title>Conclusions</title>
    <p id="Par31">MetaEuk is a sensitive reference-based algorithm for large-scale discovery of protein-coding genes in eukaryotic metagenomic data. Applying MetaEuk to large metagenomic datasets is expected to significantly enrich our databases with highly diverged eukaryotic protein-coding genes. By adding sequences from under-sampled eukaryotic lineages, we can improve sequence homology searches, protein profile computation and thereby homology-based function annotation, template-based, and even de novo protein structure prediction [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. These, in turn will allow for further exploration of eukaryotic activity in various environments [<xref ref-type="bibr" rid="CR57">57</xref>].</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>MetaEuk algorithm</title>
      <sec id="Sec16">
        <title>Code and resources availability</title>
        <p id="Par32">The MetaEuk source code, compilation instructions, and a brief user guide are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/metaeuk">https://github.com/soedinglab/metaeuk</ext-link> under the GNU General Public License v3.0. The resources produced during this study are available from <ext-link ext-link-type="uri" xlink:href="http://wwwuser.gwdg.de/~compbiol/metaeuk/">http://wwwuser.gwdg.de/~compbiol/metaeuk/</ext-link>.</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Putative exons compatibility</title>
      <p id="Par33">In the first two stages of the MetaEuk algorithm, all possibly coding protein fragments are translated from the input contigs. We scan each contig in six frames and extract the fragments between stop codons. These fragments are queried against the reference target database using MMseqs2. A set of fragments from the same contig and strand that have local matches to the same specific target <italic>T</italic> define a set of putative exons. We say two putative exons <italic>P</italic><sub><italic>i</italic></sub> and <italic>P</italic><sub><italic>j</italic></sub> from the same set are compatible with each other if they can be joined together to a multi-exon protein.</p>
      <p id="Par34">Each <italic>P</italic><sub><italic>i</italic></sub> is associated with four coordinates: the amino-acid position on <italic>T</italic> from which the match to <italic>P</italic><sub><italic>i</italic></sub> starts (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{ST}} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>ST</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq1.gif"/></alternatives></inline-formula>) and ends (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{ET}} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>ET</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq2.gif"/></alternatives></inline-formula>); the nucleotide position on the contig from which the translation of <italic>P</italic><sub><italic>i</italic></sub> starts (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{SC}} $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>SC</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq3.gif"/></alternatives></inline-formula>) and ends (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{EC}} $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>EC</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq4.gif"/></alternatives></inline-formula>). We require a match of at least 10 amino acids (a minimal exon length). We consider putative exons <italic>P</italic><sub><italic>i</italic></sub> and <italic>P</italic><sub><italic>j</italic></sub> with <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{ST}}&lt;{P}_j^{\mathrm{ST}} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>ST</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mi>ST</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq5.gif"/></alternatives></inline-formula> as compatible on the plus strand if:
<list list-type="order"><list-item><p id="Par35">their order on the contig is the same as on the target: <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{SC}}&lt;{P}_j^{\mathrm{SC}} $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>SC</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mi>SC</mml:mi></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq6.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par36">the distance between them on the contig is at least the length of a minimal intron but not more than the length of a maximal intron: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 15\le \left({P}_j^{\mathrm{SC}}-{P}_i^{\mathrm{EC}}\right)\le \mathrm{10,000} $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:mn>15</mml:mn><mml:mo>≤</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mi>SC</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>EC</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>10,000</mml:mn></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq7.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par37">their matches to <italic>T</italic> should not overlap. In practice, we allow for a short overlap to account for alignment errors: <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({P}_j^{\mathrm{ST}}-{P}_i^{\mathrm{ET}}\right)\ge -10 $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mi>ST</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>ET</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq8.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
      <p id="Par38">In case <italic>P</italic><sub><italic>i</italic></sub> and <italic>P</italic><sub><italic>j</italic></sub> are on the negative strand, we modify conditions (1) and (2) accordingly:
<list list-type="order"><list-item><p id="Par39"><disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{SC}}&gt;{P}_j^{\mathrm{SC}}; $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>SC</mml:mi></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mi>SC</mml:mi></mml:msubsup><mml:mo>;</mml:mo></mml:math><graphic xlink:href="40168_2020_808_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par40"><disp-formula id="Equb"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 15\le \left({P}_i^{\mathrm{EC}}-{\mathrm{P}}_j^{\mathrm{SC}}\right)\le \mathrm{10,000}. $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mn>15</mml:mn><mml:mo>≤</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>EC</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="normal">P</mml:mi><mml:mi>j</mml:mi><mml:mi>SC</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>10,000</mml:mn><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2020_808_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par41">Since the adjustment of conditions to the minus strand is straightforward, in the interest of brevity, we focus solely on the plus strand in the following text.</p>
      <p id="Par42">We say a set of <italic>k</italic> &gt; 1 putative exons is compatible if, when ordered by their <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_i^{\mathrm{ST}} $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>ST</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq9.gif"/></alternatives></inline-formula> values, each pair of consecutive putative exons is compatible. (A set of a single exon is always compatible.)</p>
    </sec>
    <sec id="Sec18">
      <title>Bit-score and <italic>E</italic>-value computation</title>
      <p id="Par43">A set of <italic>k</italic> compatible putative exons defines a pairwise protein alignment to the target <italic>T</italic>. This alignment is the concatenation of the ordered local alignments of all putative exons to <italic>T</italic>. Between each consecutive putative pair of exons <italic>P</italic><sub><italic>i</italic></sub> and <italic>P</italic><sub><italic>i</italic>+1</sub> there might be unmatched amino acids in <italic>T</italic> or there might be a short overlap of their matches to <italic>T</italic>. We denote the number of unmatched amino acids between <italic>P</italic><sub><italic>i</italic></sub> and <italic>P</italic><sub><italic>i</italic>+1</sub> as <italic>l</italic><sub><italic>i</italic></sub>, which can take a negative value in case of an overlap. MetaEuk computes the bit-score of the concatenated pairwise alignment <italic>S</italic>(<italic>P</italic><sub>set</sub>, <italic>T</italic>) by summing the individual Karlin-Altschul [<xref ref-type="bibr" rid="CR58">58</xref>] bit-scores <italic>S</italic>(<italic>P</italic><sub><italic>i</italic></sub>, <italic>T</italic>) of the putative exons to <italic>T</italic> and penalizing for unmatched or overlapping amino acids in <italic>T</italic> as follows:
<list list-type="simple"><list-item><label>(3)</label><p id="Par44"><disp-formula id="Equc"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ S\left({P}_{\mathrm{set}},T\right)=\sum \limits_{i=1}^kS\left({P}_i,T\right)+\sum \limits_{i=1}^{k-1}C\left({l}_i\right)+{\log}_2\left(k!\right) $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mi>set</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="40168_2020_808_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par45">where the penalty function is <italic>C</italic>(<italic>l</italic><sub><italic>i</italic></sub>) =  − |<italic>l</italic><sub><italic>i</italic></sub>| for <italic>l</italic><sub><italic>i</italic></sub> ≠ 1 and 0 if <italic>l</italic><sub><italic>i</italic></sub> = 1. The last term rewards the correct ordering of the <italic>k</italic> exons.</p>
      <p id="Par46">An <italic>E</italic>-value is the expected number of matches above a given bit-score threshold. Since for each contig, at most one gene call is reported per strand and target in the reference database, the <italic>E</italic>-value takes into account the number of amino acids in the reference database <italic>D</italic> and the search on two strands:
<list list-type="simple"><list-item><label>(4)</label><p id="Par47"><disp-formula id="Equd"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E-\mathrm{Value}\left({P}_{\mathrm{set}},T\right)=2\times D\times {2}^{-S\left({P}_{\mathrm{set}},T\right)} $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mtext>Value</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mi>set</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mi>set</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mfenced></mml:mrow></mml:msup></mml:math><graphic xlink:href="40168_2020_808_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
    </sec>
    <sec id="Sec19">
      <title>Dynamic programming</title>
      <p id="Par48">Given a set of <italic>n</italic> putative exons and their target, MetaEuk finds the set of compatible exons with the highest combined bit-score. First, all putative exons are sorted by their start on the contig, such that <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_1^{\mathrm{SC}}\le \dots \le {P}_n^{\mathrm{SC}} $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mi>SC</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:mo>…</mml:mo><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mi>SC</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq10.gif"/></alternatives></inline-formula>. The dynamic programming computation iteratively computes vectors <italic>S</italic>, <italic>k</italic>, and <italic>b</italic> from their first entry 1 to their <italic>n</italic><sup>th</sup>. The entry <italic>S</italic><sub><italic>i</italic></sub> holds the score of the best exon alignment ending in exon <italic>i</italic> and <italic>k</italic><sub><italic>i</italic></sub> holds the number of exons in that set. Once the maximum score is found, the exon alignment is back traced using <italic>b</italic>, in which entry <italic>b</italic><sub><italic>i</italic></sub> holds the index of the aligned exon preceding exon <italic>i</italic> (0 if <italic>i</italic> is the first aligned exon). Using the following values:
<list list-type="simple"><list-item><label>(5)</label><p id="Par49"><disp-formula id="Eque"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_0=0;{k}_0=0;{b}_0=0 $$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><graphic xlink:href="40168_2020_808_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par50">all putative exons <italic>P</italic><sub><italic>j</italic></sub> are examined according to their order and the score vector is updated:
<list list-type="simple"><list-item><label>(6)</label><p id="Par51"><disp-formula id="Equf"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_j=\underset{i}{\max}\left({S}_i+S\left({P}_j,T\right)+C\left({l}_j^i\right)+{\log}_2\left({k}_i+1\right)|0\le i&lt;j,i\ \mathrm{compatible}\ \mathrm{with}\ j\right) $$\end{document}</tex-math><mml:math id="M32" display="block"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>max</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>l</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.25em"/><mml:mtext>compatible with</mml:mtext><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="40168_2020_808_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par52"><italic>k</italic><sub><italic>j</italic></sub> and <italic>b</italic><sub><italic>j</italic></sub> are updated accordingly. The terms log<sub>2</sub>(<italic>k</italic><sub><italic>i</italic></sub> + 1) add up to the score contribution <inline-formula id="IEq11"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \sum \limits_{i=1}^k{\log}_2(i)={\log}_2\left(k!\right) $$\end{document}</tex-math><mml:math id="M34" display="inline"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq11.gif"/></alternatives></inline-formula> and the transition 0 to <italic>j</italic> is defined as compatible with <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left({l}_j^0\right)=0 $$\end{document}</tex-math><mml:math id="M36" display="inline"><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>l</mml:mi><mml:mi>j</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="40168_2020_808_Article_IEq12.gif"/></alternatives></inline-formula> for all <italic>j</italic>. The optimal exon set is then recovered by tracing back from the exon with the maximal score. This dynamic programming procedure has time complexity of <italic>O</italic>(<italic>n</italic><sup>2</sup>).</p>
    </sec>
    <sec id="Sec20">
      <title>Clustering gene calls to reduce redundancy</title>
      <p id="Par53">MetaEuk assigns a unique identifier to each extracted putative protein fragment (stage 1 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). A MetaEuk exon refers to the part of a fragment that matched some target <italic>T</italic> (stage 2 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, tinted background) and has the same identifier as the fragment. Two calls that have the same exon identifier in their exon set are said to share an exon. MetaEuk reduces redundancy by clustering calls that share an exon (stage 4 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) and selecting a representative call as the gene prediction of each cluster. To that end, all <italic>N</italic> MetaEuk calls from the same contig and strand combination are ordered according to the contig start position of their first exon. Since this order can include equalities, they are sub-ordered by decreasing number of exons. The first cluster is defined by the first call, which serves as its tentative representative. Let <italic>m</italic> be the last contig position of the last exon of this representative. Each of the following calls is examined so long as its start position is smaller than <italic>m</italic> (i.e., it overlaps the representative on the contig). If that call shares an exon with the representative, it is assigned to its cluster. In the next iteration, the first unassigned call serves as representative for a new cluster and the following calls are examined in a similar manner, adding unassigned calls to the cluster in case they share an exon with the representative. The clustering ends with the assignment of all calls. At this stage, the final prediction is the call with the highest score in each cluster. This greedy approach has time complexity of <italic>O</italic>(<italic>N</italic> × log(<italic>N</italic>) + <italic>N</italic> × <italic>A</italic>), where <italic>A</italic> is the average number of calls that overlap each representative on the contig. Since in practice, <italic>A</italic> ≪ <italic>N</italic>, the expected time complexity is <italic>O</italic>(<italic>N</italic> × log(<italic>N</italic>)).</p>
    </sec>
    <sec id="Sec21">
      <title>Resolving same-strand overlapping predictions</title>
      <p id="Par54">After the redundancy reduction step, MetaEuk sorts all predictions on the same contig and strand according to their <italic>E-value</italic> . It examines the sorted list and retains predictions only if they do not overlap any preceding predictions on the list.</p>
    </sec>
    <sec id="Sec22">
      <title>Benchmark datasets</title>
      <p id="Par55">The UniRef90 database was obtained on March 2018. The annotated information of <italic>Schizosaccharomyces pombe</italic> (GCA_000002945.2), <italic>Acanthamoeba castellanii str. Neff</italic> (GCA_000313135.1), <italic>Babesia bigemina</italic> (GCA_000981445.1), <italic>Phytomonas sp. isolate</italic> EM1 (GCA_000582765.1), Nocleomorph of <italic>Lotharella oceanica</italic> (GCA_000698435.2), <italic>Phaeodactylum tricornutum</italic> (GCA_000150955.2), and <italic>Aspergillus nidulans</italic> (GCA_000149205.2) were downloaded from the NCBI genome assembly database (March–September 2018). This information included the genomic scaffolds, annotated protein sequences, and GFF3 files containing information about the locations of annotated proteins and other genomic elements. MetaEuk (Github commit 4714106, MMseqs2 submodule version ebb16f3) was run with the following parameters: -e 100 (a lenient maximal <italic>E</italic>-value of a putative exon against a target protein), --metaeuk-eval 0.0001 (a stricter maximal cutoff for the MetaEuk <italic>E-value</italic> after joining exons into a gene call), --metaeuk-tcov 0.6 (a minimal cutoff for the ratio between the MetaEuk protein and the target), and --min-length 20, requiring putative exon fragments of at least 20 codons and default MMseqs2 search parameters.</p>
    </sec>
    <sec id="Sec23">
      <title>Mapping benchmark predictions to annotated proteins</title>
      <p id="Par56">For each annotated protein, we listed the contig start and end coordinates of the coding part (CDS) of each of its exons. The lowest and highest of these coordinates were considered as the boundaries of the annotated protein, and the stretch between them as its “global” contig length. Similarly, we listed these coordinates and computed the boundaries and global contig length for each MetaEuk prediction. A MetaEuk prediction was globally mapped to an annotated protein if the overlap computed based on their boundaries was at least 80% of the global contig length of either of them and if, in addition, the alignment of their protein sequences mainly consisted of identical amino acids or gaps (i.e., less than 10% mismatches). These criteria allow mapping MetaEuk predictions to an annotated protein, even if they miss some of its exons. Next, we computed the exon level mapping for all globally mapped pairs of MetaEuk predictions and annotated proteins. To that end, we compared their lists of exon contig coordinates. If an exon predicted by MetaEuk covered at least 80% of the contig length of an annotated protein’s exon, we considered the annotated exon as “covered” by the MetaEuk prediction.</p>
    </sec>
    <sec id="Sec24">
      <title>Generating typical metagenomic contig lengths</title>
      <p id="Par57">In order to evaluate MetaEuk’s performance on contigs with a length distribution typical for assemblies from metagenomic samples, we recorded the lengths of the assembled contigs used for the analysis described in the “Tara Oceans dataset” section. The 1,351,204 contigs had a minimal length of 5002 bps, 1st quartile of 5661 bps, median of 6763 bps, 3rd quartile of 9020 bps, and a maximal length of 1,524,677 bps. We divided each annotated scaffold into contigs of lengths that were randomly sampled from these recorded lengths. This resulted in 1392, 5061, 1816, 2095, 80, 3153, and 3273 contigs for <italic>S. pombe</italic>, <italic>A. castellanii</italic>, <italic>Phytomonas sp. isolate</italic> EM1, nucleomorph of <italic>L. oceanica</italic>, <italic>P. tricornutum</italic>, and <italic>A. nidulans</italic>, respectively. MetaEuk was run on these contigs in the same way as on the original scaffolds. Since each of the new contigs corresponded to specific locations on the original scaffolds, we could carry out all benchmark assessments, which relied on mapping between MetaEuk predictions and annotated proteins.</p>
    </sec>
    <sec id="Sec25">
      <title>Tara Oceans dataset</title>
      <p id="Par58">The 912 metagenomic SRA experiments associated with accession number PRJEB4352 were downloaded from the SRA (August–September 2018). The reads of each experiment were trimmed to remove adapters and low quality sequences using trimmomatic-0.38 [<xref ref-type="bibr" rid="CR59">59</xref>] with parameters ILLUMINACLIP:TruSeq3-PE.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36 (SE for single-end samples). The resulting reads were then assembled with MEGAHIT [<xref ref-type="bibr" rid="CR38">38</xref>] with default parameters. Contigs of at least 5 kbp in length were classified as eukaryotic/non-eukaryotic using EukRep [<xref ref-type="bibr" rid="CR27">27</xref>], which is trained to be highly sensitive to detecting eukaryotic contigs. MetaEuk was run on the contigs classified as eukaryotic with parameters: -e 100, --metaeuk-eval 0.0001, --min-ungapped-score 35, --min-exon-aa 20, --metaeuk-tcov 0.6, --min-length 40, --slice-search (profile mode), and default MMseqs2 search parameters.</p>
    </sec>
    <sec id="Sec26">
      <title>Taxonomic assignment to predictions and contigs</title>
      <p id="Par59">We used MMseqs2 to query the MetaEuk marine protein collection against two taxonomically annotated datasets: Uniclust90 and the MMETSP protein dataset. Taxonomic labels associated with each of the MMETSP identifiers were downloaded from the NCBI website (BioProject PRJNA231566). We retained the hit with the highest bit-score value for each prediction if it had an <italic>E</italic>-value smaller than 10<sup>-5</sup>. In addition, we examined the sequence identity between the MetaEuk prediction and the target in order to determine the rank of the taxonomic assignment. Similarly to [<xref ref-type="bibr" rid="CR20">20</xref>], we used the following sequence identity cutoffs: &gt; 95% (species), &gt; 80% (genus), &gt; 65% (family), &gt; 50% (order), &gt; 40% (class), &gt; 30% (phylum), &gt; 20% (kingdom). Lower values were assigned at the domain level. The predictions on each contig were examined and the best-scoring one was used to confer taxonomic annotation to that contig. The assignment was visualized using Krona [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
    </sec>
    <sec id="Sec27">
      <title>Phylogenetic tree reconstruction</title>
      <p id="Par60">We constructed the tree using the large subunit of RNA polymerases as a universal marker. This subunit contains five RNA_pol_Rpb domains (Pfam IDs: pf04997, pf00623, pf04983, pf05000, pf04998). As detailed below, protein sequences that contained all five domains in the right order were obtained in January–November 2019 from six sources to construct the multiple sequence alignment and tree. The sources were as follows: (1) 75 sequences of the OrthoMCL [<xref ref-type="bibr" rid="CR61">61</xref>] group OG5_127924. The four-letter taxonomic codes of these sequences were converted to NCBI scientific names, based on information from the OrthoMCL website (<ext-link ext-link-type="uri" xlink:href="http://orthomcl.org/orthomcl/getDataSummary.do">http://orthomcl.org/orthomcl/getDataSummary.do</ext-link>). (2) 36 reviewed eukaryotic sequences were downloaded from UniProt [<xref ref-type="bibr" rid="CR36">36</xref>]. These were used to distinguish between eukaryotic RNA polymerase I (8 sequences), eukaryotic RNA polymerase II (16 sequences), and eukaryotic RNA polymerase III (12 sequences). We then ran an MMseqs2 profile search against the Pfam database (with parameters: -k 5, -s 7) with several query sets and retained results in which all five domains were matched in the right order with a maximal <italic>E</italic>-value of 0.0001. This allowed us to add the following sources: (3) 674 MMETSP proteins, (4) 100 archaeal proteins, and (5) 100 bacterial proteins. For datasets (4, 5), we first downloaded candidate proteins from the UniProt database by searching for the five domains and restricting taxonomy: archaea (bacteria). We then ran the previously described search procedure and randomly sampled exactly 100 proteins from each group that matched the criterion. (6) 1076 MetaEuk predictions. The joint set of 2061 sequences was aligned using MAFFT v7.407 [<xref ref-type="bibr" rid="CR44">44</xref>] and a phylogenetic tree was reconstructed by running RAxML v8 [<xref ref-type="bibr" rid="CR45">45</xref>]. Tree visualization was performed in iTOL [<xref ref-type="bibr" rid="CR62">62</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec28">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="40168_2020_808_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Supplementary Figure S1.</bold><bold>MetaEuk predictions by number of exons and exons length.</bold> MetaEuk was run on a benchmark of seven eukaryotic unicellular organisms. (A) The fraction of multi-exon MetaEuk predictions is similar to the fraction of annotated multi-exon proteins (Table <xref rid="Tab1" ref-type="table">1</xref>). (B) Single-exon predictions tend to have longer putative exons than multi-exon predictions. <bold>Supplementary Figure S2.</bold><bold> MetaEuk target coverage.</bold> The protein sequence of each MetaEuk prediction was aligned to the UniRef90 target, which was used to produce the prediction. The level of target coverage was measured while recording the mapping status of the MetaEuk prediction with respect to the annotations of the benchmark organism: mapped to an annotated protein (“prot”), overlap of at least ten nucleotides with an annotated protein on the opposite strand (“prot. on opp. strand”), prediction on a scaffold for which no NCBI annotations were given (“unannot. scaff.”) and all other predictions (“NA”). In all cases, most targets were highly covered by their MetaEuk prediction. <bold>Supplementary Figure S3.</bold><bold> MetaEuk E-values and bit-scores.</bold> MetaEuk was run on a benchmark of seven eukaryotic unicellular organisms. The (A) E-values and (B) bit-scores computed between each predicted protein and its target by MetaEuk were compared to those computed by the Smith-Waterman algorithm. The Spearman rho values indicate high correlation for all benchmark organisms. <bold>Supplementary Figure S4.</bold><bold> MetaEuk evaluation on typical metagenomic contig lengths.</bold> The annotated scaffolds of each of the organism in Table <xref rid="Tab1" ref-type="table">1</xref> were randomly divided into shorter contigs, following typical lengths of a metagenomics analysis (see Methods). Since each of the new contigs corresponds to locations on the original scaffolds, MetaEuk predictions on these contigs could be mapped to annotated proteins. (A) Conditions of increasing evolutionary divergence were simulated by excluding gene calls based on their sequence identity to their target. Sensitivity is the fraction of annotated proteins from the query genome to which a MetaEuk prediction was mapped. (B) Fraction of exons covered by MetaEuk (color saturation). The number of MetaEuk predictions is indicated on top of each bar. (C) In an annotation-dependent precision estimation MetaEuk predictions that mapped to an annotated protein were considered as “true” and the rest as “false”. (D) Fraction of annotated protein-coding genes that were split by MetaEuk into two (dark grey) or three (black) different predictions. (E) Comparison of the E-values computed by MetaEuk and by the Smith-Waterman algorithm for <italic>A. castellani</italic> proteins. <bold>Supplementary Figure S5.</bold><bold> Contribution of reference datasets to MetaEuk predictions.</bold> Profiles computed based on clusters of MERC, MMETSP and Uniclust50 proteins served as the reference database for the MetaEuk run on the Tara Oceans contigs. MERC, MMETSP and Uniclust50 contributed 77.4%, 5.7% and 4.3% of the predictions, respectively. The rest of the predictions were based on mixed-dataset clusters.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s40168-020-00808-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. David Burstein from Tel Aviv University for his helpful insights concerning the phylogenetic analyses and Dr. Christian Woehle from Christian-Albrechts University Kiel for his comments on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ELK and JS have designed the MetaEuk algorithm, benchmark, and biological application. ELK and MM have developed the algorithm. ELK has analyzed the benchmark and Tara Oceans data. ELK and MM have generated the figures. ELK, JS, and MM have drafted the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>ELK is a recipient of a FEBS long-term fellowship and is an EMBO non-stipendiary long-term fellow. This work was supported by the EU’s Horizon 2020 Framework Programme (Virus-X, grant 685778).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analyzed during the current study are available in <ext-link ext-link-type="uri" xlink:href="http://wwwuser.gwdg.de/~compbiol/metaeuk/">http://wwwuser.gwdg.de/~compbiol/metaeuk/</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par61">Not applicable</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par62">Not applicable</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par63">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lentendu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hübschmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buscot</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilhelm</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recovery of soil unicellular eukaryotes: an efficiency and activity analysis on the single cell level</article-title>
        <source>J Microbiol Methods.</source>
        <year>2013</year>
        <volume>95</volume>
        <fpage>463</fpage>
        <lpage>469</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2013.05.006</pub-id>
        <?supplied-pmid 23680233?>
        <pub-id pub-id-type="pmid">23680233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keeling</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>del Campo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Marine protists are not just big bacteria</article-title>
        <source>Curr Biol.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>R541</fpage>
        <lpage>R549</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2017.03.075</pub-id>
        <?supplied-pmid 28586691?>
        <pub-id pub-id-type="pmid">28586691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parfrey</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Microbial eukaryotes in the human microbiome: ecology, evolution, and future directions</article-title>
        <source>Front Microbiol.</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>153</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2011.00153</pub-id>
        <?supplied-pmid 21808637?>
        <pub-id pub-id-type="pmid">21808637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Parfrey LW, Walters WA, Lauber CL, Clemente JC, Berg-Lyons D, Teiling C, et al. Communities of microbial eukaryotes in the mammalian gut within the context of environmental eukaryotic diversity. Front Microbiol. 2014;5.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Massana</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Eukaryotic picoplankton in surface oceans</article-title>
        <source>Annu Rev Microbiol.</source>
        <year>2011</year>
        <volume>65</volume>
        <fpage>91</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-micro-090110-102903</pub-id>
        <?supplied-pmid 21639789?>
        <pub-id pub-id-type="pmid">21639789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flórez</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Biedermann</surname>
            <given-names>PHW</given-names>
          </name>
          <name>
            <surname>Engl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kaltenpoth</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Defensive symbioses of animals with prokaryotic and eukaryotic microorganisms</article-title>
        <source>Nat Prod Rep.</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>904</fpage>
        <lpage>936</lpage>
        <pub-id pub-id-type="doi">10.1039/C5NP00010F</pub-id>
        <?supplied-pmid 25891201?>
        <pub-id pub-id-type="pmid">25891201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Douglas AE. Symbiosis as a general principle in eukaryotic evolution. Cold Spring Harb Perspect Biol. 2014;6:a016113.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Field CB, Behrenfeld MJ, Randerson JT, Falkowski P. Primary production of the biosphere: integrating terrestrial and oceanic components. Science. 1998;281:237–40.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jardillier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zubkov</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Pearman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Scanlan</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Significant CO2 fixation by small prymnesiophytes in the subtropical and tropical northeast Atlantic Ocean</article-title>
        <source>ISME J.</source>
        <year>2010</year>
        <volume>4</volume>
        <fpage>1180</fpage>
        <lpage>1192</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2010.36</pub-id>
        <?supplied-pmid 20393575?>
        <pub-id pub-id-type="pmid">20393575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woehle</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>A-S</given-names>
          </name>
          <name>
            <surname>Glock</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wein</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weissenbach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rosenstiel</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel eukaryotic denitrification pathway in Foraminifera</article-title>
        <source>Curr Biol</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>2536</fpage>
        <lpage>2543.e5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2018.06.027</pub-id>
        <?supplied-pmid 30078568?>
        <pub-id pub-id-type="pmid">30078568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michalak</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chojnacka</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Algae as production systems of bioactive compounds</article-title>
        <source>Eng Life Sci.</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>160</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1002/elsc.201400191</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Falaise C, François C, Travers M-A, Morga B, Haure J, Tremblay R, et al. Antimicrobial compounds from eukaryotic microalgae against human pathogens and diseases in aquaculture. Mar Drugs. 2016;14:159.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Leray M, Knowlton N. DNA barcoding and metabarcoding of standardized samples reveal patterns of marine benthic diversity. Proc Natl Acad Sci U S A. 2015;112:2076–81.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pawlowski</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The new micro-kingdoms of eukaryotes</article-title>
        <source>BMC Biol.</source>
        <year>2013</year>
        <volume>11</volume>
        <fpage>40</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-11-40</pub-id>
        <?supplied-pmid 23587248?>
        <pub-id pub-id-type="pmid">23587248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lax</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Eglit</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Eme</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Roger</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>AGB</given-names>
          </name>
        </person-group>
        <article-title>Hemimastigophora is a novel supra-kingdom-level lineage of eukaryotes</article-title>
        <source>Nature.</source>
        <year>2018</year>
        <volume>564</volume>
        <fpage>410</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0708-8</pub-id>
        <?supplied-pmid 30429611?>
        <pub-id pub-id-type="pmid">30429611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burki</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The eukaryotic tree of life from a global phylogenomic perspective</article-title>
        <source>Cold Spring Harb Perspect Biol.</source>
        <year>2014</year>
        <volume>6</volume>
        <fpage>a016147</fpage>
        <pub-id pub-id-type="doi">10.1101/cshperspect.a016147</pub-id>
        <?supplied-pmid 24789819?>
        <pub-id pub-id-type="pmid">24789819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keeling</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Burki</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilcox</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Allam</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Amaral-Zettler</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Marine Microbial Eukaryote Transcriptome Sequencing Project (MMETSP): illuminating the functional diversity of eukaryotic life in the oceans through transcriptome sequencing</article-title>
        <source>PLoS Biol.</source>
        <year>2014</year>
        <volume>12</volume>
        <fpage>e1001889</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1001889</pub-id>
        <?supplied-pmid 24959919?>
        <pub-id pub-id-type="pmid">24959919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bik</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Porazinska</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Creer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>Sequencing our way towards understanding global eukaryotic biodiversity</article-title>
        <source>Trends Ecol Evol.</source>
        <year>2012</year>
        <volume>27</volume>
        <fpage>233</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tree.2011.11.010</pub-id>
        <?supplied-pmid 22244672?>
        <pub-id pub-id-type="pmid">22244672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Chaffron</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Labadie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure and function of the global ocean microbiome</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1261359</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261359</pub-id>
        <?supplied-pmid 25999513?>
        <pub-id pub-id-type="pmid">25999513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carradec</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Pelletier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Da Silva</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Seeleuthner</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Blanc-Mathieu</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global ocean atlas of eukaryotic genes</article-title>
        <source>Nat Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>373</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02342-1</pub-id>
        <?supplied-pmid 29371626?>
        <pub-id pub-id-type="pmid">29371626</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Escobar-Zepeda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vera-Ponce de León</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanchez-Flores</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The road to metagenomics: from microbiology to DNA sequencing technologies and bioinformatics</article-title>
        <source>Front Genet</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>348</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2015.00348</pub-id>
        <?supplied-pmid 26734060?>
        <pub-id pub-id-type="pmid">26734060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Majaneva M, Hyytiäinen K, Varvio SL, Nagai S, Blomster J. Bioinformatic amplicon read processing strategies strongly affect eukaryotic diversity and the taxonomic composition of communities. PLoS One. 2015;10:e0130035.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>AUGUSTUS: a web server for gene prediction in eukaryotes that allows user-defined constraints</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W465</fpage>
        <lpage>W467</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki458</pub-id>
        <?supplied-pmid 15980513?>
        <pub-id pub-id-type="pmid">15980513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Hoff KJ, Lange S, Lomsadze A, Borodovsky M, Stanke M. BRAKER1: unsupervised RNA-seq-based genome annotation with GeneMark-ET and Augustus. Bioinformatics. 2016;32:767–9.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoff</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>WebAUGUSTUS--a web service for training AUGUSTUS and predicting genes in eukaryotes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>W123</fpage>
        <lpage>W128</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt418</pub-id>
        <?supplied-pmid 23700307?>
        <pub-id pub-id-type="pmid">23700307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korf</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Gene finding in novel genomes</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-59</pub-id>
        <?supplied-pmid 15144565?>
        <pub-id pub-id-type="pmid">15144565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>West</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Grigoriev</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Genome-reconstruction for eukaryotes from complex natural microbial communities</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>569</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.228429.117</pub-id>
        <?supplied-pmid 29496730?>
        <pub-id pub-id-type="pmid">29496730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kupkova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Provaznik</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics strategies for taxonomy independent binning and visualization of sequences in shotgun metagenomics</article-title>
        <source>Comput Struct Biotechnol J.</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>48</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2016.11.005</pub-id>
        <?supplied-pmid 27980708?>
        <pub-id pub-id-type="pmid">27980708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Lu YY, Chen T, Fuhrman JA, Sun F. COCACOLA: binning metagenomic contigs using sequence COmposition, read CoverAge, CO-alignment and pairedend read LinkAge. Bioinformatics. 2017;33:791–8.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Yu G, Jiang Y, Wang J, Zhang H, Luo H. BMC3C: binning metagenomic contigs using codon usage, sequence composition and read coverage. Bioinformatics. 2018;34:4172–9.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelfand</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Mironov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Gene recognition via spliced sequence alignment</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>1996</year>
        <volume>93</volume>
        <fpage>9061</fpage>
        <lpage>9066</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.93.17.9061</pub-id>
        <?supplied-pmid 8799154?>
        <pub-id pub-id-type="pmid">8799154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Direct mapping and alignment of protein sequences onto genomic sequence</article-title>
        <source>Bioinformatics.</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2438</fpage>
        <lpage>2444</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn460</pub-id>
        <?supplied-pmid 18728043?>
        <pub-id pub-id-type="pmid">18728043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Steinegger M, Söding J. MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets. Nat Biotechnol. 2017;35:1026-8.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>An overview of nested genes in eukaryotic genomes</article-title>
        <source>Eukaryot Cell.</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>1321</fpage>
        <lpage>1329</lpage>
        <pub-id pub-id-type="doi">10.1128/EC.00143-09</pub-id>
        <?supplied-pmid 19542305?>
        <pub-id pub-id-type="pmid">19542305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Cavanaugh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D41</fpage>
        <lpage>D47</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1094</pub-id>
        <?supplied-pmid 29140468?>
        <pub-id pub-id-type="pmid">29140468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Magrane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alpi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Antunes</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UniProt: the universal protein knowledgebase</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D158</fpage>
        <lpage>D169</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1099</pub-id>
        <pub-id pub-id-type="pmid">27899622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Delmont TO</collab>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shaiber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Esen</surname>
            <given-names>ÖC</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Rappé</surname>
            <given-names>MS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nitrogen-fixing populations of Planctomycetes and Proteobacteria are abundant in surface ocean metagenomes</article-title>
        <source>Nat Microbiol.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>804</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0176-9</pub-id>
        <?supplied-pmid 29891866?>
        <pub-id pub-id-type="pmid">29891866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sadakane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
        </person-group>
        <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1674</fpage>
        <lpage>1676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id>
        <?supplied-pmid 25609793?>
        <pub-id pub-id-type="pmid">25609793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von den Driesch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Galiez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Uniclust databases of clustered and deeply annotated protein sequences and alignments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D170</fpage>
        <lpage>D176</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1081</pub-id>
        <?supplied-pmid 27899574?>
        <pub-id pub-id-type="pmid">27899574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Protein-level assembly increases protein sequence recovery from metagenomic samples manyfold</article-title>
        <source>Nat Methods.</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>603</fpage>
        <lpage>606</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0437-4</pub-id>
        <?supplied-pmid 31235882?>
        <pub-id pub-id-type="pmid">31235882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Johnson LK, Alexander H, Brown CT. Re-assembly, quality evaluation, and annotation of 678 microbial eukaryotic reference transcriptomes. Gigascience. 2019;8:giy158.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Clustering huge protein sequence sets in linear time</article-title>
        <source>Nat Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2542</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04964-5</pub-id>
        <?supplied-pmid 29959318?>
        <pub-id pub-id-type="pmid">29959318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Geiser</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic resolution of deep eukaryotic and fungal relationships using highly conserved low-copy nuclear genes</article-title>
        <source>Genome Biol Evol.</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>2683</fpage>
        <lpage>2701</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evw196</pub-id>
        <?supplied-pmid 27604879?>
        <pub-id pub-id-type="pmid">27604879</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nakamura</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tomii</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Parallelization of MAFFT for large-scale multiple sequence alignments. Hancock J, editor</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2490</fpage>
        <lpage>2492</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty121</pub-id>
        <?supplied-pmid 29506019?>
        <pub-id pub-id-type="pmid">29506019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1312</fpage>
        <lpage>1313</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu033</pub-id>
        <?supplied-pmid 24451623?>
        <pub-id pub-id-type="pmid">24451623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghurye</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Cepeda-Espinoza</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic assembly: overview, challenges and applications</article-title>
        <source>Yale J Biol Med.</source>
        <year>2016</year>
        <volume>89</volume>
        <fpage>353</fpage>
        <lpage>362</lpage>
        <?supplied-pmid 27698619?>
        <pub-id pub-id-type="pmid">27698619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Warwick-Dugdale J, Solonenko N, Moore K, Chittick L, Gregory AC, Allen MJ, et al. Long-read viral metagenomics enables capture of abundant and microdiverse viral populations and their niche-defining genomic islands. PeerJ. 2019;7:e6800.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tooming-Klunderud</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eijsink</surname>
            <given-names>VGH</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Nederbragt</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved metagenome assemblies and taxonomic binning using long-read circular consensus sequence data</article-title>
        <source>Sci Rep.</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>25373</fpage>
        <pub-id pub-id-type="doi">10.1038/srep25373</pub-id>
        <?supplied-pmid 27156482?>
        <pub-id pub-id-type="pmid">27156482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Driscoll</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Otten</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Dreher</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Towards long-read metagenomics: complete assembly of three novel genomes from bacteria dependent on a diazotrophic cyanobacterium in a freshwater lake co-culture</article-title>
        <source>Stand Genomic Sci.</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.1186/s40793-017-0224-8</pub-id>
        <?supplied-pmid 28127419?>
        <pub-id pub-id-type="pmid">28127419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 desktop and local web server app for fast, interactive sequence searches</article-title>
        <source>Bioinformatics.</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>2856</fpage>
        <lpage>2858</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1057</pub-id>
        <?supplied-pmid 30615063?>
        <pub-id pub-id-type="pmid">30615063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mann</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Droop</surname>
            <given-names>SJM</given-names>
          </name>
        </person-group>
        <article-title>Biodiversity, biogeography and conservation of diatoms</article-title>
        <source>Hydrobiologia.</source>
        <year>1996</year>
        <volume>336</volume>
        <fpage>19</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00010816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Melkonian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Algal biodiversity</article-title>
        <source>Phycologia.</source>
        <year>1996</year>
        <volume>35</volume>
        <fpage>308</fpage>
        <lpage>326</lpage>
        <pub-id pub-id-type="doi">10.2216/i0031-8884-35-4-308.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Vargas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Audic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Decelle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mahe</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Logares</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Eukaryotic plankton diversity in the sunlit ocean</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1261605</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261605</pub-id>
        <?supplied-pmid 25999516?>
        <pub-id pub-id-type="pmid">25999516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ovchinnikov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Varghese</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>P-S</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>DE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein structure determination using metagenome sequence data</article-title>
        <source>Science.</source>
        <year>2017</year>
        <volume>355</volume>
        <fpage>294</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aah4043</pub-id>
        <?supplied-pmid 28104891?>
        <pub-id pub-id-type="pmid">28104891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Söding J. Big-data approaches to protein structure prediction. Science. 2017;355:248–9.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Worden</surname>
            <given-names>AZ</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>The voyage of the microbial eukaryote</article-title>
        <source>Curr Opin Microbiol.</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>652</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2010.08.001</pub-id>
        <?supplied-pmid 20832353?>
        <pub-id pub-id-type="pmid">20832353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Karlin S, Altschul SF. Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes. Proc Natl Acad Sci U S A. 1990;87:2264–8.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <?supplied-pmid 4103590?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Ondov BD, Bergman NH, Phillippy AM. Interactive metagenomic visualization in a web browser. BMC Bioinformatics. 2011;12:385.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mackey</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Stoeckert</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Roos</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>OrthoMCL-DB: querying a comprehensive multi-species collection of ortholog groups</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D363</fpage>
        <lpage>D368</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj123</pub-id>
        <?supplied-pmid 16381887?>
        <pub-id pub-id-type="pmid">16381887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive Tree Of Life (iTOL) v4: recent updates and new developments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>W256</fpage>
        <lpage>W259</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz239</pub-id>
        <?supplied-pmid 30931475?>
        <pub-id pub-id-type="pmid">30931475</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
