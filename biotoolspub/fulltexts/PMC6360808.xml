<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6360808</article-id>
    <article-id pub-id-type="pmid">30679308</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.241455.118</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and flexible bacterial genomic epidemiology with PopPUNK</article-title>
      <alt-title alt-title-type="left-running">Lees et al.</alt-title>
      <alt-title alt-title-type="right-running">Bacterial genomic epidemiology with PopPUNK</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5360-1254</contrib-id>
        <name>
          <surname>Lees</surname>
          <given-names>John A.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1512-6194</contrib-id>
        <name>
          <surname>Harris</surname>
          <given-names>Simon R.</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4397-2224</contrib-id>
        <name>
          <surname>Tonkin-Hill</surname>
          <given-names>Gerry</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7993-3051</contrib-id>
        <name>
          <surname>Gladstone</surname>
          <given-names>Rebecca A.</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2182-0222</contrib-id>
        <name>
          <surname>Lo</surname>
          <given-names>Stephanie W.</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7168-8090</contrib-id>
        <name>
          <surname>Weiser</surname>
          <given-names>Jeffrey N.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7752-1942</contrib-id>
        <name>
          <surname>Corander</surname>
          <given-names>Jukka</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af3">3</xref>
        <xref ref-type="aff" rid="af4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8094-3751</contrib-id>
        <name>
          <surname>Bentley</surname>
          <given-names>Stephen D.</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af5">5</xref>
        <xref ref-type="aff" rid="af6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6303-8768</contrib-id>
        <name>
          <surname>Croucher</surname>
          <given-names>Nicholas J.</given-names>
        </name>
        <xref ref-type="aff" rid="af7">7</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Department of Microbiology, New York University School of Medicine, New York, New York 10016, USA;</aff>
    <aff id="af2"><label>2</label>Parasites and Microbes, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton CB10 1SA, United Kingdom;</aff>
    <aff id="af3"><label>3</label>Department of Biostatistics, University of Oslo, 0372 Oslo, Norway;</aff>
    <aff id="af4"><label>4</label>Helsinki Institute of Information Technology, Department of Mathematics and Statistics, University of Helsinki, 00014 Helsinki, Finland;</aff>
    <aff id="af5"><label>5</label>Institute of Infection and Global Health, University of Liverpool, Liverpool L7 3EA, United Kingdom;</aff>
    <aff id="af6"><label>6</label>Department of Pathology, University of Cambridge, Cambridge CB2 1QP, United Kingdom;</aff>
    <aff id="af7"><label>7</label>MRC Centre for Global Infectious Disease Analysis, Department of Infectious Disease Epidemiology, Imperial College London, London W2 1PG, United Kingdom</aff>
    <author-notes>
      <corresp>Corresponding authors: <email>john.lees@nyumc.org</email>, <email>n.croucher@imperial.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="ppub"/>. -->
    <volume>29</volume>
    <issue>2</issue>
    <fpage>304</fpage>
    <lpage>316</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>7</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>12</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2019 Lees et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This article, published in <italic>Genome Research</italic>, is available under a Creative Commons License (Attribution 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="304.pdf"/>
    <abstract>
      <p>The routine use of genomics for disease surveillance provides the opportunity for high-resolution bacterial epidemiology. Current whole-genome clustering and multilocus typing approaches do not fully exploit core and accessory genomic variation, and they cannot both automatically identify, and subsequently expand, clusters of significantly similar isolates in large data sets spanning entire species. Here, we describe PopPUNK (<underline>Pop</underline>ulation <underline>P</underline>artitioning <underline>U</underline>sing <underline>N</underline>ucleotide <italic><underline>K</underline></italic>-mers), a software implementing scalable and expandable annotation- and alignment-free methods for population analysis and clustering. Variable-length <italic>k</italic>-mer comparisons are used to distinguish isolates’ divergence in shared sequence and gene content, which we demonstrate to be accurate over multiple orders of magnitude using data from both simulations and genomic collections representing 10 taxonomically widespread species. Connections between closely related isolates of the same strain are robustly identified, despite interspecies variation in the pairwise distance distributions that reflects species’ diverse evolutionary patterns. PopPUNK can process 10<sup>3</sup>–10<sup>4</sup> genomes in a single batch, with minimal memory use and runtimes up to 200-fold faster than existing model-based methods. Clusters of strains remain consistent as new batches of genomes are added, which is achieved without needing to reanalyze all genomes de novo. This facilitates real-time surveillance with consistent cluster naming between studies and allows for outbreak detection using hundreds of genomes in minutes. Interactive visualization and online publication is streamlined through the automatic output of results to multiple platforms. PopPUNK has been designed as a flexible platform that addresses important issues with currently used whole-genome clustering and typing methods, and has potential uses across bacterial genetics and public health research.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>United States Public Health Service </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100007197</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>AI038446</award-id>
        <award-id>AI105168</award-id>
      </award-group>
      <award-group id="funding-2">
        <funding-source>Wellcome</funding-source>
        <award-id>098051</award-id>
      </award-group>
      <award-group id="funding-3">
        <funding-source>
          <institution-wrap>
            <institution>Bill and Melinda Gates Foundation </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100000865</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-4">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>742158</award-id>
      </award-group>
      <award-group id="funding-5">
        <funding-source>Wellcome and the Royal Society</funding-source>
        <award-id>104169/Z/14/Z</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Determining whether a set of pathogen isolates are significantly more genetically similar than randomly selected representatives from the circulating population is critical in identifying transmission pairs, localized outbreaks, or global patterns of dissemination (<xref rid="GR241455LEEC13" ref-type="bibr">Croucher and Didelot 2015</xref>). For phenotypically diverse bacterial pathogens, categorizing sets of similar isolates is particularly valuable, as such clusters of genotypes are often strongly associated with variation in clinically relevant traits, including host range (<xref rid="GR241455LEEC64" ref-type="bibr">Willems et al. 2012</xref>; <xref rid="GR241455LEEC54" ref-type="bibr">Reuter et al. 2014</xref>; <xref rid="GR241455LEEC63" ref-type="bibr">Weinert et al. 2015</xref>), virulence (<xref rid="GR241455LEEC54" ref-type="bibr">Reuter et al. 2014</xref>; <xref rid="GR241455LEEC63" ref-type="bibr">Weinert et al. 2015</xref>; <xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), propensity to cause nosocomial outbreaks (<xref rid="GR241455LEEC64" ref-type="bibr">Willems et al. 2012</xref>; <xref rid="GR241455LEEC2" ref-type="bibr">Aanensen et al. 2016</xref>), and antimicrobial resistance profile (<xref rid="GR241455LEEC2" ref-type="bibr">Aanensen et al. 2016</xref>; <xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>). These subdivisions are also of practical importance for phylodynamic studies (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>; <xref rid="GR241455LEEC63" ref-type="bibr">Weinert et al. 2015</xref>; <xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>; <xref rid="GR241455LEEC33" ref-type="bibr">Kremer et al. 2017</xref>) or recombination identification (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>; <xref rid="GR241455LEEC63" ref-type="bibr">Weinert et al. 2015</xref>). Cluster identification has typically used complex population structure analysis models, such as hierBAPS (<xref rid="GR241455LEEC9" ref-type="bibr">Cheng et al. 2013</xref>), but these computationally intensive methods are not optimal for ongoing surveillance, as they must be rerun from scratch when data sets expand, and low-frequency clusters tend to be merged into a single diverse group (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>; <xref rid="GR241455LEEC24" ref-type="bibr">Grad et al. 2016</xref>; <xref rid="GR241455LEEC65" ref-type="bibr">Willemse et al. 2016</xref>). This is important, as following the temporal trends in these clusters provides critical information on population-level changes following the emergence of new genotypes (<xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>) or resulting from interventions such as vaccine introduction (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>). Therefore devising efficient, extendable population structure analysis algorithms represents a critical challenge as genomic pathogen surveillance becomes routine.</p>
  <p>Existing approaches to using genetic data for surveillance are typically based on multilocus sequence typing (MLST), in which isolates are labeled according to their set of alleles at several short fragments of unlinked housekeeping genes. Following its inception in the late 1990s (<xref rid="GR241455LEEC40" ref-type="bibr">Maiden et al. 1998</xref>), continually updated online MLST databases have facilitated rapid comparisons between global isolate sets collected over decades (<xref rid="GR241455LEEC1" ref-type="bibr">Aanensen and Spratt 2005</xref>; <xref rid="GR241455LEEC30" ref-type="bibr">Jolley et al. 2017</xref>). Clusters within the population can be defined through grouping similar MLST sequence types using minimum-spanning trees, such as those produced by eBURST (<xref rid="GR241455LEEC23" ref-type="bibr">Feil et al. 2004</xref>). However, the fixed resolution of MLST means it struggles to distinguish isolates of low-diversity pathogens such as <italic>Mycobacterium tuberculosis</italic> and <italic>Salmonella enterica</italic> serovar Typhi (<xref rid="GR241455LEEC4" ref-type="bibr">Achtman 2012</xref>). Similarly, distinct clusters of high-diversity pathogens can be merged into “straggly” clonal complexes encompassing highly divergent bacteria, owing to high recombination rates causing spurious links between unrelated groups of isolates (<xref rid="GR241455LEEC62" ref-type="bibr">Turner et al. 2007</xref>; <xref rid="GR241455LEEC64" ref-type="bibr">Willems et al. 2012</xref>). Whole-genome sequence data provide an opportunity to greatly improve the precision and resolution of bacterial typing. Core genome MLST (cgMLST) schemes extend the MLST approach across sequences common to all isolates of a sample and have demonstrated their value at scales ranging from genus-wide taxonomy to investigation of nosocomial outbreaks in <italic>Neisseria</italic> spp. (<xref rid="GR241455LEEC7" ref-type="bibr">Bratcher et al. 2014</xref>), <italic>Listeria monocytogenes</italic> (<xref rid="GR241455LEEC55" ref-type="bibr">Ruppitsch et al. 2015</xref>), <italic>Enterococcus faecium</italic> (<xref rid="GR241455LEEC18" ref-type="bibr">De Been et al. 2015</xref>), <italic>Escherichia coli</italic>, <italic>Pseudomonas aeruginosa</italic>, <italic>Klebsiella pneumoniae</italic>, and <italic>Staphylococcus aureus</italic> (<xref rid="GR241455LEEC42" ref-type="bibr">Mellmann et al. 2016</xref>). This combines the speed and ease of assigning indices to alleles combined with the increased resolution of using larger proportions of the core genome. However, all such analyses are limited to the coding sequences identified in the original scheme: In the species-specific schemes listed above, this varied between 41% and 84% of the genes in a typical genome, which can be further limited if not all loci can be extracted from the query genome. Further resolution is lost if these data are treated as a set of allele identifiers, rather than nucleotide sequences, as this obscures the level of similarity between nonidentical alleles. Nevertheless, cgMLST is highly sensitive and can uncover deeper relationships between isolates than MLST. This is a trade-off with specificity, since a minimum-spanning tree constructed using sequence types is fully connected, losing the simple and intuitive splitting of the population into clonal complexes (<xref rid="GR241455LEEC23" ref-type="bibr">Feil et al. 2004</xref>).</p>
  <p>To improve on the resolution of cgMLST, whole-genome MLST (wgMLST) schemes have been developed to incorporate accessory genes. Differences in gene content underlie much phenotypic variation between bacteria, and these are correlated with core genome divergence in multiple species (<xref rid="GR241455LEEC15" ref-type="bibr">Croucher et al. 2014</xref>; <xref rid="GR241455LEEC68" ref-type="bibr">Zhou et al. 2014</xref>; <xref rid="GR241455LEEC28" ref-type="bibr">Holt et al. 2015</xref>; <xref rid="GR241455LEEC2" ref-type="bibr">Aanensen et al. 2016</xref>), motivating the use of this information in epidemiological typing. However, incorporating data from accessory loci can be difficult, as many are more difficult to align and define than core genes. Further complications arise from the difficulty of resolving orthologous and paralogous genes (<xref rid="GR241455LEEC66" ref-type="bibr">Zhang et al. 2015</xref>) and the capacity of mobile elements to import many genes over short timescales (<xref rid="GR241455LEEC17" ref-type="bibr">Croucher et al. 2016</xref>; <xref rid="GR241455LEEC3" ref-type="bibr">Abudahab et al. 2018</xref>), potentially confounding outbreak identification (<xref rid="GR241455LEEC67" ref-type="bibr">Zhou et al. 2013</xref>). Some wgMLST schemes add further complexity through continually expanding the scheme to incorporate new loci. This necessitates extracting previously unseen loci from query genomes and ensuring consistency across the revised scheme, which is both computationally intensive and algorithmically complicated. Instead, wgMLST schemes may be fixed, although this limits their resolution by excluding newly observed accessory genes. These will include any newly emerged loci that enter the population through horizontal gene transfer (<xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), the detection of which represents a critical aspect of pathogen surveillance.</p>
  <p>The population structures identified by cgMLST (<xref rid="GR241455LEEC39" ref-type="bibr">Maiden and Harrison 2016</xref>; <xref rid="GR241455LEEC27" ref-type="bibr">Henri et al. 2017</xref>; <xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), wgMLST (<xref rid="GR241455LEEC27" ref-type="bibr">Henri et al. 2017</xref>; <xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), and hierBAPS (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>; <xref rid="GR241455LEEC2" ref-type="bibr">Aanensen et al. 2016</xref>; <xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>; <xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>) are highly consistent with the MLST clonal complexes, indicating that where such clusters can be identified, they are biologically meaningful. However, none of the existing genomic approaches are appropriate for defining these clusters in an easily extendable manner from genomic surveillance data. To solve these methodological difficulties in a single approach, we have developed PopPUNK (<underline>Pop</underline>ulation <underline>P</underline>artitioning <underline>U</underline>sing <underline>N</underline>ucleotide <italic><underline>K</underline></italic>-mers; <uri xlink:href="https://poppunk.readthedocs.io/">https://poppunk.readthedocs.io/</uri>), which uses variable-length <italic>k</italic>-mer comparisons to find genetic distances between isolates, the distribution of which is then used to find clusters we define as strains, sets of isolates significantly similar in both their core and accessory genomes relative to the rest of the species.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <sec id="s1a">
      <title>PopPUNK uses variable-length <italic>k</italic>-mers to accurately resolve genetic divergence</title>
      <p>We proposed the probability that a <italic>k</italic>-mer will match between a pair of sequences, <italic>p</italic><sub>match</sub>, is the product of <italic>p</italic><sub>accessory</sub>, the probability it does not represent an accessory locus unique to one member of the pair, and <italic>p</italic><sub>core</sub>, the probability it represents a shared core genome sequence that does not contain any mismatches. To calculate <italic>p</italic><sub>core</sub> and <italic>p</italic><sub>accessory</sub>, comparisons were run using the MinHash algorithm (<xref rid="GR241455LEEC8" ref-type="bibr">Broder 1997</xref>) as implemented in Mash (<xref rid="GR241455LEEC47" ref-type="bibr">Ondov et al. 2016</xref>), which estimates the Jaccard similarity between reduced size <italic>k</italic>-mer “sketches” of the two sequences, providing a measure of <italic>p</italic><sub>match</sub>. This is run for a selection of <italic>k</italic>-mer lengths between <italic>k</italic><sub>min</sub> and <italic>k</italic><sub>max</sub>, the former being determined by the minimum sequence length needed to avoid frequent false positive matches given the size of the genomes being compared (Methods), and the latter is limited by the requirement for memory-efficient MinHash processing. By determining the probability of <italic>k</italic>-mer matching shared core sequence over this size range, it is possible to estimate the density of single-nucleotide polymorphisms (SNPs) distinguishing the pair across their shared core, defined as π (<xref rid="GR241455LEEC45" ref-type="bibr">Nei and Li 1979</xref>). This is because longer <italic>k</italic>-mers are more likely to contain a SNP, and correspondingly the probability of a <italic>k</italic>-mer perfectly matching between a pair of isolates decreases by a factor of (1 − π) for each additional base in the <italic>k</italic>-mer:
<disp-formula><mml:math id="UM1"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">core</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>This approach assumes a random and uniform distribution of SNPs across the core, which is defined as those genomic regions in which nucleotide strings at least <italic>k</italic><sub>min</sub> long can be matched, representing a significant level of similarity between the pair. Loci in which there are no <italic>k</italic><sub>min</sub>-long matches, resulting from either absence of the sequence in one member of the pair, or high sequence divergence of at least one SNP per <italic>k</italic><sub>min</sub> bases, are classified as belonging to the accessory genome; <italic>k</italic><sub>min</sub> thereby provides an intrinsic statistical distinction between the core and accessory regions in the pairwise comparison. Hence, <italic>p</italic><sub>accessory</sub> can be regarded as the Jaccard similarity between a pair in terms of the extent of common sequence they share, allowing the definition of the accessory divergence between sequences, <italic>a</italic>, as the corresponding Jaccard distance:
<disp-formula><mml:math id="UM2"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">accessory</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>Unlike <italic>p</italic><sub>core</sub>, <italic>p</italic><sub>accessory</sub> is independent of <italic>k</italic>, allowing both π and <italic>a</italic> to be jointly estimated from the relationship between <italic>p</italic><sub>match,<italic>k</italic></sub> and <italic>k</italic> (<xref ref-type="fig" rid="GR241455LEEF1">Fig. 1</xref>):
<disp-formula><mml:math id="UM3"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">match</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <fig id="GR241455LEEF1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Summary of the PopPUNK algorithm. (Step 1) For each pairwise comparison of sequences, the proportion of shared <italic>k</italic>-mers of different lengths is used to calculate a core and accessory distance. Differences in gene content cause <italic>k</italic>-mers (examples highlighted in green) to mismatch irrespective of length, whereas point mutations distinguishing orthologous sequences cause longer <italic>k</italic>-mers to mismatch more frequently than shorter <italic>k</italic>-mers. (Step 2) The scatterplot of these core and accessory distances is clustered to identify the set of distances representing “within-strain” comparisons between closely related isolates. A network is then constructed from nodes, corresponding to isolates, linked by short genetic distances, corresponding to within-strain comparisons. Connected components of this network define clusters. (Step 3) The threshold defining within-strain links is then refined using a network score, <italic>n</italic><sub>s</sub>, in order to generate a sparse but highly clustered network. (Step 4) Finally, the network is pruned by taking one sample from each clique. The distances between new query sequences and references are calculated, and within-strain distances used to add new edges. The clusters are then reevaluated as in Step 3, with the nomenclature being kept consistent with the original reference cluster names.</p>
        </caption>
        <graphic xlink:href="304f01"/>
      </fig>
      <p>To test whether this approach was effective in differentiating core and accessory divergences, we performed forward-time simulations of bacterial populations diversifying through point mutations, large insertions and deletions (indels), and recombination using Bacmeta (<xref rid="GR241455LEEC59" ref-type="bibr">Sipola et al. 2018</xref>) using the parameters listed in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S1</ext-link>. Those simulations in which sequences diverged only through point mutations all correctly identified <italic>a</italic> &lt; 5 × 10<sup>−3</sup>, whereas π increased according to the set point mutation rate over multiple orders of magnitude, even in the presence of recombination (<xref ref-type="fig" rid="GR241455LEEF2">Fig. 2</xref>A,B; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Figs. S1–S3</ext-link>). Further tests found PopPUNK could resolve genomes distinguished by only a single point mutation, with the <italic>k</italic>-mer sketch size used determining the balance between precision and computational speed (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Text S1</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S4</ext-link>). To test the accuracy with which <italic>a</italic> could be estimated, the point mutation rate was fixed at 5 × 10<sup>−6</sup> bp<sup>−1</sup> generation<sup>−1</sup>, and indels of a fixed size of 100 bp occurred at varying rates relative to point mutations to emulate changes of gene content. The calculated <italic>a</italic> covaried with the indel rate, without substantially affecting the inferred distribution of π (<xref ref-type="fig" rid="GR241455LEEF2">Fig. 2</xref>C; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Figs. S1, S2</ext-link>). When the indel rate was fixed at 0.05, the distributions of both <italic>a</italic> and π converged toward a single mode as the rate of exchange through recombination was increased (<xref ref-type="fig" rid="GR241455LEEF2">Fig. 2</xref>D), consistent with changes in the analogous core and accessory genetic distances observed in a study using a different framework to study the effects of sequence exchange (<xref rid="GR241455LEEC41" ref-type="bibr">Marttinen et al. 2015</xref>). Hence, PopPUNK's use of variable-length <italic>k</italic>-mers can resolve variation in the genome content and sequence to generate a pairwise distance distribution that accurately reflects the population-wide distribution of genetic diversity.</p>
      <fig id="GR241455LEEF2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Detection of genetic diversity in simulated populations by PopPUNK. Each plot shows the deviation in gene sequence (π) and gene content (<italic>a</italic>) estimated by PopPUNK from a sample of 25 isolates from each of 50 simulations run with the same parameters. (<italic>A</italic>,<italic>B</italic>) Deviation through point mutation only. As the rate of point mutation (base<sup>−1</sup> generation<sup>−1</sup>) was increased over two orders of magnitude, estimates of population-wide π increased accordingly, as shown by the distribution of pairwise core distances in the <italic>top</italic> row of histograms (<italic>A</italic>). The scatterplots <italic>below</italic> (i.e., in <italic>B</italic>) show that <italic>a</italic> measurements remained below 5 × 10<sup>−3</sup>, demonstrating the specificity with which divergence was measured. (<italic>C</italic>) Deviation through insertions and deletions. To test the estimation of <italic>a</italic> in a clonally evolving population, simulations included insertions and deletions of 100-bp segments occurring at a rate defined relative to the fixed point mutation rate of 5 × 10<sup>−6</sup> base<sup>−1</sup> generation<sup>−1</sup>. Estimates of <italic>a</italic> increased proportionately with this rate, without affecting the observed range of π. (<italic>D</italic>) Effects of recombination on the distribution of genetic diversity. With the insertion and deletion rate fixed at 0.05 relative to the point mutation rate of 5 × 10<sup>−6</sup> base<sup>−1</sup> generation<sup>−1</sup>, the rate of recombination relative to point mutations was then varied. This resulted in a concentration of the estimated distances into a single mode, representing the changing population structure as frequent exchange between isolates homogenizes the divergence between them in both gene sequence and content.</p>
        </caption>
        <graphic xlink:href="304f02"/>
      </fig>
    </sec>
    <sec id="s1b">
      <title>PopPUNK identifies divergence between bacterial genomes across multiple species</title>
      <p>To test whether PopPUNK could also produce accurate estimates of <italic>a</italic> and π when applied to real high-throughput sequencing data, the software was next applied to recent population genomics studies from 10 diverse bacterial species using the default sketch size of 10<sup>4</sup>. These were chosen to be genetically and ecologically varied, including enteric bacteria (<italic>Escherichia coli</italic> and <italic>Salmonella enterica</italic>), Gram negative respiratory pathogens (<italic>Haemophilus influenzae</italic> and <italic>Neisseria meningitidis</italic>), streptococci (<italic>Streptococcus pneumoniae</italic> and <italic>Streptococcus pyogenes</italic>), other Firmicutes pathogens (<italic>Staphylococcus aureus</italic> and <italic>Listeria monocytogenes</italic>), and two species in which limited genetic diversity has previously been detected (<italic>Neisseria gonorrhoeae</italic> and <italic>Mycobacterium tuberculosis</italic>). The pangenomes of these data sets were defined using Roary (<xref rid="GR241455LEEC49" ref-type="bibr">Page et al. 2015</xref>), from which the population-wide core genome was aligned and pairwise distances calculated using the Tamura-Nei (tn93) distance (<xref rid="GR241455LEEC061" ref-type="bibr">Tamura and Nei 1993</xref>). These pairwise distances use only loci conserved across at least 99% of the isolates in each sample, rather than the pairwise definition of the core intrinsic to PopPUNK. The genome content divergence was measured as pairwise Jaccard distances based on the presence and absence of coding sequences. In all cases, there was a strong linear correlation across the full range of both <italic>a</italic> and π (<xref ref-type="fig" rid="GR241455LEEF3">Fig. 3</xref>; <xref rid="GR241455LEETB1" ref-type="table">Table 1</xref>). For π, the linear relationship was close to the identity line, indicating PopPUNK was accurately estimating the per-base probability of sequence divergence. The exception was <italic>M. tuberculosis</italic>, for which the range of π was an order of magnitude lower than in other species. To capture these differences PopPUNK needed to be run with a sketch size of 10<sup>5</sup>. Even with a 10-fold sketch size increase above the default, the analysis remained fast and memory efficient (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S2</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S5</ext-link>), and the estimated π values strongly correlated with the tn93 distances.</p>
      <fig id="GR241455LEEF3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of core and accessory distances from PopPUNK (<italic>x</italic>-axis) and pan-genome construction with Roary (<italic>y</italic>-axis). For each species, the core distance was calculated as the Tamura-Nei (tn93) distance from the core genome alignment; the accessory distance was calculated as the Jaccard distance between binary strings representing gene presence/absence. In each panel, the line of identity (red line) and a linear regression (blue line) are also plotted. Sketch sizes were 10<sup>4</sup>, except for <italic>M. tuberculosis</italic> which used a sketch size of 10<sup>5</sup>.</p>
        </caption>
        <graphic xlink:href="304f03"/>
      </fig>
      <table-wrap id="GR241455LEETB1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Adjusted <italic>R</italic><sup>2</sup> between PopPUNK-inferred core and accessory distances, and core and accessory distances inferred from a core genome alignment produced using Roary</p>
        </caption>
        <graphic xlink:href="304tb01"/>
      </table-wrap>
      <p>The comparison of <italic>a</italic> with the pairwise gene content distances from Roary found close agreement in the cases of <italic>H. influenzae</italic>, <italic>L. monocytogenes</italic>, and <italic>S. enterica</italic>, but generally PopPUNK's estimates of accessory divergence were correlated with, but lower than, Roary's. Much of this is likely attributable to differences in the levels of within-species divergence between orthologs, which were not accounted for in the Roary analyses, which all used the default BLAST identity threshold (95%). However, PopPUNK enforces changes to the <italic>k</italic><sub>min</sub> value that determines how variation is split between π and <italic>a</italic> based on genome size. This dependence on the method used to identify orthologs could be demonstrated using the <italic>S. pneumoniae</italic> data set, in which there is a high divergence between the Roary and PopPUNK analyses. The smaller <italic>a</italic> estimates from PopPUNK were very similar to those estimated by an independent annotation and analysis of gene content (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S5</ext-link>) using COGtriangles (<xref rid="GR241455LEEC34" ref-type="bibr">Kristensen et al. 2010</xref>; <xref rid="GR241455LEEC15" ref-type="bibr">Croucher et al. 2014</xref>) rather than Roary. PopPUNK is still likely to be more conservative in calculating <italic>a</italic> than any ortholog-based analysis, as it will align any segments of genes that are similar, regardless of synteny, and the sketches it generates are nonredundant, meaning <italic>a</italic> is independent of repeat copy number.</p>
      <p>The benefits of this are evident from the discrepancy between the distribution of <italic>a</italic> in <italic>M</italic>. <italic>tuberculosis</italic>, inferred to reach up to ∼10% by Roary but only ∼1.5% by PopPUNK (<xref ref-type="fig" rid="GR241455LEEF3">Fig. 3</xref>). <italic>M. tuberculosis</italic> exhibits little diversity in gene content, but ∼10% of the genome comprises repetitive, variable PE/PPE repeats (<xref rid="GR241455LEEC11" ref-type="bibr">Cole et al. 1998</xref>). Additional analysis of complete, reannotated <italic>M. tuberculosis</italic> genomes also found this discrepancy in <italic>a</italic>, indicating the difference was not a consequence of inconsistent draft assemblies (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S6A,B</ext-link>). Instead, the discrepancy was approximately halved when Roary no longer used synteny to define orthologs (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S6C,D</ext-link>) and pairwise alignments with NUCmer (<xref rid="GR241455LEEC19" ref-type="bibr">Delcher et al. 2003</xref>) identified similar proportions of divergent sequence as PopPUNK (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S6E</ext-link>). This was consistent with manual inspection of alignments, which suggested the accessory variation identified by Roary was largely a consequence of the difficulty of identifying some orthologs, rather than genuine differences in sequence content, largely as a consequence of expansion, contraction, and rearrangement of PE/PPE repeats. Nevertheless, PopPUNK can detect potentially biologically important divergence in intergenic regions (<xref rid="GR241455LEEC48" ref-type="bibr">Oren et al. 2014</xref>), as it does not depend on genome annotation. Additionally, PopPUNK was between six- and 200-fold faster than Roary, while using between five- and 45-fold less memory (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S2</ext-link>). Therefore, PopPUNK is an efficient means of accurately measuring SNP and gene content divergence in species-wide genomic data sets.</p>
    </sec>
    <sec id="s1c">
      <title>PopPUNK successfully resolves diverse bacterial populations into strains</title>
      <p>PopPUNK successfully replicated the discontinuous distribution of <italic>a</italic> and π between all pairs of sequences in an <italic>S. pneumoniae</italic> population (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S7</ext-link>), which was previously shown to reflect the sequence clusters within the population (<xref rid="GR241455LEEC15" ref-type="bibr">Croucher et al. 2014</xref>). Bacterial populations can be considered as being composed of multiple strains if there is a separation between the shorter genetic distances, corresponding to within-strain comparisons, and the larger between-strain distances, which may form one or more clusters in the plot (<xref ref-type="fig" rid="GR241455LEEF2">Fig. 2</xref>). To test whether this also applied to other bacterial pathogens, the pairwise <italic>a</italic> and π distributions were plotted for the other nine species-wide collections listed in <xref rid="GR241455LEETB1" ref-type="table">Table 1</xref> (<xref ref-type="fig" rid="GR241455LEEF4">Fig. 4</xref>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S8</ext-link>). Species known to exchange sequence through homologous recombination at similar frequencies to <italic>S. pneumoniae</italic>, such as <italic>Neisseria meningitidis</italic> (<xref ref-type="fig" rid="GR241455LEEF4">Fig. 4</xref>), exhibited a similar distribution of pairwise genetic distances. The group of within-strain pairwise distances, found near the origin of the graph, was elongated, likely as a consequence of extensive diversification of strains through transfer of genomic islands and shuffling of core sequence through homologous recombination. The between-strain distances were primarily concentrated within a single dense modal cluster, consistent with the simulations involving high level of recombination in <xref ref-type="fig" rid="GR241455LEEF2">Figure 2</xref>. In <italic>S. pneumoniae</italic>, inclusion of <italic>a</italic> distances clearly identified a third component comprising comparisons with atypical unencapsulated isolates (<xref rid="GR241455LEEC15" ref-type="bibr">Croucher et al. 2014</xref>).</p>
      <fig id="GR241455LEEF4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>PopPUNK model fitting output for five archetypal examples (other species shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S8</ext-link>). Each row is a species, with each plot showing the distribution of core and accessory distances. In each plot, points are colored by their predicted cluster, and the cluster closest to the origin is the within-strain cluster. The two-dimensional Gaussian mixture model (2D GMM) is in the <italic>left</italic> column, which also shows ellipses with the mean and covariance of the fitted mixture components. The HDBSCAN plot in the <italic>center</italic> column shows unclassified noise points in black. The <italic>right</italic> column shows the fits when maximizing the network score to refine the 2D GMM fit. <italic>Listeria monocytogenes</italic> has clearly separated clusters, which were well-predicted by all methods. Although there is more complex structure on the plots, <italic>Escherichia coli</italic> and <italic>Neisseria meningitidis</italic> have a within-strain cluster also well captured by all approaches. In <italic>Streptococcus pneumoniae</italic>, recombination makes the boundary between clusters less distinct, and the mixture model includes too many links (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>A). HDBSCAN is more accurate, but the refinement of the initial fit provides the most accurate and intuitive demarcation of the within-strain links. <italic>Streptococcus pyogenes</italic> exhibits low within-strain recombination; hence, it has a dense cluster of points near the origin of the graph, but high between-strain divergence, resulting in the single, broad between-strain set of points. Network score fit refinement is required for an accurate model fit in this case.</p>
        </caption>
        <graphic xlink:href="304f04"/>
      </fig>
      <p>In contrast, <italic>Streptococcus pyogenes</italic> strains exhibit little evidence of recent diversification through homologous recombination (<xref rid="GR241455LEEC44" ref-type="bibr">Nasser et al. 2014</xref>), hence, the within-strain distances were tightly clustered near the origin of the graph (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S8</ext-link>). Nevertheless, between-strain distances remained concentrated in a single node, consistent with the much higher level of recombination inferred across broader samples (<xref rid="GR241455LEEC20" ref-type="bibr">Didelot and Maiden 2010</xref>). A different pattern was evident in other species in which homologous recombination is infrequently observed, such as <italic>Escherichia coli</italic>, <italic>Salmonella enterica</italic>, and <italic>Staphylococcus aureus</italic> (<xref ref-type="fig" rid="GR241455LEEF4">Fig. 4</xref>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S5</ext-link>). These exhibited much stronger evidence of deep population structure, characterized by multimodal between-strain distance distributions that likely reflect ancestral divergences that have not been overwritten by sequence exchange. The distribution of within-strain distances had high variance in the accessory direction, which is likely to reflect rapid diversification in gene content through movement of mobile genetic elements in the absence of core genome diversification through homologous recombination (<xref rid="GR241455LEEC68" ref-type="bibr">Zhou et al. 2014</xref>; <xref rid="GR241455LEEC2" ref-type="bibr">Aanensen et al. 2016</xref>; <xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>). A more extreme version of this pattern was clear in <italic>Listeria monocytogenes</italic> and <italic>Haemophilus influenzae</italic>, which are composed of deep-branching lineages that result in small, tight clusters being formed in the π-<italic>a</italic> distance space. Although π and <italic>a</italic> were generally correlated, the inclusion of accessory distances helped further resolve clusters of pairwise comparisons into separate components, both permitting easy identification of atypical samples likely representing contaminated or low-quality assemblies, and providing a clear overview of sequence distribution in the species. Hence, PopPUNK can identify evidence of multistrain populations across a taxonomically diverse set of species with varied ecologies and rates of horizontal sequence exchange.</p>
    </sec>
    <sec id="s1d">
      <title>PopPUNK can exploit network properties to refine strain definitions</title>
      <p>In order to identify clusters in π-<italic>a</italic> space, two alternative approaches were implemented within PopPUNK: two-dimensional Gaussian mixture models (2D GMMs), which split the points into a user-specified maximum of <italic>K</italic> two-dimensional Gaussian distributions; or HDBSCAN, which is run iteratively to identify fewer than a user-specified maximum number of clusters <italic>D</italic> (Methods). The results of the application of both methods to the genomic data sets listed in <xref rid="GR241455LEETB1" ref-type="table">Table 1</xref> are shown in <xref ref-type="fig" rid="GR241455LEEF4">Figure 4</xref> and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Figure S8</ext-link>: In each case, both methods were successfully able to resolve the pairwise distances into discrete clusters, of which the closest to the origin represent within-strain relationships. The bacterial population can then be represented as a network in which each node corresponds to an isolate, and each within-strain relationship to an edge between these nodes (<xref ref-type="fig" rid="GR241455LEEF1">Fig. 1</xref>). This network has the property that strains can be defined as the separate connected components (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>).</p>
      <fig id="GR241455LEEF5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Network and query assignment for <italic>S. pneumoniae</italic> and <italic>E. coli</italic>. (<italic>A</italic>) Cytoscape view of the network for the Massachusetts <italic>S. pneumoniae</italic> data set using the 2D GMM fit. Nodes (colored dots) are samples and edges (lines) are those pairwise distances classified as within-strain. The nodes are colored by clusters according to the refined fit in <italic>B</italic>, showing which clusters are incorrectly merged in the mixture model fit. (<italic>B</italic>) As in <italic>A</italic>, but showing the network after fit refinement. High-stress edges causing clusters to be merged have been removed after maximizing the network score. (<italic>C</italic>) Box plots showing the similarities between cluster assignment when running PopPUNK in different modes. The different model types (2D GMM or HDBSCAN) implemented in PopPUNK were each fitted to either the Massachusetts or Maela <italic>S. pneumoniae</italic> population defined in <xref rid="GR241455LEEC12" ref-type="bibr">Corander et al. (2017)</xref>, then refined. The three nonreference populations were then added in successive batches, either through comparisons to the full data set or a representative set of reference sequences selected based on network structure, in all possible permutations. The Rand index was used to quantify clustering similarity between all those permutations in which the final population to be integrated was the same; only those isolates in the most recent extension of the network were used. These values are shown separated according to the starting reference population (Massachusetts or Maela), initial model (2D GMM or HDBSCAN), and comparison method (bar color; full database or references only). (<italic>D</italic>,<italic>E</italic>) Simulating surveillance of the <italic>E. coli</italic> BSAC population. A five-component 2D GMM was fitted to the pairwise distances between the 2001 isolates, and batches of isolates from successive years added sequentially either retaining the full database throughout (<italic>D</italic>) or identifying references after each addition (<italic>E</italic>). The stacked bar charts show the prevalence of strains in the population in each year, with the black component representing isolates of the multidrug-resistance-associated ST131 lineage, which emerged from 2002 onward. The full output of this analysis is provided in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S3</ext-link>.</p>
        </caption>
        <graphic xlink:href="304f05"/>
      </fig>
      <p>Neither the 2D GMM or HDBSCAN methods alone could satisfactorily resolve the recombinogenic populations into strains, primarily due to the diffuse nature of the within-strain distribution, which likely reflects the heterogenous rates of diversification observed in different strains (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>; <xref rid="GR241455LEEC21" ref-type="bibr">Didelot et al. 2013</xref>). For the 2D GMMs, this was manifested as insufficiently specific, elongated within-strain distributions, which incorrectly included between-strain links as edges. For HDBSCAN, the expectation of a background noise in the distribution meant some within-strain points were omitted from the appropriate cluster. Only a few spurious connections can have a dramatic effect on strain definitions, as previously observed for MLST clonal complexes (<xref rid="GR241455LEEC62" ref-type="bibr">Turner et al. 2007</xref>). For strain definitions to be robust, networks should have a nonoverlapping community structure, with distinct components that are highly internally connected. To achieve this, a linear threshold in π-<italic>a</italic> space was used to define the genetic divergence below which edges would link isolates (<xref ref-type="fig" rid="GR241455LEEF1">Fig. 1</xref>). Varying this identified a transition point at which there was a rapid increase in the transitivity of edges in the network, and a corresponding decrease in edge density (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>A), as spurious high-stress edges linking highly connected components are eliminated (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Figs. S9, S10</ext-link>). Therefore, a network score statistic <italic>n</italic><sub>s</sub> ranging between zero and one was defined:
<disp-formula><mml:math id="UM4"><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">transitivity</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">density</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>For each data set, <italic>n</italic><sub><italic>s</italic></sub> was first calculated by using a linear boundary to separate the within and between-strain distances, based on the 2D GMM of HDBSCAN results. This boundary's position was then optimized to maximize <italic>n</italic><sub><italic>s</italic></sub> (Methods). This provided an intuitive threshold defining within-strain distances (<xref ref-type="fig" rid="GR241455LEEF4">Fig. 4</xref>) and tended to be consistent whether initialized from either a 2D GMM or HDBSCAN (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S7</ext-link>). Inspection of the network before and after this refinement showed that small numbers of spurious edges between high frequency clusters were removed, and low-frequency clusters were kept distinct (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>B), increasing the robustness of strain definitions.</p>
    </sec>
    <sec id="s1e">
      <title>Comparison of PopPUNK with alternative typing methods</title>
      <p>For the populations listed in <xref rid="GR241455LEETB1" ref-type="table">Table 1</xref> the strain definitions resulting from model refinement were evaluated relative to the top level clusters identified from the core genome alignment using RhierBAPS (<xref rid="GR241455LEEC61" ref-type="bibr">Tonkin-Hill et al. 2018</xref>). PopPUNK used 15- to 74-fold less memory and ran between 10- and 100-fold faster than RhierBAPS (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S2</ext-link>). The biggest differences in performance were observed in relatively small collections containing extensive core genome divergence (<xref ref-type="fig" rid="GR241455LEEF3">Fig. 3</xref>), presumably representing the complexity of fitting the RhierBAPS model to such data. The number of clusters estimated by each method was similar (<xref rid="GR241455LEETB1" ref-type="table">Table 1</xref>). The adjusted Rand index can be used to compare the clustering results. This ranges from zero (different clusters) to one (the same clusters) while adjusting for chance cluster overlap (<xref rid="GR241455LEEC53" ref-type="bibr">Rand 1971</xref>; <xref rid="GR241455LEEC29" ref-type="bibr">Hubert and Arabie 1985</xref>); the average adjusted Rand index of 0.852 indicated a high level of overlap between the methods. Based on the Silhouette distance calculated from the π and <italic>a</italic> distances, the clustering identified by PopPUNK was typically of similar, or better, quality than that of RhierBAPS. For instance, in the case of <italic>S. enterica</italic>, the clusters identified agreed perfectly with a recent reappraisal of species and subspecies definitions (<xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), whereas using RhierBAPS leads to two cases of subspecies being merged, and a cluster with a single member being added to another larger cluster.</p>
      <p>Notably, RhierBAPS produced a superior clustering for <italic>N. gonorrhoeae</italic> and <italic>M. tuberculosis</italic>, which lack the assumed strain structure (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S8</ext-link>). For the analyses of such species, or individual strains within multistrain species, PopPUNK allows for models to be refined separately for the π and <italic>a</italic> distances (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Text S1</ext-link>). Using this approach to analyze both the <italic>S. pneumoniae</italic> multidrug-resistant lineage PMEN14 and <italic>N. gonorrhoeae</italic> found these core and accessory clusterings to be highly discrepant. For PMEN14, this was consistent with the frequent infection by phage previously identified using PANINI (<xref rid="GR241455LEEC3" ref-type="bibr">Abudahab et al. 2018</xref>), whereas for <italic>N. gonorrhoeae</italic>, pairs separated by high <italic>a</italic> but low π were found to be distinguished by the Gonococcal Genomic Island through association analysis using pyseer (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S11</ext-link>; <xref rid="GR241455LEEC37" ref-type="bibr">Lees et al. 2018a</xref>).</p>
      <p>To further evaluate the clusters generated by PopPUNK using the models refined jointly on π and <italic>a</italic>, they were compared to SNP distances calculated from the Roary core genome alignments (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S4</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S12</ext-link>) and the corresponding maximum likelihood phylogenies (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S5</ext-link>). In general, both the PopPUNK and RhierBAPS clusterings corresponded to clades in the phylogenies, indicating PopPUNK strains are typically related by common descent. Calculating the within-strain SNP distances, which approximates the SNP distance cutoff that could be used to define sequence clusters, varied by more than two orders of magnitude between species. This demonstrates the flexibility of PopPUNK's approach, which can adapt to the varied distance distributions across species, rather than favoring a particular threshold.</p>
      <p>The PopPUNK clusters were also compared to MLST and cgMLST schemes for two taxonomically diverse species with good quality typing schemes, <italic>L. monocytogenes</italic> and <italic>E. coli</italic> (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Tables S6, S7</ext-link>). The methods used, stringMLST (<xref rid="GR241455LEEC25" ref-type="bibr">Gupta et al. 2017</xref>) and chewBBACA (<xref rid="GR241455LEEC57" ref-type="bibr">Silva et al. 2018</xref>), were both more resource intensive than the PopPUNK analyses. For direct comparison with the PopPUNK strains, clonal complexes were defined using different threshold numbers of allele differences. In both species, the PopPUNK clusters were highly similar (adjusted Rand index above 0.98) to MLST clonal complexes defined by linking only single locus variants. For the cgMLST schemes, the PopPUNK clusters were highly similar to clustering samples with up to 100 allele differences in the 1701 core genes of <italic>L. monocytogenes</italic> (adjusted Rand index = 0.974) and up to 1000 allele differences in the 2360 core genes of <italic>E. coli</italic> (adjusted Rand index = 0.997). Hence, PopPUNK efficiently identifies similar relationships to cgMLST approaches, but can automatically adapt its clustering threshold according to the studied population, generating better average Silhouette distances in π-a space than gene-by-gene methods.</p>
    </sec>
    <sec id="s1f">
      <title>PopPUNK rapidly integrates new genomic data into clusters</title>
      <p>By first generating a reference database and defining a model by which <italic>a</italic> and π distances can be assigned as being within- or between-strain, PopPUNK allows the network by which strains are defined to be extended. New batches of genomes can then be included without needing to refit the model or recalculate all pairwise distances. This can result in existing strains expanding in number, merging with others, or new strains not previously represented in the database being founded. By automatically rebuilding an updated database, PopPUNK allows iterative expansion through addition of successive batches of genomes. The accuracy of this approach was tested using a data set of 4107 draft <italic>S. pneumoniae</italic> genomes resulting from the combination of four different populations, known to have divergent strain compositions (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S13</ext-link>), sampled from Massachusetts (USA), Southampton (UK), Nijmegen (Netherlands), and Maela (Thailand) (<xref rid="GR241455LEEC12" ref-type="bibr">Corander et al. 2017</xref>). Both the 2D GMM and HDBSCAN models were fitted and subsequently refined based on network properties using either the Massachusetts or Maela collections as the initial reference set. The three nonreference populations were then added as individual batches in every possible permutation to test the consistency of clusters from different starting points. The final clusterings of the isolates in the last population to be added were compared using the Rand index (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>C) and the adjusted Rand index (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S14</ext-link>). Using the same reference population and refined model, when the strains of the final population were compared with the middle two populations having been included in different orders, the Rand indices were all above 0.9997 (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>C). Comparisons were also made between successive queries assigned using different initial reference populations (Massachusetts or Maela) or model fits (GMM or HDBSCAN). The consistency of the π-<italic>a</italic> distributions, and refined model fits, meant there was only a slight decrease in the reproducibility of the clustering, with the median Rand index still greater than 0.99 (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>C). These were all highly similar to the results obtained when all 4107 isolates were clustered in a single step, regardless of which model fitting approach was used (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S15</ext-link>). The clustering observed after successive additions of query sequences to the network of genomes therefore exhibits reassuringly little sensitivity to the original choice of population and model fit.</p>
      <p>The addition of batches by calculating the distance to every sample in the original clustering is inefficient, as the tight clusters of isolates within the same strain will each be separated from a given query by similar π and <italic>a</italic> distances. By default, PopPUNK reduces a full database to a set of reference genomes, which includes just one representative from each clique (i.e., a fully connected component) within the network (<xref ref-type="fig" rid="GR241455LEEF1">Fig. 1</xref>). This selects at least one isolate from each strain cluster to use as a reference and will include multiple representatives of clusters that are not fully transitive, such that any new within-strain query will have at least one edge connecting it to the correct cluster. This allows for faster and more efficient analysis of new batches of data, from which new references can be extracted. To test whether this approach caused any decrease in clustering reproducibility, it was used to successively integrate the four test populations of <italic>S. pneumoniae</italic> as before (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>C). No decline in the accuracy of isolate assignment to strains was detected compared to using the full databases, nor was there a decrease in similarity to the global clustering of all populations (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S15</ext-link>). The final networks of all four combined populations contained a median of 281.5 references (range: 111–477): This almost 15-fold reduction in the database size resulted in a median 4.6-fold decrease in CPU time required for the addition of the final batch.</p>
      <p>To test how this worked in a surveillance setting, the BSAC <italic>E. coli</italic> collected between 2001 and 2011 (<xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>) were analyzed in batches, according to their year of isolation. A refined GMM model was fitted to the 2001 data set, and later years added either using the full database, or a reference set updated after each batch addition. This approach found similar population trends to the published analysis (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>D). The multidrug-resistance-associated ST131 lineage identified as a new strain by PopPUNK as soon as it was first detected in 2002, with all later representatives assigned to this cluster. Results using the full and reference-only approaches were always similar, and often identical, despite the latter approach reducing CPU and memory use by ∼50% (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>E). There was no trend toward greater divergence over time, as the addition of data allowed some closely related strains to be merged (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S3</ext-link>). Hence, using this network-based design, PopPUNK can efficiently expand an accurate database as new data become available.</p>
    </sec>
    <sec id="s1g">
      <title>PopPUNK outputs can be used directly for interactive browser-based analysis</title>
      <p>PopPUNK can combine input epidemiological data with the genetic analysis results to generate files for visualization and analysis with the online visualization software Phandango (<xref rid="GR241455LEEC26" ref-type="bibr">Hadfield et al. 2018</xref>), the browser-based viewer GrapeTree (<xref rid="GR241455LEEC69" ref-type="bibr">Zhou et al. 2018</xref>), network analysis tool Cytoscape (<xref rid="GR241455LEEC56" ref-type="bibr">Shannon et al. 2003</xref>), and the online epidemiology platform Microreact (<xref rid="GR241455LEEC6" ref-type="bibr">Argimón et al. 2016</xref>). Microreact allows interactive views of a neighbor joining tree of core distances on the left and a t-SNE projection of accessory distances on the right, using Microreact's network interface developed for PANINI (<xref rid="GR241455LEEC3" ref-type="bibr">Abudahab et al. 2018</xref>), with nodes in both colored by PopPUNK strain assignment. Links and descriptions of examples of such analyses are provided in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S8</ext-link>, including examples of how PopPUNK can highlight newly added data relative to the existing strains. As these platforms allow visualization at a resolution finer than that of overall clusters, within-strain structure can be discerned, such as the three clades of the <italic>E. coli</italic> ST131 lineage (<uri xlink:href="https://microreact.org/project/rJGAHaPtm">https://microreact.org/project/rJGAHaPtm</uri>) (<xref rid="GR241455LEEC52" ref-type="bibr">Petty et al. 2014</xref>), and the accessory variation in <italic>S. pneumoniae</italic> PMEN14 (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Text S1</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S16</ext-link>; <xref rid="GR241455LEEC3" ref-type="bibr">Abudahab et al. 2018</xref>). This also allows outbreak data to be analyzed, visualized, and shared online in a few minutes (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Text S1</ext-link>). PopPUNK thereby provides a simple and efficient means to intuitively and interactively analyze complex data using a platform that facilitates online collaboration and publication.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>The complexity and scale of bacterial genomic epidemiology data sets necessitates new approaches for population-wide analyses. PopPUNK responds to these needs by providing a comprehensive suite of algorithms for analyzing large bacterial population genomic data sets, from species-wide collections to outbreak studies, overcoming the technical and computational limitations of previous approaches. The method's speed results from the memory- and CPU-efficient estimation of core and accessory pairwise distances between isolates using MinHash-optimized <italic>k</italic>-mer comparisons. The strains identified by PopPUNK are highly consistent with the clusterings generated by RhierBAPS, MLST, and cgMLST, as well as the clades in maximum likelihood core genome phylogenies. The annotation- and alignment-free approach means running PopPUNK on draft assemblies is up to 200-fold faster than Roary, which starts from annotations; up to 100-fold faster than RhierBAPS, which starts from a core genome alignment; and up to threefold faster than cgMLST, which starts from a predefined scheme. The use of <italic>k</italic>-mer comparisons also fully exploits the information available in the entire genome assembly, without being limited to the core or a predefined set of common loci, allowing variation in the accessory genome to be quantified simultaneously. Unlike gene-by-gene methods, PopPUNK can be run on a new species or collection without necessitating careful definition and evaluation of a typing scheme. The software can also adapt to using different genome sizes, through altering <italic>k</italic><sub>min</sub>, and different levels of sample-wide diversity, by altering the MinHash sketch sizes. Additionally, there is flexibility in its application of machine learning techniques for defining strains, making it applicable across a wide variety of population structures and collection sizes, and providing the opportunity to expand the implemented repertoire of these techniques used by the software.</p>
    <p>Model refinement can also be adapted to the observed π-<italic>a</italic> distributions. The concordance of PopPUNK's default strain definition with clusters identified by other methods is consistent with them representing coherent natural populations (<xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), validating their critical use epidemiologically both for following longitudinal trends and understanding the distribution of clinically important traits in cross-sectional samples. The clusters are typically comparable to single MLST allele differences, although with the advantage that the boundary to merge clusters is automatically found through network refinement, and core and accessory distances are immediately available for more detailed within-strain investigation. Where multistrain structures are not evident in a sample, PopPUNK can divide collections into sequence clusters, using the divergence in the core genome (<xref rid="GR241455LEEC50" ref-type="bibr">Palys et al. 1997</xref>), or genomotypes, defined as being similar in the accessory loci they harbor (<xref rid="GR241455LEEC22" ref-type="bibr">Doolittle 2002</xref>). In each mode, PopPUNK applies a stringent threshold that minimizes the probability of spurious links, which connect nodes with high stress, and eventually lead to “straggly” clusters indirectly linking distantly related isolates. This approach also avoids the problem of clusters arising from diverse sets of rare genotypes, rather than lineages descended from a recent common ancestor (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>; <xref rid="GR241455LEEC24" ref-type="bibr">Grad et al. 2016</xref>; <xref rid="GR241455LEEC65" ref-type="bibr">Willemse et al. 2016</xref>). PopPUNK instead separates these into multiple small, distinct groupings, allowing emerging genotypes to be identified rapidly, emulating one of the most desirable properties of a high-quality MLST scheme.</p>
    <p>The stringency of the within-strain threshold also ensures strain definitions are persistent, and therefore robust to the addition of further batches of data, as demonstrated for both <italic>S. pneumoniae</italic> and <italic>E. coli</italic>. PopPUNK is therefore ideally suited to addressing the current limitations of <italic>k</italic>-mer-based epidemiological methods, which suffer from the absence of an appropriate curated database or a stable strain nomenclature (<xref rid="GR241455LEEC43" ref-type="bibr">Nadon et al. 2017</xref>), while retaining the benefit of being scalable to tens of thousands of genomes. Furthermore, by exploiting network properties to identify a reduced set of informative references, PopPUNK is much faster than naive <italic>k</italic>-mer comparison approaches when data are added in batches, as in epidemiological surveillance applications. Such functionality is further enhanced through outputs that can be readily shared using online visualization and analysis tools. Hence PopPUNK can be used as a pipeline to rapidly perform the most important tasks in bacterial epidemiology: analyzing population structure, identifying strains, finding substructure within these clusters, and integrating new data. Alternatively, its modularity means individual components may be used standalone, for example, when opting to use traditional read mapping to perform detailed analysis of variation with a cluster, or using allelic instead of core distances to construct clusters through the network. PopPUNK therefore greatly expands our capacity to conduct genomic surveillance of bacterial pathogens.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec id="s3a">
      <title>Rapid calculation of core and accessory divergences</title>
      <p>PopPUNK uses pairwise comparisons through <italic>k</italic>-mer matching between two sequences (<italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>) at multiple <italic>k</italic> lengths to distinguish divergence in shared sequences, π (<xref rid="GR241455LEEC45" ref-type="bibr">Nei and Li 1979</xref>), from divergence in accessory locus content, here defined as <italic>a</italic>, the Jaccard distance between the sequence content:
<disp-formula><mml:math id="UM5"><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="0.4em"/><mml:mo>∩</mml:mo><mml:mspace width="0.4em"/><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="0.4em"/><mml:mo>∪</mml:mo><mml:mspace width="0.4em"/><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula>
For any given <italic>k</italic>, a MinHash algorithm can efficiently estimate <italic>a</italic>, albeit with confounding by divergence due to π that prevents matching between <italic>k</italic>-mers in the core genome common to (<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>). Assuming that such sequence mismatches are distributed evenly throughout the genome, <italic>a</italic> can be estimated independently of <italic>k</italic> and π by calculating a function for each (<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) pair that relates the proportion of shared <italic>k</italic>-mers <italic>p</italic><sub>match</sub>, π, and <italic>a</italic> over a series of <italic>k</italic>-mer lengths <italic>k</italic>:
<disp-formula><mml:math id="UM6"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">match</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>
which we fit as a linear relationship in log space by minimizing the least squares divergence, and constraining <italic>a</italic> &gt; 0; π &gt; 0:
<disp-formula><mml:math id="UM7"><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.4em"/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">match</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">lo</mml:mi></mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
As both distance estimates are symmetrical, only a single comparison is calculated between each (<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) pair, corresponding to the upper triangle of a square distance matrix, or (<italic>n</italic>-1) × <italic>n</italic>/2 comparisons. The calculation of all pairwise <italic>p</italic><sub>match</sub> are further optimized for speed in our implementation (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Methods</ext-link>). Supplying each input sequence as a FASTA-formatted assembly, we use Mash (<xref rid="GR241455LEEC47" ref-type="bibr">Ondov et al. 2016</xref>) with a default sketch size of 10<sup>4</sup> to efficiently calculate <italic>p</italic><sub>match</sub> for every second <italic>k</italic>-mer size from <italic>k</italic> = <italic>k</italic><sub>min</sub> to <italic>k</italic> = <italic>k</italic><sub>max</sub> (29, by default). We constrain <italic>k</italic><sub>min</sub> such that the probability of a random <italic>k</italic>-mer match <italic>p</italic><sub>random</sub> is less than 5% (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Methods</ext-link>):
<disp-formula><mml:math id="UM8"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">random</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">random</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <italic>L</italic> is the genome length and log(4) enters due to the alphabet size (assuming minimal gaps or unspecified bases). For typical bacterial genomes with <italic>L</italic> between 1 and 8 Mb, this corresponds to a <italic>k</italic><sub>min</sub> of either 12 or 13.</p>
    </sec>
    <sec id="s3b">
      <title>Creating clusters using core and accessory divergences</title>
      <p>To create clusters of strains from the distance pairs (π, <italic>a</italic>), we first perform spatial clustering on all pairwise distances within the sample set to attempt to find the within-strain component nearest the origin. This is achieved using either a Gaussian mixture model (GMM) with a set maximum number of components <italic>K</italic>, or HDBSCAN with a set maximum number of clusters <italic>D</italic>.</p>
      <p>The distances defined as being within-strain are those in the component or cluster nearest the origin. We then create an undirected, unweighted network consisting of samples as nodes, linked by edges when the distance was classified as within-strain. We define PopPUNK clusters as the connected components of this network (<xref ref-type="fig" rid="GR241455LEEF1">Figs. 1</xref>, <xref ref-type="fig" rid="GR241455LEEF5">5</xref>). New query samples are added by calculating the distances to samples in the reference network and adding in those edges predicted to be within-strain. Clusters are updated to reflect the connected components.</p>
      <p>This network is also used to select representative references, comprising one or more samples from each cluster, by retaining only one sample from each clique in the network (where every node in a clique is mutually connected to every other node), thereby reducing its overall size with negligible loss of information (<xref ref-type="fig" rid="GR241455LEEF5">Fig. 5</xref>C; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Fig. S15</ext-link>). Finally, the GMM or HDBSCAN model fit can be improved by moving the within-strain boundary and using the resulting network's properties to calculate and maximize the network score <italic>n</italic><sub>s</sub>. Full details of the PopPUNK clustering method and its implementation can be found in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Materials</ext-link>.</p>
    </sec>
    <sec id="s3c">
      <title>Output and visualization</title>
      <p>Although a neighbor joining tree constructed using pairwise Jaccard distances directly has been shown to be reasonably accurate, using core genome divergence gives a more accurate tree topology (<xref rid="GR241455LEEC38" ref-type="bibr">Lees et al. 2018b</xref>). We therefore use dendropy or RapidNJ to produce a midpoint-rooted neighbor joining tree from the core distances (<xref rid="GR241455LEEC60" ref-type="bibr">Sukumaran and Holder 2010</xref>; <xref rid="GR241455LEEC58" ref-type="bibr">Simonsen et al. 2011</xref>), and an implementation of t-SNE in the sklearn package (<xref rid="GR241455LEEC51" ref-type="bibr">Pedregosa et al. 2011</xref>) to generate a projection of isolates based on the pairwise <italic>a</italic> matrix (<xref rid="GR241455LEEC3" ref-type="bibr">Abudahab et al. 2018</xref>). To enable interactive visualization of these outputs, PopPUNK can write files formatted for Microreact (<xref rid="GR241455LEEC6" ref-type="bibr">Argimón et al. 2016</xref>), Phandango (<xref rid="GR241455LEEC26" ref-type="bibr">Hadfield et al. 2018</xref>), and GrapeTree (<xref rid="GR241455LEEC69" ref-type="bibr">Zhou et al. 2018</xref>). Each of these can be automatically joined with other user-provided metadata for visualization. We also produce output for Cytoscape (<xref rid="GR241455LEEC56" ref-type="bibr">Shannon et al. 2003</xref>) for inspection and analysis of the network.</p>
    </sec>
    <sec id="s3d">
      <title>Comparison with other methods using both simulated and real data</title>
      <p>To determine the specificity of PopPUNK in distinguishing core sequence divergence from differences in gene content, forward-time simulations were run using Bacmeta (<xref rid="GR241455LEEC59" ref-type="bibr">Sipola et al. 2018</xref>). A population of 1000 bacteria, each represented by 100 loci each 1 kb long, was simulated for 1000 generations. Insertions and deletions were fixed at a length of 100 bp. Recombinations always exchanged a complete locus and were independent of sequence divergence between donor and recipient. A sample of 25 genomes was output from the final generation of each simulation, which were analyzed using PopPUNK using default settings. Pairwise distance estimates from 50 independent simulations were then combined for plotting.</p>
      <p>To compare PopPUNK with other clustering methods, we selected a range of previously published data sets on 10 different bacterial species (<xref rid="GR241455LEEC14" ref-type="bibr">Croucher et al. 2013</xref>, <xref rid="GR241455LEEC16" ref-type="bibr">2015</xref>; <xref rid="GR241455LEEC10" ref-type="bibr">Cohen et al. 2015</xref>; <xref rid="GR241455LEEC2" ref-type="bibr">Aanensen et al. 2016</xref>; <xref rid="GR241455LEEC24" ref-type="bibr">Grad et al. 2016</xref>; <xref rid="GR241455LEEC35" ref-type="bibr">Lees et al. 2016</xref>, <xref rid="GR241455LEEC36" ref-type="bibr">2017</xref>; <xref rid="GR241455LEEC31" ref-type="bibr">Kallonen et al. 2017</xref>; <xref rid="GR241455LEEC32" ref-type="bibr">Koelman et al. 2017</xref>; <xref rid="GR241455LEEC33" ref-type="bibr">Kremer et al. 2017</xref>; <xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>). For each data set, as well as PopPUNK, we ran Roary (<xref rid="GR241455LEEC49" ref-type="bibr">Page et al. 2015</xref>) to construct a pan-genome, using a BLAST sequence identity cutoff of 95%. We calculated core distances using the Tamura-Nei (tn93) distances (<xref rid="GR241455LEEC061" ref-type="bibr">Tamura and Nei 1993</xref>) in the core genome alignment. For accessory distance, we used the Jaccard distance between the accessory gene presence/absence vectors. For comparison with another high-performance clustering algorithm, we ran RhierBAPS using between 8 and 16 cores depending on data set size (<xref rid="GR241455LEEC61" ref-type="bibr">Tonkin-Hill et al. 2018</xref>). We estimated the maximum cluster size by data set, using the output from Roary and information from published analyses of these data sets.</p>
      <p>For each species, we generated a maximum-likelihood tree from the Roary core genome alignment SNPs using IQ-TREE v1.6.3 with a GTR + I + G + ASC model (<xref rid="GR241455LEEC46" ref-type="bibr">Nguyen et al. 2015</xref>). For each of these trees, we also counted polyphyly for each nonsingleton cluster. We identified all pairs of isolates from the same cluster that shared a most recent common ancestor with any isolate from a different cluster. To quantify diversity within and between clusters, we calculated the SNP distance matrices from each core alignment using pairsnp (<uri xlink:href="https://github.com/gtonkinhill/pairsnp">https://github.com/gtonkinhill/pairsnp</uri>). We selected and pruned the entries in the upper triangle, which correspond to within-cluster sample comparisons, leaving the remaining entries in the upper triangle corresponding to the between-cluster distances. For <italic>E. coli</italic> and <italic>L. monocytogenes</italic>, we also performed MLST and cgMLST assignment using stringMLST (<xref rid="GR241455LEEC25" ref-type="bibr">Gupta et al. 2017</xref>) and chewBBACA (<xref rid="GR241455LEEC57" ref-type="bibr">Silva et al. 2018</xref>), respectively. We used the database from EnteroBase for <italic>E. coli</italic> (<xref rid="GR241455LEEC5" ref-type="bibr">Alikhan et al. 2018</xref>), and from Ridom for <italic>L. monocytogenes</italic> (<xref rid="GR241455LEEC55" ref-type="bibr">Ruppitsch et al. 2015</xref>). We calculated the square symmetric matrix of pairwise allelic distances for each species and each scheme which, after applying an integer allelic distance cutoff, was then used as the input to PopPUNK to produce a network in the same way as with a π-<italic>a</italic> cutoff from network refinement.</p>
    </sec>
    <sec id="s3e">
      <title>Software availability</title>
      <p>Code is available on GitHub (<uri xlink:href="https://github.com/johnlees/PopPUNK">https://github.com/johnlees/PopPUNK</uri>; Apache 2.0 license), through the Python package index (<uri xlink:href="https://pypi.org/project/poppunk/">https://pypi.org/project/poppunk/</uri>), on Bioconda (<uri xlink:href="https://anaconda.org/bioconda/poppunk">https://anaconda.org/bioconda/poppunk</uri>) and as a tarball (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Data S1</ext-link>). Documentation can be found on readthedocs (<uri xlink:href="http://poppunk.readthedocs.io/">http://poppunk.readthedocs.io/</uri>). Code used to perform additional analysis are also available on GitHub (<uri xlink:href="https://github.com/johnlees/PopPUNK-scripts">https://github.com/johnlees/PopPUNK-scripts</uri>) and as a tarball (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Data S1</ext-link>). Online and interactive Microreact instances produced for each data set are listed in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.241455.118/-/DC1">Supplemental Table S8</ext-link>. PopPUNK databases with the best model fits for each species can be downloaded from <uri xlink:href="https://doi.org/10.6084/m9.figshare.6683624">https://doi.org/10.6084/m9.figshare.6683624</uri>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_2_304__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.241455.118_Supplemental_Material.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.241455.118_Supplemental_Data_S1.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Nabil-Fareed Alikhan for helpful discussions about the <italic>Salmonella enterica</italic> data set, and Leon Bentley for early experiments with changing Mash <italic>k</italic>-mer and sketch sizes. We also thank João Carriço and Mickael Silva for providing the curated cgMLST schemes. J.A.L. and J.N.W. are supported by grants from the United States Public Health Service (AI038446 and AI105168). S.R.H., G.T.-H., and S.D.B. are supported by Wellcome grant 098051. S.W.L. and R.A.G. are supported by the Bill and Melinda Gates Foundation. J.C. is supported by the European Research Council (grant no. 742158). N.J.C. is supported by a Sir Henry Dale Fellowship, jointly funded by Wellcome and the Royal Society (grant no. 104169/Z/14/Z).</p>
    <p><italic>Author contributions:</italic> Conceptualization: J.A.L. and N.J.C. Data curation: J.A.L., S.R.H., R.A.G., S.W.L., and N.J.C. Formal analysis: J.A.L. and N.J.C. Funding acquisition: J.N.W., S.D.B., and N.J.C. Investigation: J.A.L. and N.J.C. Methodology: J.A.L. and N.J.C. Software: J.A.L., G.T.-H., J.C., and N.J.C. Supervision: J.N.W., J.C., S.D.B., and N.J.C. Validation: S.R.H. Visualization: J.A.L. and N.J.C. Writing (original draft): J.A.L. and N.J.C. Writing (review and editing): all authors.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.241455.118">http://www.genome.org/cgi/doi/10.1101/gr.241455.118</ext-link>.</p>
    </fn>
    <fn>
      <p>Freely available online through the <italic>Genome Research</italic> Open Access option.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="GR241455LEEC1">
      <mixed-citation publication-type="journal"><string-name><surname>Aanensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Spratt</surname><given-names>BG</given-names></string-name>. <year>2005</year><article-title>The multilocus sequence typing network: mlst.net</article-title>. <source>Nucleic Acids Res</source><volume>33</volume>: <fpage>W728</fpage>–<lpage>W733</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki415</pub-id><pub-id pub-id-type="pmid">15980573</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC2">
      <mixed-citation publication-type="journal"><string-name><surname>Aanensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Feil</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Holden</surname><given-names>MT</given-names></string-name>, <string-name><surname>Dordel</surname><given-names>J</given-names></string-name>, <string-name><surname>Yeats</surname><given-names>CA</given-names></string-name>, <string-name><surname>Fedosejev</surname><given-names>A</given-names></string-name>, <string-name><surname>Goater</surname><given-names>R</given-names></string-name>, <string-name><surname>Castillo-Ramírez</surname><given-names>S</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Colijn</surname><given-names>C</given-names></string-name>, <etal/><year>2016</year><article-title>Whole-genome sequencing for routine pathogen surveillance in public health: a population snapshot of invasive <italic>Staphylococcus aureus</italic> in Europe</article-title>. <source>MBio</source><volume>7</volume>: <fpage>e00444-16</fpage><pub-id pub-id-type="doi">10.1128/mBio.00444-16</pub-id><pub-id pub-id-type="pmid">27150362</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC3">
      <mixed-citation publication-type="journal"><string-name><surname>Abudahab</surname><given-names>K</given-names></string-name>, <string-name><surname>Prada</surname><given-names>JM</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Aanensen</surname><given-names>DM</given-names></string-name>. <year>2018</year><article-title>PANINI: pangenome neighbour identification for bacterial populations</article-title>. <source>Microb Genom</source><volume>4</volume>: <fpage>e000220</fpage><pub-id pub-id-type="doi">10.1099/mgen.0.000220</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC4">
      <mixed-citation publication-type="journal"><string-name><surname>Achtman</surname><given-names>M</given-names></string-name>. <year>2012</year><article-title>Insights from genomic comparisons of genetically monomorphic bacterial pathogens</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source><volume>367</volume>: <fpage>860</fpage>–<lpage>867</lpage>. <pub-id pub-id-type="doi">10.1098/rstb.2011.0303</pub-id><pub-id pub-id-type="pmid">22312053</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC5">
      <mixed-citation publication-type="journal"><string-name><surname>Alikhan</surname><given-names>NF</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>Sergeant</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Achtman</surname><given-names>M</given-names></string-name>. <year>2018</year><article-title>A genomic overview of the population structure of <italic>Salmonella</italic></article-title>. <source>PLoS Genet</source><volume>14</volume>: <fpage>e1007261</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1007261</pub-id><pub-id pub-id-type="pmid">29621240</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC6">
      <mixed-citation publication-type="journal"><string-name><surname>Argimón</surname><given-names>S</given-names></string-name>, <string-name><surname>Abudahab</surname><given-names>K</given-names></string-name>, <string-name><surname>Goater</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Fedosejev</surname><given-names>A</given-names></string-name>, <string-name><surname>Bhai</surname><given-names>J</given-names></string-name>, <string-name><surname>Glasner</surname><given-names>C</given-names></string-name>, <string-name><surname>Feil</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Holden</surname><given-names>MT</given-names></string-name>, <string-name><surname>Yeats</surname><given-names>CA</given-names></string-name>, <string-name><surname>Grundmann</surname><given-names>H</given-names></string-name>, <etal/><year>2016</year><article-title>Microreact: visualizing and sharing data for genomic epidemiology and phylogeography</article-title>. <source>Microb Genom</source><volume>2</volume>: <fpage>e000093</fpage><pub-id pub-id-type="doi">10.1099/mgen.0.000093</pub-id><pub-id pub-id-type="pmid">28348833</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC7">
      <mixed-citation publication-type="journal"><string-name><surname>Bratcher</surname><given-names>HB</given-names></string-name>, <string-name><surname>Corton</surname><given-names>C</given-names></string-name>, <string-name><surname>Jolley</surname><given-names>KA</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>, <string-name><surname>Maiden</surname><given-names>MC</given-names></string-name>. <year>2014</year><article-title>A gene-by-gene population genomics platform: <italic>de novo</italic> assembly, annotation and genealogical analysis of 108 representative <italic>Neisseria meningitidis</italic> genomes</article-title>. <source>BMC Genomics</source><volume>15</volume>: <fpage>1138</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-15-1138</pub-id><pub-id pub-id-type="pmid">25523208</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC8">
      <mixed-citation publication-type="confproc"><string-name><surname>Broder</surname><given-names>AZ</given-names></string-name>. <year>1997</year><article-title>On the resemblance and containment of documents</article-title>. In <conf-name>Proceedings of the Compression and Complexity of Sequences 1997</conf-name>, pp. <fpage>21</fpage>–<lpage>29</lpage>. <publisher-name>IEEE Computer Society, Washington, DC</publisher-name>.</mixed-citation>
    </ref>
    <ref id="GR241455LEEC9">
      <mixed-citation publication-type="journal"><string-name><surname>Cheng</surname><given-names>L</given-names></string-name>, <string-name><surname>Connor</surname><given-names>TR</given-names></string-name>, <string-name><surname>Sirén</surname><given-names>J</given-names></string-name>, <string-name><surname>Aanensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>. <year>2013</year><article-title>Hierarchical and spatially explicit clustering of DNA sequences with BAPS software</article-title>. <source>Mol Biol Evol</source><volume>30</volume>: <fpage>1224</fpage>–<lpage>1228</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst028</pub-id><pub-id pub-id-type="pmid">23408797</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC10">
      <mixed-citation publication-type="journal"><string-name><surname>Cohen</surname><given-names>KA</given-names></string-name>, <string-name><surname>Abeel</surname><given-names>T</given-names></string-name>, <string-name><surname>Manson McGuire</surname><given-names>A</given-names></string-name>, <string-name><surname>Desjardins</surname><given-names>CA</given-names></string-name>, <string-name><surname>Munsamy</surname><given-names>V</given-names></string-name>, <string-name><surname>Shea</surname><given-names>TP</given-names></string-name>, <string-name><surname>Walker</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Bantubani</surname><given-names>N</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>DV</given-names></string-name>, <string-name><surname>Alvarado</surname><given-names>L</given-names></string-name>, <etal/><year>2015</year><article-title>Evolution of extensively drug-resistant tuberculosis over four decades: whole genome sequencing and dating analysis of <italic>Mycobacterium tuberculosis</italic> isolates from KwaZulu-Natal</article-title>. <source>PLoS Med</source><volume>12</volume>: <fpage>e1001880</fpage><pub-id pub-id-type="doi">10.1371/journal.pmed.1001880</pub-id><pub-id pub-id-type="pmid">26418737</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC11">
      <mixed-citation publication-type="journal"><string-name><surname>Cole</surname><given-names>ST</given-names></string-name>, <string-name><surname>Brosch</surname><given-names>R</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>, <string-name><surname>Garnier</surname><given-names>T</given-names></string-name>, <string-name><surname>Churcher</surname><given-names>C</given-names></string-name>, <string-name><surname>Harris</surname><given-names>D</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>SV</given-names></string-name>, <string-name><surname>Eiglmeier</surname><given-names>K</given-names></string-name>, <string-name><surname>Gas</surname><given-names>S</given-names></string-name>, <string-name><surname>Barry</surname><given-names>CE</given-names><suffix>III</suffix></string-name>, <etal/><year>1998</year><article-title>Deciphering the biology of <italic>Mycobacterium tuberculosis</italic> from the complete genome sequence</article-title>. <source>Nature</source><volume>393</volume>: <fpage>537</fpage>–<lpage>544</lpage>. <pub-id pub-id-type="doi">10.1038/31159</pub-id><pub-id pub-id-type="pmid">9634230</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC12">
      <mixed-citation publication-type="journal"><string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Fraser</surname><given-names>C</given-names></string-name>, <string-name><surname>Gutmann</surname><given-names>MU</given-names></string-name>, <string-name><surname>Arnold</surname><given-names>B</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Lipsitch</surname><given-names>M</given-names></string-name>, <string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>. <year>2017</year><article-title>Frequency-dependent selection in vaccine-associated pneumococcal population dynamics</article-title>. <source>Nat Ecol Evol</source><volume>1</volume>: <fpage>1950</fpage>–<lpage>1960</lpage>. <pub-id pub-id-type="doi">10.1038/s41559-017-0337-x</pub-id><pub-id pub-id-type="pmid">29038424</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC13">
      <mixed-citation publication-type="journal"><string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Didelot</surname><given-names>X</given-names></string-name>. <year>2015</year><article-title>The application of genomics to tracing bacterial pathogen transmission</article-title>. <source>Curr Opin Microbiol</source><volume>23</volume>: <fpage>62</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1016/j.mib.2014.11.004</pub-id><pub-id pub-id-type="pmid">25461574</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC14">
      <mixed-citation publication-type="journal"><string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Finkelstein</surname><given-names>JA</given-names></string-name>, <string-name><surname>Pelton</surname><given-names>SI</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>PK</given-names></string-name>, <string-name><surname>Lee</surname><given-names>GM</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>, <string-name><surname>Lipsitch</surname><given-names>M</given-names></string-name>. <year>2013</year><article-title>Population genomics of post-vaccine changes in pneumococcal epidemiology</article-title>. <source>Nat Genet</source><volume>45</volume>: <fpage>656</fpage>–<lpage>663</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2625</pub-id><pub-id pub-id-type="pmid">23644493</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC15">
      <mixed-citation publication-type="journal"><string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Coupland</surname><given-names>PG</given-names></string-name>, <string-name><surname>Stevenson</surname><given-names>AE</given-names></string-name>, <string-name><surname>Callendrello</surname><given-names>A</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>. <year>2014</year><article-title>Diversification of bacterial genome content through distinct mechanisms over different timescales</article-title>. <source>Nat Commun</source><volume>5</volume>: <fpage>5471</fpage><pub-id pub-id-type="doi">10.1038/ncomms6471</pub-id><pub-id pub-id-type="pmid">25407023</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC16">
      <mixed-citation publication-type="journal"><string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Finkelstein</surname><given-names>JA</given-names></string-name>, <string-name><surname>Pelton</surname><given-names>SI</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Lipsitch</surname><given-names>M</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>. <year>2015</year><article-title>Population genomic datasets describing the post-vaccine evolutionary epidemiology of <italic>Streptococcus pneumoniae</italic></article-title>. <source>Scientific Data</source><volume>2</volume>: <fpage>150058</fpage><pub-id pub-id-type="doi">10.1038/sdata.2015.58</pub-id><pub-id pub-id-type="pmid">26528397</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC17">
      <mixed-citation publication-type="journal"><string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Mostowy</surname><given-names>R</given-names></string-name>, <string-name><surname>Wymant</surname><given-names>C</given-names></string-name>, <string-name><surname>Turner</surname><given-names>P</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Fraser</surname><given-names>C</given-names></string-name>. <year>2016</year><article-title>Horizontal DNA transfer mechanisms of bacteria as weapons of intragenomic conflict</article-title>. <source>PLoS Biol</source><volume>14</volume>: <fpage>e1002394</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1002394</pub-id><pub-id pub-id-type="pmid">26934590</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC18">
      <mixed-citation publication-type="journal"><string-name><surname>De Been</surname><given-names>M</given-names></string-name>, <string-name><surname>Pinholt</surname><given-names>M</given-names></string-name>, <string-name><surname>Top</surname><given-names>J</given-names></string-name>, <string-name><surname>Bletz</surname><given-names>S</given-names></string-name>, <string-name><surname>Mellmann</surname><given-names>A</given-names></string-name>, <string-name><surname>Van Schaik</surname><given-names>W</given-names></string-name>, <string-name><surname>Brouwer</surname><given-names>E</given-names></string-name>, <string-name><surname>Rogers</surname><given-names>M</given-names></string-name>, <string-name><surname>Kraat</surname><given-names>Y</given-names></string-name>, <string-name><surname>Bonten</surname><given-names>M</given-names></string-name>, <etal/><year>2015</year><article-title>Core genome multilocus sequence typing scheme for high-resolution typing of <italic>Enterococcus faecium</italic></article-title>. <source>J Clin Microbiol</source><volume>53</volume>: <fpage>3788</fpage>–<lpage>3797</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.01946-15</pub-id><pub-id pub-id-type="pmid">26400782</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC19">
      <mixed-citation publication-type="journal"><string-name><surname>Delcher</surname><given-names>AL</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>, <string-name><surname>Phillippy</surname><given-names>AM</given-names></string-name>. <year>2003</year><article-title>Using MUMmer to identify similar regions in large sequence sets</article-title>. <source>Curr Protoc Bioinformatics</source><volume>Chapter 10</volume>: <fpage>Unit 10.3</fpage><pub-id pub-id-type="doi">10.1002/0471250953.bi1003s00</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC20">
      <mixed-citation publication-type="journal"><string-name><surname>Didelot</surname><given-names>X</given-names></string-name>, <string-name><surname>Maiden</surname><given-names>MCJ</given-names></string-name>. <year>2010</year><article-title>Impact of recombination on bacterial evolution</article-title>. <source>Trends Microbiol</source><volume>18</volume>: <fpage>315</fpage>–<lpage>322</lpage>. <pub-id pub-id-type="doi">10.1016/j.tim.2010.04.002</pub-id><pub-id pub-id-type="pmid">20452218</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC21">
      <mixed-citation publication-type="journal"><string-name><surname>Didelot</surname><given-names>X</given-names></string-name>, <string-name><surname>Nell</surname><given-names>S</given-names></string-name>, <string-name><surname>Yang</surname><given-names>I</given-names></string-name>, <string-name><surname>Woltemate</surname><given-names>S</given-names></string-name>, <string-name><surname>van der Merwe</surname><given-names>S</given-names></string-name>, <string-name><surname>Suerbaum</surname><given-names>S</given-names></string-name>. <year>2013</year><article-title>Genomic evolution and transmission of <italic>Helicobacter pylori</italic> in two South African families</article-title>. <source>Proc Natl Acad Sci</source><volume>110</volume>: <fpage>13880</fpage>–<lpage>13885</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1304681110</pub-id><pub-id pub-id-type="pmid">23898187</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC22">
      <mixed-citation publication-type="journal"><string-name><surname>Doolittle</surname><given-names>F</given-names></string-name>. <year>2002</year><article-title>Diversity squared</article-title>. <source>Environ Microbiol</source><volume>4</volume>: <fpage>10</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.1046/j.1462-2920.2002.gtfb00257.x</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC23">
      <mixed-citation publication-type="journal"><string-name><surname>Feil</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Li</surname><given-names>BC</given-names></string-name>, <string-name><surname>Aanensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>, <string-name><surname>Spratt</surname><given-names>BG</given-names></string-name>. <year>2004</year><article-title>eBURST: inferring patterns of evolutionary descent among clusters of related bacterial genotypes from multilocus sequence typing data</article-title>. <source>J Bacteriol</source><volume>186</volume>: <fpage>1518</fpage>–<lpage>1530</lpage>. <pub-id pub-id-type="doi">10.1128/JB.186.5.1518-1530.2004</pub-id><pub-id pub-id-type="pmid">14973027</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC24">
      <mixed-citation publication-type="journal"><string-name><surname>Grad</surname><given-names>YH</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>, <string-name><surname>Kirkcaldy</surname><given-names>RD</given-names></string-name>, <string-name><surname>Green</surname><given-names>AG</given-names></string-name>, <string-name><surname>Marks</surname><given-names>DS</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Trees</surname><given-names>D</given-names></string-name>, <string-name><surname>Lipsitch</surname><given-names>M</given-names></string-name>. <year>2016</year><article-title>Genomic epidemiology of gonococcal resistance to extended-spectrum cephalosporins, macrolides, and fluoroquinolones in the United States, 2000–2013</article-title>. <source>J Infect Dis</source><volume>214</volume>: <fpage>1579</fpage>–<lpage>1587</lpage>. <pub-id pub-id-type="doi">10.1093/infdis/jiw420</pub-id><pub-id pub-id-type="pmid">27638945</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC25">
      <mixed-citation publication-type="journal"><string-name><surname>Gupta</surname><given-names>A</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>IK</given-names></string-name>, <string-name><surname>Rishishwar</surname><given-names>L</given-names></string-name>. <year>2017</year><article-title>stringMLST: a fast k-mer based tool for multilocus sequence typing</article-title>. <source>Bioinformatics</source><volume>33</volume>: <fpage>119</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw586</pub-id><pub-id pub-id-type="pmid">27605103</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC26">
      <mixed-citation publication-type="journal"><string-name><surname>Hadfield</surname><given-names>J</given-names></string-name>, <string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Goater</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Abudahab</surname><given-names>K</given-names></string-name>, <string-name><surname>Aanensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>. <year>2018</year><article-title>Phandango: an interactive viewer for bacterial population genomics</article-title>. <source>Bioinformatics</source><volume>34</volume>: <fpage>292</fpage>–<lpage>293</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx610</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC27">
      <mixed-citation publication-type="journal"><string-name><surname>Henri</surname><given-names>C</given-names></string-name>, <string-name><surname>Leekitcharoenphon</surname><given-names>P</given-names></string-name>, <string-name><surname>Carleton</surname><given-names>HA</given-names></string-name>, <string-name><surname>Radomski</surname><given-names>N</given-names></string-name>, <string-name><surname>Kaas</surname><given-names>RS</given-names></string-name>, <string-name><surname>Mariet</surname><given-names>JF</given-names></string-name>, <string-name><surname>Felten</surname><given-names>A</given-names></string-name>, <string-name><surname>Aarestrup</surname><given-names>FM</given-names></string-name>, <string-name><surname>Smidt</surname><given-names>PG</given-names></string-name>, <string-name><surname>Roussel</surname><given-names>S</given-names></string-name>, <etal/><year>2017</year><article-title>An assessment of different genomic approaches for inferring phylogeny of <italic>Listeria monocytogenes</italic></article-title>. <source>Front Microbiol</source><volume>8</volume>: <fpage>2351</fpage><pub-id pub-id-type="doi">10.3389/fmicb.2017.02351</pub-id><pub-id pub-id-type="pmid">29238330</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC28">
      <mixed-citation publication-type="journal"><string-name><surname>Holt</surname><given-names>KE</given-names></string-name>, <string-name><surname>Wertheim</surname><given-names>H</given-names></string-name>, <string-name><surname>Zadoks</surname><given-names>RN</given-names></string-name>, <string-name><surname>Baker</surname><given-names>S</given-names></string-name>, <string-name><surname>Whitehouse</surname><given-names>CA</given-names></string-name>, <string-name><surname>Dance</surname><given-names>D</given-names></string-name>, <string-name><surname>Jenney</surname><given-names>A</given-names></string-name>, <string-name><surname>Connor</surname><given-names>TR</given-names></string-name>, <string-name><surname>Hsu</surname><given-names>LY</given-names></string-name>, <string-name><surname>Severin</surname><given-names>J</given-names></string-name>, <etal/><year>2015</year><article-title>Genomic analysis of diversity, population structure, virulence, and antimicrobial resistance in <italic>Klebsiella pneumoniae</italic>, an urgent threat to public health</article-title>. <source>Proc Natl Acad Sci</source><volume>112</volume>: <fpage>E3574</fpage>–<lpage>E3581</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1501049112</pub-id><pub-id pub-id-type="pmid">26100894</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC29">
      <mixed-citation publication-type="journal"><string-name><surname>Hubert</surname><given-names>L</given-names></string-name>, <string-name><surname>Arabie</surname><given-names>P</given-names></string-name>. <year>1985</year><article-title>Comparing partitions</article-title>. <source>J Classif</source><volume>2</volume>: <fpage>193</fpage>–<lpage>218</lpage>. <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC30">
      <mixed-citation publication-type="journal"><string-name><surname>Jolley</surname><given-names>KA</given-names></string-name>, <string-name><surname>Bray</surname><given-names>JE</given-names></string-name>, <string-name><surname>Maiden</surname><given-names>MCJ</given-names></string-name>. <year>2017</year><article-title>A RESTful application programming interface for the PubMLST molecular typing and genome databases</article-title>. <source>Database</source><volume>2017</volume>: <fpage>bax060</fpage><pub-id pub-id-type="doi">10.1093/database/bax060</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC31">
      <mixed-citation publication-type="journal"><string-name><surname>Kallonen</surname><given-names>T</given-names></string-name>, <string-name><surname>Brodrick</surname><given-names>HJ</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Brown</surname><given-names>NM</given-names></string-name>, <string-name><surname>Martin</surname><given-names>V</given-names></string-name>, <string-name><surname>Peacock</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>. <year>2017</year><article-title>Systematic longitudinal survey of invasive <italic>Escherichia coli</italic> in England demonstrates a stable population structure only transiently disturbed by the emergence of ST131</article-title>. <source>Genome Res</source><volume>27</volume>: <fpage>1437</fpage>–<lpage>1449</lpage>. <pub-id pub-id-type="doi">10.1101/gr.216606.116</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC32">
      <mixed-citation publication-type="journal"><string-name><surname>Koelman</surname><given-names>D</given-names></string-name>, <string-name><surname>Kremer</surname><given-names>P</given-names></string-name>, <string-name><surname>Lees</surname><given-names>J</given-names></string-name>, <string-name><surname>Brouwer</surname><given-names>M</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>S</given-names></string-name>, <string-name><surname>van de Beek</surname><given-names>D</given-names></string-name>. <year>2017</year><article-title>Bacterial hypervirulence in haemophilus influenzae meningitis identified by whole genome sequencing</article-title>. <source>J Neurol Sci</source><volume>381</volume>: <fpage>181</fpage>–<lpage>182</lpage>. <pub-id pub-id-type="doi">10.1016/j.jns.2017.08.523</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC33">
      <mixed-citation publication-type="journal"><string-name><surname>Kremer</surname><given-names>PH</given-names></string-name>, <string-name><surname>Lees</surname><given-names>JA</given-names></string-name>, <string-name><surname>Koopmans</surname><given-names>MM</given-names></string-name>, <string-name><surname>Ferwerda</surname><given-names>B</given-names></string-name>, <string-name><surname>Arends</surname><given-names>AW</given-names></string-name>, <string-name><surname>Feller</surname><given-names>MM</given-names></string-name>, <string-name><surname>Schipper</surname><given-names>K</given-names></string-name>, <string-name><surname>Valls Seron</surname><given-names>M</given-names></string-name>, <string-name><surname>van der Ende</surname><given-names>A</given-names></string-name>, <string-name><surname>Brouwer</surname><given-names>MC</given-names></string-name>, <etal/><year>2017</year><article-title>Benzalkonium tolerance genes and outcome in <italic>Listeria monocytogenes</italic> meningitis</article-title>. <source>Clin Microbiol Infect</source><volume>23</volume>: <fpage>265.e1</fpage>–<lpage>265.e7</lpage>. <pub-id pub-id-type="doi">10.1016/j.cmi.2016.12.008</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC34">
      <mixed-citation publication-type="journal"><string-name><surname>Kristensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Kannan</surname><given-names>L</given-names></string-name>, <string-name><surname>Coleman</surname><given-names>MK</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>YI</given-names></string-name>, <string-name><surname>Sorokin</surname><given-names>A</given-names></string-name>, <string-name><surname>Koonin</surname><given-names>EV</given-names></string-name>, <string-name><surname>Mushegian</surname><given-names>A</given-names></string-name>. <year>2010</year><article-title>A low-polynomial algorithm for assembling clusters of orthologous groups from intergenomic symmetric best matches</article-title>. <source>Bioinformatics</source><volume>26</volume>: <fpage>1481</fpage>–<lpage>1487</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq229</pub-id><pub-id pub-id-type="pmid">20439257</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC35">
      <mixed-citation publication-type="journal"><string-name><surname>Lees</surname><given-names>JA</given-names></string-name>, <string-name><surname>Vehkala</surname><given-names>M</given-names></string-name>, <string-name><surname>Välimäki</surname><given-names>N</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>, <string-name><surname>Chewapreecha</surname><given-names>C</given-names></string-name>, <string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Marttinen</surname><given-names>P</given-names></string-name>, <string-name><surname>Davies</surname><given-names>MR</given-names></string-name>, <string-name><surname>Steer</surname><given-names>AC</given-names></string-name>, <string-name><surname>Tong</surname><given-names>SYC</given-names></string-name>, <etal/><year>2016</year><article-title>Sequence element enrichment analysis to determine the genetic basis of bacterial phenotypes</article-title>. <source>Nat Commun</source><volume>7</volume>: <fpage>12797</fpage><pub-id pub-id-type="doi">10.1038/ncomms12797</pub-id><pub-id pub-id-type="pmid">27633831</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC36">
      <mixed-citation publication-type="journal"><string-name><surname>Lees</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kremer</surname><given-names>PH</given-names></string-name>, <string-name><surname>Manso</surname><given-names>AS</given-names></string-name>, <string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Ferwerda</surname><given-names>B</given-names></string-name>, <string-name><surname>Serón</surname><given-names>MV</given-names></string-name>, <string-name><surname>Oggioni</surname><given-names>MR</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>, <string-name><surname>Brouwer</surname><given-names>MC</given-names></string-name>, <string-name><surname>van der Ende</surname><given-names>A</given-names></string-name>, <etal/><year>2017</year><article-title>Large scale genomic analysis shows no evidence for pathogen adaptation between the blood and cerebrospinal fluid niches during bacterial meningitis</article-title>. <source>Microb Genom</source><volume>3</volume>: <fpage>e000103</fpage><pub-id pub-id-type="doi">10.1099/mgen.0.000103</pub-id><pub-id pub-id-type="pmid">28348877</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC37">
      <mixed-citation publication-type="journal"><string-name><surname>Lees</surname><given-names>JA</given-names></string-name>, <string-name><surname>Galardini</surname><given-names>M</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Weiser</surname><given-names>JN</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>. <year>2018a</year><article-title>pyseer: a comprehensive tool for microbial pangenome-wide association studies</article-title>. <source>Bioinformatics</source><volume>34</volume>: <fpage>4310</fpage>–<lpage>4312</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty539</pub-id><pub-id pub-id-type="pmid">30535304</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC38">
      <mixed-citation publication-type="journal"><string-name><surname>Lees</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kendall</surname><given-names>M</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>, <string-name><surname>Colijn</surname><given-names>C</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>. <year>2018b</year><article-title>Evaluation of phylogenetic reconstruction methods using bacterial whole genomes: a simulation based study</article-title>. <source>Wellcome Open Res</source><volume>3</volume>: <fpage>33</fpage><pub-id pub-id-type="doi">10.12688/wellcomeopenres.14265.2</pub-id><pub-id pub-id-type="pmid">29774245</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC39">
      <mixed-citation publication-type="journal"><string-name><surname>Maiden</surname><given-names>MC</given-names></string-name>, <string-name><surname>Harrison</surname><given-names>OB</given-names></string-name>. <year>2016</year><article-title>Population and functional genomics of <italic>Neisseria</italic> revealed with gene-by-gene approaches</article-title>. <source>J Clin Microbiol</source><volume>54</volume>: <fpage>1949</fpage>–<lpage>1955</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.00301-16</pub-id><pub-id pub-id-type="pmid">27098959</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC40">
      <mixed-citation publication-type="journal"><string-name><surname>Maiden</surname><given-names>MC</given-names></string-name>, <string-name><surname>Bygraves</surname><given-names>JA</given-names></string-name>, <string-name><surname>Feil</surname><given-names>E</given-names></string-name>, <string-name><surname>Morelli</surname><given-names>G</given-names></string-name>, <string-name><surname>Russell</surname><given-names>JE</given-names></string-name>, <string-name><surname>Urwin</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Zurth</surname><given-names>K</given-names></string-name>, <string-name><surname>Caugant</surname><given-names>DA</given-names></string-name>, <etal/><year>1998</year><article-title>Multilocus sequence typing: a portable approach to the identification of clones within populations of pathogenic microorganisms</article-title>. <source>Proc Natl Acad Sci</source><volume>95</volume>: <fpage>3140</fpage>–<lpage>3145</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.95.6.3140</pub-id><pub-id pub-id-type="pmid">9501229</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC41">
      <mixed-citation publication-type="journal"><string-name><surname>Marttinen</surname><given-names>P</given-names></string-name>, <string-name><surname>Croucher</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Gutmann</surname><given-names>MU</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>. <year>2015</year><article-title>Recombination produces coherent bacterial species clusters in both core and accessory genomes</article-title>. <source>Microb Genom</source><volume>1</volume>: <fpage>e000038</fpage><pub-id pub-id-type="doi">10.1099/mgen.0.000038</pub-id><pub-id pub-id-type="pmid">28348822</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC42">
      <mixed-citation publication-type="journal"><string-name><surname>Mellmann</surname><given-names>A</given-names></string-name>, <string-name><surname>Bletz</surname><given-names>S</given-names></string-name>, <string-name><surname>Böking</surname><given-names>T</given-names></string-name>, <string-name><surname>Kipp</surname><given-names>F</given-names></string-name>, <string-name><surname>Becker</surname><given-names>K</given-names></string-name>, <string-name><surname>Schultes</surname><given-names>A</given-names></string-name>, <string-name><surname>Prior</surname><given-names>K</given-names></string-name>, <string-name><surname>Harmsen</surname><given-names>D</given-names></string-name>. <year>2016</year><article-title>Real-time genome sequencing of resistant bacteria provides precision infection control in an institutional setting</article-title>. <source>J Clin Microbiol</source><volume>54</volume>: <fpage>2874</fpage>–<lpage>2881</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.00790-16</pub-id><pub-id pub-id-type="pmid">27558178</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC43">
      <mixed-citation publication-type="journal"><string-name><surname>Nadon</surname><given-names>C</given-names></string-name>, <string-name><surname>Van Walle</surname><given-names>I</given-names></string-name>, <string-name><surname>Gerner-Smidt</surname><given-names>P</given-names></string-name>, <string-name><surname>Campos</surname><given-names>J</given-names></string-name>, <string-name><surname>Chinen</surname><given-names>I</given-names></string-name>, <string-name><surname>Concepcion-Acevedo</surname><given-names>J</given-names></string-name>, <string-name><surname>Gilpin</surname><given-names>B</given-names></string-name>, <string-name><surname>Smith</surname><given-names>AM</given-names></string-name>, <string-name><surname>Man Kam</surname><given-names>K</given-names></string-name>, <string-name><surname>Perez</surname><given-names>E</given-names></string-name>, <etal/><year>2017</year><article-title>PulseNet International: vision for the implementation of whole genome sequencing (WGS) for global food-borne disease surveillance</article-title>. <source>Euro Surveill</source><volume>22</volume>: <fpage>pii: 30544</fpage><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.23.30544</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC44">
      <mixed-citation publication-type="journal"><string-name><surname>Nasser</surname><given-names>W</given-names></string-name>, <string-name><surname>Beres</surname><given-names>SB</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Dean</surname><given-names>MA</given-names></string-name>, <string-name><surname>Rice</surname><given-names>KA</given-names></string-name>, <string-name><surname>Long</surname><given-names>SW</given-names></string-name>, <string-name><surname>Kristinsson</surname><given-names>KG</given-names></string-name>, <string-name><surname>Gottfredsson</surname><given-names>M</given-names></string-name>, <string-name><surname>Vuopio</surname><given-names>J</given-names></string-name>, <string-name><surname>Raisanen</surname><given-names>K</given-names></string-name>, <etal/><year>2014</year><article-title>Evolutionary pathway to increased virulence and epidemic group A <italic>Streptococcus</italic> disease derived from 3,615 genome sequences</article-title>. <source>Proc Natl Acad Sci</source><volume>111</volume>: <fpage>E1768</fpage>–<lpage>E1776</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1403138111</pub-id><pub-id pub-id-type="pmid">24733896</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC45">
      <mixed-citation publication-type="journal"><string-name><surname>Nei</surname><given-names>M</given-names></string-name>, <string-name><surname>Li</surname><given-names>WH</given-names></string-name>. <year>1979</year><article-title>Mathematical model for studying genetic variation in terms of restriction endonucleases</article-title>. <source>Proc Natl Acad Sci</source><volume>76</volume>: <fpage>5269</fpage>–<lpage>5273</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.76.10.5269</pub-id><pub-id pub-id-type="pmid">291943</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC46">
      <mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname><given-names>LT</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>HA</given-names></string-name>, <string-name><surname>von Haeseler</surname><given-names>A</given-names></string-name>, <string-name><surname>Minh</surname><given-names>BQ</given-names></string-name>. <year>2015</year><article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>. <source>Mol Biol Evol</source><volume>32</volume>: <fpage>268</fpage>–<lpage>274</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msu300</pub-id><pub-id pub-id-type="pmid">25371430</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC47">
      <mixed-citation publication-type="journal"><string-name><surname>Ondov</surname><given-names>BD</given-names></string-name>, <string-name><surname>Treangen</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Melsted</surname><given-names>P</given-names></string-name>, <string-name><surname>Mallonee</surname><given-names>AB</given-names></string-name>, <string-name><surname>Bergman</surname><given-names>NH</given-names></string-name>, <string-name><surname>Koren</surname><given-names>S</given-names></string-name>, <string-name><surname>Phillippy</surname><given-names>AM</given-names></string-name>. <year>2016</year><article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source><volume>17</volume>: <fpage>132</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id><pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC48">
      <mixed-citation publication-type="journal"><string-name><surname>Oren</surname><given-names>Y</given-names></string-name>, <string-name><surname>Smith</surname><given-names>MB</given-names></string-name>, <string-name><surname>Johns</surname><given-names>NI</given-names></string-name>, <string-name><surname>Kaplan Zeevi</surname><given-names>M</given-names></string-name>, <string-name><surname>Biran</surname><given-names>D</given-names></string-name>, <string-name><surname>Ron</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Wang</surname><given-names>HH</given-names></string-name>, <string-name><surname>Alm</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Pupko</surname><given-names>T</given-names></string-name>. <year>2014</year><article-title>Transfer of noncoding DNA drives regulatory rewiring in bacteria</article-title>. <source>Proc Natl Acad Sci</source><volume>111</volume>: <fpage>16112</fpage>–<lpage>16117</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1413272111</pub-id><pub-id pub-id-type="pmid">25313052</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC49">
      <mixed-citation publication-type="journal"><string-name><surname>Page</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Cummins</surname><given-names>CA</given-names></string-name>, <string-name><surname>Hunt</surname><given-names>M</given-names></string-name>, <string-name><surname>Wong</surname><given-names>VK</given-names></string-name>, <string-name><surname>Reuter</surname><given-names>S</given-names></string-name>, <string-name><surname>Holden</surname><given-names>MT</given-names></string-name>, <string-name><surname>Fookes</surname><given-names>M</given-names></string-name>, <string-name><surname>Falush</surname><given-names>D</given-names></string-name>, <string-name><surname>Keane</surname><given-names>JA</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name>. <year>2015</year><article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics</source><volume>31</volume>: <fpage>3691</fpage>–<lpage>3693</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv421</pub-id><pub-id pub-id-type="pmid">26198102</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC50">
      <mixed-citation publication-type="journal"><string-name><surname>Palys</surname><given-names>T</given-names></string-name>, <string-name><surname>Nakamura</surname><given-names>LK</given-names></string-name>, <string-name><surname>Cohan</surname><given-names>FM</given-names></string-name>. <year>1997</year><article-title>Discovery and classification of ecological diversity in the bacterial world: the role of DNA sequence data</article-title>. <source>Int J Syst Bacteriol</source><volume>47</volume>: <fpage>1145</fpage>–<lpage>1156</lpage>. <pub-id pub-id-type="doi">10.1099/00207713-47-4-1145</pub-id><pub-id pub-id-type="pmid">9336922</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC51">
      <mixed-citation publication-type="journal"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name>, <string-name><surname>Michel</surname><given-names>V</given-names></string-name>, <string-name><surname>Thirion</surname><given-names>B</given-names></string-name>, <string-name><surname>Grisel</surname><given-names>O</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>M</given-names></string-name>, <string-name><surname>Prettenhofer</surname><given-names>P</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>R</given-names></string-name>, <string-name><surname>Dubourg</surname><given-names>V</given-names></string-name>, <etal/><year>2011</year><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><volume>12</volume>: <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="GR241455LEEC52">
      <mixed-citation publication-type="journal"><string-name><surname>Petty</surname><given-names>NK</given-names></string-name>, <string-name><surname>Ben Zakour</surname><given-names>NL</given-names></string-name>, <string-name><surname>Stanton-Cook</surname><given-names>M</given-names></string-name>, <string-name><surname>Skippington</surname><given-names>E</given-names></string-name>, <string-name><surname>Totsika</surname><given-names>M</given-names></string-name>, <string-name><surname>Forde</surname><given-names>BM</given-names></string-name>, <string-name><surname>Phan</surname><given-names>MD</given-names></string-name>, <string-name><surname>Gomes Moriel</surname><given-names>D</given-names></string-name>, <string-name><surname>Peters</surname><given-names>KM</given-names></string-name>, <string-name><surname>Davies</surname><given-names>M</given-names></string-name>, <etal/><year>2014</year><article-title>Global dissemination of a multidrug resistant <italic>Escherichia coli</italic> clone</article-title>. <source>Proc Natl Acad Sci</source><volume>111</volume>: <fpage>5694</fpage>–<lpage>5699</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1322678111</pub-id><pub-id pub-id-type="pmid">24706808</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC53">
      <mixed-citation publication-type="journal"><string-name><surname>Rand</surname><given-names>WM</given-names></string-name>. <year>1971</year><article-title>Objective criteria for the evaluation of clustering methods</article-title>. <source>J Am Stat Assoc</source><volume>66</volume>: <fpage>846</fpage>–<lpage>850</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC54">
      <mixed-citation publication-type="journal"><string-name><surname>Reuter</surname><given-names>S</given-names></string-name>, <string-name><surname>Connor</surname><given-names>TR</given-names></string-name>, <string-name><surname>Barquist</surname><given-names>L</given-names></string-name>, <string-name><surname>Walker</surname><given-names>D</given-names></string-name>, <string-name><surname>Feltwell</surname><given-names>T</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>, <string-name><surname>Fookes</surname><given-names>M</given-names></string-name>, <string-name><surname>Hall</surname><given-names>ME</given-names></string-name>, <string-name><surname>Petty</surname><given-names>NK</given-names></string-name>, <string-name><surname>Fuchs</surname><given-names>TM</given-names></string-name>, <etal/><year>2014</year><article-title>Parallel independent evolution of pathogenicity within the genus <italic>Yersinia</italic></article-title>. <source>Proc Natl Acad Sci</source><volume>111</volume>: <fpage>6768</fpage>–<lpage>6773</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1317161111</pub-id><pub-id pub-id-type="pmid">24753568</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC55">
      <mixed-citation publication-type="journal"><string-name><surname>Ruppitsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Pietzka</surname><given-names>A</given-names></string-name>, <string-name><surname>Prior</surname><given-names>K</given-names></string-name>, <string-name><surname>Bletz</surname><given-names>S</given-names></string-name>, <string-name><surname>Fernandez</surname><given-names>HL</given-names></string-name>, <string-name><surname>Allerberger</surname><given-names>F</given-names></string-name>, <string-name><surname>Harmsen</surname><given-names>D</given-names></string-name>, <string-name><surname>Mellmann</surname><given-names>A</given-names></string-name>. <year>2015</year><article-title>Defining and evaluating a core genome multilocus sequence typing scheme for whole-genome sequence-based typing of <italic>Listeria monocytogenes</italic></article-title>. <source>J Clin Microbiol</source><volume>53</volume>: <fpage>2869</fpage>–<lpage>2876</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.01193-15</pub-id><pub-id pub-id-type="pmid">26135865</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC56">
      <mixed-citation publication-type="journal"><string-name><surname>Shannon</surname><given-names>P</given-names></string-name>, <string-name><surname>Markiel</surname><given-names>A</given-names></string-name>, <string-name><surname>Ozier</surname><given-names>O</given-names></string-name>, <string-name><surname>Baliga</surname><given-names>NS</given-names></string-name>, <string-name><surname>Wang</surname><given-names>JT</given-names></string-name>, <string-name><surname>Ramage</surname><given-names>D</given-names></string-name>, <string-name><surname>Amin</surname><given-names>N</given-names></string-name>, <string-name><surname>Schwikowski</surname><given-names>B</given-names></string-name>, <string-name><surname>Ideker</surname><given-names>T</given-names></string-name>. <year>2003</year><article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>. <source>Genome Res</source><volume>13</volume>: <fpage>2498</fpage>–<lpage>2504</lpage>. <pub-id pub-id-type="doi">10.1101/gr.1239303</pub-id><pub-id pub-id-type="pmid">14597658</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC57">
      <mixed-citation publication-type="journal"><string-name><surname>Silva</surname><given-names>M</given-names></string-name>, <string-name><surname>Machado</surname><given-names>MP</given-names></string-name>, <string-name><surname>Silva</surname><given-names>DN</given-names></string-name>, <string-name><surname>Rossi</surname><given-names>M</given-names></string-name>, <string-name><surname>Moran-Gilad</surname><given-names>J</given-names></string-name>, <string-name><surname>Santos</surname><given-names>S</given-names></string-name>, <string-name><surname>Ramirez</surname><given-names>M</given-names></string-name>, <string-name><surname>Carriço</surname><given-names>JA</given-names></string-name>. <year>2018</year><article-title>chewBBACA: a complete suite for gene-by-gene schema creation and strain identification</article-title>. <source>Microb Genom</source><volume>4</volume>: <fpage>e000166</fpage><pub-id pub-id-type="doi">10.1099/mgen.0.000166</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC58">
      <mixed-citation publication-type="journal"><string-name><surname>Simonsen</surname><given-names>M</given-names></string-name>, <string-name><surname>Mailund</surname><given-names>T</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>CNS</given-names></string-name>. <year>2011</year><article-title>Inference of large phylogenies using neighbour-joining</article-title>. In <source>Biomedical engineering systems and technologies. BIOSTEC 2010. Communications in computer and information science</source> (ed. <string-name><surname>Fred</surname><given-names>A</given-names></string-name>, <etal/>), Vol. <volume>127</volume>, pp. <fpage>334</fpage>–<lpage>344</lpage>. <comment>Springer, Berlin, Heidelberg. 10.1007/978-3-642-18472-7_26</comment></mixed-citation>
    </ref>
    <ref id="GR241455LEEC59">
      <mixed-citation publication-type="journal"><string-name><surname>Sipola</surname><given-names>A</given-names></string-name>, <string-name><surname>Marttinen</surname><given-names>P</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>. <year>2018</year><article-title>Bacmeta: simulator for genomic evolution in bacterial metapopulations</article-title>. <source>Bioinformatics</source><volume>34</volume>: <fpage>2308</fpage>–<lpage>2310</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty093</pub-id><pub-id pub-id-type="pmid">29474733</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC60">
      <mixed-citation publication-type="journal"><string-name><surname>Sukumaran</surname><given-names>J</given-names></string-name>, <string-name><surname>Holder</surname><given-names>MT</given-names></string-name>. <year>2010</year><article-title>DendroPy: a Python library for phylogenetic computing</article-title>. <source>Bioinformatics</source><volume>26</volume>: <fpage>1569</fpage>–<lpage>1571</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id><pub-id pub-id-type="pmid">20421198</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC061">
      <mixed-citation publication-type="journal"><string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M</given-names></string-name>. <year>1993</year><article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees</article-title>. <source>Mol Biol Evol</source><volume>10</volume>: <fpage>512</fpage>–<lpage>526</lpage>. <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040023</pub-id><pub-id pub-id-type="pmid">8336541</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC61">
      <mixed-citation publication-type="journal"><string-name><surname>Tonkin-Hill</surname><given-names>G</given-names></string-name>, <string-name><surname>Lees</surname><given-names>JA</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>SD</given-names></string-name>, <string-name><surname>Frost</surname><given-names>SDW</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>. <year>2018</year><article-title>RhierBAPS: an R implementation of the population clustering algorithm hierBAPS</article-title>. <source>Wellcome Open Res</source><volume>3</volume>: <fpage>93</fpage><pub-id pub-id-type="doi">10.12688/wellcomeopenres.14694.1</pub-id><pub-id pub-id-type="pmid">30345380</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC62">
      <mixed-citation publication-type="journal"><string-name><surname>Turner</surname><given-names>KM</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>, <string-name><surname>Fraser</surname><given-names>C</given-names></string-name>, <string-name><surname>Connor</surname><given-names>TR</given-names></string-name>, <string-name><surname>Spratt</surname><given-names>BG</given-names></string-name>. <year>2007</year><article-title>Assessing the reliability of eBURST using simulated populations with known ancestry</article-title>. <source>BMC Microbiol</source><volume>7</volume>: <fpage>30</fpage><pub-id pub-id-type="doi">10.1186/1471-2180-7-30</pub-id><pub-id pub-id-type="pmid">17430587</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC63">
      <mixed-citation publication-type="journal"><string-name><surname>Weinert</surname><given-names>LA</given-names></string-name>, <string-name><surname>Chaudhuri</surname><given-names>RR</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Peters</surname><given-names>SE</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>, <string-name><surname>Jombart</surname><given-names>T</given-names></string-name>, <string-name><surname>Baig</surname><given-names>A</given-names></string-name>, <string-name><surname>Howell</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Vehkala</surname><given-names>M</given-names></string-name>, <string-name><surname>Välimäki</surname><given-names>N</given-names></string-name>, <etal/><year>2015</year><article-title>Genomic signatures of human and animal disease in the zoonotic pathogen <italic>Streptococcus suis</italic></article-title>. <source>Nat Commun</source><volume>6</volume>: <fpage>6740</fpage><pub-id pub-id-type="doi">10.1038/ncomms7740</pub-id><pub-id pub-id-type="pmid">25824154</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC64">
      <mixed-citation publication-type="journal"><string-name><surname>Willems</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Top</surname><given-names>J</given-names></string-name>, <string-name><surname>van Schaik</surname><given-names>W</given-names></string-name>, <string-name><surname>Leavis</surname><given-names>H</given-names></string-name>, <string-name><surname>Bonten</surname><given-names>M</given-names></string-name>, <string-name><surname>Sirén</surname><given-names>J</given-names></string-name>, <string-name><surname>Hanage</surname><given-names>WP</given-names></string-name>, <string-name><surname>Corander</surname><given-names>J</given-names></string-name>. <year>2012</year><article-title>Restricted gene flow among hospital subpopulations of <italic>Enterococcus faecium</italic></article-title>. <source>MBio</source><volume>3</volume>: <fpage>e00151-12</fpage><pub-id pub-id-type="doi">10.1128/mBio.00151-12</pub-id><pub-id pub-id-type="pmid">22807567</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC65">
      <mixed-citation publication-type="journal"><string-name><surname>Willemse</surname><given-names>N</given-names></string-name>, <string-name><surname>Howell</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Weinert</surname><given-names>LA</given-names></string-name>, <string-name><surname>Heuvelink</surname><given-names>A</given-names></string-name>, <string-name><surname>Pannekoek</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wagenaar</surname><given-names>JA</given-names></string-name>, <string-name><surname>Smith</surname><given-names>HE</given-names></string-name>, <string-name><surname>van der Ende</surname><given-names>A</given-names></string-name>, <string-name><surname>Schultsz</surname><given-names>C</given-names></string-name>. <year>2016</year><article-title>An emerging zoonotic clone in the Netherlands provides clues to virulence and zoonotic potential of <italic>Streptococcus suis</italic></article-title>. <source>Sci Rep</source><volume>6</volume>: <fpage>28984</fpage><pub-id pub-id-type="doi">10.1038/srep28984</pub-id><pub-id pub-id-type="pmid">27381348</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC66">
      <mixed-citation publication-type="journal"><string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Halkilahti</surname><given-names>J</given-names></string-name>, <string-name><surname>Hänninen</surname><given-names>M-L</given-names></string-name>, <string-name><surname>Rossi</surname><given-names>M</given-names></string-name>. <year>2015</year><article-title>Refinement of whole-genome multilocus sequence typing analysis by addressing gene paralogy</article-title>. <source>J Clin Microbiol</source><volume>53</volume>: <fpage>1765</fpage>–<lpage>1767</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.00051-15</pub-id><pub-id pub-id-type="pmid">25788543</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC67">
      <mixed-citation publication-type="journal"><string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>McCann</surname><given-names>A</given-names></string-name>, <string-name><surname>Litrup</surname><given-names>E</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>R</given-names></string-name>, <string-name><surname>Cormican</surname><given-names>M</given-names></string-name>, <string-name><surname>Fanning</surname><given-names>S</given-names></string-name>, <string-name><surname>Brown</surname><given-names>D</given-names></string-name>, <string-name><surname>Guttman</surname><given-names>DS</given-names></string-name>, <string-name><surname>Brisse</surname><given-names>S</given-names></string-name>, <string-name><surname>Achtman</surname><given-names>M</given-names></string-name>. <year>2013</year><article-title>Neutral genomic microevolution of a recently emerged pathogen, <italic>Salmonella enterica</italic> serovar Agona</article-title>. <source>PLoS Genet</source><volume>9</volume>: <fpage>e1003471</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1003471</pub-id><pub-id pub-id-type="pmid">23637636</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC68">
      <mixed-citation publication-type="journal"><string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>McCann</surname><given-names>A</given-names></string-name>, <string-name><surname>Weill</surname><given-names>FX</given-names></string-name>, <string-name><surname>Blin</surname><given-names>C</given-names></string-name>, <string-name><surname>Nair</surname><given-names>S</given-names></string-name>, <string-name><surname>Wain</surname><given-names>J</given-names></string-name>, <string-name><surname>Dougan</surname><given-names>G</given-names></string-name>, <string-name><surname>Achtman</surname><given-names>M</given-names></string-name>. <year>2014</year><article-title>Transient Darwinian selection in <italic>Salmonella enterica</italic> serovar Paratyphi A during 450 years of global spread of enteric fever</article-title>. <source>Proc Natl Acad Sci</source><volume>111</volume>: <fpage>12199</fpage>–<lpage>12204</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1411012111</pub-id><pub-id pub-id-type="pmid">25092320</pub-id></mixed-citation>
    </ref>
    <ref id="GR241455LEEC69">
      <mixed-citation publication-type="journal"><string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>Alikhan</surname><given-names>NF</given-names></string-name>, <string-name><surname>Sergeant</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Luhmann</surname><given-names>N</given-names></string-name>, <string-name><surname>Vaz</surname><given-names>C</given-names></string-name>, <string-name><surname>Francisco</surname><given-names>AP</given-names></string-name>, <string-name><surname>Carriço</surname><given-names>JA</given-names></string-name>, <string-name><surname>Achtman</surname><given-names>M</given-names></string-name>. <year>2018</year><article-title>GrapeTree: visualization of core</article-title><article-title>genomic relationships among 100,000 bacterial pathogens</article-title>. <source>Genome Res</source><volume>28</volume>: <fpage>1395</fpage>–<lpage>1404</lpage>. <pub-id pub-id-type="doi">10.1101/gr.232397.117</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
