<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6685255</article-id>
    <article-id pub-id-type="publisher-id">3009</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3009-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DROPA: DRIP-seq optimized peak annotator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Russo</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Lucca</surname>
          <given-names>Bruno</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Flati</surname>
          <given-names>Tiziano</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gioiosa</surname>
          <given-names>Silvia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chillemi</surname>
          <given-names>Giovanni</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8708-6454</contrib-id>
        <name>
          <surname>Capranico</surname>
          <given-names>Giovanni</given-names>
        </name>
        <address>
          <email>giovanni.capranico@unibo.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1757 1758</institution-id><institution-id institution-id-type="GRID">grid.6292.f</institution-id><institution>Department of Pharmacy and Biotechnology, </institution><institution>University of Bologna, </institution></institution-wrap>Bologna, Italy </aff>
      <aff id="Aff2"><label>2</label>National Council of Research, CNR, Institute of Biomembranes, Bioenergetics and Molecular Biotechnologies, Bari, Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.431603.3</institution-id><institution>SCAI-Super Computing Applications and Innovation Department, </institution><institution>CINECA, </institution></institution-wrap>Rome, Italy </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2298 9743</institution-id><institution-id institution-id-type="GRID">grid.12597.38</institution-id><institution>Department for Innovation in Biological, Agro-food and Forest systems (DIBAF), </institution><institution>University of Tuscia, </institution></institution-wrap>Viterbo, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>414</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">R-loops are three-stranded nucleic acid structures that usually form during transcription and that may lead to gene regulation or genome instability. DRIP (DNA:RNA Immunoprecipitation)-seq techniques are widely used to map R-loops genome-wide providing insights into R-loop biology. However, annotation of DRIP-seq peaks to genes can be a tricky step, due to the lack of strand information when using the common basic DRIP technique.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce DRIP-seq Optimized Peak Annotator (DROPA), a new tool for gene annotation of R-loop peaks based on gene expression information. DROPA allows a full customization of annotation options, ranging from the choice of reference datasets to gene feature definitions. DROPA allows to assign R-loop peaks to the DNA template strand in gene body with a false positive rate of less than 7%. A comparison of DROPA performance with three widely used annotation tools show that it identifies less false positive annotations than the others.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">DROPA is a fully customizable peak-annotation tool optimized for co-transcriptional DRIP-seq peaks, which allows a finest gene annotation based on gene expression information. Its output can easily be integrated into pipelines to perform downstream analyses, while useful and informative summary plots and statistical enrichment tests can be produced.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-3009-9) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>R-loop</kwd>
      <kwd>Non-canonical DNA structures</kwd>
      <kwd>Genome annotation</kwd>
      <kwd>Next-generation sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Associazione Italiana per la Ricerca sul Cancro (IT)</institution>
        </funding-source>
        <award-id>IG15886</award-id>
        <principal-award-recipient>
          <name>
            <surname>Capranico</surname>
            <given-names>Giovanni</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Università di Bologna (IT)</institution>
        </funding-source>
        <award-id>PhD Fellowship program</award-id>
        <principal-award-recipient>
          <name>
            <surname>Russo</surname>
            <given-names>Marco</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">R-loops are three stranded nucleic acid structures composed by a DNA:RNA hybrid duplex and a displaced ssDNA (single strand DNA) strand. R-loops form co-transcriptionally when nascent RNAs anneal back to DNA template strand [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. R-loops have been shown to be involved in many nuclear processes such as transcription regulation, DNA methylation modulation and DNA repair mechanisms. However unscheduled R-loop formation is associated with DNA damage accumulation, genome instability and genetic diseases [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par15">Genome-wide maps of these peculiar nucleic acid structures have boosted our understanding of R-loop biology [<xref ref-type="bibr" rid="CR1">1</xref>]. Immunoprecipitation-based techniques, generally known as DRIP (DNA:RNA Immunoprecipitation), coupled with parallel sequencing (DRIP-seq), are widely used to maps R-loops genome-wide [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>] and several DRIP variants have been developed with the intent to improve the identification of genomic R-loops [<xref ref-type="bibr" rid="CR3">3</xref>]. However, the most common technique (DRIP) allows the detection of R-loop regions without providing the strand information of the DNA:RNA hybrid. Understanding the DNA strand forming the hybrid is essential to investigate the dynamic interplay of R-loops with other nucleic acid structure (e.g. G-quadruplexes) [<xref ref-type="bibr" rid="CR6">6</xref>] or with basic directional mechanisms such as replication and transcription [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par16">Moreover, DRIP-seq data are commonly analyzed with standard peak callers, such as MACS (Model-based Analysis of ChIP-Seq) [<xref ref-type="bibr" rid="CR8">8</xref>], to identify regions with above-threshold coverage signals, usually called “peaks”. Nevertheless, DRIP peaks are markedly different from traditional ChIP (Chromatin Immunoprecipitation) peaks of transcription factors as the former peaks are usually much longer than the latter ones, spanning across several genes features or different genes. As R-loops can span several gene features (REFs), the assignment of R-loop peaks to a unique feature may not be appropriate.</p>
    <p id="Par17">To overcome these issues, we have developed a new software, named DROPA (DRIP-seq Optimized Peak Annotator), which makes use of gene expression data to annotate R-loop peaks to strand templates and expressed genes. Thus, DROPA allows the identification of the DNA strand annealed to the RNA and annotates R-loop.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Program architecture and design</title>
      <p id="Par18">DROPA is a command-line tool, developed in Python, and it can be launched in Unix environment (Linux, MacOS, Windows Subsystem for Linux).</p>
      <p id="Par19">DROPA consists of six Python scripts, <italic>PeakOverlap</italic>, <italic>CheckExpression</italic>, <italic>FeatureAssign</italic>, <italic>TableCreator</italic>, <italic>RandPeak</italic>, and <italic>SummaryPlot</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<list list-type="bullet"><list-item><p id="Par20"><italic>PeakOverlap</italic> searches for genes overlapping R-loop peaks. Two BED (Browser Extensible Data) files are produced as output: one lists peaks with corresponding overlapping genes and the other lists intergenic peaks without overlapping genes. Notwithstanding there are some libraries in R (e.g. GenomicRanges [<xref ref-type="bibr" rid="CR9">9</xref>]) that can perform this step, however we wrote <italic>PeakOverlap</italic> in Python to be consistent with the next scripts.</p></list-item><list-item><p id="Par21"><italic>CheckExpression</italic> introduces the main novelty of DROPA as compared with common peak annotation tools, as it considers gene expression levels in order to assign each R-loop peak to a given gene. It considers all overlapping genes of a peak and, if only one gene overlaps with the query peak, then that gene is assigned to the peak. In case of multiple genes overlapping to the same peak, <italic>CheckExpression</italic> evaluates their transcription levels and selects the gene with the highest level. Background levels can be set providing a threshold. If expression levels are below thresholds, they are the same for all overlapping genes, or if expression data are not provided, then the function selects the gene with the largest overlap with the query peak. Gene expression data can be in TPM (Transcripts Per Million), FPKM (Fragments Per Kilobase Million) or any other normalized values.</p></list-item><list-item><p id="Par22"><italic>FeatureAssign</italic> identifies all gene regions (upstream/downstream region, intron, exon, UTR (Untranslated Region) regions) overlapping to the peak.</p></list-item><list-item><p id="Par23"><italic>TableCreator</italic> returns a table that reports relevant information of annotated genes (name, template strand and other features) for each peak.</p></list-item><list-item><p id="Par24"><italic>RandPeak</italic> (optional) performs analyses of random R-loop peaks to calculate gene feature enrichment scores. The script takes the query peaks coordinates and returns randomly shuffled peaks all over the genome using BEDtools shuffle tool [<xref ref-type="bibr" rid="CR10">10</xref>]. Then, it launches the 1 to 4 scripts of DROPA analyses for the random peaks.</p></list-item><list-item><p id="Par25">Once all the steps are performed, <italic>SummaryPlot</italic> is used to plot results.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of DROPA workflow</p></caption><graphic xlink:href="12859_2019_3009_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Input data</title>
      <p id="Par26">DROPA requires three input data, which are:<list list-type="bullet"><list-item><p id="Par27">A file containing query peak locations in BED format;</p></list-item><list-item><p id="Par28">A reference set folder containing information about genes features (5’UTR, 3’UTR, exon, intron) in BED format and a gene reference in BED12. We provide many ready-to-use reference set for <italic>Homo sapiens</italic> (hg19) and for <italic>Mus musculus</italic> (mm9 and mm10). Gene reference can be easily generated for every genome of interest, and also custom gene reference can be used.</p></list-item><list-item><p id="Par29">A 2-column gene expression table containing the name of each gene and its normalized expression value (FPKM, TPM, etc.). This table can be optional.</p></list-item></list></p>
      <p id="Par30">Besides the three input data, other custom parameters can be provided:<list list-type="bullet"><list-item><p id="Par31">The size of upstream and downstream regions.</p></list-item><list-item><p id="Par32">The gene expression threshold to consider a gene as expressed.</p></list-item><list-item><p id="Par33">The number of shuffle samples to perform the randomization analysis.</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>Output data format</title>
      <p id="Par34">DROPA output consists of a folder containing table and image files.</p>
      <p id="Par35">The main table file result is the “<italic>annotation.table</italic>” that contains, for every annotated peak:<list list-type="bullet"><list-item><p id="Par36">Peak coordinates: chromosome, peak start, peak end;</p></list-item><list-item><p id="Par37">Peak name, as in the input file;</p></list-item><list-item><p id="Par38">Name of the gene, his strand and his expression value, as in the reference;</p></list-item><list-item><p id="Par39">Which features of the gene are covered by the peak (Upstream, 5’UTR, Exon, Intron, 3’UTR, Downstream).</p></list-item><list-item><p id="Par40">A warning flag if the peak is localized in a region in which antisense R-loops can form.</p></list-item></list></p>
      <p id="Par41">DROPA provides other secondary table files, such as the list of intergenic peaks and summary tables used to create plot figures. Figures and the annotation.table are provided in three version: the “expressed” in which are reported results for peaks annotated to genes with expression value above the threshold, the “unexpressed” in which are reported the ones annotated to genes with expression value below the threshold, and the “merged” which reports the aggregation of the previous two.</p>
      <p id="Par42">DROPA produces many informative summary plots, regarding the percentage of peaks overlapping each genic feature (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), or their proportion as a pie chart (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Furthermore, since many peaks usually overlap more than one feature, DROPA provides a plot in which is shown the number of peaks that overlap each combination of feature (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Finally, if enrichment analysis is performed, it is provided a histogram (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) with standard deviations bars and <italic>p</italic>-value of a chi-squared contingency test, showing the fold enrichment for each gene feature, calculated as the ratio between the number of query peaks that overlap a feature and the mean number of randomly shuffled peaks.<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Histogram showing the percentage (and the number in legend) of peaks that overlap each feature. <bold>b</bold> Pie chart showing the proportion of peak that overlap each feature (and the number in legend). <bold>c</bold> Upset plot showing how many peaks overlap more than one feature. <bold>d</bold> Histogram showing the fold enrichment between the number of peaks annotated to each feature and number of peaks shuffled over the genome</p></caption><graphic xlink:href="12859_2019_3009_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Availability</title>
      <p id="Par43">DROPA package can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/marcrusso/DROPA">https://github.com/marcrusso/DROPA</ext-link>.</p>
    </sec>
    <sec id="Sec7">
      <title>Installation</title>
      <p id="Par44">Detailed installation guide for DROPA and all python libraries required is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/marcrusso/DROPA">https://github.com/marcrusso/DROPA</ext-link>. (see also Additional file <xref rid="MOESM1" ref-type="media">1</xref> for DROPA requirements)</p>
    </sec>
    <sec id="Sec8">
      <title>Launching</title>
      <p id="Par45">To launch DROPA with default settings this command can be used:</p>
      <p id="Par46">python3 DROPA_v1.0.0.py -ref GeneReference/GeneReferenceSet/ -o OutputFolderName QueryPeak.bed</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Influence of expression data metrics on DROPA</title>
      <p id="Par47">As the main feature of DROPA is peak annotation using expression levels, we tested whether different expression metrics (TPM and FPKM) lead to different annotation output. In this analysis, the same default settings were used. The comparison showed that using TPMs more peaks (212, 1.3%) were assigned to expressed genes. However, all other peaks (15,872, 98.7%) were assigned to the same gene using FPKM or TPM values (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Overall the results show that using TPM or FPKM substantially leads to very similar overall peak annotation.</p>
    </sec>
    <sec id="Sec11">
      <title>Assessment of DROPA performance</title>
      <p id="Par48">To assess the correct annotation rate of DROPA, we determined the correct assignment of a query dataset of DRIPc-seq peaks [<xref ref-type="bibr" rid="CR11">11</xref>] to the DNA template strand. DRIPc is a DRIP technique variant that maintains the strand information of DNA:RNA hybrid peaks. Our comparison shows that, when DROPA assigns peaks based on gene expression (76,526 peaks, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), 88.6% (67,796) of them are assigned correctly (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Among the 11.4% (8730) of peaks with wrong annotation, we noticed that 5.05% (3871) are in the same position of another DRIPc peaks but in the opposite strand, and another 3.53% (2707) are mapped within 5000 bp upstream or downstream to expressed genes (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). As antisense transcription is known in particular at 5′ and 3′ ends of expressed genes, these analyses suggest that many peaks assigned to the wrong strand are potential antisense R-loops [<xref ref-type="bibr" rid="CR11">11</xref>]. Therefore, if we consider only the transcribed regions of a gene, DROPA efficiency is 93.8% (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). In order to warn the user about peaks that can be ambiguously assigned as they map in regions where antisense R-loop can form, we provide: i) specific output tables of these peaks and ii) warning flags to these peaks in the main output tables, leaving therefore the user the option to exclude them for further analysis.</p>
    </sec>
    <sec id="Sec12">
      <title>DROPA comparison with existing tools</title>
      <p id="Par49">To assess DROPA performance, we compared it with three widely used or recent annotation tools: HOMER [<xref ref-type="bibr" rid="CR12">12</xref>], PAVIS [<xref ref-type="bibr" rid="CR13">13</xref>] and UROPA [<xref ref-type="bibr" rid="CR14">14</xref>], which are based on different algorithms. PAVIS and HOMER annotate peaks based on the nearest TSS (Transcription Start Site), while UROPA allows to choose between the nearest start, end or center of the reference region. DROPA annotates all gene features (UTR regions, exons, introns, etc.) overlapping to peaks, while HOMER and PAVIS select one gene feature only. This may limit the biologically relevant information of HOMER and PAVIS output data when query peaks have a size larger than the gene features.</p>
      <p id="Par50">DROPA is highly flexible and customizable. DROPA, PAVIS and Homer have default gene reference sets that make these tools ready-to-use: DROPA has human (hg19) and mouse (mm9, mm10) genome as default, while PAVIS has gene sets of many organisms and genome assemblies. However, DROPA allows the choice of any custom gene set. Among the others, only PAVIS does not allow the use of a custom gene reference set. HOMER does not allow to set the size of upstream and downstream gene regions, which is useful while working on peaks that can form kilobases far from a gene, and it is instead customizable with DROPA, PAVIS and UROPA.</p>
      <p id="Par51">DROPA lacks a Graphical User Interface (GUI), however it is easy to use thanks to few and fully described command flags, which make it easily integrable into pipelines. PAVIS, a web-based tool, offers a GUI and requires an Internet connection, while UROPA offers both a command-line tool and a web-based GUI. HOMER is available only as command-line tool.</p>
      <p id="Par52">Although all four tools produce a full annotation table for every query peak, DROPA also produces summary tables and many other plots of peak distribution or enrichment over specific gene features. PAVIS produces a summary table and a pie chart of peak annotations, HOMER provides no plots but only a summary table, while UROPA also produces a summary report with plots.</p>
      <p id="Par53">Feature comparison summary is reported in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Feature comparison between DROPA and PAVIS, HOMER and UROPA</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>DROPA</th><th>PAVIS</th><th>HOMER</th><th>UROPA</th></tr></thead><tbody><tr><td>Offline Usage</td><td>✓</td><td>✗</td><td>✓</td><td>✓</td></tr><tr><td>Pipeline integration</td><td>✓</td><td>✗</td><td>✓</td><td>✓</td></tr><tr><td>Reference gene set customization</td><td>✓</td><td>✗</td><td>✓</td><td>✓</td></tr><tr><td>Upstream/downstream region definition</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td></tr><tr><td>Multiple gene feature annotation</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td></tr><tr><td>Statistical enrichment over gene feature</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td></tr><tr><td>Summary plot Results</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td></tr></tbody></table></table-wrap></p>
      <p id="Par54">We compared the four tools output using an experimental set of R-loops peaks determined by DRIP-seq in human cells [<xref ref-type="bibr" rid="CR6">6</xref>]. Peak calling was performed using MACS and comparisons were carried out using the same gene reference and the same upstream/downstream dimension. Briefly, DROPA gives different annotation results in comparison with all three tools in analysis. A full description of annotation result is reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par55">Intergenic peaks in DROPA data are always fewer compared to HOMER (10.8% of total query peaks versus 17.9% in HOMER), PAVIS (5.7% versus 12.1%) and UROPA (3.3% versus 11.2%). This is mainly due to the fact that DROPA does not take in account only the center of the query peak (that for peaks that have a dimension of kilobases can be far from the gene region) for annotation, but both the start and end point. About 10, 20 and 22% of query peaks are annotated with different genes by DROPA with respect to HOMER, PAVIS and UROPA, respectively.</p>
      <p id="Par56">As R-loop formation is mainly a co-transcriptional phenomenon and PAVIS and HOMER primarily rely on closest TSS, we can argue that DROPA identifies less false positive annotations as compared to PAVIS and HOMER due to the use of expression data (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S2 and S3). Although UROPA annotation does not rely on closest TSS search but rather on overlap, its annotation approach still gives a result clearly different from DROPA one (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4), which, is optimized using gene expression data.</p>
    </sec>
    <sec id="Sec13">
      <title>Limitations</title>
      <p id="Par57">Even though DROPA can define and assign co-transcriptional peaks in the body of expressed genes with good efficiency, its main limitation is the detection and correct assignment of antisense R-loop peaks. To compensate for this limitation, DROPA provides a list of peaks assigned only to the upstream/downstream region of expressed gene, where antisense transcripts can be present. Moreover, in the main annotation table a warning flag indicates either peaks in upstream/downstream regions and peaks located at overlapping expressed genes. A comparison of this information with genomic datasets of antisense transcripts can help the user for further analysis.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par58">DROPA is a full customizable peak annotation tool optimized for co-transcriptional DRIP-seq peaks, allowing a finest gene annotation based on gene expression information. Since the expression data table is optional, this tool can be used with other sequencing data regarding genomic features that are not strictly associated with TSS (for which tools like PAVIS and HOMER are developed) and that are characterized by broad peak dimension, such as Histone marks IP-seq, DNAse-seq and FAIRE-seq. Using DROPA, users can take advantage from its alternative annotation algorithm, based on largest overlap with the query peak, the multi-feature annotation and the informative summary plots.</p>
  </sec>
  <sec id="Sec15">
    <title>Methods</title>
    <p id="Par59">In the following evaluation, DROPA was tested on a machine running Ubuntu OS (vers. 16.04 LTS) with 8 CPU cores and 16 GB of RAM.</p>
    <sec id="Sec16">
      <title>Influence of expression data metrics on DROPA</title>
      <p id="Par60">To perform evaluation of DROPA results using different gene expression values we used an experimental set of DRIP-seq peak (available at GEO: GSE115957) and his relative RNA-seq data. Using Stringtie (REF), TPM and FPKM were computed using RNA-seq data using RefSeq gene reference. Peak dataset and gene expression table are available in DROPA repository as Test_hg19_DRIP_peaks.bed. DROPA was launched two times with default settings using TPM or FPKM table as expression data and hg19_Refseq as gene reference. Results of annotation were compared counting how many peaks were annotated as intergenic and how many peaks were annotated to the same gene.</p>
    </sec>
    <sec id="Sec17">
      <title>Assessment of DROPA performance</title>
      <p id="Par61">To perform evaluation of DROPA using stranded data we downloaded a DRIPc-seq peak dataset and relative RNA-seq data (available at GEO: GSE70189). Peak dataset and gene expression table are available in DROPA repository. DROPA was launched with default settings using as input the peak dataset, the gene expression table and the gene reference hg19_UCSCgenes. Then strandness of peaks annotated on expressed genes was compared with the one of the original dataset.</p>
    </sec>
    <sec id="Sec18">
      <title>DROPA comparison with existing tools</title>
      <p id="Par62">In all 3 comparison we used an experimental set of DRIP-seq peak (available at GEO: GSE115957) and his relative RNA-seq data. Peak dataset and gene expression table are available in DROPA repository as Test_hg19_DRIP_peaks.bed and Test_hg19_RefSeq_Expression. Since each tool has different degree of customization (fixed upstream/downstream dimension, gene reference selection, etc.), we adapted DROPA settings to the one of the tool in analysis. In comparison with HOMER, DROPA was launched with upstream/downstream region dimensions set to 1 kb and RefSeq gene reference. HOMER was launched with default settings. In comparison with PAVIS, DROPA was launched with default settings and UCSCknown gene reference, while PAVIS was launched setting the Upstream/Downstream region to 5 kb (same as DROPA default). In comparison with UROPA, DROPA was launched with default settings and Ensembl gene reference, while UROPA was launched setting the Upstream/Downstream region to 5 kb. In all three comparison, after peak annotation, results were compared counting how many peaks were annotated as intergenic and how many peaks were annotated to the same gene.</p>
    </sec>
    <sec id="Sec19">
      <title>Availability and requirements</title>
      <p id="Par63"><bold>Project name:</bold> DROPA</p>
      <p id="Par64"><bold>Project home page:</bold> Source code on <ext-link ext-link-type="uri" xlink:href="https://github.com/marcrusso/DROPA">https://github.com/marcrusso/DROPA</ext-link></p>
      <p id="Par65"><bold>Operating system:</bold> Unix (Linux or Mac OS or Windows Subsystem for Linux)</p>
      <p id="Par66"><bold>Programming language:</bold> Python3</p>
      <p id="Par67"><bold>Other requirements:</bold> All Python libraries requirements are listed in Supplementary. Bedtools software is required for peak randomization.</p>
      <p id="Par68"><bold>License:</bold> MIT license</p>
      <p id="Par69"><bold>Any restrictions to use by non-academics:</bold> None.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3009_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>Supplementary file containing DROPA requirements, summary tables and figures ragarding comparison results and a benchmark section. (DOCX 734 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BED</term>
        <def>
          <p id="Par4">Browser Extensible Data</p>
        </def>
      </def-item>
      <def-item>
        <term>ChIP-seq</term>
        <def>
          <p id="Par5">Chromatin Immunoprecipitation</p>
        </def>
      </def-item>
      <def-item>
        <term>DRIP</term>
        <def>
          <p id="Par6">DNA:RNA Immuno Precipitation</p>
        </def>
      </def-item>
      <def-item>
        <term>DROPA</term>
        <def>
          <p id="Par7">DRIP Optimized Peak Annotator</p>
        </def>
      </def-item>
      <def-item>
        <term>FPKM</term>
        <def>
          <p id="Par8">Fragments Per Kilobase Million</p>
        </def>
      </def-item>
      <def-item>
        <term>MACS</term>
        <def>
          <p id="Par9">Model-based Analysis of ChIP-Seq</p>
        </def>
      </def-item>
      <def-item>
        <term>ssDNA</term>
        <def>
          <p id="Par10">Single-strand DNA</p>
        </def>
      </def-item>
      <def-item>
        <term>TPM</term>
        <def>
          <p id="Par11">Transcripts Per Million</p>
        </def>
      </def-item>
      <def-item>
        <term>TSS</term>
        <def>
          <p id="Par12">Transcription Start Site</p>
        </def>
      </def-item>
      <def-item>
        <term>UTR</term>
        <def>
          <p id="Par13">Untranslated Region</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We wish to thank all the members of the laboratory for the helpful discussion.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MR and GCa conceived the idea and wrote the manuscript. MR, BDL, TF and SG developed DROPA. MR conducted DROPA comparison with other tools and interpreted the data. GCh revised the tool algorithms. All authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by Associazione Italiana per la Ricerca sul Cancro, Milan [IG15886 to G. Capranico] and University of Bologna PhD fellowship program [to M.R.]. The funding bodies did not influence the design of the study and collection, analysis, and interpretation of data or writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>DROPA repository containing source code, installation guide and usage information is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/marcrusso/DROPA">https://github.com/marcrusso/DROPA</ext-link>.</p>
    <p>The datasets analyzed during the current study are available in the DROPA repository.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par70">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par71">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par72">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chédin</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Nascent connections: R-loops and chromatin patterning</article-title>
        <source>Trends Genet</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>828</fpage>
        <lpage>838</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2016.10.002</pub-id>
        <?supplied-pmid 27793359?>
        <pub-id pub-id-type="pmid">27793359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santos-Pereira</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Aguilera</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>R loops: new modulators of genome dynamics and function</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>583</fpage>
        <lpage>597</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3961</pub-id>
        <?supplied-pmid 26370899?>
        <pub-id pub-id-type="pmid">26370899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crossley</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Bocek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cimprich</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>R-loops as cellular regulators and genomic threats</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <fpage>398</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.01.024</pub-id>
        <?supplied-pmid 30735654?>
        <pub-id pub-id-type="pmid">30735654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ginno</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Lott</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Korf</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chédin</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>R-loop formation is a distinctive characteristic of Unmethylated human CpG Island promoters</article-title>
        <source>Mol Cell</source>
        <year>2012</year>
        <volume>45</volume>
        <fpage>814</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2012.01.017</pub-id>
        <?supplied-pmid 22387027?>
        <pub-id pub-id-type="pmid">22387027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzo</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Hartono</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Sanz</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Marinello</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>De Biasi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cossarizza</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA topoisomerase I differentially modulates R-loops across the human genome</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1478-1</pub-id>
        <?supplied-pmid 30060749?>
        <pub-id pub-id-type="pmid">30060749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Magis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Manzo</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Russo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marinello</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Morigi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sordet</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA damage and genome instability by G-quadruplex ligands are mediated by R loops in human cancer cells</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>816</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1810409116</pub-id>
        <?supplied-pmid 30591567?>
        <pub-id pub-id-type="pmid">30591567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamperl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bocek</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Saldivar</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Swigut</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cimprich</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Transcription-replication conflict orientation modulates R-loop levels and activates distinct DNA damage responses</article-title>
        <source>Cell.</source>
        <year>2017</year>
        <volume>170</volume>
        <fpage>774</fpage>
        <lpage>786.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.07.043</pub-id>
        <?supplied-pmid 28802045?>
        <pub-id pub-id-type="pmid">28802045</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <?supplied-pmid 2592715?>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Software for computing and annotating genomic ranges</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003118</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id>
        <?supplied-pmid 23950696?>
        <pub-id pub-id-type="pmid">23950696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics.</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <?supplied-pmid 20110278?>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanz</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Hartono</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Steyaert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rajpurkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ginno</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prevalent, dynamic, and conserved R-loop structures associate with specific Epigenomic signatures in mammals</article-title>
        <source>Mol Cell</source>
        <year>2016</year>
        <volume>63</volume>
        <fpage>167</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2016.05.032</pub-id>
        <?supplied-pmid 27373332?>
        <pub-id pub-id-type="pmid">27373332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Laslo</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <?supplied-pmid 2898526?>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Loganantharaj</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Fargo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>PAVIS: a tool for peak annotation and visualization</article-title>
        <source>Bioinformatics.</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>3097</fpage>
        <lpage>3099</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt520</pub-id>
        <?supplied-pmid 24008416?>
        <pub-id pub-id-type="pmid">24008416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kondili</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fust</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Preussner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuenne</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Looso</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>UROPA: a tool for universal RObust peak annotation</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>2593</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-02464-y</pub-id>
        <?supplied-pmid 28572580?>
        <pub-id pub-id-type="pmid">28572580</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
