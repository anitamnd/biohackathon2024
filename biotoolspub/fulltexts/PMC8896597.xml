<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8896597</article-id>
    <article-id pub-id-type="pmid">34927666</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab847</article-id>
    <article-id pub-id-type="publisher-id">btab847</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Identifying cancer pathway dysregulations using differential causal effects</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4166-4343</contrib-id>
        <name>
          <surname>Jablonski</surname>
          <given-names>Kim Philipp</given-names>
        </name>
        <aff><institution>Department of Biosystems Science and Engineering, ETH Zurich</institution>, 4058 Basel, <country country="CH">Switzerland</country></aff>
        <aff><institution>SIB Swiss Institute of Bioinformatics</institution>, 4058 Basel, <country country="CH">Switzerland</country></aff>
        <xref rid="btab847-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6986-0813</contrib-id>
        <name>
          <surname>Pirkl</surname>
          <given-names>Martin</given-names>
        </name>
        <aff><institution>Department of Biosystems Science and Engineering, ETH Zurich</institution>, 4058 Basel, <country country="CH">Switzerland</country></aff>
        <aff><institution>SIB Swiss Institute of Bioinformatics</institution>, 4058 Basel, <country country="CH">Switzerland</country></aff>
        <xref rid="btab847-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ćevid</surname>
          <given-names>Domagoj</given-names>
        </name>
        <aff><institution>Seminar for Statistics, ETH Zürich</institution>, 8092 Zürich, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bühlmann</surname>
          <given-names>Peter</given-names>
        </name>
        <aff><institution>Seminar for Statistics, ETH Zürich</institution>, 8092 Zürich, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0573-6119</contrib-id>
        <name>
          <surname>Beerenwinkel</surname>
          <given-names>Niko</given-names>
        </name>
        <xref rid="btab847-cor1" ref-type="corresp"/>
        <aff><institution>Department of Biosystems Science and Engineering, ETH Zurich</institution>, 4058 Basel, <country country="CH">Switzerland</country></aff>
        <aff><institution>SIB Swiss Institute of Bioinformatics</institution>, 4058 Basel, <country country="CH">Switzerland</country></aff>
        <!--niko.beerenwinkel@bsse.ethz.ch-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btab847-FM1">
        <label>†</label>
        <p>The authors wish it to be known that, in their opinion, the Kim Philipp Jablonski and Martin Pirkl should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btab847-cor1">To whom correspondence should be addressed. <email>niko.beerenwinkel@bsse.ethz.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-12-20">
      <day>20</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>6</issue>
    <fpage>1550</fpage>
    <lpage>1559</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>27</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab847.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Signaling pathways control cellular behavior. Dysregulated pathways, for example, due to mutations that cause genes and proteins to be expressed abnormally, can lead to diseases, such as cancer.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce a novel computational approach, called Differential Causal Effects (<italic toggle="yes">dce</italic>), which compares normal to cancerous cells using the statistical framework of causality. The method allows to detect individual edges in a signaling pathway that are dysregulated in cancer cells, while accounting for confounding. Hence, technical artifacts have less influence on the results and <italic toggle="yes">dce</italic> is more likely to detect the true biological signals. We extend the approach to handle unobserved dense confounding, where each latent variable, such as, for example, batch effects or cell cycle states, affects many covariates. We show that <italic toggle="yes">dce</italic> outperforms competing methods on synthetic datasets and on CRISPR knockout screens. We validate its latent confounding adjustment properties on a GTEx (Genotype–Tissue Expression) dataset. Finally, in an exploratory analysis on breast cancer data from TCGA (The Cancer Genome Atlas), we recover known and discover new genes involved in breast cancer progression.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The method <italic toggle="yes">dce</italic> is freely available as an R package on Bioconductor (<ext-link xlink:href="https://bioconductor.org/packages/release/bioc/html/dce.html" ext-link-type="uri">https://bioconductor.org/packages/release/bioc/html/dce.html</ext-link>) as well as on <ext-link xlink:href="https://github.com/cbg-ethz/dce" ext-link-type="uri">https://github.com/cbg-ethz/dce</ext-link>. The GitHub repository also contains the Snakemake workflows needed to reproduce all results presented here.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>SystemsX.ch</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012390</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swiss Initiative in Systems Biology</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012390</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>RTD 2013/152</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>TargetInfectX—Multi-Pronged Perturbation of Pathogen Infection in Human Cells</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swiss National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001711</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>ERC Synergy Grant</institution>
          </institution-wrap>
        </funding-source>
        <award-id>609883</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council (ERC)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>786461</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The complexity of cancer makes finding reliable diagnosis and treatment options a difficult task. Decades of research have improved our understanding of this intractable disease. However, many challenges remain due to its high variability and context specificity, e.g. regarding tissue and cell type (<xref rid="btab847-B27" ref-type="bibr">Nature Cancer, 2020</xref>). Patients with common cancer types in early stages show promising survival rates, even though rare subtypes still show low survival rates due to different traits like a more aggressive disease progression (<xref rid="btab847-B15" ref-type="bibr">Hawkes, 2019</xref>; <xref rid="btab847-B25" ref-type="bibr">Miller <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab847-B48" ref-type="bibr">Troester and Swift-Scanlan, 2009</xref>).</p>
    <p>It has been hypothesized that cancer diversity can at least in part be explained by heterogeneous mutational patterns. These patterns influence the activity of biological pathways at the cellular level (<xref rid="btab847-B19" ref-type="bibr">Khakabimamaghani <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab847-B14" ref-type="bibr">Hanahan and Weinberg, 2011</xref>). For example, signaling pathways consist of several genes, which regulate certain cell programs, such as growth or apoptosis. The programs are driven by the causal interaction between the genes, e.g. the up-regulation of one causes the up-regulation of another gene. The causal effect (CE) determines the strength of this causal interaction, e.g. by increasing the expression of gene <italic toggle="yes">X</italic> twofold, the expression of its child <italic toggle="yes">Y</italic> increases fourfold. Thus, <italic toggle="yes">X</italic> has a causal effect on <italic toggle="yes">Y</italic> of 2 (<xref rid="btab847-B32" ref-type="bibr">Pearl, 2000</xref>). Understanding how these causal networks are perturbed in tumors is necessary for prioritizing drug targets, understanding inter-patient heterogeneity and detecting driver mutations (<xref rid="btab847-B51" ref-type="bibr">Vogelstein <italic toggle="yes">et al.</italic>, 2013</xref>).</p>
    <p>Traditionally, perturbed pathways are detected by assessing whether differentially expressed genes are members of the respective pathway more often than expected by chance. More sophisticated methods measure whether genes belonging to a pathway are localized at certain positions of a rank-ordered set of differentially expressed genes (<xref rid="btab847-B45" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>). In such cases, a pathway is interpreted as a simple set of genes and all topological information concerning the functional interconnectivity of genes is ignored. It has been recognized that interactions among genes can have a significant effect on the computation of pathway enrichments. Some tools consider, for example, gene expression correlations to account for confounding effects and control the type I error rate while retaining good statistical power (<xref rid="btab847-B58" ref-type="bibr">Wu and Smyth, 2012</xref>). The underlying structure of gene interactions can thus be either estimated from the data used for the enrichment analysis (<xref rid="btab847-B43" ref-type="bibr">Spirtes <italic toggle="yes">et al.</italic>, 2000</xref>; <xref rid="btab847-B40" ref-type="bibr">Sedgewick <italic toggle="yes">et al.</italic>, 2016</xref>), or obtained from existing databases. Canonical pathway databases such as the Kyoto Encyclopedia of Genes and Genomes (KEGG) (<xref rid="btab847-B30" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic>, 1999</xref>) can then be incorporated as prior knowledge to guide the enrichment analysis using topological information of gene connectivity (<xref rid="btab847-B22" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab847-B7" ref-type="bibr">Dutta <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab847-B46" ref-type="bibr">Tarca <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab847-B36" ref-type="bibr">Saez-Rodriguez <italic toggle="yes">et al.</italic>, 2009</xref>).</p>
    <p>While such enrichment methods go beyond treating pathways as plain gene sets and incorporate topological information of molecular interactions, they often only report a global pathway dysregulation score (<xref rid="btab847-B46" ref-type="bibr">Tarca <italic toggle="yes">et al.</italic>, 2009</xref>). An exception is PARADIGM, which records an inferred activity for each entity in the pathway under consideration for a given patient sample (<xref rid="btab847-B49" ref-type="bibr">Vaske <italic toggle="yes">et al.</italic>, 2010</xref>). It does, however, not model causal effects, but only quantifies whether there is some general association among the genes like correlation. Differential causal effects (DCEs) on biological pathways have already been investigated in a formal setting (<xref rid="btab847-B53" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab847-B16" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab847-B47" ref-type="bibr">Tian <italic toggle="yes">et al.</italic>, 2016</xref>), where a DCE is modeled as the difference between CEs for the same edge under two conditions. These methods infer the gene network from observational data, which is a difficult task due to the combination of typically low sample size and noise of real data. An incorrect network can result in biased estimation of CEs and DCEs. Additionally, none of these methods make use of the estimated DCEs to compute a pathway enrichment score.</p>
    <p>Here, we separate the problem of estimating the causal network and the CEs by replacing the former with the addition of prior knowledge in the form of biological pathways readily available in public databases (<xref rid="btab847-B30" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic>, 1999</xref>; <xref rid="btab847-B28" ref-type="bibr">Nishimura, 2001</xref>; <xref rid="btab847-B55" ref-type="bibr">Whirl-Carrillo <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab847-B24" ref-type="bibr">Mi <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btab847-B38" ref-type="bibr">Schaefer <italic toggle="yes">et al.</italic>, 2009</xref>). We make use of the general concept of causal effects in order to define differential CEs. Specifically, we estimate the CE of gene <italic toggle="yes">X</italic> on gene <italic toggle="yes">Y</italic> in normal samples and cancer samples and define the DCE as their difference. In particular, we compare the causal effects between two conditions, such as a malignant tissue from a tumor and a healthy tissue, to detect differences in the gene interactions. We propose Differential Causal Effects (<italic toggle="yes">dce</italic>), a new method which computes the DCE for every edge (i.e. molecular interaction) of a pathway for two given conditions based on gene expression data (<xref rid="btab847-F1" ref-type="fig">Fig.  1</xref>). </p>
    <fig position="float" id="btab847-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>A causal network of genetic interactions in a biological pathway (<bold>a</bold>) is responsible for the observed wild-type expression levels in a cell (<bold>b</bold>: wild-type). A disease can lead to perturbations of these pathways and in turn generate altered expression levels (B: mutant). Pathway databases such as KEGG (<xref rid="btab847-B30" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic>, 1999</xref>), PharmGKB (<xref rid="btab847-B55" ref-type="bibr">Whirl-Carrillo <italic toggle="yes">et al.</italic>, 2012</xref>) and Panther (<xref rid="btab847-B24" ref-type="bibr">Mi <italic toggle="yes">et al.</italic>, 2021</xref>) curate genetic interaction data (<bold>c</bold>) and thus provide networks of putative causal interactions (<bold>d</bold>). Given the observed wild-type and disease expression levels as well as the causal structure, <italic toggle="yes">dce</italic> fits a generalized linear model (GLM) for each edge to estimate differential causal effects (<bold>e</bold>). In the given example, the differential causal effect from <italic toggle="yes">X</italic> on <italic toggle="yes">Y</italic> (solid edge) is estimated using the valid adjustment set {<italic toggle="yes">Z</italic>} (as determined from the dashed edges). These differential causal effects correspond to causal perturbations, i.e. differences in causal effects between two conditions. For example, an increase of causal effect strength from wild-type to mutant is marked in blue, whereas the negative differential causal effects are marked in red (the transparency of an edge corresponds to the magnitude of the associated effect). These features are important for diagnosis and treatment design (<bold>f</bold>)</p>
      </caption>
      <graphic xlink:href="btab847f1" position="float"/>
    </fig>
    <p>This allows us to identify pathway perturbations at the individual edge level while controlling for confounding factors using the statistical framework of causality. By including the additional covariates constructed from the principal components of the design matrix, we also provide a methodological extension of our method to handle potential unobserved confounding that is dense, i.e. where the confounding variable affects many (though not necessarily all) covariates. For example, batch effects from different experimental laboratories or cell cycle stages are not necessarily known, but are accounted for automatically. Our approach allows for computing pathway enrichments in order to rank all networks in large pathway databases to identify cancer specific dysregulated pathways. In this manner, we can detect pathways which play a prominent role in tumorigenesis and pinpoint specific interactions in the pathway that make a large contribution to its dysregulation and the disease phenotype.</p>
    <p>We show that <italic toggle="yes">dce</italic> can recover significant DCEs and outperforms competitors in simulations. In a validation on real data, we apply <italic toggle="yes">dce</italic> to a public CRISPR (Clustered Regularly Interspaced Short Palindromic Repeats) dataset to recover differential effects in the network. We validate the methodological extension for latent confounding adjustment on simulated data and also on real data from the Genotype–Tissue Expression (GTEx) project (<xref rid="btab847-B23" ref-type="bibr">Lonsdale <italic toggle="yes">et al.</italic>, 2013</xref>). In an exploratory study, we apply <italic toggle="yes">dce</italic> to breast cancer samples and compare the DCEs among different cancer stages. We identify dysregulated edges common across stages as well as stage-specific edges.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>In this section, we describe the Differential Causal Effects (<italic toggle="yes">dce</italic>) method. We briefly review the causality framework and then introduce the model and computation of DCEs, including under potential latent ‘dense’ confounding. We provide implementation details for obtaining both the estimates and their significance levels. Then, we describe the generating mechanism for synthetic data used throughout the article. We explain the setup of our Perturb-seq validation, as well as the validation of the latent confounding adjustment on the GTEx dataset. Finally, we describe the results of the exploratory The Cancer Genome Atlas (TCGA) analysis.</p>
    <p><italic toggle="yes">Causality of biological pathways</italic>. First, we give a quick review of causality in the context of biological pathways. A gene pathway can be represented as a structural equation model (SEM) consisting of a directed acyclic graph (DAG) <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> with nodes <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> describing the expression of genes, a set of directed edges <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> representing the causal structure and the structural equations <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> describing how each variable <italic toggle="yes">X<sub>i</sub></italic> is generated from its parents <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are jointly independent noise variables. The causal interpretation of an edge between any two nodes is as follows: changing the expression of a parent <italic toggle="yes">X<sub>j</sub></italic> affects the expression of the child node <italic toggle="yes">X<sub>i</sub></italic>, which is propagated further to all descendants. The parental sets are given by the edge set <italic toggle="yes">E</italic>. Of particular interest are the interventional distributions for the SEM, in particular their expectations <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, which describe how the expected value of the variable <italic toggle="yes">X<sub>i</sub></italic> changes when we intervene and set the variable <italic toggle="yes">X<sub>j</sub></italic> to some fixed value <italic toggle="yes">x</italic>. We define the causal effect (CE) of a variable <italic toggle="yes">X<sub>j</sub></italic> on its descendant <italic toggle="yes">X<sub>i</sub></italic> as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>This derivative equals <italic toggle="yes">β<sub>x</sub></italic> if, by changing the value of <italic toggle="yes">X<sub>j</sub></italic> from <italic toggle="yes">x</italic> to <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, for some small value <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, the value of <italic toggle="yes">X<sub>i</sub></italic> changes on average by <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mo>Δ</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>. In the literature, the CE is often also referred to as the total causal effect, because it quantifies the overall effect of an intervention at variable <italic toggle="yes">X<sub>j</sub></italic> on all of its descendants. We are interested in differential causal effects (DCE) defined as the differences between the causal effects of two conditions of interest, such as, e.g. two different cancer stages or healthy and cancerous samples.</p>
    <p><italic toggle="yes">Linearity of the conditional mean</italic>. We model the relationship between the mean of any gene expression <italic toggle="yes">X<sub>i</sub></italic> and its parents <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> by a linear function:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>Conditionally on <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the error term <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> has mean zero and variance depending on <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. A prime example is any generalized linear model (GLM) with identity link function. The coefficients <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> correspond to the direct causal effects, whereas the total causal effects (1) measure the aggregate effect over all directed paths from a certain variable <italic toggle="yes">X<sub>j</sub></italic> to <italic toggle="yes">X<sub>i</sub></italic> in <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>.</p>
    <p>Let us consider two arbitrary genes <italic toggle="yes">X<sub>i</sub></italic> and <italic toggle="yes">X<sub>j</sub></italic> in the pathway. Under the linearity assumption (2), the causal effect <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> does not depend on <italic toggle="yes">x</italic>. Furthermore, this causal effect corresponds to the coefficient <italic toggle="yes">β</italic> in the linear regression of <italic toggle="yes">X<sub>i</sub></italic> on <italic toggle="yes">X<sub>j</sub></italic> and an adjustment set <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>,
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>β</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>η</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>Here, <italic toggle="yes">β</italic><sub>0</sub> denotes the intercept and <italic toggle="yes">η</italic> is random noise with mean zero (<xref rid="btab847-B11" ref-type="bibr">Goldszmidt and Pearl, 1992</xref>; <xref rid="btab847-B31" ref-type="bibr">Pearl, 1995</xref>). The adjustment set <italic toggle="yes">Z</italic> is a set of nodes in the pathway <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> which fulfills the Back-door criterion (<xref rid="btab847-B32" ref-type="bibr">Pearl, 2000</xref>). Hence, it holds that no element of <italic toggle="yes">Z</italic> is a descendant of <italic toggle="yes">X<sub>j</sub></italic>, and <italic toggle="yes">Z</italic> blocks every path between <italic toggle="yes">X<sub>i</sub></italic> and <italic toggle="yes">X<sub>j</sub></italic> that contains an edge with <italic toggle="yes">X<sub>j</sub></italic> as the child. For example, the parent set <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> always fulfills the Back-door criterion and we always use it as the adjustment set.</p>
    <p>If the causal effects of the gene expression <italic toggle="yes">X<sub>j</sub></italic> on the gene expression <italic toggle="yes">X<sub>i</sub></italic> are, respectively, denoted as <italic toggle="yes">β<sup>A</sup></italic> and <italic toggle="yes">β<sup>B</sup></italic> under different conditions <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic>, then the differential causal effect (DCE) <italic toggle="yes">δ</italic> is obtained as the difference
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>Given a graph <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> describing a biological pathway and observations of the variables, we can compute all differential causal effects and identify interactions between any such two variables <italic toggle="yes">X<sub>j</sub></italic> and <italic toggle="yes">X<sub>i</sub></italic> that are different between the two conditions (<xref rid="btab847-F1" ref-type="fig">Fig.  1</xref>).</p>
    <p><italic toggle="yes">Testing for significance</italic>. We can compute the DCE <italic toggle="yes">δ</italic> for the edge <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by fitting a joint model for both conditions, which also allows us to easily compute the significance of the estimates. Let <italic toggle="yes">I</italic> be an indicator random variable, which is equal to 1, if the observation comes from condition A, and 0, if it comes from condition <italic toggle="yes">B</italic>. The DCE <italic toggle="yes">δ</italic> can be computed from all samples jointly by fitting the following linear model
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mi>A</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mi>B</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>η</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>with interaction terms <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The differential causal effect <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> can be estimated by using the coefficient estimate corresponding to the interaction term <italic toggle="yes">IX<sub>j</sub></italic> in (5).</p>
    <p>Testing the significance of the estimated DCEs now corresponds to the well-known task of testing the significance of coefficient estimates in a linear model. However, some care is needed if the variances of the error terms <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in our structural <xref rid="E2" ref-type="disp-formula">Equations (2)</xref> indeed depend on the values of the predictors <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, i.e. if there is a certain mean-variance relationship for the gene expression levels, as has been described for RNA-seq data (<xref rid="btab847-B35" ref-type="bibr">Robinson and Smyth, 2007</xref>). In this case, the linear model (5) is heteroscedastic and the usual formulae for standard errors of the coefficient estimates, that result in t-tests for the significance, do not apply. We, therefore, use heteroscedasticity-consistent standard errors that yield asymptotically valid confidence intervals and <italic toggle="yes">P</italic>-values regardless of the dependence of the noise level on predictor values (<xref rid="btab847-B8" ref-type="bibr">Eicker, 1967</xref>; <xref rid="btab847-B17" ref-type="bibr">Huber <italic toggle="yes">et al.</italic>, 1967</xref>; <xref rid="btab847-B56" ref-type="bibr">White, 1980</xref>).</p>
    <p>Besides assessing significance of DCEs for single edges, we can also calculate a global <italic toggle="yes">P</italic>-value measuring the overall dysregulation of a given pathway <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>: we combine the <italic toggle="yes">P</italic>-values corresponding to different differential causal effects <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> by taking their harmonic mean (<xref rid="btab847-B12" ref-type="bibr">Good, 1958</xref>).</p>
    <p><italic toggle="yes">Adjusting for latent confounding</italic>. A fundamental assumption for most of causal inference methods is that there is no unobserved confounding, i.e. that there are no unmeasured factors affecting both the cause and the effect (<xref rid="btab847-B21" ref-type="bibr">Leek <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab847-B10" ref-type="bibr">Gagnon-Bartsch <italic toggle="yes">et al.</italic>, 2013</xref>). Such unobserved confounders could be, for example, batch effects, cell cycle stages, varying laboratory conditions, different patient demographics, etc. Although some methods exist for accounting for measured confounding (<xref rid="btab847-B60" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2020</xref>), unobserved confounding is much more challenging. Presence of latent confounding can result in spurious correlations and false causal conclusions. Therefore, adjusting for potential latent confounding is crucial for making the method robust in applications to biological data (<xref rid="btab847-B2" ref-type="bibr">Ćevid <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>Some information about latent factors can often be obtained from the principal components of the data (<xref rid="btab847-B29" ref-type="bibr">Novembre and Stephens, 2008</xref>). This can be made rigorous under the linearity assumption (2) for our structural equation model <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>, as follows. We assume that there are <italic toggle="yes">q</italic> latent variables <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> affecting our data. We extend the model (2) to include the latent confounding as follows:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>that is, the latent confounders <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are additional source nodes in the DAG <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> and affect genes in the pathway linearly, analogously to (2). Not every gene needs to be affected (<inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> could be zero), but the methodology works better when many genes are affected, see discussion below. By writing the structural <xref rid="E6" ref-type="disp-formula">Equations (6)</xref> in matrix form, where we define the matrices <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we obtain
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msubsup><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which gives
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>intercepts</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mi>H</mml:mi><mml:munder><mml:munder><mml:mrow><mml:mo>Δ</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>loadings</mml:mtext><mml:mo> </mml:mo><mml:mo>∈</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>random</mml:mtext><mml:mo> </mml:mo><mml:mtext>noise</mml:mtext><mml:mo> </mml:mo><mml:mtext>with</mml:mtext><mml:mo> </mml:mo><mml:mtext>mean</mml:mtext><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which is the standard linear factor model with heteroscedastic errors. From this representation, one can see that <italic toggle="yes">H</italic> can be determined from the principal components of <italic toggle="yes">X</italic> (<xref rid="btab847-F2" ref-type="fig">Fig.  2</xref>). The scree plot for a toy example visualizes the effect of latent variables having a global effect on the data. The first principal components are clearly separated from the rest, if latent factors are present (<xref rid="btab847-F2" ref-type="fig">Fig.  2</xref>, left). Therefore, we obtain the confounding proxies <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> as the scores of the first <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> principal components of the design matrix combining the data from both conditions.</p>
    <fig position="float" id="btab847-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>The scree plot (of synthetic data generated as described in the Materials and Methods section) shows that in presence of latent confounding as in (6), the first <italic toggle="yes">q</italic> principal components explain much more variability of the data, which we exploit for confounding adjustment</p>
      </caption>
      <graphic xlink:href="btab847f2" position="float"/>
    </fig>
    <p>The confounding proxies <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are then simply added to the adjustment set <italic toggle="yes">Z</italic>, see <xref rid="E3" ref-type="disp-formula">Equations (3)</xref> and <xref rid="E5" ref-type="disp-formula">(5)</xref>. In this way, the Back-door adjustment not only adjusts for the confounding variables observed in the DAG <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> as before, but also helps reducing the bias induced by latent confounding.</p>
    <p>The deconfounding methodology relies on the assumption that every confounding variable affects many variables in the dataset, i.e. the confounding is dense (<xref rid="btab847-B13" ref-type="bibr">Guo <italic toggle="yes">et al.</italic>, 2020</xref>). This condition is to some extent necessary, because in the case when the latent confounders affect only a few covariates, it is not identifiable whether the resulting association between them could be causal or is due to confounding. We emphasize that not every covariate needs to be affected by each confounder. However, the more covariates each latent factor <italic toggle="yes">H<sub>i</sub></italic> affects, the more information we have about it in the data and thus the confounding proxies <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> capture the effect of the confounders <italic toggle="yes">H</italic> better. Furthermore, the dense confounding assumption ensures that the scree plot, showing the singular values of the design matrix, has a spiked structure, as several latent factors can explain a relatively large proportion of the variance (<xref rid="btab847-F2" ref-type="fig">Fig.  2</xref>). This helps estimating the number <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of the confounding proxies used. As a default choice, we use a permutation method that can be shown to work well under certain assumptions (<xref rid="btab847-B6" ref-type="bibr">Dobriban, 2017</xref>) and which compares the observed value of the variance explained by the principal components with its expected value over many random permutations of the values in each column of gene expression matrix <italic toggle="yes">X</italic>.</p>
    <p><italic toggle="yes">Algorithm and implementation in R</italic>. The presented methods are implemented in the R package <italic toggle="yes">dce</italic> which is freely available on Bioconductor. The function <italic toggle="yes">dce::dce</italic> takes as input the structure of a biological pathway, i.e. the adjacency matrix of a DAG, and two <italic toggle="yes">n </italic>×<italic toggle="yes"> p</italic> matrices, with <italic toggle="yes">n</italic> samples and <italic toggle="yes">p</italic> genes, storing gene expression data for each of the two conditions, respectively. As output, the function returns the estimated DCEs, as well as standard errors and two-sided <italic toggle="yes">P</italic>-values for the DCE at each edge in the pathway together with the <italic toggle="yes">P</italic>-value measuring the overall pathway enrichment. The results can be easily transformed into a dataframe and plotted for further downstream analyses.</p>
    <p><italic toggle="yes">Generating synthetic data and benchmarking methods</italic>. We assess the behavior of <italic toggle="yes">dce</italic> and its competitors in a controlled setting by generating synthetic data with known DCEs (ground truth). We start by generating a random DAG <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>. Without loss of generality, we assume the nodes of the DAG to be topologically ordered, i.e. node <italic toggle="yes">X<sub>i</sub></italic> can only be parent of node <italic toggle="yes">X<sub>j</sub></italic>, if <italic toggle="yes">i </italic>&lt;<italic toggle="yes"> j</italic>. This ensures that the network <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> is a DAG. In practice, we sample edges from a binomial distribution with probability <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> for the upper triangle of <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>. We further sample the coefficients <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for every edge as in (2) from a uniform distribution <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We generate the data for network <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> in the following way. For a node <italic toggle="yes">X<sub>i</sub></italic>, we set the mean expression count
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>ι</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and then generate <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Pois</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a vector of counts, corresponding to gene expression values from experiments like RNA-seq. The mean depends on its parents in a linear fashion,
<disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the direct effect of <italic toggle="yes">X<sub>j</sub></italic> on <italic toggle="yes">X<sub>i</sub></italic>, <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mo>ι</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is a small shift, and <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a vector of ones. Subtracting the minimum ensures positive values of the mean for each data point. Then, a realization of <italic toggle="yes">X<sub>i</sub></italic> is drawn from the Poisson distribution <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Pois</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We introduce negative binomial noise by drawing a realization of each source node in <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> from the negative binomial distribution <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mtext>NB</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>μ</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with a general mean <italic toggle="yes">μ</italic> and dispersion <italic toggle="yes">θ</italic>. We use this setup to control the variance across all nodes, which can blow up for descendants with larger means.</p>
    <p>After sampling the data <italic toggle="yes">D<sub>A</sub></italic> for the nodes of network <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> under condition <italic toggle="yes">A</italic>, we resample a certain fraction of edge weights in order to generate new data <italic toggle="yes">D<sub>B</sub></italic> under condition <italic toggle="yes">B</italic>. For a fixed edge weight <italic toggle="yes">β<sup>A</sup></italic> we sample the new edge weight uniformly such that
<disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>∪</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>This ensures that the absolute difference between the two edge weights lies in <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
    <p>We also simulate latent variables. They are neither included in the data nor the network <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>, but have (unknown) outgoing edges to all genes in the dataset with non-zero effects. Hence, these latent variables have global effects on the data, e.g. emulating batch effects.</p>
    <p>We compare <italic toggle="yes">dce</italic> to correlation (<italic toggle="yes">cor</italic>), partial correlation (<italic toggle="yes">pcor</italic>), the method Fast Gaussian Graphical Models (<italic toggle="yes">fggm</italic>) tailored to DCEs (<xref rid="btab847-B52" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab847-B16" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2019</xref>), a differential gene expression approach (<italic toggle="yes">dge</italic>) and random guessing. <italic toggle="yes">cor</italic> is provided by the R package <monospace>stats</monospace> (<xref rid="btab847-B34" ref-type="bibr">R Core Team, 2020</xref>). For <italic toggle="yes">pcor</italic>, we use the general matrix inversion from the R package <monospace>MASS</monospace> (<xref rid="btab847-B50" ref-type="bibr">Venables and Ripley, 2002</xref>) to compute the precision matrix. <italic toggle="yes">fggm</italic> is based on partial correlation, but additionally tries to learn the network structure to adjust for confounding effects. We use the R code provided by the authors (<xref rid="btab847-B16" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2019</xref>) to run <italic toggle="yes">fggm</italic>. For <italic toggle="yes">fggm</italic>, we transform each gene expression count <italic toggle="yes">g</italic> to <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We use the differential expression result from <monospace>edgeR</monospace> (<xref rid="btab847-B35" ref-type="bibr">Robinson and Smyth, 2007</xref>) as input for <italic toggle="yes">dge</italic>. We compute the DCE for the edge between two genes <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> as the difference of the log foldchanges of both genes. We compute the corresponding <italic toggle="yes">P</italic>-value for the same edge as the minimum of the <italic toggle="yes">P</italic>-values for both genes <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic>. We provide <italic toggle="yes">pcor</italic> with the same adjustment set of confounding variables as <italic toggle="yes">dce</italic>.</p>
    <p>We run all methods on simulated data for various modeling parameters. The default parameters are a network <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> of 100 genes, 200 samples for both sample conditions, an absolute magnitude in effect differences between the two conditions of 1, mean of 100 negative binomial distributed counts with a dispersion of 1 for the source genes in the network <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> (no parents), a true positive rate of 50% (edges which have different effects between the two conditions), and library size factors for each sample in the interval <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The library size factor accounts for different sequencing depth among the samples, i.e. for one sample including more reads because more RNA was available even though the gene expression was the same as in samples with less RNA. We account for different library sizes over all samples by computing Transcripts Per Kilobase Million (TPM).</p>
    <p>Overall, we simulate a full dataset of 10, 000 genes including the genes in the network <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> to allow for the realistic estimation of the library size. As a performance measure, we use the area under the receiver operating characteristic (ROC-AUC). We count the number of true/false positive and false negative DCEs based on the edges in the ground truth network and the significant <italic toggle="yes">P</italic>-values for different significance levels. Based on these true/false positives, we can compute the ROC curve and its AUC. For both correlation methods, we use a permutation test to compute empirical <italic toggle="yes">P</italic>-values.</p>
    <p><italic toggle="yes">Validation using Perturb-seq</italic>. Perturb-seq, a CRISPR-Cas9-based gene knockout method, can be used to inhibit the expression of multiple target genes on a single-cell level (<xref rid="btab847-B33" ref-type="bibr">Qi <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab847-B1" ref-type="bibr">Adamson <italic toggle="yes">et al.</italic>, 2016</xref>). The dataset we analyze is a CRISPR knockout screen with global gene expression profiles as the read-out. We can use the known knockout information of these experiments as ground truth information for a performance evaluation of our method. In <xref rid="btab847-B1" ref-type="bibr">Adamson <italic toggle="yes">et al.</italic> (2016)</xref>, this approach was used to systematically analyze the response of an integrated endoplasmic reticulum (ER) stress response pathway to the combinatorial knockout of the three transmembrane sensor proteins ATF6, EIF2AK3 and ERN1. Each considered combinatorial knockout (ATF6, ATF6+EIF2AK3, ATF6+EIF2AK3+ERN1, ATF6+ERN1, EIF2AK3, EIF2AK3+ERN1, ERN1) was treated either with a DMSO control, tunicamycin or thapsigargin.</p>
    <p>We download the raw gene expression count data from NCBI GEO (accession: GSE90546). The repository provides us with a mapping of guide and cell barcodes, and gene expression counts for all cells. We use this information to identify gene knockouts for each cell and to create a gene expression count matrix of the individual cells labeled by their corresponding knockouts.</p>
    <p>We download all pathway networks from KEGG and retain those which contain at least one of the three transmembrane sensor proteins. This results in the pathways <italic toggle="yes">hsa04137</italic>, <italic toggle="yes">hsa04140</italic>, <italic toggle="yes">hsa04141</italic>, <italic toggle="yes">hsa04210</italic>, <italic toggle="yes">hsa04932</italic>, <italic toggle="yes">hsa05010</italic>, <italic toggle="yes">hsa05016</italic>, <italic toggle="yes">hsa05017</italic>, <italic toggle="yes">hsa05160</italic>, <italic toggle="yes">hsa05162</italic> and <italic toggle="yes">hsa05168</italic>.</p>
    <p>For each combination of the three treatments, seven (combinatorial) knockouts and 11 pathways, we compute DCEs if the respective knocked-out gene is contained in the respective pathway. In total, this yields 128 conditions for each of which we run our method.</p>
    <p>We compare the performance of <italic toggle="yes">dce</italic> to both <italic toggle="yes">cor</italic> (correlation) and <italic toggle="yes">pcor</italic> (partial correlation). For the two correlation methods, we estimate the significance of whether a difference in correlation is different from zero using a permutation test. The performance of each method is evaluated using the area-under-curve (AUC) metric for the receiver-operating-characteristic (ROC) curve. The false- and true-positive rates for the ROC curve are computed from the <italic toggle="yes">P</italic>-value per edge as in the synthetic benchmark.</p>
    <p><italic toggle="yes">Deconfounding validation on GTEx data</italic>. From the GTEx project (<xref rid="btab847-B23" ref-type="bibr">Lonsdale <italic toggle="yes">et al.</italic>, 2013</xref>), we obtain gene expression data for the samples belonging to many different human tissue types. For any pathway, one can use <italic toggle="yes">dce</italic> for comparing the expression data between two different tissue types. This approach will detect the edges for which the causal effects differ between the tissues. While this biological scenario is much different to comparing perturbed and unperturbed, or normal and tumor samples, the concept of DCEs remains the same.</p>
    <p>In line with the rest of the article, we choose the breast cancer pathway (<italic toggle="yes">hsa05224</italic>) from the Kyoto Encyclopedia of Genes and Genomes (KEGG) (<xref rid="btab847-B30" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic>, 1999</xref>) and compare mammary gland tissue with each of 29 other tissue types that contain at least 200 samples.</p>
    <p>An interesting feature of the available dataset is that one is given 23 confounding proxies including genotyping principal components, gender of donors and PEER (probabilistic estimation of expression residuals) factors (<xref rid="btab847-B44" ref-type="bibr">Stegle <italic toggle="yes">et al.</italic>, 2010</xref>). For the original breast cancer pathway (<italic toggle="yes">hsa05224</italic>), we run <italic toggle="yes">dce</italic> twice: once with and once without the confounding adjustment, yielding two sets of DCEs. Afterwards, we extend the pathway by adding the confounding proxies as the source nodes that have no incoming edges and have outgoing edges to all other nodes in the pathway. <italic toggle="yes">dce</italic> with and without confounding adjustment is then run on the extended pathway. This again yields two sets of DCEs. Finally, for both variants of <italic toggle="yes">dce</italic> (with and without confounding adjustment), we compute Pearson correlation between the obtained <italic toggle="yes">P</italic>-values for the original and the extended pathway in order to measure how well our confounding adjustment (which does not use any information about the confounding) is able to capture the effect of the known confounders.</p>
    <p><italic toggle="yes">Exploratory analysis with TCGA data</italic>. We retrieve gene expression matrices from TCGA (<xref rid="btab847-B54" ref-type="bibr">einstein <italic toggle="yes">et al.</italic>, 2013</xref>). The rows of these matrices are indexed by genes and the columns by samples. The entries are from the data category Transcriptome Profiling, data type Gene Expression Quantification, experimental strategy RNA-Seq and workflow type HTSeq-Counts. Pathway structures in the form of adjacency matrices are obtained from the Kyoto Encyclopedia of Genes and Genomes (KEGG) (<xref rid="btab847-B30" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic>, 1999</xref>).</p>
    <p>Unlike the Perturb-seq dataset, data obtained from TCGA is observational instead of interventional. We do thus not have any ground truth information and perform an exploratory analysis. For a given cancer type, the associated samples are first grouped into normal and tumor samples. The tumor samples are subsequently stratified according to their stage. The clinical data needed to stratify the samples is readily available on TCGA as metadata for each gene expression matrix. In particular, we download all normal and tumor gene expression samples from TCGA for breast cancer (<italic toggle="yes">TCGA-BRCA</italic>) and selected all stages with a sufficient number of samples (stage I: 202 samples, stage II: 697 samples, stage III: 276 samples; normal: 113 samples). We use the breast cancer pathway (<italic toggle="yes">hsa05224</italic>) from KEGG which contains 147 nodes and 509 edges. We then compute DCEs between the normal condition and each of the three stages of the tumor condition, respectively.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>In this section, we first show the performance of <italic toggle="yes">dce</italic> and its competitors on simulated data and a CRISPR dataset. Next, we evaluate the deconfounding performance using the GTEx dataset. Finally, we use <italic toggle="yes">dce</italic> for an exploratory analysis of breast cancer data from TCGA and show the progression of pathway dysregulation over different cancer stages.</p>
    <sec>
      <title>3.1 Simulation study</title>
      <p>Pathway databases contain networks of different sizes. We first investigate the influence of network size on the ability of each method to recover ground truth differential causal effects. <italic toggle="yes">dce</italic> achieves the highest ROC-AUC for all four network sizes considered (10, 50, 100 and 150 genes). Methods which do not account for known confounding variables perform similar to random guessing for large networks (<xref rid="btab847-F3" ref-type="fig">Fig.  3a</xref>). However, <italic toggle="yes">dce</italic> also outperforms <italic toggle="yes">pcor</italic> with an AUC of 0.61 versus 0.55. Variability is very high for competitors and size ten. The methods either successfully recover all of the very few effects or none at all. As an alternative performance assessment, we also computed precision and recall for a <italic toggle="yes">P</italic>-value cutoff of 0.05 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S7 and S8</xref>). While the true positive rate decreases for large networks, precision is relatively robust and <italic toggle="yes">dce</italic> avoids a high rate of false positives.</p>
      <fig position="float" id="btab847-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance benchmark. <italic toggle="yes">dce</italic> is compared with several competitors for varying network size (<bold>a</bold>) and effect magnitude (<bold>b</bold>) over 100 synthetic datasets each. <italic toggle="yes">dce</italic> achieves the highest ROC-AUC, which decreases for large networks <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> and very large or small differential effects. The whiskers of the boxplot correspond to the minimum and maximum of the data, the box denotes the first and third quartiles and the horizontal line within the box describes the median</p>
        </caption>
        <graphic xlink:href="btab847f3" position="float"/>
      </fig>
      <p>Second, we assess how the magnitude of differential causal effects affects the identification of significant differences. We sample the magnitudes from the set <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For example, for a magnitude of 1 the edge weights between the network of the wild-type samples and the disease samples differ by at most 1. <italic toggle="yes">dce</italic> has difficulty estimating large differences as well as very small differences. However, it still significantly outperforms all other methods, which again show similar performance to random guessing for large effects (<xref rid="btab847-F3" ref-type="fig">Fig.  3b</xref>).</p>
      <p>In additional simulations, <italic toggle="yes">dce</italic> shows increasing ROC-AUC for decreasing dispersion and increasing number of samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>) as is expected due to decreasing noise. We found constant ROC-AUC of <italic toggle="yes">dce</italic> over varying ranges of library size (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Different prevalence of positive edges has little effect on the ROC-AUC of <italic toggle="yes">dce</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). <italic toggle="yes">dce</italic> with latent variable adjustment performs similarly to <italic toggle="yes">dce</italic> without latent variable integration if we do not simulate any latent variables. But <italic toggle="yes">dce</italic> significantly outperforms <italic toggle="yes">dce</italic> without latent variable integration for five and ten latent variables influencing the dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). This is because without latent confounding adjustment one has a large number of false positives due to the confounding bias (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). Sampling the effects of latent variables from an exponential distribution with default rate 1 instead of a uniform distribution does not result in much difference in ROC-AUC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). This shows that even if only some and not all genes in the graph are strongly affected by the latent confounders, we can still successfully account for it.</p>
      <p><italic toggle="yes">dce</italic> relies heavily on the given network <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>. Hence, we investigate how well <italic toggle="yes">dce</italic> performs if <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> contains false edges or is missing true edges. We find that <italic toggle="yes">dce</italic> is robust to additional false edges in the network, but starts breaking down if true edges are missing in larger fractions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Validation experiments using CRISPR knockout data</title>
      <p>To benchmark our method using real-life data generated by Perturb-seq (<xref rid="btab847-B1" ref-type="bibr">Adamson <italic toggle="yes">et al.</italic>, 2016</xref>), we ask whether we can recover the CRISPR knockout from single-cell RNA-seq data using pathways from KEGG which contain the knocked-out genes. Hence, we assume that these pathways capture the causal gene interactions governing the response of the cell to the experimental intervention. As seen in the synthetic benchmark, slight deviations of the observed network from the true underlying network have no major impact on the performance of our method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). By interpreting a CRISPR knockout as an intervention of the causal pathway, we define the positive class to consist of all edges adjacent to a knocked-out gene, and the negative class as all other genes. Consequently, a true positive occurs when an edge adjacent to a CRISPR knocked-out gene is (significantly) associated to a non-zero DCE.</p>
      <p><xref rid="btab847-F4" ref-type="fig">Figure  4a</xref> shows an example of this procedure for one of the conditions described above. The CRISPR knockout gene is highlighted in red and a positive DCE of <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1.3</mml:mn></mml:mrow></mml:math></inline-formula> can be observed on the edge connecting ATF6 and DDIT3. This can be seen in more detail in <xref rid="btab847-F4" ref-type="fig">Figure  4b</xref>. As this edge is adjacent to the knocked-out gene ATF6, it is classified as a true positive for an effect size threshold of <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mn>0.5</mml:mn><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. Following an analogous argument, the edge from EIF2AK3 to EIF2S1 is classified as a false positive.</p>
      <fig position="float" id="btab847-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Overview of the CRISPR (<bold>a–c</bold>) and GTEx (<bold>d</bold>) benchmark results</p>
        </caption>
        <graphic xlink:href="btab847f4" position="float"/>
      </fig>
      <p>We find that <italic toggle="yes">dce</italic> is significantly better [Wilcoxon signed-rank test (<xref rid="btab847-B57" ref-type="bibr">Wilcoxon, 1992</xref>) <italic toggle="yes">P</italic>-value <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>] at recovering the knockout effects with a median ROC-AUC of 0.63 compared with 0.51 for <italic toggle="yes">cor</italic> and 0.53 for <italic toggle="yes">pcor</italic> (<xref rid="btab847-F4" ref-type="fig">Fig.  4c</xref>). To better understand the variability of the performance measure, we also investigate how performance varies when stratified by treatment and knockout gene (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). For example, for the knockout gene ATF6 the ROC-AUC of <italic toggle="yes">dce</italic> decreases from 0.89 for treatment 1 to 0.67 for treatment 2. This can be explained by the higher variability of the gene expression counts under treatment 2 (standard deviation of gene expression counts for treatment 1 is 0.88, and 0.99 for treatment 2), as the <italic toggle="yes">P</italic>-value estimation becomes less stable. This pattern can also be observed for other performance shifts between treatments. We note that <italic toggle="yes">cor</italic> outperforms <italic toggle="yes">dce</italic> for the knockout of ATF6 in treatment 2, as the permutation test is able to better account for the variance of the expression data in this case. This is due to the fact that the permutation test relies on fewer assumptions than the significance test in our joint model. In all other cases, <italic toggle="yes">dce</italic> is either better or roughly as good as the competing methods. We conclude that overall <italic toggle="yes">dce</italic> is able to better recover the dysregulations of single as well as combinatorial knockouts when compared to methods based on correlations.</p>
    </sec>
    <sec>
      <title>3.3 Deconfounding validation on GTEx data</title>
      <p>To validate the extension of our methodology for latent confounding adjustment, we investigate the robustness of our estimates when the confounding variables are latent, compared to when they are added to the pathway as the source nodes. When the confounding adjustment, as described in the Materials and Methods section, is used, we observe that the estimated DCEs between two different tissue types differ much less between the original and extended pathways (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>).</p>
      <p>Similarly, the resulting <italic toggle="yes">P</italic>-values are also much more stable, as measured by the Pearson correlation between the negative logarithmic <italic toggle="yes">P</italic>-values computed for the original and extended pathway (<xref rid="btab847-F4" ref-type="fig">Fig.  4d</xref>). The correlation is consistently larger when using the confounding adjustment, which is important since the latent confounding in general causes many false positives in the analysis.</p>
    </sec>
    <sec>
      <title>3.4 Exploratory analysis of TCGA data</title>
      <p>To demonstrate the ability of our method to recover known cancer-related pathway dysregulations as well as to discover new genes of potential biological and clinical relevance, we compute DCEs using breast cancer gene expression data from TCGA on the breast cancer pathway obtained from KEGG. The results for each stage are then visualized on the pathway structure (<xref rid="btab847-F5" ref-type="fig">Fig.  5a–c</xref>). The raw DCE values were transformed to a symmetric logarithm for greater visibility with the following formula
<disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mtext>symlog</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>x</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <fig position="float" id="btab847-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>DCEs for <italic toggle="yes">TCGA-BRCA normal</italic> samples versus stage I, stage II and stage III computed with the <italic toggle="yes">hsa05224</italic> pathway. In (<bold>a</bold>)–(<bold>c</bold>), edge thickness and opacity scale with absolute DCE size. More negative DCEs appear red, more positive DCEs appear blue. The color follows a symmetric logarithmic scale for values <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and is linear otherwise. (<bold>d</bold>) shows a volcano plot for the symmetric logarithm of DCE against its associated <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>-</mml:mo><mml:mtext>value</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. DCE thresholds of 1 and –1 as well as a <italic toggle="yes">P</italic>-value threshold of 0.05 are denoted with gray dashed lines</p>
        </caption>
        <graphic xlink:href="btab847f5" position="float"/>
      </fig>
      <p>Roughly 40% of all investigated interactions (614 out of 1527) show no difference in causal effects (<inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="italic">DCE</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">P</italic>-value &gt; 0.05) between normal and stage condition for all stages. In the following, we will discuss cases with large effect sizes and significant <italic toggle="yes">P</italic>-values (<xref rid="btab847-F5" ref-type="fig">Fig.  5d</xref>).</p>
      <p>Throughout all stages, interactions between the WNT (Wingless/Int1) and FZD (Frizzled) protein complexes exhibit significant, non-zero DCEs indicating a strong dysregulation of the breast cancer pathway. Most notably, we observe a highly significant dysregulation of WNT11 →FZD1, WNT11 →FZD3 and WNT11 →FZD7 in stage II (<italic toggle="yes">P</italic>-value <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), as well as of WNT11 →FZD7 in stages I and II. Additionally, the interaction between WNT8A and FZD4 features a strongly positive DCE of <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math></inline-formula> in all three stages. These observations are expected, because the interactions between the WNT and FZD protein complexes have been implicated in disease formation in general (<xref rid="btab847-B5" ref-type="bibr">Dijksterhuis <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab847-B3" ref-type="bibr">Chien <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab847-B39" ref-type="bibr">Schulte, 2010</xref>) and in breast cancer in particular (<xref rid="btab847-B59" ref-type="bibr">Yin <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab847-B20" ref-type="bibr">Koval and Katanaev, 2018</xref>).</p>
      <p>Interactions between the FGF (Fibroblast Growth Factor) and FGFR (Fibroblast Growth Factor Receptor) protein complexes show strong negative effect sizes in all three stages (DCE <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> for most members of these complexes). In particular, the FGF6 →FGFR1 link features negative DCEs of <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1279</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>665</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1961</mml:mn></mml:mrow></mml:math></inline-formula>, while the FGF8 →FGFR1 link features negative DCEs of <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mn>402</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>336</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>285</mml:mn></mml:mrow></mml:math></inline-formula>, in the stages I, II, III respectively. This pair has already been recognized as a promising therapeutic target for breast cancer treatment (<xref rid="btab847-B37" ref-type="bibr">Santolla and Maggiolini, 2020</xref>).</p>
      <p>We also find the interaction between EGFR (Epidermal Growth Factor Receptor) and PIK3CA (Phosphatidylinositol-4,5-Bisphosphate 3-Kinase Catalytic Subunit Alpha) to be significantly (<italic toggle="yes">P</italic>-values <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) dysregulated with a small negative DCE of approximately –0.2 in stages I and II but not III. EGFR →PIK3CB shows similar behavior for stage II with a DCE of –0.12 and a <italic toggle="yes">P</italic>-value <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. While the small effect size suggests that there is only a small dysregulation of these interactions, the dysregulation of EGFR together with PIK3CA mutations have been recognized as independent prognostic factors in triple negative breast cancers (<xref rid="btab847-B18" ref-type="bibr">Jacot <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
      <p>The interaction between DLL3 (Delta Like Canonical Notch Ligand 3) and NOTCH4 (Notch Receptor 4) features a significant DCE of <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>140</mml:mn></mml:mrow></mml:math></inline-formula> with <italic toggle="yes">P</italic>-values <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in all three stages. The Notch signaling pathway has been shown to play an important role in Pancreatic ductal adenocarcinoma tumor cells, but has not been implicated in breast cancer (<xref rid="btab847-B42" ref-type="bibr">Song and Zhang, 2018</xref>). Our finding suggests that stromal cells located in the breast may play an important role for disease progression throughout all stages.</p>
      <p>For the interaction between TCF7L2 (Transcription Factor 7 Like 2) and CCND1 (Cyclin D1), we observe a significant negative DCE of –11.9 with a <italic toggle="yes">P</italic>-value of <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in stage III. The role of TCF7L2, which participates in the Wnt/<italic toggle="yes">β</italic>-catenin signaling pathway and is important for cell development and growth regulation, has already been discussed in the context of breast cancer (<xref rid="btab847-B4" ref-type="bibr">Connor <italic toggle="yes">et al.</italic>, 2012</xref>). However, its interaction with CCND1 has, to the best of our knowledge, not been investigated in the literature. Due to the down-regulation in the diseased condition for stage III, we suggest that an improved understanding of the underlying biological reasons might provide insights into the late-stage behavior of breast cancer.</p>
      <p>Overall, we are able to recover both interactions which are known to be dysregulated in breast cancer as well as novel ones. The former indicates that the prioritization of interactions given by <italic toggle="yes">dce</italic> is in accordance with current literature. The latter suggests that <italic toggle="yes">dce</italic> is also able to find dysregulated interactions which up to now have only been recognized for other diseases but may play an important role for breast cancer.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have presented a new method, <italic toggle="yes">dce</italic>, to compute differential causal effects between two conditions using a regression approach. <italic toggle="yes">dce</italic> enables the edge-specific identification of signaling pathway dysregulations. This piece of information can help to further our understanding of subtle differences on the molecular level in seemingly similar cancer types.</p>
    <p><italic toggle="yes">dce</italic> assumes a linear relationship among pathway genes. The linear model is solved using network information to account for additional genes confounding the linear relationship between gene pairs. The network information is included via prior knowledge from literature. <italic toggle="yes">dce</italic> also accounts for latent confounders in the model, which are unknown and not included in the gene network. They are assumed to linearly affect a large number of measured covariates. We have successfully applied <italic toggle="yes">dce</italic> to normalized gene expression counts (TPM) in all analyses. However, <italic toggle="yes">dce</italic> is a general framework, which makes no strong assumption on the data and can be applied to other data types.</p>
    <p>We have shown in our simulations that <italic toggle="yes">dce</italic> is able to detect changes in causal effects even in the presence of noise and for certain ranges of effect sizes. For a wide array of parameter choices, <italic toggle="yes">dce</italic> outperforms methods using (partial) correlation, <italic toggle="yes">fggm</italic> and an approach based on differential expression. Especially in the case of latent confounders, we showed that <italic toggle="yes">dce</italic> with the integration of latent variables outperforms <italic toggle="yes">dce</italic> without, except if no latent confounders were used to simulate the data. In this case, both methods are equally accurate. Hence, we recommend the integration of latent variables in the model as the default configuration.</p>
    <p>In addition to the synthetic benchmark, we have also validated our method on real data derived from Perturb-seq experiments. We have shown that <italic toggle="yes">dce</italic> is able to recover the experimental knockouts with better performance than correlations and partial correlations.</p>
    <p>For breast cancer, we have shown that not all parts of the signaling pathway are perturbed and characteristic hotspots exist. Some causal effects between two genes are invariant to stage information, while other causal effects can vary in either magnitude or even sign of their effect size. This indicates that certain areas of such pathways are more relevant than others. This phenomenon has also been observed in other studies (<xref rid="btab847-B41" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab847-B9" ref-type="bibr">Feng <italic toggle="yes">et al.</italic>, 2018</xref>). Some parts of a pathway seem to be either more conserved or just not relevant to tumorigenesis. This provides interesting opportunities to identify drugs which target certain parts of a pathway and might explain their efficacy. However, we want to stress that not all dysregulated edges will be relevant for causing cancer, just like not all mutations are cancer-causing mutations. Additionally, the robustness of our method depends on the availability of enough samples. In many cases, few are available and make our approach infeasible. While <italic toggle="yes">dce</italic> performs still better than random for even 10 samples, it is significantly worse than for higher sample sizes.</p>
    <p>In summary, we have proposed a novel application of the concept of differential causal effects which describe the differences in causal effects between two conditions and developed a regression approach to compute those differences. We demonstrate their robustness in a simulation study, and point out interesting results in application to real data, e.g. we show that some dysregulated edges are consistent among breast cancer tumor stages I-III, but that other dysregulations are unique to each stage.</p>
    <p>Our simulations show the need for sufficiently large datasets when dealing with large pathways. Additionally, <italic toggle="yes">dce</italic> relies on correct network information. While very robust to incorrect edges in the network, <italic toggle="yes">dce’</italic>s performance breaks down significantly when edges are missing from the network. We have also simulated data from DAGs only and this assumption is made throughout all analyses. In reality, biological pathways include cycles, which could affect the result of <italic toggle="yes">dce</italic>. Similarly, we rely on the assumption that all causal effects are propagated linearly. Other types of causal effects could affect <italic toggle="yes">dce</italic> as well. That is, the expression of a gene could depend on the expression of its parents in a non-linear fashion. The linearity of our model might also hinder <italic toggle="yes">dce</italic> from reaching better performance in case of very large or very small effect sizes.</p>
    <p>Future research should focus on modifying the regression to adapt it to small datasets and make it more robust, for example, by enforcing sparsity through the introduction of <italic toggle="yes">L</italic><sub>1</sub> or <italic toggle="yes">L</italic><sub>2</sub> norms on the coefficients to avoid outliers produced by artifacts in the data.</p>
  </sec>
  <sec>
    <title>Code availability</title>
    <p>The method <italic toggle="yes">dce</italic> is freely available as an R package on Bioconductor (<ext-link xlink:href="https://bioconductor.org/packages/release/bioc/html/dce.html" ext-link-type="uri">https://bioconductor.org/packages/release/bioc/html/dce.html</ext-link>) as well as on <ext-link xlink:href="https://github.com/cbg-ethz/dce" ext-link-type="uri">https://github.com/cbg-ethz/dce</ext-link>. The GitHub repository also contains the Snakemake (<xref rid="btab847-B26" ref-type="bibr">Mölder <italic toggle="yes">et al.</italic>, 2021</xref>) workflows needed to reproduce all results presented here.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>Part of this work was funded by SystemsX.ch, the Swiss Initiative in Systems Biology [RTD 2013/152] (TargetInfectX—Multi-Pronged Perturbation of Pathogen Infection in Human Cells), evaluated by the Swiss National Science Foundation, and by ERC Synergy Grant [609883 to N.B.]. The research of D.C. and P.B. received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme [786461]. The logo of <italic toggle="yes">dce</italic> was created with <ext-link xlink:href="https://github.com/dirmeier/ggpixel" ext-link-type="uri">https://github.com/dirmeier/ggpixel</ext-link>.</p>
  </sec>
  <sec>
    <title>Author contributions</title>
    <p>K.P.J. and M.P. conceived the project. K.P.J. and M.P. developed the statistical model of <italic toggle="yes">dce</italic> and implemented the software package. D.C. contributed to the statistical methodology as well as software implementation. N.B. and P.B. supervised the study. K.P.J. and M.P. wrote the initial manuscript draft. All authors edited the manuscript.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The code used to construct the synthetic datasets is available as part of the R software package <italic toggle="yes">dce</italic>. The experimental data used in the Perturb-seq validation are available under the accession GSE90546 from NCBI GEO. GTEx data are publicly available through the GTEx portal. The experimental data used in the exploratory breast cancer analysis are available under the accession TCGA-BRCA from The Cancer Genome Atlas. The pathway structures have been obtained from the Kyoto Encyclopedia of Genes and Genome.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa847_Supplementary_Data</label>
      <media xlink:href="btaa847_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab847-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adamson</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A multiplexed single-cell crispr screening platform enables systematic dissection of the unfolded protein response</article-title>. <source>Cell</source>, <volume>167</volume>, <fpage>1867</fpage>–<lpage>1882</lpage>.<pub-id pub-id-type="pmid">27984733</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ćevid</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Spectral deconfounding via perturbed sparse linear models</article-title>. <source>J. Mach. Learn. Res</source>., <volume>21</volume>, <fpage>232</fpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chien</surname><given-names>A.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>A wnt survival guide: from flies to human disease</article-title>. <source>J. Investig. Dermatol</source>., <volume>129</volume>, <fpage>1614</fpage>–<lpage>1627</lpage>.<pub-id pub-id-type="pmid">19177135</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Connor</surname><given-names>A.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Associations between tcf7l2 polymorphisms and risk of breast cancer among hispanic and non-hispanic white women: the breast cancer health disparities study</article-title>. <source>Breast Cancer Res. Treat</source>., <volume>136</volume>, <fpage>593</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">23085767</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dijksterhuis</surname><given-names>J.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Systematic mapping of wnt-fzd protein interactions reveals functional selectivity by distinct wnt-fzd pairs</article-title>. <source>J. Biol. Chem</source>., <volume>290</volume>, <fpage>6789</fpage>–<lpage>6798</lpage>.<pub-id pub-id-type="pmid">25605717</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B6">
      <mixed-citation publication-type="other">Dobriban, E. (2020). Permutation methods for factor analysis and PCA. <italic toggle="yes">The Annals of Statistics</italic>, <bold>48</bold>, 2824–2847.</mixed-citation>
    </ref>
    <ref id="btab847-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dutta</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Pathnet: a tool for pathway analysis using topological information</article-title>. <source>Source Code Biol. Med</source>., <volume>7</volume>, <fpage>10</fpage>.<pub-id pub-id-type="pmid">23006764</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Eicker</surname><given-names>F.</given-names></string-name></person-group> (<year>1967</year>) <part-title>Limit theorems for regressions with unequal and dependent errors</part-title>. In: <source>Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability</source>, <volume>Vol. 1</volume>. <publisher-name>University of California Press</publisher-name>, <publisher-loc>Berkeley, CA</publisher-loc>, pp. <fpage>59</fpage>–<lpage>82</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feng</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Breast cancer development and progression: risk factors, cancer stem cells, signaling pathways, genomics, and molecular pathogenesis</article-title>. <source>Genes Dis</source>., <volume>5</volume>, <fpage>77</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">30258937</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gagnon-Bartsch</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <source>Removing Unwanted Variation from High Dimensional Data with Negative Controls</source>. <publisher-name>Tech Reports from Dep Stat Univ California</publisher-name>, <publisher-loc>Berkeley</publisher-loc>, pp. <fpage>1</fpage>–<lpage>112</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Goldszmidt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Pearl</surname><given-names>J.</given-names></string-name></person-group> (<year>1992</year>) Rank-based systems: a simple approach to belief revision, belief update, and reasoning about evidence and actions. In: <italic toggle="yes">Proceeding of the 3rd Conference on Knowledge Representation</italic>, pp. <fpage>661</fpage>–<lpage>672</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Good</surname><given-names>I.J.</given-names></string-name></person-group> (<year>1958</year>) <article-title>Significance tests in parallel and in series</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>53</volume>, <fpage>799</fpage>–<lpage>813</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) Doubly debiased lasso: High-dimensional inference under hidden confounding and measurement errors. <italic toggle="yes">arXiv preprint arXiv:2004.03758.</italic></mixed-citation>
    </ref>
    <ref id="btab847-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanahan</surname><given-names>D.</given-names></string-name>, <string-name><surname>Weinberg</surname><given-names>R.A.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Hallmarks of cancer: the next generation</article-title>. <source>Cell</source>, <volume>144</volume>, <fpage>646</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">21376230</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hawkes</surname><given-names>N.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Cancer survival data emphasise importance of early diagnosis</article-title>. <source>BMJ</source>, <volume>364</volume>, <fpage>l408</fpage>.<pub-id pub-id-type="pmid">30683652</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A statistical test for differential network analysis based on inference of Gaussian graphical model</article-title>. <source>Sci. Rep</source>., <volume>9</volume>, <fpage>10863</fpage>.<pub-id pub-id-type="pmid">31350445</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Huber</surname><given-names>P.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1967</year>) <article-title>The behavior of maximum likelihood estimates under nonstandard conditions</article-title>. In: <italic toggle="yes">Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability</italic>, <volume>Vol. 1</volume>. <publisher-name>University of California Press</publisher-name>, pp. <fpage>221</fpage>–<lpage>233</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacot</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>High EGFR protein expression and exon 9 pik3ca mutations are independent prognostic factors in triple negative breast cancers</article-title>. <source>BMC Cancer</source>, <volume>15</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">25971837</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khakabimamaghani</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Uncovering the subtype-specific temporal order of cancer pathway dysregulation</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007451</fpage>.<pub-id pub-id-type="pmid">31710622</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koval</surname><given-names>A.</given-names></string-name>, <string-name><surname>Katanaev</surname><given-names>V.L.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Dramatic dysbalancing of the wnt pathway in breast cancers</article-title>. <source>Sci. Rep</source>., <volume>8</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">29311619</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leek</surname><given-names>J.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>The SVA package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>882</fpage>–<lpage>883</lpage>.<pub-id pub-id-type="pmid">22257669</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>From expression footprints to causal pathways: contextualizing large signaling networks with carnival</article-title>. <source>NPJ Syst. Biol. Appl</source>., <volume>5</volume>, <fpage>40</fpage>.<pub-id pub-id-type="pmid">31728204</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lonsdale</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>The genotype-tissue expression (GTEX) project</article-title>. <source>Nature Genet</source>., <volume>45</volume>, <fpage>580</fpage>–<lpage>585</lpage>.<pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mi</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Panther version 16: a revised family classification, tree-based classification tool, enhancer regions and extensive api</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>D394</fpage>–<lpage>D403</lpage>.<pub-id pub-id-type="pmid">33290554</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>K.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Cancer treatment and survivorship statistics, 2019</article-title>. <source>CA Cancer J. Clin</source>., <volume>69</volume>, <fpage>363</fpage>–<lpage>385</lpage>.<pub-id pub-id-type="pmid">31184787</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mölder</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Sustainable data analysis with snakemake</article-title>. <source>F1000Research</source>, <volume>10</volume>, <fpage>33</fpage>.<pub-id pub-id-type="pmid">34035898</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B27">
      <mixed-citation publication-type="journal">Nature Cancer. (<year>2020</year>) <article-title>The global challenge of cancer</article-title>. <source>Nat. Cancer</source>, <volume>1</volume>, <fpage>1</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">35121840</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nishimura</surname><given-names>D.</given-names></string-name></person-group> (<year>2001</year>) <article-title>Biocarta. <italic toggle="yes">Biotech Software &amp; Internet Report</italic></article-title>. <source>Comput. Softw. J. Sci</source>., <volume>2</volume>, <fpage>117</fpage>–<lpage>120</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novembre</surname><given-names>J.</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group> (<year>2008</year>) <article-title>Interpreting principal component analyses of spatial population genetic variation</article-title>. <source>Nat. Genet</source>., <volume>40</volume>, <fpage>646</fpage>–<lpage>649</lpage>.<pub-id pub-id-type="pmid">18425127</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ogata</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1999</year>) <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res</source>., <volume>27</volume>, <fpage>29</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">9847135</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pearl</surname><given-names>J.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Causal diagrams for empirical research</article-title>. <source>Biometrika</source>, <volume>82</volume>, <fpage>669</fpage>–<lpage>688</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pearl</surname><given-names>J.</given-names></string-name></person-group> (<year>2000</year>) <source>Causality: Models, Reasoning and Inference</source>. <publisher-name>Cambridge University Press</publisher-name>, <publisher-loc>Cambridge, UK</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab847-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qi</surname><given-names>L.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Repurposing crispr as an rna-guided platform for sequence-specific control of gene expression</article-title>. <source>Cell</source>, <volume>152</volume>, <fpage>1173</fpage>–<lpage>1183</lpage>.<pub-id pub-id-type="pmid">23452860</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B34">
      <mixed-citation publication-type="book">R Core Team. (<year>2020</year>) <source>R: A Language and Environment for Statistical Computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab847-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>2881</fpage>–<lpage>2887</lpage>.<pub-id pub-id-type="pmid">17881408</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saez-Rodriguez</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Discrete logic modelling as a means to link protein signalling networks with functional analysis of mammalian signal transduction</article-title>. <source>Mol. Syst. Biol</source>., <volume>5</volume>, <fpage>331</fpage>.<pub-id pub-id-type="pmid">19953085</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Santolla</surname><given-names>M.F.</given-names></string-name>, <string-name><surname>Maggiolini</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) <article-title>The fgf/fgfr system in breast cancer: oncogenic features and therapeutic perspectives</article-title>. <source>Cancers</source>, <volume>12</volume>, <fpage>3029</fpage>.<pub-id pub-id-type="pmid">33081025</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaefer</surname><given-names>C.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Pid: the pathway interaction database</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>D674</fpage>–<lpage>D679</lpage>.<pub-id pub-id-type="pmid">18832364</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schulte</surname><given-names>G.</given-names></string-name></person-group> (<year>2010</year>) <article-title>International union of basic and clinical pharmacology. lxxx. the class frizzled receptors</article-title>. <source>Pharmacol. Rev</source>., <volume>62</volume>, <fpage>632</fpage>–<lpage>667</lpage>.<pub-id pub-id-type="pmid">21079039</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sedgewick</surname><given-names>A.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Learning mixed graphical models with separate sparsity parameters and stability-based model selection</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>, <fpage>307</fpage>–<lpage>318</lpage>.<pub-id pub-id-type="pmid">27534850</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Pathway-based analysis of breast cancer</article-title>. <source>Am. J. Transl. Res</source>., <volume>6</volume>, <fpage>302</fpage>–<lpage>311</lpage>.<pub-id pub-id-type="pmid">24936222</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>H.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Regulation of pancreatic stellate cell activation by notch3</article-title>. <source>BMC Cancer</source>, <volume>18</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">29291726</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B43">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Spirtes</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2000</year>) <source>Causation, Prediction, and Search</source>. <publisher-name>MIT press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btab847-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stegle</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>A Bayesian framework to account for complex non-genetic factors in gene expression levels greatly increases power in eqtl studies</article-title>. <source>PLoS Comput. Biol</source>., <volume>6</volume>, <fpage>e1000770</fpage>.<pub-id pub-id-type="pmid">20463871</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci</source>., <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>A.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>A novel signaling pathway impact analysis</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">18990722</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Identifying gene regulatory network rewiring using latent differential graphical models</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>e140</fpage>.<pub-id pub-id-type="pmid">27378774</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Troester</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Swift-Scanlan</surname><given-names>T.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Challenges in studying the etiology of breast cancer subtypes</article-title>. <source>Breast Cancer Res</source>., <volume>11</volume>, <fpage>104</fpage>.<pub-id pub-id-type="pmid">19635173</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaske</surname><given-names>C.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Inference of patient-specific pathway activities from multi-dimensional cancer genomics data using paradigm</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>i237</fpage>–<lpage>i245</lpage>.<pub-id pub-id-type="pmid">20529912</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B50">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Venables</surname><given-names>W.N.</given-names></string-name>, <string-name><surname>Ripley</surname><given-names>B.D.</given-names></string-name></person-group> (<year>2002</year>) <source>Modern Applied Statistics with S</source>, <edition>4th</edition> edn. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab847-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vogelstein</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Cancer genome landscapes</article-title>. <source>Science</source>, <volume>339</volume>, <fpage>1546</fpage>–<lpage>1558</lpage>.<pub-id pub-id-type="pmid">23539594</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Fastggm: an efficient algorithm for the inference of Gaussian graphical model in biological networks</article-title>. <source>PLoS Comput. Biol</source>., <volume>12</volume>, <fpage>e1004755</fpage>.<pub-id pub-id-type="pmid">26872036</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Direct estimation of differences in causal graphs</article-title>. In: <source>Advances in Neural Information Processing Systems</source>, pp. <fpage>3770</fpage>–<lpage>3781</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weinstein</surname><given-names>J.N.</given-names></string-name></person-group>  <etal>et al</etal>; Cancer Genome Atlas Research Network. (<year>2013</year>) <article-title>The cancer genome atlas pan-cancer analysis project</article-title>. <source>Nat. Genet</source>., <volume>45</volume>, <fpage>1113</fpage>–<lpage>1120</lpage>.<pub-id pub-id-type="pmid">24071849</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whirl-Carrillo</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Pharmacogenomics knowledge for personalized medicine</article-title>. <source>Clin. Pharmacol. Therap</source>., <volume>92</volume>, <fpage>414</fpage>–<lpage>417</lpage>.<pub-id pub-id-type="pmid">22992668</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>White</surname><given-names>H.</given-names></string-name></person-group> (<year>1980</year>) <article-title>A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity</article-title>. <source>Econometrica J. Econometric Soc</source>., <volume>48</volume>, <fpage>817</fpage>–<lpage>838</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B57">
      <mixed-citation publication-type="book"> Wilcoxon,F. (1992). Individual comparisons by ranking methods. In Breakthroughs in statistics (pp. 196-202). Springer, New York, NY. </mixed-citation>
    </ref>
    <ref id="btab847-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>D.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Camera: a competitive gene set test accounting for inter-gene correlation</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>e133</fpage>.<pub-id pub-id-type="pmid">22638577</pub-id></mixed-citation>
    </ref>
    <ref id="btab847-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Fzd2 contributes to breast cancer cell mesenchymal-like stemness and drug resistance</article-title>. <source>Oncol. Res. Featuring Preclin. Clin. Cancer Therap</source>., <volume>28</volume>, <fpage>273</fpage>–<lpage>284</lpage>.</mixed-citation>
    </ref>
    <ref id="btab847-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Combat-seq: batch effect adjustment for RNA-seq count data</article-title>. <source>NAR Genomics Bioinf</source>., <volume>2</volume>, <fpage>lqaa078</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
