<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Biol Methods Protoc</journal-id>
    <journal-id journal-id-type="iso-abbrev">Biol Methods Protoc</journal-id>
    <journal-id journal-id-type="publisher-id">biomethods</journal-id>
    <journal-title-group>
      <journal-title>Biology Methods &amp; Protocols</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2396-8923</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7750682</article-id>
    <article-id pub-id-type="pmid">33376806</article-id>
    <article-id pub-id-type="doi">10.1093/biomethods/bpaa022</article-id>
    <article-id pub-id-type="publisher-id">bpaa022</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Manuscript</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ShinyButchR: Interactive NMF-based decomposition workflow of genome-scale datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3959-805X</contrib-id>
        <name>
          <surname>Quintero</surname>
          <given-names>Andres</given-names>
        </name>
        <aff><institution>Health Data Science Unit, Medical Faculty and BioQuant, University Heidelberg</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <aff><institution>Division of Neuroblastoma Genomics, German Cancer Research Center (DKFZ)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <xref rid="bpaa022-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hübschmann</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution>Computational Oncology, Molecular Diagnostics Program, National Center for Tumor Diseases (NCT), German Cancer Research Center (DKFZ)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <aff><institution>Heidelberg Institute for Stem Cell Technology and Experimental Medicine (HI-STEM)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <xref rid="bpaa022-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7846-2817</contrib-id>
        <name>
          <surname>Kurzawa</surname>
          <given-names>Nils</given-names>
        </name>
        <aff><institution>Genome Biology Unit, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <xref rid="bpaa022-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Steinhauser</surname>
          <given-names>Sebastian</given-names>
        </name>
        <aff><institution>Bioinformatics and Computational Biology Group, The Francis Crick Institute</institution>, London, <country country="GB">UK</country></aff>
        <xref rid="bpaa022-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rentzsch</surname>
          <given-names>Philipp</given-names>
        </name>
        <aff><institution>Computational Genome Biology, Berlin Institute of Health (BIH)</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krämer</surname>
          <given-names>Stephen</given-names>
        </name>
        <aff><institution>Bioinformatics and Omics Data Analytics, German Cancer Research Center (DKFZ)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8960-7719</contrib-id>
        <name>
          <surname>Andresen</surname>
          <given-names>Carolin</given-names>
        </name>
        <aff><institution>Computational Oncology, Molecular Diagnostics Program, National Center for Tumor Diseases (NCT), German Cancer Research Center (DKFZ)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <aff><institution>Heidelberg Institute for Stem Cell Technology and Experimental Medicine (HI-STEM)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Park</surname>
          <given-names>Jeongbin</given-names>
        </name>
        <aff><institution>Center for Digital Health, Berlin Institute of Health (BIH) and Charité – Universitätsmedizin Berlin</institution>, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eils</surname>
          <given-names>Roland</given-names>
        </name>
        <aff><institution>Health Data Science Unit, Medical Faculty and BioQuant, University Heidelberg</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <aff><institution>Center for Digital Health, Berlin Institute of Health (BIH) and Charité – Universitätsmedizin Berlin</institution>, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5896-4086</contrib-id>
        <name>
          <surname>Schlesner</surname>
          <given-names>Matthias</given-names>
        </name>
        <aff><institution>Bioinformatics and Omics Data Analytics, German Cancer Research Center (DKFZ)</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <xref rid="bpaa022-cor2" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Herrmann</surname>
          <given-names>Carl</given-names>
        </name>
        <aff><institution>Health Data Science Unit, Medical Faculty and BioQuant, University Heidelberg</institution>, Heidelberg, <country country="DE">Germany</country></aff>
        <xref rid="bpaa022-cor1" ref-type="corresp"/>
        <!--carl.herrmann@bioquant.uni-heidelberg.de-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="bpaa022-cor2">Present address: Chair of Biomedical Informatics, Data Mining and Data Analytics, Faculty of Computer Science, University of Augsburg, Germany</corresp>
      <fn id="bpaa022-FM2">
        <p>Shared first authorship.</p>
      </fn>
      <corresp id="bpaa022-cor1">Correspondence address. Health Data Science Unit, Medical Faculty and BioQuant, University Heidelberg, Heidelberg, Germany. Tel: +49 6221 5451249; Fax: +49 6221 545148. E-mail:<email>carl.herrmann@bioquant.uni-heidelberg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-10-29">
      <day>29</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <volume>5</volume>
    <issue>1</issue>
    <elocation-id>bpaa022</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>26</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpaa022.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p> Non-negative matrix factorization (NMF) has been widely used for the analysis of genomic data to perform feature extraction and signature identification due to the interpretability of the decomposed signatures. However, running a basic NMF analysis requires the installation of multiple tools and dependencies, along with a steep learning curve and computing time. To mitigate such obstacles, we developed ShinyButchR, a novel R/Shiny application that provides a complete NMF-based analysis workflow, allowing the user to perform matrix decomposition using NMF, feature extraction, interactive visualization, relevant signature identification, and association to biological and clinical variables. ShinyButchR builds upon the also novel R package ButchR, which provides new TensorFlow solvers for algorithms of the NMF family, functions for downstream analysis, a rational method to determine the optimal factorization rank and a novel feature selection strategy.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>the German Cancer Research Center (DKFZ)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>the German Federal Ministry of Research</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Heidelberg Center for Human Bioinformatics (HD-HuB) within the German Network for Bioinformatics Infrastructure (de.NBI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>#031A537A, #031A537C</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>the Molecular Diagnostics Program of the NCT Heidelberg</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Grant number 01ZX1904D</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>the European Union’s Horizon 2020 research and innovation program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>grant agreement No 824110–EASI-Genomics</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Extracting relevant biological and clinical information from genome-scale datasets can be challenging given the size of the typical datasets. In particular, feature extraction (e.g., relevant genes, genomic regions) and signature identification (e.g., patterns of gene expression that can be associated with biological processes) are two of the most important tasks during analysis, but they require the installation of multiple tools and dependencies. Thus, ready-to-use and interactive software is of great importance to allow fast data exploration and analysis.</p>
    <p>Non-negative matrix factorization (NMF) is a method that provides a parts-based representation of a non-negative input matrix, leading to an enhanced interpretability of the extracted features and identified signatures[<xref rid="bpaa022-B1" ref-type="bibr">1</xref>], as well as applicability to biological data, often shaped by processes with non-negative contributions [<xref rid="bpaa022-B2" ref-type="bibr">2</xref>]. NMF has been used in different settings for analysis of genomic data, including <italic toggle="yes">de novo</italic> identification of mutational signatures [<xref rid="bpaa022-B3" ref-type="bibr">3</xref>, <xref rid="bpaa022-B4" ref-type="bibr">4</xref>] and meta gene extraction [<xref rid="bpaa022-B2" ref-type="bibr">2</xref>, <xref rid="bpaa022-B5" ref-type="bibr">5</xref>, <xref rid="bpaa022-B6" ref-type="bibr">6</xref>]. However, performing an NMF-based analysis requires the determination of a suitable factorization rank, producing stable and biologically meaningful signatures, which can be highly time-consuming for large datasets. In addition, an association between such signatures and biological variables should be established to be able to understand their biological significance.</p>
    <p>Several R packages [<xref rid="bpaa022-B7" ref-type="bibr">7</xref>] have implemented NMF algorithms [<xref rid="bpaa022-B8" ref-type="bibr">8</xref>, <xref rid="bpaa022-B9" ref-type="bibr">9</xref>]; however, performing an NMF-based analysis can be technically challenging for the nonspecialists, as large datasets might require extensive computational time and resources. Moreover, interpretation of the results is nontrivial in the absence of appropriate representation tools. To address these challenges, we developed ShinyButchR, an R/Shiny application [<xref rid="bpaa022-B10" ref-type="bibr">10</xref>] able to perform matrix decomposition using NMF, feature extraction, and to generate rich visualizations.</p>
    <p>To efficiently run the matrix decomposition, ShinyButchR leverages on the novel R package ButchR, available on GitHub. All NMF algorithms included in ButchR are implemented on TensorFlow [<xref rid="bpaa022-B11" ref-type="bibr">11</xref>], allowing its highly efficient execution under multiple systems (e.g., CPU, graphical processing units (GPU), and tensor-processing units (TPU) systems). The analyses and outputs generated by ShinyButchR are fully compatible with ButchR, providing a flexible platform to perform an NMF-based workflow analysis inside the R ecosystem. For users interested in installing ShinyButchR and ButchR on their own systems, we provide ready to use Docker images and freely available source code. To the best of our knowledge, ShinyButchR is the first online tool capable of running NMF, visualizing quality metrics, exploring the results in an interactive fashion, providing feature extraction and identifying the biological and clinical relevance of the inferred signatures.</p>
    <p>Here, we present a step-by-step description of the ShinyButchR workflow, a description of the feature extraction produce using ButchR, and an example with the application of the complete workflow on a test case.</p>
  </sec>
  <sec>
    <title>Materials and methods</title>
    <sec>
      <title>ShinyButchR workflow steps</title>
      <p>The aim of ShinyButchR and ButchR is to provide a fast and scalable NMF framework, allowing the user to decompose an input matrix into a signature matrix W and an exposure matrix H (<xref rid="bpaa022-F1" ref-type="fig">Fig. 1a</xref>). This results in a low-dimensional representation of the input dataset, identifying signatures/factors which help to understand the underlying biological processes and potential differences occurring between different samples.</p>
      <fig position="float" id="bpaa022-F1">
        <label>Figure 1.</label>
        <caption>
          <p>schematic representation of a ShinyButchR NMF-based workflow. (a) ShinyButchR takes a non-negative matrix as input to perform NMF, decomposing the input matrix into a signature matrix W and an exposure matrix H. (b) Main screens of ShinyButchR user interface. The panel on the left shows the “<bold>Setup screen</bold>” of the app, where the user can upload a dataset and associated annotation table, as well as tuning the parameters to run the matrix decomposition. The panel on the right shows the “<bold>Results screen</bold>”, where the user can explore the results interactively, e.g., selection of the optimal factorization rank, clustering analysis, association to known biological and clinical factors and signature stability assessment. (c) Steps performed in the ShinyButchR workflow, the setup steps (i.e., steps 1 to 6) are shown in red, the results exploration steps (i.e., steps 7–12) are shown in blue, and the final save results step (i.e., step 13) is shown in green.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpaa022f1" position="float"/>
      </fig>
      <p>ShinyButchR is built with an intuitive user interface, consisting of two main screens (<xref rid="bpaa022-F1" ref-type="fig">Fig. 1b</xref>).</p>
      <p>The setup screen contains the interface to upload data and change the parameters to run the matrix decomposition, and the results screen contains a collection of interactive visualization, produced from the matrix decomposition results.</p>
      <p>ShinyButchR implements a complete genome-scale data NMF workflow, which starts from uploading the data and running the matrix decomposition, followed by the selection of the optimal factorization rank and visualization of the results, finishing with exporting and saving the results (<xref rid="bpaa022-F1" ref-type="fig">Fig. 1c</xref>).</p>
      <sec>
        <title>Step 1: Setup screen</title>
        <p>By clicking on the “<italic toggle="yes">Data and annotation upload</italic>” tab, the “Setup screen” of the app is shown (<xref rid="bpaa022-F1" ref-type="fig">Fig. 1b</xref>). This screen consists of four boxes: the “Matrix upload” and “Annotation upload” boxes, provide handlers to upload data; the “NMF params” box allows the user to change the NMF parameters, and the “Start NMF” box starts the analysis after a valid dataset has been uploaded.</p>
      </sec>
      <sec>
        <title>Step 2: Matrix upload</title>
        <p>The minimum requirement to run the ShinyButchR workflow is a non-negative matrix with sample identifiers. To upload a new matrix, click in the “Browse…” button inside of the “Matrix upload” box, and select an R data serialized (RDS) format  or a comma-separated format (CSV)  file containing a non-negative matrix. Currently, a file size limit of 30 MB is imposed (which roughly corresponds to an expression matrix with 600 columns and 5000 genes). If a particular analysis requires a bigger upload limit, then we suggest using one of the alternatives to run the app locally.</p>
        <p>Alternatively, instead of uploading a new dataset, the app comes with a publicly available RNA-seq dataset of sorted blood cell populations, comprising 12 cell populations and 45 samples [<xref rid="bpaa022-B12" ref-type="bibr">12</xref>]. The demo dataset can be loaded by clicking on the “Demo” button at the bottom the box.</p>
      </sec>
      <sec>
        <title>Step 3: Annotation upload</title>
        <p>If the uploaded matrix has any associated biological/clinical information, we suggest uploading it to use the full range of functions provided in the app, and enhance the interpretability of the output, e.g., identification of signatures related to biological and clinical features. To upload a new annotation table, click in the “Browse…” button inside of the “Annotation upload” box, and select a CSV table or an RDS file containing an R data frame. The first column of the uploaded annotation table should match to the column names of the uploaded matrix.</p>
      </sec>
      <sec>
        <title>Step 4: Selection of factorization rank range</title>
        <p>In ShinyButchR, the matrix decomposition is run across a range of factorization ranks. The factorization rank range can be changed in the “Minimum factorization rank” and “Maximum factorization rank” input boxes inside the “NMF params” box. The minimum supported factorization rank is 2 and the maximum factorization rank should be less than the number of columns of the input matrix.</p>
      </sec>
      <sec>
        <title>Step 5: Selection of factorization method and number of iterations</title>
        <p>To run the matrix decomposition, ShinyButchR can use two of the NMF algorithms implemented on ButchR, i.e., the NMF algorithm firstly described by Seung and Lee [<xref rid="bpaa022-B1" ref-type="bibr">1</xref>]; and the graph regularized non-negative matrix factorization with sparse coding, described by Lin and Pang [<xref rid="bpaa022-B13" ref-type="bibr">13</xref>]. The factorization method to use can be selected in the “Select factorization method” option inside the “NMF params” box.</p>
        <p>In order to find an optimal solution in the stochastic NMF algorithm, the analysis is run over a number of different random initializations of the H and W matrices. This number can be changed in the “Number of initializations” parameter inside the “NMF params” box. We suggest using at least two random initializations for explorative analysis and more than five for more consistent results.</p>
        <p>To evaluate the convergence of the matrix decomposition, ShinyButchR uses a novel method implemented on ButchR. In this method, each sample (i.e., the columns of the input matrix) is assigned to the signature with the highest exposure at the end of every iteration. The convergence of the NMF is reached if all the sample assignments do not change after <italic toggle="yes">n</italic> iterations (i.e., convergence threshold). The threshold can be changed in the “Convergence threshold” parameter inside the “NMF params” box. Higher threshold values will increase the computation time but producing more stable results.</p>
      </sec>
      <sec>
        <title>Step 6: Run NMF</title>
        <p>After uploading a new dataset and changing the NMF parameters, the matrix decomposition can be run by clicking the “Submit” button inside the “Start NMF” box. The computation time will vary depending on the size of the input matrix and the selected NMF parameters, decomposing a 22 000 × 45 matrix with k from 5 to 8 with 10 random initializations takes about 1 min.</p>
      </sec>
      <sec>
        <title>Step 7: Output results visualization</title>
        <p>After the matrix decomposition step is done, the app will show the “Results screen” (<xref rid="bpaa022-F1" ref-type="fig">Fig. 1b</xref>). This screen contains multiple boxes to explore the results interactively, e.g., selection of the optimal factorization rank, clustering analysis, association to known biological and clinical factors, and signature stability assessment. More visualization options will be available if a valid annotation file was uploaded alongside the input matrix, e.g., displaying annotation with the matrix H heatmap, recovery analysis, and coloring the cluster analysis according to the annotation.</p>
      </sec>
      <sec>
        <title>Step 8: Selection of optimal factorization rank k</title>
        <p>In NMF, the factorization rank is a free parameter. Hence, ShinyButchR provides a diagnostic plot to determine the optimal factorization rank <italic toggle="yes">k</italic>, where the Frobenius error, the coefficient of variation and the mean Amari distance should be minimized [<xref rid="bpaa022-B14" ref-type="bibr">14</xref>], while the silhouette value and the cophenetic correlation coefficient should be maximized [<xref rid="bpaa022-B2" ref-type="bibr">2</xref>]. The diagnostic plot can be found in the “Optimal factorization rank” box.</p>
      </sec>
      <sec>
        <title>Step 9: H matrix heatmap</title>
        <p>One of the strengths of the NMF is the possibility of visualizing the decomposed signatures as a heatmap, alongside with known biological and clinical associated features. In ShinyButchR, we provide an interactive heatmap visualization using the R package ComplexHeatmap [<xref rid="bpaa022-B15" ref-type="bibr">15</xref>], including several options to enhance the visualization result, e.g., selection of the annotation features to show. The heatmap representation of the exposure matrix H can be found in the “H Matrix Heatmap” box.</p>
      </sec>
      <sec>
        <title>Step 10: H matrix uniform manifold approximation and projection</title>
        <p>In addition to the soft clustering approach provided by the visualization of the matrix H heatmap, it is also possible to use the results of the decomposition to identify clusters on the samples, by applying uniform manifold approximation and projection (UMAP) [<xref rid="bpaa022-B16" ref-type="bibr">16</xref>] on the H matrices. The results of performing UMAP on the matrix H for a selected factorization rank can be found in the “H matrix UMAP” box. Besides changing the factorization rank, it is also possible to color the samples using the annotation provided in step 3 of the workflow.</p>
      </sec>
      <sec>
        <title>Step 11: Recovery plots</title>
        <p>In ShinyButchR, the association of the NMF signatures with biological and clinical variables is visualized using a recovery curve. For every annotation variable, the curve is constructed by (i) ranking every signature from low to high exposure and (ii) iterating over all the signature exposure ranks and increasing one step in the <italic toggle="yes">y</italic>-axis if the corresponding sample is annotated for the evaluated variable.</p>
        <p>The recovery curve follows broadly a diagonal line for nonassociated features and a curve with a steep increase for associated features. The area under the curve (AUC) is computed, and the significance of the association is evaluated by computing a <italic toggle="yes">p</italic>-value after shuffling n times the sample labels, and estimating the mean and standard deviation of the null distribution of AUC values. The signature association to biological variables visualization can be found in the “Recovery plots” box.</p>
      </sec>
      <sec>
        <title>Step 12: Riverplot</title>
        <p>One of the most important features in ButchR and ShinyButchR is the possibility of visualizing the stability and hierarchical relationships between signatures at different factorization ranks using a riverplot [<xref rid="bpaa022-B17" ref-type="bibr">17</xref>]. The riverplot is a tree-like representation where nodes represent the NMF signatures, and one edge connects two signatures at different factorization ranks if they show a higher similarity than a predefined threshold. The edge strength encodes the cosine similarity between linked signatures. The factorization rank increases from left to right.</p>
        <p>The signature stability inspection riverplot plot is found in the “NMF riverplot” box. A slider to change the cutoff of the displayed similarities, and a slider to change the range of factorization ranks to use in the visualization are provided.</p>
      </sec>
      <sec>
        <title>Step 13: Export results and post processing</title>
        <p>The final step in the workflow provided by ShinyButchR is to save and export the results of the NMF decomposition. All the results generated by the workflow can be saved as RDS and CSV files. Clicking on the “<italic toggle="yes">Save results</italic>” tab, shows the “Save results screen” of the app. The NMF decomposition results are stored in an R object of class “<italic toggle="yes">ButchR_NMF</italic>” by default, which is the main object used by the package ButchR. We recommend saving results using the “<italic toggle="yes">ButchR_NMF</italic>” format when more downstream analyses are going to be performed using the package ButchR.</p>
      </sec>
    </sec>
    <sec>
      <title>Post processing and feature extraction</title>
      <p>After performing the matrix decomposition, features with a high contribution to a specific signature can be extracted using the following nonparametric procedure: (i) For every feature, i.e., every row of the matrix W, perform a <italic toggle="yes">k-</italic>means clustering with <italic toggle="yes">k </italic>=<italic toggle="yes"> </italic>2; (ii) extract a binary vector across the signatures indicating to which of the signatures that feature has particularly high contributions; and (3) signature-specific features can be selected by identifying those features, which contribute highly to only one single signature. The feature extraction procedure is implemented on the function “SignatureSpecificFeatures” of ButchR.</p>
      <p>For the evaluated dataset, the gene set enrichment analysis was done by finding the top 10% of signature-specific genes and performing an enrichment analysis using the “compareCluster” function of the R package clusterProfiler [<xref rid="bpaa022-B18" ref-type="bibr">18</xref>] against the complete molecular signature collection of the molecular signatures collection database (MSigDB) [<xref rid="bpaa022-B19" ref-type="bibr">19</xref>].</p>
    </sec>
    <sec>
      <title>ShinyButchR local deployment and ButchR installation</title>
      <p>In case a local instance of ShinyButchR is required, we provide all the source code to run the app from a local R installation (Python 3 [<xref rid="bpaa022-B20" ref-type="bibr">20</xref>] and TensorFlow &gt; 2.0.0 [11] must be installed). Also, a Docker image compiled with all the required packages alongside the app is available in Docker Hub (see code and tool availability section).</p>
      <p>ButchR is also freely available and it can be installed directly from the GitHub repository or run from the provided Docker image (see code and tool availability section). A detailed explanation of the complete functionality provided by ButchR can be found in the vignettes included in the package.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Optimal factorization rank and signature stability</title>
      <p>Using the preloaded RNA-seq dataset of different labeled cell types of the human hematopoietic system [<xref rid="bpaa022-B12" ref-type="bibr">12</xref>], we show here how ShinyButchR can be used to achieve dimensionality reduction, produce an interactive visualization of results, and extract cell type-specific features (<xref rid="bpaa022-F2" ref-type="fig">Fig. 2</xref>).</p>
      <fig position="float" id="bpaa022-F2">
        <label>Figure 2.</label>
        <caption>
          <p>example of a ShinyButchR analysis based on RNA-seq data of 12 blood cell populations and 45 samples (Corces <italic toggle="yes">et al.</italic>, 2016). (a) NMF decomposition quality metrics plot. (b) Signature stability and hierarchy assessment by a riverplot representation of the extracted signatures at different factorization ranks. The nodes represent the signatures, the edge strength encodes cosine similarity between signatures linked by the edges. (c) Heatmap representation of the exposure matrix H showing the associated annotation features. (d) Cluster identification by running UMAP on the matrix H. (e) Recovery plot analysis to identify enrichment of known biological variables to the NMF signatures, a significant enrichment relationship is shown in a bold line.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpaa022f2" position="float"/>
      </fig>
      <p>One of the most critical steps while running any NMF algorithm is the selection of a factorization rank <italic toggle="yes">k</italic>, which can hinder the results if a nonoptimal factorization rank was used to perform the analysis. To address this challenge, ShinyButchR allows the user to select and run NMF on a wide range of factorization ranks, producing a diagnostic plot to determine the optimal factorization rank <italic toggle="yes">k</italic> (<xref rid="bpaa022-F2" ref-type="fig">Fig. 2a</xref>), computing the factorization metrics by running the algorithm multiple times with different initializing conditions. Three of these metrics should be minimized (Frobenius error, coefficient of variation, and mean Amari distance), while the other three should be maximized (sum silhouette width, mean silhouette width, and cophenetic coefficient). In our case study, we found <italic toggle="yes">k </italic>=<italic toggle="yes"> </italic>8 to be a good tradeoff, as it has a high silhouette width, a low Frobenius error and mean Amari distance. However, a good practice is to also inspect the exposure values from the H-matrix for alternative values of <italic toggle="yes">k</italic>.</p>
      <p>The evaluation of the signature stability across the range of factorization ranks helps to visually inspect the quality of the decomposition in a certain rank and the robustness of a particular signature. More robust signatures will be more stable across multiple factorization ranks, which can be seen as a ribbon of similar width crossing multiple nodes in the riverplot. In this case, the riverplot visualization showed a separation of stem and progenitor cells from differentiated cell types at low factorization ranks, which persists with increasing factorization rank and resolution (<xref rid="bpaa022-F2" ref-type="fig">Fig. 2b</xref>).</p>
    </sec>
    <sec>
      <title>Sample exposure and cluster analysis</title>
      <p>For every factorization rank, ShinyButchR provides a heatmap of the exposure values from the matrix H, allowing the user to explore different factorizations and customize the annotation tracks shown with the heatmap. This visualization is helpful to inspect state transitions and samples/cells associated with multiple biological processes. The continuum exposure to the multiple NMF signatures allows to soft cluster samples by ordering the columns of the matrix H by the similarity between them. In this example, the continuous exposure value from the H matrix gave insight into fundamental biological principles. For example, one signature (Signature 2) showed a high exposure for the undifferentiated populations (hematopoietic stem cells (HSC) and multipotent progenitors (MPP)) and a progressive decrease in the exposure for populations with increasing differentiation, and can be interpreted as a hematopoietic differentiation signature (<xref rid="bpaa022-F2" ref-type="fig">Fig. 2c</xref>).</p>
      <p>Although the soft clustering approach provided by the matrix H is one of the most important features of the NMF, this matrix can also be used to cluster samples using a UMAP representation [<xref rid="bpaa022-B16" ref-type="bibr">16</xref>]. In particular, cases where it is important to assign a group identity to a sample or cell, the UMAP visualization of the matrix H generates clusters that can be associated with a particular biological state. In our example, the UMAP representation showed a clear separation of undifferentiated populations from more differentiated cell types (<xref rid="bpaa022-F2" ref-type="fig">Fig. 2d</xref>).</p>
    </sec>
    <sec>
      <title>Biological annotation enrichment for NMF signatures</title>
      <p>Displaying known biological and clinical annotation tracks, alongside with the heatmap of the matrix H provides a visual clue to identify if a signature is enriched for a particular annotation variable. On the other hand, a recovery plot also provides a quantification of the enrichment for every annotation variable. In ShinyButchR, a recovery curve can be constructed for all the categorical annotation variables, revealing the significance of the association. In our test case, we found that most of the cell types were associated with one or two signatures (<xref rid="bpaa022-F2" ref-type="fig">Fig. 2e</xref>).</p>
    </sec>
    <sec>
      <title>Feature extraction and gene set enrichment analysis</title>
      <p>As the feature enrichment analysis is highly dependent on the data type and feature naming scheme, this step is only available on the package ButchR, where the user can construct its own collection of reference feature sets. The results of the ShinyButchR workflow can be exported as an R object of class “<italic toggle="yes">ButchR_NMF</italic>” and imported within a local R session to perform the feature extraction and enrichment analysis using ButchR.</p>
      <p>ButchR has a complete suite of functions to identify the differential contribution of a feature to every signature, classifying them into signature-specific features and multisignature features (<xref rid="bpaa022-F3" ref-type="fig">Fig. 3a</xref>). In our test case, a visual inspection of the top 10% of the signature-specific features (i.e., signature-specific genes), revealed that as expected all these genes showed a particular high contribution to only one signature (<xref rid="bpaa022-F3" ref-type="fig">Fig. 3b</xref>).</p>
      <fig position="float" id="bpaa022-F3">
        <label>Figure 3.</label>
        <caption>
          <p>feature extraction and enrichment analysis of signature associated features. (a) Extraction of features associated with the NMF signatures using the R package ButchR. The UpSet plot shows the number of genes that are classified as “<bold>Signature-specific features</bold>” (i.e., features that mainly contribute towards only one signature) and features that are associated with more than one signature. (b) Feature exposure to the matrix W of the top 10% Signature specific features. The exposure values are normalized row by row. (c) Gene set enrichment analysis using the same set of genes displayed in (b). -log<sub>10</sub> of the corrected <italic toggle="yes">p</italic>-values are shown for representative gene set collections.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpaa022f3" position="float"/>
      </fig>
      <p>Finally, we performed a gene set enrichment analysis using the “compareCluster” function of the R package clusterProfiler [<xref rid="bpaa022-B18" ref-type="bibr">18</xref>], to understand the biological processes represented by the collection of signature-specific features. We used the complete set of MSigDB [<xref rid="bpaa022-B19" ref-type="bibr">19</xref>] as a reference, and performed the enrichment analysis on the set of the top 10% of the signature-specific features (<xref rid="bpaa022-F3" ref-type="fig">Fig. 3c</xref>). We found that the set of signature-specific genes are an accurate representation of genes enriched in the cell types defining the NMF signatures. For instance, the signature-specific genes were able to capture gene sets upregulated in stem cells [<xref rid="bpaa022-B21" ref-type="bibr">21</xref>, <xref rid="bpaa022-B22" ref-type="bibr">22</xref>] for the HSC/MPP signature; gene sets upregulated in committed progenitor cells [<xref rid="bpaa022-B23" ref-type="bibr">23</xref>] for the lymphoid-primed multipotent progenitors (LMPP)/common myeloid progenitors (CMP)/granulocyte-monocyte progenitors (GMP)/megakaryocyte-erythrocyte progenitor (MEP) signature; gene sets upregulated at early stages of progenitor T lymphocyte maturation [<xref rid="bpaa022-B24" ref-type="bibr">24</xref>] and in progenitor cells of B lymphocyte lineage [<xref rid="bpaa022-B25" ref-type="bibr">25</xref>] for the common lymphoid progenitors (CLP) signature, and similar associated gene set collections for all the decomposed signatures.</p>
    </sec>
  </sec>
  <sec sec-type="conclusion">
    <title>Conclusion</title>
    <p>Extracting biological relevant signatures from genome-scale data can be a challenging task. ShinyButchR provides a fast and user-friendly tool to decompose an input matrix using NMF, visualize the results interactively, and export publication-ready plots. All the analyses performed by the ShinyButchR workflow can also be done in ButchR without using the user interface of the app. The provided source code and Docker images allow the integration of an NMF analysis into any existing workflow. Additionally, the feature extraction and analysis functions provided by ButchR can be a valuable resource to understand the biological significance of the signatures produced by NMF.</p>
  </sec>
  <sec>
    <title>Code and tool availability</title>
    <p>ShinyButchR is publicly hosted at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://hdsu-bioquant.shinyapps.io/shinyButchR/" ext-link-type="uri">https://hdsu-bioquant.shinyapps.io/shinyButchR/</ext-link>, the source code is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/hdsu-bioquant/shinyButchR" ext-link-type="uri">https://github.com/hdsu-bioquant/shinyButchR</ext-link>, and a Docker image at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://hub.docker.com/r/hdsu/shinybutchr" ext-link-type="uri">https://hub.docker.com/r/hdsu/shinybutchr</ext-link>. ButchR is freely available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/wurst-theke/ButchR" ext-link-type="uri">https://github.com/wurst-theke/ButchR</ext-link> under the GPLv3 license, and a Docker image including test datasets is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://hub.docker.com/r/hdsu/butchr" ext-link-type="uri">https://hub.docker.com/r/hdsu/butchr</ext-link>.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>To reproduce all of the results reported in this study using the package ButchR, we included the vignette “ButchR hematopoiesis Corces” in the ButchR GitHub repository which contains the required datasets.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>The ShinyButchR workflow was conceived, designed and developed by A.Q. The ButchR package was conceived, designed, and developed by A.Q., D.H., S.S., and N.K. P.R., S.K., C.A., and J.P. contributed to the development of the ButchR package. M.S. and R.E. provided supervision at an early stage of the project. The article was prepared by A.Q. and C.H., with support from M.S. C.H. supervised the study. All authors approved the current version of the article.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>A.Q. and S.K. were supported by a scholarship from the German Cancer Research Center (DKFZ). This work was supported by the German Federal Ministry of Research (BMBF) funded Heidelberg Center for Human Bioinformatics (HD-HuB) within the German Network for Bioinformatics Infrastructure (de.NBI) (#031A537A, #031A537C) and the Molecular Diagnostics Program of the NCT Heidelberg. C.H. received funding for the COMMITMENT project under the BMBF e: Med Program (Grant number 01ZX1904D). This research has received funding from the European Union’s Horizon 2020 research and innovation program under grant agreement No 824110–EASI-Genomics.</p>
  </sec>
  <sec>
    <title>Conflicts of interest</title>
    <p>None declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bpaa022-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seung</surname><given-names>HS</given-names></string-name>, <string-name><surname>Lee</surname><given-names>DD.</given-names></string-name></person-group><article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source><year>1999</year>;<volume>401</volume>:<fpage>788</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brunet</surname><given-names>J-P</given-names></string-name>, <string-name><surname>Tamayo</surname><given-names>P</given-names></string-name>, <string-name><surname>Golub</surname><given-names>TR</given-names></string-name></person-group><etal>et al</etal><article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proc Natl Acad Sci USA</source><year>2004</year>;<volume>101</volume>:<fpage>4164</fpage>–<lpage>69</lpage>.<pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alexandrov</surname><given-names>LB</given-names></string-name>, <string-name><surname>Nik-Zainal</surname><given-names>S</given-names></string-name>, <string-name><surname>Wedge</surname><given-names>DC</given-names></string-name></person-group><etal>et al</etal><article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>. <source>Cell Rep</source><year>2013</year>;<volume>3</volume>:<fpage>246</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">23318258</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pal</surname><given-names>S</given-names></string-name>, <string-name><surname>Bi</surname><given-names>Y</given-names></string-name>, <string-name><surname>Macyszyn</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Isoform-level gene signature improves prognostic stratification and accurately classifies glioblastoma subtypes</article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>e64</fpage>–<lpage>e64</lpage>.<pub-id pub-id-type="pmid">24503249</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>RA</given-names></string-name>, <string-name><surname>Marayati</surname><given-names>R</given-names></string-name>, <string-name><surname>Flate</surname><given-names>EL</given-names></string-name></person-group><etal>et al</etal><article-title>Virtual microdissection identifies distinct tumor- and stroma-specific subtypes of pancreatic ductal adenocarcinoma</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>1168</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">26343385</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>YE</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>M</given-names></string-name>, <string-name><surname>Shi</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Identification of high-confidence RNA regulatory elements by combinatorial classification of RNA-protein binding sites</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>:<fpage>169</fpage>.<pub-id pub-id-type="pmid">28886744</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B7">
      <label>7</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>, <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="bpaa022-B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaujoux</surname><given-names>R</given-names></string-name>, <string-name><surname>Seoighe</surname><given-names>C.</given-names></string-name></person-group><article-title>A flexible R package for nonnegative matrix factorization</article-title>. <source>BMC Bioinformatics</source><year>2010</year>;<volume>11</volume>:<fpage>367</fpage>.<pub-id pub-id-type="pmid">20598126</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Boutros</surname><given-names>PC.</given-names></string-name></person-group><article-title>Optimization and expansion of non-negative matrix factorization</article-title>. <source>BMC Bioinformatics</source><year>2020</year>;<volume>21</volume>.</mixed-citation>
    </ref>
    <ref id="bpaa022-B10">
      <label>10</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>J</given-names></string-name>, <string-name><surname>Xie</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal> shiny: Web application framework for R [Computer software]. 2020.</mixed-citation>
    </ref>
    <ref id="bpaa022-B11">
      <label>11</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M</given-names></string-name>, <string-name><surname>Barham</surname><given-names>P</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal> TensorFlow: a system for large-scale machine learning. In: <italic toggle="yes">Proceedings of the 12th USENIX Symposium on Operating Systems Design and Implementation</italic>, <italic toggle="yes">OSDI 2016</italic>. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="bpaa022-B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Corces</surname><given-names>MR</given-names></string-name>, <string-name><surname>Buenrostro</surname><given-names>JD</given-names></string-name>, <string-name><surname>Wu</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution</article-title>. <source>Nat Genet</source><year>2016</year>;<volume>48</volume>:<fpage>1193</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">27526324</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>C</given-names></string-name>, <string-name><surname>Pang</surname><given-names>M.</given-names></string-name></person-group><article-title>Graph regularized nonnegative matrix factorization with sparse coding</article-title>. <source>Math Probl Eng</source><year>2015</year>;<volume>2015</volume>:<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="bpaa022-B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>S</given-names></string-name>, <string-name><surname>Joseph</surname><given-names>A</given-names></string-name>, <string-name><surname>Hammonds</surname><given-names>AS</given-names></string-name></person-group><etal>et al</etal><article-title>Stability-driven nonnegative matrix factorization to interpret spatial gene expression and build local gene networks</article-title>. <source>Proc Natl Acad Sci USA</source><year>2016</year>;<volume>113</volume>:<fpage>4290</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">27071099</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Eils</surname><given-names>R</given-names></string-name>, <string-name><surname>Schlesner</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2847</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">27207943</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diaz-Papkovich</surname><given-names>A</given-names></string-name>, <string-name><surname>Anderson-Trocmé</surname><given-names>L</given-names></string-name>, <string-name><surname>Ben-Eghan</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP reveals cryptic population structure and phenotype heterogeneity in large genomic cohorts</article-title>. <source>PLoS Genet</source><year>2019</year>;<volume>15</volume>:<fpage>e1008432</fpage>.<pub-id pub-id-type="pmid">31675358</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B17">
      <label>17</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Weiner</surname><given-names>J.</given-names></string-name></person-group> Riverplot: Sankey or Ribbon Plots. 2017. R package version 0.6.</mixed-citation>
    </ref>
    <ref id="bpaa022-B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L-G</given-names></string-name>, <string-name><surname>Han</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>ClusterProfiler: an R package for comparing biological themes among gene clusters</article-title>. <source>OMICS</source><year>2012</year>;<volume>16</volume>:<fpage>284</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">22455463</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname><given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname><given-names>VK</given-names></string-name></person-group><etal>et al</etal><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci USA</source><year>2005</year>;<volume>102</volume>:<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B20">
      <label>20</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Van Rossum</surname><given-names>G</given-names></string-name>, <string-name><surname>Drake</surname><given-names>FL.</given-names></string-name></person-group> (<year>2009</year>) <source>Python 3 Reference Manual</source>. <publisher-loc>Scotts Valley, CA</publisher-loc>: <publisher-name>CreateSpace</publisher-name>.</mixed-citation>
    </ref>
    <ref id="bpaa022-B21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lim</surname><given-names>E</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name>, <string-name><surname>Pal</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Transcriptome analyses of mouse and human mammary cell subpopulations reveal multiple conserved genes and pathways</article-title>. <source>Breast Cancer Res</source><year>2010</year>;<volume>12</volume>:<fpage>R21</fpage>.<pub-id pub-id-type="pmid">20346151</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaatinen</surname><given-names>T</given-names></string-name>, <string-name><surname>Hemmoranta</surname><given-names>H</given-names></string-name>, <string-name><surname>Hautaniemi</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Global gene expression profile of human cord blood-derived CD133 + cells</article-title>. <source>Stem Cells</source><year>2006</year>;<volume>24</volume>:<fpage>631</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">16210406</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eppert</surname><given-names>K</given-names></string-name>, <string-name><surname>Takenaka</surname><given-names>K</given-names></string-name>, <string-name><surname>Lechman</surname><given-names>ER</given-names></string-name></person-group><etal>et al</etal><article-title>Stem cell gene expression programs influence clinical outcome in human leukemia</article-title>. <source>Nat Med</source><year>2011</year>;<volume>17</volume>:<fpage>1086</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">21873988</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>MS</given-names></string-name>, <string-name><surname>Hanspers</surname><given-names>K</given-names></string-name>, <string-name><surname>Barker</surname><given-names>CS</given-names></string-name></person-group><etal>et al</etal><article-title>Gene expression profiles during human CD4+ T cell differentiation</article-title>. <source>Int Immunol</source><year>2004</year>;<volume>16</volume>:<fpage>1109</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">15210650</pub-id></mixed-citation>
    </ref>
    <ref id="bpaa022-B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haddad</surname><given-names>R.</given-names></string-name></person-group><article-title>Molecular characterization of early human T/NK and B-lymphoid progenitor cells in umbilical cord blood</article-title>. <source>Blood</source><year>2004</year>;<volume>104</volume>:<fpage>3918</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">15331438</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
