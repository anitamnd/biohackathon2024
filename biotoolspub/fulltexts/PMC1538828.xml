<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id>
    <journal-title>Nucleic Acids Research</journal-title>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1538828</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkl130</article-id>
    <article-id pub-id-type="pmid">16844977</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HHrep: <italic>de novo</italic> protein repeat detection and the origin of TIM barrels</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Söding</surname>
          <given-names>Johannes</given-names>
        </name>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Remmert</surname>
          <given-names>Michael</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Biegert</surname>
          <given-names>Andreas</given-names>
        </name>
      </contrib>
      <aff>
        <institution>Department of Protein Evolution, Max-Planck-Institute for Developmental Biology</institution>
        <addr-line>Spemannstrasse 35, 72076 Tübingen, Germany</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: +49 7071 601 451; Fax +49 7071 601 349; Email: <email>johannes.soeding@tuebingen.mpg.de</email></corresp>
    </author-notes>
    <!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <day>01</day>
      <month>7</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>7</month>
      <year>2006</year>
    </pub-date>
    <volume>34</volume>
    <issue>Web Server issue</issue>
    <fpage>W137</fpage>
    <lpage>W142</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>2</month>
        <year>2006</year>
      </date>
      <date date-type="rev-recd">
        <day>01</day>
        <month>3</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2006</year>
      </date>
    </history>
    <copyright-statement>© The Author 2006. Published by Oxford University Press. All rights reserved</copyright-statement>
    <copyright-year>2006</copyright-year>
    <license license-type="openaccess">
      <p>The online version of this article has been published under an open access model. Users are entitled to use, reproduce, disseminate, or display the open access version of this article for non-commercial purposes provided that: the original authorship is properly and fully attributed; the Journal and Oxford University Press are attributed as the original place of publication with the correct citation details given; if an article is subsequently reproduced or disseminated not in its entirety but only in part or as a derivative work this must be clearly indicated. For commercial re-use, please contact journals.permissions@oxfordjournals.org</p>
    </license>
    <abstract>
      <p>HHrep is a web server for the <italic>de novo</italic> identification of repeats in protein sequences, which is based on the pairwise comparison of profile hidden Markov models (HMMs). Its main strength is its sensitivity, allowing it to detect highly divergent repeat units in protein sequences whose repeats could as yet only be detected from their structures. Examples include sequences with β-propellor fold, ferredoxin-like fold, double psi barrels or (βα)<sub>8</sub> (TIM) barrels. We illustrate this with proteins from four superfamilies of TIM barrels by revealing a clear 4- and 8-fold symmetry, which we detect solely from their sequences. This symmetry might be the trace of an ancient origin through duplication of a βαβα or βα unit. HHrep can be accessed at <ext-link ext-link-type="uri" xlink:href="http://hhrep.tuebingen.mpg.de"/>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Six out of the ten most populated folds (superfolds) posses an approximate structural symmetry (<xref ref-type="bibr" rid="b1">1</xref>,<xref ref-type="bibr" rid="b2">2</xref>). Most proteins that adopt one of these folds have no symmetry detectable in their sequences, however, and it is unclear for most domain families in these folds whether their structural symmetry has its cause in an origin through duplication. The ability to detect these structural repeats by their sequences would open a window to study hypotheses about the origin of these domains by duplication of simpler fragments. Furthermore, the detection of structural repeat patterns could help to predict the fold and function of sequences for which no detectable homolog with known structure can be found.</p>
    <p>There are three general classes of methods to detect repeats in protein sequenes. Pfam, SMART and REP belong to the first class (<xref ref-type="bibr" rid="b3">3</xref>–<xref ref-type="bibr" rid="b5">5</xref>). They each use their own database of profile hidden Markov models (HMMs) or sequence profiles that are constructed from known repeat families, and they compare these profiles one by one with the query sequence.</p>
    <p>A second class of methods is specialized for the detection of periodic patterns in proteins. They do not allow for gaps within (<xref ref-type="bibr" rid="b6">6</xref>) or between repeats (<xref ref-type="bibr" rid="b7">7</xref>,<xref ref-type="bibr" rid="b8">8</xref>) and are applicable mostly to the large class of fibrous proteins.</p>
    <p>Four web servers exist that fall into the third class, that of <italic>de novo</italic> repeat detection methods: internal repeat finder, REPRO, RADAR and TRUST (<xref ref-type="bibr" rid="b9">9</xref>–<xref ref-type="bibr" rid="b12">12</xref>). They do not rely on <italic>a priori</italic> knowledge about repeat families. Instead, they look for internal similarities by comparing the protein sequence to itself with standard sequence–sequence alignment techniques. The main differences among them are (i) how they determine the length and boundaries of the repeat units, (ii) how they adapt the statistics of pairwise sequence comparison to the special case of sequence self-comparison and (iii) whether they utilize transitivity information.</p>
    <p>Transitivity has turned out to be an important concept in multiple sequence alignment (where it is called consistency) and has led to significant improvements in this field (<xref ref-type="bibr" rid="b13">13</xref>,<xref ref-type="bibr" rid="b14">14</xref>). It refers to the fact that if residue <italic>i</italic> is aligned to <italic>j</italic> and <italic>j</italic> to <italic>k</italic> then residue <italic>i</italic> must be aligned to <italic>k</italic>. Owing to transitivity, there is a significant redundancy of information if several pairwise alignments are known. A method that exploits this redundancy will try to find a multiple alignment of all repeats, which is best compatible with all pairwise alignments. Of the aforementioned methods, only TRUST makes explicit use of transitivity, whereas RADAR and REPRO exploit it indirectly during construction of a single-repeat profile from the pairwise alignments.</p>
    <p>In developing HHrep, we were guided by the idea to make full use of transitivity and, most importantly, evolutionary information. Homology detection methods have improved enormously in replacing sequence–sequence comparison by sequence–profile and finally by profile–profile comparison. One can expect the same improvements in sensitivity in going from sequence–sequence-based repeat discovery to a profile–profile or even HMM–HMM-based method.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <p>Like other <italic>de novo</italic> methods, HHrep is based on self-comparison of the query sequence, but it uses HMM–HMM comparison (<xref ref-type="bibr" rid="b15">15</xref>) instead of sequence–sequence comparison. It first builds a multiple alignment from the query sequence by several iterations of PSI-BLAST (<xref ref-type="bibr" rid="b16">16</xref>) and constructs a profile HMM from it. It then looks for sub-optimal alignments of the HMM with itself. Optionally, a secondary structure similarity score is included that uses secondary structure states predicted by PSIPRED (<xref ref-type="bibr" rid="b17">17</xref>).</p>
    <p>The <italic>P</italic>-value calculation proceeds similar to HHsearch (<xref ref-type="bibr" rid="b15">15</xref>): the query HMM is calibrated by searching a small database of representatives from all known SCOP (<xref ref-type="bibr" rid="b18">18</xref>) folds. The extracted μ and <italic>K</italic> parameters of the Gumbel distribution are then used to calculate <italic>P</italic>-values for the self-comparison, where <italic>K</italic> is divided by two. The factor two accounts for the reduction in the number of different possible alignments when a sequence is compared to itself, since the score matrix is symmetric.</p>
    <p>The server returns its results in three sections (See <xref ref-type="fig" rid="fig1">Figure 1</xref>, right). On top is a dot plot of the sequence compared to itself, based on profile–profile scores. Cells with a score above a selectable threshold are black, the others white. The main diagonal represents the trivial self-alignment, while the other black diagonal lines indicate regions of local profile similarity. The blue traces in the upper triangular half show the self-alignments found by HMM–HMM comparison. As in the popular dot plotprogram DOTTER (<xref ref-type="bibr" rid="b19">19</xref>), scores are averaged over a diagonal window of length 2<italic>w</italic> + 1 to increase signal-to-noise: The cell (<italic>i, j</italic>) contains the score <inline-formula><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the profile–profile score between columns <italic>i</italic> and <italic>j</italic>, <italic>pi</italic>(<italic>a</italic>) are the amino acid frequencies (including pseudocounts) in column <italic>i</italic>, and <italic>f</italic>(<italic>a</italic>) are the amino acid background frequencies (<xref ref-type="bibr" rid="b15">15</xref>).</p>
    <p>The score threshold and the window half-length <italic>w</italic> can be changed with radio buttons below the dot plot. The top row of radio buttons allows to narrow down the alignment used to build the profile HMM by keeping only those sequences with a minimum sequence identity of 30, 40 or 50% to the query sequence. This is useful when the repeat units have sequence identities among each other of more than 30, 40 or even 50%, respectively. In these cases, adding too distant homologs might smear out the details of the repeat pattern.</p>
    <p>The second section below the dot plot consists of a hit list which summarizes the detected self-alignments. HHrep displays the top-scoring self-alignment plus all significant further self-alignments (<italic>P</italic>-value &lt;10<sup>−3</sup>). In addition to <italic>P</italic>-values, the list gives the probabilities for each self-alignment to reflect a homologous relationship between the aligned fragments. In contrast to the <italic>P</italic>-value, this probability includes the secondary structure similarity score (column SS). The last column of the list (‘Shift’) specifies the offset from the main diagonal of the first aligned residue pair.</p>
    <p>The last section consists of the pairwise self-alignments. The annotation includes predicted secondary structure, PSIPRED confidence values, the consensus amino acids for the underlying multiple alignment (lower case letters for &gt;40% residue conservation, upper case for &gt;60%) and a central line for the column–column similarity (∣ very high, + high, · neutral, − bad, = very bad). Pressing on the colored histogram logo allows to switch to a histogram view in which colored histogram columns represent the amino acid distributions at each column of the aligned profiles. This view was developed for HHpred (<xref ref-type="bibr" rid="b20">20</xref>) and has already proven a powerful tool to quickly spot functional motifs and to discern spurious hits. (More detailed information can be found on the help pages for HHrep.)</p>
    <p>Transitivity information is incorporated in a second step by pressing the button ‘Merge alignments’ above the summary hit list. Before, the user should check the detected self-alignments and deselect those that he regards as invalid or unreliable. To understand the effect of the ‘Merge alignments’ button, suppose the query sequence contains four repeats, denoted <italic>A</italic>, <italic>B</italic>, <italic>C</italic> and <italic>D</italic>, and let us assume that the initial results returned by HHrep contain just one self-alignment, in which <italic>A</italic> is aligned with <italic>B</italic>, <italic>B</italic> with <italic>C</italic> and <italic>C</italic> with <italic>D</italic>. HHrep will then replace the initial alignment <italic>ABCD</italic> built with PSI-BLAST by a superalignment obtained by merging the two equivalent, pairwise alignments:
<disp-formula><mml:math id="M3"><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mo>→</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mo>.</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:math></disp-formula></p>
    <p>When this new alignment is again compared to itself, it will generally show a much cleaner repeat pattern. Often, for instance, previously undetected self-alignments will appear, such as that between <italic>ABCD</italic> and – – <italic>AB</italic>.</p>
    <p>This alignment-merging step may be performed until the repeat signal does not further improve (once or twice is usually sufficient). Pressing ‘View repeats’ displays the staggered alignment of repeats, constructed by merging all selected self-alignments (<xref ref-type="fig" rid="fig1">Figure 1</xref>, bottom). One can also submit the new superalignment to the HHpred server for homology detection and structure prediction (<xref ref-type="bibr" rid="b20">20</xref>). Since the merged superalignment is more diverse than the original PSI-BLAST generated alignment, the sensitivity to identify remote homologs may be significantly enhanced.</p>
    <p>A limitation of our method is its dependence on sequence homologs. Without a multiple alignment, HHrep is of similar sensitivity as existing methods. This was one of the reasons for us to develop HHsenser (available as web server, see article in this issue). This method often succeeds in finding many more homologs for sequences with few or no BLAST-detectable relatives in the database.</p>
    <p>Since HHrep has to build a multiple alignment by iterated PSI-BLAST searches, it is slower than the other <italic>de novo</italic> methods. But often the user already has a multiple alignment at hand, for example from a previous HHpred search or from secondary structure prediction. In this case, he can use this multiple alignment directly and skip the slow PSI-BLAST step, making HHrep comparable in speed with other <italic>de novo</italic> servers.</p>
  </sec>
  <sec>
    <title>BENCHMARK</title>
    <p>To demonstrate the sensitivity/selectivity gain of HHrep over existing methods, we chose to compare HHrep with TRUST, the method that has to date been reported to be most sensitive (<xref ref-type="bibr" rid="b12">12</xref>). The benchmark dataset consists of the 50 most populated folds in the SCOP 1.69 database (<xref ref-type="bibr" rid="b18">18</xref>), filtered to a maximum sequence identity of 25%. We assigned all folds or superfamilies by hand to three categories, drawing on SCOP annotation about structural symmetries (see Supplementary Data). We obtained 627 repeat-containing sequences, 1750 not containing repeats, and 77 unclassified sequences. The third category was assigned to three folds that contain both duplicated and unduplicated sequences within the same superfamilies.</p>
    <p><xref ref-type="fig" rid="fig2">Figure 2</xref> shows a receiver operating characteristic (ROC) plot that compares HHrep with and without secondary structure scoring to the TRUST method. The <italic>P</italic>-value of the best sub-optimal self-alignment was used for ordering hits. Since TRUST does not print out statistical significance values, we added two lines to the source code for that purpose. The plot shows that HHrep detects between two and three times as many repeat proteins as TRUST over a wide range of false-positive rates.</p>
    <p>It should be noted that the constructed benchmark is not particularly hard. It contains a fairly even representation of repeat proteins across all levels of detection difficulty, since we did not remove sequences with high sequence identity between repeats units. The difference between TRUST and HHrep on the difficult cases, for which repeats have significantly diverged in sequence, is therefore expected to be much more pronounced.</p>
    <p>The sensitivity of HHrep is difficult to capture in an automated benchmark, since in practice, the user has much more information than just the <italic>P</italic>-value of the best suboptimal alignment to decide whether a protein sequence contains repeats. The possibility (i) to view the self-similarities in a dot plot representation whose parameters can be interactively optimized, (ii) to accept or reject individual self-alignments, (iii) to inspect a histogram representation of the profile–profile alignments, (iv) to quickly check and correct the query alignment and finally (v) to view the results of the transitivity operation in the dot plot will substantially improve the practical performance of HHrep over the theoretical curve in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p>
  </sec>
  <sec>
    <title>ORIGIN OF THE TIM BARREL FOLD</title>
    <p>We demonstrate the use of HHrep by studying the evolution of the (βα)<sub>8</sub> or TIM barrel fold, the second most populated fold type among known protein structures (after immunoglobulins). This extremely diverse fold is subdivided into 26 superfamilies in SCOP 1.69 (<xref ref-type="bibr" rid="b18">18</xref>) and 18 families in CATH 1.7 (<xref ref-type="bibr" rid="b21">21</xref>). However, in recent years evidence has accumulated for a common ancestor of at least half of these superfamilies, based on a comparison of their sequences, structures, as well as positions and similarity of functional sites (<xref ref-type="bibr" rid="b21">21</xref>–<xref ref-type="bibr" rid="b24">24</xref>). Despite its approximate 8-fold structural symmetry, evidence for an origin of this common ancestor by 8-fold or 4-fold duplication is lacking, due to the inability to detect the repeats on the sequence level. Fani <italic>et al</italic>. (<xref ref-type="bibr" rid="b25">25</xref>) noted an internal 2-fold symmetry in HisA and HisF, two enzymes from the histidine biosynthesis pathway, and proposed an evolutionary scenario in which these proteins evolved by duplication of a common half-barrel ancestor. Based on the newly determined structures of HisA and HisF, Lang <italic>et al</italic>. (<xref ref-type="bibr" rid="b26">26</xref>) later confirmed the 2-fold symmetry and proposed this scenario for all (βα)<sub>8</sub> barrels. Nagano <italic>et al</italic>. (<xref ref-type="bibr" rid="b21">21</xref>) noted a recurrent, partially conserved loop sequence motif (G-X-D) in the superfamily containing HisA and HisF that would indicate a 4-fold symmetry.</p>
    <p>We show here that HHrep can find, within minutes, a distinct 4-, and 8-fold internal symmetry in members from several different SCOP superfamilies of the (βα)<sub>8</sub>-fold (<xref ref-type="fig" rid="fig3">Figure 3</xref>). First, we indeed find a dominant 2-fold symmetry in HisF (1thf_D, top row) and HisA (1qo2_A, data not shown), with a <italic>P</italic>-value of 9.7 × 10<sup>−13</sup> for the alignment between the two halves of HisF. But both HisA and HisF also display a weaker but clear 4-fold symmetry with <italic>P</italic>-value 5.1 × 10<sup>−4</sup> and 5.3 × 10<sup>−4</sup>, respectively, for the alignments shifted by one quarter-barrel unit. After two alignment merging operations (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, middle) the 4-fold repeat structure is obvious and all three sub-optimal alignments are visible. At lower dot plot threshold (<xref ref-type="fig" rid="fig2">Figure 2</xref>, upper right), an 8-fold repeat pattern becomes apparent. KDPG aldolase (1fg0_A) has a distinct 4-fold symmetry (<xref ref-type="fig" rid="fig2">Figure 2</xref>, lower left), but here the 2-fold symmetry is not dominant: the alignment of the two halves has a lower <italic>P</italic>-value (2.5 × 10<sup>−5</sup>) than the self-alignment shifted by a quarter-barrel unit (5.4 × 10<sup>−7</sup>). Again, at a lower score threshold, an 8-fold symmetry is discernable (lower right). Two further examples with 4-fold symmetry from other SCOP superfamilies are not shown in the figure: phosphoenol pyruvate mutase (1s2w_A) and inosine monophosphate dehydrogenase (IMPDH) (1zfj_A). All sequences were submitted with default parameters.</p>
    <p>Out of the four superfamilies with the most clear-cut examples of internal symmetry, only one superfamily, containing HisA and HisF, has members with a dominant 2-fold duplication. But representative sequences from all four superfamilies possess a distinct 4-fold symmetry and a residual 8-fold symmetry signal. Whereas the strong conservation of the 2-fold symmetry in HisA and HisF can be a consequence of their function—both halves contain a phosphate-binding motif that is required by the nature of their biphosphate substrate—the 4-fold symmetry is not easily explained by functional contraints. We note that the 8-fold symmetry is further underscored by the existence of several sequences with TIM barrel fold that possess 8-fold symmetry with partially conserved <italic>GAD</italic> motifs (e.g. Thiamine-phosphate pyrophosphorylase, sp∣Q7P1R3∣THIE_CHRVO).</p>
    <p>Similarity on the sequence level is generally regarded as indication of common ancestry. Our experience with using HMM–HMM comparison for remote homology detection confirms this common assumption [see, e.g., (<xref ref-type="bibr" rid="b27">27</xref>)]. We therefore interpret the symmetry in TIM barrels as evidence for an origin of most, if not all, TIM barrel proteins by 4-fold duplication of a single, ancient quarter-barrel module. One can speculate that this ancient module might itself have arisen by 2-fold duplication of a βα precursor, which would have given rise to the 8-fold symmetry.</p>
    <p>The present results support the hypothesis of the origin of protein domains by duplication and recombination of simpler peptides (<xref ref-type="bibr" rid="b2">2</xref>). This hypothesis explains how complex domains consisting of hundreds of amino acids and with a combinatorial complexity on the order of 20<sup>100</sup> could have evolved in a finite time, by first evolving shorter peptide modules out of which more complex domains could then have been assembled.</p>
  </sec>
  <sec>
    <title>CONCLUSION</title>
    <p>HHrep achieves a high sensitivity to detect divergent repeats in proteins by employing a new method for HMM–HMM comparison and making use of the transitivity inherent in the pairwise alignment of repeats. In an automated setting, the sensitivity is increased over current <italic>de novo</italic> methods by a factor two to three, which can be regarded as a lower limit of the expected improvement in an interactive server setting. We have used HHrep to detect a clear 4-fold repeat pattern in diverse sequences with TIM barrel fold, and at lower score thresholds we find a weak 8-fold symmtery. This supports the hypothesis that TIM barrels originated by 4- and perhaps 8-fold duplication.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p>Supplementary data are available at NAR Online.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Material]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="nar_34_suppl-2_W137__index.html"/>
      <media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="0d78f679e293eb4015d4d7235c266b47_gkl130-suppl-info.tex"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors are grateful to Andrei Lupas for getting us interested in the topic and for valuable comments on the manuscript, as well as for his inspirations, ideas and support. The authors thank Y. Sergeev for sharing his results on the existence of TIM barrel sequences with an 8-fold GAD loop motif. Funding to pay the Open Access publication charges for this article was provided by the Max-Plank society.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="b1">
      <label>1</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salem</surname>
            <given-names>G.M.</given-names>
          </name>
          <name>
            <surname>Hutchinson</surname>
            <given-names>E.G.</given-names>
          </name>
          <name>
            <surname>Orengo</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>Correlation of observed fold frequency with the occurrence of local structural motifs</article-title>
        <source>J. Mol. Biol.</source>
        <year>1999</year>
        <volume>287</volume>
        <fpage>969</fpage>
        <lpage>981</lpage>
        <pub-id pub-id-type="pmid">10222204</pub-id>
      </citation>
    </ref>
    <ref id="b2">
      <label>2</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Söding</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lupas</surname>
            <given-names>A.N.</given-names>
          </name>
        </person-group>
        <article-title>More than the sum of their parts: on the evolution of proteins from peptides</article-title>
        <source>Bioessays</source>
        <year>2003</year>
        <volume>25</volume>
        <fpage>837</fpage>
        <lpage>846</lpage>
        <pub-id pub-id-type="pmid">12938173</pub-id>
      </citation>
    </ref>
    <ref id="b3">
      <label>3</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnhammer</surname>
            <given-names>E.L.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Pfam: multiple sequence alignments and HMM-profiles of protein domains</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1998</year>
        <volume>26</volume>
        <fpage>320</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="pmid">9399864</pub-id>
      </citation>
    </ref>
    <ref id="b4">
      <label>4</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ponting</surname>
            <given-names>C.P.</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Milpetz</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>SMART: identification and annotation of domains from signalling and extracellular protein sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>229</fpage>
        <lpage>232</lpage>
        <pub-id pub-id-type="pmid">9847187</pub-id>
      </citation>
    </ref>
    <ref id="b5">
      <label>5</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrade</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>C.P.</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Homology-based method for identification of protein repeats using statistical significance estimates</article-title>
        <source>J. Mol. Biol.</source>
        <year>2000</year>
        <volume>298</volume>
        <fpage>521</fpage>
        <lpage>537</lpage>
        <pub-id pub-id-type="pmid">10772867</pub-id>
      </citation>
    </ref>
    <ref id="b6">
      <label>6</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coward</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Drablos</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Detecting periodic patterns in biological sequences</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>498</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="pmid">9694988</pub-id>
      </citation>
    </ref>
    <ref id="b7">
      <label>7</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLachlan</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The 14-fold periodicity in alpha-tropomyosin and the interaction with actin</article-title>
        <source>J. Mol. Biol.</source>
        <year>1976</year>
        <volume>103</volume>
        <fpage>271</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">950663</pub-id>
      </citation>
    </ref>
    <ref id="b8">
      <label>8</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lupas</surname>
            <given-names>A.N.</given-names>
          </name>
        </person-group>
        <article-title>REPPER–repeats and their periodicities in fibrous proteins</article-title>
        <source>Nucleic. Acids. Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W239</fpage>
        <lpage>W243</lpage>
        <pub-id pub-id-type="pmid">15980460</pub-id>
      </citation>
    </ref>
    <ref id="b9">
      <label>9</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pellegrini</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Yeates</surname>
            <given-names>T.O.</given-names>
          </name>
        </person-group>
        <article-title>A fast algorithm for genome-wide analysis of proteins with repeated sequences</article-title>
        <source>Proteins</source>
        <year>1999</year>
        <volume>35</volume>
        <fpage>440</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="pmid">10382671</pub-id>
      </citation>
    </ref>
    <ref id="b10">
      <label>10</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heringa</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Argos</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>A method to recognize distant repeats in protein sequences</article-title>
        <source>Proteins</source>
        <year>1993</year>
        <volume>17</volume>
        <fpage>391</fpage>
        <lpage>341</lpage>
        <pub-id pub-id-type="pmid">8108381</pub-id>
      </citation>
    </ref>
    <ref id="b11">
      <label>11</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heger</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Rapid automatic detection and alignment of repeats in protein sequences</article-title>
        <source>Proteins</source>
        <year>2000</year>
        <volume>41</volume>
        <fpage>224</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="pmid">10966575</pub-id>
      </citation>
    </ref>
    <ref id="b12">
      <label>12</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szklarczyk</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Tracking repeats using significance and transitivity</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1311</fpage>
        <lpage>1317</lpage>
      </citation>
    </ref>
    <ref id="b13">
      <label>13</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>
        <source>J. Mol. Biol.</source>
        <year>2000</year>
        <volume>302</volume>
        <fpage>205</fpage>
        <lpage>2177</lpage>
        <pub-id pub-id-type="pmid">10964570</pub-id>
      </citation>
    </ref>
    <ref id="b14">
      <label>14</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Mahabhashyam</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>330</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">15687296</pub-id>
      </citation>
    </ref>
    <ref id="b15">
      <label>15</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Söding</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Protein homology detection by HMM-HMM comparison</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>951</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">15531603</pub-id>
      </citation>
    </ref>
    <ref id="b16">
      <label>16</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S.F.</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Schäffer</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </citation>
    </ref>
    <ref id="b17">
      <label>17</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>D.T.</given-names>
          </name>
        </person-group>
        <article-title>Protein secondary structure prediction based on position-specific scoring matrices</article-title>
        <source>J. Mol. Biol.</source>
        <year>1999</year>
        <volume>292</volume>
        <fpage>195</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="pmid">10493868</pub-id>
      </citation>
    </ref>
    <ref id="b18">
      <label>18</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andreeva</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Howorth</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Chothia</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Murzin</surname>
            <given-names>A.G.</given-names>
          </name>
        </person-group>
        <article-title>SCOP database in 2004: refinements integrate structure and sequence family data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D226</fpage>
        <lpage>D229</lpage>
        <pub-id pub-id-type="pmid">14681400</pub-id>
      </citation>
    </ref>
    <ref id="b19">
      <label>19</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnhammer</surname>
            <given-names>E.L.</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>A dot-matrix program with dynamic threshold control suited for genomic DNA and protein sequence analysis</article-title>
        <source>Gene</source>
        <year>1995</year>
        <volume>167</volume>
        <fpage>GC1</fpage>
        <lpage>GC10</lpage>
        <pub-id pub-id-type="pmid">8566757</pub-id>
      </citation>
    </ref>
    <ref id="b20">
      <label>20</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Söding</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Biegert</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lupas</surname>
            <given-names>A.N.</given-names>
          </name>
        </person-group>
        <article-title>The HHpred interactive server for protein homology detection and structure prediction</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W244</fpage>
        <lpage>W248</lpage>
        <pub-id pub-id-type="pmid">15980461</pub-id>
      </citation>
    </ref>
    <ref id="b21">
      <label>21</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagano</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Orengo</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>One fold with many functions: the evolutionary relationships between TIM barrel families based on their sequences, structures and functions</article-title>
        <source>J. Mol. Biol.</source>
        <year>2002</year>
        <volume>321</volume>
        <fpage>741</fpage>
        <lpage>765</lpage>
        <pub-id pub-id-type="pmid">12206759</pub-id>
      </citation>
    </ref>
    <ref id="b22">
      <label>22</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Copley</surname>
            <given-names>R.R.</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Homology among (β/α)<sub>8</sub> barrels: implications for the evolution of metabolic pathways</article-title>
        <source>J. Mol. Biol.</source>
        <year>2000</year>
        <volume>303</volume>
        <fpage>627</fpage>
        <lpage>641</lpage>
        <pub-id pub-id-type="pmid">11054297</pub-id>
      </citation>
    </ref>
    <ref id="b23">
      <label>23</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reardon</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Farber</surname>
            <given-names>G.K.</given-names>
          </name>
        </person-group>
        <article-title>The structure and evolution of α/β barrel proteins</article-title>
        <source>FASEB J.</source>
        <year>1995</year>
        <volume>9</volume>
        <fpage>497</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="pmid">7737457</pub-id>
      </citation>
    </ref>
    <ref id="b24">
      <label>24</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brändén</surname>
            <given-names>C.I.</given-names>
          </name>
        </person-group>
        <article-title>The TIM barrel – the most frequently occurring folding motif in proteins</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>1991</year>
        <volume>1</volume>
        <fpage>978</fpage>
        <lpage>983</lpage>
      </citation>
    </ref>
    <ref id="b25">
      <label>25</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fani</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lio</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Chiarelli</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bazzicalupo</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The evolution of the histidine biosynthetic genes in prokaryotes: a common ancestor for the hisA and hisF genes</article-title>
        <source>J. Mol. Evol.</source>
        <year>1994</year>
        <volume>38</volume>
        <fpage>489</fpage>
        <lpage>495</lpage>
        <pub-id pub-id-type="pmid">8028028</pub-id>
      </citation>
    </ref>
    <ref id="b26">
      <label>26</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lang</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Thoma</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Henn-Sax</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sterner</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Wilmanns</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Structural evidence for evolution of the β/α barrel scaffold by gene duplication and fusion</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>289</volume>
        <fpage>1546</fpage>
        <lpage>1550</lpage>
        <pub-id pub-id-type="pmid">10968789</pub-id>
      </citation>
    </ref>
    <ref id="b27">
      <label>27</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coles</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Djuranovic</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Frickey</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Koretke</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Truffault</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lupas</surname>
            <given-names>A.N.</given-names>
          </name>
        </person-group>
        <article-title>AbrB-like transcription factors assume a swapped hairpin fold that is evolutionarily related to double-psi beta barrels</article-title>
        <source>Structure</source>
        <year>2005</year>
        <volume>13</volume>
        <fpage>919</fpage>
        <lpage>928</lpage>
        <pub-id pub-id-type="pmid">15939023</pub-id>
      </citation>
    </ref>
    <ref id="b28">
      <label>28</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clamp</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Cuff</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>G.J.</given-names>
          </name>
        </person-group>
        <article-title>The Jalview Java alignment editor</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>426</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="pmid">14960472</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig id="fig1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Start page (upper), sample help page (middle), repeat alignment displayed with JalView (<xref ref-type="bibr" rid="b28">28</xref>) (lower), and main results page with a profile–profile dot plot, summary hit list and pairwise self-alignments found by HMM–HMM comparison (right). The self-alignments, which are also shown as blue traces in the upper right half of the dot plot, can be selected and deselected by clicking on them.</p>
      </caption>
      <graphic xlink:href="gkl130f1"/>
    </fig>
    <fig id="fig2" position="float">
      <label>Figure 2</label>
      <caption>
        <p>ROC plot comparing HHrep with and without secondary structure scoring to the method TRUST (<xref ref-type="bibr" rid="b12">12</xref>). Filled diamonds and triangles mark a <italic>P</italic>-value of 10<sup>−3</sup> and 10<sup>−2</sup>, respectively, the open diamond and triangle indicate a probability of 50% and 10%, respectively.</p>
      </caption>
      <graphic xlink:href="gkl130f2"/>
    </fig>
    <fig id="fig3" position="float">
      <label>Figure 3</label>
      <caption>
        <p>The 2-, 4- and 8-fold repeat pattern in TIM barrel sequences. The figure shows profile–profile dot plots of HisF (1thf_D) (upper row) and KDPG aldolase (1fq0_A) (lower row), before (left) and after (middle) incorporation of transitivity information through alignment merging. The dot plots on the right were obtained from the middle ones by lowering the score threshold from the default value (0.4 bits) to 0.1 bits.</p>
      </caption>
      <graphic xlink:href="gkl130f3"/>
    </fig>
  </sec>
</back>
