<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5438515</article-id>
    <article-id pub-id-type="publisher-id">1683</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1683-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SurvivalGWAS_SV: software for the analysis of genome-wide association studies of imputed genotypes with “time-to-event” outcomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6981-6962</contrib-id>
        <name>
          <surname>Syed</surname>
          <given-names>Hamzah</given-names>
        </name>
        <address>
          <email>hamzah.syed@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jorgensen</surname>
          <given-names>Andrea L.</given-names>
        </name>
        <address>
          <email>A.L.Jorgensen@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morris</surname>
          <given-names>Andrew P.</given-names>
        </name>
        <address>
          <email>A.P.Morris@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8470</institution-id><institution-id institution-id-type="GRID">grid.10025.36</institution-id><institution>Department of Biostatistics, </institution><institution>University of Liverpool, </institution></institution-wrap>Liverpool, UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8470</institution-id><institution-id institution-id-type="GRID">grid.10025.36</institution-id><institution>Department of Molecular and Clinical Pharmacology, </institution><institution>University of Liverpool, </institution></institution-wrap>Liverpool, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>265</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Analysis of genome-wide association studies (GWAS) with “time to event” outcomes have become increasingly popular, predominantly in the context of pharmacogenetics, where the survival endpoint could be death, disease remission or the occurrence of an adverse drug reaction. However, methodology and software that can efficiently handle the scale and complexity of genetic data from GWAS with time to event outcomes has not been extensively developed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>SurvivalGWAS_SV is an easy to use software implemented using C# and run on Linux, Mac OS X &amp; Windows operating systems. SurvivalGWAS_SV is able to handle large scale genome-wide data, allowing for imputed genotypes by modelling time to event outcomes under a dosage model. Either a Cox proportional hazards or Weibull regression model is used for analysis. The software can adjust for multiple covariates and incorporate SNP-covariate interaction effects.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We introduce a new console application analysis tool for the analysis of GWAS with time to event outcomes. SurvivalGWAS_SV is compatible with high performance parallel computing clusters, thereby allowing efficient and effective analysis of large scale GWAS datasets, without incurring memory issues. With its particular relevance to pharmacogenetic GWAS, SurvivalGWAS_SV will aid in the identification of genetic biomarkers of patient response to treatment, with the ultimate goal of personalising therapeutic intervention for an array of diseases.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome-wide association study</kwd>
      <kwd>Pharmacogenetics</kwd>
      <kwd>Time to event</kwd>
      <kwd>Cox proportional hazards</kwd>
      <kwd>Weibull</kwd>
      <kwd>Survival analysis</kwd>
      <kwd>SNP-covariate interaction</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WT098017</award-id>
        <principal-award-recipient>
          <name>
            <surname>Morris</surname>
            <given-names>Andrew P.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Genome-wide association studies (GWAS) have revolutionised our understanding of the genetic basis of a wide variety of complex human traits and diseases. GWAS are designed to detect associations between single nucleotide polymorphisms (SNPs) across the entire genome and outcome. The focus of most GWAS have been binary phenotypes or quantitative traits, for which proficient software tools for analysis have been developed, such as SNPTEST [<xref ref-type="bibr" rid="CR1">1</xref>] and PLINK [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>“Time-to-event” outcomes have become increasingly relevant, particularly in the context of pharmacogenetic studies, where the outcome of interest could be based on overall survival [<xref ref-type="bibr" rid="CR3">3</xref>], time to remission [<xref ref-type="bibr" rid="CR4">4</xref>] or progression-free survival [<xref ref-type="bibr" rid="CR5">5</xref>] after treatment/therapy intervention. The traditional approach to the analysis of time to event data is through survival modelling, and the underlying models used are the same when applied to genetic association studies. However, the challenge arises from the scale and complexity of genetic data, and the need to incorporate a range of analytical models, which require computationally efficient software. Currently, there is a paucity of such powerful tools for survival analysis of GWAS.</p>
    <p>There are many recent GWAS published with a focus on survival outcomes such as He et al. [<xref ref-type="bibr" rid="CR6">6</xref>], Phipps et al. [<xref ref-type="bibr" rid="CR7">7</xref>], Johnson et al. [<xref ref-type="bibr" rid="CR8">8</xref>] and Wu et al. [<xref ref-type="bibr" rid="CR9">9</xref>]. In these studies, genome-wide time to event analyses were conducted using standard statistical software, such as R or SAS, which are limited by memory and not easily amenable to high-performance computing (HPC) solutions to improve efficiency. Programs such as ProbABEL [<xref ref-type="bibr" rid="CR10">10</xref>] exist for this type of analysis, but are limited to the use of only the Cox proportional hazards model and also do not allow exploration of SNP-covariate interaction effects. This is a particularly important feature for the analysis of pharmacogenetic data, where it is often desirable to test for drug or dose interactions with SNPs.</p>
    <p>We have developed the software tool SurvivalGWAS_SV, which has addressed these challenges, and currently employs a single SNP analysis approach using two commonly used analysis models. Key features include: (i) compatibility with widely used programs such as IMPUTE [<xref ref-type="bibr" rid="CR11">11</xref>], thereby directly accommodating imputed data without the need for file conversion; (ii) a range of survival analysis methods are available with the foundation in place for implementing extensions; (iii) options for testing SNP-covariate interactions, showing overall and individual test of association <italic>p</italic>-values; and (iv) compatibility with high performance parallel computing clusters.</p>
    <p>SurvivalGWAS_SV is the second program to be released under the SurvivalGWAS Suite, which also includes the complementary power calculator “SurvivalGWAS_Power” [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>User interface</title>
      <p>SurvivalGWAS_SV is a console application utilising command line inputs. The software is run from a command prompt terminal, compatible with Linux, Windows and Mac OS X. The program requires little interaction from the user since a script of commands can be submitted to the program. This is useful for the analysis of large data files: the user can specify “batches” of the data file to analyse in parallel using multiple computer nodes, where each core can run a different part of the analysis. The program requires Mono [<xref ref-type="bibr" rid="CR13">13</xref>] to run the software on Linux and Mac OS X, but this does not compromise speed or efficiency.</p>
    </sec>
    <sec id="Sec4">
      <title>Inputs</title>
      <p>SurvivalGWAS_SV is set up in a very simplistic way. Firstly, the user is required to specify the two data files that will be read into the program. This must be a genotype file (.gen or.impute) or a variant call format (VCF) text file that contains the SNP genotype probabilities (imputed or non-imputed), and a sample file (.sample) that contains all the covariate, survival time and censoring indicator information for each individual. The software supports VCF files containing the SNP genotype probabilities, dosages and/or hard genotype calls. In some circumstances, the user would have the genotype files compressed, either in a.zip or.gz file format, both of which can be read into the software directly. Secondly, the user specifies details about terms to include in their analysis model, such as covariates and/or interaction, whilst also specifying the censoring indicator and observed survival time. Thirdly, the user must specify the range of SNPs to be analysed, to enable efficient parallel computing. Lastly, the user must enter the chosen analytical method to use and the name of the file for which the analysis output will be saved. If the user is analysing covariates within the model, but does not require summary statistics for the covariates to be included in the output file, an option is available for only printing the results for the SNP or interaction effects. This is helpful when creating graphical summaries, such as Manhattan plots, using other programs. Table <xref rid="Tab1" ref-type="table">1</xref> gives a brief description of all the available commands.<table-wrap id="Tab1"><label>Table 1</label><caption><p>List of commands available in the software and their corresponding usage description</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>-gf=</td><td>This specifies the genotype file. Typically .gen, .impute, .gen.gz.</td></tr><tr><td>-sf=</td><td>This specifies the sample file (.sample).</td></tr><tr><td>-t=</td><td>This specifies the time to event (column heading name) in the sample file.</td></tr><tr><td>-c=</td><td>This specifies the censoring indicator/outcome in the sample file.</td></tr><tr><td>-cov=</td><td>This specifies the covariates to adjust for in the model. Each one separated by a comma (,). Categorical factors need to be converted to binary as software only assumes continuous or binary covariates.</td></tr><tr><td>-lstart=</td><td>This specifies the line in the genotype file at which the start position of analysis will occur. Used to break large files into small batches for parallel computing.</td></tr><tr><td>-lstop=</td><td>This specifies the line in the genotype file at which the end position of analysis will occur. Typically the number of lines is equal to the number of SNPs in the file.</td></tr><tr><td>-sp=</td><td>The start position (in base pairs) on the chromosome. Still need to specify the number of lines in the file using -lstart &amp; -lstop commands. &lt;optional&gt;</td></tr><tr><td>-ep=</td><td>The stop position (in base pairs) on the chromosome. &lt;optional&gt;</td></tr><tr><td>-chr=</td><td>This specifies the chromosome number to be output in the text file.</td></tr><tr><td>-p=</td><td>Enter “onlysnp” if only the results from the SNP analysis are to be output and “onlyint” if only the results from the SNP-covariate interaction analysis are to be output. &lt;optional&gt;</td></tr><tr><td>-m=</td><td>This specifies the choice of method for analysis. This is either “cox” for the Cox proportional hazards model or “weibull” for the parametric Weibull regression model.</td></tr><tr><td>-o=</td><td>This specifies the name of the file for output to be saved in. e.g., name.txt</td></tr><tr><td>-help</td><td>Outputs a full list of commands and usage help.</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec5">
      <title>Conversion &amp; validation</title>
      <p>Before the data can be analysed, a number of conversions and quality control measures must be performed by the software. When the genotype file is read in, one SNP at a time, either directly typed or imputed, SurvivalGWAS_SV will convert the genotype probabilities for each subject into a “dosage” under an additive model for the minor allele. This enables appropriate analysis for imputed SNP data by taking account of the uncertainty in the imputation process. The dosage model is given by <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_i={p}_{i1}+2{p}_{i2} $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2017_1683_Article_IEq1.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_{i1} $$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2017_1683_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_{i2} $$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2017_1683_Article_IEq3.gif"/></alternatives></inline-formula> are the probabilities that subject <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i $$\end{document}</tex-math><mml:math id="M8"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2017_1683_Article_IEq4.gif"/></alternatives></inline-formula> carries 1 or 2 minor alleles, respectively, at the SNP.</p>
      <p>SurvivalGWAS_SV throws exemptions whenever the user has specified an incorrect command or states a header that cannot be found in the data files. In such an event, the program will exit the application and will require re-submission of the task. The program also handles missing values within the .sample file. If a subject has missing values (in the form of “NA”) for survival time, censoring indicator or a covariate used in the model then the subject is removed from the analysis with their corresponding SNP information.</p>
    </sec>
    <sec id="Sec6">
      <title>Analysis</title>
      <p>Analysis can be carried out using one of two methods: (i) a Cox proportional hazards model; or (ii) a parametric Weibull regression model. Both methods have their advantages under different scenarios. More details about power and choice of method can be found in Syed et al. [<xref ref-type="bibr" rid="CR14">14</xref>]. Software for performing power calculations under a range of pharmacogenetic time to event scenarios is also available from Syed et al. [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
      <p>The Cox proportional hazards model is widely considered the ‘standard’ approach when modelling time to event outcomes. It is a semi-parametric model where the hazard ratio takes a parametric form in terms of the regression coefficients, but the baseline hazard is unspecified. A disadvantage of this model is that the distribution of survival times is unknown. In cases where the proportional hazards assumption is not valid, other analysis models or extensions to the Cox-regression model should be considered.</p>
      <p>The Weibull regression model is a parametric survival model with completely specified hazard and survivor functions. The Weibull model is beneficial when the hazard ratio is not proportional over time or the data have an accelerated failure time feature. For more information on the estimation of the Weibull regression model parameters please refer to Syed et al. [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Output</title>
      <p>The output from the analysis is saved in a text file, the name of which is specified by the user. Each individual parameter analysed is recorded in a list under a header row that specifies the values in each column. It includes the variable name (can be the SNP ID, covariate or interaction name), rs ID, chromosome number, base-pair position, effect and non-effect alleles, coefficient value for each variable analysed, along with its hazard ratio, standard error, confidence intervals (only for Cox proportional hazards) and corresponding <italic>p</italic>-value (Wald test for Cox model and a score test for the Weibull model). The Weibull regression model output will also comprise of a row for the intercept and shape parameter. There is also output for the likelihood ratio test of the overall model, effect allele frequency (the frequency at which the most common allele occurs within a population), minor allele frequency (MAF) and the IMPUTE info measure of imputation quality [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    </sec>
    <sec id="Sec8">
      <title>Example commands</title>
      <p>Assuming all data files and software are in the same folder, the command line in a Linux terminal for the analysis of 10000 SNPs and 2 additional covariates using a Cox proportional hazards model is as follows:</p>
      <p>
mono SurvivalGWAS_SV.exe -gf=data.gen -sf=data.sample -t=event_times -c=censoring -cov=covariate1,covariate2 -chr=1 -lstart=0 -lstop=10000 -m=cox -p=onlysnp -o=output.txt
</p>
      <p>Each command is separated by a space. The user can specify the exact location of the data files and where the output file will be saved. e.g., /DIRECTORY/DATA/output.txt
</p>
      <p>An example of a shell script (.sh) to distribute the analyses between 10 computer cores within a Linux cluster, using a sun grid engine batch system is as follows:</p>
      <p>
#!/bin/bash
</p>
      <p>
#$ -o stdout
</p>
      <p>
#$ -e stderr
</p>
      <p>
DIRECTORY=/SurvivalGWAS_SV #Location of software and data
</p>
      <p>
str1=0 #Start position in genotype file
</p>
      <p>
str=10000 #Number of SNPs/lines in genotype file
</p>
      <p>
no_of_jobs=10 #Number of cores
</p>
      <p>
inc=`expr \($str - $str1 \) \/ $no_of_jobs` #Increment
</p>
      <p>
#SGE_TASK_ID takes values 1:no_of_jobs
</p>
      <p>
nstart=`expr \($SGE_TASK_ID - 1 \) \* $inc’
</p>
      <p>
nstop=`expr $nstart + $inc – 1`
</p>
      <p>
mono $DIRECTORY/SurvivalGWAS_SV.exe –gf=$DIRECTORY/data.gen –sf=$DIRECTORY/data.sample -t=event_times -c=censoring -cov=covariate1,covariate2 -chr=1 -lstart=$nstart -lstop=$nstop -m=cox -p=onlysnp -o=$DIRECTORY/output${SGE_TASK_ID}.txt
</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results and discussion</title>
    <p>To evaluate the performance of SurvivalGWAS_SV, we simulated genotype data using the software HAPGEN2 [<xref ref-type="bibr" rid="CR15">15</xref>], based on European ancestry individuals from the HapMap3 [<xref ref-type="bibr" rid="CR16">16</xref>] reference panel. Approximately 1.5 million SNPs were simulated across 22 chromosomes for 1000 patients. We then selected one SNP (rs12425539) on chromosome 12 as the causal variant, which we used to generate time to event data. We generated the time to event data using the power calculator software “SurvivalGWAS_Power”, which simulated the survival time and censoring indicator for each individual for this single replicate of genotype data at the causal SNP. A treatment covariate (binary) was also simulated for each patient using a binomial distribution. The active treatment and the placebo were divided evenly (1:1) between the 1000 patients. Four datasets were simulated with censoring occurring randomly for approximately 20% of the sample: (i) proportional hazards data with a significant SNP effect only; (ii) proportional hazards data with significant SNP, treatment and interaction effect; (iii) accelerated failure time data with a significant SNP effect only; and (iv) accelerated failure time data with significant SNP, treatment and interaction effect. Datasets (i) and (ii) were analysed using the Cox proportional hazards model, whereas datasets (iii) and (iv) were analysed using the Weibull regression model. Only the SNP term was included in the analysis models for analysing datasets (i) and (iii). Datasets (ii) and (iv), included SNP, treatment and interaction terms within the analysis models. After analysis, the number of SNPs was reduced by removing SNPs with a MAF &lt; 0.01. This was to remove rare variants for which there is minimal power to detect association, and a standard procedure in GWAS quality control.</p>
    <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> presents the results from the Cox proportional hazards model depicted by Manhattan and QQ-plots for dataset (i). The Cox proportional hazards analysis was able to detect the causal SNP association, identifying SNPs to be genome-wide significant (<italic>p</italic> &lt; 5×10<sup>−8</sup>) in the data simulated using the proportional hazards model. The same can also be said when considering Fig. <xref rid="Fig2" ref-type="fig">2</xref>, which depicts the interaction analysis (SNP-treatment interaction <italic>p</italic>-values) for dataset (ii), simulated using the proportional hazards model.<fig id="Fig1"><label>Fig. 1</label><caption><p>Graphical representation from proportional hazards data SNP analysis. Graphical output from simulation study. (<italic>Left</italic>) Manhattan plot of Cox proportional hazards analysis SNP <italic>p</italic>-values &amp; (<italic>Right</italic>) Cox proportional hazards analysis QQ-plot</p></caption><graphic xlink:href="12859_2017_1683_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Graphical representation from proportional hazards data SNP-Treatment interaction analysis. Graphical output from simulation study. (<italic>Left</italic>) Manhattan plot of Cox proportional hazards analysis interaction <italic>p</italic>-values &amp; (<italic>Right</italic>) Cox proportional hazards analysis QQ-plot</p></caption><graphic xlink:href="12859_2017_1683_Fig2_HTML" id="MO2"/></fig>
</p>
    <p>Figures <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref> represent the results from analysing the datasets simulated using the accelerated failure time assumption. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows us that the Weibull regression analysis identified the association between the causal SNP and time to event outcome. Figure <xref rid="Fig4" ref-type="fig">4</xref> indicates that the Weibull regression model was able to detect the interaction effect in dataset (iv).<fig id="Fig3"><label>Fig. 3</label><caption><p>Graphical representation from accelerated failure time data SNP analysis. Graphical output from simulation study. (<italic>Left</italic>) Manhattan plot of Weibull regression analysis SNP <italic>p</italic>-values &amp; (<italic>Right</italic>) Weibull regression analysis QQ-plot</p></caption><graphic xlink:href="12859_2017_1683_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Graphical representation from accelerated failure time data SNP-Treatment interaction analysis. Graphical output from simulation study. (<italic>Left</italic>) Manhattan plot of Weibull regression analysis interaction <italic>p</italic>-values &amp; (<italic>Right</italic>) Weibull regression analysis QQ-plot</p></caption><graphic xlink:href="12859_2017_1683_Fig4_HTML" id="MO4"/></fig>
</p>
    <p>The entire analysis was run using 8 computer nodes (64 cores). Each node consisted of a HP Proliant DL170h G6 server, 2 Intel Xeon(R) E5520 2.27GHz quad-core CPUs, 36 GB memory and 1 TB of local storage. Running the single SNP analysis of 1.5 million SNPs across 22 chromosomes for 1000 individuals with no additional covariates took ~6 h to complete using the Cox proportional hazards model and ~5 h to complete using the Weibull regression model. The more covariates added to the analysis and/or the addition of an interaction, the longer the computational runtime. Each additional covariate took approximately an extra 0.275 s for each individual SNP analysed. The Weibull regression analysis runtime varies greatly; this is due to the convergence criteria of the Newton-Raphson method used for estimation of all parameters [<xref ref-type="bibr" rid="CR12">12</xref>]. Runtime is also dependent on missing values within the sample file and whether or not the genotype file is compressed. Ultimately, cluster specifications and size of data files are the most influential factors affecting the speed of the software.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusion</title>
    <p>SurvivalGWAS_SV is the first analytics software capable of applying a range of survival analysis methods to genome-wide data, with appropriate handling of imputed genotypes. The software can be applied to large-scale GWAS datasets efficiently and effectively, without incurring memory issues.</p>
    <p>Survival analysis methodology is evolving quickly, with the majority of researchers implementing new methods within the R statistical environment. Future versions of SurvivalGWAS_SV will employ more complex analysis techniques and extensions to account for more complex survival models such as competing risks, whilst integrating with R to allow for the software to update methodological changes faster.</p>
    <p>SurvivalGWAS_SV will ultimately enable discovery of genetic biomarkers of patient response to treatment for a range of complex human diseases, and will offer opportunities for patient stratification according to predicted benefit or risk of treatment, allowing personalisation of therapeutic intervention.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GWAS</term>
        <def>
          <p>Genome-wide association studies</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p>High-performance computing</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p>Minor allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p>Variant call format</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>APM is a Wellcome Trust Senior Fellow in Basic Biomedical Science (under award WT098017).</p>
      <p>Funding for open access charge: Wellcome Trust. The funding body (Wellcome Trust) did not play any role in the design or conclusion of the study.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p>Project name: SurvivalGWAS_SV</p>
      <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.liverpool.ac.uk/translational-medicine/research/statistical-genetics/software/">https://www.liverpool.ac.uk/translational-medicine/research/statistical-genetics/software/</ext-link>
</p>
      <p>Operating system(s): Linux, Mac OS X &amp; Windows.</p>
      <p>Platform independent</p>
      <p>Programming language: C#</p>
      <p>Other requirements: Download Mono for Linux or Mac OS X to run software.</p>
      <p>License: GNU General Public License, version 3 (GPL-3.0)</p>
      <p>Any restrictions to use by non-academics: None.</p>
    </sec>
    <sec id="FPar3">
      <title>Authors’ contributions</title>
      <p>HS carried out the literature review of genome wide association studies with time to event outcomes and commonly used software. HS also coded, developed, debugged and tested the software and drafted the manuscript. Both ALJ and APM participated in the design and coordination of the software and helped to draft the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar7">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Marchini J, Band G. SNPTEST. <ext-link ext-link-type="uri" xlink:href="https://mathgen.stats.ox.ac.uk/genetics_software/snptest/snptest.html">https://mathgen.stats.ox.ac.uk/genetics_software/snptest/snptest.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>559</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <?supplied-pmid 17701901?>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>SH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A genome-wide association study of survival in small-cell lung cancer patients treated with irinotecan plus cisplatin chemotherapy</article-title>
        <source>Pharmacogenomics J</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>20</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2013.7</pub-id>
        <?supplied-pmid 23478653?>
        <pub-id pub-id-type="pmid">23478653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ray</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tennakoon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sarginson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ABCB1 (MDR1) predicts remission on P-gp substrates in chronic depression</article-title>
        <source>Pharmacogenomics J</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>332</fpage>
        <lpage>339</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2014.72</pub-id>
        <?supplied-pmid 25487678?>
        <pub-id pub-id-type="pmid">25487678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morvan</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Litie’re</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clary</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Ait-ouferoukh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bellott</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Messina</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of SNPs associated with response of breast cancer patients to neoadjuvant chemotherapy in the EORTC-10994 randomized phase III trial</article-title>
        <source>Pharmacogenomics J</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>63</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2014.24</pub-id>
        <?supplied-pmid 24958282?>
        <pub-id pub-id-type="pmid">24958282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pitkaniemi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heikkila</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chou</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>PAF</given-names>
          </name>
          <name>
            <surname>Korhonen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide time-to-event analysis on smoking progression stages in a family-based study</article-title>
        <source>Brain and Behavior</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>e00462</fpage>
        <pub-id pub-id-type="doi">10.1002/brb3.462</pub-id>
        <?supplied-pmid 27134767?>
        <pub-id pub-id-type="pmid">27134767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phipps</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Passarelli</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Jeon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hutter</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Common genetic variation and survival after colorectal cancer diagnosis: a genome-wide analysis</article-title>
        <source>Carcinogenesis</source>
        <year>2016</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>87</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/carcin/bgv161</pub-id>
        <?supplied-pmid 26586795?>
        <pub-id pub-id-type="pmid">26586795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Weinhold</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Begum</surname>
            <given-names>DB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association study identifies variation at 6q25.1 associated with survival in multiple myeloma</article-title>
        <source>Nature Communications</source>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kraft</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stolzenberg-Solomon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Steplowski</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Brotzman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association study of survival in patients with pancreatic adenocarcinoma</article-title>
        <source>Gut</source>
        <year>2014</year>
        <volume>63</volume>
        <issue>1</issue>
        <fpage>152</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1136/gutjnl-2012-303477</pub-id>
        <?supplied-pmid 23180869?>
        <pub-id pub-id-type="pmid">23180869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aulchenko</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Struchalin</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Duijn</surname>
            <given-names>CMV</given-names>
          </name>
        </person-group>
        <article-title>ProbABEL: package for genome-wide association analysis of imputed data</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>134</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-134</pub-id>
        <?supplied-pmid 20233392?>
        <pub-id pub-id-type="pmid">20233392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Howie B, Marchini J. IMPUTE2. <ext-link ext-link-type="uri" xlink:href="https://mathgen.stats.ox.ac.uk/impute/impute_v2.html#home">https://mathgen.stats.ox.ac.uk/impute/impute_v2.html#home</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Syed</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jorgensen</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>SurvivalGWAS_Power: a user friendly tool for power calculations in pharmacogenetic studies with “time to event” outcomes</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>523</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1407-9</pub-id>
        <?supplied-pmid 27931206?>
        <pub-id pub-id-type="pmid">27931206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Mono. <ext-link ext-link-type="uri" xlink:href="http://www.mono-project.com/">http://www.mono-project.com/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Syed</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jorgensen</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of methodology for the analysis of “time-to-event” data in pharmacogenomic genome-wide association studies</article-title>
        <source>Pharmacogenomics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>907</fpage>
        <lpage>915</lpage>
        <pub-id pub-id-type="doi">10.2217/pgs.16.19</pub-id>
        <?supplied-pmid 27248145?>
        <pub-id pub-id-type="pmid">27248145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Su Z, Marchini J, Donnelly P. HAPGEN2. <ext-link ext-link-type="uri" xlink:href="https://mathgen.stats.ox.ac.uk/genetics_software/hapgen/hapgen2.html">https://mathgen.stats.ox.ac.uk/genetics_software/hapgen/hapgen2.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The International HapMap 3 Consortium</collab>
        </person-group>
        <article-title>Integrating common and rare genetic variation in diverse human populations</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>52</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09298</pub-id>
        <pub-id pub-id-type="pmid">20811451</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
