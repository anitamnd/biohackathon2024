<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3035802</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq698</article-id>
    <article-id pub-id-type="publisher-id">btq698</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>X-MATE: a flexible system for mapping short read data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wood</surname>
          <given-names>David L. A.</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Xu</surname>
          <given-names>Qinying</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pearson</surname>
          <given-names>John V.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cloonan</surname>
          <given-names>Nicole</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grimmond</surname>
          <given-names>Sean M.</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1">Queensland Centre for Medical Genomics, Institute for Molecular Bioscience, The University of Queensland, St. Lucia 4072, Queensland, Australia</aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup> To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup> The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: John Quackenbush</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>4</issue>
    <fpage>580</fpage>
    <lpage>581</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>9</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>11</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>12</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Accurate and complete mapping of short-read sequencing to a reference genome greatly enhances the discovery of biological results and improves statistical predictions. We recently presented RNA-MATE, a pipeline for the recursive mapping of RNA-Seq datasets. With the rapid increase in genome re-sequencing projects, progression of available mapping software and the evolution of file formats, we now present X-MATE, an updated version of RNA-MATE, capable of mapping both RNA-Seq and DNA datasets and with improved performance, output file formats, configuration files, and flexibility in core mapping software.</p>
      <p><bold>Availability:</bold> Executables, source code, junction libraries, test data and results and the user manual are available from <ext-link ext-link-type="uri" xlink:href="http://grimmond.imb.uq.edu.au/X-MATE/">http://grimmond.imb.uq.edu.au/X-MATE/</ext-link>.</p>
      <p><bold>Contact:</bold><email>n.cloonan@uq.edu.au</email>; <email>s.grimmond@uq.edu.au</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq698/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> Online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>A major step in most deep-sequencing data analysis is mapping of the many million short reads to a reference genome, a process which is both computationally and strategically challenging (<xref ref-type="bibr" rid="B7">Trapnell and Salzberg, 2009</xref>). Effective downstream analysis relies heavily on the quality of this mapping (<xref ref-type="bibr" rid="B6">Pepke <italic>et al.</italic>, 2009</xref>). Incomplete mapping discards precious data, and may limit the identification of biologically relevant information. Problems associated with inaccurate mapping can be more difficult to identify, but include bias in the quantification of differential gene expression, poor statistical power when detecting sequence variants, or greater noise and complexity when de-convoluting genomic re-arrangements.</p>
  <p>We have previously described the recursive mapping strategy which combats the typical decrease in tag quality towards the 3<sup>′</sup> end, and allows the alignment of short inserts with 3<sup>′</sup> trailing adaptor sequence (<xref ref-type="bibr" rid="B1">Cloonan <italic>et al.</italic>, 2009</xref>). In this strategy, tags are first mapped at full length, and then if unaligned, truncated then mapped again. Quality profiles for mapped tags indicate that those mapping at a shorter lengths do so because the truncated section contains poorer quality sequence (<xref ref-type="fig" rid="F1">Fig. 1</xref>; Supplementary <xref ref-type="fig" rid="F1">Fig. 1</xref>). The recursive approach increases the mapped data yield while maintaining exon mapping specificity (Supplementary Fig. 2), extracting as much value as possible from the experiment.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Average quality of each di-nucleotide (colour) over 50 nt SOLiD gDNA tags for five recursive runs, denoted using the code length.mismatches.mode. Mode 1 treats valid adjacent mismatches as a single mismatch (optimal for 25mer tags), and mode 0 as two mismatches. Although reads are truncated when mapped, the data shown represents the original length and quality. Truncated reads show a steeper decline in quality (<bold>a</bold>), and an increased probability of a mismatch in the truncated portion (<bold>b</bold>). The wobble particularly noticeable in (<bold>a</bold>) and also evident in (<bold>b</bold>) is a quality profile characteristic of the SOLiD five primer ligation cycle. The general trend is consistent in base-space data (Supplementary <xref ref-type="fig" rid="F1">Fig. 1</xref>).</p></caption><graphic xlink:href="btq698f1"/></fig></p>
  <p>Although RNA-MATE was specifically designed for (and effectively limited to) colour-space stranded RNA-Seq data, the recursive approach works equally well on all sequencing datasets. To increase the utility of this software, and provide further enhancements, we have significantly revised and updated the RNA-MATE pipeline. Here, we present X-MATE, a system for flexible and comprehensive mapping of all deep-sequencing datasets. A comparison of features between RNA-MATE and X-MATE can be found in <xref ref-type="table" rid="T1">Table 1</xref>.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Feature matrix summarizing the major improvements between RNA-MATE and X-MATE</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Feature</th><th align="left" rowspan="1" colspan="1">RNA-MATE</th><th align="left" rowspan="1" colspan="1">X-MATE</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">Mapping Engine</td><td align="left" rowspan="1" colspan="1">Fixed</td><td align="left" rowspan="1" colspan="1">Flexible</td></tr><tr><td align="left" rowspan="1" colspan="1">Data type</td><td align="left" rowspan="1" colspan="1">Stranded RNA-Seq only</td><td align="left" rowspan="1" colspan="1">Stranded or unstranded RNA-Seq, gDNA, CAGE, ChIP-Seq, etc</td></tr><tr><td align="left" rowspan="1" colspan="1">Data Encoding</td><td align="left" rowspan="1" colspan="1">Colour-space only</td><td align="left" rowspan="1" colspan="1">Colour-space or base-space</td></tr><tr><td align="left" rowspan="1" colspan="1">Map to junctions</td><td align="left" rowspan="1" colspan="1">Required</td><td align="left" rowspan="1" colspan="1">Optional</td></tr><tr><td align="left" rowspan="1" colspan="1">Output formats</td><td align="left" rowspan="1" colspan="1">BED, Wiggle</td><td align="left" rowspan="1" colspan="1">BED, Wiggle, SAM</td></tr><tr><td align="left" rowspan="1" colspan="1">Multi-map rescue</td><td align="left" rowspan="1" colspan="1">MuMRescue</td><td align="left" rowspan="1" colspan="1">MuMRescueLite</td></tr><tr><td align="left" rowspan="1" colspan="1">Configuration</td><td align="left" rowspan="1" colspan="1">Cumbersome</td><td align="left" rowspan="1" colspan="1">Improved</td></tr></tbody></table></table-wrap>
</p>
  <sec sec-type="" id="SEC1">
    <title>1 SUPPORT FOR MULTIPLE DATATYPES</title>
    <p>X-MATE provides full support for both unstranded and stranded RNA- and DNA-derived datasets, including CAGE and ChIP-Seq.</p>
    <p>The expected strand for a dataset can be easily configured, and when mapping stranded datasets, output files summarizing mapping results are created for each strand, allowing analysis and visualization of strand mapping specificity. When mapping unstranded data these results are combined into single output files. In both cases, libraries of known exon–exon junctions can be optionally used during alignment, either simultaneously with chromosome mapping, or after chromosome mapping.</p>
  </sec>
  <sec sec-type="" id="SEC2">
    <title>2 ALTERNATIVE MAPPING ENGINES SUPPORTING BASE- AND COLOUR-SPACE</title>
    <p>By default mapreads is used, but if licensed, ISAS can be chosen. ISAS is an extremely fast alignment system capable of performing exhaustive searches, or using a heuristic algorithm to greatly increase search speeds (see Supplementary File 1 for notes on performance). ISAS also implements a variable-length mapping mode and can be chosen in place of the X-MATE recursive mapping. The modular redesign of X-MATE allows for further alignment programs to be incorporated into the package if required. As both mapreads and ISAS can map in base-space, we have passed this additional capability to X-MATE, and it now maps base-space data natively (fasta format for mapreads, and fastq format for ISAS).</p>
  </sec>
  <sec sec-type="" id="SEC3">
    <title>3 SAM FORMAT OUTPUT NOW SUPPORTED</title>
    <p>To assist with interrogating the mapped data, X-MATE provides multiple data output formats (bed, and wiggle files) consistent with commonly used visualization tools such as UCSC genome browser (<xref ref-type="bibr" rid="B4">Kent <italic>et al.</italic>, 2002</xref>) and powerful bioinformatic middleware platforms like Galaxy (<xref ref-type="bibr" rid="B2">Goecks <italic>et al.</italic>, 2010</xref>). In addition, to provide for backward compatibility of previously mapped data (output in ‘collated’ format), and to assist in tertiary analysis, we have included a Java utility for data transformation of colour-space mapped data into Sequence Alignment/Map (SAM) format. SAM files can be converted to Binary Alignment/Map (BAM) files using Samtools (<xref ref-type="bibr" rid="B5">Li <italic>et al.</italic>, 2009</xref>), and are becoming the default input file format for many genome browsers (e.g. the Integrative Genomics Viewer, IGV, <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/igv">http://www.broadinstitute.org/igv</ext-link>). Using SAM and BAM files, mapped data can be viewed in single nucleotide resolution, and can also be passed directly to downstream software for tertiary analysis such as transcript assembly, SNP calling, structural re-arrangement detection and more.</p>
  </sec>
  <sec sec-type="" id="SEC4">
    <title>4 RESOURCE USAGE AND UTILITIES</title>
    <p>X-MATE requires modest memory (4 GB is sufficient), and although running on desktop computers is possible, the use of a distributed cluster is recommended. We have updated the multi-map rescue strategy module to use the more memory efficient MuM Rescue Lite (<xref ref-type="bibr" rid="B3">Hashimoto <italic>et al.</italic>, 2009</xref>), and included a utility to restart a mapping run from the ‘rescue’ stage. Utilities tailored to RNA-Seq data for the creation of junction libraries and for the quantification of reads mapping to the expected strand when library protocols generate stranded data are added, the latter useful in determining the quality of a sequencing library. Finally, utilities for analysis of mapping yield and for cleaning up residual files after a mapping run have been included (see descriptions in Supplementary File 1).</p>
  </sec>
  <sec sec-type="" id="SEC5">
    <title>5 SIMPLIFIED CONFIGURATION FILES</title>
    <p>Setting up an X-MATE run is now straightforward using our new configuration format. Example configuration files for many possible mapping strategies and dataset types have been provided with the X-MATE distribution. The system contains improved code quality, commenting and modularization, facilitating further enhancements and ongoing maintenance.</p>
  </sec>
  <sec sec-type="" id="SEC6">
    <title>6 FUTURE DIRECTIONS</title>
    <p>Future enhancements planned are the addition of more mapping engines, utilities to compare mapping runs and provide information to optimize mapping parameters and upkeep with file input and output formats. All source code and documentation, test datasets with results and junction libraries are freely available from <ext-link ext-link-type="uri" xlink:href="http://grimmond.imb.uq.edu.au/X-MATE/">http://grimmond.imb.uq.edu.au/X-MATE/</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_4_580__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btq698_Supplementary_Figure_1.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btq698_Supplementary_Figure_2.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btq698_supplementary_file_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank D.F. Taylor and S. Wood for web and system administrator support, R. Yip and G. Kolle for SAM file conversion software components and advice and H. Isaac for advice on ISAS.</p>
    <p><italic>Funding</italic>: National Health and Medical Research Council (455857 to S.M.G. 456140, 631701); Australian Research Council (DP1093164 to N.C., DP0988754). D.L.A.W receives an Australian Postgraduate Award from the Australian Federal Government.</p>
    <p><italic>Conflict of Interest:</italic> None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cloonan</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-MATE: a recursive mapping strategy for high-throughput RNA-sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2615</fpage>
        <lpage>2616</lpage>
        <pub-id pub-id-type="pmid">19648138</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goecks</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R86</fpage>
        <pub-id pub-id-type="pmid">20738864</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hashimoto</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic resolution of multi-mapping reads in massively parallel sequencing data using MuMRescueLite</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2613</fpage>
        <lpage>2614</lpage>
        <pub-id pub-id-type="pmid">19605420</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pepke</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computation for ChIP-seq and RNA-seq studies</article-title>
        <source>Nature. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>S22</fpage>
        <lpage>S32</lpage>
        <pub-id pub-id-type="pmid">19844228</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>How to map billions of short reads onto genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>455</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="pmid">19430453</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
