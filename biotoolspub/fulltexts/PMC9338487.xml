<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9338487</article-id>
    <article-id pub-id-type="publisher-id">4858</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04858-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Joint analysis of scATAC-seq datasets using epiConv</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lin</surname>
          <given-names>Li</given-names>
        </name>
        <address>
          <email>linli@shanghaitech.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Liye</given-names>
        </name>
        <address>
          <email>zhangly@shanghaitech.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.440637.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 4657 8879</institution-id><institution>School of Life Science and Technology, </institution><institution>ShanghaiTech University, </institution></institution-wrap>Shanghai, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>309</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Technical improvement in ATAC-seq makes it possible for high throughput profiling the chromatin states of single cells. However, data from multiple sources frequently show strong technical variations, which is referred to as batch effects. In order to perform joint analysis across multiple datasets, specialized method is required to remove technical variations between datasets while keep biological information.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present an algorithm named epiConv to perform joint analyses on scATAC-seq datasets. We first show that epiConv better corrects batch effects and is less prone to over-fitting problem than existing methods on a collection of PBMC datasets. In a collection of mouse brain data, we show that epiConv is capable of aligning low-depth scATAC-Seq from co-assay data (simultaneous profiling of transcriptome and chromatin) onto high-quality ATAC-seq reference and increasing the resolution of chromatin profiles of co-assay data. Finally, we show that epiConv can be used to integrate cells from different biological conditions (T cells in normal vs. germ-free mouse; normal vs. malignant hematopoiesis), which reveals hidden cell populations that would otherwise be undetectable.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this study, we introduce epiConv to integrate multiple scATAC-seq datasets and perform joint analysis on them. Through several case studies, we show that epiConv removes the batch effects and retains the biological signal. Moreover, joint analysis across multiple datasets improves the performance of clustering and differentially accessible peak calling, especially when the biological signal is weak in single dataset.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04858-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>scATAC-seq</kwd>
      <kwd>Cell clustering</kwd>
      <kwd>Batch effects</kwd>
      <kwd>Data integration</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NSF 31871332</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Liye</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">The expression of genes is regulated by transcription factors (TFs) that bind to the regulatory elements of the genome. As the accessible chromatin covers more than 90% TF binding regions, many techniques, such as Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq), have been developed to detect accessible chromatin [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Technical advancements have made it possible to profile the chromatin states of single cells at a high-throughput manner and along with other molecular modalities (e.g. transcriptomes) in the same cells [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. In recent years, several studies have put efforts to profile chromatin landscapes of organisms at single-cell resolution and generated atlas of datasets across diverse species, tissues and conditions [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Joint analysis on these data will help us better learn the roles of chromatin states under healthy and disease conditions.</p>
    <p id="Par5">Similar to RNA-seq, ATAC-seq data from multiple sources routinely shows strong technical variations and suffers from batch effects [<xref ref-type="bibr" rid="CR9">9</xref>], which limits large-scale analysis across datasets. Batch correction on scATAC-seq data is more challenging as it is difficult to capture and correct batch derived variations on nearly binary chromatin profiles. Most clustering algorithms for scATAC-seq data capture biological information by learning a series of latent features from binary chromatin profiles. As most benchmarking studies up to now are performed on datasets with little batch effects [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], whether these clustering algorithms are confounded by batch effects is unknown. In scRNA-seq analysis, batch effects can be removed by linear correction on a set of gene expression-derived meta features (e.g. Principal Components) [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. However, it remains unclear whether batch effects of scATAC-seq can be corrected similarly on latent features by existing tools.</p>
    <p id="Par6">Here, we develop a novel algorithm named epiConv (<ext-link ext-link-type="uri" xlink:href="https://github.com/LiLin-biosoft/epiConv">https://github.com/LiLin-biosoft/epiConv</ext-link>) to remove batch effects between scATAC-seq datasets with better performance than existing tools. We find that latent feature learning algorithms benchmarked in existing studies (cisTopic [<xref ref-type="bibr" rid="CR11">11</xref>], Latent Sematic Indexing (LSI) [<xref ref-type="bibr" rid="CR4">4</xref>], SCALE [<xref ref-type="bibr" rid="CR15">15</xref>] and SnapATAC [<xref ref-type="bibr" rid="CR16">16</xref>]) all suffered from batch effects and in some cases, they could not be removed by linear correction using existing tools for scRNA-seq (Harmony [<xref ref-type="bibr" rid="CR12">12</xref>], Mutual Nearest Neighbors (MNN) [<xref ref-type="bibr" rid="CR14">14</xref>] and Seurat [<xref ref-type="bibr" rid="CR17">17</xref>]). Unlike existing methods, epiConv directly calculates the similarities between cells without embedding them into the latent feature space. Although this strategy performs similarly compared to other methods in single cell clustering, subsequent batch correction on the similarity matrix better removes batch effects and, in the meantime, retains biological signals. Besides batch correction, we also demonstrate that epiConv can be used to analyze co-assay data through data integration. Aligning co-assay data to high quality scATAC-seq reference significantly increased the resolution of chromatin profiles and revealed thousands of putative connections between cis-regulatory elements and their target genes. Finally, we showed that integration of single cells in different biological conditions (T cells from germ-free and normal mouse, normal vs. malignant hematopoiesis) reveals the hidden heterogeneities between cells that cannot be detected from single dataset.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Batch correction algorithms of epiConv</title>
      <p id="Par7">EpiConv first calculates the similarity matrix <italic>S</italic> between single cells from a binarized matrix <italic>M</italic>, where rows represent peaks and columns represent cells. The similarity between two cells is calculated by the dot product of two cell vectors, which means that the similarity matrix is calculated by matrix product <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${M}^{T}M$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4858_Article_IEq1.gif"/></alternatives></inline-formula>. After normalization by library size, the similarity matrix can be used for other downstream analyses (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). A detailed description of this step can be found in Supplementary Note. In datasets with no batch effects, epiConv performs similarly or slightly better compared to existing algorithms (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). The result suggested that the relationships between single cells can be directly learned from the binary accessibility profiles using simple approach.<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of epiConv algorithm. <bold>a</bold> Workflow of calculating similarity matrix between single cells. The similarity matrix is calculated by matrix product of feature by cell matrix <italic>M</italic> and is normalized by library size. Downstream analyses are applied on normalized similarity matrix. <bold>b</bold> Workflow of batch correction. EpiConv removes the batch effects through linear correction on the <italic>r</italic> Eigen vectors of the similarity matrix.</p></caption><graphic xlink:href="12859_2022_4858_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">Up to now, most batch correction tools can only be applied to cells embedded in Euclidean space, which is not available in our algorithm. To overcome this problem, we develop an approach to remove batch effects on pairwise cell-cell similarity matrix (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). In the first step of batch correction, we apply Eigenvalue Decomposition to the normalized similarity matrix <italic>S</italic> and keep <italic>r</italic> Eigen values (diagonal elements of <italic>Λ</italic>) with the largest absolute values and their corresponding Eigen vectors <italic>X</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Step 1). <italic>X</italic> capture the major variations of the data (including biological and technical variations) and their contributions to the similarity matrix are weighted by <italic>Λ</italic>. The number of Eigen vectors <italic>r</italic> depends on the complexity of data and an appropriate <italic>r</italic> can be easily obtained by manually examining the batch effects on Eigen vectors. In this study, we set <italic>r </italic>= 30 unless otherwise mentioned.</p>
      <p id="Par9">If the dataset is large (e.g. ~ 100k cells), we first sample <italic>m</italic><sub>1</sub> cells and calculate the Eigen vectors of sampled cells <italic>X</italic><sub><italic>sample</italic></sub> and <italic>Λ</italic>. The Eigen vectors of <italic>m</italic><sub>2</sub> unsampled cells <italic>X</italic><sub><italic>unsample</italic></sub> is calculated by the least square solution of the equation <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S^{\prime } = X_{sample} \Lambda X_{unsample}^{T}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">sample</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">unsample</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4858_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>S’</italic> ϵ <italic>m</italic><sub>1</sub><italic> x m</italic><sub>2</sub> is the similarity matrix between <italic>m</italic><sub>1</sub> sampled and <italic>m</italic><sub>2</sub> unsampled cells. Such approximation has little effects on the Eigenvalue Decomposition if <italic>m</italic><sub>1</sub> is large enough to cover all cell types but reduces the memory requirement and running time for large datasets.</p>
      <p id="Par10">Second, we create a k-nearest-neighbor (KNN) graph between datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Step 2). For simplicity, assume that we have one query dataset <italic>A</italic> and one reference dataset <italic>B</italic>. For one cell <italic>a</italic> in <italic>A</italic>, we find its <italic>k</italic><sub>1</sub> nearest neighbors in <italic>B</italic> (<italic>b</italic><sub>1</sub><italic>, b</italic><sub>2</sub><italic>,…</italic>,<italic>b</italic><sub><italic>k</italic>1</sub>). The initial <italic>k</italic><sub>1</sub> nearest neighbors may contain cells that don’t share the same cell type as <italic>a</italic> (dash lines in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b Step 2) when the corresponding cell type is not available in <italic>B</italic> or simply due to noise. We introduce a filtering step to remove them. For each cell <italic>b</italic> in <italic>B</italic>, we find its <italic>k</italic><sub>2</sub> nearest neighbors in <italic>A</italic> and calculated the mean and standard deviation (<italic>u</italic><sub><italic>b</italic></sub> and <italic>σ</italic><sub><italic>b</italic></sub>) of them for each Eigen vector and Principal Component of RNA-seq (if <italic>A</italic> is multi-omics data). If <italic>a</italic> in <italic>A</italic> finds a neighbor <italic>b</italic><sub>1</sub> in <italic>B</italic> but <italic>a</italic> is out of the range <italic>u</italic><sub><italic>b</italic>1 </sub>± 2<italic>σ</italic><sub><italic>b</italic>1</sub> in any Eigen vector or PC of RNA-seq (In dataset <italic>A</italic>, there are some cells more similar to <italic>b</italic><sub>1</sub> but differing from <italic>a</italic>), we remove <italic>b</italic><sub>1</sub> from <italic>a</italic>’s neighbors.</p>
      <p id="Par11">After filtering, some cells in <italic>A</italic> may still keep several neighbors in <italic>B</italic> while others may lose most of its initial neighbors. Cells in <italic>A</italic> that have enough neighbors in <italic>B</italic> (≥ 5 in this study) are used as anchors to calculate correction vectors (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). For each anchor in <italic>A</italic>, we calculate the correction vectors between itself and its neighbors in <italic>B</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Step 3). The correction vectors of other non-anchor cells are calculated by the weighted mean of its most similar anchors (10 anchors in this study) on a shared-nearest-neighbor graph (SNN graph) of <italic>A</italic>, where the weight is equal to the edge of SNN graph. The SNN graph can be calculated from ATAC-seq or combined with RNA-seq profiles (if available).</p>
      <p id="Par12">Finally, the Eigen vectors of all cells in <italic>A</italic> are corrected accordingly and the similarity matrix is re-calculated from <italic>X</italic><sub><italic>corrected</italic></sub> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Step 4). Notably, retaining the residuals of Eigenvalue decomposition is an important step in batch correction. Although residuals in dimension reduction procedure are generally considered as noise and are removed in most methods, we find that directly inferring the relationships between cells in the reduced dimension of Eigenvectors like existing methods results in partial correction and lower accuracy (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9c, d in hematopoiesis dataset below), implying that the residuals contain biological signals.</p>
      <p id="Par13">EpiConv can also perform integration of multiple reference datasets and multiple query datasets. When multiple references and query datasets are available, we first integrate all references together (project Ref <italic>B</italic> to Ref <italic>A</italic>, then project Ref <italic>C</italic> to combined dataset containing A and B, …) and then align each query dataset to the combined dataset containing all references.</p>
      <p id="Par14">We used Uniform Manifold Approximation and Projection [<xref ref-type="bibr" rid="CR18">18</xref>] (UMAP) in R package umap to learn 2D embeddings of single cells and Louvain algorithm implemented in R package Seurat [<xref ref-type="bibr" rid="CR17">17</xref>] to cluster cells. In order to reduce noise, the similarity matrix between cells is first transformed to SNN graph (<italic>S</italic><sub><italic>snn</italic></sub>) described above, with number of nearest neighbors set to 1% of total cells. Then, the distance matrix (Max (<italic>S</italic><sub><italic>snn</italic></sub>) − <italic>S</italic><sub><italic>snn</italic></sub>) is used as UMAP input. The Louvain clustering is performed on the transformed UMAP graph <italic>G</italic> from the distance matrix (Max (<italic>S</italic><sub><italic>snn</italic></sub>)  − <italic>S</italic><sub><italic>snn</italic></sub>) to generate consistent results between dimension reduction and clustering. All unmentioned settings are set to default values and the resolution setting in Louvain clustering is manually adjusted between 0.2 and 2.0.</p>
    </sec>
    <sec id="Sec4">
      <title>EpiConv is less prone to over-fitting</title>
      <p id="Par15">We first applied epiConv to two peripheral blood mononuclear cells (PBMCs) datasets sequenced by two protocols (10x Genomics and dscATAC-seq) to compare its performance with other methods [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. The batch effects between two datasets were largely removed by epiConv (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). We used the LISI metric (equal to the effective number of batches in each cell’s local neighborhood) to quantitatively evaluate the mixing of cells from two batches and epiConv showed clear advantage over other methods (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). The UMP visualization also suggested that Harmony and MNN based methods failed to correct the batch effects while Seurat based methods performed better than them (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). Besides the batch correction, there were many small clusters with mixed cell identities in all SnapATAC results, suggesting technical biases derived from the step of latent feature learning but not batch correction (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2; highlighted by dashed circle).<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarking of epiConv on integrating two PBMC datasets. <bold>a</bold> Low dimensional embedding of PBMCs before and after batch correction. <bold>b</bold> local inverse Simpson’s Index (LISI) of different methods. The LISI is equal to the effective number of batches in each cell’s neighborhood. <bold>c</bold> Low dimensional embeddings of PBMCs after batch correction by Seurat based methods. <bold>d</bold> Comparison of epiConv and Seurat based methods after removing B cells, monocytes and NK cells from the reference (dsc).</p></caption><graphic xlink:href="12859_2022_4858_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par16">To perform further benchmarking between epiConv and Seurat (the one performed better among existing tools) based methods, we generated a new reference batch with only T cells and removed NK cells, B cells and monocytes from the reference (dscATAC-seq) and performed batch correction with the new reference again (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). EpiConv corrected the batch effects between T cells and grouped other cells as distinct clusters, suggesting that it was almost unaffected by the removal of NK cells, B cells and monocytes from reference. However, we found that some NK cells, B cells and monocytes in the query dataset were mixed with T cells in the reference dataset (the proportion of over-fitted cells in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d; see Methods section for the definition of over-fitted cells) after Seurat batch correction, which resulted in lower clustering accuracy (ARI in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). The results of SCALE/SnapATAC + Seurat were severely affected as B cell and monocyte clusters were merged with T cells. The results of CisTopic/LSI + Seurat were less affected but there was still higher fraction of over-fitted cells than epiConv. These incorrectly placed cells were unlikely to be contaminations from experiments as they could not be found in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c. We found that in the Canonical Correlation Analysis (CCA) space of Seurat when NK cells, B cells and monocytes were removed from reference dataset, T cells in the reference dataset became closer to other cell types in the query dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3a), which caused a large number of mis-identified anchors and subsequent over-fitting problem in batch correction (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3b). These results suggested that Seurat based methods might be vulnerable to over-fitting in scATAC-seq data when certain cell types were uniquely present in query, but not in the reference dataset.</p>
    </sec>
    <sec id="Sec5">
      <title>EpiConv better retains the biological variations</title>
      <p id="Par17">We also evaluated the performance of epiConv and other methods on another mouse lung data [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. EpiConv removed the batch effects between three datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). To assess the accuracy of clustering, we annotated clusters according to original article [<xref ref-type="bibr" rid="CR21">21</xref>] and performed differential analysis on three datasets. The majority of cell-type specific markers were consistent across datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4a). For Basophils and Neutrophils whose markers could not be detected due to low abundance in some datasets, we performed differential analysis on cells of GSE145194 and calculated cell-type specific signatures for single cells. The results suggested that Basophils and Neutrophils were also correctly aligned (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4b). Other methods also removed the batch effects between datasets but always mixed Ciliated/Club cells and AT2 cells together (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). Moreover, epiConv suggested that Ciliated/Club cells could be further segregated into two groups. To validate our findings, we performed differential analysis on three groups of cells (Ciliated/Club 1, Ciliated/Club 2 and AT2 cells) from GSE145194 to obtain their marker regions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b) and calculated the cluster-specific signatures across three datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). The results suggested that such biological heterogeneities indeed existed as we could obtain a large number of markers for each cluster. Three types of cells were correctly grouped together by epiConv according to cell-type specific signatures. Although some methods could also segregate ciliated/club and AT2 cells, they could not segregate two ciliated/club subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5).<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmarking of epiConv on integrating three mouse lung datasets. <bold>a</bold> Low dimensional embedding of mouse lung data before and after batch correction. AT1, alveolar type 1 cell; AT2, alveolar type 2 cell. <bold>b</bold> EpiConv clusters AT2 cells and Ciliated/Club cells into three clusters, each with its unique accessible peaks. <bold>c</bold> Cell-type specific signatures of AT2, Ciliated/Club 1 and Ciliated/Club 2 cells. <bold>d</bold> CisTopic detects the difference between AT2 and Ciliated/Club cells on single dataset but failed on integrated datasets.</p></caption><graphic xlink:href="12859_2022_4858_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par18">We found that mixing of Ciliated/Club cells and AT2 cells was not caused by batch correction but by the upstream clustering algorithms. We used cisTopic as an example to show this phenomenon. We applied cisTopic to a single dataset (GSE145194) and found that cisTopic could also segregate AT2 cells from Ciliated/Club cells and detect two sub-clusters of Ciliated/Club cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). However, when applied to combined datasets, cisTopic failed to detect the difference between AT2 cells and Ciliated/Club cells even before batch correction. This result suggested that batch effect did not only introduce a systematic difference between cells of different batches but also blurred the biological signal in latent features. In such case, no batch correction method could segregate different types of cells when directly applied to latent features, as the information was already lost.</p>
    </sec>
    <sec id="Sec6">
      <title>Aligning co-assay data to scATAC-seq references</title>
      <p id="Par19">EpiConv can also increase the resolution of chromatin profiles through joint analysis. Next, we demonstrated that aligning the ATAC-seq profiles of co-assay data (perform scRNA-seq and scATAC-seq simultaneously on the same cells) onto scATAC-seq references overcame the shortcomings of shallow sequencing depth in co-assay data and improved the performance of clustering and differentially accessible peaks calling. We integrated three datasets together (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a), one co-assay dataset of adult mouse cerebral cortex [<xref ref-type="bibr" rid="CR6">6</xref>] (SNARE-seq) as query dataset, two scATAC-seq datasets of adult mouse brain [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] (sci-ATAC-seq and dscATAC-seq) that served as references, whose sequencing depth were ~5 times deeper than the scATAC-seq of co-assay data. Single cells from three datasets were mixed together without obvious batch effects by epiConv and the embedding were consistent with RNA-seq derived clusters (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Rare cell types (C03 and C11) were also clearly segregated by epiConv (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b).<fig id="Fig4"><label>Fig. 4</label><caption><p>Aligning co-assay (SNARE-seq) data of mouse cerebral cortex to scATAC-seq (sci-ATAC-seq and dscATAC-seq) references increases the resolution of chromatin profiles. <bold>a</bold> Low dimensional embedding and clustering of co-assay data based on scRNA-seq profiles. <bold>b</bold> Joint embedding of scATAC-seq from co-assay data and scATAC-seq references. <bold>c</bold> The Adjusted Rank Index (ARI) and LISI of different methods. <bold>d</bold> Result of LSI + Seurat in details. LSI + Seurat groups cells with mixed identities together. <bold>e</bold> Joint embedding of scATAC-seq from co-assay data and scATAC-seq references, cells are colored by manually annotated joint clusters. Ex, excitatory neuron; In, inhibitory neuron; Oligo, oligodendrocyte; OPC, oligodendrocyte progenitor cell; Ast, astrocyte; Mic, microglia. <bold>f</bold> Heatmap of chromatin markers and their nearest genes. Left: chromatin profiles of sci-ATAC-seq. Middle: chromatin profiles of SNARE-seq. Right: gene expression profiles of SNARE-seq. Selected marker genes with highest fold changes are shown in the right panel. <bold>g</bold> Aggregated ATAC-seq signals near the TSS of OPC maker gene <italic>Vcan</italic>. <bold>h</bold> Left (scATAC-seq) and middle (co-assay): The fold changes of enrichment between ATAC-seq defined marker regions and RNA-seq defined associated regions. Right: the number of detected markers from scATAC-seq references and co-assay data for each cluster.</p></caption><graphic xlink:href="12859_2022_4858_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">The low dimensional embeddings of other methods suggested that they could not fully remove the batch effects or were inconsistent with RNA-seq derived clusters (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). To quantitatively evaluate their performance, we used LISI metric to assess batch mixing and ARI to assess the consistency between clustering of ATAC-seq and RNA-seq. EpiConv outperformed most methods in both batch mixing and accuracy (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The overall performance of LSI + Seurat is similar compared to epiConv. However, the clustering of ATAC-seq data by LSI + Seurat did not agree with RNA-seq profiles (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). RNA-seq defined rare excitatory neuron C11 were mixed with other excitatory neurons (C01, C02 and C05) and a small fraction of cells from various RNA-seq derived clusters formed single cluster in ATAC-seq data (the ambiguous cluster in Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). SnapATAC + Harmony and SnapATAC + Seurat performed better in batch mixing than epiConv but with lower accuracy. The UMAP visualization showed that SnapATAC + Harmony grouped cells of C01, C02 and C05 into many small clusters and SnapATAC + Seurat grouped a large proportion of cells from C01, C02 and C05 into a single cluster, both of which showed strong contradictions with scRNA-seq data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6b).</p>
      <p id="Par21">Based on joint ATAC-seq clustering of integrated dataset (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, clusters were manually annotated by canonical makers), we found that RNA-seq derived cluster C09 could be further grouped into 3 cell types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, clusters highlighted by red circles), which referred to one major cell type (oligodendrocyte) and two rare cell types (oligodendrocyte progenitor cell and microglia) based on their highly expressed genes, suggesting that joint analysis increased the resolution of clustering for rare cell types or subtypes.</p>
      <p id="Par22">Next, we examined whether single cells of co-assay data were correctly assigned to the references. In each dataset, we performed differential analysis to get a set of marker peaks for each joint cluster to see whether these markers were conserved across different datasets. Although markers detected from two scATAC-seq references were consistent with each other, a significant portion of these markers were not clearly more accessible in the corresponding cell types of co-assay data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7a). Only markers of clusters with a large number of cells were conserved across three datasets (e.g. Ex 1–4) and many cluster-specific markers could only be detected from deep sequencing references. We argued that this might be due to shallow sequencing of co-assay data and further incorporated RNA-seq profiles to demonstrate that these peaks inferred from matched high depth references could be supported by transcriptome data. First, we linked each peak to its closest promoter in the genome. Then for each cluster, we got a series of associated peaks with its cluster-specific marker genes. We found 8534 chromatin markers from scATAC-seq references that showed consistent pattern with its associated genes (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f, left and right), revealing the potential relationships between cis-regulatory elements and their target genes. However, only a small fraction of these peaks (3031 peaks) was differentially accessible in SNARE-seq (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f, middle). Other peaks were not statistically significant or completely undetectable due to shallow sequencing. For instance, the ATAC-seq peaks near the promoter of <italic>Vcan</italic>, an OPC marker suggested by RNA-seq data, didn’t pass statistical threshold before integrating references (Fig. <xref rid="Fig4" ref-type="fig">4</xref>g).</p>
      <p id="Par23">To quantitatively measure the consistency between ATAC-seq and RNA-seq profiles, we calculated the fold change of enrichment between chromatin markers and marker gene associated peaks for each cluster (<italic>N</italic><sub><italic>common</italic></sub>/(<italic>N</italic><sub><italic>ATAC</italic></sub> * <italic>N</italic><sub><italic>RNA</italic></sub>) * <italic>N</italic><sub><italic>total</italic></sub>; <italic>N</italic><sub><italic>common</italic></sub>: number of shared peaks, <italic>N</italic><sub><italic>ATAC</italic></sub>: number of chromatin markers, <italic>N</italic><sub><italic>RNA</italic></sub>: number of marker gene associated peaks, <italic>N</italic><sub><italic>total</italic></sub>: number of total ATAC-seq peaks). We expected that peaks residing near the promoter of one gene were more likely to be its cis-regulatory elements and cluster-specific chromatin markers would enrich in the nearby regions of marker genes if joint analysis correctly clustered recurrent cell types from co-assay and scATAC-seq datasets together. Indeed, we observed the enrichment and for most clusters, we detected much more chromatin markers from scATAC-seq references and they were with similar or even higher extent of enrichment with marker gene associated peaks than chromatin profiles of SNARE-seq (Fig. <xref rid="Fig4" ref-type="fig">4</xref>h), proving that epiConv correctly assigned co-assay single cells to the references and increased sensitivity of differentially accessible peaks calling. We noted that there were few chromatin markers of Ex 6 and Ex 7 due to their small cluster size. In order to overcome this problem, we performed the analyses on 7 excitatory neuron clusters only and the results also supported the correctness of epiConv (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7b).</p>
    </sec>
    <sec id="Sec7">
      <title>Aligning cells in different biological conditions</title>
      <p id="Par24">In addition to batch correction, integration algorithms could also be used to align cells in different biological conditions. Here, we benchmarked the performance of epiConv by integrating CD4+ T cells from normal and germ-free mouse colon [<xref ref-type="bibr" rid="CR22">22</xref>]. In the original article, cells in normal and germ-free conditions were analyzed separately. Peripherally induced Treg cells (pTreg) were not found in germ-free condition but thymus-derived Treg cells (tTreg) still existed. Consistent with original article, we also found two distinct clusters referring to pTreg and tTreg in normal mouse but could only find one Treg cluster from germ-free mouse that matched the markers of tTreg (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8a) when analyzing two datasets separately. However, when CD4+ T cells from the two conditions were integrated by epiConv, there were two groups of cells from germ-free mouse that were clustered with pTreg and tTreg of normal mouse, separately (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a,b). To validate our findings, we performed differential analysis (tTreg vs. pTreg) on normal and germ-free mouse and found that there were a large proportion of conserved tTreg and pTreg markers in normal and germ-free conditions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8b), suggesting that Treg in germ-free condition could also be classified to two groups similarly but they could not be easily distinguished from each other without proper reference.<fig id="Fig5"><label>Fig. 5</label><caption><p>Integrative analysis based on EpiConv better detects tTreg signature in germ-free mouse. <bold>a</bold> Low dimensional embedding of epiConv before and after integration. <bold>b</bold> The accessibility of <italic>Rorc</italic> promoter in normal mouse shows the identities of thymic Tregs (tTregs, <italic>Rorc</italic><sup><italic>close</italic></sup>) and peripheral Tregs (pTregs, <italic>Rorc</italic><sup><italic>open</italic></sup>). <bold>c</bold> The number of differentially accessible peaks between tTregs and pTregs in germ-free condition. <bold>d</bold> The Z-score normalized values with corresponding mean and variance of hypergeometric distribution in differentially accessible peaks. EpiConv derived clusters show more significant enrichment of accessible peaks in tTreg and pTreg markers. <bold>e</bold> Enriched motifs in up-regulated peaks of tTregs defined by epiConv and SnapATAC + Harmony.</p></caption><graphic xlink:href="12859_2022_4858_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par25">We also applied other methods for comparison. Six method combinations removed the difference between T cells in two conditions (cisTopic + Harmony, cisTopic + Seurat, LSI + MNN, LSI + Seurat, SCALE + Seurat, SnapATAC + Harmony) and showed similar results that Tregs in both conditions could be classified into two groups (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8c). The differentially accessible peaks detected by epiConv and other six methods were highly consistent in both normal and germ-free conditions, suggesting that they all captured the variations between pTreg and tTreg. However, the number of differentially accessible peaks in germ-free condition detected by epiConv was much more than other methods (all methods detected close number of differentially accessible peaks in normal condition) and about half of them could also be detected in normal condition (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). As our differential analysis was based on hypergeometric test, clusters of higher purity would result in more differentially accessible peaks to be detected due to the enrichment of accessible peaks in one cluster. To assess the cluster purity of different methods, we normalized the differentially accessible peaks detected by epiConv and other six methods using the corresponding mean and variance of hypergeometric distribution. The clusters inferred by epiConv clearly better segregated accessible vs. inaccessible peaks and consequently resulted in more significant enrichment of accessible peaks in one cluster than other methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d).</p>
      <p id="Par26">We performed motif calling on differentially accessible peaks inferred by epiConv and SnapATAC + Harmony (the method that detected the second most differentially accessible peaks) to see whether they were associated with some TFs or simply due to technical noise (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). In up-regulated peaks in tTreg, we found four enriched motifs in germ-free condition. From the result of SnapATAC + Harmony, we also found the same set of enriched motifs but there were always fewer peaks containing the motif, which resulted in lower significance level. Given that these four motifs could also be detected in normal condition (data not shown), these results suggested that epiConv better detected the unique biological features of tTreg in germ-free condition. The motif of <italic>Rorc</italic> could be detected from pTreg in normal condition as expected (data not shown) but not in germ-free condition. No other motifs could be detected for pTreg in both conditions. Thus, the lack of <italic>Rorc</italic> mediated open chromatin might weaken the difference between two types of Tregs in germ-free condition and make it hard to segregate them.</p>
    </sec>
    <sec id="Sec8">
      <title>Aligning leukemic cells to normal hematopoiesis</title>
      <p id="Par27">We further benchmarked the performance of epiConv on a leukemia dataset by aligning malignant cells from mixed-phenotype acute leukemia (MPAL), which was known to present with features of multiple hematopoietic lineages, to normal hematopoiesis [<xref ref-type="bibr" rid="CR23">23</xref>]. The normal hematopoiesis reference contains bone marrow mononuclear cells (BMMCs) and CD34+ enriched BMMCs and the Leukemia data contains single cells from MPAL patients [<xref ref-type="bibr" rid="CR23">23</xref>]. After epiConv integration, all malignant cells were projected to the hierarchy of normal hematopoiesis (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). Most method combinations failed to project the malignant cells to normal hematopoiesis (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9a,b). Seurat based methods performed better than others but still worse than epiConv (LISI metric, Fig. <xref rid="Fig6" ref-type="fig">6</xref>b; embeddings, Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). We annotated clusters by comparing chromatin markers of normal cells with FACS-sorted bulk samples [<xref ref-type="bibr" rid="CR24">24</xref>] (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a right; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10a). In addition to known cell types, we also found two novel clusters (C08 and C09). The C08 cluster (T biased progenitor) was similar to stem cell cluster (C01) but was more accessible in the marker regions of T cells (~ 50% up-regulated peaks in C08 against C01 are T cell markers) and the C09 cluster (unknown progenitor) was moderately accessible in myeloid, lymphoid and erythroid lineage-specific regions. All malignant samples contained a large proportion of stem-like cells in C01 (from 27.5 to 63.7%, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10b, bottom line). Except for some clusters with few cells, malignant cluster-specific markers always showed the highest fold change of enrichment with corresponding markers of normal cells, suggesting that leukemic cells were assigned to the most similar normal cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10b).<fig id="Fig6"><label>Fig. 6</label><caption><p>EpiConv better aligns leukemic cells to normal hematopoiesis <bold>a</bold> Low dimensional embedding of epiConv before and after integration. HSC, hematopoietic stem cell; MPP, multipotent progenitors; LMPP lymphoid-primed multipotent progenitor; GMP, granulocyte-macrophage progenitor; MEP, megakaryocyte-erythroid progenitor; CLP, common lymphoid progenitor; Ery biased MPP, erythroid biased MPP; pDC, plasmacytoid dendritic cell; CMP, common myeloid progenitor, T biased prog, T cell biased progenitor; Unk prog, unknown progenitor. <bold>b</bold> The LISI metric of different methods. <bold>c</bold> Low dimensional embeddings of cisTopic, LSI, SCALE and SnapATAC after Seurat batch correction. <bold>d</bold> Sub-clusters of C01 with increased accessibility in PU.1 or GATA1 motifs and two lymphoid primed clusters (CLP and T biased prog). Malignant cells of MPAL4 projected to these four clusters were shown. <bold>e</bold> Cluster-specific markers shared by normal cells and malignant cells of MPAL4. <bold>f</bold> MPP<sup><italic>GATA1</italic></sup> signatures of normal cells and MPAL4 on the embedding of epiConv and LSI + Seurat.</p></caption><graphic xlink:href="12859_2022_4858_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par28">As the hematopoiesis dataset was the most strongly affected dataset by residuals of Eigenvalue decomposition, we also used it as an example to show how the residuals helped correct batch effects. Through UMAP embedding and LISI metric, we found that the batch effects in the corrected Eigenvector space without residuals were reduced but not fully corrected (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9c,d). Thus, the results proved that the residuals of Eigenvalue decomposition contained biological signals that were essential to recover shared identities of cells from different conditions.</p>
      <p id="Par29">Given that hematopoietic stem and progenitors cells (C01) contained multipotent progenitors with different lineage priming, we were interested in whether similar lineage bias could also be observed in malignant cells. To better reveal the lineage priming of cells in C01, we grouped C01 to two sub-clusters, one cluster with increased accessibility in PU.1 motifs (MPP<sup><italic>PU.1</italic></sup>) and the other with increased accessibility in GATA1 motifs (MPP<sup><italic>GATA1</italic></sup>) in normal cells, reflecting bias of MPPs to myeloid and erythroid lineages (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). We performed differential analysis on normal and malignant cells in MPP<sup><italic>PU.1</italic></sup>, MPP<sup><italic>GATA1</italic></sup> and two lymphoid priming clusters (CLP/C07 and T biased prog/C08) to find conserved markers between normal and malignant cells, which could directly support our assignments of malignant cells. As expected, the corresponding cluster-specific markers between normal and malignant samples always showed higher fold change of enrichment (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11a). Malignant cells of MPAL1, MPAL4 were projected to all of the four clusters and shared a common set of 3,892 conserved markers with normal cells (MPAL4, Fig. <xref rid="Fig6" ref-type="fig">6</xref>e; MPAL1, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11b). Most cells of MPAL3 were projected to MPP<sup><italic>GATA1</italic></sup> and T biased prog (C08) and also agreed with MPAL1 and MPAL4 and shared the same set of conserved markers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11b, clusters &lt; 250 cells were not included in differential analysis). Malignant cells of MPAL5 were mainly projected to MPP<sup><italic>PU.1</italic></sup> and T biased prog (C08). A large number of conserved markers between MPAL5 and normal cells could still be found but they differed from the conserved markers of other malignant samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11c).</p>
      <p id="Par30">As cluster-level analysis may miss intra-cluster heterogeneities, we calculated the cluster-specific signatures of cells based on the conserved markers detected above to investigate their lineage bias in single cell level (MPP<sup><italic>GATA1</italic></sup> signature of normal cells and MPAL4 shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>f; other signatures shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11d). The results also agreed with cluster-level analysis that normal and malignant cells grouped together according to their lineage bias, but the signal sometimes was much weaker in malignant cells (e.g. CLP signature in MPAL4, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11d). Additionally, a synchronized decrease of MPP<sup><italic>PU.1</italic></sup> signature and increase of MPP<sup><italic>GATA1</italic></sup> signature from MPP<sup><italic>PU.1</italic></sup> to MPP<sup><italic>GATA1</italic></sup> could be observed in both normal and malignant cells (MPAL1 and MPAL4, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11d), suggesting that epiConv corrected aligned the continuum of lineage bias transition between MPP<sup><italic>PU.1</italic></sup> and MPP<sup><italic>GATA1</italic></sup>.</p>
      <p id="Par31">Using the signatures calculated above, we next examined whether leukemic cells were also correctly projected to their normal counterparts by LSI + Seurat. Although some malignant cells in MPAL1, MPAL3 and MPAL4 were indeed with higher erythroid potential, LSI + Seurat did not project them to the corresponding normal cells (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f; cells with higher MPP<sup><italic>GATA1</italic></sup> signature were grouped together in epiConv but no in LSI + Seurat). In fact, no malignant cells were projected to MPP<sup><italic>GATA1</italic></sup> normal cells. These results suggested that epiConv better integrated normal and malignant cells according to their lineage bias than LSI + Seurat. We also examine the lineage priming of SCALE/SnapATAC + Seurat, which showed higher LISI metric than other methods and they also could not integrate normal and malignant cells together according to their lineage bias (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12).</p>
    </sec>
    <sec id="Sec9">
      <title>Computational efficiency of epiConv</title>
      <p id="Par32">We finally benchmarked the computational efficiency of epiConv on a human bone marrow and blood mononuclear cells dataset of 100k cells. We down-sampled the dataset to 10k, 20k, 50k and 100k cells and applied epiConv on them. EpiConv could run in parallel, achieved desirable results and was computationally efficient on large datasets (~4 h running time with 5 threads for dataset of 100 k cells, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). LSI and SnapATAC showed similar computational efficiency with epiConv. However, SnapATAC run out of memory on dataset of 100k cells (require more than 78 GiB memory). CisTopic and SCALE were less efficiency and required more than 24 hours for large dataset (cisTopic, ≥ 20 k cells; SCALE, ≥ 100 k cells).</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion</title>
    <p id="Par33">In this paper, we introduced a novel method named epiConv for joint analysis of scATAC-seq data and compared it with several clustering tools of scATAC-seq combined with batch correction tools designed for scRNA-seq. When applied to scATAC-seq data, these batch correction tools generally did not match their performance in scRNA-seq data. We found that batch effects and biological space were not always orthogonal to each other in scATAC-seq data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3a), which broke the assumption of existing batch correction tools [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] and caused over-fitting problem (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). Moreover, technical bias might be introduced by clustering tools of scATAC-seq data during the step of latent feature learning and was inherited by batch correction tools (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). To solve this problem, the potential batch effects between datasets should be considered in latent feature learning, but unfortunately such functionality is not available in state-of-art scATAC-Seq tools. Therefore, a one-stop working pipeline, such as epiConv, that performs clustering and batch correction simultaneously should handle the problem better in joint analysis of scATAC-seq data.</p>
    <p id="Par34">The other unique feature of epiConv is the inclusion of residuals after dimension reduction. We found that most of existing integration algorithms failed to align cells from the different conditions (tumor vs normal) together (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). We hypothesized that the discarded residuals might contain biological information. Therefore, we compared the results of epiConv under two strategies (with or without adding back residuals), we found that including the residuals of Eigenvalue decomposition significantly improved the results of batch correction (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9c,d). With this additional feature, we demonstrated that epiConv could also perform integration for datasets under different biological conditions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). These results suggested that the residuals of dimension reduction might contain useful information in recovering the biological relationships between cells and should not be ignored.</p>
    <p id="Par35">Although epiConv cannot integrate scRNA-seq and scATAC-seq data directly, it is a useful tool to recover the promoter-enhancer relationships by improving the resolution of low-depth scATAC-seq of co-assay data. The low-depth of scATAC-seq limited the detection sensitivity of cell type specific chromatin profiles, especially for the rare cell population. We demonstrated that integration of scATAC-seq data with co-assay data linked a large number of enhancers to their putative target genes that could not be inferred from the co-assay data alone, while most of other methods failed to do so (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b,d). Another alternative to infer promoter-enhancer relationships is to perform scATAC-Seq and scRNA-Seq separately from the same population and to integrate these two types of data by integration algorithm, such as Seurat [<xref ref-type="bibr" rid="CR17">17</xref>]. Most algorithms that directly integrate scRNA-seq and scATAC-seq data first transform the epigenomic data into a gene activity matrix by summing the ATAC-seq counts around genes’ TSS or across the gene body. However, recent study suggested that gene activity matrix performed poorly on clustering of scATAC-seq data [<xref ref-type="bibr" rid="CR10">10</xref>], while distal enhancers better characterized the cell identities [<xref ref-type="bibr" rid="CR25">25</xref>]. Thus, it remains unclear whether these methods can provide high-resolution integration, especially for closely-related cell types. On the contrary, integration of high-depth independent scATAC-seq data with scATAC-seq from co-assay data circumvents the difficulty in matching cells from two separate assays and significantly improves the resolution of cell-type specific chromatin marks (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f). We believe that such strategy will help resolve the landscape of enhancer-promoter interactions for rare or closely-related cell types when co-assay data is available.</p>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p id="Par36">In this paper, we developed an algorithm named epiConv to integrate multiple scATAC-seq datasets. We have demonstrated that epiConv can better remove batch effects and retain biological variations than existing methods under various situations. Moreover, joint analysis provides deeper insights into the epigenetic regulation of single cells of different developmental stages as well as disease conditions. We believe that the computational framework in this study along with technical improvements could facilitate better interpretation of the roles of chromatin accessibility in epigenetic regulation of cells in the future.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Peak calling and matrix counting</title>
      <p id="Par37">We used peaks defined in original article or called peaks from two ends of fragments by MACS2 [<xref ref-type="bibr" rid="CR26">26</xref>] (--nomodel --nolambda --keep-dup all --shift -95 --extsize 200) if processed peak file was unavailable. We counted the ends of fragments against peaks to obtain the count matrix. The count matrix was binarized. Cells with less than 1,000 accessible peaks were filtered out.</p>
    </sec>
    <sec id="Sec14">
      <title>Application and evaluation of other methods</title>
      <p id="Par38">We applied cisTopic [<xref ref-type="bibr" rid="CR11">11</xref>], Latent Sematic Indexing [<xref ref-type="bibr" rid="CR4">4</xref>] (LSI), SCALE [<xref ref-type="bibr" rid="CR15">15</xref>] and SnapATAC [<xref ref-type="bibr" rid="CR16">16</xref>] to scATAC-seq data and used Harmony [<xref ref-type="bibr" rid="CR12">12</xref>], MNN [<xref ref-type="bibr" rid="CR14">14</xref>] and Seurat [<xref ref-type="bibr" rid="CR17">17</xref>] to remove batch effects. In cisTopic, the number of meta features (topics) was set to 20, 30, 40 and 50 and automatically determined. In other methods, the number of meta features was set to 50. In LSI and SCALE, we filtered peaks that were accessible in less than 1% cells following the tutorial or default settings. SnapATAC was performed on ATAC-seq fragments following the tutorials.</p>
      <p id="Par39">We applied Harmony, MNN and Seurat on meta features calculated above to correct batch effects. We did not directly apply Harmony, MNN or Seurat on the raw matrix or gene activity matrix that summed the reads near each gene’s TSS as these simple methods generally did not perform well [<xref ref-type="bibr" rid="CR10">10</xref>]. MNN and Seurat require specification of reference batches. It was the same as epiConv and was reported below. Other unmentioned settings were all set to defaults.</p>
      <p id="Par40">We used local inverse Simpson’s Index (LISI) to quantitatively evaluate the mixing of cells from different batches by R package lisi [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    </sec>
    <sec id="Sec15">
      <title>Infer differentially accessible peaks and cluster-specific signatures</title>
      <p id="Par41">We used hypergeometric test to detect cluster-specific accessible peaks. Population size was defined as total number of cells. Sample size was defined as the total library size of cluster divided by the mean library size of all cells. No. of success in the population for each peak was defined as total number of cells with coverage. No. of success in the sample was defined as number of cells with coverage in this cluster. Only peaks that were accessible in at least 1% cells were tested. Peaks with one-tailed <italic>p </italic>value smaller than 0.01 were considered as differentially accessible peaks. If peaks were considered as differentially accessible peak in more than one cluster based on the statistical significance threshold, we assigned the peak to the cluster with the highest normalized counts. Cluster-specific signatures of single cells were calculated by the total number of accessible cluster-specific markers divided by the total number of accessible peaks.</p>
    </sec>
    <sec id="Sec16">
      <title>scATAC-seq data of PBMCs</title>
      <p id="Par42">Basic data processing was described as above. Cells from GSE123581 were used as reference. As the exact identities of T cells were unknown, we used a supervised approach to annotate T cells. We first grouped T cells into 4 clusters (Naïve CD4+ T cells, Naïve CD8+ T cells, memory CD4+ T cells and effector CD8+ T cells) by epiConv and performed differential analysis to obtain the cluster-specific markers. We aggregated the cluster-specific markers to calculate cluster-specific signatures for each single cell. Finally, we normalized signatures by <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{norm}= \frac{x-{x}_{0.01}}{{x}_{0.99}-{x}_{0.01}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">norm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0.01</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0.99</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0.01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4858_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>x</italic><sub>0.01</sub> and <italic>x</italic><sub>0<italic>.</italic>99</sub> is the 1% and 99% percentiles of the signature values across all cells, and annotated single cells by the highest normalized signature. Although epiConv was not guaranteed to be with the highest accuracy, the cluster-specific signatures should be weekly affected as far as it was with reasonable accuracy. We did not find strong contradictions between the annotations and the results of other methods. The identities of other cells (NK, monocytes and B cells) were obtained from original articles.</p>
      <p id="Par43">In over-fitting test, we used Adjusted Rand Index (ARI) to evaluate the consistency between clusters and annotated cell identities. As the resolution of Louvain clustering affected ARI, we performed Louvain clustering with resolution from 0.2 to 2.0 and reported the highest ARI for each method. To count the number of over-fitted cells, we classified single cells into T cells and non-T cells and calculated the LISI by this definition. Cells with LISI &gt; 1.1 (which meant that T cells were mixed with non-T cells) were counted as over-fitted.</p>
    </sec>
    <sec id="Sec17">
      <title>scATAC-seq data of mouse lung data</title>
      <p id="Par44">Basic data processing, differential analysis and calculation of cell-type specific signatures were performed as described above. Cells from Mouse Cell Atlas were used as reference. SHARE-seq (GSE140203) is a multi-omics protocol that generates RNA-seq and ATAC-seq profiles simultaneously. But only a small proportion of cells (~ 10%) from GSE140203 have RNA-seq profiles and the sequencing depth is shallow. We did not use the data from RNA-seq profiles.</p>
    </sec>
    <sec id="Sec18">
      <title>scATAC-seq data of adult mouse brain</title>
      <p id="Par45">We integrated co-assay data of mouse adult cerebral cortex from GSE126074 [<xref ref-type="bibr" rid="CR6">6</xref>] (SNARE-seq), scATAC-seq of adult mouse brain from Mouse Cell Atlas [<xref ref-type="bibr" rid="CR7">7</xref>] (sci-ATAC-seq) and GSE123581 [<xref ref-type="bibr" rid="CR5">5</xref>] (dscATAC-seq) together. For RNA-seq profiles of co-assay data, we used the pipeline of Seurat with default settings (find 2000 most variable genes and obtain 50 PCs from them) to perform dimension reduction, clustering and finding cluster-specific marker genes. In ATAC-seq analyses, we first aligned dscATAC-seq data to sci-ATAC-seq data and then aligned co-assay data to them. Given that the quality of RNA-seq is much better than ATAC-seq, we calculated the correction vector of non-anchor cells from anchor cells using the SNN graph from RNA-seq data instead. Dimension reduction and joint ATAC-seq clustering were performed on integrated dataset as described above. Joint ATAC-seq clusters that contained fewer than 10 co-assays cells were not included in downstream analysis.</p>
      <p id="Par46">We used Adjusted Rand Index (ARI) to evaluate the consistency between clusters from RNA-seq and ATAC-seq for epiConv and other methods. We performed Louvain clustering on other methods with resolution from 0.2 to 2.0 and reported the highest ARI for each method.</p>
      <p id="Par47">The cluster-specific markers shared by sci-ATAC-seq and dscATAC-seq were shown and used to infer the relationships between ATAC-seq and RNA-seq. We also performed differential analysis on excitatory neuron cells instead of all cells to better detect the cluster-specific markers of rare cell types (Ex 6 and Ex 7).</p>
    </sec>
    <sec id="Sec19">
      <title>scATAC-seq data of mouse CD4+ T cells</title>
      <p id="Par48">Basic data processing was described as above. Cells from normal condition were used as reference. We performed Louvain clustering on integrated datasets and manually annotated pTreg and tTreg clusters by the accessibility of four marker gene promoters (<italic>Foxp3, Klrg1, Rorc, Ikzf2</italic>) used in original article. Differentially accessible peaks calling between pTreg and tTreg of normal and germ-free mouse was performed as described above. Motif calling was performed by Homer [<xref ref-type="bibr" rid="CR27">27</xref>] on the ± 200 bp regions from peak centers. The length of motif was set to 8, 10 and 12. All ATAC-seq peaks were used as background.</p>
    </sec>
    <sec id="Sec20">
      <title>scATAC-seq data of leukemia</title>
      <p id="Par49">Basic data processing was described as above. Normal cells were used as reference. There were other two samples (MPAL2 and MPAL5 relapse) in Granja et al. [<xref ref-type="bibr" rid="CR23">23</xref>]. Although we could align them to normal hematopoiesis, they showed week correlations with normal hematopoiesis and could not be used for benchmarking. Thus, we did not show the results of them.</p>
    </sec>
    <sec id="Sec21">
      <title>scATAC-seq data of human bone marrow and blood mononuclear cells</title>
      <p id="Par50">We combined data from human bone marrow and blood mononuclear cells from GSE129785, GSE139369 and 10x Genomics demonstration data together. Data of GSE139369 was used as reference. We performed Louvain clustering on data after integration and manually annotated each cluster by cells with known identities from original article or analyses described above.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4858_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Figures S1 to S13, supplementary table and supplementary note.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Vinay Kartha and Xiaoqi Zheng for useful suggestions. We would like to thank Xiaojing Zhao for testing the reproducibility of the study. We would like to thank Yingdong Zhang on his technical support on the HPC platform of ShanghaiTech University.</p>
    <sec id="d32e1526">
      <title>Application of methods</title>
      <p id="Par51">All methods used in this article are performed in accordance with the relevant guidelines and regulations.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LL conceived the study, developed the methods and performed the analyses. LL and LZ wrote the manuscript. LZ supervised the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded by the National Key Research and Development Program of China (2018YFC1004602), National Natural Science Foundation of China (NSF 31871332) and a startup fund to L.Z. from ShanghaiTech University.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All data analyzed in this article are available in public databases and are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. EpiConv is available in Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/LiLin-biosoft/epiConv">https://github.com/LiLin-biosoft/epiConv</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par52">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par53">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par54">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Giresi</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Zaba</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1213</fpage>
        <lpage>1218</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2688</pub-id>
        <pub-id pub-id-type="pmid">24097267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klemm</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Shipony</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Chromatin accessibility and the regulatory epigenome</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>207</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0089-8</pub-id>
        <pub-id pub-id-type="pmid">30675018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Litzenburger</surname>
            <given-names>UM</given-names>
          </name>
          <name>
            <surname>Ruff</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gonzales</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>486</fpage>
        <lpage>490</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14590</pub-id>
        <pub-id pub-id-type="pmid">26083756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cusanovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gunderson</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiplex single cell profiling of chromatin accessibility by combinatorial cellular indexing</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>910</fpage>
        <lpage>914</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aab1601</pub-id>
        <pub-id pub-id-type="pmid">25953818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lareau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Chew</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kartha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Burkett</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Kohlway</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Pokholok</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lebofsky</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Droplet-based combinatorial indexing for massive-scale single-cell chromatin accessibility</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>916</fpage>
        <lpage>924</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0147-6</pub-id>
        <pub-id pub-id-type="pmid">31235917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>High-throughput sequencing of the transcriptome and chromatin accessibility in the same cell</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1452</fpage>
        <lpage>1457</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0290-0</pub-id>
        <pub-id pub-id-type="pmid">31611697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cusanovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Berletch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Filippova</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>DeWitt</surname>
            <given-names>WS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell atlas of in vivo mammalian chromatin accessibility</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <issue>1309–1324</issue>
        <fpage>e1318</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domcke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>O'Day</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Aldinger</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Pokholok</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Milbank</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human cell atlas of fetal chromatin accessibility</article-title>
        <source>Science</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1126/science.aba7612</pub-id>
        <?supplied-pmid 33184180?>
        <pub-id pub-id-type="pmid">33184180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orchard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kyono</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hensley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>SCJ</given-names>
          </name>
        </person-group>
        <article-title>Quantification, dynamic visualization, and validation of bias in ATAC-Seq data with ataqv</article-title>
        <source>Cell Syst</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>298–306</issue>
        <fpage>e294</fpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andreani</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vinyard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Andrade-Navarro</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Pinello</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1854-5</pub-id>
        <pub-id pub-id-type="pmid">31739806</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bravo Gonzalez-Blas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Minnoye</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Papasokrati</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aibar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hulselmans</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Christiaens</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Davie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wouters</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>cisTopic: cis-regulatory topic modeling on single-cell ATAC-seq data</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>397</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0367-1</pub-id>
        <pub-id pub-id-type="pmid">30962623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baglaenko</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>QC</given-names>
          </name>
        </person-group>
        <article-title>SCALE method for single-cell ATAC-seq analysis via latent feature extraction</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>4576</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-12630-7</pub-id>
        <pub-id pub-id-type="pmid">31594952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Preissl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lucero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Motamedi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shiau</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive analysis of single cell ATAC-seq data with SnapATAC</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1337</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21583-9</pub-id>
        <pub-id pub-id-type="pmid">33637727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
            <suffix>3rd</suffix>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>1888–1902</issue>
        <fpage>e1821</fpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">McInnes L, Healy J, Melville J. UMAP: uniform manifold approximation and projection for dimension reduction. 2020. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426v3">https://arxiv.org/abs/1802.03426v3</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satpathy</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Granja</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Yost</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Meschi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>925</fpage>
        <lpage>936</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0206-z</pub-id>
        <pub-id pub-id-type="pmid">31375813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>LaFave</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brack</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kartha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Tay</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin potential identified by shared single-cell profiling of RNA and chromatin</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <fpage>1103</fpage>
        <lpage>1116.e1120</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.09.056</pub-id>
        <pub-id pub-id-type="pmid">33098772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LaFave</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Kartha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meli</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Del Priore</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Naranjo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>PMK</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Sankar</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenomic state transitions characterize tumor progression in mouse lung adenocarcinoma</article-title>
        <source>Cancer Cell</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>212–228</issue>
        <fpage>e213</fpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sanderink</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hotz-Wagenblatt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wuttke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schambeck</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schmidleithner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pant</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ritter</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility landscape identifies tissue repair program in human regulatory T cells</article-title>
        <source>Immunity</source>
        <year>2021</year>
        <volume>54</volume>
        <issue>702–720</issue>
        <fpage>e717</fpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granja</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Klemm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McGinnis</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Kathiria</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Mezger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gars</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liedtke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell multiomic analysis identifies regulatory programs in mixed-phenotype acute leukemia</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1458</fpage>
        <lpage>1465</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0332-7</pub-id>
        <pub-id pub-id-type="pmid">31792411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corces</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Greenside</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Koenig</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>1193</fpage>
        <lpage>1203</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3646</pub-id>
        <pub-id pub-id-type="pmid">27526324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Safi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dhapola</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warsi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sommarin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Erlandsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ungerback</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Warfvinge</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sitnicka</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bryder</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Boiers</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Concurrent stem- and lineage-affiliated chromatin programs precede hematopoietic lineage restriction</article-title>
        <source>Cell Rep</source>
        <year>2022</year>
        <volume>39</volume>
        <fpage>110798</fpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2022.110798</pub-id>
        <pub-id pub-id-type="pmid">35545037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Laslo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Murre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
