<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5596896</article-id>
    <article-id pub-id-type="publisher-id">1305</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-017-1305-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7744-8565</contrib-id>
        <name>
          <surname>Zappia</surname>
          <given-names>Luke</given-names>
        </name>
        <address>
          <email>luke.zappia@mcri.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1711-7454</contrib-id>
        <name>
          <surname>Phipson</surname>
          <given-names>Belinda</given-names>
        </name>
        <address>
          <email>belinda.phipson@mcri.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9788-5690</contrib-id>
        <name>
          <surname>Oshlack</surname>
          <given-names>Alicia</given-names>
        </name>
        <address>
          <email>alicia.oshlack@mcri.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Murdoch Childrens Research Institute, Royal Children’s Hospital, 50 Flemington Rd, Parkville, VIC 3052 Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>School of Biosciences, The University of Melbourne, </institution></institution-wrap>Parkville, VIC 3010 Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>174</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">As single-cell RNA sequencing (scRNA-seq) technologies have rapidly developed, so have analysis methods. Many methods have been tested, developed, and validated using simulated datasets. Unfortunately, current simulations are often poorly documented, their similarity to real data is not demonstrated, or reproducible code is not available. Here, we present the Splatter Bioconductor package for simple, reproducible, and well-documented simulation of scRNA-seq data. Splatter provides an interface to multiple simulation methods including Splat, our own simulation, based on a gamma-Poisson distribution. Splat can simulate single populations of cells, populations with multiple cell types, or differentiation paths.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-017-1305-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>Simulation</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">The first decade of next-generation sequencing has seen an explosion in our understanding of the genome [<xref ref-type="bibr" rid="CR1">1</xref>]. In particular, the development of RNA sequencing (RNA-seq) has enabled unprecedented insight into the dynamics of gene expression [<xref ref-type="bibr" rid="CR2">2</xref>]. Researchers now routinely conduct experiments designed to test how gene expression is affected by various stimuli. One limitation of bulk RNA-seq experiments is that they measure the average expression level of genes across the many cells in a sample. However, recent technological developments have enabled the extraction and amplification of minute quantities of RNA, allowing sequencing to be conducted on the level of single cells [<xref ref-type="bibr" rid="CR3">3</xref>]. The increased resolution of single-cell RNA-seq (scRNA-seq) data has made a range of new analyses possible.</p>
    <p id="Par3">As scRNA-seq data have become available there has been a rapid development of new bioinformatics tools attempting to unlock its potential. Currently there are at least 120 software packages that have been designed specifically for the analysis of scRNA-seq data, the majority of which have been published in peer-reviewed journals or as preprints [<xref ref-type="bibr" rid="CR4">4</xref>]. The focus of these tools is often different from those designed for the analysis of a bulk RNA-seq experiment. In a bulk experiment, the groups of samples are known and a common task is to test for genes that are differentially expressed (DE) between two or more groups. In contrast, the groups in a single-cell experiment are usually unknown and the analysis is often more exploratory.</p>
    <p id="Par4">Much of the existing software focuses on assigning cells to groups based on their expression profiles (clustering) before applying more traditional DE testing. This approach is taken by tools such as SC3 [<xref ref-type="bibr" rid="CR5">5</xref>], CIDR [<xref ref-type="bibr" rid="CR6">6</xref>], and Seurat [<xref ref-type="bibr" rid="CR7">7</xref>] and is appropriate for a sample of mature cells where it is reasonable to expect cells to have a particular type. In a developmental setting, for example, where stem cells are differentiating into mature cells, it may be more appropriate to order cells along a continuous trajectory from one cell type to another. Tools such as Monocle [<xref ref-type="bibr" rid="CR8">8</xref>], CellTree [<xref ref-type="bibr" rid="CR9">9</xref>], and Sincell [<xref ref-type="bibr" rid="CR10">10</xref>] take this approach, ordering cells along a path, then identifying patterns in the changes of gene expression along that path.</p>
    <p id="Par5">Another defining characteristic of scRNA-seq data is its sparsity; typically expression is only observed for relatively few genes in each cell. The observed zero counts have both biological (different cell types express different genes) and technical (an expressed RNA molecule might not be captured) causes, with technical zeros often referred to as “dropout”. Some analysis methods (ZIFA [<xref ref-type="bibr" rid="CR11">11</xref>], MAST [<xref ref-type="bibr" rid="CR12">12</xref>], ZINB-WaVE [<xref ref-type="bibr" rid="CR13">13</xref>]) incorporate dropout into their models while others (MAGIC [<xref ref-type="bibr" rid="CR14">14</xref>], SAVER [<xref ref-type="bibr" rid="CR15">15</xref>], scImpute [<xref ref-type="bibr" rid="CR16">16</xref>]) attempt to infer what the true expression levels should be.</p>
    <p id="Par6">Existing scRNA-seq analysis packages, and any new methods that are being developed, should demonstrate two properties: first that they can do what they claim to do, whether that is clustering, lineage tracing, differential expression testing or improved performance compared to other methods; and second that they produce some meaningful biological insight. The second criterion is specific to particular studies but it should be possible to address the first point in a more general way.</p>
    <p id="Par7">A common way to test the performance of an analysis method is through a simulation. Simulated data provide a known truth to test against, making it possible to assess whether a method has been implemented correctly, whether the assumptions of the method are appropriate, and demonstrating the method’s limitations. Such tests are often difficult with real biological data, as an experiment must be specifically designed, or results from an appropriate orthogonal test taken as the truth. Simulations, however, easily allow access to a range of metrics for assessing the performance of an analysis method. An additional advantage of evaluating methods using simulated data is that many datasets, with different parameters and assumptions, can be rapidly generated at minimal cost. As such, many of the scRNA-seq analysis packages that are currently available have used simulations to demonstrate their effectiveness. These simulations, however, are often not described in a reproducible or reusable way and the code to construct them may not be readily available. When code is available it may be poorly documented or written specifically for the computing environment used by the authors, limiting its reproducibility and making it difficult for other researchers to reuse. Most importantly, publications do not usually provide sufficient detail demonstrating that a simulation is similar to real datasets, or in what ways it differs.</p>
    <p id="Par8">In this paper we present Splatter, an R Bioconductor package for reproducible and accurate simulation of single-cell RNA sequencing data. Splatter is a framework designed to provide a consistent interface to multiple published simulations, enabling researchers to quickly simulate scRNA-seq count data in a reproducible fashion and make comparisons between simulations and real data. Along with the framework we have developed our own simulation model, Splat, and show how it compares to previously published simulations based on real datasets. We also provide a short example of how simulations can be used for assessing analysis methods.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The Splatter framework</title>
      <p id="Par9">Currently, Splatter implements six different simulation models, each with their own assumptions but accessed through a consistent, easy-to-use interface. These simulations are described in more detail in the following sections and in the documentation for each simulation in Splatter, which also describes the required input parameters.</p>
      <p id="Par10">The Splatter simulation process consists of two steps. The first step estimates the parameters required for the simulation from a real dataset. The result of the first step is a parameters object unique to each simulation model. These objects have been designed to hold the information required for the specific simulation and display details such as which parameters can be estimated and which have been changed from the default value. It is important that each simulation has its own object for storing parameters as different simulations can vary greatly in the information they require. For example, some simulations only need parameters for well-known statistical distributions while others require large vectors or matrices of data sampled from real datasets.</p>
      <p id="Par11">In the second step, Splatter uses the estimated parameters, along with any additional parameters that cannot be estimated or are overridden by the user, to generate a synthetic scRNA-seq dataset. If there is no relevant real data to estimate parameters from, a synthetic dataset can still be generated using default parameters that can be manually modified by the user. Additional parameters that may be required depend on the simulation; these could include parameters indicating whether to use a zero-inflated model or the number of genes and cells to simulate. The main result of the simulation step is a matrix of counts, which is returned as an SCESet object as defined by the scater package. Scater is a low-level analysis package that provides various functions for quality control, visualization, and preprocessing of scRNA-seq data [<xref ref-type="bibr" rid="CR17">17</xref>]. Briefly, the structure of the SCESet combines cell by feature (gene) matrices for storing expression values along with tables for storing metadata about cells and features (further details are described in the scater documentation and the accompanying paper). This is a convenient format for returning intermediate values created during simulation as well as the final expression matrix. For example, the underlying gene expression means in different groups of cells are returned and could be used as a truth when evaluating differential expression testing. Using an SCESet also provides easy access to scater’s functionality.</p>
      <p id="Par12">Splatter is also able to compare SCESet objects. These may contain simulations with different models or different parameters, or real datasets from which parameters have been estimated. The comparison function takes one or more SCESet objects, combines them (keeping any cell or gene-level information that is present in all of them) and produces a series of diagnostic plots comparing aspects of scRNA-seq data. The combined datasets are also returned, making it easy to produce additional comparison plots or statistics. Alternatively, one SCESet can be designated as a reference, such as the real data used to estimate parameters, and the difference between the reference and the other datasets can be assessed. This approach is particularly useful for comparing how well simulations recapitulate real datasets. Examples of these comparison plots are shown in the following sections.</p>
    </sec>
    <sec id="Sec4">
      <title>Simulation models</title>
      <p id="Par13">Splatter provides implementations of our own simulation model, Splat, as well as several previously published simulations. The previous simulations have either been published as R code associated with a paper or as functions in existing packages. By including them in Splatter, we have made them available in a single place in a more accessible way. If only a script was originally published, such as the Lun [<xref ref-type="bibr" rid="CR18">18</xref>] and Lun 2 [<xref ref-type="bibr" rid="CR19">19</xref>] simulations, the simulations have been re-implemented in Splatter. If the simulation is available in an existing R package, for example, scDD [<xref ref-type="bibr" rid="CR20">20</xref>] and BASiCS [<xref ref-type="bibr" rid="CR21">21</xref>], we have simply written wrappers that provide consistent input and output but use the package implementation. We have endeavored to keep the simulations and estimation procedures as close as possible to what was originally published while providing a consistent interface within Splatter. The six different simulations currently available in Splatter are described below.</p>
    </sec>
    <sec id="Sec5">
      <title>Simple</title>
      <p id="Par14">The negative binomial is the most common distribution used to model RNA-seq count data, as in the edgeR [<xref ref-type="bibr" rid="CR22">22</xref>] and DESeq [<xref ref-type="bibr" rid="CR23">23</xref>] packages. The Simple simulation is a basic implementation of this approach. A mean expression level for each gene is simulated using a gamma distribution and the negative binomial distribution is used to generate a count for each cell based on these means, with a fixed dispersion parameter (default = 0.1; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). This simulation is primarily included as a baseline reference and is not intended to accurately reproduce many of the features of scRNA-seq data.</p>
    </sec>
    <sec id="Sec6">
      <title>Lun</title>
      <p id="Par15">Published in “Pooling across cells to normalize single-cell RNA sequencing data with many zero counts” [<xref ref-type="bibr" rid="CR18">18</xref>], the Lun simulation builds on the Simple simulation by adding a scaling factor for each cell (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The cell factors are randomly sampled from a normal distribution with mean 1 and variance 0.5. The inverse- <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {log}_2 $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi mathvariant="italic">log</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq1.gif"/></alternatives></inline-formula> transformed factors are used to adjust the gene means, resulting in a matrix in which each cell has a different mean. This represents the kinds of technical effects that scaling normalization aims to remove. The matrix of means is then used to sample counts from a negative binomial distribution, with a fixed dispersion parameter. This simulation can also model differential expression between multiple groups with fixed fold changes.</p>
    </sec>
    <sec id="Sec7">
      <title>Lun 2</title>
      <p id="Par16">In “Overcoming confounding plate effects in differential expression analyses of single-cell RNA-seq data” [<xref ref-type="bibr" rid="CR19">19</xref>] Lun and Marioni extended the negative binomial model from the Lun simulation. This simulation samples input parameters from real data, with very little random sampling from statistical distributions. In the Lun 2 simulation the cell factors are replaced with a library size factor and an additional level of variation is added by including a batch effects factor. While the library size factor acts on individual cells the batch effects are applied to groups of cells from the same batch. This simulation is thus highly specific to the scenario when there are known batch effects present in the data, for example, Fluidigm C1 plate effects. Differential expression can be added between two sets of batches and the user can choose to use a zero-inflated negative binomial (ZINB) model. Counts are simulated from a negative binomial using the library size and plate factor adjusted gene means and gene-wise dispersion estimates obtained from the real data. If the ZINB model is chosen, zero inflated estimates of gene means and dispersions are used instead. An additional step then randomly sets some counts to zero, based on the gene-wise proportions of zeros observed in the data. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 shows the model assumptions and parameters for this simulation.</p>
    </sec>
    <sec id="Sec8">
      <title>scDD</title>
      <p id="Par17">The scDD package aims to test for differential expression between two groups of cells but also more complex changes such as differential distributions or differential proportions [<xref ref-type="bibr" rid="CR20">20</xref>]. This is reflected in the scDD simulation, which can contain a mixture of genes simulated to have different distributions, or differing proportions where the expression of the gene is multi-modal. This simulation also samples information from a real dataset. As the scDD simulation is designed to reproduce a high quality, filtered dataset, it only samples from genes with less than 75% zeros. As a result, it only simulates relatively highly expressed genes. The Splatter package simply provides wrapper functions to the simulation function in the scDD package, while capturing the necessary inputs and outputs needed to compare to other simulations. The full details of the scDD simulation are described in the scDD package vignette [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
    </sec>
    <sec id="Sec9">
      <title>BASiCS</title>
      <p id="Par18">The BASiCS package introduced a model for separating variation in scRNA-seq data into biological and technical components based on the expression of external spike-in controls [<xref ref-type="bibr" rid="CR21">21</xref>]. This model also enables cell-specific normalization and was extended to detect differential expression between groups of cells [<xref ref-type="bibr" rid="CR25">25</xref>]. Similar to the scDD simulation, Splatter provides a wrapper for the BASiCS simulation function, which is able to produce datasets with both endogenous and spike-in genes as well as multiple batches of cells. As the BASiCS simulation contains both biological and technical variation, it can be used to test the ability of methods to distinguish between the two.</p>
    </sec>
    <sec id="Sec10">
      <title>Splat</title>
      <p id="Par19">We have developed the Splat simulation to capture many features observed in real scRNA-Seq data, including high expression outlier genes, differing sequencing depths (library sizes) between cells, trended gene-wise dispersion, and zero-inflation. Our model uses parametric distributions with hyper-parameters estimated from real data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The core of the Splat simulation is the gamma-Poisson hierarchical model where the mean expression level for each gene <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i $$\end{document}</tex-math><mml:math id="M4"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i=1,\dots, N $$\end{document}</tex-math><mml:math id="M6"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq3.gif"/></alternatives></inline-formula>, is simulated from a gamma distribution and the count for each cell <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ j $$\end{document}</tex-math><mml:math id="M8"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ j=1,\dots, M $$\end{document}</tex-math><mml:math id="M10"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq5.gif"/></alternatives></inline-formula>, is subsequently sampled from a Poisson distribution, with modifications to include expression outliers and to enforce a mean-variance trend.<fig id="Fig1"><label>Fig. 1</label><caption><p>The Splat simulation model. Input parameters are indicated with <italic>double borders</italic> and those that can be estimated from real data are shaded <italic>blue. Red shading</italic> indicates the final output. The simulation begins by generating means from a gamma distribution. Outlier expression genes are added by multiplying by a log-normal factor and the means are proportionally adjusted for each cell’s library size. Adjusting the means using a simulated Biological Coefficient of Variation (<italic>BCV</italic>) enforces a mean-variance trend. These final means are used to generate counts from a Poisson distribution. In the final step dropout is (optionally) simulated by randomly setting some counts to zero, based on each gene’s mean expression. <italic>DoF</italic> degrees of freedom</p></caption><graphic xlink:href="13059_2017_1305_Fig1_HTML" id="MO1"/></fig>
</p>
      <p id="Par20">More specifically, the Splat simulation initially samples gene means from a Gamma distribution with shape <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha $$\end{document}</tex-math><mml:math id="M12"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq6.gif"/></alternatives></inline-formula> and rate <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \beta $$\end{document}</tex-math><mml:math id="M14"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq7.gif"/></alternatives></inline-formula>. While the gamma distribution is a good fit for gene means it does not always capture extreme expression levels. To counter this a probability (<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\pi}^O $$\end{document}</tex-math><mml:math id="M16"><mml:msup><mml:mi>π</mml:mi><mml:mi>O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq8.gif"/></alternatives></inline-formula>) that a gene is a high expression outlier can be specified. We then add these outliers to the simulation by replacing the previously simulated mean with the median of the simulated gene means multiplied by an inflation factor. The inflation factor is sampled from a log-normal distribution with location <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}^O $$\end{document}</tex-math><mml:math id="M18"><mml:msup><mml:mi>μ</mml:mi><mml:mi>O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq9.gif"/></alternatives></inline-formula> and scale <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}^O $$\end{document}</tex-math><mml:math id="M20"><mml:msup><mml:mi>σ</mml:mi><mml:mi>O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq10.gif"/></alternatives></inline-formula>.</p>
      <p id="Par21">The library size (total number of counts) varies within an scRNA-seq experiment and can be very different between experiments depending on the sequencing depth. We model library size using a log-normal distribution (with location <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}^L $$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq11.gif"/></alternatives></inline-formula> and scale <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}^L $$\end{document}</tex-math><mml:math id="M24"><mml:msup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq12.gif"/></alternatives></inline-formula>) and use the simulated library sizes (<inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_j $$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq13.gif"/></alternatives></inline-formula>) to proportionally adjust the gene means for each cell. This allows us to alter the number of counts per cell independently of the underlying gene expression levels.</p>
      <p id="Par22">It is known that there is a strong mean-variance trend in RNA-Seq data, where lowly expressed genes are more variable and highly expressed genes are more consistent [<xref ref-type="bibr" rid="CR26">26</xref>]. In the Splat simulation we enforce this trend by simulating the biological coefficient of variation (BCV) for each gene from a scaled inverse chi-squared distribution, where the scaling factor is a function of the gene mean. After simulating the BCV values we generate a new set of means (<inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\lambda}_{i,j} $$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq14.gif"/></alternatives></inline-formula>) from a gamma distribution with shape and rate parameters dependent on the simulated BCVs and previous gene means. We then generate a matrix of counts by sampling from a Poisson distribution, with lambda equal to <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\lambda}_{i,j} $$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq15.gif"/></alternatives></inline-formula>. This process is similar to the simulation of bulk RNA-seq data used by Law et al. [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
      <p id="Par23">The high proportion of zeros is another key feature of scRNA-seq data [<xref ref-type="bibr" rid="CR11">11</xref>], one cause of which is technical dropout. We use the relationship between the mean expression of a gene and the proportion of zero counts in that gene to model this process and use a logistic function to produce a probability that a count should be zero. The logistic function is defined by a midpoint parameter (<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_0 $$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq16.gif"/></alternatives></inline-formula>), the expression level at which 50% of cells are zero, and a shape parameter (<inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k $$\end{document}</tex-math><mml:math id="M34"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq17.gif"/></alternatives></inline-formula>) that controls how quickly the probabilities change from that point. The probability of a zero for each gene is then used to randomly replace some of the simulated counts with zeros using a Bernoulli distribution.</p>
      <p id="Par24">Each of the different steps in the Splat simulation outlined above are easily controlled by setting the appropriate parameters and can be turned off when they are not desirable or appropriate. The final result is a matrix of observed counts <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_{i,j} $$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq18.gif"/></alternatives></inline-formula> where the rows are genes and the columns are cells. The full set of input parameters is shown in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Input parameters for the Splat simulation model</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Symbol</th><th>Description</th></tr></thead><tbody><tr><td>Mean shape</td><td><inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \upalpha $$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="normal">α</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq19.gif"/></alternatives></inline-formula></td><td>Shape parameter for the mean gene expression gamma distribution</td></tr><tr><td>Mean rate</td><td><inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \upbeta $$\end{document}</tex-math><mml:math id="M40"><mml:mi mathvariant="normal">β</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq20.gif"/></alternatives></inline-formula></td><td>Rate parameter for the mean gene expression gamma distribution</td></tr><tr><td>Library size location</td><td><inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\upmu}^{\mathrm{L}} $$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq21.gif"/></alternatives></inline-formula></td><td>Location parameter for the library size log-normal distribution</td></tr><tr><td>Library size scale</td><td><inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\upsigma}^{\mathrm{L}} $$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq22.gif"/></alternatives></inline-formula></td><td>Scale parameter for the library size log-normal distribution</td></tr><tr><td>Outlier probability</td><td><inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\uppi}^{\mathrm{O}} $$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mi mathvariant="normal">π</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq23.gif"/></alternatives></inline-formula></td><td>Probability that a gene is an expression outlier</td></tr><tr><td>Outlier location</td><td><inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\upmu}^{\mathrm{O}} $$\end{document}</tex-math><mml:math id="M48"><mml:msup><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq24.gif"/></alternatives></inline-formula></td><td>Location parameter for the expression outlier factor log-normal distribution</td></tr><tr><td>Outlier scale</td><td><inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\upsigma}^{\mathrm{O}} $$\end{document}</tex-math><mml:math id="M50"><mml:msup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq25.gif"/></alternatives></inline-formula></td><td>Scale parameter for the expression outlier factor log-normal distribution</td></tr><tr><td>Common BCV</td><td><inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \upphi $$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq26.gif"/></alternatives></inline-formula></td><td>Common BCV dispersion across all genes</td></tr><tr><td>BCV degrees of freedom</td><td><inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{df} $$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq27.gif"/></alternatives></inline-formula></td><td>Degrees of freedom for the BCV inverse chi-squared distribution</td></tr><tr><td>Dropout midpoint</td><td><inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{x}}_0 $$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq28.gif"/></alternatives></inline-formula></td><td>Midpoint for the dropout logistic function</td></tr><tr><td>Dropout shape</td><td><inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{k} $$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="normal">k</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq29.gif"/></alternatives></inline-formula></td><td>Shape of the dropout logistic function</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec11">
      <title>Comparison of simulations</title>
      <p id="Par25">To compare the simulation models available in Splatter we estimated parameters from several real datasets and then generated synthetic datasets using those parameters. Both the standard and zero-inflated versions of the Splat and Lun 2 simulations were included, giving a total of eight simulations. We began with the Tung dataset which contains induced pluripotent stem cells from three HapMap individuals [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p id="Par26">To reduce the computational time we randomly sampled 200 cells to use for the estimation step and each simulation consisted of 200 cells. Benchmarking showed a roughly linear relationship between the number of genes or cells and the processing time required (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4 and S5). The estimation procedures for the Lun 2 and BASiCS simulations are particularly time consuming; however, the Lun 2 estimation can be run using multiple cores unlike the BASiCS estimation procedure. We did not perform any quality control of cells and only removed genes that were zero in all of the selected cells. We believe this presents the most challenging situation to simulate, as there are more likely to be violations of the underlying model. This scenario is also possibly the most useful as it allows any analysis method to be evaluated, from low-level filtering to complex downstream analysis. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows some of the plots produced by Splatter to compare simulations based on the Tung dataset.<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of simulations based on the Tung dataset. The left column panels show the distribution of mean expression (<bold>a</bold>), variance (<bold>c</bold>) and library size (<bold>g</bold>) across the real dataset and the simulations as boxplots, along with a scatter plot of the mean–variance relationship (<bold>e</bold>). The right column shows boxplots of the ranked differences between the real data and simulations for the same statistics: mean (<bold>b</bold>), variance (<bold>d</bold>), mean–variance relationship (<bold>f</bold>), and library size (<bold>h</bold>). Note that the <italic>y-axis</italic> for plots of the variance has been limited in order to show more detail. Variances for the Lun and Lun 2 simulations extend beyond what has been shown</p></caption><graphic xlink:href="13059_2017_1305_Fig2_HTML" id="MO2"/></fig>
</p>
      <p id="Par27">We compared the gene means, variances, library sizes, and the mean–variance relationship. From these diagnostic plots, we can evaluate how well each simulation reproduces the real dataset and how it differs. One way to compare across the simulations is to look at the overall distributions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, left column). Alternatively, we can choose a reference (in this case the real data) and look at departures from that data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, right column). Examining the mean expression levels across genes, we see that the scDD simulation is missing lowly expressed genes, as expected, as is the Lun simulation. In contrast, the Simple and Lun 2 simulations are skewed towards lower expression levels (Fig. <xref rid="Fig2" ref-type="fig">2a, b</xref>). The BASiCS simulation is a good match to the real data as is the Splat simulation. Both versions of the Lun 2 simulation produce some extremely highly variable genes, an effect which is also seen to a lesser extent in the Lun simulation. The difference in variance is reflected in the mean–variance relationship where genes from the Lun 2 simulation are much too variable at high expression levels for this dataset. Library size is another aspect in which the simulations differ from the real data. The simulations that do not contain a library size component (Simple, Lun, scDD) have different median library sizes and much smaller spreads. In this example, the BASiCS simulation produces too many large library sizes, as does the Lun 2 simulation to a lesser degree.</p>
      <p id="Par28">A key aspect of scRNA-seq data is the number of observed zeros. To properly recreate an scRNA-seq dataset a simulation must produce the correct number of zeros but also have them appropriately distributed across both genes and cells. In addition, there is a clear relationship between the expression level of a gene and the number of observed zeros [<xref ref-type="bibr" rid="CR29">29</xref>] and this should be reproduced in simulations. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the distribution of zeros for the simulations based on the Tung dataset.<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of zeros in simulations based on the Tung dataset. The <italic>top row</italic> shows boxplots of the distribution of zeros per cell (<bold>a</bold>) and the difference from the real data (<bold>b</bold>). The distribution (<bold>c</bold>) and difference (<bold>d</bold>) in zeros per gene are shown in the <italic>middle row</italic>. The <italic>bottom row</italic> shows scatter plots of the relationship between the mean expression of a gene (including cells with zero counts) and the percentage of zeros as both the raw observations (<bold>e</bold>) and ranked differences from the real data (<bold>f</bold>)</p></caption><graphic xlink:href="13059_2017_1305_Fig3_HTML" id="MO3"/></fig>
</p>
      <p id="Par29">For this dataset the Simple and Lun 2 simulations produce too many zeros across both genes and cells while the Lun and scDD simulations produce too few. Interestingly, the Splat simulation produces a better fit to this dataset when dropout is not included, suggesting that additional dropout is not present in the Tung dataset. However, this is not the case for all data and sometimes simulating additional dropout produces a better fit to the data (for example, the Camp dataset presented below). We can also consider the relationship between the expression level of a gene, calculated including cells with zero counts, and the percentage of zero counts in that gene. The Lun and scDD simulations produce too few zeros at low expression levels, while the Simple and Lun 2 simulations produce too many zeros at high expression levels. It is important to note that as the scDD simulation removes genes with more than 75% zeros prior to simulation this model can never produce genes with high numbers of zeros as shown in Fig. <xref rid="Fig3" ref-type="fig">3c</xref>. Both the Splat and BASiCS models are successful at distributing zeros across genes and cells as well as maintaining the mean–zeros relationship.</p>
      <p id="Par30">Although the analysis presented in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref> allows us to visually inspect how simulations compare with a single dataset, we also wished to compare simulations across a variety of datasets. To address this we performed simulations based on five different datasets (outlined in Table <xref rid="Tab2" ref-type="table">2</xref>) that varied in terms of library preparation protocol, cell capture platform, species, and tissue complexity. Three of the datasets used Unique Molecular Identifiers (UMIs) [<xref ref-type="bibr" rid="CR30">30</xref>] and two used full-length protocols. Complete comparison panels for all the datasets are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S5–S10 and processing times for all datasets are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Details of real datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Species</th><th>Cell type</th><th>Platform</th><th>Protocol</th><th>UMI</th><th>Number of cells</th></tr></thead><tbody><tr><td>Camp [<xref ref-type="bibr" rid="CR44">44</xref>]</td><td>Human</td><td>Whole brain organoids</td><td>Fluidigm C1</td><td>SMARTer</td><td>No</td><td>597</td></tr><tr><td>Engel [<xref ref-type="bibr" rid="CR45">45</xref>]</td><td>Mouse</td><td>Natural killer T cells</td><td>Flow cytometry</td><td>Modified Smart-seq2</td><td>No</td><td>203</td></tr><tr><td>Klein [<xref ref-type="bibr" rid="CR46">46</xref>]</td><td>Human</td><td>K562 cells</td><td>InDrop</td><td>CEL-Seq</td><td>Yes</td><td>213</td></tr><tr><td>Tung [<xref ref-type="bibr" rid="CR28">28</xref>]</td><td>Human</td><td>Induced pluripotent stem cells</td><td>Fluidigm C1</td><td>Modified SMARTer</td><td>Yes</td><td>564</td></tr><tr><td>Zeisel [<xref ref-type="bibr" rid="CR47">47</xref>]</td><td>Mouse</td><td>Cortex and hippocampus cells</td><td>Fluidigm C1</td><td>STRT-Seq</td><td>Yes</td><td>3005</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par31">For each dataset, we estimated parameters and produced a synthetic dataset as described previously. We then compared simulations across metrics and datasets by calculating a median absolute deviation (MAD) for each metric. For example, to get a MAD for the gene expression means, the mean expression values for both the real data and the simulations were sorted and the real values were subtracted from the simulated values. The median of these absolute differences was taken as the final statistic. To compare between simulations, we ranked the MADs for each metric with a rank of one being most similar to the real data. Figure <xref rid="Fig4" ref-type="fig">4</xref> summarizes the ranked results for the five datasets as a heatmap. A heatmap of the MADs is presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12 and the values themselves in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of simulation models based on various datasets. For each dataset parameters were estimated and synthetic datasets generated using various simulation methods. The median absolute deviation (<italic>MAD</italic>) between each simulation and the real data was calculated for a range of metrics and the simulations ranked. A heatmap of the ranks across the metrics and datasets is presented here. We see that the Splat simulation (with and without dropout) performs consistently well, with the BASiCS simulation and the two versions of the Lun 2 simulation also performing well</p></caption><graphic xlink:href="13059_2017_1305_Fig4_HTML" id="MO4"/></fig>
</p>
      <p id="Par32">Looking across the metrics and datasets we see that the Splat simulations are consistently highly ranked. In general, it seems that the datasets are not zero-inflated and thus the zero-inflated simulations do not perform as well as their regular counterparts. The Splat simulations were least successful on the Camp cerebral organoid and Engel T-cell datasets. The complex nature of the Camp data (many cell types) and the full-length protocols used by both may have contributed to Splat’s poorer performance. In this situation the semi-parametric, sampling-based models may have an advantage and the Lun 2 simulation was the best performer on most aspects of the Camp data. Interestingly, the Simple simulation was the best performer on the Engel dataset. This result suggests that the additional features of the more complex simulations may be unnecessary in this case or that other models may be more appropriate. The Lun simulation is consistently among the worst performing. However, given that this model is largely similar to the others, it is likely due to the lack of an estimation procedure for most parameters rather than significant problems with the model itself. The scDD simulation also often differed significantly from the real data, which is unsurprising as this simulation is designed to produce a filtered dataset, not the raw datasets used here. A comparison based on a filtered version of the Tung dataset, showing scDD to be a better match, is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13.</p>
      <p id="Par33">Most importantly we see that simulations perform differently on different datasets. This emphasizes the importance of evaluating different models and demonstrating their similarity to real datasets. Other comparisons may also be of interest for evaluation, such as testing each simulated gene to see if it matches known distributions, an example of which is shown in Additional file: 1 Figure S14. The Splatter framework makes these comparisons between simulation models straightforward, making it easier for researchers to choose simulations that best reflect the data they are trying to model.</p>
    </sec>
    <sec id="Sec12">
      <title>Complex simulations with Splat</title>
      <p id="Par34">The simulation models described above are sufficient for simulating a single, homogeneous population but not to reproduce the more complex situations seen in some real biological samples. For example, we might wish to simulate a population of cells from a complex tissue containing multiple mature cell types or a developmental scenario where cells are transitioning between cell types. In this section, we present how the Splat simulation can be extended to reproduce these complex sample types (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Examples of complex Splat simulations. <bold>a</bold> A principle components analysis (PCA) plot of a simulation with six groups with varying numbers of cells and levels of differential expression. <bold>b</bold> A PCA plot of a simulation with two groups (<italic>pink</italic> and <italic>blue</italic>) and two batches (<italic>circle</italic> and <italic>triangle</italic>). <italic>PC1</italic> separates groups (wanted biological variation) while <italic>PC2</italic> separates batches (unwanted technical variation). <bold>c</bold> A PCA plot of a simulation with differentiation paths; the colored gradient indicates how far along a path each cell is from <italic>blue</italic> to <italic>pink</italic>. A progenitor cell type (<italic>blue circles</italic>) differentiates into an intermediate cell type (<italic>pink circles</italic>/<italic>blue triangles</italic> or <italic>diamonds</italic>), which becomes one of two (<italic>pink triangle</italic> or <italic>diamond</italic>) mature cell types</p></caption><graphic xlink:href="13059_2017_1305_Fig5_HTML" id="MO5"/></fig>
</p>
    </sec>
    <sec id="Sec13">
      <title>Simulating groups</title>
      <p id="Par35">Splat can model samples with multiple cell types by creating distinct groups of cells where several genes are differentially expressed between the different groups. Previously published simulations can reproduce this situation to some degree but are often limited to fixed fold changes between only two groups. In the Splat simulation, however, differential expression is modeled using a process similar to that for creating expression outliers and can be used to simulate complex cell mixtures. Specifically a multiplicative differential expression factor is assigned to each gene and applied to the underlying mean. For DE genes, these factors are generated from a log-normal distribution while for other genes they are equal to one. Setting the number of groups and the probability that a cell comes from each group allows flexibility in how different groups are defined. Additionally, parameters controlling the probability that genes are differentially expressed as well as the magnitude and direction of DE factors can be set individually for each group. The resulting SCESet object contains information about which group each cell comes from as well as the factors applied to each gene in each group (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>).</p>
    </sec>
    <sec id="Sec14">
      <title>Simulating batches</title>
      <p id="Par36">A common technical problem in all sequencing experiments is batch effects, where technical variation is created during sample collection and preparation. The Splat simulation can model these effects using multiplicative factors that are applied to all genes for groups of cells. Adding this extra layer of variation allows researchers to evaluate how methods perform in the presence of unwanted variation (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>).</p>
    </sec>
    <sec id="Sec15">
      <title>Simulating paths</title>
      <p id="Par37">A common use of scRNA-seq is to study cellular development and differentiation. Instead of having groups of mature cells, individual cells are somewhere on a continuous differentiation path or lineage from one cell type to another. To model this, the Splat simulation uses the differential expression process described above to define the expression levels of a start and end cell for each path. A series of steps is then defined between the two cells types and the simulated cells are randomly assigned to one of these steps, receiving the mean expression levels at that point. Therefore, the simulation of lineages using Splat is defined by the differential expression parameters used to create the differences between the start and end of each path. It also incorporates the parameters that define the path itself, such as the length (number of steps) and skew (whether cells are more likely to come from the start or end of the path).</p>
      <p id="Par38">In real data it has been observed that expression of genes can change in more complex, non-linear ways across a differentiation trajectory. For example, a gene may be lowly expressed at the beginning of a process, highly expressed in the middle and lowly expressed at the end. Splat models these kinds of changes by generating a Brownian bridge (a random walk with fixed end points) between the two end cells of a path, which is then smoothed and interpolated using an Akima spline [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. This random element allows many possible patterns of expression changes over the course of a path (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15). While non-linear changes are possible they are not the norm. Splat defines parameters that control the proportion of genes that are non-linear and how variable those genes can be.</p>
      <p id="Par39">Further complexity in simulating differentiation paths can be achieved by modeling lineages with multiple steps or branches. For example, a stem cell that differentiates into an intermediate cell type that then changes into one of two mature cell types. These possibilities are enabled by allowing the user to set a starting point for each path (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>).</p>
    </sec>
    <sec id="Sec16">
      <title>Example: using Splatter simulations to evaluate a clustering method</title>
      <p id="Par40">To demonstrate how the simulations available in Splatter could be used to evaluate an analysis method we present an example of evaluating a clustering method. SC3 [<xref ref-type="bibr" rid="CR5">5</xref>] is a consensus <italic>k</italic>-means-based approach available from Bioconductor [<xref ref-type="bibr" rid="CR33">33</xref>]. As well as assigning cells to groups, SC3 is able to detect genes that are differentially expressed between groups and marker genes that uniquely identify each group. To test SC3 we estimated Splat simulation parameters from the Tung dataset and simulated 400 cells from three groups with probabilities of 0.6, 0.25, and 0.15. The probability of a gene being differentially expressed in a group was 0.1, resulting in approximately 1700 DE genes per group. We then ran SC3 with three clusters (<inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k=3 $$\end{document}</tex-math><mml:math id="M60"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq30.gif"/></alternatives></inline-formula>) and compared the results to the true groupings (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). We also assessed the detection of DE and marker genes. True DE genes were taken as genes with simulated DE in any group and true marker genes as the subset of DE genes that were DE in only a single group (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). This procedure was repeated 20 times with different random seeds to get some idea of the variability and robustness of the method.<fig id="Fig6"><label>Fig. 6</label><caption><p>Evaluation of SC3 results. Metrics for the evaluation of clustering (<bold>a</bold>) include the Rand index, Hubert and Arabie’s adjusted Rand index (<italic>HA</italic>), Morey and Agresti’s adjusted Rand index (<italic>MA</italic>), Fowlkes and Mallows index (<italic>FM</italic>), and the Jaccard index. Detection of differentially expressed and marker genes were evaluated (<bold>b</bold>) using accuracy, recall (true positive rate), precision, F1 score (harmonic mean of precision and recall), and false positive rate (<italic>FPR</italic>). All of the metrics are presented here as boxplots across the 20 simulations</p></caption><graphic xlink:href="13059_2017_1305_Fig6_HTML" id="MO6"/></fig>
</p>
      <p id="Par41">Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the evaluation of SC3’s clustering and gene identification on the simulated data. Five measures were used to evaluate the clustering: the Rand index (Rand), Hubert and Arabie’s (HA) adjusted Rand index and Morey and Agresti’s (MA) adjusted Rand index (both of which adjust for chance groupings), Fowlkes and Mallows index (FM) and the Jaccard index (Jaccard). All of these indices attempt to measure the similarity between two clusterings, in this case the clustering returned by SC3 and the true groups in the simulation. SC3 appears to identify clusters well for the majority of simulations, in some cases producing a near-perfect clustering. It may be interesting to examine individual cases further in order to identify when SC3 is able to perform better. Both the DE genes and marker genes identified by SC3 show a similar pattern across our classification metrics of accuracy, precision, recall, and F1 score. On average approximately 2700 of the truly DE genes and 2500 of the true marker genes passed SC3’s automatic filtering (with additional non-DE genes). SC3 then detected around 100 DE genes per simulation, along with 99 marker genes (median values). Precision (the proportion of identified genes that are true positives) is very high while recall (the proportion of true positives that were identified, or true positive rate) is very low. This tells us that in this scenario SC3 is producing many false negatives, but that the genes that it finds to be markers or DE are correct. This result is often desirable, particularly for marker genes, and is reflected in the very low false positive rate.</p>
      <p id="Par42">While it is beyond the scope of this paper, clearly this evaluation could be extended, for example, by including more clustering methods, more variations in simulation parameters, and investigating why particular results are seen. However, these data, and the code used to produce them, are an example of how such an evaluation could be conducted using the simulations available in Splatter.</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Discussion and conclusions</title>
    <p id="Par43">The recent development of single-cell RNA sequencing has spawned a plethora of analysis methods, and simulations can be a powerful tool for developing and evaluating them. Unfortunately, many current simulations of scRNA-seq data are poorly documented, not reproducible, or fail to demonstrate similarity to real datasets. In addition, simulations created to evaluate a specific method can sometimes fall into the trap of having the same underlying assumptions as the method that they are trying to test. An independent, reproducible, and flexible simulation framework is required in order for the scientific community to evaluate and develop sophisticated analysis methodologies.</p>
    <p id="Par44">Here we have developed Splatter, an independent framework for the reproducible simulation of scRNA-seq data. Splatter is available as an R package from Bioconductor, under a GPL-3 license, and implements a series of simulation models. Splatter can easily estimate parameters for each model from real data, generate synthetic datasets and quickly create a series of diagnostic plots comparing different simulations and datasets.</p>
    <p id="Par45">As part of Splatter we introduce our own simulation called Splat. Splat builds on the gamma-Poisson (or negative binomial) distribution commonly used to represent RNA-seq data, and adds high-expression outlier genes, library size distributions, a mean-variance trend, and the option of expression-based dropout. Extensions to Splat include the simulation of more complex scenarios, such as multiple groups of cells with differing sizes and levels of differential expression, experiments with several batches, or differentiation trajectories with multiple paths and branches, with genes that change in non-linear ways.</p>
    <p id="Par46">We performed an evaluation of the six simulation models currently available in Splatter by comparing synthetic data generated using estimated parameters to five published datasets. Overall Splat performed well, ranking highly on most metrics. However, other simulations performed better for some metrics or better reproduced specific datasets. We found the Camp cerebral organoid dataset the most challenging to simulate, perhaps because of the complex nature of this sample, which is comprised of many different cell types. In addition, this dataset (along with the Engel data) used a full-length protocol, which may contain additional noise compared to the UMI datasets [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
    <p id="Par47">One of the key features of scRNA-seq data is the high number of zero counts where no expression is observed for a particular gene in a particular cell. This can be especially challenging to simulate as not only must there be the correct number of zeros but they must be correctly distributed across genes and cells. We found that introducing dropout (in Splat) or zero-inflation (in Lun 2) often failed to improve the match to real datasets, suggesting that they are not truly zero-inflated. Together, the results demonstrate that no simulation can accurately reproduce all scRNA-seq datasets. They also emphasize the variability in scRNA-seq data, which arises from a complex set of biological (for example, species, tissue type, cell type, treatment, and cell cycle) and technical (for example, platform, protocol, or processing) factors. Non-parametric simulations that permute real data could potentially produce more realistic synthetic datasets but at the cost of flexibility in what can be simulated and knowledge of the underlying parameters.</p>
    <p id="Par48">Finally, we demonstrated how Splatter could be used for the development and evaluation of analysis methods, using the SC3 clustering method as an example. Splatter’s flexible framework allowed us to quickly generate multiple test datasets, based on parameters from real data. The information returned about the simulations gave us a truth to test against when evaluating the method. We found that SC3 accurately clustered cells and was precise in identifying DE and marker genes.</p>
    <p id="Par49">The simulations available in Splatter are well documented, reproducible, and independent of any particular analysis method. Splatter’s comparison functions also make it easy to demonstrate how similar simulations are to real datasets. Splatter provides a framework for simulation models, makes existing scRNA-seq simulations accessible to researchers and introduces Splat, a new scRNA-seq simulation model. As more simulation models become available, such as those replicating newer technologies including k-cell sequencing, they can be adapted to Splatter’s framework. The Splat model will continue to be developed and may, in the future, include additional modules such as the ability to add gene lengths to differentiate between UMI and full-length data. We hope that Splatter empowers researchers to rapidly and rigorously develop new scRNA-seq analysis methods, ultimately leading to new discoveries in cell biology.</p>
  </sec>
  <sec id="Sec18">
    <title>Methods</title>
    <sec id="Sec19">
      <title>Splat parameter estimation</title>
      <p id="Par50">To easily generate a simulation that is similar to a given dataset, Splatter includes functions to estimate the parameters for each simulation from real datasets. Just as with the simulation models themselves, the estimation procedures are based on what has been published and there is variation in how many parameters can be estimated for each model. We have given significant attention to estimating the parameters for the Splat simulation. The parameters that control the mean expression of each gene (<inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha $$\end{document}</tex-math><mml:math id="M62"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \beta $$\end{document}</tex-math><mml:math id="M64"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq32.gif"/></alternatives></inline-formula>) are estimated by fitting a gamma distribution to the winsorized means of the library size normalized counts using the fitdistrplus package [<xref ref-type="bibr" rid="CR35">35</xref>]. The library size normalization is a basic normalization where the counts in the original dataset are adjusted so that each cell has the same number of total counts (in this case the median across all cells) and any genes that are all zero are removed. We found that genes with extreme means affect the fit of the gamma distribution and that this effect was mitigated by winsorizing the top and bottom 10% of values to the 10th and 90th percentiles, respectively. Parameters for the library size distribution (<inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}^L $$\end{document}</tex-math><mml:math id="M66"><mml:msup><mml:mi>μ</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}^L $$\end{document}</tex-math><mml:math id="M68"><mml:msup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq34.gif"/></alternatives></inline-formula>) are estimated in a similar way by fitting a log-normal distribution to the unnormalised library sizes.</p>
      <p id="Par51">The procedure for estimating expression outlier parameters is more complex. Taking the library size normalized counts, outliers are defined as genes where the mean expression is more than two MADs greater than the median of the gene expression means. The outlier probability <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\pi}^O $$\end{document}</tex-math><mml:math id="M70"><mml:msup><mml:mi>π</mml:mi><mml:mi>O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq35.gif"/></alternatives></inline-formula> is then calculated as the proportion of genes that are outliers. Parameters for the outlier factors (<inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}^O $$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mi>μ</mml:mi><mml:mi>O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}^O $$\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mi>σ</mml:mi><mml:mi>O</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq37.gif"/></alternatives></inline-formula>) are estimated by fitting a log-normal distribution to the ratio of the means of the outlier genes to the median of the gene expression means.</p>
      <p id="Par52">BCV parameters are estimated using the estimateDisp function in the edgeR package [<xref ref-type="bibr" rid="CR22">22</xref>]. When testing the estimation procedure on simulated datasets we observed that the edgeR estimate of common dispersion was inflated (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16); therefore, we apply a linear correction to this value (<inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\phi}=0.1+0.25{\widehat{\phi}}_{\mathrm{edgeR}} $$\end{document}</tex-math><mml:math id="M76"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>+</mml:mo><mml:mn>0.25</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi mathvariant="normal">edgeR</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq38.gif"/></alternatives></inline-formula>).</p>
      <p id="Par53">The midpoint (<inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_0 $$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq39.gif"/></alternatives></inline-formula>) and shape (<inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k $$\end{document}</tex-math><mml:math id="M80"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq40.gif"/></alternatives></inline-formula>) parameters for the dropout function are estimated by fitting a logistic function to the relationship between the log means of the normalized counts and the proportion of samples that are zero for each gene (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17).</p>
      <p id="Par54">While we note that our estimation procedures are somewhat ad hoc, we found that these procedures are robust, efficient, and guaranteed to produce parameter estimates on all datasets we tested.</p>
    </sec>
    <sec id="Sec20">
      <title>Datasets</title>
      <p id="Par55">Each of the real datasets used in the comparison of simulations is publicly available. Raw FASTQ files for the Camp dataset were downloaded from SRA (accession SRP066834) and processed using a Bpipe (v0.9.9.3) [<xref ref-type="bibr" rid="CR36">36</xref>] pipeline that examined the quality of reads using FastQC (v0.11.4), aligned the reads to the hg38 reference genome using STAR (v2.5.2a) [<xref ref-type="bibr" rid="CR37">37</xref>], and counted reads overlapping genes in the Gencode V22 annotation using featureCounts (v1.5.0-p3) [<xref ref-type="bibr" rid="CR38">38</xref>]. Matrices of gene by cell expression values for the Klein (accession GSM1599500) and Zeisel (accession GSE60361) datasets were downloaded from GEO. For the Tung dataset the matrix of molecules (UMIs) aligned to each gene available from <ext-link ext-link-type="uri" xlink:href="https://github.com/jdblischak/singleCellSeq">https://github.com/jdblischak/singleCellSeq</ext-link> was used. These data are also available from GEO (accession GSE77288). The Salmon [<xref ref-type="bibr" rid="CR39">39</xref>] quantification files for the Engel dataset were download from the Conquer database (<ext-link ext-link-type="uri" xlink:href="http://imlspenticton.uzh.ch:3838/conquer/">http://imlspenticton.uzh.ch:3838/conquer/</ext-link>) and converted to a gene by cell matrix using the tximport [<xref ref-type="bibr" rid="CR40">40</xref>] package.</p>
    </sec>
    <sec id="Sec21">
      <title>Simulation comparison</title>
      <p id="Par56">For each dataset the data file was read into R (v3.4.0) [<xref ref-type="bibr" rid="CR41">41</xref>] and converted to a gene by cell matrix. We randomly selected 200 cells without replacement and filtered out any genes that had zero expression in all cells or any missing values. The parameters for each simulation were estimated from the selected cells and a synthetic dataset generated with 200 cells and the same number of genes as the real data. Simulations were limited to 200 cells (the size of the smallest dataset) to reduce the computational time required. When estimating parameters for the Lun 2, scDD, and BASiCS simulations cells were randomly assigned to two groups. For the Splat and Lun 2 simulations both the regular and zero-inflated variants were used to simulate data. The resulting eight simulations were then compared to the real data using Splatter’s comparison functions and plots showing the overall comparison produced. To compare simulations across the datasets summary statistics were calculated. For each of the basic metrics (mean, variance, library size, zeros per gene, and zeros per cell) the genes were sorted individually for each simulation and the difference from the sorted values and the real data calculated. When looking at the relationship between mean expression level and other metrics (variance, zeros per gene) genes in both the real and simulated data were sorted by mean expression and the difference between the metric of interest (e.g., variance) calculated. The median absolute deviation for each metric was then calculated and ranked for each dataset to give the rankings shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.</p>
    </sec>
    <sec id="Sec22">
      <title>Clustering evaluation</title>
      <p id="Par57">Parameters for Splat simulations used in the example evaluation of SC3 were estimated from the Tung dataset. Twenty synthetic datasets were generated using these parameters with different random seeds. Each simulation had three groups of different cells, with probabilities of 0.6, 0.25 and 0.1, and a probability of a gene being differentially expressed of 0.1. Factors for differentially expressed genes were generated from a log-normal distribution with location parameter equal to –0.1 and scale parameter equal to 0.3. For each simulation the SC3 package was used to cluster cells with <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k=3 $$\end{document}</tex-math><mml:math id="M82"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq41.gif"/></alternatives></inline-formula> and asked to detect DE and marker genes, taking those with adjusted <italic>p</italic> values less than 0.05. True DE genes were defined as genes where the simulated DE factor was not equal to 1 in one or more groups. Marker genes were defined as genes where the DE factor was not equal to 1 in a single group (and 1 in all others). Clustering metrics were calculated using the clues R package [<xref ref-type="bibr" rid="CR42">42</xref>]. To evaluate the DE and marker gene detection we calculated the numbers of true negatives (TN), true positives (TP), false negatives (FN), and false positives (FP). We then used these values to calculate the metrics shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>: accuracy (<inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Acc=\left( TP+ TN\right)/ Total\kern0.17em number\kern0.17em of\kern0.17em genes $$\end{document}</tex-math><mml:math id="M84"><mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="true">/</mml:mo><mml:mi mathvariant="italic">Total</mml:mi><mml:mspace width="0.12em"/><mml:mi mathvariant="italic">number</mml:mi><mml:mspace width="0.12em"/><mml:mi mathvariant="italic">of</mml:mi><mml:mspace width="0.12em"/><mml:mi mathvariant="italic">genes</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq42.gif"/></alternatives></inline-formula>), recall (<inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Rec= TP/\left( TP+ FN\right) $$\end{document}</tex-math><mml:math id="M86"><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq43.gif"/></alternatives></inline-formula>), precision (<inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Pre= TP/\left( TP+ FP\right) $$\end{document}</tex-math><mml:math id="M88"><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq44.gif"/></alternatives></inline-formula>), F1 score (<inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ F1={2}^{\ast}\left(\left({Pre}^{\ast } Rec\right)/\left( Pre+ Rec\right)\right) $$\end{document}</tex-math><mml:math id="M90"><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>*</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="true">/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq45.gif"/></alternatives></inline-formula>), and false positive rate (<inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ FPR= FP/\left( FP+ TN\right) $$\end{document}</tex-math><mml:math id="M92"><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2017_1305_Article_IEq46.gif"/></alternatives></inline-formula>). Metrics were aggregated across the 20 simulations and boxplots produced using the ggplot2 package [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
      <p id="Par58">Session information describing the packages used in all analysis steps is included as Additional file <xref rid="MOESM3" ref-type="media">3</xref>. The code and dataset files are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Oshlack/splatter-paper">https://github.com/Oshlack/splatter-paper</ext-link> under an MIT license.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2017_1305_MOESM1_ESM.pdf">
            <label>Additional file 1: Figures S1–S17</label>
            <caption>
              <p>Diagrams of other simulation models, Splatter comparison output for all datasets, example non-linear gene, dispersion estimate correction, mean-zeros fit, benchmarking, and processing times (PDF 17991 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2017_1305_MOESM2_ESM.csv">
            <label>Additional file 2:</label>
            <caption>
              <p>Table of the median absolute deviations used to produce Fig. <xref rid="Fig4" ref-type="fig">4</xref> in CSV format. (CSV 37 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2017_1305_MOESM3_ESM.pdf">
            <label>Additional file 3:</label>
            <caption>
              <p>Session information. Details of the R environment and packages used for analysis. (PDF 118 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s13059-017-1305-0) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank the authors of the BASiCS and scDD packages for their responses to our questions about how to include their simulations in Splatter as well as Mark Robinson and Charlotte Soneson for discussions regarding the simulation of scRNA-seq data. Our thanks also to Jovana Maksimovic and Sarah Blood for their comments on the manuscript.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par59">Luke Zappia is supported by an Australian Government Research Training Program (RTP) Scholarship. Alicia Oshlack is supported through a National Health and Medical Research Council Career Development Fellowship APP1126157. MCRI is supported by the Victorian Government's Operational Infrastructure Support Program.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par60">The datasets analyzed during the current study are available from the repositories specified in the methods. The code used to analyze them is available under an MIT license from the repository for this paper <ext-link ext-link-type="uri" xlink:href="https://github.com/Oshlack/splatter-paper">https://github.com/Oshlack/splatter-paper</ext-link> (doi: 10.5281/zenodo.833571). Copies of the datasets are also provided in this repository. The Splatter package is available from Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/splatter/">http://bioconductor.org/packages/splatter/</ext-link>) and is being developed on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/Oshlack/splatter">https://github.com/Oshlack/splatter</ext-link>) under a GPL-3 license. The specific version of Splatter used in this paper, which includes the BASiCS simulation, is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Oshlack/splatter/releases/tag/v1.1.3-basics">https://github.com/Oshlack/splatter/releases/tag/v1.1.3-basics</ext-link> (doi: 10.5281/zenodo.833574).</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LZ developed the software and performed the analysis. BP contributed to the statistics and supervision. AO oversaw all aspects of the project. All authors contributed to drafting the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par61">Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p id="Par62">The authors declare that they have no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodwin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Richard McCombie</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>333</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.49</pub-id>
        <?supplied-pmid 27184599?>
        <pub-id pub-id-type="pmid">27184599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ozsolak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Milos</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing: advances, challenges and opportunities</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>87</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2934</pub-id>
        <?supplied-pmid 21191423?>
        <pub-id pub-id-type="pmid">21191423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>377</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <?supplied-pmid 19349980?>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">scRNA-tools. <ext-link ext-link-type="uri" xlink:href="http://www.scrna-tools.org/">http://www.scrna-tools.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaub</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Troup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>JWK</given-names>
          </name>
        </person-group>
        <article-title>CIDR: ultrafast and accurate clustering through imputation for single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1188-0</pub-id>
        <?supplied-pmid 28351406?>
        <pub-id pub-id-type="pmid">28351406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <?supplied-pmid 24658644?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DuVerle</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Yotsukura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nomura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aburatani</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tsuda</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Cell Tree: an R/bioconductor package to infer the hierarchical structure of cell populations from single-cell RNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>363</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1175-6</pub-id>
        <?supplied-pmid 27620863?>
        <pub-id pub-id-type="pmid">27620863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juliá</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Telenti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rausell</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Sincell: an R/Bioconductor package for statistical assessment of cell-state hierarchies from single-cell RNA-seq</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3380</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv368</pub-id>
        <?supplied-pmid 26099264?>
        <pub-id pub-id-type="pmid">26099264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id>
        <?supplied-pmid 26527291?>
        <pub-id pub-id-type="pmid">26527291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yajima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gersuk</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Perraudeau</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gribkova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <source>ZINB-WaVE: a general and flexible method for signal extraction from single-cell RNA-seq data</source>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>van Dijk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nainys</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kathail</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Moon</surname>
            <given-names>KR</given-names>
          </name>
          <etal/>
        </person-group>
        <source>MAGIC: a diffusion-based imputation method reveals gene-gene interactions in single-cell RNA-sequencing data</source>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Torre</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bonasio</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Gene expression recovery for single cell RNA sequencing</source>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Li WV, Li JJ. scImpute: accurate and robust imputation for single cell RNA-Seq data. 2017. <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2017/05/24/141598">http://biorxiv.org/content/early/2017/05/24/141598</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Wills</surname>
            <given-names>QF</given-names>
          </name>
        </person-group>
        <article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1179</fpage>
        <lpage>86</lpage>
        <?supplied-pmid 28088763?>
        <pub-id pub-id-type="pmid">28088763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0866-z</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Overcoming confounding plate effects in differential expression analyses of single-cell RNA-seq data</article-title>
        <source>Biostatistics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>451</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 28334062?>
        <pub-id pub-id-type="pmid">28334062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korthauer</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>222</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1077-y</pub-id>
        <?supplied-pmid 27782827?>
        <pub-id pub-id-type="pmid">27782827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BASiCS: Bayesian analysis of single-cell sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004333</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id>
        <?supplied-pmid 26107944?>
        <pub-id pub-id-type="pmid">26107944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <?supplied-pmid 20979621?>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Korthauer K. scDD vignette. 2017. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/vignettes/scDD/inst/doc/scDD.pdf">https://bioconductor.org/packages/release/bioc/vignettes/scDD/inst/doc/scDD.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Beyond comparisons of means: understanding changes in gene expression at the single-cell level</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>70</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0930-3</pub-id>
        <?supplied-pmid 27083558?>
        <pub-id pub-id-type="pmid">27083558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
        <?supplied-pmid 24485249?>
        <pub-id pub-id-type="pmid">24485249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Blischak</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Burnett</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Batch effects and the effective design of single-cell gene expression studies</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>39921</fpage>
        <pub-id pub-id-type="doi">10.1038/srep39921</pub-id>
        <?supplied-pmid 28045081?>
        <pub-id pub-id-type="pmid">28045081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Andrews TS, Hemberg M. Modelling dropouts allows for unbiased identification of marker genes in scRNASeq experiments. 2016. <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2016/07/21/065094">http://biorxiv.org/content/early/2016/07/21/065094</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kivioja</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vähärautio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bonke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>72</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akima</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A new method of interpolation and smooth curve fitting based on local procedures</article-title>
        <source>JACM</source>
        <year>1970</year>
        <volume>17</volume>
        <fpage>589</fpage>
        <lpage>602</lpage>
        <pub-id pub-id-type="doi">10.1145/321607.321609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Akima H, Gebhardt A. akima: interpolation of irregularly and regularly spaced data. 2016. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=akima">https://CRAN.R-project.org/package=akima</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>115</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id>
        <?supplied-pmid 25633503?>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Gene length and detection bias in single cell RNA sequencing protocols</article-title>
        <source>F1000Res</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>595</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.11290.1</pub-id>
        <?supplied-pmid 28529717?>
        <pub-id pub-id-type="pmid">28529717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delignette-Muller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dutang</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>fitdistrplus: an R package for fitting distributions</article-title>
        <source>J Stat Softw</source>
        <year>2015</year>
        <volume>64</volume>
        <fpage>1</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v064.i04</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sadedin</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Pope</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bpipe: a tool for running and managing bioinformatics pipelines</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1525</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts167</pub-id>
        <?supplied-pmid 22500002?>
        <pub-id pub-id-type="pmid">22500002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>923</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>
        <?supplied-pmid 24227677?>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>417</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <?supplied-pmid 28263959?>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences</article-title>
        <source>F1000Res</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>1521</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.7563.1</pub-id>
        <?supplied-pmid 26925227?>
        <pub-id pub-id-type="pmid">26925227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">R Core Team. R: a language and environment for statistical computing. Vienna: R Foundation for Statistical Computing; 2016. <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zamar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lazarus</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>clues: an R package for nonparametric clustering based on local shrinking</article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v033.i04</pub-id>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: elegant graphics for data analysis</source>
        <year>2010</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camp</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Badsha</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Florio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wilsch-Bräuninger</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human cerebral organoids recapitulate gene expression programs of fetal neocortex development</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>15672</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1508055112</pub-id>
        <?supplied-pmid 26644564?>
        <pub-id pub-id-type="pmid">26644564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Engel</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Seumois</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Samaniego-Castruita</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chawla</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Innate-like functions of natural killer T cell subsets result from highly divergent gene programs</article-title>
        <source>Nat Immunol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>728</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1038/ni.3437</pub-id>
        <?supplied-pmid 27089380?>
        <pub-id pub-id-type="pmid">27089380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1187</fpage>
        <lpage>201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Muñoz-Manchado</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Juréus</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
