<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5588725</article-id>
    <article-id pub-id-type="publisher-id">1814</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1814-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Statistical classifiers for diagnosing disease from immune repertoires: a case study using multiple sclerosis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ostmeyer</surname>
          <given-names>Jared</given-names>
        </name>
        <address>
          <email>jared.ostmeyer@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Christley</surname>
          <given-names>Scott</given-names>
        </name>
        <address>
          <email>scott.christley@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Rounds</surname>
          <given-names>William H.</given-names>
        </name>
        <address>
          <email>william.rounds@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toby</surname>
          <given-names>Inimary</given-names>
        </name>
        <address>
          <email>inimary.toby@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Greenberg</surname>
          <given-names>Benjamin M.</given-names>
        </name>
        <address>
          <email>benjamin.greenberg@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monson</surname>
          <given-names>Nancy L.</given-names>
        </name>
        <address>
          <email>nancy.monson@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Cowell</surname>
          <given-names>Lindsay G.</given-names>
        </name>
        <address>
          <email>lindsay.cowell@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution>Department of Clinical Sciences, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>5323 Harry Hines Boulevard, Dallas, TX 75390-9066 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution>Department of Neurology and Neurotherapeutics, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>5323 Harry Hines Boulevard, Dallas, TX 75390-9036 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>401</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Deep sequencing of lymphocyte receptor repertoires has made it possible to comprehensively profile the clonal composition of lymphocyte populations. This opens the door for novel approaches to diagnose and prognosticate diseases with a driving immune component by identifying repertoire sequence patterns associated with clinical phenotypes. Indeed, recent studies support the feasibility of this, demonstrating an association between repertoire-level summary statistics (e.g., diversity) and patient outcomes for several diseases. In our own prior work, we have shown that six codons in VH4-containing genes in B cells from the cerebrospinal fluid of patients with relapsing remitting multiple sclerosis (RRMS) have higher replacement mutation frequencies than observed in healthy controls or patients with other neurological diseases. However, prior methods to date have been limited to focusing on repertoire-level summary statistics, ignoring the vast amounts of information in the millions of individual immune receptors comprising a repertoire. We have developed a novel method that addresses this limitation by using innovative approaches for accommodating the extraordinary sequence diversity of immune receptors and widely used machine learning approaches. We applied our method to RRMS, an autoimmune disease that is notoriously difficult to diagnose.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We use the biochemical features encoded by the complementarity determining region 3 of each B cell receptor heavy chain in every patient repertoire as input to a detector function, which is fit to give the correct diagnosis for each patient using maximum likelihood optimization methods. The resulting statistical classifier assigns patients to one of two diagnosis categories, RRMS or other neurological disease, with 87% accuracy by leave-one-out cross-validation on training data (<italic>N</italic> = 23) and 72% accuracy on unused data from a separate study (<italic>N</italic> = 102).</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Our method is the first to apply statistical learning to immune repertoires to aid disease diagnosis, learning repertoire-level labels from the set of individual immune repertoire sequences. This method produced a repertoire-based statistical classifier for diagnosing RRMS that provides a high degree of diagnostic capability, rivaling the accuracy of diagnosis by a clinical expert. Additionally, this method points to a diagnostic biochemical motif in the antibodies of RRMS patients, which may offer insight into the disease process.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-017-1814-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Antibody</kwd>
      <kwd>Immune repertoire</kwd>
      <kwd>CDR3</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Multiple sclerosis</kwd>
      <kwd>Statistical classifier</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>AI097403</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cowell</surname>
            <given-names>Lindsay G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution>Cancer Prevention and Research Institute of Texas (US)</institution>
        </funding-source>
        <award-id>RP160157</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ostmeyer</surname>
            <given-names>Jared</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par21">Lymphocytes express immune receptors on their cell surface, the genes of which are somatically generated in developing lymphocytes through a DNA recombination process known as V(D)J recombination. V(D)J recombination assembles variable (V), diversity (D), and joining (J) gene segments into mature, composite genes. The diversity of gene sequences generated by V(D)J recombination is huge as a result of varying combinations of V, D, and J gene segments, as well as sequence modifications (e.g.<italic>,</italic> exonucleolytic activity and non-templated nucleotide addition) at the junctions of rearranged gene segments. As a result, each individual has millions of unique immune receptor genes. Somatic generation of a tremendously diverse repertoire of immune receptors enables effective immune responses against an essentially infinite array of antigens, such as those derived from pathogens or tumors, but it can also lead to detrimental effects, such as autoimmune responses and organ rejection following transplantation. The composition of immune repertoires shifts in response to such immunological events, and thus reflects previous and ongoing immune responses.</p>
    <p id="Par22">Deep sequencing of immune repertoires has made it possible to comprehensively profile the clonal composition of lymphocyte populations, opening the door for novel approaches to diagnose and prognosticate diseases with a driving immune component by identifying repertoire sequence patterns associated with important clinical phenotypes. Recent studies support the feasibility of this approach. Patterns in the relative abundances of V gene segment types in a repertoire have been observed in association with various autoimmune diseases [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>], as well as with metastasis-free/progression-free survival in basal-like and HER2-enriched breast cancer subtypes and the immunoreactive ovarian cancer subtype [<xref ref-type="bibr" rid="CR4">4</xref>]. Repertoire diversity has been associated with prognosis in gastric cancer [<xref ref-type="bibr" rid="CR5">5</xref>] and with outcome following Ipilimumab treatment for metastatic melanoma [<xref ref-type="bibr" rid="CR6">6</xref>]. We have demonstrated that VH4-containing genes in B cell repertoires from the cerebrospinal fluid of RRMS patients have higher replacement mutation frequencies at six codons than those in healthy controls [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. The sum of Z scores across the six codons can distinguish RRMS patients from those with other neurological diseases (OND) [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par23">The methods applied to date for associating repertoire patterns with clinical phenotypes have focused on repertoire-level features, ignoring the vast amounts of information available in the millions of individual immune receptors comprising a repertoire. This has been due to difficulties accounting for the tremendous diversity of immune repertoires and the lack of methods for mapping the large number of individual sequences in a repertoire to a single phenotype label. We have developed a novel method that addresses both limitations by combining widely used machine learning methods with innovative approaches for accommodating the extraordinary sequence diversity of immune receptors and for aggregating the set of predictions made for each sequence in a repertoire.</p>
    <p id="Par24">We applied our method to RRMS, a subtype of multiple sclerosis (MS). MS is an autoimmune disease that is notoriously difficult to diagnose. It is believed to be the result of immune cells attacking the myelin insulation around nerve cells, leaving patients with physical and cognitive impairments. Unfortunately, there are no symptoms, physical findings, or lab tests that provide a definitive MS diagnosis. Patients have to demonstrate findings consistent with MS and simultaneously have alternative diagnoses be excluded [<xref ref-type="bibr" rid="CR8">8</xref>]. Thus, reaching an MS diagnosis can be a slow process, but early detection is needed, because prompt intervention can significantly slow the progression of the disease [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par25">We applied our method to B cell receptor (BCR) heavy chain genes to develop a statistical classifier that assigns patients to one of two diagnosis categories, RRMS or OND, based on the BCR heavy chain biochemical features. The classifier has 87% accuracy by leave-one-out cross-validation on training data (<italic>N</italic> = 23) and 73% accuracy on unused data from a separate study (<italic>N</italic> = 102). These results demonstrate the utility of our new method for identifying repertoire-based signatures with diagnostic potential.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par26">Our overall approach was as follows. We used two data sets, one as training data and one as validation data (Table <xref rid="Tab1" ref-type="table">1</xref>). The training data set was used with exhaustive leave-one-out cross-validation for model selection to identify the best model from among seven models tested (Table <xref rid="Tab2" ref-type="table">2</xref>). The seven models correspond to different approaches to representing immune receptor sequences. The model with highest classification accuracy by cross-validation was selected for application to the validation data set.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Repertoire sequencing data sets used to develop and test the MS classifier. The number of patients in each study with each diagnosis is shown</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Relapsing Remitting Multiple Sclerosis</th><th>Other Neurological Disease</th></tr></thead><tbody><tr><td>2015 Study [7]</td><td>11</td><td>12</td></tr><tr><td>2017 Study</td><td>60</td><td>42</td></tr></tbody></table></table-wrap>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Sequence Representations used for Model Selection. CDR3 sequences were cut into snippets of varying length and represented as DNA sequence, amino acid sequence, or Atchley factors [<xref ref-type="bibr" rid="CR10">10</xref>]. Classification accuracy results are reported as the fraction of patients for which the model’s prediction of the diagnosis is correct</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Snippet Length</th><th>Sequence Representation</th><th>Classification Accuracy on the Training Data Set by Exhaustive 1-Holdout Cross-Validation</th></tr></thead><tbody><tr><td>4 Amino Acids</td><td>Atchley Factors</td><td>11/23 ≈ 47.8%</td></tr><tr><td>5 Amino Acids</td><td>Atchley Factors</td><td>15/23 ≈ 65.2%</td></tr><tr><td>6 Amino Acids</td><td>Atchley Factors</td><td>20/23 ≈ 87.0%</td></tr><tr><td>7 Amino Acids</td><td>Atchley Factors</td><td>14/23 ≈ 60.9%</td></tr><tr><td>2 DNA Triplets</td><td>DNA Nucleotides</td><td>12/23 ≈ 52.2%</td></tr><tr><td>6 DNA Triplets</td><td>DNA Nucleotides</td><td>8/23 ≈ 34.8%</td></tr><tr><td>6 Amino Acids</td><td>Amino Acid Residue</td><td>15/23 ≈ 65.2%</td></tr></tbody></table></table-wrap>
</p>
    <p id="Par27">The training data set consisted of 23 patients, 11 with RRMS and 12 with OND (2015 Study, Table <xref rid="Tab1" ref-type="table">1</xref>). The validation data set consisted of 102 patients, 60 with RRMS and 42 with OND (2017 Study, Table <xref rid="Tab1" ref-type="table">1</xref>). For both studies, B cell repertoires were collected and processed as described in [<xref ref-type="bibr" rid="CR7">7</xref>]. Briefly, samples were collected from patient cerebrospinal fluid (CSF) (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>), and VH4-containing BCR heavy chain genes were sequenced using next generation sequencing (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). VH4-containing heavy chains were targeted because previous studies found elevated VH4 expression in patients with RRMS [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Sequence pre-processing was performed as described in Methods to identify complementarity determining region 3 (CDR3) sequences for input into our method.<fig id="Fig1"><label>Fig. 1</label><caption><p>Study Overview (<bold>a</bold>) B cells are collected from patient cerebrospinal fluid. (<bold>b</bold>) DNA is extracted, and next generation sequencing is used to sequence immunoglobulin heavy chain loci expressing IGHV4 rearrangements. (<bold>c</bold>) Snippets of amino acid sequence taken from the CDR3 are converted into a set of chemical features using Atchley factors. (<bold>d</bold>) The chemical features are scored by a detector function. The detector function used in this study is the same function used in logistic regression. A positive diagnosis (for RRMS) is flagged whenever a high scoring snippet is found. Values for the weights on each Atchley factor as well as the bias term are determined by maximizing the likelihood of obtaining the correct diagnoses on a training set of patients</p></caption><graphic xlink:href="12859_2017_1814_Fig1_HTML" id="MO1"/></fig>
</p>
    <sec id="Sec3">
      <title>Representing immune receptor sequences for statistical classification</title>
      <p id="Par28">We utilized the CDR3 sequence of each heavy chain gene, because it is the somatically generated portion of the gene and the primary determinant of the antigen binding specificity encoded by the gene. To accommodate the varying length of CDR3, each CDR3 sequence was cut into snippets of equal length (i.e.<italic>,</italic> k-mers). We considered snippet lengths of 2, 4, 5, 6, and 7 amino acids or codons. For each CDR3, the full set of overlapping snippets was used. We considered three different sequence representations: DNA sequence, amino acid sequence, and a representation based on Atchley factors (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). There are five Atchley factors derived from a set of over 50 amino acid properties by dimensionality reduction to identify clusters of amino acid properties that co-vary [<xref ref-type="bibr" rid="CR10">10</xref>]. The five Atchley factors correspond loosely to polarity, secondary structure, molecular volume, codon diversity, and electrostatic charge. For the Atchley factor representation, each amino acid in a snippet is represented by a vector of its five Atchley factor values. We conducted model selection over seven combinations of snippet length and sequence representation (Table <xref rid="Tab2" ref-type="table">2</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>Scoring each sequence in a repertoire</title>
      <p id="Par29">Every snippet from every CDR3 sequence in a patient’s repertoire is scored by a detector function indicating if a snippet predicts RRMS. We use a logistic function because of its widespread use and simplicity, and because it models the outcome of a two-category process. The first step is to compute a biased, weighted sum of the snippet’s features, referred to as a logit.<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{logit}={b}_0+{W}_1\cdot {f}_1+{W}_2\cdot {f}_2+\cdots +{W}_N\cdot {f}_N(1) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mtext>logit</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="12859_2017_1814_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par30">For the DNA and amino acid sequence representations, the values <italic>f</italic>
<sub>1</sub> through <italic>f</italic>
<sub><italic>N</italic></sub> represent the snippet residues. For the Atchley factor representation, the <italic>f</italic>
<sub><italic>i</italic></sub> represent the five Atchley factors from each residue in the snippet. For snippets of length six, <italic>N</italic> = 30. The bias term <italic>b</italic>
<sub>0</sub> along with the weights <italic>W</italic>
<sub><italic>i</italic></sub> are the parameters of the model and are fit by maximum likelihood using gradient descent optimization techniques as described below. The same weights <italic>W</italic>
<sub><italic>i</italic></sub> and bias term <italic>b</italic>
<sub>0</sub> are used for all snippets. Once the logit is computed, the value is passed through the sigmoid function to obtain a score between 0 and 1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure. S1).<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{score}=\frac{1}{1+{e}^{-\mathrm{logit}}}(2) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mtext>logit</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="12859_2017_1814_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>
</p>
    </sec>
    <sec id="Sec5">
      <title>Aggregation of snippet scores to predict a diagnosis</title>
      <p id="Par31">A patient’s snippet scores need to be aggregated into a single value to form a diagnosis. Because only a small fraction of BCRs in a patient’s repertoire are expected to be disease related, it is necessary to capture a diagnosis even if only a few snippets have a high score. This is accomplished by assigning a positive diagnosis when even a single high scoring snippet is found (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). Assuming the output of the detector function represents a probability value between 0 and 1, the form of the model can be written as:<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left(\mathrm{positive}\  \mathrm{diagnosis}|{\mathrm{snip}}_1,{\mathrm{snip}}_2,{\mathrm{snip}}_3,\dots \right)=\mathrm{Maximum}\left({\mathrm{score}}_1,{\mathrm{score}}_2,{\mathrm{score}}_3,\dots \kern0.5em \right)(3) $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mtext>positive diagnosis</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mtext>snip</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>snip</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>snip</mml:mtext><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Maximum</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mtext>score</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>score</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>score</mml:mtext><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mspace width="0.5em"/><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="12859_2017_1814_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par32">A probability &gt;0.5 indicates a positive diagnosis (RRMS), whereas a value &lt;0.5 indicates an OND diagnosis.</p>
    </sec>
    <sec id="Sec6">
      <title>Parameter fitting by gradient descent</title>
      <p id="Par33">Specific values for the weights <italic>W</italic>
<sub><italic>i</italic></sub> and bias term <italic>b</italic>
<sub>0</sub> in the detector function are determined using the patient diagnoses. The values must be chosen to maximize the likelihood that each predicted diagnosis is correct. To search for the optimal values, gradient optimization techniques can be used. With these techniques, each parameter is iteratively adjusted along the gradient in a direction that maximizes the log-likelihood, which in turn maximizes the likelihood that each predicted diagnosis is correct. The initial value for the bias term <italic>b</italic>
<sub>0</sub> is 0, and initial values for the weights are drawn at random according to <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_i\sim \mathcal{N}\left(0,{N}_{\mathrm{features}}^{-1}\right) $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:msubsup><mml:mi>N</mml:mi><mml:mtext>features</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1814_Article_IEq1.gif"/></alternatives></inline-formula>. Because the Adam optimizer, a gradient descent based method, has been shown to work well on a wide range of optimization tasks, it is used here [<xref ref-type="bibr" rid="CR11">11</xref>]. The Adam optimizer is run for 2500 iterations with a step size of 0.01. The default values for the other Adam optimizer settings are: <italic>β</italic>
<sub>1</sub> = 0.9, <italic>β</italic>
<sub>2</sub> = 0.999, <italic>ϵ</italic> = 10<sup>−8</sup>.</p>
      <p id="Par34">A limitation of using a gradient descent based method is there is no guarantee of finding the globally optimal solution. Although the chosen detector function constitutes a linear model, the scores from every snippet are aggregated together in a non-linear fashion. Multiple local minima could exist. To address this, 10<sup>5</sup> runs of Adam optimization, each starting from different initial parameters <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_i\sim \mathcal{N}\left(0,{N}_{\mathrm{features}}^{-1}\right) $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:msubsup><mml:mi>N</mml:mi><mml:mtext>features</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1814_Article_IEq2.gif"/></alternatives></inline-formula>, are used, and the best fit solution over all runs is used to diagnose new patients.</p>
    </sec>
    <sec id="Sec7">
      <title>Development of the MS classifier– Model selection and validation</title>
      <p id="Par35">We applied the above-described approach to our training data set of 23 patients using one-holdout cross-validation (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). Classification accuracy on the holdout patients was used to identify the best performing model from among the seven models tried (Table <xref rid="Tab2" ref-type="table">2</xref>). A snippet size of 6 amino acid residues resulted in the highest classification accuracy. Categorical representations of the DNA nucleotides and amino acid residues both underperformed the Atchley factor representation. The best performing model correctly diagnosed 20 out of 23 patients (Table <xref rid="Tab2" ref-type="table">2</xref>, Fig. <xref rid="Fig3" ref-type="fig">3a</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Workflow for Model Selection and Parameter Fitting. (<bold>a</bold>) The diagram shows how training data is used to train and evaluate multiple hypotheses. The model that gives the best classification accuracy on the exhaustive 1-holdout cross-validation constitutes the lead hypothesis. (<bold>b</bold>) The diagram shows how data is used to train and test the lead hypothesis. The best performing model is refitted to all the samples in the training data, and then used to score samples from the validation data set</p></caption><graphic xlink:href="12859_2017_1814_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Classification Accuracy and Receiver Operating Characteristic (ROC) Curve. (<bold>a</bold>) Classification accuracy for the best performing model obtained via exhaustive 1-holdout cross-validation on training data. 87% of patients were correctly classified. (<bold>b</bold>) Classification accuracy of the best performing model on the validation data. 72% of patients were correctly classified. (<bold>c</bold>) The corresponding ROC curve shows true and false positive rates for different thresholds of a positive diagnosis based on the highest snippet score. The area under the curve is 0.75</p></caption><graphic xlink:href="12859_2017_1814_Fig3_HTML" id="MO3"/></fig>
</p>
      <p id="Par36">To estimate the probability of correctly classifying 20 of 23 patients by chance using our best performing model, we performed a permutation analysis. We performed 20 permutations in which patient diagnoses were permutated, and the one-holdout cross-validation procedure was conducted. The resulting classification accuracies are shown in Table <xref rid="Tab3" ref-type="table">3</xref>. All were lower than 20 out of 23, allowing us to assign <italic>p</italic> &lt; 0.05 to the observed accuracy. The average accuracy over all permutations is 40.4%.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Classification accuracies observed by 1-holdout cross-validation after permuting diagnoses in our training data set. Results reported as the fraction of samples for which the model’s prediction of the diagnosis matches the label assigned under permutation</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="5">Classification Accuracy on the Training Data Set by Exhaustive 1-Holdout Cross-Validation (Labels Assigned under Permutation)</th></tr></thead><tbody><tr><td>7/23 ≈ 30.4%</td><td>11/23 ≈ 47.8%</td><td>6/23 ≈ 26.1%</td><td>6/23 ≈ 26.1%</td><td>7/23 ≈ 30.4%</td></tr><tr><td>15/23 ≈ 65.2%</td><td>13/23 ≈ 56.5%</td><td>11/23 ≈ 47.8%</td><td>12/23 ≈ 52.2%</td><td>7/23 ≈ 30.4%</td></tr><tr><td>18/23 ≈ 78.3%</td><td>7/23 ≈ 30.4%</td><td>6/23 ≈ 26.1%</td><td>8/23 ≈ 34.8%</td><td>11/23 ≈ 47.8%</td></tr><tr><td>4/23 ≈ 17.4%</td><td>11/23 ≈ 47.8%</td><td>9/23 ≈ 39.1%</td><td>10/23 ≈ 43.5%</td><td>7/23 ≈ 30.4%</td></tr><tr><td colspan="5">Average: 40.4%</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par37">To determine if the best performing model generalizes to unseen data, the full 23-patient training set was used to fit the weights and bias term, and the resulting model was applied to score a validation data set of 102 patients (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). The model correctly diagnoses 73 out of 102 patients, corresponding to an accuracy of 72% (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). The ROC curve for the validation data is shown in Fig. <xref rid="Fig3" ref-type="fig">3c</xref>. The area under the curve is 0.75.</p>
    </sec>
    <sec id="Sec8">
      <title>Analysis of the diagnostic biochemical motif</title>
      <p id="Par38">To discern the biochemical features of snippets resulting in a positive diagnosis, we examined the weights of the best performing model with parameters fit on the full 23-patient training set. The weights reveal how each Atchley factor contributes to the score and the relative importance of each position (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). We observe relatively large, negative weights along almost every position of the snippet for Atchley factors II and IV, indicating a high probability of an RRMS diagnosis for snippets with negative values for these two Atchley factors. In particular, we notice large negative weights for factor II for positions 1 and 5 and for factor IV for positions 1, 3, and 4. A negative value for Atchley factor II correlates with amino acid residues that appear frequently in α-helical segments. A negative value for Atchley factor IV correlates with amino acid residues less commonly used and having high heat capacity and refractivity. The weights for the other Atchley factors are position-dependent. We observe relatively large positive weights for Atchley factor I at position 1 and for Atchley factor V at position 3. We also observe relatively large negative weights for positions 1 and 3 for Atchley factor III. This indicates increased probability of an RRMS diagnosis for snippets with large, positively charged, hydrophilic residues at snippet positions 1 and 3.<fig id="Fig4"><label>Fig. 4</label><caption><p>Illustration of the Classifier Weights. For each of the five Atchley factors, the weights for the model fit on all 23 training samples are shown for the six residue positions. Positive weight values are shown in <italic>red</italic> pointing up, and negative weight values are shown in <italic>blue</italic> pointing down. The length of the <italic>arrow</italic> corresponds to the weight’s magnitude</p></caption><graphic xlink:href="12859_2017_1814_Fig4_HTML" id="MO4"/></fig>
</p>
      <p id="Par39">We next aligned the highest scoring snippet from each patient to determine where within CDR3 the diagnostic snippet is positioned (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). We find that the highest scoring snippets can be located anywhere along CDR3. Although the snippet sequences do not align well, patterns are observable in their Atchley factors, which are shown next to each snippet (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Consistent with the values for the weights, we observe a tendency toward hydrophilicty for snippet position 1, toward α-helical values at position 5, toward high heat capacity and refractivity at positions 1 through 4, and toward negative charge at position 6.<fig id="Fig5"><label>Fig. 5</label><caption><p>The Highest Scoring Snippet from each Patient in the Training Data Set. The snippets were scored with the model trained on all 23 subjects. (<italic>Left</italic>) Location of the snippet is shown in its CDR3 sequence using <italic>yellow highlighting</italic>. (Right) The Atchley factor values are shown for each snippet in the five <italic>boxes</italic>. Each <italic>box</italic> corresponds to one Atchley factor. The columns in each <italic>box</italic> correspond to the snippet positions</p></caption><graphic xlink:href="12859_2017_1814_Fig5_HTML" id="MO5"/></fig>
</p>
      <p id="Par40">We next looked at the distribution of snippet scores in the 23 patients of our training data set (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Only 27 of 3259 snippets score above 0.5 (the threshold for a RRMS diagnosis), and all of these were from RRMS patient repertoires. Each RRMS patient had no more than 5 snippets that scored above the threshold.<fig id="Fig6"><label>Fig. 6</label><caption><p>Histograms of Snippet Scores for all Snippets in the Training Data Set. The snippets were scored with the model trained on all 23 subjects. The <italic>red bars</italic> indicate the distribution of snippet scores from RRMS patients. The blue bars indicate the distribution of snippet scores from OND patients. Only a few snippets score above 0.5, which is diagnostic of RRMS</p></caption><graphic xlink:href="12859_2017_1814_Fig6_HTML" id="MO6"/></fig>
</p>
      <p id="Par41">To determine if the rarity of high scoring snippets in our patient repertoires can be attributed to the likelihood of the corresponding DNA sequences arising by chance in V(D)J recombination junctions, we examined the DNA encodings of each snippet. For each amino acid sequence, there are many possible DNA encodings. An example of how to calculate the total number of encodings for a single snippet is shown in Fig. <xref rid="Fig7" ref-type="fig">7a</xref>. The distribution for the total number of ways to encode each snippet is shown for non-diagnostic snippets in Fig. <xref rid="Fig7" ref-type="fig">7b</xref> and for diagnostic snippets in Fig. <xref rid="Fig7" ref-type="fig">7c</xref>. We find that the diagnostic snippets identified by the model have significantly fewer possible encodings than non-diagnostic snippets (<italic>p</italic>-value is 7.41 × 10<sup>−8</sup>). Under the naïve assumption that CDR3 sequence is generated at random, RRMS diagnostic snippets would be some of the least likely to occur.<fig id="Fig7"><label>Fig. 7</label><caption><p>Encoding Degeneracy of Diagnostic and Non-diagnostic Snippets in the Training Data Set. (<bold>a</bold>) An example of how to calculate the number of ways a snippet can be encoded. (<bold>b</bold>) The distribution of the number of encodings for each non-diagnostic snippet. (<bold>c</bold>) The distribution of the number of encodings for each diagnostic snippet</p></caption><graphic xlink:href="12859_2017_1814_Fig7_HTML" id="MO7"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par42">High-throughput sequencing of immune repertoires now enables their detailed characterization, driving interest in utilizing repertoires in clinical applications, including diagnosing and prognosticating diseases (e.g.<italic>,</italic> [<xref ref-type="bibr" rid="CR12">12</xref>]). Attempts to date have taken the approach of computing repertoire-level summary statistics, such as gene segment usage statistics, repertoire diversity, and clonality, and looking for differences in these statistics between two sets of repertoires (e.g.<italic>,</italic> cases and controls) [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. This approach captures important features of a repertoire as a whole, and it can give insight into the biological processes underlying repertoire differences, such as whether there is clonal expansion or recruitment of new cells. On the other hand, this approach ignores the vast amount of information available in the individual immune receptor sequences, in particular, information about the encoded antigen binding specificities.</p>
    <p id="Par43">We present here a new approach that allows application of standard machine learning techniques to mine the full set of repertoire sequences for sequence patterns that distinguish one group of repertoires from the other. There are two key features of our approach. The first is that we capture all k-mers from all CDR3s in a repertoire and represent them as biochemical features using Atchley factors. The second is that we score all k-mers in a repertoire and then aggregate the set of scores to predict a label for the whole repertoire.</p>
    <p id="Par44">We have focused on the CDR3 portion of immune receptor sequences, because it is the somatically generated portion of the gene and the primary determinant of the antigen binding specificity encoded by the gene. The approach could be readily applied, however, to other parts of the gene, and even to the full sequence. The longer the sequence used, however, the more training data would be required to accommodate the corresponding increase in the number of model parameters.</p>
    <p id="Par45">To accommodate variation in CDR3 length, we represent each CDR3 sequence as a set of overlapping k-mers of a specified length. For example, a CDR3 of eight amino acids in length would be represented as three 6-mers. In our MS application, we used k-mers varying from four to seven amino acids and found that the highest classification accuracy was achieved with 6-mers (Table <xref rid="Tab2" ref-type="table">2</xref>). Some CDR3s in our data sets are only six amino acids in length and are thus excluded from analysis when longer k-mers are used. Shorter k-mers, on the other hand, are more likely to appear in both MS and OND repertoires and are therefore not useful for discrimination.</p>
    <p id="Par46">We hypothesized that using a biochemical representation of amino acid k-mers would be beneficial, because such a representation captures sequence features related to receptor-antigen binding, and therefore related to the receptor’s function. Additionally, immune receptors with distinct amino acid sequences that bind to the same antigen would be expected to have similar biochemical properties. Indeed, we found that, for a fixed k-mer length of six amino acids, the biochemical representation resulted in higher classification accuracy than either an amino acid or DNA sequence representation (Table <xref rid="Tab2" ref-type="table">2</xref>).</p>
    <p id="Par47">To aggregate the scores from all k-mers in a repertoire to a repertoire-level label, we took the maximum score based on the assumption that, among all receptors in a repertoire, those participating in the phenotype-related immune response may be rare. Thus, we wanted a function that would flag a positive diagnosis even for a single high-scoring snippet. The maximum score is a special case of the generalized mean, however, and other means, or even other functions, could be used to accommodate different assumptions about the underlying immune response and its role in the phenotype.</p>
    <p id="Par48">Using this approach, we were able to mine the individual CDR3 sequences of OND and RRMS patient repertoires to discover a biochemical motif that correctly classifies repertoires according to diagnosis with accuracy of 87% on training data and 72% on validation data. Importantly, no prior knowledge of the disease was utilized (i.e.<italic>,</italic> it was not necessary to know which antigens the B cells may be responding to). Additionally, the method did not rely on finding “public clones”, as we removed all shared sequences to control for possible carry-over contamination, as described in Methods.</p>
    <p id="Par49">In the context of MS, a classification accuracy of 72% is highly significant. MS is an autoimmune disease that is difficult to diagnose. There are no single symptoms, physical findings, or laboratory tests that provide a definitive MS diagnosis [<xref ref-type="bibr" rid="CR13">13</xref>]. The current method of diagnosis relies on the 2010 revisions to the McDonald criteria and requires demonstration of dissemination of central nervous system lesions in both space and time, along with the exclusion of other diagnoses [<xref ref-type="bibr" rid="CR8">8</xref>]. Currently, the most widely used piece of paraclinical evidence for MS diagnosis is magnetic resonance imaging (MRI). Therefore, the accuracy obtained using MRI to distinguish patients with MS from those with OND is the most appropriate direct comparison for our 72% accuracy. We know of one study based on the most recent MRI criteria making this assessment. An accuracy of 57% was observed for distinguishing MS from primary and secondary central nervous system vasculitis, lupus, and Sjogren’s syndrome [<xref ref-type="bibr" rid="CR14">14</xref>]. In this context, a classification accuracy of 72% is highly significant.</p>
    <p id="Par50">Overfitting is a common concern with machine learning approaches and is usually addressed by regularization. To determine if the use of regularization could have improved our model’s performance on unseen data, we re-ran our procedure using early stopping, L1/L2 regularization, and bagging. The results are presented in supplementary materials (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Only early stopping led to better performance. The classification accuracy by one-holdout cross-validation was 20 out of 23. The classification accuracy on the validation data set was 75 out of 102 (this is an improvement with two additional patients being correctly diagnosed). Because we had already un-blinded ourselves to our validation data set prior to applying these regularization techniques, we include these results only as supplementary material and not as the primary result reported in the paper.</p>
    <p id="Par51">The simple model presented here represents a first step in developing a new family of methods for applying machine learning to immune receptor sequences and is not without limitations. First, under the assumption that CDR3 sequences are generated at random during V(D)J recombination, and in the absence of negative selection against particular sequences, every possible snippet would be expected to appear in a sufficiently large repertoire. In this case, the mere presence of individual high-scoring snippets would not be sufficient to differentiate patients by their diagnosis, and more sophisticated aggregation functions would be needed. Second, our approach is designed to work for phenotypes for which the underlying adaptive immune response is driven by a restricted set of antigens that is common across patients. Thus, the approach may not be directly applicable to other immune response types, such as those against cancer neoantigens. Finally, while the approach is designed to be applicable to both BCR and T cell receptor (TCR) CDR3 sequences, the restriction on TCR to recognize antigen in the context of major histocompatibility complex molecules may limit the utility of our approach when applied to TCR. Our future work will include improvements to the method designed to address these issues.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusion</title>
    <p id="Par52">Immune repertoire sequencing is a promising new technology for studying adaptive immune responses. The point of this study is to lay the groundwork for statistical classifiers of repertoire sequence data. The work presented here represents a first in combining maximum likelihood with a statistical model that maps a set of immune receptor sequences to a single diagnosis. Other published methods require that the repertoire first be reduced to a fixed number of features. The model represents an initial step in developing a new family of methods for analyzing immune repertoires. Without relying on disease-specific knowledge about MS, a classifier has been built using novel statistical methods to correctly diagnose a significant fraction of patients with either RRMS or OND. The work presented here is further demonstration that diseases can be diagnosed from a sample of a patient’s immune repertoire. In the future, we expect to improve the diagnostic accuracy of our approach and to broaden its use to other diseases.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <p id="Par53">The BCR heavy chain repertoires used in this study were collected in the context of other studies and shared with us upon request ([<xref ref-type="bibr" rid="CR7">7</xref>] and under review with <italic>Multiple Sclerosis Journal</italic>). The samples from each study are referred to by the year the study was completed (Table <xref rid="Tab1" ref-type="table">1</xref>). The repertoires were obtained as described in [<xref ref-type="bibr" rid="CR7">7</xref>]. Briefly, CSF was taken by lumbar puncture from patients diagnosed with either RRMS or OND. DNA was extracted from CSF cell pellets, and targeted PCR was conducted to amplify rearranged BCR genes. Because of the limited amount of DNA extracted from each CSF sample, the PCR amplification protocol has been designed and carefully implemented to minimize the impact of amplification bias and carry-over contamination between samples. DNA is first amplified using whole genome amplification followed by targeted PCR amplification of the variable region of BCR heavy chain genes utilizing a V gene segment from the VH4 family. VH4 sequences were targeted because previous studies found VH4 usage to be elevated in patients with RRMS [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Sequencing was conducted on the 454 platform. All tissue and patient data from both studies was handled in accordance with IRB-approved protocols.</p>
    <p id="Par54">The DNA sequences for each sample were processed to prepare them for analysis following recommendations in [<xref ref-type="bibr" rid="CR17">17</xref>]. Specifically, sequences with a length less than 300 base pairs or an average quality score less than 35 were removed. The regions of each sequence to which the PCR primers hybridize were trimmed, and duplicate sequences appearing within a single sample were counted and then collapsed to a single sequence. The remaining sequences were aligned to a database of germline gene segments for V, D, and J gene assignment. Sequences representing non-functional rearrangements were removed. Processing was performed using the pRESTO [<xref ref-type="bibr" rid="CR18">18</xref>], IgBlast [<xref ref-type="bibr" rid="CR19">19</xref>], and RepCalc pipelines on the VDJServer Immune Repertoire Analysis Portal (<ext-link ext-link-type="uri" xlink:href="http://www.vdjserver.org/">http://www.vdjserver.org</ext-link>).</p>
    <p id="Par55">For the sequences remaining after processing, the CDR3 nucleotide sequences were identified, according to the Immunogenetics Information System (<ext-link ext-link-type="uri" xlink:href="http://www.imgt.org">http://www.imgt.org</ext-link>) definitions. CDR3 sequences containing ambiguous base calls were removed, and the remaining sequences were compared across samples to identify potential carry-over contamination. The amount observed was in line with other studies [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Sequences observed in more than one sample were removed. The remaining CDR3 sequences were used as input to develop the statistical classifier as described above.</p>
    <p id="Par56">Model development was implemented in TensorFlow, an open source machine learning package published by Google [<xref ref-type="bibr" rid="CR22">22</xref>]. The data is represented as a 3-dimensional tensor of the form [Patient, Snippet, Atchley Factors]. The Atchley factors for each snippet are scored using TensorFlow functions for logistic modelling. The output is a tensor with a shape of [Patient, Score]. For each patient, the maximum score is used to represent their diagnosis. Taking the maximum score produces a new 1-dimensional tensor with a shape of [Probability]. Model parameters are fitted using gradient optimizers included with TensorFlow. Our project’s source code is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/jostmey/MaxSnippetModel">https://github.com/jostmey/MaxSnippetModel</ext-link>​.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2017_1814_MOESM1_ESM.docx">
            <label>Additional file 1: Figure. S1.</label>
            <caption>
              <p>Plot of the logistic function used as part of the detector function to convert the logit value to a score between 0 and 1. (DOCX 50 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2017_1814_MOESM2_ESM.docx">
            <label>Additional file 2:</label>
            <caption>
              <p>This document describes the results of applying four different approaches for mitigating overfitting. (DOCX 94 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BCR</term>
        <def>
          <p id="Par4">B cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>CDR3</term>
        <def>
          <p id="Par5">complementarity determining region 3</p>
        </def>
      </def-item>
      <def-item>
        <term>CSF</term>
        <def>
          <p id="Par6">Cerebrospinal fluid</p>
        </def>
      </def-item>
      <def-item>
        <term>D</term>
        <def>
          <p id="Par7">Diversity gene segment</p>
        </def>
      </def-item>
      <def-item>
        <term>HER2</term>
        <def>
          <p id="Par8">Human epidermal growth factor receptor 2</p>
        </def>
      </def-item>
      <def-item>
        <term>IGHV4</term>
        <def>
          <p id="Par9">heavy chain rearrangements utilizing a V gene segment from the VH4 family</p>
        </def>
      </def-item>
      <def-item>
        <term>IRB</term>
        <def>
          <p id="Par10">Institutional review board</p>
        </def>
      </def-item>
      <def-item>
        <term>J</term>
        <def>
          <p id="Par11">Joining gene segment</p>
        </def>
      </def-item>
      <def-item>
        <term>MRI</term>
        <def>
          <p id="Par12">Magnetic resonance imaging</p>
        </def>
      </def-item>
      <def-item>
        <term>MS</term>
        <def>
          <p id="Par13">Multiple Sclerosis</p>
        </def>
      </def-item>
      <def-item>
        <term>OND</term>
        <def>
          <p id="Par14">Other neurological disease</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR</term>
        <def>
          <p id="Par15">Polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par16">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>RRMS</term>
        <def>
          <p id="Par17">Relapsing Remitting Multiple Sclerosis</p>
        </def>
      </def-item>
      <def-item>
        <term>TCR</term>
        <def>
          <p id="Par18">T cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>V</term>
        <def>
          <p id="Par19">Variable gene segment</p>
        </def>
      </def-item>
      <def-item>
        <term>VH4</term>
        <def>
          <p id="Par20">Family 4 of V gene segments of the heavy chain locus</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s12859-017-1814-6) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>None.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par57">This project was supported by a Burroughs Welcome Fund Career Award and an NIAID-funded R01 (AI097403) to LGC. JO’s contributions were supported by a training grant to the Simmons Comprehensive Cancer Center at UT Southwestern from the Cancer Prevention and Research Institute of Texas (RP160157).</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par58">The source code for implementing our method is available here <ext-link ext-link-type="uri" xlink:href="https://github.com/jostmey/MaxSnippetModel">https://github.com/jostmey/MaxSnippetModel</ext-link>​. The data were collected under separate studies and can be requested by contacting Nancy Monson at nancy.monson@utsouthwestern.edu.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>BG and NM provided the antibody repertoire sequences from previous studies comparing patients with Relapsing Remitting Multiple Sclerosis to patients with other neurological diseases. WR designed the procedures for pre-processing the repertoire sequences. LGC conceived the study and proposed developing a statistical classifier for diagnosing RRMS patients from repertoire data. JO designed, implemented, trained, and validated the statistical classifier. SC proposed important improvements to the fitting procedure. IT participated in group discussions geared to refining the approach. JO and LGC wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par59">Data were collected under protocols approved by the UT Southwestern Institutional Review Board. The patients provided informed consent.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p id="Par60">Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p id="Par61">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p id="Par62">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of the interindividual conservation of T cell receptor alpha- and beta-chain variable regions gene in the peripheral blood of patients with systemic lupus erythematosus</article-title>
        <source>Clin Exp Immunol</source>
        <year>2008</year>
        <volume>154</volume>
        <issue>3</issue>
        <fpage>316</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2249.2008.03770.x</pub-id>
        <?supplied-pmid 18811695?>
        <pub-id pub-id-type="pmid">18811695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cameron</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Potential of a unique antibody gene signature to predict conversion to clinically definite multiple sclerosis</article-title>
        <source>J Neuroimmunol</source>
        <year>2009</year>
        <volume>213</volume>
        <issue>1–2</issue>
        <fpage>123</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneuroim.2009.05.014</pub-id>
        <?supplied-pmid 19631394?>
        <pub-id pub-id-type="pmid">19631394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marrero</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hamm</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>High-throughput sequencing of islet-infiltrating memory CD4+ T cells reveals a similar pattern of TCR Vbeta usage in prediabetic and diabetic NOD mice</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>10</issue>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0076546</pub-id>
        <?supplied-pmid 24146886?>
        <pub-id pub-id-type="pmid">24146886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iglesia</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prognostic B-cell signatures using mRNA-seq in patients with subtype-specific breast and ovarian cancer</article-title>
        <source>Clin Cancer Res</source>
        <year>2014</year>
        <volume>20</volume>
        <issue>14</issue>
        <fpage>3818</fpage>
        <lpage>3829</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-13-3368</pub-id>
        <?supplied-pmid 24916698?>
        <pub-id pub-id-type="pmid">24916698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity index of mucosal resident T lymphocyte repertoire predicts clinical prognosis in gastric cancer</article-title>
        <source>Oncoimmunology</source>
        <year>2015</year>
        <volume>4</volume>
        <issue>4</issue>
        <pub-id pub-id-type="doi">10.1080/2162402X.2014.1001230</pub-id>
        <?supplied-pmid 26137399?>
        <pub-id pub-id-type="pmid">26137399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Postow</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peripheral T cell receptor diversity is associated with clinical outcomes following ipilimumab treatment in metastatic melanoma</article-title>
        <source>J Immunother Cancer</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.1186/s40425-015-0070-4</pub-id>
        <?supplied-pmid 26085931?>
        <pub-id pub-id-type="pmid">26085931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rounds</surname>
            <given-names>WH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MSPrecise: a molecular diagnostic test for multiple sclerosis using next generation sequencing</article-title>
        <source>Gene</source>
        <year>2015</year>
        <volume>572</volume>
        <issue>2</issue>
        <fpage>191</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gene.2015.07.011</pub-id>
        <?supplied-pmid 26172868?>
        <pub-id pub-id-type="pmid">26172868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polman</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diagnostic criteria for multiple sclerosis: 2010 revisions to the McDonald criteria</article-title>
        <source>Ann Neurol</source>
        <year>2011</year>
        <volume>69</volume>
        <issue>2</issue>
        <fpage>292</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.22366</pub-id>
        <?supplied-pmid 21387374?>
        <pub-id pub-id-type="pmid">21387374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frohman</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Most patients with multiple sclerosis or a clinically isolated demyelinating syndrome should be treated at the time of diagnosis</article-title>
        <source>Arch Neurol</source>
        <year>2006</year>
        <volume>63</volume>
        <issue>4</issue>
        <fpage>614</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="doi">10.1001/archneur.63.4.614</pub-id>
        <?supplied-pmid 16606781?>
        <pub-id pub-id-type="pmid">16606781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Atchley</surname>
            <given-names>WR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Solving the protein sequence metric problem</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>18</issue>
        <fpage>6395</fpage>
        <lpage>6400</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0408677102</pub-id>
        <?supplied-pmid 15851683?>
        <pub-id pub-id-type="pmid">15851683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kingma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ba</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Adam: A method for stochastic optimization arXiv preprint arXiv</source>
        <year>2014</year>
        <volume>1412</volume>
        <fpage>6980</fpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Sequencing the functional antibody repertoire--diagnostic and therapeutic discovery</article-title>
        <source>Nat Rev Rheumatol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>171</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="doi">10.1038/nrrheum.2014.220</pub-id>
        <?supplied-pmid 25536486?>
        <pub-id pub-id-type="pmid">25536486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Milo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Revised diagnostic criteria of multiple sclerosis</article-title>
        <source>Autoimmun Rev</source>
        <year>2014</year>
        <volume>13</volume>
        <issue>4–5</issue>
        <fpage>518</fpage>
        <lpage>524</lpage>
        <pub-id pub-id-type="doi">10.1016/j.autrev.2014.01.012</pub-id>
        <?supplied-pmid 24424194?>
        <pub-id pub-id-type="pmid">24424194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>SS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Limited utility of current MRI criteria for distinguishing multiple sclerosis from common mimickers: primary and secondary CNS vasculitis, lupus and Sjogren's syndrome</article-title>
        <source>Mult Scler</source>
        <year>2014</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1177/1352458513491329</pub-id>
        <?supplied-pmid 23736535?>
        <pub-id pub-id-type="pmid">23736535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owens</surname>
            <given-names>GP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VH4 Gene segments dominate the intrathecal humoral immune response in multiple sclerosis</article-title>
        <source>J Immunol</source>
        <year>2007</year>
        <volume>179</volume>
        <issue>9</issue>
        <fpage>6343</fpage>
        <lpage>6351</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.179.9.6343</pub-id>
        <?supplied-pmid 17947712?>
        <pub-id pub-id-type="pmid">17947712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennett</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CSF IgG heavy-chain bias in patients at the time of a clinically isolated syndrome</article-title>
        <source>J Neuroimmunol</source>
        <year>2008</year>
        <volume>199</volume>
        <issue>1–2</issue>
        <fpage>126</fpage>
        <lpage>132</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneuroim.2008.04.031</pub-id>
        <?supplied-pmid 18547652?>
        <pub-id pub-id-type="pmid">18547652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yaari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kleinstein</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Practical guidelines for B-cell receptor repertoire sequencing analysis</article-title>
        <source>Genome Med</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>121</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-015-0243-2</pub-id>
        <?supplied-pmid 26589402?>
        <pub-id pub-id-type="pmid">26589402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Vander Heiden</collab>
        </person-group>
        <article-title>J.A., et al., pRESTO: a toolkit for processing high-throughput sequencing raw reads of lymphocyte receptor repertoires</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>13</issue>
        <fpage>1930</fpage>
        <lpage>1932</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu138</pub-id>
        <?supplied-pmid 24618469?>
        <pub-id pub-id-type="pmid">24618469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>Web Server issue</issue>
        <fpage>W34</fpage>
        <lpage>W40</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt382</pub-id>
        <?supplied-pmid 23671333?>
        <pub-id pub-id-type="pmid">23671333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quail</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SASI-Seq: sample assurance spike-ins, and highly differentiating 384 barcoding for Illumina sequencing</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>110</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-110</pub-id>
        <?supplied-pmid 24507442?>
        <pub-id pub-id-type="pmid">24507442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seitz</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A new method to prevent carry-over contaminations in two-step PCR NGS library preparations</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>20</issue>
        <fpage>e135</fpage>
        <?supplied-pmid 26152304?>
        <pub-id pub-id-type="pmid">26152304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Tensorflow: Large-scale machine learning on heterogeneous distributed systems arXiv preprint arXiv</source>
        <year>2016</year>
        <volume>1603</volume>
        <fpage>04467</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
