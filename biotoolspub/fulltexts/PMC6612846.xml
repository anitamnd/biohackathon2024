<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612846</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz329</article-id>
    <article-id pub-id-type="publisher-id">btz329</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genomic Variation Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Integrating read-based and population-based phasing for dense and accurate haplotyping of individual genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bansal</surname>
          <given-names>Vikas</given-names>
        </name>
        <xref ref-type="corresp" rid="btz329-cor1"/>
        <!--<email>vibansal@ucsd.edu</email>-->
        <xref ref-type="aff" rid="btz329-aff1"/>
      </contrib>
    </contrib-group>
    <aff id="btz329-aff1">Department of Pediatrics, School of Medicine, University of California, San Diego, La Jolla, CA, USA</aff>
    <author-notes>
      <corresp id="btz329-cor1">To whom correspondence should be addressed. <email>vibansal@ucsd.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i242</fpage>
    <lpage>i248</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz329.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Reconstruction of haplotypes for human genomes is an important problem in medical and population genetics. Hi-C sequencing generates read pairs with long-range haplotype information that can be computationally assembled to generate chromosome-spanning haplotypes. However, the haplotypes have limited completeness and low accuracy. Haplotype information from population reference panels can potentially be used to improve the completeness and accuracy of Hi-C haplotyping.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>In this paper, we describe a likelihood based method to integrate short-range haplotype information from a population reference panel of haplotypes with the long-range haplotype information present in sequence reads from methods such as Hi-C to assemble dense and highly accurate haplotypes for individual genomes. Our method leverages a statistical phasing method and a maximum spanning tree algorithm to determine the optimal second-order approximation of the population-based haplotype likelihood for an individual genome. The population-based likelihood is encoded using pseudo-reads which are then used as input along with sequence reads for haplotype assembly using an existing tool, HapCUT2. Using whole-genome Hi-C data for two human genomes (NA19240 and NA12878), we demonstrate that this integrated phasing method enables the phasing of 97–98% of variants, reduces the switch error rates by 3–6-fold, and outperforms an existing method for combining phase information from sequence reads with population-based phasing. On Strand-seq data for NA12878, our method improves the haplotype completeness from 71.4 to 94.6% and reduces the switch error rate 2-fold, demonstrating its utility for phasing using multiple sequencing technologies.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Code and datasets are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/vibansal/IntegratedPhasing">https://github.com/vibansal/IntegratedPhasing</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Humans are diploid and haplotype phasing—determination of the sequence of alleles at variant sites on homologous chromosomes—is an important problem in human genomics. Haplotype information is crucial for a number of analyses including identification of genetic variants associated with disease (e.g. compound heterozygotes), detection of IBD (Identity by Descent) segments and genotype imputation (<xref rid="btz329-B28" ref-type="bibr">Tewhey <italic>et al.</italic>, 2011</xref>). Haplotypes are not directly observed from genotyping or short-read sequencing but can be inferred either directly (using long sequence reads for an individual genome) or indirectly (using a reference panel of haplotypes). A number of algorithms and statistical methods have been developed for haplotype inference from genotype data (<xref rid="btz329-B5" ref-type="bibr">Browning and Browning, 2011</xref>). Nevertheless, population-based phasing is limited in accuracy for rare variants and in regions with high haplotype diversity in the human genome.</p>
    <p>Read-based haplotype phasing is a direct approach for phasing individual genomes and there is increasing interest in haplotype-resolved whole-genome sequencing (<xref rid="btz329-B27" ref-type="bibr">Snyder <italic>et al.</italic>, 2015</xref>). Read-based phasing is feasible using long reads such as those generated using single molecule sequencing technologies such as Pacific Biosciences (<xref rid="btz329-B21" ref-type="bibr">Pendleton <italic>et al.</italic>, 2015</xref>). Sequence reads that cover multiple variants provide partial haplotype information and can be assembled into longer haplotypes using computational methods (<xref rid="btz329-B18" ref-type="bibr">Levy <italic>et al.</italic>, 2007</xref>). To address the computational problem of haplotype assembly, a number of combinatorial and statistical algorithms (<xref rid="btz329-B1" ref-type="bibr">Aguiar and Istrail, 2012</xref>; <xref rid="btz329-B3" ref-type="bibr">Bansal and Bafna, 2008</xref>; <xref rid="btz329-B10" ref-type="bibr">Duitama <italic>et al.</italic>, 2010</xref>; <xref rid="btz329-B16" ref-type="bibr">Kuleshov, 2014</xref>) have been developed. At the same time, a number of methods that encode long-range haplotype information in short reads and generate virtual long reads have been developed (<xref rid="btz329-B11" ref-type="bibr">Duitama <italic>et al.</italic>, 2012</xref>; <xref rid="btz329-B15" ref-type="bibr">Kitzman <italic>et al.</italic>, 2011</xref>; <xref rid="btz329-B17" ref-type="bibr">Kuleshov <italic>et al.</italic>, 2014</xref>; <xref rid="btz329-B22" ref-type="bibr">Peters <italic>et al.</italic>, 2012</xref>).</p>
    <p>Haplotype assembly is also feasible with paired-end sequencing—pairs of short reads derived from the ends of DNA fragments—but requires long and variable insert lengths to assemble long haplotypes. Hi-C sequencing generates paired-end reads with insert sizes ranging from a few hundred bases to tens of megabases. <xref rid="btz329-B26" ref-type="bibr">Selvaraj <italic>et al.</italic> (2013)</xref> exploited this property of Hi-C reads to assemble accurate haplotypes for NA12878 using ∼18 × Illumina whole-genome sequencing. In contrast to haplotyping using long reads which generates 10–100s of disjoint haplotype segments per chromosome, more than 90% of variants phased using Hi-C are connected in a single chromosome-spanning block. Although Hi-C based haplotypes span entire chromosomes, the completeness of the haplotypes is rather low [only 18–22% of the variants per chromosome could be phased using the Hi-C reads (<xref rid="btz329-B26" ref-type="bibr">Selvaraj <italic>et al.</italic>, 2013</xref>)]. A second limitation is the relatively low accuracy [switch error rate of 1–2% compared to other methods (<xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic>, 2017</xref>)]. The low resolution of Hi-C haplotypes is due to non-uniformity in sequence coverage resulting from the use a DNA restriction enzyme in the Hi-C library preparation protocol. Recently, <xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic> (2017)</xref> showed using Hi-C data generated using the MboI restriction enzyme can be used to assemble haplotypes with 65% completeness compared to ∼20% completeness using the <italic>Hin</italic>dIII enzyme.</p>
    <p>Hi-C sequencing leverages the Illumina technology and does not require specialized equipment unlike other sequencing-based haplotyping methods such as 10X Linked-reads (<xref rid="btz329-B29" ref-type="bibr">Zheng <italic>et al.</italic>, 2016</xref>). Therefore, improving the completeness and accuracy of Hi-C haplotyping can enhance the use of this approach for phasing human genomes. Similar to Hi-C-based haplotyping, the Strand-seq single-cell sequencing method also generates sparse chromosome-spanning haplotypes (<xref rid="btz329-B23" ref-type="bibr">Porubsky <italic>et al.</italic>, 2016</xref>). Another singe-cell based haplotyping method, SISSOR, also generates highly accurate haplotypes but with 70% resolution (<xref rid="btz329-B7" ref-type="bibr">Chu <italic>et al.</italic>, 2017</xref>). One avenue for improving accuracy and completeness is to combine sequence data from multiple technologies. <xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic> (2017)</xref> combined Hi-C data with 10X Linked-read data to assemble haplotypes with very high resolution and low switch error rates. Similarly, <xref rid="btz329-B24" ref-type="bibr">Porubsky <italic>et al.</italic> (2017)</xref> showed that combining Strand-seq haplotypes with long-read sequence information enables the reconstruction of dense, chromosome-spanning haplotypes. <xref rid="btz329-B4" ref-type="bibr">Ben-Elazar <italic>et al.</italic> (2016)</xref> described a novel algorithmic framework to combine short-range haplotypes with Hi-C reads for phasing. Nevertheless, all of these methods requires sequencing using two or more technologies, and may not be feasible for all genomes.</p>
    <p>An alternative approach that does not require additional sequencing is to leverage haplotype information from population reference panels to complement haplotype information of sequence reads. <xref rid="btz329-B26" ref-type="bibr">Selvaraj <italic>et al.</italic> (2013)</xref> combined Hi-C haplotypes with statistical phasing to improve the completeness of haplotypes to ∼81%. <xref rid="btz329-B17" ref-type="bibr">Kuleshov <italic>et al.</italic> (2014)</xref> developed a statistical method to combine read-based haplotype information with population phase information to improve the contiguity of haplotypes from long reads. Similarly, <xref rid="btz329-B9" ref-type="bibr">Delaneau <italic>et al.</italic> (2013)</xref> extended their statistical phasing method (SHAPEIT2) to incorporate haplotype information from sequence reads. They demonstrated that this reduced the switch error rate, particularly for rare variants. However, it is not clear if the Markov model underlying this method can incorporate the long-range haplotype information present in Hi-C reads.</p>
    <p>In this paper, we describe a new likelihood based method that integrates long-range haplotype information from sequence reads with short-range haplotype information from population reference panels to dramatically improve the accuracy and completeness of haplotyping human genomes using methods such as Hi-C. Our approach leverages the existing likelihood based method HapCUT2 for read-based haplotype phasing. To incorporate population haplotype information, we use the statistical phasing method SHAPEIT2 to sample haplotypes consistent with the individual’s genotypes and approximate the population haplotype likelihood as a product of second-order distributions. Subsequently, pseudo-reads are used to encode the approximate population likelihood and used as input along with sequence reads for phasing using HapCUT2 (<xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic>, 2017</xref>).</p>
    <p>We have used this integrative phasing method to investigate the improvement in completeness and accuracy of Hi-C haplotyping using whole-genome sequence data for two different individuals from the 1000 Genomes Project: NA19240 (YRI population) and NA12878 (CEU population). For both these genomes, we demonstrate that our method improves the completeness of haplotypes [&gt;98% single nucleotide variants (SNVs) phased] and reduces the switch error rate by 3–6-fold. We also show that a recent multi-enzyme Hi-C protocol enables the phasing of ∼86.7% of SNVs using Illumina whole-genome sequencing with 36× coverage. In addition, we use whole-genome Strand-seq data to show that our integrated phasing method can improve the completeness and accuracy of haplotyping for any sparse sequencing method.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Comparison of Hi-C haplotypes to high-confidence haplotypes (for the NA12878 genome) shows that the vast majority of errors are local errors where a single variant or a small block of variants is incorrectly phased with respect to the chromosome-spanning haplotype block (<xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic>, 2017</xref>). Given an individual’s genotypes, one can infer haplotypes using information from a population reference panel (<xref rid="btz329-B9" ref-type="bibr">Delaneau <italic>et al.</italic>, 2013</xref>). These population-based haplotypes are highly accurate in short blocks (30–100 kb) and provide haplotype information that is complementary to Hi-C sequence reads. Therefore, leveraging haplotype information from population reference panels has great potential to improve the completeness and accuracy of haplotyping using methods such as Hi-C (see <xref ref-type="fig" rid="btz329-F1">Fig. 1</xref> for an illustration). Since sequence reads contain errors (e.g. trans errors in Hi-C) and population-based haplotype information has ambiguity in regions with high population diversity, a probabilistic approach for combining the two sources of haplotype information is needed. Therefore, we consider a joint likelihood model for individual haplotyping that combines the two independent sources of haplotype information.
</p>
    <fig id="btz329-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Integrating haplotype information from Hi-C reads and population reference panels to improve accuracy and completeness of haplotyping. Haplotypes assembled using HapCUT2 from Hi-C reads have three unphased variants (2, 9 and 15) and an incorrectly phased variant (#6) with respect to the large haplotype block due to an erroneous Hi-C read (edge connecting variants 6 and 14). Haplotypes estimated using a population reference panel provide accurate short-range phase information. This information can be combined with the Hi-C reads to phase two of the three variants with no sequence information and also correct the phase for variant #6</p>
      </caption>
      <graphic xlink:href="btz329f1"/>
    </fig>
    <sec>
      <title>2.1 Joint likelihood model for haplotyping</title>
      <p>We assume that the variants (and genotypes) to be phased are known in advance and only consider heterozygous variants for phasing. For read-based phasing or haplotype assembly, the objective is to find the most likely pair of haplotypes (<italic>H</italic> = (<italic>H</italic><sup>1</sup>, <italic>H</italic><sup>2</sup>)) for an individual genome given the genotypes <italic>G</italic>, aligned sequence reads <italic>R</italic> and the corresponding set of base error probabilities <italic>Q</italic> for the reads. In population-based phasing, the goal is to find the most likely pair of haplotypes given the genotypes and a reference panel of population haplotypes (<italic>H<sup>p</sup></italic>). A joint likelihood based formulation for haplotyping is:
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>We can assume that the reads for the individual are conditionally independent of the haplotypes for other individuals, given <italic>H</italic>. Under this assumption, it has previously been shown that the joint likelihood can be decomposed as a product of two terms (<xref rid="btz329-B9" ref-type="bibr">Delaneau <italic>et al.</italic>, 2013</xref>):
<disp-formula id="E2"><label>(1)</label><mml:math id="M2"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>H</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The <inline-formula id="IE1"><mml:math id="IM1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> term corresponds to the read-based likelihood and the <inline-formula id="IE2"><mml:math id="IM2"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> is the population-based likelihood of a pair of haplotypes <italic>H</italic> conditional on the reference panel of haplotypes. The read-based likelihood is simply a product of individual read likelihoods defined as:
<disp-formula id="E3"><mml:math id="M3"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∏</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE3"><mml:math id="IM3"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> can be calculated using the base error probabilities of the reads as follows:
<disp-formula id="E4"><label>(2)</label><mml:math id="M4"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi mathvariant="normal">δ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">δ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE5"><mml:math id="IM5"><mml:mi mathvariant="normal">δ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> if <italic>r<sub>j</sub></italic> = <italic>h<sub>j</sub></italic> and 0 otherwise, and the product is over all variants covered <italic>j</italic> by the read <italic>r</italic> (<xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic>, 2017</xref>).</p>
      <p>Unlike the read-based likelihood, there is no direct expression for the population-based likelihood<inline-formula id="IE6"><mml:math id="IM6"><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>. Different statistical phasing methods use different models for capturing the relationship between an individual’s haplotypes and the haplotypes in a population. SHAPEIT2, a state-of-the-art statistical phasing tool, uses a Markov model for modeling an individual’s haplotypes and utilizes an MCMC algorithm to sample from the posterior distribution of<inline-formula id="IE7"><mml:math id="IM7"><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>. We use the SHAPEIT2 algorithm to obtain haplotype samples from the probability distribution and use these samples to approximate the population haplotype likelihood using lower order distributions.</p>
    </sec>
    <sec>
      <title>2.2 Approximating population haplotype likelihood using second-order distributions</title>
      <p>We are given a sample of <italic>N</italic> haplotype pairs for <italic>n</italic> heterozygous variants for a single individual sampled from the probability distribution<inline-formula id="IE8"><mml:math id="IM8"><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>. Using these samples, it is difficult to estimate the full probability distribution since the number of potential haplotypes for an individual is exponential in <italic>n</italic> and much larger than <italic>N</italic>. Therefore, we approximate the probability distribution as a product of lower order distributions using the <italic>N</italic> samples. This allows us to calculate <inline-formula id="IE9"><mml:math id="IM9"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> for any haplotype pair <italic>H</italic> using a small number of samples. Since we are interested in obtaining short-range haplotype information from the population reference panel, this is a reasonable approximation. For example, given two variant sites <italic>x</italic> and <italic>y</italic>, there are only two possible phasings: (00, 11) and (01, 10). Let <inline-formula id="IE10"><mml:math id="IM10"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> be the haplotype allele at variant <italic>x</italic> in haplotype <italic>H</italic><sup>1</sup>. We can use the <italic>N</italic> samples to estimate <inline-formula id="IE11"><mml:math id="IM11"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> as follows:
<disp-formula id="E5"><mml:math id="M5"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE12"><mml:math id="IM12"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>00</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> is the count of the pair 00 in the <italic>N</italic> samples at sites <italic>x</italic> and <italic>y</italic>. This is also equal to the probability of the phase being (00, 11). Also, <inline-formula id="IE13"><mml:math id="IM13"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. We can approximate the full distribution as a product of <italic>n</italic> − 1 second-order distributions:
<disp-formula id="E6"><mml:math id="M6"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>≈</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE14"><mml:math id="IM14"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is a permutation of the <italic>n</italic> variants. The number of possible permutations is exponential in <italic>n</italic>, so how we do choose the permutation for approximating the probability distribution? <xref rid="btz329-B6" ref-type="bibr">Chow and Liu (1968)</xref> have shown that it is possible to select the second-order approximation that has the minimum Kullback–Leibler distance to the full distribution and hence is the best approximation in the information-theoretic sense. The Chow–Liu algorithm reduces the problem of finding the best permutation or the optimal second-order approximation to finding the maximum spanning tree of a weighted graph where the nodes of the graph correspond to the <italic>n</italic> variants and the weight of an edge (<italic>x</italic>, <italic>y</italic>) is equal to the mutual information between the two variants:
<disp-formula id="E7"><mml:math id="M7"><mml:mi>I</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>We can estimate <inline-formula id="IE15"><mml:math id="IM15"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> using the frequency of the pair <italic>H<sub>xy</sub></italic> in the <italic>N</italic> haplotype samples. Similarly, we can estimate <inline-formula id="IE16"><mml:math id="IM16"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> using the samples.</p>
    </sec>
    <sec>
      <title>2.3 Encoding the population haplotype likelihood using pseudo-reads</title>
      <p>Our objective is to find a haplotype pair that maximizes the product of the population-based haplotype likelihood <inline-formula id="IE18"><mml:math id="IM18"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> and read-based likelihood <inline-formula id="IE19"><mml:math id="IM19"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> [<xref ref-type="disp-formula" rid="E2">Equation (1)</xref>]. HapCUT2 (<xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic>, 2017</xref>) uses a graph-cut based iterative method to search for a pair of haplotypes that maximizes<inline-formula id="IE20"><mml:math id="IM20"><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. To incorporate the population haplotype likelihood into HapCUT2, we encode each individual term <inline-formula id="IE21"><mml:math id="IM21"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> in the second-order approximation of <inline-formula id="IE22"><mml:math id="IM22"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> as a pseudo-read <italic>r</italic> with alleles <italic>r<sub>x</sub></italic> and <italic>r<sub>y</sub></italic> and base error probabilities <italic>q<sub>x</sub></italic> and <italic>q<sub>y</sub></italic>. The allele and error probabilities are chosen such that <inline-formula id="IE23"><mml:math id="IM23"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> for any haplotype pair <italic>H</italic>. As a result, if we use these pseudo-reads as input to HapCUT2 along with the sequence reads, the likelihood function optimized by HapCUT2 is precisely equal to the product of the read-based likelihood and the second-order approximation of<inline-formula id="IE24"><mml:math id="IM24"><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
      <p>For this, we define <inline-formula id="IE25"><mml:math id="IM25"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>00</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> and<inline-formula id="IE26"><mml:math id="IM26"><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>01</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>00</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. We also define <inline-formula id="IE27"><mml:math id="IM27"><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn><mml:msqrt><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>00</mml:mn><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>01</mml:mn><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:msqrt></mml:math></inline-formula>. Then, the pseudo-read <italic>r</italic> that covers the two variants <italic>x</italic> and <italic>y</italic> is defined as:
<list list-type="bullet"><list-item><p>If<inline-formula id="IE28"><mml:math id="IM28"><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>00</mml:mn><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>01</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>: <italic>r<sub>x</sub></italic> = 0, <italic>r<sub>y</sub></italic> = 0, <inline-formula id="IE29"><mml:math id="IM29"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:math></inline-formula></p></list-item><list-item><p>else: <italic>r<sub>x</sub></italic> = 0, <italic>r<sub>y</sub></italic> = 1, <inline-formula id="IE30"><mml:math id="IM30"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:math></inline-formula>.</p></list-item></list></p>
    </sec>
    <sec>
      <title>2.4 Integrated phasing method</title>
      <p>Encoding the approximate population haplotype likelihood as pseudo-reads allows us to simply use these pseudo-reads along with the sequence reads as input to HapCUT2 for phasing. We use the Kruskal minimum spanning tree algorithm to find the optimal second-order approximation of the probability distribution. The full algorithm is outlined below:
<list list-type="order"><list-item><p>Given individual genotypes <italic>G</italic> and population reference panel <italic>H<sup>p</sup></italic>, sample <italic>N</italic> haplotype pairs using the SHAPEIT2 MCMC method.</p></list-item><list-item><p>For each pair of variants (<italic>x</italic>, <italic>y</italic>), calculate <inline-formula id="IE31"><mml:math id="IM31"><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> using the <italic>N</italic> samples.</p></list-item><list-item><p>Construct a weighted graph <italic>G</italic> with each variant as a node and the weight of the edge (<italic>x</italic>, <italic>y</italic>) = <italic>I</italic>(<italic>H<sub>x</sub></italic>, <italic>H<sub>y</sub></italic>).</p></list-item><list-item><p>Compute the maximum spanning tree of <italic>G.</italic></p></list-item><list-item><p>For each edge in the maximum spanning tree, generate a pseudo-read <italic>r.</italic></p></list-item><list-item><p>Run HapCUT2 with the sequence reads <italic>R</italic> and the pseudo-reads as input.</p></list-item></list></p>
      <p>In Step 1, we sample <italic>N</italic> <italic> </italic>= 1000 pairs of haplotypes. In Step 2, for a variant <italic>x</italic>, if we calculate <italic>I</italic>(<italic>H<sub>x</sub></italic>, <italic>H<sub>y</sub></italic>) for all other variants <italic>y</italic>, the complexity of the algorithm increases as<inline-formula id="IE32"><mml:math id="IM32"><mml:mo> </mml:mo><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>. To reduce the running time, we compute <italic>I</italic>(<italic>H<sub>x</sub></italic>, <italic>H<sub>y</sub></italic>) only for <italic>k</italic> variants to the left and right of <italic>x</italic> where the variants are ordered by their location. We considered different values of <italic>k</italic> (5–30) and found that using values of <italic>k</italic> larger than 10 did not change the Minimum Spanning Tree (MST) since for most variants, edges to neighboring variants were selected (data not shown). Therefore, we use <italic>k</italic> <italic> </italic>= 10 for phasing real data. We also remove all edges (<italic>x</italic>, <italic>y</italic>) from the graph for which <italic>q</italic> &lt; 0.8 since these low-confidence edges are not reliable for phasing.</p>
    </sec>
    <sec>
      <title>2.5 Measuring haplotyping accuracy</title>
      <p>The accuracy of the haplotypes was measured using the switch error rate metric (<xref rid="btz329-B11" ref-type="bibr">Duitama <italic>et al.</italic>, 2012</xref>; <xref rid="btz329-B13" ref-type="bibr">Edge <italic>et al.</italic>, 2017</xref>; <xref rid="btz329-B16" ref-type="bibr">Kuleshov, 2014</xref>). The switch error rate is defined as the fraction of adjacent phased variants for which the phase is incorrect. Two consecutive switch errors correspond to the flipping of the phase of a single variant and are counted separately as a single ‘mismatch’ or short switch error. To calculate the absolute error rate (or the Hamming error rate) of the haplotypes, we compute the hamming distance between the estimated and true haplotypes and divide it by the total number of phased variants.</p>
    </sec>
    <sec>
      <title>2.6 Datasets</title>
      <p>We evaluated our integrated phasing method using whole-genome Hi-C data for two individuals from the 1000 Genomes Project: NA19240 (YRI population) and NA12878 (CEU population). For NA19240, whole-genome Hi-C data generated by the 1000 Genomes SV project (<xref rid="btz329-B8" ref-type="bibr">Clarke <italic>et al.</italic>, 2017</xref>) for this individual was downloaded from SRA (project PRJEB11418, accessions ERX1299696-701) and aligned to the hg19 reference human genome sequence using BWA-MEM (option -SP5M). PCR duplicates were marked using the Picard tool (<ext-link ext-link-type="uri" xlink:href="https://broadinstitute.github.io/picard/">https://broadinstitute.github.io/picard/</ext-link>). The raw data contained 467 million read pairs with reads of length 100 bp. SNV calls from the 1000 Genomes Project were used for phasing and trio-based haplotypes were used for assessing accuracy for these data.</p>
      <p>For the NA12878 genome, we utilized Hi-C datasets generated using two different protocols: (i) a multi-enzyme protocol developed by Arima Genomics (<xref rid="btz329-B14" ref-type="bibr">Ghurye <italic>et al.</italic>, 2019</xref>) and (ii) MboI restriction enzyme based protocol (<xref rid="btz329-B25" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>). The Arima Hi-C dataset for NA12878 was downloaded from SRA (accession SRR6675327) and processed using the same pipeline as used for the NA19240 data. The read length for this dataset was 150 bp and the average depth of coverage was 36×. Similarly, reads for the MboI Hi-C data (<xref rid="btz329-B25" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>) (read length equal to 101 bp) were aligned to the reference genome using BWA-MEM and the aligned reads were down-sampled to match the coverage of the Arima Hi-C dataset. SNV calls generated using an independent Illumina WGS dataset (30× coverage) from the GIAB project (<xref rid="btz329-B30" ref-type="bibr">Zook <italic>et al.</italic>, 2016</xref>) were used for phasing and high quality phased haplotypes from the Platinum Genomes Project (<xref rid="btz329-B12" ref-type="bibr">Eberle <italic>et al.</italic>, 2017</xref>) were used for assessing the accuracy of phasing.</p>
      <p>In addition, we also leveraged whole-genome Strand-seq data (<xref rid="btz329-B23" ref-type="bibr">Porubsky <italic>et al.</italic>, 2016</xref>) for NA12878 for analysis. Aligned Strand-seq reads for 133 cells generated by <xref rid="btz329-B24" ref-type="bibr">Porubsky <italic>et al.</italic> (2017)</xref> were downloaded from Zenodo (doi: 10.5281/zenodo.830278) and two haplotype fragments were generated for each cell using the list of WC regions identified previously by <xref rid="btz329-B23" ref-type="bibr">Porubsky <italic>et al.</italic> (2016)</xref>. This was done using the extractHAIRS module of HapCUT2 and a custom script.</p>
      <p>The 1000 Genomes reference panel (<xref rid="btz329-B2" ref-type="bibr">Auton <italic>et al.</italic>, 2015</xref>) (2504 individuals from 25 different populations) was used to estimate haplotypes for each genome using SHAPEIT2 and also to sample haplotype pairs. Since the NA12878 (CEU population) and NA19240 (YRI population) genomes are part of the 1000 Genomes panel, we excluded all individuals from the CEU and YRI populations in the reference panel to avoid any bias. For all datasets, only heterozygous SNVs were considered for phasing. HapCUT2 was run with default parameters. For processing Hi-C datasets, the option ‘−hic 1’ was used.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Accurate haplotyping using Hi-C data for NA19240</title>
      <p>First, we applied the integrated phasing method to whole-genome Hi-C data for NA19240. Using the Hi-C reads, 51.3% of the 50 763 SNVs (with heterozygous genotype) on chromosome 20 could be phased and the largest haplotype block contained 19.9% of the SNVs. Using the integrated phasing algorithm, 48 135 pseudo-reads were included for phasing along with the Hi-C reads. The resulting haplotypes covered 97.32% of the SNVs with 96.47% of the SNVs in the largest haplotype block. The haplotypes had very high accuracy with a switch error rate of 0.034% and a mismatch error rate equal to 0.266% (<xref rid="btz329-T1" ref-type="table">Table 1</xref>). Furthermore, the absolute error rate of the Hi-C haplotypes was 0.31% demonstrating that almost all of the errors were local (due to the incorrect phasing of a few variants relative to the chromosome spanning haplotype block).</p>
      <table-wrap id="btz329-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Comparison of the phasing completeness and accuracy on whole-genome Hi-C data for NA19240</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">SNVs phased (%)</th>
              <th rowspan="1" colspan="1">Absolute error rate (%)</th>
              <th rowspan="1" colspan="1">Switch error rate (%)</th>
              <th rowspan="1" colspan="1">Mismatch rate (%)</th>
              <th rowspan="1" colspan="1">Run time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reads only</td>
              <td rowspan="1" colspan="1">51.30</td>
              <td rowspan="1" colspan="1">0.49</td>
              <td rowspan="1" colspan="1">0.20</td>
              <td rowspan="1" colspan="1">0.365</td>
              <td rowspan="1" colspan="1">02:43</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Integrated phasing</td>
              <td rowspan="1" colspan="1">97.32</td>
              <td rowspan="1" colspan="1">0.31</td>
              <td rowspan="1" colspan="1">0.034</td>
              <td rowspan="1" colspan="1">0.266</td>
              <td rowspan="1" colspan="1">08:57</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SHAPEIT2</td>
              <td rowspan="1" colspan="1">98.67</td>
              <td rowspan="1" colspan="1">42.1</td>
              <td rowspan="1" colspan="1">0.27</td>
              <td rowspan="1" colspan="1">0.76</td>
              <td rowspan="1" colspan="1">04:57</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: Results shown are from the analysis of chromosome 20 only. The run-time is reported as minutes:seconds.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For comparison, we used SHAPEIT2 to phase the SNVs using the 1000 Genomes haplotype reference panel. Phase-informative reads were extracted using the extractPIRs tool and were included for phasing using SHAPEIT2 (<xref rid="btz329-B9" ref-type="bibr">Delaneau <italic>et al.</italic>, 2013</xref>). 98.67% of the SNVs were phased with a long switch error of 0.27% and a mismatch error rate equal to 0.76%. Although SHAPEIT2 phased more SNVs compared to the integrated phasing method, the switch error rate of the SHAPEIT2 haplotypes was almost 8-fold higher than the haplotypes assembled using the integrated phasing approach (<xref rid="btz329-T1" ref-type="table">Table 1</xref>). In addition, the SHAPEIT2 haplotypes had an absolute error rate of 42.1% due to the presence of long switch errors. As a result, these haplotypes cannot be used to reliably infer the phase between distant pair of variants.</p>
    </sec>
    <sec>
      <title>3.2 Comparison of different Hi-C protocols on NA12878 genome</title>
      <p>Next, we compared the accuracy and completeness of phasing using whole-genome Hi-C data for NA12878. 72.1% of SNVs (on chromosome 20) could be phased using the MboI Hi-C data with a switch error rate of 1.3% and a mismatch error rate of 1.1%. In comparison, 86.7% of the SNVs were phased by HapCUT2 using the Arima Hi-C reads with 2-fold lower switch and mismatch error rates (<xref ref-type="fig" rid="btz329-F2">Fig. 2A</xref>). Furthermore, the largest haplotype block contained 80.92% of the SNVs. The greater completeness and accuracy of the haplotypes assembled using Arima Hi-C data was a result of the improved uniformity in sequence coverage. Analysis of the sequence data showed that 3.63% SNVs had less than 5 × coverage in the Arima Hi-C data. In comparison, the MboI Hi-C data had 11.7% SNVs with such low-coverage (<xref ref-type="fig" rid="btz329-F2">Fig. 2C</xref>). Single-enzyme Hi-C using the MboI (or similar) restriction enzyme results in non-uniform sequence coverage due to the preference of the restriction enzyme for specific sequences. The Arima Hi-C protocol utilizes multiple restriction enzymes to digest chromatin which reduces the coverage bias.
</p>
      <fig id="btz329-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Completeness and accuracy of haplotyping using Hi-C data for NA12878 (all statistics are for chromosome 20 only). (<bold>A</bold>) Error rates for haplotypes estimated using HapCUT2 on the MboI and Arima Hi-C datasets, and the integrated phasing algorithm applied to the Arima Hi-C data. (<bold>B</bold>) Haplotyping completeness (percentage of SNVs phased) across the three different methods. (<bold>C</bold>) Distribution of read-depth across SNV sites using the Arima and MboI Hi-C datasets (36× coverage). (<bold>D</bold>) Haplotype completeness for Arima Hi-C data as a function of sequence coverage</p>
        </caption>
        <graphic xlink:href="btz329f2"/>
      </fig>
      <p>Phasing the Arima Hi-C data using the integrated phasing method increased the completeness to 98.14% from 86.7% and improved the accuracy of the haplotypes (<xref ref-type="fig" rid="btz329-F2">Fig. 2</xref>). Using sequence reads, the ability to phase a variant does not depend on its population allele frequency but only on the number of links to other variants. Analysis of the phased SNVs showed that the integrated phasing method could phase 86.65% of the rare variants (minor allele frequency &lt;1% in the 1000 Genomes reference panel), 3.5% points more than using Hi-C reads alone (<xref ref-type="fig" rid="btz329-F2">Fig. 2B</xref>). This was not surprising, since using a population reference panel, rare variants are less likely to be phased compared to common variants. Analysis of phasing accuracy and completeness for all autosomes (chromosomes 1–22) demonstrated that the integrated phasing algorithm was able to phase 97.65% of SNVs with an average switch (mismatch) error rate equal to 0.038% (0.049%). In comparison, the switch and mismatch error rates using HapCUT2 on the Hi-C reads alone were 0.25 and 0.33% respectively, more than 6-fold higher.</p>
      <p>To assess the ability to assemble haplotypes using low-coverage Hi-C data, we down-sampled the Arima dataset to various depths of coverage (5×, 10×, 15×, 20× and 30×) and calculated the completeness and accuracy of the haplotypes using HapCUT2 (reads only) and the integrated phasing method. The results (<xref ref-type="fig" rid="btz329-F2">Fig. 2D</xref>) show that using Hi-C reads only, the completeness of the haplotypes increases gradually from 50 to 84.3% as coverage is increased from 5 × to 30 ×. In comparison, using the integrated phasing method, 96.6% of the SNVs can be phased with an absolute error rate of 1.1% at a coverage of 10×. This demonstrated that chromosome-spanning haplotypes with long-range accuracy can be assembled using low-coverage sequencing.</p>
    </sec>
    <sec>
      <title>3.3 Analysis of Strand-seq data</title>
      <p>Recently, <xref rid="btz329-B23" ref-type="bibr">Porubsky <italic>et al.</italic> (2016)</xref> developed a single-cell strand sequencing approach, Strand-seq, and showed that it enables accurate whole-chromosome phasing of diploid genomes. However, only 74.6% of SNVs could be phased for the NA12878 genome using 183 Strand-seq libraries (<xref rid="btz329-B23" ref-type="bibr">Porubsky <italic>et al.</italic>, 2016</xref>). To assess if our new integrated phasing method could improve the completeness and accuracy of haplotyping using Strand-seq, we applied our method to this dataset.</p>
      <p>After processing the raw data (see Section 2.6), 140 fragments were obtained for chromosome 20 and each fragment had allelic information for ∼750 SNVs (1.5% of the total number of heterozygous SNVs) on average. Using these fragments, 71.4% of the SNVs were phased into a single, chromosome-spanning haplotype block using HapCUT2. In comparison, using the integrated phasing method, 94.56% of the SNVs were phased and the chromosome-spanning haplotype block contained 94.1% of the SNVs. In addition, the mismatch error rate was reduced 2-fold, while the long switch error rate was also lower (<xref rid="btz329-T2" ref-type="table">Table 2</xref>). These results demonstrate that the integrated phasing method can significantly improve the completeness and accuracy of haplotyping for multiple sequencing technologies.</p>
      <table-wrap id="btz329-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Phasing completeness and accuracy on whole-genome Strand-seq data for NA12878</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">SNVs phased (%)</th>
              <th rowspan="1" colspan="1">Switch error rate (%)</th>
              <th rowspan="1" colspan="1">Mismatch error rate (%)</th>
              <th rowspan="1" colspan="1">Absolute error rate (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reads only</td>
              <td rowspan="1" colspan="1">71.38</td>
              <td rowspan="1" colspan="1">0.091</td>
              <td rowspan="1" colspan="1">0.268</td>
              <td rowspan="1" colspan="1">0.905</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Integrated phasing</td>
              <td rowspan="1" colspan="1">94.56</td>
              <td rowspan="1" colspan="1">0.0364</td>
              <td rowspan="1" colspan="1">0.134</td>
              <td rowspan="1" colspan="1">0.868</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic>Note</italic>: Results are shown for data on chromosome 20 only. Switch and mismatch error rates were calculated by comparison to Platinum Genomes haplotypes for NA12878.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this paper, we have described a novel likelihood based method that can integrate sparse, long-range haplotype information from sequence reads with haplotype information from population reference panels to enable dense and accurate whole-genome haplotyping of individual genomes. We have demonstrated that this approach significantly improves the completeness and accuracy of haplotype phasing using whole-genome Hi-C data for human genomes. We also find that a new multi-enzyme Hi-C chemistry developed by Arima Genomes significantly improves the completeness of whole-genome haplotyping compared to existing single-enzyme Hi-C data.</p>
    <p>Using 30–40× Illumina whole-genome sequencing using the Arima Hi-C protocol, the integrated phasing method can assemble highly accurate and complete haplotypes for human genomes (&gt;98% of variants phased and error rates &lt;0.2%). Recent work (<xref rid="btz329-B24" ref-type="bibr">Porubsky <italic>et al.</italic>, 2017</xref>) showed that combining data from 10 Strand-seq cells with 10 × Pacific Biosciences long read data was sufficient to phase more than 95% of variants into a single chromosome-spanning block. Here we have shown that it is possible to obtain dense and chromosome-spanning haplotypes with very low error rates using data from a single sequencing technology. Therefore, using low-coverage (∼10×) Hi-C sequencing for genomes in projects such as the Genotype-Tissue Expression (GTEx) project (<xref rid="btz329-B19" ref-type="bibr">Lonsdale <italic>et al.</italic>, 2013</xref>) would be highly informative since it would provide accurate long-range haplotype information for eQTL mapping as well as information about the 3D structure of the genome.</p>
    <p>Our integrated phasing method approximates the haplotype likelihood from a population reference panel using second-order probability distributions that capture the uncertainty in the phase information from population data and can be combined with sequence reads for phasing using HapCUT2. This approach is not limited to Hi-C data and we have shown that it improves the completeness and accuracy of phasing using another sparse haplotyping method, Strand-seq. For Hi-C data, our method significantly outperforms an existing statistical phasing method, SHAPEIT2, in terms of switch error rates. Even though this method can leverage haplotype information from sequence reads (<xref rid="btz329-B9" ref-type="bibr">Delaneau <italic>et al.</italic>, 2013</xref>), our results indicate that SHAPEIT2 is unable to fully utilize the long-range haplotype information in Hi-C reads.</p>
    <p>One limitation of our integrated phasing method is that the ability to phase rare variants that are not linked by sequence reads to other variants is limited by the size of the population reference panel. In this paper, we have used the 1000 Genomes Project reference panel which has haplotypes from 2504 individuals. Use of larger haplotype reference panels such as the recently published HRC panel (<xref rid="btz329-B20" ref-type="bibr">McCarthy <italic>et al.</italic>, 2016</xref>) with 64 976 haplotypes will likely improve the ability to phase rare variants.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Arima Genomics for useful discussions and making their Hi-C dataset available.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz329-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aguiar</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Istrail</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>HapCompass: a fast cycle basis algorithm for accurate haplotype assembly of sequence data</article-title>. <source>J. Comput. Biol</source>., <volume>19</volume>, <fpage>577</fpage>–<lpage>590</lpage>.<pub-id pub-id-type="pmid">22697235</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Auton</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>, <fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bansal</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Bafna</surname><given-names>V.</given-names></name></person-group> (<year>2008</year>) 
<article-title>HapCUT: an efficient and accurate algorithm for the haplotype assembly problem</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>i153</fpage>–<lpage>i159</lpage>.<pub-id pub-id-type="pmid">18689818</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ben-Elazar</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Extending partial haplotypes to full genome haplotypes using chromosome conformation capture data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i559</fpage>–<lpage>i566</lpage>.<pub-id pub-id-type="pmid">27587675</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Browning</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Browning</surname><given-names>B.L.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Haplotype phasing: existing methods and new developments</article-title>. <source>Nat. Rev. Genet</source>., <volume>12</volume>, <fpage>703</fpage>–<lpage>714</lpage>.<pub-id pub-id-type="pmid">21921926</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chow</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>C.</given-names></name></person-group> (<year>1968</year>) 
<article-title>Approximating discrete probability distributions with dependence trees</article-title>. <source>IEEE Trans. Inf. Theory</source>, <volume>14</volume>, <fpage>462</fpage>–<lpage>467</lpage>.</mixed-citation>
    </ref>
    <ref id="btz329-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chu</surname><given-names>W.K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Ultraaccurate genome sequencing and haplotyping of single human cells</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>114</volume>, <fpage>12512</fpage>–<lpage>12517</lpage>.<pub-id pub-id-type="pmid">29078313</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Clarke</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>The International Genome Sample Resource (IGSR): a worldwide collection of genome variation incorporating the 1000 Genomes Project data</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D854</fpage>–<lpage>D859</lpage>.<pub-id pub-id-type="pmid">27638885</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Delaneau</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Haplotype estimation using sequencing reads</article-title>. <source>Am. J. Hum. Genet</source>., <volume>93</volume>, <fpage>687</fpage>–<lpage>696</lpage>.<pub-id pub-id-type="pmid">24094745</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Duitama</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>). 
<article-title>ReFHap: a reliable and fast algorithm for single individual haplotyping</article-title>. In: <source>Proceedings of the First ACM International Conference on Bioinformatics and Computational Biology</source>, pp. <fpage>160</fpage>–<lpage>169</lpage>. ACM, Niagara Falls, New York.</mixed-citation>
    </ref>
    <ref id="btz329-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duitama</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Fosmid-based whole genome haplotyping of a HapMap trio child: evaluation of single individual haplotyping techniques</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>2041</fpage>–<lpage>2053</lpage>.<pub-id pub-id-type="pmid">22102577</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eberle</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>A reference data set of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>157</fpage>–<lpage>164</lpage>.<pub-id pub-id-type="pmid">27903644</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edge</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>HapCUT2: robust and accurate haplotype assembly for diverse sequencing technologies</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>801</fpage>–<lpage>812</lpage>.<pub-id pub-id-type="pmid">27940952</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ghurye</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>). 
<article-title>Integrating Hi-C links with assembly graphs for chromosome-scale assembly</article-title>. <source>bioRxiv</source><fpage>261149</fpage>; doi: https://doi.org/10.1101/261149.</mixed-citation>
    </ref>
    <ref id="btz329-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kitzman</surname><given-names>J.O.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Haplotype-resolved genome sequencing of a Gujarati Indian individual</article-title>. <source>Nat. Biotechnol</source>., <volume>29</volume>, <fpage>59</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">21170042</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuleshov</surname><given-names>V.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Probabilistic single-individual haplotyping</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i379</fpage>–<lpage>385</lpage>.<pub-id pub-id-type="pmid">25161223</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuleshov</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Whole-genome haplotyping using long reads and statistical methods</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>261</fpage>–<lpage>266</lpage>.<pub-id pub-id-type="pmid">24561555</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Levy</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>The diploid genome sequence of an individual human</article-title>. <source>PLoS Biol</source>., <volume>5</volume>, <fpage>e254.</fpage><pub-id pub-id-type="pmid">17803354</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lonsdale</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>The Genotype-Tissue Expression (GTEx) project</article-title>. <source>Nat. Genet</source>., <volume>45</volume>, <fpage>580</fpage>–<lpage>585</lpage>.<pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McCarthy</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A reference panel of 64, 976 haplotypes for genotype imputation</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>1279</fpage>–<lpage>1283</lpage>.<pub-id pub-id-type="pmid">27548312</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pendleton</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Assembly and diploid architecture of an individual human genome via single-molecule technologies</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>780</fpage>–<lpage>786</lpage>.<pub-id pub-id-type="pmid">26121404</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peters</surname><given-names>B.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Accurate whole-genome sequencing and haplotyping from 10 to 20 human cells</article-title>. <source>Nature</source>, <volume>487</volume>, <fpage>190</fpage>–<lpage>195</lpage>.<pub-id pub-id-type="pmid">22785314</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Porubsky</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Direct chromosome-length haplotyping by single-cell sequencing</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>1565</fpage>–<lpage>1574</lpage>.<pub-id pub-id-type="pmid">27646535</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Porubsky</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Dense and accurate whole-chromosome haplotyping of individual genomes</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>1293.</fpage><pub-id pub-id-type="pmid">29101320</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rao</surname><given-names>S.S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>, <volume>159</volume>, <fpage>1665</fpage>–<lpage>1680</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Selvaraj</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Whole-genome haplotype reconstruction using proximity-ligation and shotgun sequencing</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>1111</fpage>–<lpage>1118</lpage>.<pub-id pub-id-type="pmid">24185094</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Snyder</surname><given-names>M.W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Haplotype-resolved genome sequencing: experimental methods and applications</article-title>. <source>Nat. Rev. Genet</source>., <volume>16</volume>, <fpage>344</fpage>–<lpage>358</lpage>.<pub-id pub-id-type="pmid">25948246</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tewhey</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>The importance of phase information for human genomics</article-title>. <source>Nat. Rev. Genet</source>., <volume>12</volume>, <fpage>215</fpage>–<lpage>223</lpage>.<pub-id pub-id-type="pmid">21301473</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>G.X.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Haplotyping germline and cancer genomes with high-throughput linked-read sequencing</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>303</fpage>–<lpage>311</lpage>.<pub-id pub-id-type="pmid">26829319</pub-id></mixed-citation>
    </ref>
    <ref id="btz329-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zook</surname><given-names>J.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Extensive sequencing of seven human genomes to characterize benchmark reference materials</article-title>. <source>Sci. Data</source>, <volume>3</volume>, <fpage>160025.</fpage><pub-id pub-id-type="pmid">27271295</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
