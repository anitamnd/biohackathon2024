<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7048296</article-id>
    <article-id pub-id-type="pmid">32069291</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00651</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007644</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Organism Development</subject>
            <subj-group>
              <subject>Organogenesis</subject>
              <subj-group>
                <subject>Lung Development</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability theory</subject>
            <subj-group>
              <subject>Markov models</subject>
              <subj-group>
                <subject>Hidden Markov models</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Cell Differentiation</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Information Technology</subject>
          <subj-group>
            <subject>Data Processing</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>DNA-binding proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Regulatory Proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Inferring TF activation order in time series scRNA-Seq studies</article-title>
      <alt-title alt-title-type="running-head">Inferring TF activation order in time series scRNA-Seq studies</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2417-9992</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Chieh</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5183-6885</contrib-id>
        <name>
          <surname>Ding</surname>
          <given-names>Jun</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Ziv</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Machine Learning Department, School of Computer Science, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Computational Biology Department, School of Computer Science, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Aerts</surname>
          <given-names>Stein</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Katholieke Universiteit Leuven Centrum Menselijke Erfelijkheid, BELGIUM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>zivbj@cs.cmu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>2</issue>
    <elocation-id>e1007644</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Lin et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lin et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007644.pdf"/>
    <abstract>
      <p>Methods for the analysis of time series single cell expression data (scRNA-Seq) either do not utilize information about transcription factors (TFs) and their targets or only study these as a post-processing step. Using such information can both, improve the accuracy of the reconstructed model and cell assignments, while at the same time provide information on how and when the process is regulated. We developed the Continuous-State Hidden Markov Models TF (CSHMM-TF) method which integrates probabilistic modeling of scRNA-Seq data with the ability to assign TFs to specific activation points in the model. TFs are assumed to influence the emission probabilities for cells assigned to later time points allowing us to identify not just the TFs controlling each path but also their order of activation. We tested CSHMM-TF on several mouse and human datasets. As we show, the method was able to identify known and novel TFs for all processes, assigned time of activation agrees with both expression information and prior knowledge and combinatorial predictions are supported by known interactions. We also show that CSHMM-TF improves upon prior methods that do not utilize TF-gene interaction.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>An important attribute of time series single cell RNA-Seq (scRNA-Seq) data, is the ability to infer continuous trajectories of genes based on orderings of the cells. While several methods have been developed for ordering cells and inferring such trajectories, to date it was not possible to use these to infer the temporal activity of several key TFs. These TFs are are only post-transcriptionally regulated and so their expression does not provide complete information on their activity. To address this we developed the Continuous-State Hidden Markov Models TF (CSHMM-TF) methods that assigns continuous activation time to TFs based on both, their expression and the expression of their targets. Applying our method to several time series scRNA-Seq datasets we show that it correctly identifies the key regulators for the processes being studied. We analyze the temporal assignments for these TFs and show that they provide new insights about combinatorial regulation and the ordering of TF activation. We used several complementary sources to validate some of these predictions and discuss a number of other novel suggestions based on the method. As we show, the method is able to scale to large and noisy datasets and so is appropriate for several studies utilizing time series scRNA-Seq data.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Institutes of Health</institution>
        </funding-source>
        <award-id>U01 HL122626, 1R01GM122096 and OT2OD026682</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Ziv</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The research fund is granted to ZBJ, from National Institutes of Health (U01 HL122626, 1R01GM122096 and OT2OD026682). <ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/">https://www.nih.gov/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="2"/>
      <page-count count="19"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-02-28</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data files are obtained from previously published papers (cited in methods), and are available from public database. Details of where to get the data can be found in the cited papers. Program is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/jessica1338/CSHMM-TF-for-time-series-scRNA-Seq">https://github.com/jessica1338/CSHMM-TF-for-time-series-scRNA-Seq</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data files are obtained from previously published papers (cited in methods), and are available from public database. Details of where to get the data can be found in the cited papers. Program is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/jessica1338/CSHMM-TF-for-time-series-scRNA-Seq">https://github.com/jessica1338/CSHMM-TF-for-time-series-scRNA-Seq</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Single cell RNA-Seq data (scRNA-Seq) has been used over the last few years to study several developmental and temporal processes [<xref rid="pcbi.1007644.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1007644.ref003" ref-type="bibr">3</xref>]. These include cell differentiation studies [<xref rid="pcbi.1007644.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007644.ref004" ref-type="bibr">4</xref>], in-vivo studies of developing animals [<xref rid="pcbi.1007644.ref005" ref-type="bibr">5</xref>] and response studies [<xref rid="pcbi.1007644.ref002" ref-type="bibr">2</xref>]. In all cases cells are usually sampled at specific intervals, RNA is extracted and sequenced, and expression profiles are determined. Using these expression profiles researchers then aim to reconstruct branching and cell fate decision models that underlie developmental processes.</p>
    <p>In scRNA-Seq cells that are profiled cannot be further traced. Thus, to infer the trajectories which underlie these processes researchers often rely on computational methods that link expression profiles from different cells. Several methods have been developed for such analysis including methods that are based on dimensionality reduction followed by the construction of trees or graphs in the resulting reduced dimension space (for example, DPT [<xref rid="pcbi.1007644.ref006" ref-type="bibr">6</xref>], scTDA [<xref rid="pcbi.1007644.ref007" ref-type="bibr">7</xref>], PCA analysis [<xref rid="pcbi.1007644.ref003" ref-type="bibr">3</xref>], Monocle 2 [<xref rid="pcbi.1007644.ref001" ref-type="bibr">1</xref>], Wanderlust [<xref rid="pcbi.1007644.ref008" ref-type="bibr">8</xref>]), GPLVM [<xref rid="pcbi.1007644.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1007644.ref010" ref-type="bibr">10</xref>], Slingshot [<xref rid="pcbi.1007644.ref011" ref-type="bibr">11</xref>], and PAGA [<xref rid="pcbi.1007644.ref012" ref-type="bibr">12</xref>] and probabilistic methods that utilize the entire expression space such as SCUBA [<xref rid="pcbi.1007644.ref013" ref-type="bibr">13</xref>] and TASIC [<xref rid="pcbi.1007644.ref014" ref-type="bibr">14</xref>]). More recent work has also attempted to associate transcription factors (TF) with specific branching events to determine regulators of the reconstructed paths [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1007644.ref017" ref-type="bibr">17</xref>].</p>
    <p>While the above methods successfully identify paths and branching events, and some can identify key TFs, the integration of TFs with the scRNA-Seq data has not reached its full potential. Several methods have been developed to integrate <italic>bulk</italic> time series gene expression data with protein-DNA interaction data, but these can only place TFs at a discrete, and often small, number of time points making it hard to determine the precise activation order and the combinatorial interactions involved [<xref rid="pcbi.1007644.ref018" ref-type="bibr">18</xref>]. A number of methods were recently proposed for identifying TF-gene interactions using scRNA-Seq data which can allow for more continuous assignments. However, most of these methods perform such assignments as a post-processing step [<xref rid="pcbi.1007644.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1007644.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1007644.ref019" ref-type="bibr">19</xref>] making it hard to utilize the information for improving model reconstruction and assignments. A few methods can actually integrate TFs as part of the model construction algorithm and these were indeed shown to improve upon methods that do not use this data [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>]. However, these methods use a discrete state model in which TFs can only be assigned to a specific (pre-defined) time. This makes it hard to identify the exact activation time of these TFs, to infer combinatorial activity of TFs and the dynamics of TF complexes assembly.</p>
    <p>To address these issues we extended a previous method we developed for modeling dynamic scRNA-Seq branching data which was based on Continuous State Hidden Markov Models (CSHMMs) [<xref rid="pcbi.1007644.ref020" ref-type="bibr">20</xref>]. Similar to regular HMMs, CSHMMs are defined by states and transition probabilities. However, unlike traditional HMMs they have infinitely many states and so can be used to represent continuous time. The continuous states are used to determine assignment of cells to paths in the model (<xref ref-type="fig" rid="pcbi.1007644.g001">Fig 1</xref>) and transition probabilities are used to denote branching of cells to different fates [<xref rid="pcbi.1007644.ref021" ref-type="bibr">21</xref>]. Here we extend this model to take into account TF-gene interaction as well. We formulate an new CSHMM model (termed CSHMM-TF) in which the regulation by TFs influences the emission probabilities of the different paths. Using the revised model we associate TFs with different model paths and identify a specific activation time along the path for the different TFs. Applying our CSHMM-TF to several mouse and human scRNA-Seq datasets, we show that by using this information the resulting models are more accurate compared to models that do not use TF-gene interaction information. We also discuss the combinatorial aspects of TF regulation and show that many of the TFs assigned to the same paths are indeed working together to regulate genes. Finally, we study the dynamic of TFs activation by looking at early and late TFs for the same path (or genes) and use this to raise novel hypotheses regarding TF activation order.</p>
    <fig id="pcbi.1007644.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>CSHMM-TF model structure and parameters.</title>
        <p>The figure presents the assignments of cells and TFs to the reconstructed branching model for the process studies. Each edge (path) represents a set of infinite states parameterized by the path number and the location along the path. We use a function based on parameters learned for the split nodes (nodes at the start and end of each path) and TF assignments to define an emission probability. Emission probability for a gene along a path is a function of the location of the state and prior TFs (<italic>t</italic> and <italic>t</italic><sub><italic>start</italic></sub>) and a gene specific parameter <italic>k</italic> which controls the rate of change of its expression along the path. Split nodes are locations where paths split and are associated with a branch (transition) probability. The t_start parameter defines the TF activation time for a specific TF associated with the path. Cell assignment to paths is determined by the emission probabilities and the expression of specific TF targets for the TFs associated with the path. <italic>w</italic> is a vector of <italic>gene-specific</italic> mixture weight, where the weights are a non linear function which depends on (<italic>t</italic> and <italic>t</italic><sub><italic>start</italic></sub>). See text for more details.</p>
      </caption>
      <graphic xlink:href="pcbi.1007644.g001"/>
    </fig>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>To infer dynamic continuous models for both cell ordering and TF activation we developed the Continuous State Hidden Markov Models Transcription Factor (CSHMM-TF) method. An overview of the model is presented in <xref ref-type="fig" rid="pcbi.1007644.g001">Fig 1</xref>. We start by learning an initial branching structure (which can be modified as part of the iterative algorithm). Each edge (path) represents a set of infinite states parameterized by the path number and the location along the path. Cells are assigned to these states leading to a continuous ordering of cells along the paths. Paths can diverge at split nodes (representing a split leading to two or more different cell types) and a transition probability is inferred based on the fraction of cells assigned to each of the diverging branches. Emission probability for a gene along a path is a function of the location of the state on the path (which accounts for global gene expression in that cell) and the timing of the set of TFs assigned to the path. Specifically, we infer an activation time for some of the TFs and assign a TF specific function for their activity. We use the TF specific time and function to determine the expected expression of its targets in each point along the path. When computing emission probabilities for cells we place a larger weight on the <italic>targets</italic> of these TFs leading to selection of cells that are more likely regulated by them. This process iterates between model revisions, cell assignments and TF assignment until convergence. When the model converges we obtain a specific location for each cell on one of the paths and a time of activation for TFs identified.</p>
    <sec id="sec003">
      <title>Application of CSHMM-TF to time series scRNA-Seq data</title>
      <p>We applied CSHMM-TF to several time series scRNA-Seq datasets. The first is a human liver dataset with 765 cells, 19K genes, collected at 4 developmental stages [<xref rid="pcbi.1007644.ref022" ref-type="bibr">22</xref>]. The second studies human skeletal muscle myoblasts and contains 271 cells, 13K genes and 4 time points [<xref rid="pcbi.1007644.ref001" ref-type="bibr">1</xref>]. The third is from mouse and looks at differentiation of medial ganglionic eminences (MGC) to the Cortex [<xref rid="pcbi.1007644.ref023" ref-type="bibr">23</xref>]. This dataset contains ∼ 21K cells, ∼10K genes and 3 time points. The fourth is mouse embryonic fibroblasts (MEF) reprogramming to neurons [<xref rid="pcbi.1007644.ref004" ref-type="bibr">4</xref>]. It contains 252 cells, 12K genes and 4 time points. The fifth is a lung development dataset with 152 cells, 15K genes and 3 time points [<xref rid="pcbi.1007644.ref003" ref-type="bibr">3</xref>]. See <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting methods for more details about each of these datasets.</p>
      <p>Figs <xref ref-type="fig" rid="pcbi.1007644.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1007644.g003">3</xref> present the resulting CSHMM-TF models for the human liver data and the mouse lung developmental data with TF assignments. As can be seen in these figures, unlike prior methods that assign TFs to discrete branch points only [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1007644.ref024" ref-type="bibr">24</xref>–<xref rid="pcbi.1007644.ref026" ref-type="bibr">26</xref>], CSHMM-TF can infer a more refined time for the activation of TFs. This helps improve the assignment of cells to different paths, to infer combinatorial TF regulation and to determine TF ordering as we show below. See also Figure A-C, E and Table C, E in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> for results for the MEF reprogramming, myoblasts differentiation, and the cortex differentiation datasets, respectfully.</p>
      <fig id="pcbi.1007644.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>CSHMM-TF result for the liver dataset.</title>
          <p>(a) CSHMM-TF structure and continuous cell assignment for the liver dataset. D nodes are split nodes and p edges are paths as shown in <xref ref-type="fig" rid="pcbi.1007644.g001">Fig 1</xref>. Each circle on a path represents cells assigned to a state on that path. The bigger the circle the more cells are assigned to this state. Cells are colored based on the cell type / time point assigned to them in the original paper. (b) TF assignments by CSHMM-TF for the liver dataset. We highlight known functional roles for several TFs. Path names (DE, LB etc.) are based on annotated cells assigned to that path in the figure above. Full names of cell types can be found on <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting methods of data collection and processing.</p>
        </caption>
        <graphic xlink:href="pcbi.1007644.g002"/>
      </fig>
      <fig id="pcbi.1007644.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>CSHMM-TF result for the lung development dataset.</title>
          <p>(a) CSHMM-TF structure and continuous cell assignment for lung development dataset. Notations are similar to the ones described in <xref ref-type="fig" rid="pcbi.1007644.g002">Fig 2</xref> (b) TF assignments to each path by CSHMM-TF. We highlight known functional roles for several TFs. Path names (Ciliated, AT1 etc.) are based on annotated cells assigned to that path in the figure above.</p>
        </caption>
        <graphic xlink:href="pcbi.1007644.g003"/>
      </fig>
      <p>The reconstructed trajectories for the liver dataset (<xref ref-type="fig" rid="pcbi.1007644.g002">Fig 2(a)</xref>), correctly reconstruct the relationship of induced Pluripotent Stem Cells (iPSC) → DE (definitive endoderm) → HE (hepatic endoderm) and IH (immature hepatoblast-like) → MH (mature hepatocyte-like). For the lung dataset (<xref ref-type="fig" rid="pcbi.1007644.g003">Fig 3(a)</xref>), CSHMM-TF correctly assigns cells, based on their known types, to terminal paths (ciliated, Clara, AT1 and AT2). Progenitor cells and BP cells are also correctly assigned to earlier paths.</p>
    </sec>
    <sec id="sec004">
      <title>Assigned TFs correctly match cell types in each path</title>
      <p>Figs <xref ref-type="fig" rid="pcbi.1007644.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1007644.g003">3(b)</xref> present TF assignment for CSHMM-TF for the liver and lung dataset. In the figures we highlight known functions related to development and the specific processes for several TFs. As can be seen, CSHMM-TF identifies known key regulators (<xref ref-type="fig" rid="pcbi.1007644.g002">Fig 2(b)</xref>). For example, FOX family TFs are identified in several paths and are known to control the formation and function of the liver [<xref rid="pcbi.1007644.ref027" ref-type="bibr">27</xref>]. HMGA1 (identified in all path except P3) and HMGA2 (identified in P7, P8, P11) are known to be involved in several developmental processes [<xref rid="pcbi.1007644.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1007644.ref029" ref-type="bibr">29</xref>]. ONECUT2 regulates liver development and is required for liver bud expansion [<xref rid="pcbi.1007644.ref030" ref-type="bibr">30</xref>]. CEBPB, identified for path P8 which is the path for liver bud, is the marker of early liver development and expressed in the early liver bud [<xref rid="pcbi.1007644.ref031" ref-type="bibr">31</xref>]. GATA2 is important in hepatic cell fate decision [<xref rid="pcbi.1007644.ref032" ref-type="bibr">32</xref>]. SOX9 is also related to hepatogenic differentiation [<xref rid="pcbi.1007644.ref033" ref-type="bibr">33</xref>]. SRF is essential for hypatocyte proliferation and liver function [<xref rid="pcbi.1007644.ref034" ref-type="bibr">34</xref>]. PITX2 is related to the differentiation of induced hepatic stem cells [<xref rid="pcbi.1007644.ref035" ref-type="bibr">35</xref>]. See <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Results for a full list.</p>
      <p>For the lung dataset, several of the TFs assigned by the model to the lung dataset are known to play important roles in lung development. These include SOX9 [<xref rid="pcbi.1007644.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1007644.ref037" ref-type="bibr">37</xref>], which plays an important role in tracheal and lung epithelium development, GATA6 [<xref rid="pcbi.1007644.ref038" ref-type="bibr">38</xref>, <xref rid="pcbi.1007644.ref039" ref-type="bibr">39</xref>], a regulator for AT1/AT2 cell type, SREBF1 which regulates the biological process of perinatal lung maturation [<xref rid="pcbi.1007644.ref040" ref-type="bibr">40</xref>], STAT6 which can serve as a therapeutic target for preventing pulmonary hypoplasia [<xref rid="pcbi.1007644.ref041" ref-type="bibr">41</xref>], YY1 [<xref rid="pcbi.1007644.ref042" ref-type="bibr">42</xref>], which is required in lung morphogenesis and CEBPB plays pivotal role in determining airway epithelial differentiation [<xref rid="pcbi.1007644.ref043" ref-type="bibr">43</xref>]. Others include SRF, a critical protein for pulmonary myofibroblast differentiation [<xref rid="pcbi.1007644.ref044" ref-type="bibr">44</xref>] and BACH2 which is required for the functional maturation of alveolar macrophages and pulmonary homeostasis [<xref rid="pcbi.1007644.ref045" ref-type="bibr">45</xref>]. Additionally, a number of cell type specific marker genes can be identified based on their expression profiles in paths identified by CSHMM-TF. For example, AQP5 is a known marker for type 1 cells (AT1, path P7) and SFTPC, SFTPA and NKX2-1 are known markers for type 2 cells (AT2, path P5). GATA6 is the regulator for these markers [<xref rid="pcbi.1007644.ref039" ref-type="bibr">39</xref>], and is assigned to both paths by CSHMM-TF. SOX4 and SOX9 control formation of primary cilia [<xref rid="pcbi.1007644.ref046" ref-type="bibr">46</xref>] and SOX5 activates the expression of ciliary genes. All 3 TFs are correctly detected for path (ciliated path).</p>
      <p>For both the lung and liver datasets, CSHMM-TF has also identified several TFs related to cell proliferation, as expected for developing tissues and organs. Examples are shown in the figures and the <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting results. Similar results for the neuron reprogramming dataset are also available in the <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting results.</p>
    </sec>
    <sec id="sec005">
      <title>Verifying predicted TF activation time</title>
      <p>While we observe the expression values for all genes and TFs, when learning the CSHMM-TF model we do not use the expression of the TFs. Instead, following past work [<xref rid="pcbi.1007644.ref018" ref-type="bibr">18</xref>] we determine TF activity and timing based on TF targets. This allows us to identify TFs that are post-transcriptionally regulated which are missed when only using expression data to infer activity. However, some TFs are transcriptionally regulated and we can thus use their expression profiles to validate model assignments. Specifically, since TF expression levels and protein-protein interactions are not used to infer their targets, we use them for model validation. <xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4</xref> presents expression profiles smoothed by 4-degree polynomial for top assigned TFs based on p-values from binomial test in the lung, neuron, and liver models. Each figure legend denotes the color and the time assignment for TFs.</p>
      <fig id="pcbi.1007644.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Expression profiles for top TFs assigned by the method to the lung, neuron, and liver reconstructed models.</title>
          <p>Each figure plots the expression TFs predicted to co-regulate a specific path. Each figure legend denotes the color and the <italic>time</italic> assignment for each TF. Profiles for TFs are the MLE estimates for these TFs expression values based on learned model parameters. (a-d) co-regulating TF expressions in lung paths. (e-i) co-regulating TF expressions in neuron paths. (j-l) co-regulating TF expressions in liver paths. See text for details.</p>
        </caption>
        <graphic xlink:href="pcbi.1007644.g004"/>
      </fig>
      <p>Several of these profiles agree with both their time assignment and their relationship to other TFs assigned to the same paths. For example, the transcriptional repressor protein YY1 is known to directly interact with members of the ATF/CREB family of transcription factors [<xref rid="pcbi.1007644.ref047" ref-type="bibr">47</xref>]. These TFs are all assigned to path P1 with YY1 being up-regulated earlier than ATF/CREB supporting model assignments (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(a)</xref>). Similarly, interactions between YY1 and E2F genes was previously noted [<xref rid="pcbi.1007644.ref048" ref-type="bibr">48</xref>, <xref rid="pcbi.1007644.ref049" ref-type="bibr">49</xref>] and indeed both are assigned to path P1 (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(b)</xref>). CEBPB/CEBPD, known to form a heterodimers [<xref rid="pcbi.1007644.ref050" ref-type="bibr">50</xref>] are both correctly assigned to the same time (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(c)</xref>). Similarly, E2Fs which are known to bind DP1 [<xref rid="pcbi.1007644.ref051" ref-type="bibr">51</xref>] are assigned to the same time and path (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(d), 4(g) and 4(k)</xref>). FOS and JUN can form heterodimers [<xref rid="pcbi.1007644.ref052" ref-type="bibr">52</xref>] and are also assigned the same activation time (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(e) and 4(f)</xref>). SOX genes are known to modulate beta-catenin/TCF activity [<xref rid="pcbi.1007644.ref053" ref-type="bibr">53</xref>]. Our model assigning all of them to the same time in path P6 of the neuron data, though expression analysis shows that sox11 is slightly ahead of TCF7 (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(h)</xref>). ATF3 is a known co-factor of c-Fos and both are correctly assigned to the same time (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(i)</xref>). In addition, SOX9 is known to be the downstream target of NFATC1 [<xref rid="pcbi.1007644.ref054" ref-type="bibr">54</xref>], and CSHMM-TF identified both of them in the same path and assign them at the same time point (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(j)</xref>). Finally, SRF are known to form a physical complex with NKX3-1 [<xref rid="pcbi.1007644.ref055" ref-type="bibr">55</xref>], and both of them are assigned at the same path with same time (<xref ref-type="fig" rid="pcbi.1007644.g004">Fig 4(l)</xref>). In Table F in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref>, we present the Spearman correlations for the expression of predicted TF pairs. As can be seen, overall the high correlations support the assignments of CSHMM-TF.</p>
    </sec>
    <sec id="sec006">
      <title>TF interactions further support TF assignment times</title>
      <p>In addition to the support provided by the analysis of expression profiles we looked at known interactions between TFs to determine whether TFs assigned by CSHMM-TF to the same path (either at the same or different times) are indeed known to interact. For this, we determined the number of protein-protein interactions (PPI) or regulatory interactions in each paths and compared these to random TF sets of the same size. We have further divided the analysis to determine the significance of interactions within and between a specific time assignment (early-early, late-late, or early-late where early is defined as an assignment to the branching point (0) and late as everything after that).</p>
      <p>We searched for interactions for all 5 models in the TcoF-DB database [<xref rid="pcbi.1007644.ref056" ref-type="bibr">56</xref>], which contains transcription factor interactions for human and mouse. Results are presented in <xref rid="pcbi.1007644.t001" ref-type="table">Table 1</xref>. Each dataset is represented by 3 rows: The first displays the number of interactions in the TcoF-DB in all paths, divided by the number of all combinations in all paths. Take the lung data as an example, there are 257 TFs in the dataset, so there could be 257*256/2 = 32896 possible TF interactions, but only 960 of these interactions are found in the TcoF-DB database. For the #A vs A column, the numerator is the sum of the number of interactions found in TcoF-DB, while the denominator is the sum of all possible interactions in each path (in this dataset we have identified top 10 TFs in each path, so this number becomes 10*9/2 * (7 paths) = 315). For the second row of each dataset, we just calculated the ratio based on the numbers in the first row. For the third row, we calculated the p-value based on hypergeometric test compared to the #total column.</p>
      <table-wrap id="pcbi.1007644.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Analysis of predicted TF-TF interactions based on the TcoF database.</title>
          <p>Abbreviations: total: all possible interactions in a dataset, A: all TFs assigned to each path, E: early TFs in each of the paths, L: late TFs. For each dataset we present 3 rows: number of combinations, ratio and p-value.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007644.t001g" xlink:href="pcbi.1007644.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Dataset</th>
                <th align="left" rowspan="1" colspan="1">#of TF</th>
                <th align="left" rowspan="1" colspan="1">#total</th>
                <th align="left" rowspan="1" colspan="1">#A vs A</th>
                <th align="left" rowspan="1" colspan="1">#E vs E</th>
                <th align="left" rowspan="1" colspan="1">#L vs L</th>
                <th align="left" rowspan="1" colspan="1">#E vs L</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Liver #comb</td>
                <td align="left" rowspan="1" colspan="1">252</td>
                <td align="left" rowspan="1" colspan="1">1021/31626</td>
                <td align="left" rowspan="1" colspan="1">20/342</td>
                <td align="left" rowspan="1" colspan="1">11/166</td>
                <td align="left" rowspan="1" colspan="1">2/48</td>
                <td align="left" rowspan="1" colspan="1">7 / 128</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Liver ratio</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.032</td>
                <td align="left" rowspan="1" colspan="1">0.058</td>
                <td align="left" rowspan="1" colspan="1">0.066</td>
                <td align="left" rowspan="1" colspan="1">0.042</td>
                <td align="left" rowspan="1" colspan="1">0.055</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">Liver-p-value</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1"/>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">X</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">3.99E-03</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">7.85E-03</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">2.02E-01</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">5.60E-02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lung #comb</td>
                <td align="left" rowspan="1" colspan="1">257</td>
                <td align="left" rowspan="1" colspan="1">960/32896</td>
                <td align="left" rowspan="1" colspan="1">30/315</td>
                <td align="left" rowspan="1" colspan="1">8/119</td>
                <td align="left" rowspan="1" colspan="1">5/47</td>
                <td align="left" rowspan="1" colspan="1">17/149</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lung ratio</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.029</td>
                <td align="left" rowspan="1" colspan="1">0.095</td>
                <td align="left" rowspan="1" colspan="1">0.067</td>
                <td align="left" rowspan="1" colspan="1">0.106</td>
                <td align="left" rowspan="1" colspan="1">0.114</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">Lung p-value</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1"/>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">X</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">4.56E-09</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">8.24E-03</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">2.35E-03</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">3.91E-07</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Cortical #comb</td>
                <td align="left" rowspan="1" colspan="1">157</td>
                <td align="left" rowspan="1" colspan="1">423/12246</td>
                <td align="left" rowspan="1" colspan="1">19/291</td>
                <td align="left" rowspan="1" colspan="1">9/144</td>
                <td align="left" rowspan="1" colspan="1">0/33</td>
                <td align="left" rowspan="1" colspan="1">10 / 114</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Cortical ratio</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.035</td>
                <td align="left" rowspan="1" colspan="1">0.065</td>
                <td align="left" rowspan="1" colspan="1">0.063</td>
                <td align="left" rowspan="1" colspan="1">0.000</td>
                <td align="left" rowspan="1" colspan="1">0.088</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">Cortical-p-value</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1"/>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">X</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">2.72E-03</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">2.76E-02</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">X</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">1.93E-03</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Neuron #comb</td>
                <td align="left" rowspan="1" colspan="1">208</td>
                <td align="left" rowspan="1" colspan="1">873/21528</td>
                <td align="left" rowspan="1" colspan="1">30/351</td>
                <td align="left" rowspan="1" colspan="1">16/90</td>
                <td align="left" rowspan="1" colspan="1">8/85</td>
                <td align="left" rowspan="1" colspan="1">6/176</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Neuron ratio</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.040</td>
                <td align="left" rowspan="1" colspan="1">0.085</td>
                <td align="left" rowspan="1" colspan="1">0.17</td>
                <td align="left" rowspan="1" colspan="1">0.094</td>
                <td align="left" rowspan="1" colspan="1">0.034</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">Neuron p-value</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1"/>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">X</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">4.47E-05</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">1.07E-07</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">7.47E-03</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">X</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Myoblast #comb</td>
                <td align="left" rowspan="1" colspan="1">230</td>
                <td align="left" rowspan="1" colspan="1">875/26335</td>
                <td align="left" rowspan="1" colspan="1">49/447</td>
                <td align="left" rowspan="1" colspan="1">45/408</td>
                <td align="left" rowspan="1" colspan="1">0/3</td>
                <td align="left" rowspan="1" colspan="1">4/36</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Myoblast ratio</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.033</td>
                <td align="left" rowspan="1" colspan="1">0.109</td>
                <td align="left" rowspan="1" colspan="1">0.111</td>
                <td align="left" rowspan="1" colspan="1">0.000</td>
                <td align="left" rowspan="1" colspan="1">0.111</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Myoblast-p-value</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">X</td>
                <td align="left" rowspan="1" colspan="1">7.18E-14</td>
                <td align="left" rowspan="1" colspan="1">5.50E-13</td>
                <td align="left" rowspan="1" colspan="1">X</td>
                <td align="left" rowspan="1" colspan="1">6.42E-03</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Overall, we see very significant enrichment for interactions between TFs assigned to the same path. For most datasets we also see significant enrichment for interaction for ‘early TFs’. These are TFs that are assigned to the initial part of the path (usually those that regulate a large number of genes in the path) and as shown above in many cases represent proteins that are involved in complexes that jointly regulate a large number of genes. However, interestingly we also find for some of the datasets (most notably the mouse lung data) a strong enrichment for early-late interactions. These interactions likely represent a late TF activation or recruitment by an earlier TF. The fact that many of them are known interactions indicate that our model, using scRNA-Seq data, is indeed able to identify the specific timing of the regulation of the different TFs which are usually all assigned to the same time.</p>
    </sec>
    <sec id="sec007">
      <title>Comparison to other methods</title>
      <p>We compared CSHMM-TF with several prior methods for trajectory inference that do not utilize TF-gene interaction data. For this we looked at the accuracy of the reconstructed trajectories and cell assignments as well as on the inference of TFs and their order.</p>
      <p>Figure B in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> presents a comparisons for the lung and neuron datasets between CSHMM-TF and several prior methods for pseudo-time inference including PCA [<xref rid="pcbi.1007644.ref003" ref-type="bibr">3</xref>], TSNE, GPLVM following PCA [<xref rid="pcbi.1007644.ref057" ref-type="bibr">57</xref>], Monocle 2 [<xref rid="pcbi.1007644.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1007644.ref058" ref-type="bibr">58</xref>], Slingshot [<xref rid="pcbi.1007644.ref011" ref-type="bibr">11</xref>], and PAGA [<xref rid="pcbi.1007644.ref012" ref-type="bibr">12</xref>]. Note that, although PCA and TSNE are not cell trajectory reconstruction methods, a number of previous time series scRNA-Seq analysis papers have used these methods to discuss trajectories [<xref rid="pcbi.1007644.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007644.ref016" ref-type="bibr">16</xref>]. In addition, several of the trajectory assignment methods only work on the reduced dimension representation (including GPLVM and slingshot) and so we plot the results for these methods as well.</p>
      <p>As the figure shows, for a number of cell types these methods were unable to fully reconstruct known developmental trajectories.</p>
      <p>For example, while PCA and TSNE, were able to identify clusters for some cell types in both the lung and neuron data, they were unable to reconstruct the correct trajectories and also mix a number of different cell types correctly assigned by CSHMM-TF. GPLVM correctly orders cells along a pseudotime, however, it is unable to determine branching models. Monocle 2 is able to reconstruct cell trajectories, however it only found a single split for these datasets and also mixed cell types that CSHMM-TF correctly separated into unique branches. Slingshot is able to order cells along a pseudotime but it did not identify any branch point for the lung data. For the neural data it correctly separates the MEF and neuron cells, but is unable to infer a correct trajectory along the different cell types (in fact, one of its trajectories ends with d2_induced which is an intermediate cell type). As for PAGA, while it correctly clusters cell types, it does not seem to provide any clear trajectory for the cells or clusters. For both datasets PAGA produces a set of weakly connected cliques making it hard to infer the branching.</p>
      <p>To compare the results of CSHMM-TF with CSHMM that does not utilize TF-gene interactions, we developed a quantitative measure which calculates the accuracy of the ordering inferred by the two methods (<xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods). We used this to compare the two methods on three of the datasets analyzed in this paper: lung, neuron and liver. Results are shown in Table H in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref>. As can be seen, CSHMM-TF assignments are in better agreement with known cell differentiation stages when compared to CSHMM for all three datasets. In some of them the improvement is small (1-2%) while for the lung dataset, the improvement is about 9%. To further study the usefulness of the TF-gene interaction information we have also compared CSHMM-TF to a version that uses random TF-gene assignments. Again, we see a decrease in performance when not using the correct TF-gene interactions (Table H in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref>). For the random assignments we also determined the number of significant TFs identified by CSHMM-TF. As can be seen in Table I in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref>, random TF-gene interactions lead to much fewer significant TFs indicating that, as we assumed in the model, several co-regulated genes are assigned to the same paths by CSHMM-TF.</p>
      <p>As mentioned above, most prior methods do not attempt to model regulation by TFs. However, a few do, and so we next compared CSHMM-TF to two prior methods for TF assignments using the liver dataset. The first is SCDIFF [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>], which, unlike our method does not provide continuous assignment for cells. The second is based on post-processing assignment of TFs following model reconstruction [<xref rid="pcbi.1007644.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1007644.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1007644.ref019" ref-type="bibr">19</xref>]. These methods perform t-test for the expressions of TFs between each path and its parent path and use a p-value cutoff to select differentially expressed (DE) TFs. Here, we use the DE method as a post processing step following CSHMM analysis for comparison. Table A-B in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> present the resulting TFs selected by SCDIFF and the DE method. For both methods we select the top 10 TFs for each path and compare these to the top 10 CSHMM-TF predictions. While we see some overlap (HMGA1, HMGA2 and PITX2) between TFs identified by the DE method, and those identified by CSHMM-TF, all other liver TFs identified by CSHMM-TF which were discussed are missed by the DE method. Similarly, we see a number of known liver development TFs that were identified by CSHMM-TF but missed by SCDIFF including ONECUT2 at P5 [<xref rid="pcbi.1007644.ref030" ref-type="bibr">30</xref>], APC [<xref rid="pcbi.1007644.ref059" ref-type="bibr">59</xref>] at P4, and SOX9 [<xref rid="pcbi.1007644.ref033" ref-type="bibr">33</xref>] at P3 and P5.</p>
    </sec>
    <sec id="sec008">
      <title>Scalability and robustness of CSHMM-TF</title>
      <p>While some recent scRNA-Seq studies profile thousands of cells, very few large time series scRNA-Seq datasets are currently available. One of the datasets we analyzed, which studied mouse cortical development is quite large (∼21K cells, ∼10K genes) [<xref rid="pcbi.1007644.ref023" ref-type="bibr">23</xref>]. As we have shown in Figure E and Table E in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref>, CSHMM-TF can be successfully applied to such data. Total runtime for this dataset on a desktop with 4 cores was less than 3 days and since assignments of cells to paths are easy to parallelize, run time can be significantly reduced on a larger cluster. To test performance on slightly smaller, though better annotated, dataset we performed simulation analysis based on the liver scRNA-Seq data [<xref rid="pcbi.1007644.ref022" ref-type="bibr">22</xref>] using ∼10K cells. For this, we generated a new dataset with ∼10K cells based on the human liver data. We created 13 random cells from each original cell by randomly adding 20% dropouts (setting the expression of 20% random genes in each cell to zero). Results are presented in Figure D and Table D in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref>. Run time on a desktop is about 9 hours for one EM iteration with the total run time of less than 2 days. We have also compared the accuracy of the resulting model to the original model (based on a smaller data size) and found them to be comparable. See <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Results for complete details.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Discussion</title>
    <p>While several methods have been developed to reconstruct developmental models based on time series scRNA-Seq data, very few of these utilize information about TF-gene interactions. Such complementary information can aid in correctly reconstructing models for development and differentiation and can help explain the regulation of the process being studied.</p>
    <p>Here we presented CSHMM-TF a continuous-state HMM model which combines cell assignments to a developmental model with TF assignments as regulators of the process. The method utilizes a probabilistic model which helps account for noise and missing values common to scRNA-Seq data. To learn the model the method iterates between cell assignments to branches and TF assignments to specific time points. Cells assigned to paths to which TFs are assigned are assumed to have that TF active. Based on the analysis of the targets of these cells we can both, identify the regulators and improve the assignments of cells to paths.</p>
    <p>We applied the method to several scRNA-Seq datasets from both human and mouse. As we show, the method was able to reconstruct biologically sound models for all datasets, in most cases correctly grouping cells based on known types. In contrast, several other pseudo-time scRNA-Seq analysis methods were unable to correctly reconstruct models for at least some of these studies highlighting the advantage of integrating expression and regulation data.</p>
    <p>Beyond the construction of the models and cell assignments to specific positions, CSHMM-TF identifies several TFs as regulating key aspects of the processes. Analysis of the TFs identified for the different biological systems studied supports these assignments since many of them are known to play important roles in those process while others represent novel predictions about the regulation of specific branching events. In addition to the list of TFs, CSHMM-TF provides information about potential combinatorial and causal relationships between TFs assigned to the same path. As we showed, TFs assigned to the beginning of paths are often interacting and in some cases early and late TFs are interacting as well. In these cases CSHMM-TF provides information on the dynamics of the assembly process of TF complexes which, without the detailed trajectories provided by scRNA-Seq would have been hard to do.</p>
    <p>CSHMM-TF can also be complimentary to current analysis methods that are based on identifying DE TFs. For the liver data, we found that PITX2, a known liver development TF [<xref rid="pcbi.1007644.ref035" ref-type="bibr">35</xref>], appears in paths P6 for the DE while it appears as regulating a later path, P12, for CSHMM-TF. This likely means that while PITX2 is first DE early, its impact and regulatory role are only observed later in the developmental process. Such joint analysis can further improve the confidence in the identified TFs.</p>
    <p>While CSHMM-TF was successful in analyzing several biological systems, there are certainly many places where it can be improved. First, CSHMM-TF relies on a predefined list of TF-gene interactions, and this is likely incomplete preventing the method from identifying additional key TFs. In addition, while the method is able to identify interacting TFs, the model for their impact is additive and so it would be hard for this method to identify more complex relationships (for example, AND and OR types).</p>
    <p>CSHMM-TF is implemented in python and is available from github (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessica1338/CSHMM-TF-for-time-series-scRNA-Seq.git">https://github.com/jessica1338/CSHMM-TF-for-time-series-scRNA-Seq.git</ext-link>). We believe that CSHMM-TF represents a useful first step in utilizing the detailed information provided by scRNA-Seq data to infer the dynamics of TF activation.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec010">
    <title>Materials and methods</title>
    <sec id="sec011">
      <title>Data collection and processing</title>
      <p>We tested our method on five publicly available time-series scRNA-Seq datasets in human and mouse. The number of cells in the datasets ranged from 152 (mouse lung data) to ∼ 21K (mouse cortex data). Datasets were processed by removing genes with overall low expression (following [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>]). Following this step the number of genes in the models ranged from 10-18K. Details about the datasets are provided in Results, and data processing information is available in the <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting methods. Details about how TF-gene interaction information is obtained is provided in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting methods.</p>
    </sec>
    <sec id="sec012">
      <title>CSHMM-TF formulation</title>
      <p>Continuous State HMMs (CSHMM) differs from standard HMMs in the number of states each can have. While HMMs have a (finite) well defined set of states, CSHMM can have infinitely many states (which we use to represent continuous time of cells). CSHMM-TF extends the formulation of CSHMM for time-series scRNA-Seq data (first presented in [<xref rid="pcbi.1007644.ref021" ref-type="bibr">21</xref>]) by adding TF regulation information to each path (edge). In addition, the model also assigns the <italic>time at which a TF is impacting its targets</italic>. The model assigns both activators and repressor TFs. For simplicity we are using the term “TF activation” when discussing this assignment though the actual direction of the impact is calculated independently of the timing assignment and as mentioned above can be either positive or negative. Our method uses TF targets to infer TF activity since several prior studies have shown that the expression of many TFs does not adequately reflect their activation profiles as many of them are post-transcriptionally and post-transcriptionally regulated. In contrast, the activity of target genes is often a better proxy for TF activity [<xref rid="pcbi.1007644.ref060" ref-type="bibr">60</xref>]. The assignment of continuous activation time also allows the model to infer combinatorial regulatory relationships (if two TFs are assigned to regulate the same path) and in some cases to infer the order of the recruitment process for different TFs regulating the same gene. <xref ref-type="fig" rid="pcbi.1007644.g001">Fig 1</xref> presents the CSHMM-TF structure. In the figure, we denote a few states as split nodes (<italic>D</italic><sub>0</sub> ∼ <italic>D</italic><sub>3</sub> nodes). These are the states in which cells are allowed to split to two or more branches and they represent important split stages for cell lineages. The edges between split nodes are denoted as paths (<italic>p</italic><sub>0</sub> ∼ <italic>p</italic><sub>2</sub>) and each contains infinitely many states such that each point on a path corresponds to an state. States are parametrized by their location w.r.t the two split nodes at the end of the path they reside on. Each of the split nodes is associated with a branch probability <italic>B</italic>. For each state (including split nodes), we define an emission probability by determining parameters for a multivariate Gaussian distribution which, following previous work, assumes independence for gene specific expression levels conditioned on the state [<xref rid="pcbi.1007644.ref061" ref-type="bibr">61</xref>]. The main difference between CSHMM-TF and CSHMM is that the formulation of CSHMM-TF utilizes TF-gene interaction information to change the likelihood function of cell assignments to paths. The assignment of a TF to path, and its inferred activation time (<italic>t</italic><sub><italic>start</italic></sub>) directly affects the emission probability of cells assigned to locations on the paths that follow the start time of the TF. To formulate the emission probabilities in CSHMM-TF we use <italic>s</italic><sub><italic>p</italic>,<italic>t</italic></sub> to represent a specific state where 0 ≤ <italic>t</italic> ≤ 1 is a pseudo time on path <italic>p</italic>(<italic>D</italic><sub><italic>a</italic></sub> → <italic>D</italic><sub><italic>b</italic></sub>), and <italic>a</italic>, <italic>b</italic> are the indices of split nodes. Denote by <inline-formula id="pcbi.1007644.e001"><alternatives><graphic xlink:href="pcbi.1007644.e001.jpg" id="pcbi.1007644.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> the expression of gene <italic>j</italic> in cell <italic>i</italic>, the emission probability for gene <italic>j</italic> in cell <italic>i</italic> assigned to state <italic>s</italic><sub><italic>p</italic>,<italic>t</italic></sub> is modeled as a Gaussian distribution with mean <inline-formula id="pcbi.1007644.e002"><alternatives><graphic xlink:href="pcbi.1007644.e002.jpg" id="pcbi.1007644.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and variance <italic>σ</italic><sub><italic>j</italic></sub>:
<disp-formula id="pcbi.1007644.e003"><alternatives><graphic xlink:href="pcbi.1007644.e003.jpg" id="pcbi.1007644.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mfrac><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
Where
<disp-formula id="pcbi.1007644.e004"><alternatives><graphic xlink:href="pcbi.1007644.e004.jpg" id="pcbi.1007644.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>Here, <italic>θ</italic> is the set of model parameters (see <xref rid="pcbi.1007644.t002" ref-type="table">Table 2</xref>). <italic>g</italic><sub><italic>aj</italic></sub> is the mean expression for gene <italic>j</italic> at split node <italic>a</italic>. We assume a continuous change in expression for a subset of the genes along a path (from left split node <italic>g</italic><sub><italic>a</italic></sub> to right split node <italic>g</italic><sub><italic>b</italic></sub> with a mixture weight <italic>w</italic><sub><italic>j</italic></sub> = exp(−<italic>K</italic><sub><italic>p</italic>,<italic>j</italic></sub>
<italic>t</italic>′)). Note that this weight is gene specific and depends in part on the TFs predicted to regulate that gene. To allow different genes to change non-linearly at different rates across the path (some at the beginning while others at the end) we use a gene specific parameter <italic>K</italic><sub><italic>p</italic>,<italic>j</italic></sub> to denote the rate of change. For genes regulated by TFs that do not change at the start of the path we use <italic>t</italic>′ = max(0, <italic>t</italic> − <italic>t</italic><sub><italic>start</italic></sub>). Here, <italic>t</italic> is the time assignment of the cell, <italic>t</italic><sub><italic>j</italic>,<italic>start</italic></sub> is the TF activation time for TF regulating gene <italic>j</italic>, which we discuss in more detail below. For genes not regulated by any TF assigned to this path, or those regulated by TFs that are activated at the start of the path, <italic>t</italic>′ = max(0, <italic>t</italic> − <italic>t</italic><sub><italic>start</italic></sub>) is equal to <italic>t</italic>. We also attempted to include dropout probability using a mixture weight model in the emission probability, however, this did not change the performance of CSHMM-TF much and so is omitted here. These notations are enough to define the parameters required to specify a CSHMM-TF: <italic>θ</italic> = (<italic>V</italic>, <italic>π</italic>, <italic>S</italic>, <italic>A</italic>, <italic>E</italic>′). All symbol definitions are presented in <xref rid="pcbi.1007644.t002" ref-type="table">Table 2</xref>. In <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods we prove that our definition of CSHMM-TF leads to a valid continuous state HMM and also provide additional details of the definition of transition probabilities for CSHMM-TF.</p>
      <table-wrap id="pcbi.1007644.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Parameters of the CSHMM-TF model: <italic>θ</italic><sub><italic>CSHMM</italic>−<italic>TF</italic></sub> = (<italic>V</italic>, <italic>π</italic>, <italic>S</italic>, <italic>A</italic>, <italic>E</italic>′).</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007644.t002g" xlink:href="pcbi.1007644.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">symbol</th>
                <th align="left" rowspan="1" colspan="1">definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>V</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the observation alphabet <inline-formula id="pcbi.1007644.e005"><alternatives><graphic id="pcbi.1007644.e005g" xlink:href="pcbi.1007644.e005"/><mml:math id="M5"><mml:mrow><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> (the possible input set)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>π</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the initial probability for each state, <inline-formula id="pcbi.1007644.e006"><alternatives><graphic id="pcbi.1007644.e006g" xlink:href="pcbi.1007644.e006"/><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>S</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the set of states (each path has infinitely many states)<break/><italic>s</italic><sub><italic>p</italic>,<italic>t</italic></sub> denotes the hidden state of path <italic>p</italic>, pseudo time <italic>t</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>B</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the branch probability defined on each pair of paths, ∑<sub><italic>j</italic>∈<italic>P</italic></sub>
<italic>B</italic><sub><italic>i</italic>,<italic>j</italic></sub> = 1, 0 ≤ <italic>B</italic><sub><italic>i</italic>,<italic>j</italic></sub> ≤ 1   ∀<italic>i</italic>, <italic>j</italic> ∈ <italic>P</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the transition probability defined on any pair of states <inline-formula id="pcbi.1007644.e007"><alternatives><graphic id="pcbi.1007644.e007g" xlink:href="pcbi.1007644.e007"/><mml:math id="M7"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007644.e008"><alternatives><graphic id="pcbi.1007644.e008g" xlink:href="pcbi.1007644.e008"/><mml:math id="M8"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>E</italic>′ = (<italic>K</italic>, <italic>g</italic>, <italic>σ</italic><sup>2</sup>, Ω, Φ)</td>
                <td align="left" rowspan="1" colspan="1">the parameters associated with emission probability for a given state</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>K</italic>
                </td>
                <td align="left" rowspan="1" colspan="1"><inline-formula id="pcbi.1007644.e009"><alternatives><graphic id="pcbi.1007644.e009g" xlink:href="pcbi.1007644.e009"/><mml:math id="M9"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>K</italic><sub><italic>p</italic>,<italic>j</italic></sub> denotes the gene changing speed for gene <italic>j</italic> at path <italic>p</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>g</italic>
                </td>
                <td align="left" rowspan="1" colspan="1"><inline-formula id="pcbi.1007644.e010"><alternatives><graphic id="pcbi.1007644.e010g" xlink:href="pcbi.1007644.e010"/><mml:math id="M10"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>g</italic><sub><italic>d</italic>,<italic>j</italic></sub> denotes the mean gene expression of gene <italic>j</italic> for split nodes <italic>d</italic><break/><italic>g</italic><sub><italic>d</italic></sub> denotes the mean gene expression vector of split node <italic>d</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1007644.e011">
                    <alternatives>
                      <graphic id="pcbi.1007644.e011g" xlink:href="pcbi.1007644.e011"/>
                      <mml:math id="M11">
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>σ</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                          <mml:mo>⊂</mml:mo>
                          <mml:msup>
                            <mml:mi mathvariant="double-struck">R</mml:mi>
                            <mml:mi>G</mml:mi>
                          </mml:msup>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">the variance vector for genes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1007644.e012">
                    <alternatives>
                      <graphic id="pcbi.1007644.e012g" xlink:href="pcbi.1007644.e012"/>
                      <mml:math id="M12">
                        <mml:mrow>
                          <mml:mo>Ω</mml:mo>
                          <mml:mo>⊂</mml:mo>
                          <mml:msup>
                            <mml:mi mathvariant="double-struck">R</mml:mi>
                            <mml:mrow>
                              <mml:mi>G</mml:mi>
                              <mml:mo>×</mml:mo>
                              <mml:mo>|</mml:mo>
                              <mml:mi>F</mml:mi>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">the matrix where each entry Ω<sub><italic>i</italic>,<italic>j</italic></sub> is 0 or 1 denoting whether gene <italic>i</italic> is regulated by TF <italic>j</italic> or not</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1007644.e013">
                    <alternatives>
                      <graphic id="pcbi.1007644.e013g" xlink:href="pcbi.1007644.e013"/>
                      <mml:math id="M13">
                        <mml:mrow>
                          <mml:mo>Φ</mml:mo>
                          <mml:mo>⊂</mml:mo>
                          <mml:msup>
                            <mml:mi mathvariant="double-struck">R</mml:mi>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mi>P</mml:mi>
                              <mml:mo>|</mml:mo>
                              <mml:mo>×</mml:mo>
                              <mml:mo>|</mml:mo>
                              <mml:mi>F</mml:mi>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">the matrix where each entry Φ<sub><italic>i</italic>,<italic>j</italic></sub> denoting the relationship of path <italic>i</italic> and TF <italic>j</italic>. Where -1 means no relationship, 0 ≤ <italic>t</italic><sub><italic>start</italic></sub> ≤ 0.5 means TF <italic>j</italic> is assigned to path <italic>i</italic> with time <italic>t</italic><sub><italic>start</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the set of split points</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>P</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the set of paths</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>G</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the number of genes (dimension of data)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>F</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">the set of TFs</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">λ<sub><italic>g</italic></sub></td>
                <td align="left" rowspan="1" colspan="1">the hyper parameter for the L1 regularization that controls the sparsity of Δ<italic>g</italic> for every path <italic>p</italic></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec013">
      <title>Assigning regulating TFs to each path</title>
      <p>To predict regulating TFs for each path we extend methods that only allow discrete time assignments to TF activity [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>]. We first remove TFs that are expressed in less than 20% of cells in the path. Next, we determine differentially expressed (DE) genes by performing a t-test between cells assigned to the current and parent path (<xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods). After we identify the set of DE genes, we use the TF-target information (Ω parameter) obtained from [<xref rid="pcbi.1007644.ref024" ref-type="bibr">24</xref>, <xref rid="pcbi.1007644.ref062" ref-type="bibr">62</xref>] to calculate the p-value (based on hyper-geometric distribution) for each TF for this path. Details about the how the TF-target information is provided in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods. We keep TFs with a p-value ≤ 0.05 (p-value obtained by binomial test) with an upper bound of 10 TF for each path. The method for assigning TFs in each path is presented in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods (in the section “Assigning pseudo time to TF regulating a path”).</p>
    </sec>
    <sec id="sec014">
      <title>Adjusting regularization parameters based on TF assignments</title>
      <p>We assume that most genes do not change in a specific path (i.e. developmental branching is only affecting a subset of the genes). Based on this we regularize the gene expression difference vector (Δ<italic>g</italic>) which represent the change in expression for each gene between the two nodes that define a path (start and end). We use a L1 regularization with parameter λ<sub><italic>g</italic></sub>, where larger λ<sub><italic>g</italic></sub> means more strict regulation. To incorporate TF information to this regularization (given our assumption that genes regulated by path specific TFs are more likely to change in that path) we use instead <inline-formula id="pcbi.1007644.e014"><alternatives><graphic xlink:href="pcbi.1007644.e014.jpg" id="pcbi.1007644.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mfrac><mml:msub><mml:mo>λ</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> as the regularization term. Here <italic>α</italic><sub><italic>p</italic>,<italic>j</italic></sub> is the probability that the expression of gene <italic>j</italic> will change along path <italic>p</italic> (and so the higher the probability the lower the regularization for gene <italic>j</italic>). <italic>α</italic><sub><italic>p</italic>,<italic>j</italic></sub> is estimated by fitting a logistic regression model for all genes regulated by TFs on path <italic>p</italic>. Such changes in the regularization parameters allow genes that are targets of assigned TFs to change more than other genes for which no explanation for change in expression is determined by the model.</p>
    </sec>
    <sec id="sec015">
      <title>Likelihood function for the CSHMM-TF model</title>
      <p>We use the following notations: we assume we have <italic>N</italic> cells. Let <italic>X</italic><sup><italic>i</italic></sup> denote the expression profile of cell <italic>i</italic> and let <inline-formula id="pcbi.1007644.e015"><alternatives><graphic xlink:href="pcbi.1007644.e015.jpg" id="pcbi.1007644.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be the hidden state denoting that cell <italic>i</italic> is assigned to path <italic>p</italic> with pseudo time <italic>t</italic>. Δ<italic>g</italic><sub><italic>p</italic></sub> is the difference vector for the expression values at the endpoints of path <italic>p</italic>. Using notations defined above the log-likelihood with L1 regularization term is:
<disp-formula id="pcbi.1007644.e016"><alternatives><graphic xlink:href="pcbi.1007644.e016.jpg" id="pcbi.1007644.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo form="prefix">log</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo form="prefix">log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtext>L1</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>regularization</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>term</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:mo form="prefix">log</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo form="prefix">log</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mo>λ</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
Where,
<disp-formula id="pcbi.1007644.e017"><alternatives><graphic xlink:href="pcbi.1007644.e017.jpg" id="pcbi.1007644.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mtext>branch</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>probability</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>from</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>root</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4.pt"/><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>q</mml:mi><mml:mspace width="1.em"/><mml:mspace width="4.pt"/><mml:mo>(</mml:mo><mml:mtext>the</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>branch</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>probability</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pcbi.1007644.e018"><alternatives><graphic xlink:href="pcbi.1007644.e018.jpg" id="pcbi.1007644.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mspace width="1.em"/><mml:mspace width="4.pt"/><mml:mtext>(the</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>emission</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>probability)</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mfrac><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
      <p>Where (<italic>g</italic><sub><italic>a</italic></sub>, <italic>g</italic><sub><italic>b</italic></sub>) refers to the mean gene expression of the split point at both ends of a path. Briefly, the log-likelihood shown in <xref ref-type="disp-formula" rid="pcbi.1007644.e016">Eq 2</xref> contains three terms. The first, further expanded in <xref ref-type="disp-formula" rid="pcbi.1007644.e018">Eq 4</xref>, represents the emission probability of each cell. Note that in this part we use a modified cell time <italic>t</italic>′ as we have discussed previously. The second, expanded in <xref ref-type="disp-formula" rid="pcbi.1007644.e017">Eq 3</xref>, represents the penalty we use for cells assigned on later (more specific) paths. The idea is similar to prior probabilistic methods for reconstructing branching trajectories [<xref rid="pcbi.1007644.ref014" ref-type="bibr">14</xref>]: earlier stages are often less specific (higher entropy [<xref rid="pcbi.1007644.ref063" ref-type="bibr">63</xref>], while later stages (representing specific fates) have a tighter expression profile. Thus, cells that represent specific cell types will still be assigned to their correct (late) stage based on their expression profile while noisier cells would be assigned to the earlier stages. The last term in <xref ref-type="disp-formula" rid="pcbi.1007644.e016">Eq 2</xref> is the new L1 regularization term, where the L1 parameter has been replaced as we have discussed previously.</p>
    </sec>
    <sec id="sec016">
      <title>Model initialization, learning and continuous cell assignments</title>
      <p>For model initialization, the advantages of the SCDIFF initialization method [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>] for CSHMMs have been previously discussed in [<xref rid="pcbi.1007644.ref021" ref-type="bibr">21</xref>]. Based on these results we use the same initialization for CSHMM-TF as well. Specifically, we first construct a discrete branching model based on the time-series scRNA-Seq data only. This step includes performing clustering for each time point, adjusting the level of the clusters based on time point information, and constructing a tree-branching model from the clusters. While initial assignment is based on the time information, cells can be re-assigned to different tree branches (representing other time points) as part of the iterative learning of the model. In this model, which uses prior methods for pseudotime ordering (SCDIFF [<xref rid="pcbi.1007644.ref015" ref-type="bibr">15</xref>]) cells are assigned to discrete nodes rather than continuously to paths, and no TF information is used. Next, we assign cells in each internal node to a random location along the corresponding developmental path that is incoming to that node leading to an initial continuous model. Details about model initialization for CSHMM-TF are presented in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods. For model learning and continuous cell assignments, we adopt the Expectation-Maximization algorithm (EM), where in the E-step we do the continuous cell assignments; in the M-step we try to maximize the likelihood of CSHMM-TF with Maximum Likelihood Estimation (MLE) and sampling. We iterate between E-step and M-step to improve the likelihood of the model. <xref ref-type="fig" rid="pcbi.1007644.g005">Fig 5</xref> presents a flowchart for the steps used when learning CSHMM-TF. Details about parameter learning for CSHMM-TF are also presented in <xref ref-type="supplementary-material" rid="pcbi.1007644.s001">S1 Appendix</xref> Supporting Methods.</p>
      <fig id="pcbi.1007644.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007644.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>flow chart of how to iteratively learn CSHMM-TF.</title>
        </caption>
        <graphic xlink:href="pcbi.1007644.g005"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec017">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007644.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Supporting methods and results.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007644.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007644.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Cacchiarelli</surname><given-names>D</given-names></name>, <name><surname>Grimsby</surname><given-names>J</given-names></name>, <name><surname>Pokharel</surname><given-names>P</given-names></name>, <name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Morse</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nature biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><?supplied-pmid 24658644?><pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Shalek</surname><given-names>AK</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Adiconis</surname><given-names>X</given-names></name>, <name><surname>Gertner</surname><given-names>RS</given-names></name>, <name><surname>Gaublomme</surname><given-names>JT</given-names></name>, <name><surname>Raychowdhury</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>. <source>Nature</source>. <year>2013</year>;<volume>498</volume>(<issue>7453</issue>):<fpage>236</fpage><pub-id pub-id-type="doi">10.1038/nature12172</pub-id><?supplied-pmid 23685454?><pub-id pub-id-type="pmid">23685454</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Treutlein</surname><given-names>B</given-names></name>, <name><surname>Brownfield</surname><given-names>DG</given-names></name>, <name><surname>Wu</surname><given-names>AR</given-names></name>, <name><surname>Neff</surname><given-names>NF</given-names></name>, <name><surname>Mantalas</surname><given-names>GL</given-names></name>, <name><surname>Espinoza</surname><given-names>FH</given-names></name>, <etal>et al</etal><article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single cell RNA-seq</article-title>. <source>Nature</source>. <year>2014</year>;<volume>509</volume>(<issue>7500</issue>):<fpage>371</fpage><pub-id pub-id-type="doi">10.1038/nature13173</pub-id><?supplied-pmid 24739965?><pub-id pub-id-type="pmid">24739965</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Treutlein</surname><given-names>B</given-names></name>, <name><surname>Lee</surname><given-names>QY</given-names></name>, <name><surname>Camp</surname><given-names>JG</given-names></name>, <name><surname>Mall</surname><given-names>M</given-names></name>, <name><surname>Koh</surname><given-names>W</given-names></name>, <name><surname>Shariati</surname><given-names>SAM</given-names></name>, <etal>et al</etal><article-title>Dissecting direct reprogramming from fibroblast to neuron using single-cell RNA-seq</article-title>. <source>Nature</source>. <year>2016</year>;<volume>534</volume>(<issue>7607</issue>):<fpage>391</fpage><pub-id pub-id-type="doi">10.1038/nature18323</pub-id><?supplied-pmid 27281220?><pub-id pub-id-type="pmid">27281220</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Skelly</surname><given-names>DA</given-names></name>, <name><surname>Squiers</surname><given-names>GT</given-names></name>, <name><surname>McLellan</surname><given-names>MA</given-names></name>, <name><surname>Bolisetty</surname><given-names>MT</given-names></name>, <name><surname>Robson</surname><given-names>P</given-names></name>, <name><surname>Rosenthal</surname><given-names>NA</given-names></name>, <etal>et al</etal><article-title>Single-cell transcriptional profiling reveals cellular diversity and intercommunication in the mouse heart</article-title>. <source>Cell reports</source>. <year>2018</year>;<volume>22</volume>(<issue>3</issue>):<fpage>600</fpage>–<lpage>610</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2017.12.072</pub-id><?supplied-pmid 29346760?><pub-id pub-id-type="pmid">29346760</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Haghverdi</surname><given-names>L</given-names></name>, <name><surname>Buettner</surname><given-names>M</given-names></name>, <name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Buettner</surname><given-names>F</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>. <source>Nature methods</source>. <year>2016</year>;<volume>13</volume>(<issue>10</issue>):<fpage>845</fpage><pub-id pub-id-type="doi">10.1038/nmeth.3971</pub-id><?supplied-pmid 27571553?><pub-id pub-id-type="pmid">27571553</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Rizvi</surname><given-names>AH</given-names></name>, <name><surname>Camara</surname><given-names>PG</given-names></name>, <name><surname>Kandror</surname><given-names>EK</given-names></name>, <name><surname>Roberts</surname><given-names>TJ</given-names></name>, <name><surname>Schieren</surname><given-names>I</given-names></name>, <name><surname>Maniatis</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Single-cell topological RNA-seq analysis reveals insights into cellular differentiation and development</article-title>. <source>Nature Biotechnology</source>. <year>2017</year>;<volume>35</volume>(<issue>6</issue>):<fpage>551</fpage>–<lpage>560</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3854</pub-id><?supplied-pmid 28459448?><pub-id pub-id-type="pmid">28459448</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bendall</surname><given-names>SC</given-names></name>, <name><surname>Davis</surname><given-names>KL</given-names></name>, <name><surname>Amir</surname><given-names>EaD</given-names></name>, <name><surname>Tadmor</surname><given-names>MD</given-names></name>, <name><surname>Simonds</surname><given-names>EF</given-names></name>, <name><surname>Chen</surname><given-names>TJ</given-names></name>, <etal>et al</etal><article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>. <year>2014</year>;<volume>157</volume>(<issue>3</issue>):<fpage>714</fpage>–<lpage>725</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2014.04.005</pub-id><?supplied-pmid 24766814?><pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Reid</surname><given-names>JE</given-names></name>, <name><surname>Wernisch</surname><given-names>L</given-names></name>. <article-title>Pseudotime estimation: deconfounding single cell time series</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>19</issue>):<fpage>2973</fpage>–<lpage>2980</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw372</pub-id><?supplied-pmid 27318198?><pub-id pub-id-type="pmid">27318198</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lönnberg</surname><given-names>T</given-names></name>, <name><surname>Svensson</surname><given-names>V</given-names></name>, <name><surname>James</surname><given-names>KR</given-names></name>, <name><surname>Fernandez-Ruiz</surname><given-names>D</given-names></name>, <name><surname>Sebina</surname><given-names>I</given-names></name>, <name><surname>Montandon</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Single-cell RNA-seq and computational analysis using temporal mixture modelling resolves Th1/Tfh fate bifurcation in malaria</article-title>. <source>Science immunology</source>. <year>2017</year>;<volume>2</volume>(<issue>9</issue>). <pub-id pub-id-type="doi">10.1126/sciimmunol.aal2192</pub-id><?supplied-pmid 28345074?><pub-id pub-id-type="pmid">28345074</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Street</surname><given-names>K</given-names></name>, <name><surname>Risso</surname><given-names>D</given-names></name>, <name><surname>Fletcher</surname><given-names>RB</given-names></name>, <name><surname>Das</surname><given-names>D</given-names></name>, <name><surname>Ngai</surname><given-names>J</given-names></name>, <name><surname>Yosef</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>. <source>BMC genomics</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>477</fpage><pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id><?supplied-pmid 29914354?><pub-id pub-id-type="pmid">29914354</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Hamey</surname><given-names>FK</given-names></name>, <name><surname>Plass</surname><given-names>M</given-names></name>, <name><surname>Solana</surname><given-names>J</given-names></name>, <name><surname>Dahlin</surname><given-names>JS</given-names></name>, <name><surname>Göttgens</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>59</fpage><pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id><?supplied-pmid 30890159?><pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Marco</surname><given-names>E</given-names></name>, <name><surname>Karp</surname><given-names>RL</given-names></name>, <name><surname>Guo</surname><given-names>G</given-names></name>, <name><surname>Robson</surname><given-names>P</given-names></name>, <name><surname>Hart</surname><given-names>AH</given-names></name>, <name><surname>Trippa</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>52</issue>):<fpage>E5643</fpage>–<lpage>E5650</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1408993111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Rashid</surname><given-names>S</given-names></name>, <name><surname>Kotton</surname><given-names>DN</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>TASIC: determining branching models from time series single cell data</article-title>. <source>Bioinformatics</source>. <year>2017</year>; p. <fpage>btx173</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>J</given-names></name>, <name><surname>Aronow</surname><given-names>B</given-names></name>, <name><surname>Kaminski</surname><given-names>N</given-names></name>, <name><surname>Kitzmiller</surname><given-names>J</given-names></name>, <name><surname>Whitsett</surname><given-names>J</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>Reconstructing differentiation networks and their regulation from time series single cell expression data</article-title>. <source>Genome research</source>. <year>2018</year>; p. gr–225979. <pub-id pub-id-type="doi">10.1101/gr.225979.117</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>da Rocha</surname><given-names>EL</given-names></name>, <name><surname>Rowe</surname><given-names>RG</given-names></name>, <name><surname>Lundin</surname><given-names>V</given-names></name>, <name><surname>Malleshaiah</surname><given-names>M</given-names></name>, <name><surname>Jha</surname><given-names>DK</given-names></name>, <name><surname>Rambo</surname><given-names>CR</given-names></name>, <etal>et al</etal><article-title>Reconstruction of complex single-cell trajectories using CellRouter</article-title>. <source>Nature communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>892</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-03214-y</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Zheng</surname><given-names>J</given-names></name>. <article-title>HopLand: single-cell pseudotime recovery using continuous Hopfield network-based modeling of Waddington’s epigenetic landscape</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>14</issue>):<fpage>i102</fpage>–<lpage>i109</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx232</pub-id><?supplied-pmid 28881967?><pub-id pub-id-type="pmid">28881967</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>, <name><surname>Gitter</surname><given-names>A</given-names></name>, <name><surname>Simon</surname><given-names>I</given-names></name>. <article-title>Studying and modelling dynamic biological processes using time-series gene expression data</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>13</volume>(<issue>8</issue>):<fpage>552</fpage>–<lpage>564</lpage>. <pub-id pub-id-type="doi">10.1038/nrg3244</pub-id><?supplied-pmid 22805708?><pub-id pub-id-type="pmid">22805708</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Cacchiarelli</surname><given-names>D</given-names></name>, <name><surname>Grimsby</surname><given-names>J</given-names></name>, <name><surname>Pokharel</surname><given-names>P</given-names></name>, <name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Morse</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Pseudo-temporal ordering of individual cells reveals dynamics and regulators of cell fate decisions</article-title>. <source>Nature biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>4</issue>):<fpage>381</fpage><?supplied-pmid 24658644?><pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref020">
      <label>20</label>
      <mixed-citation publication-type="book"><name><surname>Ainsleigh</surname><given-names>PL</given-names></name>. <source>Theory of continuous-state hidden Markov models and hidden Gauss-Markov models</source>. <year>2001</year>;.</mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>C</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>Continuous-state HMMs for modeling time-series single-cell RNA-Seq data</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>22</issue>):<fpage>4707</fpage>–<lpage>4715</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz296</pub-id><?supplied-pmid 31038684?><pub-id pub-id-type="pmid">31038684</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Camp</surname><given-names>JG</given-names></name>, <name><surname>Sekine</surname><given-names>K</given-names></name>, <name><surname>Gerber</surname><given-names>T</given-names></name>, <name><surname>Loeffler-Wirth</surname><given-names>H</given-names></name>, <name><surname>Binder</surname><given-names>H</given-names></name>, <name><surname>Gac</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Multilineage communication regulates human liver bud development from pluripotency</article-title>. <source>Nature</source>. <year>2017</year>;<volume>546</volume>(<issue>7659</issue>):<fpage>533</fpage><pub-id pub-id-type="doi">10.1038/nature22796</pub-id><?supplied-pmid 28614297?><pub-id pub-id-type="pmid">28614297</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Mayer</surname><given-names>C</given-names></name>, <name><surname>Hafemeister</surname><given-names>C</given-names></name>, <name><surname>Bandler</surname><given-names>RC</given-names></name>, <name><surname>Machold</surname><given-names>R</given-names></name>, <name><surname>Brito</surname><given-names>RB</given-names></name>, <name><surname>Jaglin</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Developmental diversification of cortical inhibitory interneurons</article-title>. <source>Nature</source>. <year>2018</year>;<volume>555</volume>(<issue>7697</issue>):<fpage>457</fpage><pub-id pub-id-type="doi">10.1038/nature25999</pub-id><?supplied-pmid 29513653?><pub-id pub-id-type="pmid">29513653</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Schulz</surname><given-names>MH</given-names></name>, <name><surname>Devanny</surname><given-names>WE</given-names></name>, <name><surname>Gitter</surname><given-names>A</given-names></name>, <name><surname>Zhong</surname><given-names>S</given-names></name>, <name><surname>Ernst</surname><given-names>J</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>DREM 2.0: Improved reconstruction of dynamic regulatory networks from time-series expression data</article-title>. <source>BMC systems biology</source>. <year>2012</year>;<volume>6</volume>(<issue>1</issue>):<fpage>104</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-6-104</pub-id><?supplied-pmid 22897824?><pub-id pub-id-type="pmid">22897824</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Greenfield</surname><given-names>A</given-names></name>, <name><surname>Hafemeister</surname><given-names>C</given-names></name>, <name><surname>Bonneau</surname><given-names>R</given-names></name>. <article-title>Robust data-driven incorporation of prior knowledge into the inference of dynamic regulatory networks</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>8</issue>):<fpage>1060</fpage>–<lpage>1067</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt099</pub-id><?supplied-pmid 23525069?><pub-id pub-id-type="pmid">23525069</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Villaverde</surname><given-names>AF</given-names></name>, <name><surname>Ross</surname><given-names>J</given-names></name>, <name><surname>Morán</surname><given-names>F</given-names></name>, <name><surname>Banga</surname><given-names>JR</given-names></name>. <article-title>MIDER: network inference with mutual information distance and entropy reduction</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>5</issue>):<fpage>e96732</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0096732</pub-id><?supplied-pmid 24806471?><pub-id pub-id-type="pmid">24806471</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Le Lay</surname><given-names>J</given-names></name>, <name><surname>Kaestner</surname><given-names>KH</given-names></name>. <article-title>The Fox genes in the liver: from organogenesis to functional integration</article-title>. <source>Physiological reviews</source>. <year>2010</year>;<volume>90</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.1152/physrev.00018.2009</pub-id><?supplied-pmid 20086072?><pub-id pub-id-type="pmid">20086072</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>J</given-names></name>, <name><surname>Yu</surname><given-names>S</given-names></name>, <name><surname>Jiang</surname><given-names>Z</given-names></name>, <name><surname>Shi</surname><given-names>C</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Du</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Microarray comparison of the gene expression profiles in the adult vs. embryonic day 14 rat liver</article-title>. <source>Biomedical reports</source>. <year>2014</year>;<volume>2</volume>(<issue>5</issue>):<fpage>664</fpage>–<lpage>670</lpage>. <pub-id pub-id-type="doi">10.3892/br.2014.303</pub-id><?supplied-pmid 25054008?><pub-id pub-id-type="pmid">25054008</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>JS</given-names></name>, <name><surname>Ward</surname><given-names>WO</given-names></name>, <name><surname>Knapp</surname><given-names>G</given-names></name>, <name><surname>Ren</surname><given-names>H</given-names></name>, <name><surname>Vallanat</surname><given-names>B</given-names></name>, <name><surname>Abbott</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Transcriptional ontogeny of the developing liver</article-title>. <source>BMC genomics</source>. <year>2012</year>;<volume>13</volume>(<issue>1</issue>):<fpage>33</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-13-33</pub-id><?supplied-pmid 22260730?><pub-id pub-id-type="pmid">22260730</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Margagliotti</surname><given-names>S</given-names></name>, <name><surname>Clotman</surname><given-names>F</given-names></name>, <name><surname>Pierreux</surname><given-names>CE</given-names></name>, <name><surname>Beaudry</surname><given-names>JB</given-names></name>, <name><surname>Jacquemin</surname><given-names>P</given-names></name>, <name><surname>Rousseau</surname><given-names>GG</given-names></name>, <etal>et al</etal><article-title>The Onecut transcription factors HNF-6/OC-1 and OC-2 regulate early liver expansion by controlling hepatoblast migration</article-title>. <source>Developmental biology</source>. <year>2007</year>;<volume>311</volume>(<issue>2</issue>):<fpage>579</fpage>–<lpage>589</lpage>. <pub-id pub-id-type="doi">10.1016/j.ydbio.2007.09.013</pub-id><?supplied-pmid 17936262?><pub-id pub-id-type="pmid">17936262</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Westmacott</surname><given-names>A</given-names></name>, <name><surname>Burke</surname><given-names>ZD</given-names></name>, <name><surname>Oliver</surname><given-names>G</given-names></name>, <name><surname>Slack</surname><given-names>JM</given-names></name>, <name><surname>Tosh</surname><given-names>D</given-names></name>. <article-title>C/EBP<italic>α</italic> and C/EBP<italic>β</italic> are markers of early liver development</article-title>. <source>The International journal of developmental biology</source>. <year>2006</year>;<volume>50</volume>(<issue>7</issue>):<fpage>653</fpage><pub-id pub-id-type="doi">10.1387/ijdb.062146aw</pub-id><?supplied-pmid 16892179?><pub-id pub-id-type="pmid">16892179</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Goldman</surname><given-names>O</given-names></name>, <name><surname>Cohen</surname><given-names>I</given-names></name>, <name><surname>Gouon-Evans</surname><given-names>V</given-names></name>. <article-title>Functional Blood Progenitor Markers in Developing Human Liver Progenitors</article-title>. <source>Stem cell reports</source>. <year>2016</year>;<volume>7</volume>(<issue>2</issue>):<fpage>158</fpage>–<lpage>166</lpage>. <pub-id pub-id-type="doi">10.1016/j.stemcr.2016.07.008</pub-id><?supplied-pmid 27509132?><pub-id pub-id-type="pmid">27509132</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Paganelli</surname><given-names>M</given-names></name>, <name><surname>Nyabi</surname><given-names>O</given-names></name>, <name><surname>Sid</surname><given-names>B</given-names></name>, <name><surname>Evraerts</surname><given-names>J</given-names></name>, <name><surname>El Malmi</surname><given-names>I</given-names></name>, <name><surname>Heremans</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Downregulation of Sox9 expression associates with hepatogenic differentiation of human liver mesenchymal stem/progenitor cells</article-title>. <source>Stem cells and development</source>. <year>2014</year>;<volume>23</volume>(<issue>12</issue>):<fpage>1377</fpage>–<lpage>1391</lpage>. <pub-id pub-id-type="doi">10.1089/scd.2013.0169</pub-id><?supplied-pmid 24548059?><pub-id pub-id-type="pmid">24548059</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>K</given-names></name>, <name><surname>Battle</surname><given-names>MA</given-names></name>, <name><surname>Misra</surname><given-names>RP</given-names></name>, <name><surname>Duncan</surname><given-names>SA</given-names></name>. <article-title>Hepatocyte expression of serum response factor is essential for liver function, hepatocyte proliferation and survival, and postnatal body growth in mice</article-title>. <source>Hepatology</source>. <year>2009</year>;<volume>49</volume>(<issue>5</issue>):<fpage>1645</fpage>–<lpage>1654</lpage>. <pub-id pub-id-type="doi">10.1002/hep.22834</pub-id><?supplied-pmid 19205030?><pub-id pub-id-type="pmid">19205030</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>F</given-names></name>, <name><surname>Yao</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Yu</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>Q</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Suppressing Pitx2 inhibits proliferation and promotes differentiation of iHepSCs</article-title>. <source>The international journal of biochemistry &amp; cell biology</source>. <year>2016</year>;<volume>80</volume>:<fpage>154</fpage>–<lpage>162</lpage>. <pub-id pub-id-type="doi">10.1016/j.biocel.2016.09.024</pub-id><pub-id pub-id-type="pmid">27697592</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Rockich</surname><given-names>BE</given-names></name>, <name><surname>Hrycaj</surname><given-names>SM</given-names></name>, <name><surname>Shih</surname><given-names>HP</given-names></name>, <name><surname>Nagy</surname><given-names>MS</given-names></name>, <name><surname>Ferguson</surname><given-names>MA</given-names></name>, <name><surname>Kopp</surname><given-names>JL</given-names></name>, <etal>et al</etal><article-title>Sox9 plays multiple roles in the lung epithelium during branching morphogenesis</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>47</issue>):<fpage>E4456</fpage>–<lpage>E4464</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1311847110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Turcatel</surname><given-names>G</given-names></name>, <name><surname>Rubin</surname><given-names>N</given-names></name>, <name><surname>Menke</surname><given-names>DB</given-names></name>, <name><surname>Martin</surname><given-names>G</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Warburton</surname><given-names>D</given-names></name>. <article-title>Lung mesenchymal expression of Sox9 plays a critical role in tracheal development</article-title>. <source>BMC biology</source>. <year>2013</year>;<volume>11</volume>(<issue>1</issue>):<fpage>117</fpage><pub-id pub-id-type="doi">10.1186/1741-7007-11-117</pub-id><?supplied-pmid 24274029?><pub-id pub-id-type="pmid">24274029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>H</given-names></name>, <name><surname>Lu</surname><given-names>MM</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Whitsett</surname><given-names>JA</given-names></name>, <name><surname>Morrisey</surname><given-names>EE</given-names></name>. <article-title>GATA6 regulates differentiation of distal lung epithelium</article-title>. <source>Development</source>. <year>2002</year>;<volume>129</volume>(<issue>9</issue>):<fpage>2233</fpage>–<lpage>2246</lpage>. <?supplied-pmid 11959831?><pub-id pub-id-type="pmid">11959831</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Flodby</surname><given-names>P</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Rieger</surname><given-names>ME</given-names></name>, <name><surname>Minoo</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Cell-specific expression of aquaporin-5 (Aqp5) in alveolar epithelium is directed by GATA6/Sp1 via histone acetylation</article-title>. <source>Scientific reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>3473</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-03152-7</pub-id><?supplied-pmid 28615712?><pub-id pub-id-type="pmid">28615712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Bridges</surname><given-names>JP</given-names></name>, <name><surname>Schehr</surname><given-names>A</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Huo</surname><given-names>L</given-names></name>, <name><surname>Besnard</surname><given-names>V</given-names></name>, <name><surname>Ikegami</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Epithelial SCAP/INSIG/SREBP signaling regulates multiple biological processes during perinatal lung maturation</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>5</issue>):<fpage>e91376</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0091376</pub-id><?supplied-pmid 24806461?><pub-id pub-id-type="pmid">24806461</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Piairo</surname><given-names>P</given-names></name>, <name><surname>Moura</surname><given-names>RS</given-names></name>, <name><surname>Baptista</surname><given-names>MJ</given-names></name>, <name><surname>Correia-Pinto</surname><given-names>J</given-names></name>, <name><surname>Nogueira-Silva</surname><given-names>C</given-names></name>. <article-title>STATs in Lung Development: Distinct Early and Late Expression, Growth Modulation and Signaling Dysregulation in Congenital Diaphragmatic Hernia</article-title>. <source>Cellular Physiology and Biochemistry</source>. <year>2018</year>;<volume>45</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1159/000486218</pub-id><?supplied-pmid 29310117?><pub-id pub-id-type="pmid">29310117</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Boucherat</surname><given-names>O</given-names></name>, <name><surname>Landry-Truchon</surname><given-names>K</given-names></name>, <name><surname>Bérubé-Simard</surname><given-names>FA</given-names></name>, <name><surname>Houde</surname><given-names>N</given-names></name>, <name><surname>Beuret</surname><given-names>L</given-names></name>, <name><surname>Lezmi</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>Epithelial inactivation of Yy1 abrogates lung branching morphogenesis</article-title>. <source>Development</source>. <year>2015</year>;<volume>142</volume>(<issue>17</issue>):<fpage>2981</fpage>–<lpage>2995</lpage>. <pub-id pub-id-type="doi">10.1242/dev.120469</pub-id><?supplied-pmid 26329601?><pub-id pub-id-type="pmid">26329601</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Roos</surname><given-names>AB</given-names></name>, <name><surname>Berg</surname><given-names>T</given-names></name>, <name><surname>Barton</surname><given-names>JL</given-names></name>, <name><surname>Didon</surname><given-names>L</given-names></name>, <name><surname>Nord</surname><given-names>M</given-names></name>. <article-title>Airway epithelial cell differentiation during lung organogenesis requires C/EBP<italic>α</italic> and C/EBP<italic>β</italic></article-title>. <source>Developmental Dynamics</source>. <year>2012</year>;<volume>241</volume>(<issue>5</issue>):<fpage>911</fpage>–<lpage>923</lpage>. <pub-id pub-id-type="doi">10.1002/dvdy.23773</pub-id><?supplied-pmid 22411169?><pub-id pub-id-type="pmid">22411169</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Sandbo</surname><given-names>N</given-names></name>, <name><surname>Kregel</surname><given-names>S</given-names></name>, <name><surname>Taurin</surname><given-names>S</given-names></name>, <name><surname>Bhorade</surname><given-names>S</given-names></name>, <name><surname>Dulin</surname><given-names>NO</given-names></name>. <article-title>Critical role of serum response factor in pulmonary myofibroblast differentiation induced by TGF-<italic>β</italic></article-title>. <source>American journal of respiratory cell and molecular biology</source>. <year>2009</year>;<volume>41</volume>(<issue>3</issue>):<fpage>332</fpage>–<lpage>338</lpage>. <pub-id pub-id-type="doi">10.1165/rcmb.2008-0288OC</pub-id><?supplied-pmid 19151320?><pub-id pub-id-type="pmid">19151320</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Nakamura</surname><given-names>A</given-names></name>, <name><surname>Ebina-Shibuya</surname><given-names>R</given-names></name>, <name><surname>Itoh-Nakadai</surname><given-names>A</given-names></name>, <name><surname>Muto</surname><given-names>A</given-names></name>, <name><surname>Shima</surname><given-names>H</given-names></name>, <name><surname>Saigusa</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Transcription repressor Bach2 is required for pulmonary surfactant homeostasis and alveolar macrophage function</article-title>. <source>Journal of Experimental Medicine</source>. <year>2013</year>; p. jem–20130028. <pub-id pub-id-type="doi">10.1084/jem.20130028</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Poncy</surname><given-names>A</given-names></name>, <name><surname>Antoniou</surname><given-names>A</given-names></name>, <name><surname>Cordi</surname><given-names>S</given-names></name>, <name><surname>Pierreux</surname><given-names>CE</given-names></name>, <name><surname>Jacquemin</surname><given-names>P</given-names></name>, <name><surname>Lemaigre</surname><given-names>FP</given-names></name>. <article-title>Transcription factors SOX4 and SOX9 cooperatively control development of bile ducts</article-title>. <source>Developmental biology</source>. <year>2015</year>;<volume>404</volume>(<issue>2</issue>):<fpage>136</fpage>–<lpage>148</lpage>. <pub-id pub-id-type="doi">10.1016/j.ydbio.2015.05.012</pub-id><?supplied-pmid 26033091?><pub-id pub-id-type="pmid">26033091</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>Q</given-names></name>, <name><surname>Gedrich</surname><given-names>RW</given-names></name>, <name><surname>Engel</surname><given-names>DA</given-names></name>. <article-title>Transcriptional repression of the c-fos gene by YY1 is mediated by a direct interaction with ATF/CREB</article-title>. <source>Journal of virology</source>. <year>1995</year>;<volume>69</volume>(<issue>7</issue>):<fpage>4323</fpage>–<lpage>4330</lpage>. <pub-id pub-id-type="doi">10.1128/JVI.69.7.4323-4330.1995</pub-id><?supplied-pmid 7769693?><pub-id pub-id-type="pmid">7769693</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Van Ginkel</surname><given-names>PR</given-names></name>, <name><surname>Hsiao</surname><given-names>KM</given-names></name>, <name><surname>Schjerven</surname><given-names>H</given-names></name>, <name><surname>Farnham</surname><given-names>PJ</given-names></name>. <article-title>E2F-mediated growth regulation requires transcription factor cooperation</article-title>. <source>Journal of Biological Chemistry</source>. <year>1997</year>;<volume>272</volume>(<issue>29</issue>):<fpage>18367</fpage>–<lpage>18374</lpage>. <pub-id pub-id-type="doi">10.1074/jbc.272.29.18367</pub-id><?supplied-pmid 9218478?><pub-id pub-id-type="pmid">9218478</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Schlisio</surname><given-names>S</given-names></name>, <name><surname>Halperin</surname><given-names>T</given-names></name>, <name><surname>Vidal</surname><given-names>M</given-names></name>, <name><surname>Nevins</surname><given-names>JR</given-names></name>. <article-title>Interaction of YY1 with E2Fs, mediated by RYBP, provides a mechanism for specificity of E2F function</article-title>. <source>The EMBO journal</source>. <year>2002</year>;<volume>21</volume>(<issue>21</issue>):<fpage>5775</fpage>–<lpage>5786</lpage>. <pub-id pub-id-type="doi">10.1093/emboj/cdf577</pub-id><?supplied-pmid 12411495?><pub-id pub-id-type="pmid">12411495</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>Z</given-names></name>, <name><surname>Umek</surname><given-names>RM</given-names></name>, <name><surname>McKnight</surname><given-names>SL</given-names></name>. <article-title>Regulated expression of three C/EBP isoforms during adipose conversion of 3T3-L1 cells</article-title>. <source>Genes &amp; development</source>. <year>1991</year>;<volume>5</volume>(<issue>9</issue>):<fpage>1538</fpage>–<lpage>1552</lpage>. <pub-id pub-id-type="doi">10.1101/gad.5.9.1538</pub-id><pub-id pub-id-type="pmid">1840554</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Müller</surname><given-names>H</given-names></name>, <name><surname>Bracken</surname><given-names>AP</given-names></name>, <name><surname>Vernell</surname><given-names>R</given-names></name>, <name><surname>Moroni</surname><given-names>MC</given-names></name>, <name><surname>Christians</surname><given-names>F</given-names></name>, <name><surname>Grassilli</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>E2Fs regulate the expression of genes involved in differentiation, development, proliferation, and apoptosis</article-title>. <source>Genes &amp; development</source>. <year>2001</year>;<volume>15</volume>(<issue>3</issue>):<fpage>267</fpage>–<lpage>285</lpage>. <pub-id pub-id-type="doi">10.1101/gad.864201</pub-id><pub-id pub-id-type="pmid">11159908</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Chinenov</surname><given-names>Y</given-names></name>, <name><surname>Kerppola</surname><given-names>TK</given-names></name>. <article-title>Close encounters of many kinds: Fos-Jun interactions that mediate transcription regulatory specificity</article-title>. <source>Oncogene</source>. <year>2001</year>;<volume>20</volume>(<issue>19</issue>):<fpage>2438</fpage><pub-id pub-id-type="doi">10.1038/sj.onc.1204385</pub-id><?supplied-pmid 11402339?><pub-id pub-id-type="pmid">11402339</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Kormish</surname><given-names>JD</given-names></name>, <name><surname>Sinner</surname><given-names>D</given-names></name>, <name><surname>Zorn</surname><given-names>AM</given-names></name>. <article-title>Interactions between SOX factors and Wnt/<italic>β</italic>-catenin signaling in development and disease</article-title>. <source>Developmental Dynamics</source>. <year>2010</year>;<volume>239</volume>(<issue>1</issue>):<fpage>56</fpage>–<lpage>68</lpage>. <pub-id pub-id-type="doi">10.1002/dvdy.22046</pub-id><?supplied-pmid 19655378?><pub-id pub-id-type="pmid">19655378</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>NM</given-names></name>, <name><surname>Singh</surname><given-names>G</given-names></name>, <name><surname>Koenig</surname><given-names>A</given-names></name>, <name><surname>Liou</surname><given-names>GY</given-names></name>, <name><surname>Storz</surname><given-names>P</given-names></name>, <name><surname>Zhang</surname><given-names>JS</given-names></name>, <etal>et al</etal><article-title>NFATc1 links EGFR signaling to induction of Sox9 transcription and acinar–ductal transdifferentiation in the pancreas</article-title>. <source>Gastroenterology</source>. <year>2015</year>;<volume>148</volume>(<issue>5</issue>):<fpage>1024</fpage>–<lpage>1034</lpage>. <pub-id pub-id-type="doi">10.1053/j.gastro.2015.01.033</pub-id><?supplied-pmid 25623042?><pub-id pub-id-type="pmid">25623042</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Simmons</surname><given-names>SO</given-names></name>, <name><surname>Horowitz</surname><given-names>JM</given-names></name>. <article-title>Nkx3. 1 binds and negatively regulates the transcriptional activity of Sp-family members in prostate-derived cells</article-title>. <source>Biochemical Journal</source>. <year>2006</year>;<volume>393</volume>(<issue>1</issue>):<fpage>397</fpage>–<lpage>409</lpage>. <pub-id pub-id-type="doi">10.1042/BJ20051030</pub-id><?supplied-pmid 16201967?><pub-id pub-id-type="pmid">16201967</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Schmeier</surname><given-names>S</given-names></name>, <name><surname>Alam</surname><given-names>T</given-names></name>, <name><surname>Essack</surname><given-names>M</given-names></name>, <name><surname>Bajic</surname><given-names>VB</given-names></name>. <article-title>TcoF-DB v2: update of the database of human and mouse transcription co-factors and transcription factor interactions</article-title>. <source>Nucleic acids research</source>. <year>2016</year>; p. gkw1007. <pub-id pub-id-type="doi">10.1093/nar/gkw1007</pub-id><?supplied-pmid 27789689?><pub-id pub-id-type="pmid">27789689</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Campbell</surname><given-names>KR</given-names></name>, <name><surname>Yau</surname><given-names>C</given-names></name>. <article-title>Order under uncertainty: robust differential expression analysis using probabilistic models for pseudotime inference</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>11</issue>):<fpage>e1005212</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005212</pub-id><?supplied-pmid 27870852?><pub-id pub-id-type="pmid">27870852</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Qiu</surname><given-names>X</given-names></name>, <name><surname>Hill</surname><given-names>A</given-names></name>, <name><surname>Packer</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>D</given-names></name>, <name><surname>Ma</surname><given-names>YA</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>. <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>. <source>Nature methods</source>. <year>2017</year>;<volume>14</volume>(<issue>3</issue>):<fpage>309</fpage><pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><?supplied-pmid 28114287?><pub-id pub-id-type="pmid">28114287</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Burke</surname><given-names>ZD</given-names></name>, <name><surname>Reed</surname><given-names>KR</given-names></name>, <name><surname>Yeh</surname><given-names>SW</given-names></name>, <name><surname>Meniel</surname><given-names>V</given-names></name>, <name><surname>Sansom</surname><given-names>OJ</given-names></name>, <name><surname>Clarke</surname><given-names>AR</given-names></name>, <etal>et al</etal><article-title>Spatiotemporal regulation of liver development by the Wnt/<italic>β</italic>-catenin pathway</article-title>. <source>Scientific reports</source>. <year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>2735</fpage><pub-id pub-id-type="doi">10.1038/s41598-018-20888-y</pub-id><?supplied-pmid 29426940?><pub-id pub-id-type="pmid">29426940</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Schacht</surname><given-names>T</given-names></name>, <name><surname>Oswald</surname><given-names>M</given-names></name>, <name><surname>Eils</surname><given-names>R</given-names></name>, <name><surname>Eichmüller</surname><given-names>SB</given-names></name>, <name><surname>König</surname><given-names>R</given-names></name>. <article-title>Estimating the activity of transcription factors by the effect on their target genes</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>17</issue>):<fpage>i401</fpage>–<lpage>i407</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu446</pub-id><?supplied-pmid 25161226?><pub-id pub-id-type="pmid">25161226</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Schulz</surname><given-names>MH</given-names></name>, <name><surname>Pandit</surname><given-names>KV</given-names></name>, <name><surname>Cardenas</surname><given-names>CLL</given-names></name>, <name><surname>Ambalavanan</surname><given-names>N</given-names></name>, <name><surname>Kaminski</surname><given-names>N</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>Reconstructing dynamic microRNA-regulated interaction networks</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>39</issue>):<fpage>15686</fpage>–<lpage>15691</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1303236110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Ernst</surname><given-names>J</given-names></name>, <name><surname>Vainas</surname><given-names>O</given-names></name>, <name><surname>Harbison</surname><given-names>CT</given-names></name>, <name><surname>Simon</surname><given-names>I</given-names></name>, <name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>. <article-title>Reconstructing dynamic regulatory maps</article-title>. <source>Molecular systems biology</source>. <year>2007</year>;<volume>3</volume>(<issue>1</issue>):<fpage>74</fpage><pub-id pub-id-type="doi">10.1038/msb4100115</pub-id><?supplied-pmid 17224918?><pub-id pub-id-type="pmid">17224918</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007644.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Teschendorff</surname><given-names>AE</given-names></name>, <name><surname>Enver</surname><given-names>T</given-names></name>. <article-title>Single-cell entropy for accurate estimation of differentiation potency from a cell’s transcriptome</article-title>. <source>Nature communications</source>. <year>2017</year>;<volume>8</volume>:<fpage>15599</fpage><pub-id pub-id-type="doi">10.1038/ncomms15599</pub-id><?supplied-pmid 28569836?><pub-id pub-id-type="pmid">28569836</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
