<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5668949</article-id>
    <article-id pub-id-type="pmid">29025895</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.220673.117</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accounting for GC-content bias reduces systematic errors and batch effects in ChIP-seq data</article-title>
      <alt-title alt-title-type="left-running">Teng and Irizarry</alt-title>
      <alt-title alt-title-type="right-running">GC-content bias correction in ChIP-seq data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8536-8941</contrib-id>
        <name>
          <surname>Teng</surname>
          <given-names>Mingxiang</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3944-4309</contrib-id>
        <name>
          <surname>Irizarry</surname>
          <given-names>Rafael A.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, Boston, Massachusetts 02215, USA;</aff>
    <aff id="af2"><label>2</label>Department of Biostatistics, Harvard T.H. Chan School of Public Health, Boston, Massachusetts 02115, USA;</aff>
    <aff id="af3"><label>3</label>School of Computer Science and Technology, Harbin Institute of Technology, Harbin 150001, China</aff>
    <author-notes>
      <corresp>Corresponding author: <email>rafa@jimmy.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <volume>27</volume>
    <issue>11</issue>
    <fpage>1930</fpage>
    <lpage>1938</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2017 Teng and Irizarry; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This article is distributed exclusively by Cold Spring Harbor Laboratory Press for the first six months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">http://genome.cshlp.org/site/misc/terms.xhtml</ext-link>). After six months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1930.pdf"/>
    <abstract>
      <p>The main application of ChIP-seq technology is the detection of genomic regions that bind to a protein of interest. A large part of functional genomics’ public catalogs is based on ChIP-seq data. These catalogs rely on peak calling algorithms that infer protein-binding sites by detecting genomic regions associated with more mapped reads (coverage) than expected by chance, as a result of the experimental protocol's lack of perfect specificity. We find that GC-content bias accounts for substantial variability in the observed coverage for ChIP-seq experiments and that this variability leads to false-positive peak calls. More concerning is that the GC effect varies across experiments, with the effect strong enough to result in a substantial number of peaks called differently when different laboratories perform experiments on the same cell line. However, accounting for GC content bias in ChIP-seq is challenging because the binding sites of interest tend to be more common in high GC-content regions, which confounds real biological signals with unwanted variability. To account for this challenge, we introduce a statistical approach that accounts for GC effects on both nonspecific noise and signal induced by the binding site. The method can be used to account for this bias in binding quantification as well to improve existing peak calling algorithms. We use this approach to show a reduction in false-positive peaks as well as improved consistency across laboratories.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>National Human Genome Research Institute </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100000051</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>5U41HG007000</award-id>
        <award-id>2U41HG004059</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Chromatin immunoprecipitation followed by NGS (ChIP-seq) is widely used for detecting the genomic locations of transcription factor binding and histone modifications. ChIP-seq is widely used, with the majority of data provided by the ENCODE (<xref rid="TENGGR220673C8" ref-type="bibr">The ENCODE Project Consortium 2012</xref>) and modENCODE (<xref rid="TENGGR220673C5" ref-type="bibr">Celniker et al. 2009</xref>) projects produced with this technology. After mapping the NGS reads, the main part of the quantitative analysis is to infer the genomic sites where the protein of interest binds by finding regions with an enrichment of mapped reads. The regions reported by this analysis are referred to as peaks due to the appearance of the coverage plots (<xref rid="TENGGR220673C23" ref-type="bibr">Pepke et al. 2009</xref>). Several competing peak detection algorithms have been described in the literature (<xref rid="TENGGR220673C11" ref-type="bibr">Ji et al. 2008</xref>; <xref rid="TENGGR220673C15" ref-type="bibr">Jothi et al. 2008</xref>; <xref rid="TENGGR220673C16" ref-type="bibr">Kharchenko et al. 2008</xref>; <xref rid="TENGGR220673C28" ref-type="bibr">Valouev et al. 2008</xref>; <xref rid="TENGGR220673C30" ref-type="bibr">Zhang et al. 2008</xref>; <xref rid="TENGGR220673C26" ref-type="bibr">Rozowsky et al. 2009</xref>; <xref rid="TENGGR220673C13" ref-type="bibr">John et al. 2011</xref>; <xref rid="TENGGR220673C24" ref-type="bibr">Rashid et al. 2011</xref>). Although details of these competing approaches vary, most follow similar general principles. First, after reads are mapped, coverage is calculated for binned regions of the genome. In principle, only regions including binding sites should have counts larger than zero. However, due to nonspecificity of the experimental protocol, we observe a <italic>background level</italic>. This background level is then modeled, and statistical inference is used to distinguish between count levels that can be explained with the background model and those that are higher than expected by chance. The latter are reported as peaks.</p>
  <p>GC-content bias has been reported for several NGS applications (<xref rid="TENGGR220673C7" ref-type="bibr">Dohm et al. 2008</xref>; <xref rid="TENGGR220673C2" ref-type="bibr">Alkan et al. 2009</xref>; <xref rid="TENGGR220673C6" ref-type="bibr">Cheung et al. 2011</xref>; <xref rid="TENGGR220673C4" ref-type="bibr">Benjamini and Speed 2012</xref>; <xref rid="TENGGR220673C12" ref-type="bibr">Jiang et al. 2015</xref>). For genomic DNA data, PCR amplification of DNA fragments during library preparation is one factor that introduces this bias (<xref rid="TENGGR220673C1" ref-type="bibr">Aird et al. 2011</xref>; <xref rid="TENGGR220673C25" ref-type="bibr">Ross et al. 2013</xref>). The bias has also been observed in RNA-seq data (<xref rid="TENGGR220673C21" ref-type="bibr">Love et al. 2016</xref>). Solutions to this bias have been published for genomic DNA (<xref rid="TENGGR220673C4" ref-type="bibr">Benjamini and Speed 2012</xref>; <xref rid="TENGGR220673C12" ref-type="bibr">Jiang et al. 2015</xref>) and RNA-seq data (<xref rid="TENGGR220673C9" ref-type="bibr">Hansen et al. 2012</xref>; <xref rid="TENGGR220673C21" ref-type="bibr">Love et al. 2016</xref>). However, below we explain why these approaches are not directly applicable to ChIP-seq data.</p>
  <p>Using ENCODE (<xref rid="TENGGR220673C8" ref-type="bibr">The ENCODE Project Consortium 2012</xref>) data, we show that GC-content bias is also present in ChIP-seq technology. Furthermore, we demonstrate that the way in which GC content affects coverage varies across samples and laboratories and that this unwanted variability is substantial enough to result in different laboratories calling different regions as peaks. Unfortunately, solutions for GC-bias correction, published for other NGS applications, are not directly applicable to ChIP-seq experiments. This is because, in many instances, binding sites are expected to occur in or near high GC-content regions such as gene promoters. If we naively correct for GC content, we may erase the biologically relevant signals we are interested in detecting. Here, we present an approach based on a mixture model, which accounts for GC-content bias separately for effects related to protein binding and differential nonspecific binding. We demonstrate how this approach greatly reduces false-positive peaks and improves agreement across laboratories. The approach was developed for and tested on punctate ChIP-seq for transcription factors.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <sec id="s1a">
      <title>GC affects coverage and it does so differently in different labs</title>
      <p>To demonstrate the challenges presented by GC-content bias and the advantages presented by our method, we downloaded and processed raw ENCODE (<xref rid="TENGGR220673C8" ref-type="bibr">The ENCODE Project Consortium 2012</xref>) ChIP-seq data measuring transcription factor binding (<italic>CTCF</italic>, <italic>POLR2A</italic>, <italic>YY1</italic>, <italic>EP300</italic>, and <italic>GATA2</italic>) in the GM12878, HeLa-S3, HepG2, HUVEC, K562, and NHEK cell lines (see Methods section and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Table S1</ext-link>). Unless otherwise mentioned, all the examples described in this section are based on the <italic>CTCF</italic> data set. We use this particular binding protein as an example because data is available for all six cell lines and experiments performed by three independent laboratories each running at least two replicated experiments (one laboratory ran three replicates for cell lines GM12878 and K562) with at least one million mapped reads.</p>
      <p>To explore the extent and characteristics of the bias, we segmented the genome into 10K base-pair bins. After GC content was computed for each of these bins, for each sample of the HUVEC cell line, we counted reads for each bin. Plotting counts versus GC content reveals two clusters in each of the samples (<xref ref-type="fig" rid="TENGGR220673F1">Fig. 1</xref>A–F; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S1</ext-link>). The presence of two clusters is in agreement with the previously noted observation that ChIP-seq reads can result from either (1) a background level or (2) protein-binding regions (<xref rid="TENGGR220673C30" ref-type="bibr">Zhang et al. 2008</xref>), with the latter associated with peaks. In both replicates from one laboratory, we observe that counts increase with GC content in both background and signal clusters (<xref ref-type="fig" rid="TENGGR220673F1">Fig. 1</xref>A,B). Of particular concern is the fact that the way GC content affects coverage is different in another laboratory (<xref ref-type="fig" rid="TENGGR220673F1">Fig. 1</xref>C,D) in which counts decrease with GC content. In a third laboratory, the GC-content bias is only present in one of the two replicates (<xref ref-type="fig" rid="TENGGR220673F1">Fig. 1</xref>E,F). A similar result has been previously reported for genomic DNA (<xref rid="TENGGR220673C4" ref-type="bibr">Benjamini and Speed 2012</xref>; <xref rid="TENGGR220673C12" ref-type="bibr">Jiang et al. 2015</xref>) and RNA-seq (<xref rid="TENGGR220673C21" ref-type="bibr">Love et al. 2016</xref>).</p>
      <fig id="TENGGR220673F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Evidence of GC-content effects at the bin level and its downstream result on peaks demonstrated on the <italic>CTCF</italic> HUVEC cell line. (<italic>A</italic>) The genome is divided into 10-kb bins and counts are computed in the first replicate of laboratory UW as well as the GC content of each bin. Counts are plotted against GC content. (<italic>B</italic>) As in <italic>A</italic> but for the second replicate. (<italic>C</italic>) As in <italic>A</italic> but for the first replicate of laboratory UTA. (<italic>D</italic>) As in <italic>C</italic> but for the second replicate. (<italic>E</italic>) As in <italic>A</italic> but for the first replicate of laboratory Broad. (<italic>F</italic>) As in <italic>E</italic> but for the second replicate. (<italic>G</italic>,<italic>H</italic>) Examples of two peaks that change substantially from laboratory to laboratory. The peaks shown in <italic>G</italic> and <italic>H</italic> were selected to illustrate how coverage plots can change from laboratory to laboratory and that the change appears to be driven by GC content. These regions are associated with the bins annotated with the letters ‘G’ and ‘H’ in <italic>A</italic>–<italic>F</italic>.</p>
        </caption>
        <graphic xlink:href="1930f01"/>
      </fig>
      <p>Note that here we use the large bin size for exploratory and illustrative purposes only since it results in enough of a reduction in sampling variance to clearly highlight the GC-content bias. Similarly, we used the HUVEC data to illustrate the challenge because it exhibited the strongest GC-content bias. The resulting data visualization (<xref ref-type="fig" rid="TENGGR220673F1">Fig. 1</xref>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S1</ext-link>) motivated the approach that we now describe and is applied to smaller bin sizes that are more appropriate for peak calling.</p>
    </sec>
    <sec id="s1b">
      <title>GC bias leads to variability of ChIP-seq peak calling</title>
      <p>The effects described above are strong enough to affect downstream analysis, such as peak detection. For example, coverage can change drastically across laboratories depending on the GC content of the region (<xref ref-type="fig" rid="TENGGR220673F1">Fig. 1</xref>G,H; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S2</ext-link>). Note that, in the high GC-content region, laboratory UW shows a peak, but laboratory UTA does not, while in the low GC-content region it is the other way around. These regions are not isolated examples. In fact, the agreement in peak calls across laboratories (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S3A</ext-link>) is rather low. For example, the peaks reported for the HUVEC cell line on the ENCODE (<xref rid="TENGGR220673C18" ref-type="bibr">Landt et al. 2012</xref>) portal report in 37,920, 44,033, and 37,412 peaks called for the three laboratories, respectively, with 24.3% of regions reported by only one laboratory. Note that ENCODE uses the IDR algorithm (<xref rid="TENGGR220673C20" ref-type="bibr">Li et al. 2011</xref>) to select peaks that consistently appear on two replicates for each laboratory; thus, the number of peaks reported for each laboratory may be significantly affected by the quality of the replicates rather than by suboptimal performance from peak callers. To see if GC content was a major driver of these differences, we compared the GC content of the peak regions detected just by laboratory UW, to those detected just by laboratory Broad, to those detected just by laboratory UTA, and found a strong difference (<xref ref-type="fig" rid="TENGGR220673F2">Fig. 2</xref>A). Note that these differences cannot be due to biology but rather must be a result of differences in experimental conditions. These results demonstrate that, if left unaccounted for, GC-content bias will lead current peak callers to report a substantial number of false positives.</p>
      <fig id="TENGGR220673F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>GC content of peaks called by only one laboratory. (<italic>A</italic>) For the <italic>CTCF</italic> HUVEC cell line, we formed four groups of peaks reported by the ENCODE portal. We split them into those called only in laboratory UW, those called only in laboratory Broad, those called only in laboratory UTA, and those called in all three. We computed the GC content for each of these peak regions, shown in four box plots. (<italic>B</italic>) As in <italic>A</italic> but after finding peaks with our algorithm.</p>
        </caption>
        <graphic xlink:href="1930f02"/>
      </fig>
    </sec>
    <sec id="s1c">
      <title>Mixture model estimates GC-content effect for background and signal</title>
      <p>Published work on GC-content bias correction has found that modeling GC-content effects at the fragment level is, currently, the optimal approach (<xref rid="TENGGR220673C4" ref-type="bibr">Benjamini and Speed 2012</xref>; <xref rid="TENGGR220673C21" ref-type="bibr">Love et al. 2016</xref>). However, this approach is not directly applicable to ChIP-seq data. One reason is that most peak calling algorithms operate on bin level information. Specifically, these algorithms define bins, compute coverage in these bins, and then peaks are inferred from these coverage measurements (<xref rid="TENGGR220673C11" ref-type="bibr">Ji et al. 2008</xref>; <xref rid="TENGGR220673C16" ref-type="bibr">Kharchenko et al. 2008</xref>; <xref rid="TENGGR220673C30" ref-type="bibr">Zhang et al. 2008</xref>; <xref rid="TENGGR220673C13" ref-type="bibr">John et al. 2011</xref>; <xref rid="TENGGR220673C24" ref-type="bibr">Rashid et al. 2011</xref>). Here we develop a method that makes use of an approximation that permits the adaptation of published peak calling algorithms so that they adjust for GC-content bias. Although we focus on the SPP algorithm (<xref rid="TENGGR220673C16" ref-type="bibr">Kharchenko et al. 2008</xref>) because it was used by the ENCODE project, our approach applies to any peak algorithm based on coverage computed in bins. The approach can also be used to adjust enrichment scores for predefined regions—for example, regions considered interesting by an investigator or regions reported by a peak caller.</p>
      <p>The first step in our approach is to estimate a sample-specific GC-content effect from the data. This effect is defined by estimating the GC-bias for both background level and binding signal for any given potential binding region (<xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A). Suppose our targeted protein binds to a region centered at genomic location <italic>i</italic><sub>0</sub> and has length <italic>l</italic>. Computing the GC content of the genomic region starting at <italic>i</italic><sub>0</sub> − (<italic>l</italic>/2) and ending at <italic>i</italic><sub>0</sub> + (<italic>l</italic>/2) is straightforward. However, due to the fact that DNA is randomly cut into fragments of sizes ranging from 200 to 500 bp (depending on the experimental protocol), the sequenced reads associated with this binding site map to a larger region of the genome (<xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A). Specifically, if fragments are, on average, size <italic>h</italic>, then the peak region will span from <italic>i</italic><sub>0</sub> + (<italic>l</italic>/2) − <italic>h</italic> to <italic>i</italic><sub>0</sub> − (<italic>l</italic>/2) + <italic>h</italic>. Note also that once outside of the [<italic>i</italic><sub>0</sub> − (<italic>l</italic>/2), <italic>i</italic><sub>0</sub> + (<italic>l</italic>/2)] range, the probability that a specific fragment appears decreases as its center is further from <italic>i</italic><sub>0</sub>. Specifically, these different probabilities imply that we should use the following weights:
<disp-formula><mml:math id="UM1"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.4em"/><mml:mo>−</mml:mo><mml:mspace width="0.4em"/><mml:mspace width="0.4em"/><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi mathvariant="normal">if</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi mathvariant="normal">if</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.4em"/><mml:mspace width="0.4em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <fig id="TENGGR220673F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Illustration of regions related to the enrichment score and effective GC-content calculation. (<italic>A</italic>) The regions associated with the counts denoted by <italic>Y</italic><sub><italic>i</italic>,+</sub>, <italic>Y</italic><sub><italic>i</italic>,−</sub>, <italic>B</italic><sub><italic>i</italic>,+</sub>, <italic>B</italic><sub><italic>i</italic>,−</sub> in the paper are denoted with the regions 1, 4, 2, and 3, respectively. The red and blue lines represent fragments that are true signals and background noise, respectively, with their start positions labeled as bars on the DNA plot with corresponding colors. The start positions for forward strand fragments are labeled <italic>above</italic> the line while reverse strand fragments are labeled <italic>under</italic> the line. A cartoon indicating the signal coverages formed by forward and reverse strands is also added on the DNA plot. (<italic>B</italic>) Illustration of nucleotide weights when calculating effective GC content for a bin centered at location <italic>i</italic><sub>0</sub>.</p>
        </caption>
        <graphic xlink:href="1930f03"/>
      </fig>
      <p>The shape of <italic>w</italic><sub><italic>i</italic></sub> can be seen in <xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>B. This implies that the total GC-content bias affecting fragments associated with a protein binding at [<italic>i</italic><sub>0</sub> − (<italic>l</italic>/2), <italic>i</italic><sub>0</sub> + (<italic>l</italic>/2)] is a weighted average of all the GC-content effects of all potential fragments in the bin [<italic>i</italic><sub>0</sub> + (<italic>l</italic>/2) − <italic>h</italic>, <italic>i</italic><sub>0</sub> − (<italic>l</italic>/2) + <italic>h</italic>]. We therefore define the <italic>effective GC content</italic> (EGCC) associated with a bin centered at <italic>i</italic><sub>0</sub> as
<disp-formula><mml:math id="UM2"><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mstyle></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
</p>
      <p>where <italic>x</italic><sub><italic>i</italic></sub> is 1 if genomic location <italic>i</italic> is G or C, and 0 otherwise. Note that a positive side effect of this approach is that it results in a GC-content covariate that is less sensitive to the bin size (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S4</ext-link>). The parameters <italic>l</italic> and <italic>W</italic> (<xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A) are estimated separately for each experiment, as described in detail in the Methods section. Note that <italic>h</italic> = <italic>W</italic> + <italic>l</italic>/2.</p>
      <p>With an EGCC in place for any given genomic location, we can then estimate GC-content effects for both the background level and signal using a mixture model. Specifically, we pose a mixed generalized linear model with two components corresponding to coverage due to specific binding and background regions, respectively. We assume that each component follows a negative binomial distribution with the log of the rate a smooth function of EGCC. When fitting this model to the HUVEC data, the fitted GC-content-dependent effects demonstrate that each laboratory introduces a different type of bias for both the signal and background (<xref ref-type="fig" rid="TENGGR220673F4">Fig. 4</xref>). See the Methods section for details.</p>
      <fig id="TENGGR220673F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Visualization of the fitted generalized linear mixture model. (<italic>A</italic>) We defined bins using estimated binding size (<italic>W</italic> in <xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A) and randomly selected 5% of all genome-wide bins. We computed counts for these bins in the first replicate of the <italic>CTCF</italic> HUVEC cell line for laboratory UW. We fitted our model to these bins. The colors represent the probability of being background (blue) or signal (red). The GC-content bias smooth functions are plotted with dashed curves. (<italic>B</italic>) As in <italic>A</italic> but for the second replicate for laboratory UW. (<italic>C</italic>) As in <italic>A</italic> but for laboratory UTA. (<italic>D</italic>) As in <italic>C</italic> but for the second replicate for laboratory UTA. (<italic>E</italic>) As in <italic>A</italic> but for laboratory Broad. (<italic>F</italic>) As in <italic>E</italic> but for the second replicate for laboratory Broad.</p>
        </caption>
        <graphic xlink:href="1930f04"/>
      </fig>
    </sec>
    <sec id="s1d">
      <title>Adjusting binding quantification for GC-bias reduces batch effects</title>
      <p>We computed counts for each of the regions reported as <italic>CTCF</italic> peaks in at least one cell line by ENCODE (<xref rid="TENGGR220673C17" ref-type="bibr">Kundaje et al. 2015</xref>) for each of the GM12878, HeLa-S3, HepG2, HUVEC, K562, and NHEK samples. We constructed a matrix with these binding quantifications and performed principal component analysis (PCA) on the log-transformed values in this matrix. The first two principal components (PCs) do not separate by cell line, as expected (<xref ref-type="fig" rid="TENGGR220673F5">Fig. 5</xref>A). Furthermore, the large variation seen within each cell line is largely explained by the different laboratories (<xref ref-type="fig" rid="TENGGR220673F5">Fig. 5</xref>A). We then adjusted the values in this matrix for GC content using our model-based approach and recomputed the PCs. The results were markedly improved (<xref ref-type="fig" rid="TENGGR220673F5">Fig. 5</xref>B), with the samples now clearly clustering by cell line and much of the batch effects removed. The improvement in specificity and batch effect removal was evident from plotting mean squared residuals summarizing across laboratory variability, computed within cell line, before and after GC-content correction and noting a substantial reduction (<xref ref-type="fig" rid="TENGGR220673F5">Fig. 5</xref>C). Because the variability is driven by the difference in GC-content biases rather than laboratory, we expect our method to outperform batch-effect adjustment tools such as ComBat (<xref rid="TENGGR220673C14" ref-type="bibr">Johnson et al. 2007</xref>). As the GC-content effects and laboratories are not perfectly correlated, we expect some of the GC-content bias to remain even after applying ComBat. We confirm this by rerunning the PCA after applying ComBat and noting that the unwanted variability is not removed (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S5</ext-link>). In addition, our approach has the further advantage that it can be applied to a single experiment, while ComBat requires multiple samples.</p>
      <fig id="TENGGR220673F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>GC-bias correction reduces the impact of batch effects. (<italic>A</italic>) For the regions reported as binding sites by ENCODE, we computed counts for the GM12878, HeLa-S3, HepG2, HUVEC, K562, and NHEK for <italic>CTCF</italic>. The first two principal components of this matrix are shown, with color representing cell line and different symbols used to represent laboratory. (<italic>B</italic>) As in <italic>A</italic> but after performing the batch correction. (<italic>C</italic>) Box plots showing the within cell line across laboratory variability before and after correction for the HUVEC cell line.</p>
        </caption>
        <graphic xlink:href="1930f05"/>
      </fig>
      <p>To show that our approach improves downstream results for other transcription factors, we applied the same analysis to <italic>POLR2A</italic>, another binding protein run on several cell lines and across three laboratories (see Methods and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Table S1</ext-link>). Although the GC-content effect was not as strong in this experiment as in the <italic>CTCF</italic> experiment, our method still showed improved specificity (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S6</ext-link>).</p>
    </sec>
    <sec id="s1e">
      <title>Integrating GC-content adjustment into peak calling algorithms</title>
      <p>Our model-based approach provides an adjustment value for any genomic bin. This implies that it can be integrated with peak algorithms that use bins as raw data (<xref rid="TENGGR220673C11" ref-type="bibr">Ji et al. 2008</xref>; <xref rid="TENGGR220673C16" ref-type="bibr">Kharchenko et al. 2008</xref>; <xref rid="TENGGR220673C30" ref-type="bibr">Zhang et al. 2008</xref>; <xref rid="TENGGR220673C24" ref-type="bibr">Rashid et al. 2011</xref>). Here, we demonstrate the advantages of our approach by adapting the peak detection algorithm used by ENCODE, namely the ChIP-seq processing pipeline (SPP) (<xref rid="TENGGR220673C16" ref-type="bibr">Kharchenko et al. 2008</xref>). SPP starts by estimating the average half-width of the binding protein, referred to here as <italic>W</italic> (see Methods section for details). With this estimate in place, the SPP algorithm then computes read counts for positive and negative strands separately for each genomic location <italic>i</italic>, denoted here with <italic>Y</italic><sub><italic>i</italic>,+</sub> and <italic>Y</italic><sub><italic>i</italic>,−</sub>, respectively (red fragments in <xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A). The <italic>Y</italic><sub><italic>i</italic>,+</sub> represents positive strand counts in a region starting at <italic>i</italic> − <italic>W</italic> and ending at <italic>i</italic>, and the <italic>Y</italic><sub><italic>i</italic>,−</sub> represents negative strand counts in a region starting at <italic>i</italic> and ending at <italic>i</italic> + <italic>W</italic>. As described by <xref rid="TENGGR220673C23" ref-type="bibr">Pepke et al. (2009)</xref>, these counts should be large when a protein binds a region centered at <italic>i</italic>. To account for local background, SPP also computes counts in regions that should be associated with nonspecific binding, denoted here with <italic>B</italic><sub><italic>i</italic>,+</sub> and <italic>B</italic><sub><italic>i</italic>,−</sub>, respectively (blue fragments in <xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A). The background level <italic>B</italic><sub><italic>i</italic>,+</sub> represents positive strand counts in a region starting at <italic>i</italic> and ending at <italic>i</italic> + <italic>W</italic>, and the background level <italic>B</italic><sub><italic>i</italic>,−</sub> represents negative strand counts in a region starting at <italic>i</italic> − <italic>W</italic> and ending at <italic>i</italic>. As described by <xref rid="TENGGR220673C23" ref-type="bibr">Pepke et al. (2009)</xref>, there should be no counts in these regions when a protein binds a region centered at <italic>i</italic>. Then, for each <italic>i</italic>, SPP defines the <italic>enrichment score</italic> as a geometric mean of the signal counts minus the average background signal <inline-formula><mml:math id="il1"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.4em"/></mml:mrow></mml:msub><mml:mrow><mml:mo>×</mml:mo><mml:mspace width="0.4em"/></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mspace width="0.4em"/></mml:mrow></mml:msub></mml:msqrt><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.4em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mspace width="0.4em"/></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. Note that this is the geometric average of the signal minus the arithmetic average of background multiplied by two. To find candidate peaks, SPP then estimates binding significance and uses the local maxima of enrichment scores to call peaks. To correct for GC, we simply compute the effective GC content of each bin and adjust <italic>Y</italic><sub><italic>i</italic>,+</sub>, <italic>Y</italic><sub><italic>i</italic>,−</sub>, <italic>B</italic><sub><italic>i</italic>,+</sub>, <italic>B</italic><sub><italic>i</italic>,−</sub> accordingly (see Methods). We then used an approach similar to SPP to quantify uncertainty for each candidate peak reported by our GC-corrected SPP algorithm (Methods and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S7</ext-link>). We compared these peaks to those obtained by the original SPP and found that our method (gcapc) resulted in substantial improvement in consistency (<xref ref-type="fig" rid="TENGGR220673F6">Fig. 6</xref>A). If, as done by ENCODE, we filter peaks using an IDR (<xref rid="TENGGR220673C20" ref-type="bibr">Li et al. 2011</xref>) of 0.02, our algorithm reports improved results of 31,051, 33,769, and 30,250 peaks (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S3B</ext-link>) called for the three laboratories and now only 16.9% of regions reported by only one laboratory. More importantly, the differences are no longer due to differences in GC content (<xref ref-type="fig" rid="TENGGR220673F2">Fig. 2</xref>B). Note that the ENCODE pipeline is more complicated than running a peak caller and IDR (<uri xlink:href="https://www.encodeproject.org/chip-seq/transcription_factor/">https://www.encodeproject.org/chip-seq/transcription_factor/</uri>). If we simply run SPP followed by IDR, the improvements of our algorithm are even larger, since this approach produced 29.5% of regions reported by only one laboratory (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S3C</ext-link>). Because IDR analysis is sensitive to the quality of replicates (<xref rid="TENGGR220673C20" ref-type="bibr">Li et al. 2011</xref>), to provide a more systematic comparison we generated a CAT plot (<xref rid="TENGGR220673C10" ref-type="bibr">Irizarry et al. 2005</xref>), including the comparison of each sample (<xref ref-type="fig" rid="TENGGR220673F6">Fig. 6</xref>A).</p>
      <fig id="TENGGR220673F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Improvements of peak calling consistency and transcription factor binding site enrichment with GC-content adjustment. For the <italic>CTCF</italic> HUVEC cell line, we create lists of candidate peaks and rank them based on enrichment score. (<italic>A</italic>) Correspondence at the top (CAT) plots. For each list size, we compute the proportion of peaks in common reported by two different laboratories. We do this for each pairwise comparison and plot this percentage against the list size. Peak width is scaled to the same median size between gcapc and SPP for each sample. (<italic>B</italic>) For each list size, we compute PWM scores for each peak and define with lower than 72% as false positives. We do this for each replicate and plot the false-positive rate against the list size and plot the number of false positives for each list size ranging from 1 to 30,000.</p>
        </caption>
        <graphic xlink:href="1930f06"/>
      </fig>
      <p>Finally, to further assess the improvement provided by our approach, we performed <italic>CTCF</italic> binding site enrichment analysis. Specifically, we used the human <italic>CTCF</italic> motif from the JASPAR 2016 database (<xref rid="TENGGR220673C22" ref-type="bibr">Mathelier et al. 2016</xref>) to define a position weight matrix (PWM) score sequence of the same size as the motif (<xref rid="TENGGR220673C29" ref-type="bibr">Wasserman and Sandelin 2004</xref>). A background probability of 30% for A and T and 20% for C and G were used for the PWM score calculation. Then, we assigned a PWM score to each reported peak by selecting the maximum PWM within the region associated with the peak. Following <xref rid="TENGGR220673C27" ref-type="bibr">Sandelin et al. (2004)</xref> and <xref rid="TENGGR220673C29" ref-type="bibr">Wasserman and Sandelin (2004)</xref>, we defined peaks with a maximum PWM score lower than 72% of all possible PWM scores for this <italic>CTCF</italic> motif as a false positive. gcapc had substantially less false positives than SPP (<xref ref-type="fig" rid="TENGGR220673F6">Fig. 6</xref>B). For example, if we examine the top 100 peaks across all six replicates, SPP results in a total of 54 false positives, while gcapc has none. The improvements were consistent across several cut-off choices ranging from 67% to 92% (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S8</ext-link>).</p>
      <p>To demonstrate that the improvements offered by gcapc generalize to other transcription factors, we applied our approach to the ChIP-seq data of three other transcription factors, <italic>YY1</italic>, <italic>EP300</italic>, and <italic>GATA2</italic> (see Methods and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Table S1</ext-link>). Our method reduced the inconsistencies between laboratories compared to SPP (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S9</ext-link>). We note that the improvements for the <italic>GATA2</italic> data set are less substantial. This appears to be the case because the GC-content bias is less pronounced in this data set. Note that using our R package, one can visualize the data (<xref ref-type="fig" rid="TENGGR220673F4">Fig. 4</xref>) to determine the severity of the GC-content effect. If the fitted curves look flat for all your data sets, a GC-bias method might not be necessary.</p>
      <p>Finally, to demonstrate that our approach can be incorporated into other peak callers, we adapted the MACS2 (<xref rid="TENGGR220673C30" ref-type="bibr">Zhang et al. 2008</xref>) and hotspot (<xref rid="TENGGR220673C13" ref-type="bibr">John et al. 2011</xref>) algorithms (see Methods). Note that the MACS2 method estimates a local background level from the data that could, in principle, correct for sequence bias. However, because this background level estimation procedure does not appear to be local enough to capture the GC effects, as a result we see similar inconsistencies in MACS2 as in SPP (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S10</ext-link>). The GC-bias correction added by our approach showed marked improvements for these two peak calling algorithms as well (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S11</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>We have demonstrated how GC-content bias induces substantial variability into ChIP-seq data and that this variability is large enough to result in different peaks being reported by different laboratories when studying the same cell lines. We described how published GC-content adjustment methods are not directly applicable to ChIP-seq data due to confounding between the GC content of regions and their biological relevance. We described gcapc (<uri xlink:href="http://bioconductor.org/packages/gcapc/">http://bioconductor.org/packages/gcapc/</uri>), a method that adjusts for GC-content bias in ChIP-seq data using a mixed model, which permits independent adjustments of the signal and background signals and thus circumvents the confounding challenge and can be incorporated into most current peak callers. Our method permits the GC-content bias correction for any predefined bin. We demonstrated the practical advantage of our approach by removing batch effects from binding quantifications in ENCODE data and by adapting the widely used SPP algorithm and showing substantial improvements in peak calling consistency across laboratories.</p>
    <p>Note that, although we tested our approach on several transcription factors, all are examples of what are referred to as punctate data sets: characterized by peaks that are short and marked. We do not yet recommend our method for broad peak data sets such as histone modifications. Extending our GC-bias adjusting method to these data sets is the subject of future work.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec id="s3a">
      <title>Data acquisition and preprocessing</title>
      <p>We chose data for the transcription factors <italic>CTCF</italic>, <italic>POLR2A</italic>, <italic>YY1</italic>, <italic>EP300</italic>, and <italic>GATA2</italic> provided by ENCODE as example data sets because they include a wide range of cell types or experiments performed by two to three different laboratories using the same protocol. The five production centers (laboratories) which conducted experiments on selected transcription factors were located at the Broad Institute (Broad), HudsonAlpha Institute for Biotechnology (HAIB), Stanford University or University of Southern California (SYDH), University of Texas at Austin (UTA), and University of Washington (UW). For <italic>CTCF</italic>, we focused on the GM12878, HeLa-S3, HepG2, HUVEC, K562, and NHEK cell lines because each of these was processed in replicates by each of three laboratories: Broad, UTA, and UW. Similarly, we focused on GM12878, HeLa-S3, HepG2, and HUVEC cell line samples for <italic>POLR2A</italic> by HAIB, SYDH, and UTA. For the other three factors, we only selected one cell line in two laboratories for analysis (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Table S1</ext-link>). Raw sequencing reads were downloaded from the ENCODE data portal (<uri xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</uri>) or UCSC ENCODE portal (<uri xlink:href="https://genome.ucsc.edu/ENCODE/">https://genome.ucsc.edu/ENCODE/</uri>) using accession IDs or links documented in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Table S1</ext-link>.</p>
      <p>The raw reads were aligned to human genome build hg19 with aligner BWA (<xref rid="TENGGR220673C19" ref-type="bibr">Li and Durbin 2009</xref>). We note that since our analysis is based on bin counts, with bins of size 100–250 bp, given the characteristics of the differences between hg19 and GRCh38, realigning the reads to GRCh38 will not affect our conclusions. Reads from Chromosome Y were ignored to avoid sex effects. Mapped reads with a mapping score less than 30 were removed. Secondary alignments were also removed. Duplicate reads were thinned down to one read. For the purposes of quantifying binding in predefined regions, we only considered the start position at the 5′ end.</p>
    </sec>
    <sec id="s3b">
      <title>Estimating GC-content bias with the mixed generalized linear model</title>
      <p><xref ref-type="fig" rid="TENGGR220673F1">Figures 1</xref> and <xref ref-type="fig" rid="TENGGR220673F4">4</xref> clearly demonstrate the presence of two clusters. We assume the cluster characterized by low counts is related to nonspecific binding and refer to it as the <italic>background</italic>. We assume that the cluster characterized by higher counts is related to the specific binding signals that constitute the peaks. The counts in both clusters show a strong nonlinear dependence on GC content and motivate the following mixed model. We assume that for any given position <italic>i</italic>, <italic>Z</italic><sub><italic>i</italic></sub> = 1 if binding occurs at that position, and 0 otherwise. We denote with π the probability that any given <italic>Z</italic><sub><italic>i</italic></sub> = 1. We then assume that, conditioned on the state <italic>Z</italic><sub><italic>i</italic></sub>, the counts <italic>Y</italic><sub><italic>i</italic></sub> follow a negative binomial distribution with log(E[Y<sub>i</sub>|<italic>Z</italic><sub><italic>i</italic></sub> = <italic>a</italic>, <italic>X</italic><sub><italic>i</italic></sub> = <italic>x</italic><sub><italic>i</italic></sub>] ) = μ<sub><italic>a</italic></sub> + <italic>f</italic><sub><italic>a</italic></sub> (<italic>x</italic><sub><italic>i</italic></sub>), with μ<sub><italic>a</italic></sub> the mean count level for the positions, <italic>x</italic><sub><italic>i</italic></sub> the effective GC content for position <italic>i</italic>, and <italic>f</italic><sub><italic>a</italic></sub> is a smooth function that we represent with a cubic spline. Note that <italic>a</italic> is indexing the two possible states, background or specific signal, which implies that the GC-content effect is modeled differently for each state.</p>
      <p>Because we start with millions of bins, to improve computational efficiency we selected a random subset of bins representing 5% of the genome and estimated the parameters π, μ<sub>0</sub>, μ<sub>1</sub>, and the parameters used to represent the splines <italic>f</italic><sub>0</sub> and <italic>f</italic><sub>1</sub> using an expectation–maximization (EM) algorithm on this subset. We repeated this procedure with five independent subsets and updated the estimates to be the average across the five resulting sets of parameters. Using 15% and 25% resulted in practically identical estimates (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S12</ext-link>). The GC-content effect for binding quantification is simply
<disp-formula><mml:math id="UM3"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.4em"/><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>
with <inline-formula><mml:math id="il2"><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>Pr(</mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> the estimate obtained with the EM algorithm. To correct for the GC-content bias, we simply divide the counts by this quantity: <inline-formula><mml:math id="il3"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.4em"/><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>.</p>
      <p>To extend SPP, we use the correction <inline-formula><mml:math id="il4"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="il5"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> for the <italic>Y</italic><sub><italic>i</italic>,+</sub> and <italic>Y</italic><sub><italic>i</italic>,−</sub>, respectively, where <italic>x</italic><sub><italic>i</italic>,1,+</sub> and <italic>x</italic><sub><italic>i</italic>,1,−</sub> are the effective GC content in the positive and negative strand bins, described above, respectively. Similarly, we used the correction <inline-formula><mml:math id="il6"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="il7"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> for the <italic>B</italic><sub><italic>i</italic>,+</sub> and <italic>B</italic><sub><italic>i</italic>,−</sub>, respectively. Note that here, we use <italic>f</italic><sub>0</sub> for both signal and background components, because this summary is intended as a test statistic for which we define a null distribution assuming there is no signal. The term <italic>f</italic><sub>1</sub> is therefore only used when fitting the model and to correct region binding quantification already determined to be potential peaks.</p>
    </sec>
    <sec id="s3c">
      <title>Expectation–maximization (EM) algorithm for fitting the mixture model</title>
      <p>The log-likelihood for the expectation step is as follows:
<disp-formula><mml:math id="UM4"><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">LL</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where nb<sub><italic>a</italic></sub> represents the probability density function of a negative binomial distribution with log mean μ<sub><italic>a</italic></sub> + <italic>f</italic><sub><italic>a</italic></sub> (<italic>x</italic><sub><italic>i</italic></sub>) and shape parameter θ<sub><italic>a</italic></sub>. <italic>p</italic> is the probability of a bin belonging to a signal mixture component. The other parameters are defined above.</p>
      <p>In the maximization step, the parameters are estimated as follows:
<disp-formula><mml:math id="UM5"><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mspace width="0.4em"/><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mtext>nb</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mtext>nb</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mtext>nb</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
<disp-formula><mml:math id="UM6"><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.4em"/></mml:mstyle></mml:math></disp-formula>
<italic>c</italic> is a constant 2, <italic>n</italic> is total bin number, μ, θ, <italic>f</italic> are estimated using the <italic>glm.nb</italic> function in the R package MASS, with μ<sub>1</sub>, θ<sub>1</sub>, <italic>f</italic><sub>1</sub> based on bins with <inline-formula><mml:math id="il8"><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, and μ<sub>0</sub>, θ<sub>0</sub>, <italic>f</italic><sub>0</sub> based on bins with <inline-formula><mml:math id="il9"><mml:msub><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>.</p>
    </sec>
    <sec id="s3d">
      <title>Analysis of regions reported by ENCODE</title>
      <p>For the analysis involving the binding regions reported by ENCODE (<uri xlink:href="https://www.encodeproject.org/data/annotations/v2/">https://www.encodeproject.org/data/annotations/v2/</uri>), we did not need to run a peak calling algorithm since regions were already provided. We used data from all the regions reported by ENOCDE as potential peaks. To perform a GC-content bias correction of binding quantification, we assumed a binding width of 150 bp and used flanking regions of width 250 bp. We fit the model described above and we can correct as described. PCA analysis was based on binding regions reported for GM12878, HeLa-S3, HepG2, HUVEC, K562, and NHEK cell lines for <italic>CTCF</italic> and GM12878, HeLa-S3, HepG2, and HUVEC for <italic>POLR2A</italic>. As an example, the across-laboratory variability was computed in the HUVEC cell line for <italic>CTCF</italic>.</p>
    </sec>
    <sec id="s3e">
      <title>Quantifying uncertainty</title>
      <p>We implement a method similar to SPP. Specifically, we compute the enrichment score <italic>S</italic><sub><italic>i</italic></sub> for each region <italic>i</italic>. Then, for each of these regions, we permuted the start sites of all the reads falling within the region and recomputed the enrichment scores, denoted here with <inline-formula><mml:math id="il10"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math></inline-formula>. We used the <inline-formula><mml:math id="il11"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math></inline-formula> to form a null distribution and assign a <italic>P</italic>-value to each candidate peak (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Fig. S7</ext-link>). The user should treat the <italic>P</italic>-values obtained from this procedure, as well as SPP, with caution as they are based on several assumptions that are hard to test empirically. Furthermore, these uncertainty estimates do not account for the selection process. Permutation approaches such as those implemented by the bumphunter approach (<xref rid="TENGGR220673C3" ref-type="bibr">Aryee et al. 2014</xref>) are the subject of future research. Regardless, we find this quantification useful for prioritizing peaks.</p>
    </sec>
    <sec id="s3f">
      <title>Other improvements on the SPP algorithm</title>
      <p>Apart from the GC-content correction, we adapted the SPP algorithm in three other ways, which we describe in detail here.</p>
      <p>The SPP algorithm computes the enrichment score <italic>S</italic><sub><italic>i</italic></sub> for every location <italic>i</italic> on the genome. To do this, SPP defines a window size <italic>W</italic> that is used to compute the read counts as described in the Results section (<xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A). This window size is supposed to define the region that includes fragments resulting with a protein binding at location <italic>i</italic>. To define <italic>W</italic>, SPP uses the cross-correlation function between the fragment start sights from positive and negative strands. SPP uses an ad hoc procedure picking <italic>W</italic> to be a number between the lag that maximizes the cross-correlation function and a defined maximum window size that defaults to 500 bp. Instead, we make the assumption that the window size <italic>W</italic> should maximize the correlation of read counts between positive-strand windows and corresponding negative-strand windows. Using this criteria, the estimated window sizes in <italic>CTCF</italic> data sets are always much smaller than those estimated by SPP. In addition, we define another parameter <italic>l</italic> (<xref ref-type="fig" rid="TENGGR220673F3">Fig. 3</xref>A) to represent the real protein-binding width for effective GC-content estimation. This parameter is estimated using the lag that maximizes the cross-correlation function.</p>
      <p>The second difference is related to computational efficiency. While SPP computes <italic>S</italic><sub><italic>i</italic></sub> and the uncertainty estimate for every location on the genome, in our software we perform a filter that removes regions with small counts in all four relevant bins (<italic>Y</italic><sub><italic>i</italic>,+</sub>, <italic>Y</italic><sub><italic>i</italic>,−</sub>, <italic>B</italic><sub><italic>i</italic>,+</sub>, <italic>B</italic><sub><italic>i</italic>,−</sub>). This reduces the number of regions for which the uncertainty quantification is computed.</p>
      <p>Finally, to report the center of the binding site, SPP searches for local maxima of enrichment scores <italic>S</italic><sub><italic>i</italic></sub>. However, distributions of enrichment scores are not always symmetric around these local maxima, and we find that neighboring peak regions sometimes represent the same binding site. To avoid reporting two maxima associated with the same binding site as two separate peaks, we merged any two neighboring peaks that are within the estimated binding width from each other. Uncertainty is quantified only for merged peaks.</p>
    </sec>
    <sec id="s3g">
      <title>Adapting other peak callers</title>
      <p>First, optimal bin size and the parameter estimates needed to describe the GC-content effects are obtained using the same strategy described above. Then, the peak caller—MACS2 or hotspot, for example—is used to identify peaks. Then, each candidate region is extended by half the bin size at both ends to ensure every position in the reported peaks receives an effective GC content. For these regions, we then move a sliding window of the size of a bin, in steps of 1 bp and compute read counts and effective GC content in each. Now, for each bin we have a count and an effective GC content, so using the estimated GC-content bias model, we can perform a correction for each of these bins using the same approach as described above for SPP. The maximum corrected binding score with each region is reported as a summary binding quantification for that peak. Permutation is performed as described before. It is noted that a flexible set of peak regions is required to use this functionality to ensure the accuracy of permutation analysis.</p>
    </sec>
    <sec id="s3h">
      <title>Software availability</title>
      <p>The method described in this manuscript is available as an R/Bioconductor package (<uri xlink:href="http://bioconductor.org/packages/gcapc/">http://bioconductor.org/packages/gcapc/</uri>). The source code for the main results is documented here (<uri xlink:href="https://github.com/tengmx/gcapc_manuscript">https://github.com/tengmx/gcapc_manuscript</uri>). Both the R package and source code are also available in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.220673.117/-/DC1">Supplemental Material</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_11_1930__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S1.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S2.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S3.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S4.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S5.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S6.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S7.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S8.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S9.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S10.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S11.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.220673.117_Supplemental_Fig_S12.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.220673.117_Supplemental_Material.zip"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gr.220673.117_Supplemental_Table_S1.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Anshul Kundaje for the suggestion on transcription factor binding sites analysis. We acknowledge support from the National Human Genome Research Institute (grant numbers U24HG009446 and R01HG005220).</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.220673.117">http://www.genome.org/cgi/doi/10.1101/gr.220673.117</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="TENGGR220673C1">
      <mixed-citation publication-type="journal"><string-name><surname>Aird</surname><given-names>D</given-names></string-name>, <string-name><surname>Ross</surname><given-names>MG</given-names></string-name>, <string-name><surname>Chen</surname><given-names>WS</given-names></string-name>, <string-name><surname>Danielsson</surname><given-names>M</given-names></string-name>, <string-name><surname>Fennell</surname><given-names>T</given-names></string-name>, <string-name><surname>Russ</surname><given-names>C</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>DB</given-names></string-name>, <string-name><surname>Nusbaum</surname><given-names>C</given-names></string-name>, <string-name><surname>Gnirke</surname><given-names>A</given-names></string-name>. <year>2011</year><article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>. <source>Genome Biol</source><volume>12</volume>: <fpage>R18</fpage>.<pub-id pub-id-type="pmid">21338519</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C2">
      <mixed-citation publication-type="journal"><string-name><surname>Alkan</surname><given-names>C</given-names></string-name>, <string-name><surname>Kidd</surname><given-names>JM</given-names></string-name>, <string-name><surname>Marques-Bonet</surname><given-names>T</given-names></string-name>, <string-name><surname>Aksay</surname><given-names>G</given-names></string-name>, <string-name><surname>Antonacci</surname><given-names>F</given-names></string-name>, <string-name><surname>Hormozdiari</surname><given-names>F</given-names></string-name>, <string-name><surname>Kitzman</surname><given-names>JO</given-names></string-name>, <string-name><surname>Baker</surname><given-names>C</given-names></string-name>, <string-name><surname>Malig</surname><given-names>M</given-names></string-name>, <string-name><surname>Mutlu</surname><given-names>O</given-names></string-name>, <etal/><year>2009</year><article-title>Personalized copy number and segmental duplication maps using next-generation sequencing</article-title>. <source>Nat Genet</source><volume>41</volume>: <fpage>1061</fpage>–<lpage>1067</lpage>.<pub-id pub-id-type="pmid">19718026</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C3">
      <mixed-citation publication-type="journal"><string-name><surname>Aryee</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>AE</given-names></string-name>, <string-name><surname>Corrada-Bravo</surname><given-names>H</given-names></string-name>, <string-name><surname>Ladd-Acosta</surname><given-names>C</given-names></string-name>, <string-name><surname>Feinberg</surname><given-names>AP</given-names></string-name>, <string-name><surname>Hansen</surname><given-names>KD</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>RA</given-names></string-name>. <year>2014</year><article-title>Minfi: a flexible and comprehensive Bioconductor package for the analysis of Infinium DNA methylation microarrays</article-title>. <source>Bioinformatics</source><volume>30</volume>: <fpage>1363</fpage>–<lpage>1369</lpage>.<pub-id pub-id-type="pmid">24478339</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C4">
      <mixed-citation publication-type="journal"><string-name><surname>Benjamini</surname><given-names>Y</given-names></string-name>, <string-name><surname>Speed</surname><given-names>TP</given-names></string-name>. <year>2012</year><article-title>Summarizing and correcting the GC content bias in high-throughput sequencing</article-title>. <source>Nucleic Acids Res</source><volume>40</volume>: <fpage>e72</fpage>.<pub-id pub-id-type="pmid">22323520</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C5">
      <mixed-citation publication-type="journal"><string-name><surname>Celniker</surname><given-names>SE</given-names></string-name>, <string-name><surname>Dillon</surname><given-names>LA</given-names></string-name>, <string-name><surname>Gerstein</surname><given-names>MB</given-names></string-name>, <string-name><surname>Gunsalus</surname><given-names>KC</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Karpen</surname><given-names>GH</given-names></string-name>, <string-name><surname>Kellis</surname><given-names>M</given-names></string-name>, <string-name><surname>Lai</surname><given-names>EC</given-names></string-name>, <string-name><surname>Lieb</surname><given-names>JD</given-names></string-name>, <string-name><surname>MacAlpine</surname><given-names>DM</given-names></string-name>, <etal/><year>2009</year><article-title>Unlocking the secrets of the genome</article-title>. <source>Nature</source><volume>459</volume>: <fpage>927</fpage>–<lpage>930</lpage>.<pub-id pub-id-type="pmid">19536255</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C6">
      <mixed-citation publication-type="journal"><string-name><surname>Cheung</surname><given-names>MS</given-names></string-name>, <string-name><surname>Down</surname><given-names>TA</given-names></string-name>, <string-name><surname>Latorre</surname><given-names>I</given-names></string-name>, <string-name><surname>Ahringer</surname><given-names>J</given-names></string-name>. <year>2011</year><article-title>Systematic bias in high-throughput sequencing data and its correction by BEADS</article-title>. <source>Nucleic Acids Res</source><volume>39</volume>: <fpage>e103</fpage>.<pub-id pub-id-type="pmid">21646344</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C7">
      <mixed-citation publication-type="journal"><string-name><surname>Dohm</surname><given-names>JC</given-names></string-name>, <string-name><surname>Lottaz</surname><given-names>C</given-names></string-name>, <string-name><surname>Borodina</surname><given-names>T</given-names></string-name>, <string-name><surname>Himmelbauer</surname><given-names>H</given-names></string-name>. <year>2008</year><article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>. <source>Nucleic Acids Res</source><volume>36</volume>: <fpage>e105</fpage>.<pub-id pub-id-type="pmid">18660515</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C8">
      <mixed-citation publication-type="journal"><collab>The ENCODE Project Consortium</collab>. <year>2012</year><article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source><volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C9">
      <mixed-citation publication-type="journal"><string-name><surname>Hansen</surname><given-names>KD</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>RA</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Z</given-names></string-name>. <year>2012</year><article-title>Removing technical variability in RNA-seq data using conditional quantile normalization</article-title>. <source>Biostatistics</source><volume>13</volume>: <fpage>204</fpage>–<lpage>216</lpage>.<pub-id pub-id-type="pmid">22285995</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C10">
      <mixed-citation publication-type="journal"><string-name><surname>Irizarry</surname><given-names>RA</given-names></string-name>, <string-name><surname>Warren</surname><given-names>D</given-names></string-name>, <string-name><surname>Spencer</surname><given-names>F</given-names></string-name>, <string-name><surname>Kim</surname><given-names>IF</given-names></string-name>, <string-name><surname>Biswal</surname><given-names>S</given-names></string-name>, <string-name><surname>Frank</surname><given-names>BC</given-names></string-name>, <string-name><surname>Gabrielson</surname><given-names>E</given-names></string-name>, <string-name><surname>Garcia</surname><given-names>JG</given-names></string-name>, <string-name><surname>Geoghegan</surname><given-names>J</given-names></string-name>, <string-name><surname>Germino</surname><given-names>G</given-names></string-name>, <etal/><year>2005</year><article-title>Multiple-laboratory comparison of microarray platforms</article-title>. <source>Nat Methods</source><volume>2</volume>: <fpage>345</fpage>–<lpage>350</lpage>.<pub-id pub-id-type="pmid">15846361</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C11">
      <mixed-citation publication-type="journal"><string-name><surname>Ji</surname><given-names>H</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>H</given-names></string-name>, <string-name><surname>Ma</surname><given-names>W</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>DS</given-names></string-name>, <string-name><surname>Myers</surname><given-names>RM</given-names></string-name>, <string-name><surname>Wong</surname><given-names>WH</given-names></string-name>. <year>2008</year><article-title>An integrated software system for analyzing ChIP-chip and ChIP-seq data</article-title>. <source>Nat Biotechnol</source><volume>26</volume>: <fpage>1293</fpage>–<lpage>1300</lpage>.<pub-id pub-id-type="pmid">18978777</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C12">
      <mixed-citation publication-type="journal"><string-name><surname>Jiang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Oldridge</surname><given-names>DA</given-names></string-name>, <string-name><surname>Diskin</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>NR</given-names></string-name>. <year>2015</year><article-title>CODEX: a normalization and copy number variation detection method for whole exome sequencing</article-title>. <source>Nucleic Acids Res</source><volume>43</volume>: <fpage>e39</fpage>.<pub-id pub-id-type="pmid">25618849</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C13">
      <mixed-citation publication-type="journal"><string-name><surname>John</surname><given-names>S</given-names></string-name>, <string-name><surname>Sabo</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Thurman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Sung</surname><given-names>MH</given-names></string-name>, <string-name><surname>Biddie</surname><given-names>SC</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>TA</given-names></string-name>, <string-name><surname>Hager</surname><given-names>GL</given-names></string-name>, <string-name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></string-name>. <year>2011</year><article-title>Chromatin accessibility pre-determines glucocorticoid receptor binding patterns</article-title>. <source>Nat Genet</source><volume>43</volume>: <fpage>264</fpage>–<lpage>268</lpage>.<pub-id pub-id-type="pmid">21258342</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C14">
      <mixed-citation publication-type="journal"><string-name><surname>Johnson</surname><given-names>WE</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Rabinovic</surname><given-names>A</given-names></string-name>. <year>2007</year><article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source><volume>8</volume>: <fpage>118</fpage>–<lpage>127</lpage>.<pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C15">
      <mixed-citation publication-type="journal"><string-name><surname>Jothi</surname><given-names>R</given-names></string-name>, <string-name><surname>Cuddapah</surname><given-names>S</given-names></string-name>, <string-name><surname>Barski</surname><given-names>A</given-names></string-name>, <string-name><surname>Cui</surname><given-names>K</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>K</given-names></string-name>. <year>2008</year><article-title>Genome-wide identification of in vivo protein-DNA binding sites from ChIP-seq data</article-title>. <source>Nucleic Acids Res</source><volume>36</volume>: <fpage>5221</fpage>–<lpage>5231</lpage>.<pub-id pub-id-type="pmid">18684996</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C16">
      <mixed-citation publication-type="journal"><string-name><surname>Kharchenko</surname><given-names>PV</given-names></string-name>, <string-name><surname>Tolstorukov</surname><given-names>MY</given-names></string-name>, <string-name><surname>Park</surname><given-names>PJ</given-names></string-name>. <year>2008</year><article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>. <source>Nat Biotechnol</source><volume>26</volume>: <fpage>1351</fpage>–<lpage>1359</lpage>.<pub-id pub-id-type="pmid">19029915</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C17">
      <mixed-citation publication-type="journal"><string-name><surname>Kundaje</surname><given-names>A</given-names></string-name>, <string-name><surname>Meuleman</surname><given-names>W</given-names></string-name>, <string-name><surname>Ernst</surname><given-names>J</given-names></string-name>, <string-name><surname>Bilenky</surname><given-names>M</given-names></string-name>, <string-name><surname>Yen</surname><given-names>A</given-names></string-name>, <string-name><surname>Heravi-Moussavi</surname><given-names>A</given-names></string-name>, <string-name><surname>Kheradpour</surname><given-names>P</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Ziller</surname><given-names>MJ</given-names></string-name>, <etal/><year>2015</year><article-title>Integrative analysis of 111 reference human epigenomes</article-title>. <source>Nature</source><volume>518</volume>: <fpage>317</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">25693563</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C18">
      <mixed-citation publication-type="journal"><string-name><surname>Landt</surname><given-names>SG</given-names></string-name>, <string-name><surname>Marinov</surname><given-names>GK</given-names></string-name>, <string-name><surname>Kundaje</surname><given-names>A</given-names></string-name>, <string-name><surname>Kheradpour</surname><given-names>P</given-names></string-name>, <string-name><surname>Pauli</surname><given-names>F</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>, <string-name><surname>Bernstein</surname><given-names>BE</given-names></string-name>, <string-name><surname>Bickel</surname><given-names>P</given-names></string-name>, <string-name><surname>Brown</surname><given-names>JB</given-names></string-name>, <string-name><surname>Cayting</surname><given-names>P</given-names></string-name>, <etal/><year>2012</year><article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Res</source><volume>22</volume>: <fpage>1813</fpage>–<lpage>1831</lpage>.<pub-id pub-id-type="pmid">22955991</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C19">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>2009</year><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C20">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>Q</given-names></string-name>, <string-name><surname>Brown</surname><given-names>JB</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name>, <string-name><surname>Bickel</surname><given-names>PJ</given-names></string-name>. <year>2011</year><article-title>Measuring reproducibility of high-throughput experiments</article-title>. <source>Ann Appl Stat</source><volume>5</volume>: <fpage>1752</fpage>–<lpage>1779</lpage>.</mixed-citation>
    </ref>
    <ref id="TENGGR220673C21">
      <mixed-citation publication-type="journal"><string-name><surname>Love</surname><given-names>MI</given-names></string-name>, <string-name><surname>Hogenesch</surname><given-names>JB</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>RA</given-names></string-name>. <year>2016</year><article-title>Modeling of RNA-seq fragment sequence bias reduces systematic errors in transcript abundance estimation</article-title>. <source>Nat Biotechnol</source><volume>34</volume>: <fpage>1287</fpage>–<lpage>1291</lpage>.<pub-id pub-id-type="pmid">27669167</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C22">
      <mixed-citation publication-type="journal"><string-name><surname>Mathelier</surname><given-names>A</given-names></string-name>, <string-name><surname>Fornes</surname><given-names>O</given-names></string-name>, <string-name><surname>Arenillas</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Chen</surname><given-names>CY</given-names></string-name>, <string-name><surname>Denay</surname><given-names>G</given-names></string-name>, <string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Shi</surname><given-names>W</given-names></string-name>, <string-name><surname>Shyr</surname><given-names>C</given-names></string-name>, <string-name><surname>Tan</surname><given-names>G</given-names></string-name>, <string-name><surname>Worsley-Hunt</surname><given-names>R</given-names></string-name>, <etal/><year>2016</year><article-title>JASPAR 2016: a major expansion and update of the open-access database of transcription factor binding profiles</article-title>. <source>Nucleic Acids Res</source><volume>44</volume>: <fpage>D110</fpage>–<lpage>D115</lpage>.<pub-id pub-id-type="pmid">26531826</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C23">
      <mixed-citation publication-type="journal"><string-name><surname>Pepke</surname><given-names>S</given-names></string-name>, <string-name><surname>Wold</surname><given-names>B</given-names></string-name>, <string-name><surname>Mortazavi</surname><given-names>A</given-names></string-name>. <year>2009</year><article-title>Computation for ChIP-seq and RNA-seq studies</article-title>. <source>Nat Methods</source><volume>6</volume>: <fpage>S22</fpage>–<lpage>S32</lpage>.<pub-id pub-id-type="pmid">19844228</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C24">
      <mixed-citation publication-type="journal"><string-name><surname>Rashid</surname><given-names>NU</given-names></string-name>, <string-name><surname>Giresi</surname><given-names>PG</given-names></string-name>, <string-name><surname>Ibrahim</surname><given-names>JG</given-names></string-name>, <string-name><surname>Sun</surname><given-names>W</given-names></string-name>, <string-name><surname>Lieb</surname><given-names>JD</given-names></string-name>. <year>2011</year><article-title>ZINBA integrates local covariates with DNA-seq data to identify broad and narrow regions of enrichment, even within amplified genomic regions</article-title>. <source>Genome Biol</source><volume>12</volume>: <fpage>R67</fpage>.<pub-id pub-id-type="pmid">21787385</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C25">
      <mixed-citation publication-type="journal"><string-name><surname>Ross</surname><given-names>MG</given-names></string-name>, <string-name><surname>Russ</surname><given-names>C</given-names></string-name>, <string-name><surname>Costello</surname><given-names>M</given-names></string-name>, <string-name><surname>Hollinger</surname><given-names>A</given-names></string-name>, <string-name><surname>Lennon</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Hegarty</surname><given-names>R</given-names></string-name>, <string-name><surname>Nusbaum</surname><given-names>C</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>DB</given-names></string-name>. <year>2013</year><article-title>Characterizing and measuring bias in sequence data</article-title>. <source>Genome Biol</source><volume>14</volume>: <fpage>R51</fpage>.<pub-id pub-id-type="pmid">23718773</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C26">
      <mixed-citation publication-type="journal"><string-name><surname>Rozowsky</surname><given-names>J</given-names></string-name>, <string-name><surname>Euskirchen</surname><given-names>G</given-names></string-name>, <string-name><surname>Auerbach</surname><given-names>RK</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>ZD</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>T</given-names></string-name>, <string-name><surname>Bjornson</surname><given-names>R</given-names></string-name>, <string-name><surname>Carriero</surname><given-names>N</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>M</given-names></string-name>, <string-name><surname>Gerstein</surname><given-names>MB</given-names></string-name>. <year>2009</year><article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls</article-title>. <source>Nat Biotechnol</source><volume>27</volume>: <fpage>66</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">19122651</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C27">
      <mixed-citation publication-type="journal"><string-name><surname>Sandelin</surname><given-names>A</given-names></string-name>, <string-name><surname>Wasserman</surname><given-names>WW</given-names></string-name>, <string-name><surname>Lenhard</surname><given-names>B</given-names></string-name>. <year>2004</year><article-title>ConSite: web-based prediction of regulatory elements using cross-species comparison</article-title>. <source>Nucleic Acids Res</source><volume>32</volume>: <fpage>W249</fpage>–<lpage>W252</lpage>.<pub-id pub-id-type="pmid">15215389</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C28">
      <mixed-citation publication-type="journal"><string-name><surname>Valouev</surname><given-names>A</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>DS</given-names></string-name>, <string-name><surname>Sundquist</surname><given-names>A</given-names></string-name>, <string-name><surname>Medina</surname><given-names>C</given-names></string-name>, <string-name><surname>Anton</surname><given-names>E</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>, <string-name><surname>Myers</surname><given-names>RM</given-names></string-name>, <string-name><surname>Sidow</surname><given-names>A</given-names></string-name>. <year>2008</year><article-title>Genome-wide analysis of transcription factor binding sites based on ChIP-seq data</article-title>. <source>Nat Methods</source><volume>5</volume>: <fpage>829</fpage>–<lpage>834</lpage>.<pub-id pub-id-type="pmid">19160518</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C29">
      <mixed-citation publication-type="journal"><string-name><surname>Wasserman</surname><given-names>WW</given-names></string-name>, <string-name><surname>Sandelin</surname><given-names>A</given-names></string-name>. <year>2004</year><article-title>Applied bioinformatics for the identification of regulatory elements</article-title>. <source>Nat Rev Genet</source><volume>5</volume>: <fpage>276</fpage>–<lpage>287</lpage>.<pub-id pub-id-type="pmid">15131651</pub-id></mixed-citation>
    </ref>
    <ref id="TENGGR220673C30">
      <mixed-citation publication-type="journal"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>T</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>CA</given-names></string-name>, <string-name><surname>Eeckhoute</surname><given-names>J</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>DS</given-names></string-name>, <string-name><surname>Bernstein</surname><given-names>BE</given-names></string-name>, <string-name><surname>Nusbaum</surname><given-names>C</given-names></string-name>, <string-name><surname>Myers</surname><given-names>RM</given-names></string-name>, <string-name><surname>Brown</surname><given-names>M</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <etal/><year>2008</year><article-title>Model-based analysis of ChIP-seq (MACS)</article-title>. <source>Genome Biol</source><volume>9</volume>: <fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
