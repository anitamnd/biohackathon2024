<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9912678</article-id>
    <article-id pub-id-type="pmid">36759904</article-id>
    <article-id pub-id-type="publisher-id">2865</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-02865-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>REPAC: analysis of alternative polyadenylation from RNA-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9527-3703</contrib-id>
        <name>
          <surname>Imada</surname>
          <given-names>Eddie L.</given-names>
        </name>
        <address>
          <email>eimada@med.cornell.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilks</surname>
          <given-names>Christopher</given-names>
        </name>
        <address>
          <email>cwilks3@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Langmead</surname>
          <given-names>Ben</given-names>
        </name>
        <address>
          <email>langmead@cs.jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Marchionni</surname>
          <given-names>Luigi</given-names>
        </name>
        <address>
          <email>marchion@med.cornell.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution>Department of Pathology and Laboratory Medicine, Weill Cornell Medicine, </institution></institution-wrap>New York, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Department of Computer Science, Johns Hopkins University, </institution></institution-wrap>Baltimore, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>22</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Alternative polyadenylation (APA) is an important post-transcriptional mechanism that has major implications in biological processes and diseases. Although specialized sequencing methods for polyadenylation exist, availability of these data are limited compared to RNA-sequencing data. We developed REPAC, a framework for the analysis of APA from RNA-sequencing data. Using REPAC, we investigate the landscape of APA caused by activation of B cells. We also show that REPAC is faster than alternative methods by at least 7-fold and that it scales well to hundreds of samples. Overall, the REPAC method offers an accurate, easy, and convenient solution for the exploration of APA.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-02865-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Polyadenylation</kwd>
      <kwd>Method</kwd>
      <kwd>Compositions</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01CA200859</award-id>
        <award-id>R01GM121459</award-id>
        <principal-award-recipient>
          <name>
            <surname>Langmead</surname>
            <given-names>Ben</given-names>
          </name>
          <name>
            <surname>Marchionni</surname>
            <given-names>Luigi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM139602</award-id>
        <principal-award-recipient>
          <name>
            <surname>Langmead</surname>
            <given-names>Ben</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014039</institution-id>
            <institution>DOD Prostate Cancer Research Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>W81XWH-16-1-0739</award-id>
        <principal-award-recipient>
          <name>
            <surname>Marchionni</surname>
            <given-names>Luigi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Mechanisms that control gene expression at the RNA level are often referred to as post-transcriptional regulation (PTR) mechanisms. Splicing and alternative polyadenylation (APA) are well-known examples of PTR that can regulate not only gene expression but also their function. While splicing has been extensively studied since the advent of next generation sequencing (NGS), APA studies are far less common than splicing studies. Indeed, inferring APA events from RNA-Seq data is challenging due to the lack of an intrinsic characteristic (e.g., split-reads for splicing), and for this reason, several specialized sequencing methods were developed to pinpoint polyadenylation sites (PAS) [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Although these methods improve the quantification of PA sites usage, the number of publicly available data derived from these methods is extremely limited in comparison to traditional RNA-Seq data.</p>
    <p id="Par3">This poses a challenge to the study of polyadenylation (PA) biology given that the lack of publicly available data severely hinders investigation and hypothesis generation without incurring major experimental costs. To overcome this limitation, several groups have developed methods to quantify PA usage from RNA-Seq data [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Among them, DaPars [<xref ref-type="bibr" rid="CR6">6</xref>] is a popular method to compare PA profiles across two phenotypes and detect the differential usage of APA by the degree of difference in APA usage quantified as a change in percentage of distal polyA site usage Index (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PDUI$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>D</mml:mi><mml:mi>U</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq1.gif"/></alternatives></inline-formula>). Likewise, QAPA [<xref ref-type="bibr" rid="CR4">4</xref>], which leverages the speed and power of pseudo-alignment software, such as salmon, was shown to be the fastest method for APA studies so far.</p>
    <p id="Par4">Most of the methods currently available rely on the effect size of the change in the proportion of the expression levels between different PA sites. Performing statistical analysis on proportions of a total (i.e. percentage) imposes many statistical limitations that are often ignored and can lead to inaccurate results. Most multivariate methods that were developed for real values cannot be directly applied to compositional data (proportional data) because compositional data often breaks many assumptions of these methods [<xref ref-type="bibr" rid="CR7">7</xref>]. Moreover, these methods do not allow for the control of unwanted variables or the design of more complex comparisons (e.g., factorial designs, paired samples, etc.).</p>
    <p id="Par5">In this work, we present regression of polyadenylation compositions (REPAC) a novel framework to detect differential alternative polyadenylation (APA) using regression of polyadenylation compositions which can appropriately handle the compositional nature of this type of data while allowing for complex designs. We show that REPAC is faster and yields more accurate and robust results in comparison to other methods.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>REPAC can accurately detect APA events</title>
      <p id="Par6">REPAC makes use of expression estimates of 50 bp window upstream of annotated PA sites to fit a generalized linear regression model on the compositions to assess differential polyadenylation site usage (DPU) occurring between conditions. This quantification can be done with traditional tools (e.g., Subread, HT-Seq, etc.) or directly pulled from <italic>recount3 </italic>[<xref ref-type="bibr" rid="CR8">8</xref>] bigWig files (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Briefly, to assess the performance of REPAC, we simulated 2 conditions (<italic>n </italic>= 5 for each condition) with 5000 genes having a longer or shorter isoform. Half of the set had one of the isoforms predominantly expressed in one of the conditions (1250:1250 for short/longer isoforms), and the other half did not have a predominant isoform. The ratio of longer to shorter isoforms was randomly defined within a pre-defined range (see the “<xref rid="Sec11" ref-type="sec">Methods”</xref>). We applied the REPAC method after removing 197 low expressed genes. For each type of event, REPAC was able to achieve 0.99/0.98, 0.99/0.98 and 0.98/0.98 specificity/sensitivity for lengthening, shortening, and no preference (NP), respectively. With an overall accuracy of 0.98 and an area under the curve (AUC) of 0.9989, REPAC was shown to accurately detect APA events (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A).<fig id="Fig1"><label>Fig. 1</label><caption><p>REPAC workflow. REPAC perform analysis of differential polyadenylation usage by analyzing the upstream region of annotated PAS. While quantification of PAS can be performed in traditional ways (alignment and counting), it was primarily design to take advantage of the <italic>recount3</italic> project to extract counts on-the-fly for over 750,000 samples publicly available</p></caption><graphic xlink:href="13059_2023_2865_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Performance of alternative methods for APA detection</title>
      <p id="Par7">We compared the performance of REPAC to other popular methods for APA detection: DaPars [<xref ref-type="bibr" rid="CR6">6</xref>], QAPA [<xref ref-type="bibr" rid="CR4">4</xref>], and LABRAT [<xref ref-type="bibr" rid="CR9">9</xref>]. Both QAPA and LABRAT relies on external tools such as salmon to obtain estimates of each isoform 3′-UTR expression level which are transformed to relative expression levels by normalizing the isoform expression level by the total 3’-UTR expression level. However, LABRAT implements significance testing for the differences in PAS usage, which QAPA does not. In contrast, DaPars relies on 3′-UTR changes in coverage to infer de novo PA sites and their differential usage.</p>
      <p id="Par8">We measured the performance of all the methods using the same simulation experiment. For each method, we used their respective effect size estimators (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PDUI$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>D</mml:mi><mml:mi>U</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq2.gif"/></alternatives></inline-formula> for DaPars and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PPAU$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq3.gif"/></alternatives></inline-formula> for QAPA) to compute the AUC similarly to what done for REPAC. Out of the four methods tested, REPAC, QAPA, and LABRAT were able to achieve high accuracy, with REPAC presenting a marginally higher performance (AUC = 0.9989 versus 0.9967 and 0.9975 for QAPA and LABRAT, respectively), while DaPars exhibited the lowest performance in the simulated dataset (AUC = 0.882) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). The lower performance of DaPars was on par with previous simulations suggesting that de novo prediction of PAS from traditional RNA-seq data is relatively inaccurate compared to methods that rely on annotated PAS [<xref ref-type="bibr" rid="CR4">4</xref>]. Moreover, DaPars was drastically slower (&gt; 40-fold) than all the methods tested (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1).<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarked tests. <bold>A</bold> Empirical ROC curves of REPAC, QAPA, and DaPars. REPAC and QAPA performs very similarly (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AUC = 0.99$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq4.gif"/></alternatives></inline-formula>) in simulated data, while DaPars shows a lower performance (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AUC=0.88$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>0.88</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq5.gif"/></alternatives></inline-formula>). Curves were based on the effect-size of the methods i.e., cFC, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PDUI$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>D</mml:mi><mml:mi>U</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PAU$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq7.gif"/></alternatives></inline-formula> for REPAC, DaPars, and QAPA, respectively. <bold>B</bold> REPAC runtime scales almost linearly with the number of samples</p></caption><graphic xlink:href="13059_2023_2865_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>REPAC enables fast and streamlined exploration of public domain data</title>
      <p id="Par9">The REPAC method and associated R package were designed to take advantage of our recently published recount3 resource [<xref ref-type="bibr" rid="CR8">8</xref>]. The recount3 project processed and analyzed data from over 750,000 samples of human and mouse origin publicly available in SRA in a standardized manner. The REPAC package extends recount3 to enable the extraction of expression estimates for thousands of PA sites within a few seconds per sample. The REPAC framework has major advantages over existing methods for APA analysis from RNA-seq data. For instance, it allows the user to skip the time- and storage-intensive step of downloading the raw data and processing it. By integrating with the recount3 framework, REPAC enables researchers to explore differential APA events for thousands of phenotypes in a fast and streamlined fashion. Since the protocols used to generate publicly available data sets can vary greatly, we performed three additional simulations to assess the performance of REPAC on common protocol variations. These variations were as follows: (1) polyA capture vs ribosomal depletion, (2) 50bp vs 75bp reads, (3) single- vs paired-end reads, and (4) experiment with factorial design. Overall, we found that REPAC is robust to variations in protocols with an overall accuracy greater than 0.95 in all simulations (see full benchmark statistics in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). QAPA and LABRAT both relies on lightweight quasi-mapping implemented in the salmon software, which has already been shown to be substantially faster than other methods such as DaPars and ROAR. Therefore, we benchmarked the speed of REPAC against QAPA and LABRAT. To this end, we started by obtaining from SRA the raw data for the project SRP048707 (see below). The total size of the data set analyzed was approximately 27 GB (gzipped fastq files). Assuming a constant speed of 300 Mbps, this step alone would take approximately 15 min to complete. Because REPAC pulls expression estimates directly from recount3, it allows the users to skip this step. Next, pre-processing (extracting 3′-UTR sequences, building the index and quantification) and expression quantification with salmon [<xref ref-type="bibr" rid="CR10">10</xref>] for QAPA analysis took on average 17 min and LABRAT took on average 20 min. Meanwhile, obtaining PAS estimates with the REPAC package took under one minute. Finally, detecting DPU between the comparisons took 0.03 min with QAPA and 6.5 min with LABRAT, compared to 3.2 min with REPAC. However, it is important to note QAPA does not perform any statistical testing, which contributes to the speed in this step. Overall, considering the entire workflow of an APA study, REPAC was 7.6 times faster than QAPA and 8.3 times faster than LABRAT.</p>
    </sec>
    <sec id="Sec6">
      <title>The REPAC method is scalable to large data sets</title>
      <p id="Par10">One advantage of REPAC is its ability to tap into recount3 to directly obtain PAS expression quantification. As demonstrated in the previous analysis, this feature can greatly speed up the analytical process even for small data sets. However, the advantages of REPAC become abundantly clear when analyzing large collections, such as the GTEx for instance, for which storage and computing power requirements can quickly become a limiting factor for many researchers. Moreover, the process of acquiring access to raw data can be slow and burdensome. To test how well REPAC scales with increasing amounts of data, we extracted PAS quantification and performed a DPU analysis for a total of 20, 100, 200, and 400 randomly selected brain (cortex) and testis tissue samples from the GTEx project (V8). We found that the time to quantify PAS with REPAC scaled linearly with the number of samples, with an average of 9 seconds per sample. The time to test for DPU between conditions remained stable at around four minutes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B).</p>
      <p id="Par11">When looking at highly differential PA site usage (<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|cFC| \ge 0.25$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>c</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FDR \le 0.05$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq9.gif"/></alternatives></inline-formula>) between 200 testis and 200 brain samples, we observed 879 genes with differential usage of PAS. The results showed that testis favors the expression of shorter 3’-UTR isoforms when compared to the cerebral cortex, with over 97% of the genes detected showing preferential usage of a shorter PAS in testis and vice-versa. These results were consistent with previous studies reports [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2).</p>
    </sec>
    <sec id="Sec7">
      <title>Global profiling of APA during B cell activation</title>
      <p id="Par12">We applied the REPAC method to investigate the landscape of APA in response to B cell activation. To this end, we used a dataset from Diaz-Muñoz et al. [<xref ref-type="bibr" rid="CR13">13</xref>] containing naive and LPS-activated B cells (with four replicates per condition). Using the REPAC package, we obtained expression estimates for 67,509 3′-UTR PAS (as derived from the PolyASite 2.0 database [<xref ref-type="bibr" rid="CR14">14</xref>], see the “<xref rid="Sec11" ref-type="sec">Methods”</xref>) for all samples and then performed a DPU analysis comparing naive versus LPS-activated B cells. This analysis detected 117 genes with DPU in response to B cell activation (<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|cFC| \ge 0.20$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>c</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>0.20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq10.gif"/></alternatives></inline-formula>, adjusted <italic>p</italic>-value <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.01$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq11.gif"/></alternatives></inline-formula>). Approximately 80% of the genes with DPU were found to have a higher usage of a more proximal PAS upon B cell activation, with the 3′-UTR being 817 bp shorter on the median. We found that genes associated with secretion mechanisms, such as Cd47, Edem1, and Rbx1, were among the most significant DPU events (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Next, we investigated whether these changes were associated with a particular biological process (BP). Through gene set enrichment analysis (GSEA) of GO BP, we observed that 19 BP were significantly enriched in 3′-UTR-Shortening (3′-US) events (adjusted <italic>p</italic>-value<inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.05$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq12.gif"/></alternatives></inline-formula>). Among the top enriched pathways were IRE1 mediated unfolded protein response and response to type I interferon (IFN-I) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Some of these findings were consistent with findings from Cheng and collaborators [<xref ref-type="bibr" rid="CR15">15</xref>] showing that in activated B cells, the genes associated with secretion exhibit shorter 3′-UTRs. Notably, our analysis also expanded the currently known set of genes and processes affected by APA-revealing processes, such as response to IFN-I, that have not been associated with B cell activation before.<fig id="Fig3"><label>Fig. 3</label><caption><p>3′-UTR-shortening events in naive and LPS-activated B cells. <bold>A</bold> Differences in 3′-UTR coverage of secretion associated genes Cd47 and Edem1. The coverage was normalized by the highest expressing base pair. <bold>B</bold> Heatmap showing the relationship between the usage of the proximal and distal PAS (PPAS:DPAS) and expression levels (CPM) using standardized values. Overall, preferential usage of the shorter 3′-UTR isoform (blue color) is associated with higher expression levels (red color) for the genes involved in secretion and IFN-I response</p></caption><graphic xlink:href="13059_2023_2865_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par13">Additionally, we also performed the same comparison using QAPA and LABRAT to assess whether these methods could also recover known B cell biology. The analysis by QAPA was able to detect 28 genes with DPU (<inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta |PPAU| \ge 20$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq13.gif"/></alternatives></inline-formula>), while LABRAT was able to detect 137 genes with DPU (<inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi \ge 0.1$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FDR \le 0.01$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq15.gif"/></alternatives></inline-formula>). GSEA analysis on QAPA and LABRAT results did not indicate enrichment in any of the processes found enriched by REPAC, including secretion pathways previously reported by other studies [<xref ref-type="bibr" rid="CR15">15</xref>] (see GSEA enrichment results in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S2-S4).</p>
      <p id="Par14">Surprisingly, none of the APA events were detected in common by all methods. Given this discrepancy, we visually evaluated inspect the results for the top 10 predicted events. Upon visual inspection of the results, we found that the events predicted by QAPA were largely driven by false positives caused by low 3′-UTR coverage in one of the groups, and no striking changes were observed in genes with enough coverage for QAPA and LABRAT (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S3 and S4), while the events predicted by REPAC clearly showed a difference in 3′-UTR coverage (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5).</p>
    </sec>
    <sec id="Sec8">
      <title>Technical implications of APA in downstream analyses</title>
      <p id="Par15">Our results indicated that APA events in 3′-UTR regions can drastically impact transcript size, as previously reported by other studies [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Therefore, we investigated how APA events can impact downstream steps, such as differential gene expression analysis. To this end, we obtained length-corrected (length scaled TPM) and uncorrected gene expression estimates via the salmon-tximport pipeline from whole transcript and CDS-only sequences. Next, we carried out a differential gene expression analysis between naive and activated B cells. After taking into account the different lengths of the isoforms, we found that many genes with APA events captured by REPAC exhibited significant changes in expression levels and fold-change between conditions (<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|logFC| \ge 0.5$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq16.gif"/></alternatives></inline-formula>, adjusted <italic>p</italic>-value <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.05$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq17.gif"/></alternatives></inline-formula>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>A).<fig id="Fig4"><label>Fig. 4</label><caption><p>APA can drastically impact expression estimates. <bold>A</bold> Expression levels of the whole transcript and CDS-only with and without length correction by tximport for the top 6 APA events predicted by REPAC. Many genes can be found deferentially expressed after length correction, highlighting the importance of APA in other analysis. <italic>P</italic>-values from a <italic>t</italic>-test between groups are shown. <bold>B</bold> Scatter plot shows the ratio between fold-change estimated from a differential gene expression analysis with and without length correction</p></caption><graphic xlink:href="13059_2023_2865_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par16">This issue was evidenced by genes such as Cd47, Ptpn1, and Edem1, whose expression levels after LPS-activation increase by 75%, 222%, and 20%, respectively, when adjusting for the transcript length. In contrast, if the transcript length is not taken into account, the observed changes in expression level upon LPS-activation for Cd47, Ptpn1, and Edem1 are 2%, 151%, and − 4.7%, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Moreover, for quantification of CDS regions, length-correction had little or no effect on gene expression levels of the majority of selected genes, confirming that the differences observed after correction in the whole transcript quantification did not originate from alternative splicing events. Genes predicted by REPAC to have 3′-US upon B cell activation showed predominantly increased fold-change values, while genes predicted to have 3′-UTR lengthening (3’UL) presented a decrease in fold-change when comparing fold-changes before and after isoform length correction (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). For some genes, we did not observe significant changes in fold-change after correction due to alternative PAS for these genes not being annotated as independent isoforms meaning these differences are usually not captured by gene expression quantification software.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par17">Here, we present regression of polyadenylation compositions (REPAC), a new framework for the study of differential PA events using traditional bulk RNA-sequencing data. The REPAC method is based on the principles of compositional data (CD) analysis developed by Aitchson [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par18">In our simulated data set REPAC outperformed DaPars, which is currently, one of the most popular methods of APA analysis, in both accuracy and speed. When compared to more recent developments such as QAPA, REPAC presented a marginal increase in performance (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). However, when comparing the results of REPAC, QAPA, and LABRAT in in a case-study, we found that REPAC was able to recover more known APA events associated with B cell activation than QAPA and LABRAT (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S2-S4). Moreover, REPAC offers substantial advantages over other existing methods.</p>
    <p id="Par19">The REPAC package takes full advantage of the recount3 framework to skip the data acquisition and processing steps and directly extract the necessary data for differential APA analysis with little resource usage and time. This feature makes over 750,000 samples readily available for analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This is a huge advantage over existing methods since all of them require raw data to be obtained and processed before analysis. Even when disregarding the time and effort of data acquisition, DaPars and QAPA still require pre-processing of the data such as aligning the data to the genome or performing 3′-UTR estimations with salmon, respectively. Despite salmon being relatively lightweight and faster than alignment-based methods (i.e. DaPars), it still requires substantial computational resources to carry the index construction and quantification, especially when a large number of PAS are used. Additionally, since REPAC makes use of generalized linear regression models, it can easily handle complex comparisons (i.e. factorial designs, paired samples, etc.) and correct for unwanted sources of variations (i.e. batch effects, blocks, etc.), which cannot be directly modeled by other methods (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1).</p>
    <p id="Par20">All of these overheads translate into a much faster and more accurate analysis with REPAC than other methods. We demonstrated that the analysis of a small data set (<italic>n </italic>= 8) was 7.6 times faster to process with REPAC than QAPA (4.2 versus 32 min) and LABRAT (4.2 versus 35 min). Both of these methods already outperforms other methods[<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Even when disregarding the time for data acquisition, REPAC was still 4 times faster than QAPA and 4.8 times faster than LABRAT. It is important to note that these differences in processing times would significantly scale with larger data sets, to the point where performing APA analysis with other methods, might become infeasible for research groups without access to a robust computing environment.</p>
    <p id="Par21">As a proof of principle, we used REPAC to compare brain (cortex) and testis tissues from GTEx V8. On average, REPAC took 9 seconds per sample to quantify all PAS, meaning REPAC is scalable for large data sets with 400 samples taking under one hour to complete the entire analysis (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). In contrast, other methods would require the user to first get permission to access the raw data, download the data, and processes it, all of which would take days and access to a robust computing environment that are compliant with data privacy laws (i.e. Health Insurance Portability and Accountability Act in the US, and General Data Protection Regulation in Europe).</p>
    <p id="Par22">Moreover, the results of this comparison were consistent with previous studies reporting that cells from non-proliferative tissue (e.g., brain) tend to express longer 3′-UTR isoforms than cells from proliferative tissues (eg, testis) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Interestingly, we found that 3′-US events were enriched for genes involved in spermatogenesis and androgen response, suggesting that APA is not only associated with a proliferative state but also regulates specific processes associated with tissue function (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2).</p>
    <p id="Par23">Despite one of the first pieces of evidence of APA as a functional mechanism being reported during B cell transition to plasma cell [<xref ref-type="bibr" rid="CR17">17</xref>], the landscape of APA during B cell activation had remained largely under-explored. Recently, a study by Cheng and collaborators [<xref ref-type="bibr" rid="CR15">15</xref>] conducted a broad survey of APA in secretory cell differentiation and observed that many genes involved in secretion presented 3′-UTR shortening after B cell activation. In light of these findings, we performed a case-study in order to evaluate if REPAC and other methods were able to replicate the findings by Chen and collaborators [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par24">Our analysis of naive versus LPS-activated B cells detected hundreds of genes impacted by APA, whose majority were 3′-UTR shortening events. On par with previous observations[<xref ref-type="bibr" rid="CR15">15</xref>], we found that genes involved in secretion were enriched in 3′-UTR shortening. Specifically, we found that genes involved in the IRE1 mediated unfolded protein response enriched in shortening events (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). We also observed that the genes involved in this pathway exhibited a negative correlation between 3′UTR size and gene expression, a relationship which has already been extensively reported by other studies [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Surprisingly, QAPA was not able to capture APA across any gene involved in the secretion pathway. LABRAT managed to capture one gene involved in secretion (Edem11) but did not exhibited any enrichment in processes related to secretion.</p>
    <p id="Par25">Interestingly, response to type I interferon (IFN-I) was among the most enriched processes in 3′-US. Early response of B cells to IFN-I has been shown to elicit many types of responses (e.g., enhance antiviral humoral feedback by increasing the formation of early antiviral IgM, increase TLR-9 mediated activation and regulate autoreactive B cell activation [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR20">20</xref>]). Using REPAC, we were able to detect 3′-US in genes such as Ptpn1, Ube2k, and Irf2bp2, which are known to be involved in cell response to interferon stimulation [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR25">25</xref>].</p>
    <p id="Par26">Finally, we also demonstrated that APA has serious implications on downstream analysis (e.g., differential gene expression analysis) since traditionally gene length is assumed to be the same between conditions and therefore is not accounted for in many approaches. While recent pipelines based on expression estimates at transcript level through quasi-mapping, such as the salmon-tximport [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] pipeline used in this analysis, can correct for differential isoform/3′-UTR usage, they are only able to do so if these isoforms/3′-UTRs are properly annotated. In this regard, we found that major annotation resources like GENCODE/ENSEMBL and RefSeq still lack proper annotation of 3’-UTRs for many genes. Therefore, the accessibility and ease of usage of REPAC is a powerful tool in making sure APA events are properly detected, annotated, and studied.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par27">We demonstrated that REPAC is a robust and powerful tool for exploring the biology of APA. It enables the analysis of over 750,000 samples encompassing thousands of different phenotypes. With REPAC, we want to encourage more studies on APA and how they influence normal and disease tissues. We hope this new tool can help pave the way to develop new hypotheses that can be further explored to understand the biological role of APA as a whole.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Detection of differential polyadenylation site usage</title>
      <p id="Par28">The REPAC framework is based on the Aitchison geometry in the simplex. A D-part simplex is defined as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S^{D} = \left\{ {\textbf {x}}=\left[ x_{1}, x_{2}, \dots , x_{D} \right] ; x_{i}&gt;0, i=1,2,\dots ,D; \sum _{i=1}^{D}x_{i}=k \right\} \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mfenced><mml:mo>;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>;</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>D</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2865_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic> is the number of elements of comprising a composition (i.e., number of PAS) and <italic>k</italic> is a positive constant. We apply the isometric log ratio (<italic>ilr</italic>) transformation to the simplex. Let <bold>x</bold> be a D-part simplex, then:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} clr({\textbf {x}})= &amp; {} \left[ ln\frac{x_{1}}{g({\textbf {x}})}, ln\frac{x_{2}}{g({\textbf {x}})}, \dots ,ln\frac{x_{D}}{g({\textbf {x}})}\right] \nonumber \\ ilr({\textbf {x}})= &amp; {} clr({\textbf {x}})U^t \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="]" open="["><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2865_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g({\textbf {x}}) = \left[ x_{1} x_{2} \dots x_{D} \right] ^\frac{1}{D}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mfrac></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq18.gif"/></alternatives></inline-formula> is the geometric mean of the composition and <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U^t$$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq19.gif"/></alternatives></inline-formula> is a matrix which columns form an orthonormal basis of the centered log-ratio (<italic>clr</italic>) plane of <bold>x</bold>. Starting with a initial reference <italic>r</italic> (most proximal PAS, <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{0}=x_{1}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq20.gif"/></alternatives></inline-formula>), we iterate over each subsequent PAS (<inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=[x_{2}, \dots , x_{D}]$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq21.gif"/></alternatives></inline-formula>) testing for DPU by fitting a linear model in a ilr-transformed sub-composition comprised of a reference and a target <italic>C</italic>[<italic>r</italic>, <italic>t</italic>], updating the reference to the target whenever the difference in compositions is not significant.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_n= &amp; {} ilr\left( C \left[ x_{r}, x_{t} \right] \right) ,\nonumber \\ Y_n= &amp; {} a \oplus \beta \otimes \tilde{X} + \epsilon ,\nonumber \\ r= &amp; {} (p \le \alpha \rightarrow r) \wedge (p \ge \alpha \rightarrow t) \end{aligned}$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>a</mml:mi><mml:mo>⊕</mml:mo><mml:mi>β</mml:mi><mml:mo>⊗</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>r</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∧</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>≥</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2865_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>C</italic> represents a closing operation in the sub-composition and <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=P(\beta = 0)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq22.gif"/></alternatives></inline-formula> is the probability of the slope being 0.</p>
      <p id="Par29">The compositional fold-change (cFC) reported by REPAC represents the fold-change of the isometric log-ratio transformed compositions. This effect size metric, must be interpreted in the simplex space. Since interpretation of changes in the simplex space are not easy to interpret, the REPAC package also provides the mean composition changes across groups (mcDiff) which can be interpreted as the mean percentage in the PAS usage compared to the reference site. REPAC also provides pre-annotated intervals of 3′UTR events for both human and mouse based on polyAsite database [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Simulation benchmark</title>
      <p id="Par30">To assess the performance of REPAC, we used simFlux [<xref ref-type="bibr" rid="CR27">27</xref>] to simulated fastq files of the dataset with 2 conditions and 5 replicates containing 5000 genes with two isoforms: a normal one (annotated) and one which 3′-UTR were extended by 1000 bp from the original gene model. Each replicates contained 5000 non-overlapping gene models that were randomly selected from the GENCODE 37 annotation and were composed of 2500 genes with longer/shorter isoforms equally distributed and 2500 genes without preferential isoform. The overall expression levels of the genes for each replicate were randomly assigned and the proportion of extended isoform usage was randomly assigned proportion <italic>p</italic> (<inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.1 \ge p \le 0.35$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>≥</mml:mo><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq23.gif"/></alternatives></inline-formula>) in the first condition and <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-p$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq24.gif"/></alternatives></inline-formula> for the second condition. The fastq files were aligned with STAR with default parameters against the hg38 human genome. For the benchmark of REPAC, we quantified 50 bp windows located 100 bp upstream of the PAS (TTS of the isoforms) using featureCounts, and the resulting matrix was used as input to REPAC to compare the two simulated conditions. Similarly, for DaPars [<xref ref-type="bibr" rid="CR6">6</xref>] we generated wig files from the alignments and used them as input to DaPars along with a gtf file of the simulated isoforms. To benchmark QAPA [<xref ref-type="bibr" rid="CR4">4</xref>], we quantified the 3′-UTR expression with salmon v1.6.0 [<xref ref-type="bibr" rid="CR10">10</xref>] using an index of 3′-UTR sequences extracted with the QAPA helper script and passed the quantification as input to QAPA. Finally, we assessed LABRAT [<xref ref-type="bibr" rid="CR9">9</xref>] performance by extracting the last two exons of the simulated transcripts using the mode “makeTFfasta” and quantified it using the modes “runSalmon” and “calculatepsi.” The absolute effect size of each method, i.e., cFC, <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PDUI$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>D</mml:mi><mml:mi>U</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq25.gif"/></alternatives></inline-formula>, <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PAU$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq26.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi$$\end{document}</tex-math><mml:math id="M60"><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq27.gif"/></alternatives></inline-formula> for REPAC, Dapars, QAPA, and LABRAT, respectively, was used as a score variable to compute the empirical ROC curves and AUC with the R/Bioconductor package ROCit.</p>
    </sec>
    <sec id="Sec14">
      <title>Resources and pre-processing</title>
      <p id="Par31">Both REPAC and QAPA rely on pre-annotated PAS to infer DPU. In this work, we used PAS annotations from the PolyAsite database for both mouse (mm10) and human (hg38) genomes. For each genome, we processed the PAS using <italic>QAPA build</italic> to incorporate PolyASite into the latest Ensembl annotations for each genome (v102 and v105 for mm10 and hg38, respectively) and select PAS overlapping with 3′-UTR regions. A total of 67509 and 85476 PAS coordinates were obtained and used in the downstream analysis for mice and humans, respectively. For the QAPA analysis, we extracted the 3′-UTR sequences using <italic>QAPA</italic> fasta. These sequences were used to build the index and perform the 3′-UTR expression quantification with salmon [<xref ref-type="bibr" rid="CR10">10</xref>]. For the REPAC analysis, we generated a BED file with coordinates for 50 bp windows located 50 bp upstream of the PAS (herein referred to just as polyadenylation sites), which were used as input to the REPAC package. The whole transcriptome index for salmon [<xref ref-type="bibr" rid="CR10">10</xref>] was built from the latest set of CDS and ncRNAs for the mouse genome from the Ensembl website to obtain the gene level quantification (see the “<xref rid="Sec16" ref-type="sec">Technical implications of APA in downstream analyses</xref>” section).</p>
    </sec>
    <sec id="Sec15">
      <title>Differential polyadenylation in activated B cells</title>
      <p id="Par32">Differential polyadenylation usage analyses were performed using REPAC and QAPA (v1.3) [<xref ref-type="bibr" rid="CR4">4</xref>] to detect differential PAS usage between naive and activated B cells. The REPAC analysis was carried out using the REPAC package to query recount3 tracks and quantify PAS to obtain an expression matrix. Next, we filtered low expressed sites (<inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CPM &lt; 10$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>C</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq28.gif"/></alternatives></inline-formula>) and low expressed genes (<inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CPM &lt; 30)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>C</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>30</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq29.gif"/></alternatives></inline-formula> from the analysis using the salmon whole transcriptome quantification (see the “<xref rid="Sec16" ref-type="sec">Technical implications of APA in downstream analyses</xref>” section) using the approach described in Chen and collaborators [<xref ref-type="bibr" rid="CR28">28</xref>]. Finally, we estimated the cFC between PAS by fitting a linear model on the ilr-transformed compositions. Compositions with <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|cFC| \ge 0.25$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>c</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq30.gif"/></alternatives></inline-formula> and adjusted <italic>p</italic>-value <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.05$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq31.gif"/></alternatives></inline-formula> were considered shortening or lengthening events if their cFC were negative or positive, respectively. For the GSEA analysis, we ranked the results of REPAC by <italic>t</italic>-statistics and tested the MSigDB GO Biological process collection for negative enrichment using a Monte Carlo adaptive multilevel splitting approach, implemented in the fgsea package [<xref ref-type="bibr" rid="CR29">29</xref>]. The results of GSEA were collapsed with fgsea collapsePathways function to reduce redundancy.</p>
      <p id="Par33">For the QAPA analysis, we used the QAPA quant option to load 3′-UTR expression estimates from salmon and compute the PAU’s for each sample. Low expressed 3′-UTRs were filtered (CPM <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M70"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq32.gif"/></alternatives></inline-formula> 10), and the <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PPAU$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq33.gif"/></alternatives></inline-formula> was computed as the difference between the average PPAU for each condition. Finally, genes with <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\Delta PPAU| \ge 20$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq34.gif"/></alternatives></inline-formula> were considered shortening or lengthening events if their <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PPAU$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq35.gif"/></alternatives></inline-formula> were negative or positive, respectively. Similarly, for the LABRAT analysis we generated the indexes using the mode “makeTFfasta” with the GENCODE M30 annotations, quantified it using the mode “runSalmon,” and computed the psi values and <italic>p</italic>-values with the “calculatepsi” mode. Enrichment analysis of GO BP were conducted in the same manner as REPAC, but instead ranking the genes by <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta PPAU$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq36.gif"/></alternatives></inline-formula> and <italic>psi</italic> for QAPA and LABRAT, respectively.</p>
    </sec>
    <sec id="Sec16">
      <title>Technical implications of APA in downstream analyses</title>
      <p id="Par34">To assess the impact 3′-US events can have in gene expression estimations, we obtained the raw data from SRA (SRP048707 [<xref ref-type="bibr" rid="CR13">13</xref>]) and estimated the transcripts expression levels with salmon [<xref ref-type="bibr" rid="CR10">10</xref>]. The transcripts estimates were summarized at gene level with tximport [<xref ref-type="bibr" rid="CR26">26</xref>] setting the argument “countsFromAbundance” to “no” (uncorrected expression values) and “lengthScaledTPM” (isoform length-corrected values). To evaluate whether the differences, if any, observed after length correction were a product of alternative splicing, we also performed the same gene expression estimations using only coding sequences (CDS). For each estimate, low count genes (&lt; 10 CPM) were filtered and the remaining genes were normalized with the trimmed mean of the <italic>M</italic>-Values method. A generalized linear model approach coupled with empirical Bayes moderation of standard errors and voom precision weights [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] was used to detect deferentially expressed genes between the selected contrasts. Adjusted <italic>p</italic>-values controlling for multiple hypothesis testing were performed using the Benjamini-Hochberg method [<xref ref-type="bibr" rid="CR32">32</xref>]. Next, the ratio between the fold-change of the two results for the genes with significant DPU was used to estimate the impact on downstream analysis.</p>
    </sec>
    <sec id="Sec17">
      <title>Analysis of GTEx tissues</title>
      <p id="Par35">To evaluate how well REPAC can scale with large data sets, we randomly selected a subset of 20, 100, 200, and 400 brains (cortex) and testis samples from the GTEx tracks of recount3 [<xref ref-type="bibr" rid="CR8">8</xref>]. For each subset, we quantified the PAS using the REPAC function <italic>create_pa_rse</italic> and recorded the time taken to quantify each subset. Next, we filtered PASs that were lowly expressed (counts <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M80"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq37.gif"/></alternatives></inline-formula> 10) and estimated the cFC between PAS by fitting a linear model on the ilr-transformed compositions. PAS with a <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|cFC| \ge 0.25$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>c</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq38.gif"/></alternatives></inline-formula> and <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FDR \le 0.05$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2865_Article_IEq39.gif"/></alternatives></inline-formula> were considered shortening or lengthening events if their cFC were negative or positive, respectively. GSEA analysis was carried out by ranking the results of REPAC by <italic>t</italic>-statistics and testing the MSigDB hallmarks collection with the fgsea package [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_2865_MOESM1_ESM.pdf">
            <caption>
              <p>
                <bold>Additional file 1:</bold>
                <bold>Supplementary Figures.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_2865_MOESM2_ESM.xlsx">
            <caption>
              <p>
                <bold>Additional file 2:</bold>
                <bold>Supplementary Tables.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_2865_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3.</bold> Peer review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>recount3 is hosted on SciServer, a collaborative research environment for large-scale data-driven science. It is being developed at, and administered by, the Institute for Data Intensive Engineering and Science (IDIES) at Johns Hopkins University. SciServer is funded by the National Science Foundation Award ACI-1261715. For more information about SciServer, visit <ext-link ext-link-type="uri" xlink:href="http://www.sciserver.org/">http://www.sciserver.org/</ext-link>.</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par36">Tim Sands was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par37">The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LM and ELI conceived the idea, designed the study, and interpreted the results; ELI performed the analysis; CW and BL provided the data and tools; all authors wrote, reviewed, and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This publication was made possible through support from the NIH R01CA200859 (L.M. and E.L.I.), the Weill Cornell Medicine Prostate Cancer SPORE P50 CA211024 (E.L.I.), the NIH-NIGMS grants R01GM121459 (C.W. and B.L.) and R35GM139602 (C.W. and B.L.), the Department of Defense (DoD) office of the Congressionally Directed Medical Research Programs (CDMRP) award W81XWH-16-1-0739 (E.L.I. and L.M.), and the Meyer Cancer Center Collaborative Research Initiative Pilot Grant (E.L.I. and L.M.). The funding sources played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All raw data used in this work are available at the Sequence Read Archive (SRA) (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra">https://www.ncbi.nlm.nih.gov/sra</ext-link>) study SRP048707. Counts estimates from GTEx are available through the recount3 and REPAC R packages. The REPAC R package can be obtained at <ext-link ext-link-type="uri" xlink:href="https://github.com/eddieimada/REPAC">https://github.com/eddieimada/REPAC</ext-link> [<xref ref-type="bibr" rid="CR33">33</xref>]. All scripts to reproduce the analyses in this manuscript, including simulation, are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/eddieimada/REPAC_paper">https://github.com/eddieimada/REPAC_paper</ext-link> [<xref ref-type="bibr" rid="CR34">34</xref>] and Zenodo [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par38">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par39">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par40">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoque</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>You</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of alternative cleavage and polyadenylation by 3’ region extraction and deep sequencing</article-title>
        <source>Nat Methods.</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>133</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2288</pub-id>
        <pub-id pub-id-type="pmid">23241633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanfilippo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Miura</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>EC</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide profiling of the 3’ends of polyadenylated RNAs</article-title>
        <source>Methods.</source>
        <year>2017</year>
        <volume>126</volume>
        <fpage>86</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2017.06.003</pub-id>
        <pub-id pub-id-type="pmid">28602807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lianoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Ubiquitously transcribed genes use alternative polyadenylation to achieve tissue-specific expression</article-title>
        <source>Genes Dev.</source>
        <year>2013</year>
        <volume>27</volume>
        <issue>21</issue>
        <fpage>2380</fpage>
        <lpage>2396</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.229328.113</pub-id>
        <pub-id pub-id-type="pmid">24145798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ha</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>QAPA: a new method for the systematic analysis of alternative polyadenylation from RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1414-4</pub-id>
        <pub-id pub-id-type="pmid">29301551</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grassi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mariella</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lembo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Molineris</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Provero</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Roar: detecting alternative polyadenylation with standard mRNA sequencing libraries</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1254-8</pub-id>
        <pub-id pub-id-type="pmid">26817711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Donehower</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Neilson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>EJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic analyses of alternative polyadenylation from RNA-seq reveal a 3’-UTR landscape across seven tumour types</article-title>
        <source>Nat Commun.</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/ncomms6274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The statistical analysis of compositional data</article-title>
        <source>J R Stat Soc Ser B (Methodol).</source>
        <year>1982</year>
        <volume>44</volume>
        <issue>2</issue>
        <fpage>139</fpage>
        <lpage>160</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilks</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>FY</given-names>
          </name>
          <name>
            <surname>Charles</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Solomon</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ling</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>recount3: summaries and queries for large-scale RNA-seq expression and splicing</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02533-6</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goering</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Gillen</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Taliaferro</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>LABRAT reveals association of alternative polyadenylation with transcript localization, RNA binding protein expression, transcription speed, and cancer survival</article-title>
        <source>BMC Genomics.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1186/s12864-021-07781-1</pub-id>
        <pub-id pub-id-type="pmid">33388042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sood</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Krek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Macino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Cell-type-specific signatures of microRNAs on target mRNA expression</article-title>
        <source>Proc Natl Acad Sci.</source>
        <year>2006</year>
        <volume>103</volume>
        <issue>8</issue>
        <fpage>2746</fpage>
        <lpage>2751</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0511045103</pub-id>
        <pub-id pub-id-type="pmid">16477010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Miura</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Westholm</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Shenker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Duff</surname>
            <given-names>MO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global patterns of tissue-specific alternative polyadenylation in Drosophila</article-title>
        <source>Cell Rep.</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>277</fpage>
        <lpage>289</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.01.001</pub-id>
        <pub-id pub-id-type="pmid">22685694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaz-Muñoz</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Fairfax</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Monzon-Casanova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Gonzalez-Porta</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The RNA-binding protein HuR is essential for the B cell antibody response</article-title>
        <source>Nat Immunol.</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>4</issue>
        <fpage>415</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1038/ni.3115</pub-id>
        <pub-id pub-id-type="pmid">25706746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herrmann</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kanitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Artimo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gruber</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PolyASite 2.0: a consolidated atlas of polyadenylation sites from 3’ end sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>D1</issue>
        <fpage>D174</fpage>
        <lpage>D179</lpage>
        <pub-id pub-id-type="pmid">31617559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baljinnyam</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ogami</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yeung</surname>
            <given-names>PL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Widespread transcript shortening through alternative polyadenylation in secretory cell differentiation</article-title>
        <source>Nat Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16959-2</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bartel</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>Widespread shortening of 3ÚTRs by alternative cleavage and polyadenylation activates oncogenes in cancer cells</article-title>
        <source>Cell.</source>
        <year>2009</year>
        <volume>138</volume>
        <issue>4</issue>
        <fpage>673</fpage>
        <lpage>684</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2009.06.016</pub-id>
        <pub-id pub-id-type="pmid">19703394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alt</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Bothwell</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Knapp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mather</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Koshland</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Synthesis of secreted and membrane-bound immunoglobulin mu heavy chains is directed by mRNAs that differ at their 3’ ends</article-title>
        <source>Cell.</source>
        <year>1980</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>293</fpage>
        <lpage>301</lpage>
        <pub-id pub-id-type="doi">10.1016/0092-8674(80)90615-7</pub-id>
        <pub-id pub-id-type="pmid">6771018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fink</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Manjarrez-Orduno</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Junt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Senn</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Holdener</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Early type I interferon-mediated signals on B cells specifically enhance antiviral humoral responses</article-title>
        <source>Eur J Immunol.</source>
        <year>2006</year>
        <volume>36</volume>
        <issue>8</issue>
        <fpage>2094</fpage>
        <lpage>2105</lpage>
        <pub-id pub-id-type="doi">10.1002/eji.200635993</pub-id>
        <pub-id pub-id-type="pmid">16810635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Giordani L, Sanchez M, Libri I, Quaranta M, Mattioli B, Viora M. IFN-<italic>α</italic> amplifies human naïve B cell TLR-9-mediated activation and Ig production. J Leukoc Biol. 2009;86(2):261–71.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiefer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oropallo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Cancro</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Marshak-Rothstein</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Role of type I interferons in the activation of autoreactive B cells</article-title>
        <source>Immunol Cell Biol.</source>
        <year>2012</year>
        <volume>90</volume>
        <issue>5</issue>
        <fpage>498</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="doi">10.1038/icb.2012.10</pub-id>
        <pub-id pub-id-type="pmid">22430248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phosphatase PTP1B negatively regulates MyD88-and TRIF-dependent proinflammatory cytokine and type I interferon production in TLR-triggered macrophages</article-title>
        <source>Mol Immunol.</source>
        <year>2008</year>
        <volume>45</volume>
        <issue>13</issue>
        <fpage>3545</fpage>
        <lpage>3552</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molimm.2008.05.006</pub-id>
        <pub-id pub-id-type="pmid">18571728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourdeau</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dubé</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tremblay</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Cytoplasmic protein tyrosine phosphatases, regulation and function: the roles of PTP1B and TC-PTP</article-title>
        <source>Curr Opin Cell Biol.</source>
        <year>2005</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ceb.2005.02.001</pub-id>
        <pub-id pub-id-type="pmid">15780598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Rajsbaum R, Versteeg G, Schmid S, Maestre A, Belicha-Villanueva A, Fernandez-Sesma A, et al. Unanchored Lysine48-linked polyubiquitin chains positively regulate the type I IFN-mediated antiviral response (P1391). J Immunol. 2013;190(1_Supplement):57–7.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cruz</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Hari</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Couture</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lagace</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Loss of IRF2BP2 in microglia increases inflammation and functional deficits after focal ischemic brain injury</article-title>
        <source>Front Cell Neurosci.</source>
        <year>2017</year>
        <volume>11</volume>
        <fpage>201</fpage>
        <pub-id pub-id-type="doi">10.3389/fncel.2017.00201</pub-id>
        <pub-id pub-id-type="pmid">28769762</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kraus</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Parisien</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>A hybrid IRF9-STAT2 protein recapitulates interferon-stimulated gene expression and antiviral response</article-title>
        <source>J Biol Chem.</source>
        <year>2003</year>
        <volume>278</volume>
        <issue>15</issue>
        <fpage>13033</fpage>
        <lpage>13038</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M212972200</pub-id>
        <pub-id pub-id-type="pmid">12574168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Soneson C, Love MI, Robinson MD. Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences. F1000Research. 2015;4.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griebel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zacher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ribeca</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Raineri</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lacroix</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modelling and simulating generic RNA-Seq experiments with the flux simulator</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>20</issue>
        <fpage>10073</fpage>
        <lpage>10083</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks666</pub-id>
        <pub-id pub-id-type="pmid">22962361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Chen Y, Lun AT, Smyth GK. From reads to genes to pathways: differential expression analysis of RNA-Seq experiments using Rsubread and the edgeR quasi-likelihood pipeline. F1000Research. 2016;5.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Korotkevich G, Sukhov V, Budin N, Shpak B, Artyomov MN, Sergushichev A. Fast gene set enrichment analysis. BioRxiv. 2021;060012.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>e47</fpage>
        <lpage>e47</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B (Methodol).</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Imada E. eddieimada/REPAC. GitHub. 2022. <ext-link ext-link-type="uri" xlink:href="https://github.com/eddieimada/REPAC">https://github.com/eddieimada/REPAC</ext-link>. Accessed 2 Feb 2023.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Imada E. eddieimada/REPAC_paper. GitHub. 2022. <ext-link ext-link-type="uri" xlink:href="https://github.com/eddieimada/REPAC_paper">https://github.com/eddieimada/REPAC_paper</ext-link>. Accessed 2 Feb 2023.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Imada E. eddieimada/REPAC_paper: First release (v1.0.0). Zenodo. 2022. <pub-id pub-id-type="doi">10.5281/zenodo.7044517</pub-id>. Accessed 2 Feb 2023.</mixed-citation>
    </ref>
  </ref-list>
</back>
