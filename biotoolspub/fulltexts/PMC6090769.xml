<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neurosci</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neurosci</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neurosci.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroscience</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1662-4548</issn>
    <issn pub-type="epub">1662-453X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6090769</article-id>
    <article-id pub-id-type="doi">10.3389/fnins.2018.00513</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Technology Report</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BEAPP: The Batch Electroencephalography Automated Processing Platform</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Levin</surname>
          <given-names>April R.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/289525/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Méndez Leal</surname>
          <given-names>Adriana S.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/482996/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gabard-Durnam</surname>
          <given-names>Laurel J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/482894/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O’Leary</surname>
          <given-names>Heather M.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/511739/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Neurology, Boston Children’s Hospital</institution>, <addr-line>Boston, MA</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Laboratories of Cognitive Neuroscience, Division of Developmental Medicine, Boston Children’s Hospital, Harvard Medical School</institution>, <addr-line>Boston, MA</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Center for Rare Neurological Diseases</institution>, <addr-line>Atlanta, GA</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Arnaud Delorme, UMR5549 Centre de Recherche Cerveau et Cognition (CerCo), France</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Pedro Antonio Valdes-Sosa, The Clinical Hospital of Chengdu Brain Science Institute, China; Dezhong Yao, University of Electronic Science and Technology of China, China; Guido Nolte, Fraunhofer Society (FhG), Germany; Laura Marzetti, Università degli Studi “G. d’Annunzio" Chieti-Pescara, Italy</p>
      </fn>
      <corresp id="c001">*Correspondence: April R. Levin, <email>april.levin@childrens.harvard.edu</email></corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Brain Imaging Methods, a section of the journal Frontiers in Neuroscience</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>07</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>513</elocation-id>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>7</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2018 Levin, Méndez Leal, Gabard-Durnam and O’Leary.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <copyright-holder>Levin, Méndez Leal, Gabard-Durnam and O’Leary</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Electroencephalography (EEG) offers information about brain function relevant to a variety of neurologic and neuropsychiatric disorders. EEG contains complex, high-temporal-resolution information, and computational assessment maximizes our potential to glean insight from this information. Here we present the Batch EEG Automated Processing Platform (BEAPP), an automated, flexible EEG processing platform incorporating freely available software tools for batch processing of multiple EEG files across multiple processing steps. BEAPP does not prescribe a specified EEG processing pipeline; instead, it allows users to choose from a menu of options for EEG processing, including steps to manage EEG files collected across multiple acquisition setups (e.g., for multisite studies), minimize artifact, segment continuous and/or event-related EEG, and perform basic analyses. Overall, BEAPP aims to streamline batch EEG processing, improve accessibility to computational EEG assessment, and increase reproducibility of results.</p>
    </abstract>
    <kwd-group>
      <kwd>EEG</kwd>
      <kwd>electroencephalography</kwd>
      <kwd>signal processing</kwd>
      <kwd>batch</kwd>
      <kwd>automated</kwd>
      <kwd>reproducibility</kwd>
      <kwd>MATLAB</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn01">American Brain Foundation<named-content content-type="fundref-id">10.13039/100005331</named-content></funding-source>
      </award-group>
      <award-group>
        <funding-source id="cn02">Autism Science Foundation<named-content content-type="fundref-id">10.13039/100008152</named-content></funding-source>
        <award-id rid="cn02">12-1004</award-id>
      </award-group>
      <award-group>
        <funding-source id="cn03">Nancy Lurie Marks Family Foundation<named-content content-type="fundref-id">10.13039/100000874</named-content></funding-source>
      </award-group>
      <award-group>
        <funding-source id="cn04">Brain and Behavior Research Foundation<named-content content-type="fundref-id">10.13039/100000874</named-content></funding-source>
        <award-id rid="cn04">25176</award-id>
      </award-group>
      <award-group>
        <funding-source id="cn05">National Institute on Deafness and Other Communication Disorders<named-content content-type="fundref-id">10.13039/100000055</named-content></funding-source>
        <award-id rid="cn05">R01-DC010290</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="2"/>
      <equation-count count="0"/>
      <ref-count count="40"/>
      <page-count count="13"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Electroencephalography (EEG) offers tremendous opportunities as a window into brain function. It offers potential in understanding large-scale neural network activity, and thus serves as a bridge between neurons and behavior. It is translatable, providing opportunities to bridge between animals and humans. It can be used in a variety of ages without requiring sedation, and in both typical and clinical populations, facilitating data acquisition in populations (such as young infants) who cannot follow instructions and have a limited behavioral repertoire. Its portability and relative affordability allow it to be easily used for multisite studies, which is of particular utility when studying rare diseases or acquiring large datasets.</p>
    <p>Often the most productive research combines knowledge from two or more previously disparate fields. EEG is of particular interest to researchers in fields such as neuroscience, psychology, and development, given its ability to measure and thus enhance understanding of brain activity across a wide variety of ages, settings, and disease states. Engineers, mathematicians, and computer scientists have developed numerous signal processing techniques and tools applicable to the large amount of EEG data even a short recording session can produce. In order to bridge these fields, and thus maximize the insights that can be obtained from EEG data, brain researchers must be able to access procedures and code created by experienced signal processors.</p>
    <p>Open source toolboxes such as EEGLAB (<xref rid="B3" ref-type="bibr">Delorme and Makeig, 2004</xref>), FieldTrip (<xref rid="B29" ref-type="bibr">Oostenveld et al., 2011</xref>) with SPM integrated (<xref rid="B24" ref-type="bibr">Litvak et al., 2011</xref>), Brainstorm (<xref rid="B33" ref-type="bibr">Tadel et al., 2011</xref>), MNE (<xref rid="B12" ref-type="bibr">Gramfort et al., 2014</xref>) with MNE-Python (<xref rid="B11" ref-type="bibr">Gramfort, 2013</xref>), and NUTMEG (<xref rid="B34" ref-type="bibr">Tannous and Teng, 2011</xref>) offer myriad opportunities in this regard. All of these toolboxes offer multiple advanced options for EEG (as well as magnetoencephalography, MEG) signal processing, with options to create analysis scripts for batch processing across multiple processing steps and analyses, for multiple EEG files.</p>
    <p>Despite these important advances, accessibility of integrated analyses remains limited in some cases. For users without coding experience, creating an analysis script or pipeline may be a daunting process. For users comfortable creating such scripts, keeping track of the inputs, outputs, and specific settings in various steps of an analysis can be challenging. This is particularly a concern for users evaluating large multisite or longitudinal datasets, in which native EEG format, sampling rates, electrode layouts during acquisition, variable names, and even line noise frequencies (for international studies) may differ across files.</p>
    <p>Additionally, reproducibility of analyses remains limited. Among automated analyses, the computer code that researchers use to generate data may link multiple software packages, set parameters that are only partially reported in a “Materials and Methods” section, and may not necessarily be saved or shared (<xref rid="B30" ref-type="bibr">Peng, 2011</xref>). Furthermore, “hand-editing” of EEG data further contributes to this concern, due to difficulties with human error and judgment discrepancies. Allowing reviewers or other researchers to exactly repeat prior analyses and review the details thereof would help address this concern.</p>
    <p>The Batch EEG Automated Processing Platform (BEAPP) thus aims to aid accessibility and reproducibility by building upon preexisting EEG analysis toolboxes to provide a flexible structure for automated batch processing of EEG datasets. Beginning with raw or partially preprocessed data, BEAPP offers a series of automated steps to manage EEGs collected across multiple acquisitions setups, minimize artifact, perform several types of re-referencing, segment continuous and/or event-related EEG, and conduct basic time-frequency analyses. User inputs are determined in a single scripted user interface or in a graphical user interface (GUI) that can be saved as a template for future users, allowing users to determine their analyses and parameters without writing their own code. BEAPP tracks the output and parameters of each step of the analysis, allowing users to review prior steps or re-run a portion of the analysis with new parameters when needed.</p>
    <p>The remainder of this manuscript provides an overview of the BEAPP format and current options, along with a series of sample analyses of publicly available data. This manuscript is intended to be used in conjunction with the BEAPP software package, user manual, and new module creation starter guide, available as described below.</p>
  </sec>
  <sec sec-type="materials|methods" id="s1">
    <title>Materials and Methods</title>
    <p>BEAPP is modular, MATLAB-based software, with user inputs entered via a GUI or a script, and with functions in script format. BEAPP is freely available, covered under the terms of the GNU General Public License (version 3) (<xref rid="B7" ref-type="bibr">Free Software Foundation, 2007</xref>). The BEAPP software package, user manual, and new module creation starter guide are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/lcnbeapp/beapp">https://github.com/lcnbeapp/beapp</ext-link>. BEAPP is hosted on GitHub, with the intention that users adding new functionality will build upon the basic BEAPP structure, ultimately providing shared functionality for EEG analysis across a variety of laboratories and research studies. BEAPP integrates code from several other EEG analysis toolboxes and pipelines, including EEGLAB (<xref rid="B3" ref-type="bibr">Delorme and Makeig, 2004</xref>), the PREP pipeline (<xref rid="B1" ref-type="bibr">Bigdely-Shamlo et al., 2015</xref>), the CSD toolbox (<xref rid="B16" ref-type="bibr">Kayser and Tenke, 2006a</xref>,<xref rid="B17" ref-type="bibr">b</xref>), REST (<xref rid="B5" ref-type="bibr">Dong et al., 2017</xref>), Cleanline (<xref rid="B28" ref-type="bibr">Mullen, 2012</xref>), FieldTrip (<xref rid="B29" ref-type="bibr">Oostenveld et al., 2011</xref>), MARA (<xref rid="B37" ref-type="bibr">Winkler et al., 2014</xref>), and HAPPE (<xref rid="B9" ref-type="bibr">Gabard-Durnam et al., 2018</xref>).</p>
    <p>BEAPP is divided into four main steps, based on the format of input and output data (<bold>Figure <xref ref-type="fig" rid="F1">1</xref></bold>). Step 1 involves converting native data into BEAPP format. Step 2 involves preprocessing of continuous data, for minimization of experimentally generated artifacts and standardization across acquisition setups. Step 3 involves dividing continuous data into segments for further analysis. Step 4 includes several options for analyses themselves, particularly those based on spectral decomposition. If users wish to input pre-segmented native data, they may skip steps 2 and 3 and proceed directly to analysis. Of note, while steps 1 and 2 are conceptually separate and thus described separately in the manuscript, within the GUI these steps are combined under the “Format and Preprocessing” option.</p>
    <fig id="F1" position="float">
      <label>FIGURE 1</label>
      <caption>
        <p>Flowchart of BEAPP steps and modules. This figure provides an overview of BEAPP. Each step is divided into modules, which contain user-defined parameters. Modules are indicated by individual cells. Cell body color indicates module input format, and cell outline color indicates module output format. Green = native file format; Blue = EEG in continuous array; Purple = EEG in segmented 3D array; Red = Output measure. For each module, sample parameters are outlined in black.</p>
      </caption>
      <graphic xlink:href="fnins-12-00513-g001"/>
    </fig>
    <p>Within each step, the user can select any series of modules. Within modules, further customizable options and parameters are available. The user inputs offer a script-based or GUI-based menu to determine whether to include each given module, choose which options and parameters being used for that module, and decide whether to save the output of that module. Default parameters are offered to guide a beginning user, and as an example of parameter input format. Outputs include EEG data produced in that module, along with file-specific and group-level information intended to allow a user to easily keep track of how raw data have been altered, while avoiding unnecessary redundancy that may lead to excessively large file sizes.</p>
    <p>The user guide contains detailed information about how to prepare EEG data to be run through BEAPP, including a “Start-Up Guide” for preparing an initial data run. This includes information on ensuring a user has the software necessary for running BEAPP, preparing the EEG files that will be analyzed (in a format recognizable by BEAPP), specifying any additional file-specific information not contained within the original EEG files themselves (e.g., line noise frequency), and setting the modules (and the options and parameters within these modules) to be run on the data. There is also a BEAPP “Module Creation Starter Guide” provided with the BEAPP software, to help users add new functionality.</p>
    <sec>
      <title>Step 1: Formatting Data for BEAPP</title>
      <p>Prior to running any processing, segmenting, or analysis modules, BEAPP converts data from its native file format into BEAPP file format. BEAPP can handle several native file formats; details about how to prepare native files are included in the user guide. BEAPP format includes a cell array labeled <italic>eeg</italic>, which contains one matrix per recording period with the relevant EEG data. Each row of the matrix contains the amplitude of the EEG tracing for a particular channel, and each column contains the amplitude of the EEG tracing at a particular timepoint. For example, data obtained from an EEG with 129 channels over 60 s, sampled at 500 Hz, would be a 129 × 30,000 matrix. BEAPP format also includes a variable labeled <italic>file_proc_info</italic>, which contains key information specific to a particular EEG, including electrode layout, event timing, and sampling rate. As each file runs through the BEAPP platform, details of what processing steps the EEG has undergone are also included in <italic>file_proc_info</italic>. Of note, files in BEAPP format can be converted to and from EEGLAB file format as needed, using the batch_beapp2eeglab.m and batch_eeglab2beapp.m functions, respectively.</p>
      <p>Native continuous (unsegmented) EEG data, with tags defining any events for later segmentation if necessary, provides the greatest flexibility in terms of which modules can be run in BEAPP. However, if users wish to provide preprocessed, pre-segmented data to BEAPP for analysis, this can be accommodated as well.</p>
      <p>The formatting module requires users to provide BEAPP with the native EEG data and additional necessary information, including information about data type (baseline, event-tagged, or conditioned baseline). For our purposes, “baseline” refers to data that is continuously collected and not tied to any particular stimulus or time point. (If any event tags happen to exist in data marked as “baseline,” these tags will be ignored in the analysis and will not determine how the data are segmented). For many users, resting-state data may fit these criteria. “Event-tagged” refers to data that, while perhaps continuously collected, contains tags that specify a particular stimulus or time point around which segmentation should occur. This can be used for event-related potential (ERP) paradigms, for example. “Conditioned baseline” refers to a hybrid of baseline and event-tagged data, in which baseline data occurs between event tags; this includes alternating or recurring sections of baseline data. Resting data in which the eyes are intermittently opened and closed, sleep stages, or data containing intermittent epileptiform activity would often be of this data type. There is also an option to specify whether particular “recording periods” of data should be analyzed. In BEAPP, “recording periods” refer to sections of continuous data in a non-continuous data file. For example, if an EEG file contains one minute of continuous data, followed by a break during which no EEG was recorded, and then another minute of continuous data, then each of these one-minute runs of continuous data would be considered a recording period, and outputs would be reported separately for each recording period. Additionally, users provide information about electrode layout(s), line noise frequency, sampling rate(s), event tag name(s), and event tag offset(s), all of which may differ across EEGs within a single dataset.</p>
    </sec>
    <sec>
      <title>Step 2: Preprocessing of Continuous Data</title>
      <p>In step 2 (preprocessing of continuous data), each module involves input of a continuous EEG signal, and output of another continuous EEG signal after modification by that module. The first module the user selects utilizes the user-provided EEG as its input, and each successive module that the user selects builds upon changes to the EEG made in the prior module. As above, the user can determine which modules to use, and which to turn off.</p>
      <sec>
        <title>PREP Pipeline</title>
        <p>In step 2, the first module offered is the PREP pipeline (<xref rid="B1" ref-type="bibr">Bigdely-Shamlo et al., 2015</xref>). The PREP pipeline is offered first because it was developed as a standardized early-stage preprocessing pipeline, including line noise removal using the <italic>cleanline</italic> method (<xref rid="B28" ref-type="bibr">Mullen, 2012</xref>), and robust average referencing with detection and interpolation of bad channels relative to this reference. Because line noise frequency varies by region (60 Hz in most of North America, 50 Hz in most of Europe, Africa, and Australia, and either 50 or 60 Hz in parts of South America and Asia), the BEAPP user is offered the opportunity to specify expected line noise frequency for their dataset in the formatting module, and this is altered accordingly in PREP. For users who may wish to evaluate data from multiple countries with potentially different line noise frequencies, users also have the option to define line noise frequency separately for each individual file. Since PREP is intended to be a standardized pipeline, optional input parameters for PREP through BEAPP are otherwise intentionally limited, although an advanced user could manually make changes directly within PREP as needed. Outputs include information about a variety of variables determined by the PREP pipeline, including whether any errors were encountered, and which channels PREP interpolated.</p>
      </sec>
      <sec>
        <title>Filtering</title>
        <p>Users may next use the filter module to apply their choice of high pass, low pass, and/or notch filtering steps, and can set the frequency parameters for each of these. BEAPP currently uses the EEGLAB <italic>eegfiltnew</italic> function for the high pass, low pass, and notch filters in this module, pulling in file-specific EEG data and sampling rate. <italic>Cleanline</italic> (<xref rid="B28" ref-type="bibr">Mullen, 2012</xref>) is also available for line noise removal.</p>
        <p>Several checks are included in this module. First, since the user is offered the opportunity to later resample after filtering, BEAPP verifies that the minimum allowed sampling rate (after resampling) will not be less than twice the maximum frequency of the low pass filter, in order to avoid aliasing during resampling. (Of note, given imperfections in a typical filter, we would in fact recommend that the low pass filter be set below, rather than at, the Nyquist frequency of the resampling rate). Alternatively, if data in a particular file is sampled at a rate lower than the maximum good frequency in the low pass filter, filtering is skipped for that file. User notifications are generated in both of these cases, although the pipeline will continue running.</p>
        <p>Typically a user will opt to remove line noise using either a notch filter or <italic>cleanline</italic>, but not both. Of note, <italic>cleanline</italic> is applied in both the PREP pipeline and the HAPPE pipeline (part of the ICA module, and described in companion paper; <xref rid="B9" ref-type="bibr">Gabard-Durnam et al., 2018</xref>); therefore, users applying PREP or HAPPE to their data will likely opt to turn both notch filtering and <italic>cleanline</italic> steps off in this module. By default, if the notch filter or <italic>cleanline</italic> are turned on, they will target frequency components in the range of the user-defined line noise.</p>
      </sec>
      <sec>
        <title>Resampling</title>
        <p>The next module offered is resampling. Users are currently offered the option to resample using interpolation via the MATLAB <italic>interp1</italic> function. While resampling can be used for any number of reasons, in BEAPP its primary utility is likely to standardize sampling rates across multiple acquisition setups (and hence potentially multiple acquisition sampling rates), by downsampling those EEGs collected at higher sampling rates to match the EEGS collected at lower sampling rates.</p>
      </sec>
      <sec>
        <title>Independent Components Analysis (ICA)</title>
        <p>BEAPP includes an ICA module, which provides three options for applying ICA to a dataset. One option is ICA alone, which decomposes the data from selected channels into a series of components maximizing temporal independence from one another. BEAPP employs the extended infomax ICA algorithm (with pre-whitening) to account for sources with subgaussian or supergaussian activity distributions (<xref rid="B19" ref-type="bibr">Lee et al., 1999</xref>). Relative to other ICA algorithms and decomposition methods, this ICA algorithm has been shown to be useful for decomposing electrophysiological signals like EEG (<xref rid="B4" ref-type="bibr">Delorme et al., 2007</xref>). If the user chooses this option, the EEG run through the remainder of BEAPP will include these components in place of channels, although the format (and variable names) will otherwise remain unchanged. Users may choose this option if they wish to analyze a particular component or series of components.</p>
        <p>As a second option, if users wish to use ICA for artifact rejection, they may choose the option for ICA with a multiple artifact rejection algorithm (MARA). While details of MARA are described elsewhere (<xref rid="B38" ref-type="bibr">Winkler et al., 2011</xref>, <xref rid="B37" ref-type="bibr">2014</xref>), it is worth noting that MARA has been shown to identify multiple types of artifact (including that from muscle and eye movements) for rejection in an automated manner, and can be applied to different electrode placements. While other options for automated artifact detection could be added in the future, we began with MARA because of its fully automated approach, its generalizability across participants and EEG acquisitions, and its ability to detect multiple classes of artifacts (rather than being restricted to a single artifact type). For users who wish to visualize the components that MARA selects for rejection, or manually select alternative components for rejection, a visualization option is provided; however, users should note that this addition of a manual step may decrease reproducibility of the otherwise automated EEG processing in BEAPP.</p>
        <p>Of note, although there is still much empirical research to be done on processing steps and data parameters to optimize ICA performance (e.g., filtering settings, data quality, downsampling), ICA works best under several conditions. ICA performs optimally when data has been high pass filtered to remove non-stationary signal, and low-pass filtered to remove frequencies outside the range of biological sources (e.g., 250 Hz by some accounts) (<xref rid="B37" ref-type="bibr">Winkler et al., 2014</xref>). To avoid sensitivity to slow drift, high pass filtering at 0.5 Hz, or up to a maximum 2 Hz, is also recommended. While empirical testing is limited, it is also often recommended that for a given number of channels <italic>c</italic> and number of data samples <italic>s</italic>:</p>
        <disp-formula id="E1">
          <mml:math id="M1">
            <mml:mrow>
              <mml:mi>s</mml:mi>
              <mml:mo>≥</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>*</mml:mo>
              <mml:msup>
                <mml:mi>c</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msup>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where <italic>x</italic> is a minimum of 20–30. This is to avoid overlearning and generate a robust, stable ICA signal decomposition (<xref rid="B31" ref-type="bibr">Särelä and Vigário, 2003</xref>). Users should take into account any down-sampling from the raw data when calculating their (effective) data samples. A large number of data samples and seconds of EEG data are necessary but not sufficient to guarantee robust ICA decomposition; therefore, these may serve as preliminary guidelines in combination with the abovementioned parameters.</p>
        <p>MARA works best with epochs that are at least 15 s long, and suboptimal results may occur if data is high pass filtered at frequencies greater than 2 Hz or low pass filtered at frequencies less than 39 Hz. MARA calculates several metrics as part of its artifact detection algorithm that use spatial information from the 10–20 electrodes (or their equivalents), so users wishing to apply MARA should have channel locations with known 10–20 channel equivalents. Accordingly, within BEAPP, ICA/MARA currently runs on any channels in the acquisition layout whose placement corresponds to an electrode in the 10–20 system, and on any additional channels defined by the user to achieve the relationship between channels and samples as described above.</p>
        <p>As a third option (and, if the user chooses, as an alternative to the other modules in step 2), the user also has the opportunity to run the HAPPE pipeline within BEAPP. HAPPE is described in a companion manuscript to this one (<xref rid="B9" ref-type="bibr">Gabard-Durnam et al., 2018</xref>), and is targeted toward artifact removal for EEG data collected from young children, those with neurodevelopmental disorders, or other EEG data with short recording lengths or high levels of artifact contamination. HAPPE includes highpass filtering at 1 Hz (bandpass filtering 1–249 Hz for EEGs sampled at 500 Hz or higher), <italic>cleanline</italic> for line noise removal, automated bad channel detection and removal, wavelet-enhanced ICA (W-ICA) and ICA with MARA component rejection for artifact removal, interpolation of bad channels, and referencing to average or single-channel or channel subset references. In the segmentation step of BEAPP, HAPPE also offers specific segmentation options, including automated segment rejection. HAPPE produces a single summary report across all EEGs of data quality metrics for each EEG to facilitate evaluation of files for inclusion in further analysis and to assess HAPPE performance on the data. For further details, see the companion paper on HAPPE (<xref rid="B9" ref-type="bibr">Gabard-Durnam et al., 2018</xref>).</p>
      </sec>
      <sec>
        <title>Re-referencing</title>
        <p>BEAPP then offers several options for re-referencing data. One referencing option is the infinity reference obtained by the reference electrode standardization technique (REST) (<xref rid="B39" ref-type="bibr">Yao, 2001</xref>, <xref rid="B40" ref-type="bibr">Yao et al., 2005</xref>; <xref rid="B5" ref-type="bibr">Dong et al., 2017</xref>), which is provided since multiple studies have recently found performance of REST to be superior to other referencing techniques (<xref rid="B2" ref-type="bibr">Chella et al., 2017</xref>; <xref rid="B13" ref-type="bibr">Huang et al., 2017</xref>; <xref rid="B20" ref-type="bibr">Lei and Liao, 2017</xref>; <xref rid="B23" ref-type="bibr">Liang et al., 2017</xref>).</p>
        <p>If users prefer, data can be referenced to average at this stage. (Of note, average referencing does not need to be repeated at this stage if native data was average referenced, or if either PREP or HAPPE were already run on a dataset, because these pipelines output average referenced data). Data can also be referenced to a single channel or user-defined channel subset. Alternatively, data can be Laplacian referenced, using the CSD toolbox (<xref rid="B16" ref-type="bibr">Kayser and Tenke, 2006a</xref>). The Laplacian transform is well-regarded by many signal processors for its ability to help counteract the negative effects of volume conduction and recording reference (<xref rid="B18" ref-type="bibr">Kayser and Tenke, 2015</xref>) as well as muscle artifact (<xref rid="B6" ref-type="bibr">Fitzgibbon et al., 2013</xref>); additionally, Laplacian and average referencing can provide complementary information, as these techniques allow for targeted analysis of localized and widespread activity, respectively (<xref rid="B22" ref-type="bibr">Levin et al., 2017b</xref>).</p>
        <p>There is a complex relationship between referencing and channel interpolation. A channel with poor signal quality (e.g., an electrode that was not appropriately attached to the head) can significantly alter the appearance not only of its own tracing, but also the tracing of any channels referenced to it. Therefore, such channels are often interpolated prior to re-referencing. However, interpolation itself depends on data in the surrounding channels; if more than one channel has poor signal quality, signal in an interpolated channel may have persistently poor quality. Additionally, determination of which channels have poor signal quality may differ depending upon the reference type being used.</p>
        <p>To address this concern, BEAPP offers several options. As one option, users may opt to use the PREP pipeline (<xref rid="B1" ref-type="bibr">Bigdely-Shamlo et al., 2015</xref>), which includes a robust re-referencing procedure. This procedure involves iterative estimation of the average referenced signal, identification and interpolation of bad channels relative to this average referenced signal, and then re-estimation of the average referenced signal. This process is continued until iteratively alternating between these two processes no longer changes which channels are identified as requiring interpolation. Alternatively, users may opt to use ICA with MARA or HAPPE prior to re-referencing; in both of these options, for high-density EEG only a subset of the original channels are typically maintained (given limitations on the relationship between number of channels, which informs the number of ICA components, and number of data samples) (<xref rid="B26" ref-type="bibr">Makeig and Onton, 2011</xref>). Within this subset of channels, HAPPE identifies channels with poor signal quality and removes them before running ICA. ICA with MARA (either on its own or as part of HAPPE) then essentially acts upon remaining channels in the user-defined subset to minimize artifact while maintaining underlying signal. Any channels within the subset that had been removed earlier in processing are then interpolated. After PREP, ICA with MARA, or HAPPE, users can choose either to maintain any interpolated channels as they are, or remove any interpolated channels (substituting their data with NaN) so that they are not included in re-referencing and further steps.</p>
      </sec>
      <sec>
        <title>Detrending</title>
        <p>The final module currently offered in the preprocessing step of BEAPP is a detrending option. Currently users may choose mean, linear, or Kalman detrending. While mean or linear detrending will likely suffice for most users, Kalman detrending has been used for removal of artifact from transcranial magnetic stimulation (<xref rid="B27" ref-type="bibr">Morbidi et al., 2008</xref>) and ballistocardiogram (<xref rid="B14" ref-type="bibr">In et al., 2006</xref>), as well as epileptic spike detection (<xref rid="B36" ref-type="bibr">Tzallas et al., 2006</xref>). Kalman filtering works within a Bayesian framework, uses surrounding information to estimate the state of a process, and thus estimate the noise to be removed from the signal. (<xref rid="B15" ref-type="bibr">Kalman, 1960</xref>). Notably, “detrending” in this module refers to processing of the continuous EEG. A separate option for detrending within individual segments is also available in step 3.</p>
      </sec>
    </sec>
    <sec>
      <title>Step 3: Division of Data Into Segments</title>
      <p>In step 3 (division of data into segments), the input is a continuous EEG signal. This is typically the last EEG signal output from step 2 after preprocessing is complete, although users who have preprocessed their data outside of BEAPP may choose to proceed directly to step 3 after formatting. The output is a series of EEG segments, which are ready for the analyses offered in step 4.</p>
      <p>During the segmentation step, users may specify whether to treat data as baseline data, event-related data, or conditioned baseline data and whether any additional processing (e.g., within-segment detrending) takes place. Additionally, this step allows the user to provide rejection criteria for each segment.</p>
      <sec>
        <title>Event-Related Data</title>
        <p>For event-related EEG, the data segments created are time-locked to a stimulus or other marked event (hereafter “stimulus” will refer to all cases of an event). The user can define the event code for this stimulus of interest, and specify segment start and end times in relation to the stimulus. Start and end times can be negative or positive, for situations in which the user would like segments to include data before or after stimulus offset, respectively. If the timing of the event code is offset from the true stimulus delivery time (e.g., due to transmission delays in the stimulus presentation setup), the user can define this offset in the formatting module. If offsets are not uniform across the dataset, the user can provide a table that defines the offset for each individual file. Once segments are created, the user can choose whether to run a within-segment linear detrend. “Bad” segments can be rejected if data in any channel crosses an amplitude threshold set by the user, or using rejection criteria defined in HAPPE, which includes both amplitude thresholding and assessment of segment likelihood (where artifact-contaminated segments should be less likely than good segments) using joint probability calculations (both across segments for a single channel and across channels for a single segment).</p>
        <p>Of note, this initial creation of segments is used primarily for within-segment preprocessing, and for determining which segments to reject. The user is not obligated to analyze all of the data within a segment once a segment has been created, however. In the analysis step (described below), the user can choose a sub-segment upon which to focus their analyses. This may be particularly useful for users who wish to baseline correct event-related data to a pre-stimulus baseline, or users who wish to run separate analyses on a series of sub-segments (e.g., early and late responses to a stimulus).</p>
      </sec>
      <sec>
        <title>Baseline Data</title>
        <p>For baseline data, the user defines the length of segments to be created, and BEAPP creates a series of non-overlapping segments from the available data. Amplitude thresholding or HAPPE-based thresholding for segment rejection can occur after BEAPP divides the full EEG into segments, in a manner identical to event-related segment rejection (<bold>Figure <xref ref-type="fig" rid="F2">2A</xref></bold>). Alternatively, BEAPP offers an option to use amplitude thresholding to first identify segments of unusable data within the continuous EEG, and then create segments from the remaining data. For this purpose, BEAPP’s definition of unusable data is intended to closely match common hand-editing practices, which aim to identify high-amplitude data and its surrounding rise and fall. Upon identifying any data point that is above threshold, BEAPP determines the nearest zero-crossing before and after that data point. Above-threshold segments are then defined as beginning and ending at the nearest zero-crossings, rather than only including the narrower windows of time where data is suprathreshold. BEAPP creates a mask marking segments of data in which any channel is above threshold (as defined by the zero-crossing start and end points), and then creates segments from the remaining data (<bold>Figure <xref ref-type="fig" rid="F2">2B</xref></bold>).</p>
        <fig id="F2" position="float">
          <label>FIGURE 2</label>
          <caption>
            <p>Segmentation and amplitude thresholding. Channels are arranged vertically, with horizontal channel reference lines in cyan. For clarity, only those channels that are part of the 10–20 system, and those channels that cross the amplitude threshold in this portion of the EEG, are shown here. EEG tracings for each channel are in black. Reference lines are spaced by 100 μV, equal to amplitude threshold, so that above-amplitude portions of tracing cross another channel’s reference line. Dark blue vertical lines indicate segment boundaries; in this example, 1 s segments are created from continuous data. Sample data here are from baselineEEG08.mat, samples 13,250:15,750, after PREP, filtering (1 Hz high pass, 100 Hz low pass), and mean detrending. <bold>(A)</bold> Amplitude thresholding after segmentation. Pink patches demonstrate segments rejected because at least one channel crosses the artifact threshold. Portions of the EEG tracing that are above the amplitude threshold (and thus lead a segment to be rejected) are in red. Blue patches demonstrate good segments to be analyzed. <bold>(B)</bold> Amplitude thresholding before segmentation. Pink patches demonstrate segments rejected because at least one channel crosses the artifact threshold; length of segment spans from zero-crossing before the segment crosses the artifact threshold to zero-crossing after the segment crosses the artifact threshold. Portions of the EEG tracing that are above the amplitude threshold, extending out to the zero-crossing on either side (thus determining the boundaries for rejected segments) are in red. Blue patches demonstrate good segments to be analyzed. White patches demonstrate remaining segments of good data that are too short for analysis.</p>
          </caption>
          <graphic xlink:href="fnins-12-00513-g002"/>
        </fig>
        <p>Regardless of whether segment rejection occurs before or after segmentation, non-continuous data are not concatenated in any way, given concerns about data integrity with concatenation. Data is divided into the maximum possible number of segments of user-specified length, but any remaining data at the end of each useable segment, if it is too short to create its own segment, is excluded from analysis.</p>
      </sec>
      <sec>
        <title>Conditioned Baseline Data</title>
        <p>As described above, conditioned baseline data is essentially a hybrid of baseline and event-tagged data, in which baseline data occurs between event tags. The user specifies the event tags that signify onset and offset of conditioned baseline periods. Then, as for baseline data, the user defines the length of segments to be created, and BEAPP segments the data between event tags accordingly.</p>
      </sec>
      <sec>
        <title>Further Processing of Segments</title>
        <p>Once segments have been created, BEAPP also offers an option for within-segment detrending. All of the analyses described below can then be run on a segment in its entirety, or on a sub-segment. For event-related data, users have the option to baseline correct one portion of the segment (typically a post-stimulus portion) to another portion of the segment (typically a pre-stimulus portion) prior to running analyses on a sub-segment.</p>
      </sec>
    </sec>
    <sec>
      <title>Step 4: Analyses</title>
      <p>In step 4 (analyses), the inputs are the segmented EEG. Outputs are the results of analyses themselves. For each file, detailed outputs are reported in MATLAB, for users who wish to run further analyses on their own. Additionally, several summary outputs are output into a .csv file, for users who do not desire any further post-processing. Several basic analyses are currently offered in BEAPP. Users may also use the preprocessed data output from step 2 or segmented data output from step 3 as a basis for performing other analyses outside of BEAPP, if they prefer.</p>
      <sec>
        <title>Power Spectrum</title>
        <p>Spectral power is initially calculated on each segment or sub-segment created as above. Several options are offered for a how a power spectrum is calculated.</p>
        <p>If the user opts to use a rectangular window or Hanning window, power is calculated by Fast Fourier Transform, using the <italic>fft</italic> function (<xref rid="B8" ref-type="bibr">Frigo and Johnson, 1998</xref>) in MATLAB. Each segment is zero-padded with trailing zeros to the nearest power of 2, as recommended by MATLAB to increase the performance of <italic>fft</italic> when the number of samples in a given segment is not a power of 2. This creates a double-sided power spectrum, with complex fft values. For a single side of this spectrum <italic>eeg_wf</italic>, absolute power <italic>eeg_wfp</italic> is then calculated for each segment, for given sampling rate <italic>sr</italic> and segment length (in samples) <italic>l</italic>, as follows:</p>
        <disp-formula id="E2">
          <mml:math id="M2">
            <mml:mrow>
              <mml:mi>e</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mi>g</mml:mi>
              <mml:mo>_</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mi>f</mml:mi>
              <mml:mi>p</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mo>*</mml:mo>
                  <mml:mo>|</mml:mo>
                  <mml:mi>e</mml:mi>
                  <mml:mi>e</mml:mi>
                  <mml:mi>g</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mi>f</mml:mi>
                  <mml:msup>
                    <mml:mo>|</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>*</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>If the user opts to use a multitaper method (<xref rid="B35" ref-type="bibr">Thomson, 1982</xref>) to calculate the power spectrum, they can choose the number of tapers to apply. The power spectrum is then calculated using the MATLAB <italic>pmtm</italic> function.</p>
      </sec>
      <sec>
        <title>Inter-Trial Phase Coherence</title>
        <p>Inter-trial phase coherence (ITPC), a measure of the extent to which an EEG signal is phase-locked to repeated time-locked events (<xref rid="B25" ref-type="bibr">Makeig et al., 2004</xref>), can be calculated across segments as well. This calculation uses the EEGLAB <italic>newtimef.m</italic> function. For each event condition and each channel, phase coherence is calculated across all segments, across relevant spectral time windows (determined by user-defined subwindow length) and frequency bins. Outputs of this module are complex numbers, which include information about ITPC magnitude (absolute value of the complex number) and phase (angle of the complex number).</p>
      </sec>
    </sec>
    <sec>
      <title>Summary Outputs</title>
      <p>After each run of one or more files across one or more modules, BEAPP creates a folder called “out,” which contains detailed information summarizing the run. This includes a MATLAB structure specifying the user inputs and run settings that were common to all files included in a given run; of note, maintaining this information in its own file, rather than repeated within each individual EEG file, helps with management of data size (see below). There is also a file detailing the text output from the command window. Summary information is included in this folder for certain modules as well. For example, a .csv file contains summary information about files run through PREP, including whether any errors occurred and how many bad channels PREP detected. A separate .csv file contains summary information generated through HAPPE.</p>
      <p>The output folder also includes summary information about analyses conducted. For analyses in the frequency domain, data can be binned into any number of frequency bands defined by the user. For power analyses, optional outputs in .csv format include mean power across all segments in each channel at each frequency band, as well as absolute power, normalized power, natural log of power, and log10 of power. For ITPC analyses, .csv outputs can include the maximum and/or mean ITPC magnitude for each channel. Analysis-generated .csv outputs also include general information relevant to interpretation of these outputs, such as the original EEG’s net type (EEG electrode layout), original sampling rate, current sampling rate (for resampled data), information about recording periods run (for original EEGs that included multiple recording periods), information about channels marked bad, and number of data segments analyzed.</p>
    </sec>
    <sec>
      <title>Management of Data Size</title>
      <p>When running large EEG datasets and saving outputs at multiple processing modules, the amount of data being generated may rapidly become a burden. BEAPP addresses this concern in several ways. First, users are given the option of whether to save output of each module. If a user does not intend to review outputs of a specific module, or if outputs of a given module can be rapidly reproduced if needed in the future, users may choose to have BEAPP automatically delete these outputs. Outputs aim to strike a balance between maintaining adequate information to allow a user to easily keep track of how raw data have been altered and avoid unnecessary redundancy that may lead to excessively large file sizes.</p>
    </sec>
    <sec>
      <title>Sample Data Files</title>
      <p>The specific examples in this manuscript come from application of BEAPP to EEG data collected through the Infant Sibling Project (ISP), a prospective investigation examining infants at high versus low familial risk for autism spectrum disorder over the first 3 years of life. This dataset was chosen because the longitudinal nature of the study led to data collection with different sampling rates (250 and 500 Hz) and acquisition setups (64-channel Geodesic Sensor Net v2.0, and 128-channel HydroCel Geodesic Sensor Net, both from Electrical Geodesics, Inc., Eugene, OR, United States). Additionally, because young children cannot follow instructions to “rest” or remain still, EEG in these children typically contains greater amounts of artifact than EEG in typical adults. Baseline EEG data was collected while a young child sat in a parent’s lap watching a research assistant blow bubbles or show toys (<xref rid="B22" ref-type="bibr">Levin et al., 2017b</xref>). Event-related EEG data was collected using an auditory double oddball paradigm, in which a stream of consonant-vowel stimuli was presented. Stimuli included a “Standard” /aaada/ sound 80% of the time, “Native” /ta/ sound 10% of the time, and “Non-Native” /da/ sound 10% of the time (<xref rid="B32" ref-type="bibr">Seery et al., 2014</xref>). To demonstrate applications of BEAPP to analysis of group data, a subset of the full ISP dataset, containing 10 baseline EEGs and 10 event-related EEGs, is available at <ext-link ext-link-type="uri" xlink:href="http://zenodo.org">zenodo.org</ext-link> (<xref rid="B21" ref-type="bibr">Levin et al., 2017a</xref>) Details regarding the baseline EEGs are provided in <bold>Table <xref rid="T1" ref-type="table">1</xref></bold>, and details regarding the event-related EEGs are provided in <bold>Table <xref rid="T2" ref-type="table">2</xref></bold>. Data were collected in the United States, with 60 Hz line noise. This study was carried out in accordance with the recommendations of the Institutional Review Board at Boston University and Boston Children’s Hospital, with written informed consent from all caregivers prior to their child’s participation in the study.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Baseline EEG information.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">File name</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Sampling</th>
              <th valign="top" align="left" rowspan="1" colspan="1">Net type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">rate</th>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG01.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG02.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“Geodesic Sensor Net 64 2.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG03.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“Geodesic Sensor Net 64 2.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG04.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG05.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG06.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG07.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG08.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">500</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG09.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">500</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“baselineEEG10.mat”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">500</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Event-tagged EEG information.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">File name</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Sampling</th>
              <th valign="top" align="left" rowspan="1" colspan="1">Net type</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Offset</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">rate</th>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG01.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG02.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“Geodesic Sensor Net 64 2.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG03.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“Geodesic Sensor Net 64 2.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG04.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG05.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG06.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG07.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">250</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG08.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">500</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">18</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG09.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">500</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">18</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">“auditoryEEG10.mff”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">500</td>
              <td valign="top" align="left" rowspan="1" colspan="1">“HydroCel GSN 128 1.0”</td>
              <td valign="top" align="center" rowspan="1" colspan="1">18</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>Data were run on a standard iMac (late 2015, 4 GHz Intel Core i7 processor, macOS X El Capitan version 10.11.6). BEAPP was initially created and tested in MATLAB 2016a, although data here were run using MATLAB 2017b.</p>
    <sec>
      <title>Testing BEAPP on a Sample Dataset: Baseline DATA, Power Spectrum</title>
      <p>We ran BEAPP on a sample dataset of 10 baseline EEGs, as described above. Data ran through BEAPP for a variety of module combinations. A <bold>Supplementary File <xref ref-type="supplementary-material" rid="SM1">1</xref></bold> describing the exact settings for each of these analyses is included with this manuscript. Of note, the formatting and PREP modules were only run once each; the order of runs described above and in the table allowed subsequent runs to take advantage of these modules from prior runs.</p>
      <p>Power spectra generated with each of these configurations are shown in <bold>Figure <xref ref-type="fig" rid="F3">3</xref></bold>. Power from the “Raw” data (after segmentation into 1 s segments without artifact rejection) is shown in black. After the PREP pipeline, which involves <italic>cleanline</italic> and robust average referencing, 60 Hz line noise is reduced (though not fully eliminated), and power is reduced across frequencies (red). After the “Filt” run (green), there is a reduction in power below 4 Hz with some extension into higher frequencies, due to the 4 Hz high pass filter. There is a reduction in power above 80 Hz, due to the 80 Hz low pass filter. There is a reduction in power at and near 60 Hz, due to the 60 Hz notch filter. After the HAPPE run (dark blue), there is a significant reduction in power across all frequencies as is expected with HAPPE preprocessing (<xref rid="B9" ref-type="bibr">Gabard-Durnam et al., 2018</xref>), reduction in 60 Hz line noise power (since HAPPE includes <italic>cleanline</italic>), and some reduction in power just above 1 Hz and just below 100 Hz, due to high and low pass filters respectively occurring at these frequencies. With CSD rereferencing (pink) after the PREP pipeline and 1–100 Hz filtering, the power spectrum takes on the shape expected from these preprocessing steps, but with increased power across frequencies overall. (Of note, power units for CSD are μV<sup>2</sup>/mm<sup>2</sup>, whereas power units are otherwise in μV<sup>2</sup>). MskArt (light blue) and RejPostSeg (purple), with artifact thresholding taking place before and after segmentation respectively, give relatively similar results to one another; REST (orange) also gives similar results.</p>
      <fig id="F3" position="float">
        <label>FIGURE 3</label>
        <caption>
          <p>Power spectra generated by various preprocessing pipelines. Power spectra for each continuous EEG are shown on a log10-log10 scale. Power units are in μV<sup>2</sup>, except CSD (pink) which is in μV<sup>2</sup>/mm<sup>2</sup>. Each line shows the mean power spectrum generated across all channels. After specified processing, data were segmented into 1 s windows. No additional artifact rejection occurred prior to power analysis, unless otherwise specified. Black: Raw data. Red: PREP pipeline. Green: “Filt.” (Filtering 4 Hz high pass, 80 Hz low pass, 60 Hz notch). Dark blue: HAPPE pipeline (Filtering 1–100 Hz, resampling to 250 Hz, HAPPE pipeline with associated segment rejection). Pink: CSD (PREP pipeline, filtering 1–100 Hz, CSD rereferencing, mean detrending, artifact thresholding at 3,000 μV<sup>2</sup>/mm<sup>2</sup> prior to segmentation). Orange: REST (PREP pipeline, filtering 1–100 Hz, REST rereferencing, mean detrending, artifact thresholding at 100 μV<sup>2</sup> prior to segmentation). Light blue: MskArt (PREP pipeline, filtering 1–100 Hz, resampling to 250 Hz, mean detrending, artifact thresholding at 100 μV<sup>2</sup> prior to segmentation). Purple: Same settings as MskArt, but with artifact thresholding after segmentation.</p>
        </caption>
        <graphic xlink:href="fnins-12-00513-g003"/>
      </fig>
      <p>While the exact amount of time each step requires will depend on multiple factors (e.g., file size, computer specifications, etc.), approximate benchmarks for the computer described above are provided here for transparency. On average for each file, modules took the following amounts of time: Format &lt;10 s, PREP 1.5 min, filter &lt;10 s, resample &lt;10 s, HAPPE 3.5 min, CSD 30 s, REST &lt;10 s, detrend &lt;10 s, segment &lt;10 s, PSD &lt;10 s.</p>
    </sec>
    <sec>
      <title>Testing BEAPP on a Sample Dataset: Event-Tagged Data, ITPC</title>
      <p>We next ran BEAPP on the sample dataset of 10 event-tagged EEGs. Processing steps after formatting included the PREP pipeline, filtering 1–100 Hz, resampling to 250 Hz, CSD rereferencing, mean detrending, segmenting from -100 to 800 ms in relationship to the event tag for each “Standard” stimulus (taking into account system offsets, which had not been accounted for in the original event tags), and evaluation ITPC across multiple overlapping windows of 256 ms each, and across multiple frequency bands. On average, the ITPC module took 30 s per file. <bold>Figure <xref ref-type="fig" rid="F4">4</xref></bold> plots the outcome of this analysis for the frontocentral channel demonstrating maximum ITPC in each EEG. There is a peak in ITPC in the 150–300 ms time windows, across multiple frequencies, for most of the sample EEGs. Of note, this finding overlaps exactly with the time windows in which one expects a positive-going P150 component in event-related potential (ERP) analyses of young children (<xref rid="B32" ref-type="bibr">Seery et al., 2014</xref>).</p>
      <fig id="F4" position="float">
        <label>FIGURE 4</label>
        <caption>
          <p>Inter-trial phase coherence for event-tagged data. ITPC for each event-tagged EEG is shown on a surface plot. Color demonstrates magnitude of ITPC at each time window, for each frequency band. ITPC for the frontocentral channel demonstrating maximum ITPC (across all time windows centered 100–300 ms after stimulus onset, and across all frequency bands) is plotted for each EEG; thus each plot contains data from only one channel.</p>
        </caption>
        <graphic xlink:href="fnins-12-00513-g004"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>BEAPP automates batch EEG processing and analyses across multiple EEGs (including those collected across multiple acquisition setups) and multiple processing steps. Rather than prescribing a specified set of processing steps, BEAPP allows users to choose from a menu of options that meet their needs.</p>
    <p>BEAPP has two primary goals. The first is accessibility. BEAPP aims to provide a bridge, allowing researchers studying the brain to more easily access some of the most useful tools that experienced signal processors have created, by replicating others’ analysis pipelines or creating their own. To this end, BEAPP aims to strike a balance between assuming only a basic level of MATLAB and EEG signal processing experience, while also offering a flexible menu of opportunities for more advanced users.</p>
    <p>The second primary goal is reproducibility. By allowing improved accessibility of methods and workflows across execution environments, BEAPP aims to improve reproducibility within experiments, replicability across experiments, and collaboration across laboratories.</p>
    <p>Several limitations of BEAPP merit discussion. First, while BEAPP provides flexibility for running a variety of modules with a variety of user-specified parameters, BEAPP does not prevent an inexperienced user from running incorrect sequences of analyses, or setting meaningless parameters. For example, a user running the PREP or HAPPE pipelines within BEAPP will need to have adequate knowledge of these pipelines (either through reading their companion manuscripts, or through the BEAPP user guide) to know that these pipelines include <italic>cleanline</italic> and average referencing; therefore, such steps do not need to be run separately in other modules. As another example, running ITPC on baseline data would produce outputs, but the meaning of such results (since data segments would not be tied to any particular stimulus) would be questionable. In many cases, tips to avoid such errors are included in the user guide, or within the user inputs themselves. BEAPP also contains flags to help avoid certain errors (such as unintentionally overwriting previously generated data when running modules with a new set of parameters). However, as is often the case with customizable software, such errors are not fully avoidable.</p>
    <p>BEAPP is currently also limited in the scope of processing techniques that it offers. The processing algorithms contained in other software packages are numerous and tremendously useful, and BEAPP incorporates only a small subset of the tools available. In its current form, BEAPP therefore acts predominantly as a basic structure for EEG data analysis and tracking, upon which other parameters, modules, and options can be added in the future. Future additions to BEAPP would likely include additional options for managing a wider variety of native file types, compatibility with the Brain Imaging Data Structure (BIDS) (<xref rid="B10" ref-type="bibr">Gorgolewski et al., 2016</xref>), improved efficiency through parallel processing, additional analysis options (e.g., coherence, phase lag index, and phase amplitude coupling), and display options (e.g., topoplots). Rather than a fixed pipeline, BEAPP is intended to offer a framework that a beginning user can use for batch EEG data processing, and upon which a more advanced user can build in additional options for preprocessing and analysis.</p>
    <p>Overall, BEAPP aims to provide a structure to streamline batch processing of EEG across multiple preprocessing and analysis steps, and across multiple EEGs in a dataset (including EEGs with differing acquisition setups). Long term goals of this structure include improved accessibility to EEG analysis across fields, and improved reproducibility thereof.</p>
  </sec>
  <sec>
    <title>Author’s Note</title>
    <p>BEAPP is copyright 2015, 2016, 2017, 2018. This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License (version 3) as published by the Free Software Foundation.</p>
  </sec>
  <sec>
    <title>Author Contributions</title>
    <p>AL conceived of BEAPP and drafted the manuscript. AL, AML, LG-D, and HO’L contributed and tested the code. HO’L focused predominantly on signal processing aspects of code, AML focused on code development, and LG-D focused on integration of the HAPPE pipeline into BEAPP (see associated manuscript). AL, AML, LG-D, and HO’L contributed to design of BEAPP, analysis and interpretation of data for BEAPP, critically revising the manuscript for important intellectual content, and approving the final version for submission.</p>
  </sec>
  <sec>
    <title>Conflict of Interest Statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was supported by several grants from the Autism Science Foundation (to AL, AML, and LG-D), as well as the American Brain Foundation (to AL), Nancy Lurie Marks Family Foundation (to AL), a NARSAD Young Investigator Grant from the Brain and Behavior Research Foundation (to AL), William Randolph Hearst Fund (to AL), Translational Neuroscience Center at Boston Children’s Hospital (to AL), the Rett Syndrome Research Foundation (to LG-D), and the National Institutes of Health (R01-DC010290, to Helen Tager-Flusberg and Charles Alexander Nelson, for the Infant Sibling Project). The funding bodies did not have any role in the design, collection, analyses, interpretation of data or in writing the manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <p>The authors wish to acknowledge Dr. Charles A. Nelson and Dr. Helen Tager-Flusberg for providing the EEG dataset on which BEAPP was initially tested, Dr. Demba Ba for providing code for the Kalman filter included as an option in BEAPP, Dr. Carol Wilkinson for extensive testing and feedback regarding BEAPP, Dr. Peter Davis for feedback regarding this manuscript, and the Autism Biomarkers Consortium for Clinical Trials for enhancing the thought processes and design decisions relevant to BEAPP.</p>
  </ack>
  <sec sec-type="supplementary material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fnins.2018.00513/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fnins.2018.00513/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Data_Sheet_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM2">
      <media xlink:href="Presentation_1.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bigdely-Shamlo</surname><given-names>N.</given-names></name><name><surname>Mullen</surname><given-names>T.</given-names></name><name><surname>Kothe</surname><given-names>C.</given-names></name><name><surname>Su</surname><given-names>K.-M.</given-names></name><name><surname>Robbins</surname><given-names>K. A.</given-names></name></person-group> (<year>2015</year>). <article-title>The PREP pipeline: standardized preprocessing for large-scale EEG analysis.</article-title>
<source><italic>Front. Neuroinform.</italic></source>
<volume>9</volume>:<issue>16</issue>. <pub-id pub-id-type="doi">10.3389/fninf.2015.00016</pub-id><?supplied-pmid 26150785?><pub-id pub-id-type="pmid">26150785</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chella</surname><given-names>F.</given-names></name><name><surname>D’Andrea</surname><given-names>A.</given-names></name><name><surname>Basti</surname><given-names>A.</given-names></name><name><surname>Pizzella</surname><given-names>V.</given-names></name><name><surname>Marzetti</surname><given-names>L.</given-names></name></person-group> (<year>2017</year>). <article-title>Non-linear analysis of scalp EEG by using bispectra: the effect of the reference choice.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>11</volume>:<issue>262</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2017.00262</pub-id><?supplied-pmid 28559790?><pub-id pub-id-type="pmid">28559790</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delorme</surname><given-names>A.</given-names></name><name><surname>Makeig</surname><given-names>S.</given-names></name></person-group> (<year>2004</year>). <article-title>EEGLAB: an open source toolbox for analysis of single-trial EEG dynamics including independent component analysis.</article-title>
<source><italic>J. Neurosci. Methods</italic></source>
<volume>134</volume>
<fpage>9</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1016/j.jneumeth.2003.10.009</pub-id><?supplied-pmid 15102499?><pub-id pub-id-type="pmid">15102499</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delorme</surname><given-names>A.</given-names></name><name><surname>Palmer</surname><given-names>J.</given-names></name><name><surname>Oostenveld</surname><given-names>R.</given-names></name><name><surname>Onton</surname><given-names>J.</given-names></name><name><surname>Makeig</surname><given-names>S.</given-names></name></person-group> (<year>2007</year>). <source><italic>Comparing</italic></source>
<italic>Results of Algorithms Implementing Blind Source Separation of EEG Data</italic> Available at: <ext-link ext-link-type="uri" xlink:href="https://sccn.ucsd.edu/tildearno/mypapers/delorme_unpub.pdf">https://sccn.ucsd.edu/tildearno/mypapers/delorme_unpub.pdf</ext-link> [Accessed September <volume>24</volume>
<issue>2017</issue>].</mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>F.</given-names></name><name><surname>Liu</surname><given-names>Q.</given-names></name><name><surname>Wen</surname><given-names>X.</given-names></name><name><surname>Lai</surname><given-names>Y.</given-names></name><name><surname>Xu</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>MATLAB toolboxes for reference electrode standardization technique (REST) of scalp EEG.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>11</volume>:<issue>601</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2017.00601</pub-id><?supplied-pmid 29163006?><pub-id pub-id-type="pmid">29163006</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzgibbon</surname><given-names>S. P.</given-names></name><name><surname>Lewis</surname><given-names>T. W.</given-names></name><name><surname>Powers</surname><given-names>D. M. W.</given-names></name><name><surname>Whitham</surname><given-names>E. W.</given-names></name><name><surname>Willoughby</surname><given-names>J. O.</given-names></name><name><surname>Pope</surname><given-names>K. J.</given-names></name></person-group> (<year>2013</year>). <article-title>Surface laplacian of central scalp electrical signals is insensitive to muscle contamination.</article-title>
<source><italic>IEEE Trans. Biomed. Eng.</italic></source>
<volume>60</volume>
<fpage>4</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1109/TBME.2012.2195662</pub-id><?supplied-pmid 22542648?><pub-id pub-id-type="pmid">22542648</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><collab>Free Software Foundation</collab> (<year>2007</year>). <source><italic>GNU General Public License.</italic></source> Available at: <ext-link ext-link-type="uri" xlink:href="http://www.gnu.org/licenses/gpl.html">http://www.gnu.org/licenses/gpl.html</ext-link></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Frigo</surname><given-names>M.</given-names></name><name><surname>Johnson</surname><given-names>S. G.</given-names></name></person-group> (<year>1998</year>). <article-title>“FFTW: an adaptive software architecture for the FFT,”</article-title> in <conf-name>Proceedings of the 1998 IEEE International Conference on Acoustics, Speech and Signal Processing, ICASSP ’98</conf-name>, (<publisher-loc>Seattle, WA</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>1381</fpage>–<lpage>1384</lpage>. <pub-id pub-id-type="doi">10.1109/ICASSP.1998.681704</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabard-Durnam</surname><given-names>L. J.</given-names></name><name><surname>Mendez Leal</surname><given-names>A. S.</given-names></name><name><surname>Wilkinson</surname><given-names>C. L.</given-names></name><name><surname>Levin</surname><given-names>A. R.</given-names></name></person-group> (<year>2018</year>). <article-title>The Harvard Automated Processing Pipeline for Electroencephalography (HAPPE): standardized processing software for developmental and high-artifact data.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>12</volume>:<issue>97</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2018.00097</pub-id><?supplied-pmid 29535597?><pub-id pub-id-type="pmid">29535597</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorgolewski</surname><given-names>K. J.</given-names></name><name><surname>Auer</surname><given-names>T.</given-names></name><name><surname>Calhoun</surname><given-names>V. D.</given-names></name><name><surname>Craddock</surname><given-names>R. C.</given-names></name><name><surname>Das</surname><given-names>S.</given-names></name><name><surname>Duff</surname><given-names>E. P.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>The brain imaging data structure, a format for organizing and describing outputs of neuroimaging experiments.</article-title>
<source><italic>Sci. Data</italic></source>
<volume>3</volume>:<issue>160044</issue>. <pub-id pub-id-type="doi">10.1038/sdata.2016.44</pub-id><?supplied-pmid 27326542?><pub-id pub-id-type="pmid">27326542</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gramfort</surname><given-names>A.</given-names></name></person-group> (<year>2013</year>). <article-title>MEG and EEG data analysis with MNE-Python.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>7</volume>:<issue>267</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2013.00267</pub-id><?supplied-pmid 24431986?><pub-id pub-id-type="pmid">24431986</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gramfort</surname><given-names>A.</given-names></name><name><surname>Luessi</surname><given-names>M.</given-names></name><name><surname>Larson</surname><given-names>E.</given-names></name><name><surname>Engemann</surname><given-names>D. A.</given-names></name><name><surname>Strohmeier</surname><given-names>D.</given-names></name><name><surname>Brodbeck</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>MNE software for processing MEG and EEG data.</article-title>
<source><italic>Neuroimage</italic></source>
<volume>86</volume>
<fpage>446</fpage>–<lpage>460</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.027</pub-id><?supplied-pmid 24161808?><pub-id pub-id-type="pmid">24161808</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y.</given-names></name><name><surname>Zhang</surname><given-names>J.</given-names></name><name><surname>Cui</surname><given-names>Y.</given-names></name><name><surname>Yang</surname><given-names>G.</given-names></name><name><surname>Liu</surname><given-names>Q.</given-names></name><name><surname>He</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>How different EEG references influence sensor level functional connectivity graphs.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>11</volume>:<issue>368</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2017.00368</pub-id><?supplied-pmid 28725175?><pub-id pub-id-type="pmid">28725175</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>In</surname><given-names>M. H.</given-names></name><name><surname>Lee</surname><given-names>S. Y.</given-names></name><name><surname>Park</surname><given-names>T. S.</given-names></name><name><surname>Kim</surname><given-names>T. S.</given-names></name><name><surname>Cho</surname><given-names>M. H.</given-names></name><name><surname>Ahn</surname><given-names>Y. B.</given-names></name></person-group> (<year>2006</year>). <article-title>Ballistocardiogram artifact removal from EEG signals using adaptive filtering of EOG signals.</article-title>
<source><italic>Physiol. Meas.</italic></source>
<volume>27</volume>
<fpage>1227</fpage>–<lpage>1240</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/27/11/014</pub-id><?supplied-pmid 17028414?><pub-id pub-id-type="pmid">17028414</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalman</surname><given-names>R. E.</given-names></name></person-group> (<year>1960</year>). <article-title>A new approach to linear filtering and prediction problems.</article-title>
<source><italic>Trans. ASME J. Basic Eng.</italic></source>
<volume>82</volume>
<fpage>35</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1115/1.3662552</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kayser</surname><given-names>J.</given-names></name><name><surname>Tenke</surname><given-names>C. E.</given-names></name></person-group> (<year>2006a</year>). <article-title>Principal components analysis of laplacian waveforms as a generic method for identifying ERP generator patterns: I. Evaluation with auditory oddball tasks.</article-title>
<source><italic>Clin. Neurophysiol.</italic></source>
<volume>117</volume>
<fpage>348</fpage>–<lpage>368</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2005.08.034</pub-id><?supplied-pmid 16356767?><pub-id pub-id-type="pmid">16356767</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kayser</surname><given-names>J.</given-names></name><name><surname>Tenke</surname><given-names>C. E.</given-names></name></person-group> (<year>2006b</year>). <article-title>Principal components analysis of laplacian waveforms as a generic method for identifying ERP generator patterns: II. Adequacy of low-density estimates.</article-title>
<source><italic>Clin. Neurophysiol.</italic></source>
<volume>117</volume>
<fpage>369</fpage>–<lpage>380</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2005.08.033</pub-id><?supplied-pmid 16356768?><pub-id pub-id-type="pmid">16356768</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kayser</surname><given-names>J.</given-names></name><name><surname>Tenke</surname><given-names>C. E.</given-names></name></person-group> (<year>2015</year>). <article-title>Issues and considerations for using the scalp surface laplacian in EEG/ERP research: a tutorial review.</article-title>
<source><italic>Int. J. Psychophysiol.</italic></source>
<volume>97</volume>
<fpage>189</fpage>–<lpage>209</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijpsycho.2015.04.012</pub-id><?supplied-pmid 25920962?><pub-id pub-id-type="pmid">25920962</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>T. W.</given-names></name><name><surname>Girolami</surname><given-names>M.</given-names></name><name><surname>Sejnowski</surname><given-names>T. J.</given-names></name></person-group> (<year>1999</year>). <article-title>Independent component analysis using an extended infomax algorithm for mixed subgaussian and supergaussian sources.</article-title>
<source><italic>Neural Comput.</italic></source>
<volume>11</volume>
<fpage>417</fpage>–<lpage>441</lpage>. <pub-id pub-id-type="doi">10.1162/089976699300016719</pub-id><?supplied-pmid 9950738?><pub-id pub-id-type="pmid">9950738</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lei</surname><given-names>X.</given-names></name><name><surname>Liao</surname><given-names>K.</given-names></name></person-group> (<year>2017</year>). <article-title>Understanding the influences of EEG reference: a large-scale brain network perspective.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>11</volume>:<issue>205</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2017.00205</pub-id><?supplied-pmid 28450827?><pub-id pub-id-type="pmid">28450827</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levin</surname><given-names>A. R.</given-names></name><name><surname>Gabard-Durnam</surname><given-names>L. J.</given-names></name><name><surname>Mendez Leal</surname><given-names>A. S.</given-names></name><name><surname>O’Leary</surname><given-names>H. M.</given-names></name><name><surname>Wilkinson</surname><given-names>C. L.</given-names></name><name><surname>Tager-Flusberg</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2017a</year>). <source><italic>Infant Sibling Project: Sample Files.</italic></source>
<pub-id pub-id-type="doi">10.5281/zenodo.998964</pub-id> Available at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/998965#.WdBg2BNSxBw">https://zenodo.org/record/998965#.WdBg2BNSxBw</ext-link></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levin</surname><given-names>A. R.</given-names></name><name><surname>Varcin</surname><given-names>K. J.</given-names></name><name><surname>O’Leary</surname><given-names>H. M.</given-names></name><name><surname>Tager-Flusberg</surname><given-names>H.</given-names></name><name><surname>Nelson</surname><given-names>C. A.</given-names></name></person-group> (<year>2017b</year>). <article-title>EEG power at 3 months in infants at high familial risk for autism.</article-title>
<source><italic>J. Neurodev. Disord.</italic></source>
<volume>9</volume>:<issue>34</issue>. <pub-id pub-id-type="doi">10.1186/s11689-017-9214-9</pub-id><?supplied-pmid 28903722?><pub-id pub-id-type="pmid">28903722</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>T.</given-names></name><name><surname>Hu</surname><given-names>Z.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Ye</surname><given-names>C.</given-names></name><name><surname>Liu</surname><given-names>Q.</given-names></name></person-group> (<year>2017</year>). <article-title>Electrophysiological correlates of change detection during delayed matching task: a comparison of different references.</article-title>
<source><italic>Front. Neurosci.</italic></source>
<volume>11</volume>:<issue>527</issue>. <pub-id pub-id-type="doi">10.3389/fnins.2017.00527</pub-id><?supplied-pmid 29018318?><pub-id pub-id-type="pmid">29018318</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litvak</surname><given-names>V.</given-names></name><name><surname>Mattout</surname><given-names>J.</given-names></name><name><surname>Kiebel</surname><given-names>S.</given-names></name><name><surname>Phillips</surname><given-names>C.</given-names></name><name><surname>Henson</surname><given-names>R.</given-names></name><name><surname>Kilner</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>EEG and MEG Data Analysis in SPM8.</article-title>
<source><italic>Comput. Intell. Neurosci.</italic></source>
<volume>2011</volume>:<issue>852961</issue>. <pub-id pub-id-type="doi">10.1155/2011/852961</pub-id><?supplied-pmid 21437221?><pub-id pub-id-type="pmid">21437221</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Makeig</surname><given-names>S.</given-names></name><name><surname>Debener</surname><given-names>S.</given-names></name><name><surname>Onton</surname><given-names>J.</given-names></name><name><surname>Delorme</surname><given-names>A.</given-names></name></person-group> (<year>2004</year>). <article-title>Mining event-related brain dynamics.</article-title>
<source><italic>Trends Cogn. Sci.</italic></source>
<volume>8</volume>
<fpage>204</fpage>–<lpage>210</lpage>. <pub-id pub-id-type="doi">10.1016/j.tics.2004.03.008</pub-id><?supplied-pmid 15120678?><pub-id pub-id-type="pmid">15120678</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Makeig</surname><given-names>S.</given-names></name><name><surname>Onton</surname><given-names>J.</given-names></name></person-group> (<year>2011</year>). <article-title>“ERP features and EEG dynamics: an ICA perspective,”</article-title> in <source><italic>Oxfort Handbook of Event-Related Potential Components</italic>.</source>
<publisher-loc>New York, NY</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>
<pub-id pub-id-type="doi">10.1093/oxfordhb/9780195374148.013.0035</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morbidi</surname><given-names>F.</given-names></name><name><surname>Garulli</surname><given-names>A.</given-names></name><name><surname>Prattichizzo</surname><given-names>D.</given-names></name><name><surname>Rizzo</surname><given-names>C.</given-names></name><name><surname>Rossi</surname><given-names>S.</given-names></name></person-group> (<year>2008</year>). <article-title>Application of kalman filter to remove TMS-induced artifacts from EEG recordings.</article-title>
<source><italic>IEEE Trans. Control Syst. Technol.</italic></source>
<volume>16</volume>
<fpage>1360</fpage>–<lpage>1366</lpage>. <pub-id pub-id-type="doi">10.1109/TCST.2008.921814</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mullen</surname><given-names>T.</given-names></name></person-group> (<year>2012</year>). <source><italic>NITRC: Cleanline.</italic></source>
<publisher-loc>San Diego, CA</publisher-loc>: <publisher-name>Tool/Resource Info</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oostenveld</surname><given-names>R.</given-names></name><name><surname>Fries</surname><given-names>P.</given-names></name><name><surname>Maris</surname><given-names>E.</given-names></name><name><surname>Schoffelen</surname><given-names>J.-M.</given-names></name></person-group> (<year>2011</year>). <article-title>FieldTrip: open source software for advanced analysis of MEG, EEG, and invasive electrophysiological data.</article-title>
<source><italic>Comput. Intell. Neurosci.</italic></source>
<volume>2011</volume>:<issue>156869</issue>. <pub-id pub-id-type="doi">10.1155/2011/156869</pub-id><?supplied-pmid 21253357?><pub-id pub-id-type="pmid">21253357</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>R. D.</given-names></name></person-group> (<year>2011</year>). <article-title>Reproducible research in computational science.</article-title>
<source><italic>Science</italic></source>
<volume>334</volume>
<fpage>1226</fpage>–<lpage>1227</lpage>. <pub-id pub-id-type="doi">10.1126/science.1213847</pub-id><?supplied-pmid 22144613?><pub-id pub-id-type="pmid">22144613</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Särelä</surname><given-names>J.</given-names></name><name><surname>Vigário</surname><given-names>R.</given-names></name></person-group> (<year>2003</year>). <article-title>Overlearning in marginal distribution-based ICA: analysis and solutions.</article-title>
<source><italic>J. Mach. Learn. Res.</italic></source>
<volume>4</volume>
<fpage>1447</fpage>–<lpage>1469</lpage>.</mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seery</surname><given-names>A.</given-names></name><name><surname>Tager-Flusberg</surname><given-names>H.</given-names></name><name><surname>Nelson</surname><given-names>C. A.</given-names></name></person-group> (<year>2014</year>). <article-title>Event-related potentials to repeated speech in 9-month-old infants at risk for autism spectrum disorder.</article-title>
<source><italic>J. Neurodev. Disord.</italic></source>
<volume>6</volume>:<issue>43</issue>. <pub-id pub-id-type="doi">10.1186/1866-1955-6-43</pub-id><?supplied-pmid 25937843?><pub-id pub-id-type="pmid">25937843</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tadel</surname><given-names>F.</given-names></name><name><surname>Baillet</surname><given-names>S.</given-names></name><name><surname>Mosher</surname><given-names>J. C.</given-names></name><name><surname>Pantazis</surname><given-names>D.</given-names></name><name><surname>Leahy</surname><given-names>R. M.</given-names></name></person-group> (<year>2011</year>). <article-title>Brainstorm: a user-friendly application for MEG/EEG analysis.</article-title>
<source><italic>Comput. Intell. Neurosci.</italic></source>
<volume>2011</volume>:<issue>879716</issue>. <pub-id pub-id-type="doi">10.1155/2011/879716</pub-id><?supplied-pmid 21584256?><pub-id pub-id-type="pmid">21584256</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tannous</surname><given-names>B. A.</given-names></name><name><surname>Teng</surname><given-names>J.</given-names></name></person-group> (<year>2011</year>). <article-title>Secreted blood reporters: insights and applications.</article-title>
<source><italic>Biotechnol. Adv.</italic></source>
<volume>29</volume>
<fpage>997</fpage>–<lpage>1003</lpage>. <pub-id pub-id-type="doi">10.1016/j.biotechadv.2011.08.021</pub-id><?supplied-pmid 21920429?><pub-id pub-id-type="pmid">21920429</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname><given-names>D. J.</given-names></name></person-group> (<year>1982</year>). <article-title>Spectrum estimation and harmonic analysis.</article-title>
<source><italic>Proc. IEEE</italic></source>
<volume>70</volume>
<fpage>1055</fpage>–<lpage>1096</lpage>. <pub-id pub-id-type="doi">10.1109/PROC.1982.12433</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tzallas</surname><given-names>A. T.</given-names></name><name><surname>Oikonomou</surname><given-names>V. P.</given-names></name><name><surname>Fotiadis</surname><given-names>D. I.</given-names></name></person-group> (<year>2006</year>). <article-title>“Epileptic spike detection using a kalman filter based approach,”</article-title> in <conf-name>Proceedings of the 28th IEEE EMBS Annual International Conference</conf-name>, (<publisher-loc>New York, NY</publisher-loc>), <fpage>501</fpage>–<lpage>504</lpage>. <pub-id pub-id-type="doi">10.1109/IEMBS.2006.260780</pub-id><?supplied-pmid 17945981?></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winkler</surname><given-names>I.</given-names></name><name><surname>Brandl</surname><given-names>S.</given-names></name><name><surname>Horn</surname><given-names>F.</given-names></name><name><surname>Waldburger</surname><given-names>E.</given-names></name><name><surname>Allefeld</surname><given-names>C.</given-names></name><name><surname>Tangermann</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>). <article-title>Robust artifactual independent component classification for BCI practitioners.</article-title>
<source><italic>J. Neural Eng.</italic></source>
<volume>11</volume>:<issue>035013</issue>. <pub-id pub-id-type="doi">10.1088/1741-2560/11/3/035013</pub-id><?supplied-pmid 24836294?><pub-id pub-id-type="pmid">24836294</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winkler</surname><given-names>I.</given-names></name><name><surname>Haufe</surname><given-names>S.</given-names></name><name><surname>Tangermann</surname><given-names>M.</given-names></name></person-group> (<year>2011</year>). <article-title>Automatic classification of artifactual ICA-components for artifact removal in EEG signals.</article-title>
<source><italic>Behav. Brain Funct.</italic></source>
<volume>7</volume>:<issue>30</issue>. <pub-id pub-id-type="doi">10.1186/1744-9081-7-30</pub-id><?supplied-pmid 21810266?><pub-id pub-id-type="pmid">21810266</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>D.</given-names></name></person-group> (<year>2001</year>). <article-title>A method to standardize a reference of scalp EEG recordings to a point at infinity.</article-title>
<source><italic>Physiol. Meas.</italic></source>
<volume>22</volume>
<fpage>693</fpage>–<lpage>711</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/22/4/305</pub-id><?supplied-pmid 11761077?><pub-id pub-id-type="pmid">11761077</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>D.</given-names></name><name><surname>Wang</surname><given-names>L.</given-names></name><name><surname>Oostenveld</surname><given-names>R.</given-names></name><name><surname>Nielsen</surname><given-names>K. D.</given-names></name><name><surname>Arendt-Nielsen</surname><given-names>L.</given-names></name><name><surname>Chen</surname><given-names>A. C. N.</given-names></name></person-group> (<year>2005</year>). <article-title>A comparative study of different references for EEG spectral mapping: the issue of the neutral reference and the use of the infinity reference.</article-title>
<source><italic>Physiol. Meas.</italic></source>
<volume>26</volume>
<fpage>173</fpage>–<lpage>184</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/26/3/003</pub-id><?supplied-pmid 15798293?><pub-id pub-id-type="pmid">15798293</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
