<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10017094</article-id>
    <article-id pub-id-type="pmid">36897014</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad100</article-id>
    <article-id pub-id-type="publisher-id">btad100</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>StonPy: a tool to parse and query collections of SBGN maps in a graph database</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2118-035X</contrib-id>
        <name>
          <surname>Rougny</surname>
          <given-names>Adrien</given-names>
        </name>
        <aff><institution>Biotechnology Research Institute for Drug Discovery, National Institute of Advanced Industrial Science and Technology (AIST)</institution>, Tokyo 135-0064, <country country="JP">Japan</country></aff>
        <aff><institution>Com. Bio Big Data Open Innovation Lab. (CBBD-OIL), AIST</institution>, Tokyo 169-8555, <country country="JP">Japan</country></aff>
        <xref rid="btad100-cor1" ref-type="corresp"/>
        <!--adrienrougny@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Balaur</surname>
          <given-names>Irina</given-names>
        </name>
        <aff><institution>Luxembourg Centre for Systems Biomedicine (LCSB), University of Luxembourg, 7, avenue des Hauts Fourneaux</institution>, Esch-sur-Alzette L-4362, <country country="LU">Luxembourg</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luna</surname>
          <given-names>Augustin</given-names>
        </name>
        <aff><institution>Department of Systems Biology, Harvard Medical School</institution>, Boston, MA, <country country="US">USA</country></aff>
        <aff><institution>Department of Data Science, Dana-Farber Cancer Institute</institution>, Boston, MA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mazein</surname>
          <given-names>Alexander</given-names>
        </name>
        <aff><institution>Luxembourg Centre for Systems Biomedicine (LCSB), University of Luxembourg, 7, avenue des Hauts Fourneaux</institution>, Esch-sur-Alzette L-4362, <country country="LU">Luxembourg</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad100-cor1">To whom correspondence should be addressed. <email>adrienrougny@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-10">
      <day>10</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>3</issue>
    <elocation-id>btad100</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>10</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad100.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The systems biology graphical notation (SBGN) has become the <italic toggle="yes">de facto</italic> standard for the graphical representation of molecular maps. Having rapid and easy access to the content of large collections of maps is necessary to perform semantic or graph-based analysis of these resources. To this end, we propose StonPy, a new tool to store and query SBGN maps in a Neo4j graph database. StonPy notably includes a data model that takes into account all three SBGN languages and a completion module to automatically build valid SBGN maps from query results. StonPy is built as a library that can be integrated into other software and offers a command-line interface that allows users to easily perform all operations.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>StonPy is implemented in Python 3 under a GPLv3 license. Its code and complete documentation are freely available from <ext-link xlink:href="https://github.com/adrienrougny/stonpy" ext-link-type="uri">https://github.com/adrienrougny/stonpy</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Luxembourg</institution>
            <institution-id institution-id-type="DOI">10.13039/100008665</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The systems biology graphical notation (SBGN) (<xref rid="btad100-B5" ref-type="bibr">Le Novere <italic toggle="yes">et al.</italic>, 2009</xref>) is one of the main standards for representing molecular networks graphically. SBGN includes three different languages: process description (PD), for representing reaction networks (<xref rid="btad100-B11" ref-type="bibr">Rougny <italic toggle="yes">et al.</italic>, 2019</xref>); activity flow (AF), for representing influence graphs (<xref rid="btad100-B8" ref-type="bibr">Mi <italic toggle="yes">et al.</italic>, 2015</xref>); and entity relationship (ER), for representing rule-based graphs (<xref rid="btad100-B13" ref-type="bibr">Sorokin <italic toggle="yes">et al.</italic>, 2015</xref>). Having fast and easy access to the content of maps is valuable for semantic and graph-based analysis. For this purpose, <xref rid="btad100-B14" ref-type="bibr">Touré <italic toggle="yes">et al.</italic> (2016)</xref> previously proposed STON (SBGN to Neo4j), a Java-based software for storing SBGN PD and AF maps into a Neo4j database. Neo4j (<ext-link xlink:href="https://neo4j.com/" ext-link-type="uri">https://neo4j.com/</ext-link>) is a freely available labeled property graph-based database that (i) provides R, Java and Python-based APIs, (ii) uses Cypher, a declarative graph query language and (iii) facilitates user query and exploration via a web-based graphical user interface. Information within a Neo4j database is represented by <italic toggle="yes">labeled nodes</italic> (for concepts) and typed edges called <italic toggle="yes">relationships</italic> (for relationships between concepts); more, attributes of concepts and of their inter-relationships can be stored as named values called <italic toggle="yes">properties</italic> (with numeric, Booleans or string values). Graph databases have been proven efficient for storing and querying molecular networks (<xref rid="btad100-B2" ref-type="bibr">Fabregat <italic toggle="yes">et al.</italic>, 2018</xref>). STON, however, revealed a few drawbacks: first, it does not support the latest versions of Neo4j; second, it is available as standalone software, which makes it difficult to integrate into programmatic pipelines; third, its data model does not support all three SBGN languages (in particular, it does not support ER maps); and finally, features such as state variables and units of information cannot be queried efficiently, and complex queries are needed instead. To solve these issues, we developed StonPy, a new tool to store SBGN maps into a Neo4j database. Specifically, StonPy includes a new comprehensive data model that takes into account all elements of the three SBGN languages in a way they can be easily queried, including annotations. It also offers new capabilities to retrieve (sub-)maps from the database, based on a completion module that automatically builds valid SBGN maps from query results representing parts of maps.</p>
  </sec>
  <sec>
    <title>2 StonPy data model</title>
    <p>The data model of StonPy takes into account all SBGN elements in a way they can be easily queried (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> for a quick comparison with STON’s data model). Each element of an SBGN map is stored as a Neo4j node, and each relationship between two elements (including between an element and one of its sub-elements) is modeled as a Neo4j relationship connecting the nodes modeling the two elements (<xref rid="btad100-F1" ref-type="fig">Fig. 1</xref>).</p>
    <fig position="float" id="btad100-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of StonPy’s functionalities. An example of an input SBGN PD map is shown on the left. The corresponding Neo4j graph, built using StonPy, is shown on the right. All SBGN glyphs and arcs are modeled using Neo4j nodes; relationships between SBGN glyphs and sub-glyphs or complex attributes are modeled using Neo4j relationships. SBGN arcs are optionally modeled using additional Neo4j relationships (CATALYZES, HAS_REACTANT, and HAS_PRODUCT relationships) that mimic the structure of the SBGN map and facilitate writing queries on the represented biological concepts. For each Neo4j node, either one of its labels or one of its attributes is shown; for each label, its type is shown. Examples of labels and attributes are shown for some Neo4j nodes in the boxes on the right. Consumption (Cons) and Production (Prod) have been shortened for visualization</p>
      </caption>
      <graphic xlink:href="btad100f1" position="float"/>
    </fig>
    <p>In our data model, SBGN arcs are stored using Neo4j nodes. This structure is required since arcs may contain sub-elements [such as (sub-)glyphs or ports] that are themselves modeled using nodes. It has however two drawbacks: first, it moves our model away from the representation of maps itself, where arcs are links between nodes, and makes it less intuitive; second, it makes it more difficult for the user to write queries focusing on the biological concepts only, without taking into account their specific representation. To solve these issues, each arc is additionally modeled using a graph relationship from the node modeling its source to the one modeling its target (<xref rid="btad100-F1" ref-type="fig">Fig. 1</xref>, green relationships).</p>
  </sec>
  <sec>
    <title>3 StonPy functionalities and command-line tool</title>
    <p>The StonPy library allows users to store SBGN-ML (<xref rid="btad100-B1" ref-type="bibr">Bergmann <italic toggle="yes">et al.</italic>, 2020</xref>) maps into a running Neo4j database, and conversely retrieve them into SBGN-ML (<xref rid="btad100-F1" ref-type="fig">Fig. 1</xref>, Import and Export functionalities). StonPy also includes a completion module that allows users to build valid SBGN maps from query results representing parts of maps automatically (<xref rid="btad100-F1" ref-type="fig">Fig. 1</xref>, Query and Completion functionalities). This module significantly facilitates the extraction of submaps from the database based on given criteria expressed in a query. The completion algorithm and a complete example are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). StonPy also includes a command-line tool that allows users to easily perform all operations permitted by the library, and to automatically download SBGN and CellDesigner maps from a number of publicly available map repositories [e.g. the PANTHER database (<xref rid="btad100-B9" ref-type="bibr">Mi <italic toggle="yes">et al.</italic>, 2019</xref>) or the Atlas of Cancer Signalling Network (<xref rid="btad100-B4" ref-type="bibr">Kuperstein <italic toggle="yes">et al.</italic>, 2015</xref>)] and store them into a Neo4j database.</p>
  </sec>
  <sec>
    <title>4 StonPy use cases</title>
    <p>StonPy brings new capabilities for storing and analyzing large collections of CellDesigner and SBGN maps using Neo4j and Cypher. It has been successfully tested in several projects, demonstrating its usefulness in real-case applications, and how it can be integrated into workflows for the design and analysis of maps (<xref rid="btad100-B7" ref-type="bibr">Mazein <italic toggle="yes">et al.</italic>, 2022</xref>). For example, StonPy has been used to build a Neo4j database integrating the maps of the COVID-19 Disease Map resource (<xref rid="btad100-B10" ref-type="bibr">Niarakis <italic toggle="yes">et al.</italic>, 2022</xref>), and for the extensive analysis and comparison of the maps of the PANTHER database and Atlas of Cancer Signalling Networks resources (<xref rid="btad100-B6" ref-type="bibr">Mazein <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btad100-B12" ref-type="bibr">Rougny <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad100_Supplementary_Data</label>
      <media xlink:href="btad100_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We would like to thank the SBGN community for the development and maintenance of the SBGN standards.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Luxembourg Centre for Systems Biomedicine, University of Luxembourg; and the National Institute of General Medical Sciences [NIGMS-P41 GM103504] to A.L.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>StonPy is implemented in Python 3 under a GPLv3 license. It relies on the libsbgn-python library <xref rid="btad100-B3" ref-type="bibr">König (2020)</xref> for reading SBGN-ML files and on the py2neo library (<ext-link xlink:href="https://py2neo.org/" ext-link-type="uri">https://py2neo.org/</ext-link>) for interfacing with Neo4j. StonPy’s code and a complete documentation are freely available from <ext-link xlink:href="https://github.com/adrienrougny/stonpy" ext-link-type="uri">https://github.com/adrienrougny/stonpy</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad100-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergmann</surname><given-names>F.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Systems biology graphical notation markup language (SBGNML) version 0.3</article-title>. <source>J. Integr. Bioinform</source>., <volume>17, 20200016</volume>.</mixed-citation>
    </ref>
    <ref id="btad100-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fabregat</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Reactome graph database: efficient access to complex pathway data</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1005968</fpage>.<pub-id pub-id-type="pmid">29377902</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>König</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) matthiaskoenig/libsbgn-python: 0.2.2 (0.2.2). Zenodo. <pub-id pub-id-type="doi">10.5281/zenodo.4171366</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad100-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuperstein</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Atlas of cancer signalling network: a systems biology resource for integrative analysis of cancer data with google maps</article-title>. <source>Oncogenesis</source>, <volume>4</volume>, <fpage>e160</fpage>.<pub-id pub-id-type="pmid">26192618</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le Novere</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>The systems biology graphical notation</article-title>. <source>Nat. Biotechnol</source>., <volume>27</volume>, <fpage>735</fpage>. <lpage>741</lpage>.<pub-id pub-id-type="pmid">19668183</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mazein</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Reusability and composability in process description maps: RAS–RAF–MEK–ERK signalling</article-title>. <source>Brief. Bioinform</source>., <volume>22</volume>, <fpage>bbab103</fpage>.<pub-id pub-id-type="pmid">33834185</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Mazein</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>). High-quality reconstruction of disease mechanisms: planning, development and maintenance. pp. <fpage>2022120209</fpage>.</mixed-citation>
    </ref>
    <ref id="btad100-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mi</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Systems biology graphical notation: activity flow language level 1 version 1.2</article-title>. <source>J. Integr. Bioinform</source>., <volume>12</volume>, <fpage>340</fpage>. <lpage>381</lpage>.</mixed-citation>
    </ref>
    <ref id="btad100-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mi</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Panther version 14: more genomes, a new panther go-slim and improvements in enrichment analysis tools</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D419</fpage>. <lpage>D426</lpage>.<pub-id pub-id-type="pmid">30407594</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Niarakis</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal>; The COVID-19 Disease Map Community (<year>2022</year>) A versatile and interoperable computational framework for the analysis and modeling of COVID-19 disease mechanisms. bioRxiv. <pub-id pub-id-type="doi">10.1101/2022.12.17.520865</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad100-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rougny</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Systems biology graphical notation: process description language level 1 version 2.0</article-title>. <source>J. Integr. Bioinform</source>., <volume>16, 20190022</volume>.</mixed-citation>
    </ref>
    <ref id="btad100-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rougny</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>SBGN bricks ontology as a tool to describe recurring concepts in molecular networks</article-title>. <source>Brief. Bioinform</source>., <volume>22</volume>, <fpage>bbab049</fpage>.<pub-id pub-id-type="pmid">33758926</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sorokin</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Systems biology graphical notation: entity relationship language level 1 version 2</article-title>. <source>J. Integr. Bioinform</source>., <volume>12</volume>, <fpage>281</fpage>.<pub-id pub-id-type="pmid">26673932</pub-id></mixed-citation>
    </ref>
    <ref id="btad100-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Touré</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>STON: exploring biological pathways using the SBGN standard and graph databases</article-title>. <source>BMC Bioinform</source>., <volume>17</volume>, <fpage>1</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
