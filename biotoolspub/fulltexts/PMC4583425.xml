<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4583425</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-23319</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0138030</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>msCentipede: Modeling Heterogeneity across Genomic Sites and Replicates Improves Accuracy in the Inference of Transcription Factor Binding</article-title>
      <alt-title alt-title-type="running-head">msCentipede: Inferring Transcription Factor Binding</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Raj</surname>
          <given-names>Anil</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Shim</surname>
          <given-names>Heejung</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="currentaff001">
          <sup>¤</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gilad</surname>
          <given-names>Yoav</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pritchard</surname>
          <given-names>Jonathan K.</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stephens</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Genetics, Stanford University, Stanford, California, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Human Genetics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Biology, Stanford University, Stanford, California, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Howard Hughes Medical Institute, Chevy Chase, Maryland, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Statistics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zheng</surname>
          <given-names>Deyou</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Albert Einsten College of Medicine, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: AR HS YG JKP MS. Analyzed the data: AR HS. Wrote the paper: AR HS YG JKP MS.</p>
      </fn>
      <fn fn-type="current-aff" id="currentaff001">
        <label>¤</label>
        <p>Current address: Department of Statistics, Purdue University, West Lafayette, Indiana, United States of America</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>rajanil@stanford.edu</email> (AR); <email>hjshim@gmail.com</email> (HS); <email>gilad@uchicago.edu</email> (YG); <email>pritch@stanford.edu</email> (JKP); <email>mstephens@uchicago.edu</email> (MS)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <volume>10</volume>
    <issue>9</issue>
    <elocation-id>e0138030</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>8</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2015 Raj et al</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Raj et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0138030.pdf"/>
    <abstract>
      <p>Understanding global gene regulation depends critically on accurate annotation of regulatory elements that are functional in a given cell type. CENTIPEDE, a powerful, probabilistic framework for identifying transcription factor binding sites from tissue-specific DNase I cleavage patterns and genomic sequence content, leverages the hypersensitivity of factor-bound chromatin and the information in the DNase I spatial cleavage profile characteristic of each DNA binding protein to accurately infer functional factor binding sites. However, the model for the spatial profile in this framework fails to account for the substantial variation in the DNase I cleavage profiles across different binding sites. Neither does it account for variation in the profiles at the same binding site across multiple replicate DNase I experiments, which are increasingly available. In this work, we introduce new methods, based on multi-scale models for inhomogeneous Poisson processes, to account for such variation in DNase I cleavage patterns both within and across binding sites. These models account for the spatial structure in the heterogeneity in DNase I cleavage patterns for each factor. Using DNase-seq measurements assayed in a lymphoblastoid cell line, we demonstrate the improved performance of this model for several transcription factors by comparing against the Chip-seq peaks for those factors. Finally, we explore the effects of DNase I sequence bias on inference of factor binding using a simple extension to our framework that allows for a more flexible background model. The proposed model can also be easily applied to paired-end ATAC-seq and DNase-seq data. msCentipede, a Python implementation of our algorithm, is available at <ext-link ext-link-type="uri" xlink:href="http://rajanil.github.io/msCentipede">http://rajanil.github.io/msCentipede</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was funded by grants from the NIH (HG02585 to M.S., HG007036 to J.K.P., and MH084703 to Y.G. and J.K.P.), and by the Howard Hughes Medical Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="0"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data analyzed for this paper were published previously by other research groups and are publicly available without restrictions. These data include: DNase-seq in LCLs [<xref rid="pone.0138030.ref008" ref-type="bibr">8</xref>], ChIP-seq in LCLs [<xref rid="pone.0138030.ref020" ref-type="bibr">20</xref>], DNase-seq on naked DNA [<xref rid="pone.0138030.ref015" ref-type="bibr">15</xref>], and Transcription factor PWMs [<xref rid="pone.0138030.ref022" ref-type="bibr">22</xref>].</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data analyzed for this paper were published previously by other research groups and are publicly available without restrictions. These data include: DNase-seq in LCLs [<xref rid="pone.0138030.ref008" ref-type="bibr">8</xref>], ChIP-seq in LCLs [<xref rid="pone.0138030.ref020" ref-type="bibr">20</xref>], DNase-seq on naked DNA [<xref rid="pone.0138030.ref015" ref-type="bibr">15</xref>], and Transcription factor PWMs [<xref rid="pone.0138030.ref022" ref-type="bibr">22</xref>].</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>A central challenge in modern genomics is the accurate identification of all the regulatory sequences that are active in a given cell type and a description of the mechanisms by which they regulate gene expression. One key mechanism is by recruiting transcription factors which bind to the DNA at characteristic nucleotide sequences. Chromatin immunoprecipitation followed by sequencing (ChIP-seq) provides a direct measurement of DNA sequences bound by transcription factors (either directly or through a co-factor); however, each ChIP-seq experiment provides information for only one transcription factor at a time. DNase-seq [<xref rid="pone.0138030.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0138030.ref002" ref-type="bibr">2</xref>] provides an indirect measurement of active regulatory sequences by exploiting the increased sensitivity of nucleosome-depleted chromatin to DNase I enzyme. While DNase-seq provides information on the active regulatory regions in the genome, identifying which transcription factors are bound to these regions and their organization requires statistical modelling of the spatial structure in DNase sensitivity in active regulatory regions [<xref rid="pone.0138030.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0138030.ref007" ref-type="bibr">7</xref>].</p>
    <p>Pique-Regi et al. [<xref rid="pone.0138030.ref003" ref-type="bibr">3</xref>] introduced a probabilistic framework to infer sequence motif instances that are bound by transcription factors, by combining sequence information with the information in DNase I cleavage patterns measured from DNase-seq assays. The model, CENTIPEDE, relies on two observations: (1) chromatin around motif instances bound by transcription factors typically has higher DNase I sensitivity than chromatin around unbound motif instances, and (2) each transcription factor has a characteristic DNase I cleavage profile around bound motif instances. Based on these observations, given a putative bound motif instance, CENTIPEDE models the number of reads mapped to each base pair along a window around the motif site as a mixture of two components (bound vs unbound), and infers the probability that each site is bound. Specifically, conditional on being bound (or unbound), CENTIPEDE models (1) the total number of DNase-seq reads using a negative binomial distribution, and (2) DNase-seq read counts along a window, conditional on the total number of reads, using a multinomial distribution, with independent sets of parameters for bound and unbound sites.</p>
    <p>A limitation of the CENTIPEDE model is that it ignores variation in binding profiles across sites: it assumes that, given enough number of reads, the DNase I read count profiles would be the same at all bound sites, and that any variation in observed count profiles is due to multinomial sampling error from finite sequence coverage. However, in practice we have observed that read count profiles often have excess variation across factor-bound genomic locations and across replicate DNase-seq measurements compared with a multinomial model. Based on this, we hypothesized that improved modeling of this variation would improve predictions of transcription factor binding, particularly when multiple replicate DNase-seq datasets are available. Furthermore, when multiple replicate DNase-seq measurements are available for the same cell type, CENTIPEDE has often been applied after pooling replicates. If there is substantial heterogeneity between replicates, then pooling replicates tends to introduce more variation in the read count profiles, exacerbating the limitation of the multinomial model in this framework. The increasing availability of such replicate data [<xref rid="pone.0138030.ref008" ref-type="bibr">8</xref>] make improved performance in this setting particularly desirable.</p>
    <p><xref ref-type="fig" rid="pone.0138030.g001">Fig 1</xref> illustrates the excess variation in read count profiles noted above. The figure compares the distribution of the observed proportion of reads mapping to each half of a genomic window around each motif instance with its expectations under a multinomial sampling model (see <xref ref-type="supplementary-material" rid="pone.0138030.s009">S1 Methods</xref> for details). The distribution of observed (‘true’) proportions clearly exhibits a higher variance than expected under the multinomial model, demonstrating that multinomial sampling variation is insufficient to model the variation in read profiles across factor-bound genomic sites. Analagous plots at finer scales (smaller windows) show similar evidence for overdispersion (not shown).</p>
    <fig id="pone.0138030.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0138030.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Illustration that DNase I cleavage profiles exhibit excess variation compared with a multinomial model.</title>
        <p>For a set of 1000 SP1 motif instances with high ChIP-seq signal, we computed, for a 100bp window around each motif instance, the ratio of number of DNase I cuts mapped to the left half of the window to the number of DNase I cuts mapped to the entire window. The histogram of these ‘observed ratios’ is shown in orange. Under a multinomial model the number of reads mapping to each half of the window should have a binomial distribution, and we used this fact to simulate ‘expected ratios’ (gray line); see <xref ref-type="supplementary-material" rid="pone.0138030.s009">S1 Methods</xref> for more details. The observed ratios are clearly overdispersed compared with the expectation under a multinomial model.</p>
      </caption>
      <graphic xlink:href="pone.0138030.g001"/>
    </fig>
    <p>Motivated by these observations, we have developed methods to better model heterogeneity in the read profiles across genomic locations and across replicate measurements of chromatin accessibility. Our methods are based on extending recent work using multi-scale methods for analyses of high-throughput sequencing data [<xref rid="pone.0138030.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0138030.ref010" ref-type="bibr">10</xref>]. A key feature of these multi-scale methods is that they allow for spatial structure in the heterogeneity across sites, with different amounts of variation at each spatial scale, and automatic identification of relevant scales during inference.</p>
    <p>In addition to modelling heterogeneity among sites, the multi-scale methods provide a simple way to model the background cleavage model for DNase I. We have also implemented a flexible background model, and explored the improvement in performance when DNase-seq data from naked DNA are available to estimate its parameters.</p>
  </sec>
  <sec id="sec002">
    <title>Methods and Data</title>
    <p>Suppose we have <italic>S</italic> replicate DNase-seq measurements for a particular cell type or experimental condition. Consider a genomic window (site) of length <italic>L</italic> centered around each of <italic>N</italic> putative binding motifs, with <italic>L</italic> assumed to be a power of 2 (<italic>L</italic> = 2<sup><italic>J</italic></sup>). Let <italic>X</italic>
<sup><italic>n</italic></sup> = (<italic>X</italic>
<sup><italic>n</italic>,1</sup>, …, <italic>X</italic>
<sup><italic>n</italic>,<italic>S</italic></sup>), where <inline-formula id="pone.0138030.e001"><alternatives><graphic xlink:href="pone.0138030.e001.jpg" id="pone.0138030.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the sequence of read counts in the <italic>n</italic>
<sup>th</sup> site for the <italic>s</italic>
<sup>th</sup> replicate and <inline-formula id="pone.0138030.e002"><alternatives><graphic xlink:href="pone.0138030.e002.jpg" id="pone.0138030.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is read count at <italic>l</italic>
<sup>th</sup> base pair in the site. Let <italic>Z</italic>
<sup><italic>n</italic></sup> denote a binary indicator for whether the <italic>n</italic>
<sup>th</sup> site is bound (<italic>Z</italic>
<sup><italic>n</italic></sup> = 1). Following the model in CENTIPEDE [<xref rid="pone.0138030.ref003" ref-type="bibr">3</xref>], a mixture model at the <italic>n</italic>
<sup>th</sup> site can be written as
<disp-formula id="pone.0138030.e003"><alternatives><graphic xlink:href="pone.0138030.e003.jpg" id="pone.0138030.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where
<disp-formula id="pone.0138030.e004"><alternatives><graphic xlink:href="pone.0138030.e004.jpg" id="pone.0138030.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1.em"/><mml:mtext>for</mml:mtext><mml:mspace width="1.em"/><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
and the mixing proportion <monospace>P</monospace>(<italic>Z</italic>
<sup><italic>n</italic></sup> = 1) = ζ<sub><italic>n</italic></sub> is modeled as a logistic function of genomic information (e.g. motif position weight matrix score and motif sequence conservation score). Note that <xref ref-type="disp-formula" rid="pone.0138030.e004">Eq (2)</xref> treats the <italic>S</italic> replicates for each site as independent given the bound/unbound status <italic>Z</italic>
<sup><italic>n</italic></sup>. In the following sections, we first detail our model for one replicate (here we drop the superscript <sup><italic>s</italic></sup>) and then describe its extension to multiple replicates.</p>
    <sec id="sec003">
      <title>msCentipede model at bound motifs</title>
      <p>We modeled the profile of read counts at the <italic>n</italic>
<sup>th</sup> site <italic>X</italic>
<sup><italic>n</italic></sup> conditional on <italic>Z</italic>
<sup><italic>n</italic></sup> = 1 using a Poisson model: <inline-formula id="pone.0138030.e005"><alternatives><graphic xlink:href="pone.0138030.e005.jpg" id="pone.0138030.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for <italic>l</italic> = 1, …, <italic>L</italic>. We allowed the mean read profile <inline-formula id="pone.0138030.e006"><alternatives><graphic xlink:href="pone.0138030.e006.jpg" id="pone.0138030.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to vary across sites by using a hierarchical version of the multi-scale model for inhomogeneous Poisson processes introduced by Kolaczyk [<xref rid="pone.0138030.ref011" ref-type="bibr">11</xref>], and Timmermann and Nowak [<xref rid="pone.0138030.ref012" ref-type="bibr">12</xref>].</p>
      <p>To introduce the ideas behind the multi-scale model, consider a single site with parameter vector <italic>μ</italic> = (<italic>μ</italic>
<sub>1</sub>, …, <italic>μ</italic>
<sub><italic>L</italic></sub>) (so drop the superscript <sup><italic>n</italic></sup> for simplicity). The key idea behind multi-scale Poisson models is to reparameterize this model in terms of parameters that capture spatial variation in <italic>μ</italic> at multiple scales, as follows. Let <inline-formula id="pone.0138030.e007"><alternatives><graphic xlink:href="pone.0138030.e007.jpg" id="pone.0138030.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> denote the sum <inline-formula id="pone.0138030.e008"><alternatives><graphic xlink:href="pone.0138030.e008.jpg" id="pone.0138030.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. At the “zeroth” scale, define a single intensity parameter <italic>λ</italic>
<sub>0</sub> that captures the total intensity in the region
<disp-formula id="pone.0138030.e009"><alternatives><graphic xlink:href="pone.0138030.e009.jpg" id="pone.0138030.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
At the first scale define a single parameter that captures the relative intensity in the first half of the region vs the entire region:
<disp-formula id="pone.0138030.e010"><alternatives><graphic xlink:href="pone.0138030.e010.jpg" id="pone.0138030.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:msubsup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
At the second scale, define two parameters: one that captures the relative intensity in the first quarter of the region vs the first half; and one that captures the relative intensity in the third quarter vs the second half.
<disp-formula id="pone.0138030.e011"><alternatives><graphic xlink:href="pone.0138030.e011.jpg" id="pone.0138030.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>;</mml:mo><mml:mspace width="1.em"/><mml:msub><mml:mi>p</mml:mi><mml:mn>22</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
At the third scale there are four parameters <italic>p</italic>
<sub>31</sub>, …, <italic>p</italic>
<sub>34</sub> that similarly capture the relative intensity of an eighth of the region vs each quarter. This continues up to the <italic>J</italic>th scale (where recall <italic>J</italic> = log<sub>2</sub>(<italic>L</italic>)), in which there are <italic>L</italic>/2 = 2<sup><italic>J</italic>−1</sup> parameters of the form
<disp-formula id="pone.0138030.e012"><alternatives><graphic xlink:href="pone.0138030.e012.jpg" id="pone.0138030.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mspace width="1.em"/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mspace width="1.em"/><mml:mo>⋯</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
Combining across scales 0 to <italic>J</italic> this defines a total of <italic>L</italic> parameters, <italic>p</italic> = (<italic>λ</italic>
<sub>0</sub>, <italic>p</italic>
<sub>11</sub>, <italic>p</italic>
<sub>21</sub>, <italic>p</italic>
<sub>22</sub>, …, <italic>p</italic>
<sub><italic>J</italic>(<italic>L</italic>/2)</sub>), which are a one-to-one function of <italic>μ</italic>. That is, this defines a reparameterization of the model from <italic>μ</italic> = (<italic>μ</italic>
<sub>1</sub>, …, <italic>μ</italic>
<sub><italic>L</italic></sub>) to <italic>p</italic> = (<italic>λ</italic>
<sub>0</sub>, <italic>p</italic>
<sub>11</sub>, <italic>p</italic>
<sub>21</sub>, <italic>p</italic>
<sub>22</sub>, …, <italic>p</italic>
<sub><italic>J</italic>(<italic>L</italic>/2)</sub>).</p>
      <p>This reparameterization has two key features: i) the likelihood <monospace>P</monospace>(<italic>X</italic>∣<italic>p</italic>) factorizes into a product form over the <italic>L</italic> elements of <italic>p</italic> (just as the likelihood <monospace>P</monospace>(<italic>X</italic>∣<italic>μ</italic>) factorizes into a product over the <italic>L</italic> elements of <italic>μ</italic>). Indeed, from elementary properties of the Poisson distribution, this factorization includes a Poisson likelihood for <italic>λ</italic>
<sub>0</sub> and a Binomial likelihood for each of the other parameters in <italic>p</italic>; see <xref ref-type="supplementary-material" rid="pone.0138030.s009">S1 Methods</xref> and [<xref rid="pone.0138030.ref011" ref-type="bibr">11</xref>] for details. ii) spatially-structured perturbations to the vector <italic>μ</italic> are captured by large perturbations in just a few elements of <italic>p</italic>. (By a spatially-structured perturbation, we mean a modification <italic>μ</italic>
<sub><italic>i</italic></sub> → <italic>μ</italic>
<sub><italic>i</italic></sub>+<italic>δ</italic>
<sub><italic>i</italic></sub> such that <italic>δ</italic>
<sub><italic>i</italic></sub> tends to be similar to <italic>δ</italic>
<sub><italic>j</italic></sub> when ∣<italic>i</italic> − <italic>j</italic>∣ is small.) This property is related to the similar key property of wavelets [<xref rid="pone.0138030.ref013" ref-type="bibr">13</xref>], which are perhaps the best known multi-scale methods: spatially smooth signals tend to be concentrated into a small number of wavelet coefficients.</p>
      <p>As a consequence of ii) we modeled spatially-smooth heterogeneity in <italic>μ</italic>
<sup>1</sup>, …, <italic>μ</italic>
<sup><italic>N</italic></sup> across <italic>N</italic> putative binding sites using a simple hierarchical model for <italic>p</italic>
<sup>1</sup>, …, <italic>p</italic>
<sup><italic>N</italic></sup> (where we have reintroduced superscript <sup><italic>n</italic></sup> to index sites). Specifically, we introduced parameters <inline-formula id="pone.0138030.e013"><alternatives><graphic xlink:href="pone.0138030.e013.jpg" id="pone.0138030.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>11</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>21</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>22</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to represent the mean cleavage pattern across sites, and then assumed that site specific parameters <italic>p</italic>
<sup>1</sup>, …, <italic>p</italic>
<sup><italic>N</italic></sup> are independent and identically distributed given <inline-formula id="pone.0138030.e014"><alternatives><graphic xlink:href="pone.0138030.e014.jpg" id="pone.0138030.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, with
<disp-formula id="pone.0138030.e015"><alternatives><graphic xlink:href="pone.0138030.e015.jpg" id="pone.0138030.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∼</mml:mo><mml:mtext>gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
<disp-formula id="pone.0138030.e016"><alternatives><graphic xlink:href="pone.0138030.e016.jpg" id="pone.0138030.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
for <italic>k</italic> = 1, …, 2<sup><italic>j</italic>−1</sup> and <italic>j</italic> = 1, …, <italic>J</italic>, where <italic>α</italic> and <italic>τ</italic>
<sub><italic>j</italic></sub> are hyperparameters (estimated from the data) that control variability in the parameters at different scales. To ensure that the beta distributions in <xref ref-type="disp-formula" rid="pone.0138030.e016">Eq (8)</xref> are unimodal, we constrain the hyperparameters <inline-formula id="pone.0138030.e017"><alternatives><graphic xlink:href="pone.0138030.e017.jpg" id="pone.0138030.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> such that <inline-formula id="pone.0138030.e018"><alternatives><graphic xlink:href="pone.0138030.e018.jpg" id="pone.0138030.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0138030.e019"><alternatives><graphic xlink:href="pone.0138030.e019.jpg" id="pone.0138030.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for all <italic>k</italic> = 1, …, 2<sup><italic>j</italic>−1</sup> and <italic>j</italic> = 1, …, <italic>J</italic>.</p>
    </sec>
    <sec id="sec004">
      <title>msCentipede model at unbound motifs</title>
      <p>We modeled the read count profile at the <italic>n</italic>
<sup>th</sup> site <italic>X</italic>
<sup><italic>n</italic></sup> conditional on <italic>Z</italic>
<sup><italic>n</italic></sup> = 0 using the same Poisson model, but with different distributions for the parameters:
<disp-formula id="pone.0138030.e020"><alternatives><graphic xlink:href="pone.0138030.e020.jpg" id="pone.0138030.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∼</mml:mo><mml:mtext>gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mi>o</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mi>o</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>o</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
<disp-formula id="pone.0138030.e021"><alternatives><graphic xlink:href="pone.0138030.e021.jpg" id="pone.0138030.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∼</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
where <italic>δ</italic>
<sub>0.5</sub> denotes the distribution with point mass on 0.5. Note that this means that <inline-formula id="pone.0138030.e022"><alternatives><graphic xlink:href="pone.0138030.e022.jpg" id="pone.0138030.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, which is equivalent to assuming that the Poisson rates <italic>μ</italic> = (<italic>μ</italic>
<sub>1</sub>, …, <italic>μ</italic>
<sub><italic>L</italic></sub>) are all equal, resulting in uniformly distributed reads over the entire site. That is, it corresponds to the commonly-used assumption that there is no spatial structure in the read count profile when the transcription factor is not bound to its motif. Later, we propose a more flexible model for unbound sites.</p>
    </sec>
    <sec id="sec005">
      <title>CENTIPEDE is a special case of msCentipede</title>
      <p>The above msCentipede model (Eqs (<xref ref-type="disp-formula" rid="pone.0138030.e020">9</xref>) and (<xref ref-type="disp-formula" rid="pone.0138030.e021">10</xref>)) for unbound sites is exactly the same as the CENTIPEDE model for unbound sites. (The assumption of a gamma distribution for the Poisson rate parameter <inline-formula id="pone.0138030.e023"><alternatives><graphic xlink:href="pone.0138030.e023.jpg" id="pone.0138030.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pone.0138030.e020">Eq (9)</xref> implies a negative binomial distribution for the total read-counts, which is exactly the model assumed by CENTIPEDE.) Furthermore, the msCentipede model for bound sites, <xref ref-type="disp-formula" rid="pone.0138030.e016">Eq (8)</xref>, becomes equivalent to the original CENTIPEDE model for bound sites in the special case <italic>τ</italic>
<sub><italic>j</italic></sub> → ∞, which corresponds to no heterogeneity in the shape of the cleavage pattern across bound sites. That is, msCentipede is an extension of CENTIPEDE to allow for heterogeneity in the shape of the cleavage pattern across bound sites.</p>
    </sec>
    <sec id="sec006">
      <title>msCentipede for multiple replicates</title>
      <p>When multiple replicates are available, msCentipede treats the replicates as independent (see <xref ref-type="disp-formula" rid="pone.0138030.e004">Eq (2)</xref>). We assume the site and replicate specific parameters <inline-formula id="pone.0138030.e024"><alternatives><graphic xlink:href="pone.0138030.e024.jpg" id="pone.0138030.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>11</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>21</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>22</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for <italic>n</italic> = 1, …, <italic>N</italic> and <italic>s</italic> = 1, …, <italic>S</italic> (where we have reintroduced superscript <sup><italic>s</italic></sup> to index replicates) are independent and distributed as follows. Conditional on <italic>Z</italic>
<sup><italic>n</italic></sup> = 1,
<disp-formula id="pone.0138030.e025"><alternatives><graphic xlink:href="pone.0138030.e025.jpg" id="pone.0138030.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∼</mml:mo><mml:mtext>gamma</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
where replicate-specific hyper parameters, <italic>α</italic>
<sup><italic>s</italic></sup> and <inline-formula id="pone.0138030.e026"><alternatives><graphic xlink:href="pone.0138030.e026.jpg" id="pone.0138030.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, capture replicate-specific mean (<inline-formula id="pone.0138030.e027"><alternatives><graphic xlink:href="pone.0138030.e027.jpg" id="pone.0138030.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) and variance (<inline-formula id="pone.0138030.e028"><alternatives><graphic xlink:href="pone.0138030.e028.jpg" id="pone.0138030.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mrow><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>α</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>). At the remaining scales,
<disp-formula id="pone.0138030.e029"><alternatives><graphic xlink:href="pone.0138030.e029.jpg" id="pone.0138030.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
where hyper parameter <inline-formula id="pone.0138030.e030"><alternatives><graphic xlink:href="pone.0138030.e030.jpg" id="pone.0138030.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents the mean cleavage pattern across replicates and sites, and hyper parameter <italic>τ</italic>
<sub><italic>j</italic></sub> controls variability in the parameters at different scales.</p>
      <p>This approach simplifies the problem by treating variation across replicates within a single site in effectively the same way as variation across sites within a single replicate. In principle this treatment could be improved—for example, by introducing a “random effect” at each site to represent site-specific variation that is shared across replicates. However, this would inevitably complicate the inference procedure, and we do not pursue it here.</p>
      <p>The background model (<italic>Z</italic>
<sup><italic>n</italic></sup> = 0) can be constructed in a similar way:
<disp-formula id="pone.0138030.e031"><alternatives><graphic xlink:href="pone.0138030.e031.jpg" id="pone.0138030.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∼</mml:mo><mml:mtext>gamma</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
<disp-formula id="pone.0138030.e032"><alternatives><graphic xlink:href="pone.0138030.e032.jpg" id="pone.0138030.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∼</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
where <italic>δ</italic>
<sub>0.5</sub> denotes the distribution with point mass on 0.5.</p>
      <p>To account for the difference in the total number of sequence reads generated for each replicate, we allow for replicate-specific hyper parameters at the zeroth scale (see Eqs (<xref ref-type="disp-formula" rid="pone.0138030.e025">11</xref>) and (<xref ref-type="disp-formula" rid="pone.0138030.e031">13</xref>)). See <xref ref-type="supplementary-material" rid="pone.0138030.s009">S1 Methods</xref> for the computation of the likelihood.</p>
    </sec>
    <sec id="sec007">
      <title>Flexible model for background DNase I cleavage rate</title>
      <p>A number of studies have highlighted a strong sequence preference for DNase I cleavage [<xref rid="pone.0138030.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0138030.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0138030.ref016" ref-type="bibr">16</xref>]. This sequence preference would cause the distribution of reads at unbound motif instances to be i) systematically non-uniform near the shared core motif; and ii) varying among motif instances away from the shared core motif (due to differences in the surrounding sequence). To account for these factors we consider a more flexible model for unbound sites. Specifically, we modify Eqs (<xref ref-type="disp-formula" rid="pone.0138030.e021">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0138030.e032">14</xref>) as follows:
<disp-formula id="pone.0138030.e033"><alternatives><graphic xlink:href="pone.0138030.e033.jpg" id="pone.0138030.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>o</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mi>o</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>j</mml:mi><mml:mi>o</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>j</mml:mi><mml:mi>o</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
where the background parameters <inline-formula id="pone.0138030.e034"><alternatives><graphic xlink:href="pone.0138030.e034.jpg" id="pone.0138030.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>τ</italic>
<sup><italic>o</italic></sup> control the mean profile and the variance about this mean respectively. We estimated these background parameters using DNase-seq reads from naked DNA around the same set of motif instances, and refer to the method using this more flexible background model as msCentipede-flexbg. (In principle it is also possible to estimate these parameters using the DNase-seq data from chromatin, as part of the clustering of motif instances into bound and unbound motifs, but when we tried this we found msCentipede performed worse in practice than the uniform model (Eqs (<xref ref-type="disp-formula" rid="pone.0138030.e021">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0138030.e032">14</xref>)), presumably because of the cost associated with attempting to estimate the many additional parameters of this more flexible model; see <xref ref-type="sec" rid="sec013">Discussion</xref>).</p>
    </sec>
    <sec id="sec008">
      <title>Parameter estimation and inference</title>
      <p>We estimated model parameters {<italic>ζ</italic>, <italic>α</italic>
<sup><italic>s</italic></sup>, <inline-formula id="pone.0138030.e035"><alternatives><graphic xlink:href="pone.0138030.e035.jpg" id="pone.0138030.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>α</italic>
<sup><italic>o</italic>,<italic>s</italic></sup>, <inline-formula id="pone.0138030.e036"><alternatives><graphic xlink:href="pone.0138030.e036.jpg" id="pone.0138030.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>τ</italic>
<sub><italic>j</italic></sub>, <inline-formula id="pone.0138030.e037"><alternatives><graphic xlink:href="pone.0138030.e037.jpg" id="pone.0138030.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>} by maximizing the likelihood across all putative binding sites using a variational optimization algorithm, accelerated using the SQUAREM method [<xref rid="pone.0138030.ref017" ref-type="bibr">17</xref>]. The variational optimization scheme is detailed in <xref ref-type="supplementary-material" rid="pone.0138030.s009">S1 Methods</xref>, and is equivalent to the expectation-maximization algorithm [<xref rid="pone.0138030.ref018" ref-type="bibr">18</xref>]. When DNase-seq data assayed in naked DNA were available, the background parameters <inline-formula id="pone.0138030.e038"><alternatives><graphic xlink:href="pone.0138030.e038.jpg" id="pone.0138030.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0138030.e039"><alternatives><graphic xlink:href="pone.0138030.e039.jpg" id="pone.0138030.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>j</mml:mi><mml:mi>o</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> were first estimated using naked DNA assays; keeping these fixed, we, then, learned the remaining model parameters.</p>
      <p>Inference on binding sites can be performed by computing the posterior odds for each site:
<disp-formula id="pone.0138030.e040"><alternatives><graphic xlink:href="pone.0138030.e040.jpg" id="pone.0138030.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="normal">n</mml:mi><mml:mtext>th</mml:mtext></mml:msup><mml:mspace width="0.277778em"/><mml:mtext>site</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>bound</mml:mtext><mml:mo>|</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="normal">n</mml:mi><mml:mtext>th</mml:mtext></mml:msup><mml:mspace width="0.277778em"/><mml:mtext>site</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>unbound</mml:mtext><mml:mo>|</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula>
Detailed computation of <monospace>P</monospace>(<italic>Z</italic>
<sup><italic>n</italic></sup> = 1∣<italic>X</italic>
<sup><italic>n</italic></sup>) is given in <xref ref-type="supplementary-material" rid="pone.0138030.s009">S1 Methods</xref>.</p>
    </sec>
    <sec id="sec009">
      <title>Description of data and validation metrics</title>
      <p>We executed msCentipede and CENTIPEDE using DNase-seq and ATAC-seq measurements assayed in the GM12878 lymphoblastoid cell line as data. Two replicate measurements using the UW DNase-seq protocol [<xref rid="pone.0138030.ref002" ref-type="bibr">2</xref>] and four replicate ATAC-seq measurements [<xref rid="pone.0138030.ref019" ref-type="bibr">19</xref>] were available for this cell line. The DNase-seq data were single-end reads that can be converted to counts of DNase I nicks for each base pair in a straightforward manner. The ATAC-seq data were paired-end reads; however, we ignored the information in the length of DNA fragments and used the counts of transpositions for each base pair as data.</p>
      <p>We compared the algorithms on a set of 40 transcription factors with ChIP-seq data assayed by ENCODE in the same cell line [<xref rid="pone.0138030.ref020" ref-type="bibr">20</xref>], and for which PWM models were computed using data from high-throughput SELEX experiments [<xref rid="pone.0138030.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0138030.ref022" ref-type="bibr">22</xref>]. For each transcription factor, we identified a genomewide set of high-quality putative binding sites (PBS) using human genome reference GrCh37; for each PBS, the likelihood ratio for the PWM model vs a background model exceeded 1000. Using a 64 base-pair window around each PBS, we filtered out those sites that had fewer than 80% of bases in their window to be uniquely mappable. For each of the remaining sites, we computed the posterior probability that the transcription factor is bound, using CENTIPEDE and msCentipede. We used DNase-seq read count data from naked DNA derived from the IMR90 cell line [<xref rid="pone.0138030.ref015" ref-type="bibr">15</xref>] to fit the background model parameters in msCentipede-flexbg.</p>
      <p>In addition, we compared the performance of msCentipede against that of PIQ [<xref rid="pone.0138030.ref007" ref-type="bibr">7</xref>] using DNase-seq data. Starting with a set of candidate binding sites, PIQ learns the background DNase I cleavage rate using a Gaussian process model. Then, PIQ estimates TF binding based on DNase I cleavage profiles and total DNase I cleavage rates that are specific to each TF, using the expectation propagation algorithm. We used the “score” metric output by PIQ as a measure of confidence of whether a motif instance is bound. When multiple replicate measurements are available, we executed PIQ by providing data from the replicates as separate input files.</p>
      <p>We evaluated the accuracy of each of the three algorithms using Area under the Receiver Operating Curve (AuROC). To compute the AuROC, we selected a gold standard set of ‘bound motif instances’ and ‘unbound motif instances’; bound motif instances were PBS that lied within a ChIP-seq peak identified by a peak caller and ‘unbound motif instances’ were PBS that lied outside ChIP-seq peaks and had fewer ChIP reads than reads from a control IP experiment mapping to a 400 base pair window around the PBS, after controlling for total read depth. For each transcription factor, we executed two peak callers, MACS [<xref rid="pone.0138030.ref023" ref-type="bibr">23</xref>] and GEM [<xref rid="pone.0138030.ref024" ref-type="bibr">24</xref>], each with a 1% FDR cutoff, to generate two gold standard sets of bound and unbound motif instances. In this paper, we illustrate the accuracy of the algorithms evaluated against gold standards generated using GEM when using DNase-seq measurements as data. The accuracy of all three algorithms decreased by a modest amount when using the gold standards generated by MACS (see <xref ref-type="supplementary-material" rid="pone.0138030.s001">S1 Fig</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec010">
    <title>Results</title>
    <p>In this section, we evaluate the accuracy of msCentipede, using multiple DNase-seq and ATAC-seq data sets, on a set of transcription factors for which high quality ChIP-seq data and highly informative position-weight matrix (PWM) models are available. We also evaluate the gain in performance achieved when we use a more flexible model for background DNase I cleavage rate, with parameters for this model learned using DNase-seq data from naked DNA.</p>
    <sec id="sec011">
      <title>msCentipede achieves improved accuracy</title>
      <p>msCentipede achieved AuROC comparable to or better than CENTIPEDE across a broad range of transcription factors when each algorithm was applied to chromatin accessibility measurements from a single DNase-seq assay as shown in <xref ref-type="fig" rid="pone.0138030.g002">Fig 2A</xref> (top). Compared with PIQ, we observed that msCentipede achieved substantially higher AuROC for some factors and lower AuROC for others, as shown in <xref ref-type="fig" rid="pone.0138030.g002">Fig 2A</xref> (bottom) (see <xref ref-type="supplementary-material" rid="pone.0138030.s010">S1 Table</xref> for more details). When multiple replicates are available, CENTIPEDE requires pooling the replicate datasets and PIQ uses the replicate datasets to jointly learn the background Gaussian process model; however, msCentipede treats replicates by modeling them as independent samples. By modeling the replicates appropriately and accounting for heterogeneity across genomic sites and replicates, msCentipede achieved substantial increase in AuROC compared to CENTIPEDE and PIQ for a broad range of transcription factors, as illustrated in <xref ref-type="fig" rid="pone.0138030.g002">Fig 2B</xref>. Similar improvements in accuracy for msCentipede compared to CENTIPEDE were observed when using ATAC-seq measurements as data (see <xref ref-type="supplementary-material" rid="pone.0138030.s002">S2 Fig</xref>).</p>
      <fig id="pone.0138030.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0138030.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Accuracy of msCentipede, CENTIPEDE and PIQ across a range of transcription factors.</title>
          <p>Each point corresponds to a different factor and accuracy is measured by area under the ROC curve. Blue points correpond to factors where msCentipede achieves higher accuracy than CENTIPEDE (top panels) or PIQ (bottom panels), and orange points correspond to a worse performance by msCentipede. A: The algorithms are compared using data from a single replicate. B: The algorithms are compared using data from multiple library replicates.</p>
        </caption>
        <graphic xlink:href="pone.0138030.g002"/>
      </fig>
      <p>For each transcription factor, the hyperparameter <italic>τ</italic> gives a measure of heterogeneity in read distribution across genomic sites and replicates, with lower values indicating greater heterogeneity. In <xref ref-type="supplementary-material" rid="pone.0138030.s003">S3 Fig</xref>, we observed that the values of the hyperparameters <italic>τ</italic>
<sub><italic>j</italic></sub> were rather small, suggesting that we were able to increase power by better modeling variation in the data. Furthermore, we observed a higher degree of overdispersion in read distribution at medium resolutions compared to the finest and coarsest resolutions across all transcription factors.</p>
    </sec>
    <sec id="sec012">
      <title>Modeling DNase I cleavage patterns improves factor binding inference</title>
      <p>In recent work, He et al. [<xref rid="pone.0138030.ref016" ref-type="bibr">16</xref>] and Sung et al. [<xref rid="pone.0138030.ref025" ref-type="bibr">25</xref>] demonstrated that strong DNA sequence preference for DNase I cleavage could pose a challenge to using the detailed shape of DNase cleavage profiles for inferring transcription factor binding. Specifically, He et al. [<xref rid="pone.0138030.ref016" ref-type="bibr">16</xref>] identified motif instances that lie within peaks in ChIP-seq measurements for a transcription factor in a given cell line. Using these instances, they showed that, in a region of ∼ 20 bp surrounding the motif, the mean DNase I cleavage profile estimated from naked DNA (unbound sites) matched the mean cleavage profile estimated using DNase-seq data from the same cell line (bound sites). Starting from similar observations, Sung et al. [<xref rid="pone.0138030.ref025" ref-type="bibr">25</xref>] clarified that although sequence-preference effects were evident for all transcription factors, some transcription factors—those with slower-binding kinetics—show an appreciable reduction in the cut profile around the bound motifs (a “footprint”), whereas others—those with faster-binding kinetics—show little or no footprint.</p>
      <p>These observations raise two questions: first, whether the uniform background model (assumed by CENTIPEDE, and msCentipede) for the unbound sites might be better replaced by a non-uniform background model capable of capturing the sequence preference effects around the motifs; second, whether it might be better to entirely ignore the DNase I cleavage profile when attempting to distinguish between bound and unbound sites—and, rather, to focus only on the total intensity of DNase I hypersensitivity in the region. To test this, we compared the accuracy of three different models for transcription factor binding:
<list list-type="order"><list-item><p>‘no cleavage profile’ model that ignores the cleavage profile, and simply models the total DNase read counts using Poisson-gamma distributions at bound and unbound sites (described earlier).</p></list-item><list-item><p>msCentipede</p></list-item><list-item><p>msCentipede-flexbg, which allows for a non-uniform background model, with parameters estimated using DNase-seq measurements from naked DNA around the same set of PBS.</p></list-item></list>
</p>
      <p>Comparing first the msCentipede model with the no-cleavage model, we found the accuracy of msCentipede to be substantially greater for a broad range of transcription factors (<xref ref-type="fig" rid="pone.0138030.g003">Fig 3A</xref>). This result may appear to conflict with previous results [<xref rid="pone.0138030.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0138030.ref025" ref-type="bibr">25</xref>] showing that cleavage patterns within factor-bound motif instances are driven primarily by sequence preferences for DNase I cleavage, which suggests that use of the cleavage profile to identify binding sites could increase false positive findings. However, we note that i) sequence preference effects, while presumably occuring genome wide, are <italic>shared</italic> across binding sites only in the small region around the shared sequence motif (typically 10–20 bp), while most methods to detect factor binding, including ours, make use of cleavage patterns in much larger windows (typically 50–100 bp) around the motif instance, and ii) for some factors—those with slower binding kinetics—the footprint effect (i.e. the systematic overall decrease in DNase signal surrounding the motif) may be helpful in distinguishing bound and unbound sites, and the benefits of this could outweigh the unmodelled sequence preference effects.</p>
      <fig id="pone.0138030.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0138030.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Modeling factor-specific DNase I cleavage profile and sequence bias in DNase cleavage increases prediction accuracy.</title>
          <p>A: Modeling the DNase I cleavage profile at bound sites increases the prediction accuracy of msCentipede across a broad range of transcription factors. Each point on the plot corresponds to a different transcription factor. B: We show the ROC curves for transcription factor EBF1 for three different models of increasing complexity. We observe a substantial increase in accuracy when incorporating a multi-scale model for the factor-specific cleavage profile; however, the increase in accuracy when modeling the background cleavage rate using naked DNA data is rather modest. This holds true for a broad range of factors as shown in <xref ref-type="supplementary-material" rid="pone.0138030.s004">S4 Fig</xref>.</p>
        </caption>
        <graphic xlink:href="pone.0138030.g003"/>
      </fig>
      <p>We turn now to evaluate the effect of sequence bias in DNase I cleavage patterns on the inference of TF binding by comparing msCentipede with msCentipede-flexbg. Note that msCentipede-flexbg, by modeling the background cleavage profile using naked DNA assays, has the potential to eliminate false positives due to sequence-driven cleavage patterns highlighted earlier [<xref rid="pone.0138030.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0138030.ref025" ref-type="bibr">25</xref>]. And indeed, we found that, for most factors, the estimated mean background cleavage profile, captured by the parameters <inline-formula id="pone.0138030.e041"><alternatives><graphic xlink:href="pone.0138030.e041.jpg" id="pone.0138030.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, was non-uniform within the motif, reflecting precisely the sequence preferences for DNase I cleavage (<xref ref-type="supplementary-material" rid="pone.0138030.s005">S5 Fig</xref>). However, we also found that this improved background model resulted in only modest improvements in accuracy of identifying bound sites (<xref ref-type="supplementary-material" rid="pone.0138030.s004">S4 Fig</xref>). It is possible that accuracy could be further improved by explicitly modeling sequence-specific context effects in more detail than we have here, for example by relating cleavage rates at each location to the surrounding k-mers. However, our preliminary attempts to achieve this were unsuccessful (results not shown).</p>
      <p>Using transcription factor EBF1 as an example, <xref ref-type="fig" rid="pone.0138030.g003">Fig 3B</xref> illustrates that all three models have very similar true positive rates up to a false positive rate of 3–4%. However, incorporating the DNase cleavage profile substantially increased the true positive rate for false positive rates larger than 4%. This suggests that while modeling the total DNase read counts alone was sufficient to accurately identify bound PBS with highest total DNase-seq signal, incorporation of the DNase cleavage profile was necessary to identify bound PBS with moderate total DNase-seq signal. These PBS may be indicative of low occupancy sites where the binding of the transcription factor is in a less stable equilibrium and the factor is likely bound to the DNA at these PBS in a smaller fraction of the cells assayed.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Discussion</title>
    <p>We developed msCentipede, a hierarchical multi-scale model to accurately identify binding of a transcription factor using sequencing reads from DNase-seq or ATAC-seq assays and the sequence content of putative binding sites for that factor in the genome. While previous approaches like CENTIPEDE have successfully used the characteristic profile of DNA hypersensitivity to DNase I around bound motif instances to identify factor binding sites, the multinomial model used in CENTIPEDE ignores spatial structure in the data and makes a strong assumption on the heterogeneity in read distribution across bound sites in the genome. Moreover, when multiple replicate measurements are available, CENTIPEDE ignores heterogeneity across replicates. The hierarchical multi-scale model explicitly allows for heterogeneity in the read distribution across bound sites and across replicate measurements (with different amounts at different scales), resulting in a substantial increase in accuracy across a broad range of transcription factors. Finally, we explored the effects of sequence bias in DNase I on inference by using a simple, flexible background model that can exploit the availability of DNase-seq data assayed in naked DNA. This flexible background model has the potential to account for heterogeneity in background DNase I cleavage rate specific to the sequence context of motif instances of the transcription factor.</p>
    <p>A simple extension to CENTIPEDE that can account for heterogeneity across sites is to allow for site-specific parameters in the multinomial distribution and to model these site-specific parameters using a Dirichlet distribution. However, this multinomial-Dirichlet model is not sufficiently flexible to capture potential spatial structure in heterogeneity in DNase I cleavage, since it has only one additional parameter that captures variance. The proposed multi-scale model allows different amounts of variance across different scales, effectively capturing spatial structure in the heterogeneity. It is fairly straightforward to extend the proposed framework to model spatial structure in the mean cleavage pattern (<inline-formula id="pone.0138030.e042"><alternatives><graphic xlink:href="pone.0138030.e042.jpg" id="pone.0138030.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>) as usually modeled in multi-scale approaches [<xref rid="pone.0138030.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0138030.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0138030.ref013" ref-type="bibr">13</xref>]. However, we found that this extension was computationally expensive and gave very minor improvements in accuracy, presumably because there were so many motif instances that we could accurately estimate the mean pattern without spatial smoothing.</p>
    <p>When considering a flexible model at unbound motif instances which allows for spatial structure and heterogeneity in background DNase I cleavage patterns, it is natural to estimate the parameters of this model using data from the relevant cell type. However, we observed that when all the parameters in the flexible model are estimated using data from chromatin, the model tended to estimate smaller values for the precision parameter, <italic>τ</italic>, at bound sites resulting in a large number of ‘true’ unbound sites being incorrectly identified as bound. Currently, we suggest using the flexible model (msCentipede-flexbg) only when DNase-seq (or ATAC-seq) data assayed in naked DNA is available. However, a framework that allows estimation of heterogeneity in background DNase I cleavage from data assayed in the relevant cell type may be be more accurate.</p>
    <p>msCentipede-flexbg estimates spatial structure and heterogeneity in the background model using DNase-seq data from naked DNA at all motif instances; thus, the heterogeneity in background read distribution is primarily driven by variation in sequence context around motif instances. However, within a cell type, variation in background chromatin context at unbound sites (e.g., whether the motif instance is in the linker region or in DNA wrapped around a nucleosome, and which other transcription factors are bound at or close to the motif instance) is likely to be a larger source of heterogeneity in background read distribution than variation in sequence context. This intuition suggests that we should estimate the precision parameter at unbound sites <italic>τ</italic>
<sup><italic>o</italic></sup> using DNase-seq data from chromatin, rather than using DNase-seq data from naked DNA. However, using this approach, we observed the background precision parameter <italic>τ</italic>
<sup><italic>o</italic></sup> in msCentipede-flexbg was consistently underestimated when this parameter was estimated using data from chromatin, resulting in a high false positive rate. Extensions to these models that accurately capture the background heterogeneity in the data across genomic sites would be a useful avenue for future research.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec014">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0138030.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Accuracy of msCentipede, CENTIPEDE and PIQ using a gold standard identified using MACS.</title>
        <p>Each point corresponds to a different factor and accuracy is measured by area under the ROC curve. Blue points correpond to factors where msCentipede achieves higher accuracy than CENTIPEDE (top panels) or PIQ (bottom panels), and orange points correspond to a worse performance by msCentipede.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s001.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Accuracy of msCentipede and CENTIPEDE using ATAC-seq data and a gold standard identified using GEM.</title>
        <p>Blue points correpond to factors where msCentipede achieves higher accuracy than CENTIPEDE and orange points correspond to a worse performance by msCentipede.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s002.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Heterogeneity across different scales.</title>
        <p>A: A plot of the precision parameter <italic>τ</italic> as a function of the scale in the multi-scale model. Each gray line corresponds to a different transcription factor and the solid blue line shows the median trend across all factors. B: A plot of the relative change in AuROC as a function of the lower bound on the precision parameter <italic>τ</italic> for all scales. Each line corresponds to a transcription factor, and red lines correspond to factors where most lower bounds lead to a decrease in accuracy. Although the AuROC is fairly robust to the maximum allowed dispersion (minimum allowed precision), most factors show a modest decrease in accuracy for higher values of the lower bound.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Evaluating the effect of DNase I sequence bias.</title>
        <p>A: Comparing the accuracy of msCentipede and msCentipede-flexbg. Blue points correspond to factors where msCentipede-flexbg shows improved performance and orange points correspond to a worse performance by msCentipede-flexbg. The increase in accuracy for msCentipede-flexbg is relatively modest across a large number of transcription factors. B: Comparing the accuracy of msCentipede-flexbg with fixed zero-variance in the background model, and msCentipede-flexbg. Most of the improvement of msCentipede-flexbg over msCentipede arises from modeling variance in the background DNase I cleavage patterns.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s004.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Normalized DNase I cleavage profiles in chromatin and naked DNA, for a subset of transcription factors.</title>
        <p>The cleavage profiles for chromatin and naked DNA were computed from the maximum likelihood estimates of the parameters <inline-formula id="pone.0138030.e043"><alternatives><graphic xlink:href="pone.0138030.e043.jpg" id="pone.0138030.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0138030.e044"><alternatives><graphic xlink:href="pone.0138030.e044.jpg" id="pone.0138030.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>‾</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. For the sake of clarity, only the plus strand cleavage profile is shown. The dotted orange lines indicate the boundaries of the core motif.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s005.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Accuracy of msCentipede and CENTIPEDE at different sequencing depths.</title>
        <p>msCentipede achieves better (or similar) accuracies as CENTIPEDE for majority of the TFs in each of the replicates, indicating that the results hold across almost a 5-fold difference in coverage. Indeed, as the sequencing depth approaches 100 million reads, we observe the accuracy of CENTIPEDE and msCentipede to be highly concordant, while msCentipede achieves higher accuracies at sequencing depths closer to 10 million reads.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s006.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Accuracy of msCentipede, CENTIPEDE and PIQ on pooled replicates.</title>
        <p>Accuracy of msCentipede is similar to that of CENTIPEDE, and substantially better than that of PIQ, when applied to pooled replicate data. Note that msCentipede applied to pooled data achieves worse accuracy than when the replicates are treated as independent samples (despite the total sequencing depth being the same), since the variance across replicates is not properly accounted for when pooling replicate data sets.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s007.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s008">
      <label>S8 Fig</label>
      <caption>
        <title>True positive rate of msCentipede, CENTIPEDE and PIQ at 5% false positive rate.</title>
        <p>msCentipede achieves better (or similar) true positive rates compared to CENTIPEDE, and substantially higher true positive rates than PIQ. Multiple DNase replicates were used in this analysis, and msCentipede and PIQ were run in their multi-replicate modes.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0138030.s008.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s009">
      <label>S1 Methods</label>
      <caption>
        <title>Detailed description of the model.</title>
        <p>A detailed description of the model for msCentipede, along with the estimation and inference framework.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0138030.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s010">
      <label>S1 Table</label>
      <caption>
        <title>Accuracy when using one DNase-seq replicate.</title>
        <p>A list of the transcription factors, their PWM models and the AUC score achieved by the different algorithms listed in the main text, using only one DNase-seq data set. Factors for which PIQ achieves a higher accuracy than msCentipede are highlighted in red.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0138030.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0138030.s011">
      <label>S2 Table</label>
      <caption>
        <title>Accuracy when using multiple DNase-seq replicates.</title>
        <p>A list of the transcription factors, their PWM models and the AUC score achieved by the different algorithms listed in the main text, using both replicate DNase-seq data sets. Factors for which PIQ achieves a higher accuracy than msCentipede are highlighted in red.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0138030.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was funded by grants from the NIH (HG02585 to M.S., HG007036 to J.K.P., and MH084703 to Y.G. and J.K.P.), and by the Howard Hughes Medical Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0138030.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Boyle</surname><given-names>AP</given-names></name>, <name><surname>Davis</surname><given-names>S</given-names></name>, <name><surname>Shulha</surname><given-names>HP</given-names></name>, <name><surname>Meltzer</surname><given-names>P</given-names></name>, <name><surname>Margulies</surname><given-names>EH</given-names></name>, <name><surname>Weng</surname><given-names>Z</given-names></name>, <etal>et al</etal><article-title>High-resolution mapping and characterization of open chromatin across the genome</article-title>. <source>Cell</source>. <year>2008</year>;<volume>132</volume>(<issue>2</issue>):<fpage>311</fpage>–<lpage>322</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2007.12.014</pub-id><?supplied-pmid 18243105?><pub-id pub-id-type="pmid">18243105</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hesselberth</surname><given-names>JR</given-names></name>, <name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Sabo</surname><given-names>PJ</given-names></name>, <name><surname>Sandstrom</surname><given-names>R</given-names></name>, <name><surname>Reynolds</surname><given-names>AP</given-names></name>, <etal>et al</etal><article-title>Global mapping of protein-DNA interactions in vivo by digital genomic footprinting</article-title>. <source>Nature Methods</source>. <year>2009</year>;<volume>6</volume>:<fpage>283</fpage>–<lpage>289</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1313</pub-id><?supplied-pmid 19305407?><pub-id pub-id-type="pmid">19305407</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Pique-Regi</surname><given-names>R</given-names></name>, <name><surname>Degner</surname><given-names>JF</given-names></name>, <name><surname>Pai</surname><given-names>AA</given-names></name>, <name><surname>Gaffney</surname><given-names>DJ</given-names></name>, <name><surname>Gilad</surname><given-names>Y</given-names></name>, <name><surname>Pritchard</surname><given-names>JK</given-names></name>. <article-title>Accurate inference of transcription factor binding from DNA sequence and chromatin accessibility data</article-title>. <source>Genome Research</source>. <year>2011</year>;<volume>21</volume>:<fpage>447</fpage>–<lpage>455</lpage>. <pub-id pub-id-type="doi">10.1101/gr.112623.110</pub-id><?supplied-pmid 21106904?><pub-id pub-id-type="pmid">21106904</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Boyle</surname><given-names>AP</given-names></name>, <name><surname>Song</surname><given-names>L</given-names></name>, <name><surname>Lee</surname><given-names>BK</given-names></name>, <name><surname>London</surname><given-names>D</given-names></name>, <name><surname>Keefe</surname><given-names>D</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>High-resolution genome-wide in vivo footprinting of diverse transcription factors in human cells</article-title>. <source>Genome Research</source>. <year>2011</year>;<volume>21</volume>(<issue>3</issue>):<fpage>456</fpage>–<lpage>464</lpage>. <pub-id pub-id-type="doi">10.1101/gr.112656.110</pub-id><?supplied-pmid 21106903?><pub-id pub-id-type="pmid">21106903</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>K</given-names></name>, <name><surname>Hartemink</surname><given-names>AJ</given-names></name>. <article-title>Using DNase digestion data to accurately identify transcription factor binding sites</article-title>. <source>Pacific Symposium on Biocomputing</source>. <year>2013</year>;p. <fpage>80</fpage>–<lpage>91</lpage>.
<?supplied-pmid 23424114?><pub-id pub-id-type="pmid">23424114</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref006">
      <label>6</label>
      <mixed-citation publication-type="other">Piper J, Elze MC, Cauchy P, Cockerill PN, Bonifer C, Ott S. Wellington: a novel method for the accurate identification of digital genomic footprints from DNase-seq data. Nucleic Acids Research. 2013;.</mixed-citation>
    </ref>
    <ref id="pone.0138030.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Sherwood</surname><given-names>RI</given-names></name>, <name><surname>Hashimoto</surname><given-names>T</given-names></name>, <name><surname>O’Donnell</surname><given-names>CW</given-names></name>, <name><surname>Lewis</surname><given-names>S</given-names></name>, <name><surname>Barkal</surname><given-names>AA</given-names></name>, <name><surname>van Hoff</surname><given-names>JP</given-names></name>, <etal>et al</etal><article-title>Discovery of directional and nondirectional pioneer transcription factors by modeling DNase profile magnitude and shape</article-title>. <source>Nature Biotechnology</source>. <year>2014</year>;<volume>32</volume>:<fpage>171</fpage>–<lpage>178</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2798</pub-id><?supplied-pmid 24441470?><pub-id pub-id-type="pmid">24441470</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Thurman</surname><given-names>RE</given-names></name>, <name><surname>Rynes</surname><given-names>E</given-names></name>, <name><surname>Humbert</surname><given-names>R</given-names></name>, <name><surname>Vierstra</surname><given-names>J</given-names></name>, <name><surname>Maurano</surname><given-names>MT</given-names></name>, <name><surname>Haugen</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>:<fpage>75</fpage>–<lpage>82</lpage>. <pub-id pub-id-type="doi">10.1038/nature11232</pub-id><?supplied-pmid 22955617?><pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Shim</surname><given-names>H</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>. <article-title>Wavelet-based genetic association analysis of functional phenotypes arising from high-throughput sequencing assays</article-title>. <source>The Annals of Applied Statistics</source>. <year>2015</year><month>6</month>;<volume>9</volume>(<issue>2</issue>):<fpage>665</fpage>–<lpage>686</lpage>. <pub-id pub-id-type="doi">10.1214/14-AOAS776</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref010">
      <label>10</label>
      <mixed-citation publication-type="other">Shim H, Xing Z, Pantaleo E, Stephens M. Bayesian multi-scale models for detecting differences in high-throughput sequencing data between multiple groups and their applications in small sample sizes. In prep. 2015;.</mixed-citation>
    </ref>
    <ref id="pone.0138030.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Kolaczyk</surname><given-names>ED</given-names></name>. <article-title>Bayesian multiscale models for Poisson processes</article-title>. <source>Journal of the American Statistical Association</source>. <year>1999</year><month>9</month>;<volume>94</volume>(<issue>447</issue>):<fpage>920</fpage>–<lpage>933</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1999.10474197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Timmermann</surname><given-names>KE</given-names></name>, <name><surname>Nowak</surname><given-names>RD</given-names></name>. <article-title>Multiscale modeling and estimation of Poisson processes with application to photon-limited imaging</article-title>. <source>IEEE Transactions on Information Theory</source>. <year>1999</year><month>4</month>;<volume>45</volume>(<issue>3</issue>):<fpage>846</fpage>–<lpage>862</lpage>. <pub-id pub-id-type="doi">10.1109/18.761328</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Donoho</surname><given-names>DL</given-names></name>, <name><surname>Johnstone</surname><given-names>IM</given-names></name>. <article-title>Adapting to unknown smoothness via wavelet shrinkage</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year><month>12</month>;<volume>90</volume>(<issue>432</issue>):<fpage>1200</fpage>–<lpage>1224</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1995.10476626</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Koohy</surname><given-names>H</given-names></name>, <name><surname>Down</surname><given-names>TA</given-names></name>, <name><surname>Hubbard</surname><given-names>TJ</given-names></name>. <article-title>Chromatin accessibility data sets show bias due to sequence specificity of the DNase I enzyme</article-title>. <source>PLoS ONE</source>. <year>2013</year><month>7</month>;<volume>8</volume>(<issue>7</issue>):<fpage>e69853</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0069853</pub-id><?supplied-pmid 23922824?><pub-id pub-id-type="pmid">23922824</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Lazarovici</surname><given-names>A</given-names></name>, <name><surname>Zhou</surname><given-names>T</given-names></name>, <name><surname>Shafer</surname><given-names>A</given-names></name>, <name><surname>Dantas Machado</surname><given-names>AC</given-names></name>, <name><surname>Riley</surname><given-names>TR</given-names></name>, <name><surname>Sandstrom</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Probing DNA shape and methylation state on a genomic scale with DNase I</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>16</issue>):<fpage>6376</fpage>–<lpage>6381</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1216822110</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>HH</given-names></name>, <name><surname>Meyer</surname><given-names>CA</given-names></name>, <name><surname>Hu</surname><given-names>SS</given-names></name>, <name><surname>Chen</surname><given-names>MW</given-names></name>, <name><surname>Zang</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Refined DNase-seq protocol and data analysis reveals intrinsic bias in transcription factor footprint identification</article-title>. <source>Nature Methods</source>. <year>2014</year>;p. <fpage>73</fpage>–<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2762</pub-id><?supplied-pmid 24317252?><pub-id pub-id-type="pmid">24317252</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Varadhan</surname><given-names>R</given-names></name>, <name><surname>Roland</surname><given-names>C</given-names></name>. <article-title>Simple and globally convergent methods for accelerating the convergence of any EM algorithm</article-title>. <source>Scandinavian Journal of Statistics</source>. <year>2008</year>;<volume>35</volume>(<issue>2</issue>):<fpage>335</fpage>–<lpage>353</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9469.2007.00585.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><name><surname>Beal</surname><given-names>MJ</given-names></name>. <chapter-title>Variational Algorithms for Approximate Bayesian Inference</chapter-title><source>Gatsby Computational Neuroscience Unit</source>, <publisher-name>University College London</publisher-name>; <year>2003</year>.</mixed-citation>
    </ref>
    <ref id="pone.0138030.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Buenrostro</surname><given-names>JD</given-names></name>, <name><surname>Giresi</surname><given-names>PG</given-names></name>, <name><surname>Zaba</surname><given-names>LC</given-names></name>, <name><surname>Chang</surname><given-names>HY</given-names></name>, <name><surname>Greenleaf</surname><given-names>WJ</given-names></name>. <article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>. <source>Nature Methods</source>. <year>2013</year>;<volume>10</volume>:<fpage>1213</fpage>–<lpage>1218</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2688</pub-id><?supplied-pmid 24097267?><pub-id pub-id-type="pmid">24097267</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Yip</surname><given-names>KY</given-names></name>, <name><surname>Cheng</surname><given-names>C</given-names></name>, <name><surname>Bhardwaj</surname><given-names>N</given-names></name>, <name><surname>Brown</surname><given-names>JB</given-names></name>, <name><surname>Leng</surname><given-names>J</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Classification of human genomic regions based on experimentally determined binding sites of more than 100 transcription-related factors</article-title>. <source>Genome Biology</source>. <year>2012</year>;<volume>13</volume>:<fpage>R48</fpage><pub-id pub-id-type="doi">10.1186/gb-2012-13-9-r48</pub-id><?supplied-pmid 22950945?><pub-id pub-id-type="pmid">22950945</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jolma</surname><given-names>A</given-names></name>, <name><surname>Kivioja</surname><given-names>T</given-names></name>, <name><surname>Toivonen</surname><given-names>J</given-names></name>, <name><surname>Cheng</surname><given-names>L</given-names></name>, <name><surname>Wei</surname><given-names>G</given-names></name>, <name><surname>Enge</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Multiplexed massively parallel SELEX for characterization of human transcription factor binding specificities</article-title>. <source>Genome Research</source>. <year>2010</year>;<volume>20</volume>(<issue>6</issue>):<fpage>861</fpage>–<lpage>873</lpage>. <pub-id pub-id-type="doi">10.1101/gr.100552.109</pub-id><?supplied-pmid 20378718?><pub-id pub-id-type="pmid">20378718</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Jolma</surname><given-names>A</given-names></name>, <name><surname>Yan</surname><given-names>J</given-names></name>, <name><surname>Whitington</surname><given-names>T</given-names></name>, <name><surname>Toivonen</surname><given-names>J</given-names></name>, <name><surname>Nitta</surname><given-names>K</given-names></name>, <name><surname>Rastas</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>DNA-binding specificities of human transcription factors</article-title>. <source>Cell</source>. <year>2013</year>;<volume>152</volume>(<issue>1-2</issue>):<fpage>327</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2012.12.009</pub-id><?supplied-pmid 23332764?><pub-id pub-id-type="pmid">23332764</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Meyer</surname><given-names>CA</given-names></name>, <name><surname>Eeckhoute</surname><given-names>J</given-names></name>, <name><surname>Johnson</surname><given-names>DS</given-names></name>, <name><surname>Bernstein</surname><given-names>BE</given-names></name>, <etal>et al</etal><article-title>Model-based analysis of ChIP-seq</article-title>. <source>Genome Biology</source>. <year>2008</year>;<volume>9</volume>:<fpage>R137</fpage><pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id><?supplied-pmid 18798982?><pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>Y</given-names></name>, <name><surname>Mahony</surname><given-names>S</given-names></name>, <name><surname>Gifford</surname><given-names>DK</given-names></name>. <article-title>High resolution genome wide binding event finding and motif discovery reveals transcription factor spatial binding constraints</article-title>. <source>PLoS Computational Biology</source>. <year>2012</year>;p. <fpage>e1002638</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002638</pub-id><?supplied-pmid 22912568?><pub-id pub-id-type="pmid">22912568</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0138030.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Sung</surname><given-names>MH</given-names></name>, <name><surname>Guertin</surname><given-names>MJ</given-names></name>, <name><surname>Baek</surname><given-names>S</given-names></name>, <name><surname>Hager</surname><given-names>GL</given-names></name>. <article-title>DNase footprint signatures are dictated by factor dynamics and DNA sequence</article-title>. <source>Molecular Cell</source>. <year>2014</year>;<volume>56</volume>:<fpage>275</fpage>–<lpage>285</lpage>. <pub-id pub-id-type="doi">10.1016/j.molcel.2014.08.016</pub-id><?supplied-pmid 25242143?><pub-id pub-id-type="pmid">25242143</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
