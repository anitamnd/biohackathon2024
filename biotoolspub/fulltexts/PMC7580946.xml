<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7580946</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0227659</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-35325</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Chromatographic Techniques</subject>
          <subj-group>
            <subject>Liquid Chromatography</subject>
            <subj-group>
              <subject>Liquid Chromatography-Mass Spectrometry</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Analytical Chemistry</subject>
            <subj-group>
              <subject>Mass Spectrometry</subject>
              <subj-group>
                <subject>Liquid Chromatography-Mass Spectrometry</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Spectrum Analysis Techniques</subject>
          <subj-group>
            <subject>Mass Spectrometry</subject>
            <subj-group>
              <subject>Liquid Chromatography-Mass Spectrometry</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Optimization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Kalman Filter</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Kalman Filter</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Acquisition</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Signal Processing</subject>
          <subj-group>
            <subject>Signal Filtering</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>XFlow: An algorithm for extracting ion chromatograms</article-title>
      <alt-title alt-title-type="running-head">XFlow: An algorithm for extracting ion chromatograms</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Gutierrez</surname>
          <given-names>Mathew</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1864-9110</contrib-id>
        <name>
          <surname>Smith</surname>
          <given-names>Rob</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Computer Science, University of Montana, Missoula, MT, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Jacobs</surname>
          <given-names>Jon M.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Pacific Northwest National Laboratory, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>robert.smith@mso.umt.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>10</issue>
    <elocation-id>e0227659</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Gutierrez, Smith</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Gutierrez, Smith</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0227659.pdf"/>
    <abstract>
      <p>Mass spectrometry is a fundamental tool for modern proteomics. The increasing availability of mass spectrometry data paired with the increasing sensitivity and fidelity of the instruments necessitates new and more potent analytical methods. To that end, we have created and present XFlow, a feature detection algorithm for extracting ion chromatograms from MS1 LC-MS data. XFlow is a parameter-free procedurally agnostic feature detection algorithm that utilizes the latent properties of ion chromatograms to resolve them from the surrounding noise present in MS1 data. XFlow is designed to function on either profile or centroided data across different resolutions and instruments. This broad applicability lends XFlow strong utility as a one-size-fits-all method for MS1 analysis or target acquisition for MS2. XFlow is written in Java and packaged with JS-MS, an open-source mass spectrometry analysis toolkit.</p>
    </abstract>
    <funding-group>
      <funding-statement>This research was supported by NSF grant number 366208 to R.S. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="17"/>
      <table-count count="0"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>XFlow and additional information is available at <ext-link ext-link-type="uri" xlink:href="http://github.com/optimusmoose/jsms">github.com/optimusmoose/jsms</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>XFlow and additional information is available at <ext-link ext-link-type="uri" xlink:href="http://github.com/optimusmoose/jsms">github.com/optimusmoose/jsms</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Mass spectrometry is a popular approach for measuring the sample-bound content and quantity of a variety of classes of molecules across a broad range of applications including pharmaceuticals, forensics, biochemistry, and food science. All applications of mass spectrometry have a common problem: the instrument itself does not directly provide measurements of molecules nor their identities, but rather produces raw data that must be rendered human-interpretable through the application of data processing algorithms.</p>
    <p>According to community perceptions, advancements in software have lagged behind the steady pace of instrumentation advancements [<xref rid="pone.0227659.ref001" ref-type="bibr">1</xref>]. Unlike other computational science fields (such as genomics) where several foundational computational problems are regarded as solved, most mass spectrometry users feel that significant problems in computational mass spectrometry remain unsolved [<xref rid="pone.0227659.ref001" ref-type="bibr">1</xref>] despite (in some cases) dozens of published algorithms designed to address them [<xref rid="pone.0227659.ref002" ref-type="bibr">2</xref>]. Beyond user sentiment, the experimental influence of algorithm selection suggests that the analysis and advancement of computational mass spectrometry algorithms is a valuable pursuit [<xref rid="pone.0227659.ref003" ref-type="bibr">3</xref>].</p>
    <p>Mass spectrometry systems generate datasets that quantify counts of charged particles at specific mass-to-charge (m/z) values. In liquid chromatography-mass spectrometry (LC-MS) systems, these measurements are taken over the time (retention time or RT) required for the molecules to elute from a chromatography column designed to slow or speed the migration of the molecules depending on particular physico-chemical properties such as size, or polarity.</p>
    <p>Mapping the raw LC-MS data points to particular classes of molecule (say, a particular peptide at a particular charge state) provides both an accurate count of the relative abundance of that molecule class (through integrating the intensities in those points) and discriminatory information about the identity of the molecule(s), as the charge state and uncharged mass can be derived through the m/z gap present between isotopic-specific sub-signals (extracted ion chromatograms or XICs) in the signal (see <xref ref-type="fig" rid="pone.0227659.g001">Fig 1</xref>).</p>
    <fig id="pone.0227659.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>3d Isotopic envelope.</title>
        <p>In this figure are five extracted ion chromatograms (XIC) bounded by yellow rectangles. Each XIC is composed of points, each with m/z, RT and intensity (denoted by color and height on z axis). Each XIC is the evidence of an isotope of a molecule or molecules. The group of five XICs is referred to as an isotopic envelope, or feature, seen bounded by the red rectangle.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g001"/>
    </fig>
    <p>Some existing algorithms attempt to resolve the features directly from the point data (e.g. OpenMS FFC [<xref rid="pone.0227659.ref004" ref-type="bibr">4</xref>]). Other algorithms split this process into two steps. First, two step algorithms cluster points into XICs, sometimes called isotopic traces (or features [<xref rid="pone.0227659.ref005" ref-type="bibr">5</xref>]) Second, by clustering XICs into isotopic envelopes (sometimes also called features [<xref rid="pone.0227659.ref006" ref-type="bibr">6</xref>]) (see <xref ref-type="fig" rid="pone.0227659.g001">Fig 1</xref>). This two-stage approach maximizes the utilization of available information and serves to reduce the amount of data by allowing a summary of each XIC to be used to find isotopic envelopes instead of cumbersome point data.</p>
    <p>This manuscript presents <italic>XFlow</italic>, a novel algorithm for extracting ion chromatograms from LC-MS data. XFlow outperforms existing XIC algorithms evaluated recently on a benchmark human-curated dataset and provides qualitative evidence in support of high-function on alternative datasets. The output of XFlow can be used in conjunction with the XIC clustering algorithm Xnet [<xref rid="pone.0227659.ref007" ref-type="bibr">7</xref>] to map raw data points from an LC-MS run into the signal groups necessary for further analysis (see <xref ref-type="fig" rid="pone.0227659.g002">Fig 2</xref>).</p>
    <fig id="pone.0227659.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Ion chromatogram extraction in context.</title>
        <p>Like several other ion chromatogram extraction algorithms, XFlow forms one step in a two-step process where ion chromatograms (blue, red, green) are extracted from raw data. In the example workflow provided for the software JS-MS [<xref rid="pone.0227659.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0227659.ref009" ref-type="bibr">9</xref>], the XICs are then combined into isotopic envelopes (purple).</p>
      </caption>
      <graphic xlink:href="pone.0227659.g002"/>
    </fig>
    <p>A recent XIC benchmark study [<xref rid="pone.0227659.ref010" ref-type="bibr">10</xref>] noted that Massifquant [<xref rid="pone.0227659.ref011" ref-type="bibr">11</xref>], a Kalman filter-based XIC algorithm, performed well against other popular algorithms on a large set of hand-annotated XICs. Massifquant uses a Kalman filter to model XICs as time-series events where the probability of membership of a proximate point in the next scan is a factor of the m/z of previous points in the putative XIC. Massifquant has several drawbacks. It has a very large possible parameter space, takes considerable time to run, and lacks an objective or automatic approach to optimize parameters. Still, it outperformed all other evaluated algorithms on a large human-curated dataset.</p>
    <p>Perhaps the principle theoretical advantage of Massifquant is that it attempts to assemble point membership in XICs as a function of the probability of a given point being a member of a given proto-XIC. Unfortunately, Massifquant uses Kalman filters—which require many expensive calculations), suffers from many parameters, and constructs XICs in decreasing time order which can lead to incorrect XICs.</p>
    <p>Several algorithms have been published that avoid the theoretical and computational limitations of Massifquant by leveraging intensity order to iteratively construct XICs (for example, FFC [<xref rid="pone.0227659.ref004" ref-type="bibr">4</xref>], KPIC2 [<xref rid="pone.0227659.ref005" ref-type="bibr">5</xref>], and Agilent Profinder).</p>
    <p>The core idea of intensity order XIC algorithms is the hypothesis that the most intense points in a mass spectrometry run also have the most accurate m/z measurement. Therefore, intensity of a point can be used as a surrogate for confidence. These algorithms incrementally adding points from surrounding windows to putative features seeded with a point of locally maximal intensity, earning the nickname of “waterfall” methods. Other algorithms use less rich sources of information. Shape filters (for example, matchedFilter [<xref rid="pone.0227659.ref012" ref-type="bibr">12</xref>] and centWave [<xref rid="pone.0227659.ref013" ref-type="bibr">13</xref>]) tend to degrade at lower intensities and are expensive to optimize for each signal in a run. Massifquant [<xref rid="pone.0227659.ref011" ref-type="bibr">11</xref>] and MaxQuant [<xref rid="pone.0227659.ref014" ref-type="bibr">14</xref>] both build XICs scan by scan, though in reverse order. Due to the Gaussian shape of XICs, this guarantees that the least confident information is the most relied upon in both of these algorithms, ensuring suboptimal performance.</p>
    <p>Like other intensity order algorithms, XFlow avoids the drawbacks of relying on specific shapes or expensive models. Unlike other intensity order algorithms, XFlow takes the intensity-confidence hypothesis a step further. Instead of processing local windows through “walking” through time on each side of an XIC’s intensity apex or extracting an XIC in a region of interest around a high intensity local maxima, XFlow processes each point in decreasing order without simplifying heuristics and post-processing. In other words, for each point in the run, XFlow will either add it to an already existing putative feature, or create a new putative feature seeded with the current point, in decreasing order of intensity. In addition to achieving single-pass efficiency, XFlow’s strategy avoids the post-processing step necessary for local-neighborhood algorithms that can’t distinguish between overlapping features on their own. XFlow also avoids the drawback of reliance on user parameters, which, as we will show, is a significant concern for other algorithms due to the effect parameter selection can have.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>XFlow casts ion chromatogram extraction as a clustering problem, where points are clustered into XICs (see <xref ref-type="fig" rid="pone.0227659.g002">Fig 2</xref>).</p>
    <sec id="sec003">
      <title>Baseline correction</title>
      <p>XFlow uses a baseline filter for both: 1) determining the subset of points that will be clustered into XICs and 2) determining whether a point is allowed to seed a putative XIC. The justification for this thresholding is two part. The primary consideration of thresholding is to limit the admission of noise into the final output, while the secondary consideration is to reduce the computational burden to only the relevant subset of the data.</p>
      <p>XFlow automatically calculates the baseline threshold from the data by calculating the average intensity of all points in the run, on the assumption that most points in the run will be very low intensity. All points below the baseline are excluded from XIC consideration, and only points with intensity at least twice the baseline are allowed to seed new putative XICs. The study of when and where to apply intensity thresholding is an active and ongoing topic of research in our lab due to the difficulty of avoiding bias, limiting noise inclusion, and maximizing signal inclusion [<xref rid="pone.0227659.ref015" ref-type="bibr">15</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>XIC construction</title>
      <p>Let (<bold>P</bold>) be the set of all points (p<sub>i</sub>) in a run with intensity equal to or greater than baseline. Let <bold>W</bold> represent the set of points that are plausible members of the same XIC as a given p<sub>i</sub> such that the intensity of the point is less than p<sub>i</sub>’s intensity. In theory, <bold>W</bold> could be the entire run. In practice, and in the implementation of XFlow provided, the m/z width of two times the automatically-calculated resolution estimate (explained below) and the RT width of two times the sampling rate are sufficient to generate good results.</p>
      <p>For each p<sub>i</sub> in decreasing intensity order down to twice the baseline, each point w<sub>j</sub> in <bold>W</bold> is sorted by decreasing distance. Until the intensity of p<sub>i</sub> is exhausted, each w<sub>j</sub> is linked to p<sub>i</sub> with the difference between p<sub>i</sub> and w<sub>j</sub> scaled by their distance, and this value is subtracted from p<sub>i</sub>’s intensity (see <xref ref-type="disp-formula" rid="pone.0227659.e001">Eq 1</xref>).</p>
      <disp-formula id="pone.0227659.e001">
        <alternatives>
          <graphic xlink:href="pone.0227659.e001.jpg" id="pone.0227659.e001g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M1">
            <mml:mi>i</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mi>e</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>s</mml:mi>
            <mml:mi>i</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mi>y</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>i</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mi>e</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>s</mml:mi>
            <mml:mi>i</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mi>y</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mo>|</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>y</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>*</mml:mo>
              <mml:mi>d</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>s</mml:mi>
              <mml:mi>t</mml:mi>
              <mml:mi>a</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mi>c</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>|</mml:mo>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(1)</label>
      </disp-formula>
      <p>Using intensity as a surrogate for likelihood of XIC membership, we estimate confidence of any link as a function of the difference of p<sub>i</sub>‘s intensity before and after linking the point divided by its intensity before linking (see <xref ref-type="disp-formula" rid="pone.0227659.e002">Eq 2</xref>). A high confidence point is one that is near in space, and similar in intensity.</p>
      <disp-formula id="pone.0227659.e002">
        <alternatives>
          <graphic xlink:href="pone.0227659.e002.jpg" id="pone.0227659.e002g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M2">
            <mml:mi>c</mml:mi>
            <mml:mi>o</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>f</mml:mi>
            <mml:mi>i</mml:mi>
            <mml:mi>d</mml:mi>
            <mml:mi>e</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>c</mml:mi>
            <mml:mi>e</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>y</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
                <mml:mo>−</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>y</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>y</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfrac>
          </mml:math>
        </alternatives>
        <label>(2)</label>
      </disp-formula>
      <p>This value is stored such that each link in question has an associated confidence that is a function of the nearness in both intensity and Euclidean distance (given that the difference is scaled by their distance) (see <xref ref-type="fig" rid="pone.0227659.g003">Fig 3</xref>).</p>
      <fig id="pone.0227659.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>XFlow link progression.</title>
          <p>This figure details the linking process (lines) and associated confidence (color) of XFlow in a sequence of images with MZ and RT axis. Beginning with a completely unlinked region (1) XFlow links the highest intensity point to all nearby points (2). Linking continues in (3) and (4) as XFlow progressively considers lower and lower intensity points, creating links of varying confidence. Though this figure is just focusing on one XIC, the entire file is progressing in the same way simultaneously.</p>
        </caption>
        <graphic xlink:href="pone.0227659.g003"/>
      </fig>
      <p>After links and confidence for those links are calculated for all (p<sub>i</sub>), XICs are extracted such that the points in each cluster consist of the highest confidence links when alternatives exist. Putative XICs are required to contain more than 5 points for centroided data and more than 15 points for profile data.</p>
    </sec>
    <sec id="sec005">
      <title>No parameters</title>
      <p>Unlike any published XIC algorithm, XFlow is also parameter-free. Unlike most XIC algorithms, XFlow is designed to be agnostic to instrument and to whether the data is centroided or profile. XFlow self-calibrates based on three parameters automatically derived from each run: resolution, sampling rate, and noise baseline. The baseline calculation is described above. The resolution is automatically estimated using the minimum m/z separation between any two points belonging to the same scan. The sampling rate is estimated by calculating the minimum RT separation between two consecutive scans.</p>
    </sec>
    <sec id="sec006">
      <title>Evaluation</title>
      <p>Algorithmic performance is evaluated on a hand-annotated dataset [<xref rid="pone.0227659.ref016" ref-type="bibr">16</xref>] from a recent study that presented over 57,000 XICs from a public LC-MS dataset [<xref rid="pone.0227659.ref017" ref-type="bibr">17</xref>] (UPS2). XFlow was compared to the algorithms centWave [<xref rid="pone.0227659.ref013" ref-type="bibr">13</xref>], matchedFilter [<xref rid="pone.0227659.ref012" ref-type="bibr">12</xref>], and MZMine2 [<xref rid="pone.0227659.ref018" ref-type="bibr">18</xref>], selected for comparison as equivalent open source algorithms. Accurate evaluation with respect to the hand annotated dataset required point by point comparison. For the chosen algorithms, point data was recovered using the window output that each provided.</p>
      <p>For an XIC to be considered appropriately extracted, it must be matched to a corresponding hand annotated XIC. For the purposes of determining matches, we will refer to the set of points constituting an XIC produced by the software as <bold>A</bold> while the set of points constituting an XIC produced by hand annotation will be <bold>H</bold>. For an XIC to be considered correctly recovered, the sum of the intensity of the intersection of points between <bold>A</bold> and <bold>H</bold> must constitute greater than fifty percent of the sum of the intensity of the points in the hand annotated XIC (<bold>H</bold>). This fraction of shared intensity will be referred to as <italic>S</italic> (<xref ref-type="disp-formula" rid="pone.0227659.e003">Eq 3</xref>).</p>
      <disp-formula id="pone.0227659.e003">
        <alternatives>
          <graphic xlink:href="pone.0227659.e003.jpg" id="pone.0227659.e003g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M3">
            <mml:mi>S</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>y</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">⋂</mml:mo>
                      <mml:mrow>
                        <mml:mi>H</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>y</mml:mi>
                    <mml:mo>(</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>H</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfrac>
          </mml:math>
        </alternatives>
        <label>(3)</label>
      </disp-formula>
    </sec>
  </sec>
  <sec sec-type="results" id="sec007">
    <title>Results</title>
    <p>Peak deconvolution, a problem generally thought of as difficult, is handled simply and intrinsically by XFlow’s intensity-first approach. This process is demonstrated in <xref ref-type="fig" rid="pone.0227659.g004">Fig 4</xref> in a mockup of a bi-modal XIC with several steps between initial consideration and completion of linking.</p>
    <fig id="pone.0227659.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>XFlow intrinsic deconvolution.</title>
        <p>This figure demonstrates the latent capacity for XFlow to deconvolve overlapping signals. Observe Subplot 1, XFlow has just begun linking points in intensity order, shown by the colored points. Next in subplot 2, XFlow has begin linking progressively less intense points to the higher intensity points. In subplot 3, XFlow links all points in the valley between two peaks, and all points are linked to one or the other growing XIC. In subplot 4, XFlow continues linking lower intensity peaks on either side of the bi-modal peak, adding points to each growing XIC respectively. Again note that while the figure is focusing on one XIC, in reality the entire file proceeds in this manner simultaneously.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g004"/>
    </fig>
    <p>We compared XFlow to several popular publicly available and functionally equivalent algorithms. For the purposes of this evaluation, algorithms were selected based on the similarity of the intended task (MaxQuant [<xref rid="pone.0227659.ref014" ref-type="bibr">14</xref>] and FFC [<xref rid="pone.0227659.ref004" ref-type="bibr">4</xref>], for example, do not stop at XIC extraction, but exports entire envelopes) and were limited according to previously published performance (KPIC2 [<xref rid="pone.0227659.ref005" ref-type="bibr">5</xref>], for example, was shown to perform comparably or worse than GridMass [<xref rid="pone.0227659.ref018" ref-type="bibr">18</xref>]). XCMS’s centWave [<xref rid="pone.0227659.ref013" ref-type="bibr">13</xref>] and matchedFilter [<xref rid="pone.0227659.ref012" ref-type="bibr">12</xref>] algorithms (optimized using Isotopologue Parameter Optimization [<xref rid="pone.0227659.ref019" ref-type="bibr">19</xref>]) and GridMass (optimized by employing grid search of parameters). Due to the difficulty of obtaining verified XIC datasets, quantitative validation of algorithmic results for XFlow, centWave, matchedFilter and GridMass are limited to the UPS2 dataset, the only dataset with hand annotated XICs. Five other reference or standard datasets were selected from the PRIDE repository: PXD000790, PXD000792, PXD003236, PXD008952, PXD011194. These additional files were selected in order to provide qualitative information. The RAW files were processed using ProteoWizard’s msConvert [<xref rid="pone.0227659.ref020" ref-type="bibr">20</xref>] (Version: 3.0.19277-b582d79cd) to create centroided and profile.mzml files using vendor centroiding algorithm for a total of 10 qualitative test files (5 profile, 5 centroided) The percent recall of each algorithm on the hand annotated dataset can be seen in <xref ref-type="fig" rid="pone.0227659.g005">Fig 5</xref>.</p>
    <fig id="pone.0227659.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Percent recall of hand annotated XICs.</title>
        <p>Percentage of XICs shared between hand annotated dataset, and from the set of XICs output by each algorithm recovered from the UPS2 dataset. Note the disparity between algorithms with XFlow recovering the most with just over 70%, and matched filter recovering just over 15%.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g005"/>
    </fig>
    <p>The hand-annotated dataset contains many accurate XICs, but is not a complete set of all XICs in the file. Without confidence in the existence of a complete set, there is no verifiable way to determine existence of false positives. Therefore, the best measure of false positives is given by <xref ref-type="fig" rid="pone.0227659.g005">Fig 5</xref>.</p>
    <p>In addition to evaluating the performance of these algorithms quantitively we can analyze the output with a human eye. The characteristics of a high quality XIC are contiguity along retention time (RT), narrow span along the m/z axis, and a unimodal distribution of intensity along the RT axis. Example XICs from each algorithm on the UPS2 data are shown in Figs <xref ref-type="fig" rid="pone.0227659.g006">6</xref>–<xref ref-type="fig" rid="pone.0227659.g009">9</xref>.</p>
    <fig id="pone.0227659.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>XFlow results.</title>
        <p>Selected result of XFlow on the hand annotated data in top-down, 3d and spectral views. All XICs in window are fully formed, and the extent of the XICs in the RT dimension are captured. Note the correctly distinguished bi-modal or tri-modal peaks in the spectral view.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g006"/>
    </fig>
    <fig id="pone.0227659.g007" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g007</object-id>
      <label>Fig 7</label>
      <caption>
        <title>GridMass results.</title>
        <p>Selected result of GridMass on the hand annotated data in top-down 3d and spectral views. Most XICS in window are fully formed, and XICs extend in the RT dimension to their full extent. GridMass was also able to correctly distinguish bi-modal peaks after parameter optimization.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g007"/>
    </fig>
    <fig id="pone.0227659.g008" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g008</object-id>
      <label>Fig 8</label>
      <caption>
        <title>matchedFilter results.</title>
        <p>Selected result of matchedFilter on the hand-annotated data in top-down, 3d and spectral views. One XIC in the center has been completely skipped. Several XICs extend too far in the m/z dimension. XICs do not extend fully in the RT dimension.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g008"/>
    </fig>
    <fig id="pone.0227659.g009" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g009</object-id>
      <label>Fig 9</label>
      <caption>
        <title>centWave results.</title>
        <p>Result example of centWave in top-down, 3d and spectral views. One XIC in the center has been completely skipped. Some XICs extend too far in the m/z dimension as before with matchedFilter. XICs also do not fully extend in RT dimension.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g009"/>
    </fig>
    <p>The number of XICs recovered from alternative datasets for both centroid and profile data can be observed in Figs <xref ref-type="fig" rid="pone.0227659.g010">10</xref> and <xref ref-type="fig" rid="pone.0227659.g011">11</xref>.</p>
    <fig id="pone.0227659.g010" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g010</object-id>
      <label>Fig 10</label>
      <caption>
        <title>Total number of XICs for each centroid file.</title>
        <p>The number of XICs reported by each algorithm for each centroided dataset. Note the much larger set of XICs returned from XFlow for the UPS2 data set in comparison to other algorithms, and other files.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g010"/>
    </fig>
    <fig id="pone.0227659.g011" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g011</object-id>
      <label>Fig 11</label>
      <caption>
        <title>Total number of XICs for each profile file.</title>
        <p>The number of XICs reported by each algorithm for each profile dataset. Note some disparity among GridMass and XFlow between centroid (<xref ref-type="fig" rid="pone.0227659.g010">Fig 10</xref>) and profile datasets. Disparity between profile and centroid, while expected, is not desirable. Ideally, the centroid and profile datasets will have the exact same number of signals as they come from the same source. XCMS’s matchedFilter and centWave excelled at recovering the similar numbers of XICs from profile and centroided versions of the datasets. The effect of centroiding and quantifying the related loss of information during the process is an ongoing area of research in our lab.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g011"/>
    </fig>
    <p>XCMS’ matchedFilter and centWave performed similarly in relation to each other. This is likely due to the common origin of the algorithms, and IPO’s optimization strategy. CentWave and matchedFilter also had the most similar results between centroid and profile data (Figs <xref ref-type="fig" rid="pone.0227659.g009">9</xref> and <xref ref-type="fig" rid="pone.0227659.g010">10</xref>), also likely attributable to IPOs parameter optimization strategy. The downside of employing IPO is its very lengthy runtime. Further, while centWave and matchedFilter had a very high percentage of detected XICs matched to hand annotated XICs, the overall number of the hand annotated XICs they recovered is far fewer than XFlow or GridMass, qualitatively suggesting that they fail to recover lower intensity signals, an observation that can be verified by analyzing images from PXD011194 dataset to provide qualitative evaluation and comparison between algorithms tested. (See Figs <xref ref-type="fig" rid="pone.0227659.g012">12</xref>–<xref ref-type="fig" rid="pone.0227659.g015">15</xref>).</p>
    <fig id="pone.0227659.g012" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g012</object-id>
      <label>Fig 12</label>
      <caption>
        <title>XFlow qualitative results.</title>
        <p>XFlow wide scale (left) and XFlow feature scale (right). It is clear that XFlow has self-adjusted the intensity slightly too high, and as a result is missing clearly present XICS (left). Further, XICs are well formed, and fully extended, having captured all relevant points.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g012"/>
    </fig>
    <fig id="pone.0227659.g013" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g013</object-id>
      <label>Fig 13</label>
      <caption>
        <title>GridMass qualitative results.</title>
        <p>Feature view (left) and wide view (right). GridMass utterly failed to resolve any XICs in the selected window. It is clear that without a method to optimize the parameters, GridMass is unable to deliver appropriate results. So while approximately 50,000 XICs were recovered from the dataset, the qualitative quality of the XICs are poor.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g013"/>
    </fig>
    <fig id="pone.0227659.g014" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g014</object-id>
      <label>Fig 14</label>
      <caption>
        <title>matchedFilter qualitative results.</title>
        <p>Feature view (left) and wide view (right) The left view shows that matchedFilter manages to return several of the XICs. MatchedFilter failed to find most of the high intensity points in the feature view (right), but found several of the peaks.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g014"/>
    </fig>
    <fig id="pone.0227659.g015" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g015</object-id>
      <label>Fig 15</label>
      <caption>
        <title>centWave qualitative results.</title>
        <p>Feature view (right) and centWave wide view (left) and the left view shows that centWave manages to return several of the XICs. Like matchedFilter, centWave failed to find most of the points in the XICs in the feature view (right), but found several peaks.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g015"/>
    </fig>
    <p>Additionally, it was observed that centWave and matchedFilter both harbor a tendency to over or under select around regions of interest (Figs <xref ref-type="fig" rid="pone.0227659.g014">14</xref> and <xref ref-type="fig" rid="pone.0227659.g015">15</xref>). Additionally, with the prevalence of large datasets, the runtime of these algorithms is vitally important for their continued feasibility in the future. These runtimes can be seen in <xref ref-type="fig" rid="pone.0227659.g016">Fig 16</xref> (note log scale).</p>
    <fig id="pone.0227659.g016" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g016</object-id>
      <label>Fig 16</label>
      <caption>
        <title>Runtime of algorithms on PXD000792.</title>
        <p>This chart shows the log scaled runtimes for each of the algorithms in seconds on the PXD000792-Centroid dataset. CentWave took the longest at ~18000 seconds (approximately 5 hours), matchedFilter and GridMass took nearly the same at about 5 minutes. XFlow took approximately 8 seconds. Note that the time consuming part of centWave and matchedFilter is the parameter optimization which necessitates repeated trials to obtain optimal results.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g016"/>
    </fig>
    <p>A comparison of the shared XICs found between the tested algorithms can be seen in <italic><xref ref-type="fig" rid="pone.0227659.g017">Fig 17</xref></italic>. Each algorithm is compared to every other algorithm and the hand annotated dataset twice to give some sense of the peformance of the algorithm. The directionality of the comparison is important, as each XIC present in the second comparison file can be matched to as many XICs in the first comparison file. This evaluation was conducted in this way to detect a failure of the algorithms to separate bimodal peaks. In this way, the difference between the two comparisons between the same algorithms can be determined to mean that the algorithm with more matches was better able to separate co-eluting XICs as it matched multiple XICs to one presumably concatenated bi-modal signal.</p>
    <fig id="pone.0227659.g017" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227659.g017</object-id>
      <label>Fig 17</label>
      <caption>
        <title>Comparison of Traces recovered for UPS2.</title>
        <p>This table was created to derive a metric to determine shared XICs recovered between algorithms and also to determine quality of deconvolution.</p>
      </caption>
      <graphic xlink:href="pone.0227659.g017"/>
    </fig>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>The results of this study have brought to light several interesting and key features of the ability of the evaluated algorithms to recover XICs from LC-MS data sets.</p>
    <p>GridMass and XFlow were generally the most permissive algorithms tested, resulting in the most XICs recovered. Both algorithms also managed to recover many XICs from the UPS2 dataset, GridMass recovering just over 64%, and XFlow recovering 71%. XFlow recovered a disproportionally large number of XICs from the UPS2 dataset. Likely due to the large number of extremely low intensity noise points that drove the baseline calculation down. While GridMass performed very well on recovering the hand annotated data, it was optimized using a grid search evaluated using the hand annotated data, and was unable to replicate the success without this optimization strategy.</p>
    <p>Considering the total number of XICs collected for each algorithm with respect to each data file, it is clear here that the UPS2 dataset has interesting qualities in relation to the other datasets (<xref ref-type="fig" rid="pone.0227659.g009">Fig 9</xref>). XFlow returned the most hand annotated XICs between any algorithm, this disparity seems only attributable to something inherent in the dataset itself, in addition to what was mentioned before, UPS2 has a relatively small difference between the signal intensity and the background noise intensity in the dataset.</p>
    <p>The runtime of the algorithms is highly disparate, and the challenges of optimizing a highly parameterized algorithm such as centWave, matchedFilter, and GridMass (Even using an automated tool like IPO) is prohibitively time consuming for larger datasets. It is feasible to reuse optimized parameters but doing so is likely to return suboptimal results. In this way, it is clear that algorithms designed without user tunable parameters will excel.</p>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Conclusion</title>
    <p>The size of the datasets, the complexity of the signals, and the noise obfuscation make XIC acquisition from MS1 data extremely challenging. The general method to account for complexity has been to include parameters to increase the scope of an individual algorithm. It was our goal in our lab to reduce complexity, and simplify the experience of conducting MS1 analysis by designing XFlow in a procedurally agnostic way such that it works on a wide variety of MS1 datasets without parameter modification regardless of centroiding or instrument type, a goal that is now accomplished. It’s clear that XFlow excels at signal acquisition for the UPS2 dataset in particular and performs favorably with respect to other algorithms in signal acquisition from alternate datasets (Figs <xref ref-type="fig" rid="pone.0227659.g012">12</xref>–<xref ref-type="fig" rid="pone.0227659.g015">15</xref>). Additionally, while qualitative information is gained by comparing results for alternative datasets, it’s impossible to quantitatively evaluate the performance of the algorithms for datasets that do not have a hand annotated version. To this end, developing a database of a variety of hand annotated datasets with which to evaluate algorithms remains a valuable endeavor, in order to provide additional sources of comparison beyond UPS2. Further exploration into noise/signal detection and baseline detection would also serve to improve the predictability of XFlow in a method agnostic way.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec010">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0227659.s001">
      <label>S1 File</label>
      <caption>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0227659.s001.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0227659.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>R.</given-names></name><article-title>Conversations with 100 Scientists in the Field Reveal a Bifurcated Perception of the State of Mass Spectrometry Software</article-title>. <source><italic toggle="yes">Journal of Proteome Research</italic></source><year>2018</year><volume>17</volume> (<issue>4</issue>), <fpage>1335</fpage>–<lpage>1339</lpage>
<pub-id pub-id-type="doi">10.1021/acs.jproteome.8b00015</pub-id>
<?supplied-pmid 29546988?><pub-id pub-id-type="pmid">29546988</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>R</given-names></name>, <name><surname>Ventura</surname><given-names>D</given-names></name>, <name><surname>Prince</surname><given-names>J</given-names></name>. <article-title>LC-MS alignment in theory and practice: a comprehensive algorithmic review</article-title>, <source><italic toggle="yes">Briefings in Bioinformatics</italic></source><volume>16</volume>(<issue>1</issue>), <year>2015</year>, Pages <fpage>104</fpage>–<lpage>117</lpage>, <pub-id pub-id-type="doi">10.1093/bib/bbt080</pub-id><?supplied-pmid 24273217?><pub-id pub-id-type="pmid">24273217</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>R</given-names></name>, <name><surname>Ventura</surname><given-names>D</given-names></name>, <name><surname>Prince</surname><given-names>J</given-names></name>. <article-title>Novel algorithms and the benefits of comparative validation</article-title>, <source><italic toggle="yes">Bioinformatics</italic></source><volume>29</volume>(<issue>12</issue>), <year>2013</year>, Pages <fpage>1583</fpage>–<lpage>1585</lpage>, <pub-id pub-id-type="doi">10.1093/bioinformatics/btt176</pub-id><?supplied-pmid 23589651?><pub-id pub-id-type="pmid">23589651</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref004">
      <label>4</label>
      <mixed-citation publication-type="book"><name><surname>Bertsch</surname><given-names>A</given-names></name>, <name><surname>Gropl</surname><given-names>C</given-names></name>, <name><surname>Reinert</surname><given-names>K</given-names></name>, <name><surname>Kohlbacher</surname><given-names>O</given-names></name>. <chapter-title>OpenMS and TOPP: Open Source Software for LC-MS Data Analysis</chapter-title><source><italic toggle="yes">Data mining in Proteomics</italic>: <italic toggle="yes">From Standards to Applications</italic></source>; <publisher-name>Humana Press</publisher-name>, <year>2011</year>; Pages <fpage>353</fpage>–<lpage>367</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0227659.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Ji</surname><given-names>H</given-names></name>, <name><surname>Zeng</surname><given-names>F</given-names></name>, <name><surname>Xu</surname><given-names>Y</given-names></name>, <name><surname>Lu</surname><given-names>H</given-names></name> and <name><surname>Zhang</surname><given-names>Z</given-names></name>. <article-title>KPIC2: an effective framework for mass spectrometry-based metabolomics using pure ion chromatograms</article-title>. <source><italic toggle="yes">Analytical Chemistry</italic></source>, <volume>89</volume>(<issue>14</issue>), Pages <fpage>7631</fpage>–<lpage>7640</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.7b01547</pub-id>
<?supplied-pmid 28621925?><pub-id pub-id-type="pmid">28621925</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>R</given-names></name>, <name><surname>Taylor</surname><given-names>R.M</given-names></name>, <name><surname>Prince</surname><given-names>J.T</given-names></name>. <article-title>Current controlled vocabularies are insufficient to uniquely map molecular entities to mass spectrometry signal</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source><volume>16</volume>(<issue>S2</issue>) <year>2015</year><pub-id pub-id-type="doi">10.1186/1471-2105-16-S7-S2</pub-id><?supplied-pmid 25952148?><pub-id pub-id-type="pmid">25952148</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Gutierrez</surname><given-names>M</given-names></name>, <name><surname>Handy</surname><given-names>K</given-names></name>, and <name><surname>Smith</surname><given-names>R</given-names></name>. <article-title>XNet: A Bayesian Approach to Extracted Ion Chromatogram Clustering for Precursor Mass Spectrometry Data</article-title>. <source><italic toggle="yes">Journal of Proteome Research</italic></source><volume>18</volume>(<issue>7</issue>), <year>2019</year>, Pages <fpage>2771</fpage>–<lpage>2778</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.9b00068</pub-id><?supplied-pmid 31179699?><pub-id pub-id-type="pmid">31179699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Henning</surname><given-names>J</given-names></name>, <name><surname>Smith</surname><given-names>R</given-names></name>. <article-title>A web-based system for creating, viewing, and editing precursor mass spectrometry ground truth data</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source> (in press), <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="pone.0227659.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Rosen</surname><given-names>J</given-names></name>, <name><surname>Handy</surname><given-names>K</given-names></name>, <name><surname>Gillan</surname><given-names>A</given-names></name>, <name><surname>Smith</surname><given-names>R</given-names></name>. <article-title>JS-MS: a cross-platform, modular javascript viewer for mass spectrometry signals</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source><volume>18</volume>(<issue>1</issue>), <fpage>2017</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0227659.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Tostengard</surname><given-names>A</given-names></name>, and <name><surname>Smith</surname><given-names>R</given-names></name>. “<article-title>A Quantitative Evaluation of Ion Chromatogram Extraction Algorithms</article-title>” <source><italic toggle="yes">Journal of Proteome Research</italic></source>
<volume>19</volume>(<issue>5</issue>) <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="pone.0227659.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Conley</surname><given-names>C</given-names></name>, <name><surname>Smith</surname><given-names>R</given-names></name>, <name><surname>Torgrip</surname><given-names>R</given-names></name>, <name><surname>Taylor</surname><given-names>R</given-names></name>, <name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Prince</surname><given-names>J</given-names></name>. <article-title>Massifquant: open-source Kalman filter-based XC-MS isotope trace feature detection</article-title>, <source><italic toggle="yes">Bioinformatics</italic></source><volume>30</volume>(<issue>18</issue>), <year>2014</year> Pages <fpage>2636</fpage>–<lpage>2643</lpage>, <pub-id pub-id-type="doi">10.1093/bioinformatics/btu359</pub-id>
<?supplied-pmid 24872423?><pub-id pub-id-type="pmid">24872423</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>C</given-names></name>, <name><surname>Want</surname><given-names>E</given-names></name>, <name><surname>O'Maille</surname><given-names>G</given-names></name>, <name><surname>Abagyan</surname><given-names>R</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>Processing Mass Spectrometry Data for Metabolite Profiling Using Nonlinear Peak Alignment, Matching, and Identification</article-title>. <source><italic toggle="yes">Analytical Chemistry</italic></source><volume>78</volume> (<issue>3</issue>), <year>2006</year> Pages <fpage>779</fpage>–<lpage>787</lpage>. <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
<?supplied-pmid 16448051?><pub-id pub-id-type="pmid">16448051</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Böttcher</surname><given-names>C</given-names></name>, <article-title>Neumann, S. Highly sensitive feature detection for high resolution LC/MS</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source><volume>9</volume>(<issue>504</issue>), <fpage>2008</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-504</pub-id><?supplied-pmid 19040729?><pub-id pub-id-type="pmid">19040729</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Cox</surname><given-names>J</given-names></name>, <name><surname>Mann</surname><given-names>M</given-names></name>. <article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title>. <source><italic toggle="yes">Nat Biotechnol</italic></source><volume>26</volume>, Pages <fpage>1367</fpage>–<lpage>1372</lpage> (<year>2008</year>) <pub-id pub-id-type="doi">10.1038/nbt.1511</pub-id>
<?supplied-pmid 19029910?><pub-id pub-id-type="pmid">19029910</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Zhurov</surname><given-names>K</given-names></name>, <name><surname>Kozhinov</surname><given-names>A</given-names></name>, <name><surname>Fornelli</surname><given-names>L</given-names></name>, <name><surname>Tsybin</surname><given-names>Y</given-names></name>. <article-title>Distinguishing Analyte from Noise Components in Mass Spectra of Complex Samples: Where to Cut the Noise?</article-title><source><italic toggle="yes">Analytical Chemistry</italic></source><volume>86</volume>(<issue>7</issue>), <year>2014</year><fpage>3308</fpage>–<lpage>3316</lpage><pub-id pub-id-type="doi">10.1021/ac403278t</pub-id><?supplied-pmid 24579830?><pub-id pub-id-type="pmid">24579830</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Henning</surname><given-names>J</given-names></name>, <name><surname>Tostengard</surname><given-names>A</given-names></name>, <name><surname>Smith</surname><given-names>R</given-names></name>. <article-title>A Peptide-Level Fully Annotated Data Set for Quantitative Evaluation of Precursor-Aware Mass Spectrometry Data Processing Algorithms</article-title><source><italic toggle="yes">Journal of Proteome Research</italic></source><volume>18</volume>(<issue>1</issue>), <year>2019</year> Pages <fpage>392</fpage>–<lpage>398</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.8b00659</pub-id>
<?supplied-pmid 30394759?><pub-id pub-id-type="pmid">30394759</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Chih-Chiang</surname><given-names>T</given-names></name>, <name><surname>Avtonomov</surname><given-names>D</given-names></name>, <name><surname>Larsen</surname><given-names>B</given-names></name>, <name><surname>Tucholska</surname><given-names>M</given-names></name>, <name><surname>Choi</surname><given-names>H</given-names></name>, <name><surname>Gingras</surname><given-names>A</given-names></name>, <name><surname>Nesvizhskii</surname><given-names>A</given-names></name>. <article-title>DIA-Umpire: comprehensive computational framework for data-independent acquisition proteomics</article-title>. <source><italic toggle="yes">Nature Methods</italic></source><volume>12</volume>(<issue>3</issue>), <fpage>2015</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0227659.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>BTreviño</surname><given-names>V</given-names></name>, <name><surname>Yañez-Garza</surname><given-names>I</given-names></name>, <name><surname>Rodriguez-López</surname><given-names>C</given-names></name>, <name><surname>Urrea-López</surname><given-names>R</given-names></name>, <name><surname>Garza-Rodriguez</surname><given-names>M</given-names></name>, <name><surname>Barrera-Saldaña</surname><given-names>H</given-names></name>, <name><surname>Tamez-Peña</surname><given-names>J</given-names></name>, <name><surname>Winkler</surname><given-names>R</given-names></name>, <name><surname>Díaz de-la-Garza</surname><given-names>R</given-names></name>. <article-title>GridMass: a fast two-dimensional feature detection method for LC/MS</article-title>. <source>Journal of Mass Spectrometry</source><volume>50</volume>(<issue>1</issue>),<year>2015</year><pub-id pub-id-type="doi">10.1002/jms.3512</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Libiseller</surname><given-names>G</given-names></name>, <name><surname>Dvorzak</surname><given-names>M</given-names></name>, <name><surname>Kleb</surname><given-names>U</given-names></name>, <name><surname>Gander</surname><given-names>E</given-names></name>, <name><surname>Eisenberg</surname><given-names>T</given-names></name>, <name><surname>Madeo</surname><given-names>F</given-names></name><etal>et al</etal><article-title>IPO: a tool for automated optimization of XCMS parameters</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source><volume>16</volume>(<issue>118</issue>), <fpage>2015</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0562-8</pub-id><?supplied-pmid 25888443?><pub-id pub-id-type="pmid">25888443</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227659.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Kessner</surname><given-names>D</given-names></name>, <name><surname>Chambers</surname><given-names>M</given-names></name>, <name><surname>Burke</surname><given-names>R</given-names></name>, <name><surname>Agus</surname><given-names>D</given-names></name>, <name><surname>Mallick</surname><given-names>P</given-names></name>, <article-title>ProteoWizard: open source software for rapid proteomics tools development</article-title>, <source><italic toggle="yes">Bioinformatics</italic></source><volume>24</volume>(<issue>21</issue>), <year>2008</year> Pages <fpage>2534</fpage>–<lpage>2536</lpage>, <pub-id pub-id-type="doi">10.1093/bioinformatics/btn323</pub-id>
<?supplied-pmid 18606607?><pub-id pub-id-type="pmid">18606607</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
