<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6842926</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2019.01027</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>XitoSBML: A Modeling Tool for Creating Spatial Systems Biology Markup Language Models From Microscopic Images</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ii</surname>
          <given-names>Kaito</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mashimo</surname>
          <given-names>Kota</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ozeki</surname>
          <given-names>Mitsunori</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamada</surname>
          <given-names>Takahiro G.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/611821"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hiroi</surname>
          <given-names>Noriko</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/30491"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Funahashi</surname>
          <given-names>Akira</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/28277"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Systems Biology Laboratory, Department of Biosciences and Informatics, Keio University</institution>, <addr-line>Yokohama</addr-line>, <country>Japan</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Laboratory of Physical Chemistry for Life Science, Faculty of Pharmaceutical Sciences, Sanyo-Onoda City University</institution>, <addr-line>Sanyo-Onoda City</addr-line>, <country>Japan</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Helder Nakaya, University of São Paulo, Brazil</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Lucian Paul Smith, University of Washington, United States; Nicholas Roehner, Raytheon, United States</p>
      </fn>
      <corresp id="fn001">*Correspondence: Akira Funahashi, <email xlink:href="mailto:funa@bio.keio.ac.jp" xlink:type="simple">funa@bio.keio.ac.jp</email>
</corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Systems Biology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>1027</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Ii, Mashimo, Ozeki, Yamada, Hiroi and Funahashi</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Ii, Mashimo, Ozeki, Yamada, Hiroi and Funahashi</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>XitoSBML is a software tool designed to create an SBML (Systems Biology Markup Language) Level 3 Version 1 document from microscopic cellular images. It is implemented as an ImageJ plug-in and is designed to create spatial models that reflect the three-dimensional cellular geometry. With XitoSBML, users can perform spatial model simulations based on realistic cellular geometry by using SBML-supported software tools, including simulators such as Virtual Cell and Spatial Simulator. XitoSBML is open-source and is available at <uri xlink:type="simple" xlink:href="https://github.com/spatialsimulator/XitoSBML/">https://github.com/spatialsimulator/XitoSBML/</uri>. XitoSBML is confirmed to run on most 32/64-bit operating systems: Windows, MacOS, and Linux.</p>
    </abstract>
    <kwd-group>
      <kwd>spatial model simulation</kwd>
      <kwd>spatial modeling</kwd>
      <kwd>systems biology markup language</kwd>
      <kwd>ImageJ</kwd>
      <kwd>image processing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">Japan Society for the Promotion of Science<named-content content-type="fundref-id">10.13039/501100001691</named-content></funding-source>
        <award-id rid="cn001">24300112</award-id>
      </award-group>
      <award-group>
        <funding-source id="cn002">National Institutes of Natural Sciences<named-content content-type="fundref-id">10.13039/501100006321</named-content></funding-source>
        <award-id rid="cn002">IS271002</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="0"/>
      <equation-count count="0"/>
      <ref-count count="17"/>
      <page-count count="7"/>
      <word-count count="2988"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>With the recent development of imaging technologies, we can quantitatively analyze spatial localization and concentration gradients of biochemicals within living cells (<xref rid="B2" ref-type="bibr">Chen et al., 2014</xref>; <xref rid="B5" ref-type="bibr">Keller and Ahrens, 2015</xref>). As a result, the importance of biochemical spatial localization and concentration gradients has become apparent. The effect of dynamics related to biochemical spatial distribution and cellular shape can be analyzed by using spatial model simulations (<xref rid="B11" ref-type="bibr">Rangamani et al., 2013</xref>).</p>
    <p>However, in most spatial model simulations, cellular regions are defined as two- or three-dimensional spatial models based on simple mathematical equations. Because cell shape in such models differs from actual cells, these simulations will not produce appropriate results. Therefore, it is crucial to perform three-dimensional spatial model simulations by using spatial models with the actual cellular shape.</p>
    <p>Moreover, the advance of microscopic imaging technologies has made it possible to acquire a considerable amount of microscopic cellular images from biological experiments. Therefore, providing a software tool that can automatically generate a spatial model from microscopic cellular images will play an essential role in Systems Biology.</p>
    <p>Software tools such as Virtual Cell (<xref rid="B6" ref-type="bibr">Loew and Schaff, 2001</xref>), Smoldyn (<xref rid="B1" ref-type="bibr">Andrews et al., 2010</xref>), and Morpheus (<xref rid="B16" ref-type="bibr">Starruss et al., 2014</xref>) are capable of performing simulations with actual cellular shape. Virtual Cell is a computational environment for modeling and numerical simulation that provides a graphical user interface (GUI) to create biochemical network models and perform ordinary differential equations, partial differential equations, and stochastic numerical simulations. Virtual Cell is popular for its partial differential equation model simulation. Smoldyn is a stochastic model simulator that can perform spatial model simulation with a particle-based model. The molecules in the model are defined as particles that diffuse with Brownian motion. The software is mostly used for biochemical reaction simulation at the single-cell scale (e.g., nanometer-scale spatial resolution). Morpheus is a modeling environment for simulation with ordinary or partial differential equations and can be used to model a reaction-diffusion system for multiscale and multicellular systems. These software tools provide outstanding functionalities in terms of spatial modeling and simulation but are limited by their unique file format. Morpheus can import SBML (Systems Biology Markup Language) (<xref rid="B4" ref-type="bibr">Hucka et al., 2003</xref>) files but cannot import the spatial information from these files. Virtual Cell can import and export SBML files, including spatial information. Smoldyn supports the SBML file format using Virtual Cell as a proxy. Virtual Cell, Smoldyn, and Morpheus are also limited in that they do not offer an interface to overcome the difficulty of creating a spatial model from images.</p>
    <p>Virtual Cell provides functionality to create a spatial model from microscopic images and export it as a spatial SBML document, but it only supports the import of grayscale or multichannel TIFF images; this is problematic for the following reasons: 1) When importing a grayscale image, users have to apply a segmentation task manually from the distribution of intensity provided by Virtual Cell. Because, in general, segmentation is a difficult task in image processing (<xref rid="B10" ref-type="bibr">Rajasekaran et al., 2016</xref>), manual segmentation for each organelle with the distribution of intensity would requires enormous modifications to each pixel in the image; and 2) Even though Virtual Cell supports the import of a multichannel TIFF image so that each channel can be segmented and assigned to each organelle, the program requires users to manually assign a membrane between two organelles in their model. The number of possible membrane positions would increase with <italic>O</italic>(<italic>n</italic>
<sup>2</sup>) [<inline-formula><mml:math id="IM1"><mml:mrow><mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>n</italic> is the number of organelles]. When the number of organelles is small, it would not be a critical problem for users but advances in microscopic technologies have enabled 9 to 24 multichannel images to be obtained for a single cell (<xref rid="B8" ref-type="bibr">Niehörster et al., 2016</xref>; <xref rid="B17" ref-type="bibr">Wei et al., 2017</xref>).</p>
    <p>To solve these problems, we present XitoSBML, which is capable of creating spatial models from microscopic images in SBML format. XitoSBML uses images to construct spatial models with more flexibility in defining compartment shapes compared to models created with mathematical equations. Because XitoSBML is implemented as a plug-in for ImageJ (<xref rid="B13" ref-type="bibr">Schindelin et al., 2012</xref>; <xref rid="B15" ref-type="bibr">Schneider et al., 2012</xref>), users can call sophisticated segmentation algorithms for each channel through the user interface of ImageJ and directly apply the segmentation result to XitoSBML. This means that users can process images and create the spatial model within the same application. XitoSBML supports the import of plural segmented (binary) images for each organelle. Moreover, XitoSBML automatically assigns membranes between domains from given inclusion properties of organelles. XitoSBML also automatically adjusts the segmentation result so that users can create a spatial model without manually performing morphological operations and interpolation on the segmented images. SBML is compatible with more than 290 different software tools. Although only a limited number of software tools currently support spatial SBML simulation (Loew and Schaff 2001; <xref rid="B7" ref-type="bibr">Matsui et al., 2015</xref>), the demand for such modeling is increasing. We therefore expect that the number of spatial simulators will increase in the next few years. XitoSBML is a user-friendly and extensive modeling software, providing the environment to create a spatial model on the fly. Users may efficiently perform spatial model simulations and export the model to any compatible simulator.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials And Methods</title>
    <p>Here, we briefly describe XitoSBML and outline the process the program takes to create a model with JSBML 1.2 (<xref rid="B3" ref-type="bibr">Dräger et al., 2011</xref>). XitoSBML operates as a plug-in for ImageJ. Once the microscopic images are well organized and segmented (<xref rid="B9" ref-type="bibr">Nketia et al., 2017</xref>), XitoSBML can take them as input to create an SBML level 3 version 1 model with spatial processes (<xref rid="B12" ref-type="bibr">Schaff et al., 2015</xref>).</p>
    <sec id="s2_1">
      <title>Software Architecture</title>
      <p>XitoSBML is open-source software distributed under Apache License, 2.0; it is written in Java and is platform-independent. XitoSBML uses an ImageJ plug-in application programming interface (API) to import images from ImageJ and to create the GUI (<xref ref-type="fig" rid="f1"><bold>Figure 1</bold></xref>). The imported images are passed to several image processing algorithms (morphological operations, interpolation, and labeling) implemented in XitoSBML. The JSBML API then converts the processed images to a spatial SBML model, which is converted to an SBML Level 3 Version 1 object that can be modified through the XitoSBML GUI. The converted spatial SBML model contains the spatial geometry of the original images as well as information on molecular concentrations, locations, biochemical reactions, and parameters. This information will be used by SBML-supported simulators to perform spatial simulation on the model.</p>
      <fig id="f1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Architecture and workflow of XitoSBML. Inputs to XitoSBML are segmented images of a cell or spatial SBML model. The segmented images are easily generated by using existing functions in ImageJ. XitoSBML imports these images through ImageJ plug-in API and applies several image processing algorithms implemented in XitoSBML. The converted images are then exported to spatial SBML by using JSBML API. The generated spatial SBML model is used to perform a spatial simulation on SBML-supported simulators.</p>
        </caption>
        <graphic xlink:href="fgene-10-01027-g001"/>
      </fig>
      <sec id="s2_1_1">
        <title>Preprocess Of Images</title>
        <p>XitoSBML takes in two-dimensional or z-stack three-dimensional images as input and creates a spatial model. Before doing so, the images must be in a specific format as outlined below. XitoSBML assumes the image is segmented and represented as a specific domain within the cell. Usually, the segmented image is a binary image that only contains black or white pixels. For example, input images with a segmented image of a nucleus and a cytosol will produce a spatial model with domains of extracellular matrix, cytosol, and nucleus. Therefore, to obtain a reasonable model, segmentation of the microscopic images is essential. ImageJ provides a variety of tools for this purpose. One of the benefits of XitoSBML is that one can process the image and create the model simultaneously on ImageJ: i.e., the user just has to process the images on ImageJ and import them into XitoSBML on ImageJ.</p>
      </sec>
    </sec>
    <sec id="s2_2">
      <title>Software Functionalities</title>
      <sec id="s2_2_1">
        <title>Creating Spatial Model From Images</title>
        <p>XitoSBML provides an easy-to-use GUI to create the spatial models. Before doing so, the microscopic images must be processed to binary representing one component of the cell; this can be performed on ImageJ. Given the input images, the software will generate a spatial model as follows.</p>
        <list list-type="order">
          <list-item>
            <p>The binary images (<xref ref-type="fig" rid="f2"><bold>Figure 2A</bold></xref>) are filled by morphological operation and interpolated if necessary for the sake of simulation (<xref ref-type="fig" rid="f2"><bold>Figure 2B</bold></xref>).</p>
          </list-item>
          <list-item>
            <p>The software then combines the images into a single grayscale image, assigning a distinct pixel value to each component given by the input (<xref ref-type="fig" rid="f2"><bold>Figure 2C</bold></xref>).</p>
          </list-item>
          <list-item>
            <p>After the software generates a simulation space from the given images, users may add molecular species, parameters, and reactions to the model.</p>
          </list-item>
          <list-item>
            <p>The resulting image is visualized by surface rendering using a 3D Viewer (<xref rid="B14" ref-type="bibr">Schmid et al., 2010</xref>) (<xref ref-type="fig" rid="f2"><bold>Figure 2D</bold></xref>).</p>
          </list-item>
          <list-item>
            <p>In addition, the inclusion property between domains is shown (<xref ref-type="fig" rid="f2"><bold>Figure 2E</bold></xref>). Using this relationship, one can check whether the domains in the model are biologically valid by showing which domains are adjacent to each other. Thus, the program can determine whether a model is biologically impossible: e.g., nucleus adjacent to the extracellular matrix.</p>
          </list-item>
          <list-item>
            <p>Finally, the model is exported as an SBML document, along with the grayscale image (<xref ref-type="fig" rid="f2"><bold>Figure 2F</bold></xref>).</p>
          </list-item>
        </list>
        <fig id="f2" position="float">
          <label>Figure 2</label>
          <caption>
            <p>Flowchart of XitoSBML and post-processing of imported images in XitoSBML. <bold>(A)</bold> Segmented images of cytosol (red) and nucleus (green). The two images are in color for visualization purposes; however, when in actual use, they have to be binarized. These two images are set as inputs of XitoSBML. <bold>(B)</bold> Each input is filled by morphological operation and interpolated as necessary. The interpolation is performed with the nearest neighbor method. <bold>(C)</bold> The inputs are combined creating a new grayscale image. The domains, in this case, cytosol and nucleus, are assigned with the specific pixel value. If each domain overlaps with each other or creates a gap in between, the grayscale images are corrected. <bold>(D)</bold> The result of the grayscale image projected three-dimensionally with 3D viewer. Each color represents a different domain of the input. <bold>(E)</bold> Inclusion property within the model. The box refers to the domain, and the arrow refers to the adjacency of domains, which apparently corresponds with <bold>(C)</bold>. <bold>(F)</bold> The resulting model for the SBML document. <bold>(G)</bold> When a gap exists between two segmented regions (e.g., nucleus and cytosol), XitoSBML will automatically fill the gap by a morphological operation. <bold>(H)</bold> If the imported simulation space contains anisotropic voxels, XitoSBML will use the nearest neighbor method to interpolate z-slice images from the given input images.</p>
          </caption>
          <graphic xlink:href="fgene-10-01027-g002"/>
        </fig>
        <p><xref ref-type="fig" rid="f2"><bold>Figures 2G</bold></xref>, H show the post-processing of imported images. When merging two segmented images, a gap might occur between two segmented regions (e.g., nucleus and cytosol) when the segmentation did not work correctly. XitoSBML will automatically fill the gap between these two regions by a morphological operation (<xref ref-type="fig" rid="f2"><bold>Figure 2G</bold></xref>). Most of the three-dimensional microscopic images (z-stack images) have low resolution on the z-axis. This induces anisotropic voxels in the spatial model, which in turn would cause inaccurate spatial simulation. To solve this problem, XitoSBML interpolates z-slice images from the given input images by the nearest neighbor method (<xref ref-type="fig" rid="f2"><bold>Figure 2H</bold></xref>). Common pitfalls of segmentation are covered by applying morphological operation and interpolation as a post-process.</p>
        <p><xref ref-type="fig" rid="f3"><bold>Figure 3</bold></xref> shows how the domains are written in SBML. From the original image (e.g., <xref ref-type="fig" rid="f2"><bold>Figure 2A</bold></xref>), each domain is assigned a specific pixel value creating a single grayscale image (e.g., <xref ref-type="fig" rid="f2"><bold>Figure 2C</bold></xref>). In the example in <xref ref-type="fig" rid="f3"><bold>Figure 3</bold></xref> (left side), Nuc (nucleus) has a value of 170, Cyt (cytosol) has a value of 85, and EC (extracellular matrix) has a value of 0. From the grayscale image, the adjacency of domains is found, and membranes (with no thickness) are created between the domains. After the domains are created from given images, users can manually add molecular species and parameters (e.g., advection coefficient, boundary condition, or diffusion coefficient) into the necessary domains by XitoSBML (model editor). Then, all the information is written in an SBML document. While exporting the spatial model as an SBML Level 3 Version 1 document, XitoSBML executes both syntax and semantic validation on the SBML core package by using an API provided by JSBML and executes syntax validation on the SBML spatial package by using an online libSBML validator. Moreover, XitoSBML has a custom implementation of a validator that can semantically validate the spatial information inside the model.</p>
        <fig id="f3" position="float">
          <label>Figure 3</label>
          <caption>
            <p>Diagram of how the image is written in the SBML document. The array on the left side is a sample image representing the grayscale image in <xref ref-type="fig" rid="f2"><bold>Figure 2C</bold></xref>. Each pixel value corresponds to a domainType, and every contiguous region on a domainType is defined as the domain of that domainType. Membranes are created between the domains and defined in the SBML document. In this instance, EC (extracellular matrix), PM (plasma membrane), Cyt (cytosol), NM (nuclear membrane), and Nuc (nucleus) are defined as domains. While creating the membrane, the adjacency of domains is resolved and defined as adjacentDomain. The corresponding value of the domain, excluding membranes, is defined as the sampledValue. Lastly, the array of the whole image is stored in the sampledField.</p>
          </caption>
          <graphic xlink:href="fgene-10-01027-g003"/>
        </fig>
        <p>The user needs to do only three easy steps to create a spatial model from images: 1) process the microscopic images to binary images, 2) add molecular species and parameters into the necessary domains, and 3) save the created model as a file.</p>
      </sec>
      <sec id="s2_2_2">
        <title>Editing an Existing Model</title>
        <p>XitoSBML also can handle existing spatial SBML models, thereby allowing users to modify their spatial SBML model by opening it from XitoSBML. Using the “run Model Editor” menu item from the “XitoSBML” plug-in menu, the molecular species and parameter in a model can be modified. With the correct version and extensions, any model can be modified.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <p>In <xref ref-type="fig" rid="f4"><bold>Figure 4</bold></xref>, we present an example of the use of XitoSBML software to demonstrate the basic work flow. As an input, we will use three-dimensional images of SH-SY5Y cells, which are derived from human neuroblastoma. Before construction of the model, the images were segmented using ImageJ, with each segmented image representing a geometry of a domain in a cell.</p>
    <fig id="f4" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Screenshot of XitoSBML generating an SBML document from microscopic images. The segmented three-dimensional SH-SY5Y cell images are shown on the left. Top left is the nucleus, and bottom left is the cytosol. On the right is the interface of XitoSBML that allows the user to add the images to the corresponding domainType.</p>
      </caption>
      <graphic xlink:href="fgene-10-01027-g004"/>
    </fig>
    <p>XitoSBML offers an easy way to create a spatial model from images. The obtained spatial model is usable for spatial model simulation with the appropriate simulator. Below, we present the result of a spatial model simulation with a spatial model exported from XitoSBML to validate the usefulness of the obtained spatial model. As an example simulator, we chose Spatial Simulator (<xref rid="B7" ref-type="bibr">Matsui et al., 2015</xref>), which is an in-house software implemented as a partial differential equation simulator specialized for SBML documents. Before performing the simulation, the XitoSBML output model requires further modification: information on biochemical reactions must be added because Spatial Simulator lacks the ability to add this information. XitoSBML provides a GUI for this purpose; users can add molecular species, reactions, parameters, and reaction rates to the model. In this example, the model is the simple transportation of molecules from Cyt to EC and simple diffusion combined. The result of the spatial model simulation is shown in <xref ref-type="supplementary-material" rid="SM1"><bold>Figure S1</bold></xref>.</p>
    <p>Even though the model is three-dimensional, to visualize the entire result, we show the results of a time series of a particular Z slice of the model. The colors inside the cell represent a concentration of molecule. By using XitoSBML and Spatial Simulator, users can easily create a spatial model, add mathematics to their model, and execute a spatial simulation from microscopic images.</p>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>Ever since the SBML Spatial Processes package was proposed, spatial models could be created in a standardized format. XitoSBML is one of the first software tools to create a pure SBML spatial model. Thus, we have provided a platform within a laboratory to perform spatial modeling in which acquisition of microscopic images and the addition of molecular species and parameters is conducted manually through the GUI of XitoSBML.</p>
    <p>XitoSBML is a significant step toward more user-friendly tools for spatial biochemical modeling that provides the environment to create spatial models that reflect three-dimensional cellular geometry. It provides a GUI to easily create SBML Level 3 Version 1 documents and operates on ImageJ to simultaneously process images and create SBML documents. The exported model is compatible with SBML-supported software tools and can be used to perform spatial modeling. Thus, XitoSBML works as the gateway between bioimaging and spatial model simulation. As such, it provides a fast and easy way for biologists, who do not have detailed knowledge of modeling but can produce microscopic z-stack images, to perform spatial model simulations.</p>
    <p>In the future, XitoSBML will be extended to automatically add the distribution of the initial concentration for each molecular species: in this new functionality, the fluorescent microscopic image of the localization of the molecule would be received and added as the distribution of initial concentration for that molecule in the SBML model.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>The datasets generated and analyzed for this study can be found in <uri xlink:type="simple" xlink:href="https://github.com/spatialsimulator/XitoSBML/">https://github.com/spatialsimulator/XitoSBML/</uri>.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>AF conceived and led the project. KI implemented the software and wrote the manuscript with TY. NH provided biological expertise. AF gave technical advice on the implementation. KM and MO provided advice on the image processing algorithms implemented in this software. All authors were involved in drafting or revising the content of the manuscript. All authors read and approved the manuscript.</p>
  </sec>
  <sec sec-type="funding-information" id="s7">
    <title>Funding</title>
    <p>This work was supported by JSPS KAKENHI Grant-in-Aid for Scientific Research (B) (Grant Number 24300112) and the Imaging Science Project of the Center for Novel Science Initiatives (CNSI), National Institutes of Natural Sciences (NINS) (Grant Number IS271002).</p>
  </sec>
  <sec id="s8">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank Ryuichi Tanimoto, Keio University, and Yuta Tokuoka, Keio University for providing the three-dimensional SH-SY5Y cell images and for productive discussions on recent segmentation algorithms.</p>
  </ack>
  <sec sec-type="supplementary-material" id="s9">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fgene.2019.01027/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fgene.2019.01027/full#supplementary-material</ext-link>
</p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="DataSheet_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>S. S.</given-names></name><name><surname>Addy</surname><given-names>N. J.</given-names></name><name><surname>Brent</surname><given-names>R.</given-names></name><name><surname>Arkin</surname><given-names>A. P.</given-names></name></person-group> (<year>2010</year>). <article-title>Detailed simulations of cell biology with smoldyn 2.1</article-title>. <source>PLoS Comput. Biol.</source>
<volume>6</volume>, <elocation-id>e1000705</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000705</pub-id>
<pub-id pub-id-type="pmid">20300644</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>B.-C.</given-names></name><name><surname>Legant</surname><given-names>W. R.</given-names></name><name><surname>Wang</surname><given-names>K.</given-names></name><name><surname>Shao</surname><given-names>L.</given-names></name><name><surname>Milkie</surname><given-names>D. E.</given-names></name><name><surname>Davidson</surname><given-names>M. W.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Lattice light-sheet microscopy: imaging molecules to embryos at high spatiotemporal resolution</article-title>. <source>Science</source>
<volume>346</volume>, <fpage>1257998</fpage>–<lpage>1257998</lpage>. <pub-id pub-id-type="doi">10.1126/science.1257998</pub-id>
<pub-id pub-id-type="pmid">25342811</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dräger</surname><given-names>A.</given-names></name><name><surname>Rodriguez</surname><given-names>N.</given-names></name><name><surname>Dumousseau</surname><given-names>M.</given-names></name><name><surname>Dörr</surname><given-names>A.</given-names></name><name><surname>Wrzodek</surname><given-names>C.</given-names></name><name><surname>Le Novère</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>JSBML: a flexible Java library for working with SBML</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>2167</fpage>–<lpage>2168</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr361</pub-id>
<pub-id pub-id-type="pmid">21697129</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hucka</surname><given-names>M.</given-names></name><name><surname>Finney</surname><given-names>A.</given-names></name><name><surname>Sauro</surname><given-names>H. M.</given-names></name><name><surname>Bolouri</surname><given-names>H.</given-names></name><name><surname>Doyle</surname><given-names>J. C.</given-names></name><name><surname>Kitano</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2003</year>). <article-title>The systems biology markup language (SBML): a medium for representationand exchange of biochemical network models</article-title>. <source>Bioinformatics</source>
<volume>19</volume>, <fpage>524</fpage>–<lpage>531</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btg015</pub-id>
<pub-id pub-id-type="pmid">12611808</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>P. J.</given-names></name><name><surname>Ahrens</surname><given-names>M. B.</given-names></name></person-group> (<year>2015</year>). <article-title>Visualizing whole-brain activity and development at the single-cell level using light-sheet microscopy</article-title>. <source>Neuron</source>
<volume>85</volume>, <fpage>462</fpage>–<lpage>483</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2014.12.039</pub-id>
<pub-id pub-id-type="pmid">25654253</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loew</surname><given-names>L. M.</given-names></name><name><surname>Schaff</surname><given-names>J. C.</given-names></name></person-group> (<year>2001</year>). <article-title>The virtual cell: a software environment for computational cell biology</article-title>. <source>Trends Biotechnol.</source>
<volume>19</volume>, <fpage>401</fpage>–<lpage>406</lpage>. <pub-id pub-id-type="doi">10.1016/s0167-7799(01)01740-1</pub-id>
<pub-id pub-id-type="pmid">11587765</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Matsui</surname><given-names>T.</given-names></name><name><surname>Mashimo</surname><given-names>K.</given-names></name><name><surname>Ii</surname><given-names>K.</given-names></name><name><surname>Hiroi</surname><given-names>N.</given-names></name><name><surname>Funahashi</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>). <source>Spatial simulator</source>. Available at: <uri xlink:type="simple" xlink:href="https://github.com/spatialsimulator/Spatial_Simulator/">https://github.com/spatialsimulator/Spatial_Simulator/</uri></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niehörster</surname><given-names>T.</given-names></name><name><surname>Löschberger</surname><given-names>A.</given-names></name><name><surname>Gregor</surname><given-names>I.</given-names></name><name><surname>Krämer</surname><given-names>B.</given-names></name><name><surname>Rahn</surname><given-names>H.-J.</given-names></name><name><surname>Patting</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Multi-target spectrally resolved fluorescence lifetime imaging microscopy</article-title>. <source>Nat. Methods</source>
<volume>13</volume>, <fpage>257</fpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3740</pub-id>
<pub-id pub-id-type="pmid">26808668</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nketia</surname><given-names>T. A.</given-names></name><name><surname>Sailem</surname><given-names>H.</given-names></name><name><surname>Rohde</surname><given-names>G.</given-names></name><name><surname>Machiraju</surname><given-names>R.</given-names></name><name><surname>Rittscher</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>). <article-title>Analysis of live cell images: methods, tools and opportunities</article-title>. <source>Methods</source>
<volume>115</volume>, <fpage>65</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymeth.2017.02.007</pub-id>
<pub-id pub-id-type="pmid">28242295</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajasekaran</surname><given-names>B.</given-names></name><name><surname>Uriu</surname><given-names>K.</given-names></name><name><surname>Valentin</surname><given-names>G.</given-names></name><name><surname>Tinevez</surname><given-names>J.-Y.</given-names></name><name><surname>Oates</surname><given-names>A. C.</given-names></name></person-group> (<year>2016</year>). <article-title>Object segmentation and ground truth in 3d embryonic imaging</article-title>. <source>PloS ONE</source>
<volume>11</volume>, <elocation-id>e0150853</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pone.0150853</pub-id>
<pub-id pub-id-type="pmid">27332860</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rangamani</surname><given-names>P.</given-names></name><name><surname>Lipshtat</surname><given-names>A.</given-names></name><name><surname>Azeloglu</surname><given-names>E. U.</given-names></name><name><surname>Calizo</surname><given-names>R. C.</given-names></name><name><surname>Hu</surname><given-names>M.</given-names></name><name><surname>Ghassemi</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Decoding information in cell shape</article-title>. <source>Cell</source>
<volume>154</volume>, <fpage>1356</fpage>–<lpage>1369</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2013.08.026</pub-id>
<pub-id pub-id-type="pmid">24034255</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Schaff</surname><given-names>J. C.</given-names></name><name><surname>Lakshminarayana</surname><given-names>A.</given-names></name><name><surname>Smith</surname><given-names>L.</given-names></name><name><surname>Bergmann</surname><given-names>F.</given-names></name><name><surname>Sullivan</surname><given-names>D. P.</given-names></name></person-group> (<year>2015</year>). <source>SBML level 3 package specification spatial processes</source>. Available at: <uri xlink:type="simple" xlink:href="https://sourceforge.net/p/sbml/code/HEAD/tree/trunk/specifications/sbml-level-3/version-1/spatial/specification/spatial-v1-sbml-l3v1-rel0.90.pdf">https://sourceforge.net/p/sbml/code/HEAD/tree/trunk/specifications/sbml-level-3/version-1/spatial/specification/spatial-v1-sbml-l3v1-rel0.90.pdf</uri></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname><given-names>J.</given-names></name><name><surname>Arganda-Carreras</surname><given-names>I.</given-names></name><name><surname>Frise</surname><given-names>E.</given-names></name><name><surname>Kaynig</surname><given-names>V.</given-names></name><name><surname>Longair</surname><given-names>M.</given-names></name><name><surname>Pietzsch</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Fiji: an open-source platform for biological-image analysis</article-title>. <source>Nat. Methods</source>
<volume>9</volume>, <fpage>676</fpage>–<lpage>682</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id>
<pub-id pub-id-type="pmid">22743772</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmid</surname><given-names>B.</given-names></name><name><surname>Schindelin</surname><given-names>J.</given-names></name><name><surname>Cardona</surname><given-names>A.</given-names></name><name><surname>Longair</surname><given-names>M.</given-names></name><name><surname>Heisenberg</surname><given-names>M.</given-names></name></person-group> (<year>2010</year>). <article-title>A high-level 3d visualization api for java and imagej. BMC</article-title>. <source>Bioinformatics</source>
<volume>11</volume>, <fpage>274</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-274</pub-id>
<pub-id pub-id-type="pmid">20492697</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>C. A.</given-names></name><name><surname>Rasband</surname><given-names>W. S.</given-names></name><name><surname>Eliceiri</surname><given-names>K. W.</given-names></name></person-group> (<year>2012</year>). <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nat. Methods</source>
<volume>9</volume>, <fpage>671</fpage>–<lpage>675</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id>
<pub-id pub-id-type="pmid">22930834</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starruss</surname><given-names>J.</given-names></name><name><surname>de Back</surname><given-names>W.</given-names></name><name><surname>Brusch</surname><given-names>L.</given-names></name><name><surname>Deutsch</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>). <article-title>Morpheus: a user-friendly modeling environment for multiscale and multicellular systems biology</article-title>. <source>Bioinformatics</source>
<volume>30</volume>, <fpage>1331</fpage>–<lpage>1332</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt772</pub-id>
<pub-id pub-id-type="pmid">24443380</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>L.</given-names></name><name><surname>Chen</surname><given-names>Z.</given-names></name><name><surname>Shi</surname><given-names>L.</given-names></name><name><surname>Long</surname><given-names>R.</given-names></name><name><surname>Anzalone</surname><given-names>A. V.</given-names></name><name><surname>Zhang</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Super-multiplex vibrational imaging</article-title>. <source>Nature</source>
<volume>544</volume>, <fpage>465</fpage>. <pub-id pub-id-type="doi">10.1038/nature22051</pub-id>
<pub-id pub-id-type="pmid">28424513</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
