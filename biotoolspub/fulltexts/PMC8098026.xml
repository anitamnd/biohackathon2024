<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8098026</article-id>
    <article-id pub-id-type="pmid">33070179</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa880</article-id>
    <article-id pub-id-type="publisher-id">btaa880</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MolTrans: Molecular Interaction Transformer for drug–target interaction prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6693-8390</contrib-id>
        <name>
          <surname>Huang</surname>
          <given-names>Kexin</given-names>
        </name>
        <aff><institution>Health Data Science, Harvard University</institution>, Boston, MA 02120, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiao</surname>
          <given-names>Cao</given-names>
        </name>
        <aff><institution>Analytics Center of Excellence, IQVIA</institution>, Cambridge, MA 02139, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glass</surname>
          <given-names>Lucas M</given-names>
        </name>
        <aff><institution>Analytics Center of Excellence, IQVIA</institution>, Cambridge, MA 02139, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sun</surname>
          <given-names>Jimeng</given-names>
        </name>
        <xref rid="btaa880-cor1" ref-type="corresp"/>
        <aff><institution>Department of Computer Science, University of Illinois at Urbana-Champaign</institution>, Urbana, IL 61801, <country country="US">USA</country></aff>
        <!--jimeng@illinois.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lu</surname>
          <given-names>Zhiyong</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa880-cor1">To whom correspondence should be addressed. <email>jimeng@illinois.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-10-18">
      <day>18</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>6</issue>
    <fpage>830</fpage>
    <lpage>836</lpage>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>25</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa880.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Drug–target interaction (DTI) prediction is a foundational task for <italic toggle="yes">in-silico</italic> drug discovery, which is costly and time-consuming due to the need of experimental search over large drug compound space. Recent years have witnessed promising progress for deep learning in DTI predictions. However, the following challenges are still open: (i) existing molecular representation learning approaches ignore the sub-structural nature of DTI, thus produce results that are less accurate and difficult to explain and (ii) existing methods focus on limited labeled data while ignoring the value of massive unlabeled molecular data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose a Molecular Interaction Transformer (MolTrans) to address these limitations via: (i) knowledge inspired sub-structural pattern mining algorithm and interaction modeling module for more accurate and interpretable DTI prediction and (ii) an augmented transformer encoder to better extract and capture the semantic relations among sub-structures extracted from massive unlabeled biomedical data. We evaluate MolTrans on real-world data and show it improved DTI prediction performance compared to state-of-the-art baselines.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The model scripts are available at <ext-link xlink:href="https://github.com/kexinhuang12345/moltrans" ext-link-type="uri">https://github.com/kexinhuang12345/moltrans</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>SCH SCH-2014438</award-id>
        <award-id>IIS-1418511</award-id>
        <award-id>CCF-1533768</award-id>
        <award-id>IIS-1838042</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 1R01NS107291-01</award-id>
        <award-id>R56HL138415</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>IQVIA</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Drug discovery is notoriously costly and time-consuming due to the need of experimental search over large drug compound space. Drug–target protein interaction (DTI) prediction serves as the foundation for finding new drugs (i.e. virtual screening) and new indications of existing drugs (i.e. drug repositioning), since the therapeutic effects of drug compounds are detected by examining DTIs (<xref rid="btaa880-B15" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2011</xref>). During the compound identification process, researchers often need to conduct assay experiments and search over 97 M possible compounds in a candidate database (<xref rid="btaa880-B3" ref-type="bibr">Broach <italic toggle="yes">et al.</italic>, 1996</xref>).</p>
    <p>Luckily, with massive biomedical data and knowledge being collected and available, along with the advances of deep learning technologies which demonstrated huge success in many application areas, the drug discovery process particularly DTI prediction has been significantly enhanced. Recently, various deep models have shown encouraging performance in DTI predictions. They often take drug and protein data as inputs, cast DTI as a classification problem, and make prediction by feeding the inputs through deep learning models such as deep neural network (DNN) (<xref rid="btaa880-B31" ref-type="bibr">Unterthiner <italic toggle="yes">et al.</italic>, 2014</xref>), deep belief network (DBN) (<xref rid="btaa880-B34" ref-type="bibr">Wen <italic toggle="yes">et al.</italic>, 2017</xref>) and convolutional neural network (CNN) (<xref rid="btaa880-B22" ref-type="bibr">Mayr <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa880-B23" ref-type="bibr">Öztürk <italic toggle="yes">et al.</italic>, 2018</xref>, <xref rid="btaa880-B24" ref-type="bibr">2019</xref>). Despite these efforts, the following challenges are still open.
</p>
    <list list-type="order">
      <list-item>
        <p><bold>Inadequate modeling of interaction mechanism</bold>. Existing works (<xref rid="btaa880-B9" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa880-B23" ref-type="bibr">Öztürk <italic toggle="yes">et al.</italic>, 2018</xref>, <xref rid="btaa880-B24" ref-type="bibr">2019</xref>) learn molecular representation and make prediction based on whole molecular structure of drugs and proteins, ignoring that the interactions are sub-structural—only involving relevant sub-structures of drugs and proteins (<xref rid="btaa880-B16" ref-type="bibr">Jia <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btaa880-B28" ref-type="bibr">Schenone <italic toggle="yes">et al.</italic>, 2013</xref>). The full-structural molecular representations introduce noises and affect the prediction performance. Also, the learned representations are hard to interpret since they do not provide a tractable path to indicate which sub-structures of drugs and proteins contribute to the interactions.</p>
      </list-item>
      <list-item>
        <p><bold>Restricted to limited labeled data</bold>. Previous works (<xref rid="btaa880-B9" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa880-B19" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa880-B23" ref-type="bibr">Öztürk <italic toggle="yes">et al.</italic>, 2018</xref>, <xref rid="btaa880-B24" ref-type="bibr">2019</xref>; <xref rid="btaa880-B34" ref-type="bibr">Wen <italic toggle="yes">et al.</italic>, 2017</xref>) focus on data in hand and limit the scope within several thousands of drugs and proteins while ignoring the vast (e.g. order of millions) unlabeled biomedical data available. The model architectures in previous works are also not designed to enable the integration of massive dataset.</p>
      </list-item>
    </list>
    <p><bold>Present Work</bold>. To solve these challenges, we propose a transformer (<xref rid="btaa880-B32" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic>, 2017</xref>)-based bio-inspired molecular data representation method [coined as Molecular Interaction Transformer (MolTrans)] to leverage vast unlabeled data for <italic toggle="yes">in-silico</italic> DTI prediction. MolTrans is enabled by the following technical contributions:
</p>
    <list list-type="order">
      <list-item>
        <p><bold>Knowledge inspired representation and interaction modeling for more accurate and explainable prediction</bold>. Inspired by the knowledge that DTI is sub-structural, MolTrans derives a data-driven method called Frequent Consecutive Sub-sequence (FCS) mining that is adaptable to extract high-quality fit-sized sub-structures for both protein and drug. In addition, MolTrans includes a bio-inspired interaction module imitating the real biological DTI process. The new sub-structure fingerprints enable a tractable path for understanding which sub-structure combination has more relevance to the outcome through an explicit map in the interaction module.</p>
      </list-item>
      <list-item>
        <p><bold>Leverage massive unlabeled biomedical data</bold>. MolTrans mines through millions of drugs and proteins sequences from multiple unlabeled data sources to extract high-quality sub-structures of drugs and proteins. The vast data result in a much higher quality sub-structures than using small training dataset alone. We also augment the representation using transformers (<xref rid="btaa880-B32" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic>, 2017</xref>), which captures the complex signals among the large sequential sub-structures outputs generated from the unlabeled data.</p>
      </list-item>
    </list>
    <p>We provide a comprehensive performance comparison of state-of-the-art methods on various realistic drug discovery settings include unseen drug/target problems and in scarce training dataset setup. We show empirically that MolTrans has robust improved predictive performance over state-of-the-art baselines by up to 25% over the best performing baseline.</p>
    <p><bold>Related work</bold>. Numerous computational methods have been developed for DTI prediction problem. Similarity-based methods such as kernel regression (<xref rid="btaa880-B25" ref-type="bibr">Pahikkala <italic toggle="yes">et al.</italic>, 2015</xref>) and matrix factorization (<xref rid="btaa880-B37" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2013</xref>) methods exploit known DTI’s drug–target similarity information and infer new ones. However, these methods are shown to be not generalizable to different protein classes (<xref rid="btaa880-B34" ref-type="bibr">Wen <italic toggle="yes">et al.</italic>, 2017</xref>). Feature-based methods feed numerical descriptors of drug and proteins into downstream prediction models. Popular numerical descriptors include ECFP (<xref rid="btaa880-B27" ref-type="bibr">Rogers and Hahn, 2010</xref>) and PubChem (<xref rid="btaa880-B1" ref-type="bibr">Bolton <italic toggle="yes">et al.</italic>, 2008</xref>) for drugs, Composition–Transition–Distribution (CTD; <xref rid="btaa880-B6" ref-type="bibr">Dubchak <italic toggle="yes">et al.</italic>, 1995</xref>) and protein sequence composition descriptor (PSC; <xref rid="btaa880-B4" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2013</xref>) for proteins. Classic machine learning methods such as gradient boosting (<xref rid="btaa880-B12" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2017</xref>) have shown promises in predictive performance. Recently, deep learning-based methods (<xref rid="btaa880-B24" ref-type="bibr">Öztürk <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa880-B30" ref-type="bibr">Tsubaki <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa880-B31" ref-type="bibr">Unterthiner <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btaa880-B34" ref-type="bibr">Wen <italic toggle="yes">et al.</italic>, 2017</xref>) have shown further improvement of performance due to its capability to capture complex non-linear signals of DTI. MolTrans differs from existing works with (i) its knowledge-driven model architecture design rather than direct application of existing deep learning models; (ii) emphasis on interpretability instead of predictive performance alone to potentially aid medical chemists for better decision making and (iii) usage of external drug and target data to complement interaction dataset.</p>
    <p>
      <inline-graphic xlink:href="btaa880ilf1.jpg"/>
    </p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Problem definition</title>
      <p>We formulate the DTI prediction as a classification task to determine whether a pair of drug and target protein will interact. In our setting, drug is represented by the Simplified Molecular Input Line Entry System (SMILES) <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which consists of a sequence of chemical atoms and bonds tokens (e.g. C, O, S), generated by depth-first traversal over the molecule graph. We denote <bold>S</bold> for drug’s SMILES representation. Target protein, denoted as <bold>A</bold>, is represented by a sequence of protein tokens, where each token is one of the 23 amino acids. The notation table is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>. The DTI prediction task is defined as below.</p>
      <p>Problem 1 (<bold>DTI Prediction</bold>). Given compound sequence <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for <italic toggle="yes">n</italic> drugs and protein sequence <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for <italic toggle="yes">m</italic> proteins, the DTI prediction task can be casted as to learn a function mapping <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>→</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> from drug–target pairs to an interaction probability score.</p>
    </sec>
    <sec>
      <title>2.2 The MolTrans method</title>
      <p>The MolTrans framework learns to predict DTI as follows. Given the input drug and protein data, a FCS mining module first decomposes them into a set of explicit sequences of sub-structures using a specialized decomposition algorithm. The outputs are then fed into a augmented transformer embedding module to obtain an augmented contextual embedding for each sub-structure through transformer encoders (<xref rid="btaa880-B32" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic>, 2017</xref>). Next, in the interaction prediction module, drug sub-structures are paired with protein sub-structures with pairwise interaction scores. A CNN layer is later applied on the interaction map to capture higher-order interactions. Finally, a decoder module outputs a score indicating the probability of pairwise interactions. Method illustration is provided in<xref rid="btaa880-F1" ref-type="fig"> Fig. 1.</xref></p>
      <sec>
        <title>2.2.1 FCS mining module</title>
        <p>Driven by the domain knowledge that DTI happens in a sub-structural level, MolTrans first decomposes molecular sequence for proteins and drugs into sub-structures. In particular, we propose a data-driven sequential pattern mining algorithm called FCS algorithm to find recurring sub-sequences across drug and protein databases. Inspired by the invention of sub-word units in the natural language processing field (<xref rid="btaa880-B8" ref-type="bibr">Gage, 1994</xref>; <xref rid="btaa880-B29" ref-type="bibr">Sennrich <italic toggle="yes">et al.</italic>, 2015</xref>), FCS aims to generate a set of hierarchy of frequent sub-sequences for sequences.</p>
        <p>The algorithm is summarized in Algorithm 1. FCS decomposes each sequence of protein/drug hierarchically into sub-sequences, smaller sub-sequences and individual atoms/amino acids symbols. FCS first initializes a vocabulary set <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">V</mml:mi></mml:math></inline-formula> of distinctive amino acid tokens or SMILES strings characters and given the tokens, tokenizes the entire drug/protein corpus. We call the tokenized set <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">W</mml:mi></mml:math></inline-formula>. Then, it scans through <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">W</mml:mi></mml:math></inline-formula> and identifies the most frequent consecutive tokens (A, B). FCS then updates every (A, B) in the tokenized set <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">W</mml:mi></mml:math></inline-formula> with the new token (AB) and also adds this new token to the vocabulary set <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">V</mml:mi></mml:math></inline-formula>. Then this process of <italic toggle="yes">scan</italic>, <italic toggle="yes">identify</italic>, <italic toggle="yes">update</italic> is repeated until no frequent token is above the threshold <italic toggle="yes">θ</italic> or the size of <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">V</mml:mi></mml:math></inline-formula> reaches a pre-defined maximum value <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>ℓ</mml:mo></mml:math></inline-formula>. Through this operation, frequent sub-sequences are merged into one token and sub-sequences that are not frequent enough are decomposed into a set of shorter tokens. In the end, for a drug/protein, FCS results in a sequence <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of sub-structural drug/target proteins with size of <italic toggle="yes">k</italic>, where each <italic toggle="yes">C<sub>i</sub></italic> is from the set <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi mathvariant="script">V</mml:mi></mml:math></inline-formula>.</p>
        <p>Using FCS algorithm, MolTrans converts input drug and target to a sequence of explicit sub-structures <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, respectively. The significance of FCS is threefolds:
</p>
        <list list-type="order">
          <list-item>
            <p>It distinguishes from previous sub-structure fingerprinting methods as it is more explainable. Explicit sub-structure fingerprint such as PubChem encoding has on average 100 granular sub-structures for a small molecule where many sub-structures are a subset of other ones, making it intractable to know which sub-structure leads to the outcome. In contrast, FCS drug encoding is capable of giving explicit hints as it decomposes each drug molecule into discrete and moderate size <italic toggle="yes">partitions</italic> of sub-structures as shown in Section 3.7. It allows for leveraging the massive unlabeled data for improved sub-structure mining. For example, we use the Uniprot dataset (<xref rid="btaa880-B2" ref-type="bibr">Boutet <italic toggle="yes">et al.</italic>, 2007</xref>) consists of 560 823 unique protein sequences and the ChEMBL database (<xref rid="btaa880-B10" ref-type="bibr">Gaulton <italic toggle="yes">et al.</italic>, 2012</xref>) which includes 1 870 461 drug SMILES strings. We observe that the quality of the mined sub-structures originates from the massive unlabeled data we used. In small datasets, the occurrences of many useful sub-structures are below the reasonable minimum frequency whereas a large aggregation dataset can successfully identify them with a larger sequences pool. We also show that the encoding has better predictive power when using massive unlabeled data compared to using small datasets, in Section 3.8.</p>
          </list-item>
          <list-item>
            <p>FCS can capture fundamental and meaningful biomedical semantics. The generated sub-structures are associated with fundamental unit of drugs and proteins that recur frequently. We find that the FCS algorithm identify similar set of fundamental biochemical sub-structures given different dataset characteristics such as different types of organisms of the protein dataset and the drug-likeliness of drug dataset, suggesting the robustness of FCS algorithm (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>). In general, we apply a more general dataset (e.g. ChEMBL) instead of a focused dataset (e.g. approved drugs in DrugBank) because larger dataset can improve downstream predictive performance (Section 3.8).</p>
          </list-item>
        </list>
      </sec>
      <sec>
        <title>2.2.2 Augmented transformer embedding module</title>
        <p>To capture the chemical semantics of sub-structures, MolTrans includes an augmented embedding module where it first initializes a learnable sub-structure lookup dictionary and then augment the embedding with the contextual sub-structural information via transformer encoders (<xref rid="btaa880-B32" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic>, 2017</xref>). The transformer is a state-of-the-art deep learning architecture that leverages self-attention mechanism to generate contextual embedding. It was originally developed to natural language processing tasks. Here, we adapted it for molecule representation learning. In our setting, the self-attention mechanism in the transformer encoder modifies each input sub-structure embedding by learning from all the sub-structures from the same molecule. The resulting sub-structural embedding is better because it is contextual by taking account into the complex chemical relationships among the neighboring sub-structures.</p>
        <p>Concretely, for each input drug–target pair, we transform the corresponding sequence of sub-structures <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> into two matrices <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">k</italic>/<italic toggle="yes">l</italic> is the total size of sub-structures for drug/protein or the cardinality of the vocabulary set <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">V</mml:mi></mml:math></inline-formula> from FCS algorithm, Θ<sub><italic toggle="yes">p</italic></sub> and Θ<sub><italic toggle="yes">d</italic></sub> are the maximum lengths of sub-structure sequences for protein and drug, and each column <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">M</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">M</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is a one-hot vector corresponding to the sub-structure index for the <italic toggle="yes">i</italic>th sub-structure of protein sequence and <italic toggle="yes">j</italic>th sub-structure of drug sequence. The content embedding <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>cont</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>cont</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for each protein and drug is generated via a learnable dictionary lookup matrix <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>cont</mml:mtext></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mo>ϑ</mml:mo><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>cont</mml:mtext></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mo>ϑ</mml:mo><mml:mo>×</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> such that
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>cont</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>cont</mml:mtext></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">M</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>cont</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>cont</mml:mtext></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">M</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where ϑ is the size of latent embedding for each sub-structure.</p>
        <p>Since MolTrans uses sequential sub-structures, we also include a positional embedding <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>pos</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>pos</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> via a lookup dictionary (<xref rid="btaa880-B32" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic>, 2017</xref>) <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>pos</mml:mtext></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mo>ϑ</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>pos</mml:mtext></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mo>ϑ</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>pos</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>pos</mml:mtext></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>pos</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>pos</mml:mtext></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a single hot vector where <italic toggle="yes">i</italic>/<italic toggle="yes">j</italic>th position is 1.</p>
        <p>The final embedding <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are generated via the sum of content and positional embedding:
<disp-formula id="E3"><label>(1)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>cont</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>pos</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>cont</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:mrow><mml:msub><mml:mi>pos</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>The models above outputs a set of independent sub-structure embedding. However, these sub-structures have chemical relationships (e.g. Octet rules) among themselves to capture these contextual information, we further augment the embedding using a transformer encoder layers (<xref rid="btaa880-B32" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic>, 2017</xref>):
<disp-formula id="E4"><label>(2)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>Transformer</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Protein</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>Transformer</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Drug</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      </sec>
      <sec>
        <title>2.2.3 Interaction prediction module</title>
        <p>MolTrans includes an interaction module that consists of two layers: (i) an interaction tensor to model pairwise sub-structural interaction and (ii) a CNN layer over interaction map to extract neighborhood interaction.</p>
        <p><bold>Pairwise interaction</bold>. To model the pairwise interaction, for each sub-sequence <italic toggle="yes">i</italic> in protein and sub-sequence <italic toggle="yes">j</italic> in drug, we have
<disp-formula id="E5"><label>(3)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi mathvariant="normal">F</mml:mi></mml:math></inline-formula> is a function that measures the interaction between the pairs. It can be any function such as sum, average and dot product. Therefore, after this layer, we have a tensor <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:mi>d</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mo>Φ</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:mi>d</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the length of sub-sequences for drug/protein, respectively, and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mo>Φ</mml:mo></mml:math></inline-formula> is the size of the output of function <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi mathvariant="normal">F</mml:mi></mml:math></inline-formula>, where each column in this tensor takes account into the interaction of individual sub-structure of proteins and drugs. To provide explainability, we favor dot product as the aggregation function because it generates a single scalar that explicitly measures the intensity of interaction between individual target-drug sub-structural pair. As dot product output is one-dimensional for every pair, <bold>I</bold> becomes a two-dimensional interaction map. If a value in the map is high, it will be activated in the downstream layer and have a higher likelihood of DTI interaction. Through end-to-end learning, if a pair of sub-structures indeed interact, they will have high interaction score in the corresponding sub-structure pair position in the interaction map. Thus, by examining this map, we directly see which sub-structure pairs contribute to the final outcome.</p>
        <p><bold>Neighborhood interaction</bold>. Nearby sub-structure of proteins and drugs influence each other in triggering the interactions. Hence, besides modeling the individual pairwise interaction, it is also necessary to model the interaction to the nearby regions. We achieve this through a CNN (<xref rid="btaa880-B17" ref-type="bibr">Krizhevsky <italic toggle="yes">et al.</italic>, 2012</xref>) layer on top of the interaction map <bold>I</bold>. The intuition is that by applying several order-invariant local convolution filters, interaction to nearby regions can be captured and aggregated. We obtain the output representation <bold>O</bold> of the input drug–target pair:
<disp-formula id="E6"><label>(4)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">O</mml:mi><mml:mo>=</mml:mo><mml:mtext>CNN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>This interaction module is inspired from the Deep Interactive Inference Network (<xref rid="btaa880-B11" ref-type="bibr">Gong <italic toggle="yes">et al.</italic>, 2018</xref>). Thanks to this explicit interaction modeling, we can later visualize the strength of individual sub-structural interaction pair from the interaction map. To output a probability indicating the likelihood of interaction, we first flatten the <bold>O</bold> into a vector and use a linear layer parameterized by weight matrix <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and bias vector <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E7"><label>(5)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo>=</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mtext>FLATTEN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p>
        <p>The entire network with parameters <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>cont</mml:mtext></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>cont</mml:mtext></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>pos</mml:mtext></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mtext>pos</mml:mtext></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula><inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the transformer encoders weights and CNN weights can be jointly optimized through the binary classification loss:
<disp-formula id="E8"><label>(6)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <bold>Y</bold> is the ground truth label.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Implementation</title>
      <p>MolTrans is implemented in PyTorch (<xref rid="btaa880-B26" ref-type="bibr">Paszke <italic toggle="yes">et al.</italic>, 2019</xref>). For the FCS algorithm, we set the minimum number of occurrences of sub-structures in the dataset to be 500 for drugs and proteins, which results in 23 532 drug sub-structures and 16 693 protein sub-structures. For transformer encoders, we use two layers of transformer encoders for both drug and proteins. The input embedding is of size 384 and we set 12 attention heads for each transformer encoder with intermediate dimension 1536. We set the maximum length of sequence for drug to be 50 and protein to be 545 to cover 95% of them in the dataset. We cut/pad for the parts that are above/below the maximum length. We show that the model performance is not biased against sequence length in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S2. For the CNN, we use three filters with kernel size three. For optimization hyper-parameters, we use Adam optimizer with learning rate of 1e−5. We set the batch size to be 64 and we allow it to run for 30 epochs. It converges between 8 and 15 epochs. The dropout rate is 0.1.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Result</title>
    <p>We design experiments to answer the following questions.</p>
    <p>Q1: Does MolTrans improve DTI predictive performance?</p>
    <p>Q2: How well does MolTrans tackle the unseen drug/target cases?</p>
    <p>Q3: How does MolTrans respond to large number of missing data?</p>
    <p>Q4: How does performance vary given different protein families?</p>
    <p>Q5: Does MolTrans provide useful knowledge about DTI?</p>
    <p>Q6: How does each component of MolTrans contribute to the predictive performance gain?</p>
    <sec>
      <title>3.1 Experimental setup</title>
      <p><bold>Dataset</bold>. We use the MINER DTI dataset from BIOSNAP collection (<xref rid="btaa880-B38" ref-type="bibr">Zitnik <italic toggle="yes">et al.</italic>, 2018a</xref>) as our main dataset of experiments. It consists of 4510 drug nodes and 2181 protein targets, and 13 741 DTI pairs from DrugBank (<xref rid="btaa880-B35" ref-type="bibr">Wishart <italic toggle="yes">et al.</italic>, 2008</xref>). BIOSNAP dataset only contains positive DTI pairs. For negative pairs, we sample from the unseen pairs, following common practice (<xref rid="btaa880-B36" ref-type="bibr">Zhang and Chen, 2018</xref>; <xref rid="btaa880-B39" ref-type="bibr">Zitnik <italic toggle="yes">et al.</italic>, 2018b</xref>). We obtain a balanced dataset with equal positive and negative samples. In addition to BIOSNAP, we also include two benchmark datasets in the main predictive performance comparison experiment. DAVIS consists of wet lab assay <italic toggle="yes">K</italic><sub>d</sub> values among 68 drugs and 379 proteins (<xref rid="btaa880-B5" ref-type="bibr">Davis <italic toggle="yes">et al.</italic>, 2011</xref>) and BindingDB consists of <italic toggle="yes">K</italic><sub>d</sub> values among 10 665 drugs and 1413 proteins (<xref rid="btaa880-B21" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2007</xref>). DTI pairs that have <italic toggle="yes">K</italic><sub>d</sub> values &lt;30 units are considered positive. For balanced training, we sub-sample the same number of negative DTI pairs as the positive samples for training set. We keep the dataset negative ratios in the validation and testing set. Dataset statistics are provided in <xref rid="btaa880-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btaa880-T1">
        <label>Table 1.</label>
        <caption>
          <p>Dataset statistics</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th align="left" rowspan="1" colspan="1"># Drugs</th>
              <th align="left" rowspan="1" colspan="1"># Proteins</th>
              <th align="left" rowspan="1" colspan="1"># Pos Interactions</th>
              <th align="left" rowspan="1" colspan="1"># Neg Interactions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BIOSNAP</td>
              <td rowspan="1" colspan="1">4510</td>
              <td rowspan="1" colspan="1">2181</td>
              <td rowspan="1" colspan="1">9619/1374/2748</td>
              <td rowspan="1" colspan="1">9619/1374/2748</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DAVIS</td>
              <td rowspan="1" colspan="1">68</td>
              <td rowspan="1" colspan="1">379</td>
              <td rowspan="1" colspan="1">1043/160/303</td>
              <td rowspan="1" colspan="1">1043/2846/5708</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BindingDB</td>
              <td rowspan="1" colspan="1">10 665</td>
              <td rowspan="1" colspan="1">1413</td>
              <td rowspan="1" colspan="1">6334/927/1905</td>
              <td rowspan="1" colspan="1">6334/5717/11 384</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: For the number of interactions columns, we include training/validation/testing interactions statistics in onefold of data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p><bold>Metrics</bold>. We use ROC-AUC (area under the receiver operating characteristic curve) and PR-AUC (area under the precision–recall curve) as metrics to measure the binary classification performance. In addition, we use sensitivity and specificity metrics where the threshold is the one that has the best <italic toggle="yes">F</italic>1 score in the validation set.</p>
      <p><bold>Evaluation strategies</bold>. We divided the dataset into training, validation and testing sets in a 7:1:2 ratio. For every experiment, we conduct five independent runs with different random splits of dataset. We then select the best performing model based on ROC-AUC performance from the validation set. The selected model via validation is then evaluated on the test set with the result reported below.</p>
      <p><bold>Technologies</bold>. We use a server with 2 Intel Xeon E5-2670v2 2.5 GHz CPUs, 128 GB RAM and 2 NVIDIA Tesla P40 GPUs.</p>
    </sec>
    <sec>
      <title>3.2 Baselines</title>
      <p>We compared MolTrans with the following baselines. We focus on state-of-the-art deep learning models as they have demonstrated superior performance over shallow models.
</p>
      <list list-type="order">
        <list-item>
          <p><bold>LR</bold> (<xref rid="btaa880-B4" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btaa880-B27" ref-type="bibr">Rogers and Hahn, 2010</xref>) applies a logistic regression model on the concatenated drug and protein feature vectors. We experiment on all the combinations for ECFP4 (<xref rid="btaa880-B27" ref-type="bibr">Rogers and Hahn, 2010</xref>) and PubChem (<xref rid="btaa880-B33" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2009</xref>) for drugs and PSC (<xref rid="btaa880-B4" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2013</xref>) and CTD (<xref rid="btaa880-B6" ref-type="bibr">Dubchak <italic toggle="yes">et al.</italic>, 1995</xref>) for proteins. We find ECFP4 for drugs and PSC for protein has the highest performance.</p>
        </list-item>
        <list-item>
          <p><bold>DNN</bold> uses a three layer DNN with hidden size 1024 on top of the ECFP4 and PSC concatenated vector.</p>
        </list-item>
        <list-item>
          <p><bold>GNN-CPI</bold> (<xref rid="btaa880-B30" ref-type="bibr">Tsubaki <italic toggle="yes">et al.</italic>, 2019</xref>) uses graph neural network to encode drugs and use CNN to encode proteins. The latent vectors are then concatenated into a neural network for compound–protein interaction prediction. We follow the same hyper-parameter setting described in the paper.</p>
        </list-item>
        <list-item>
          <p><bold>DeepDTI</bold> (<xref rid="btaa880-B34" ref-type="bibr">Wen <italic toggle="yes">et al.</italic>, 2017</xref>) models DTI using DBN (<xref rid="btaa880-B13" ref-type="bibr">Hinton, 2009</xref>), which is a stack of Restricted Boltzmann Machines (<xref rid="btaa880-B14" ref-type="bibr">Hinton, 2012</xref>). It uses the concatenation of ECFP2, ECFP4, ECFP6 as the drug feature and uses PSC for protein features. We optimize the hyper-parameters described from the paper based on validation set performance.</p>
        </list-item>
        <list-item>
          <p><bold>DeepDTA</bold> (<xref rid="btaa880-B23" ref-type="bibr">Öztürk <italic toggle="yes">et al.</italic>, 2018</xref>) applies CNN on both raw SMILES string and protein sequence to extract local residue patterns. The task is to predict binding affinity values. We add a Sigmoid activation function in the end to change it to a binary classification problem and we conduct hyper-parameter search to ensure fairness.</p>
        </list-item>
        <list-item>
          <p><bold>DeepConv-DTI</bold> (<xref rid="btaa880-B19" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2019</xref>) uses CNN and global max pooling layer to extract various length local patterns in protein sequence and applies fully connected layer on drug fingerprint ECFP4. It conducts extensive experiment on different datasets and is the state-of-the-art model in DTI binary prediction task. We follow the same hyper-parameter setting described in the paper.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>3.3 Q1: MolTrans achieves superior predictive performance</title>
      <p>To answer Q1, we randomly select 20% drug protein pairs as test set. <xref rid="btaa880-T2" ref-type="table">Table 2</xref> shows MolTrans has consistently better predictive baselines in the DTI prediction setting in ROC-AUC and PR-AUC across all datasets. MolTrans has up to 25% increase over best performing baseline (DAVIS PR-AUC). Note that due to different thresholds across different methods, the sensitivity and specificity may vary.</p>
      <table-wrap position="float" id="btaa880-T2">
        <label>Table 2.</label>
        <caption>
          <p>Performance comparison (five random runs)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th align="left" rowspan="1" colspan="1">ROC-AUC</th>
              <th align="left" rowspan="1" colspan="1">PR-AUC</th>
              <th align="left" rowspan="1" colspan="1">Sensitivity</th>
              <th align="left" rowspan="1" colspan="1">Specificity</th>
              <th align="left" rowspan="1" colspan="1">Threshold</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="6" rowspan="1">Dataset 1: BIOSNAP</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> LR</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE41">
                  <mml:math id="IM41" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.846</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE42">
                  <mml:math id="IM42" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.850</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.011</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE43">
                  <mml:math id="IM43" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.755</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.039</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE44">
                  <mml:math id="IM44" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.800</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.018</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.434</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DNN</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE45">
                  <mml:math id="IM45" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.849</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.003</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE46">
                  <mml:math id="IM46" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.855</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.010</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE47">
                  <mml:math id="IM47" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.776</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.040</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE48">
                  <mml:math id="IM48" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.838</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.024</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.499</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GNN-CPI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE49">
                  <mml:math id="IM49" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.879</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.007</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE50">
                  <mml:math id="IM50" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.890</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE51">
                  <mml:math id="IM51" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.780</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.014</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE52">
                  <mml:math id="IM52" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.819</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.012</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.349</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepDTI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE53">
                  <mml:math id="IM53" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.876</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE54">
                  <mml:math id="IM54" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.876</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.006</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.789±0.027</bold>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE56">
                  <mml:math id="IM55" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.845</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.017</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.347</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepDTA</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE57">
                  <mml:math id="IM56" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.876</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE58">
                  <mml:math id="IM57" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.883</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.006</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE59">
                  <mml:math id="IM58" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.781</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE60">
                  <mml:math id="IM59" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.824</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.012</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.466</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepConv-DTI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE61">
                  <mml:math id="IM60" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.883</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE62">
                  <mml:math id="IM61" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.889</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE63">
                  <mml:math id="IM62" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.770</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.023</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE64">
                  <mml:math id="IM63" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.832</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.016</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.441</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> MolTrans</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE65">
                  <mml:math id="IM64" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.895</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE66">
                  <mml:math id="IM65" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.901</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE67">
                  <mml:math id="IM66" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.775</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.032</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE68">
                  <mml:math id="IM67" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.851</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.014</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.431</td>
            </tr>
            <tr>
              <td colspan="6" rowspan="1">Dataset 2: DAVIS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> LR</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE69">
                  <mml:math id="IM68" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.835</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.010</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE70">
                  <mml:math id="IM69" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.232</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.023</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE71">
                  <mml:math id="IM70" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.699</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.051</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE72">
                  <mml:math id="IM71" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.842</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.033</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.399</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DNN</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE73">
                  <mml:math id="IM72" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.864</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.009</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE74">
                  <mml:math id="IM73" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.258</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.024</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE75">
                  <mml:math id="IM74" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.764</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.045</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE76">
                  <mml:math id="IM75" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.860</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.038</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.489</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GNN-CPI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE77">
                  <mml:math id="IM76" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.840</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.012</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE78">
                  <mml:math id="IM77" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.269</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.020</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE79">
                  <mml:math id="IM78" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.696</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.047</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE80">
                  <mml:math id="IM79" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.842</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.039</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.487</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepDTI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE81">
                  <mml:math id="IM80" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.861</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE82">
                  <mml:math id="IM81" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.231</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.006</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE83">
                  <mml:math id="IM82" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.751</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE84">
                  <mml:math id="IM83" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.853</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.012</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.387</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepDTA</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE85">
                  <mml:math id="IM84" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.880</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.007</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE86">
                  <mml:math id="IM85" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.302</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.044</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE87">
                  <mml:math id="IM86" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.764</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.045</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE88">
                  <mml:math id="IM87" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.865</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.020</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.482</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepConv-DTI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE89">
                  <mml:math id="IM88" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.884</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.008</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE90">
                  <mml:math id="IM89" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.299</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.039</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE91">
                  <mml:math id="IM90" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.754</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.040</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE92">
                  <mml:math id="IM91" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.880</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.024</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.438</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> MolTrans</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE93">
                  <mml:math id="IM92" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.907</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE94">
                  <mml:math id="IM93" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.404</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.016</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE95">
                  <mml:math id="IM94" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.800</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.022</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE96">
                  <mml:math id="IM95" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.876</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.013</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.447</td>
            </tr>
            <tr>
              <td colspan="6" rowspan="1">Dataset 3: BindingDB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> LR</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE97">
                  <mml:math id="IM96" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.887</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE98">
                  <mml:math id="IM97" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.557</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE99">
                  <mml:math id="IM98" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.741</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.013</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE100">
                  <mml:math id="IM99" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.896</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.011</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.394</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DNN</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE101">
                  <mml:math id="IM100" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.908</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.003</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE102">
                  <mml:math id="IM101" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.613</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE103">
                  <mml:math id="IM102" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.769</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.028</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE104">
                  <mml:math id="IM103" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.914</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.021</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.371</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GNN-CPI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE105">
                  <mml:math id="IM104" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.900</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE106">
                  <mml:math id="IM105" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.578</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE107">
                  <mml:math id="IM106" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.754</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE108">
                  <mml:math id="IM107" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.903</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.011</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.406</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepDTI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE109">
                  <mml:math id="IM108" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.844</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE110">
                  <mml:math id="IM109" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.429</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE111">
                  <mml:math id="IM110" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.651</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.024</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE112">
                  <mml:math id="IM111" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.895</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.023</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.060</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepDTA</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE113">
                  <mml:math id="IM112" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.913</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.003</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE114">
                  <mml:math id="IM113" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.622</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.012</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE115">
                  <mml:math id="IM114" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.780</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.035</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE116">
                  <mml:math id="IM115" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.915</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.016</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.305</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DeepConv-DTI</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE117">
                  <mml:math id="IM116" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.908</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE118">
                  <mml:math id="IM117" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.611</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE119">
                  <mml:math id="IM118" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.781</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.015</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE120">
                  <mml:math id="IM119" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.905</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.013</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.318</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> MolTrans</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE121">
                  <mml:math id="IM120" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.914</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.001</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE122">
                  <mml:math id="IM121" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.622</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.007</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE123">
                  <mml:math id="IM122" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0.797</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn mathvariant="bold">0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE124">
                  <mml:math id="IM123" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.896</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.007</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.355</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic toggle="yes">Note</italic>: MolTrans achieves the best predictive performance across all datasets. The bold value corresponds to the best performance method for each metric.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.4 Q2: MolTrans has competitive performance in unseen drug and target setting</title>
      <p>To imitate the unseen drug/target task, we randomly select 20% drug/target proteins and all DTI pairs associated with these drugs and targets as the test set. The results are in <xref rid="btaa880-T3" ref-type="table">Table 3</xref>. We observe that KronRLS’s performance vary across settings. This is because KronRLS is a similarity-based method; hence, it is susceptible to the data properties in hand. In the unseen drug setting, we find the one-layer LR is better than multi-layers DNN, and is worse than the SOTA methods with more complicated deep model design. This shows the necessity for carefully designed model architecture. We also see that MolTrans has competitive performance against the SOTA deep learning baselines in both settings.</p>
      <table-wrap position="float" id="btaa880-T3">
        <label>Table 3.</label>
        <caption>
          <p>MolTrans has competitive result in both unseen drug and protein settings (shown avg. ROC-AUC of five random runs) on BIOSNAP dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Settings</th>
              <th align="left" rowspan="1" colspan="1">DeepDTI</th>
              <th align="left" rowspan="1" colspan="1">DeepDTA</th>
              <th align="left" rowspan="1" colspan="1">DeepConv-DTI</th>
              <th align="left" rowspan="1" colspan="1">MolTrans</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Unseen drugs</td>
              <td rowspan="1" colspan="1">0.843 ± 0.003</td>
              <td rowspan="1" colspan="1">0.849 ± 0.007</td>
              <td rowspan="1" colspan="1">0.847 ± 0.009</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE125">
                  <mml:math id="IM124" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.853</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.011</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Unseen proteins</td>
              <td rowspan="1" colspan="1">0.759 ± 0.029</td>
              <td rowspan="1" colspan="1">0.767 ± 0.022</td>
              <td rowspan="1" colspan="1">0.766 ± 0.022</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE126">
                  <mml:math id="IM125" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.770</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.029</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p><italic toggle="yes">Note</italic>: The best performing three baselines are used for comparison.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Q3: MolTrans performs best with scarce data</title>
      <p>Although the availability of DTI data is exploding, in some real-world drug discovery pipelines, there are new target proteins or drugs that have only a handful of labels due to budget restriction. Hence, a robust performance under low resource constraint is ideal in DTI setting. We trained each method on 5%, 10%, 20% and 30% of dataset and predict on the rest of them (we use 10% of the test edges as validation set for early stopping). The result is reported in <xref rid="btaa880-T4" ref-type="table">Table 4</xref>. We see that MolTrans is the most robust method. In the contrast, SOTA baselines such as DeepDTI and DeepConv-DTI drop as missing fractions increase. One reason why MolTrans is good on scarce setting is that MolTrans leverages on embeddings from sub-structures which are relatively abundant hence transferable compared to other methods which utilize the entire drugs and proteins.</p>
      <table-wrap position="float" id="btaa880-T4">
        <label>Table 4.</label>
        <caption>
          <p>MolTrans provides best result in high fraction of missing data (shown avg. ROC-AUC of five random runs)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Settings (%)</th>
              <th align="left" rowspan="1" colspan="1">DeepDTI</th>
              <th align="left" rowspan="1" colspan="1">DeepDTA</th>
              <th align="left" rowspan="1" colspan="1">DeepConv-DTI</th>
              <th align="left" rowspan="1" colspan="1">MolTrans</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">70</td>
              <td rowspan="1" colspan="1">0.853 ± 0.004</td>
              <td rowspan="1" colspan="1">0.838 ± 0.004</td>
              <td rowspan="1" colspan="1">0.845 ± 0.003</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE127">
                  <mml:math id="IM126" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.853</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">80</td>
              <td rowspan="1" colspan="1">0.828 ± 0.007</td>
              <td rowspan="1" colspan="1">0.821 ± 0.008</td>
              <td rowspan="1" colspan="1">0.825 ± 0.003</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE128">
                  <mml:math id="IM127" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.832</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.003</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">90</td>
              <td rowspan="1" colspan="1">0.767 ± 0.010</td>
              <td rowspan="1" colspan="1">0.787 ± 0.011</td>
              <td rowspan="1" colspan="1">0.792 ± 0.004</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE129">
                  <mml:math id="IM128" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.802</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">95</td>
              <td rowspan="1" colspan="1">0.659 ± 0.011</td>
              <td rowspan="1" colspan="1">0.762 ± 0.004</td>
              <td rowspan="1" colspan="1">0.726 ± 0.008</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE130">
                  <mml:math id="IM129" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.768</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <p><italic toggle="yes">Note</italic>: The best performing three baselines are used for comparison.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.6 Q4: MolTrans is robust in various protein families</title>
      <p>Target proteins come from different proteins families. It is important that the prediction algorithm is not biased toward one particular protein family. In this experiment, we test on the predictive performance on four of the largest druggable targets: enzymes, ion channels, G-protein-coupled receptors (GPCRs) and nuclear receptors. We retrieve one test set of BIOSNAP and map the target proteins to the four protein families using GtoPdb database (<ext-link xlink:href="https://www.guidetopharmacology.org/targets.jsp" ext-link-type="uri">https://www.guidetopharmacology.org/targets.jsp</ext-link>). We find 1908 enzymes interactions, 533 GPCRs interactions, 496 ion channels interactions and 104 nuclear receptors interactions. We find MolTrans is robust in all of the above individual protein family (<xref rid="btaa880-F2" ref-type="fig">Fig. 2</xref>). Particularly, enzymes, GPCRs and ion channels have higher performance than the overall protein classes.</p>
      <fig position="float" id="btaa880-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>MolTrans workflow: (<bold>a</bold>) MolTrans utilizes vast unlabeled data. (<bold>b</bold>) Given the input pair of drug <bold>S</bold> and protein <bold>A</bold>, MolTrans extracts a sequence of sub-structures <inline-formula id="IE131"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE132"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> via Algorithm <xref rid="btaa880-B1" ref-type="bibr">1</xref>. (<bold>c</bold>) Each sub-structure is embedded into a latent feature vector <inline-formula id="IE133"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE134"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> through a learnable embedding table via <xref rid="E3" ref-type="disp-formula">Equation (1)</xref>. Then, drug/protein sequence of sub-structure embedding is fed into drug/target transformer encoders, respectively, to obtain an augmented contextual representation <inline-formula id="IE135"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE136"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> via <xref rid="E4" ref-type="disp-formula">Equation (2)</xref>. (d) An interaction map <bold>I</bold> measuring interaction intensity among sub-structures is generated via <xref rid="E5" ref-type="disp-formula">Equation (3)</xref>. The interaction is further optimized by a CNN layer that models higher-order interaction, which results in a tensor <bold>O</bold> via <xref rid="E6" ref-type="disp-formula">Equation (4)</xref>. (e) A decoder module then feed the tensor for a classifier to output the DTI probability <bold>P</bold> via <xref rid="E7" ref-type="disp-formula">Equation (5)</xref>. All modules are trained end-to-end with the binary classification loss via <xref rid="E8" ref-type="disp-formula">Equation (6)</xref></p>
        </caption>
        <graphic xlink:href="btaa880f1" position="float"/>
      </fig>
      <fig position="float" id="btaa880-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>MolTrans is robust in different protein families</p>
        </caption>
        <graphic xlink:href="btaa880f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.7 Q5: MolTrans allows model understanding</title>
      <p>To answer Q5, we show through examples how the interaction map <bold>I</bold> can provide hints on which sub-structure leads to the interaction. A high value cell in the interaction map stands for a potentially activated interaction between drug and target sub-structure that is important to the final interaction outcome. Thus, to visualize, we generate a heat map for <bold>I</bold> to see which cells have high values. We then select a threshold to mask out the majority of cells that have low values. We then examine literature to see if the remaining cells contain clues to the interaction outcome.</p>
      <p>We first feed drug 2-nonyl n-oxide, and the protein cytochrome b-c1 complex unit 1 into MolTrans, and we visualize the interaction map by filtering scalars that are larger than a threshold in <xref rid="btaa880-F3" ref-type="fig">Figure 3</xref>. We saw the nitrogen oxide group [N+]([O−]) and KNWV has the highest interaction coefficient, matching with the previous study (<xref rid="btaa880-B20" ref-type="bibr">Lightbown and Jackson, 1956</xref>) who showed that nitrogen oxide group is essential for cytochrome inhibition activity. This example supports that MolTrans is capable of providing reasonable cues for understanding the model prediction and possibly shed light on the inner workings of DTI. To add more credibility, we feed Ephrin type-A receptor 4 (Epha4) target and Dasatinib drug into MolTrans, the map shows amino-thiazole group [S(=O)(=O) and N sub-structures] is highlighted with protein motif KF and DVG, which has an overlap with the Epha4–Dasatinib complex described in previous study (<xref rid="btaa880-B7" ref-type="bibr">Farenc <italic toggle="yes">et al.</italic>, 2011</xref>). We also feed the input target protein HDAC2 and the input drug hydroxamic acid. The interaction map assigns the NC(=O) group and the carbon chain with protein sub-structure KK, YG, DIG, DD with high intensity. The suggested ligand sub-structure matches with the observed interaction in HDAC2-SAHA co-complex (<xref rid="btaa880-B18" ref-type="bibr">Lauffer <italic toggle="yes">et al.</italic>, 2013</xref>). The interaction maps for the additional examples are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>.</p>
      <fig position="float" id="btaa880-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>The interaction map on the contributions of sub-structures in DTI, shown as drug 2-nonyl n-oxide interacts with protein cytochrome b-c1 complex unit 10</p>
        </caption>
        <graphic xlink:href="btaa880f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.8 Q6: Ablation study</title>
      <p>We conduct an ablation study on the full data setting with the following setup:
</p>
      <list list-type="order">
        <list-item>
          <p>-CNN: we remove the CNN from interaction module, and flatten the interaction map <bold>I</bold> output and feed into the decoder.</p>
        </list-item>
        <list-item>
          <p>-AugEmbed: we remove the transformer in the augmented embedding module and feed the interaction module with the positional and content embedding.</p>
        </list-item>
        <list-item>
          <p>-Interaction: we further remove the interaction module from -AugEmbed. It degenerates to a decoder on top of the FCS fingerprint. Note that removing the interaction module alone is not a valid model design.</p>
        </list-item>
        <list-item>
          <p>Small: we use smaller dataset to train FCS: DrugBank for drug and BindingDB for protein. We adjust the minimal frequency to output a similar number of sub-structured as FCS-large.</p>
        </list-item>
        <list-item>
          <p>-FCS: we replace FCS embedding with ECFP4 fingerprint for drug and PSC descriptor for protein. The rest of the models remains the same, i.e. they are then fed into transformers, interaction module and decoder.</p>
        </list-item>
      </list>
      <p>From <xref rid="btaa880-T5" ref-type="table">Table 5</xref>, we see CNN, transformers and interaction module contribute to the model final performance. The FCS fingerprint alone has strong predictive performance from -Interaction. In addition, from Small, we see the massive unlabeled data are useful as it enriches the input and boosts the performance. From -FCS, we see our model is adaptable to other popular fingerprints with similar strong performance.</p>
      <table-wrap position="float" id="btaa880-T5">
        <label>Table 5.</label>
        <caption>
          <p>Ablation study (five random runs)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Setup</th>
              <th align="left" rowspan="1" colspan="1">ROC-AUC</th>
              <th align="left" rowspan="1" colspan="1">PR-AUC</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">MolTrans</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE137">
                  <mml:math id="IM136" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.895</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.002</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE138">
                  <mml:math id="IM137" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.901</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−CNN</td>
              <td rowspan="1" colspan="1">0.876 ± 0.003</td>
              <td rowspan="1" colspan="1">0.883 ± 0.006</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−AugEmbed</td>
              <td rowspan="1" colspan="1">0.876 ± 0.004</td>
              <td rowspan="1" colspan="1">0.870 ± 0.004</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−Interaction</td>
              <td rowspan="1" colspan="1">0.847 ± 0.003</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE139">
                  <mml:math id="IM138" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.859</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.005</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Small</td>
              <td rowspan="1" colspan="1">0.888 ± 0.001</td>
              <td rowspan="1" colspan="1">0.888 ± 0.007</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−FCS</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE140">
                  <mml:math id="IM139" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>0.887</mml:mn>
                      <mml:mo>±</mml:mo>
                      <mml:mn>0.004</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.887 ± 0.004</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this work, we introduce MolTrans, an end-to-end biological inspired deep learning-based framework that models DTI process. We test under realistic drug discovery setting and evaluate with state-of-the-art baselines. We demonstrate empirically that MolTrans has competitive performance in accurately predicting DTI under all settings with an improved explainability.</p>
    <p><italic toggle="yes">Financial Support</italic>: This work was in part supported by the National Science Foundation award SCH SCH-2014438, IIS-1418511, CCF-1533768, IIS-1838042, the National Institute of Health award NIH R01 1R01NS107291-01 and R56HL138415, and IQVIA.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data used in the study are from public resources. BIOSNAP is available at http://snap.stanford.edu/biodata/datasets/10002/10002-ChG-Miner.html; DAVIS is available at http://staff.cs.utu.fi/~aatapa/data/DrugTarget/; BindingDB is available at https://www.bindingdb.org/bind/index.jsp. Data processing scripts are also provided in MolTrans GitHub code repository.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa880_Supplementary_Data</label>
      <media xlink:href="btaa880_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa880-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bolton</surname>
 <given-names>E.E.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2008</year>) <part-title>Pubchem: integrated platform of small molecules and biological activities</part-title>. In: <source>Annual Reports in Computational Chemistry</source>. Vol. <volume>4</volume>, 
<publisher-name>Elsevier</publisher-name>, pp. <fpage>217</fpage>–<lpage>241</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa880-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Boutet</surname>
 <given-names>E.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2007</year>) <part-title>UniProtkb/Swiss-Prot</part-title>. In: <source>Plant Bioinformatics</source>. 
<publisher-name>Springer</publisher-name>, pp. <fpage>89</fpage>–<lpage>112</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa880-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Broach</surname>
 <given-names>J.R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>1996</year>) 
<article-title>High-throughput screening for drug discovery</article-title>. <source>Nature</source>, <volume>384</volume>, <fpage>14</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">8895594</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname>
 <given-names>D.-S.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>propy: a tool to generate various modes of Chou’s PseAAC</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>960</fpage>–<lpage>962</lpage>.<pub-id pub-id-type="pmid">23426256</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname>
 <given-names>M.I.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>Comprehensive analysis of kinase inhibitor selectivity</article-title>. <source>Nat. Biotechnol</source>., <volume>29</volume>, <fpage>1046</fpage>–<lpage>1051</lpage>.<pub-id pub-id-type="pmid">22037378</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dubchak</surname>
 <given-names>I.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>1995</year>) 
<article-title>Prediction of protein folding class using global description of amino acid sequence</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>92</volume>, <fpage>8700</fpage>–<lpage>8704</lpage>.<pub-id pub-id-type="pmid">7568000</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farenc</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>Crystal structure of the EphA4 protein tyrosine kinase domain in the apo-and dasatinib-bound state</article-title>. <source>FEBS Lett</source>., <volume>585</volume>, <fpage>3593</fpage>–<lpage>3599</lpage>.<pub-id pub-id-type="pmid">22036717</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gage</surname>
 <given-names>P.</given-names></string-name></person-group> (<year>1994</year>) 
<article-title>A new algorithm for data compression</article-title>. <source>C Users J</source>., <volume>12</volume>, <fpage>23</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa880-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gao</surname>
 <given-names>Y.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) Interpretable drug target prediction using deep neural representation. In: <italic toggle="yes">IJCAI</italic>, pp. 3371–3377, Stockholm, Sweden.</mixed-citation>
    </ref>
    <ref id="btaa880-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaulton</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2012</year>) 
<article-title>ChEMBL: a large-scale bioactivity database for drug discovery</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>D1100</fpage>–<lpage>D1107</lpage>.<pub-id pub-id-type="pmid">21948594</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gong</surname>
 <given-names>Y.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) Natural language inference over interaction space. In: <italic toggle="yes">ICLR</italic>, Vancouver, Canada.</mixed-citation>
    </ref>
    <ref id="btaa880-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname>
 <given-names>T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>SimBoost: a read-across approach for predicting drug–target binding affinities using gradient boosting machines</article-title>. <source>J. Cheminform</source>., <volume>9</volume>, <fpage>24</fpage>.<pub-id pub-id-type="pmid">29086119</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinton</surname>
 <given-names>G.E.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>Deep belief networks</article-title>. <source>Scholarpedia</source>, <volume>4</volume>, <fpage>5947</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa880-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinton</surname>
 <given-names>G.E.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>A practical guide to training restricted Boltzmann machines</article-title>. <source>Neural Networks: Tricks of the Trade</source>, <fpage>599</fpage>–<lpage>619</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa880-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hughes</surname>
 <given-names>J.P.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>Principles of early drug discovery</article-title>. <source>Br. J. Pharmacol</source>., <volume>162</volume>, <fpage>1239</fpage>–<lpage>1249</lpage>.<pub-id pub-id-type="pmid">21091654</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname>
 <given-names>J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>Mechanisms of drug combinations: interaction and network perspectives</article-title>. <source>Nat. Rev. Drug Disc</source>., <volume>8</volume>, <fpage>111</fpage>–<lpage>128</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa880-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Krizhevsky</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2012</year>) ImageNet classification with deep convolutional neural networks. In: <italic toggle="yes">NeurIPS</italic>, pp. 1097–1105, Lake Tahoe, USA.</mixed-citation>
    </ref>
    <ref id="btaa880-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lauffer</surname>
 <given-names>B.E.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Histone deacetylase (HDAC) inhibitor kinetic rate constants correlate with cellular histone acetylation but not transcription and cell viability</article-title>. <source>J. Biol. Chem</source>., <volume>288</volume>, <fpage>26926</fpage>–<lpage>26943</lpage>.<pub-id pub-id-type="pmid">23897821</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>
 <given-names>I.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>DeepConv-DTI: prediction of drug-target interactions via deep learning with convolution on protein sequences</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007129</fpage>.<pub-id pub-id-type="pmid">31199797</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lightbown</surname>
 <given-names>J.</given-names></string-name>, <string-name><surname>Jackson</surname><given-names>F.</given-names></string-name></person-group> (<year>1956</year>) 
<article-title>Inhibition of cytochrome systems of heart muscle and certain bacteria by the antagonists of dihydrostreptomycin: 2-alkyl-4-hydroxyquinoline N-oxides</article-title>. <source>Biochem. J</source>., <volume>63</volume>, <fpage>130</fpage>–<lpage>137</lpage>.<pub-id pub-id-type="pmid">13315258</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>
 <given-names>T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2007</year>) 
<article-title>BindingDB: a web-accessible database of experimentally determined protein–ligand binding affinities</article-title>. <source>Nucleic Acids Res</source>., <volume>35</volume>, <fpage>D198</fpage>–<lpage>D201</lpage>.<pub-id pub-id-type="pmid">17145705</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mayr</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>Large-scale comparison of machine learning methods for drug target prediction on chEMBL</article-title>. <source>Chem. Sci</source>., <volume>9</volume>, <fpage>5441</fpage>–<lpage>5451</lpage>.<pub-id pub-id-type="pmid">30155234</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Öztürk</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>DeepDTA: deep drug–target binding affinity prediction</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i821</fpage>–<lpage>i829</lpage>.<pub-id pub-id-type="pmid">30423097</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Öztürk</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) WideDTA: prediction of drug-target binding affinity. arXiv:1902.04166.</mixed-citation>
    </ref>
    <ref id="btaa880-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pahikkala</surname>
 <given-names>T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Toward more realistic drug–target interaction predictions</article-title>. <source>Brief. Bioinform</source>., <volume>16</volume>, <fpage>325</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">24723570</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Paszke</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) Automatic differentiation in Pytorch. In: <italic toggle="yes">NeurIPS</italic>, Vancouver, Canada.</mixed-citation>
    </ref>
    <ref id="btaa880-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogers</surname>
 <given-names>D.</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>M.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Extended-connectivity fingerprints</article-title>. <source>J. Chem. Inf. Model</source>., <volume>50</volume>, <fpage>742</fpage>–<lpage>754</lpage>.<pub-id pub-id-type="pmid">20426451</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schenone</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Target identification and mechanism of action in chemical biology and drug discovery</article-title>. <source>Nat. Chem. Biol</source>., <volume>9</volume>, <fpage>232</fpage>–<lpage>240</lpage>.<pub-id pub-id-type="pmid">23508189</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B29">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Sennrich</surname>
 <given-names>R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) Neural machine translation of rare words with subword units. ACL, pp. 1715–1725, Berlin, Germany.</mixed-citation>
    </ref>
    <ref id="btaa880-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsubaki</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Compound-protein interaction prediction with end-to-end learning of neural networks for graphs and sequences</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>309</fpage>–<lpage>318</lpage>.<pub-id pub-id-type="pmid">29982330</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Unterthiner</surname>
 <given-names>T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) Deep learning as an opportunity in virtual screening. In <italic toggle="yes">Deep Learning Workshop at NeurIPS</italic>. Vol. <volume>27</volume>, p. 1, Montreal, Canada.</mixed-citation>
    </ref>
    <ref id="btaa880-B32">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Vaswani</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) Attention is all you need. In: <italic toggle="yes">NeurIPS</italic>, Long Beach, USA.</mixed-citation>
    </ref>
    <ref id="btaa880-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>
 <given-names>Y.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>PubChem: a public information system for analyzing bioactivities of small molecules</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>W623</fpage>–<lpage>W633</lpage>.<pub-id pub-id-type="pmid">19498078</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wen</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Deep-learning-based drug–target interaction prediction</article-title>. <source>J. Proteome Res</source>., <volume>16</volume>, <fpage>1401</fpage>–<lpage>1409</lpage>.<pub-id pub-id-type="pmid">28264154</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wishart</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2008</year>) 
<article-title>DrugBank: a knowledgebase for drugs, drug actions and drug targets</article-title>. <source>Nucleic Acids Res</source>., <volume>36</volume>, <fpage>D901</fpage>–<lpage>D906</lpage>.<pub-id pub-id-type="pmid">18048412</pub-id></mixed-citation>
    </ref>
    <ref id="btaa880-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhang</surname>
 <given-names>M.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.</given-names></string-name></person-group> (<year>2018</year>) Link prediction based on graph neural networks. In: <italic toggle="yes">NeurIPS</italic>, pp. 5165–5175, Montreal, Canada.</mixed-citation>
    </ref>
    <ref id="btaa880-B37">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zheng</surname>
 <given-names>X.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) Collaborative matrix factorization with multiple similarities for predicting drug-target interactions. In: <italic toggle="yes">KDD</italic>, Chicago, USA.</mixed-citation>
    </ref>
    <ref id="btaa880-B38">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zitnik</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>a) 
<article-title>BioSNAP datasets: Stanford biomedical network dataset collection</article-title>.</mixed-citation>
    </ref>
    <ref id="btaa880-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zitnik</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>b) 
<article-title>Modeling polypharmacy side effects with graph convolutional networks</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i457</fpage>–<lpage>i466</lpage>.<pub-id pub-id-type="pmid">29949996</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
