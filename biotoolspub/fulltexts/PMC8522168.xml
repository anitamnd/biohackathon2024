<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8522168</article-id>
    <article-id pub-id-type="publisher-id">4415</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04415-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>AdmixSim 2</italic>: a forward-time simulator for modeling complex population admixture</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Rui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Chang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Kai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ni</surname>
          <given-names>Xumin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Yuwen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1975-1002</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Shuhua</given-names>
        </name>
        <address>
          <email>xushua@fudan.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.410726.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 8419</institution-id><institution>Key Laboratory of Computational Biology, Shanghai Institute of Nutrition and Health, </institution><institution>University of Chinese Academy of Sciences, Chinese Academy of Sciences, </institution></institution-wrap>Shanghai, 200031 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.181531.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 1789 9622</institution-id><institution>Department of Mathematics, School of Science, </institution><institution>Beijing Jiaotong University, </institution></institution-wrap>Beijing, 100044 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>State Key Laboratory of Genetic Engineering, Collaborative Innovation Center of Genetics and Development, School of Life Sciences, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, 200438 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>Human Phenome Institute, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, 201203 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.440637.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 4657 8879</institution-id><institution>School of Life Science and Technology, </institution><institution>ShanghaiTech University, </institution></institution-wrap>Shanghai, 201210 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.9227.e</institution-id><institution-id institution-id-type="ISNI">0000000119573309</institution-id><institution>Center for Excellence in Animal Evolution and Genetics, </institution><institution>Chinese Academy of Sciences, </institution></institution-wrap>Kunming, 650223 China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.207374.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2189 3846</institution-id><institution>Henan Institute of Medical and Pharmaceutical Sciences, </institution><institution>Zhengzhou University, </institution></institution-wrap>Zhengzhou, 450052 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>506</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>9</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Computer simulations have been widely applied in population genetics and evolutionary studies. A great deal of effort has been made over the past two decades in developing simulation tools. However, there are not many simulation tools suitable for studying population admixture.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We here developed a forward-time simulator, <italic>AdmixSim 2</italic>, an individual-based tool that can flexibly and efficiently simulate population genomics data under complex evolutionary scenarios. Unlike its previous version, <italic>AdmixSim 2</italic> is based on the extended Wright-Fisher model, and it implements many common evolutionary parameters to involve gene flow, natural selection, recombination, and mutation, which allow users to freely design and simulate any complex scenario involving population admixture. <italic>AdmixSim 2</italic> can be used to simulate data of dioecious or monoecious populations, autosomes, or sex chromosomes. To our best knowledge, there are no similar tools available for the purpose of simulation of complex population admixture. Using empirical or previously simulated genomic data as input, <italic>AdmixSim 2</italic> provides phased haplotype data for the convenience of further admixture-related analyses such as local ancestry inference, association studies, and other applications. We here evaluate the performance of <italic>AdmixSim 2</italic> based on simulated data and validated functions via comparative analysis of simulated data and empirical data of African American, Mexican, and Uyghur populations.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>AdmixSim 2</italic> is a flexible simulation tool expected to facilitate the study of complex population admixture in various situations.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04415-x.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Population admixture</kwd>
      <kwd>Forward-time simulation</kwd>
      <kwd>Admixture models</kwd>
      <kwd>Multiple-wave admixture</kwd>
      <kwd>Evolutionary forces</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Natural Science Foundation of China (NSFC) grant</institution>
        </funding-source>
        <award-id>32030020</award-id>
        <award-id>31771388</award-id>
        <award-id>32041008</award-id>
        <award-id>31525014</award-id>
        <award-id>31961130380</award-id>
        <award-id>31900418</award-id>
        <award-id>11801027</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ni</surname>
            <given-names>Xumin</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Shuhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Strategic Priority Research Program of the Chinese Academy of Sciences (CAS)</institution>
        </funding-source>
        <award-id>XDPB17</award-id>
        <award-id>XDB38000000</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xu</surname>
            <given-names>Shuhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>UK Royal Society-Newton Advanced Fellowship</institution>
        </funding-source>
        <award-id>NAF\R1\191094</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xu</surname>
            <given-names>Shuhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key Research and Development Program</institution>
        </funding-source>
        <award-id>2016YFC0906403</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xu</surname>
            <given-names>Shuhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Shanghai Municipal Science and Technology Major Project </institution>
        </funding-source>
        <award-id>2017SHZDZX01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xu</surname>
            <given-names>Shuhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Fundamental Research Funds for the Central Universities </institution>
        </funding-source>
        <award-id>2020RC001</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ni</surname>
            <given-names>Xumin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">Computer simulation has come to play an increasingly critical role in various population genetic studies, such as estimating summary statistics of sequencing-level data, evaluating the robustness of mathematical inference frameworks, and understanding current genetic diversity underlying different demographic histories. A number of simulation tools have been developed, and some reviews have comprehensively covered the works in which they were used [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. The available simulation tools can be divided into two distinct classes: backward-time, also called coalescent-based, and forward-time. Backward-time simulation tools are based on the idea of tracing back to the most recent common ancestor of currently surviving individuals and then attributing genetic information to each individual on the coalescent tree. These tools are very efficient and memory-saving because only existing individuals are considered. However, they are not powerful in complex demographic scenarios. Coalescent-based methods are not suitable for cases involving questions of interest that require complete ancestral information since only the ancestral information of currently surviving individuals is saved. Unlike coalescent-based methods, forward-time approaches start from some initial reference populations and then implement specific evolutionary events generation by generation, such as recombination, de novo mutation, natural selection, and migration. Many efficient forward-time tools have been developed recently. The National Cancer Institute’s Genetic Simulation Resources (GSR) website (<ext-link ext-link-type="uri" xlink:href="https://surveillance.cancer.gov/genetic-simulation-resources/packages/">https://surveillance.cancer.gov/genetic-simulation-resources/packages/</ext-link>) listed 178 simulators. These tools were initially designed for various modeling emphases and objectives, so that they have been widely applied to different genetics studies, such as the human epidemiology (<italic>simuPOP</italic> [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]), the ecology of wild species (<italic>Nemo</italic> [<xref ref-type="bibr" rid="CR9">9</xref>]), and the genome-wide association studies (<italic>genomeSIM</italic> [<xref ref-type="bibr" rid="CR10">10</xref>], <italic>genomeSIMLA</italic> [<xref ref-type="bibr" rid="CR11">11</xref>]). Among forward-time simulators, some possess functions to simulate a process of population admixture directly, such as <italic>admix’em</italic> [<xref ref-type="bibr" rid="CR12">12</xref>], <italic>SELAM</italic> [<xref ref-type="bibr" rid="CR13">13</xref>], <italic>SLiM</italic> [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>], <italic>simuPOP</italic>, <italic>fwdpp</italic> [<xref ref-type="bibr" rid="CR17">17</xref>], and <italic>forqs</italic> [<xref ref-type="bibr" rid="CR18">18</xref>]. They are flexible and computationally efficient in fields of their respective designing objectives and also workable on other demographic scenarios. In particular, <italic>admix’em</italic> focuses simulations on two-way admixture. <italic>SELAM</italic> is especially useful in simulating admixture resulted from a founding population with all subpopulations being co-existing throughout the simulation. <italic>SLiM</italic> and <italic>forqs</italic> are both powerful in simulating the evolution of quantitative traits when assuming various demographic histories. <italic>simuPOP</italic> and <italic>fdwpp</italic> are especially suitable for users who are good at Python or Cpp programming. In addition, <italic>SLiM 3.3</italic> [<xref ref-type="bibr" rid="CR16">16</xref>], <italic>GeneEvolve</italic> [<xref ref-type="bibr" rid="CR19">19</xref>], <italic>simuPOP</italic>, and <italic>AdmixSim</italic> [<xref ref-type="bibr" rid="CR20">20</xref>] also support real genomic data as input, this feature is helpful in many applications, especially when mutation-drift equilibrium is to be approached which can be time-consuming. Taken together, there is room for developing tools specifically for modeling complex population admixture. Here, we introduce a highly flexible and user-friendly forward-time simulation tool called <italic>AdmixSim 2</italic>. It allows simulating real sequence data in a series of complex admixture processes with various evolutionary driving forces including de novo mutation, drift, recombination, and natural selection. Notably, <italic>AdmixSim 2</italic> can also be applied in admixture scenarios for sex chromosomes and non-human species. The source code of <italic>AdmixSim 2</italic> is freely available at <ext-link ext-link-type="uri" xlink:href="https://www.picb.ac.cn/PGG/resource.php">https://www.picb.ac.cn/PGG/resource.php</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://github.com/Shuhua-Group/AdmixSim2">https://github.com/Shuhua-Group/AdmixSim2</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">The data structure of <italic>AdmixSim 2</italic> can be mainly divided into five layers: segment, chromosome, individual, single-generation population, and multiple-generation population. <italic>AdmixSim 2</italic> begins with a set of individuals from ancestral populations, corresponding sex settings, chromosome information, and a user-defined demographic model. Each Individual is a diploid and constituted by two chromosomes. In the founding generation, each chromosome of ancestral individuals is assigned with a unique integer-type label ranging from 0 to <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2N - 1\left( {N = \mathop \sum \limits_{i = 1}^{k} N_{i} } \right)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4415_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4415_Article_IEq2.gif"/></alternatives></inline-formula> is the number of individuals of the <italic>i</italic>th ancestral population, <italic>i</italic> = 1, 2, …, <italic>k</italic>). Chromosomes of a certain population take consecutive labels. Following the demographic model settings, for each population, the probability of being sampled to be a parent of newly generated individuals is proportional to the corresponding admixture proportion. More specifically, when there are three ancestral populations, i.e., pop1, pop2, and pop3, their admixture proportions are 0.2, 0.1, and 0.7 respectively. To make new individual data, we first generate a random number between 0 and 1. One individual of pop1 is selected if the random number is less than 0.2, while one individual of pop2 is selected if the random number is larger than 0.2 and less than 0.3, otherwise, one individual of pop3 is selected. Within each population, the probability of being sampled for each individual is proportional to the corresponding fitness. Each chromosome of newly generated individuals consists of a list of segments. Each segment is identified by the start physical position, the end physical position, and the label it originates from. The new generated individual inherits corresponding segments from parents with additional segments resulted from recombination. Asides from the ancestral segments, each chromosome has two additional lists recording the recombination breakpoints and de novo mutation points, respectively, and one map recording the physical positions under selection and corresponding states of the allele. The generation of new recombination and mutation points can be modeled as the Poisson process and assigned along the chromosome based on the user-defined recombination rate and mutation rate, respectively. Each population in <italic>AdmixSim 2</italic> is constituted by individuals spreading several generations specified in the demographic model.</p>
    <p id="Par16">Next, we provide a brief description of the workflow of <italic>AdmixSim 2</italic>. Detailed information can be found in the user’s manual. <italic>AdmixSim 2</italic> follows the extended Wright-Fisher (WF) model, which includes diploid individuals and non-overlapping, discrete generations. Unlike the strict WF model, the population size over generations can fluctuate and can be defined by users. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the general flow chart of <italic>AdmixSim 2</italic>. Briefly, four input files are required for ancestral haplotype data, individual information, single nucleotide variation (SNV) information, and model description. The model description file defines the overall simulation processes by combining a series of modules of a standard format for every single process. Even though it is possible to use models in combination for extensive admixture scenarios, modifications of a single model are also applicable and flexible. With the input of these four files, <italic>AdmixSim 2</italic> implements the whole simulation process defined in the model description file across generations. At the end of the simulation, haplotype data of individuals of specified populations are provided, and users can flexibly sample a certain number of individual data for output. Output data of any generation are available for all of the simulated populations. The output individual information file, haplotype data file, and updated SNV information file are in a similar format as the input file, which provides convenience and flexibility for subsequent simulations across different demographic models. Moreover, the haplotype data as provided by <italic>AdmixSim 2</italic> are helpful for follow-up analysis and revealing the properties of real genomic data, which are not available in many other simulation tools. In addition to the aforementioned output files, <italic>AdmixSim 2</italic> also generates three additional outputs, frequency of alleles under selection, ancestral track information, and a log file.<fig id="Fig1"><label>Fig. 1</label><caption><p>General simulation flow chart of <italic>AdmixSim 2</italic>. Colors indicate different ancestral populations, squares represent males, circles represent females. Red spots represent mutations and red crosses represent recombinations. <italic>AdmixSim2</italic> requires four input files separately recording ancestral haplotype data, individual information, SNV information, and demographic model. During the simulation, each individual in the current generation undergoes mutation and is then sampled to be a parent of offspring in the next generation. The probability of being included in this sample is proportional to the individual’s fitness. Each parent contributes one gamete to the offspring after recombination. At the end of the simulation, there are six output files. The first three take nearly the same format as the corresponding input, and they can be used for subsequent simulations with a new demographic model</p></caption><graphic xlink:href="12859_2021_4415_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par17">Admixture, de novo mutation, and natural selection are the evolutionary events that we mainly considered in <italic>AdmixSim 2</italic>. Corresponding parameters can be set in input files or using the command-line interface. Initial settings for sex in the individual information file define monoecious and dioecious individuals for simulation. In the case of monoecious individuals, we logically sample two different individuals as parents of each offspring in the next generation. The probability that samples an individual out is proportional to the individual’s fitness. The fitness of an individual is calculated as one plus the sum of selection coefficients of all selection conditions satisfied. The negative value is rescaled to zero. Each parent contributes one gamete to the offspring with mutations and recombination. The recombination rate and mutation rate can be set as uniform or nonuniform (locus-specific) in either the command line or the SNV information file. For selection, <italic>AdmixSim 2</italic> can simulate the case of a single locus, multi-locus (continuous or discrete), population-specific, and sex-specific selection. Here, the sex-specific selection is incorporated by assigning different selection coefficients for two sexes. Sex-specific population sizes and sex-specific admixture proportions are supported as well. The selection coefficients are allowed to change over generations. Users can also simplify the simulation by using a single parameter setting to avoid complex evolutionary processes with recombination, de novo mutation, and natural selection, respectively.</p>
    <p id="Par18">We implemented some features for the efficiency of run time and memory usage. First of all, we record the recombination segments rather than the whole haplotype data, which is much more memory-efficient as stated in <italic>forqs</italic>. The time consuming is insensitive to the number of simulated SNVs and remains relatively small even with a large recombination rate and mutation rate. Second, we discard the population information of the previous generation after simulating the current generation unless it is specified to be output. Generally speaking, there are data of two generations existing simultaneously in the simulation process. Finally, we record the haplotype data of ancestral populations into memory after simulating all the generations instead of at the beginning. The ancestral haplotype data are used to extract the segmental sequence based on the segment information carried by each output haplotype. We compared the basic features and abilities of <italic>AdmixSim 2</italic> with <italic>QuantiNemo 2</italic> [<xref ref-type="bibr" rid="CR21">21</xref>], <italic>SLiM 3.3</italic>, <italic>simuPOP</italic>, <italic>GeneEvolve</italic>, <italic>SELAM</italic>, <italic>forqs</italic>, and <italic>admix’em</italic> (Table <xref rid="Tab1" ref-type="table">1</xref>). The results showed that <italic>AdmixSim 2</italic> is an irreplaceable tool for simulating population admixture with real genomic data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of the features</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulator features</th><th align="left"><bold><italic>AdmixSim 2</italic></bold></th><th align="left"><bold><italic>quantiNemo 2</italic></bold></th><th align="left"><bold><italic>SLiM 3.3</italic></bold></th><th align="left"><bold><italic>simuPOP</italic></bold></th><th align="left"><bold><italic>GeneEvolve</italic></bold></th><th align="left"><bold><italic>SELAM</italic></bold></th><th align="left"><bold><italic>forqs</italic></bold></th><th align="left"><bold><italic>Admix’em</italic></bold></th></tr></thead><tbody><tr><td align="left">Admixture<sup>a</sup></td><td align="left">Y, SS</td><td align="left">N</td><td align="left">Y</td><td align="left">Y, SS</td><td align="left">N</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td></tr><tr><td align="left">Real sequence data input</td><td align="left">Y</td><td align="left">N</td><td align="left">Y/N</td><td align="left">Y/N</td><td align="left">Y</td><td align="left">N</td><td align="left">N</td><td align="left">N</td></tr><tr><td align="left">Genomic data output</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td><td align="left">N</td><td align="left">Y</td><td align="left">N</td></tr><tr><td align="left">Recombination</td><td align="left">U, NU, A</td><td align="left">U, NU, SS</td><td align="left">U, NU</td><td align="left">U, NU</td><td align="left">U, NU</td><td align="left">U</td><td align="left">U, NU</td><td align="left">U, NU, SS</td></tr><tr><td align="left">Mutation</td><td align="left">U, NU, A</td><td align="left">U, NU, KA, SM</td><td align="left">U, NU, KA, SM</td><td align="left">U, NU, KA, SM</td><td align="left">U, NU, A</td><td align="left">U</td><td align="left">U, NU, A</td><td align="left">U, NU</td></tr><tr><td align="left">Selection</td><td align="left">SL, ML, POS, SS, GS, DS, A</td><td align="left">SL, ML, POS, DS, GS, BS, ES</td><td align="left">SL, ML, POS, DS, BS, ES, PHS, A</td><td align="left">SL, ML, POS, BS, DS, ES</td><td align="left">SL, ML, POS, DS, BS, PHS, A</td><td align="left">SL, SS, POS, DS, ES</td><td align="left">SL, ML, DS, A</td><td align="left">SL, ML, POS, SS, DS, GS, ES, PHS</td></tr><tr><td align="left">X chromosome</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td><td align="left">N</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td></tr><tr><td align="left">Programming language</td><td align="left">C++, Python</td><td align="left">C++</td><td align="left">C++</td><td align="left">C++</td><td align="left">C++</td><td align="left">C++</td><td align="left">C++</td><td align="left">C++</td></tr><tr><td align="left">Interface</td><td align="left">Command-line, configuration files</td><td align="left">Command line, configuration files</td><td align="left">Edios programming</td><td align="left">Python programming</td><td align="left">Command-line, configuration files</td><td align="left">Command-line, configuration files</td><td align="left">Command-line, configuration files</td><td align="left">Command-line, configuration files</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Generate new admixed populations</p><p><italic>A</italic> Absent, <italic>BS</italic> Balancing Selection, <italic>ES</italic> Epistatic Selection, <italic>DS</italic> Directional Selection, <italic>GS</italic> Generation Specific, <italic>KA</italic> k-Allele Model, <italic>ML</italic> Multi-locus, <italic>N</italic> No, <italic>NU</italic> Nonuniform, <italic>PHS</italic> Phenotype Specific, <italic>POS</italic> Population Specific, <italic>SL</italic> Single-locus, <italic>SM</italic> Stepwise Mutation Model, <italic>SS</italic> Sex Specific, <italic>U</italic> Uniform, <italic>Y</italic> Yes</p></table-wrap-foot></table-wrap></p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>Admixture, recombination, and mutation</title>
      <p id="Par19">To validate the basic functions of our simulator, we used admixture models of three typical admixed populations (African Americans, Mexicans, and Uyghurs) which are of 2, 3, and 4 distinct ancestral originations, respectively (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S1). The simulation model of each population is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. To simulate African Americans, we chose populations European and African from the 1000 Genomes Project (KGP) as reference. Totally 6,196,135 SNVs on chromosome 1 were used for simulation. We performed principal component analysis (PCA) with <italic>flashpca</italic> [<xref ref-type="bibr" rid="CR24">24</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) and supervised admixture analysis with <italic>ADMIXTURE</italic> [<xref ref-type="bibr" rid="CR25">25</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C) of both simulated and empirical data. The results of PCA and admixture analysis were largely concordant between simulated data and empirical data, indicating the simulated data by <italic>AdmixSim 2</italic> are a satisfactory alternative on a global level. We further calculated the segment length proportion of each ancestral population to validate the function of sampling patterns and recombination. The variation of these proportions was largely stochastic without significant deviation from the expected value as set in the admixture model (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). To validate the function of adding mutations, we set the mutation rate as 10<sup>–8</sup> per generation per site and compared the distribution of mutation counts of each output haplotype to the Poisson distribution (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). The results show that the two distributions were extremely close (<italic>p</italic> = 0.69<italic>,</italic> chi-square goodness of fit test). These results further demonstrated the simulated data by <italic>AdmixSim 2</italic> are a satisfactory alternative on the level of local genomic regions. For the other two admixed populations, Mexicans and Uyghurs, the aforementioned features of simulated data were confirmed (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 and Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3).<fig id="Fig2"><label>Fig. 2</label><caption><p>Simulation of African American admixture pattern. <bold>A</bold> PCA results. The left is the result of empirical data and the right is the result of simulated data. The patterns of these two results are quite similar. <bold>B</bold> Segment length proportion. The proportion of each ancestry was calculated based on the sum of the corresponding segment length. The average proportions of European and African were 0.225 and 0.775, which is in broad agreement with proportions set in the admixture model (European: 0.246, African: 0.754). <bold>C</bold> Supervised admixture analysis results at K = 2. The left is the result of empirical data and the right is simulated data. There is no marked difference between these two results. <bold>D</bold> Mutation number counts. The green histogram represents the simulation value and the red curve is derived from the theoretical Poisson distribution. The <italic>p</italic>-value was calculated using the chi-square goodness of fit test. The chromosome length was approximate 2.49 Morgan and the mutation rate was set as 10<sup>–8</sup> per generation per site. Thus, after simulating 11 generations, the average mutation number of each haplotype is about 27</p></caption><graphic xlink:href="12859_2021_4415_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Recombination and length distribution of segments of distinct ancestry in the analysis of X chromosome and autosomal data</title>
      <p id="Par20">The main difference is the recombination pattern in simulating X chromosome and autosome data. While simulating X chromosome data, we assume that recombination only occurs in females. Thus, the number of recombination events of the X chromosome is expected to be two-thirds of that of autosome theoretically. We simulated an admixed population with a population size of 5000 using pseudo data of 3 Morgan. The simulation was based on hybrid isolation (HI) model with the initial ancestral contribution of 4:1 for two ancestral populations (hereafter refers to Anc1 and Anc2, respectively) and ended at generation 50. The recombination rate was set as 10<sup>–8</sup> Morgan per base pair. There are differences between the numbers of recombination breakpoints of autosomes and those of X chromosome under the identical simulation model and parameter settings (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The mean numbers of breakpoints of autosome and X chromosome were 149.66 and 100, respectively, thus satisfied the two-thirds ratio as expected. Next, we examined the consistency between length distribution of ancestral segments in simulation and that in the theoretical deduction based on the method proposed in <italic>MultiWaver</italic> [<xref ref-type="bibr" rid="CR22">22</xref>]. The statistical significance was determined by the Kolmogorov–Smirnov test. As expected, the two distributions did not show statistical significance, which again demonstrated a fundamental capacity of <italic>AdmixSim 2</italic> to simulate X chromosome data (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B).<fig id="Fig3"><label>Fig. 3</label><caption><p>Recombination and length distribution of segments of distinct ancestry in the analysis of X chromosome and autosomal data. <bold>A</bold> Recombination breakpoint counts. The histogram represents the simulated value of recombination breakpoints and the red curve is the theoretical Poisson distribution. Under identical simulation models and parameter settings, the average number of recombination breakpoints of the X chromosome is approximately two-thirds of that of autosomes. <bold>B</bold> Segment length distribution. The histogram represents the simulated segment length distribution and the red curve is the theoretical exponential distribution. The theoretical distribution fits quite well with the simulated one. Moreover, X chromosomes possess a smaller effective recombination rate compared to autosomes</p></caption><graphic xlink:href="12859_2021_4415_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Natural selection</title>
      <p id="Par21">To verify the frequency variation tendency of alleles under selection, we simulated a two-locus segment under a selection amenable to the additive model with an initial freqncy of 5% and a selection coefficient of 0.1. Under the additive model, the fitness is 1, 1 + <italic>s</italic>, and 1 + 2<italic> s</italic> for individuals carrying 0, 1, and 2 selected haplotypes, respectively, where <italic>s</italic> denotes the selection coefficient. During each simulation of 500 repeats, we recorded the selection frequency at each generation. Using <italic>x</italic><sub><italic>t</italic></sub> to denote allele frequency at generation <italic>t</italic>, we have the theoretical frequency at generation <italic>t</italic> + 1 as<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{t + 1} = \frac{{\left( {1 + 2s} \right)x_{t}^{2} + x_{t} \left( {1 - x_{t} } \right)\left( {1 + s} \right)}}{{\left( {1 + 2s} \right)x_{t}^{2} + 2x_{t} \left( {1 - x_{t} } \right)\left( {1 + s} \right) + (1 - x_{t} )^{2} }}.$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4415_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par22">Given the condition of <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{0} = 0.05$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4415_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s = 0.1$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4415_Article_IEq4.gif"/></alternatives></inline-formula>, the mean value of allele frequencies across 500 repeats was compared to the expected value at each generation (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). The results of simulation and theoretical expectation are consistent regarding the frequency of allele under selection (<italic>p</italic> = 0.999<italic>,</italic> Kolmogorov–Smirnov test).<fig id="Fig4"><label>Fig. 4</label><caption><p>Selection Test of <italic>AdmixSim 2</italic>. <bold>A</bold> The variation trend of allele frequency. The grey curve represents each repeat. The red curve is the average of 500 repeats and the blue one is the theoretical value. The <italic>p</italic>-value was calculated using the Kolmogorov–Smirnov test and the average of 500 simulations was quite indistinguishable from the theoretical one. The pie chart on the right shows the statistical analysis of each repeat and the theoretical value. More than 95% of tests did not show statistical significance. <bold>B</bold> Allele fixation time under different combinations of initial frequency and selection coefficient. The fixation time reasonably decreased with the increase of selection coefficients. Moreover, the higher initial frequencies were, the fewer generations were cost to reach a fixation state</p></caption><graphic xlink:href="12859_2021_4415_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par23">To test the number of generations of an allele being fixed under selections with different initial frequencies and coefficients, we simulated 1 centiMorgan chromosome and used the HI model with an initial contribution of 1:1 from two ancestral populations. Each ancestral population had 100 individuals in the founding generation and the population size of the admixed population was 5,000 throughout the simulation. Recombination rate (Morgan per base pair) and mutation rate (per generation per site) were both set as 10<sup>–8</sup>. We considered four distinct initial frequencies of the segment under selection, 5%, 10%, 15%, and 20%. The selection coefficient varied in the change of 0.01–0.1, taking 0.01 as a step (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S2). For each combination of initial frequency and selection coefficient setting, we performed 100 replications, and then calculated the average of fixation time with standard error (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). As expected, the fixation time decreased with the increase of selection coefficients. Besides, there was a negative correlation between the initial frequencies and the time in generations taken to reach a fixation state. These results revealed a powerful performance of <italic>AdmixSim 2</italic> in terms of simulating natural selection during admixture.</p>
    </sec>
    <sec id="Sec7">
      <title>Time and memory cost</title>
      <p id="Par24">Further, we evaluated the time cost of <italic>AdmixSim 2</italic> using a HI model with equal contribution from the two ancestral populations. Six distinct factors were considered in the evaluation by varying values of one and holding the rest constant, including chromosome length, recombination rate, mutation rate, admixed population size in simulation, end generation, and a number of loci under selection (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S3). The time cost exhibited an approximately linear increase with the value of the condition rising and was relatively low (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Later, we compare the runtime and memory cost of <italic>AdmixSim 2</italic> and <italic>SLiM 3.3</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] using the population Yoruba in Ibadan, Nigeria (YRI) from the KGP dataset (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Here, for simplicity, we simulated the case that YRI evolves for a certain number of generations without gene flow from other populations. Totally 1,055,452 SNVs on chromosome 22 were used for simulation. The simulated chromosome length was about 50 Mb. The uniform recombination and mutation rate were set as 10<sup>−8</sup> Morgan per base pair and 10<sup>−8</sup> per generation per site. We record the runtime and peak memory usage in changing the population size (1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10,000) and simulated generation (50, 100, 150, 200, 250, 300, 350, 400). All tests were conducted on 96-core Intel Xeon Platinum 9242 CPU 2.30 GHz computer servers. <italic>SLiM 3.3</italic> was compiled under the release build. The runtime and memory cost for both simulators are approximately linear functions of generations or population size. Notably, the memory cost of <italic>AdmixSim 2</italic> is almost constant, while for <italic>SLiM 3.3</italic>, it is much higher and growing faster. These results indicate that <italic>AdmixSim 2</italic> is feasible and efficient in massive simulations.<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance evaluation of <italic>AdmixSim 2</italic>. <bold>A</bold> Varying chromosome length (centiMorgan). <bold>B</bold> Varying recombination rate (Morgan per base pair). <bold>C</bold> Varying mutation rate (per generation per site). <bold>D</bold> Varying population size. <bold>E</bold> Varying generation. <bold>F</bold> A varying number of loci under selection. The time cost increased linearly with the increase of the corresponding factor and was relatively low</p></caption><graphic xlink:href="12859_2021_4415_Fig5_HTML" id="MO5"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Performance comparison of <italic>AdmixSim 2</italic> and <italic>SLiM 3.3</italic>. <bold>A</bold> Time cost with different simulation generations. <bold>B</bold> Memory cost with different simulation generations. <bold>C</bold> Time cost with different population sizes. <bold>D</bold> Memory cost with different population sizes. Here the memory cost is the maximum resident set size during the simulation. Both simulators demonstrate a linear relationship with the generations or population size. The runtime and memory cost of <italic>AdmixSim 2</italic> is much less than <italic>SLiM 3.3</italic></p></caption><graphic xlink:href="12859_2021_4415_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par25">Since <italic>AdmixSim 2</italic> was designed to focus on simulating the admixture process, the pre-admixture data can be generated from different strategies. In human genetics, users can use the genetic data from public data sets like the KGP, the Estonian Biocentre Human Genome Diversity Panel (EGDP), the Simons Genome Diversity Project (SGDP), and the International HapMap Project. Since <italic>AdmixSim 2</italic> can simulate the scenario that the ancestral populations evolve same generations as the admixed population, it is practical to use the populations from these public datasets as ancestral populations. Besides, populations from these datasets could be used as proxy populations in local ancestry inference. With the advance of genotyping and technologies, the ability to generate large amounts of sequence data in a relatively short amount of time is helping to enable a wide range of genetic analysis applications. Therefore, the pre-admixture genetic data can be more easily obtained in the future owing to advanced sequencing technologies. More generally, users can use coalescent approaches like <italic>msprime</italic> [<xref ref-type="bibr" rid="CR26">26</xref>] or forward-in-time methods like <italic>SLiM 3.3</italic> to simulate the pre-admixture data. This approach can be applied to both human and non-human species. For instance, the documentation of <italic>msprime</italic> (<ext-link ext-link-type="uri" xlink:href="https://tskit.dev/msprime/docs/stable/demography.html">https://tskit.dev/msprime/docs/stable/demography.html</ext-link>) gave the code to simulate African, European, and East Asian individuals based on the Out of Africa model developed by Gutenkunst et al. [<xref ref-type="bibr" rid="CR27">27</xref>] from the HapMap Project data. Besides, the manual of <italic>SLiM 3.3</italic> (page 99) implemented a model of human evolution presented by Gravel et al. in 2011 [<xref ref-type="bibr" rid="CR28">28</xref>] based on the KGP data. Last but not least, the output haplotype data of <italic>AdmixSim 2</italic> can also be used as the input of further simulations. The first three output files (haplotype data, individual information, and updated SNV information) of <italic>AdmixSim 2</italic> take the same format as the corresponding input, and they can be used for subsequent simulations with a new demographic model.</p>
    <p id="Par26"><italic>AdmixSim 2</italic> record the recombination segments rather than the whole haplotype data, which brings a proportion of efficiency for the simulation. The way of segment representation in <italic>AdmixSim 2</italic> is similar to that implemented in <italic>forqs</italic>, but there is some slight difference. Each haplotype chunk in <italic>forqs</italic> is represented by two numbers (position, id): the position where it begins, and the identifier of the founding haplotype from which it is derived. For <italic>AdmixSim 2</italic>, each segment is identified by the start physical position, the end physical position, and the ancestral label it originates from. Despite this difference is not seemly substantial, we believe specify an ending physical position is more convenient to calculate the selection fitness and extract segmental sequence data without indexing the next segment. Besides, we noticed that <italic>forqs</italic> is mainly used to simulate the scenarios that recombination and/or natural selection on polygenic quantitative traits within a relatively small number of generations, while the emphasis of <italic>AdmixSim 2</italic> is on simulating complex population admixture events more flexibly. Previous studies have demonstrated that a segment-based simulator is not as efficient as array-based simulators (like <italic>SLiM</italic>) when involving demographic events taking place over thousands of generations [<xref ref-type="bibr" rid="CR18">18</xref>]. Nevertheless, we here mainly focus on the studies of modern humans, and the history usually much less than 1000 generations for typical admixed populations of modern humans.</p>
    <p id="Par27">The previous version, <italic>AdmixSim</italic>, has been used in many evolutionary and population genetic studies, including those exploring the genetic history of Xinjiang’s Uyghurs [<xref ref-type="bibr" rid="CR23">23</xref>], validating statistical tool <italic>CAMer</italic> [<xref ref-type="bibr" rid="CR29">29</xref>], <italic>MultiWaver</italic> series software [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], and <italic>Libgdrift</italic> [<xref ref-type="bibr" rid="CR31">31</xref>]. We summarized the similarities and differences between <italic>AdmixSim</italic> and <italic>AdmixSim 2</italic> (Table <xref rid="Tab2" ref-type="table">2</xref>). We expect <italic>AdmixSim 2</italic> to be widely used in population admixture studies, such as modeling complicated demographic history, validating methods for local ancestry inference, and dating population admixture. In addition, autosomal and sex chromosomal data are both supported. This is particularly useful in studying sex-biased admixture.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparisons between <italic>AdmixSim</italic> and <italic>AdmixSim 2</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Features<sup>c</sup></th><th align="left"><bold><italic>AdmixSim</italic></bold></th><th align="left"><bold><italic>AdmixSim 2</italic></bold></th></tr></thead><tbody><tr><td align="left">Admixture</td><td align="left">One admixed population</td><td align="left">Multiple<sup>b</sup> admixed populations<sup>a</sup></td></tr><tr><td align="left"/><td align="left"/><td align="left">Sex-biased</td></tr><tr><td align="left">Recombination</td><td align="left">Locus-specific/ constant</td><td align="left">Locus-specific/constant<sup>a</sup></td></tr><tr><td align="left">Mutation</td><td align="left">No</td><td align="left">Locus-specific/constant<sup>a</sup></td></tr><tr><td align="left">Natural selection</td><td align="left">No</td><td align="left">Multiple<sup>b</sup>-locus<sup>a</sup></td></tr><tr><td align="left"/><td align="left"/><td align="left">Multiple<sup>b</sup> regions</td></tr><tr><td align="left"/><td align="left"/><td align="left">Population-specific</td></tr><tr><td align="left"/><td align="left"/><td align="left">Sex-specific</td></tr><tr><td align="left">Chromosome type</td><td align="left">Autosome</td><td align="left">Autosome/X chromosome<sup>a</sup></td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Different rows in the feature descriptions can be realized simultaneously in a single simulation process. Terms in a row separated by ‘/’ are mutually exclusive</p><p><sup>b</sup>All terms with ‘multiple’ support the corresponding scenarios of ‘single'</p><p><sup>c</sup>The first four features are allowed to be absent</p></table-wrap-foot></table-wrap></p>
    <p id="Par28">Nevertheless, there is still room for improvement in <italic>AdmixSim 2</italic>. As in many other programs, we here also assume non-overlapping and discrete generations, which may have some limitations in practical applications. It is possible to consider overlapping and continuous generations in future versions. In addition, de novo mutation is not considered for determining individual fitness during simulation of natural selection, and the potential effect on admixture inference is to be further evaluated. Furthermore, the tree sequence recording (TSR) algorithm [<xref ref-type="bibr" rid="CR32">32</xref>] implemented in <italic>SLiM 3.3</italic> provides the necessary information to detect coalescence events and construct the genealogical tree at each chromosome position, although applying the TSR algorithm has a large impact on the performance of models, in terms of both runtime and memory usage (page 40 of <italic>SLiM 3.3</italic> manual). The TSR algorithm has also been applied into many other simulators like <italic>msprime</italic> and inference methods like <italic>tsinfer</italic> [<xref ref-type="bibr" rid="CR33">33</xref>]. Nonetheless, there is no single simulation tool is ideal for all cases and some other simulation tools are suitable for a few special scenarios. For example, in the framework of selection, <italic>SLiM 3.3</italic>, <italic>SELAM</italic>, and <italic>admix’em</italic> consider the cases including phenotypic selection, epistatic selection, or balancing selection. Although <italic>AdmixSim 2</italic> does not cover the comprehensive scenarios of mate choice as some other simulators, it implements sex-biased admixture (different admixture proportions for two sexes) and sex-specific selection (different selection coefficients for two sexes).</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par29">In summary, <italic>AdmixSim 2</italic> is an individual-based, forward-time simulator based on the extended WF model, which can be used to efficiently simulate one or more admixed populations under complex demographic scenarios. <italic>AdmixSim 2</italic> is highly flexible and it can implement combinations of multiple parameter settings to simulate admixture, recombination, mutation, and natural selection. Furthermore, <italic>AdmixSim 2</italic> can be used to simulate admixture scenarios for sex chromosomes and non-human species.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec10">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4415_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Figure S1</bold>. Admixture models of population (A) African America (B) Mexican and (C) Uyghur. The numbers on the arrows represent the corresponding admixture proportions. The time on the left of each model represent the admixture generations</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2021_4415_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2: Figure S2</bold>. Simulation of Mexican admixture pattern. (A) PCA results. The left is the result of empirical data and the right is the result of simulated data. The patterns of two results are quite similar. (B) Segment length proportion. The proportion of each ancestry was calculated based on the sum of the corresponding segment length. The average proportion of European, African, and Native American were 0.506, 0.054, and 0.440, which is consistent with proportions set in the admixture model (European: 0.512, African: 0.052, Native American: 0.436). (C) Supervised admixture analysis results at K = 3. The left is the result of empirical data and the right is the result of simulated data. There is no marked difference between these two results. (D) Mutation number counts. The green histogram represents the simulation value and the red curve is derived from the theoretical Poisson distribution. The p-value was calculated using the chi-square goodness of fit test. The chromosome length was approximate 2.48 Morgan and the mutation rate was set as 10-8 per generation per site. As a result, after simulating 18 generations, the average mutation number of each haplotype is about 45</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2021_4415_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3: Figure S3</bold>. Simulation of Uyghur admixture pattern. (A) PCA results. The left is the result of empirical data and the right is the result of simulated data. The patterns of two results are quite similar. (B) Segment length proportion. The proportion of each ancestry was calculated based on the sum of the corresponding segment length. The average proportion of East Asian, Siberian, West Eurasian, and South Asian were 0.33, 0.17, 0.36, and 0.14, which is consistent with proportions in the admixture model (East Asian: 0.35, Siberian: 0.15, West Eurasian: 0.35, South Asian: 0.15). (C) Supervised admixture analysis results at K = 4. The left is the result of empirical data and the right is the result of simulated data. There is no marked difference between these two results. (D) Mutation number counts. The green histogram represents the simulation value and the red curve is the Poisson distribution, theoretically. The p-value was calculated using the chi-square goodness of fit. The chromosome length was about 2.48 Morgan and the mutation rate was set as 10-8 per generation per site. Therefore, after simulating 150 generations, the average mutation number of each haplotype is about 372</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2021_4415_MOESM4_ESM.docx">
            <caption>
              <p><bold>Additional file 4: Table S1</bold>. Parameter settings of typical admixture pattern</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2021_4415_MOESM5_ESM.docx">
            <caption>
              <p><bold>Additional file 5: Table S2</bold>. Parameter settings of selection fixation test</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2021_4415_MOESM6_ESM.docx">
            <caption>
              <p><bold>Additional file 6: Table S3</bold>. Parameter settings of performance evaluation</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>EGDP</term>
        <def>
          <p id="Par4">The Estonian biocentre human genome diversity panel</p>
        </def>
      </def-item>
      <def-item>
        <term>GSR</term>
        <def>
          <p id="Par5">Genetic simulation resources</p>
        </def>
      </def-item>
      <def-item>
        <term>HI</term>
        <def>
          <p id="Par6">Hybrid isolation</p>
        </def>
      </def-item>
      <def-item>
        <term>KGP</term>
        <def>
          <p id="Par7">1000 Genomes Project</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par8">Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>SGDP</term>
        <def>
          <p id="Par9">The Simon genome diversity project</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par10">Single nucleotide variation</p>
        </def>
      </def-item>
      <def-item>
        <term>WF</term>
        <def>
          <p id="Par11">Wright–Fisher</p>
        </def>
      </def-item>
      <def-item>
        <term>YRI</term>
        <def>
          <p id="Par12">Yoruba in Ibadan, Nigeria</p>
        </def>
      </def-item>
      <def-item>
        <term>TSR</term>
        <def>
          <p id="Par13">Tree sequence recording</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Rui Zhang and Chang Liu have contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to the people of Population Genomics Group (PGG) who participated in the software testing and provided constructive suggestions. We thank LetPub (<ext-link ext-link-type="uri" xlink:href="http://www.letpub.com">www.letpub.com</ext-link>) for its linguistic assistance during the preparation of this manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>SX conceived the study. RZ and CL designed and implemented the <italic>AdmixSim 2</italic> with contributions from KY and XN. RZ, CL, and SX wrote the manuscript. RZ and CL validated the function and analyzed the performance with contributions from XN and KY. YP designed the scripts for calculating summary statistics. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was supported by the National Key Research and Development Program (2016YFC0906403), the National Natural Science Foundation of China (NSFC) Grants (32030020, 31771388, 32041008, 31525014, 31961130380, 31900418, and 11801027), the Strategic Priority Research Program (XDPB17, XDB38000000) of the Chinese Academy of Sciences (CAS), the UK Royal Society-Newton Advanced Fellowship (NAF\R1\191094), the Shanghai Municipal Science and Technology Major Project (2017SHZDZX01), and the Fundamental Research Funds for the Central Universities (2020RC001). The funders had no role in study design, data collection, and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>AdmixSim 2</italic>: <ext-link ext-link-type="uri" xlink:href="https://www.picb.ac.cn/PGG/resource.php">https://www.picb.ac.cn/PGG/resource.php</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://github.com/Shuhua-Group/AdmixSim2">https://github.com/Shuhua-Group/AdmixSim2</ext-link>. Operating system(s): Linux. Programming language: C++ and Python. License: GNU GPL v3.0. Any restrictions to use by non academics: None. The availability of public software and data used in the current study are listed as below: <italic>MultiWaver</italic> series software: <ext-link ext-link-type="uri" xlink:href="https://www.picb.ac.cn/PGG/resource.php">https://www.picb.ac.cn/PGG/resource.php</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://github.com/Shuhua-Group/MultiWaveInfer2.0">https://github.com/Shuhua-Group/MultiWaveInfer2.0</ext-link>. 1000 Genomes Project data: <ext-link ext-link-type="uri" xlink:href="https://www.internationalgenome.org">https://www.internationalgenome.org</ext-link>. Human Origins Project data: <ext-link ext-link-type="uri" xlink:href="https://reich.hms.harvard.edu/datasets">https://reich.hms.harvard.edu/datasets</ext-link>, available through the European Nucleotide Archive under accession number PRJEB6272.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par30">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par31">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par32">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carvajal-Rodriguez</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Simulation of genomes: a review</article-title>
        <source>Curr Genom</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>155</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.2174/138920208784340759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carvajal-Rodriguez</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Simulation of genes and genomes forward in time</article-title>
        <source>Curr Genom</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>58</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.2174/138920210790218007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Youfang Liu GAaMEW</collab>
        </person-group>
        <article-title>A survey of genetic simulation software for population and epidemiological studies</article-title>
        <source>Hum Genom</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>79</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1186/1479-7364-3-1-79</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoban</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>An overview of the utility of population simulation software in molecular ecology</article-title>
        <source>Mol Ecol</source>
        <year>2014</year>
        <volume>23</volume>
        <issue>10</issue>
        <fpage>2383</fpage>
        <lpage>2401</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.12741</pub-id>
        <pub-id pub-id-type="pmid">24689878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoban</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bertorelle</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gaggiotti</surname>
            <given-names>OE</given-names>
          </name>
        </person-group>
        <article-title>Computer simulations: tools for population and evolutionary genetics</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>2</issue>
        <fpage>110</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3130</pub-id>
        <pub-id pub-id-type="pmid">22230817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Herrington</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>An overview of population genetic data simulation</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0188</pub-id>
        <pub-id pub-id-type="pmid">22149682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kimmel</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>simuPOP: a forward-time population genetics simulation environment</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>18</issue>
        <fpage>3686</fpage>
        <lpage>3687</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti584</pub-id>
        <pub-id pub-id-type="pmid">16020469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Amos</surname>
            <given-names>CI</given-names>
          </name>
        </person-group>
        <article-title>Forward-time simulations of non-random mating populations using simuPOP</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>11</issue>
        <fpage>1408</fpage>
        <lpage>1409</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn179</pub-id>
        <pub-id pub-id-type="pmid">18417488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guillaume</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rougemont</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nemo: an evolutionary and population genetics programming framework</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>20</issue>
        <fpage>2556</fpage>
        <lpage>2557</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl415</pub-id>
        <pub-id pub-id-type="pmid">16882649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudek</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Motsinger</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Velez</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Data simulation software for whole-genome association and other studies in human genetics</article-title>
        <source>Pac Sympos Biocomput</source>
        <year>2006</year>
        <volume>11</volume>
        <fpage>499</fpage>
        <lpage>510</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Edwards TL, Bush WS, Turner SD, Dudek SM, Torstenson ES, Schmidt M, Martin E, Ritchie MD. Generating linkage disequilibrium patterns in data simulations using genome SIMLA. EvoBIO 2008:24–35.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schumer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>GG</given-names>
          </name>
        </person-group>
        <article-title>Admix'em: a flexible framework for forward-time simulations of hybrid populations with selection and mate choice</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>7</issue>
        <fpage>1103</fpage>
        <lpage>1105</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv700</pub-id>
        <pub-id pub-id-type="pmid">26615212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Corbett-Detig R, Jones M. SELAM: simulation of epistasis and local adaptation during admixture with mate choice. Bioinformatics 2016.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Messer</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>SLiM: simulating evolution with selection and linkage</article-title>
        <source>Genetics</source>
        <year>2013</year>
        <volume>194</volume>
        <issue>4</issue>
        <fpage>1037</fpage>
        <lpage>1039</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.113.152181</pub-id>
        <pub-id pub-id-type="pmid">23709637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haller</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Messer</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>SLiM 2: flexible, interactive forward genetic simulations</article-title>
        <source>Mol Biol Evol</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>230</fpage>
        <lpage>240</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msw211</pub-id>
        <pub-id pub-id-type="pmid">27702775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haller</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Messer</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>SLiM 3: forward genetic simulations beyond the Wright–Fisher model</article-title>
        <source>Mol Biol Evol</source>
        <year>2019</year>
        <volume>36</volume>
        <issue>3</issue>
        <fpage>632</fpage>
        <lpage>637</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msy228</pub-id>
        <pub-id pub-id-type="pmid">30517680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thornton</surname>
            <given-names>KR</given-names>
          </name>
        </person-group>
        <article-title>A C++ template library for efficient forward-time population genetic simulation of large populations</article-title>
        <source>Genetics</source>
        <year>2014</year>
        <volume>198</volume>
        <issue>1</issue>
        <fpage>157</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.114.165019</pub-id>
        <pub-id pub-id-type="pmid">24950894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kessner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Novembre</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>forqs: forward-in-time simulation of recombination, quantitative traits and selection</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>576</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt712</pub-id>
        <pub-id pub-id-type="pmid">24336146</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Tahmasbi R, Keller MC. GeneEvolve: a fast and memory efficient forward-time simulator of realistic whole-genome sequence and SNP data. Bioinformatics 2017.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Yang X, Yuan K, Ni X, Zhou Y, Guo W, Xu S. AdmixSim: a forward-time simulator for various complex scenarios of population admixture. Front Genet 2020, 11.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neuenschwander</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Michaud</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Goudet</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>QuantiNemo 2: a Swiss knife to simulate complex demographic and genetic scenarios, forward and backward in time</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>5</issue>
        <fpage>886</fpage>
        <lpage>888</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty737</pub-id>
        <pub-id pub-id-type="pmid">30816926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ni</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Inference of multiple-wave admixtures by length distribution of ancestral tracks</article-title>
        <source>Heredity (Edinb)</source>
        <year>2018</year>
        <volume>121</volume>
        <issue>1</issue>
        <fpage>52</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/s41437-017-0041-2</pub-id>
        <pub-id pub-id-type="pmid">29358727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic history of Xinjiang's Uyghurs suggests Bronze age multiple-way contacts in Eurasia</article-title>
        <source>Mol Biol Evol</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>10</issue>
        <fpage>2572</fpage>
        <lpage>2582</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx177</pub-id>
        <pub-id pub-id-type="pmid">28595347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Gad Abraham MI. Fast principal component analysis of large-scale genome-wide data. PLoS ONE 2014, 9(4).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexander</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Novembre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Fast model-based estimation of ancestry in unrelated individuals</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>9</issue>
        <fpage>1655</fpage>
        <lpage>1664</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.094052.109</pub-id>
        <pub-id pub-id-type="pmid">19648217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelleher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Etheridge</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>e1004842</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004842</pub-id>
        <pub-id pub-id-type="pmid">27145223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gutenkunst</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>Inferring the joint demographic history of multiple populations from multidimensional SNP frequency data</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>e1000695</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000695</pub-id>
        <pub-id pub-id-type="pmid">19851460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gravel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henn</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Gutenkunst</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Indap</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Genomes</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>Demographic history and rare allele sharing among human populations</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>29</issue>
        <fpage>11983</fpage>
        <lpage>11988</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1019276108</pub-id>
        <pub-id pub-id-type="pmid">21730125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Modeling continuous admixture using admixture-induced linkage disequilibrium</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>43054</fpage>
        <pub-id pub-id-type="doi">10.1038/srep43054</pub-id>
        <pub-id pub-id-type="pmid">28230170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ni</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MultiWaver 2.0: modeling discrete and continuous gene flow to reconstruct complex population admixtures</article-title>
        <source>Eur J Hum Genet</source>
        <year>2019</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>133</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1038/s41431-018-0259-3</pub-id>
        <pub-id pub-id-type="pmid">30206356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Victor S, Solar R, Gil-Costa V, Marin M. Towards rapid population genetics forward-in-time simulations. In: Proceedings of the 2017 winter simulation conference 2017.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelleher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Ashander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ralph</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>Efficient pedigree recording for fast population genetics simulation</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>11</issue>
        <fpage>e1006581</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006581</pub-id>
        <pub-id pub-id-type="pmid">30383757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelleher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wohns</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Fadil</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Inferring whole-genome histories in large population datasets</article-title>
        <source>Nat Genet</source>
        <year>2019</year>
        <volume>51</volume>
        <issue>9</issue>
        <fpage>1330</fpage>
        <lpage>1338</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0483-y</pub-id>
        <pub-id pub-id-type="pmid">31477934</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
