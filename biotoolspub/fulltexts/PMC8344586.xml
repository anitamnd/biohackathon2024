<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8344586</article-id>
    <article-id pub-id-type="pmid">34096994</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab421</article-id>
    <article-id pub-id-type="publisher-id">btab421</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A SARS-CoV-2 sequence submission tool for the European Nucleotide Archive</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7461-1427</contrib-id>
        <name>
          <surname>Roncoroni</surname>
          <given-names>Miguel</given-names>
        </name>
        <aff><institution>Department of Plant Biotechnology and Bioinformatics, Ghent University</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <aff><institution>VIB Center for Plant Systems Biology</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <xref rid="btab421-cor1" ref-type="corresp"/>
        <!--miguel.roncoroni@psb.vib-ugent.be-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3079-6586</contrib-id>
        <name>
          <surname>Droesbeke</surname>
          <given-names>Bert</given-names>
        </name>
        <aff><institution>Department of Plant Biotechnology and Bioinformatics, Ghent University</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <aff><institution>VIB Center for Plant Systems Biology</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8231-3323</contrib-id>
        <name>
          <surname>Eguinoa</surname>
          <given-names>Ignacio</given-names>
        </name>
        <aff><institution>Department of Plant Biotechnology and Bioinformatics, Ghent University</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <aff><institution>VIB Center for Plant Systems Biology</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Ruyck</surname>
          <given-names>Kim</given-names>
        </name>
        <aff><institution>Department of Plant Biotechnology and Bioinformatics, Ghent University</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <aff><institution>VIB Center for Plant Systems Biology</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>D’Anna</surname>
          <given-names>Flora</given-names>
        </name>
        <aff><institution>Department of Plant Biotechnology and Bioinformatics, Ghent University</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <aff><institution>VIB Center for Plant Systems Biology</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yusuf</surname>
          <given-names>Dilmurat</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Freiburg</institution>, 79110 Freiburg im Breisgau, Baden-Württemberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grüning</surname>
          <given-names>Björn</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Freiburg</institution>, 79110 Freiburg im Breisgau, Baden-Württemberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Backofen</surname>
          <given-names>Rolf</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Freiburg</institution>, 79110 Freiburg im Breisgau, Baden-Württemberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coppens</surname>
          <given-names>Frederik</given-names>
        </name>
        <aff><institution>Department of Plant Biotechnology and Bioinformatics, Ghent University</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
        <aff><institution>VIB Center for Plant Systems Biology</institution>, 9052 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lu</surname>
          <given-names>Zhiyong</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab421-cor1">To whom correspondence should be addressed. <email>miguel.roncoroni@psb.vib-ugent.be</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-06-07">
      <day>07</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>21</issue>
    <fpage>3983</fpage>
    <lpage>3985</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab421.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Many aspects of the global response to the COVID-19 pandemic are enabled by the fast and open publication of SARS-CoV-2 genetic sequence data. The European Nucleotide Archive (ENA) is the European recommended open repository for genetic sequences. In this work, we present a tool for submitting raw sequencing reads of SARS-CoV-2 to ENA. The tool features a single-step submission process, a graphical user interface, tabular-formatted metadata and the possibility to remove human reads prior to submission. A Galaxy wrap of the tool allows users with little or no bioinformatics knowledge to do bulk sequencing read submissions. The tool is also packed in a Docker container to ease deployment.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>CLI ENA upload tool is available at <ext-link xlink:href="http://github.com/usegalaxy-eu/ena-upload-cli" ext-link-type="uri">github.com/usegalaxy-eu/ena-upload-cli</ext-link> (DOI 10.5281/zenodo.4537621); Galaxy ENA upload tool at <ext-link xlink:href="http://toolshed.g2.bx.psu.edu/view/iuc/ena_upload/382518f24d6d" ext-link-type="uri">toolshed.g2.bx.psu.edu/view/iuc/ena_upload/382518f24d6d</ext-link> and <ext-link xlink:href="https://github.com/galaxyproject/tools-iuc/tree/master/tools/ena_upload" ext-link-type="uri">github.com/galaxyproject/tools-iuc/tree/master/tools/ena_upload</ext-link> (development); and ENA upload Galaxy container at <ext-link xlink:href="http://github.com/ELIXIR-Belgium/ena-upload-container" ext-link-type="uri">github.com/ELIXIR-Belgium/ena-upload-container</ext-link> (DOI 10.5281/zenodo.4730785).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fonds Wetenschappelijk Onderzoek</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003130</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>I002819N</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Sonderforschungsbereich</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>TRR</institution>
          </institution-wrap>
        </funding-source>
        <award-id>167/2 Z01</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The current COVID-19 pandemic caused by the SARS-CoV-2 virus has highlighted the importance of open and FAIR (Findable, Accessible, Interoperable, Reusable) (<xref rid="btab421-B5" ref-type="bibr">Wilkinson <italic toggle="yes">et al.</italic>, 2016</xref>) data. Fast and open access to all types of data (biomolecular, epidemiological, societal) is paramount to the quick development and deployment of tests, vaccines, treatments and policies used in the fight against the virus. </p>
    <p>Genome sequences of SARS-CoV-2 are available since early January 2020 (<xref rid="btab421-B6" ref-type="bibr">Wu <italic toggle="yes">et al</italic>., 2020</xref>) and have enabled, among other things, the design of polymerase chain reaction tests and vaccines. Currently, genome sequencing is the only way for detecting and monitoring new, and potentially more infectious, virus variants. In the COVID-19 Data Portal (<ext-link xlink:href="http://www.covid19dataportal.org" ext-link-type="uri">www.covid19dataportal.org</ext-link>), the repository for SARS-CoV-2 nucleotide sequence data is the European Nucleotide Archive (ENA). ENA stores raw sequencing data, assemblies and annotation data (<ext-link xlink:href="http://www.ebi.ac.uk/ena/browser/home" ext-link-type="uri">www.ebi.ac.uk/ena/browser/home</ext-link>). As part of the International Nucleotide Sequence Database Collaboration (INSDC), ENA also indexes data from the NCBI and DDBJ (<xref rid="btab421-B1" ref-type="bibr">Arita <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>The Global Initiative on Sharing All Influenza Data (GISAID, <ext-link xlink:href="http://www.gisaid.org" ext-link-type="uri">www.gisaid.org</ext-link>) is a specialized repository for genetic, clinical and epidemiological data of influenza viruses and coronaviruses. GISAID is also one of the data resources mentioned in the European guidelines for open access to COVID-19 data. It differs from ENA and other INSDC repositories in some key aspects: access to data and data submission are only possible after application and registration; reuse of data is restricted; and only the consensus sequence of assembled genomes is accepted.</p>
    <p>Raw reads contain valuable information, such as coverage depth and quality scores, that is lost in a consensus sequence. Variant callers with different stringencies on coverage and quality may produce slightly different consensus sequences from the same raw reads (<xref rid="btab421-B2" ref-type="bibr">Black <italic toggle="yes">et al.</italic>, 2020</xref>). Accurate and reproducible variant calling is particularly important for the detection and monitoring of new virus variants.</p>
    <p>Submissions to both GISAID and ENA are increasing exponentially. However, while over 1.7 M SARS-CoV-2 genome sequences have been submitted to GISAID, only 645 K raw reads submissions occurred in ENA-INSDC as of May 2021. This has two important implications for the research community: the majority of SARS-CoV-2 genomes are not fully FAIR and their underlying raw data remains unpublished. We believe that this discrepancy is in part caused by the technical barrier to submitting large amounts of raw reads to ENA which requires command line knowledge and metadata in XML format, putting off many researchers and clinicians.</p>
    <p>We have developed a tool to facilitate the submission of SARS-CoV-2 raw sequence reads to ENA. The tool simplifies the submission process by performing ’Study’ and ’Sample’ registration, and data submission in one step. Metadata is submitted via a single spreadsheet template containing all mandatory fields and controlled vocabulary or interactively. The tool is available in the command line, as a Galaxy tool, and packed in a Docker container. There are many advantages of porting this submission tool to Galaxy including a graphical user interface, access to tools and workflows (including SARS-CoV-2-specific ones) (<xref rid="btab421-B4" ref-type="bibr">Maier <italic toggle="yes">et al.</italic>, 2021</xref>) for preprocessing, downstream analysis and visualization of sequences. Galaxy also provides a platform for sharing of data and metadata, facilitating international collaboration, integration with other public resources and enabling publishing FAIR data and analysis workflows.</p>
    <p><xref rid="btab421-F1" ref-type="fig">Figure 1</xref> outlines the data and metadata flow using the different instances of the tool.</p>
    <fig position="float" id="btab421-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Schematic data and metadata flow of a submission of raw reads to ENA using the ENA upload Galaxy container. Raw reads can be processed with Metagen-FastQC tool to remove human reads. Metadata can be input using a template spreadsheet or interactively in Galaxy. Webin credentials are kept in the Galaxy user profile. Upon execution, sequence files are uploaded to ENA FTP server and ’Study’ and ’Sample’ are registered. Accession numbers are retrieved, added to the metadata and this is pushed with cURL to ENA to complete the submission</p>
      </caption>
      <graphic xlink:href="btab421f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Features</title>
    <sec>
      <title>2.1 Command line interface ENA upload tool</title>
      <p>This python script is used for programmatic submissions of sequencing reads to ENA. It has a command line interface and requires four metadata tables, the sequence files and a Webin ID and password. Metadata is imported through four tabular (tsv) files, one each for ’Study’, ’Sample’, ’Experiment’ and ’Run’ (ena-docs.readthedocs.io/en/latest/submit/general-guide/metadata.html). From these tables, the tool uses the Genshi template engine to generate XML files needed for a programmatic submission of reads to ENA, including the submission XML file. The tool submits the sequence data to the user’s private Webin file upload area at EMBL-EBI using FTP and uses the checksum of the data files to ensure the data integrity. To perform bulk submission of all objects, the aliases IDs in different ENA objects should correspond to the aliases IDs in the experiment object, linking all objects together. After the data files are submitted, the tool registers the ’Study’, ’Samples’, ’Experiments’ and ’Runs’ metadata at ENA. Submission of the XML metadata is done with cURL.</p>
    </sec>
    <sec>
      <title>2.2 Galaxy ENA upload tool</title>
      <p>The command line submission tool was also wrapped into a Galaxy tool. Galaxy’s graphical user interface makes it more accessible to researchers with limited or no command line experience. Additionally, Galaxy offers a myriad of tools and workflows to preprocess and analyze genetic sequence data, including COVID-19 specific workflows (<ext-link xlink:href="http://covid19.galaxyproject.org/" ext-link-type="uri">covid19.galaxyproject.org/</ext-link>). The user adds the Webin credentials required for submission to the Galaxy user profile. For custom Galaxy instances, the admin can enable users to set their own credentials using a yaml configuration file. In addition to the tsv files, the user can input the metadata interactively in Galaxy or complete and upload a metadata template spreadsheet. In all cases, the Galaxy submission tool converts the metadata to the tsv files required to generate the xml files for submission. The tool is indexed at Galaxy’s tool shed and available for use at usegalaxy.eu. The ENA upload tool is part of the Intergalactic Utilities Commission, a curated collection of Galaxy tools.</p>
    </sec>
    <sec>
      <title>2.3 ENA upload Galaxy container</title>
      <p>We made use of the Galaxy Docker base image (<ext-link xlink:href="http://github.com/bgruening/docker-galaxy-stable" ext-link-type="uri">github.com/bgruening/docker-galaxy-stable</ext-link>) to pack the submission tool into a custom-tailored ENA upload Galaxy container. The Galaxy instance in the container has a user guide in its middle pane and includes a tool to remove contaminant human reads. This tool is a wrap of Metagen-FastQC that removes any reads that map to the human genome (<ext-link xlink:href="http://github.com/Finn-Lab/Metagen-FastQC" ext-link-type="uri">github.com/Finn-Lab/Metagen-FastQC</ext-link>). Mapping is done using BWA-MEM (<xref rid="btab421-B3" ref-type="bibr">Li and Durbin, 2010</xref>) and can be resource intensive. BWA-MEM took an average of 39.0 min (3.0 min SD) and 5.26 GB of memory (0.01 GB SD) to align one Ion Torrent sequence file (<italic toggle="yes">n</italic> = 8, mean file size was 182 MB) on a workstation with 8 GB memory and 1.6 GHz eight-core processor. The whole container running the cleanup tool peaked at 6.23 GB memory (0.19 GB SD). We recommend this tool for containers deployed on clusters with ample memory resources. The human reference genome is stored in a CernVM-FS repository. A FUSE client is mounted upon running the container to be able to access the repository. An alternative version of the container includes a copy of the indexed human reference genome hg38. Included is also a workflow to preprocess short reads (Illumina or ONT) before submission, adapted from an existing Galaxy SARS-CoV-2 preprocessing workflow (<ext-link xlink:href="http://github.com/galaxyproject/SARS-CoV-2/tree/master/genomics" ext-link-type="uri">github.com/galaxyproject/SARS-CoV-2/tree/master/genomics</ext-link>). Installing the dependencies for this workflow is done automatically using the workflow file.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>The ENA upload Galaxy container was used by ELIXIR Belgium to submit SARS-CoV-2 sequence data from Belgian patients to ENA. We submitted 39 sequences (runs) from 35 samples obtained from oropharyngeal swabs of COVID-19 patients at Hospital AZ Rivierenland in Antwerp (PRJEB40711). The data were provided by the Institute of Tropical Medicine (<ext-link xlink:href="http://www.itg.be" ext-link-type="uri">www.itg.be</ext-link>). Additionally, eight SARS-CoV-2 sequences from eight postmortem FFPE lung tissue samples (Hôpital Erasme-Université Libre de Bruxelles) were successfully submitted to ENA (PRJEB42699).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In keeping with FAIR principles, the ENA offers unrestricted access and reuse of raw and analyzed sequence data. The set of tools presented here facilitate the submission of raw SARS-CoV-2 sequences to ENA. It should prove particularly useful for users submitting large numbers of raw read data files programmatically and/or for users with limited or no bioinformatics skills. Submitting raw viral sequence data to ENA ensures that all researchers can access and use this in the response against COVID-19.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Fonds Wetenschappelijk Onderzoek [I002819N] and Sonderforschungsbereich/TRR [167/2 Z01].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab421-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arita</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>The international nucleotide sequence database collaboration</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>D121</fpage>–<lpage>D124</lpage>.<pub-id pub-id-type="pmid">33166387</pub-id></mixed-citation>
    </ref>
    <ref id="btab421-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Black</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Ten recommendations for supporting open pathogen genomic analysis in public health</article-title>. <source>Nat. Med</source>., <volume>26</volume>, <fpage>832</fpage>–<lpage>841</lpage>.<pub-id pub-id-type="pmid">32528156</pub-id></mixed-citation>
    </ref>
    <ref id="btab421-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>589</fpage>–<lpage>595</lpage>.<pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="btab421-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maier</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Freely accessible ready to use global infrastructure for SARS-CoV-2 monitoring</article-title>. <source>bioRXiv</source>, doi:10.1101/2021.03.25.437046.</mixed-citation>
    </ref>
    <ref id="btab421-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilkinson</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>The FAIR guiding principles for scientific data management and stewardship</article-title>. <source>Sci. Data</source>, <volume>3</volume>, <fpage>160018</fpage>.<pub-id pub-id-type="pmid">26978244</pub-id></mixed-citation>
    </ref>
    <ref id="btab421-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A new coronavirus associated with human respiratory disease in China</article-title>. <source>Nature</source>, <volume>579</volume>, <fpage>265</fpage>–<lpage>269</lpage>.<pub-id pub-id-type="pmid">32015508</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
