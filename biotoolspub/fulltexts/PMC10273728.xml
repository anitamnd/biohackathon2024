<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10273728</article-id>
    <article-id pub-id-type="pmid">37322495</article-id>
    <article-id pub-id-type="publisher-id">1196</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01196-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ReporTree: a surveillance-oriented tool to strengthen the linkage between pathogen genetic clusters and epidemiological data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mixão</surname>
          <given-names>Verónica</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pinto</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sobral</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Di Pasquale</surname>
          <given-names>Adriano</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gomes</surname>
          <given-names>João Paulo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3767-2209</contrib-id>
        <name>
          <surname>Borges</surname>
          <given-names>Vítor</given-names>
        </name>
        <address>
          <email>vitor.borges@insa.min-saude.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.422270.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2287 695X</institution-id><institution>Genomics and Bioinformatics Unit, Department of Infectious Diseases, </institution><institution>National Institute of Health Doutor Ricardo Jorge (INSA), </institution></institution-wrap>Lisbon, Portugal </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419578.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1805 1770</institution-id><institution>National Reference Centre (NRC) for Whole Genome Sequencing of Microbial Pathogens: Database and Bioinformatics analysis (GENPAT), </institution><institution>Istituto Zooprofilattico Sperimentale Dell’Abruzzo E del Molise “Giuseppe Caporale” (IZSAM), </institution></institution-wrap>Teramo, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>43</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genomics-informed pathogen surveillance strengthens public health decision-making, playing an important role in infectious diseases’ prevention and control. A pivotal outcome of genomics surveillance is the identification of pathogen genetic clusters and their characterization in terms of geotemporal spread or linkage to clinical and demographic data. This task often consists of the visual exploration of (large) phylogenetic trees and associated metadata, being time-consuming and difficult to reproduce.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed ReporTree, a flexible bioinformatics pipeline that allows diving into the complexity of pathogen diversity to rapidly identify genetic clusters at any (or all) distance threshold(s) or cluster stability regions and to generate surveillance-oriented reports based on the available metadata, such as timespan, geography, or vaccination/clinical status. ReporTree is able to maintain cluster nomenclature in subsequent analyses and to generate a nomenclature code combining cluster information at different hierarchical levels, thus facilitating the active surveillance of clusters of interest. By handling several input formats and clustering methods, ReporTree is applicable to multiple pathogens, constituting a flexible resource that can be smoothly deployed in routine surveillance bioinformatics workflows with negligible computational and time costs. This is demonstrated through a comprehensive benchmarking of (i) the cg/wgMLST workflow with large datasets of four foodborne bacterial pathogens and (ii) the alignment-based SNP workflow with a large dataset of <italic>Mycobacterium tuberculosis</italic>. To further validate this tool, we reproduced a previous large-scale study on <italic>Neisseria gonorrhoeae</italic>, demonstrating how ReporTree is able to rapidly identify the main species genogroups and characterize them with key surveillance metadata, such as antibiotic resistance data. By providing examples for SARS-CoV-2 and the foodborne bacterial pathogen <italic>Listeria monocytogenes</italic>, we show how this tool is currently a useful asset in genomics-informed routine surveillance and outbreak detection of a wide variety of species.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In summary, ReporTree is a pan-pathogen tool for automated and reproducible identification and characterization of genetic clusters that contributes to a sustainable and efficient public health genomics-informed pathogen surveillance. ReporTree is implemented in python 3.8 and is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree">https://github.com/insapathogenomics/ReporTree</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01196-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>ReporTree</kwd>
      <kwd>Genetic clustering</kwd>
      <kwd>Genomic surveillance</kwd>
      <kwd>Public health</kwd>
      <kwd>Automated pipeline</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010678</institution-id>
            <institution>H2020 Food</institution>
          </institution-wrap>
        </funding-source>
        <award-id>773830</award-id>
        <principal-award-recipient>
          <name>
            <surname>Borges</surname>
            <given-names>Vítor</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>FCT - Foundation for Science and Technology, I.P.</institution>
        </funding-source>
        <award-id>2022.00851.CEECIND/CP1748/CT0001</award-id>
        <principal-award-recipient>
          <name>
            <surname>Mixão</surname>
            <given-names>Verónica</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background
</title>
    <p id="Par11">Whole-genome sequencing (WGS) is the method with the highest resolution to discriminate and classify microorganisms (either at inter- or intra-species level) based on their genetic relatedness. Therefore, the implementation of genomics-informed surveillance systems able to track the circulation of pathogens and monitor their clinical and epidemiologically relevant features is essential for infectious diseases’ prevention and control and for a more informed public health decision-making.</p>
    <p id="Par12">Several bioinformatics solutions for the analysis of WGS data are currently available, with most workflows for genetic clustering determination ending up in the same key output: a phylogenetic tree or a tree-like representation. This often corresponds to a minimum spanning tree (MST) or a dendrogram reflecting the allele distances that result from a core-genome (cg) or whole-genome (wg) multilocus sequence type (MLST) analysis (commonly used approach for bacterial pathogens [<xref ref-type="bibr" rid="CR1">1</xref>]) or to a rooted tree reflecting the single-nucleotide polymorphism (SNP) distances that result from a multiple sequence alignment (e.g., as routinely applied for viruses [<xref ref-type="bibr" rid="CR2">2</xref>], such as SARS-CoV-2 or monkeypox virus). Subsequently, the identification and characterization of epidemiologically/biologically relevant genetic clusters (e.g., clusters of outbreak-related strains) often consists of the visual exploration of these (large) phylogenetic trees and associated metadata, taking advantage of robust visualization tools, such as those provided by PHYLOViZ [<xref ref-type="bibr" rid="CR3">3</xref>], GrapeTree [<xref ref-type="bibr" rid="CR4">4</xref>], Nextstrain [<xref ref-type="bibr" rid="CR5">5</xref>], Microreact [<xref ref-type="bibr" rid="CR6">6</xref>], or Taxonium [<xref ref-type="bibr" rid="CR7">7</xref>]. As such, this task can be time-consuming and difficult to reproduce.</p>
    <p id="Par13">In this context, there is a continuous scientific effort to automate the identification of clusters at specific genetic thresholds [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR14">14</xref>] and develop dynamic cluster/lineage nomenclature systems, such as the Pango system for SARS-CoV-2 [<xref ref-type="bibr" rid="CR15">15</xref>] or the bacteria-oriented “SNP address” of SnapperDB, the HierCC of Enterobase, the “HashID” of chewieSnake, or the INNUENDO nomenclature system [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Still, the field would benefit from the development of automated and more flexible tools that can be used for a wide variety of species, not only to facilitate the detection of genetic clusters at any (or all) distance thresholds of a tree but also to automatically characterize them based on the available metadata variables of interest.</p>
    <p id="Par14">Here, we present ReporTree, an automated surveillance-oriented resource that allows diving into the complexity of pathogen diversity to rapidly identify genetic clusters at any distance thresholds between samples and further characterize them according to any relevant epidemiological indicator in a reproducible manner. ReporTree’s flexibility, reproducibility, and performance make it an innovative resource to enhance existing genomics surveillance systems, with potential benefits at multiple pathogen levels.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">ReporTree is a command-line tool implemented in python 3.8 that represents a flexible solution to obtain clustering information at any sample distance thresholds (partitions) either for species that require a cg/wgMLST analysis or for those that rely on SNPs/multiple sequence alignments for tree reconstruction. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, ReporTree pipeline can be divided into three major steps:<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic representation of the three main steps of ReporTree pipeline. Blue background highlights the alternative input types, green background highlights the alternative clustering modules, and pink background highlights the main outputs of ReporTree. Arrows indicate the alternative workflows for each input. Single asterisk, only output when a sequence alignment is provided. Double asterisks, exclusive output of MST and HC analysis. Triple asterisks, output of an optional step (comparing partitions) not represented in the figure</p></caption><graphic xlink:href="13073_2023_1196_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Input processing</title>
      <p id="Par16">The methodology used for WGS data analysis varies from species to species. For this reason, ReporTree was carefully designed to accept multiple input formats (Table <xref rid="Tab1" ref-type="table">1</xref>), being suitable for application in a wide variety of pathogens. Besides SNP/allele matrices and trees/dendrograms in Newick format, ReporTree accepts other input formats such as multiple sequence alignments, VCF files, or distance matrices. For instance, when a multiple sequence alignment is provided, ReporTree runs the script <italic>alignment_processing.py</italic> (also available in standalone mode) to clean the alignment according to the user's specifications and to convert it into a SNP matrix that will be used in the remaining steps. Moreover, when sample genetic variability is provided in the format of multiple VCF files or a list of mutations (variant sites), ReporTree uses vcf2mst [<xref ref-type="bibr" rid="CR17">17</xref>] to do this format conversion. Besides the input transformation, ReporTree’s input processing step can also involve the filtration of the input files to (i) remove samples with excess of missing data (e.g., samples with less than 95% of cgMLST loci called), (ii) remove informative sites/loci from the SNP/allele matrices (e.g., wgMLST loci called in less than 98% samples), and (iii) analyze a subset of samples fulfilling the metadata parameters specified by the user (e.g., samples from a given sequence type [ST] or year) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This dynamic approach allows maximizing the loci/positions shared by a subset of samples, thus contributing to an increased resolution power and, consequently, a higher confidence in the clustering analysis, aligned with a previously explored rationale [<xref ref-type="bibr" rid="CR14">14</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of ReporTree input types and respective clustering options, with indication of the main outputs provided by this tool</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Inputs Metadata and (phylo)genetic data</th><th align="left">Clustering options</th><th align="left">Main outputs</th></tr></thead><tbody><tr><td align="left" rowspan="2"><p>- <bold>Multiple sequence alignment</bold> (e.g., core SNP alignment)</p><p>- <bold>SNP/allele matrix</bold> (e.g., derived from cg/wgMLST analysis)</p><p>- List of <bold>mutations</bold> or <bold>VCFs</bold></p><p>- Pairwise <bold>distance matrix</bold> (only for HC)</p></td><td align="left"><bold>Minimum spanning tree</bold> (using GrapeTree)</td><td align="left" rowspan="3"><p>- <bold>Genetic clusters</bold> at any (or all) possible distance threshold(s) (partitions table)</p><p>- <bold>Updated metadata</bold> table with clustering information (and nomenclature)</p><p>- <bold>Summary reports with the statistics/trends for the derived genetic clusters</bold></p><p>- <bold>Nomenclature history (record of changes in cluster composition and codes between runs)</bold></p><p>- Summary reports and in-depth cluster analysis for <bold>samples of interest</bold></p><p>- <bold>Count/frequency matrices for the derived genetic clusters</bold> or for any other indicated grouping variable</p><p>- <bold>Regions of cluster stability</bold></p><p>- <bold>Newick tree</bold> (when applicable)</p></td></tr><tr><td align="left"><bold>Hierarchical clustering</bold> (using several methods, such as single-linkage)</td></tr><tr><td align="left">- <bold>Newick tree</bold> (e.g., SNP-scaled tree or dendrogram)</td><td align="left"><bold>Distance between leaves and root or between tree nodes</bold> (using TreeCluster)</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Clustering</title>
      <sec id="Sec5">
        <title>Cluster detection</title>
        <p id="Par17">Once the input files have been processed, ReporTree determines genetic clusters at all user-defined partition thresholds. When the input file corresponds to a phylogenetic tree, ReporTree runs the script <italic>partitioning_treecluster.py</italic> (also available in standalone mode), which takes advantage of TreeCluster [<xref ref-type="bibr" rid="CR8">8</xref>] to automatically determine the genetic clusters using one or several of the different algorithms provided by this tool. For all the other input types (except for the distance matrix which can only be used with a hierarchical clustering (HC) approach), the user can choose between genetic clustering using a GrapeTree or a HC algorithm (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). When a GrapeTree algorithm is requested (MSTreeV2 or goeBURST [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]), ReporTree runs the script <italic>partitioning_grapetree.py</italic> (also available in standalone mode), which uses a modified version of this program [<xref ref-type="bibr" rid="CR19">19</xref>], to obtain the MST and all the genetic clusters. When a HC algorithm is requested, ReporTree runs the script <italic>partitioning_HC.py</italic> (also available in standalone mode), which calculates pairwise Hamming distances with cgmlst-dists [<xref ref-type="bibr" rid="CR20">20</xref>] and determines the genetic clusters using one or several of the different algorithms provided by SciPy [<xref ref-type="bibr" rid="CR21">21</xref>]. The main output of each of these three clustering options is always a so-called partitions table with clustering information for each sample at all the distance thresholds and clustering algorithms requested by the user. Additionally, if the user provides a list of samples of interest (e.g., outbreak-related or newly sequenced samples), ReporTree can automatically apply the above-mentioned dynamic approach by additionally running a high-resolution analysis for every cluster including samples of interest and/or for the subset of the “N” most closely related samples to the samples of interest.</p>
        <p id="Par18">As a complement, ReporTree can optionally identify ranges of distance thresholds associated with cluster stability, i.e., subsequent partition thresholds in which clustering composition is similar. This kind of analysis can be useful for the user in future pathogen-specific nomenclature design. If requested by the user, ReporTree determines those “stable” regions by running a modified version of the code of the Comparing Partitions tool [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. This new version [<xref ref-type="bibr" rid="CR24">24</xref>] takes as input the “partitions table” with clustering information at all possible thresholds and assesses several metrics (Simpson’s Index of Diversity, Adjusted Rand and Adjusted Wallace coefficient) to compare the clustering information at consecutive partitions (from “n + 1” to “n”). Based on a previously described approach [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], ReporTree then uses the neighborhood Adjusted Wallace coefficient (nAWC) to ultimately determine regions of cluster stability [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR26">26</xref>].</p>
      </sec>
      <sec id="Sec6">
        <title>Cluster nomenclature system</title>
        <p id="Par19">ReporTree includes a nomenclature system that can act in two different but complementary ways, namely by (i) maintaining cluster nomenclature at any or all distance thresholds over time and (ii) providing a nomenclature code for each sample that combines clustering information at different hierarchical levels. For the first approach, the intended usage is to provide as input a “partitions table” containing the cluster names at any or all distance thresholds of a previous ReporTree run, which will then be used to (re)name the clusters (for the respective thresholds) of the current run. With this approach, clusters that do not change their composition or just acquire new samples (most expected scenario in a context of continuous surveillance) maintain their name. Moreover, if a previous cluster (e.g., cluster_1) is split into several new clusters in the new run, it will also keep the name by adding an additional suffix (e.g., cluster_1.1, cluster_1.2, etc.). New cluster names will be attributed in some situations, such as the merge of previous clusters, singletons that integrate clusters, and clusters exclusively composed by new samples. ReporTree keeps track of all these changes in cluster composition and nomenclature in a comprehensive tabular output. To increase the flexibility of the nomenclature system, ReporTree also allows the users to change the regular expression for cluster nomenclature (i.e., starting with “cluster_” or “singleton_”) by other nomenclature of interest (e.g., ECDC EpiPulse cluster ID, other official codes for outbreaks, genogroups, etc.), which will be kept afterwards.</p>
        <p id="Par20">Towards the simplification of the system, ReporTree can provide a short nomenclature code for each sample representing a combination of its clustering at different hierarchical levels, following the rationale behind “SNP address” and INNUENDO nomenclature systems [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. For example, if “150,30,7” thresholds are indicated, a combining code of cluster names at these levels will be generated by the same order: C3-C2-C1. In ReporTree, these levels are not predefined by default but instead must be indicated by the user, making it suitable for application to multiple pathogens and easily adaptable to the dataset diversity. ReporTree also opens the possibility to add an extra layer of information to this code with the inclusion of information of a given metadata variable (e.g., C3-C2-C1-CountryA, if country is added to the code).</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Summary report</title>
      <p id="Par21">The final step of ReporTree is the generation of summary reports with the <italic>metadata_report.py</italic> script (also available in standalone mode). Following the user’s specifications, this script can perform cluster characterization according to any relevant epidemiological indicator present in the metadata (e.g., source, vaccination status, antibiotic resistance phenotype). Similar summary reports can be generated to assess the distribution of any (and as many) user-specified variables of interest (e.g., ST distribution by year). When the time variable “date” is provided in the metadata, ReporTree automatically infers other time units (ISO week and ISO year) and metrics (e.g., cluster timespan) relevant for surveillance purposes. Moreover, ReporTree can provide count/relative frequency reports for any grouping variable, such as the relative frequency of the different (sub-)lineages/clusters circulating in the country over time. Noteworthy, ReporTree allows requesting specific reports for sample(s) of interest, as well as the application of filters in the metadata table to select subsets of samples that will be included in the analysis/report (without the need of generating a new subset metadata table). Moreover, when the “nomenclature code” was requested, summary reports of this variable are automatically provided, facilitating cluster tracking and characterization.</p>
      <p id="Par22">Besides these main reports (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), ReporTree generates multiple parallel outputs that enable a fine exploration of intermediate data (e.g., pairwise distance matrices, filtered alignments, trees/dendrograms), while rendering standardized formats that can be easily explored through multiple compatible visualization tools. For instance, users can interactively visualize and explore the ReporTree derived clusters by uploading an updated metadata table (with cluster information) together with the original/derived Newick MST/dendrogram to interactive tools, such as auspice.us [<xref ref-type="bibr" rid="CR5">5</xref>], Microreact [<xref ref-type="bibr" rid="CR6">6</xref>], or GrapeTree [<xref ref-type="bibr" rid="CR4">4</xref>]. In particular, ReporTree outputs can also be uploaded to GrapeTree-GIS [<xref ref-type="bibr" rid="CR27">27</xref>] to get an interactive visualization of a MST together with temporal and geographical data.</p>
      <p id="Par23">ReporTree is available as a github repository [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] or as a docker image [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results and discussion</title>
    <sec id="Sec9">
      <title>Benchmarking</title>
      <sec id="Sec10">
        <title>cg/wgMLST workflow</title>
        <p id="Par24">ReporTree benchmarking for the cg/wgMLST workflow was performed in a laptop [Intel Core i5(R)] with 16 GB of RAM using four different datasets of distinct foodborne bacterial pathogens: <italic>Listeria monocytogenes</italic> (1874 isolates [<xref ref-type="bibr" rid="CR31">31</xref>])<italic>, Salmonella enterica</italic> (1434 isolates [<xref ref-type="bibr" rid="CR32">32</xref>])<italic>, Escherichia coli</italic> (1999 isolates [<xref ref-type="bibr" rid="CR33">33</xref>]), and <italic>Campylobacter jejuni</italic> (3076 isolates [<xref ref-type="bibr" rid="CR34">34</xref>]). Each of these datasets consists of a collection of genome assemblies and respective allelic profiles of isolates with public sequencing data (deposited in SRA/ENA) that were carefully selected to cover a wide genetic diversity (assessed in terms of ST or serotype, depending on the species). Details on the methodology used for the isolates’ selection and dataset curation can be found in each dataset repository [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR34">34</xref>]. Briefly, the genome assemblies were performed with Aquamis v1.3.9 [<xref ref-type="bibr" rid="CR35">35</xref>] using default parameters. cg/wgMLST profiles were determined with chewBBACA v2.8.5 [<xref ref-type="bibr" rid="CR36">36</xref>] using the 1748-loci Pasteur cgMLST schema for <italic>L. monocytogenes</italic> [<xref ref-type="bibr" rid="CR37">37</xref>], the 8558-loci INNUENDO wgMLST schema for <italic>S. enterica</italic>, the 7601-loci INNUENDO wgMLST schema for <italic>E. coli</italic>, and the 2794-loci INNUENDO wgMLST schema for <italic>C. jejuni</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]. All these schemas were retrieved from chewie-NS [<xref ref-type="bibr" rid="CR38">38</xref>] in May/June of 2022. As there was the need to determine a set of core loci for <italic>S. enterica</italic>, <italic>E. coli</italic>, and <italic>C. jejuni</italic> datasets, three sets of core loci were obtained for each species with ReporTree by setting distinct “--site-inclusion” thresholds: 0.95, 0.98, and 1.0 (i.e., only keep loci called in at least 95%, 98%, and 100% of the dataset samples). This resulted into cgMLST schemas with 3261, 3179, and 874 loci for <italic>S. enterica</italic>, 2826, 2704, and 465 loci for <italic>E. coli</italic>, and 1012, 987, and 29 loci for <italic>C. jejuni</italic>, at 0.95, 0.98, and 1.0 thresholds, respectively. As for each of these species, the values obtained at 0.95 and 0.98 were relatively similar, and in the range of what was previously determined for other datasets of the same species [<xref ref-type="bibr" rid="CR14">14</xref>], the benchmarking proceeded with the loci obtained at the 0.98 threshold.</p>
        <p id="Par25">To assess the time performance of ReporTree with different dataset sizes, for each species, we generated sub-datasets of randomly selected isolates. The size of these sub-datasets varied between 200 and the maximum number of isolates of the respective dataset (in a 200-isolates step), with ten replicates being run per sub-dataset size. ReporTree was run for each replicate setting “--loci-called 0.95” (i.e., including only samples with at least 95% of loci called) and requesting summary reports at all possible partition levels obtained with (i) GrapeTree analysis (MSTreeV2 algorithm) and (ii) HC analysis (single-linkage algorithm). Additional runs were performed for each dataset using all isolates but requesting summary reports only for thresholds of “stability” regions (using nAWC, as described above) or at potential “outbreak” level (according to previously described cutoffs) [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR39">39</xref>].</p>
        <p id="Par26">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, for each dataset, ReporTree running time increases linearly with the number of samples, with GrapeTree MSTreeV2 algorithm taking slightly more time than HC single-linkage. Moreover, as expected, a higher number of loci also led to an increased running time. An interesting observation regards the comparison of <italic>S. enterica</italic> and <italic>E. coli</italic> results. Indeed, although the <italic>E. coli</italic> analysis involved a lower number of loci and only a slightly higher number of samples, its running times were higher than those observed for <italic>S. enterica.</italic> This is related to a consistent higher number of clusters in <italic>E. coli</italic> than <italic>S. enterica</italic> dataset at the same threshold (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B), showing that, as expected, the dataset diversity also impacts ReporTree running times. Overall, using the whole dataset, ReporTree identified and characterized clusters determined at all possible distance thresholds with single-linkage and MSTreeV2 in around 5 and 6 min for <italic>L. monocytogenes</italic>, 10 and 11 min for <italic>S. enterica</italic>, 18 and 20 min for <italic>E. coli</italic>, and 5 and 7 min for <italic>C. jejuni</italic>, respectively. Nevertheless, in a routine surveillance scenario in which genetic clusters are obtained at a single or very small number of distance thresholds (e.g., thresholds for potential outbreak detection), ReporTree running times considerably decreased in all the species (also using the whole dataset) to less than 45 s with the HC algorithm and less than 1 min and 30 s with the GrapeTree algorithm (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C), reinforcing its suitability for implementation in routine surveillance.<fig id="Fig2"><label>Fig. 2</label><caption><p>Results of ReporTree benchmarking of the cg/wgMLST workflow using datasets for four different species: <italic>L. monocytogenes</italic> (Lm), <italic>S. enterica</italic> (Se), <italic>E. coli</italic> (Ec), and <italic>C. jejuni</italic> (Cj). <bold>A</bold> ReporTree running times for the 10 replicates of each subset of <italic>L. monocytogenes</italic> (top left), <italic>S. enterica</italic> (top right), <italic>E. coli</italic> (bottom left), and <italic>C. jejuni</italic> (bottom right), where the flag “all” indicates subsets for which ReporTree obtained clusters at all possible thresholds, the flag “outbreak” indicates subsets for which ReporTree obtained clusters at potential outbreak level (7 allelic differences for <italic>L. monocytogenes</italic>, 14 (0.43%) for <italic>S. enterica</italic>, 9 (0.34%) for <italic>E. coli</italic>, and 6 for (0.59%) for <italic>C. jejuni</italic> [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]), and the flag “stability” indicates subsets for which ReporTree obtained clusters at all possible thresholds but only generated reports for those corresponding to stability regions. <bold>B</bold> Number of clusters generated at all possible distance thresholds for each dataset. <bold>C</bold> Comparison of running times when ReporTree obtained clusters at potential outbreak level</p></caption><graphic xlink:href="13073_2023_1196_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par27">ReporTree represents an integrative workflow from a flexible input to a dynamic reporting of cg/wgMLST data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), with clustering being the central step in the analysis. As such, ReporTree offers widely used and validated algorithms (HC, goeBURST/MSTree, and MSTreeV2) for clustering purposes [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Nevertheless, as alternative software for this step is also available, here, we compare ReporTree cgMLST clustering workflows with pHierCC [<xref ref-type="bibr" rid="CR16">16</xref>], another commonly used method for routine surveillance and outbreak detection (implemented in Enterobase [<xref ref-type="bibr" rid="CR40">40</xref>]). Our results (detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1.1 to S1.4) show that despite the conceptual differences of the tested algorithms, in general, the three clustering methods implemented in ReporTree yielded cluster number and composition highly congruent with pHierCC using the four foodborne bacteria datasets described above.</p>
        <p id="Par28">Additionally, in order to assess ReporTree performance in a different context, such as the identification of main populations (or lineages) in a dataset, we have also compared ReporTree with PopPUNK, a <italic>k</italic>-mer-based clustering tool that relies on machine learning to cluster genomes [<xref ref-type="bibr" rid="CR41">41</xref>]. As recommended by the respective authors, PopPUNK was applied to assign the genomes of the <italic>E. coli</italic> dataset to genetic clusters using the existing <italic>E. coli</italic> reference database (<ext-link ext-link-type="uri" xlink:href="https://www.bacpop.org/poppunk/">https://www.bacpop.org/poppunk/</ext-link>, assessed on April 24, 2023) with the best fitting model. PopPUNK identified 366 clusters, which were found to be highly congruent with ReporTree cg/wgMLST clustering results at 642 (for MSTree and HC single-linkage) and 724 (for MSTreeV2) allele differences thresholds, with Adjusted Rand coefficients of 0.995 in both cases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2.1). These thresholds fall within one of the stability regions identified by ReporTree, reinforcing the applicability of the nAWC component of ReporTree to detect low-resolution genogroups/lineages for longitudinal surveillance or population structure evaluation.</p>
      </sec>
      <sec id="Sec11">
        <title>Alignment-based core-SNP workflow</title>
        <p id="Par29">ReporTree benchmarking for the alignment-based SNP workflow was performed in a laptop [Intel Core i7(R)] with 16 GB of RAM using a publicly available diverse dataset of <italic>Mycobacterium tuberculosis</italic> [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>], which is a bacterial pathogen with a large genome (approximately 4.4 Mb) for which such a workflow is starting to be routinely applied for surveillance. As input for this benchmarking, we used a filtered alignment comprising the maximum number of informative sites (a total of 88,562 nucleotide sites with at least one mutation in a given sequence) observed in the comparison of 1788 <italic>M</italic><italic>. tuberculosis</italic> genomes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Similar to the cg/wgMLST workflow, we generated sub-datasets of randomly selected isolates with between 200 and the maximum number of isolates in a 200-isolates step, with ten replicates per sub-dataset size, and requesting summary reports at all possible partition levels with (i) GrapeTree analysis (MSTreeV2 algorithm) and (ii) HC analysis (single-linkage algorithm). Additional runs with all isolates and requesting summary reports at potential transmission chain resolution (12 SNPs) and at stable regions were also performed. Running time was assessed using “--site-inclusion” of 1.0 (true core alignment, i.e., only ATCG) and 0.95 (core alignment tolerating 5% of undefined nucleotides per site), as a way to simulate two likely applications of ReporTree. The first one more likely suits clustering of large and diverse datasets, while the second one is more likely to be applied when fine resolution is needed (e.g., to enhance the resolution in clusters identified with less discriminatory genotyping methods).<fig id="Fig3"><label>Fig. 3</label><caption><p>Results of ReporTree benchmarking of the alignment-based core SNP workflow using a multi-sequence alignment of 1788 <italic>M</italic><italic>. tuberculosis</italic> samples and 88,562 informative nucleotide positions. <bold>A</bold> ReporTree running times for the 10 replicates of each sample subset with a site inclusion of 1.0 (left) and 0.95 (right), where the flag “all” indicates subsets for which ReporTree obtained clusters at all possible thresholds, the flag “single_thr” indicates subsets for which ReporTree obtained clusters at potential “transmission chain” level (12 SNP differences), and the flag “stability” indicates subsets for which ReporTree obtained clusters at all possible thresholds but only generated reports for those corresponding to stability regions. <bold>B</bold> ReporTree running times according to the number of variant sites obtained after alignment cleaning and that were used for clustering. Technical notes: 1. The “site-inclusion” argument defines informative nucleotide sites to be kept in the alignment based on the minimum proportion of samples per site without missing data (e.g., 1.0 reflects a “true” core alignment with all variant sites having exclusively ATCG, and 0.95 reflects a core alignment tolerating 5% of undefined nucleotides per site). 2. The <italic>M. tuberculosis</italic> dataset used in this benchmarking is described at [<xref ref-type="bibr" rid="CR42">42</xref>]</p></caption><graphic xlink:href="13073_2023_1196_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par30">ReporTree running time in the alignment-based core SNP analysis increases with the number of samples, linearly for “site-inclusion 1.0” and exponentially for “site-inclusion 0.95” (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The considerably higher running times observed in “site-inclusion 0.95” were expected as this workflow requires a demanding cleaning step in which each variant site in the alignment has to be screened for the amount of missing data. We have also assessed how the time performance correlates with the number of informative sites used for clustering. In the “site-inclusion 1.0” workflow, for the same number of samples, having more variant sites has a minimal impact on time (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). On the other hand, in the “site-inclusion 0.95”, time is a function of both the number of samples and number of sites in the sense that, as expected, adding more samples introduces more variant sites to be screened for missing data. In summary, the running times were satisfactory for the main purpose of each condition, with the “site-inclusion 1.0” workflow taking less than 6 min in all tested situations and the “site-inclusion 0.95” workflow taking less than 10 min for datasets with less than 400 isolates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Of note, given the main goal of this benchmarking (considerably scale up the number of variant sites for clustering when comparing with the cg/wgMLST workflow), we used an alignment containing the maximum number of informative sites in the dataset. In a simulated scenario in which ReporTree would instead take the full genome alignment (i.e., 4.4 Mb) as input, as removing gaps and non-variable sites is less demanding than handling the “site-inclusion” argument, the time performance with the current dataset would range between 3 and 22 min for a “site-inclusion 1.0” and 12 min and 4 h and 15 min for “site-inclusion 0.95”, depending on the dataset size (200 and 1788 isolates, respectively).</p>
        <p id="Par31">The alignment-based core SNP workflow available in ReporTree is designed to facilitate the routine assessment of bacteria genetic relatedness at different levels of resolution, either as an alternative or a complement to cg/wgMLST data (e.g., to increase the resolution at outbreak level). As demonstrated in the previous benchmarkings, ReporTree relies on widely used and validated methods that ensure input flexibility, clustering reliability, and turn-around times compatible with routine purposes. Still, core SNP-based analyses are also often applied for the identification of main bacterial populations (or lineages) towards the reconstruction of pathogen evolutionary history or species-level population structure. As such, we sought to assess how ReporTree-derived clustering compares with the lineages/populations obtained through a traditional typing method and also through a Bayesian analysis of population structure (BAPS). To this end, we not only took advantage of the lineage information of the <italic>M. tuberculosis</italic> dataset (inferred using Tb-profiler v4.4.1. [<xref ref-type="bibr" rid="CR44">44</xref>]) but also ran FastBAPS [<xref ref-type="bibr" rid="CR45">45</xref>] on its multi-sequence alignment using default parameters (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Similar to the cg/wgMLST benchmarking (previous subsection), clusters were identified at all possible thresholds with ReporTree using MSTreeV2 method. We found that the levels with highest congruence either with <italic>M. tuberculosis</italic> main lineages or with FastBAPS fall within ReporTree-determined stability regions for this dataset (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>), again demonstrating the alternative utility of ReporTree to get insight on bacterial population structure.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Reproducing a large-scale study on genetic clustering and linkage to antibiotic resistance data in <italic>Neisseria gonorrhoeae</italic></title>
      <p id="Par32">Our team has recently performed an extensive genomics analysis of the bacterial pathogen <italic>Neisseria gonorrhoeae</italic> [<xref ref-type="bibr" rid="CR46">46</xref>]. In this study, 3791 <italic>N. gonorrhoeae</italic> genomes from isolates collected across Europe were analyzed with a cgMLST approach. Genetic clusters were determined with the goeBURST algorithm implemented in PHYLOViZ [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR47">47</xref>] for all possible allelic distance thresholds (partitions). Cluster concordance between subsequent distance thresholds was assessed with the nAWC in order to determine regions of cluster stability [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] that were used for nomenclature purposes and identification of genogroups. The association between metadata and genetic clusters was then performed by time-consuming table handling with a spreadsheet program. This corresponded to a non-automated workflow and, in the particular case of the cluster congruence analysis and the integration of genetic and clinically or epidemiologically relevant data, it represented a highly demanding process difficult to be applied in real-time pathogen surveillance. As such, to validate ReporTree and demonstrate how it can enhance bacterial pathogens’ surveillance and research, we used the same dataset as in the previous study [<xref ref-type="bibr" rid="CR46">46</xref>] and attempted to reproduce the main study outputs with this tool. As shown in ReporTree’s Wiki [<xref ref-type="bibr" rid="CR48">48</xref>], using the allele matrix with 822 loci [<xref ref-type="bibr" rid="CR49">49</xref>] and the associated metadata (available in Supplementary material 1 of Pinto et al. [<xref ref-type="bibr" rid="CR46">46</xref>]) as input, ReporTree automatically identified the genetic clusters at all possible partition thresholds of the generated MST, identified the same regions of cluster stability, and replicated the hierarchical nomenclature applied by Pinto et al. [<xref ref-type="bibr" rid="CR46">46</xref>]. Moreover, it provided an updated metadata table with clustering information at the first partition of each stability region and of the derived nomenclature code, which could be used as input for visualization in GrapeTree [<xref ref-type="bibr" rid="CR4">4</xref>]. Furthermore, summary reports with statistics/trends associated with each genetic cluster of low and high levels of stability (i.e., 40 allele differences at the lower level and 79 allele differences at the higher level, similarly to what was found by Pinto et al.) were reported. Of note, the high level of stability identified by ReporTree matches the lineages identified by PopPUNK with the same dataset (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2.2), supporting that this resolution level reflects <italic>N. gonorrhoeae</italic> population structure. Finally, ReporTree was able to associate and report the distribution of genetic determinants of antimicrobial resistance in <italic>N. gonorrhoeae</italic> for the different genetic clusters. Importantly, this example allowed a clear validation of the tool by rigorously reproducing the data presented, for example, in Figure 1a, 1b and 3 and in Tables 1 and 2 of the previous publication [<xref ref-type="bibr" rid="CR46">46</xref>]. All these outputs (and additional ones) are available for consultation at ReporTree github repository [<xref ref-type="bibr" rid="CR28">28</xref>]. Noteworthy, this proof of concept was made with a single ReporTree command line that ran for approximately 2 min and 2 s in a laptop [Intel Core i5(R)] with 16 GB of RAM.</p>
    </sec>
    <sec id="Sec13">
      <title>ReporTree and its application to genomics-informed routine surveillance (e.g., SARS-CoV-2) and outbreak detection (e.g., <italic>Listeria monocytogenes</italic>)</title>
      <p id="Par33">ReporTree’s versatility and broad functionalities make it suitable for different applications and integration in different research or surveillance contexts (from the usage of specific functionalities to the whole pipeline implementation). Here, we provide two examples of the integration of this tool, at different scales, in established workflows of genomic surveillance.</p>
      <p id="Par34">Genomics-informed surveillance of SARS-CoV-2 has had an important role in worldwide public health and political decision-making in the last 2 years. In Portugal, weekly reports of nationwide sequencing surveys are provided to public health authorities and the general public describing important indicators and trends of the evolution and geotemporal spread of the virus [<xref ref-type="bibr" rid="CR50">50</xref>]. Therefore, after ReporTree validation, we implemented this tool in the routine genomics surveillance of SARS-CoV-2 in the country with the objective of speeding up the association between genomic and epidemiological data and the generation of the surveillance-oriented reports. For instance, besides its comprehensive usage for calculating the relative frequency of variants of concern (VOCs) at regional and national levels, ReporTree is often applied to identify clusters of high-closely related viruses (e.g., using TreeCluster [<xref ref-type="bibr" rid="CR8">8</xref>] max-clade or avg-clade models at high resolution levels) that may represent local transmission networks or even super-spreading events. Examples of ReporTree application in the context of SARS-CoV-2 genomic epidemiology are provided at ReporTree’s Wiki [<xref ref-type="bibr" rid="CR48">48</xref>]. To further demonstrate its utility and performance for this purpose, we ran ReporTree over the public Taxonium (<ext-link ext-link-type="uri" xlink:href="https://cov2tree.org/">https://cov2tree.org/</ext-link>) [<xref ref-type="bibr" rid="CR7">7</xref>] tree with more than 6 million SARS-CoV-2 sequences (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). ReporTree is able to cut this massive tree, identifying all clusters of close-related sequences (e.g., avg-clade at 2 SNP differences), and extract valuable information (timespan, country dispersion, etc.) for the clusters identified in a given lineage, country, or period of time.</p>
      <p id="Par35">Regarding the full implementation, one of the most direct and intuitive applications is the analysis of cg/wgMLST data for outbreak investigation, namely for foodborne bacterial pathogens (as shown in the Benchmarking section), as this subtyping method delivers sufficiently high-resolution and epidemiological concordance [<xref ref-type="bibr" rid="CR51">51</xref>]. In ReporTree’s Wiki [<xref ref-type="bibr" rid="CR48">48</xref>], it is provided a simple simulated example in which, with a single command line, ReporTree builds an MST from cgMLST data and automatically extracts and reports genetic clusters of <italic>L. monocytogenes</italic> at high-resolution levels commonly used for outbreak detection (≤ 4 and ≤ 7 allelic differences, [<xref ref-type="bibr" rid="CR39">39</xref>]), keeping the cluster nomenclature of the previous run, as routinely performed in Portugal. These two examples show that ReporTree is a useful asset to rapidly generate summary reports with key data (pathogen genetic clusters) and statistics/trends for routine surveillance and outbreak investigation.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par36">ReporTree represents an automated and flexible pipeline that can be used for a wide variety of species and that facilitates the detection of genetic clusters and their linkage to epidemiological data, in a concept aligned with “One Health” perspectives. Here, we presented the proof of concept of this tool, showing its ability to quickly report a comprehensive WGS-based genogroup assignment for <italic>N. gonorrhoeae</italic>, based on the identification of the discriminatory genetic thresholds reflecting cluster stability, and the rapid correlation of these genogroups (representing main circulating lineages) with any data of interest, such as antimicrobial resistance data. Furthermore, we have shown how its flexibility contributed to speed up SARS-CoV-2 and <italic>L. monocytogenes</italic> genomics-informed surveillance in Portugal, facilitating and accelerating the production of surveillance-oriented reports. ReporTree benchmarking ultimately demonstrated that this tool can be smoothly implemented in routine surveillance bioinformatics workflows, with negligible computational and time costs. Although ReporTree is currently available as a command line tool, this resource can easily be integrated in start-to-end platforms for genomics/epidemiological analysis (for instance, it will be soon integrated in the COHESIVE Information System [<xref ref-type="bibr" rid="CR52">52</xref>] and INSaFLU platform [<xref ref-type="bibr" rid="CR53">53</xref>]), thus contributing to a sustainable and efficient public health genomics-informed pathogen surveillance.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par37">Project name: ReporTree.</p>
    <p id="Par38">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree">https://github.com/insapathogenomics/ReporTree</ext-link></p>
    <p id="Par39">Project Wiki: <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree/wiki">https://github.com/insapathogenomics/ReporTree/wiki</ext-link></p>
    <p id="Par40">Record of the home page and Wiki at the time of publication: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7772640">https://doi.org/10.5281/zenodo.7772640</ext-link></p>
    <p id="Par41">Operating system(s): Unix.</p>
    <p id="Par42">Programming language: Python 3.8</p>
    <p id="Par43">Other requirements: Biopython 1.77, Pandas 1.1.3, Ete3, TreeCluster 1.0.3, GrapeTree 2.1, cgmlst-dists, and vcf2mst.</p>
    <p id="Par44">License: GPL 3.0</p>
    <p id="Par45">Any restrictions to use by non-academics: none.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1196_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Comparison of ReporTree results with other clustering methods and tools.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>cgMLST</term>
        <def>
          <p id="Par4">Core-genome multilocus sequence type</p>
        </def>
      </def-item>
      <def-item>
        <term>HC</term>
        <def>
          <p id="Par5">Hierarchical clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p id="Par6">Minimum spanning tree</p>
        </def>
      </def-item>
      <def-item>
        <term>nAWC</term>
        <def>
          <p id="Par7">Neighborhood Adjusted Wallace coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par8">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>wgMLST</term>
        <def>
          <p id="Par9">Whole-genome multilocus sequence type</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par10">Whole-genome sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Dr. Holger Brendebach, Dr. Carlus Deneke, and Dr. Simon Tausch from the German Federal Institute for Risk Assessment for their support during the genome assembly of the samples used in ReporTree benchmarking and Dr. João André Carriço for the productive discussions throughout ReporTree development. We would also like to thank the National Distributed Computing Infrastructure of Portugal (INCD) for providing the necessary resources to run the genome assemblies. INCD was funded by FCT and FEDER under the project 22153-01/SAICT/2016.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>VM, MP, JPG, and VB idealized and planned the tool. All authors contributed to the design and refinement of the tool. VM performed the programming and benchmarking. VM, MP, and VB performed the tool validation. DS performed the dockerization and continuous integration testing. VM and VB wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by funding from the European Union’s Horizon 2020 Research and Innovation program under grant agreement No 773830: One Health European Joint Programme (2020–2022) and by national funds through FCT—Foundation for Science and Technology, I.P., in the frame of Individual CEEC 2022.00851.CEECIND/CP1748/CT0001 (2023 onwards).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analyzed during the current study are available in the Zenodo repository (<italic>L. monocytogenes</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7116879">https://zenodo.org/record/7116879</ext-link> [<xref ref-type="bibr" rid="CR31">31</xref>]; <italic>S. enterica</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7119736">https://zenodo.org/record/7119736</ext-link> [<xref ref-type="bibr" rid="CR32">32</xref>]; <italic>E. coli</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7120058">https://zenodo.org/record/7120058</ext-link> [<xref ref-type="bibr" rid="CR33">33</xref>]; <italic>C. jejuni</italic>: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7120167">https://doi.org/10.5281/zenodo.7120167</ext-link> [<xref ref-type="bibr" rid="CR34">34</xref>]; <italic>N. gonorrhoeae</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3946223">https://zenodo.org/record/3946223</ext-link> [<xref ref-type="bibr" rid="CR49">49</xref>]; <italic>M. tuberculosis</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7772652">https://zenodo.org/record/7772652</ext-link> [<xref ref-type="bibr" rid="CR43">43</xref>]) or in ReporTree github repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree/">https://github.com/insapathogenomics/ReporTree/</ext-link> [<xref ref-type="bibr" rid="CR28">28</xref>]. In order to ensure the long-term availability of all materials used in this manuscript, the github repository and the Wiki material at the time of publication are also available at Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7772640">https://doi.org/10.5281/zenodo.7772640</ext-link>) [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par46">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par48">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jolley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
        </person-group>
        <article-title>Using multilocus sequence typing to study bacterial variation: prospects in the genomic era</article-title>
        <source>Future Microbiol</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>623</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.2217/fmb.14.24</pub-id>
        <?supplied-pmid 24957089?>
        <pub-id pub-id-type="pmid">24957089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wohl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Genomic analysis of viral outbreaks</article-title>
        <source>Annu Rev Virol</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>173</fpage>
        <lpage>195</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-virology-110615-035747</pub-id>
        <?supplied-pmid 27501264?>
        <pub-id pub-id-type="pmid">27501264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ribeiro-Gonçalves</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>PHYLOViZ Online: web-based tool for visualization, phylogenetic inference, analysis and sharing of minimum spanning trees</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W246</fpage>
        <lpage>W251</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw359</pub-id>
        <?supplied-pmid 27131357?>
        <pub-id pub-id-type="pmid">27131357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Sergeant</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Luhmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GrapeTree: visualization of core genomic relationships among 100,000 bacterial pathogens</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1395</fpage>
        <lpage>1404</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.232397.117</pub-id>
        <?supplied-pmid 30049790?>
        <pub-id pub-id-type="pmid">30049790</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hadfield</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Megill</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Callender</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nextstrain: real-time tracking of pathogen evolution</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>4121</fpage>
        <lpage>4123</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty407</pub-id>
        <?supplied-pmid 29790939?>
        <pub-id pub-id-type="pmid">29790939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Argimón</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abudahab</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goater</surname>
            <given-names>RJE</given-names>
          </name>
          <name>
            <surname>Fedosejev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bhai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Glasner</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microreact: visualizing and sharing data for genomic epidemiology and phylogeography</article-title>
        <source>Microb Genom</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>e000093</fpage>
        <?supplied-pmid 28348833?>
        <pub-id pub-id-type="pmid">28348833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanderson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Taxonium, a web-based tool for exploring large phylogenetic trees</article-title>
        <source>eLife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e82392</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.82392</pub-id>
        <?supplied-pmid 36377483?>
        <pub-id pub-id-type="pmid">36377483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balaban</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moshiri</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mai</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TreeCluster: clustering biological sequences using phylogenetic trees</article-title>
        <source>PLoS one</source>
        <year>2019</year>
        <volume>14</volume>
        <fpage>e0221068</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0221068</pub-id>
        <?supplied-pmid 31437182?>
        <pub-id pub-id-type="pmid">31437182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dallman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ashton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Jironkin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Painset</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shaaban</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SnapperDB: a database solution for routine sequencing analysis of bacterial isolates</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3028</fpage>
        <lpage>3029</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty212</pub-id>
        <?supplied-pmid 29659710?>
        <pub-id pub-id-type="pmid">29659710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deneke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Uelze</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brendebach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tausch</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Malorny</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Decentralized investigation of bacterial outbreaks based on hashed cgMLST</article-title>
        <source>Front Microbiol</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>649517</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2021.649517</pub-id>
        <?supplied-pmid 34220740?>
        <pub-id pub-id-type="pmid">34220740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ragonnet-Cronin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hodcroft</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hué</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fearnhill</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Delpech</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>AJL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated analysis of phylogenetic clusters</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>317</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-317</pub-id>
        <?supplied-pmid 24191891?>
        <pub-id pub-id-type="pmid">24191891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Monteiro</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Melo-Cristino</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>PHYLOViZ: phylogenetic inference and data visualization for sequence based typing methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-87</pub-id>
        <?supplied-pmid 22568821?>
        <pub-id pub-id-type="pmid">22568821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lees</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gladstone</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Weiser</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and flexible bacterial genomic epidemiology with PopPUNK</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>304</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.241455.118</pub-id>
        <?supplied-pmid 30679308?>
        <pub-id pub-id-type="pmid">30679308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Llarena</surname>
            <given-names>A-K</given-names>
          </name>
          <name>
            <surname>Ribeiro-Gonçalves</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Nuno Silva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Halkilahti</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Machado</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Da Silva</surname>
            <given-names>MS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>INNUENDO: a cross-sectoral platform for the integration of genomics in the surveillance of food-borne pathogens</article-title>
        <source>EFSA Support Publ</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1498</fpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>O’Toole</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McCrone</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology</article-title>
        <source>Nat Microbiol</source>
        <year>2020</year>
        <volume>5</volume>
        <fpage>1403</fpage>
        <lpage>1407</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-020-0770-5</pub-id>
        <?supplied-pmid 32669681?>
        <pub-id pub-id-type="pmid">32669681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Charlesworth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Achtman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>HierCC: a multi-level clustering scheme for population assignments based on core genome MLST</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>20</issue>
        <fpage>3645</fpage>
        <lpage>3646</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab234</pub-id>
        <?supplied-pmid 33823553?>
        <pub-id pub-id-type="pmid">33823553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Pasquale</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Radomski</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mangone</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Calistri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lorusso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cammà</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>SARS-CoV-2 surveillance in Italy through phylogenomic inferences based on Hamming distances derived from pan-SNPs, -MNPs and -InDels</article-title>
        <source>BMC Genomics</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>782</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-021-08112-0</pub-id>
        <?supplied-pmid 34717546?>
        <pub-id pub-id-type="pmid">34717546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Bugalho</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Global optimal eBURST analysis of multilocus typing data using a graphic matroid approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>152</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-152</pub-id>
        <?supplied-pmid 19450271?>
        <pub-id pub-id-type="pmid">19450271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">GrapeTree (github repository with the modified version). <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/GrapeTree">https://github.com/insapathogenomics/GrapeTree</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Seemann T. cgmlst-dists. github. <ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/cgmlst-dists">https://github.com/tseemann/cgmlst-dists</ext-link> Accessed on 28 Sept 2022.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>261</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <?supplied-pmid 32015543?>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Silva-Costa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Melo-Cristino</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pinto</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>de Lencastre</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Illustration of a common framework for relating multiple typing methods by application to macrolide-resistant Streptococcus pyogenes</article-title>
        <source>J Clin Microbiol</source>
        <year>2006</year>
        <volume>44</volume>
        <fpage>2524</fpage>
        <lpage>2532</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02536-05</pub-id>
        <?supplied-pmid 16825375?>
        <pub-id pub-id-type="pmid">16825375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Comparing partitions. <ext-link ext-link-type="uri" xlink:href="http://www.comparingpartitions.info/">http://www.comparingpartitions.info/</ext-link> Accessed on 28 Sept 2022.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Comparing partitions (repository with the new version). Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ComparingPartitions">https://github.com/insapathogenomics/ComparingPartitions</ext-link> Accessed on 28 Sept 2022.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Severiano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pinto</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Adjusted Wallace coefficient as a measure of congruence between typing methods</article-title>
        <source>J Clin Microbiol</source>
        <year>2011</year>
        <volume>49</volume>
        <fpage>3997</fpage>
        <lpage>4000</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00624-11</pub-id>
        <?supplied-pmid 21918028?>
        <pub-id pub-id-type="pmid">21918028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Barker DOR, Carriço JA, Kruczkiewicz P, Palma F, Rossi M, Taboada EN. Rapid identification of stable clusters in bacterial populations using the adjusted Wallace coefficient bioRxiv. 2018. Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/299347">http://biorxiv.org/lookup/doi/10.1101/299347</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Di Pasquale A, Radomski N, Maassen K, Cammà C. One Health structure In Europe for omics-based surveillance. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/genpat-it/grapetree-gis">https://github.com/genpat-it/grapetree-gis</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">ReporTree github. <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree">https://github.com/insapathogenomics/ReporTree</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Mixão V, Pinto M, Sobral D, Di Pasquale A, Gomes JP, Borges V. ReporTree: a surveillance-oriented tool to strengthen the linkage between pathogen genetic clusters and epidemiological data. 2023. Zenodo. 10.5281/zenodo.7772640.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">ReporTree (docker). <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/insapathogenomics/reportree">https://hub.docker.com/r/insapathogenomics/reportree</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective cgMLST profiles of a diverse dataset comprising 1,874 <italic>Listeria monocytogenes</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7116879">https://zenodo.org/record/7116879</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective wg/cgMLST profiles of a diverse dataset comprising 1,434 <italic>Salmonella enterica</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7119736">https://zenodo.org/record/7119736</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective wg/cgMLST profiles of a diverse dataset comprising 1,999 <italic>Escherichia coli</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7120058">https://zenodo.org/record/7120058</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective wg/cgMLST profiles of a diverse dataset comprising 3,076 <italic>Campylobacter jejuni</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7120167">https://zenodo.org/record/7120167</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deneke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brendebach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Uelze</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Borowiak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malorny</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tausch</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Species-specific quality control, assembly and contamination detection in microbial isolate sequences with AQUAMIS</article-title>
        <source>Genes</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>644</fpage>
        <pub-id pub-id-type="doi">10.3390/genes12050644</pub-id>
        <?supplied-pmid 33926025?>
        <pub-id pub-id-type="pmid">33926025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Machado</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Rossi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moran-Gilad</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>chewBBACA: a complete suite for gene-by-gene schema creation and strain identification</article-title>
        <source>Microb Genom</source>
        <year>2018</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>e000166</fpage>
        <?supplied-pmid 29543149?>
        <pub-id pub-id-type="pmid">29543149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moura</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Criscuolo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pouseele</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Maury</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Leclercq</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tarr</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole genome-based population biology and epidemiological surveillance of <italic>Listeria monocytogenes</italic></article-title>
        <source>Nat Microbiol</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>16185</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.185</pub-id>
        <?supplied-pmid 27723724?>
        <pub-id pub-id-type="pmid">27723724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mamede</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vila-Cerqueira</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Chewie Nomenclature Server (chewie-NS): a deployable nomenclature server for easy sharing of core and whole genome MLST schemas</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D660</fpage>
        <lpage>D666</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa889</pub-id>
        <?supplied-pmid 33068420?>
        <pub-id pub-id-type="pmid">33068420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Walle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Björkman</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Cormican</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dallman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mossong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moura</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Retrospective validation of whole genome sequencing-enhanced surveillance of listeriosis in Europe, 2010 to 2015</article-title>
        <source>Euro Surveill</source>
        <year>2018</year>
        <volume>23</volume>
        <issue>33</issue>
        <fpage>1700798</fpage>
        <?supplied-pmid 30131096?>
        <pub-id pub-id-type="pmid">30131096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
          <collab>Agama Study Group</collab>
          <name>
            <surname>Achtman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The EnteroBase user’s guide, with case studies on Salmonella transmissions, Yersinia pestis phylogeny, and Escherichia core genomic diversity</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>138</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.251678.119</pub-id>
        <?supplied-pmid 31809257?>
        <pub-id pub-id-type="pmid">31809257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lees</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gladstone</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Weiser</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and flexible bacterial genomic epidemiology with PopPUNK</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>304</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.241455.118</pub-id>
        <?supplied-pmid 30679308?>
        <pub-id pub-id-type="pmid">30679308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walker</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Omar</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Hedge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Elias</surname>
            <given-names>CDO</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequencing for prediction of <italic>Mycobacterium tuberculosis</italic> drug susceptibility and resistance: a retrospective study</article-title>
        <source>Lancet Infect Dis</source>
        <year>2015</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>1193</fpage>
        <lpage>1202</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(15)00062-6</pub-id>
        <?supplied-pmid 26116186?>
        <pub-id pub-id-type="pmid">26116186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Mixão V, Pinto M, Sobral D, Di Pasquale A, Gomes JP, Borges V. Multiple sequence alignment of a diverse dataset with 1788 <italic>Mycobacterium tuberculosis</italic> isolates. Zenodo. 2023. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7772652">https://zenodo.org/record/7772652</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phelan</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>O'Sullivan</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Machado</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oppong</surname>
            <given-names>YEA</given-names>
          </name>
          <name>
            <surname>Campino</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating informatics tools and portable sequencing technology for rapid detection of resistance to anti-tuberculous drugs</article-title>
        <source>Genome Med</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-019-0650-x</pub-id>
        <?supplied-pmid 31234910?>
        <pub-id pub-id-type="pmid">31234910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lees</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Frost</surname>
            <given-names>SDW</given-names>
          </name>
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fast hierarchical Bayesian analysis of population structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>11</issue>
        <fpage>5539</fpage>
        <lpage>5549</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz361</pub-id>
        <?supplied-pmid 31076776?>
        <pub-id pub-id-type="pmid">31076776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Isidro</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodrigues</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Vieira</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Borrego</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>Neisseria gonorrhoeae</italic> clustering to reveal major European whole-genome-sequencing-based genogroups in association with antimicrobial resistance</article-title>
        <source>Microb Genom</source>
        <year>2021</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>000481</fpage>
        <?supplied-pmid 33245688?>
        <pub-id pub-id-type="pmid">33245688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nascimento</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sousa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>PHYLOViZ 2.0: providing scalable data integration and visualization for multiple phylogenetic inference methods</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>128</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw582</pub-id>
        <?supplied-pmid 27605102?>
        <pub-id pub-id-type="pmid">27605102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">ReporTree Wiki. <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree/wiki">https://github.com/insapathogenomics/ReporTree/wiki</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Pinto M, Borges V, Isidro J, Rodrigues JC, Vieira L, Borrego MJ, et al. <italic>Neisseria gonorrhoeae</italic> clustering to reveal major European WGS-based genogroups in association with antimicrobial resistance (cgMLST and MScgMLST schemas, allelic profile matrices and GrapeTree input file). Zenodo. 2020. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3946223">https://zenodo.org/record/3946223</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Diversidade genética do novo coronavírus SARS-CoV-2 (COVID-19) em Portugal. Available from: <ext-link ext-link-type="uri" xlink:href="https://insaflu.insa.pt/covid19/">https://insaflu.insa.pt/covid19/</ext-link> Accessed on 12 May 2023.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nadon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Van Walle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gerner-Smidt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Campos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chinen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Concepcion-Acevedo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PulseNet International: vision for the implementation of whole genome sequencing (WGS) for global food-borne disease surveillance</article-title>
        <source>Euro Surveill</source>
        <year>2017</year>
        <volume>22</volume>
        <issue>23</issue>
        <fpage>30544</fpage>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.23.30544</pub-id>
        <?supplied-pmid 28662764?>
        <pub-id pub-id-type="pmid">28662764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Sciensano. D3.12- abstract book for 2nd annual scientific meeting (ASM). Zenodo; 2021. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4897305">https://zenodo.org/record/4897305</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borges</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pinheiro</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pechirra</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Guiomar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gomes</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>INSaFLU: an automated open web-based bioinformatics suite “from-reads” for influenza whole-genome-sequencing-based surveillance</article-title>
        <source>Genome Med</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>46</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-018-0555-0</pub-id>
        <?supplied-pmid 29954441?>
        <pub-id pub-id-type="pmid">29954441</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10273728</article-id>
    <article-id pub-id-type="pmid">37322495</article-id>
    <article-id pub-id-type="publisher-id">1196</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01196-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ReporTree: a surveillance-oriented tool to strengthen the linkage between pathogen genetic clusters and epidemiological data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mixão</surname>
          <given-names>Verónica</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pinto</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sobral</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Di Pasquale</surname>
          <given-names>Adriano</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gomes</surname>
          <given-names>João Paulo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3767-2209</contrib-id>
        <name>
          <surname>Borges</surname>
          <given-names>Vítor</given-names>
        </name>
        <address>
          <email>vitor.borges@insa.min-saude.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.422270.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2287 695X</institution-id><institution>Genomics and Bioinformatics Unit, Department of Infectious Diseases, </institution><institution>National Institute of Health Doutor Ricardo Jorge (INSA), </institution></institution-wrap>Lisbon, Portugal </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419578.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1805 1770</institution-id><institution>National Reference Centre (NRC) for Whole Genome Sequencing of Microbial Pathogens: Database and Bioinformatics analysis (GENPAT), </institution><institution>Istituto Zooprofilattico Sperimentale Dell’Abruzzo E del Molise “Giuseppe Caporale” (IZSAM), </institution></institution-wrap>Teramo, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>43</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genomics-informed pathogen surveillance strengthens public health decision-making, playing an important role in infectious diseases’ prevention and control. A pivotal outcome of genomics surveillance is the identification of pathogen genetic clusters and their characterization in terms of geotemporal spread or linkage to clinical and demographic data. This task often consists of the visual exploration of (large) phylogenetic trees and associated metadata, being time-consuming and difficult to reproduce.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed ReporTree, a flexible bioinformatics pipeline that allows diving into the complexity of pathogen diversity to rapidly identify genetic clusters at any (or all) distance threshold(s) or cluster stability regions and to generate surveillance-oriented reports based on the available metadata, such as timespan, geography, or vaccination/clinical status. ReporTree is able to maintain cluster nomenclature in subsequent analyses and to generate a nomenclature code combining cluster information at different hierarchical levels, thus facilitating the active surveillance of clusters of interest. By handling several input formats and clustering methods, ReporTree is applicable to multiple pathogens, constituting a flexible resource that can be smoothly deployed in routine surveillance bioinformatics workflows with negligible computational and time costs. This is demonstrated through a comprehensive benchmarking of (i) the cg/wgMLST workflow with large datasets of four foodborne bacterial pathogens and (ii) the alignment-based SNP workflow with a large dataset of <italic>Mycobacterium tuberculosis</italic>. To further validate this tool, we reproduced a previous large-scale study on <italic>Neisseria gonorrhoeae</italic>, demonstrating how ReporTree is able to rapidly identify the main species genogroups and characterize them with key surveillance metadata, such as antibiotic resistance data. By providing examples for SARS-CoV-2 and the foodborne bacterial pathogen <italic>Listeria monocytogenes</italic>, we show how this tool is currently a useful asset in genomics-informed routine surveillance and outbreak detection of a wide variety of species.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In summary, ReporTree is a pan-pathogen tool for automated and reproducible identification and characterization of genetic clusters that contributes to a sustainable and efficient public health genomics-informed pathogen surveillance. ReporTree is implemented in python 3.8 and is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree">https://github.com/insapathogenomics/ReporTree</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01196-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>ReporTree</kwd>
      <kwd>Genetic clustering</kwd>
      <kwd>Genomic surveillance</kwd>
      <kwd>Public health</kwd>
      <kwd>Automated pipeline</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010678</institution-id>
            <institution>H2020 Food</institution>
          </institution-wrap>
        </funding-source>
        <award-id>773830</award-id>
        <principal-award-recipient>
          <name>
            <surname>Borges</surname>
            <given-names>Vítor</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>FCT - Foundation for Science and Technology, I.P.</institution>
        </funding-source>
        <award-id>2022.00851.CEECIND/CP1748/CT0001</award-id>
        <principal-award-recipient>
          <name>
            <surname>Mixão</surname>
            <given-names>Verónica</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background
</title>
    <p id="Par11">Whole-genome sequencing (WGS) is the method with the highest resolution to discriminate and classify microorganisms (either at inter- or intra-species level) based on their genetic relatedness. Therefore, the implementation of genomics-informed surveillance systems able to track the circulation of pathogens and monitor their clinical and epidemiologically relevant features is essential for infectious diseases’ prevention and control and for a more informed public health decision-making.</p>
    <p id="Par12">Several bioinformatics solutions for the analysis of WGS data are currently available, with most workflows for genetic clustering determination ending up in the same key output: a phylogenetic tree or a tree-like representation. This often corresponds to a minimum spanning tree (MST) or a dendrogram reflecting the allele distances that result from a core-genome (cg) or whole-genome (wg) multilocus sequence type (MLST) analysis (commonly used approach for bacterial pathogens [<xref ref-type="bibr" rid="CR1">1</xref>]) or to a rooted tree reflecting the single-nucleotide polymorphism (SNP) distances that result from a multiple sequence alignment (e.g., as routinely applied for viruses [<xref ref-type="bibr" rid="CR2">2</xref>], such as SARS-CoV-2 or monkeypox virus). Subsequently, the identification and characterization of epidemiologically/biologically relevant genetic clusters (e.g., clusters of outbreak-related strains) often consists of the visual exploration of these (large) phylogenetic trees and associated metadata, taking advantage of robust visualization tools, such as those provided by PHYLOViZ [<xref ref-type="bibr" rid="CR3">3</xref>], GrapeTree [<xref ref-type="bibr" rid="CR4">4</xref>], Nextstrain [<xref ref-type="bibr" rid="CR5">5</xref>], Microreact [<xref ref-type="bibr" rid="CR6">6</xref>], or Taxonium [<xref ref-type="bibr" rid="CR7">7</xref>]. As such, this task can be time-consuming and difficult to reproduce.</p>
    <p id="Par13">In this context, there is a continuous scientific effort to automate the identification of clusters at specific genetic thresholds [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR14">14</xref>] and develop dynamic cluster/lineage nomenclature systems, such as the Pango system for SARS-CoV-2 [<xref ref-type="bibr" rid="CR15">15</xref>] or the bacteria-oriented “SNP address” of SnapperDB, the HierCC of Enterobase, the “HashID” of chewieSnake, or the INNUENDO nomenclature system [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Still, the field would benefit from the development of automated and more flexible tools that can be used for a wide variety of species, not only to facilitate the detection of genetic clusters at any (or all) distance thresholds of a tree but also to automatically characterize them based on the available metadata variables of interest.</p>
    <p id="Par14">Here, we present ReporTree, an automated surveillance-oriented resource that allows diving into the complexity of pathogen diversity to rapidly identify genetic clusters at any distance thresholds between samples and further characterize them according to any relevant epidemiological indicator in a reproducible manner. ReporTree’s flexibility, reproducibility, and performance make it an innovative resource to enhance existing genomics surveillance systems, with potential benefits at multiple pathogen levels.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">ReporTree is a command-line tool implemented in python 3.8 that represents a flexible solution to obtain clustering information at any sample distance thresholds (partitions) either for species that require a cg/wgMLST analysis or for those that rely on SNPs/multiple sequence alignments for tree reconstruction. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, ReporTree pipeline can be divided into three major steps:<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic representation of the three main steps of ReporTree pipeline. Blue background highlights the alternative input types, green background highlights the alternative clustering modules, and pink background highlights the main outputs of ReporTree. Arrows indicate the alternative workflows for each input. Single asterisk, only output when a sequence alignment is provided. Double asterisks, exclusive output of MST and HC analysis. Triple asterisks, output of an optional step (comparing partitions) not represented in the figure</p></caption><graphic xlink:href="13073_2023_1196_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Input processing</title>
      <p id="Par16">The methodology used for WGS data analysis varies from species to species. For this reason, ReporTree was carefully designed to accept multiple input formats (Table <xref rid="Tab1" ref-type="table">1</xref>), being suitable for application in a wide variety of pathogens. Besides SNP/allele matrices and trees/dendrograms in Newick format, ReporTree accepts other input formats such as multiple sequence alignments, VCF files, or distance matrices. For instance, when a multiple sequence alignment is provided, ReporTree runs the script <italic>alignment_processing.py</italic> (also available in standalone mode) to clean the alignment according to the user's specifications and to convert it into a SNP matrix that will be used in the remaining steps. Moreover, when sample genetic variability is provided in the format of multiple VCF files or a list of mutations (variant sites), ReporTree uses vcf2mst [<xref ref-type="bibr" rid="CR17">17</xref>] to do this format conversion. Besides the input transformation, ReporTree’s input processing step can also involve the filtration of the input files to (i) remove samples with excess of missing data (e.g., samples with less than 95% of cgMLST loci called), (ii) remove informative sites/loci from the SNP/allele matrices (e.g., wgMLST loci called in less than 98% samples), and (iii) analyze a subset of samples fulfilling the metadata parameters specified by the user (e.g., samples from a given sequence type [ST] or year) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This dynamic approach allows maximizing the loci/positions shared by a subset of samples, thus contributing to an increased resolution power and, consequently, a higher confidence in the clustering analysis, aligned with a previously explored rationale [<xref ref-type="bibr" rid="CR14">14</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of ReporTree input types and respective clustering options, with indication of the main outputs provided by this tool</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Inputs Metadata and (phylo)genetic data</th><th align="left">Clustering options</th><th align="left">Main outputs</th></tr></thead><tbody><tr><td align="left" rowspan="2"><p>- <bold>Multiple sequence alignment</bold> (e.g., core SNP alignment)</p><p>- <bold>SNP/allele matrix</bold> (e.g., derived from cg/wgMLST analysis)</p><p>- List of <bold>mutations</bold> or <bold>VCFs</bold></p><p>- Pairwise <bold>distance matrix</bold> (only for HC)</p></td><td align="left"><bold>Minimum spanning tree</bold> (using GrapeTree)</td><td align="left" rowspan="3"><p>- <bold>Genetic clusters</bold> at any (or all) possible distance threshold(s) (partitions table)</p><p>- <bold>Updated metadata</bold> table with clustering information (and nomenclature)</p><p>- <bold>Summary reports with the statistics/trends for the derived genetic clusters</bold></p><p>- <bold>Nomenclature history (record of changes in cluster composition and codes between runs)</bold></p><p>- Summary reports and in-depth cluster analysis for <bold>samples of interest</bold></p><p>- <bold>Count/frequency matrices for the derived genetic clusters</bold> or for any other indicated grouping variable</p><p>- <bold>Regions of cluster stability</bold></p><p>- <bold>Newick tree</bold> (when applicable)</p></td></tr><tr><td align="left"><bold>Hierarchical clustering</bold> (using several methods, such as single-linkage)</td></tr><tr><td align="left">- <bold>Newick tree</bold> (e.g., SNP-scaled tree or dendrogram)</td><td align="left"><bold>Distance between leaves and root or between tree nodes</bold> (using TreeCluster)</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Clustering</title>
      <sec id="Sec5">
        <title>Cluster detection</title>
        <p id="Par17">Once the input files have been processed, ReporTree determines genetic clusters at all user-defined partition thresholds. When the input file corresponds to a phylogenetic tree, ReporTree runs the script <italic>partitioning_treecluster.py</italic> (also available in standalone mode), which takes advantage of TreeCluster [<xref ref-type="bibr" rid="CR8">8</xref>] to automatically determine the genetic clusters using one or several of the different algorithms provided by this tool. For all the other input types (except for the distance matrix which can only be used with a hierarchical clustering (HC) approach), the user can choose between genetic clustering using a GrapeTree or a HC algorithm (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). When a GrapeTree algorithm is requested (MSTreeV2 or goeBURST [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]), ReporTree runs the script <italic>partitioning_grapetree.py</italic> (also available in standalone mode), which uses a modified version of this program [<xref ref-type="bibr" rid="CR19">19</xref>], to obtain the MST and all the genetic clusters. When a HC algorithm is requested, ReporTree runs the script <italic>partitioning_HC.py</italic> (also available in standalone mode), which calculates pairwise Hamming distances with cgmlst-dists [<xref ref-type="bibr" rid="CR20">20</xref>] and determines the genetic clusters using one or several of the different algorithms provided by SciPy [<xref ref-type="bibr" rid="CR21">21</xref>]. The main output of each of these three clustering options is always a so-called partitions table with clustering information for each sample at all the distance thresholds and clustering algorithms requested by the user. Additionally, if the user provides a list of samples of interest (e.g., outbreak-related or newly sequenced samples), ReporTree can automatically apply the above-mentioned dynamic approach by additionally running a high-resolution analysis for every cluster including samples of interest and/or for the subset of the “N” most closely related samples to the samples of interest.</p>
        <p id="Par18">As a complement, ReporTree can optionally identify ranges of distance thresholds associated with cluster stability, i.e., subsequent partition thresholds in which clustering composition is similar. This kind of analysis can be useful for the user in future pathogen-specific nomenclature design. If requested by the user, ReporTree determines those “stable” regions by running a modified version of the code of the Comparing Partitions tool [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. This new version [<xref ref-type="bibr" rid="CR24">24</xref>] takes as input the “partitions table” with clustering information at all possible thresholds and assesses several metrics (Simpson’s Index of Diversity, Adjusted Rand and Adjusted Wallace coefficient) to compare the clustering information at consecutive partitions (from “n + 1” to “n”). Based on a previously described approach [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], ReporTree then uses the neighborhood Adjusted Wallace coefficient (nAWC) to ultimately determine regions of cluster stability [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR26">26</xref>].</p>
      </sec>
      <sec id="Sec6">
        <title>Cluster nomenclature system</title>
        <p id="Par19">ReporTree includes a nomenclature system that can act in two different but complementary ways, namely by (i) maintaining cluster nomenclature at any or all distance thresholds over time and (ii) providing a nomenclature code for each sample that combines clustering information at different hierarchical levels. For the first approach, the intended usage is to provide as input a “partitions table” containing the cluster names at any or all distance thresholds of a previous ReporTree run, which will then be used to (re)name the clusters (for the respective thresholds) of the current run. With this approach, clusters that do not change their composition or just acquire new samples (most expected scenario in a context of continuous surveillance) maintain their name. Moreover, if a previous cluster (e.g., cluster_1) is split into several new clusters in the new run, it will also keep the name by adding an additional suffix (e.g., cluster_1.1, cluster_1.2, etc.). New cluster names will be attributed in some situations, such as the merge of previous clusters, singletons that integrate clusters, and clusters exclusively composed by new samples. ReporTree keeps track of all these changes in cluster composition and nomenclature in a comprehensive tabular output. To increase the flexibility of the nomenclature system, ReporTree also allows the users to change the regular expression for cluster nomenclature (i.e., starting with “cluster_” or “singleton_”) by other nomenclature of interest (e.g., ECDC EpiPulse cluster ID, other official codes for outbreaks, genogroups, etc.), which will be kept afterwards.</p>
        <p id="Par20">Towards the simplification of the system, ReporTree can provide a short nomenclature code for each sample representing a combination of its clustering at different hierarchical levels, following the rationale behind “SNP address” and INNUENDO nomenclature systems [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. For example, if “150,30,7” thresholds are indicated, a combining code of cluster names at these levels will be generated by the same order: C3-C2-C1. In ReporTree, these levels are not predefined by default but instead must be indicated by the user, making it suitable for application to multiple pathogens and easily adaptable to the dataset diversity. ReporTree also opens the possibility to add an extra layer of information to this code with the inclusion of information of a given metadata variable (e.g., C3-C2-C1-CountryA, if country is added to the code).</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Summary report</title>
      <p id="Par21">The final step of ReporTree is the generation of summary reports with the <italic>metadata_report.py</italic> script (also available in standalone mode). Following the user’s specifications, this script can perform cluster characterization according to any relevant epidemiological indicator present in the metadata (e.g., source, vaccination status, antibiotic resistance phenotype). Similar summary reports can be generated to assess the distribution of any (and as many) user-specified variables of interest (e.g., ST distribution by year). When the time variable “date” is provided in the metadata, ReporTree automatically infers other time units (ISO week and ISO year) and metrics (e.g., cluster timespan) relevant for surveillance purposes. Moreover, ReporTree can provide count/relative frequency reports for any grouping variable, such as the relative frequency of the different (sub-)lineages/clusters circulating in the country over time. Noteworthy, ReporTree allows requesting specific reports for sample(s) of interest, as well as the application of filters in the metadata table to select subsets of samples that will be included in the analysis/report (without the need of generating a new subset metadata table). Moreover, when the “nomenclature code” was requested, summary reports of this variable are automatically provided, facilitating cluster tracking and characterization.</p>
      <p id="Par22">Besides these main reports (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), ReporTree generates multiple parallel outputs that enable a fine exploration of intermediate data (e.g., pairwise distance matrices, filtered alignments, trees/dendrograms), while rendering standardized formats that can be easily explored through multiple compatible visualization tools. For instance, users can interactively visualize and explore the ReporTree derived clusters by uploading an updated metadata table (with cluster information) together with the original/derived Newick MST/dendrogram to interactive tools, such as auspice.us [<xref ref-type="bibr" rid="CR5">5</xref>], Microreact [<xref ref-type="bibr" rid="CR6">6</xref>], or GrapeTree [<xref ref-type="bibr" rid="CR4">4</xref>]. In particular, ReporTree outputs can also be uploaded to GrapeTree-GIS [<xref ref-type="bibr" rid="CR27">27</xref>] to get an interactive visualization of a MST together with temporal and geographical data.</p>
      <p id="Par23">ReporTree is available as a github repository [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] or as a docker image [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results and discussion</title>
    <sec id="Sec9">
      <title>Benchmarking</title>
      <sec id="Sec10">
        <title>cg/wgMLST workflow</title>
        <p id="Par24">ReporTree benchmarking for the cg/wgMLST workflow was performed in a laptop [Intel Core i5(R)] with 16 GB of RAM using four different datasets of distinct foodborne bacterial pathogens: <italic>Listeria monocytogenes</italic> (1874 isolates [<xref ref-type="bibr" rid="CR31">31</xref>])<italic>, Salmonella enterica</italic> (1434 isolates [<xref ref-type="bibr" rid="CR32">32</xref>])<italic>, Escherichia coli</italic> (1999 isolates [<xref ref-type="bibr" rid="CR33">33</xref>]), and <italic>Campylobacter jejuni</italic> (3076 isolates [<xref ref-type="bibr" rid="CR34">34</xref>]). Each of these datasets consists of a collection of genome assemblies and respective allelic profiles of isolates with public sequencing data (deposited in SRA/ENA) that were carefully selected to cover a wide genetic diversity (assessed in terms of ST or serotype, depending on the species). Details on the methodology used for the isolates’ selection and dataset curation can be found in each dataset repository [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR34">34</xref>]. Briefly, the genome assemblies were performed with Aquamis v1.3.9 [<xref ref-type="bibr" rid="CR35">35</xref>] using default parameters. cg/wgMLST profiles were determined with chewBBACA v2.8.5 [<xref ref-type="bibr" rid="CR36">36</xref>] using the 1748-loci Pasteur cgMLST schema for <italic>L. monocytogenes</italic> [<xref ref-type="bibr" rid="CR37">37</xref>], the 8558-loci INNUENDO wgMLST schema for <italic>S. enterica</italic>, the 7601-loci INNUENDO wgMLST schema for <italic>E. coli</italic>, and the 2794-loci INNUENDO wgMLST schema for <italic>C. jejuni</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]. All these schemas were retrieved from chewie-NS [<xref ref-type="bibr" rid="CR38">38</xref>] in May/June of 2022. As there was the need to determine a set of core loci for <italic>S. enterica</italic>, <italic>E. coli</italic>, and <italic>C. jejuni</italic> datasets, three sets of core loci were obtained for each species with ReporTree by setting distinct “--site-inclusion” thresholds: 0.95, 0.98, and 1.0 (i.e., only keep loci called in at least 95%, 98%, and 100% of the dataset samples). This resulted into cgMLST schemas with 3261, 3179, and 874 loci for <italic>S. enterica</italic>, 2826, 2704, and 465 loci for <italic>E. coli</italic>, and 1012, 987, and 29 loci for <italic>C. jejuni</italic>, at 0.95, 0.98, and 1.0 thresholds, respectively. As for each of these species, the values obtained at 0.95 and 0.98 were relatively similar, and in the range of what was previously determined for other datasets of the same species [<xref ref-type="bibr" rid="CR14">14</xref>], the benchmarking proceeded with the loci obtained at the 0.98 threshold.</p>
        <p id="Par25">To assess the time performance of ReporTree with different dataset sizes, for each species, we generated sub-datasets of randomly selected isolates. The size of these sub-datasets varied between 200 and the maximum number of isolates of the respective dataset (in a 200-isolates step), with ten replicates being run per sub-dataset size. ReporTree was run for each replicate setting “--loci-called 0.95” (i.e., including only samples with at least 95% of loci called) and requesting summary reports at all possible partition levels obtained with (i) GrapeTree analysis (MSTreeV2 algorithm) and (ii) HC analysis (single-linkage algorithm). Additional runs were performed for each dataset using all isolates but requesting summary reports only for thresholds of “stability” regions (using nAWC, as described above) or at potential “outbreak” level (according to previously described cutoffs) [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR39">39</xref>].</p>
        <p id="Par26">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, for each dataset, ReporTree running time increases linearly with the number of samples, with GrapeTree MSTreeV2 algorithm taking slightly more time than HC single-linkage. Moreover, as expected, a higher number of loci also led to an increased running time. An interesting observation regards the comparison of <italic>S. enterica</italic> and <italic>E. coli</italic> results. Indeed, although the <italic>E. coli</italic> analysis involved a lower number of loci and only a slightly higher number of samples, its running times were higher than those observed for <italic>S. enterica.</italic> This is related to a consistent higher number of clusters in <italic>E. coli</italic> than <italic>S. enterica</italic> dataset at the same threshold (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B), showing that, as expected, the dataset diversity also impacts ReporTree running times. Overall, using the whole dataset, ReporTree identified and characterized clusters determined at all possible distance thresholds with single-linkage and MSTreeV2 in around 5 and 6 min for <italic>L. monocytogenes</italic>, 10 and 11 min for <italic>S. enterica</italic>, 18 and 20 min for <italic>E. coli</italic>, and 5 and 7 min for <italic>C. jejuni</italic>, respectively. Nevertheless, in a routine surveillance scenario in which genetic clusters are obtained at a single or very small number of distance thresholds (e.g., thresholds for potential outbreak detection), ReporTree running times considerably decreased in all the species (also using the whole dataset) to less than 45 s with the HC algorithm and less than 1 min and 30 s with the GrapeTree algorithm (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C), reinforcing its suitability for implementation in routine surveillance.<fig id="Fig2"><label>Fig. 2</label><caption><p>Results of ReporTree benchmarking of the cg/wgMLST workflow using datasets for four different species: <italic>L. monocytogenes</italic> (Lm), <italic>S. enterica</italic> (Se), <italic>E. coli</italic> (Ec), and <italic>C. jejuni</italic> (Cj). <bold>A</bold> ReporTree running times for the 10 replicates of each subset of <italic>L. monocytogenes</italic> (top left), <italic>S. enterica</italic> (top right), <italic>E. coli</italic> (bottom left), and <italic>C. jejuni</italic> (bottom right), where the flag “all” indicates subsets for which ReporTree obtained clusters at all possible thresholds, the flag “outbreak” indicates subsets for which ReporTree obtained clusters at potential outbreak level (7 allelic differences for <italic>L. monocytogenes</italic>, 14 (0.43%) for <italic>S. enterica</italic>, 9 (0.34%) for <italic>E. coli</italic>, and 6 for (0.59%) for <italic>C. jejuni</italic> [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]), and the flag “stability” indicates subsets for which ReporTree obtained clusters at all possible thresholds but only generated reports for those corresponding to stability regions. <bold>B</bold> Number of clusters generated at all possible distance thresholds for each dataset. <bold>C</bold> Comparison of running times when ReporTree obtained clusters at potential outbreak level</p></caption><graphic xlink:href="13073_2023_1196_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par27">ReporTree represents an integrative workflow from a flexible input to a dynamic reporting of cg/wgMLST data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), with clustering being the central step in the analysis. As such, ReporTree offers widely used and validated algorithms (HC, goeBURST/MSTree, and MSTreeV2) for clustering purposes [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Nevertheless, as alternative software for this step is also available, here, we compare ReporTree cgMLST clustering workflows with pHierCC [<xref ref-type="bibr" rid="CR16">16</xref>], another commonly used method for routine surveillance and outbreak detection (implemented in Enterobase [<xref ref-type="bibr" rid="CR40">40</xref>]). Our results (detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1.1 to S1.4) show that despite the conceptual differences of the tested algorithms, in general, the three clustering methods implemented in ReporTree yielded cluster number and composition highly congruent with pHierCC using the four foodborne bacteria datasets described above.</p>
        <p id="Par28">Additionally, in order to assess ReporTree performance in a different context, such as the identification of main populations (or lineages) in a dataset, we have also compared ReporTree with PopPUNK, a <italic>k</italic>-mer-based clustering tool that relies on machine learning to cluster genomes [<xref ref-type="bibr" rid="CR41">41</xref>]. As recommended by the respective authors, PopPUNK was applied to assign the genomes of the <italic>E. coli</italic> dataset to genetic clusters using the existing <italic>E. coli</italic> reference database (<ext-link ext-link-type="uri" xlink:href="https://www.bacpop.org/poppunk/">https://www.bacpop.org/poppunk/</ext-link>, assessed on April 24, 2023) with the best fitting model. PopPUNK identified 366 clusters, which were found to be highly congruent with ReporTree cg/wgMLST clustering results at 642 (for MSTree and HC single-linkage) and 724 (for MSTreeV2) allele differences thresholds, with Adjusted Rand coefficients of 0.995 in both cases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2.1). These thresholds fall within one of the stability regions identified by ReporTree, reinforcing the applicability of the nAWC component of ReporTree to detect low-resolution genogroups/lineages for longitudinal surveillance or population structure evaluation.</p>
      </sec>
      <sec id="Sec11">
        <title>Alignment-based core-SNP workflow</title>
        <p id="Par29">ReporTree benchmarking for the alignment-based SNP workflow was performed in a laptop [Intel Core i7(R)] with 16 GB of RAM using a publicly available diverse dataset of <italic>Mycobacterium tuberculosis</italic> [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>], which is a bacterial pathogen with a large genome (approximately 4.4 Mb) for which such a workflow is starting to be routinely applied for surveillance. As input for this benchmarking, we used a filtered alignment comprising the maximum number of informative sites (a total of 88,562 nucleotide sites with at least one mutation in a given sequence) observed in the comparison of 1788 <italic>M</italic><italic>. tuberculosis</italic> genomes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Similar to the cg/wgMLST workflow, we generated sub-datasets of randomly selected isolates with between 200 and the maximum number of isolates in a 200-isolates step, with ten replicates per sub-dataset size, and requesting summary reports at all possible partition levels with (i) GrapeTree analysis (MSTreeV2 algorithm) and (ii) HC analysis (single-linkage algorithm). Additional runs with all isolates and requesting summary reports at potential transmission chain resolution (12 SNPs) and at stable regions were also performed. Running time was assessed using “--site-inclusion” of 1.0 (true core alignment, i.e., only ATCG) and 0.95 (core alignment tolerating 5% of undefined nucleotides per site), as a way to simulate two likely applications of ReporTree. The first one more likely suits clustering of large and diverse datasets, while the second one is more likely to be applied when fine resolution is needed (e.g., to enhance the resolution in clusters identified with less discriminatory genotyping methods).<fig id="Fig3"><label>Fig. 3</label><caption><p>Results of ReporTree benchmarking of the alignment-based core SNP workflow using a multi-sequence alignment of 1788 <italic>M</italic><italic>. tuberculosis</italic> samples and 88,562 informative nucleotide positions. <bold>A</bold> ReporTree running times for the 10 replicates of each sample subset with a site inclusion of 1.0 (left) and 0.95 (right), where the flag “all” indicates subsets for which ReporTree obtained clusters at all possible thresholds, the flag “single_thr” indicates subsets for which ReporTree obtained clusters at potential “transmission chain” level (12 SNP differences), and the flag “stability” indicates subsets for which ReporTree obtained clusters at all possible thresholds but only generated reports for those corresponding to stability regions. <bold>B</bold> ReporTree running times according to the number of variant sites obtained after alignment cleaning and that were used for clustering. Technical notes: 1. The “site-inclusion” argument defines informative nucleotide sites to be kept in the alignment based on the minimum proportion of samples per site without missing data (e.g., 1.0 reflects a “true” core alignment with all variant sites having exclusively ATCG, and 0.95 reflects a core alignment tolerating 5% of undefined nucleotides per site). 2. The <italic>M. tuberculosis</italic> dataset used in this benchmarking is described at [<xref ref-type="bibr" rid="CR42">42</xref>]</p></caption><graphic xlink:href="13073_2023_1196_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par30">ReporTree running time in the alignment-based core SNP analysis increases with the number of samples, linearly for “site-inclusion 1.0” and exponentially for “site-inclusion 0.95” (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The considerably higher running times observed in “site-inclusion 0.95” were expected as this workflow requires a demanding cleaning step in which each variant site in the alignment has to be screened for the amount of missing data. We have also assessed how the time performance correlates with the number of informative sites used for clustering. In the “site-inclusion 1.0” workflow, for the same number of samples, having more variant sites has a minimal impact on time (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). On the other hand, in the “site-inclusion 0.95”, time is a function of both the number of samples and number of sites in the sense that, as expected, adding more samples introduces more variant sites to be screened for missing data. In summary, the running times were satisfactory for the main purpose of each condition, with the “site-inclusion 1.0” workflow taking less than 6 min in all tested situations and the “site-inclusion 0.95” workflow taking less than 10 min for datasets with less than 400 isolates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Of note, given the main goal of this benchmarking (considerably scale up the number of variant sites for clustering when comparing with the cg/wgMLST workflow), we used an alignment containing the maximum number of informative sites in the dataset. In a simulated scenario in which ReporTree would instead take the full genome alignment (i.e., 4.4 Mb) as input, as removing gaps and non-variable sites is less demanding than handling the “site-inclusion” argument, the time performance with the current dataset would range between 3 and 22 min for a “site-inclusion 1.0” and 12 min and 4 h and 15 min for “site-inclusion 0.95”, depending on the dataset size (200 and 1788 isolates, respectively).</p>
        <p id="Par31">The alignment-based core SNP workflow available in ReporTree is designed to facilitate the routine assessment of bacteria genetic relatedness at different levels of resolution, either as an alternative or a complement to cg/wgMLST data (e.g., to increase the resolution at outbreak level). As demonstrated in the previous benchmarkings, ReporTree relies on widely used and validated methods that ensure input flexibility, clustering reliability, and turn-around times compatible with routine purposes. Still, core SNP-based analyses are also often applied for the identification of main bacterial populations (or lineages) towards the reconstruction of pathogen evolutionary history or species-level population structure. As such, we sought to assess how ReporTree-derived clustering compares with the lineages/populations obtained through a traditional typing method and also through a Bayesian analysis of population structure (BAPS). To this end, we not only took advantage of the lineage information of the <italic>M. tuberculosis</italic> dataset (inferred using Tb-profiler v4.4.1. [<xref ref-type="bibr" rid="CR44">44</xref>]) but also ran FastBAPS [<xref ref-type="bibr" rid="CR45">45</xref>] on its multi-sequence alignment using default parameters (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Similar to the cg/wgMLST benchmarking (previous subsection), clusters were identified at all possible thresholds with ReporTree using MSTreeV2 method. We found that the levels with highest congruence either with <italic>M. tuberculosis</italic> main lineages or with FastBAPS fall within ReporTree-determined stability regions for this dataset (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>), again demonstrating the alternative utility of ReporTree to get insight on bacterial population structure.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Reproducing a large-scale study on genetic clustering and linkage to antibiotic resistance data in <italic>Neisseria gonorrhoeae</italic></title>
      <p id="Par32">Our team has recently performed an extensive genomics analysis of the bacterial pathogen <italic>Neisseria gonorrhoeae</italic> [<xref ref-type="bibr" rid="CR46">46</xref>]. In this study, 3791 <italic>N. gonorrhoeae</italic> genomes from isolates collected across Europe were analyzed with a cgMLST approach. Genetic clusters were determined with the goeBURST algorithm implemented in PHYLOViZ [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR47">47</xref>] for all possible allelic distance thresholds (partitions). Cluster concordance between subsequent distance thresholds was assessed with the nAWC in order to determine regions of cluster stability [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] that were used for nomenclature purposes and identification of genogroups. The association between metadata and genetic clusters was then performed by time-consuming table handling with a spreadsheet program. This corresponded to a non-automated workflow and, in the particular case of the cluster congruence analysis and the integration of genetic and clinically or epidemiologically relevant data, it represented a highly demanding process difficult to be applied in real-time pathogen surveillance. As such, to validate ReporTree and demonstrate how it can enhance bacterial pathogens’ surveillance and research, we used the same dataset as in the previous study [<xref ref-type="bibr" rid="CR46">46</xref>] and attempted to reproduce the main study outputs with this tool. As shown in ReporTree’s Wiki [<xref ref-type="bibr" rid="CR48">48</xref>], using the allele matrix with 822 loci [<xref ref-type="bibr" rid="CR49">49</xref>] and the associated metadata (available in Supplementary material 1 of Pinto et al. [<xref ref-type="bibr" rid="CR46">46</xref>]) as input, ReporTree automatically identified the genetic clusters at all possible partition thresholds of the generated MST, identified the same regions of cluster stability, and replicated the hierarchical nomenclature applied by Pinto et al. [<xref ref-type="bibr" rid="CR46">46</xref>]. Moreover, it provided an updated metadata table with clustering information at the first partition of each stability region and of the derived nomenclature code, which could be used as input for visualization in GrapeTree [<xref ref-type="bibr" rid="CR4">4</xref>]. Furthermore, summary reports with statistics/trends associated with each genetic cluster of low and high levels of stability (i.e., 40 allele differences at the lower level and 79 allele differences at the higher level, similarly to what was found by Pinto et al.) were reported. Of note, the high level of stability identified by ReporTree matches the lineages identified by PopPUNK with the same dataset (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2.2), supporting that this resolution level reflects <italic>N. gonorrhoeae</italic> population structure. Finally, ReporTree was able to associate and report the distribution of genetic determinants of antimicrobial resistance in <italic>N. gonorrhoeae</italic> for the different genetic clusters. Importantly, this example allowed a clear validation of the tool by rigorously reproducing the data presented, for example, in Figure 1a, 1b and 3 and in Tables 1 and 2 of the previous publication [<xref ref-type="bibr" rid="CR46">46</xref>]. All these outputs (and additional ones) are available for consultation at ReporTree github repository [<xref ref-type="bibr" rid="CR28">28</xref>]. Noteworthy, this proof of concept was made with a single ReporTree command line that ran for approximately 2 min and 2 s in a laptop [Intel Core i5(R)] with 16 GB of RAM.</p>
    </sec>
    <sec id="Sec13">
      <title>ReporTree and its application to genomics-informed routine surveillance (e.g., SARS-CoV-2) and outbreak detection (e.g., <italic>Listeria monocytogenes</italic>)</title>
      <p id="Par33">ReporTree’s versatility and broad functionalities make it suitable for different applications and integration in different research or surveillance contexts (from the usage of specific functionalities to the whole pipeline implementation). Here, we provide two examples of the integration of this tool, at different scales, in established workflows of genomic surveillance.</p>
      <p id="Par34">Genomics-informed surveillance of SARS-CoV-2 has had an important role in worldwide public health and political decision-making in the last 2 years. In Portugal, weekly reports of nationwide sequencing surveys are provided to public health authorities and the general public describing important indicators and trends of the evolution and geotemporal spread of the virus [<xref ref-type="bibr" rid="CR50">50</xref>]. Therefore, after ReporTree validation, we implemented this tool in the routine genomics surveillance of SARS-CoV-2 in the country with the objective of speeding up the association between genomic and epidemiological data and the generation of the surveillance-oriented reports. For instance, besides its comprehensive usage for calculating the relative frequency of variants of concern (VOCs) at regional and national levels, ReporTree is often applied to identify clusters of high-closely related viruses (e.g., using TreeCluster [<xref ref-type="bibr" rid="CR8">8</xref>] max-clade or avg-clade models at high resolution levels) that may represent local transmission networks or even super-spreading events. Examples of ReporTree application in the context of SARS-CoV-2 genomic epidemiology are provided at ReporTree’s Wiki [<xref ref-type="bibr" rid="CR48">48</xref>]. To further demonstrate its utility and performance for this purpose, we ran ReporTree over the public Taxonium (<ext-link ext-link-type="uri" xlink:href="https://cov2tree.org/">https://cov2tree.org/</ext-link>) [<xref ref-type="bibr" rid="CR7">7</xref>] tree with more than 6 million SARS-CoV-2 sequences (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). ReporTree is able to cut this massive tree, identifying all clusters of close-related sequences (e.g., avg-clade at 2 SNP differences), and extract valuable information (timespan, country dispersion, etc.) for the clusters identified in a given lineage, country, or period of time.</p>
      <p id="Par35">Regarding the full implementation, one of the most direct and intuitive applications is the analysis of cg/wgMLST data for outbreak investigation, namely for foodborne bacterial pathogens (as shown in the Benchmarking section), as this subtyping method delivers sufficiently high-resolution and epidemiological concordance [<xref ref-type="bibr" rid="CR51">51</xref>]. In ReporTree’s Wiki [<xref ref-type="bibr" rid="CR48">48</xref>], it is provided a simple simulated example in which, with a single command line, ReporTree builds an MST from cgMLST data and automatically extracts and reports genetic clusters of <italic>L. monocytogenes</italic> at high-resolution levels commonly used for outbreak detection (≤ 4 and ≤ 7 allelic differences, [<xref ref-type="bibr" rid="CR39">39</xref>]), keeping the cluster nomenclature of the previous run, as routinely performed in Portugal. These two examples show that ReporTree is a useful asset to rapidly generate summary reports with key data (pathogen genetic clusters) and statistics/trends for routine surveillance and outbreak investigation.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par36">ReporTree represents an automated and flexible pipeline that can be used for a wide variety of species and that facilitates the detection of genetic clusters and their linkage to epidemiological data, in a concept aligned with “One Health” perspectives. Here, we presented the proof of concept of this tool, showing its ability to quickly report a comprehensive WGS-based genogroup assignment for <italic>N. gonorrhoeae</italic>, based on the identification of the discriminatory genetic thresholds reflecting cluster stability, and the rapid correlation of these genogroups (representing main circulating lineages) with any data of interest, such as antimicrobial resistance data. Furthermore, we have shown how its flexibility contributed to speed up SARS-CoV-2 and <italic>L. monocytogenes</italic> genomics-informed surveillance in Portugal, facilitating and accelerating the production of surveillance-oriented reports. ReporTree benchmarking ultimately demonstrated that this tool can be smoothly implemented in routine surveillance bioinformatics workflows, with negligible computational and time costs. Although ReporTree is currently available as a command line tool, this resource can easily be integrated in start-to-end platforms for genomics/epidemiological analysis (for instance, it will be soon integrated in the COHESIVE Information System [<xref ref-type="bibr" rid="CR52">52</xref>] and INSaFLU platform [<xref ref-type="bibr" rid="CR53">53</xref>]), thus contributing to a sustainable and efficient public health genomics-informed pathogen surveillance.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par37">Project name: ReporTree.</p>
    <p id="Par38">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree">https://github.com/insapathogenomics/ReporTree</ext-link></p>
    <p id="Par39">Project Wiki: <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree/wiki">https://github.com/insapathogenomics/ReporTree/wiki</ext-link></p>
    <p id="Par40">Record of the home page and Wiki at the time of publication: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7772640">https://doi.org/10.5281/zenodo.7772640</ext-link></p>
    <p id="Par41">Operating system(s): Unix.</p>
    <p id="Par42">Programming language: Python 3.8</p>
    <p id="Par43">Other requirements: Biopython 1.77, Pandas 1.1.3, Ete3, TreeCluster 1.0.3, GrapeTree 2.1, cgmlst-dists, and vcf2mst.</p>
    <p id="Par44">License: GPL 3.0</p>
    <p id="Par45">Any restrictions to use by non-academics: none.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1196_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Comparison of ReporTree results with other clustering methods and tools.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>cgMLST</term>
        <def>
          <p id="Par4">Core-genome multilocus sequence type</p>
        </def>
      </def-item>
      <def-item>
        <term>HC</term>
        <def>
          <p id="Par5">Hierarchical clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p id="Par6">Minimum spanning tree</p>
        </def>
      </def-item>
      <def-item>
        <term>nAWC</term>
        <def>
          <p id="Par7">Neighborhood Adjusted Wallace coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par8">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>wgMLST</term>
        <def>
          <p id="Par9">Whole-genome multilocus sequence type</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par10">Whole-genome sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Dr. Holger Brendebach, Dr. Carlus Deneke, and Dr. Simon Tausch from the German Federal Institute for Risk Assessment for their support during the genome assembly of the samples used in ReporTree benchmarking and Dr. João André Carriço for the productive discussions throughout ReporTree development. We would also like to thank the National Distributed Computing Infrastructure of Portugal (INCD) for providing the necessary resources to run the genome assemblies. INCD was funded by FCT and FEDER under the project 22153-01/SAICT/2016.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>VM, MP, JPG, and VB idealized and planned the tool. All authors contributed to the design and refinement of the tool. VM performed the programming and benchmarking. VM, MP, and VB performed the tool validation. DS performed the dockerization and continuous integration testing. VM and VB wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by funding from the European Union’s Horizon 2020 Research and Innovation program under grant agreement No 773830: One Health European Joint Programme (2020–2022) and by national funds through FCT—Foundation for Science and Technology, I.P., in the frame of Individual CEEC 2022.00851.CEECIND/CP1748/CT0001 (2023 onwards).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analyzed during the current study are available in the Zenodo repository (<italic>L. monocytogenes</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7116879">https://zenodo.org/record/7116879</ext-link> [<xref ref-type="bibr" rid="CR31">31</xref>]; <italic>S. enterica</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7119736">https://zenodo.org/record/7119736</ext-link> [<xref ref-type="bibr" rid="CR32">32</xref>]; <italic>E. coli</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7120058">https://zenodo.org/record/7120058</ext-link> [<xref ref-type="bibr" rid="CR33">33</xref>]; <italic>C. jejuni</italic>: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7120167">https://doi.org/10.5281/zenodo.7120167</ext-link> [<xref ref-type="bibr" rid="CR34">34</xref>]; <italic>N. gonorrhoeae</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3946223">https://zenodo.org/record/3946223</ext-link> [<xref ref-type="bibr" rid="CR49">49</xref>]; <italic>M. tuberculosis</italic>: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7772652">https://zenodo.org/record/7772652</ext-link> [<xref ref-type="bibr" rid="CR43">43</xref>]) or in ReporTree github repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree/">https://github.com/insapathogenomics/ReporTree/</ext-link> [<xref ref-type="bibr" rid="CR28">28</xref>]. In order to ensure the long-term availability of all materials used in this manuscript, the github repository and the Wiki material at the time of publication are also available at Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7772640">https://doi.org/10.5281/zenodo.7772640</ext-link>) [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par46">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par48">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jolley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
        </person-group>
        <article-title>Using multilocus sequence typing to study bacterial variation: prospects in the genomic era</article-title>
        <source>Future Microbiol</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>623</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.2217/fmb.14.24</pub-id>
        <?supplied-pmid 24957089?>
        <pub-id pub-id-type="pmid">24957089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wohl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Genomic analysis of viral outbreaks</article-title>
        <source>Annu Rev Virol</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>173</fpage>
        <lpage>195</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-virology-110615-035747</pub-id>
        <?supplied-pmid 27501264?>
        <pub-id pub-id-type="pmid">27501264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ribeiro-Gonçalves</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>PHYLOViZ Online: web-based tool for visualization, phylogenetic inference, analysis and sharing of minimum spanning trees</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W246</fpage>
        <lpage>W251</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw359</pub-id>
        <?supplied-pmid 27131357?>
        <pub-id pub-id-type="pmid">27131357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Sergeant</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Luhmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GrapeTree: visualization of core genomic relationships among 100,000 bacterial pathogens</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1395</fpage>
        <lpage>1404</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.232397.117</pub-id>
        <?supplied-pmid 30049790?>
        <pub-id pub-id-type="pmid">30049790</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hadfield</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Megill</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Callender</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nextstrain: real-time tracking of pathogen evolution</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>4121</fpage>
        <lpage>4123</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty407</pub-id>
        <?supplied-pmid 29790939?>
        <pub-id pub-id-type="pmid">29790939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Argimón</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abudahab</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goater</surname>
            <given-names>RJE</given-names>
          </name>
          <name>
            <surname>Fedosejev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bhai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Glasner</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microreact: visualizing and sharing data for genomic epidemiology and phylogeography</article-title>
        <source>Microb Genom</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>e000093</fpage>
        <?supplied-pmid 28348833?>
        <pub-id pub-id-type="pmid">28348833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanderson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Taxonium, a web-based tool for exploring large phylogenetic trees</article-title>
        <source>eLife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e82392</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.82392</pub-id>
        <?supplied-pmid 36377483?>
        <pub-id pub-id-type="pmid">36377483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balaban</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moshiri</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mai</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TreeCluster: clustering biological sequences using phylogenetic trees</article-title>
        <source>PLoS one</source>
        <year>2019</year>
        <volume>14</volume>
        <fpage>e0221068</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0221068</pub-id>
        <?supplied-pmid 31437182?>
        <pub-id pub-id-type="pmid">31437182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dallman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ashton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Jironkin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Painset</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shaaban</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SnapperDB: a database solution for routine sequencing analysis of bacterial isolates</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3028</fpage>
        <lpage>3029</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty212</pub-id>
        <?supplied-pmid 29659710?>
        <pub-id pub-id-type="pmid">29659710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deneke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Uelze</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brendebach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tausch</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Malorny</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Decentralized investigation of bacterial outbreaks based on hashed cgMLST</article-title>
        <source>Front Microbiol</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>649517</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2021.649517</pub-id>
        <?supplied-pmid 34220740?>
        <pub-id pub-id-type="pmid">34220740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ragonnet-Cronin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hodcroft</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hué</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fearnhill</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Delpech</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>AJL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated analysis of phylogenetic clusters</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>317</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-317</pub-id>
        <?supplied-pmid 24191891?>
        <pub-id pub-id-type="pmid">24191891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Monteiro</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Melo-Cristino</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>PHYLOViZ: phylogenetic inference and data visualization for sequence based typing methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-87</pub-id>
        <?supplied-pmid 22568821?>
        <pub-id pub-id-type="pmid">22568821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lees</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gladstone</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Weiser</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and flexible bacterial genomic epidemiology with PopPUNK</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>304</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.241455.118</pub-id>
        <?supplied-pmid 30679308?>
        <pub-id pub-id-type="pmid">30679308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Llarena</surname>
            <given-names>A-K</given-names>
          </name>
          <name>
            <surname>Ribeiro-Gonçalves</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Nuno Silva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Halkilahti</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Machado</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Da Silva</surname>
            <given-names>MS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>INNUENDO: a cross-sectoral platform for the integration of genomics in the surveillance of food-borne pathogens</article-title>
        <source>EFSA Support Publ</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1498</fpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>O’Toole</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McCrone</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology</article-title>
        <source>Nat Microbiol</source>
        <year>2020</year>
        <volume>5</volume>
        <fpage>1403</fpage>
        <lpage>1407</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-020-0770-5</pub-id>
        <?supplied-pmid 32669681?>
        <pub-id pub-id-type="pmid">32669681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Charlesworth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Achtman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>HierCC: a multi-level clustering scheme for population assignments based on core genome MLST</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>20</issue>
        <fpage>3645</fpage>
        <lpage>3646</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab234</pub-id>
        <?supplied-pmid 33823553?>
        <pub-id pub-id-type="pmid">33823553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Pasquale</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Radomski</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mangone</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Calistri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lorusso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cammà</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>SARS-CoV-2 surveillance in Italy through phylogenomic inferences based on Hamming distances derived from pan-SNPs, -MNPs and -InDels</article-title>
        <source>BMC Genomics</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>782</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-021-08112-0</pub-id>
        <?supplied-pmid 34717546?>
        <pub-id pub-id-type="pmid">34717546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Bugalho</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Global optimal eBURST analysis of multilocus typing data using a graphic matroid approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>152</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-152</pub-id>
        <?supplied-pmid 19450271?>
        <pub-id pub-id-type="pmid">19450271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">GrapeTree (github repository with the modified version). <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/GrapeTree">https://github.com/insapathogenomics/GrapeTree</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Seemann T. cgmlst-dists. github. <ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/cgmlst-dists">https://github.com/tseemann/cgmlst-dists</ext-link> Accessed on 28 Sept 2022.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>261</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <?supplied-pmid 32015543?>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Silva-Costa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Melo-Cristino</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pinto</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>de Lencastre</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Illustration of a common framework for relating multiple typing methods by application to macrolide-resistant Streptococcus pyogenes</article-title>
        <source>J Clin Microbiol</source>
        <year>2006</year>
        <volume>44</volume>
        <fpage>2524</fpage>
        <lpage>2532</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02536-05</pub-id>
        <?supplied-pmid 16825375?>
        <pub-id pub-id-type="pmid">16825375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Comparing partitions. <ext-link ext-link-type="uri" xlink:href="http://www.comparingpartitions.info/">http://www.comparingpartitions.info/</ext-link> Accessed on 28 Sept 2022.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Comparing partitions (repository with the new version). Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ComparingPartitions">https://github.com/insapathogenomics/ComparingPartitions</ext-link> Accessed on 28 Sept 2022.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Severiano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pinto</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Adjusted Wallace coefficient as a measure of congruence between typing methods</article-title>
        <source>J Clin Microbiol</source>
        <year>2011</year>
        <volume>49</volume>
        <fpage>3997</fpage>
        <lpage>4000</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00624-11</pub-id>
        <?supplied-pmid 21918028?>
        <pub-id pub-id-type="pmid">21918028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Barker DOR, Carriço JA, Kruczkiewicz P, Palma F, Rossi M, Taboada EN. Rapid identification of stable clusters in bacterial populations using the adjusted Wallace coefficient bioRxiv. 2018. Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/299347">http://biorxiv.org/lookup/doi/10.1101/299347</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Di Pasquale A, Radomski N, Maassen K, Cammà C. One Health structure In Europe for omics-based surveillance. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/genpat-it/grapetree-gis">https://github.com/genpat-it/grapetree-gis</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">ReporTree github. <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree">https://github.com/insapathogenomics/ReporTree</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Mixão V, Pinto M, Sobral D, Di Pasquale A, Gomes JP, Borges V. ReporTree: a surveillance-oriented tool to strengthen the linkage between pathogen genetic clusters and epidemiological data. 2023. Zenodo. 10.5281/zenodo.7772640.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">ReporTree (docker). <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/insapathogenomics/reportree">https://hub.docker.com/r/insapathogenomics/reportree</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective cgMLST profiles of a diverse dataset comprising 1,874 <italic>Listeria monocytogenes</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7116879">https://zenodo.org/record/7116879</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective wg/cgMLST profiles of a diverse dataset comprising 1,434 <italic>Salmonella enterica</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7119736">https://zenodo.org/record/7119736</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective wg/cgMLST profiles of a diverse dataset comprising 1,999 <italic>Escherichia coli</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7120058">https://zenodo.org/record/7120058</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Mixão V, Brendebach H, Pinto M, Sobral D, Gomes JP, Deneke C, et al. Genome assemblies and respective wg/cgMLST profiles of a diverse dataset comprising 3,076 <italic>Campylobacter jejuni</italic> isolates. Zenodo. 2022. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7120167">https://zenodo.org/record/7120167</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deneke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brendebach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Uelze</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Borowiak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malorny</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tausch</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Species-specific quality control, assembly and contamination detection in microbial isolate sequences with AQUAMIS</article-title>
        <source>Genes</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>644</fpage>
        <pub-id pub-id-type="doi">10.3390/genes12050644</pub-id>
        <?supplied-pmid 33926025?>
        <pub-id pub-id-type="pmid">33926025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Machado</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Rossi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moran-Gilad</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>chewBBACA: a complete suite for gene-by-gene schema creation and strain identification</article-title>
        <source>Microb Genom</source>
        <year>2018</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>e000166</fpage>
        <?supplied-pmid 29543149?>
        <pub-id pub-id-type="pmid">29543149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moura</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Criscuolo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pouseele</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Maury</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Leclercq</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tarr</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole genome-based population biology and epidemiological surveillance of <italic>Listeria monocytogenes</italic></article-title>
        <source>Nat Microbiol</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>16185</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.185</pub-id>
        <?supplied-pmid 27723724?>
        <pub-id pub-id-type="pmid">27723724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mamede</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vila-Cerqueira</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Chewie Nomenclature Server (chewie-NS): a deployable nomenclature server for easy sharing of core and whole genome MLST schemas</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D660</fpage>
        <lpage>D666</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa889</pub-id>
        <?supplied-pmid 33068420?>
        <pub-id pub-id-type="pmid">33068420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Walle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Björkman</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Cormican</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dallman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mossong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moura</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Retrospective validation of whole genome sequencing-enhanced surveillance of listeriosis in Europe, 2010 to 2015</article-title>
        <source>Euro Surveill</source>
        <year>2018</year>
        <volume>23</volume>
        <issue>33</issue>
        <fpage>1700798</fpage>
        <?supplied-pmid 30131096?>
        <pub-id pub-id-type="pmid">30131096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
          <collab>Agama Study Group</collab>
          <name>
            <surname>Achtman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The EnteroBase user’s guide, with case studies on Salmonella transmissions, Yersinia pestis phylogeny, and Escherichia core genomic diversity</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>138</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.251678.119</pub-id>
        <?supplied-pmid 31809257?>
        <pub-id pub-id-type="pmid">31809257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lees</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gladstone</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Weiser</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and flexible bacterial genomic epidemiology with PopPUNK</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>304</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.241455.118</pub-id>
        <?supplied-pmid 30679308?>
        <pub-id pub-id-type="pmid">30679308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walker</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Omar</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Hedge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Elias</surname>
            <given-names>CDO</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequencing for prediction of <italic>Mycobacterium tuberculosis</italic> drug susceptibility and resistance: a retrospective study</article-title>
        <source>Lancet Infect Dis</source>
        <year>2015</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>1193</fpage>
        <lpage>1202</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(15)00062-6</pub-id>
        <?supplied-pmid 26116186?>
        <pub-id pub-id-type="pmid">26116186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Mixão V, Pinto M, Sobral D, Di Pasquale A, Gomes JP, Borges V. Multiple sequence alignment of a diverse dataset with 1788 <italic>Mycobacterium tuberculosis</italic> isolates. Zenodo. 2023. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7772652">https://zenodo.org/record/7772652</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phelan</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>O'Sullivan</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Machado</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oppong</surname>
            <given-names>YEA</given-names>
          </name>
          <name>
            <surname>Campino</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating informatics tools and portable sequencing technology for rapid detection of resistance to anti-tuberculous drugs</article-title>
        <source>Genome Med</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-019-0650-x</pub-id>
        <?supplied-pmid 31234910?>
        <pub-id pub-id-type="pmid">31234910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lees</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Frost</surname>
            <given-names>SDW</given-names>
          </name>
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fast hierarchical Bayesian analysis of population structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>11</issue>
        <fpage>5539</fpage>
        <lpage>5549</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz361</pub-id>
        <?supplied-pmid 31076776?>
        <pub-id pub-id-type="pmid">31076776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Isidro</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodrigues</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Vieira</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Borrego</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>Neisseria gonorrhoeae</italic> clustering to reveal major European whole-genome-sequencing-based genogroups in association with antimicrobial resistance</article-title>
        <source>Microb Genom</source>
        <year>2021</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>000481</fpage>
        <?supplied-pmid 33245688?>
        <pub-id pub-id-type="pmid">33245688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nascimento</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sousa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Francisco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Carriço</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Vaz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>PHYLOViZ 2.0: providing scalable data integration and visualization for multiple phylogenetic inference methods</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>128</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw582</pub-id>
        <?supplied-pmid 27605102?>
        <pub-id pub-id-type="pmid">27605102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">ReporTree Wiki. <ext-link ext-link-type="uri" xlink:href="https://github.com/insapathogenomics/ReporTree/wiki">https://github.com/insapathogenomics/ReporTree/wiki</ext-link> (open page continuously updated).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Pinto M, Borges V, Isidro J, Rodrigues JC, Vieira L, Borrego MJ, et al. <italic>Neisseria gonorrhoeae</italic> clustering to reveal major European WGS-based genogroups in association with antimicrobial resistance (cgMLST and MScgMLST schemas, allelic profile matrices and GrapeTree input file). Zenodo. 2020. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3946223">https://zenodo.org/record/3946223</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Diversidade genética do novo coronavírus SARS-CoV-2 (COVID-19) em Portugal. Available from: <ext-link ext-link-type="uri" xlink:href="https://insaflu.insa.pt/covid19/">https://insaflu.insa.pt/covid19/</ext-link> Accessed on 12 May 2023.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nadon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Van Walle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gerner-Smidt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Campos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chinen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Concepcion-Acevedo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PulseNet International: vision for the implementation of whole genome sequencing (WGS) for global food-borne disease surveillance</article-title>
        <source>Euro Surveill</source>
        <year>2017</year>
        <volume>22</volume>
        <issue>23</issue>
        <fpage>30544</fpage>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.23.30544</pub-id>
        <?supplied-pmid 28662764?>
        <pub-id pub-id-type="pmid">28662764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Sciensano. D3.12- abstract book for 2nd annual scientific meeting (ASM). Zenodo; 2021. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4897305">https://zenodo.org/record/4897305</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borges</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pinheiro</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pechirra</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Guiomar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gomes</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>INSaFLU: an automated open web-based bioinformatics suite “from-reads” for influenza whole-genome-sequencing-based surveillance</article-title>
        <source>Genome Med</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>46</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-018-0555-0</pub-id>
        <?supplied-pmid 29954441?>
        <pub-id pub-id-type="pmid">29954441</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
