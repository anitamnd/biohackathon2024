<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6658715</article-id>
    <article-id pub-id-type="pmid">29415263</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty058</article-id>
    <article-id pub-id-type="publisher-id">bty058</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scEpath: energy landscape-based inference of transition probabilities and cellular trajectories from single-cell transcriptomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Suoqin</given-names>
        </name>
        <xref ref-type="aff" rid="bty058-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>MacLean</surname>
          <given-names>Adam L</given-names>
        </name>
        <xref ref-type="aff" rid="bty058-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="bty058-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <xref ref-type="aff" rid="bty058-aff1">1</xref>
        <xref ref-type="aff" rid="bty058-aff2">2</xref>
        <xref ref-type="corresp" rid="bty058-cor1"/>
        <!--<email>qnie@uci.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty058-aff1"><label>1</label>Department of Mathematics and Center for Complex Biological Systems</aff>
    <aff id="bty058-aff2"><label>2</label>Department of Development and Cell Biology, University of California, Irvine, CA, USA</aff>
    <author-notes>
      <corresp id="bty058-cor1">To whom correspondence should be addressed. Email: <email>qnie@uci.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-02-05">
      <day>05</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>12</issue>
    <fpage>2077</fpage>
    <lpage>2086</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>2</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty058.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA-sequencing (scRNA-seq) offers unprecedented resolution for studying cellular decision-making processes. Robust inference of cell state transition paths and probabilities is an important yet challenging step in the analysis of these data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here we present scEpath, an algorithm that calculates energy landscapes and probabilistic directed graphs in order to reconstruct developmental trajectories. We quantify the energy landscape using ‘single-cell energy’ and distance-based measures, and find that the combination of these enables robust inference of the transition probabilities and lineage relationships between cell states. We also identify marker genes and gene expression patterns associated with cell state transitions. Our approach produces pseudotemporal orderings that are—in combination—more robust and accurate than current methods, and offers higher resolution dynamics of the cell state transitions, leading to new insight into key transition events during differentiation and development. Moreover, scEpath is robust to variation in the size of the input gene set, and is broadly unsupervised, requiring few parameters to be set by the user. Applications of scEpath led to the identification of a cell-cell communication network implicated in early human embryo development, and novel transcription factors important for myoblast differentiation. scEpath allows us to identify common and specific temporal dynamics and transcriptional factor programs along branched lineages, as well as the transition probabilities that control cell fates.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>A MATLAB package of scEpath is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sqjin/scEpath">https://github.com/sqjin/scEpath</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institute of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>P50GM76516</award-id>
        <award-id>R01GM107264</award-id>
        <award-id>R01ED023050</award-id>
        <award-id>R01NS095355</award-id>
        <award-id>R01GM123731</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Science Foundation</named-content>
          <named-content content-type="funder-identifier">110.13039/501100008982</named-content>
        </funding-source>
        <award-id>DMS1161621</award-id>
        <award-id>DMS1562176</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Jayne Koskinas Ted Giovanis Foundation for Health and Policy</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Breast Cancer Research Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/100001006</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Since it first became possible to simultaneously measure thousands of genes in many single cells (<xref rid="bty058-B14" ref-type="bibr">Islam <italic>et al.</italic>, 2011</xref>), technological developments in single-cell RNA sequencing (scRNA-seq) analyses have dramatically improved (<xref rid="bty058-B26" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). Concurrently, methods are required that are suitable for the analysis of these data, which are inherently of very large dimension, necessitating some form of computational analysis for any meaning to be drawn from them (<xref rid="bty058-B27" ref-type="bibr">Tanay and Regev, 2017</xref>). Such data analyses include the identification of functionally relevant (sub-)populations of cells, cell state transitions along developmental or other trajectories, hierarchical lineage relationships (e.g. stem cell differentiation) and pseudotemporal ordering.</p>
    <p>A number of computational methods have been developed to address these tasks. Monocle was the first of a series of pseudotemporal ordering algorithms, and uses a combination of independent component analysis and a minimal spanning tree (MST) algorithm to build a differentiation trajectory (<xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>). Monocle 2 has been recently released, which uses reverse graph embedding, producing more accurate trajectories than its predecessor (<xref rid="bty058-B23" ref-type="bibr">Qiu <italic>et al.</italic>, 2017</xref>). TSCAN uses a cluster-based MST, improving upon the original Monocle (<xref rid="bty058-B15" ref-type="bibr">Ji and Ji, 2016</xref>). Other tools include DPT, which uses diffusion-like random walks (<xref rid="bty058-B12" ref-type="bibr">Haghverdi <italic>et al.</italic>, 2016</xref>), Mpath, which uses neighborhood-based cell state transitions (<xref rid="bty058-B7" ref-type="bibr">Chen <italic>et al.</italic>, 2016</xref>) and TASIC, which uses a probabilistic graphical model (<xref rid="bty058-B24" ref-type="bibr">Rashid <italic>et al.</italic>, 2017</xref>).</p>
    <p>The metaphorical epigenetic landscape conceived by Waddington is frequently used to depict or describe cell fate decision-making processes (<xref rid="bty058-B19" ref-type="bibr">Mojtahedi <italic>et al.</italic>, 2016</xref>; <xref rid="bty058-B20" ref-type="bibr">Moris <italic>et al.</italic>, 2016</xref>). As yet however, producing robust hierarchical lineage maps between cell states, and determining their corresponding transition probabilities, remains challenging. Motivated in part by such Waddington-like landscapes, recent works have sought to quantify cell fate processes such as differentiation, either using entropy to measure the current state of a cell: SCENT (<xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>); StemID (<xref rid="bty058-B9" ref-type="bibr">Grun <italic>et al.</italic>, 2016</xref>); SLICE (<xref rid="bty058-B11" ref-type="bibr">Guo <italic>et al.</italic>, 2017</xref>); Dpath (<xref rid="bty058-B8" ref-type="bibr">Gong <italic>et al.</italic>, 2017</xref>); or by mapping cells to a landscape: HopLand (<xref rid="bty058-B10" ref-type="bibr">Guo and Zheng, 2017</xref>); Topslam (<xref rid="bty058-B41" ref-type="bibr">Zwiessele and Lawrence, 2017</xref>). These methods provide means to characterize the cell fate landscape. For example SLICE and SCENT both quantify differentiation potency, and are able to infer initial cell states a priori and without the need for feature selection. SCENT estimates the signaling entropy of single cells in the context of an interaction network (<xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>); a particular strength of this method, and one that we will incorporate into our method development below.</p>
    <p>Here we introduce <bold>s</bold>ingle <bold>c</bold>ell <bold>E</bold>nergy path (scEpath): a method for mapping the quantitative energy landscape of single-cell dynamical processes using statistical physics modeling, such that we can obtain transition probabilities between cell states, reconstructed lineages and pseudotemporal ordering of cells. scEpath requires neither feature selection nor the number of branches in the trajectory to be specified, and can predict initial states by inferring direction based on physical principles, i.e. that the energy will decrease towards a minimum at equilibrium (although in biology equilibria may never be reached).</p>
    <p>Current methods for scRNA-seq analysis focus of variation between isolated genes, i.e. without accounting for statistical dependencies between genes (<xref rid="bty058-B1" ref-type="bibr">Babtie <italic>et al.</italic>, 2017</xref>; <xref rid="bty058-B27" ref-type="bibr">Tanay and Regev, 2017</xref>). Underpinning our algorithm is consideration of such gene interactions within local neighborhoods, which are input to estimate the single-cell energy (scEnergy) within the context of a gene network. Similarity between (groups of) cells and thus the quantitative energy landscape can then be inferred. In order to infer the cell state lineage and transition probabilities, we combine scEnergy with a distance-based measure. scEpath also performs downstream analyses including identification of marker genes and transcription factors important for specific cell clusters over pseudotime.</p>
    <p>The rest of the paper is organized as follows: in the next section we summarize the methods used in scEpath (full details of the methods are given in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). We then assess the performance of scEpath on a simulated dataset and three biological scRNA-seq datasets studying human early embryo development, lung epithelial development and myoblast differentiation. We assess scEpath against current state-of-the-art tools, and conclude with a discussion.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>scEpath takes <italic>X</italic> = (<italic>x<sub>ij</sub></italic>) as input, where <italic>X</italic> is an expression matrix in which columns correspond to cells and rows correspond to genes/transcripts. Each element of <italic>X</italic> gives the expression (e.g. TPM, FPKM or UMI values) of a gene/transcript in a given cell. We take the log2-transform, i.e. log2(<italic>X </italic>+<italic> </italic>1), and for convenience, we still denote this preprocessed expression matrix by <italic>X</italic>. scEpath then calculates the energy landscape, cell state transition probabilities, pseudotime and pseudotime-dependent maker genes. A schematic description of the steps of the scEpath algorithm is given in <xref ref-type="fig" rid="bty058-F1">Figure 1</xref>, an overview is below, and detailed description is given in <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>.
</p>
    <fig id="bty058-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of scEpath. (<bold>A</bold>) Given a gene expression matrix as input, scEpath first constructs a gene-gene interaction network, then learns a cell-cell similarity matrix using an unsupervised clustering method. Through a combination of statistical physics modeling of single cell energy and principal component analysis, gene expression patterns are then mapped on to energy landscapes, and a cell-state probabilistic transition matrix is inferred. Cell lineages are inferred by finding the maximum probability flow in the energy-directed probabilistic graph. The pseudotemporal ordering is constructed by projecting cells onto the principal curve embedded in the first two principal components and re-ordering the cells according to the position of projection points. (<bold>B</bold>) Downstream analyses that scEpath can perform to reveal additional molecular and functional mechanisms</p>
      </caption>
      <graphic xlink:href="bty058f1"/>
    </fig>
    <sec>
      <title>2.1 Construction of a gene-gene interaction network</title>
      <p>scEpath infers a correlation-based interaction network between genes, i.e. a network with <italic>n</italic> nodes (genes) that is specified by its adjacency matrix <italic>A</italic> = (<italic>a<sub>ik</sub></italic>), where <italic>a<sub>ik</sub></italic>takes value 1 or 0 depending on the presence whether nodes <italic>i</italic> and <italic>k</italic> are linked or not (See <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Calculation of single cell energy (scEnergy)</title>
      <p>Waddington’s epigenetic landscape is an abstract metaphor frequently used to describe lineage specification and cell fate decisions (<xref rid="bty058-B17" ref-type="bibr">Li <italic>et al.</italic>, 2016</xref>; <xref rid="bty058-B20" ref-type="bibr">Moris <italic>et al.</italic>, 2016</xref>), however the question of whether such a landscape can be mapped out quantitatively to infer transition probabilities between cell states and cellular trajectories remains largely unanswered. To address this question and better understand the relationship between gene expression stochasticity and phenotypic variability, we employed a statistical physics-based approach to quantitatively measure developmental states of single cells. The state of a cell <italic>j</italic> containing <italic>n</italic> genes is represented by a random vector <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>Y<sub>ij</sub></italic> indicates the expression of gene <italic>i</italic> in cell <italic>j</italic>. <bold>Y</bold><italic><sub>j</sub></italic>is then modeled by the Boltzmann–Gibbs distribution: <inline-formula id="IE601"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>p<sub>j</sub></italic>(y) is the probability that a system will be in a cell state <italic>j</italic> with the gene expression pattern y, <italic>E<sub>j</sub></italic>(y) is the scEnergy of cell <italic>j</italic> and <italic>m</italic> is the number of states accessible to the system, e.g. the number of cells.</p>
      <p>Current methods for single cell analysis mostly do not consider statistical dependencies among genes (<xref rid="bty058-B1" ref-type="bibr">Babtie <italic>et al.</italic>, 2017</xref>; <xref rid="bty058-B16" ref-type="bibr">Jin <italic>et al.</italic>, 2017</xref>; <xref rid="bty058-B27" ref-type="bibr">Tanay and Regev, 2017</xref>). It is however reasonable to assume that if the energy of a gene depends on its expression, then it should also depend on the expression levels of genes that are closely interacting with it. Furthermore, gene expression is more promiscuous in multipotent cells, becoming restricted in differentiated cells (<xref rid="bty058-B2" ref-type="bibr">Banerji <italic>et al.</italic>, 2013</xref>; <xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>; <xref rid="bty058-B40" ref-type="bibr">Zipori, 2004</xref>). This restriction that occurs during differentiation results in decreases in energy, as genes have fewer neighboring ‘on’ genes. Thus, given the level of functional interdependency between molecular components in a cell, following the logic of (<xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>) we defined an energy function incorporating nearest-neighbor correlations based on maximum-entropy and statistical thermodynamics (<xref rid="bty058-B22" ref-type="bibr">Presse <italic>et al.</italic>, 2013</xref>; <xref rid="bty058-B25" ref-type="bibr">Rietman <italic>et al.</italic>, 2017</xref>):
<disp-formula id="E2"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>y<sub>ij</sub></italic>represents the normalized expression level (rescaled between 0 and 1) of gene <italic>i</italic> in cell <italic>j</italic> and <italic>N</italic>(<italic>i</italic>) is the neighborhood of node <italic>i</italic> (including <italic>i</italic>) in the network. We define <italic>E<sub>ij</sub></italic>(<italic>y</italic>) = 0 when <italic>y<sub>ij</sub></italic> = 0. In addition, this model shows that not only each cell has an associated value representing its scEnergy (<italic>E<sub>j</sub></italic>), but also each gene is assigned a local energy state <italic>E<sub>ij</sub></italic>. We define the normalized scEnergy as:
<disp-formula id="E3"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE2"><mml:math id="IM3"><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the average scEnergy across all the cells; the normalized scEnergy is used throughout scEpath.</p>
    </sec>
    <sec>
      <title>2.3 Energy landscape visualization via principal component analysis and structural clustering</title>
      <p>To visualize the energy landscape, scEpath performs Principal Component Analysis (PCA) on the energy matrix <italic>E</italic> = (<italic>E<sub>ij</sub></italic>). We then fit a surface using piecewise linear interpolation over the first two PCA components and energy of each cell. In addition, we plot scEnergy against energy distance, which is defined as the distance (L1 norm) from the cell with the maximum scEnergy to each other cell in the low-dimensional space. To identify the cell states, scEpath performs structural clustering using an unsupervised framework called single-cell interpretation via multikernel learning (SIMLR) (<xref rid="bty058-B35" ref-type="bibr">Wang <italic>et al.</italic>, 2017</xref>). scEpath uses gap properties of the eigenvalue spectrum (<xref rid="bty058-B34" ref-type="bibr">von Luxburg, 2007</xref>) to determine the number of desired clusters by analyzing the Laplacian matrix derived from the cell-to-cell similarity matrix learned by SIMLR. Generally, the number of clusters <italic>N</italic> is usually given by the value of <italic>N</italic> that maximizes the eigen-gap (difference between consecutive eigenvalues) (for full details see <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>).</p>
    </sec>
    <sec>
      <title>2.4 Inference of transition probabilities</title>
      <p>scEpath defines the metacell as the set of cells that occupies θ<sub>1</sub> percent of the total energy in each cluster, and we set θ<sub>1</sub>= 80% by default. scEpath employs Tukey's trimean (<italic>TM</italic>) to estimate the energy of a metacell: <inline-formula id="IE3"><mml:math id="IM4"><mml:mrow><mml:mi>T</mml:mi><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><sub>.</sub> The energy <inline-formula id="IE4"><mml:math id="IM5"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> of a metacell <italic>k</italic> is then the <italic>TM</italic> of the energies of the cells composing that metacell. The expression of a gene in a metacell is the <italic>TM</italic> of the expression values for that gene in all cells comprising that metacell. The probability that a given system will be in metacell <italic>k</italic> with energy <inline-formula id="IE5"><mml:math id="IM6"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>can be calculated from the Boltzmann–Gibbs distribution:
<disp-formula id="E4"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>j</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>N</italic> is the number of metacells. The probability <inline-formula id="IE6"><mml:math id="IM7"><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> that the system leaves this metacell is thus <inline-formula id="IE7"><mml:math id="IM8"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Next we assume that the probability of entering a state <italic>l</italic> from state <italic>k</italic> is inversely proportional to the pair-wise distance in reduced dimensional space. Since we argue that any distance-based transition probability should be symmetrical, we define a symmetrical transition matrix <inline-formula id="IE8"><mml:math id="IM9"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sym</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> based on pair-wise distances between metacells, which is given by:
<disp-formula id="E5"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sym</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>π</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">asym</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>π</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>π</italic> is the stationary distribution for the asymmetrical transition matrix <inline-formula id="IE9"><mml:math id="IM10"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">asym</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>that is derived using the Markov chains theory (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). Combining <xref ref-type="disp-formula" rid="E4">Eqs. (3)</xref> and <xref ref-type="disp-formula" rid="E5">(4)</xref>, scEpath defines the transition probability <italic>T<sub>kl</sub></italic> between metacell <italic>k</italic> and metacell <italic>l</italic> as follows:
<disp-formula id="E6"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sym</mml:mi></mml:mrow></mml:msubsup><mml:mtext>    </mml:mtext><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mtext>               </mml:mtext><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.5 Inference of cell lineage hierarchy via probabilistic directed graph construction</title>
      <p>scEpath constructs a probabilistic directed graph in which nodes represent metacells and edges connecting metacells are weighted by the transition probability between these metacells. Each metacell has an associated energy, and edge direction on the graph is inferred by comparing metacell energies. Since energy is expected to decrease during developmental processes, directionality of the edges is determined by significant decreases in energy; here significance is determined by a two-sided Wilcoxon rank-sum test, where the null hypothesis states that energies of the cells included in the metacells under comparison have equal medians. scEpath rejects the null hypothesis at the α significance level (Default: α = 0.01). If it fails to reject the null hypothesis, the edge is marked as bidirectional. Taken together, the weighted matrix <italic>W</italic> of the inferred probabilistic directed graph is given by
<disp-formula id="E7"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sym</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mtext> if  </mml:mtext><mml:mi>P</mml:mi><mml:mtext>-value(</mml:mtext><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mtext>)</mml:mtext><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mtext> </mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>                          or </mml:mtext><mml:mi>P</mml:mi><mml:mtext>-value(</mml:mtext><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mtext>)</mml:mtext><mml:mo>≥</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mtext>           </mml:mtext><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE10"><mml:math id="IM11"><mml:mrow><mml:mi>P</mml:mi><mml:mo>-</mml:mo><mml:mtext>value</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> indicates <italic>P</italic>-value returned from the two-sided Wilcoxon rank sum test of metacells <italic>k</italic> and <italic>l</italic>.</p>
      <p>In the probabilistic directed graph derived by scEpath, some connections (particularly those with low transition probabilities) can be artifacts due the unavoidable technical noise in single-cell experiments (<xref rid="bty058-B27" ref-type="bibr">Tanay and Regev, 2017</xref>), to account for which, scEpath removes the connections with low transition probabilities by learning a maximum probability flow in the probabilistic directed graph defined by a weighted matrix <italic>W</italic>. This problem is equivalent to find a minimum directed spanning tree (MDST) by setting the edge weights to be 1-<italic>W</italic>. A MDST rooted at <italic>r</italic> is a directed spanning tree rooted at <italic>r</italic> of minimum weights. scEpath determines the root node (initial state) as the metacell with highest energy. As this method tends to connect metacells that are close (measured by high transition probability, i.e. high expression similarity) to each other to achieve the maximum probability flow and minimal number of edges, the resulting tree approximates the cell state transition network.</p>
    </sec>
    <sec>
      <title>2.6 Reconstruction of pseudotime</title>
      <p>Once the cell lineage structure has been determined, scEpath reconstructs pseudotime by ordering individual cells along developmental trajectories. scEpath orders cells separately for each lineage branch via a principal curve-based approach. A smooth one-dimensional curve that passes through the middle of the data in reduced dimensional space is fit. Each cell is projected onto the principal curve such that the projected point is closest to the cell in an orthogonal sense. In this way, all cells can be placed in order according to the projected positions. Once cells are ordered, pseudotime is computed for each lineage path. Then scEpath rescales the pseudotime such that it is bounded in [0, 1].</p>
      <p>To measure the accuracy of the reconstructed pseudotime based on the ordering expected by independent sources of information (e.g. true data collection time), we define a pseudotime reconstruction score (PRS)
<disp-formula id="E8"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>c</italic> and <italic>c′</italic> are the number of concordant and disconcordant pairs of cells, respectively.</p>
    </sec>
    <sec>
      <title>2.7 Discovery of molecular and functional mechanisms responsible for cell fate decisions</title>
      <p>scEpath also identifies pseudotime-dependent marker genes that are significantly changed along pseudotime by creating a smoothed version of gene expression. To discover key transcription factor programs responsible for cell states and state transitions during development, we first collected the TFs that are annotated in the Animal Transcription Factor Database (AnimalTFDB 2.0) (<xref rid="bty058-B37" ref-type="bibr">Zhang <italic>et al.</italic>, 2015</xref>) among the identified pseudotime-dependent genes. scEpath then declares potentially important TFs for directing cell fate choices if these TFs are differentially expressed between consecutive clusters on one lineage path. In addition, transcription factor regulatory networks are inferred to study cell-state transitions at the network level. Moreover, multiscale transition dynamics can be explored using scEpath by performing hierarchical clustering of pseudotime-dependent genes and functional enrichment analysis of the derived gene clusters (See details in <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We tested the performance of scEpath using a simulated dataset (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 1 and Fig. S1</xref>) and three independent published scRNA-seq datasets that have been previously used for comparison and validation of pseudotime inference. These consist of cells from human early embryos (HEE) (GSE36552) (<xref rid="bty058-B36" ref-type="bibr">Yan <italic>et al.</italic>, 2013</xref>), from mouse lung epithelium specification (LES) (GSE52583) (<xref rid="bty058-B31" ref-type="bibr">Treutlein <italic>et al.</italic>, 2014</xref>) and from human skeletal muscle myoblasts (HSMM) (GSE52529) (<xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>).</p>
    <sec>
      <title>3.1 scEpath identifies transcriptional dynamics on multiple scales during human early embryo development</title>
      <p>To test the effectiveness of scEpath, we first used scRNA-seq data consisting of 88 cells from seven stages (from oocytes to blastocyst) in human early embryos (HEE) (<xref rid="bty058-B36" ref-type="bibr">Yan <italic>et al.</italic>, 2013</xref>). To construct a gene co-expression network, we investigated the relationship between the number of nodes (genes)/edges and the threshold, and chose the highest threshold without a significant reduction in the total number of genes of the constructed network. We hence selected a threshold 0.5, giving a network consisting of 16, 664 genes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). Then the scEnergy of each cell is calculated using <xref ref-type="disp-formula" rid="E2">Eqs. (1)</xref> and <xref ref-type="disp-formula" rid="E3">(2)</xref>, and visualized using principal components (<xref ref-type="fig" rid="bty058-F2">Fig. 2A</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11A</xref>). Unsupervised clustering identified six metacells (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8A</xref>); of these six, one comprises oocytes, zygotes and 2-cell embryos, the 4-cell, 8-cell and morula stages cluster into distinct metacells, and two metacells represent the late blastocyst stage (<xref ref-type="fig" rid="bty058-F2">Fig. 2A and B</xref>). <xref ref-type="fig" rid="bty058-F2">Figure 2C–E</xref> depict the 3D energy path, showing how cells transition from oocytes to blastocysts along landscape ‘valleys’.
</p>
      <fig id="bty058-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>scEpath reconstructed the developmental lineage and a high-resolution view of the transcriptional programs of human early embryos. (<bold>A</bold>) Cells visualized on the first two principal components, colored by their experimentally verified developmental stage. (<bold>B</bold>) Cells are colored according to unsupervised clustering. Cell size is proportional to scEnergy. (<bold>C</bold>) Overall energy landscape view in 3D. The developmental trajectories are shown by a curve: white indicates initial and blue indicates later stages. (<bold>D</bold>) Energy landscape view from another aspect, showing the transition path during late stages. (<bold>E</bold>) Contour plot of the energy landscape: solid blue line denotes actual transition path; dashed blue lines indicate other possible paths according to the locations of landscape ‘valleys’; numbers represent transition probabilities between two metacells. (<bold>F</bold>) Cells visualized on the scEnergy distance–scEnergy space (the distance was normalized). Inset: Comparison of energy distributions among the identified cell clusters. ‘***’: <italic>P</italic>-value &lt; 0.001, ‘*’: 0.01 &lt; <italic>P</italic>-value &lt; 0.05, ‘n.s.’: not significant. (<bold>G</bold>) Left panel: ‘Rolling wave’ plot shows the normalized-smoothed expression pattern of pseudotime-dependent genes (<italic>n</italic> = 9545) clustered into nine groups (I–IX). Right panel: Average expression of the nine gene clusters along pseudotime. (<bold>H</bold>) Transcriptional factor co-expression network, showing putative activating (inhibiting) relationships according to significant positive (negative) correlations. The node size is proportional to their betweenness centrality reflecting the contribution to the communication between two subnetworks. (<bold>J</bold>) scEpath revealed a linear lineage in which transition probabilities are shown and node size corresponds to the energy (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="bty058f2"/>
      </fig>
      <p>Significant decreases were found at each consecutive step from C2 to C6, however we found no significant differences between the energy distributions of the first two metacells C1 and C2 (by a two-sided Wilcoxon rank sum test, <xref ref-type="fig" rid="bty058-F2">Fig. 2F</xref> Inset). In an attempt to resolve the difference between C1 and C2, we plot the scEnergy distance against the scEnergy, which suggests a separation between these two clusters in this two-dimensional space (<xref ref-type="fig" rid="bty058-F2">Fig. 2F</xref>). We also used SCENT to calculate the signaling entropy for C1 and C2, and found that it was higher for C1 than C2, although this difference was not significant (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S30A</xref>). If we compare these results to the original data, we see that C1 contains oocytes, thus does indeed represent the initial state. Although the energy landscape is immediately suggestive of permissible transitions (e.g. by following valleys from C1/C2 to C5, or from C3 to C6; <xref ref-type="fig" rid="bty058-F2">Fig. 2E</xref>), we find that the lineage is best determined by combining the energy landscape with a transition matrix. The resulting transition probabilities that scEpath predicts indicate that the probabilities of transitions from C2 to C3, and from C3 to C4, are much higher than the examples listed above (i.e. C2 to C5, or C3 to C6) (<xref ref-type="fig" rid="bty058-F2">Fig. 2E</xref>). scEpath then predicted a linear lineage from C1 to C6 [the stable state which had the lowest scEnergy and the largest metacell probability (probability of remaining in this state)] (<xref ref-type="fig" rid="bty058-F2">Fig. 2J</xref>). This <italic>de novo</italic> reconstruction closely follows the known progression of human early embryos from oocyte to late blastocyst. Analysis of known markers collected from (<xref rid="bty058-B36" ref-type="bibr">Yan <italic>et al.</italic>, 2013</xref>) were in very good agreement with the pseudotemporal ordering predicted by scEpath, with, e.g. LIN28B, FGFR4 and CLDN10 being upregulated while DPPA3 and SALL2 are downregulated during development (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9</xref>).</p>
      <p>To investigate molecular mechanisms driving cell state transitions, scEpath identifies pseudotime-dependent marker genes along the lineage path. Hierarchical clustering of the pseudotime-dependent genes resulted in nine temporal ‘rolling wave’ clusters of transcriptional changes during development (<xref ref-type="fig" rid="bty058-F2">Fig. 2G</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S10A</xref>). Several gene clusters were downregulated on different time scales; and enriched common or specific gene function signatures can be found (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11C</xref>). Gene clusters I, III and IV were all enriched for ‘cell cycle’, while notably, gene cluster III (downregulated late), was specifically enriched for ‘neurogenesis’ and ‘chromatin modification’. Cluster V exhibited interesting transient dynamics: gradually increasing in expression until the 8-cell stage before downregulation. In human embryos the major maternal-zygotic transition happens at the 8-cell stage (<xref rid="bty058-B3" ref-type="bibr">Braude <italic>et al.</italic>, 1988</xref>). Combining clusters produces a high-resolution picture of the transcriptional spectrum in which we can identify several different time scales. Our results thus depict a detailed view of the transcriptional dynamics during human early embryo development.</p>
      <p>scEpath can be used to identify TFs important for cell state transitions, as we demonstrate here in human embryos (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S10C</xref>). The temporal expression dynamics of 40 representative TFs are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S11B</xref>, suggesting continuously transcription regulatory profiles during embryonic development. scEpath found that several well known pre-implantation-specific regulators such as UBTFL1, NANOG, SOX2, KLF4 and GATA2 were successively upregulated along this lineage path. In addition, scEpath also predicted novel TFs, such as ZNF736, KLF10, IRX5 and SNAI1, which exhibited very similar expression pattern to known TFs and thus represent attractive targets for future studies. Finally, we constructed a TF regulation network based on pairwise correlation of expression levels across all stages of development (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). This revealed three densely connected subnetworks, regulating early, intermediate and late development respectively (<xref ref-type="fig" rid="bty058-F2">Fig. 2H</xref>).</p>
    </sec>
    <sec>
      <title>3.2 scEpath infers a branched lineage during murine lung development, with branch-specific transcriptional patterns</title>
      <p>Next, we applied scEpath to data describing the development of mouse lung epithelium. Cells were collected from embryonic mouse lung at four developmental stages: E14.5, E16.5, E18.5 and adult (<xref rid="bty058-B31" ref-type="bibr">Treutlein <italic>et al.</italic>, 2014</xref>), totaling 155 cells. We studied cells comprising the mouse lung alveolar type 2 (AT2) branch in isolation, to investigate the development of this lineage branch before considering the full system (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 2 and Figs S12–S14</xref>).</p>
      <p>Applying scEpath to all the full dataset (155 epithelial cells), we identified six metacells including various progenitors and differentiated cell types: early EPs (early progenitor), late EPs, BPs (bipotential progenitors), AT1, nascent AT2 and mature AT2 (<xref ref-type="fig" rid="bty058-F3">Fig. 3B</xref>, see details in <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 3</xref>), which is good agreement with previous studies (<xref rid="bty058-B31" ref-type="bibr">Treutlein <italic>et al.</italic>, 2014</xref>). The energy landscape (<xref ref-type="fig" rid="bty058-F3">Fig. 3C</xref>) shows a path from the highest cells in C1 (early EPs), through C2 (late EPs) and C3 (BPs), to the lowest wells denoting C4 (AT1) and C6 (mature AT2); with statistically significant differences between clusters (<xref ref-type="fig" rid="bty058-F3">Fig. 3F</xref> Inset). Therefore, energy landscapes define the developmental and cellular hierarchy of the distal mouse lung epithelium, suggesting the potential paths for the maturation of progenitors along both AT1 and AT2 lineages. Although there is no significant scEnergy difference between C3 and C4, we observed a significant difference in the scEnergy distance (<xref ref-type="fig" rid="bty058-F3">Fig. 3F</xref>), suggesting that C4 constitutes a distinct branch, bifurcating from C5/C6 at C3. We also calculated the signaling entropies of C3 and C4 using SCENT (<xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>), and found that significant difference of signaling entropies was observed (<italic>P</italic>-value &lt; 0.001) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S30C</xref>). Furthermore, scEpath inferred AT1 and AT2 lineages emerging from a common BP (<xref ref-type="fig" rid="bty058-F3">Fig. 3G</xref>), which is spread on the landscape (<xref ref-type="fig" rid="bty058-F3">Fig. 3D</xref>). Each lineage exhibited consistently decreased energies during differentiation. Moreover, scEpath revealed that there is a higher probability of differentiation from BPs into AT1 lineage than to AT2 lineage, which is consistent with the facts that cells in clusters C3 and C4 are from the same developmental stage (E18.5) and that the scEnergies between them are similar.
</p>
      <fig id="bty058-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>scEpath reconstructed a branched lineage and their distinct transcriptional spectrum during lung epithelial specification. (<bold>A</bold>) Cells colored by unsupervised clustering. (<bold>B</bold>) Expression levels of known markers. (<bold>C</bold>) Overall energy landscape view in 3D. (<bold>D</bold>) Zoom in on to cells surrounding the branching point on the energy landscape; the oval indicates cells on a ‘flat’ part of the landscape, suggestive of a transition state. (<bold>E</bold>) Contour plot of the energy landscape. Dashed blue lines indicate another possible path. (<bold>F</bold>) Cells visualized on the scEnergy distance–scEnergy space. Inset: Comparison of energy distribution. (<bold>G</bold>) scEpath revealed a branched lineage path in which transition probabilities are shown. (<bold>H</bold>) Left panel: ‘Rolling wave’ plot of pseudotime-dependent genes (<italic>n</italic> = 2159) clustered into eight groups (I–VIII). Right panel: Average expressions of the gene clusters along pseudotime in AT1 and AT2 path respectively. (<bold>J</bold>) Smoothed expression pattern of the identified TFs. TFs indicated by a triangle have been previously described as relevant for lung epithelial specification (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="bty058f3"/>
      </fig>
      <p>scEpath found eight temporal ‘rolling wave’ clusters of transcriptional changes during lung epithelial specification (<xref ref-type="fig" rid="bty058-F3">Fig. 3H</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S15A</xref>). Three clusters (V, VI and VIII) of genes showed distinct expression kinetics along the AT1 versus AT2 branches while the remaining clusters followed very similar dynamical trends on both branches. In addition, enriched common or specific gene function signatures can also be discovered (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 3 and Fig. S17</xref>).</p>
      <p>Moreover, scEpath revealed 32 TFs important for state transitions. <xref ref-type="fig" rid="bty058-F3">Figure 3J</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S15B</xref> demonstrated that the differentiation process is accurately regulated by cell state-specific TFs. Several well-known regulators such as Smad5, Sox11, Sox9 and Hmga1-rs1 were rapidly downregulated in progenitor cells of both lineages. We also observed switch-like inactivation of several TFs such as Id1, Foxp2, Arid4b, Kdm5b and Gtf2i, which are the potential critical events in the differentiation of progenitors and lead to the activation of key regulators (e.g. Klf5, Hopx, Tead1 and Runx1) in AT1 path and key regulators (e.g. Etv5) in AT2 path. Attractively, a recent study demonstrated that Etv5 is essential for the maintenance of AT2 cells and deletion of Etv5 from AT2 cells produced gene and protein signatures characteristic of differentiated AT1 cells (<xref rid="bty058-B38" ref-type="bibr">Zhang <italic>et al.</italic>, 2017</xref>). In addition, several regulators (e.g. Runx1, Foxn2, Foxn3, Klf5, Id3) have been shown to play critical roles in differentiation (<xref rid="bty058-B18" ref-type="bibr">Logan <italic>et al.</italic>, 2015</xref>; <xref rid="bty058-B33" ref-type="bibr">Ustiyan <italic>et al.</italic>, 2012</xref>), but no studies reported their roles in mouse lung epithelial specification (see details in <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 3</xref>).</p>
    </sec>
    <sec>
      <title>3.3 scEpath reveals the myoblast differentiated trajectory and pinpoints the timing of key regulatory events</title>
      <p>We applied scEpath to the differentiation of 271 primary human skeletal muscle myoblasts (HSMM) captured using scRNA sequencing. scEpath identified four metacells including: two clusters (C1 and C4) that expressed markers of actively proliferating cells such as CDK1 and CDC20, one cluster (C2) that expressed markers of myogenesis such as MYOG and ENO3, and finally one cluster (C3) that lacked myogenic markers but expressed PDGFRA and PLD1 (<xref ref-type="fig" rid="bty058-F4">Fig. 4B</xref>), suggesting that they are interstitial mesenchymal cells (<xref rid="bty058-B7" ref-type="bibr">Chen <italic>et al.</italic>, 2016</xref>; <xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>).
</p>
      <fig id="bty058-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>scEpath revealed the myoblast differentiated trajectory and pinpointed the timing of key regulatory events of myoblast differentiation. (<bold>A</bold>) Cells colored by unsupervised clustering. (<bold>B</bold>) Expression levels of known markers in each cluster. (<bold>C</bold>) Overall energy landscape view in 3D. (<bold>D</bold>) Inferred lineage path in which transition probabilities are shown. C3 was not shown because only path C1-C4-C2 differentiated into muscle cells while C3 contained contaminating interstitial mesenchymal cells. (<bold>E</bold>) Comparison of expression patterns of pseudotime-dependent genes (<italic>n</italic> = 1116; clustered into five groups: I–V) between cluster C3 (left; cells are randomly ordered) and muscle path (middle; cells are ordered according to pseudotime). Right panel: Average expressions of the five gene clusters along pseudotime in muscle path. (<bold>F</bold>) Smoothed expression pattern of the important TFs delineated by scEpath (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="bty058f4"/>
      </fig>
      <p>The energy landscape of myoblast differentiation (<xref ref-type="fig" rid="bty058-F4">Fig. 4C</xref>) shows high heterogeneity, suggesting a complex interplay of cellular processes including proliferation and differentiation. Statistical tests indicate significant decreases of energy from C1 to C4 or C3 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S18A</xref>). The scEnergy distance–scEnergy plot suggests a transition path from C1, through C4, to C2 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S18</xref>). scEpath predicted a branched lineage starting from C1: with one branch corresponding to myoblast specification (C4 and C2), and the other proceeding from C1 to C3. Analysis highlighted that C3 is composed of contaminating interstitial mesenchymal cells, which were excluded from further analyses in the original work (<xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>) as well as other studies (<xref rid="bty058-B11" ref-type="bibr">Guo <italic>et al.</italic>, 2017</xref>; <xref rid="bty058-B15" ref-type="bibr">Ji and Ji, 2016</xref>). Thus, we remove C3 from further analyses.</p>
      <p>scEpath revealed two gene clusters (IV and V) that strongly mark for myoblast differentiation, by comparing expression patterns of myogenic branch with cluster C3 (<xref ref-type="fig" rid="bty058-F4">Fig. 4E</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S19 and S20</xref>). Functional enrichment analysis identified established gene function signatures (e.g. muscle development processes and muscle cell differentiation) in gene clusters IV and V (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 4 and Fig. S18D</xref>). In addition, scEpath identified 31 TFs as important for cell state transitions (<xref ref-type="fig" rid="bty058-F4">Fig. 4F</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S20B</xref>). Several regulators such as MYOG, MYF5, MYF6, HES6 and ID2 have been previously demonstrated as critical in regulating myogenic differentiation (<xref rid="bty058-B4" ref-type="bibr">Buckingham and Rigby, 2014</xref>; <xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>). <xref ref-type="fig" rid="bty058-F4">Figure 4F</xref> shows that they were significantly upregulated in muscle path while downregulated in non-muscle path. HMGB2 exhibited immediate downregulation, consistent with previous findings that an HMGB2 knockdown inhibited myoblast proliferation and stimulated differentiation (<xref rid="bty058-B39" ref-type="bibr">Zhou <italic>et al.</italic>, 2016</xref>). We predict several novel TFs to also be important here due to their similarity in expression pattern with HMGB2, including HMGB3, MYBL2, E2F7, POU5F1 and FOXM1. Moreover, we observed switch-like inactivation of several TFs, such as MYF5, ID2 and SOX11, which are the potential critical events in the muscle differentiation and lead to the activation of key regulators (e.g. HES6, MYOG and KLF5). A previous study showed that switch-like inactivation of ID1 leads to the activation of MYOG (<xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>). More recently, it was demonstrated that Klf5 regulated muscle differentiation by directly targeting muscle-specific genes in cooperation with MyoD in mice (<xref rid="bty058-B13" ref-type="bibr">Hayashi <italic>et al.</italic>, 2016</xref>), suggesting that KLF5 is a promising regulator of primary human skeletal muscle myoblasts. Thus, scEpath can pinpoint the timing of key regulatory events and identify novel regulators of differentiation.</p>
    </sec>
    <sec>
      <title>3.4 Comparison of scEpath with existing algorithms for pseudotime inference</title>
      <p>We compared the performance of scEpath with four current pseudotime inference algorithms: Monocle 1/Monocle 2 (<xref rid="bty058-B23" ref-type="bibr">Qiu <italic>et al.</italic>, 2017</xref>; <xref rid="bty058-B30" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>), TSCAN (<xref rid="bty058-B15" ref-type="bibr">Ji and Ji, 2016</xref>) and DPT (<xref rid="bty058-B12" ref-type="bibr">Haghverdi <italic>et al.</italic>, 2016</xref>) on the four experimental datasets discussed above. We use a combination of qualitative and quantitative measures to assess method performance; no one measure is sufficient when little is known about the biological truth. Applying current methods to the two linear trajectories (HEE data and AT2 data), all can successfully reconstruct the trajectories (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S21</xref>). For LES, only scEpath and Monocle 1/2 can separate the AT1 and AT2 branches (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S22A</xref>). For the HSMM data, only scEpath, Monocle 1/2 and TSCAN can isolate the mesenchymal cells from the myoblast lineage, while DPT failed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S22B</xref>). By comparing the pseudotime reconstruction score (PRS) of the inferred pseudotime with the true time orderings, where known, we can assess the accuracy of those methods. We found that scEpath outperformed Monocle 1 and DPT, and produced trajectories that were overall comparable in accuracy with Monocle 2 and TSCAN (<xref ref-type="fig" rid="bty058-F5">Fig. 5A</xref>).
</p>
      <fig id="bty058-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Comparison of scEpath with existing algorithms for pseudotime inference. (<bold>A</bold>) Comparison of the accuracy of pseudotemporal ordering, measured by Pseudotime Reconstruction Score (PRS). (<bold>B</bold>) Comparison of robustness (by PRS) of pseudotemporal ordering under repeated subsampling of the cells from each dataset</p>
        </caption>
        <graphic xlink:href="bty058f5"/>
      </fig>
      <p>Next we used two measures (PRS and Pearson Correlation Coefficient) to assess the agreement between pairs of pseudotemporal ordering runs under repeated subsampling (50 times independently) of 90, 80, or 70% of the total number of cells in each dataset (<xref ref-type="fig" rid="bty058-F5">Fig. 5B</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S23</xref>). These results show that scEpath is more robust than Monocle 1/2 and TSCAN in all cases, and comparable to DPT overall (insignificant differences for HEE and AT2; outperforms DPT for LES; slightly underperforms against DPT for HSMM). We also found that scEpath produced robust results when varying the number of input genes for lineage reconstruction (<xref ref-type="supplementary-material" rid="sup1">Supplementary Note 5 and Figs S4–S7</xref>), demonstrating that feature selection is not required for successful inference here. These results show that tested against either accuracy or robustness, scEpath performs at least as well as current methods, and if we consider both measures together, then scEpath performs better than current methods. scEpath is thus able to reconstruct pseudotime robustly and (to the best of current knowledge) accurately, without feature selection.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Increasingly, distinguishing between cell types is fraught with difficulty, as data reveal new phenotypes and different cell states move closer to one another in phenotypic space (<xref rid="bty058-B20" ref-type="bibr">Moris <italic>et al.</italic>, 2016</xref>; <xref rid="bty058-B27" ref-type="bibr">Tanay and Regev, 2017</xref>). There is thus a pressing need for measures with which to distinguish between cell states. Here, by introducing the concept of single cell energy (scEnergy) and combining dimension reduction with energy landscape construction we sought to characterize such states along axes of development or lineage specification. We were able to construct 3D energy landscapes of cells, and then in combination with distance measure, we reconstructed lineages, along with cell state transition probabilities, and ordered cells along pseudotime. Downstream analyses by scEpath allow visualization of the transcriptional dynamics, and demonstrate that gene clusters (functional modules) are tightly regulated on different time scales. These outputs allow for the discovery of common and specific gene clusters, temporal dynamics and functional diversification along branched lineages.</p>
    <p>Using scEpath we identified a cell-cell communication network implicated in early human embryo specification, involving three transcriptional subnetworks (respectively for early, intermediate and late stages) with strong inhibition between subnetwork motifs and putative activation within each subnetwork. Applying scEpath to mouse lung specification, distinct gene expression dynamics and functional signatures of the two epithelial branches were revealed. Finally, we applied our methods to myoblast differentiation, and found that scEpath was able to isolate mesenchymal cells from the myoblast lineage, and identify novel transcription factors (TFs) (e.g. HMGB3, MYBL2, POU5F1) whose expression patterns closely follow those of known TFs, as well as TFs whose inactivation is strongly implicated in lineage choice (e.g. MYF5, ID2, SOX11).</p>
    <p>scEpath is broadly unsupervised, requiring few parameters to be set by the user. In the network construction, we investigated the relationship between the number of nodes (genes)/edges and the threshold, and then chose the highest threshold without a significant reduction in the total number of genes of the constructed network (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). This approach enables some network pruning (to be more conservative in determining edges) while retaining a large portion of the transcriptome for energy calculations (i.e. reducing information loss). Moreover, we systematically explored the threshold, and found that within a certain range the results derived using scEpath are most consistent and robust (<xref ref-type="supplementary-material" rid="sup1">Supplementary Note 6 and Figs S3–S7</xref>). Within this range, the networks exhibit approximate scale-free topology based on the degree distribution (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S24</xref>). The reason behind this may be related to the findings of (<xref rid="bty058-B28" ref-type="bibr">Teschendorff <italic>et al.</italic>, 2015</xref>) that reveal relationships between signaling entropy, network topology, and cell plasticity. As an alternative approach to study gene networks, rather than construct a network de novo, resources [e.g. BioGRID (<xref rid="bty058-B6" ref-type="bibr">Chatr-Aryamontri <italic>et al.</italic>, 2017</xref>)] could be used to input interaction network information. We set two parameters (θ<sub>1</sub> and θ<sub>2</sub>) to define cells within a metacell; these thresholds, set for the energy and the distance, respectively, are used to exclude outliers from the metacell. We found that scEpath is robust to these parameters (<xref ref-type="supplementary-material" rid="sup1">Supplementary Note 6 and Figs S25–S29</xref>), thus adjustment from default values ought to be rarely required.</p>
    <p>A crucial aspect of scEpath is its combination of energy-based and distance-based measures, supported by an underlying interaction network, in order to predict pseudotemporal ordering of cells and cell state transition probabilities. Drawing on the success of previous methods that incorporates network information into the calculation of cellular quantities (in the case of SCENT, signaling entropy) (<xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>), the scEnergy is calculated within the context of a larger gene network. This makes the resulting inferences much less prone to perturbation-driven variation [e.g. gene dropout (<xref rid="bty058-B21" ref-type="bibr">Pierson and Yau, 2015</xref>) or changes in the input gene sets]. We assessed what benefits the incorporation of network information could offer to scEpath, and found that both the discriminative ability and the robustness of pseudotemporal ordering were improved (<xref ref-type="supplementary-material" rid="sup1">Supplementary Note 7 and Fig. S32</xref>). Resulting from this network-based approach, scEpath achieves robust and accurate predictions of pseudotime without feature selection (<xref ref-type="fig" rid="bty058-F5">Fig. 5</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S23</xref>).</p>
    <p>In contrast to most current methods for pseudotime inference [such as Monocle 2, TSCAN, DPT, Bayesian GPLVM (<xref rid="bty058-B5" ref-type="bibr">Campbell and Yau, 2016</xref>)], scEpath seeks to infer the initial state and the direction of the trajectory without prior knowledge such as marker gene expression. Entropy-based approaches for single-cell analysis—such as SCENT and SLICE (<xref rid="bty058-B11" ref-type="bibr">Guo <italic>et al.</italic>, 2017</xref>; <xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>)—can also infer initial states. While scEpath predicts an initial state in the majority of cases, we observed in the human embryonic dataset that there was no significant scEnergy difference between clusters C1 and C2. We found higher entropies for C1 (compared with C2) using SCENT and SLICE, although these differences were also not significant (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S30A</xref>). This is probably due to the small number of cells (each cluster has only 12 cells). Automatically defining the initial state with confidence thus remains challenging in some cases, and better methods are required. Here, when differences in scEnergy are not significant, other approaches to discriminate these states include using signaling entropy (SCENT), or using marker genes to identify the most plausible initial state biologically, or indeed using other means altogether. There may also be cases for which the initial state is not unique, depending on the biological system and the question of focus (e.g. in the case of quiescent and cycling stem cells).</p>
    <p>The cellular energy landscapes constructed in scEpath imply a clear direction of flow from peaks to troughs. Comparing scEnergy with entropy-based measures (e.g. SCENT, SLICE, StemID) that have been used to successfully quantify developmental trajectories, we find high correlations between the measures proposed by SCENT and SLICE (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S30</xref>), although the transcriptomic entropy proposed in StemID seems to be less closely correlated with developmental states (especially for the HEE and AT2 data). Of note, in some cases only SCENT finds significant differences between cellular states, where other methods including scEpath cannot; for example the bipotent (C3) and AT1 (C4) populations of lung epithelium, which we expect biologically to be different (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S30C</xref>). These strengths of SCENT motivate us to use this measure to discriminate between cell states for which we do not find significant differences using scEpath alone, ameliorating the lineage inference capabilities in scEpath. Our analyses suggest that scEnergy can discriminate between pluri/multi-potent cells and less potent cells using four different datasets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Note 8 and Fig. S31</xref>). These results support the rationale—motivated by previous works (<xref rid="bty058-B2" ref-type="bibr">Banerji <italic>et al.</italic>, 2013</xref>; <xref rid="bty058-B29" ref-type="bibr">Teschendorff and Enver, 2017</xref>)—behind the use of a network-based measure to discriminate between more and less potent states (with respectively, greater or fewer signaling interactions).</p>
    <p>Additional challenges for scEpath offer much potential for future work. For HSMM data, scEpath (as well as other methods tested) inferred a link between proliferating cells and mesenchymal cells (not biologically supported). How to automatically detect and isolate contaminating cells—or in general any cells that are derived from a different source—remains challenging. A limitation of scEpath (shared by most current methods as far as we are aware) is the inability to describe trajectories involving multiple different progenitor cell populations, i.e. multiple initial states. We propose to add this capability by combination of multiple energy landscapes (this will require careful normalization). Its success will permit us to describe more complex biological processes, for example cancers including breast, oligodendroglioma and squamous cell carcinoma, for each of which multiple progenitor species are implicated (<xref rid="bty058-B32" ref-type="bibr">Tsoucas and Yuan, 2017</xref>). Here heterogeneity is known to compound analyses, and thus careful analysis of gene expression profiles for validation—as well as biological discovery—will be necessary. scEpath reports such gene expression profiles associated with pseudotime, and we find that overall there is excellent agreement between scEpath-predicted expression patterns and experimental evidence, where is it available. In addition, scEpath achieves robustness by using the full distribution of cell energies—rather than a mean value (e.g. SLICE)—to calculate differences between states. This permits generalization to more general biological processes where the energy might not be monotonically decreasing (e.g. direct reprogramming), by decreasing the significance level α in <xref ref-type="disp-formula" rid="E7">Eq. (6)</xref>), thus permitting bidirectional probabilistic graphs. The use of scEnergy to construct energy landscapes and thus infer transition probabilities is therefore warranted, and can reveal differentiation trajectories with fidelity and robustness.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported in part by the National Institute of Health [P50GM76516, R01GM107264, R01ED023050, R01NS095355, R01GM123731]; the National Science Foundation [DMS1161621, DMS1562176] and the Jayne Koskinas Ted Giovanis Foundation for Health and Policy jointly with the Breast Cancer Research Foundation.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty058_supplementary_data-revised-r1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bty058-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Babtie</surname><given-names>A.C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Learning regulatory models for cell development from single cell transcriptomic data</article-title>. <source>Curr. Opin. Syst. Biol</source>., <volume>5</volume>, <fpage>72</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="bty058-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Banerji</surname><given-names>C.R.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Cellular network entropy as the energy potential in Waddington's differentiation landscape</article-title>. <source>Sci. Rep</source>., <volume>3</volume>, <fpage>3039</fpage>.<pub-id pub-id-type="pmid">24154593</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Braude</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>1988</year>) 
<article-title>Human gene expression first occurs between the four- and eight-cell stages of preimplantation development</article-title>. <source>Nature</source>, <volume>332</volume>, <fpage>459</fpage>–<lpage>461</lpage>.<pub-id pub-id-type="pmid">3352746</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buckingham</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Rigby</surname><given-names>P.W.J.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Gene regulatory networks and transcriptional mechanisms that control myogenesis</article-title>. <source>Dev. Cell</source>, <volume>28</volume>, <fpage>225</fpage>–<lpage>238</lpage>.<pub-id pub-id-type="pmid">24525185</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>K.R.</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Order under uncertainty: robust differential expression analysis using probabilistic models for pseudotime inference</article-title>. <source>PLoS Comput. Biol</source>., <volume>12</volume>, <fpage>e1005212.</fpage><pub-id pub-id-type="pmid">27870852</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chatr-Aryamontri</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>The BioGRID interaction database: 2017 update</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D369</fpage>–<lpage>D379</lpage>.<pub-id pub-id-type="pmid">27980099</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Mpath maps multi-branching single-cell trajectories revealing progenitor cell progression during development</article-title>. <source>Nat. Commun</source>., <volume>7</volume>, <fpage>11988</fpage>.<pub-id pub-id-type="pmid">27356503</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gong</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Dpath software reveals hierarchical haemato-endothelial lineages of Etv2 progenitors based on single-cell transcriptome analysis</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14362</fpage>.<pub-id pub-id-type="pmid">28181481</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grun</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>De novo prediction of stem cell identity using single-cell transcriptome data</article-title>. <source>Cell Stem Cell</source>, <volume>19</volume>, <fpage>266</fpage>–<lpage>277</lpage>.<pub-id pub-id-type="pmid">27345837</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Zheng</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>) 
<article-title>HopLand: single-cell pseudotime recovery using continuous Hopfield network-based modeling of Waddington's epigenetic landscape</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>i102</fpage>–<lpage>i109</lpage>.<pub-id pub-id-type="pmid">28881967</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>SLICE: determining cell differentiation and lineage based on single cell entropy</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>e54</fpage>.<pub-id pub-id-type="pmid">27998929</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haghverdi</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>845</fpage>–<lpage>848</lpage>.<pub-id pub-id-type="pmid">27571553</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hayashi</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Klf5 regulates muscle differentiation by directly targeting muscle-specific genes in cooperation with MyoD in mice</article-title>. <source>Elife</source>, <volume>5</volume>, <fpage>e17462.</fpage><pub-id pub-id-type="pmid">27743478</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Islam</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Characterization of the single-cell transcriptional landscape by highly multiplex RNA-seq</article-title>. <source>Genome Res</source>., <volume>21</volume>, <fpage>1160</fpage>–<lpage>1167</lpage>.<pub-id pub-id-type="pmid">21543516</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ji</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Ji</surname><given-names>H.</given-names></name></person-group> (<year>2016</year>) 
<article-title>TSCAN: pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>e117</fpage>.<pub-id pub-id-type="pmid">27179027</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jin</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Domain control of nonlinear networked systems and applications to complex disease networks</article-title>. <source>Discrete Contin. Dyn. Syst. Ser. B</source>, <volume>22</volume>, <fpage>2169</fpage>–<lpage>2206</lpage>.</mixed-citation>
    </ref>
    <ref id="bty058-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Quantifying the landscape and kinetic paths for epithelial-mesenchymal transition from a core circuit</article-title>. <source>Phys. Chem. Chem. Phys</source>., <volume>18</volume>, <fpage>17949</fpage>–<lpage>17956</lpage>.<pub-id pub-id-type="pmid">27328302</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Logan</surname><given-names>T.T.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Runx1 promotes proliferation and neuronal differentiation in adult mouse neurosphere cultures</article-title>. <source>Stem Cell Res</source>., <volume>15</volume>, <fpage>554</fpage>–<lpage>564</lpage>.<pub-id pub-id-type="pmid">26473321</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mojtahedi</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Cell fate decision as high-dmensional critical state transition</article-title>. <source>PLoS Biol</source>., <volume>14</volume>, <fpage>e2000640</fpage>.<pub-id pub-id-type="pmid">28027308</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moris</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Transition states and cell fate decisions in epigenetic landscapes</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>693</fpage>–<lpage>703</lpage>.<pub-id pub-id-type="pmid">27616569</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pierson</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>) 
<article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>241.</fpage><pub-id pub-id-type="pmid">26527291</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Presse</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Principles of maximum entropy and maximum caliber in statistical physics</article-title>. <source>Rev. Mod. Phys</source>., <volume>85</volume>, <fpage>1115</fpage>–<lpage>1141</lpage>.</mixed-citation>
    </ref>
    <ref id="bty058-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Qiu</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>979</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">28825705</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rashid</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>TASIC: determining branching models from time series single cell data</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2504</fpage>–<lpage>2512</lpage>.<pub-id pub-id-type="pmid">28379537</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rietman</surname><given-names>E.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Personalized anticancer therapy selection using molecular landscape topology and thermodynamics</article-title>. <source>Oncotarget</source>, <volume>8</volume>, <fpage>18735</fpage>–<lpage>18745</lpage>.<pub-id pub-id-type="pmid">27793055</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) Exponential scaling of single-cell RNA-seq in the last decade, <italic>arXiv: 1704.01379</italic>.</mixed-citation>
    </ref>
    <ref id="bty058-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tanay</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Regev</surname><given-names>A.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>. <source>Nature</source>, <volume>541</volume>, <fpage>331</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">28102262</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teschendorff</surname><given-names>A.E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Increased signaling entropy in cancer requires the scale-free property of protein interaction networks</article-title>. <source>Sci. Rep</source>., <volume>5</volume>, <fpage>9646</fpage>.<pub-id pub-id-type="pmid">25919796</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teschendorff</surname><given-names>A.E.</given-names></name>, <name name-style="western"><surname>Enver</surname><given-names>T.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Single-cell entropy for accurate estimation of differentiation potency from a cell's transcriptome</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>15599</fpage>.<pub-id pub-id-type="pmid">28569836</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Treutlein</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>, <volume>509</volume>, <fpage>371</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">24739965</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tsoucas</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Yuan</surname><given-names>G.C.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Recent progress in single-cell cancer genomics</article-title>. <source>Curr. Opin. Genet. Dev</source>., <volume>42</volume>, <fpage>22</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">28126650</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ustiyan</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Foxm1 transcription factor is critical for proliferation and differentiation of Clara cells during development of conducting airways</article-title>. <source>Dev. Biol</source>., <volume>370</volume>, <fpage>198</fpage>–<lpage>212</lpage>.<pub-id pub-id-type="pmid">22885335</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>von Luxburg</surname><given-names>U.</given-names></name></person-group> (<year>2007</year>) 
<article-title>A tutorial on spectral clustering</article-title>. <source>Stat. Comput</source>., <volume>17</volume>, <fpage>395</fpage>–<lpage>416</lpage>.</mixed-citation>
    </ref>
    <ref id="bty058-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>414</fpage>–<lpage>416</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yan</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Single-cell RNA-Seq profiling of human preimplantation embryos and embryonic stem cells</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>20</volume>, <fpage>1131</fpage>–<lpage>1139</lpage>.<pub-id pub-id-type="pmid">23934149</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>H.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>AnimalTFDB 2.0: a resource for expression, prediction and functional study of animal transcription factors</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>D76</fpage>–<lpage>D81</lpage>.<pub-id pub-id-type="pmid">25262351</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Transcription factor Etv5 is essential for the maintenance of alveolar type II cells</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>114</volume>, <fpage>3903</fpage>–<lpage>3908</lpage>.<pub-id pub-id-type="pmid">28351980</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>HMGB2 regulates satellite-cell-mediated skeletal muscle regeneration through IGF2BP2</article-title>. <source>J. Cell Sci</source>., <volume>129</volume>, <fpage>4305</fpage>–<lpage>4316</lpage>.<pub-id pub-id-type="pmid">27672022</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zipori</surname><given-names>D.</given-names></name></person-group> (<year>2004</year>) 
<article-title>The nature of stem cells: state rather than entity</article-title>. <source>Nat. Rev. Genet</source>., <volume>5</volume>, <fpage>873</fpage>–<lpage>878</lpage>.<pub-id pub-id-type="pmid">15520797</pub-id></mixed-citation>
    </ref>
    <ref id="bty058-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Zwiessele</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Lawrence</surname><given-names>N.D.</given-names></name></person-group> (<year>2017</year>) Topslam: Waddington landscape recovery for single cell experiments, <italic>bioRxiv</italic>, 057778.</mixed-citation>
    </ref>
  </ref-list>
</back>
