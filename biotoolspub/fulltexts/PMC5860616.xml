<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860616</article-id>
    <article-id pub-id-type="pmid">29048466</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx660</article-id>
    <article-id pub-id-type="publisher-id">btx660</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyBEL: a computational framework for Biological Expression Language</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4423-4370</contrib-id>
        <name>
          <surname>Hoyt</surname>
          <given-names>Charles Tapley</given-names>
        </name>
        <xref ref-type="aff" rid="btx660-aff1">1</xref>
        <xref ref-type="aff" rid="btx660-aff2">2</xref>
        <xref ref-type="corresp" rid="btx660-cor1"/>
        <!--<email>charles.hoyt@scai.fraunhofer.de</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Konotopez</surname>
          <given-names>Andrej</given-names>
        </name>
        <xref ref-type="aff" rid="btx660-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ebeling</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="btx660-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx660-aff1"><label>1</label>Department of Bioinformatics, Fraunhofer Institute for Algorithms and Scientific Computing (SCAI), Sankt Augustin, Germany</aff>
    <aff id="btx660-aff2"><label>2</label>Department of Life Science Informatics, Bonn-Aachen International Center for IT, Rheinische Friedrich-Wilhelms-Universität Bonn, Bonn, Germany</aff>
    <author-notes>
      <corresp id="btx660-cor1">To whom correspondence should be addressed. Email: <email>charles.hoyt@scai.fraunhofer.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-18">
      <day>18</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>4</issue>
    <fpage>703</fpage>
    <lpage>704</lpage>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>7</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx660.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Biological Expression Language (BEL) assembles knowledge networks from biological relations across multiple modes and scales. Here, we present PyBEL; a software package for parsing, validating, converting, storing, querying, and visualizing networks encoded in BEL.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>PyBEL is implemented in platform-independent, universal Python code. Its source is distributed under the Apache 2.0 License at <ext-link ext-link-type="uri" xlink:href="https://github.com/pybel">https://github.com/pybel</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Among the most popular modeling and data exchange languages in systems biology are currently the Biological Pathways Exchange (BioPAX), Systems Biology Markup Language (SBML) and Biological Expression Language (BEL). BioPAX captures metabolic, signaling, molecular, gene-regulatory, and genetic interaction networks (<xref rid="btx660-B4" ref-type="bibr">Hucka <italic>et al.</italic>, 2003</xref>); SBML accommodates mathematical models of biochemical networks, cellular signaling, and metabolic pathways (<xref rid="btx660-B2" ref-type="bibr">Demir <italic>et al.</italic>, 2010</xref>); and BEL assembles qualitative causal and correlative relations between biological entities across multiple modes and scales, with full provenance information including namespace references, relation provenance (citation and evidence), and biological context-specific relation metadata (anatomy, cell, disease etc.) (<xref rid="btx660-B8" ref-type="bibr">Slater, 2014</xref>).</p>
    <p>Although there exist several software packages for BioPAX and SBML, the ecosystem of open-source software for BEL is much more limited. An assessment of previous software (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>) shows there is an unmet need for easily installable, stable, facile software that parses modern BEL and provides programmatic access to a data container that enables the resulting network to be extended, queried, manipulated, analyzed, and visualized. Furthermore, a converter between common data formats is needed to enable re-usability and interoperability between general and BEL-specific software for network analysis and visualization.</p>
    <p>Here, we present PyBEL; a software package designed to fulfill each of these needs.</p>
  </sec>
  <sec>
    <title>2 Software architecture</title>
    <p>The PyBEL software package consists of five main components: (i) network data container, (ii) parser and validator, (iii) network database manager, (iv) data converter and (v) network visualizer.</p>
    <p>Although a graph refers to an abstraction for a set of objects (i.e. nodes) and their relations (i.e. edges), its instantiation in a real-world application is often called a network. We provide an implementation of a directed multigraph (i.e. a graph whose edges have directionality and any given pair of nodes may have multiple edges) that maps the biological entities and concepts in the subjects and objects of BEL relations to nodes in a network and their relations, with corresponding metadata, to edges. We extended the MultiDiGraph class from <monospace>NetworkX</monospace> (<ext-link ext-link-type="uri" xlink:href="http://networkx.github.io">http://networkx.github.io</ext-link>) to enable users direct access to their suite of network algorithms and static visualizations to support their further development into biologically meaningful analyses.</p>
    <p>The parser performs tokenization, lexical analysis, parsing, and validation on each of the three sections of BEL documents (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1 and S2</xref>). Callbacks are used to annotate the entries in the document metadata section to a network instance, download and store the resources referenced in the definitions section, maintain a list of current annotations from SET statements, and parse BEL relations to populate a network instance with the corresponding nodes, edges, and their metadata from the current internal state. Although relations’ syntax is implicitly validated, the semantics of their subjects’ and objects’ identifiers are validated against the references from the definitions section. Finally, feedback is provided to users to support thoughtful re-curation, which could lead to more robust knowledge assemblies and enable more reproducible science.</p>
    <p>Namespaces and networks are cached with a relational database to improve the speed of validation and access to data. Although relational databases lack the faculty for applying network algorithms, they provide indexing functionality that enables complicated queries and filters over the nodes, edges, and metadata of increasingly large collections of networks. For example, this could help identify intersections and potential cross-talk between disease-specific networks.</p>
    <p>We implemented lossless converters for common file formats including Node-Link JSON, JGIF, CX, and binary as well as for database formats including SQL, Neo4J, and NDEx. We also provide lossy exporters to Excel, CSV, SIF, XGMML, and GSEA to facilitate usage in other programs. Notably, we have deferred implementing a RDF (Resource Description Framework) converter until improvements are made to the existing BEL to RDF mapping and its documentation (<ext-link ext-link-type="uri" xlink:href="https://wiki.openbel.org">https://wiki.openbel.org</ext-link>). Future work will also include converters for BioPAX and SBML. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref> for more detailed descriptions of each format.</p>
    <p>Networks can be exported for visualization in Cytoscape or uploaded to NDEx (<xref rid="btx660-B7" ref-type="bibr">Pratt <italic>et al.</italic>, 2015</xref>) to take advantage of its viewer and simple query interface. Alternatively, we provide an interactive network explorer tailored to BEL networks (appropriate node coloring, metadata pop-ups etc.) that can be directly embedded as HTML in email, Jupyter Notebook, or a web application. It has already been used to produce visualizations in the NeuroMMSig Web Service (<xref rid="btx660-B3" ref-type="bibr">Domingo-Fernández <italic>et al.</italic>, 2017</xref>). <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S3–S5</xref> present these visualizations side-by-side. In addition to their programmatic interfaces, the parser, storage, conversion, and visualization features are exposed via a command line tool.</p>
  </sec>
  <sec>
    <title>3 Case study</title>
    <p>The PyBEL suite includes functions for querying and mutating networks with which it implements state-of-the-art algorithms for over-representation analysis, functional class scoring, and pathway topological analysis of BEL networks such as Reverse Causal Reasoning (<xref rid="btx660-B1" ref-type="bibr">Catlett <italic>et al.</italic>, 2013</xref>). <xref ref-type="fig" rid="btx660-F1">Figure 1</xref> presents a case study in which a novel heat diffusion work flow was used to assess the observed impact on biological processes from differential gene expression in Alzheimer’s disease (AD). Technical documentation is included in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.
</p>
    <fig id="btx660-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Plotted is the distribution of the final heat on biological processes from the NeuroMMSig AD Knowledge Assembly (<xref rid="btx660-B3" ref-type="bibr">Domingo-Fernández <italic>et al.</italic>, 2017</xref>) following heat diffusion analysis with a differential gene expression experiment from the brains of AD patients (E-GEOD-5281, <xref rid="btx660-B6" ref-type="bibr">Liang <italic>et al.</italic>, 2007</xref>). The significant down-regulation of biological processes related to inflammatory response (heat = 69) and up-regulation of cellular death (heat = −13) and beta-amyloid formation (heat = −9) match common clinical observations and serve as a validation for this approach</p>
      </caption>
      <graphic xlink:href="btx660f1"/>
    </fig>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Even after its v2.0 update, BEL does not yet explicitly specify many concepts in molecular biology such as epigenetic information (<xref rid="btx660-B5" ref-type="bibr">Irin <italic>et al.</italic>, 2015</xref>). The inevitability of language evolution prompted us to develop the parser in modules so that new syntax could be proposed and implemented quickly. As a proof of concept, a syntax extension for gene modifications is included in the package by default.</p>
    <p>Historically, BEL has used a custom namespace file format, but the creation and maintenance of biological terminologies has tended towards using OWL (Web Ontology Language). Furthermore, many domains (e.g. SNPs) are growing too large to enumerate during semantic integration and validation. The modular architecture of the parser enables easy implementation of new definition file formats, external validation services, or even alternative namespace definition schemes to address these issues.</p>
    <p>Although BEL is often used to formalize knowledge curated from unstructured sources, our software also enables the integration of knowledge from structured sources. For example, existing solutions for resolving equivalences across namespaces rely on the creation and hosting of extensive lookup tables. Alternatively, the parser could be extended with a dedicated syntax and draw equivalencies directly from OWL.</p>
    <p>Finally, we plan to present this software as a web service to enable a wider audience of researchers across disciplines to validate, explore, and analyze their BEL networks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx660_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Sumit Madan and Scott Colby for their advice and feedback.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the European Union/European Federation of Pharmaceutical Industries and Associations (EFPIA) Innovative Medicines Initiative Joint Undertaking under AETIONOMY [grant number 115568], resources of which are composed of financial contribution from the European Union's Seventh Framework Programme (FP7/2007-2013) and EFPIA companies in kind contribution.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx660-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Catlett</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Reverse causal reasoning: applying qualitative causal knowledge to the interpretation of high-throughput data</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>340</fpage>.<pub-id pub-id-type="pmid">24266983</pub-id></mixed-citation>
    </ref>
    <ref id="btx660-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Demir</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>The BioPAX community standard for pathway data sharing</article-title>. <source>Nat. Biotechnol</source>., <volume>28</volume>, <fpage>1308</fpage>–<lpage>1308</lpage>.</mixed-citation>
    </ref>
    <ref id="btx660-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Domingo-Fernández</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Multimodal Mechanistic Signatures for Neurodegenerative Diseases (NeuroMMSig): a web server for mechanism enrichment</article-title>. <source>Bioinformatics (Oxford, England)</source>, btx399.</mixed-citation>
    </ref>
    <ref id="btx660-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hucka</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>19</volume>, <fpage>524</fpage>–<lpage>531</lpage>.</mixed-citation>
    </ref>
    <ref id="btx660-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Irin</surname><given-names>A.K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Computational Modelling Approaches on Epigenetic Factors in Neurodegenerative and Autoimmune Diseases and Their Mechanistic Analysis</article-title>. <source>J. Immunol. Res</source>., <volume>2015</volume>, doi:10.1155/2015/737168.</mixed-citation>
    </ref>
    <ref id="btx660-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liang</surname><given-names>W.S.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Gene expression profiles in anatomically and functionally distinct regions of the normal aged human brain</article-title>. <source>Physiol. Genomics</source>, <volume>28</volume>, <fpage>311</fpage>–<lpage>322</lpage>.<pub-id pub-id-type="pmid">17077275</pub-id></mixed-citation>
    </ref>
    <ref id="btx660-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pratt</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>NDEx, the network data exchange</article-title>. <source>Cell Syst</source>., <volume>1</volume>, <fpage>302</fpage>–<lpage>305</lpage>.<pub-id pub-id-type="pmid">26594663</pub-id></mixed-citation>
    </ref>
    <ref id="btx660-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Slater</surname><given-names>T.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Recent advances in modeling languages for pathway maps and computable biological networks</article-title>. <source>Drug Discov. Today</source>, <volume>19</volume>, <fpage>193</fpage>–<lpage>198</lpage>.<pub-id pub-id-type="pmid">24444544</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
