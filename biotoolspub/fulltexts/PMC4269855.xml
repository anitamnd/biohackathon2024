<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4269855</article-id>
    <article-id pub-id-type="pmid">25495450</article-id>
    <article-id pub-id-type="publisher-id">394</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-014-0394-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MPAgenomics: an R package for multi-patient analysis of genomic markers</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Grimonprez</surname>
          <given-names>Quentin</given-names>
        </name>
        <address>
          <email>quentin.grimonprez@inria.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Celisse</surname>
          <given-names>Alain</given-names>
        </name>
        <address>
          <email>alain.celisse@inria.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blanck</surname>
          <given-names>Samuel</given-names>
        </name>
        <address>
          <email>samuel.blanck@inria.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheok</surname>
          <given-names>Meyling</given-names>
        </name>
        <address>
          <email>meyling.cheok@inserm.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Figeac</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>martin.figeac@inserm.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marot</surname>
          <given-names>Guillemette</given-names>
        </name>
        <address>
          <email>guillemette.marot@inria.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <aff id="Aff1"><label/>MODAL team, Inria Lille-Nord Europe, Villeneuve-d’Ascq, France </aff>
      <aff id="Aff2"><label/>Laboratoire Paul Painlevé, Université Lille 1, Villeneuve-d’Ascq, France </aff>
      <aff id="Aff3"><label/>Inserm, U837, Team 3, Cancer Research Institute of Lille, Lille, France </aff>
      <aff id="Aff4"><label/>Plate-forme de génomique fonctionnelle et structurale, IFR-114, Université Lille 2, Lille, France </aff>
      <aff id="Aff5"><label/>EA 2694, Université Lille 2, Lille, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>394</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Grimonprez et al.; licensee BioMed Central Ltd. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Last generations of Single Nucleotide Polymorphism (SNP) arrays allow to study copy-number variations in addition to genotyping measures.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>MPAgenomics, standing for multi-patient analysis (MPA) of genomic markers, is an R-package devoted to: (<italic>i</italic>) efficient segmentation and (<italic>i</italic><italic>i</italic>) selection of genomic markers from multi-patient copy number and SNP data profiles. It provides wrappers from commonly used packages to streamline their repeated (sometimes difficult) manipulation, offering an easy-to-use pipeline for beginners in R.</p>
        <p>The segmentation of successive multiple profiles (finding losses and gains) is performed with an automatic choice of parameters involved in the wrapped packages. Considering multiple profiles in the same time, MPAgenomics wraps efficient penalized regression methods to select relevant markers associated with a given outcome.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>MPAgenomics provides an easy tool to analyze data from SNP arrays in R. The R-package MPAgenomics is available on CRAN.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>SNP arrays</kwd>
      <kwd>Segmentation of genomic data</kwd>
      <kwd>Marker selection</kwd>
      <kwd>Multi-patient analysis</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Genome-wide Single Nucleotide Polymorphism (SNP) arrays have been widely used over the past few years [<xref ref-type="bibr" rid="CR1">1</xref>]. First generations were measuring only genetic variations of Single Nucleotide Polymorphisms, which are single base pair mutations at specific loci. Last generations (e.g. SNP5.0, SNP6.0) also include non-polymorphic probes in order to study copy-number variations along the genome in addition to genotyping measures. These arrays are especially used to study the impact of diseases, e.g. cancer, on the human genome.</p>
    <p>Analyzing data from genome-wide SNP arrays within R requires several packages, e.g. aroma for normalization of Affymetrix®; SNP arrays [<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>], changepoint or cghseg for segmentation of copy number profiles [<xref ref-type="bibr" rid="CR4">4</xref>], cghcall for labelling segments [<xref ref-type="bibr" rid="CR5">5</xref>], and glmnet for penalized regressions [<xref ref-type="bibr" rid="CR6">6</xref>]. Each package performs a specific task along the whole analysis but none of them is related to the others. Output formats of given packages are often not compatible with input formats required by the other, making their use tricky for beginners in R. One main contribution of the MPAgenomics R package is to aggregate these commonly used packages, providing wrappers to inter-relate them automatically.</p>
    <p>At each step of the analysis a large amount of packages are available to perform normalization, segmentation or marker selection. A careful choice of only a few methods is required to provide an easy-to-use and efficient tool.</p>
    <p>In this software article, we describe two different pipelines implemented in the R package MPAgenomics. Both of them perform the whole analysis from raw data to normalization, and then either successive segmented profiles, or a list of genomic markers selected from all available profiles.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>MPAgenomics is implemented in R [<xref ref-type="bibr" rid="CR7">7</xref>]. The package is divided in four main parts: data normalization, segmentation, calling and marker selection. Each part depends on different packages. MPAgenomics provides wrappers for some functions of these packages and facilitates the interaction between outputs and inputs of different functions. It remedies some problems with the wrapped packages such as confusing parameter names.</p>
    <sec id="Sec3">
      <title>Data normalization</title>
      <p>The normalization process in MPAgenomics contains <italic>technical biases correction</italic> and <italic>copy number and allele B fraction estimation</italic>. Following [<xref ref-type="bibr" rid="CR8">8</xref>], <italic>allele B fraction</italic> refers to the proportion of the total signal coming from allele B. Normalization methods are available for Affymetrix®; arrays (10K, 100K, 500K, GenomeWideSNP 5 &amp; 6, and CytoScanHD). The estimation of the total copy number and allele B fraction is made by <italic>CRMAv2</italic> [<xref ref-type="bibr" rid="CR9">9</xref>] originally implemented in the aroma packages. For studies with matched normal-tumor samples, a better estimation is suggested and implemented for the allele B fraction of the tumoral sample with the <italic>TumorBoost</italic> method [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p>The use of aroma packages is difficult for neophytes due to the strict folder architecture it requires and the documentation of the project which is mainly dedicated to experts able to criticize each method proposed and understand details of each procedure.</p>
      <p>MPAgenomics provides documentation with a detailed example explaining how to quickly analyze data. The tutorial can be accessed in R by running the following commands:</p>
      <p>library(MPAgenomics)</p>
      <p>vignette(“MPAgenomics”)</p>
      <p>More details on each step or wrapper are given to help advanced users to run each function separately.</p>
      <p>Several features in the original aroma packages create new folders and files within the architecture. Matching files from different processes associated with a given sample can be tricky for neophytes. MPAgenomics implements a wrapper to build the folder architecture, check filenames automatically, process <italic>CRMAv2</italic> and <italic>TumorBoost</italic> normalization steps. Miscellaneous functions are also provided to ease some actions like signal extraction. Furthermore, different graphs such as the copy number profile can be saved in the working directory for further visualization.</p>
      <p>The following steps (segmentation, calling and/or selection of genomic markers) are available in two settings. One is aroma-based and exploits the folder architecture and the files generated along the process. The second does not depend on aroma and allows advanced users to use their own normalized data.</p>
    </sec>
    <sec id="Sec4">
      <title>Segmentation</title>
      <p>Although the use of manual annotations provides the best segmentation results [<xref ref-type="bibr" rid="CR10">10</xref>], it appears essential for multi-patient analysis to avoid relying on them since they are time-consuming.</p>
      <p>Therefore, following simulation results of [<xref ref-type="bibr" rid="CR10">10</xref>], MPAgenomics wraps the <sc>CGHSEG</sc> [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>] and <sc>PELT</sc> (Pruned Exact Linear Time) [<xref ref-type="bibr" rid="CR13">13</xref>] segmentation methods which appeared to be those with the best overall performance.</p>
      <p><sc>PELT</sc> and <sc>CGHSEG</sc> methods fit a Gaussian maximum likelihood model but they differ in the way they choose the number of segments. <sc>CGHSEG</sc> requires the maximal number of segments as input. In MPAgenomics, the optimal number of segments is chosen according to a penalty <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$C\times K \times \left (2.5+\log \left (\frac {P}{K}\right)\right)$
						\end{document}</tex-math><mml:math id="M2"><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_394_Article_IEq1.gif"/></alternatives></inline-formula> with a profile of length <italic>P</italic>, <italic>K</italic> the number of segments and <italic>C</italic>&gt;0 a parameter to choose [<xref ref-type="bibr" rid="CR14">14</xref>]. This choice is performed using slope heuristics [<xref ref-type="bibr" rid="CR15">15</xref>]. The <sc>PELT</sc> method returns a segmentation with a number of segments automatically chosen by the algorithm according to a penalty <italic>K</italic><italic>ρ</italic> log(<italic>P</italic>) with <italic>ρ</italic>&gt;0 a parameter to choose. The choice of the penalty parameter has been raised in [<xref ref-type="bibr" rid="CR4">4</xref>]. MPAgenomics suggests an automatic sample-specific choice of <italic>ρ</italic> chromosome by chromosome (see package vignette for details on the method). In MPAgenomics, the two methods, <sc>CGHSEG</sc> with the slope heuristic and <sc>PELT</sc> with our calibration method, are proposed. By default, <sc>CGHSEG</sc> is used because it is quicker than <sc>PELT</sc> due to the multiple execution required by the <italic>ρ</italic> calibration method we propose.</p>
      <p>The implemented segmentation methods are independently available for both copy number and allele B fraction profiles. In the case of allele B fraction segmentation, only heterozygous SNPs are kept. First, a naive genotype call [<xref ref-type="bibr" rid="CR8">8</xref>] is performed on each normal sample in order to separate heterozygous SNPs from homozygous SNPs. Naive genotyping method assumes SNPs are bi-allelic and therefore is not recommended for tumor samples. Thus allele B fraction segmentation in MPAgenomics requires matched normal-tumor pairs. Then, following [<xref ref-type="bibr" rid="CR16">16</xref>], the resulting signal is centered on 0.5 and symmetrized, which makes it similar to the usual copy number.</p>
    </sec>
    <sec id="Sec5">
      <title>Calling</title>
      <p>From each segmented profile, the <italic>CGHcall</italic> method [<xref ref-type="bibr" rid="CR17">17</xref>] is run to label every copy-number segment in terms of <italic>loss</italic>, <italic>normal</italic>, and <italic>gain</italic>.</p>
      <p><italic>CGHcall</italic> depends on a parameter, named <italic>cellularity</italic>, corresponding to the contamination of a sample with healthy cells. In MPAgenomics, this parameter can be modified by users, by default its value is 1 meaning that tumor samples are pure.</p>
      <p>In the aroma-dependent function, segmentation and calling are performed with the same wrapper. The calling is run for each profile separately. Results are saved in text format in the working folder architecture.</p>
    </sec>
    <sec id="Sec6">
      <title>Selection of genomic markers</title>
      <p>The goal is to select genomic markers (e.g. SNPs or CNV) associated with a given response from all patient profiles simultaneously. There is no need to perform segmentation and calling before the multi-patient analysis, marker selection is made over all copy-number profiles. However, segmentation can be performed before marker selection if wanted, in order to reduce the noise and the dimensionality of the problem.</p>
      <p>Assuming <italic>I</italic> individuals and <italic>P</italic> potential markers, then for each individual <italic>i</italic>, <italic>y</italic><sub><italic>i</italic></sub> denotes the response and <italic>x</italic><sub><italic>i</italic>,<italic>p</italic></sub> the corresponding normalized value of copy number or allele B fraction signal at genomic position <italic>p</italic>.</p>
      <p>Due to the huge number of markers (<italic>P</italic>&gt;&gt;<italic>I</italic>), MPAgenomics uses by default the <italic>lasso</italic> [<xref ref-type="bibr" rid="CR18">18</xref>] regularization method to select very few ones. This method offers two advantages: (<italic>i</italic>) it selects only few variables, easing the interpretability of results, (<italic>i</italic><italic>i</italic>) there exist some algorithms such as the lars [<xref ref-type="bibr" rid="CR19">19</xref>] to solve quickly the <italic>lasso</italic> problem and support high-dimensional data.</p>
      <p>The lasso regularization method consists in minimizing <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$g_{\lambda } : \beta \in \mathbb {R}^{P}\mapsto g_{\lambda }(\beta)$
						\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>β</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>↦</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_394_Article_IEq2.gif"/></alternatives></inline-formula>, where <disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\begin{aligned} g_{\lambda}(\beta) = \sum\limits_{i=1}^{I} \left(y_{i}-(X\beta)_{i}\right)^{2}+\lambda \sum\limits_{p=1}^{P} |\beta_{p}|~~~, \end{aligned} $$ 
						\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Xβ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2014_394_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> with <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$(X\beta)_{i}=\sum _{p} x_{i,p}\beta _{p}$
						\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Xβ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_394_Article_IEq3.gif"/></alternatives></inline-formula> and <italic>λ</italic>&gt;0 controlling the number of non-zero coordinates of <italic>β</italic>. After minimization, non-zero coefficients <italic>β</italic><sub><italic>p</italic></sub> correspond to influential positions to predict the response.</p>
      <p>MPAgenomics genomic marker selection drastically improves currently available packages in terms of computation time. With the linear regression model, it efficiently provides the exact solution by using the new R package HDPenReg, which is an optimized implementation of the <italic>lars</italic> algorithm [<xref ref-type="bibr" rid="CR19">19</xref>] specially dedicated to a huge number of markers.</p>
      <p>Since the theoretical grounding of Lasso when <italic>P</italic>&gt;&gt;<italic>I</italic> relies on a theoretical condition (see [<xref ref-type="bibr" rid="CR20">20</xref>]) that cannot be easily checked in practice, the spike and slab algorithm [<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref>] – a three steps algorithm performing filtering, estimation and variable selection – is also provided in MPAgenomics as an alternative.</p>
      <p>Logistic regression is also available for binary responses. In this case, MPAgenomics wraps the glmnet package [<xref ref-type="bibr" rid="CR6">6</xref>] in the whole process. Unlike HDPenReg it does not provide the exact solution but is computationally very efficient. With glmnet and HDPenReg, the regularization parameter <italic>λ</italic> is chosen by <italic>k</italic>-fold cross-validation [<xref ref-type="bibr" rid="CR23">23</xref>]. The selected variables are the most relevant ones regarding the response.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p>MPAgenomics is mainly dedicated to beginners in SNP array analyses. It solves problems commonly encountered by neophytes such as interaction between different packages or specialized documentation dedicated to experts in the field. In addition, MPAgenomics suggests careful and automatic choices of crucial parameters at each part of the analysis.</p>
    <p>To achieve simplicity of usage, MPAgenomics does not propose all options implemented in the wrapped packages, especially for normalization. However, outputs are generated in such a way that interaction between wrapped packages and MPAgenomics is facilitated. For example, the strict directory structure of aroma packages is built by MPAgenomics. Therefore, advanced users may directly use specific options of aroma to enhance their analysis without renormalizing data from scratch.</p>
    <p>As specified in the data normalization section, segmentation, calling and marker selection steps can be performed without the use of aroma. This allows users to provide their own normalized data into matrices. This is useful for non-Affymetrix®; SNP arrays, CGH arrays or high-throughput sequencing data. For the latter, count data might need a variance-stabilizing transformation into Gaussian data before using current segmentation, calling and marker selection. For example, the Anscombe transform [<xref ref-type="bibr" rid="CR24">24</xref>] can be used in addition to appropriate normalization specific to the used technology (target sequencing, whole-genome sequencing).</p>
    <p>Currently, copy number and allele B fraction are segmented independently from each other. Research is ongoing to propose joint segmentation methods allowing to detect uniparental disomies, fragments which present a normal copy number but a loss of heterozygosity in the corresponding allele B fraction.</p>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>MPAgenomics provides user-friendly wrappers for normalization and multi-patient analysis of high-throughput genomic data. It offers a guideline for beginners in copy-number variation analysis focusing on proven methods for their effectiveness. MPAgenomics also provides automatic choices of crucial parameters for segmentation and selection of markers.</p>
    <p>Even though normalization is provided for Affymetrix®; arrays, other steps (segmentation, calling, and marker selection) can be applied to normalized data from other DNA arrays and next-generation sequencing data.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> MPAgenomics<bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="http://cran.at.r-project.org/package=MPAgenomics">http://cran.at.r-project.org/package=MPAgenomics</ext-link><bold>Operating system(s):</bold> Platform independent <bold>Programming language:</bold> R<bold>Other requirements:</bold> none <bold>License:</bold> GNU GPL (&gt;=2) <bold>Any restrictions to use by non-academics:</bold> None</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>QG implemented the first versions of MPAgenomics and HDPenReg. He helped in their maintenance and drafted the manuscript and the vignette of the package. AC contributed for choices of crucial parameters in segmentation, and helped draft the manuscript. SB maintained MPAgenomics and its vignette. MC and MF participated in discussions on data analysis and results. GM conceived of the project and managed it, selected key packages for wrapping. She occasionally participated to the implementation and helped draft the manuscript and the vignette. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Serge Iovleff for his help implementing HDPenReg. We also thank Claude Preudhomme and Olivier Nibourel for providing data presented in the vignette of the package, and for their helpful clinical competences to interpret the results. The development of this package was funded by the Inria Technological Development Action (ADT) named <italic>MPAGenomics</italic>.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LaFramboise</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Single nucleotide polymorphism arrays: a decade of biological, computational and technological advances</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>13</issue>
        <fpage>4181</fpage>
        <lpage>4193</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp552</pub-id>
        <?supplied-pmid 19570852?>
        <pub-id pub-id-type="pmid">19570852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <mixed-citation publication-type="other">Bengtsson H, Simpson K, Bullard J, Hansen K: <bold>aroma.affymetrix: A generic framework in R for analyzing small to very large Affymetrix data sets in bounded memory</bold>. Technical Report 745, Department of Statistics, University of California, Berkeley; 2008.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <mixed-citation publication-type="other">Bengtsson H, Bullard J, Hansen K, Neuvial P, Purdomand E, Robinson M, Simpson K: <bold>Aroma project</bold>2010. [http://www.aroma-project.org/]</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <mixed-citation publication-type="other">Killick R, Eckley I: <bold>Changepoint: An R Package for Changepoint Analysis</bold>2013. R package version 1.1, [http://www.lancs.ac.uk/~killick/Pub/KillickEckley2011.pdf]</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <mixed-citation publication-type="other">van de Wiel M, Vosse S: <bold>CGHcall: Calling Aberrations for Array CGH Tumor Profiles</bold>2012. R package version 2.20.0 [http://www.bioconductor.org/packages/release/bioc/vignettes/CGHcall/inst/doc/CGHcall.pdf]</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Regularization paths for generalized linear models via coordinate descent</bold>
        </article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <?supplied-pmid 20808728?>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2014</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Bengtsson H, Neuvial P, Speed TP: <bold>Tumorboost: Normalization of allele-specific tumor copy numbers from a single pair of tumor-normal genotyping microarrays</bold>. <italic>BMC Bioinformatics</italic>2010, <bold>11:</bold>245.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wirapati</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A single-array preprocessing method for estimating full-resolution raw copys from all Affymetrix genotyping arrays including GenomeWideSNP 5 &amp; 6</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>17</issue>
        <fpage>2149</fpage>
        <lpage>2156</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp371</pub-id>
        <?supplied-pmid 19535535?>
        <pub-id pub-id-type="pmid">19535535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other">Hocking T, Schleiermacher G, Janoueix-Lerosey I, Boeva V, Cappo J, Delattre O, Bach F, Vert J-P: <bold>Learning smoothing models of copy number profiles using breakpoint annotations</bold>. <italic>BMC Bioinformatics</italic>2013, <bold>14</bold>(1):164.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <mixed-citation publication-type="other">Picard F, Robin S, Lavielle M, Vaisse C, Daudin J-J: <bold>A statistical approach for array CGH data analysis</bold>. <italic>BMC Bioinformatics</italic>2005, <bold>6</bold>(1):27.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Rigaill G: <bold>Pruned dynamic programming for optimal multiple change-point detection</bold>. arXiv e-print, 2010, arXiv/1004.0887.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Killick</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fearnhead</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Eckley</surname>
            <given-names>IA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Optimal detection of changepoints with a linear computational cost</bold>
        </article-title>
        <source>J Am Stat Assoc</source>
        <year>2012</year>
        <volume>107</volume>
        <issue>500</issue>
        <fpage>1590</fpage>
        <lpage>1598</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2012.737745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lebarbier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detecting multiple change-points in the mean of gaussian process by model selection</bold>
        </article-title>
        <source>Signal Process</source>
        <year>2005</year>
        <volume>85</volume>
        <issue>4</issue>
        <fpage>717</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1016/j.sigpro.2004.11.012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birgé</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Massart</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Minimal penalties for gaussian model selection</bold>
        </article-title>
        <source>Probability Theory Related Fields</source>
        <year>2007</year>
        <volume>138</volume>
        <issue>1-2</issue>
        <fpage>33</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1007/s00440-006-0011-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Staaf J, Lindgren D, Vallon-Christersson J, Isaksson A, Göransson H, Juliusson G, Rosenquist R, Höglund M, Borg Å, Ringnér M: <bold>Segmentation-based detection of allelic imbalance and loss-of-heterozygosity in cancer cells using whole genome SNP arrays</bold>. <italic>Genome Biol</italic>2008, <bold>9</bold>(9):R136.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van de Wiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>KI</given-names>
          </name>
          <name>
            <surname>Vosse</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>van Wieringen</surname>
            <given-names>WN</given-names>
          </name>
          <name>
            <surname>Wilting</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Ylstra</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>CGHcall: calling aberrations for array CGH tumor profiles</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>7</issue>
        <fpage>892</fpage>
        <lpage>894</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm030</pub-id>
        <?supplied-pmid 17267432?>
        <pub-id pub-id-type="pmid">17267432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Regression shrinkage and selection via the lasso</bold>
        </article-title>
        <source>J R Stat Soci Series B</source>
        <year>1994</year>
        <volume>58</volume>
        <fpage>267</fpage>
        <lpage>288</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Johnstone</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Least angle regression</bold>
        </article-title>
        <source>Ann Stat</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>407</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1214/009053604000000067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ravikumar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wainwright</surname>
            <given-names>M. J</given-names>
          </name>
          <name>
            <surname>Raskutti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>High-dimensional covariance estimation by minimizing</bold>
          <bold>
            <italic>l</italic>
          </bold>
          <sub>
            <bold>1</bold>
          </sub>
          <bold>-penalized log-determinant divergence</bold>
        </article-title>
        <source>Electron J Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>935</fpage>
        <lpage>980</lpage>
        <pub-id pub-id-type="doi">10.1214/11-EJS631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ishwaran</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Spike and slab variable selection: frequentist and bayesian strategies</bold>
        </article-title>
        <source>Ann Stat</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>2</issue>
        <fpage>730</fpage>
        <lpage>773</lpage>
        <pub-id pub-id-type="doi">10.1214/009053604000001147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Ishwaran H, Rao JS: <bold>Generalized ridge regression: geometry and computational solutions when p is larger than n</bold>. Technical Report, Department of Public Health Sciences Division of Biostatistics, University of Miami, Miller School of Medecine; 2010.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arlot</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Celisse</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A survey of cross-validation procedures for model selection</bold>
        </article-title>
        <source>Stat Surv</source>
        <year>2010</year>
        <volume>4</volume>
        <fpage>40</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1214/09-SS054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anscombe</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The transformation of poisson, binomial, and negative-binomial data</bold>
        </article-title>
        <source>Biometrika</source>
        <year>1948</year>
        <volume>35</volume>
        <issue>3/4</issue>
        <fpage>246</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="doi">10.2307/2332343</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
