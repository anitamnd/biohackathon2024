<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Geochem Geophys Geosyst</journal-id>
    <journal-id journal-id-type="iso-abbrev">Geochem Geophys Geosyst</journal-id>
    <journal-id journal-id-type="doi">10.1002/(ISSN)1525-2027</journal-id>
    <journal-id journal-id-type="publisher-id">GGGE</journal-id>
    <journal-title-group>
      <journal-title>Geochemistry, Geophysics, Geosystems : G(3)</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1525-2027</issn>
    <publisher>
      <publisher-name>John Wiley and Sons Inc.</publisher-name>
      <publisher-loc>Hoboken</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6001588</article-id>
    <article-id pub-id-type="doi">10.1002/2017GC007279</article-id>
    <article-id pub-id-type="publisher-id">GGGE21516</article-id>
    <article-categories>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Magnetism in the Geosciences ‐ Advances and Perspectives</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Geomagnetism and Paleomagnetism</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Rock and Mineral Magnetism</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Magnetic Mineralogy and Petrology</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Physical Properties of Rocks</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Magnetic and Electrical Properties</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Exploration Geophysics</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Magnetic and Electrical Methods</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Computational Geophysics</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Modeling</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Oceanography: General</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Numerical Modeling</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Natural Hazards</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Physical Modeling</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Informatics</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>High‐performance Computing</subject>
      </subj-group>
      <subj-group subj-group-type="article-subject-classification">
        <subject>Modeling</subject>
      </subj-group>
      <subj-group subj-group-type="overline">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MERRILL: Micromagnetic Earth Related Robust Interpreted Language Laboratory</article-title>
      <alt-title alt-title-type="right-running-head">MERRILL</alt-title>
      <alt-title alt-title-type="left-running-head">CONBHUÍ ET AL.</alt-title>
    </title-group>
    <contrib-group>
      <contrib id="ggge21516-cr-0001" contrib-type="author" corresp="yes">
        <name>
          <surname>Ó Conbhuí</surname>
          <given-names>Pádraig</given-names>
        </name>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2575-3741</contrib-id>
        <address>
          <email>poconbhui@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="ggge21516-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="ggge21516-cr-0002" contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Wyn</given-names>
        </name>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9210-7574</contrib-id>
        <xref ref-type="aff" rid="ggge21516-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="ggge21516-cr-0003" contrib-type="author">
        <name>
          <surname>Fabian</surname>
          <given-names>Karl</given-names>
        </name>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3504-3292</contrib-id>
        <xref ref-type="aff" rid="ggge21516-aff-0002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="ggge21516-aff-0003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib id="ggge21516-cr-0004" contrib-type="author">
        <name>
          <surname>Ridley</surname>
          <given-names>Phil</given-names>
        </name>
        <xref ref-type="aff" rid="ggge21516-aff-0004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib id="ggge21516-cr-0005" contrib-type="author">
        <name>
          <surname>Nagy</surname>
          <given-names>Lesleis</given-names>
        </name>
        <xref ref-type="aff" rid="ggge21516-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="ggge21516-cr-0006" contrib-type="author">
        <name>
          <surname>Muxworthy</surname>
          <given-names>Adrian R.</given-names>
        </name>
        <xref ref-type="aff" rid="ggge21516-aff-0005">
          <sup>5</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="ggge21516-aff-0001">
      <label>
        <sup>1</sup>
      </label>
      <named-content content-type="organisation-division">School of GeoSciences</named-content>
      <institution>University of Edinburgh</institution>
      <named-content content-type="city">Edinburgh</named-content>
      <country country="GB">United Kingdom</country>
    </aff>
    <aff id="ggge21516-aff-0002">
      <label>
        <sup>2</sup>
      </label>
      <institution>Geological Survey of Norway</institution>
      <named-content content-type="city">Trondheim</named-content>
      <country country="NO">Norway</country>
    </aff>
    <aff id="ggge21516-aff-0003">
      <label>
        <sup>3</sup>
      </label>
      <named-content content-type="organisation-division">Department of Geology</named-content>
      <institution>University of Tromsø</institution>
      <named-content content-type="city">Tromsø</named-content>
      <country country="NO">Norway</country>
    </aff>
    <aff id="ggge21516-aff-0004">
      <label>
        <sup>4</sup>
      </label>
      <institution>Cray UK Ltd, Broad Quay House, Broad Quay</institution>
      <named-content content-type="city">Bristol</named-content>
      <country country="GB">United Kingdom</country>
    </aff>
    <aff id="ggge21516-aff-0005">
      <label>
        <sup>5</sup>
      </label>
      <named-content content-type="organisation-division">Natural Magnetism Group, Department of Earth Science and Engineering</named-content>
      <institution>Imperial College London</institution>
      <named-content content-type="city">London</named-content>
      <country country="GB">United Kingdom</country>
    </aff>
    <author-notes>
      <corresp id="correspondenceTo"><label>*</label><bold>Correspondence to</bold>: P. Ó Conbhuí, <email>poconbhui@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>06</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <issue>4</issue>
    <issue-id pub-id-type="doi">10.1002/ggge.v19.4</issue-id>
    <fpage>1080</fpage>
    <lpage>1106</lpage>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>2</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <!--<copyright-statement content-type="issue-copyright"> &#x000a9; 2018. American Geophysical Union. All Rights Reserved. <copyright-statement>-->
      <copyright-statement content-type="article-copyright">© 2018. The Authors.</copyright-statement>
      <license license-type="creativeCommonsBy">
        <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="file:GGGE-19-1080.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Complex magnetic domain structures and the energy barriers between them are responsible for pseudo‐single‐domain phenomena in rock magnetism and contribute significantly to the magnetic remanence of paleomagnetic samples. This article introduces MERRILL, an open source software package for three‐dimensional micromagnetics optimized and designed for the calculation of such complex structures. MERRILL has a simple scripting user interface that requires little computational knowledge to use but provides research strength algorithms to model complex, inhomogeneous domain structures in magnetic materials. It uses a finite element/boundary element numerical method, optimally suited for calculating magnetization structures of local energy minima (LEM) in irregular grain geometries that are of interest to the rock and paleomagnetic community. MERRILL is able to simulate the magnetic characteristics of LEM states in both single grains, and small assemblies of interacting grains, including saddle‐point paths between nearby LEMs. Here the numerical model is briefly described, and an overview of the scripting language and available commands is provided. The open source nature of the code encourages future development of the model by the scientific community.</p>
    </abstract>
    <abstract abstract-type="short">
      <title>Key Points</title>
      <p>
        <list list-type="simple" id="ggge21516-list-0001">
          <list-item id="ggge21516-li-0001">
            <p>MERRILL is a powerful micromagnetic modeling package for the Earth Sciences community which uses a simple scripting language interface</p>
          </list-item>
          <list-item id="ggge21516-li-0002">
            <p>MERRILL can model phenomena in magnetic minerals, like remanence and hysteresis, without need for specialist computational knowledge</p>
          </list-item>
          <list-item id="ggge21516-li-0003">
            <p>This article is an introduction to micromagnetic modeling and MERRILL, including example scripts useful for rock‐magnetism and paleomagnetism</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <kwd-group kwd-group-type="author-generated">
      <kwd id="ggge21516-kwd-0001">micromagnetism</kwd>
      <kwd id="ggge21516-kwd-0002">micromagnetic modeling</kwd>
      <kwd id="ggge21516-kwd-0003">rock magnetism</kwd>
      <kwd id="ggge21516-kwd-0004">mineral magnetism</kwd>
      <kwd id="ggge21516-kwd-0005">paleomagnetism</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>Norwegian Research Council
</funding-source>
        <award-id>223259
</award-id>
      </award-group>
      <award-group>
        <funding-source>Natural Environment Research Council
</funding-source>
        <award-id>NE/J020966/1
</award-id>
      </award-group>
      <award-group>
        <funding-source>European Research Council
</funding-source>
        <award-id>EC320832
</award-id>
      </award-group>
      <award-group>
        <funding-source>National Science Foundation
</funding-source>
        <award-id>EAR1547263
</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="20"/>
      <table-count count="2"/>
      <page-count count="27"/>
      <word-count count="11784"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>source-schema-version-number</meta-name>
        <meta-value>2.0</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>component-id</meta-name>
        <meta-value>ggge21516</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>April 2018</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>details-of-publishers-convertor</meta-name>
        <meta-value>Converter:WILEY_ML3GV2_TO_NLMPMC version:version=5.4.1.1 mode:remove_FC converted:14.06.2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <p content-type="self-citation">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0001"><string-name><surname>Ó Conbhuí</surname>, <given-names>P.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, 
<string-name><surname>Ridley</surname>, <given-names>P.</given-names></string-name>, 
<string-name><surname>Nagy</surname>, <given-names>L.</given-names></string-name>, &amp; 
<string-name><surname>Muxworthy</surname>, <given-names>A. R.</given-names></string-name> (<year>2018</year>). <article-title>MERRILL: Micromagnetic earth related robust interpreted language laboratory</article-title>. <source xml:lang="en">Geochemistry, Geophysics, Geosystems</source>, <volume>19</volume>, <fpage>1080</fpage>–<lpage>1106</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/2017GC007279">https://doi.org/10.1002/2017GC007279</ext-link>
</mixed-citation>
    </p>
  </notes>
</front>
<body>
  <sec id="ggge21516-sec-0001">
    <label>1</label>
    <title>Introduction</title>
    <p>Paleomagnetic observations have contributed a wealth of information about the evolution of the Earth and other planetary bodies (Dunlop &amp; Özdemir, <xref rid="ggge21516-bib-0015" ref-type="ref">2001</xref>; Merrill, <xref rid="ggge21516-bib-0035" ref-type="ref">1998</xref>), through the interpretation of remanent magnetization in naturally occurring magnetic minerals. The vast majority of the natural magnetic archives are recorded by nanosized particles whose magnetic properties initially could only be inferred from experimental observations, either on natural samples or on man‐made analogues of bulk particle arrays which have relatively broad particle size distributions. Rock magnetic interpretation is typically based on the assumption that paleomagnetic samples are dominated by single‐domain particles which are theoretically accessible by Néel's theoretical description (Néel, <xref rid="ggge21516-bib-0040" ref-type="ref">1955</xref>).</p>
    <p>With the advent of numerical micromagnetics and high‐resolution imaging techniques, it has been demonstrated that many of the remanence carriers in natural samples are inhomogeneously magnetized pseudo‐single‐domain (PSD) grains, which in their simplest form take on a single vortex (SV) magnetic structure. The first three‐dimensional micromagnetic models were introduced in the late 1980s (Schabes &amp; Bertram, <xref rid="ggge21516-bib-0043" ref-type="ref">1988</xref>; Williams &amp; Dunlop, <xref rid="ggge21516-bib-0049" ref-type="ref">1989</xref>), and over the last 30 years have significantly advanced our understanding of magnetic recording in interacting and noninteracting nonuniformly magnetized particles. In paleomagnetism, for example, such studies have demonstrated not only that small PSD grains, ubiquitous in rocks, primarily occupy SV states but that these states can provide reliable and stable recording of the ancient magnetic field that remain stable of over billions of years (Nagy et al., <xref rid="ggge21516-bib-0039" ref-type="ref">2017</xref>).</p>
    <p>Modern desktop computers and workstations are now powerful enough to perform micromagnetic simulations of a wide range of grain sizes, materials, and even clusters of grains that are of interest to rock‐magnetists, paleomagnetists, and environmental magnetists. The currently available open source programs (e.g. OOMMF (Donahue &amp; Porter, <xref rid="ggge21516-bib-0014" ref-type="ref">1999</xref>), Magpar (Scholz et al., <xref rid="ggge21516-bib-0044" ref-type="ref">2003</xref>), and NMag (Fischbacher et al., <xref rid="ggge21516-bib-0019" ref-type="ref">2007</xref>)) are developed for applications in material science and physics and require substantial specialist knowledge to install, maintain, and apply in Earth related contexts. The objective of this article is to introduce an open source micromagnetic model that we believe can significantly increase the ability of the rock and paleomagnetic community to define the magnetic properties of their samples through forward modeling of the behavior of their possible domain states.</p>
    <p>We describe here a finite element micromagnetic modeling package called MERRILL (Micromagnetic Earth Related Robust Interpreted Language Laboratory) in honor of the early work of Ron T. Merrill on micromagnetics in rock magnetism (Merrill, <xref rid="ggge21516-bib-0034" ref-type="ref">1977</xref>; Moon &amp; Merrill, <xref rid="ggge21516-bib-0036" ref-type="ref">1984</xref>, <xref rid="ggge21516-bib-0037" ref-type="ref">1985</xref>). MERRILL is a script based modeling program designed for the Earth science community that needs no specialist computing knowledge or proprietary additional software to run the models and visualize the magnetic domain structures. Yet it is a fully tested research‐strength modeling platform that uniquely provides specific features relevant for natural samples and may even outperform some of the above mentioned software in certain applications. Both, precompiled binaries and the FORTRAN source code are freely available and run on LINUX, macOS, and Windows. They can be downloaded from the MERRILL homepage at <ext-link ext-link-type="uri" xlink:href="http://www.rockmag.org">http://www.rockmag.org</ext-link>.</p>
    <sec id="ggge21516-sec-0002">
      <label>1.1</label>
      <title>Workflow</title>
      <p>A typical workflow using MERRILL is outlined in Figure <xref rid="ggge21516-fig-0001" ref-type="fig">1</xref>. A tetrahedral mesh of the geometry of interest must first be generated in an external program (although MERRILL contains routines for generating some commonly used geometries), representing the magnetic material. An “MScript” command file is then passed to MERRILL to drive the model, e.g., loading the mesh, setting material parameters, varying external fields, minimizing the micromagnetic energy, and outputting the magnetization to disk. When the magnetization has been output to disk, an external visualization program can be used to inspect the results. The visualizations of the geometries and magnetizations presented in this paper were generated with ParaView (Ahrens et al., <xref rid="ggge21516-bib-0001" ref-type="ref">2005</xref>). This magnetization may also be used as a starting point in future models.</p>
      <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0001" orientation="portrait" position="float">
        <label>Figure 1</label>
        <caption>
          <p>A typical workflow using MERRILL.</p>
        </caption>
        <graphic id="nlm-graphic-1" xlink:href="GGGE-19-1080-g001"/>
      </fig>
      <p>A productive workflow might involve running a micromagnetic model, inspecting the results visually, and then continuing the model using the previous results as the new starting point, until some desired result is achieved.</p>
    </sec>
  </sec>
  <sec id="ggge21516-sec-0003">
    <label>2</label>
    <title>Micromagnetism</title>
    <p>In micromagnetism, a real physical magnetic system is described in terms of a continuous vector valued function:
<disp-formula id="ggge21516-disp-0001"><mml:math id="nlm-math-1"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mn>3</mml:mn></mml:msup><mml:mo> </mml:mo><mml:mo>→</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0002"><mml:math id="nlm-math-2"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>↦</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where 
<mml:math id="nlm-math-3"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> represents a mathematical magnetization vector at the mathematical point 
<mml:math id="nlm-math-4"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math> (Brown, <xref rid="ggge21516-bib-0006" ref-type="ref">1963</xref>; Hubert &amp; Schäfer, <xref rid="ggge21516-bib-0027" ref-type="ref">1998</xref>). All physical energies and processes are then mathematically studied through this continuous function. To link the results to the physical situation, one can assume that the magnetization at a given mathematical point is constructed by averaging the discrete physical sources of magnetism, e.g., electron spins and orbitals, over a small volume centered at that point. This volume must be large enough that the behavior of individual atoms are averaged out, but small enough to resolve inhomogeneous magnetic structures such as domain walls, vortices, or flower states. It turns out that this continuum approximation represents real magnetization structures astonishingly well, even if the mathematical magnetization at a given point represents only the average over a few atoms. Quantum mechanical effects, which are essential in magnetism, are represented purely phenomenologically through material constants like the exchange constant or the magnetocrystalline anisotropy constant.</p>
    <p>In micromagnetic models, the magnetic structure in a particle gives rise to various contributions to the total free magnetic energy functional 
<mml:math id="nlm-math-5"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>, or to their associated effective fields. The effective field 
<mml:math id="nlm-math-6"><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math> is given as a function of 
<mml:math id="nlm-math-7"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math> as
<disp-formula id="ggge21516-disp-0003"><label>(1)</label><mml:math id="nlm-math-8"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
    <p>The dynamics of a micromagnetic system is described by the Landau‐Lifshitz‐Gilbert (LLG) equation (Gilbert, <xref rid="ggge21516-bib-0022" ref-type="ref">2004</xref>):
<disp-formula id="ggge21516-disp-0004"><label>(2)</label><mml:math id="nlm-math-9"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>γ</italic> is the electron gyromagnetic ratio and <italic>λ</italic> is a material‐dependent damping factor. This behaves like a dynamical system where a force 
<mml:math id="nlm-math-10"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math> acts on a system with a nonzero angular momentum vector pointing parallel to 
<mml:math id="nlm-math-11"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>. A sufficient condition for an equilibrium magnetization 
<mml:math id="nlm-math-12"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math> is given by
<disp-formula id="ggge21516-disp-0005"><label>(3)</label><mml:math id="nlm-math-13"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
    <p>This solution is local energy minimum (LEM), which we might associate with a remanent magnetization state, and so we will denote it 
<mml:math id="nlm-math-14"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>rem</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math>. From equation <xref rid="ggge21516-disp-0005" ref-type="disp-formula">(3)</xref> we can see two types of solutions. Either 
<mml:math id="nlm-math-15"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup></mml:mrow></mml:math> is parallel to 
<mml:math id="nlm-math-16"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> or 
<mml:math id="nlm-math-17"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math>. In MERRILL, we focus on the second solution, that is, we solve for the LEM solutions by optimizing the expression for the total free magnetic energy of the system. This is generally much more efficient at finding stable domain structures that the full solution to the LLG equation, and we are not normally interested in the details of the domain transition dynamics that the LLG describes.</p>
    <sec id="ggge21516-sec-0004">
      <label>2.1</label>
      <title>Effective Fields</title>
      <p>The total effective field 
<mml:math id="nlm-math-18"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> for a typical cubic ferromagnetic crystal involves four primary components: Zeeman, anisotropy, exchange and demagnetizing fields (Brown, <xref rid="ggge21516-bib-0006" ref-type="ref">1963</xref>; Kittel, <xref rid="ggge21516-bib-0028" ref-type="ref">1949</xref>).</p>
      <sec id="ggge21516-sec-0005">
        <label>2.1.1</label>
        <title>Zeeman Field</title>
        <p>The Zeeman field represents the interaction of external sources of magnetic field with the magnetic system under investigation. As such, it is often referred to as the “external field.” It is assumed that the system under investigation has no effect upon the external source.
<disp-formula id="ggge21516-disp-0006"><label>(4)</label><mml:math id="nlm-math-19"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext>constant</mml:mtext></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      </sec>
      <sec id="ggge21516-sec-0006">
        <label>2.1.2</label>
        <title>Anisotropy Field</title>
        <p>The anisotropy field couples the magnetization to the crystal lattice. It is the primary mechanism by which the symmetries of the lattice affect the magnetization. For a cubic ferromagnetic crystal, if the crystal axes are along the <italic>x</italic>, <italic>y</italic>, and <italic>z</italic> coordinate axes, it can be written
<disp-formula id="ggge21516-disp-0007"><label>(5)</label><mml:math id="nlm-math-20"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>anis</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>with <italic>K</italic>
<sub>1</sub> the anisotropy constant. In magnetite and iron higher‐order terms are much smaller and can be safely ignored for micromagnetic calculations. However, MERRILL does allow a value for <italic>K</italic>
<sub>2</sub> to be set.</p>
        <p>The vector 
<mml:math id="nlm-math-21"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math> here represents the directional cosines of the magnetization with respect to the crystal axes. For a crystal with cubic axes 
<mml:math id="nlm-math-22"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math>, and 
<mml:math id="nlm-math-23"><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>, the vector 
<mml:math id="nlm-math-24"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math> is defined:
<disp-formula id="ggge21516-disp-0008"><label>(6)</label><mml:math id="nlm-math-25"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>such that 
<mml:math id="nlm-math-26"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>.</p>
        <p>For other noncubic anisotropies, appropriate equations are used, e.g., for a crystal with a uniaxial symmetry, e.g., a tetragonal mineral like tetrataenite, a uniaxial anisotropy 
<mml:math id="nlm-math-27"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>anis</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math> is commonly used, with <italic>a</italic> the anisotropy axis.</p>
      </sec>
      <sec id="ggge21516-sec-0007">
        <label>2.1.3</label>
        <title>Exchange Field</title>
        <p>The exchange field serves to align nearest neighbor magnetizations. Although this incorporates quantum mechanical spin coupling, in the continuum approximation a micromagnetic expression can be given as
<disp-formula id="ggge21516-disp-0009"><label>(7)</label><mml:math id="nlm-math-28"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></disp-formula>with <italic>A</italic> the exchange coupling constant.</p>
      </sec>
      <sec id="ggge21516-sec-0008">
        <label>2.1.4</label>
        <title>Demagnetizing Field</title>
        <p>The demagnetizing field represents the magnetic field generated by the magnetic material itself, derived from the “magnetic self‐energy.” It is called the demagnetizing field, because a higher magnetic self‐energy represents a higher energy configuration, so it typically acts on the magnetization in such a way that it minimizes external flux and thereby itself.
<disp-formula id="ggge21516-disp-0010"><label>(8)</label><mml:math id="nlm-math-29"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>dmag</mml:mtext></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0011"><label>(9)</label><mml:math id="nlm-math-30"><mml:mrow><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0012"><label>(10)</label><mml:math id="nlm-math-31"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>∞</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
        <p>Outside the magnetic material, this is the “stray field.”</p>
      </sec>
    </sec>
  </sec>
  <sec id="ggge21516-sec-0009">
    <label>3</label>
    <title>Minimum Energy Solutions Using Finite Elements</title>
    <p>There are a variety of numerical micromagnetic approaches than can be used to solve for locally stable magnetic domain structures. Here we use a method that is both numerically efficient and robust while requiring the simplest input for representing the geometry of the grain. In most micromagnetic models, the primary consideration is the efficiency with which in the internal demagnetizing field can be computed. This field calculation scales as 
<mml:math id="nlm-math-32"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>, where <italic>N</italic> is the number nodes, but if the geometry is meshed using a regular grid this scaling can be reduced to 
<mml:math id="nlm-math-33"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> using FFT (Fabian et al., <xref rid="ggge21516-bib-0017" ref-type="ref">1996</xref>; Wright et al., <xref rid="ggge21516-bib-0053" ref-type="ref">1997</xref>). However, such regular grids do not easily account for arbitrary grain geometries, although some success has been achieved by relative scaling of surface elements (Witt et al., <xref rid="ggge21516-bib-0052" ref-type="ref">2005</xref>), or irregular FFT techniques (Kritsikis et al., <xref rid="ggge21516-bib-0030" ref-type="ref">2008</xref>).</p>
    <p>In MERRILL, we employ the Finite Element Method (FEM), a standard technique for describing functions over a geometry and solving differential equations in terms of those functions (Davies, <xref rid="ggge21516-bib-0012" ref-type="ref">2011</xref>). MERRILL uses arbitrarily shaped linear tetrahedral finite elements to describe the geometry of a particle and to solve for the LEM stable domain states. Some care is needed in the calculation of the demagnetizing field described by equations <xref rid="ggge21516-disp-0010" ref-type="disp-formula">(8)</xref>, <xref rid="ggge21516-disp-0011" ref-type="disp-formula">(9)</xref>, <xref rid="ggge21516-disp-0012" ref-type="disp-formula">(10)</xref>, which involves solving the Poisson equation for the magnetic scalar potential over an infinite space.</p>
    <p>MERRILL makes use of a Boundary Element Method (BEM) technique (Fredkin &amp; Koehler, <xref rid="ggge21516-bib-0021" ref-type="ref">1990</xref>; Lindholm, <xref rid="ggge21516-bib-0033" ref-type="ref">1984</xref>), which is a specialization of the FEM for homogeneous Poisson equations, particularly suited to problems defined over an infinite space. This method has significant advantage in that we need not create a mesh in the free‐space region outside the geometry of the magnetic particle (even for multiparticle solutions) but the method does, however, increase the memory requirements of the programme. In our experience, this is acceptable for single‐grain geometries requiring up to about a million elements. A more detailed account of different mciromagnetic methodologies can be found in Fidler and Schrefl (<xref rid="ggge21516-bib-0018" ref-type="ref">2000</xref>).</p>
    <p>LEM states are found by solving for the minimum free magnetic energy of the system 
<mml:math id="nlm-math-34"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math> where the total effective field is given by
<disp-formula id="ggge21516-disp-0013"><label>(11)</label><mml:math id="nlm-math-35"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>anis</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>dmag</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
    <p>To include further phenomena, like stress fields or surface anisotropy, in theory one need only derive the corresponding effective field, typically by taking the derivative of the energy with respect to the magnetization, and add it to equation <xref rid="ggge21516-disp-0013" ref-type="disp-formula">(11)</xref>.</p>
    <p>In order to determine minimum energy solutions, by default MERRILL makes use of an accelerated adaptive step‐size steepest descent algorithm across the energy landscape, optimized for micromagnetics, here called “Hubert Minimizer” (Berkov, <xref rid="ggge21516-bib-0004" ref-type="ref">1998a</xref>; Ramstöck, <xref rid="ggge21516-bib-0041" ref-type="ref">1997</xref>). A standard conjugate gradient optimizer is also available as an option, but in most cases is slightly less efficient in finding energy minima.</p>
  </sec>
  <sec id="ggge21516-sec-0010">
    <label>4</label>
    <title>Mesh Generation</title>
    <p>MERRILL requires that the geometry of the magnetic particle is described using a linear tetrahedral mesh (by default defined in micron units). The magnetization is thus specified only at the four vertices of each element and linearly interpolated at all other locations. MERRILL is able to generate suitable meshes for simple grain geometries such as cubes and spheres, however, more complex particle geometries require additional meshing software of which there are many free and commercial programmes. The only requirement is that the mesh is formatted according to ASCII text based PATRAN (.neu) standard. Most finite element meshing applications will support this and more detailed information about the PATRAN format can be obtained from the website of the MSC Software Corporation (<ext-link ext-link-type="uri" xlink:href="https://simcompanion.mscsoftware.com">https://simcompanion.mscsoftware.com</ext-link>).</p>
    <p>Like all finite element models, the quality of the mesh will affect the convergence efficiency of the model. In most cases meshing software will take care to produce a qood quality mesh, but for highly irregular geometries problems may still arise. Discussion of mesh quality metrics can be found in many publications (e.g., Dai et al., <xref rid="ggge21516-bib-0011" ref-type="ref">2014</xref>; Knupp, <xref rid="ggge21516-bib-0029" ref-type="ref">2006</xref>)</p>
    <p>For micromagnetic applications, it is important to ensure that that mesh is fine enough to resolve the expected spatial variation of the magnetization within the model geometry. The maximum element size is usually described in terms of the “exchange length,” 
<mml:math id="nlm-math-36"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> (Rave et al., <xref rid="ggge21516-bib-0042" ref-type="ref">1998</xref>), which is dependent on the magnetic material parameters:
<disp-formula id="ggge21516-disp-0014"><label>(12)</label><mml:math id="nlm-math-37"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>M</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
    <p>For iron and magnetite, for example, the exchange length is around 3 and 9 nm, respectively, at 30°C and slightly larger near the Curie temperature.</p>
    <p>Clearly, the bigger particle and finer the mesh the longer the model will take to converge to a LEM state. For large grains, the mesh size is usually set to the exchange length. However, small grain geometries will require a mesh that is finer than the exchange length in order adequately represent the grain shape.</p>
  </sec>
  <sec id="ggge21516-sec-0011">
    <label>5</label>
    <title>Model Validation</title>
    <p>Validation of micromagnetic models should ultimately be done against experimental observations. However, such direct validation has until recently been extremely difficult to achieve since the maximum grain size that could be modeled numerically was much smaller than that which could be directly observed experimentally. As a result, the earliest micromagnetic models could only be validated against bulk observations such as assemblies of sized particle fractions or magnetosome observations (Fabian et al., <xref rid="ggge21516-bib-0017" ref-type="ref">1996</xref>; Williams &amp; Dunlop, <xref rid="ggge21516-bib-0050" ref-type="ref">1995</xref>; Witt et al., <xref rid="ggge21516-bib-0052" ref-type="ref">2005</xref>) in the case of natural materials, or on thin film and particulate man‐made recording media (Labrune &amp; Miltat, <xref rid="ggge21516-bib-0031" ref-type="ref">1990</xref>; Silva &amp; Bertram, <xref rid="ggge21516-bib-0045" ref-type="ref">1990</xref>). However, results from MERRILL have been directly compared with nanoscale experimental data via electron holography with good agreement (Almeida et al., <xref rid="ggge21516-bib-0003" ref-type="ref">2016</xref>).</p>
    <p>With an increasing number of micromagnetic models being published, a number of standard tests were developed in order to ensure that the models were at least self‐consistent. Validation against these standard tests is now a prerequisite for any newly published micromagnetic code. One such test is <italic>μ</italic>MAG Standard Problem 3 (see Appendix <xref rid="ggge21516-app-0001" ref-type="app">A</xref>), which tests for the critical edge length of a cube for transition between a flower state and a vortex state. Our solutions found the flower and vortex states had equal energies at an edge length of 8.47 
<mml:math id="nlm-math-38"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> when extrapolated to an infinitely fine mesh, which is in good agreement with other submissions to the <italic>μ</italic>MAG problem.</p>
    <p>MERRILL also tests the effective field components against some analytic solutions. For example, the demagnetizing field for a uniform sphere can be written 
<mml:math id="nlm-math-39"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>dmag</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math> and should be independent of the sphere size.</p>
  </sec>
  <sec id="ggge21516-sec-0012">
    <label>6</label>
    <title>MScript: The MERRILL Scripting Language</title>
    <p>MERRILL is run at the command line with an input text file containing a series of MScript commands for MERRILL to execute. These commands allow the user to interact with MERRILL in a number of ways, for example, setting material constants, loading meshes or finding a local energy minimum. In this section, we will outline a few typical computer experiments that can be used to probe the behavior of the magnetization of magnetic materials using MERRILL. This will also serve as a brief tutorial on the MScript language and introduce some of features in MERRILL.</p>
    <p>The default units for MERRILL are microns and degrees Celsius, although different units may be used as specified in the user documentation. A full list of MERRILL commands can be found in Appendix <xref rid="ggge21516-app-0002" ref-type="app">B</xref> and on MERRILL download page (<ext-link ext-link-type="uri" xlink:href="http://www.rockmag.org">http://www.rockmag.org</ext-link>) where it will be updated as MERRILL is developed further.</p>
    <p>Some typical commands include (but are not limited to)
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><bold><italic>Magnetite</italic></bold><mml:math id="nlm-math-40"><mml:mo>〈</mml:mo></mml:math><bold><italic>temperature</italic></bold><mml:math id="nlm-math-41"><mml:mo>〉</mml:mo></mml:math><bold><italic>C</italic></bold></p><p>Set material constants to magnetite at 
<mml:math id="nlm-math-42"><mml:mo>〈</mml:mo></mml:math>
<italic>temperature</italic>
<mml:math id="nlm-math-43"><mml:mo>〉</mml:mo></mml:math> degrees Celsius.</p><p><bold><italic>Iron</italic></bold><mml:math id="nlm-math-44"><mml:mo>〈</mml:mo></mml:math><bold><italic>temperature</italic></bold><mml:math id="nlm-math-45"><mml:mo>〉</mml:mo></mml:math><bold><italic>C</italic></bold></p><p>Set material constants to iron at 
<mml:math id="nlm-math-46"><mml:mo>〈</mml:mo></mml:math>
<italic>temperature</italic>
<mml:math id="nlm-math-47"><mml:mo>〉</mml:mo></mml:math> degrees Celsius.</p><p><bold><italic>GenerateCubeMesh</italic></bold><mml:math id="nlm-math-48"><mml:mo>〈</mml:mo></mml:math><bold><italic>width</italic></bold><mml:math id="nlm-math-49"><mml:mo>〉</mml:mo></mml:math><mml:math id="nlm-math-50"><mml:mo>〈</mml:mo></mml:math><bold><italic>edgelen</italic></bold><mml:math id="nlm-math-51"><mml:mo>〉</mml:mo></mml:math></p><p>Generate a cubic geometry of width 
<mml:math id="nlm-math-52"><mml:mo>〈</mml:mo></mml:math>
<italic>width</italic>
<mml:math id="nlm-math-53"><mml:mo>〉</mml:mo></mml:math> and with the average length between mesh nodes of length 
<mml:math id="nlm-math-54"><mml:mo>〈</mml:mo></mml:math>
<italic>edgelen</italic>
<mml:math id="nlm-math-55"><mml:mo>〉</mml:mo></mml:math>.</p><p><bold><italic>Uniform Magnetization</italic></bold><mml:math id="nlm-math-56"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></p><p>Set the magnetization of the material to
<disp-formula id="ggge21516-disp-0015"><mml:math id="nlm-math-57"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula>
</p><p><bold><italic>Minimize</italic></bold></p><p>Run the minimizer to find the local energy minimum.</p><p><bold><italic>WriteMagnetization</italic></bold><mml:math id="nlm-math-58"><mml:mo>〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-59"><mml:mo>〉</mml:mo></mml:math></p><p>Write the magnetization to disk. Two files are written, 
<mml:math id="nlm-math-60"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-61"><mml:mo>〉</mml:mo></mml:math>.dat and 
<mml:math id="nlm-math-62"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-63"><mml:mo>〉</mml:mo></mml:math>_mult.tec. The file 
<mml:math id="nlm-math-64"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-65"><mml:mo>〉</mml:mo></mml:math>.dat contains a list of vertex points and the magnetization at that point. This is suitable for use with the <italic>ReadMagnetization</italic> command (see below). The 
<mml:math id="nlm-math-66"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-67"><mml:mo>〉</mml:mo></mml:math>_mult.tec file is the mesh and the magnetization in a TecPlot file format. This can be read by a number of visualization tools, including the free, open source and cross‐platform ParaView software (Ahrens et al., <xref rid="ggge21516-bib-0001" ref-type="ref">2005</xref>).</p><p><bold><italic>ReadMagnetization</italic></bold><mml:math id="nlm-math-68"><mml:mo>〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-69"><mml:mo>〉</mml:mo></mml:math></p><p>Read a previously written file 
<mml:math id="nlm-math-70"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-71"><mml:mo>〉</mml:mo></mml:math> from the <italic>WriteMagnetization</italic> command, and set the current magnetization based on that.</p><p><bold><italic>External Field Direction</italic></bold><mml:math id="nlm-math-72"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></p><p>Set the Zeeman field direction to
<disp-formula id="ggge21516-disp-0016"><mml:math id="nlm-math-73"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula>
</p><p><bold><italic>External Field Strength</italic></bold><mml:math id="nlm-math-74"><mml:mo>〈</mml:mo></mml:math><bold><italic>magnitude</italic></bold><mml:math id="nlm-math-75"><mml:mo>〉</mml:mo></mml:math><bold><italic>mT</italic></bold></p><p>Set the Zeeman field strength to
<disp-formula id="ggge21516-disp-0017"><mml:math id="nlm-math-76"><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>〈</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></disp-formula>
</p></boxed-text>
</p>
    <p>MScript also includes supports for variables and loops. For example, the script 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><bold>Loop</bold> myvalue 0 100 10</monospace></p><p><bold>Print</bold><monospace>#myvalue</monospace></p><p><bold>EndLoop</bold></p></boxed-text>
</p>
    <p>creates a loop with the local variable myvalue. The numbers in the loop command determine initial value, end value and step size, such that the above loop prints out the values 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, and 100. To distinguish between floating point, integer and string values, the variable <italic>myvalue</italic> can be referred to as <monospace>%myvalue</monospace>, <monospace>#myvalue</monospace>, and <monospace>$myvalue$</monospace>, depending on what is needed. For example, in 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><bold>Loop</bold> myvalue 0 100 10</monospace></p><p><monospace><bold>WriteMagnetization</bold> SolnFileA_%myvalue</monospace></p><p><monospace><bold>WriteMagnetization</bold> SolnFileB_#myvalue</monospace></p><p><bold>EndLoop</bold></p></boxed-text>
</p>
    <p>the filenames written to by the two <bold>WriteMagnetization</bold> commands are quite different. The argument <monospace>SolnFileA_%myvalue</monospace> produces filenames of the form SolnFileA_+0.10000E2 when myvalue is 10, while the argument <monospace>SolnFileB_#myvalue</monospace> produces filename of the form SolnFileB_10.</p>
    <sec id="ggge21516-sec-0013">
      <label>6.1</label>
      <title>Minimization</title>
      <p>A basic minimization from a random start, or a uniformly magnetized start can be a quick way to tell if a grain is in the SD or PSD size range. Moreover, it is the basic building block from which most other MERRILL modeling experiments come.</p>
      <p>A simple minimization script to determine a LEM state from a random initial state for a meshed geometry can be given as follows:
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><italic>! Setup material constants for Iron</italic></monospace></p><p><monospace><italic>! at 20 Degrees Celsius</italic></monospace></p><p><monospace><bold>Iron</bold> 20 C</monospace></p><p><monospace><italic>! Load the meshed geometry from a</italic></monospace></p><p><monospace><italic>! Patran Neutral file</italic></monospace></p><p><monospace><bold>ReadMesh</bold> 1 mesh.neu</monospace></p><p><monospace><italic>! Randomize the magnetization</italic></monospace></p><p><monospace><bold>Randomize All Moments</bold></monospace></p><p><monospace><italic>! Run the minimizer</italic></monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><italic>! Output the solution M to two files</italic>:</monospace></p><p><monospace><italic>! soln.dat and soln_mult.tec</italic>.</monospace></p><p><monospace><italic>! The soln.dat file can be used as the</italic></monospace></p><p><monospace><italic>! input for another run as, e.g., an</italic></monospace></p><p><monospace><italic>! initial guess. soln_mult.tec is a</italic></monospace></p><p><monospace><italic>! TecPlot format file which can be used</italic></monospace></p><p><monospace><italic>! to view the solution in a visualization</italic></monospace></p><p><monospace><italic>! program such as ParaView</italic></monospace></p><p><monospace><italic>! (which is free and open source!)</italic></monospace></p><p><monospace><bold>WriteMagnetization</bold> soln</monospace></p></boxed-text>
</p>
      <p>The output of this script can be seen in Figure <xref rid="ggge21516-fig-0002" ref-type="fig">2</xref> using a mesh generated from experimental focused ion beam nanotomography data for an example iron inclusion in dusty olivine in a chondritic meteor sample (Einsle et al., <xref rid="ggge21516-bib-0016" ref-type="ref">2016</xref>).</p>
      <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0002" orientation="portrait" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Minimization of an iron inclusion from a dusty olivine sample at 20 C with random initial magnetization. The shape is approximately a prolate ellipsoid with semimajor axes of 0.134 and 0.126 μm, and semiminor axis of 0.085 μm, with axes aligned along the cardinal directions. The LEM is a single vortex state with core aligned along the semiminor axis.</p>
        </caption>
        <graphic id="nlm-graphic-3" xlink:href="GGGE-19-1080-g002"/>
      </fig>
      <p>It is important to note that there may be several possible magnetization states the minimization might settle upon, representing multiple possible, and completely valid local energy minima states. However, from a given starting point, barring numerical noise, the minimization should always reach the same end point.</p>
      <p>The LEM found can be highly dependent on the choice of initial state. A simple minimization script to determine a LEM state for a cubic grain of magnetite, starting with uniform magnetization, can be given as follows:
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><italic>! Setup material constants for Magnetite</italic></monospace></p><p><monospace><italic>! at 20 Degrees Celsius</italic></monospace></p><p><monospace><bold>Magnetite</bold> 20 C</monospace></p><p><monospace><italic>! Generate a.08 micron cube using the</italic></monospace></p><p><monospace><italic>! built‐in cube mesh with mesh size 5 ∼nm</italic></monospace></p><p><monospace><italic>! generator</italic></monospace></p><p><monospace><bold>GenerateCubeMesh</bold> 0.080 0.005</monospace></p><p><monospace><italic>! A flower state will nucleate from a</italic></monospace></p><p><monospace><italic>! uniform magnetization along the</italic></monospace></p><p><italic>! easy axis</italic></p><p><monospace><bold>Uniform Magnetization</bold> 1 1 1</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><bold>WriteMagnetization</bold> flower_soln</monospace></p></boxed-text>
</p>
      <p>The output of this script can be seen in Figure <xref rid="ggge21516-fig-0003" ref-type="fig">3</xref>, representing a flower state.</p>
      <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0003" orientation="portrait" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Minimization of a 0.08 μm cube of Magnetite to a flower state from an initial uniform [111] magnetization.</p>
        </caption>
        <graphic id="nlm-graphic-5" xlink:href="GGGE-19-1080-g003"/>
      </fig>
      <p>By starting from a rough vortex state rather than a uniform state, we can instead nucleate a vortex LEM. This can be accomplished by 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><bold>Magnetite</bold> 20 C</monospace></p><p><monospace><bold>GenerateCubeMesh</bold> 0.080 0.005</monospace></p><p><monospace><italic>! A vortex state will nucleate from a</italic></monospace></p><p><monospace><italic>! rough vortex state with core aligned</italic></monospace></p><p><monospace><italic>! along the easy axis</italic></monospace></p><p><monospace><italic>! The 1 1 1 refers to the direction,</italic></monospace></p><p><monospace><italic>! 0.02 is the “tightness,” which should</italic></monospace></p><p><monospace><italic>! by manually tuned by the user, and</italic></monospace></p><p><monospace><italic>! LH will produce a left hand vortex</italic></monospace>.</p><p><monospace><bold>Vortex Magnetization</bold> 1 1 1 0.02 LH</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><bold>WriteMagnetization</bold> vortex_soln</monospace></p></boxed-text>
</p>
      <p>The output of this new script (seen in Figure <xref rid="ggge21516-fig-0004" ref-type="fig">4</xref>) highlights the “local” aspect of a local energy minimum.</p>
      <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0004" orientation="portrait" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Minimization of a 0.08 μm cube of Magnetite to a vortex state from an initial approximate [111] aligned vortex state, colored by helicity (
<mml:math id="nlm-math-77"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>).</p>
        </caption>
        <graphic id="nlm-graphic-7" xlink:href="GGGE-19-1080-g004"/>
      </fig>
    </sec>
    <sec id="ggge21516-sec-0014">
      <label>6.2</label>
      <title>Hysteresis Loops</title>
      <p>Hysteresis loops are a useful tool when a magnetic material has several remanent magnetization states for a given set of parameters. From a hysteresis loop, it is possible to deterministically move from one state to another, and find the tipping point where the variation of a given parameter will cause one state to spontaneously switch to the other. This also provides information on the range of values for the given parameter where both states can coexist. In other words, it provides some information about the stability of a given state when multiple valid states exist.</p>
      <p>Since the minimization should always reach the same solution when given the same starting point, a hysteresis loop run with the same parameters and the same changes in parameters should always return the same results in MERRILL.</p>
      <sec id="ggge21516-sec-0015">
        <label>6.2.1</label>
        <title>Magnetic Field Hysteresis</title>
        <p>A magnetic hysteresis loop has several uses. A single hysteresis loop can be useful to get a feel for the behavior of the magnetization of a system (i.e., its coercivity, if it is SD or PSD). The average of hysteresis loops in many directions can be used to compare simulations with experimental observations of magnetic characteristics such as coercivity.</p>
        <p>A hysteresis loop is a quasi‐static thermodynamic process. That is to say, at each point of the hysteresis loop, the system is assumed to be in equilibrium and the energy at a local energy minimum. A change from one point to the next in a hysteresis loop represents the system moving from what was a local energy minimum in the previous step to the nearest, new local energy minimum in the current step.</p>
        <p>The simulation of a hysteresis loop is accomplished by the following scheme:
<list list-type="order" id="ggge21516-list-0002"><list-item id="ggge21516-li-0004"><p>Set Zeeman field to saturating value in a fixed direction: Z = Zmax.</p></list-item><list-item id="ggge21516-li-0005"><p>Find LEM.</p></list-item><list-item id="ggge21516-li-0006"><p>Update Zeeman field: Z = Z − a*Zmax.</p></list-item><list-item id="ggge21516-li-0007"><p>If Z != −Zmax, go to 2.</p></list-item></list>
</p>
        <p>For a saturating field 
<mml:math id="nlm-math-78"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math>, a hysteresis loop will run from 
<mml:math id="nlm-math-79"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math> to −
<mml:math id="nlm-math-80"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math> in small increments. Here “small” means sufficiently small enough that any phenomenon sensitive to the external field, e.g., magnetization switching or nucleation of vortices, are accounted for. In practice, “small” means just small enough to resolve changes in the magnetization you are looking for, but as large as possible to reduce the total number of steps needed for the loop. Otherwise a large amount of work may be done unnecessarily for little progress.</p>
        <p>A MERRILL script which accomplishes this is 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><bold>Magnetite</bold> 20 C</monospace></p><p><monospace><bold>GenerateCubeMesh</bold> 0.100 0.005</monospace></p><p><monospace><bold>External Field Direction</bold> 1 0 0</monospace></p><p><monospace><bold>External Field Strength</bold> 0 mT</monospace></p><p><monospace><bold>Loop</bold> field −100 100 5</monospace></p><p><monospace><bold>Randomize Magnetization</bold> 10</monospace></p><p><monospace><bold>External Field</bold> Strength</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><italic>! Write current value to disk</italic>,</monospace></p><p><monospace><italic>! so we can inspect it later</italic>.</monospace></p><p><monospace><bold>WriteHyst</bold> hyst_soln</monospace></p><p><monospace><bold>EndLoop</bold></monospace></p></boxed-text>
</p>
        <p>Since hysteresis is generally symmetrical to forward and reverse fields, it is only necessary to run either the upper or lower branch of the hysteresis loop, not both.</p>
        <p>A plot of the upper branch is shown in Figure <xref rid="ggge21516-fig-0005" ref-type="fig">5</xref>. This curve is different to the usual SD curve, where the value 
<mml:math id="nlm-math-81"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math> remains near the saturation value, until passing the coercive field. Here the grain enters a vortex state, and the value 
<mml:math id="nlm-math-82"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math> can minimized while keeping the anisotropy energy relatively low by varying the shape of the vortex. An example of the vortex state at 
<mml:math id="nlm-math-83"><mml:mrow><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math> mT is shown in Figure <xref rid="ggge21516-fig-0006" ref-type="fig">6</xref>.</p>
        <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0005" orientation="portrait" position="float">
          <label>Figure 5</label>
          <caption>
            <p>The lower branch of a hysteresis loop with respect to an external magnetic field, varying from −100 to 100 mT for a 0.1 μm sphere of magnetite. The arrow denotes the direction of change of 
<mml:math id="nlm-math-84"><mml:mrow><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math> during the loop.</p>
          </caption>
          <graphic id="nlm-graphic-9" xlink:href="GGGE-19-1080-g005"/>
        </fig>
        <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0006" orientation="portrait" position="float">
          <label>Figure 6</label>
          <caption>
            <p>Magnetization of a 0.1 μm sphere of magnetite at 
<mml:math id="nlm-math-85"><mml:mrow><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math> mT during a field hysteresis from 
<mml:math id="nlm-math-86"><mml:mrow><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math> mT to <italic>H</italic> = 100 mT, colored by helicity (
<mml:math id="nlm-math-87"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>).</p>
          </caption>
          <graphic id="nlm-graphic-11" xlink:href="GGGE-19-1080-g006"/>
        </fig>
      </sec>
      <sec id="ggge21516-sec-0016">
        <label>6.2.2</label>
        <title>Size Hysteresis</title>
        <p>A hysteresis loop where the size of the grain is varied rather than an external field can be a useful tool for determining SD and PSD ranges, and the evolution of magnetic domain states. Since several remanent states can exist for a grain, particularly in the early PSD size range, it can be difficult to pinpoint exactly where that regime begins.</p>
        <p>In a size hysteresis loop, the grain is started in an SD magnetization state. The size of the grain is increased until it spontaneously switches to a vortex PSD state. The size of the grain is then scaled down until it is in a SD state again. The branch of increasing size can tell us what the largest grain size is that supports an SD state, and the branch of decreasing size can tell us what the smallest grain size is that supports a PSD state.</p>
        <p>Note that the exact initial SD was not defined. Ideally, a size hysteresis should be run for each possible SD remanent state. For symmetric grains, symmetry should make many of these redundant. However, for asymmetric grains, the direction of the initial magnetization may greatly affect the stability of the SD solution.</p>
        <p>When scaling sizes, it is important to consider the size of the elements of the mesh during scaling. Typically, the edges of a mesh should be around the exchange length. When the size of a mesh is increased, the average edge length should not exceed the exchange length. By starting with a larger mesh and scaling down, rather than the other way around, we can avoid this problem. However, finer meshes take longer to run. A compromise can be found using the “Remesh” command. A user might use a mesh that is suitable for scaling up to, e.g., 0.1 μm, and at that size, switch to a mesh suitable for up to, e.g., 0.2 μm.</p>
        <p>So if we want a maximum node spacing of, e.g., 0.005 μm, we make two meshes of width 0.1 μm: one with node spacing 0.005 μm, and one with node spacing of 0.0025 μm. The first mesh will cover grains from 0 to 0.1 μm, while the second can cover grains from 0.1 to 0.2 μm. We make the meshes the same initial size so the Remesh command can interpolate the magnetization directly from one to the other.</p>
        <p>In MERRILL, the “Resize” command can be used to scale the mesh. An example size hysteresis script incorporating all of this is 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><italic>! Use magnetite material parameters</italic></monospace></p><p><monospace><bold>Magnetite</bold> 20 C</monospace></p><p><monospace><italic>! Ensure we can load at least 2 meshes</italic></monospace></p><p><monospace><italic>! at a time</italic></monospace></p><p><monospace><bold>Set MaxMeshNumber</bold> 2</monospace></p><p><monospace><italic>! Load 0.1 um mesh with 0.005 um node</italic></monospace></p><p><monospace><italic>! spacing, suitable for scaling up to</italic></monospace></p><p><monospace><italic>! 0.1 um, into slot 1</italic></monospace></p><p><monospace><bold>ReadMesh</bold> 1 octahedron_0.1um_0.005um.neu</monospace></p><p><monospace><italic>! Load 0.1 um mesh with 0.0025 um node</italic></monospace></p><p><monospace><italic>! spacing, suitable for scaling up to</italic></monospace></p><p><monospace><italic>! 0.2 um, into slot 2</italic></monospace></p><p><monospace><bold>ReadMesh</bold> 2 octahedron_0.1um_0.0025um.neu</monospace></p><p><monospace><italic>! Set reference size of the meshes to 100</italic>.</monospace></p><p><monospace><italic>! We'll be scaling from 10 to 200</italic>.</monospace></p><p><monospace><italic>! In this case, 100 will be 0.1 um</italic>,</monospace></p><p><monospace><italic>! 10 will be 0.01 um, and 200 will be</italic></monospace></p><p><monospace><italic>! 0.2 um</italic>.</monospace></p><p><monospace><bold>define</bold> refsize 100</monospace></p><p><monospace><italic>! Make sure mesh 1 is loaded</italic></monospace></p><p><monospace><bold>LoadMesh</bold> 1</monospace></p><p><monospace><italic>! Set initial magnetization to [111]</italic></monospace></p><p><monospace><bold>Uniform Magnetization</bold> 1 1 1</monospace></p><p><monospace><italic>! Loop from 10 to 100 in steps of 10 for</italic></monospace></p><p><monospace><italic>! the 0.005 um mesh</italic></monospace></p><p><monospace><bold>Loop</bold> meshsize 10 100 10</monospace></p><p><monospace><italic>! Resize our mesh to the current</italic></monospace></p><p><monospace><italic>! %meshsize</italic></monospace></p><p><monospace><italic>! For #meshsize 20, for example</italic>,</monospace></p><p><monospace><italic>! the 0.1 um mesh is scaled to</italic></monospace></p><p><monospace><italic>! 0.02 um</italic>.</monospace></p><p><monospace><bold>Resize</bold> #refsize #meshsize</monospace></p><p><monospace><italic>! Give the magnetization a small kick</italic></monospace></p><p><monospace><bold>Randomize Magnetization</bold> 5</monospace></p><p><monospace>! Run the minimization</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><italic>! Write the output to a file</italic></monospace></p><p><monospace><bold>WriteMagnetization</bold> up_0.$meshsize$um</monospace></p><p><monospace><italic>! Resize the mesh back to its original</italic></monospace></p><p><monospace><italic>! size, for the next loop iteration</italic></monospace></p><p><monospace><bold>Resize</bold> #meshsize #refsize</monospace></p><p><monospace><bold>EndLoop</bold></monospace></p><p><monospace><italic>!</italic></monospace></p><p><monospace><italic>! Hand off to the 0.0025 um mesh</italic></monospace></p><p><monospace><italic>!</italic></monospace></p><p><monospace><italic>! Interpolate the current magnetization to</italic></monospace></p><p><monospace><italic>! mesh 2 and load it</italic></monospace></p><p><monospace><bold>Remesh</bold> 2</monospace></p><p><monospace><italic>! Loop from 110 to 200 in steps of 10 for</italic></monospace></p><p><monospace><italic>! the 0.0025 um mesh</italic></monospace></p><p><monospace><bold>Loop</bold> meshsize 110 200 10</monospace></p><p><monospace><bold>Resize</bold> #refsize #meshsize</monospace></p><p><monospace><bold>Randomize Magnetization</bold> 5</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><bold>WriteMagnetization</bold> up_0.$meshsize$um</monospace></p><p><monospace><bold>Resize</bold> #meshsize #refsize</monospace></p><p><monospace><bold>EndLoop</bold></monospace></p><p><monospace><italic>! Small to large done</italic>.</monospace></p><p><monospace><italic>! Now do large to small</italic>.</monospace></p><p><monospace><italic>! Loop over 0.0025 um mesh</italic></monospace></p><p><monospace><bold>Loop</bold> meshsize 200 110 −10</monospace></p><p><monospace><bold>Resize</bold> #refsize #meshsize</monospace></p><p><monospace><bold>Randomize Magnetization</bold> 5</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><bold>WriteMagnetization</bold> down_0.$meshsize$um</monospace></p><p><monospace><bold>Resize</bold> #meshsize #refsize</monospace></p><p><monospace>EndLoop</monospace></p><p><monospace><italic>! Hand off to 0.1 um mesh</italic></monospace></p><p><monospace><bold>Remesh 1</bold></monospace></p><p><monospace><italic>! Loop over 0.1 um mesh</italic></monospace></p><p><monospace><bold>Loop</bold> meshsize 100 10 −10</monospace></p><p><monospace><bold>Resize</bold> #refsize #meshsize</monospace></p><p><monospace><bold>Randomize Magnetization</bold> 5</monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><bold>WriteMagnetization</bold> down_0.$meshsize$um</monospace></p><p><monospace><bold>Resize</bold> #meshsize #refsize</monospace></p><p><monospace><bold>EndLoop</bold></monospace></p></boxed-text>
</p>
        <p>A graph of the saturation magnetization versus the grain size is shown in Figure <xref rid="ggge21516-fig-0007" ref-type="fig">7</xref>, with three distinct magnetic phases marked: a flower state (FS), a hard‐aligned single vortex (HSV), and an easy‐aligned easy vortex state (ESV). A comparison of the upper and lower branches at 0.13 μm and at 0.15 μm, are shown in Figure <xref rid="ggge21516-fig-0008" ref-type="fig">8</xref>, demonstrating the ESV and HSV states for the lower branch, and the corresponding FS states on the upper branch.</p>
        <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0007" orientation="portrait" position="float">
          <label>Figure 7</label>
          <caption>
            <p>A full hysteresis loop of saturation magnetization versus size for an octahedral grain of magnetite. Three distinct magnetic phases are marked: a flower state (FS), a hard‐aligned single vortex state (HSV), and an easy‐aligned single vortex state (ESV).</p>
          </caption>
          <graphic id="nlm-graphic-13" xlink:href="GGGE-19-1080-g007"/>
        </fig>
        <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0008" orientation="portrait" position="float">
          <label>Figure 8</label>
          <caption>
            <p>Comparison of upper and lower branch results for a size hysteresis of an octahedral grain of magnetite. The upper branch goes from small to large, and the lower branch goes from large to small. (a) The upper branch at 0.13 μm, (b) the lower branch at 0.13 μm, (c) the upper branch at 0.15 μm, and (d) the lower branch at 0.15 μm. The coloring is helicity (
<mml:math id="nlm-math-88"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>).</p>
          </caption>
          <graphic id="nlm-graphic-15" xlink:href="GGGE-19-1080-g008"/>
        </fig>
      </sec>
      <sec id="ggge21516-sec-0017">
        <label>6.2.3</label>
        <title>Temperature Hysteresis</title>
        <p>A temperature hysteresis can be used to observe the effects of heating, say iron, from room temperature to the Curie temperature and back. The approach MERRILL takes to this is to simply change the temperature dependant material parameters for each step. In this way, the model is of a “cold” material, since no other thermal effects are taken into account which might spontaneously and nondeterministically effect the magnetization. However, the changes in material properties can have significant impact on the shape of the energy landscape with respect to the depths, positions and even number of the local energy minima.</p>
        <p>An example temperature hysteresis of iron is 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><bold>GenerateCubeMesh</bold> 0.18 0.005</monospace></p><p><monospace><bold>Uniform Magnetization</bold> 1 1 1</monospace></p><p><monospace><bold>Loop</bold> temperature 20 770 10</monospace></p><p><monospace><italic>! Set the material parameters for iron</italic></monospace></p><p><monospace><italic>! at the given temperature</italic></monospace></p><p><monospace><bold>Iron</bold> %temperature C</monospace></p><p><monospace><italic>! Find the LEM</italic></monospace></p><p><monospace><bold>Minimize</bold></monospace></p><p><monospace><italic>! Write current value to disk, so we</italic></monospace></p><p><monospace><italic>! can inspect it later</italic></monospace>.</p><p><monospace><bold>WriteHyst</bold> hyst_soln_#temperature</monospace></p><p><monospace><bold>EndLoop</bold></monospace></p></boxed-text>
</p>
      </sec>
    </sec>
    <sec id="ggge21516-sec-0018">
      <label>6.3</label>
      <title>Energy Barriers</title>
      <p>MERRILL includes a new method for finding the minimum energy transition between two given LEM states (K. Fabian &amp; V. P. Shcherbakov, Energy barriers in three‐dimensional micromagnetic models and the physics of thermo‐viscous magnetization in multidomain particles, arXiv 1702.00070v1, 2017). It uses a combination of the Nudged Elastic Band technique (Dittrich et al., <xref rid="ggge21516-bib-0013" ref-type="ref">2002</xref>; Henkelman &amp; Jónsson, <xref rid="ggge21516-bib-0025" ref-type="ref">2000</xref>) and an action minimization method (Berkov, <xref rid="ggge21516-bib-0004" ref-type="ref">1998a</xref>, <xref rid="ggge21516-bib-0005" ref-type="ref">1998b</xref>; Fabian &amp; Shcherbakov, arXiv 1702.00070v1, 2017). It finally constructs a prescribed number of intermediary states between the given LEM states <italic>L</italic>
<sub>1</sub>, <italic>L</italic>
<sub>2</sub>, such that their interpolation represents the average physical switching path for a fully damped (<italic>λ</italic> = 0) switching process from <italic>L</italic>
<sub>1</sub> to <italic>L</italic>
<sub>2</sub>. The path with the lowest maximum energy barrier determines the thermal activation energy required to switch between these states. From that, the probability of switching and the relaxation time across the energy barrier can be obtained.</p>
      <p>These quantities are of paramount importance in paleomagnetism, where small changes in size, shape, or material parameters can change the relaxation time from the order of seconds, to millions of years, and the corresponding paleomagnetic information is either completely unblocked, or can be regarded as stable or blocked. In contrast to, for example, the simulation of writing heads for magnetic hard drives, the nanosecond dynamics of the switching processes are of no interest in paleomagnetism, such that time‐consuming full‐fledged LLG models do not improve the result. On the contrary, the exact determination of the energy barrier through the saddle‐point path provides a better estimate of the thermal relaxation time. Note in that respect that the LLG equation does not include temperature, and that thermal activation has to be added in a phenomenological way, e.g., as a stochastic zero‐mean Gaussian fluctuation field (Torres et al., <xref rid="ggge21516-bib-0048" ref-type="ref">2001</xref>), if it is considered at all.</p>
      <p>If morphology and composition of a natural magnetic mineral system is known MERRILL can provide quantitative insight to whether the signal recorded has remained stable since it was recorded (Nagy et al., <xref rid="ggge21516-bib-0039" ref-type="ref">2017</xref>).</p>
      <p>An example script for a NEB calculation is 
<boxed-text position="anchor" content-type="box" orientation="portrait"><p><monospace><italic>! Use only one mesh for this NEB</italic></monospace></p><p><monospace><italic>! minimization</italic></monospace></p><p><monospace><bold>Set MaxMeshNumber</bold> 1</monospace></p><p><monospace><italic>! Read in the mesh</italic></monospace></p><p><monospace><bold>ReadMesh</bold> 1 model.neu</monospace></p><p><monospace><italic>! Set the maximum number of energy</italic></monospace></p><p><monospace><italic>! evaluations for LEM/path calculations</italic></monospace></p><p><monospace><bold>Set MaxEnergyEvaluations</bold> 10000</monospace></p><p><monospace><bold>Set MaxPathEvaluations</bold> 1000</monospace></p><p><monospace><italic>! Set the material parameters using a</italic></monospace></p><p><italic>! predefined material (iron)</italic></p><p><monospace><bold>Iron</bold> 20 C</monospace></p><p><monospace><italic>! Define an initial path containing only</italic></monospace></p><p><monospace><italic>! two points (the start and end points)</italic></monospace></p><p><monospace><bold>Set PathN 2</bold></monospace></p><p><monospace><italic>! Read in the start structure from a</italic></monospace></p><p><monospace><italic>! magnetization file &amp; store as path</italic></monospace></p><p><italic>! point 1</italic></p><p><monospace><bold>ReadMagnetization</bold> start_mag</monospace></p><p><monospace><bold>MagnetizationToPath</bold> 1</monospace></p><p><monospace><italic>! Read in the end structure from a</italic></monospace></p><p><monospace><italic>! magnetization file &amp; store as path</italic></monospace></p><p><monospace><italic>! point 2</italic></monospace></p><p><monospace><bold>ReadMagnetization</bold> end_mag</monospace></p><p><monospace><bold>MagnetizationToPath</bold> 2</monospace></p><p><monospace><italic>! Define the energy log output file</italic></monospace></p><p><monospace><bold>EnergyLog</bold> nebinitial_energy</monospace></p><p><monospace><italic>! Refine the path to 100 structures (98</italic></monospace></p><p><monospace><italic>! intermediate structures are created)</italic></monospace></p><p><monospace><bold>RefinePathTo</bold> 100</monospace></p><p><monospace><italic>! Set the minimization to use conjugate</italic></monospace></p><p><monospace><italic>! gradient</italic></monospace></p><p><monospace><bold>ConjugateGradient</bold></monospace></p><p><monospace><italic>! Set the exchange calculator to the</italic></monospace></p><p><monospace><italic>! typical one (default)</italic></monospace></p><p><monospace><bold>Set ExchangeCalculator</bold> 1</monospace></p><p><monospace><italic>! Generate an initial path and save the</italic></monospace></p><p><monospace><italic>! initial path</italic></monospace></p><p><monospace><bold>MakeInitialPath</bold></monospace></p><p><monospace><bold>WriteTecPlotPath</bold> initialpath.tec</monospace></p><p><monospace><italic>! Run the NEB using the initial and write</italic></monospace></p><p><monospace><italic>! the output file</italic></monospace></p><p><monospace><bold>PathMinimize</bold></monospace></p><p><monospace><bold>WriteTecPlotPath</bold> finalpath.tec</monospace></p><p><monospace><italic>! Output the energy of each point of the</italic></monospace></p><p><monospace><italic>! path to disk</italic></monospace>.</p><p><monospace><bold>PathStructureEnergies</bold> energies </monospace></p></boxed-text>
</p>
    </sec>
  </sec>
  <sec id="ggge21516-sec-0019">
    <label>7</label>
    <title>Practical Considerations</title>
    <p>There are a number of practical considerations when using MERRILL. Presently, MERRILL is not parallelized. However, many instances of MERRILL may be run in task‐farm parallel manner for reasonably small grains. This approach can be used to model, for example, large assemblies of noninteracting grains, and hysteresis loops about many axes in parallel. The maximum grain size that you will be able to model will be dependent on a number of factors, but primarily the number of elements in the model. MERRILL will comfortably cope with models of up to approximately 10<sup>6</sup> elements for single grain of simple geometry on a machine with access to 64 GB of RAM (see Figure <xref rid="ggge21516-fig-0009" ref-type="fig">9</xref>). If the model consists of a cluster particles where the total grain surface to volume ratio is significantly greater than that of a single grain then the maximum number of elements in the model would need to be less than 10<sup>6</sup>. It is not possible to formulate any hard rules that cover the combination of different number of particles, grain sizes and mesh sizes, but the user should be aware that the memory requirement increases as the square of the number of surface nodes (which is typically proportional to the number of surface elements).</p>
    <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0009" orientation="portrait" position="float">
      <label>Figure 9</label>
      <caption>
        <p>A log‐log plot of the time taken for MERRILL to find a local energy minimum of a cube, starting from a random state, versus the number of elements in the mesh.</p>
      </caption>
      <graphic id="nlm-graphic-17" xlink:href="GGGE-19-1080-g009"/>
    </fig>
    <p>The time taken for a model to converge on a local energy minimum will again be largely dependent on the model size (see Figure <xref rid="ggge21516-fig-0009" ref-type="fig">9</xref>), but also on how close your initial guess is to the final LEM solution. Thus solution times for a random initial guess and a uniform saturated state initial guess can have significantly different solution times. A similar situation occurs during a change in the magnetic phase, i.e., when a solution changes from SD to SV, or hard‐aligned SV to easy‐aligned SV.</p>
    <p>In rare cases, the model might attempt a large number of iterations because of slow convergence to the final solution. In such cases it is better to place a limit in on the maximum number of allowed iterations (which has default value of 100,000). Often such slowly converging solutions can be avoided by trying a slightly different initial guess, slightly changing the model mesh, or adding a small random kick to the solution.</p>
    <p>As mentioned in section <xref rid="ggge21516-sec-0010" ref-type="sec">4</xref>, the mesh shape and quality also impact on convergence times. Regular tetrahedra are the most numerically stable elements, so the more regular the tetrahedra in a mesh, the quicker the model will converge. The single most important concern, however, is to avoid slivers. Slivers are elements that are so flat, their volumes approach zero (Alliez et al., <xref rid="ggge21516-bib-0002" ref-type="ref">2017</xref>). These lead to extreme numerical instability and very slow convergence times, if the model converges at all. Slivers might occur during Delaunay triangulation, as the algorithm is well known to be blind to a class of slivers where the vertices all lie on the same circumcircle. An additional mesh optimization step like Lloyd optimization, or ODT smoothing is often performed during mesh generation to eliminate slivers. Most finite element meshing packages will have algorithms that attempt to detect and avoid such elements, but in all cases when the model fails to converge it is important to check the mesh quality (e.g., using the “Mesh Quality” filter in ParaView).</p>
    <p>Also mentioned in section <xref rid="ggge21516-sec-0010" ref-type="sec">4</xref> is that mesh edge lengths should be smaller than the exchange length. In most meshing programs, it is unclear what the defined “mesh size” is. In some cases, it is the upper bound of the radius of the circumcircle of an element allowed before the element is decomposed into smaller elements. In some cases, it is the diameter of this circumcircle. For some software, it is the target average edge length of the elements in the mesh. In any case, the ReportEnergy function of MERRILL reports the average edge length of the mesh in nanometres, which is then directly comparable to the exchange length reported by this function in nanometres. Users are encouraged to use these values as a useful and direct report of whether the mesh is fine enough for the given material.</p>
    <p>The solvers used in MERRILL can be susceptible to finding unstable equilibria. Gimbal locking, for instance, can occur for field hysteresis loops directly along the hard‐axis of the material. Two simple techniques can be used to avoid this. First, prefer not to perform hysteresis loops directly along the major axes. Add a slight perturbation, i.e., use the [1 1 1.0001] direction instead of [1 1 1]. Another technique is to add a small random “kick” to the magnetization. Typically, moving each magnetization randomly by around 5 or 10 degrees is not so large that it will move the state out of a deep, stable LEM, but it can move it off a local maximum, and also out of a shallow LEM, where the magnetization is around a SD/SV phase transition.</p>
  </sec>
  <sec id="ggge21516-sec-0020">
    <label>8</label>
    <title>Discussion</title>
    <p>The formulation of a micromagnetic model in an easy to use form can significantly enhance its application in paleomagnetic and rock magnetic investigations. MERRILL presents such a tool that is particularly focused on finding remanent states and studying their stability. The parallels and usefulness to paleomagnetic and rock magnetic studies should be clear. MERRILL has been used in a number of publications and talks using functionality not presented in this paper, e.g., behaviors of assemblages of interacting grains, large models, strongly anisotropic materials and detailed simulations of magnetostrictive effects (e.g., Almeida et al., <xref rid="ggge21516-bib-0003" ref-type="ref">2016</xref>; Chang et al., <xref rid="ggge21516-bib-0007" ref-type="ref">2012</xref>; Conbhuí et al., <xref rid="ggge21516-bib-0008" ref-type="ref">2016</xref>; Einsle et al., <xref rid="ggge21516-bib-0016" ref-type="ref">2016</xref>; Li et al., <xref rid="ggge21516-bib-0032" ref-type="ref">2013</xref>; Nagy et al., <xref rid="ggge21516-bib-0039" ref-type="ref">2017</xref>; Williams et al., <xref rid="ggge21516-bib-0051" ref-type="ref">2010</xref>). Not all of these, however, used the scripting interface presented here.</p>
    <p>The simple scripting language makes it particularly friendly to nontechnical users. The fast and efficient minimization scheme means simple computer experiments can be run quite quickly. The scripts presented here represent the sort of scripts run by the authors day to day. Some effort has been made to make these copy/pasteable, but a curious reader is recommended to look in the “demo” directory of the MERRILL package for more information and examples.</p>
    <p>If the scripting language is not up to a particular task, MERRILL can also be used as a library and called from a Fortran program. In addition, a plugin interface has been included so that users can compile libraries that can be loaded from the MScript interface and hook into the MScript parser to add commands and variables, and also add effective field calculators to 
<mml:math id="nlm-math-89"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math> not originally shipped with MERRILL. This should allow MERRILL to be adopted to a wide range of problems.</p>
    <p>For viewing solutions, the authors recommend ParaView. It is a free, open source 3D viewer, easily downloaded and installed from the ParaView website, which can open and visualize solutions generated by MERRILL from the <bold>WriteMagnetization</bold> command. A plugin for ParaView for opening MERRILL solutions with some preprocessing already done can be found in the demo directory.</p>
  </sec>
</body>
<back>
  <ack id="ggge21516-sec-0034">
    <title>Acknowledgments</title>
    <p>We acknowledge Ron T. Merrill for giving his blessings to our naming of the code. We also gratefully acknowledge the following funding that has supported this work. An NGU sabbatical program and the Centre of Excellence: Arctic Gas hydrate, Environment and Climate (CAGE) funded by the Norwegian Research Council (grant 223259) to K.F.; Natural Environment Research Council (grant NE/J020966/1) and the European Research Council (grant EC320832 Imaging Magnetism in Nanostructures Using Electron Holography) to W.W. and P.Ó.C.; and National Science Foundation (grant EAR1547263 to Lisa Tauxe) to support L.N.</p>
  </ack>
  <ref-list content-type="cited-references">
    <title>References</title>
    <ref id="ggge21516-bib-0001">
      <mixed-citation publication-type="book" id="ggge21516-cit-0002"><string-name><surname>Ahrens</surname>, <given-names>J.</given-names></string-name>, 
<string-name><surname>Geveci</surname>, <given-names>B.</given-names></string-name>, &amp; 
<string-name><surname>Law</surname>, <given-names>C.</given-names></string-name> (<year>2005</year>). <chapter-title>ParaView: An end‐user tool for large data visualization</chapter-title>
<source xml:lang="en">Visualization Handbook</source>. <publisher-loc>Amsterdam, the Netherlands</publisher-loc>: <publisher-name>Elsevier</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0002">
      <mixed-citation publication-type="book" id="ggge21516-cit-0003"><string-name><surname>Alliez</surname>, <given-names>P.</given-names></string-name>, 
<string-name><surname>Jamin</surname>, <given-names>C.</given-names></string-name>, 
<string-name><surname>Rineau</surname>, <given-names>L.</given-names></string-name>, 
<string-name><surname>Tayeb</surname>, <given-names>S.</given-names></string-name>, 
<string-name><surname>Tournois</surname>, <given-names>J.</given-names></string-name>, &amp; 
<string-name><surname>Yvinec</surname>, <given-names>M.</given-names></string-name> (<year>2017</year>). <chapter-title>3D mesh generation</chapter-title> In <source xml:lang="en">CGAL user and reference manual</source> (4.11 ed.). <publisher-name>CGAL Editorial Board</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0003">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0004"><string-name><surname>Almeida</surname>, <given-names>T. P.</given-names></string-name>, 
<string-name><surname>Muxworthy</surname>, <given-names>A. R.</given-names></string-name>, 
<string-name><surname>Kovács</surname>, <given-names>A.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Nagy</surname>, <given-names>L.</given-names></string-name>, 
<string-name><surname>Conbhuí</surname>, <given-names>P. Ó.</given-names></string-name>, et al. (<year>2016</year>). <article-title>Direct observation of the thermal demagnetization of magnetic vortex structures in nonideal magnetite recorders</article-title>. <source xml:lang="en">Geophysical Research Letters</source>, <volume>43</volume>, <fpage>8426</fpage>–<lpage>8434</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/2016GL070074">https://doi.org/10.1002/2016GL070074</ext-link><pub-id pub-id-type="pmid">27867236</pub-id></mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0004">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0005"><string-name><surname>Berkov</surname>, <given-names>D.</given-names></string-name> (<year>1998a</year>). <article-title>Numerical calculation of the energy barrier distribution in disordered many‐particle systems: The path integral method</article-title>. <source xml:lang="en">Journal of Magnetism and Magnetic Materials</source>, <volume>186</volume>(<issue>1–2</issue>), <fpage>199</fpage>–<lpage>213</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0304-8853(98)00078-X">https://doi.org/10.1016/S0304-8853(98)00078-X</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0005">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0006"><string-name><surname>Berkov</surname>, <given-names>D.</given-names></string-name> (<year>1998b</year>). <article-title>Evaluation of the energy barrier distribution in many‐particle systems using the path integral approach</article-title>. <source xml:lang="en">Journal of Physics: Condensed Matter</source>, <volume>186</volume>(<issue>1–2</issue>), <fpage>L89</fpage>–<lpage>L95</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0006">
      <mixed-citation publication-type="book" id="ggge21516-cit-0007"><string-name><surname>Brown</surname>, <given-names>W. F.</given-names></string-name> (<year>1963</year>). <source xml:lang="en">Micromagnetics</source> (Vol. <volume>18</volume>). <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Interscience</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0007">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0008"><string-name><surname>Chang</surname>, <given-names>L.</given-names></string-name>, 
<string-name><surname>Roberts</surname>, <given-names>A. P.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Gerald</surname>, <given-names>J. D. F.</given-names></string-name>, 
<string-name><surname>Larrasoaña</surname>, <given-names>J. C.</given-names></string-name>, 
<string-name><surname>Jovane</surname>, <given-names>L.</given-names></string-name>, et al. (<year>2012</year>). <article-title>Giant magnetofossils and hyperthermal events</article-title>. <source xml:lang="en">Earth and Planetary Science Letters</source>, <volume>351–352</volume>, <fpage>258</fpage>–<lpage>269</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.epsl.2012.07.031">https://doi.org/10.1016/j.epsl.2012.07.031</ext-link></mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0008">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0009"><string-name><surname>Conbhuí</surname>, <given-names>P. Ó.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, &amp; 
<string-name><surname>Nagy</surname>, <given-names>L.</given-names></string-name> (<year>2016</year>). <italic>Including magnetostriction in micromagnetic models</italic> Paper presented at the EGU General Assembly Conference Abstracts, EGU General Assembly Conference Abstracts (Vol. <volume>18</volume>, p. <fpage>7754</fpage>).
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0009">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0010"><string-name><surname>Crangle</surname>, <given-names>J.</given-names></string-name>, &amp; 
<string-name><surname>Goodman</surname>, <given-names>G. M.</given-names></string-name> (<year>1971</year>). <article-title>The magnetization of pure iron and nickel</article-title>. <source xml:lang="en">Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>, <volume>321</volume>(<issue>1547</issue>), <fpage>477</fpage>–<lpage>491</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspa.1971.0044">https://doi.org/10.1098/rspa.1971.0044</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0010">
      <mixed-citation publication-type="book" id="ggge21516-cit-0011"><string-name><surname>Cullity</surname>, <given-names>B. D.</given-names></string-name>, &amp; 
<string-name><surname>Graham</surname>, <given-names>C. D.</given-names></string-name> (<year>2008</year>). <source xml:lang="en">Introduction to magnetic materials</source>. <publisher-loc>Hoboken, NJ</publisher-loc>: <publisher-name>John Wiley</publisher-name>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/9780470386323">https://doi.org/10.1002/9780470386323</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0011">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0012"><string-name><surname>Dai</surname>, <given-names>C.</given-names></string-name>, 
<string-name><surname>Liu</surname>, <given-names>H. L.</given-names></string-name>, &amp; 
<string-name><surname>Dong</surname>, <given-names>L.</given-names></string-name> (<year>2014</year>). <article-title>A comparison of objective functions of optimization‐based smoothing algorithm for tetrahedral mesh improvement</article-title>. <source xml:lang="en">Journal of Theoretical and Applied Mechanics</source>, <volume>2014</volume>(<issue>1</issue>), <fpage>1</fpage>–<lpage>163</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0012">
      <mixed-citation publication-type="book" id="ggge21516-cit-0013"><string-name><surname>Davies</surname>, <given-names>A. J.</given-names></string-name> (<year>2011</year>). <source xml:lang="en">The finite element method: An introduction with partial differential equations</source>. <publisher-loc>Cary, NC</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0013">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0014"><string-name><surname>Dittrich</surname>, <given-names>R.</given-names></string-name>, 
<string-name><surname>Schrefl</surname>, <given-names>T.</given-names></string-name>, 
<string-name><surname>Suess</surname>, <given-names>D.</given-names></string-name>, 
<string-name><surname>Scholz</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Forster</surname>, <given-names>H.</given-names></string-name>, &amp; 
<string-name><surname>Fidler</surname>, <given-names>J.</given-names></string-name> (<year>2002</year>). <article-title>A path method for finding energy barriers and minimum energy paths in complex micromagnetic systems</article-title>. <source xml:lang="en">Journal of Magnetism and Magnetic Materials</source>, <volume>250</volume>(<issue>1–3</issue>), <fpage>L12</fpage>–<lpage>L19</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0014">
      <mixed-citation publication-type="miscellaneous" id="ggge21516-cit-0015"><string-name><surname>Donahue</surname>, <given-names>M.</given-names></string-name>, &amp; 
<string-name><surname>Porter</surname>, <given-names>D.</given-names></string-name> (<year>1999</year>). <italic>OOMMF user's guide, version 1.0</italic> (Interagency Rep. NISTIR 6376). Gaithersburg, MD: National Institute of Standards and Technology.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0015">
      <mixed-citation publication-type="book" id="ggge21516-cit-0016"><string-name><surname>Dunlop</surname>, <given-names>D. J.</given-names></string-name>, &amp; 
<string-name><surname>Özdemir</surname>, <given-names>Ö.</given-names></string-name> (<year>2001</year>). <source xml:lang="en">Rock Magnetism: Fundamentals and Frontiers (Cambridge Studies in Magnetism)</source>. <publisher-loc>Cambridge, UK</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0016">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0017"><string-name><surname>Einsle</surname>, <given-names>J. F.</given-names></string-name>, 
<string-name><surname>Harrison</surname>, <given-names>R. J.</given-names></string-name>, 
<string-name><surname>Kasama</surname>, <given-names>T.</given-names></string-name>, 
<string-name><surname>Conbhuí</surname>, <given-names>P. Ó.</given-names></string-name>, 
<string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, et al. (<year>2016</year>). <article-title>Multi‐scale three‐dimensional characterization of iron particles in dusty olivine: Implications for paleomagnetism of chondritic meteorites</article-title>. <source xml:lang="en">American Mineralogist</source>, <volume>101</volume>(<issue>9</issue>), <fpage>2070</fpage>–<lpage>2084</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2138/am-2016-5738CCBY">https://doi.org/10.2138/am-2016-5738CCBY</ext-link></mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0017">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0018"><string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, 
<string-name><surname>Kirchner</surname>, <given-names>A.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Heider</surname>, <given-names>F.</given-names></string-name>, 
<string-name><surname>Leibl</surname>, <given-names>T.</given-names></string-name>, &amp; 
<string-name><surname>Huber</surname>, <given-names>A.</given-names></string-name> (<year>1996</year>). <article-title>Three‐dimensional micromagnetic calculations for magnetite using FFT</article-title>. <source xml:lang="en">Geophysical Journal International</source>, <volume>124</volume>(<issue>1</issue>), <fpage>89</fpage>–<lpage>104</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0018">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0019"><string-name><surname>Fidler</surname>, <given-names>J.</given-names></string-name>, &amp; 
<string-name><surname>Schrefl</surname>, <given-names>T.</given-names></string-name> (<year>2000</year>). <article-title>Micromagnetic modelling—The current state of the art</article-title>. <source xml:lang="en">Journal of Physics D: Applied Physics</source>, <volume>33</volume>(<issue>15</issue>), <fpage>R135</fpage>–<lpage>R156</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0022-3727/33/15/201">https://doi.org/10.1088/0022-3727/33/15/201</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0019">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0020"><string-name><surname>Fischbacher</surname>, <given-names>T.</given-names></string-name>, 
<string-name><surname>Franchin</surname>, <given-names>M.</given-names></string-name>, 
<string-name><surname>Bordignon</surname>, <given-names>G.</given-names></string-name>, &amp; 
<string-name><surname>Fangohr</surname>, <given-names>H.</given-names></string-name> (<year>2007</year>). <article-title>A systematic approach to multiphysics extensions of finite‐element‐based micromagnetic simulations: Nmag</article-title>. <source xml:lang="en">IEEE Transactions on Magnetics</source>, <volume>43</volume>(<issue>6</issue>), <fpage>2896</fpage>–<lpage>2898</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TMAG.2007.893843">https://doi.org/10.1109/TMAG.2007.893843</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0020">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0021"><string-name><surname>Fletcher</surname>, <given-names>E. J.</given-names></string-name>, &amp; 
<string-name><surname>O'Reilly</surname>, <given-names>W.</given-names></string-name> (<year>1974</year>). <article-title>Contribution of Fe<sup>2+</sup> ions to the magnetocrystalline anisotropy constant K<sub>1</sub> of Fe<sub>3–</sub>
<italic>x</italic>Ti<italic>x</italic>O<sub>4</sub> (0 &lt; <italic>x</italic> &lt; 0.1)</article-title>. <source xml:lang="en">Journal of Physics C: Solid State Physics</source>, <volume>7</volume>(<issue>1</issue>), <fpage>171</fpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0021">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0022"><string-name><surname>Fredkin</surname>, <given-names>D.</given-names></string-name>, &amp; 
<string-name><surname>Koehler</surname>, <given-names>T.</given-names></string-name> (<year>1990</year>). <article-title>Hybrid method for computing demagnetizing fields</article-title>. <source xml:lang="en">IEEE Transactions on Magnetics</source>, <volume>26</volume>(<issue>2</issue>), <fpage>415</fpage>–<lpage>417</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/20.106342">https://doi.org/10.1109/20.106342</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0022">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0023"><string-name><surname>Gilbert</surname>, <given-names>T. L.</given-names></string-name> (<year>2004</year>). <article-title>A phenomenological theory of damping in ferromagnetic materials</article-title>. <source xml:lang="en">IEEE Transactions on Magnetics</source>, <volume>40</volume>(<issue>6</issue>), <fpage>3443</fpage>–<lpage>3449</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TMAG.2004.836740">https://doi.org/10.1109/TMAG.2004.836740</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0023">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0024"><string-name><surname>Heider</surname>, <given-names>F.</given-names></string-name>, 
<string-name><surname>Dunlop</surname>, <given-names>D. J.</given-names></string-name>, &amp; 
<string-name><surname>Sugiura</surname>, <given-names>N.</given-names></string-name> (<year>1987</year>). <article-title>Magnetic properties of hydrothermally recrystallized magnetite crystals</article-title>. <source xml:lang="en">Science</source>, <volume>236</volume>(<issue>4806</issue>), <fpage>1287</fpage>–<lpage>1290</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.236.4806.1287">https://doi.org/10.1126/science.236.4806.1287</ext-link>
<pub-id pub-id-type="pmid">17770330</pub-id></mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0024">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0025"><string-name><surname>Heider</surname>, <given-names>F.</given-names></string-name>, &amp; 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name> (<year>1988</year>). <article-title>Note on temperature dependence of exchange constant in magnetite</article-title>. <source xml:lang="en">Geophysical Research Letters</source>, <volume>15</volume>(<issue>2</issue>), <fpage>184</fpage>–<lpage>187</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1029/GL015i002p00184">https://doi.org/10.1029/GL015i002p00184</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0025">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0026"><string-name><surname>Henkelman</surname>, <given-names>G.</given-names></string-name>, &amp; 
<string-name><surname>Jónsson</surname>, <given-names>H.</given-names></string-name> (<year>2000</year>). <article-title>Improved tangent estimate in the nudged elastic band method for finding minimum energy paths and saddle points</article-title>. <source xml:lang="en">Journal of Computational Physics</source>, <volume>113</volume>(<issue>22</issue>), <fpage>9978</fpage>–<lpage>9985</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0026">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0027"><string-name><surname>Honda</surname>, <given-names>K.</given-names></string-name>, 
<string-name><surname>Masumoto</surname>, <given-names>H.</given-names></string-name>, &amp; 
<string-name><surname>Kaya</surname>, <given-names>S.</given-names></string-name> (<year>1928</year>). <article-title>Magnetization of single crystal of Fe at high temperatures</article-title>. <source xml:lang="en">Science Reports of Tohoku University</source>, <volume>17</volume>, <fpage>111</fpage>–<lpage>130</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0027">
      <mixed-citation publication-type="book" id="ggge21516-cit-0028"><string-name><surname>Hubert</surname>, <given-names>A.</given-names></string-name>, &amp; 
<string-name><surname>Schäfer</surname>, <given-names>R.</given-names></string-name> (<year>1998</year>). <source xml:lang="en">Magnetic domains</source>. <publisher-loc>Berlin, Germany</publisher-loc>: <publisher-name>Springer</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0028">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0029"><string-name><surname>Kittel</surname>, <given-names>C.</given-names></string-name> (<year>1949</year>). <article-title>Physical theory of ferromagnetic domains</article-title>. <source xml:lang="en">Reviews of Modern Physics</source>, <volume>21</volume>(<issue>4</issue>), <fpage>541</fpage>–<lpage>583</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/RevModPhys.21.541">https://doi.org/10.1103/RevModPhys.21.541</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0029">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0030"><string-name><surname>Knupp</surname>, <given-names>P. M.</given-names></string-name> (<year>2006</year>). <article-title>Algebraic mesh quality metrics</article-title>. <source xml:lang="en">SIAM Journal on Scientific Computing</source>, <volume>23</volume>(<issue>1</issue>), <fpage>193</fpage>–<lpage>218</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/S1064827500371499">https://doi.org/10.1137/S1064827500371499</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0030">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0031"><string-name><surname>Kritsikis</surname>, <given-names>E.</given-names></string-name>, 
<string-name><surname>Toussaint</surname>, <given-names>J.‐C.</given-names></string-name>, 
<string-name><surname>Fruchart</surname>, <given-names>O.</given-names></string-name>, 
<string-name><surname>Szambolics</surname>, <given-names>H.</given-names></string-name>, &amp; 
<string-name><surname>Buda‐Prejbeanu</surname>, <given-names>L.</given-names></string-name> (<year>2008</year>). <article-title>Fast computation of magnetostatic fields by nonuniform fast fourier transforms</article-title>. <source xml:lang="en">Applied Physics Letters</source>, <volume>93</volume>(<issue>13</issue>), <fpage>132508</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.2995850">https://doi.org/10.1063/1.2995850</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0031">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0032"><string-name><surname>Labrune</surname>, <given-names>M.</given-names></string-name>, &amp; 
<string-name><surname>Miltat</surname>, <given-names>J.</given-names></string-name> (<year>1990</year>). <article-title>Micromagnetics of strong stripe domains in NiCo thin films</article-title>. <source xml:lang="en">IEEE Transactions on Magnetics</source>, <volume>26</volume>(<issue>5</issue>), <fpage>1521</fpage>–<lpage>1523</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/20.104432">https://doi.org/10.1109/20.104432</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0032">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0033"><string-name><surname>Li</surname>, <given-names>J.</given-names></string-name>, 
<string-name><surname>Ge</surname>, <given-names>K.</given-names></string-name>, 
<string-name><surname>Pan</surname>, <given-names>Y.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Liu</surname>, <given-names>Q.</given-names></string-name>, &amp; 
<string-name><surname>Qin</surname>, <given-names>H.</given-names></string-name> (<year>2013</year>). <article-title>A strong angular dependence of magnetic properties of magnetosome chains: Implications for rock magnetism and paleomagnetism</article-title>. <source xml:lang="en">Geochemistry, Geophysics, Geosystems</source>, <volume>14</volume>, <fpage>3887</fpage>–<lpage>3907</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/ggge.20228">https://doi.org/10.1002/ggge.20228</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0033">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0034"><string-name><surname>Lindholm</surname>, <given-names>D.</given-names></string-name> (<year>1984</year>). <article-title>Three‐dimensional magnetostatic fields from point‐matched integral equations with linearly varying scalar sources</article-title>. <source xml:lang="en">IEEE Transactions on Magnetics</source>, <volume>20</volume>(<issue>5</issue>), <fpage>2025</fpage>–<lpage>2032</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TMAG.1984.1063254">https://doi.org/10.1109/TMAG.1984.1063254</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0034">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0035"><string-name><surname>Merrill</surname>, <given-names>R.</given-names></string-name> (<year>1977</year>). <article-title>The demagnetization field of multidomain grains</article-title>. <source xml:lang="en">Journal of Geomagnetism and Geoelectricity</source>, <volume>29</volume>(<issue>4</issue>), <fpage>285</fpage>–<lpage>292</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0035">
      <mixed-citation publication-type="book" id="ggge21516-cit-0036"><string-name><surname>Merrill</surname>, <given-names>R. T.</given-names></string-name> (<year>1998</year>). <source xml:lang="en">The magnetic field of the earth, volume 63: Paleomagnetism, the core, and the deep mantle (international geophysics)</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>Academic Press</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0036">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0037"><string-name><surname>Moon</surname>, <given-names>T.</given-names></string-name>, &amp; 
<string-name><surname>Merrill</surname>, <given-names>R. T.</given-names></string-name> (<year>1984</year>). <article-title>The magnetic‐moments of non‐uniformly magnetized grains</article-title>. <source xml:lang="en">Physics of the Earth and Planetary Interiors</source>, <volume>34</volume>(<issue>3</issue>), <fpage>186</fpage>–<lpage>194</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0031-9201(84)90006-2">https://doi.org/10.1016/0031-9201(84)90006-2</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0037">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0038"><string-name><surname>Moon</surname>, <given-names>T. S.</given-names></string-name>, &amp; 
<string-name><surname>Merrill</surname>, <given-names>R. T.</given-names></string-name> (<year>1985</year>). <article-title>Nucleation theory and domain states in multidomain magnetic material</article-title>. <source xml:lang="en">Physics of the Earth and Planetary Interiors</source>, <volume>37</volume>(<issue>2–3</issue>), <fpage>214</fpage>–<lpage>222</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0031-9201(85)90053-6">https://doi.org/10.1016/0031-9201(85)90053-6</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0038">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0039"><string-name><surname>Muxworthy</surname>, <given-names>A. R.</given-names></string-name>, &amp; 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name> (<year>2015</year>). <article-title>Critical single‐domain grain sizes in elongated iron particles: Implications for meteoritic and lunar magnetism</article-title>. <source xml:lang="en">Geophysical Journal International</source>, <volume>202</volume>(<issue>1</issue>), <fpage>578</fpage>–<lpage>583</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/gji/ggv180">https://doi.org/10.1093/gji/ggv180</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0039">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0040"><string-name><surname>Nagy</surname>, <given-names>L.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Muxworthy</surname>, <given-names>A. R.</given-names></string-name>, 
<string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, 
<string-name><surname>Almeida</surname>, <given-names>T. P.</given-names></string-name>, 
<string-name><surname>Conbhuí</surname>, <given-names>P. Ó.</given-names></string-name>, et al. (<year>2017</year>). <article-title>Stability of equidimensional pseudo‐single‐domain magnetite over billion‐year timescales</article-title>. <source xml:lang="en">Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>114</volume>(<issue>39</issue>), <fpage>10356</fpage>–<lpage>10360</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1708344114">https://doi.org/10.1073/pnas.1708344114</ext-link><pub-id pub-id-type="pmid">28874562</pub-id></mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0040">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0041"><string-name><surname>Néel</surname>, <given-names>L.</given-names></string-name> (<year>1955</year>). <article-title>Some theoretical aspects of rock‐magnetism</article-title>. <source xml:lang="en">Advances in Physics</source>, <volume>4</volume>(<issue>14</issue>), <fpage>191</fpage>–<lpage>243</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/00018735500101204">https://doi.org/10.1080/00018735500101204</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0041">
      <mixed-citation publication-type="miscellaneous" id="ggge21516-cit-0042"><string-name><surname>Ramstöck</surname>, <given-names>K.</given-names></string-name> (<year>1997</year>). <italic>Mikromagnetische Rechnungen an isolierten und eingebetteten Strukturen</italic> (PhD thesis). Erlangen, Germany: University Erlangen‐Nürnberg.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0042">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0043"><string-name><surname>Rave</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, &amp; 
<string-name><surname>Hubert</surname>, <given-names>A.</given-names></string-name> (<year>1998</year>). <article-title>Magnetic states of small cubic particles with uniaxial anisotropy</article-title>. <source xml:lang="en">Journal of Magnetism and Magnetic Materials</source>, <volume>190</volume>(<issue>3</issue>), <fpage>332</fpage>–<lpage>348</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0304-8853(98)00328-X">https://doi.org/10.1016/S0304-8853(98)00328-X</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0043">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0044"><string-name><surname>Schabes</surname>, <given-names>M. E.</given-names></string-name>, &amp; 
<string-name><surname>Bertram</surname>, <given-names>H. N.</given-names></string-name> (<year>1988</year>). <article-title>Magnetization processes in ferromagnetic cubes</article-title>. <source xml:lang="en">Journal of Applied Physics</source>, <volume>64</volume>(<issue>3</issue>), <fpage>1347</fpage>–<lpage>1357</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.341858">https://doi.org/10.1063/1.341858</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0044">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0045"><string-name><surname>Scholz</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Fidler</surname>, <given-names>J.</given-names></string-name>, 
<string-name><surname>Schrefl</surname>, <given-names>T.</given-names></string-name>, 
<string-name><surname>Suess</surname>, <given-names>D.</given-names></string-name>, 
<string-name><surname>Dittrich</surname>, <given-names>R.</given-names></string-name>, 
<string-name><surname>Forster</surname>, <given-names>H.</given-names></string-name>, et al. (<year>2003</year>). <article-title>Scalable parallel micromagnetic solvers for magnetic nanostructures</article-title>. <source xml:lang="en">Computational Materials Science</source>, <volume>28</volume>(<issue>2</issue>), <fpage>366</fpage>–<lpage>383</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0927-0256(03)00119-8">https://doi.org/10.1016/S0927-0256(03)00119-8</ext-link></mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0045">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0046"><string-name><surname>Silva</surname>, <given-names>T. J.</given-names></string-name>, &amp; 
<string-name><surname>Bertram</surname>, <given-names>H. N.</given-names></string-name> (<year>1990</year>). <article-title>Magnetization fluctuations in uniformly magnetized thin‐film recording media</article-title>. <source xml:lang="en">IEEE Transactions on Magnetics</source>, <volume>26</volume>(<issue>6</issue>), <fpage>3129</fpage>–<lpage>3139</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/20.102901">https://doi.org/10.1109/20.102901</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0046">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0047"><string-name><surname>Stringfellow</surname>, <given-names>M. W.</given-names></string-name> (<year>1968</year>). <article-title>Observation of spin‐wave renormalization effects in iron and nickel</article-title>. <source xml:lang="en">Journal of Physics C: Solid State Physics</source>, <volume>1</volume>(<issue>4</issue>), <fpage>950</fpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0047">
      <mixed-citation publication-type="book" id="ggge21516-cit-0048"><collab collab-type="authors">The CGAL Project</collab>
. (<year>2017</year>). <source xml:lang="en">CGAL user and reference manual</source> (4.11 ed.). <publisher-name>CGAL Editorial Board</publisher-name>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0048">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0049"><string-name><surname>Torres</surname>, <given-names>L.</given-names></string-name>, 
<string-name><surname>Lopez‐Diaz</surname>, <given-names>L.</given-names></string-name>, 
<string-name><surname>Moro</surname>, <given-names>E.</given-names></string-name>, 
<string-name><surname>de Francisco</surname>, <given-names>C.</given-names></string-name>, &amp; 
<string-name><surname>Alejos</surname>, <given-names>O.</given-names></string-name> (<year>2001</year>). <article-title>Micromagnetics of thermally activated switching in nonuniformly magnetized nanodots</article-title>. <source xml:lang="en">Journal of Magnetism and Magnetic Materials</source>, <volume>226–230</volume>, <fpage>1242</fpage>–<lpage>1244</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0304-8853(01)00054-3">https://doi.org/10.1016/S0304-8853(01)00054-3</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0049">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0050"><string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, &amp; 
<string-name><surname>Dunlop</surname>, <given-names>D. J.</given-names></string-name> (<year>1989</year>). <article-title>Three‐dimensional micromagnetic modelling of ferromagnetic domain structure</article-title>. <source xml:lang="en">Nature</source>, <volume>337</volume>(<issue>6208</issue>), <fpage>634</fpage>–<lpage>637</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/337634a0">https://doi.org/10.1038/337634a0</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0050">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0051"><string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, &amp; 
<string-name><surname>Dunlop</surname>, <given-names>D. J.</given-names></string-name> (<year>1995</year>). <article-title>Simulation of magnetic hysteresis in pseudo‐single‐domain grains of magnetite</article-title>. <source xml:lang="en">Journal of Geophysical Research</source>, <volume>100</volume>(<issue>B3</issue>), <fpage>3859</fpage>–<lpage>3871</lpage>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0051">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0052"><string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, 
<string-name><surname>Evans</surname>, <given-names>M. E.</given-names></string-name>, &amp; 
<string-name><surname>Krása</surname>, <given-names>D.</given-names></string-name> (<year>2010</year>). <article-title>Micromagnetics of paleomagnetically significant mineral grains with complex morphology</article-title>. <source xml:lang="en">Geochemistry, Geophysics, Geosystems</source>, <volume>11</volume>, Q02Z14. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1029/2009GC002828">https://doi.org/10.1029/2009GC002828</ext-link>.
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0052">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0053"><string-name><surname>Witt</surname>, <given-names>A.</given-names></string-name>, 
<string-name><surname>Fabian</surname>, <given-names>K.</given-names></string-name>, &amp; 
<string-name><surname>Bleil</surname>, <given-names>U.</given-names></string-name> (<year>2005</year>). <article-title>Three‐dimensional micromagnetic calculations for naturally shaped magnetite: Octahedra and magnetosomes</article-title>. <source xml:lang="en">Earth and Planetary Science Letters</source>, <volume>233</volume>(<issue>3–4</issue>), <fpage>311</fpage>–<lpage>324</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.epsl.2005.01.043">https://doi.org/10.1016/j.epsl.2005.01.043</ext-link>
</mixed-citation>
    </ref>
    <ref id="ggge21516-bib-0053">
      <mixed-citation publication-type="journal" id="ggge21516-cit-0054"><string-name><surname>Wright</surname>, <given-names>T. M.</given-names></string-name>, 
<string-name><surname>Williams</surname>, <given-names>W.</given-names></string-name>, &amp; 
<string-name><surname>Dunlop</surname>, <given-names>D. J.</given-names></string-name> (<year>1997</year>). <article-title>An improved algorithm for micromagnetics</article-title>. <source xml:lang="en">Journal of Geophysical Research</source>, <volume>102</volume>(<issue>B6</issue>), <fpage>12085</fpage>–<lpage>12094</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1029/96JB03628">https://doi.org/10.1029/96JB03628</ext-link>
</mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="ggge21516-app-0001" content-type="Appendix">
      <label>Appendix A</label>
      <title><italic>μ</italic>MAG Standard Problem 3</title>
      <sec id="ggge21516-sec-0021">
        <sec id="ggge21516-sec-0022">
          <title>A1. Introduction</title>
          <p>The <italic>μ</italic>MAG Standard Problem 3 is a test for the critical edge length of a cube with uniaxial anisotropy for a change in the magnetic phase from a flower state to a single vortex state (<ext-link ext-link-type="uri" xlink:href="http://www.ctcms.nist.gov/">http://www.ctcms.nist.gov/</ext-link>∼<ext-link ext-link-type="uri" xlink:href="http://rdm/mumag.org.html">http://rdm/mumag.org.html</ext-link>). It was introduced in 1998.</p>
          <p>In Standard Problem 3, the material parameters of the cube: the saturation magnetization <italic>M<sub>s</sub></italic>, and the uniaxial anisotropy constant <italic>K<sub>u</sub></italic>, are related by the relation:
<disp-formula id="ggge21516-disp-0018"><label>(A1)</label><mml:math id="nlm-math-90"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>M</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></disp-formula>and the exchange length 
<mml:math id="nlm-math-91"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is given in terms of the uniaxial anisotropy constant, the exchange coupling <italic>A</italic>
<disp-formula id="ggge21516-disp-0019"><label>(A2)</label><mml:math id="nlm-math-92"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
          <p>Existing results suggest the critical edge length, where a flower state and a vortex state should have the same energy is in the region of 8.45
<mml:math id="nlm-math-93"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> to 8.55 
<mml:math id="nlm-math-94"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>.</p>
        </sec>
        <sec id="ggge21516-sec-0023">
          <title>A2. Method</title>
          <p>The material parameters used were
<disp-formula id="ggge21516-disp-0020"><label>(A3)</label><mml:math id="nlm-math-95"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>4.807680</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup><mml:mo> </mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0021"><label>(A4)</label><mml:math id="nlm-math-96"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1.334870</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mi mathvariant="normal">J</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0022"><label>(A5)</label><mml:math id="nlm-math-97"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1.452282</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">J</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
          <p>The exchange length was therefore
<disp-formula id="ggge21516-disp-0023"><label>(A6)</label><mml:math id="nlm-math-98"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9.587248</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
          <p>To nucleate a flower state, the mesh is scaled to 7.5
<mml:math id="nlm-math-99"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> and a local energy minimum (LEM) is found, then rescaled to 8.45
<mml:math id="nlm-math-100"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>, our expected lower bound, and the LEM found and saved to disk. By “scaled to,” we mean the mesh is resized until edge length of the cube is the given value. This two step approach to nucleation is needed, since a flower state is not guaranteed to nucleate at 
<mml:math id="nlm-math-101"><mml:mrow><mml:mn>8.45</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>, as this is around the critical edge length; reminimizing at 8.45
<mml:math id="nlm-math-102"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is done primarily to save time during minimization later.</p>
          <p>For any particular domain state, its form will change slightly with grain size. A flower at a larger grain size, for example, will have a more divergent magnetization at the grain surface than a flower state at a smaller grain size. In that manner, states from grains closer in size tend to be more “similar” to each other than states from grains less close in size. Since the size 8.45
<mml:math id="nlm-math-103"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is closer in size to our expected critical region than the initial size of 7.5
<mml:math id="nlm-math-104"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>, the flower state at 8.45
<mml:math id="nlm-math-105"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> should be more “similar” to the states about the region of interest too. As a result, minimizing from the more “similar” state at 8.45
<mml:math id="nlm-math-106"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> to states about the region of interest takes less time than minimizing from the state at 7.5
<mml:math id="nlm-math-107"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>. An initial flower state at 8.45
<mml:math id="nlm-math-108"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is shown in Figure <xref rid="ggge21516-fig-0010" ref-type="fig">A1</xref>.</p>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0010" orientation="portrait" position="anchor">
            <label>Figure A1</label>
            <caption>
              <p>An initial flower solution at edge length 
<mml:math id="nlm-math-109"><mml:mrow><mml:mn>8.45</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>, colored by the cubic anisotropy energy.</p>
            </caption>
            <graphic id="nlm-graphic-19" xlink:href="GGGE-19-1080-g010"/>
          </fig>
          <p>To nucleate a vortex state, the mesh is first scaled to 11
<mml:math id="nlm-math-110"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> to guarantee vortex nucleation and the LEM found, then scaled to 8.45
<mml:math id="nlm-math-111"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> and the LEM found and saved to disk. Again, reminimization saves a lot of time as the vortex at 8.5
<mml:math id="nlm-math-112"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is more “similar” to the states around the region of interest than the state at 11
<mml:math id="nlm-math-113"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is. An initial vortex state at 8.45
<mml:math id="nlm-math-114"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is shown in Figure <xref rid="ggge21516-fig-0011" ref-type="fig">A2</xref>.</p>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0011" orientation="portrait" position="anchor">
            <label>Figure A2</label>
            <caption>
              <p>An initial vortex state at edge length 
<mml:math id="nlm-math-115"><mml:mrow><mml:mn>8.45</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> colored by helicity (
<mml:math id="nlm-math-116"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>).</p>
            </caption>
            <graphic id="nlm-graphic-21" xlink:href="GGGE-19-1080-g011"/>
          </fig>
          <p>To evaluate, say, the flower state energy at a certain cube size, say <italic>L</italic>, the mesh is scaled to length <italic>L</italic>, the flower state at is loaded from disk, which for the flower was found for 8.45
<mml:math id="nlm-math-117"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>, and the energy is minimized. The energy is then found and written to disk. This is done for the flower and vortex states for a range of cube sizes about the expected critical point of 8.5
<mml:math id="nlm-math-118"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>.</p>
          <p>The critical length for the cube is then found by finding the iteration just before the flower state energy passes the single vortex energy and the iteration just after, and using a linear interpolation between the energies of each iteration to find the edge length where they intercept. Denoting the first iteration's flower energy, vortex energy, and length scale as 
<mml:math id="nlm-math-119"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mo>−</mml:mo></mml:msub></mml:mrow></mml:math>, and the second iteration's as 
<mml:math id="nlm-math-120"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math>, the intercept length scale, <italic>l</italic>
<sub>0</sub>, is
<disp-formula id="ggge21516-disp-0024"><label>(A7)</label><mml:math id="nlm-math-121"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
          <p>This assumes the energies scale linearly with the edge length, which is incorrect, but for sufficiently small steps of the edge length, it should be accurate enough for this application.</p>
          <p>This entire process is then repeated for an increasingly fine mesh. The critical edge length of the cube should scale as the square of the mesh spacing. This is due to higher resolution of the derivatives, which, for the demagnetization and exchange calculations are of the order two. By performing a linear fit on the (mesh spacing)<sup>2</sup> versus the intercept length, it is be possible to extrapolate the intercept length for an infinitely fine mesh, i.e., where the mesh spacing is zero.</p>
          <p>For each mesh, the energies were found for the flower and vortex states for 8.39
<mml:math id="nlm-math-122"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> to 4.70
<mml:math id="nlm-math-123"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> in steps of 0.01
<mml:math id="nlm-math-124"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>. The mesh spacings used were 1.0
<mml:math id="nlm-math-125"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> to 0.3
<mml:math id="nlm-math-126"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> in steps of 0.1
<mml:math id="nlm-math-127"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>. The meshes were generated using a Delaunay triangulation algorithm from the CGAL library (The CGAL Project, <xref rid="ggge21516-bib-0047" ref-type="ref">2017</xref>). An example mesh at node spacing 0.5
<mml:math id="nlm-math-128"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> is given in Figure <xref rid="ggge21516-fig-0012" ref-type="fig">A3</xref>.</p>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0012" orientation="portrait" position="anchor">
            <label>Figure A3</label>
            <caption>
              <p>Cube mesh with a node spacing of 0.5
<mml:math id="nlm-math-129"><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>. Critical edge length versus node spacing.</p>
            </caption>
            <graphic id="nlm-graphic-23" xlink:href="GGGE-19-1080-g012"/>
          </fig>
        </sec>
        <sec id="ggge21516-sec-0024">
          <title>A3. Results</title>
          <p>From Figure <xref rid="ggge21516-fig-0013" ref-type="fig">A4</xref>, the critical edge length for an infinitely fine mesh was found to be 
<mml:math id="nlm-math-130"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8.468</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>, and from Figure <xref rid="ggge21516-fig-0014" ref-type="fig">A5</xref>, the critical energy was 
<mml:math id="nlm-math-131"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.30242</mml:mn><mml:mo>±</mml:mo><mml:mn>0.00008</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>V</mml:mi></mml:mrow></mml:math>. A break down of the demag, exchange, and anisotropy energies at the critical length for the flower and vortex states is in Table <xref rid="ggge21516-tbl-0001" ref-type="table-wrap">A1</xref>. The average magnetization for these states at the critical length is in Table <xref rid="ggge21516-tbl-0002" ref-type="table-wrap">A2</xref>.</p>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0013" orientation="portrait" position="anchor">
            <label>Figure A4</label>
            <caption>
              <p>The critical length versus the node spacing of the mesh, and linear fit extrapolating the node spacing to 0. This shows the critical edge length for an infinitely fine mesh using MERRILL is 
<mml:math id="nlm-math-132"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8.468</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>exch</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math>. Critical energy versus node spacing.</p>
            </caption>
            <graphic id="nlm-graphic-25" xlink:href="GGGE-19-1080-g013"/>
          </fig>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0014" orientation="portrait" position="anchor">
            <label>Figure A5</label>
            <caption>
              <p>The critical energy versus the node spacing of the mesh, and linear extrapolating the node spacing to 0. This shows the critical energy for an infinitely fine mesh using MERRILL is 
<mml:math id="nlm-math-133"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.30242</mml:mn><mml:mo>±</mml:mo><mml:mn>0.00008</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>V</mml:mi></mml:mrow></mml:math>.</p>
            </caption>
            <graphic id="nlm-graphic-27" xlink:href="GGGE-19-1080-g014"/>
          </fig>
          <table-wrap id="ggge21516-tbl-0001" xml:lang="en" orientation="portrait" position="anchor">
            <label>Table A1</label>
            <caption>
              <p>
                <italic>Extrapolated Partial Energies at the Critical Edge Length in Units of</italic>
                <mml:math id="nlm-math-134">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>K</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:msub>
                    <mml:mi>V</mml:mi>
                  </mml:mrow>
                </mml:math>
              </p>
            </caption>
            <table frame="hsides" rules="groups">
              <col style="border-bottom:solid 1px #000000; border-right:solid 1px #000000" width="80pt" span="1"/>
              <col style="border-bottom:solid 1px #000000; border-right:solid 1px #000000" width="80pt" span="1"/>
              <col style="border-bottom:solid 1px #000000; border-right:solid 1px #000000" width="80pt" span="1"/>
              <thead valign="bottom">
                <tr style="border-bottom:solid 1px #000000">
                  <th align="left" valign="bottom" rowspan="1" colspan="1"/>
                  <th align="center" valign="bottom" rowspan="1" colspan="1">Flower</th>
                  <th align="center" valign="bottom" rowspan="1" colspan="1">Vortex</th>
                </tr>
              </thead>
              <tbody valign="top">
                <tr>
                  <td align="left" valign="top" rowspan="1" colspan="1">Demag</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.2791 ± 0.0001</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.0775 ± 0.0006</td>
                </tr>
                <tr>
                  <td align="left" valign="top" rowspan="1" colspan="1">Anisotropy</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.00563 ± 0.00002</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.0520 ± 0.0001</td>
                </tr>
                <tr>
                  <td align="left" valign="top" rowspan="1" colspan="1">Exchange</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.01773 ± 0.00005</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.1729 ± 0.0007</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <table-wrap id="ggge21516-tbl-0002" xml:lang="en" orientation="portrait" position="anchor">
            <label>Table A2</label>
            <caption>
              <p>
                <italic>Extrapolated Magnetizations at the Critical Edge Length in Units of M<sub>s</sub></italic>
              </p>
            </caption>
            <table frame="hsides" rules="groups">
              <col style="border-bottom:solid 1px #000000; border-right:solid 1px #000000" width="80pt" span="1"/>
              <col style="border-bottom:solid 1px #000000; border-right:solid 1px #000000" width="80pt" span="1"/>
              <col style="border-bottom:solid 1px #000000; border-right:solid 1px #000000" width="80pt" span="1"/>
              <thead valign="bottom">
                <tr style="border-bottom:solid 1px #000000">
                  <th align="left" valign="bottom" rowspan="1" colspan="1"/>
                  <th align="center" valign="bottom" rowspan="1" colspan="1">Flower</th>
                  <th align="center" valign="bottom" rowspan="1" colspan="1">Vortex</th>
                </tr>
              </thead>
              <tbody valign="top">
                <tr>
                  <td align="left" valign="top" rowspan="1" colspan="1">
                    <mml:math id="nlm-math-135">
                      <mml:mrow>
                        <mml:mo>〈</mml:mo>
                        <mml:msub>
                          <mml:mi>m</mml:mi>
                          <mml:mi>x</mml:mi>
                        </mml:msub>
                        <mml:mo>〉</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.97086 ± 0.00008</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">−0.0000 ± 0.0008</td>
                </tr>
                <tr>
                  <td align="left" valign="top" rowspan="1" colspan="1">
                    <mml:math id="nlm-math-136">
                      <mml:mrow>
                        <mml:mo>〈</mml:mo>
                        <mml:msub>
                          <mml:mi>m</mml:mi>
                          <mml:mi>y</mml:mi>
                        </mml:msub>
                        <mml:mo>〉</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">−0.0000 ± 0.0002</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.0 ± 0.3</td>
                </tr>
                <tr>
                  <td align="left" valign="top" rowspan="1" colspan="1">
                    <mml:math id="nlm-math-137">
                      <mml:mrow>
                        <mml:mo>〈</mml:mo>
                        <mml:msub>
                          <mml:mi>m</mml:mi>
                          <mml:mi>z</mml:mi>
                        </mml:msub>
                        <mml:mo>〉</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">−0.0003 ± 0.0002</td>
                  <td align="char" char="±" valign="top" rowspan="1" colspan="1">0.0000 ± 0.0007</td>
                </tr>
              </tbody>
            </table>
          </table-wrap>
          <p>These measurements were also carried out with MERRILL's built in regular mesh generation for cubes, and the difference in results was within 1%.</p>
        </sec>
        <sec id="ggge21516-sec-0025">
          <title>A4. Discussion</title>
          <p>MERRILL's solutions to the <italic>μ</italic>MAG Standard Problem 3 are in very good agreement with the other submissions. This is good evidence that the energy terms in MERRILL are correctly determined and converge to the true continuum value when mesh size approaches zero.</p>
          <p>The error values presented here are for the extrapolation of the critical values MERRILL would find on an infinitely fine mesh. They are not errors in the actual values generated by MERRILL compared to the physical equivalent. There are many sources of error unaccounted for by this approach, including material parameters, mesh geometry, numerical errors, and approximation errors. For this reason, when comparing between MERRILL's results, and other submissions to the <italic>μ</italic>MAG site, it may be more informative to directly compare the extrapolated values than to compare the extrapolated values within the presented errors.</p>
        </sec>
      </sec>
    </app>
    <app id="ggge21516-app-0002" content-type="Appendix">
      <label>Appendix B</label>
      <title>MERRILL Commands</title>
      <sec id="ggge21516-sec-0026">
        <p>The basic functionality of MERRILL provides a boundary element micromagnetic energy calculation for arbitrary particle shapes.</p>
        <p>To use MERRILL requires at least
<list list-type="order" id="ggge21516-list-0003"><list-item id="ggge21516-li-0008"><p>A particle geometry (e.g., a cube or octahedron) that describes the particle to be modeled. This geometry is translated into a tetrahedral mesh with a large set of model nodes by a mesh generator. The distance between the nodes defines the resolution of the model. Several ready to use meshes are provided together with MERRILL, but arbitrary meshes can be loaded as long as they fulfill some minimal quality criteria. Besides commercial software, there exist several professional open source mesh generators that are more than sufficient for generating simple particle meshes. For example, <ext-link ext-link-type="uri" xlink:href="http://engits.eu/en/engrid">http://engits.eu/en/engrid</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/netgen-mesher/">http://sourceforge.net/projects/netgen-mesher/</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://geuz.org/gmsh/">http://geuz.org/gmsh/</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://meshlab.sourceforge.net/">http://meshlab.sourceforge.net/</ext-link>.</p></list-item><list-item id="ggge21516-li-0009"><p>Material properties of the magnetic material to be modeled and the scaling constant determining the particle size. MERRILL provides a database of material properties for several common natural magnetic minerals.</p></list-item><list-item id="ggge21516-li-0010"><p>With the above prerequisites it is already possible to do very sophisticated model runs resulting, e.g., in micromagnetic energies and mean magnetization values. To visualize the resulting output files MERRILL is set up to easily interact with ParaView.</p></list-item></list>
</p>
        <sec id="ggge21516-sec-0027">
          <title>B1. Interpreter Language</title>
          <p>MERRILL is operated through an interpreter language script that determines all aspects of the micromagnetic calculation.</p>
          <p>The script is a simple ASCII file containing a sequence of lines. Empty lines, leading, trailing, and multiple spaces or tabs are ignored, as well as anything behind an exclamation mark (!). A number of keywords are used to call subroutines or perform simple assignments. All keywords are case insensitive, e.g., “ReadMesh” and “readmesh” are equivalent. The script file is parsed line by line. Each valid line is immediately interpreted and executed.</p>
          <sec id="ggge21516-sec-0028">
            <title>B1.1. Basic Commands</title>
            <p>The following list contains the currently available commands.</p>
            <p><bold><italic>Set</italic></bold><mml:math id="nlm-math-138"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>variable</italic></bold><mml:math id="nlm-math-139"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-140"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>value</italic></bold><mml:math id="nlm-math-141"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> is used to define global variables for the material, the geometry of the mesh, or program parameters. The following <italic>variables</italic> are supported:</p>
            <p><bold><italic>Ms</italic></bold> saturation magnetization in A/m.</p>
            <p><bold><italic>K1</italic></bold> anisotropy constant for uniaxial or cubic anisotropy in J/m<sup>3</sup>.</p>
            <p><bold><italic>Aex</italic></bold> exchange constant in J/m.</p>
            <p><bold><italic>Ls</italic></bold> inverse length scale 1/m. Internally Ls<sup>2</sup> is used.</p>
            <p><bold><italic>mu</italic></bold> related to permeability of free space via mu 
<mml:math id="nlm-math-142"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:math>.</p>
            <p><bold><italic>NEBSpring</italic></bold> Spring constant for nudged‐elastic band method (NEB).</p>
            <p><bold><italic>CurvatureWeight</italic></bold> Weight of curvature contribution for nudged‐elastic band method (NEB).</p>
            <p><bold><italic>MaxMeshNumber</italic></bold> Maximal number of finite element meshes stored. Must be set once before loading meshes.</p>
            <p><bold><italic>PathN</italic></bold> Number of structures along the magnetization path. Warning: The mesh must have been defined previously! Use only after ReadMesh.</p>
            <p><bold><italic>ExchangeCalculator</italic></bold> Chooses the exchange energy discretization method used. The available choices are 1= 
<mml:math id="nlm-math-143"><mml:mrow><mml:mi>m</mml:mi><mml:mo> </mml:mo><mml:mo>Δ</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math>, 2= 
<mml:math id="nlm-math-144"><mml:mrow><mml:msup><mml:mi>φ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math> along edges, 3= 
<mml:math id="nlm-math-145"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∇</mml:mo><mml:mi>ϑ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>ϑ</mml:mi><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∇</mml:mo><mml:mi>φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>, 4=
<mml:math id="nlm-math-146"><mml:mrow><mml:msup><mml:mi>φ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math> from centroid to vertices.</p>
            <p><bold><italic>MaxRestarts</italic></bold> Maximum number of restarts during energy minimization.</p>
            <p><bold><italic>MaxEnergyEvaluations</italic></bold> Maximum number of energy calculations during energy minimization (typical: 5,000–10,000). Afterward energy minimization is aborted.</p>
            <p><bold><italic>MaxPathEvaluations</italic></bold> Maximum number of path energy calculations during path minimization (typical: 500–2,000).</p>
            <p><bold><italic>Zone</italic></bold> Current Zone to be written into the TecPlot output file (double). Zone can be set before each output, or c an be used with automatic increment.</p>
            <p><bold><italic>ZoneIncrement</italic></bold> Automatic increment of zone (default = 1.0).</p>
            <p><bold><italic>AllExchange</italic></bold> Values greater zero imply that all exchange energy calculations are performed and logged. This slows the program down.</p>
            <p><bold><italic>Magnetite</italic></bold><mml:math id="nlm-math-147"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>temperature</italic></bold><mml:math id="nlm-math-148"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><bold>C</bold> Defines material constants for magnetite at temperature 
<mml:math id="nlm-math-149"><mml:mo>〈</mml:mo></mml:math>
<italic>temperature</italic>
<mml:math id="nlm-math-150"><mml:mo>〉</mml:mo></mml:math> to be used in subsequent calculations. The temperature is given in degrees Celsius and must be positive and below magnetite's Curie temperature at 580°C.</p>
            <p><bold><italic>Resize</italic></bold><mml:math id="nlm-math-151"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>old length</italic></bold><mml:math id="nlm-math-152"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-153"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>new length</italic></bold><mml:math id="nlm-math-154"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> changes the length scale of the mesh such that after this rescaling the length 
<mml:math id="nlm-math-155"><mml:mo>〈</mml:mo></mml:math>
<italic>old length</italic>
<mml:math id="nlm-math-156"><mml:mo>〉</mml:mo></mml:math> will become 
<mml:math id="nlm-math-157"><mml:mo>〈</mml:mo></mml:math>
<italic>new length</italic>
<mml:math id="nlm-math-158"><mml:mo>〉</mml:mo></mml:math>.</p>
            <p><bold><italic>(Cubic</italic></bold><mml:math id="nlm-math-159"><mml:mo>|</mml:mo></mml:math><bold><italic>Uniaxial) Anisotropy</italic></bold> Defines the symmetry of the anisotropy energy.</p>
            <p><bold><italic>CubicRotation</italic></bold><mml:math id="nlm-math-160"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">φ</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">ϑ</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo mathvariant="bold">〉</mml:mo></mml:mrow></mml:math> Rotates the cubic easy axes using the rotation matrix with the prescribed Euler angles.</p>
            <p><bold><italic>CubicAxes</italic></bold><mml:math id="nlm-math-161"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi></mml:msub><mml:mo mathvariant="bold">〉</mml:mo><mml:mo> </mml:mo><mml:mo mathvariant="bold">〈</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi></mml:msub><mml:mo mathvariant="bold">〉</mml:mo><mml:mo> </mml:mo><mml:mo mathvariant="bold">〈</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi></mml:msub><mml:mo mathvariant="bold">〉</mml:mo></mml:mrow></mml:math> Directly set the 3 cubic axes, 
<mml:math id="nlm-math-162"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math>, and 
<mml:math id="nlm-math-163"><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>, for the cubic anisotropy. Users should ensure the axes are mutually orthogonal.</p>
            <p><bold><italic>EasyAxis</italic></bold><mml:math id="nlm-math-164"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold">〉</mml:mo></mml:mrow></mml:math> Determines the easy axis for uniaxial anisotropy.</p>
            <p><bold><italic>External field direction</italic></bold><mml:math id="nlm-math-165"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold">〉</mml:mo></mml:mrow></mml:math> Determines the direction vector of an external homogenous magnetic field. Intrinsically sets the field to <italic>B</italic> = 1 T.</p>
            <p><bold><italic>External field strength</italic></bold><mml:math id="nlm-math-166"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>B</italic></bold><mml:math id="nlm-math-167"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-168"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>unit</italic></bold><mml:math id="nlm-math-169"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Determines the strength of the external homogenous magnetic field as 
<mml:math id="nlm-math-170"><mml:mo>〈</mml:mo></mml:math>
<italic>B</italic>
<mml:math id="nlm-math-171"><mml:mo>〉</mml:mo></mml:math> in units of 
<mml:math id="nlm-math-172"><mml:mo>〈</mml:mo></mml:math>
<italic>unit</italic>
<mml:math id="nlm-math-173"><mml:mo>〉</mml:mo></mml:math>. Possible values for 
<mml:math id="nlm-math-174"><mml:mo>〈</mml:mo></mml:math>
<italic>unit</italic>
<mml:math id="nlm-math-175"><mml:mo>〉</mml:mo></mml:math> are “μT,” “mT,” or “T.” Must be set after defining the direction. Subsequent calls reset the field to 
<mml:math id="nlm-math-176"><mml:mo>〈</mml:mo></mml:math>B
<mml:math id="nlm-math-177"><mml:mo>〉</mml:mo></mml:math> without changing the direction. Can be used for hysteresis modeling.</p>
            <p><bold><italic>ReadMesh</italic></bold><mml:math id="nlm-math-178"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>index</italic></bold><mml:math id="nlm-math-179"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-180"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-181"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Reads the Patran file 
<mml:math id="nlm-math-182"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-183"><mml:mo>〉</mml:mo></mml:math>, and stores the corresponding mesh and finite element arrays at location 
<mml:math id="nlm-math-184"><mml:mo>〈</mml:mo></mml:math>
<italic>index</italic>
<mml:math id="nlm-math-185"><mml:mo>〉</mml:mo></mml:math>
<italic>. The index must be less or equal to the previously set MaxMeshNumber</italic>.</p>
            <p><bold><italic>LoadMesh</italic></bold><mml:math id="nlm-math-186"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>index</italic></bold><mml:math id="nlm-math-187"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Loads a previously read mesh and its finite element arrays from location 
<mml:math id="nlm-math-188"><mml:mo>〈</mml:mo></mml:math>
<italic>index</italic>
<mml:math id="nlm-math-189"><mml:mo>〉</mml:mo></mml:math>. This mesh will then be used in subsequent operations.</p>
            <p><bold><italic>ReadMagnetization</italic></bold><mml:math id="nlm-math-190"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-191"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Reads a magnetization file, 
<mml:math id="nlm-math-192"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-193"><mml:mo>〉</mml:mo></mml:math>, (.dat) into the current mesh magnetization array. Make sure that it was created for the currently active mesh! The magnetization read is used in subsequent operations.</p>
            <p><bold><italic>Uniform magnetization</italic></bold><mml:math id="nlm-math-194"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mo> </mml:mo><mml:mo mathvariant="bold">[</mml:mo><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow></mml:math> Creates a uniform magnetization for the current mesh pointing in the normalized direction 
<mml:math id="nlm-math-195"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math>. The optional parameter 
<mml:math id="nlm-math-196"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>b</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math> is the index of the block of nodes in the mesh that should be set. By definition block 1 contains the free nodes, while higher block numbers can be used to define fixed nodes. These blocks have to be defined in the Patran file. Any previous magnetization is lost.</p>
            <p><bold><italic>Vortex magnetization</italic></bold><mml:math id="nlm-math-197"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mo> </mml:mo><mml:mo mathvariant="bold">[</mml:mo><mml:mo mathvariant="bold">〈</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">]</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mo> </mml:mo><mml:mo mathvariant="bold">[</mml:mo><mml:mo mathvariant="bold">〈</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">]</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mo> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow></mml:math><bold>RH</bold><mml:math id="nlm-math-198"><mml:mo mathvariant="bold">|</mml:mo></mml:math><bold>LH</bold><mml:math id="nlm-math-199"><mml:mo mathvariant="bold">]</mml:mo></mml:math> Creates an approximate vortex state with core pointing along the line from 
<mml:math id="nlm-math-200"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math> to 
<mml:math id="nlm-math-201"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>, with component 
<mml:math id="nlm-math-202"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>v</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math> along the core direction, and right handed (RH), or left handed (LH) orientation. By default, 
<mml:math id="nlm-math-203"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mn>0</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math>, <italic>v</italic> = 0 and the orientation is RH.</p>
            <p><bold><italic>Invert magnetization</italic></bold><mml:math id="nlm-math-204"><mml:mrow><mml:mo mathvariant="bold">〈</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi></mml:msub><mml:mo mathvariant="bold">〉</mml:mo></mml:mrow></mml:math> Inverts the current magnetization structure by multiplying each component of 
<mml:math id="nlm-math-205"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> with the corresponding sign 
<mml:math id="nlm-math-206"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>. For example, Invert magnetization 1 −1 1 on each node changes the current magnetization 
<mml:math id="nlm-math-207"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>↦</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>.</p>
            <p><bold><italic>Randomize magnetization</italic></bold><mml:math id="nlm-math-208"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>angle</italic></bold><mml:math id="nlm-math-209"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Randomly changes each current magnetization vector by at most 
<mml:math id="nlm-math-210"><mml:mo>〈</mml:mo></mml:math>
<italic>angle</italic>
<mml:math id="nlm-math-211"><mml:mo>〉</mml:mo></mml:math> degrees. The previous magnetization is (partially) lost.</p>
            <p><bold><italic>Randomize all moments</italic></bold> Replaces the current magnetization by randomly distributed unit vectors. Any previous magnetization is lost!</p>
            <p><bold><italic>ReMesh</italic></bold><mml:math id="nlm-math-212"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>index</italic></bold><mml:math id="nlm-math-213"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Takes the current magnetization array and interpolates it at the nodes of the previously read mesh at location 〈<italic>index</italic>〉. This mesh from location 〈<italic>index</italic>〉 is then loaded and will be used in subsequent operations.</p>
            <p><bold><italic>ConjugateGradient</italic></bold> Uses conjugate gradient steps during the accelerated descent.</p>
            <p><bold><italic>SteepestDescent</italic></bold> Uses normal gradient steps during the accelerated descent.</p>
            <p><bold><italic>Minimize</italic></bold> Calls the minimization routine for the current mesh and initial magnetization. This call does not save the final result!</p>
            <p><bold><italic>EnergyLog</italic></bold><mml:math id="nlm-math-214"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-215"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Starts logging all subsequent energy calculations into the logfile 
<mml:math id="nlm-math-216"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-217"><mml:mo>〉</mml:mo></mml:math>.log. Logging can be stopped by <italic>EndLog</italic> or <italic>CloseLogfile</italic>
</p>
            <p><bold><italic>CloseLogfile</italic></bold> ends the previous logging of energy calculations or path minimizations.</p>
            <p><bold><italic>WriteMagnetization</italic></bold><mml:math id="nlm-math-218"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-219"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Saves the magnetization and the mesh in two files:</p>
            <p><mml:math id="nlm-math-220"><mml:mo>〈</mml:mo></mml:math><italic>filename</italic><mml:math id="nlm-math-221"><mml:mo>〉</mml:mo></mml:math>.dat contains vertex coordinates and magnetization vectors.</p>
            <p><mml:math id="nlm-math-222"><mml:mo>〈</mml:mo></mml:math><italic>filename</italic><mml:math id="nlm-math-223"><mml:mrow><mml:mo>〉</mml:mo><mml:mo>_</mml:mo></mml:mrow></mml:math><italic>mult.dat</italic> TecPlot file for visualization using ParaView or TecPlot. Contains mesh geometry and one or more magnetization states.</p>
            <p><bold><italic>WriteHyst</italic></bold><mml:math id="nlm-math-224"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-225"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Saves hysteresis data in 5 columns of 
<mml:math id="nlm-math-226"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo>|</mml:mo></mml:mrow></mml:math> and the 3 components on the average unit magnetization vector, 
<mml:math id="nlm-math-227"><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>〉</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>〈</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>〉</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>〈</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>〉</mml:mo></mml:mrow></mml:math>, where M is the magnetization and 
<mml:math id="nlm-math-228"><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup><mml:mo>|</mml:mo></mml:mrow></mml:math> is the magnitude of external field. 
<mml:math id="nlm-math-229"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mtext>zm</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math> is normalized to the saturated magnetization in the direction of the applied field.</p>
            <p><bold><italic>SystemCommand</italic></bold><mml:math id="nlm-math-230"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>command</italic></bold><mml:math id="nlm-math-231"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-232"><mml:mo>…</mml:mo></mml:math> Performs the system command in the remaining arguments as a line. No guarantee can be given for correct behavior. Uses FORTRAN's <italic>SYSTEM</italic> command.</p>
            <p><bold><italic>KeyPause</italic></bold> Pauses script evaluation and waits for Key + Enter for continuation.</p>
            <p><bold><italic>GradientTest</italic></bold> Test feature to check energy gradient calculation against several finite‐difference estimates.</p>
            <p><italic><bold>(Stop</bold></italic><mml:math id="nlm-math-233"><mml:mo>|</mml:mo></mml:math><bold><italic>End)</italic></bold> Stops script evaluation.</p>
          </sec>
          <sec id="ggge21516-sec-0029">
            <title>B1.2. Path Related Commands</title>
            <p>The following contains all path related commands available for NEB calculations.</p>
            <p><bold><italic>MagnetizationToPath</italic></bold><mml:math id="nlm-math-234"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>index</italic></bold><mml:math id="nlm-math-235"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Saves the current magnetization in the path at location 
<mml:math id="nlm-math-236"><mml:mo>〈</mml:mo></mml:math>
<italic>index</italic>
<mml:math id="nlm-math-237"><mml:mo>〉</mml:mo></mml:math>. This allows to assemble a path from individual magnetization states that have to fit to the current mesh! After assembling a path it must be renewed before further operations can be performed.</p>
            <p><bold><italic>PathToMagnetization</italic></bold><mml:math id="nlm-math-238"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>index</italic></bold><mml:math id="nlm-math-239"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Moves the path magnetization state at location 
<mml:math id="nlm-math-240"><mml:mo>〈</mml:mo></mml:math>
<italic>index</italic>
<mml:math id="nlm-math-241"><mml:mo>〉</mml:mo></mml:math> to the current magnetization. This allows to change individual magnetizations in the path. For example, Initial and final states of a path read from a file can be minimized for new material constants.</p>
            <p><bold><italic>RenewPath</italic></bold> Defines all path variables, like distances and tangent vectors, assuming that all magnetizations have been correctly filled.</p>
            <p><bold><italic>RefinePathTo</italic></bold><mml:math id="nlm-math-242"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>newlength</italic></bold><mml:math id="nlm-math-243"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Refines the current path to a new number of states by linear interpolation in the magnetization angles. This also resets <italic>PathN</italic> to the new value and renews the path. Of course, the new number of states can also be less than the previous <italic>PathN</italic>.</p>
            <p><bold><italic>WriteTecPlotPath</italic></bold><mml:math id="nlm-math-244"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-245"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Exports the current path to a TecPlot file with name 
<mml:math id="nlm-math-246"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-247"><mml:mo>〉</mml:mo></mml:math>. All states along the path are individual zones in the TecPlotFile.</p>
            <p><bold><italic>ReadTecPlotPath</italic></bold><mml:math id="nlm-math-248"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-249"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Reads a new path from a TecPlot file with name 
<mml:math id="nlm-math-250"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-251"><mml:mo>〉</mml:mo></mml:math>. All states along the path are individual zones in the TecPlotFile. Because this also reads in the mesh, all mesh related quantities are recalculated. Sets <italic>PathN</italic> and allocates necessary space for mesh and path arrays.</p>
            <p>Make sure that all material parameters are correctly assigned, since those are not read!</p>
            <p><bold><italic>MakeInitialPath</italic></bold> Assumes that a path is defined by <italic>set PathN</italic>
<mml:math id="nlm-math-252"><mml:mo>〈</mml:mo></mml:math>
<italic>number</italic>
<mml:math id="nlm-math-253"><mml:mo>〉</mml:mo></mml:math> and that the first and last magnetization patterns are defined. Then proceeds by stepwise minimization to construct an initial path for subsequent optimization by the NEB method.</p>
            <p><bold><italic>PathMinimize</italic></bold> Assumes that an initial path is defined and minimizes the action integral using a variant of the NEB method.</p>
            <p><bold><italic>PathLogfile</italic></bold><mml:math id="nlm-math-254"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>filename</italic></bold><mml:math id="nlm-math-255"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Starts logging all subsequent path minimization calculations into three logfiles 
<mml:math id="nlm-math-256"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-257"><mml:mo>〉</mml:mo></mml:math>.enlog 
<mml:math id="nlm-math-258"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-259"><mml:mo>〉</mml:mo></mml:math>.grlog, and 
<mml:math id="nlm-math-260"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-261"><mml:mo>〉</mml:mo></mml:math>.dlog. They contain energies along the path, norms of the gradients along the path and cumulative distances along the path. Logging can be stopped by <italic>EndLog</italic> or <italic>CloseLogfile</italic>.</p>
            <p><bold><italic>PathStructureEnergies</italic></bold><mml:math id="nlm-math-262"><mml:mrow><mml:mo mathvariant="bold">[</mml:mo><mml:mo mathvariant="bold">〈</mml:mo></mml:mrow></mml:math><bold><italic>filname</italic></bold><mml:math id="nlm-math-263"><mml:mrow><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow></mml:math> Calculates the energies for each structure along the currently loaded path (in Joule). If 
<mml:math id="nlm-math-264"><mml:mo>〈</mml:mo></mml:math>
<italic>filename</italic>
<mml:math id="nlm-math-265"><mml:mo>〉</mml:mo></mml:math> is omitted, the path is written to standard output.</p>
            <p><bold><italic>Energy</italic></bold> Calculates the energy (in Joule) of the currently loaded magnetization structure.</p>
          </sec>
          <sec id="ggge21516-sec-0030">
            <title>B1.3. Interpreter Language Control Constructs</title>
            <p>The following commands are simple options of the interpreter language to implement loops or script variables. Note that they cannot be nested or used recursively.</p>
            <p><bold><italic>Loop</italic></bold><mml:math id="nlm-math-266"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>variable</italic></bold><mml:math id="nlm-math-267"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-268"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>startvalue</italic></bold><mml:math id="nlm-math-269"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-270"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>endvalue</italic></bold><mml:math id="nlm-math-271"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-272"><mml:mrow><mml:mo mathvariant="bold">[</mml:mo><mml:mo mathvariant="bold">〈</mml:mo></mml:mrow></mml:math><bold><italic>step</italic></bold><mml:math id="nlm-math-273"><mml:mrow><mml:mo mathvariant="bold">〉</mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow></mml:math> Takes all commands until the next <italic>EndLoop</italic> statement and performs a loop over the enclosed commands by replacing the variable 
<mml:math id="nlm-math-274"><mml:mo>〈</mml:mo></mml:math>
<italic>variable</italic>
<mml:math id="nlm-math-275"><mml:mo>〉</mml:mo></mml:math> with values from 
<mml:math id="nlm-math-276"><mml:mo>〈</mml:mo></mml:math>
<italic>startvalue</italic>
<mml:math id="nlm-math-277"><mml:mo>〉</mml:mo></mml:math> to 
<mml:math id="nlm-math-278"><mml:mo>〈</mml:mo></mml:math>
<italic>endvalue</italic>
<mml:math id="nlm-math-279"><mml:mo>〉</mml:mo></mml:math> in steps of 
<mml:math id="nlm-math-280"><mml:mo>〈</mml:mo></mml:math>
<italic>step</italic>
<mml:math id="nlm-math-281"><mml:mo>〉</mml:mo></mml:math>. If step is not given step‐size <italic>step = 1.0</italic> is assumed. Within the loop the string #〈variable〉 is replaced by the integer value of <italic>variable</italic>, the string %〈variable〉 is replaced by the double precision value of <italic>variable</italic>, and the string $〈variable〉$ is replaced by a string of the value of <italic>variable</italic>. Nested loops are not yet supported. Warning: The <italic>Loop</italic> command itself must NOT contain other variables than the loop variable. This is so because currently the parsing for replacing variables is performed only after unravelling the loops.</p>
            <p><bold><italic>EndLoop</italic></bold> Delimits the set of commands inside the active loop.</p>
            <p><bold><italic>Define</italic></bold><mml:math id="nlm-math-282"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>variable</italic></bold><mml:math id="nlm-math-283"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-284"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>value</italic></bold><mml:math id="nlm-math-285"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Defines a numeric variable that can be used like a loop variable.</p>
            <p><bold><italic>AddTo</italic></bold><mml:math id="nlm-math-286"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>variable</italic></bold><mml:math id="nlm-math-287"><mml:mo mathvariant="bold">〉</mml:mo></mml:math><mml:math id="nlm-math-288"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>value</italic></bold><mml:math id="nlm-math-289"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Adds a number to a previously defined variable.</p>
            <p><bold><italic>Undefine</italic></bold><mml:math id="nlm-math-290"><mml:mo mathvariant="bold">〈</mml:mo></mml:math><bold><italic>variable</italic></bold><mml:math id="nlm-math-291"><mml:mo mathvariant="bold">〉</mml:mo></mml:math> Forgets a previously defined variable.</p>
          </sec>
        </sec>
      </sec>
    </app>
    <app id="ggge21516-app-0003" content-type="Appendix">
      <label>Appendix C</label>
      <title>Material Parameters</title>
      <sec id="ggge21516-sec-0031">
        <p>The micromagnetic models require values of the three temperature‐dependent magnetic parameters of saturation magnetization (<italic>M<sub>s</sub></italic>), the crystalline anisotropy constant (<italic>K</italic>
<sub>1</sub>), and the exchange constant (<italic>A</italic>). Each parameter is represented by a polynomial, based on the best fit to experimental data.</p>
        <sec id="ggge21516-sec-0032">
          <title>C1. Magnetite</title>
          <p>For magnetite the experimental data was derived from Heider and Williams (<xref rid="ggge21516-bib-0024" ref-type="ref">1988</xref>) for the exchange constant, Fletcher and O'Reilly (<xref rid="ggge21516-bib-0020" ref-type="ref">1974</xref>) for the crystalline anisotropy and Heider et al. (<xref rid="ggge21516-bib-0023" ref-type="ref">1987</xref>) for the saturation magnetization. The polynomial expressions used in MERRILL for each of these three magnetite parameters is
<disp-formula id="ggge21516-disp-0025"><label>(C1)</label><mml:math id="nlm-math-292"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:mn>21622.526</mml:mn><mml:mo>+</mml:mo><mml:mn>816.476</mml:mn><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo>−</mml:mo><mml:mn>147.046</mml:mn></mml:mrow><mml:mrow><mml:mn>408.238</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0026"><label>(C2)</label><mml:math id="nlm-math-293"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2.13074</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>3.2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0027"><label>(C3)</label><mml:math id="nlm-math-294"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>737.384</mml:mn><mml:mo>×</mml:mo><mml:mn>51.876</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>T</italic> is the temperature in Celsius and <italic>T<sub>C</sub></italic> is the Curie temperature for magnetite taken as 580 C. These parameter polynomials are plotted in Figures <xref rid="ggge21516-fig-0015" ref-type="fig">C1</xref>, <xref rid="ggge21516-fig-0016" ref-type="fig">C2</xref>, <xref rid="ggge21516-fig-0017" ref-type="fig">C3</xref>.</p>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0015" orientation="portrait" position="anchor">
            <label>Figure C1</label>
            <caption>
              <p>Exchange coupling versus temperature for magnetite.</p>
            </caption>
            <graphic id="nlm-graphic-29" xlink:href="GGGE-19-1080-g015"/>
          </fig>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0016" orientation="portrait" position="anchor">
            <label>Figure C2</label>
            <caption>
              <p>Crystalline anisotropy constant versus temperature for magnetite.</p>
            </caption>
            <graphic id="nlm-graphic-31" xlink:href="GGGE-19-1080-g016"/>
          </fig>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0017" orientation="portrait" position="anchor">
            <label>Figure C3</label>
            <caption>
              <p>Saturation magnetization versus temperature for magnetite.</p>
            </caption>
            <graphic id="nlm-graphic-33" xlink:href="GGGE-19-1080-g017"/>
          </fig>
        </sec>
        <sec id="ggge21516-sec-0033">
          <title>C2. Iron</title>
          <p>For iron the experimental data for <italic>M<sub>s</sub></italic> is derived from Crangle and Goodman (<xref rid="ggge21516-bib-0009" ref-type="ref">1971</xref>) and Cullity and Graham (<xref rid="ggge21516-bib-0010" ref-type="ref">2008</xref>), where the sparsity of data near the Curie temperature in tabulated values of Crangle and Goodman (<xref rid="ggge21516-bib-0009" ref-type="ref">1971</xref>) are supplemented data digitized from the <italic>M<sub>s</sub></italic>‐<italic>T</italic> graphs of Cullity and Graham (<xref rid="ggge21516-bib-0010" ref-type="ref">2008</xref>). For <italic>K</italic>
<sub>1</sub>, the experimental data are taken from Honda et al. (<xref rid="ggge21516-bib-0026" ref-type="ref">1928</xref>) reproduced in graphical form in Cullity and Graham (<xref rid="ggge21516-bib-0010" ref-type="ref">2008</xref>). Although this <italic>K</italic>
<sub>1</sub> material parameters fall to zero as the temperature approached the Curie point, more recent studies (e.g., Muxworthy &amp; Williams, <xref rid="ggge21516-bib-0038" ref-type="ref">2015</xref>) use a slightly higher room temperature value. In order to reconcile this discrepancy, the data from Honda et al. (<xref rid="ggge21516-bib-0026" ref-type="ref">1928</xref>) was scaled by a factor (480/456). Finally the exchange constant, <italic>A</italic>, for iron was obtained following the method outlined in Heider and Williams (<xref rid="ggge21516-bib-0024" ref-type="ref">1988</xref>), using the stiffness constant values reported by Stringfellow (<xref rid="ggge21516-bib-0046" ref-type="ref">1968</xref>).</p>
          <p>The polynomial expressions used in MERRILL for each of these there iron parameters is
<disp-formula id="ggge21516-disp-0028"><label>(C4)</label><mml:math id="nlm-math-295"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1.8952</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>3.0657</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1.599</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>4.0151</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>5.3728</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>3.6501</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>9.9515</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>28</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0029"><label>(C5)</label><mml:math id="nlm-math-296"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1.75221</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1.21716</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo> </mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>33.3368</mml:mn><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.363228</mml:mn><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1.96713</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>5.98015</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1.06587</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1.1048</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>6.16143</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>8</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1.42904</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>9</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="ggge21516-disp-0030"><label>(C6)</label><mml:math id="nlm-math-297"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>+</mml:mo><mml:mn>54967.1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>44.2946</mml:mn><mml:mo> </mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.426485</mml:mn><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>0.000811152</mml:mn><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1.07579</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>8.83207</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>2.90947</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>6</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>480.0</mml:mn></mml:mrow><mml:mrow><mml:mn>456.0</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
          <p>Note for iron, <italic>T</italic> is the temperature in Kelvin, although the default temperature unit in MERRILL is Celsius. The conversion to Kelvin is done internally. These parameter polynomials are plotted in Figures <xref rid="ggge21516-fig-0018" ref-type="fig">C4</xref>, <xref rid="ggge21516-fig-0019" ref-type="fig">C5</xref>, <xref rid="ggge21516-fig-0020" ref-type="fig">C6</xref>.</p>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0018" orientation="portrait" position="anchor">
            <label>Figure C4</label>
            <caption>
              <p>Exchange coupling versus temperature for iron.</p>
            </caption>
            <graphic id="nlm-graphic-35" xlink:href="GGGE-19-1080-g018"/>
          </fig>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0019" orientation="portrait" position="anchor">
            <label>Figure C5</label>
            <caption>
              <p>Crystalline anisotropy constant versus temperature for iron.</p>
            </caption>
            <graphic id="nlm-graphic-37" xlink:href="GGGE-19-1080-g019"/>
          </fig>
          <fig fig-type="Figure" xml:lang="en" id="ggge21516-fig-0020" orientation="portrait" position="anchor">
            <label>Figure C6</label>
            <caption>
              <p>Saturation magnetization versus temperature for iron.</p>
            </caption>
            <graphic id="nlm-graphic-39" xlink:href="GGGE-19-1080-g020"/>
          </fig>
        </sec>
      </sec>
    </app>
  </app-group>
</back>
