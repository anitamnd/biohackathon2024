<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7788845</article-id>
    <article-id pub-id-type="publisher-id">3939</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03939-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HapSolo: an optimization approach for removing secondary haplotigs during diploid genome assembly and scaffolding</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Solares</surname>
          <given-names>Edwin A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tao</surname>
          <given-names>Yuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Long</surname>
          <given-names>Anthony D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1334-5556</contrib-id>
        <name>
          <surname>Gaut</surname>
          <given-names>Brandon S.</given-names>
        </name>
        <address>
          <email>bgaut@uci.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.266093.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0668 7243</institution-id><institution>Department of Ecology and Evolutionary Biology, </institution><institution>University of California, Irvine, </institution></institution-wrap>Irvine, CA 92697-2525 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>9</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Despite marked recent improvements in long-read sequencing technology, the assembly of diploid genomes remains a difficult task. A major obstacle is distinguishing between alternative contigs that represent highly heterozygous regions. If primary and secondary contigs are not properly identified, the primary assembly will overrepresent both the size and complexity of the genome, which complicates downstream analysis such as scaffolding.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we illustrate a new method, which we call HapSolo, that identifies secondary contigs and defines a primary assembly based on multiple pairwise contig alignment metrics. HapSolo evaluates candidate primary assemblies using BUSCO scores and then distinguishes among candidate assemblies using a cost function. The cost function can be defined by the user but by default considers the number of missing, duplicated and single BUSCO genes within the assembly. HapSolo performs hill climbing to minimize cost over thousands of candidate assemblies. We illustrate the performance of HapSolo on genome data from three species: the Chardonnay grape (<italic>Vitis vinifera</italic>), with a genome of 490 Mb, a mosquito (<italic>Anopheles funestus</italic>; 200 Mb) and the Thorny Skate (<italic>Amblyraja radiata</italic>; 2650 Mb).</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">HapSolo rapidly identified candidate assemblies that yield improvements in assembly metrics, including decreased genome size and improved N50 scores. Contig N50 scores improved by 35%, 9% and 9% for Chardonnay, mosquito and the thorny skate, respectively, relative to unreduced primary assemblies. The benefits of HapSolo were amplified by down-stream analyses, which we illustrated by scaffolding with Hi-C data. We found, for example, that prior to the application of HapSolo, only 52% of the Chardonnay genome was captured in the largest 19 scaffolds, corresponding to the number of chromosomes. After the application of HapSolo, this value increased to ~ 84%. The improvements for the mosquito’s largest three scaffolds, representing the number of chromosomes, were from 61 to 86%, and the improvement was even more pronounced for thorny skate. We compared the scaffolding results to assemblies that were based on PurgeDups for identifying secondary contigs, with generally superior results for HapSolo.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome</kwd>
      <kwd>Assembly</kwd>
      <kwd>Alternative haplotype</kwd>
      <kwd>Haploid</kwd>
      <kwd>Purge</kwd>
      <kwd>Deduplication</kwd>
      <kwd>Scaffolding</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01OD010974</award-id>
        <award-id>R01GM115562</award-id>
        <principal-award-recipient>
          <name>
            <surname>Long</surname>
            <given-names>Anthony D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1741627</award-id>
        <award-id>1321846</award-id>
        <principal-award-recipient>
          <name>
            <surname>Solares</surname>
            <given-names>Edwin A.</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>Brandon S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec2">
    <title>Background</title>
    <p id="Par7">Traditionally, reference genomes have been produced from genetic materials that simplify assembly; for example, the first two plant species targeted for reference quality genomes, <italic>Arabidopsis thaliana</italic> [<xref ref-type="bibr" rid="CR1">1</xref>] and rice (<italic>Oryza sativa</italic>) [<xref ref-type="bibr" rid="CR2">2</xref>], were chosen in part because they naturally self-fertilize and are therefore highly homozygous. Other early genomes, such as those from <italic>Caenorhabditis elegans</italic> and <italic>Drosophila melanogaster</italic> [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], were also based on inbred, highly homozygous materials. Recent sequencing of additional model and non-model species have continued to rely on near-homozygous materials, either through inbreeding [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] or by focusing on haploid tissue [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par8">The reliance on homozygous materials is fading rapidly, however, for at least three reasons. The first is that it has become clear that inbred materials can misrepresent the natural state of genomes. A dramatic illustration of this fact is that some lines of maize purged 8% of their genome in only six generations of self-fertilization [<xref ref-type="bibr" rid="CR9">9</xref>]; more generally, inbred genomes tend to be smaller than those based on outbreeding species [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The second is that many species of interest cannot be easily manipulated into a homozygous state. Many animals fall into this category, such as mosquitoes [<xref ref-type="bibr" rid="CR12">12</xref>], as do many perennial crops like grapes, which are highly heterozygous [<xref ref-type="bibr" rid="CR13">13</xref>] and can be selfed but only with substantial fitness costs that limits homozygosity [<xref ref-type="bibr" rid="CR14">14</xref>]. Finally, some important features and phenotypes—such as sex determination [<xref ref-type="bibr" rid="CR15">15</xref>] and other important adaptations—can only be identified by analyzing heterozygous samples.</p>
    <p id="Par9">Fortunately, the resolution of highly heterozygous regions, which often contain large structural variants, is now possible due to improvements in sequencing technologies and their affordability. In theory, long-read sequencing technologies, like those from Pacific Biosciences and Oxford Nanopore, provide the capability to resolve distinct haplotypes in heterozygous regions, leading to the assembly of reference-quality diploid genomes [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Several genomes based on highly heterozygous materials have been published recently [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR22">22</xref>], with many additional efforts ongoing.</p>
    <p id="Par10">Nevertheless, the assembly of heterozygous genomes still presents substantial challenges. One challenge is resolving distinct haplotypes in regions of high heterozygosity. Programs that assemble long-reads, such as FALCON and Canu [<xref ref-type="bibr" rid="CR23">23</xref>], can fuse distinct haplotypes into the primary assembly. This haplotype-fusion produces genomes that are much larger than the expected genome size. When haplotypes are fused, either into the same contig or as different contigs into the primary assembly, the increased size and complexity of the assembly complicates down-stream approaches, such as scaffolding by Hi-C or optical mapping. In theory, FALCON-unzip [<xref ref-type="bibr" rid="CR19">19</xref>] solves some problems by identifying alternative (or ‘secondary’) haplotigs that represent the second allele in a heterozygous region and then providing a primary assembly without secondary contigs.</p>
    <p id="Par11">It remains a difficult problem to identify and remove alternative contigs during assembly, but there are some suggested solutions. For example, Redundans identifies secondary contigs via similarities between contigs [<xref ref-type="bibr" rid="CR24">24</xref>] and removes the shorter of two contigs that share some pre-defined level of similarity. Another approach, PurgeHaplotigs uses sequence coverage as a criterion to identify regions with two haplotypes [<xref ref-type="bibr" rid="CR25">25</xref>]. The reasoning behind PurgeHaplotigs is that alternative alleles in a heterozygous region should have only half the raw sequence coverage of homozygous regions. Accordingly, the algorithm proceeds by first remapping raw reads to contigs, then flagging contigs with lower than expected read depth, and finally re-mapping and removing low-coverage contigs from the primary haplotype-fused assembly. A more recent approach, implemented in the purge_dups tool [<xref ref-type="bibr" rid="CR26">26</xref>], builds on the coverage-based approach of PurgeHaplotigs. Purge_dups has been compared to PurgeHaplotigs and is superior based on a few exemplar assemblies [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p id="Par12">Here we report another strategy, which we call HapSolo, to identify and remove potential secondary haplotigs. Our approach is similar to Redundans, in that it begins with an all-by-all pairwise alignment among contigs and uses features of sequence alignment as a basis to identify potential alternative haplotigs. However, HapSolo is unique in exploring the parameter space of alignment properties to optimize the primary assembly, using features of BUSCO scores as the optimization target. Here we detail the approach and implementation of HapSolo, demonstrate that it efficiently identifies primary versus secondary haplotigs and show that it improves Hi-C based scaffolding outcomes relative to purge_dups. HapSolo has been implemented in python and is freely available (<ext-link ext-link-type="uri" xlink:href="https://github.com/esolares/HapSolo">https://github.com/esolares/HapSolo</ext-link>).</p>
  </sec>
  <sec id="Sec3">
    <title>Approach and implementation</title>
    <sec id="Sec4">
      <title>Pre-processing</title>
      <p id="Par13">Our method begins with the set of contigs from genome assembly. In theory, HapSolo will work for any set of contigs from any assembler and from any sequencing type (i.e., short-read, long-read or merged assemblies). Given the set of contigs, the first steps are to size sort the contigs and then to perform an all-by-all pairwise alignment among all contigs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, steps 1 and 2), using each contig as both a reference and a query. In theory, pre-processing alignments can be performed with any algorithm, with the HapSolo implementation supporting either BLAT [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] or minimap2 [<xref ref-type="bibr" rid="CR29">29</xref>] input files.<fig id="Fig1"><label>Fig. 1</label><caption><p>A schematic showing the basic workflow and ideas behind HapSolo. The rectangles on the right illustrate the basic steps, including pre-processing (blue rectangles), steps within HapSolo (red rectangles) and post-processing (green rectangle). Some of the HapSolo steps include iterations to perform hill climbing calculations, as described in the text and shown by the arrow. On the left, step 1 shows the contigs from the primary assembly, and step 2 illustrates the all-by-all alignment of contigs. Step 3 provides examples of some properties of potential alignments. The metrics—ID, Q and QR—were defined to help capture some of the variation among these conditions. Step 4 illustrates that new primary assemblies are formed by dropping putative secondary contigs</p></caption><graphic xlink:href="12859_2020_3939_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Steps within HapSolo</title>
      <p id="Par14">HapSolo imports alignment results into a PANDAS (<ext-link ext-link-type="uri" xlink:href="https://pandas.pydata.org/">https://pandas.pydata.org/</ext-link>) dataframe to form a table with rows representing pairs of aligned contigs and columns containing descriptive statistics for each pairwise comparison (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 3). Columns include the percent nucleotide identity between contigs (<italic>ID</italic>), a metric similar to those used in previous haplotig reduction programs; the proportion of the query contig length that aligns to the reference contig (<italic>Q</italic>), which is included to recognize that alignments can be clipped; and the ratio of the proportion of the query aligned to the reference relative to the proportion of the reference aligned to the query (<italic>QR</italic>). <italic>QR</italic> is considered because it reflects properties of aligned length and potential structural variant differences between contigs. A downside of <italic>QR</italic> is that it can reach values &gt; 1.0, as longer variants may exist in either the query or the reference, and it is also non-symmetric. To compensate for this we include a symmetric value, which we define as <italic>QR</italic>′ = <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}^{-{log}_{2}(QR)}$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3939_Article_IEq1.gif"/></alternatives></inline-formula>. The four parameters—<italic>ID</italic>, <italic>Q, QR</italic> and <italic>QR</italic>′—are the basis for filtering query contigs from the table and defining them as putative secondary contigs. For simplicity, however, we will emphasize <italic>QR</italic>, because <italic>QR</italic>′ is dependent on <italic>QR</italic>.</p>
      <p id="Par15">In addition to the alignment table, HapSolo generates a table of BUSCO properties [<xref ref-type="bibr" rid="CR30">30</xref>] for each contig. This BUSCO analysis is performed on each contig of the assembly prior to running HapSolo’s reduction algorithm. To perform these analyses, contigs are split into individual FAStA files and then BUSCO v3.0.2 is run on each contig separately so that they can be evaluated in parallel. Ultimately, the BUSCO table generated by HapSolo contains a list of complete (C) and fragmented (F) BUSCO genes for each contig. This table is integral for rapidly evaluating potential candidate assemblies.</p>
      <p id="Par16">Given the alignment table and the BUSCO table, HapSolo begins by assigning threshold values for <italic>ID</italic>, <italic>Q</italic> and <italic>QR</italic>, which we denote as <italic>ID</italic><sub><italic>T</italic></sub>, <italic>Q</italic><sub><italic>T</italic></sub> and <italic>QR</italic><sub><italic>T</italic></sub>. The threshold values can be assigned randomly, with set default values or with values defined by the user. The threshold values are applied to the alignment table to identify query contigs for purging. To be removed, a query contig must be in a pairwise alignment that satisfies three conditions: (1) an <italic>ID</italic> value ≥ <italic>ID</italic><sub><italic>T</italic></sub>; (2) a <italic>Q</italic> value ≥ <italic>Q</italic><sub><italic>T</italic></sub>; and (3) a <italic>QR</italic> value that falls within the range min(<italic>QR</italic><sub><italic>T</italic></sub>,<italic>QR</italic>′<sub><italic>T</italic></sub>) and max(<italic>QR</italic><sub><italic>T</italic></sub>,<italic>QR</italic>′<sub><italic>T</italic></sub>). After purging query contigs, HapSolo calculates the number of Fragmented (F), Missing (M), Duplicated (D) and Single-Copy (S) BUSCO genes across all of the primary contigs that remain in the candidate assembly, based on values in the BUSCO table. It then calculates the <italic>Cost</italic> of the candidate assembly as:<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Cost = \left( {\uptheta _{1} {\text{M}} +\uptheta _{2} {\text{D}} +\uptheta _{3} {\text{F}}} \right)/\uptheta _{4} {\text{S}}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>M</mml:mtext><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mtext>D</mml:mtext><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mtext>F</mml:mtext></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mtext>S</mml:mtext></mml:mrow></mml:math><graphic xlink:href="12859_2020_3939_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where θ<sub>1,</sub> θ<sub>2</sub>, θ<sub>3</sub>, and θ<sub>4</sub> are weights that can vary between 0.0 and 1.0. Weights can be assigned by users; for all of our analyses below, we employ weights of 0.0 for F and 1.0 for M, D and S.</p>
      <p id="Par17">We then employ hill climbing to minimize <italic>Cost</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Once <italic>Cost</italic> is calculated with random starting values, <italic>ID</italic><sub><italic>T</italic></sub>,<italic> Q</italic><sub><italic>T</italic></sub> and <italic>QR</italic><sub><italic>T</italic></sub> are modified at each iteration by a randomized step in the positive direction, which in turn defines a new set of primary contigs for a new cost evaluation. The steps consist of a fixed increment, which can be set by the user but is set to 0.0001 by default, multiplied by a random value sampled from U(0,1). As such, HapSolo utilizes a randomized forward walking agent to traverse the search space. If <italic>Cost</italic> does not change with new parameter values for a specified number of steps or if parameters increase past their maximum limits of <italic>ID</italic><sub><italic>T</italic></sub> = <italic>Q</italic><sub><italic>T</italic></sub> = 1.00, then HapSolo assigns new random values of <italic>ID</italic><sub><italic>T</italic></sub>, <italic>Q</italic><sub><italic>T</italic></sub> and <italic>QR</italic><sub><italic>T</italic></sub>. The process is repeated for <italic>n</italic> total iterations, and the iteration(s) with the smallest <italic>Cost</italic> are used to define the final set of primary contigs. When there are multiple solutions that minimize <italic>Cost</italic>, we retain all unique solutions; these additional solutions can be exported by the user for post-processing steps and evaluation. The values that determine the behavior of this minimization—e.g., the threshold for the number of consecutive cost plateaus, the number of <italic>x</italic> unique best candidate assemblies retained, the increase in step size by a fixed value, and the total number of iterations—can be set by the user.</p>
      <p id="Par18">To retain candidate assemblies with the smallest <italic>Cost</italic>, we implemented a unique priority queue (UPQ). The UPQ maintains a maximum number of <italic>x</italic> best assemblies, where <italic>x</italic> can be set by the user. The UPQ initially takes a list of one set of values, the score, primary contigs and other assembly information. The UPQ then takes the number of primary contigs for each of the candidate assemblies and sorts them by size. It then compares only the candidate assemblies of the same size, because assemblies of unequal size cannot be the same assembly. Therefore our algorithm, in order to reduce the number of contig set comparisons, only compares contig sets of the same size. Once it is established that the candidate assemblies of the same number of contigs are equal, only the candidate assembly with the lowest score is saved. The list is then sorted by score and returned. This allows retention of the max score of the best <italic>x</italic> number of assemblies by looking at the score of the last candidate assembly in the list, giving <italic>O</italic>(<italic>1</italic>) access to this value. Sorting takes <italic>O</italic>(<italic>x log</italic>(<italic>x</italic>)), where <italic>x</italic> is the best number of candidate assemblies to return, giving our UPQ a time complexity of <italic>O</italic>(<italic>x log</italic>(<italic>x</italic>)). Since we can instantaneously access the worst of the <italic>x</italic> candidate assemblies, we then perform an integer comparison of the score of our current candidate assembly with the worst score of our best <italic>x</italic> number of assemblies, reducing our computational time complexity. Only assemblies with the same or lower scores than the worst candidate assembly are then added to our UPQ. This reduces our total time complexity to <italic>O</italic>(<italic>i x log</italic>(<italic>x</italic>)) where <italic>i</italic> is the number of iterations which produce scores lower than our max of <italic>x</italic>, and <italic>x</italic> is the number of best candidate assemblies to keep.</p>
    </sec>
    <sec id="Sec6">
      <title>Post-processing</title>
      <p id="Par19">Once HapSolo converges on a set (or <italic>x</italic> sets) of primary contigs that minimize <italic>Cost</italic>, the contig set is employed for post-processing to evaluate the candidate assembly. Specifically, we run QUAST v4.5 [<xref ref-type="bibr" rid="CR31">31</xref>] and BUSCO 3.0.2 on the set of primary contigs that represent the best (or set of <italic>x</italic> best) candidate assemblies. QUAST measures basic genome assembly statistics, such as, N50, total assembly length, L50 and the largest contig size. Although not part of the HapSolo method, we provide scripts that run QUAST and BUSCO to output their results into a single score file.</p>
    </sec>
    <sec id="Sec7">
      <title>Implementation and requirements</title>
      <p id="Par20">HapSolo has been implemented and optimized for Python 2.7, but it is also supported under Python 3. However, we recommend using Python 2.7, for faster run times. HapSolo requires the input of a contig assembly (as a FAStA file), the location of a directory for individual contig BUSCO results, and the input of pairwise alignments. It currently supports either BLAT or minimap2 alignment output files (PSL or PAF or compressed PSL.gz or PAF.gz file).</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Primary assemblies</title>
      <p id="Par21">We illustrate the application and results of HapSolo on three diploid genome data sets. The three—including the Chardonnay grape (<italic>Vitis vinifera</italic>), the Anopheles mosquito (<italic>A. funestus</italic>) and the Thorny Skate (<italic>Amblyraja radiata</italic>)—represent a range of expected genome sizes, at 490 Mb [<xref ref-type="bibr" rid="CR32">32</xref>], 200 Mb [<xref ref-type="bibr" rid="CR20">20</xref>] and 2560 Mb (<ext-link ext-link-type="uri" xlink:href="https://vgp.github.io/genomeark/Amblyraja_radiata/">https://vgp.github.io/genomeark/Amblyraja_radiata/</ext-link>), respectively. The three datasets also represent a range of raw sequence coverage (at 58×, 240×, and 128×, respectively), and two different assembly methods—i.e., a hybrid assembly for Chardonnay [<xref ref-type="bibr" rid="CR13">13</xref>] and Falcon_Unzip for both mosquito [<xref ref-type="bibr" rid="CR20">20</xref>] and thorny skate [<xref ref-type="bibr" rid="CR33">33</xref>]. The sequencing data are based on the Pacific Biosciences (PacBio) sequencing platform, but HapSolo should be applicable to any contig assembly drafted from any long-read assembler.</p>
      <p id="Par22">For pre-processing, we utilized pairwise alignments with BLAT and minimap2 for the Chardonnay and mosquito data. To limit run time, we applied BLAT to the Chardonnay and mosquito data without long contigs (&gt; 10 Mb) as queries, because we reasoned that &gt; 10 Mb contigs are unlikely to represent alternative haplotigs (see “<xref rid="Sec16" ref-type="sec">Methods”</xref> section). These long contigs were included as references, however, so that they are represented in pairwise alignments. We used only minimap2 for the larger skate genome, due to prohibitively long run times with BLAT.</p>
      <p id="Par23">For each species, we applied HapSolo with and without hill climbing and compared the outcomes to the original unreduced assembly. Table <xref rid="Tab1" ref-type="table">1</xref> provides assembly statistics, and it illustrates improvements from the unreduced assembly, to the assembly without hill climbing (−HC) based on default values, and finally to the assembly with hill climbing (+HC), which is based on random starting values and 50,000 iterations. Focusing on Chardonnay, for example, the primary contig genome size declined 13% from the unreduced assembly to the −HC assembly and another 5% from the −HC assembly to the +HC assembly. Not surprisingly, as genome size decreased, so did the number of contigs included in the assembly, which fell from 2072 to 1369 (−HC) to 1155 (+HC). Moreover, contig N50 increased by 35% from 1.066 Mb to 1.441 Mb. Similar results were achieved after applying HapSolo to contigs from mosquito and thorny skate (Table <xref rid="Tab1" ref-type="table">1</xref>). For both assemblies, the number of contigs, L50 and genome size decreased, while the contig N50 improved by 9% for both mosquito and the thorny skate. We note, however, that hill climbing did not increase N50 for the mosquito assembly much beyond that achieved by applying HapSolo for one iteration with its default values, suggesting that the default values performed well by this measure with this dataset.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Contig assembly statistics for three primary assemblies for each of three species</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species</th><th align="left" colspan="3">Chardonnay</th><th align="left" colspan="3">Mosquito</th><th align="left" colspan="3">Thorny Skate<sup>d</sup></th></tr><tr><th align="left">Assembly type</th><th align="left">No HapSolo<sup>a</sup></th><th align="left">HapSolo –HC<sup>b</sup></th><th align="left">HapSolo +HC<sup>c</sup></th><th align="left">No HapSolo</th><th align="left">HapSolo −HC2</th><th align="left">HapSolo +HC3</th><th align="left">No HapSolo</th><th align="left">HapSolo −HC</th><th align="left">HapSolo +HC</th></tr></thead><tbody><tr><td align="left"># of Contigs</td><td align="left">2072</td><td align="left">1369</td><td align="left">1155</td><td align="left">1073</td><td align="left">674</td><td align="left">666</td><td align="left">16,218</td><td align="left">14,494</td><td align="left">12,937</td></tr><tr><td align="left">Contig assembly size (Mb)</td><td align="left">655.2</td><td align="left">569.3</td><td align="left">539.0</td><td align="left">212.0</td><td align="left">200.4</td><td align="left">200.0</td><td align="left">3229.4</td><td align="left">3147.8</td><td align="left">3031.3</td></tr><tr><td align="left">Largest contig (Mb)</td><td align="left">11.6</td><td align="left">11.6</td><td align="left">11.6</td><td align="left">7.6</td><td align="left">7.6</td><td align="left">7.6</td><td align="left">3.4</td><td align="left">3.4</td><td align="left">3.4</td></tr><tr><td align="left">Contig N50 (Mb)</td><td align="left">1.1</td><td align="left">1.3</td><td align="left">1.4</td><td align="left">0.6</td><td align="left">0.7</td><td align="left">0.7</td><td align="left">0.4</td><td align="left">0.4</td><td align="left">0.5</td></tr><tr><td align="left">Contig L50</td><td align="left">141</td><td align="left">106</td><td align="left">95</td><td align="left">86</td><td align="left">77</td><td align="left">77</td><td align="left">2022</td><td align="left">1928</td><td align="left">1800</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Results in this column are based on the primary assembly without application of HapSolo</p><p><sup>b</sup>Results in this column are based on application of HapSolo without hill climbing (−HC) and with default parameters of ID, Q and QR = 0.70</p><p><sup>c</sup>Results in this column are based on application of HapSolo with 50,000 cycles of hill climbing (+HC)</p><p><sup>d</sup>Results for HapSolo were generated using minimap2. Chardonnay and mosquito statistics are based on BLAT</p></table-wrap-foot></table-wrap></p>
      <p id="Par24">Although N50 did not decline for the mosquito data, our implementation of hill climbing reduced <italic>Cost,</italic> as we expected, with the expected effects on BUSCO scores. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates a sorted representation of <italic>Cost</italic>, showing that lower <italic>Cost</italic>s were identified. The behavior of hill climbing is dependent on the assembly, starting values for the three parameters (<italic>ID</italic><sub><italic>T</italic></sub>, <italic>Q</italic><sub><italic>T</italic></sub> and <italic>QR</italic><sub><italic>T</italic></sub>), and the number of local minima in the <italic>Cost</italic> function. Nonetheless, substantial improvements occurred within the first 1000 iterations for all three datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), with only minor improvements thereafter. Overall, the improvement in <italic>Cost</italic> suggests value in applying hill climbing to new data sets, especially given that the computational requirements are minor (see below).
<fig id="Fig2"><label>Fig. 2</label><caption><p>A graph of the sorted performance of hill climbing over 5000 iterations, with normalized <italic>Cost</italic> on the <italic>y</italic>-axis and the number of iterations on the <italic>x</italic>-axis. For most of our analyses with HC, we performed 5000 iterations on each of 10 cores; here we are showing results from one core. The top right provides a graph with altered scale for better visualization of Chardonnay and mosquito results</p></caption><graphic xlink:href="12859_2020_3939_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par25">Table <xref rid="Tab2" ref-type="table">2</xref> complements information about <italic>Cost</italic> by reporting BUSCO scores. HapSolo achieved its principal goal, which is to generally increase the representation of single copy (S) BUSCO genes and decrease duplicated (D) genes in reduced compared to unreduced assemblies. Note the differences between the −HC and +HC assemblies, because in some cases the −HC assembly had more single copy genes but at the cost of also having more duplicated genes. Thus, the +HC option can produce assemblies with lower <italic>Cost</italic> but with fewer BUSCO genes.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Starting and ending BUSCO values for the three species for primary contig assemblies</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">No HapSolo</th><th align="left" colspan="2">HapSolo (−HC)</th><th align="left" colspan="2">HapSolo (+HC)</th></tr></thead><tbody><tr><td align="left">Species</td><td align="left">GS<sup>a</sup></td><td align="left">BUSCO<sup>b</sup></td><td align="left">GS</td><td align="left">BUSCO</td><td align="left">GS</td><td align="left">BUSCO</td></tr><tr><td align="left" rowspan="3">Chardonnay</td><td align="left" rowspan="3">655.2</td><td align="left">C:1357</td><td align="left" rowspan="3">569.3</td><td align="left">C:1356</td><td align="left" rowspan="3">539.0</td><td align="left">C:1357</td></tr><tr><td align="left">S:1004</td><td align="left">S:1152</td><td align="left">S:1205</td></tr><tr><td align="left">D:353</td><td align="left">D:204</td><td align="left">D:152</td></tr><tr><td align="left" rowspan="3">Mosquito</td><td align="left" rowspan="3">212.0</td><td align="left">C:2640</td><td align="left" rowspan="3">200.4</td><td align="left">C:2609</td><td align="left" rowspan="3">200.0</td><td align="left">C:2621</td></tr><tr><td align="left">S:2493</td><td align="left">S:2548</td><td align="left">S:2566</td></tr><tr><td align="left">D:147</td><td align="left">D:61</td><td align="left">D:55</td></tr><tr><td align="left" rowspan="3">Thorny Skate</td><td align="left" rowspan="3">3229.4</td><td align="left">C:2091</td><td align="left" rowspan="3">3147.8</td><td align="left">C:2087</td><td align="left" rowspan="3">3031.3</td><td align="left">C:2080</td></tr><tr><td align="left">S:1651</td><td align="left">S:1675</td><td align="left">S:1715</td></tr><tr><td align="left">D:440</td><td align="left">D:412</td><td align="left">D:365</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Genome Size (GS) based on the sum of all contigs for the primary assembly</p><p><sup>b</sup>Busco based on all contigs prior to the application of HapSolo. The three values represent the complete (C), the single (S) and duplicated (D) BUSCO genes</p></table-wrap-foot></table-wrap></p>
      <p id="Par26">Figure <xref rid="Fig3" ref-type="fig">3</xref> plots the cumulative contig assembly length for the three assemblies for each of the three species, and it illustrates two important points. First, HapSolo reduced the total assembly length primarily by removing numerous contigs of small size. Second, differences between the −HC and +HC reduced assemblies were more evident for some species (e.g., thorny skate) than for others (e.g., Chardonnay). Nonetheless, when there were differences, hill climbing decreased both assembly size (Table <xref rid="Tab1" ref-type="table">1</xref>) and <italic>Cost</italic> (Table <xref rid="Tab2" ref-type="table">2</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>The cumulative assembly size (cdf) based on contigs. For Chardonnay (<bold>a</bold>) and mosquito (<bold>b</bold>), the five lines depict: an unreduced assembly (-HapSolo −HC), HapSolo applied with default parameter values and no hill climbing (+HapSolo −HC) using BLAT or minimap2 (+Hap Solo +MM2 −HC), HapSolo with random starting values and 50,000 iterations of hill climbing using BLAT (+HapSolo +HC) or minimap2 (+HapSolo +MM2 +HC). For thorny skate (<bold>c</bold>), three analyses were performed: an unreduced assembly (-HapSolo −HC) and Hapsolo analyses based on minimaps 2 pairwise alignment with and without hillclimbing</p></caption><graphic xlink:href="12859_2020_3939_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Hi-C scaffolding results</title>
      <p id="Par27">HapSolo focuses on the improvement of primary assemblies, but there are potential advantages for removing haplotigs for downstream operations like scaffolding. Failing to remove duplicate haplotigs can cause false joins between duplicate haplotigs or lead to non-parsimonious joins between duplicate haplotigs and adjacent single copy regions. Here we illustrate the advantage of running HapSolo on primary assemblies prior to Hi-C scaffolding. For these analyses, the unreduced assembly and both reduced assemblies (i.e., −HC and +HC) were scaffolded using the 3D-DNA pipeline [<xref ref-type="bibr" rid="CR34">34</xref>], resulting in more continuous assemblies overall. We compared the improvements of the two scaffolded HapSolo assemblies against the unreduced scaffolded assembly (Table <xref rid="Tab3" ref-type="table">3</xref>). Gains in improvements to the largest scaffold were clear across all assemblies relative to the unreduced assembly. For example, the largest scaffold increased by 1.71× (−HC) and 1.91× (+HC) for Chardonnay and by 1.22× (−HC) and 2.18× (+HC) for mosquito (Table <xref rid="Tab3" ref-type="table">3</xref>).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Scaffolded assembly statistics after Hi-C analysis on HapSolo assemblies, for three primary assemblies for each of three species</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species</th><th align="left" colspan="3">Chardonnay</th><th align="left" colspan="3">Mosquito</th><th align="left" colspan="3">Thorny Skate<sup>f</sup></th></tr><tr><th align="left">Assembly type</th><th align="left">No HapSolo<sup>a</sup></th><th align="left">HapSolo −HC<sup>b</sup></th><th align="left">HapSolo +HC<sup>c</sup></th><th align="left">No HapSolo</th><th align="left">HapSolo −HC</th><th align="left">HapSolo +HC</th><th align="left">No HapSolo</th><th align="left">HapSolo −HC</th><th align="left">HapSolo +HC</th></tr></thead><tbody><tr><td align="left"># of Scaffolds</td><td align="left">1332</td><td align="left">2748</td><td align="left">2403</td><td align="left">1211</td><td align="left">603</td><td align="left">611</td><td align="left">14,238</td><td align="left">12,269</td><td align="left">10,009</td></tr><tr><td align="left">% of Genome in <italic>k</italic> largest scaffolds<sup>d,e</sup></td><td align="left">52.0%</td><td align="left">89.0%</td><td align="left">84.0%</td><td align="left">61.9%</td><td align="left">68.3%</td><td align="left">85.7%</td><td align="left">31.5%</td><td align="left">104.7%</td><td align="left">106.3%</td></tr><tr><td align="left">% of Genome in Scaffolds &gt; 10Mb<sup>e</sup></td><td align="left">44.0%</td><td align="left">94.0%</td><td align="left">94.0%</td><td align="left">93.5%</td><td align="left">94.7%</td><td align="left">94.1%</td><td align="left">40.4%</td><td align="left">103.3%</td><td align="left">105.5%</td></tr><tr><td align="left">Scaffold assembly size (Mb)</td><td align="left">656.1</td><td align="left">570.4</td><td align="left">540.1</td><td align="left">212.5</td><td align="left">200.8</td><td align="left">200.3</td><td align="left">3240</td><td align="left">3158</td><td align="left">3039</td></tr><tr><td align="left">Largest scaffold (Mb)</td><td align="left">19.1</td><td align="left">32.6</td><td align="left">36.5</td><td align="left">43.6</td><td align="left">53.0</td><td align="left">95.0</td><td align="left">170.0</td><td align="left">208.4</td><td align="left">250.5</td></tr><tr><td align="left">Scaffold N50 (Mb)</td><td align="left">7.2</td><td align="left">23.5</td><td align="left">20.7</td><td align="left">37.9</td><td align="left">41.5</td><td align="left">41.6</td><td align="left">62.1</td><td align="left">65.5</td><td align="left">69.8</td></tr><tr><td align="left">Scaffold L50</td><td align="left">28</td><td align="left">11</td><td align="left">11</td><td align="left">3</td><td align="left">3</td><td align="left">2</td><td align="left">16</td><td align="left">35</td><td align="left">13</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Results in this column were based on the primary assembly without application of HapSolo</p><p><sup>b</sup>Results in this column were based on application of HapSolo without hill climbing (−HC) and default parameters of ID, Q and QR</p><p><sup>c</sup>Results in this column were based on application of HapSolo with 50,000 cycles of hill climbing (+HC)</p><p><sup>d</sup>Percentage of genome in the largest <italic>k</italic> scaffolds, where <italic>k</italic> is equal to the number of chromosomes expected for each species</p><p><sup>e</sup>Percentages normalized using expected genome sizes of 490 Mb, 200 Mb and 2560 Mb for chardonnay, mosquito and thorny skate respectively</p><p><sup>f</sup>Results for HapSolo were generated using minimap2</p></table-wrap-foot></table-wrap></p>
      <p id="Par28">Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates the distribution of scaffolds for each of the three species under various HapSolo implementations. For each scaffold we measured the proportion of the genome that was contained in the <italic>k</italic> largest scaffolds, where <italic>k</italic> is the haploid number of chromosomes for each species. For example, Chardonnay has 19 chromosomes, and the 19 largest scaffolds based on the unreduced assembly represented 52% of the genome size. Following HapSolo haplotig reduction, the largest 19 scaffolds encompassed up to 93% of the total expected genome size of 490 Mb. Similar improvements were identified for the two other species, with mosquito improving from 61.9 to 85.7% and thorny skate from 31.5 to 106.3%. The observation that  106.3% of the thorny skate is contained in the largest <italic>k</italic> scaffolds indicates that the expected genome size is incorrect or that there is a need for additional purging of haplotigs.<fig id="Fig4"><label>Fig. 4</label><caption><p>The cumulative assembly size (cdf) based on scaffolds for a different species in each row. The three rows represent analyses based on Chardonnay (<bold>a</bold>), mosquito (<bold>b</bold>) and thorny skate (<bold>c</bold>) data. There are two graphs for each species; the one on the left focuses on the chromosome length scaffold portion of the assembly (number of scaffolds), while the one on the right is the complete assembly on a log<sub>10</sub> (number of scaffolds) scale. Each graph for Chardonnay and mosquito have five lines and follow the key provided in the right-hand graph in panel B for mosquito. The analyses are scaffolded genome based on purge_dups (purge_dups + HiC), the unreduced assembly (-HapSolo −HC  +HiC), scaffold based on the HapSolo reduced assembly with BLAT preprocessing and without hill climbing (+HapSolo −HC  +HiC), and the scaffold based on the HapSolo reduced assembly with BLAT preprocessing and with hill climbing (+HapSolo +HC +HiC) and, finally, HapSolo reduced assembly with hill climbing using minimap2 (+HapSolo +MM2 +HC +HiC). In all graphs, the dotted line indicates the number of chromosomes for the species. <bold>c</bold> Reports results for thorny skate, which did not include BLAT processing. The HapSolo analyses are based on minimap2 alignments and presented with (+HC) and without (−HC) hillclimbing</p></caption><graphic xlink:href="12859_2020_3939_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par29">HapSolo scaffolded assemblies were always demonstrably superior to the unreduced scaffolded assemblies for all three species, but the additional value of hill climbing varied among datasets. The value of hill climbing was clear for the mosquito, where the first 3 scaffolds (representing <italic>k</italic> = 3 chromosomes) represented ~ 68% of genome with scaffolded −HC assembly versus 86% for the +HC reduced assembly. In contrast, hill climbing produced a disadvantage for Chardonnay (<italic>k</italic> = 19, 92.6% −HC vs. 88.0% +HC) and only a small improvement for thorny skate (<italic>k</italic> = 49, 104.7% −HC vs. 106.3% +HC). This being said, our metric based on the proportion of the genome in the <italic>k</italic> largest scaffolds is imperfect. For example, something as simple as a single split chromosome representing two metacentric arms could have a large effect on the metric. We therefore also examined other metrics, like the percentage of the genome encompassed in &gt; 10 Mb scaffolds and the longest scaffold. The largest differences were again due to application of HapSolo, with sometimes relatively minor differences associated with hill climbing (Table <xref rid="Tab3" ref-type="table">3</xref>).</p>
      <p id="Par30">Finally, we focused on results based on comparing the two pre-processing alignment algorithms, BLAT and minimap2. We applied both algorithms to Chardonnay and mosquito. For mosquito, the results were similar with either aligner, but the BLAT results were markedly superior for Chardonnay (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>). We do not know the cause of the discrepancy with Chardonnay, but we note that it is a genome that contains extensive structural variation between haplotypes, such that ~ 15% of genes are estimated to be in a hemizygous state [<xref ref-type="bibr" rid="CR13">13</xref>]. We suspect that minimap2 often failed to extend alignments beyond large insertion and deletion events, even though we applied it with low gap and extension penalties substantially (see “Methods” section). Minimap2 is, however, highly preferable for run times, and it can be applied easily to gigabase-scale genomes like thorny skate.</p>
    </sec>
    <sec id="Sec11">
      <title>Comparing HapSolo to an alternative method</title>
      <p id="Par31">Other algorithms have been devised to identify and remove alternative haplotigs [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. In the publication of purge_dups, Guan et al. [<xref ref-type="bibr" rid="CR26">26</xref>] compared its performance to PurgeHaplotigs and found it to be generally superior. We compared HapSolo to purge_dups, focusing on scaffolding results after Hi-C analysis. Figure <xref rid="Fig4" ref-type="fig">4</xref> indicates that HapSolo generally led to better scaffolded assemblies than purge_dups, but with some caveats. For example, the HapSolo-based Chardonnay assembly was superior to the purge_dups assembly when BLAT was used to perform pre-processing. In this case, the percentage of the genome with &gt; 10 Mb scaffolds was 97.7% for HapSolo versus 67.4% purge_dups, with a 32% improvement in largest scaffold (Table <xref rid="Tab4" ref-type="table">4</xref>). However, purge_dups performed similarly to HapSolo for Chardonnay when pairwise alignments were based on minimap2 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For mosquito, purge_dups performed more poorly than HapSolo with either pre-processing aligner, as long as hill climbing was included in HapSolo analysis. Finally, for the larger thorny skate genome, HapSolo with hill climbing outperformed purge_dups (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), resulting in a higher proportion of genomes in <italic>k</italic> scaffolds, more large (&gt; 10 Mb) scaffolds, and a 26% larger ‘largest scaffold’ (Table <xref rid="Tab4" ref-type="table">4</xref>). Overall, HapSolo performed as well or better than purge_dups, based on the three exemplar datasets.<table-wrap id="Tab4"><label>Table 4</label><caption><p>A comparison of scaffolded assemblies after Hi-C analysis, based on HapSolo and purge_dups primary assemblies</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species<sup>a</sup></th><th align="left" colspan="2">Chardonnay</th><th align="left" colspan="2">Mosquito</th><th align="left" colspan="2">Thorny Skate</th></tr><tr><th align="left">Assembly type</th><th align="left">HapSolo +HC<sup>b</sup></th><th align="left">purge_dups</th><th align="left">HapSolo +HC</th><th align="left">purge_dups</th><th align="left">HapSolo +HC<sup>e</sup></th><th align="left">purge_dups</th></tr></thead><tbody><tr><td align="left"># of Scaffolds</td><td align="left">2403</td><td align="left">294</td><td align="left">611</td><td align="left">635</td><td align="left">10,009</td><td align="left">1534</td></tr><tr><td align="left">% of Genome in <italic>k</italic> largest scaffolds<sup>c</sup></td><td align="left">88.0%</td><td align="left">58.5%</td><td align="left">85.7%</td><td align="left">83.7%</td><td align="left">106.3%</td><td align="left">86.8%</td></tr><tr><td align="left">% of Genome in scaffolds  &gt; 10M<sup>d</sup></td><td align="left">97.7%</td><td align="left">67.4%</td><td align="left">94.1%</td><td align="left">92.7%</td><td align="left">105.6%</td><td align="left">86.0%</td></tr><tr><td align="left">Scaffold assembly size (Mb)</td><td align="left">540.1</td><td align="left">470.4</td><td align="left">200.4</td><td align="left">200.3</td><td align="left">3039.3</td><td align="left">2251.4</td></tr><tr><td align="left">Largest scaffold (Mb)</td><td align="left">36.5</td><td align="left">24.9</td><td align="left">95.0</td><td align="left">74.1</td><td align="left">250.5</td><td align="left">184.1</td></tr><tr><td align="left">Scaffold N50 (Mb)</td><td align="left">20.7</td><td align="left">12.7</td><td align="left">41.6</td><td align="left">51.2</td><td align="left">69.8</td><td align="left">61.7</td></tr><tr><td align="left">Scaffold L50</td><td align="left">11</td><td align="left">15</td><td align="left">2</td><td align="left">2</td><td align="left">13</td><td align="left">11</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Data for HapSolo are based on BLAT alignments for Chardonnay and mosquito, and minimap2 alignments for thorny skate</p><p><sup>b</sup>Results in the +HC columns are based on application of HapSolo with 50,000 cycles of hill climbing (+HC)</p><p><sup>c</sup>Percentage of genome in the largest <italic>k</italic> scaffolds, where <italic>k</italic> is equal to the number of chromosomes expected for each species. Percentages are normalized using expected genome sizes of 490 Mb, 200 Mb and 2560 Mb for Chardonnay, mosquito and thorny skate respectively</p><p><sup>d</sup>Percentages normalized using expected genome sizes of 490 Mb, 200 Mb and 2560 Mb for chardonnay, mosquito and thorny skate respectively</p><p><sup>e</sup>Results for HapSolo were generated using minimap2</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Applying HapSolo to a genome with low heterozygosity</title>
      <p id="Par32">HapSolo was designed to address a specific problem: the assembly of highly heterozygous genomes with divergent haplotigs. We chose our three exemplars to represent the problem. But how does HapSolo perform on less heterozygous genomes? We applied HapSolo to the mouse, <italic>Peromyscus leucopus</italic>, a mammalian genome from a single diploid individual with low (0.33%) heterozygosity [<xref ref-type="bibr" rid="CR35">35</xref>]. In samples with low heterozygosity, alternative haplotigs are less likely to exist, and hence we expect fewer benefits with the application of HapSolo. Indeed, we found no benefit. Comparing results between the reference assembly and the HapSolo assembly (with minimap 2 and hill climbing), we found similar proportions of the genome encompassed in 10 Mb scaffolds (96.8% vs. 95.7%) and a substantially smaller proportion of the genome encompassed in <italic>k</italic> = 24 chromosomes (88.5% vs. 71.1%) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The HapSolo assembly was, however, largely contiguous with the reference assembly (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). Interestingly, purge_dups did not find any alternative contigs on this assembly and ultimately failed with an error, so we are unable to compare its performance.</p>
      <p id="Par33">In addition to the low heterozygosity, the <italic>P. leucopus</italic> genome has a low percentage of duplicated BUSCOs relative to the complete set of BUSCOs, at 2.1% (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In contrast, Chardonnay, mosquito and thorny skate have 26.0%, 5.5% and 21.0%, respectively (Table <xref rid="Tab2" ref-type="table">2</xref>). Perhaps unsurprisingly, given this statistic, mosquito exhibits the least dramatic improvements in assembly statistics after application of HapSolo (Table <xref rid="Tab3" ref-type="table">3</xref>). These observations suggest that there are lower limits at which HapSolo becomes ineffective and perhaps even detrimental. Based on the data we have analyzed, we suggest that ~ 5% may be a lower limit for the proportion of duplicated BUSCOs. Heterozygosity is likely to define another lower limit. Given that heterozygosity is 0.33% for <italic>P. leucopus</italic>, we expect that HapSolo will not be useful for the assembly of human genomes, because species-wide human heterozygosity is 0.05% [<xref ref-type="bibr" rid="CR36">36</xref>]. Our results nonetheless suggest that HapSolo is likely to be a helpful tool for assemblies with a high number of duplicate BUSCOs.</p>
    </sec>
    <sec id="Sec13">
      <title>Execution time and memory efficiency</title>
      <p id="Par34">To measure runtime, HapSolo was run on dual CPU Intel E5-2696 V2 nodes containing 512 GB of RAM and storage attached via a 40Gbe Infiniband connection. CPU runtime depends on the number of iterations, but it is also dependent on the data and parameter values. We measured runtime across the datasets, measuring different configurations in terms of the number of cores and the number of iterations per core (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Under the conditions we used for empirical data (i.e., hill climbing on 10 cores with 5000 iterations per core), the total time was &lt; 10 min for both Chardonnay and mosquito but substantially longer at 13 h and 45 min for the much larger thorny skate. Note that memory usage was dependent on the size of the alignment file and independent of the number of iterations, because HapSolo stores alignments in memory for rapid filtering at each step during hill climbing. Nonetheless, the memory and speed requirements are such that HapSolo can be run on a laptop or desktop computer.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par35">We have presented an implementation, HapSolo, that is focused on improving primary assemblies by removing alternative haplotigs. In theory, the HapSolo package can be applied to any set of contigs from any assembly algorithm. The approach implemented in HapSolo is intended to replace laborious manual curation [<xref ref-type="bibr" rid="CR37">37</xref>], and it follows some of the logic of existing programs, like Redundans [<xref ref-type="bibr" rid="CR24">24</xref>], PurgeHaplotigs [<xref ref-type="bibr" rid="CR25">25</xref>] and purge_dups [<xref ref-type="bibr" rid="CR26">26</xref>]. However, HapSolo differs from competing programs by at least three features. First, it utilizes multiple alignment metrics, so that it is not reliant only on percent identity (<italic>ID</italic>). The goal of these multiple metrics is to better discriminate among some situations that may yield high identity scores but nevertheless lead to the retention of different contigs in the primary assembly (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Second, when the hill climbing option is utilized, HapSolo relies on a maximization scheme based on BUSCO values. The underlying assumption is that maximizing the number of single-copy BUSCOs establishes more complete and less repetitive genomes. We emphasize that this is an assumption common to the genomics community, because most new genomes are reported with BUSCO scores to reflect their completeness and quality. Third, an important feature of HapSolo is the ability to modify the <italic>Cost</italic> function, so that the user may choose to weigh duplicated BUSCO genes less heavily or perhaps even ignore them altogether. This flexibility may prove useful for some applications. For example, it may be useful to ignore costs related to duplicated BUSCO genes when assembling polyploid genomes and instead focus only on complete and fragmented genes.</p>
    <p id="Par36">We have illustrated some of the performance features of HapSolo by applying it to data from three species that differ in genome size and complexity: Chardonnay grape, a mosquito, and the thorny skate. The common feature of these species is that diploid assembly is necessary. For all three species, we compared the unreduced primary assembly to two HapSolo assemblies, one that used default values (−HC) and one that used hill climbing minimization (+HC). Both HapSolo assemblies reduced genome size and markedly improved standard statistics like N50 (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The +HC contig assembly was generally better than the −HC assembly, but not always; the most substantial differences occurred between the unreduced assembly and either of the two HapSolo assemblies.</p>
    <p id="Par37">Our reduced assemblies scaffolded faster than unreduced assemblies and also led to more contiguous genomes. For each of our three species, the cumulative genome length associated with first <italic>k</italic> scaffolds (where <italic>k</italic> is the chromosome number) was much larger based on reduced vs. unreduced assemblies. The percentage of the genome contained in chromosome length scaffolds increased by at least 25% (Table <xref rid="Tab3" ref-type="table">3</xref>). We conclude that in highly heterozygous samples that potentially have a large number of alternative haplotigs, some reduction step is critical for curating a primary assembly and for downstream scaffolding. This is true even when the primary assemblies are from FALCON_Unzip [<xref ref-type="bibr" rid="CR19">19</xref>] which has already (in theory but perhaps not always in practice) identified secondary haplotigs. We further advocate for the use of the hill climbing feature in HapSolo, because the computational cost is relatively small but the gains can be large (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Finally, we find that BLAT tends to outperform minimap2 as the pre-processing aligner and advocate for its use. However, it can be time prohibitive on large genomes, and hence HapSolo includes support for minimap2.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par38">Based on the data in this paper, HapSolo generally led to similar or better outcomes than purge_dups [<xref ref-type="bibr" rid="CR26">26</xref>], another recently published method to identify and remove haplotigs. That is not to say, however, that HapSolo cannot be improved. We can see three obvious areas for future growth. The first is to consider coverage statistics, which represents a point of departure between our approach and that of both Purge Haplotigs and purge_dups. We predict, but do not yet know, that the inclusion of coverage with our existing alignment statistics could lead to more accurate inferences. A second area of improvement may be to implement alternative maximization algorithms, such as simulated annealing. Finally, it may also be possible to include additional features in the calculations of <italic>Cost</italic>. Our present reliance on BUSCOs has the advantages of speed and wide acceptance in the genomics community. However, depending on the initial assembly, it is likely that some contigs do not contain a BUSCO gene, are therefore not considered in <italic>Cost</italic> and do not form the approximation of threshold parameters (<italic>ID</italic><sub><italic>T</italic></sub>, <italic>Q</italic><sub><italic>T</italic></sub> and <italic>QR</italic><sub><italic>T</italic></sub>). It is not yet clear what additional features could be included in the <italic>Cost</italic> function, but identifying contigs containing an over-representation of shared <italic>k</italic>-mers is one possibility.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <sec id="Sec17">
      <title>Species and data</title>
      <p id="Par39">The data for the assemblies for <italic>V. vinifera</italic> (cultivar Chardonnay) [<xref ref-type="bibr" rid="CR13">13</xref>], <italic>A. funestus</italic> (mosquito) [<xref ref-type="bibr" rid="CR20">20</xref>], and <italic>A. radiata</italic> (thorny skate) [<xref ref-type="bibr" rid="CR33">33</xref>] were downloaded from public databases (see Data Availability). As mentioned, the contig assemblies were based on PacBio data. The chromosome number for each species was found in various sources [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. The <italic>P. leucopus</italic> data were published in [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
    </sec>
    <sec id="Sec18">
      <title>Pre-processing</title>
      <p id="Par40">For each genome, pre-processing prior to application of HapSolo consisted of all-by-all pairwise contig alignments, as described above. For this study, we used BLAT v35 [<xref ref-type="bibr" rid="CR28">28</xref>] and minimap2 [<xref ref-type="bibr" rid="CR29">29</xref>]. BLAT was run with default options after the reference was compressed into 2 bit format, and it was run using each contig as a separate query to reduce run time. Although not technically a feature of HapSolo, our github release provides a script to run Blat v35 [<xref ref-type="bibr" rid="CR28">28</xref>] using this parallel approach. After running on individual contigs, the resulting PSL files were concatenated into a single PSL file for input into HapSolo. Minimap2 was used to compare feasibility and results between aligners; it was employed with the options “ -P -k19 -w2 -A1 -B2 -O1,6 -E2,1 -s200 -z200 -N50 -min-occ-floor = 100”.</p>
    </sec>
    <sec id="Sec19">
      <title>Assemblies, Hi-C data and scaffolding</title>
      <p id="Par41">HapSolo was applied to with default parameters of 0.70 for ID<sub>T</sub>, Q<sub>T</sub> and QR<sub>T</sub>; hill climbing started with random values of ID<sub>T</sub>, Q<sub>T</sub> and QR<sub>T</sub> and then minimized <italic>Cost</italic> using hill climbing over 50,000 iterations. In HapSolo, BUSCO is run in <italic>geno</italic> mode on each contig using the orthoDB9 datasets and the AUGUSTUS species option. BUSCO v.3.0.2 relies on BLAST v.2.2.31+, AUGUSTUS v3.3, and BRAKER v1.9.</p>
      <p id="Par42">We obtained short-read Hi-C data from online public databases for scaffolding [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] (see Data Availability). The Hi-C sequencing data were mapped to their respective assemblies using BWA [<xref ref-type="bibr" rid="CR28">28</xref>]. The scaffolding of raw assembly and HapSolo processed assemblies were processed with the 3D de novo assembly pipeline v180419 [<xref ref-type="bibr" rid="CR39">39</xref>], available from <ext-link ext-link-type="uri" xlink:href="https://github.com/theaidenlab/3d-dna/">https://github.com/theaidenlab/3d-dna/</ext-link>. We ran QUAST v4.5 [<xref ref-type="bibr" rid="CR31">31</xref>] for our post processing example and to assess performance during program development. For Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1, the normalized value was calculated by first subtracting the minimum observed <italic>Cost</italic> min(<italic>Cost</italic>) from the observed <italic>Cost</italic>. The numerator [<italic>Cost</italic>-min(<italic>Cost</italic>)] was then divided by [max(<italic>Cost</italic>)-min(<italic>Cost</italic>)].</p>
    </sec>
    <sec id="Sec20">
      <title>Computational resources and processing</title>
      <p id="Par43">For runtime analyses, HapSolo was run on dual CPU Intel E5-2696 V2 Nodes containing 512 GB of RAM. The Blat, minimap2 and BUSCO pre-processing steps were run on these same nodes, but also one the UC Irvine High Performance Computing Cluster, Extreme Science and Engineering Discovery Environment [<xref ref-type="bibr" rid="CR40">40</xref>], San Diego Supercomputer Center Comet [<xref ref-type="bibr" rid="CR41">41</xref>] and Pittsburgh Supercomputing Center Bridges [<xref ref-type="bibr" rid="CR42">42</xref>] clusters.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3939_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary Tables and Figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HC</term>
        <def>
          <p id="Par4">Hill Climbing</p>
        </def>
      </def-item>
      <def-item>
        <term>BUSCO</term>
        <def>
          <p id="Par5">Benchmarking Universal Single-Copy Orthologs</p>
        </def>
      </def-item>
      <def-item>
        <term>MM2</term>
        <def>
          <p id="Par6">Minimap2</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-020-03939-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank A. Minio from the Cantù Lab at UC Davis for informing us of the haplotig issue in genome assemblies, R. Lathrop, S. Koren and J.J. Emerson at UC Irvine for comments, and R. Kuo from the Roslin Institute, University of Edinburgh for devising the name, HapSolo.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>EAS conceived of the approach, wrote the package and analyzed primary assemblies; YT performed Hi-C scaffolding; ADL and BSG provided ideas and feedback on the approach; EAS, ADL and BSG wrote the paper. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>EAS is supported by a National Science Foundation (NSF) Graduate Research Program Fellowship under Grant No. DGE-1321846. This grant supported his time to formulate and excute the study. The work was also supported by NSF Grant NSF Grant No. 1741627 to BSG; this grant supported the empirical work that was the motivation for this study, it contributed data, and it funded publication charges. YT and ADL were supported by NIH Grants R01OD010974 and R01GM115562; these grants contributed data and supported personnel time for Hi-C analyses. This work also used the Extreme Science and Engineering Discovery Environment, which is supported by National Science Foundation grant number ACI-1548562. Specifically, it used the Bridges system, which is supported by NSF award number ACI-1445606, at the Pittsburgh Supercomputing Center under award no. TG-MCB180035. These grants provided computational resources that were used in this study.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>Vitis vinifera</italic> data: NCBI under the BioProject ID PRJNA550461. <italic>Anopheles funestus</italic> data: NCBI under the BioProject ID PRJNA494870. <italic>Amblyraja radiata</italic> data<italic>:</italic> Genbank ID GCA_010909765.1, <ext-link ext-link-type="uri" xlink:href="https://vgp.github.io/genomeark/Amblyraja_radiata/">https://vgp.github.io/genomeark/Amblyraja_radiata/</ext-link><underline>.</underline>
<italic>Peromyscus leucopus</italic> data: Genbank ID GCA_004664715.2. Software: <ext-link ext-link-type="uri" xlink:href="https://github.com/esolares/HapSolo">https://github.com/esolares/HapSolo</ext-link>. Publication Version: <ext-link ext-link-type="uri" xlink:href="https://github.com/esolares/HapSolo/releases/tag/v0.1">https://github.com/esolares/HapSolo/releases/tag/v0.1</ext-link></p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par44">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par45">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par46">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yazaki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sundaresan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cokus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>SW-L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide high-resolution mapping and functional analysis of DNA methylation in arabidopsis</article-title>
        <source>Cell</source>
        <year>2006</year>
        <volume>126</volume>
        <fpage>1189</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2006.08.003</pub-id>
        <pub-id pub-id-type="pmid">16949657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goff</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>A draft sequence of the rice genome (<italic>Oryza sativa</italic> L. ssp. japonica)</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>296</volume>
        <fpage>92</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1068275</pub-id>
        <?supplied-pmid 11935018?>
        <pub-id pub-id-type="pmid">11935018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>C. elegans Sequencing Consortium</collab>
        </person-group>
        <article-title>Genome sequence of the nematode <italic>C. elegans</italic>: a platform for investigating biology</article-title>
        <source>Science</source>
        <year>1998</year>
        <volume>282</volume>
        <fpage>2012</fpage>
        <lpage>2018</lpage>
        <pub-id pub-id-type="doi">10.1126/science.282.5396.2012</pub-id>
        <pub-id pub-id-type="pmid">9851916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>The genome sequence of <italic>Drosophila melanogaster</italic></article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>287</volume>
        <fpage>2185</fpage>
        <lpage>2195</lpage>
        <pub-id pub-id-type="doi">10.1126/science.287.5461.2185</pub-id>
        <?supplied-pmid 10731132?>
        <pub-id pub-id-type="pmid">10731132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Solares</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Chakraborty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Kalsow</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Perera</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid low-cost assembly of the <italic>Drosophila melanogaster</italic> reference genome using low-coverage, long-read sequencing</article-title>
        <source>G3 Genes Genomes Genet</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1101/267401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stitzer</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved maize reference genome with single-molecule technologies</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>546</volume>
        <fpage>524</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22971</pub-id>
        <pub-id pub-id-type="pmid">28605751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daccord</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Celton</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Linsmith</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Choisne</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schijlen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-quality de novo assembly of the apple genome and methylome dynamics of early fruit development</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1099</fpage>
        <lpage>1106</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3886</pub-id>
        <pub-id pub-id-type="pmid">28581499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raymond</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gouzy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Just</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Badouin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Verdenaud</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lemainque</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Rosa genome provides new insights into the domestication of modern roses</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>772</fpage>
        <lpage>777</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0110-3</pub-id>
        <pub-id pub-id-type="pmid">29713014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roessler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Muyle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diez</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>GRJ</given-names>
          </name>
          <name>
            <surname>Bousios</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stitzer</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome-wide dynamics of purging during selfing in maize</article-title>
        <source>Nat Plants</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>980</fpage>
        <lpage>990</lpage>
        <pub-id pub-id-type="doi">10.1038/s41477-019-0508-7</pub-id>
        <pub-id pub-id-type="pmid">31477888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>Evolution of DNA content in higher plants</article-title>
        <source>Bot Rev</source>
        <year>1976</year>
        <volume>42</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1007/BF02860861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierst</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Willis</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ahearne</surname>
            <given-names>TE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reproductive mode and the evolution of genome size and structure in Caenorhabditis Nematodes</article-title>
        <source>PLoS Genet</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1005323</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1005323</pub-id>
        <pub-id pub-id-type="pmid">26114425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Endersby-Harshman</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive assessment of inbreeding and laboratory adaptation in <italic>Aedes aegypti</italic> mosquitoes</article-title>
        <source>Evol Appl</source>
        <year>2019</year>
        <volume>12</volume>
        <fpage>572</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1111/eva.12740</pub-id>
        <pub-id pub-id-type="pmid">30828375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Minio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Massonnet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Solares</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Beridze</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The population genetics of structural variants in grapevine domestication</article-title>
        <source>Nat Plants</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>965</fpage>
        <lpage>979</lpage>
        <pub-id pub-id-type="doi">10.1038/s41477-019-0507-8</pub-id>
        <pub-id pub-id-type="pmid">31506640</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Cantu</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>How single molecule real-time sequencing and haplotype phasing have enabled reference-grade diploid genome assembly of wine grapes</article-title>
        <source>Front Plant Sci</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>826</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2017.00826</pub-id>
        <pub-id pub-id-type="pmid">28567052</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Massonnet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cochetel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Minio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vondras</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Muyle</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genetic basis of sex determination in grapes</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16700-z</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rand</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sasani</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakraborty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baldwin-Brown</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Contiguous and accurate de novo assembly of metazoan genomes with modest long read coverage</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e147</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw419</pub-id>
        <pub-id pub-id-type="pmid">27458204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vondras</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Minio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blanco-Ulate</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Figueroa-Balderas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Penn</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genomic diversification of clonally propagated grapevines</article-title>
        <source>bioRxiv</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/585869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>C-S</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Clum</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>1050</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4035</pub-id>
        <?supplied-pmid 27749838?>
        <pub-id pub-id-type="pmid">27749838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghurye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Small</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Redmond</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Howell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A chromosome-scale assembly of the major African malaria vector <italic>Anopheles funestus</italic></article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>giz063</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz063</pub-id>
        <?supplied-pmid 31157884?>
        <pub-id pub-id-type="pmid">31157884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Bickhart</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kingan</surname>
            <given-names>SB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of haplotype-resolved genomes with trio binning</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1038/nbt.4277</pub-id>
        <?supplied-pmid 30346939?>
        <pub-id pub-id-type="pmid">30346939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rice</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heaton</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Kalbfleisch</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Continuous chromosome-scale haplotypes assembled from a single interspecies F1 hybrid of yak and cattle</article-title>
        <source>Gigascience</source>
        <year>2020</year>
        <volume>9</volume>
        <fpage>giaa029</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giaa029</pub-id>
        <?supplied-pmid 32242610?>
        <pub-id pub-id-type="pmid">32242610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pryszcz</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Redundans: an assembly pipeline for highly heterozygous genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e113</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw294</pub-id>
        <pub-id pub-id-type="pmid">27131372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roach</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Borneman</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Purge Haplotigs: allelic contig reassignment for third-gen diploid genome assemblies</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>460</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2485-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identifying and removing haplotypic duplication in primary genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa025</pub-id>
        <?supplied-pmid 33297937?>
        <pub-id pub-id-type="pmid">33297937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>BLAT—the BLAST-like alignment tool</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229202</pub-id>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read alignment with Burrows–Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>589</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id>
        <pub-id pub-id-type="pmid">20080505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3210</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id>
        <pub-id pub-id-type="pmid">26059717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roach</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Bohlmann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van Vuuren</surname>
            <given-names>HJJ</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SJM</given-names>
          </name>
          <name>
            <surname>Pretorius</surname>
            <given-names>IS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population sequencing reveals clonal diversity and ancestral inbreeding in the grapevine cultivar Chardonnay</article-title>
        <source>PLoS Genet</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1007807</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1007807</pub-id>
        <pub-id pub-id-type="pmid">30458008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Fedrigo</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Damas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Formenti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards complete and error-free genome assemblies of all vertebrate species</article-title>
        <source>bioRxiv</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1101/2020.05.22.110833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolff</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bhardwaj</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nothjunge</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Richard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Renschler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gilsbach</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Galaxy HiCExplorer: a web server for reproducible Hi-C data analysis, quality control and visualization</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>W11</fpage>
        <lpage>W16</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky504</pub-id>
        <pub-id pub-id-type="pmid">29901812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Baldwin-Brown</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Balderrama-Gutierrez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Corbett-Detig</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome of <italic>Peromyscus leucopus</italic>, natural host for Lyme disease and other emerging infections</article-title>
        <source>Sci Adv</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>6441</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.aaw6441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cargill</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ireland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Patil</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of single-nucleotide polymorphisms in coding regions of human genes</article-title>
        <source>Nat Genet</source>
        <year>1999</year>
        <volume>22</volume>
        <fpage>231</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="doi">10.1038/10290</pub-id>
        <pub-id pub-id-type="pmid">10391209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakraborty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>VanKuren</surname>
            <given-names>NW</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Kalsow</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Hidden genetic variation shapes the structure of functional elements in Drosophila</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>20</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-017-0010-y</pub-id>
        <pub-id pub-id-type="pmid">29255259</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Noel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Policriti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clepet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Casagrande</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The grapevine genome sequence suggests ancestral hexaploidization in major angiosperm phyla</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>463</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06148</pub-id>
        <pub-id pub-id-type="pmid">17721507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudchenko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Batra</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Omer</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Nyquist</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hoeger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of the <italic>Aedes aegypti</italic> genome using Hi-C yields chromosome-length scaffolds</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <fpage>92</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aal3327</pub-id>
        <pub-id pub-id-type="pmid">28336562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Towns</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cockerill</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dahan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gaither</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grimshaw</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>XSEDE: accelerating scientific discovery</article-title>
        <source>Comput Sci Eng</source>
        <year>2014</year>
        <volume>16</volume>
        <fpage>62</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1109/mcse.2014.80</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Moore RL, Baru C, Baxter D, Fox GC, Majumdar A, Papadopoulos P, et al. Gateways to discovery: Cyberinfrastructure for the long tail of science. In: Proceedings of the 2014 annual conference on extreme science and engineering discovery environment. New York, NY, USA: Association for Computing Machinery; 2014. p. 1–8.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Nystrom NA, Levine MJ, Roskies RZ, Scott JR. Bridges: a uniquely flexible HPC resource for new communities and data analytics. In: Proceedings of the 2015 XSEDE Conference: Scientific Advancements Enabled by Enhanced Cyberinfrastructure. New York, NY, USA: Association for Computing Machinery; 2015. p. 1–8.</mixed-citation>
    </ref>
  </ref-list>
</back>
